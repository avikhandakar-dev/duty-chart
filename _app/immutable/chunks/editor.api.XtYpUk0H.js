import{aC as xs,aD as Nr,aE as bu,aF as pg,O as _g,H as Bt,aG as bg,aH as vg,aI as wg,aJ as bo,b as Se,L as Sg,aK as Cg,e as Oe,I as Ar,W as vu,a5 as yg,a3 as Oi,M as Lg,E as kg,z as Eg,aB as xg,aL as Je,aM as Ig,R as Or,aN as jc,X as vi,aO as Dg,aP as Is,aQ as vo,aR as Rg,aS as wo,$ as Ke,T as wu,aT as Mg,o as Gc,aU as nn,P as At,aV as Ds,am as Le,an as Rs,aW as Ms,D as Su,aX as Tg,aY as Zc,aZ as Ng,a_ as Ag,a$ as Og,b0 as Pg,b1 as Fg,b2 as Bg,Q as rc,b3 as oc,N as Kr,V as Wg,b4 as Hg,a4 as Vg,b5 as Ug,b6 as Xr,b7 as gn,b8 as $g,ao as zt,b9 as Kc,ba as qg,bb as zg,bc as jg,bd as Gg,w as Xc,u as Yc,v as Zg,A as Qc,be as Kg,bf as Xg,at as Xn,t as Pr,bg as Cu,bh as yu,bi as Lu,bj as Yg,bk as Qg,bl as Jc,bm as Jg,B as em,bn as ku,bo as tm,bp as So,bq as ac,br as Eu,bs as Ts,r as Yn,bt as lc,bu as xu,c as Ki,n as im,bv as nm,bw as Co,bx as sm,by as rm,bz as om,bA as am,bB as lm,bC as cm,bD as dm,bE as hm,bF as Xi,bG as be,bH as um,bI as wi,bJ as ed,bK as fm,J as gm,K as mm,bL as pm,bM as _m,bN as bm,bO as vm,bP as wm}from"./iconRegistry.BJgxFQLY.js";import{K as Sm,a as Fr,J as R,P as K,R as O,U as Ae,ba as Cm,H as D,o as di,cm as Iu,cn as td,a5 as le,co as ym,c2 as cc,cp as Lm,cq as km,bV as Du,cr as Em,ap as id,bx as xm,cs as yo,_ as Lo,ct as Yr,cu as Im,cv as On,cw as dc,br as Wt,am as Dm,cx as Rm,cy as Ru,cz as Mm,cf as Ot,cg as ti,cA as Tm,cB as Nm,b4 as Pt,cC as hc,ac as uc,ah as Ns,D as ie,cD as Mu,Y as fc,q as dt,ay as Ee,w as Vt,I as Q,i as Tu,b8 as Am,bC as Om,bz as Ue,cE as Pm,L as Ei,F as me,ax as se,cF as Nu,f as Ce,cG as Au,aw as nd,X as ee,a8 as Ou,l as C,bw as vs,bu as ko,cH as Eo,s as Pu,cI as Fm,b9 as Pn,bI as gc,bJ as Bm,c as re,aD as ae,V as I,aN as ot,aH as ui,cJ as Fu,S as G,a0 as he,cK as Bu,au as sd,aA as lt,at as Wu,as as Hu,bb as As,cL as Wm,aE as xi,cd as Hm,cc as Vm,cM as mn,b$ as Te,bX as Um,cN as $m,c0 as Ft,cO as Vu,aO as N,aP as je,an as mc,bd as Ut,b5 as rd,aJ as od,cP as qm,cQ as zm,cR as Uu,cS as jm,bO as Gm,cT as Zm,cU as sn,aG as xo,cV as Km,cW as $u,cX as Xm,W as pe,bg as vn,cY as Io,aW as Fn,bo as Ym,ai as hi,cZ as Qm,bq as qu,T as $e,Q as we,bP as Jm,c_ as ep,c$ as tp,a2 as ad,bY as ip,d0 as zu,aT as ju,a9 as Gu,$ as Qn,aq as Br,ci as np,a6 as ii,g as Yi,aM as sp,c3 as ld,b as Bn,c9 as Pi,d1 as rp,d2 as Zu,bQ as He,b_ as cd,d3 as Os,d4 as op,z as Qi,h as Ie,aX as Ku,d5 as ap,cb as Xu,bS as lp,M as Yu,a1 as Qu,d6 as cp,d7 as dd,a3 as Ju,by as ef,d8 as dp,r as hp,d9 as up,da as Qr,db as fp,dc as gp,dd as mp,de as pp,aI as _p,t as Ii,e as Ct,az as bp,df as hd,dg as vp,bj as wp,aj as Sp,dh as Cp,di as yp,dj as Lp,G as kp,v as Ep,dk as xp,bm as Fi,dl as ud,dm as Ps,dn as fd,dp as gd,Z as Ip,c8 as P,dq as Dp,dr as Rp,j as Ge,ds as Mp,bi as tf,aR as Tp,B as Np}from"./editorContextKeys.Cdn_dJhV.js";import{a as Fs,r as V,c as Lt,g as md,E as Ap,I as nf,b as sf,S as Op}from"./stableEditorScroll.DHPB0mmN.js";import{ak as Pp,al as q,am as Wn,an as A,ao as Fp,ap as Bs,aq as Bp,ar as Hn,as as rf,at as Wp,c as Jn,I as yt,a as $t,au as Hp,av as rn,aw as of,q as Ne,ax as af,ay as Vp,P as ht,b as fi,az as pd,Z as Wr,ai as Up,aA as Jr,V as $p,aB as qp,aC as zp,aD as jp,f as $,aE as Gp,aF as lf,aG as _d,aH as bd,aI as Zp,a6 as ne,A as ni,aJ as Kp,a4 as Xp,aK as Yp,J as pc,aL as Qp,aM as Jp,ae as Si,aN as e_,aO as t_,aP as i_,a2 as n_,aQ as Ci,T as s_,r as r_,g as o_,F as a_,aR as cf,k as vd,aS as F,aT as ge,aU as l_,aV as c_,aW as d_,a0 as h_,aX as u_,aY as f_,aZ as g_,l as m_,a_ as Hr,a$ as Vr,b0 as p_,m as __,b1 as ns,b2 as b_,b3 as es,b4 as v_,d as w_,i as S_,aj as C_,b5 as y_,e as L_,b6 as k_,b7 as ct,b8 as Ur,b9 as ts,ba as _c,a8 as et,bb as $r,bc as E_,bd as Do,a9 as Ji,be as df,a7 as T,M as ut,bf as ze,bg as bc,bh as ss,bi as wd,bj as Sd,bk as x_,bl as I_,bm as D_,bn as vc,t as Cd,bo as R_,bp as M_,bq as wc,S as T_,br as nt,bs as yd,bt as N_,bu as hf,bv as A_,ag as O_,bw as P_,bx as uf,C as ff,by as F_,bz as B_,bA as W_,bB as pn,$ as H_,bC as V_,bD as U_,bE as $_,bF as q_,bG as z_,bH as j_,bI as G_}from"./codeEditorWidget.CXeIzSuq.js";import{_ as Z_}from"./preload-helper.Q8GAf1eS.js";import{L as K_,s as X_,H as Y_,i as Q_,h as J_,j as qr,p as gi,t as eb,M as It,k as Sc,K as tb,v as ib,R as nb,I as sb,C as Ld,w as rb,x as ob,o as ab,y as lb,e as cb,z as db,A as hb,B as gf}from"./toolbar.BTiJf7ch.js";import{b as ub,I as Cc}from"./editorBrowser.CzkYJKPy.js";import{T as fb,S as gb,c as mb,I as pb,b as yc}from"./clipboardService.BTmHAzm-.js";import{I as zr,A as kt,b as _b}from"./format.Bb1_og6G.js";var Ro;(function(n){n[n.Unknown=0]="Unknown",n[n.Disabled=1]="Disabled",n[n.Enabled=2]="Enabled"})(Ro||(Ro={}));var Mo;(function(n){n[n.Invoke=1]="Invoke",n[n.Auto=2]="Auto"})(Mo||(Mo={}));var To;(function(n){n[n.None=0]="None",n[n.KeepWhitespace=1]="KeepWhitespace",n[n.InsertAsSnippet=4]="InsertAsSnippet"})(To||(To={}));var No;(function(n){n[n.Method=0]="Method",n[n.Function=1]="Function",n[n.Constructor=2]="Constructor",n[n.Field=3]="Field",n[n.Variable=4]="Variable",n[n.Class=5]="Class",n[n.Struct=6]="Struct",n[n.Interface=7]="Interface",n[n.Module=8]="Module",n[n.Property=9]="Property",n[n.Event=10]="Event",n[n.Operator=11]="Operator",n[n.Unit=12]="Unit",n[n.Value=13]="Value",n[n.Constant=14]="Constant",n[n.Enum=15]="Enum",n[n.EnumMember=16]="EnumMember",n[n.Keyword=17]="Keyword",n[n.Text=18]="Text",n[n.Color=19]="Color",n[n.File=20]="File",n[n.Reference=21]="Reference",n[n.Customcolor=22]="Customcolor",n[n.Folder=23]="Folder",n[n.TypeParameter=24]="TypeParameter",n[n.User=25]="User",n[n.Issue=26]="Issue",n[n.Snippet=27]="Snippet"})(No||(No={}));var Ao;(function(n){n[n.Deprecated=1]="Deprecated"})(Ao||(Ao={}));var Oo;(function(n){n[n.Invoke=0]="Invoke",n[n.TriggerCharacter=1]="TriggerCharacter",n[n.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Oo||(Oo={}));var Po;(function(n){n[n.EXACT=0]="EXACT",n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW"})(Po||(Po={}));var Fo;(function(n){n[n.NotSet=0]="NotSet",n[n.ContentFlush=1]="ContentFlush",n[n.RecoverFromMarkers=2]="RecoverFromMarkers",n[n.Explicit=3]="Explicit",n[n.Paste=4]="Paste",n[n.Undo=5]="Undo",n[n.Redo=6]="Redo"})(Fo||(Fo={}));var Bo;(function(n){n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(Bo||(Bo={}));var Wo;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(Wo||(Wo={}));var Ho;(function(n){n[n.None=0]="None",n[n.Keep=1]="Keep",n[n.Brackets=2]="Brackets",n[n.Advanced=3]="Advanced",n[n.Full=4]="Full"})(Ho||(Ho={}));var Vo;(function(n){n[n.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",n[n.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",n[n.accessibilitySupport=2]="accessibilitySupport",n[n.accessibilityPageSize=3]="accessibilityPageSize",n[n.ariaLabel=4]="ariaLabel",n[n.ariaRequired=5]="ariaRequired",n[n.autoClosingBrackets=6]="autoClosingBrackets",n[n.autoClosingComments=7]="autoClosingComments",n[n.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",n[n.autoClosingDelete=9]="autoClosingDelete",n[n.autoClosingOvertype=10]="autoClosingOvertype",n[n.autoClosingQuotes=11]="autoClosingQuotes",n[n.autoIndent=12]="autoIndent",n[n.automaticLayout=13]="automaticLayout",n[n.autoSurround=14]="autoSurround",n[n.bracketPairColorization=15]="bracketPairColorization",n[n.guides=16]="guides",n[n.codeLens=17]="codeLens",n[n.codeLensFontFamily=18]="codeLensFontFamily",n[n.codeLensFontSize=19]="codeLensFontSize",n[n.colorDecorators=20]="colorDecorators",n[n.colorDecoratorsLimit=21]="colorDecoratorsLimit",n[n.columnSelection=22]="columnSelection",n[n.comments=23]="comments",n[n.contextmenu=24]="contextmenu",n[n.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",n[n.cursorBlinking=26]="cursorBlinking",n[n.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",n[n.cursorStyle=28]="cursorStyle",n[n.cursorSurroundingLines=29]="cursorSurroundingLines",n[n.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",n[n.cursorWidth=31]="cursorWidth",n[n.disableLayerHinting=32]="disableLayerHinting",n[n.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",n[n.domReadOnly=34]="domReadOnly",n[n.dragAndDrop=35]="dragAndDrop",n[n.dropIntoEditor=36]="dropIntoEditor",n[n.emptySelectionClipboard=37]="emptySelectionClipboard",n[n.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",n[n.extraEditorClassName=39]="extraEditorClassName",n[n.fastScrollSensitivity=40]="fastScrollSensitivity",n[n.find=41]="find",n[n.fixedOverflowWidgets=42]="fixedOverflowWidgets",n[n.folding=43]="folding",n[n.foldingStrategy=44]="foldingStrategy",n[n.foldingHighlight=45]="foldingHighlight",n[n.foldingImportsByDefault=46]="foldingImportsByDefault",n[n.foldingMaximumRegions=47]="foldingMaximumRegions",n[n.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",n[n.fontFamily=49]="fontFamily",n[n.fontInfo=50]="fontInfo",n[n.fontLigatures=51]="fontLigatures",n[n.fontSize=52]="fontSize",n[n.fontWeight=53]="fontWeight",n[n.fontVariations=54]="fontVariations",n[n.formatOnPaste=55]="formatOnPaste",n[n.formatOnType=56]="formatOnType",n[n.glyphMargin=57]="glyphMargin",n[n.gotoLocation=58]="gotoLocation",n[n.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",n[n.hover=60]="hover",n[n.inDiffEditor=61]="inDiffEditor",n[n.inlineSuggest=62]="inlineSuggest",n[n.inlineEdit=63]="inlineEdit",n[n.letterSpacing=64]="letterSpacing",n[n.lightbulb=65]="lightbulb",n[n.lineDecorationsWidth=66]="lineDecorationsWidth",n[n.lineHeight=67]="lineHeight",n[n.lineNumbers=68]="lineNumbers",n[n.lineNumbersMinChars=69]="lineNumbersMinChars",n[n.linkedEditing=70]="linkedEditing",n[n.links=71]="links",n[n.matchBrackets=72]="matchBrackets",n[n.minimap=73]="minimap",n[n.mouseStyle=74]="mouseStyle",n[n.mouseWheelScrollSensitivity=75]="mouseWheelScrollSensitivity",n[n.mouseWheelZoom=76]="mouseWheelZoom",n[n.multiCursorMergeOverlapping=77]="multiCursorMergeOverlapping",n[n.multiCursorModifier=78]="multiCursorModifier",n[n.multiCursorPaste=79]="multiCursorPaste",n[n.multiCursorLimit=80]="multiCursorLimit",n[n.occurrencesHighlight=81]="occurrencesHighlight",n[n.overviewRulerBorder=82]="overviewRulerBorder",n[n.overviewRulerLanes=83]="overviewRulerLanes",n[n.padding=84]="padding",n[n.pasteAs=85]="pasteAs",n[n.parameterHints=86]="parameterHints",n[n.peekWidgetDefaultFocus=87]="peekWidgetDefaultFocus",n[n.placeholder=88]="placeholder",n[n.definitionLinkOpensInPeek=89]="definitionLinkOpensInPeek",n[n.quickSuggestions=90]="quickSuggestions",n[n.quickSuggestionsDelay=91]="quickSuggestionsDelay",n[n.readOnly=92]="readOnly",n[n.readOnlyMessage=93]="readOnlyMessage",n[n.renameOnType=94]="renameOnType",n[n.renderControlCharacters=95]="renderControlCharacters",n[n.renderFinalNewline=96]="renderFinalNewline",n[n.renderLineHighlight=97]="renderLineHighlight",n[n.renderLineHighlightOnlyWhenFocus=98]="renderLineHighlightOnlyWhenFocus",n[n.renderValidationDecorations=99]="renderValidationDecorations",n[n.renderWhitespace=100]="renderWhitespace",n[n.revealHorizontalRightPadding=101]="revealHorizontalRightPadding",n[n.roundedSelection=102]="roundedSelection",n[n.rulers=103]="rulers",n[n.scrollbar=104]="scrollbar",n[n.scrollBeyondLastColumn=105]="scrollBeyondLastColumn",n[n.scrollBeyondLastLine=106]="scrollBeyondLastLine",n[n.scrollPredominantAxis=107]="scrollPredominantAxis",n[n.selectionClipboard=108]="selectionClipboard",n[n.selectionHighlight=109]="selectionHighlight",n[n.selectOnLineNumbers=110]="selectOnLineNumbers",n[n.showFoldingControls=111]="showFoldingControls",n[n.showUnused=112]="showUnused",n[n.snippetSuggestions=113]="snippetSuggestions",n[n.smartSelect=114]="smartSelect",n[n.smoothScrolling=115]="smoothScrolling",n[n.stickyScroll=116]="stickyScroll",n[n.stickyTabStops=117]="stickyTabStops",n[n.stopRenderingLineAfter=118]="stopRenderingLineAfter",n[n.suggest=119]="suggest",n[n.suggestFontSize=120]="suggestFontSize",n[n.suggestLineHeight=121]="suggestLineHeight",n[n.suggestOnTriggerCharacters=122]="suggestOnTriggerCharacters",n[n.suggestSelection=123]="suggestSelection",n[n.tabCompletion=124]="tabCompletion",n[n.tabIndex=125]="tabIndex",n[n.unicodeHighlighting=126]="unicodeHighlighting",n[n.unusualLineTerminators=127]="unusualLineTerminators",n[n.useShadowDOM=128]="useShadowDOM",n[n.useTabStops=129]="useTabStops",n[n.wordBreak=130]="wordBreak",n[n.wordSegmenterLocales=131]="wordSegmenterLocales",n[n.wordSeparators=132]="wordSeparators",n[n.wordWrap=133]="wordWrap",n[n.wordWrapBreakAfterCharacters=134]="wordWrapBreakAfterCharacters",n[n.wordWrapBreakBeforeCharacters=135]="wordWrapBreakBeforeCharacters",n[n.wordWrapColumn=136]="wordWrapColumn",n[n.wordWrapOverride1=137]="wordWrapOverride1",n[n.wordWrapOverride2=138]="wordWrapOverride2",n[n.wrappingIndent=139]="wrappingIndent",n[n.wrappingStrategy=140]="wrappingStrategy",n[n.showDeprecated=141]="showDeprecated",n[n.inlayHints=142]="inlayHints",n[n.editorClassName=143]="editorClassName",n[n.pixelRatio=144]="pixelRatio",n[n.tabFocusMode=145]="tabFocusMode",n[n.layoutInfo=146]="layoutInfo",n[n.wrappingInfo=147]="wrappingInfo",n[n.defaultColorDecorators=148]="defaultColorDecorators",n[n.colorDecoratorsActivatedOn=149]="colorDecoratorsActivatedOn",n[n.inlineCompletionsAccessibilityVerbose=150]="inlineCompletionsAccessibilityVerbose"})(Vo||(Vo={}));var Uo;(function(n){n[n.TextDefined=0]="TextDefined",n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(Uo||(Uo={}));var $o;(function(n){n[n.LF=0]="LF",n[n.CRLF=1]="CRLF"})($o||($o={}));var qo;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=3]="Right"})(qo||(qo={}));var zo;(function(n){n[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease"})(zo||(zo={}));var jo;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(jo||(jo={}));var Go;(function(n){n[n.Both=0]="Both",n[n.Right=1]="Right",n[n.Left=2]="Left",n[n.None=3]="None"})(Go||(Go={}));var Zo;(function(n){n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(Zo||(Zo={}));var Ko;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(Ko||(Ko={}));var Xo;(function(n){n[n.Invoke=0]="Invoke",n[n.Automatic=1]="Automatic"})(Xo||(Xo={}));var Yo;(function(n){n[n.DependsOnKbLayout=-1]="DependsOnKbLayout",n[n.Unknown=0]="Unknown",n[n.Backspace=1]="Backspace",n[n.Tab=2]="Tab",n[n.Enter=3]="Enter",n[n.Shift=4]="Shift",n[n.Ctrl=5]="Ctrl",n[n.Alt=6]="Alt",n[n.PauseBreak=7]="PauseBreak",n[n.CapsLock=8]="CapsLock",n[n.Escape=9]="Escape",n[n.Space=10]="Space",n[n.PageUp=11]="PageUp",n[n.PageDown=12]="PageDown",n[n.End=13]="End",n[n.Home=14]="Home",n[n.LeftArrow=15]="LeftArrow",n[n.UpArrow=16]="UpArrow",n[n.RightArrow=17]="RightArrow",n[n.DownArrow=18]="DownArrow",n[n.Insert=19]="Insert",n[n.Delete=20]="Delete",n[n.Digit0=21]="Digit0",n[n.Digit1=22]="Digit1",n[n.Digit2=23]="Digit2",n[n.Digit3=24]="Digit3",n[n.Digit4=25]="Digit4",n[n.Digit5=26]="Digit5",n[n.Digit6=27]="Digit6",n[n.Digit7=28]="Digit7",n[n.Digit8=29]="Digit8",n[n.Digit9=30]="Digit9",n[n.KeyA=31]="KeyA",n[n.KeyB=32]="KeyB",n[n.KeyC=33]="KeyC",n[n.KeyD=34]="KeyD",n[n.KeyE=35]="KeyE",n[n.KeyF=36]="KeyF",n[n.KeyG=37]="KeyG",n[n.KeyH=38]="KeyH",n[n.KeyI=39]="KeyI",n[n.KeyJ=40]="KeyJ",n[n.KeyK=41]="KeyK",n[n.KeyL=42]="KeyL",n[n.KeyM=43]="KeyM",n[n.KeyN=44]="KeyN",n[n.KeyO=45]="KeyO",n[n.KeyP=46]="KeyP",n[n.KeyQ=47]="KeyQ",n[n.KeyR=48]="KeyR",n[n.KeyS=49]="KeyS",n[n.KeyT=50]="KeyT",n[n.KeyU=51]="KeyU",n[n.KeyV=52]="KeyV",n[n.KeyW=53]="KeyW",n[n.KeyX=54]="KeyX",n[n.KeyY=55]="KeyY",n[n.KeyZ=56]="KeyZ",n[n.Meta=57]="Meta",n[n.ContextMenu=58]="ContextMenu",n[n.F1=59]="F1",n[n.F2=60]="F2",n[n.F3=61]="F3",n[n.F4=62]="F4",n[n.F5=63]="F5",n[n.F6=64]="F6",n[n.F7=65]="F7",n[n.F8=66]="F8",n[n.F9=67]="F9",n[n.F10=68]="F10",n[n.F11=69]="F11",n[n.F12=70]="F12",n[n.F13=71]="F13",n[n.F14=72]="F14",n[n.F15=73]="F15",n[n.F16=74]="F16",n[n.F17=75]="F17",n[n.F18=76]="F18",n[n.F19=77]="F19",n[n.F20=78]="F20",n[n.F21=79]="F21",n[n.F22=80]="F22",n[n.F23=81]="F23",n[n.F24=82]="F24",n[n.NumLock=83]="NumLock",n[n.ScrollLock=84]="ScrollLock",n[n.Semicolon=85]="Semicolon",n[n.Equal=86]="Equal",n[n.Comma=87]="Comma",n[n.Minus=88]="Minus",n[n.Period=89]="Period",n[n.Slash=90]="Slash",n[n.Backquote=91]="Backquote",n[n.BracketLeft=92]="BracketLeft",n[n.Backslash=93]="Backslash",n[n.BracketRight=94]="BracketRight",n[n.Quote=95]="Quote",n[n.OEM_8=96]="OEM_8",n[n.IntlBackslash=97]="IntlBackslash",n[n.Numpad0=98]="Numpad0",n[n.Numpad1=99]="Numpad1",n[n.Numpad2=100]="Numpad2",n[n.Numpad3=101]="Numpad3",n[n.Numpad4=102]="Numpad4",n[n.Numpad5=103]="Numpad5",n[n.Numpad6=104]="Numpad6",n[n.Numpad7=105]="Numpad7",n[n.Numpad8=106]="Numpad8",n[n.Numpad9=107]="Numpad9",n[n.NumpadMultiply=108]="NumpadMultiply",n[n.NumpadAdd=109]="NumpadAdd",n[n.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",n[n.NumpadSubtract=111]="NumpadSubtract",n[n.NumpadDecimal=112]="NumpadDecimal",n[n.NumpadDivide=113]="NumpadDivide",n[n.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",n[n.ABNT_C1=115]="ABNT_C1",n[n.ABNT_C2=116]="ABNT_C2",n[n.AudioVolumeMute=117]="AudioVolumeMute",n[n.AudioVolumeUp=118]="AudioVolumeUp",n[n.AudioVolumeDown=119]="AudioVolumeDown",n[n.BrowserSearch=120]="BrowserSearch",n[n.BrowserHome=121]="BrowserHome",n[n.BrowserBack=122]="BrowserBack",n[n.BrowserForward=123]="BrowserForward",n[n.MediaTrackNext=124]="MediaTrackNext",n[n.MediaTrackPrevious=125]="MediaTrackPrevious",n[n.MediaStop=126]="MediaStop",n[n.MediaPlayPause=127]="MediaPlayPause",n[n.LaunchMediaPlayer=128]="LaunchMediaPlayer",n[n.LaunchMail=129]="LaunchMail",n[n.LaunchApp2=130]="LaunchApp2",n[n.Clear=131]="Clear",n[n.MAX_VALUE=132]="MAX_VALUE"})(Yo||(Yo={}));var Qo;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(Qo||(Qo={}));var Jo;(function(n){n[n.Unnecessary=1]="Unnecessary",n[n.Deprecated=2]="Deprecated"})(Jo||(Jo={}));var ea;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(ea||(ea={}));var ta;(function(n){n[n.Normal=1]="Normal",n[n.Underlined=2]="Underlined"})(ta||(ta={}));var ia;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.TEXTAREA=1]="TEXTAREA",n[n.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",n[n.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",n[n.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",n[n.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",n[n.CONTENT_TEXT=6]="CONTENT_TEXT",n[n.CONTENT_EMPTY=7]="CONTENT_EMPTY",n[n.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",n[n.CONTENT_WIDGET=9]="CONTENT_WIDGET",n[n.OVERVIEW_RULER=10]="OVERVIEW_RULER",n[n.SCROLLBAR=11]="SCROLLBAR",n[n.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",n[n.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(ia||(ia={}));var na;(function(n){n[n.AIGenerated=1]="AIGenerated"})(na||(na={}));var sa;(function(n){n[n.Invoke=0]="Invoke",n[n.Automatic=1]="Automatic"})(sa||(sa={}));var ra;(function(n){n[n.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",n[n.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",n[n.TOP_CENTER=2]="TOP_CENTER"})(ra||(ra={}));var oa;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(oa||(oa={}));var aa;(function(n){n[n.Word=0]="Word",n[n.Line=1]="Line",n[n.Suggest=2]="Suggest"})(aa||(aa={}));var la;(function(n){n[n.Left=0]="Left",n[n.Right=1]="Right",n[n.None=2]="None",n[n.LeftOfInjectedText=3]="LeftOfInjectedText",n[n.RightOfInjectedText=4]="RightOfInjectedText"})(la||(la={}));var ca;(function(n){n[n.Off=0]="Off",n[n.On=1]="On",n[n.Relative=2]="Relative",n[n.Interval=3]="Interval",n[n.Custom=4]="Custom"})(ca||(ca={}));var da;(function(n){n[n.None=0]="None",n[n.Text=1]="Text",n[n.Blocks=2]="Blocks"})(da||(da={}));var ha;(function(n){n[n.Smooth=0]="Smooth",n[n.Immediate=1]="Immediate"})(ha||(ha={}));var ua;(function(n){n[n.Auto=1]="Auto",n[n.Hidden=2]="Hidden",n[n.Visible=3]="Visible"})(ua||(ua={}));var fa;(function(n){n[n.LTR=0]="LTR",n[n.RTL=1]="RTL"})(fa||(fa={}));var ga;(function(n){n.Off="off",n.OnCode="onCode",n.On="on"})(ga||(ga={}));var ma;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(ma||(ma={}));var pa;(function(n){n[n.File=0]="File",n[n.Module=1]="Module",n[n.Namespace=2]="Namespace",n[n.Package=3]="Package",n[n.Class=4]="Class",n[n.Method=5]="Method",n[n.Property=6]="Property",n[n.Field=7]="Field",n[n.Constructor=8]="Constructor",n[n.Enum=9]="Enum",n[n.Interface=10]="Interface",n[n.Function=11]="Function",n[n.Variable=12]="Variable",n[n.Constant=13]="Constant",n[n.String=14]="String",n[n.Number=15]="Number",n[n.Boolean=16]="Boolean",n[n.Array=17]="Array",n[n.Object=18]="Object",n[n.Key=19]="Key",n[n.Null=20]="Null",n[n.EnumMember=21]="EnumMember",n[n.Struct=22]="Struct",n[n.Event=23]="Event",n[n.Operator=24]="Operator",n[n.TypeParameter=25]="TypeParameter"})(pa||(pa={}));var _a;(function(n){n[n.Deprecated=1]="Deprecated"})(_a||(_a={}));var ba;(function(n){n[n.Hidden=0]="Hidden",n[n.Blink=1]="Blink",n[n.Smooth=2]="Smooth",n[n.Phase=3]="Phase",n[n.Expand=4]="Expand",n[n.Solid=5]="Solid"})(ba||(ba={}));var va;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})(va||(va={}));var wa;(function(n){n[n.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",n[n.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",n[n.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",n[n.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(wa||(wa={}));var Sa;(function(n){n[n.None=0]="None",n[n.Same=1]="Same",n[n.Indent=2]="Indent",n[n.DeepIndent=3]="DeepIndent"})(Sa||(Sa={}));var bt;let bb=(bt=class{static chord(e,t){return Sm(e,t)}},bt.CtrlCmd=2048,bt.Shift=1024,bt.Alt=512,bt.WinCtrl=256,bt);function mf(){return{editor:void 0,languages:void 0,CancellationTokenSource:Fr,Emitter:R,KeyCode:Yo,KeyMod:bb,Position:K,Range:O,Selection:Fs,SelectionDirection:fa,MarkerSeverity:Qo,MarkerTag:Jo,Uri:Ae,Token:xs}}const kd="default",vb="$initialize";let Ed=!1;function Ca(n){Cm&&(Ed||(Ed=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(n.message))}class wb{constructor(e,t,i,s,r){this.vsWorker=e,this.req=t,this.channel=i,this.method=s,this.args=r,this.type=0}}class xd{constructor(e,t,i,s){this.vsWorker=e,this.seq=t,this.res=i,this.err=s,this.type=1}}class Sb{constructor(e,t,i,s,r){this.vsWorker=e,this.req=t,this.channel=i,this.eventName=s,this.arg=r,this.type=2}}class Cb{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class yb{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class Lb{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t,i){const s=String(++this._lastSentReq);return new Promise((r,o)=>{this._pendingReplies[s]={resolve:r,reject:o},this._send(new wb(this._workerId,s,e,t,i))})}listen(e,t,i){let s=null;const r=new R({onWillAddFirstListener:()=>{s=String(++this._lastSentReq),this._pendingEmitters.set(s,r),this._send(new Sb(this._workerId,s,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(s),this._send(new yb(this._workerId,s)),s=null}});return r.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}createProxyToRemoteChannel(e,t){const i={get:(s,r)=>(typeof r=="string"&&!s[r]&&(_f(r)?s[r]=o=>this.listen(e,r,o):pf(r)?s[r]=this.listen(e,r,void 0):r.charCodeAt(0)===36&&(s[r]=async(...o)=>(await(t==null?void 0:t()),this.sendMessage(e,r,o)))),s[r])};return new Proxy(Object.create(null),i)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(s=>{this._send(new xd(this._workerId,t,s,void 0))},s=>{s.detail instanceof Error&&(s.detail=td(s.detail)),this._send(new xd(this._workerId,t,void 0,td(s)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.channel,e.eventName,e.arg)(s=>{this._send(new Cb(this._workerId,t,s))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class kb extends D{constructor(e,t){super(),this._localChannels=new Map,this._worker=this._register(e.create({amdModuleId:"vs/base/common/worker/simpleWorker",esmModuleLocation:t.esmModuleLocation,label:t.label},r=>{this._protocol.handleMessage(r)},r=>{di(r)})),this._protocol=new Lb({sendMessage:(r,o)=>{this._worker.postMessage(r,o)},handleMessage:(r,o,a)=>this._handleMessage(r,o,a),handleEvent:(r,o,a)=>this._handleEvent(r,o,a)}),this._protocol.setWorkerId(this._worker.getId());let i=null;const s=globalThis.require;typeof s<"u"&&typeof s.getConfig=="function"?i=s.getConfig():typeof globalThis.requirejs<"u"&&(i=globalThis.requirejs.s.contexts._.config),this._onModuleLoaded=this._protocol.sendMessage(kd,vb,[this._worker.getId(),JSON.parse(JSON.stringify(i)),t.amdModuleId]),this.proxy=this._protocol.createProxyToRemoteChannel(kd,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(r=>{this._onError("Worker failed to load "+t.amdModuleId,r)})}_handleMessage(e,t,i){const s=this._localChannels.get(e);if(!s)return Promise.reject(new Error(`Missing channel ${e} on main thread`));if(typeof s[t]!="function")return Promise.reject(new Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(s[t].apply(s,i))}catch(r){return Promise.reject(r)}}_handleEvent(e,t,i){const s=this._localChannels.get(e);if(!s)throw new Error(`Missing channel ${e} on main thread`);if(_f(t)){const r=s[t].call(s,i);if(typeof r!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return r}if(pf(t)){const r=s[t];if(typeof r!="function")throw new Error(`Missing event ${t} on main thread channel ${e}.`);return r}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}_onError(e,t){console.error(e),console.info(t)}}function pf(n){return n[0]==="o"&&n[1]==="n"&&Iu(n.charCodeAt(2))}function _f(n){return/^onDynamic/.test(n)&&Iu(n.charCodeAt(9))}let Di;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?Di=globalThis.workerttPolicy:Di=Nr("defaultWorkerFactory",{createScriptURL:n=>n});function Eb(n,e){const t=globalThis.MonacoEnvironment;if(t){if(typeof t.getWorker=="function")return t.getWorker("workerMain.js",e);if(typeof t.getWorkerUrl=="function"){const i=t.getWorkerUrl("workerMain.js",e);return new Worker(Di?Di.createScriptURL(i):i,{name:e,type:"module"})}}if(n){const i=xb(e,n.toString(!0)),s=new Worker(Di?Di.createScriptURL(i):i,{name:e,type:"module"});return Ib(s)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function xb(n,e,t){if(!(/^((http:)|(https:)|(file:)|(vscode-file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const r=e.lastIndexOf("?"),o=e.lastIndexOf("#",r),a=r>0?new URLSearchParams(e.substring(r+1,~o?o:void 0)):new URLSearchParams;ym.addSearchParam(a,!0,!0),a.toString()?e=`${e}?${a.toString()}#${n}`:e=`${e}#${n}`}const s=new Blob([cc([`/*${n}*/`,void 0,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(Lm())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(km())};`,`globalThis._VSCODE_FILE_ROOT = '${globalThis._VSCODE_FILE_ROOT}';`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL('${e}') ?? '${e}');`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${n}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(s)}function Ib(n){return new Promise((e,t)=>{n.onmessage=function(i){i.data.type==="vscode-worker-ready"&&(n.onmessage=null,e(n))},n.onerror=t})}function Db(n){return typeof n.then=="function"}class Rb extends D{constructor(e,t,i,s,r,o){super(),this.id=i,this.label=s;const a=Eb(e,s);Db(a)?this.worker=a:this.worker=Promise.resolve(a),this.postMessage(t,[]),this.worker.then(l=>{l.onmessage=function(c){r(c.data)},l.onmessageerror=o,typeof l.addEventListener=="function"&&l.addEventListener("error",o)}),this._register(le(()=>{var l;(l=this.worker)==null||l.then(c=>{c.onmessage=null,c.onmessageerror=null,c.removeEventListener("error",o),c.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)==null||i.then(s=>{try{s.postMessage(e,t)}catch(r){di(r),di(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:r}))}})}}class Mb{constructor(e,t){this.amdModuleId=e,this.label=t,this.esmModuleLocation=Du.asBrowserUri(`${e}.esm.js`)}}const gr=class gr{constructor(){this._webWorkerFailedBeforeError=!1}create(e,t,i){const s=++gr.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new Rb(e.esmModuleLocation,e.amdModuleId,s,e.label||"anonymous"+s,t,r=>{Ca(r),this._webWorkerFailedBeforeError=r,i(r)})}};gr.LAST_WORKER_ID=0;let ya=gr;function Tb(n,e){const t=typeof n=="string"?new Mb(n,e):n;return new kb(new ya,t)}class Nb{constructor(e,t,i){const s=new Uint8Array(e*t);for(let r=0,o=e*t;r<o;r++)s[r]=i;this._data=s,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class Ab{constructor(e){let t=0,i=0;for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const s=new Nb(i,t,0);for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];s.set(a,l,c)}this._states=s,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let eo=null;function Ob(){return eo===null&&(eo=new Ab([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),eo}let on=null;function Pb(){if(on===null){on=new Em(0);const n=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<n.length;t++)on.set(n.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)on.set(e.charCodeAt(t),2)}return on}class Ws{static _createLink(e,t,i,s,r){let o=r-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>s);if(s>0){const a=t.charCodeAt(s-1),l=t.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:i,startColumn:s+1,endLineNumber:i,endColumn:o+2},url:t.substring(s,o+1)}}static computeLinks(e,t=Ob()){const i=Pb(),s=[];for(let r=1,o=e.getLineCount();r<=o;r++){const a=e.getLineContent(r),l=a.length;let c=0,d=0,h=0,u=1,f=!1,g=!1,p=!1,b=!1;for(;c<l;){let w=!1;const S=a.charCodeAt(c);if(u===13){let _;switch(S){case 40:f=!0,_=0;break;case 41:_=f?0:1;break;case 91:p=!0,g=!0,_=0;break;case 93:p=!1,_=g?0:1;break;case 123:b=!0,_=0;break;case 125:_=b?0:1;break;case 39:case 34:case 96:h===S?_=1:h===39||h===34||h===96?_=0:_=1;break;case 42:_=h===42?1:0;break;case 124:_=h===124?1:0;break;case 32:_=p?0:1;break;default:_=i.get(S)}_===1&&(s.push(Ws._createLink(i,a,r,d,c)),w=!0)}else if(u===12){let _;S===91?(g=!0,_=0):_=i.get(S),_===1?w=!0:u=13}else u=t.nextState(u,S),u===0&&(w=!0);w&&(u=1,f=!1,g=!1,b=!1,d=c+1,h=S),c++}u===13&&s.push(Ws._createLink(i,a,r,d,l))}return s}}function Fb(n){return!n||typeof n.getLineCount!="function"||typeof n.getLineContent!="function"?[]:Ws.computeLinks(n)}const mr=class mr{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,s,r){if(e&&t){const o=this.doNavigateValueSet(t,r);if(o)return{range:e,value:o}}if(i&&s){const o=this.doNavigateValueSet(s,r);if(o)return{range:i,value:o}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let s=Number(e);const r=parseFloat(e);return!isNaN(s)&&!isNaN(r)&&s===r?s===0&&!t?null:(s=Math.floor(s*i),s+=t?i:-i,String(s/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let s=null;for(let r=0,o=e.length;s===null&&r<o;r++)s=this.valueSetReplace(e[r],t,i);return s}valueSetReplace(e,t,i){let s=e.indexOf(t);return s>=0?(s+=i?1:-1,s<0?s=e.length-1:s%=e.length,e[s]):null}};mr.INSTANCE=new mr;let La=mr;const xn=class xn{static getChannel(e){return e.getChannel(xn.CHANNEL_NAME)}static setChannel(e,t){e.setChannel(xn.CHANNEL_NAME,t)}};xn.CHANNEL_NAME="editorWorkerHost";let ka=xn;class Bb{static computeUnicodeHighlights(e,t,i){const s=i?i.startLineNumber:1,r=i?i.endLineNumber:e.getLineCount(),o=new Id(t),a=o.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${Wb(Array.from(a))}`,"g");const c=new Pp(null,l),d=[];let h=!1,u,f=0,g=0,p=0;e:for(let b=s,w=r;b<=w;b++){const S=e.getLineContent(b),_=S.length;c.reset(0);do if(u=c.next(S),u){let m=u.index,v=u.index+u[0].length;if(m>0){const E=S.charCodeAt(m-1);id(E)&&m--}if(v+1<_){const E=S.charCodeAt(v-1);id(E)&&v++}const y=S.substring(m,v);let L=bu(m+1,pg,S,0);L&&L.endColumn<=m+1&&(L=null);const k=o.shouldHighlightNonBasicASCII(y,L?L.word:null);if(k!==0){if(k===3?f++:k===2?g++:k===1?p++:xm(),d.length>=1e3){h=!0;break e}d.push(new O(b,m+1,b,v+1))}}while(u)}return{ranges:d,hasMore:h,ambiguousCharacterCount:f,invisibleCharacterCount:g,nonBasicAsciiCharacterCount:p}}static computeUnicodeHighlightReason(e,t){const i=new Id(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const r=e.codePointAt(0),o=i.ambiguousCharacters.getPrimaryConfusable(r),a=yo.getLocales().filter(l=>!yo.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(r));return{kind:0,confusableWith:String.fromCodePoint(o),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function Wb(n,e){return`[${Lo(n.map(i=>String.fromCodePoint(i)).join(""))}]`}class Id{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=yo.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of Yr.codePoints)Dd(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let s=!1,r=!1;if(t)for(const o of t){const a=o.codePointAt(0),l=Im(o);s=s||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!Yr.isInvisibleCharacter(a)&&(r=!0)}return!s&&r?0:this.options.invisibleCharacters&&!Dd(e)&&Yr.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function Dd(n){return n===" "||n===`
`||n==="	"}class ws{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class bf{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class Hb{constructor(e){this.text=e,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new q(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}get textLength(){const e=this.lineStartOffsetByLineIdx.length-1;return new Wn(e,this.text.length-this.lineStartOffsetByLineIdx[e])}}class Vb{constructor(e){this.edits=e,On(()=>dc(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}apply(e){let t="",i=new K(1,1);for(const r of this.edits){const o=r.range,a=o.getStartPosition(),l=o.getEndPosition(),c=Rd(i,a);c.isEmpty()||(t+=e.getValueOfRange(c)),t+=r.text,i=l}const s=Rd(i,e.endPositionExclusive);return s.isEmpty()||(t+=e.getValueOfRange(s)),t}applyToString(e){const t=new $b(e);return this.apply(t)}getNewRanges(){const e=[];let t=0,i=0,s=0;for(const r of this.edits){const o=Wn.ofText(r.text),a=K.lift({lineNumber:r.range.startLineNumber+i,column:r.range.startColumn+(r.range.startLineNumber===t?s:0)}),l=o.createRange(a);e.push(l),i=l.endLineNumber-r.range.endLineNumber,s=l.endColumn-r.range.endColumn,t=r.range.endLineNumber}return e}}class Ub{constructor(e,t){this.range=e,this.text=t}toSingleEditOperation(){return{range:this.range,text:this.text}}}function Rd(n,e){if(n.lineNumber===e.lineNumber&&n.column===Number.MAX_SAFE_INTEGER)return O.fromPositions(e,e);if(!n.isBeforeOrEqual(e))throw new Wt("start must be before end");return new O(n.lineNumber,n.column,e.lineNumber,e.column)}class vf{get endPositionExclusive(){return this.length.addToPosition(new K(1,1))}}class $b extends vf{constructor(e){super(),this.value=e,this._t=new Hb(this.value)}getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}}class ve{static inverse(e,t,i){const s=[];let r=1,o=1;for(const l of e){const c=new ve(new A(r,l.original.startLineNumber),new A(o,l.modified.startLineNumber));c.modified.isEmpty||s.push(c),r=l.original.endLineNumberExclusive,o=l.modified.endLineNumberExclusive}const a=new ve(new A(r,t+1),new A(o,i+1));return a.modified.isEmpty||s.push(a),s}static clip(e,t,i){const s=[];for(const r of e){const o=r.original.intersect(t),a=r.modified.intersect(i);o&&!o.isEmpty&&a&&!a.isEmpty&&s.push(new ve(o,a))}return s}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new ve(this.modified,this.original)}join(e){return new ve(this.original.join(e.original),this.modified.join(e.modified))}toRangeMapping(){const e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new We(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new Wt("not a valid diff");return new We(new O(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new O(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new We(new O(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new O(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(Md(this.original.endLineNumberExclusive,e)&&Md(this.modified.endLineNumberExclusive,t))return new We(new O(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new O(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new We(O.fromPositions(new K(this.original.startLineNumber,1),yi(new K(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),O.fromPositions(new K(this.modified.startLineNumber,1),yi(new K(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new We(O.fromPositions(yi(new K(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),yi(new K(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),O.fromPositions(yi(new K(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),yi(new K(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new Wt}}function yi(n,e){if(n.lineNumber<1)return new K(1,1);if(n.lineNumber>e.length)return new K(e.length,e[e.length-1].length+1);const t=e[n.lineNumber-1];return n.column>t.length+1?new K(n.lineNumber,t.length+1):n}function Md(n,e){return n>=1&&n<=e.length}class Ve extends ve{static fromRangeMappings(e){const t=A.join(e.map(s=>A.fromRangeInclusive(s.originalRange))),i=A.join(e.map(s=>A.fromRangeInclusive(s.modifiedRange)));return new Ve(t,i,e)}constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){var e;return new Ve(this.modified,this.original,(e=this.innerChanges)==null?void 0:e.map(t=>t.flip()))}withInnerChangesFromLineRanges(){return new Ve(this.original,this.modified,[this.toRangeMapping()])}}class We{static assertSorted(e){for(let t=1;t<e.length;t++){const i=e[t-1],s=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(s.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(s.modifiedRange.getStartPosition())))throw new Wt("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new We(this.modifiedRange,this.originalRange)}toTextEdit(e){const t=e.getValueOfRange(this.modifiedRange);return new Ub(this.originalRange,t)}}const qb=3;class zb{computeDiff(e,t,i){var l;const r=new Zb(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),o=[];let a=null;for(const c of r.changes){let d;c.originalEndLineNumber===0?d=new A(c.originalStartLineNumber+1,c.originalStartLineNumber+1):d=new A(c.originalStartLineNumber,c.originalEndLineNumber+1);let h;c.modifiedEndLineNumber===0?h=new A(c.modifiedStartLineNumber+1,c.modifiedStartLineNumber+1):h=new A(c.modifiedStartLineNumber,c.modifiedEndLineNumber+1);let u=new Ve(d,h,(l=c.charChanges)==null?void 0:l.map(f=>new We(new O(f.originalStartLineNumber,f.originalStartColumn,f.originalEndLineNumber,f.originalEndColumn),new O(f.modifiedStartLineNumber,f.modifiedStartColumn,f.modifiedEndLineNumber,f.modifiedEndColumn))));a&&(a.modified.endLineNumberExclusive===u.modified.startLineNumber||a.original.endLineNumberExclusive===u.original.startLineNumber)&&(u=new Ve(a.original.join(u.original),a.modified.join(u.modified),a.innerChanges&&u.innerChanges?a.innerChanges.concat(u.innerChanges):void 0),o.pop()),o.push(u),a=u}return On(()=>dc(o,(c,d)=>d.original.startLineNumber-c.original.endLineNumberExclusive===d.modified.startLineNumber-c.modified.endLineNumberExclusive&&c.original.endLineNumberExclusive<d.original.startLineNumber&&c.modified.endLineNumberExclusive<d.modified.startLineNumber)),new ws(o,[],r.quitEarly)}}function wf(n,e,t,i){return new K_(n,e,t).ComputeDiff(i)}let Td=class{constructor(e){const t=[],i=[];for(let s=0,r=e.length;s<r;s++)t[s]=Ea(e[s],1),i[s]=xa(e[s],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const s=[],r=[],o=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],d=e?this._startColumns[l]:1,h=e?this._endColumns[l]:c.length+1;for(let u=d;u<h;u++)s[a]=c.charCodeAt(u-1),r[a]=l+1,o[a]=u,a++;!e&&l<i&&(s[a]=10,r[a]=l+1,o[a]=c.length+1,a++)}return new jb(s,r,o)}};class jb{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class Bi{constructor(e,t,i,s,r,o,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=s,this.modifiedStartLineNumber=r,this.modifiedStartColumn=o,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const s=t.getStartLineNumber(e.originalStart),r=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),d=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),h=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new Bi(s,r,o,a,l,c,d,h)}}function Gb(n){if(n.length<=1)return n;const e=[n[0]];let t=e[0];for(let i=1,s=n.length;i<s;i++){const r=n[i],o=r.originalStart-(t.originalStart+t.originalLength),a=r.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(o,a)<qb?(t.originalLength=r.originalStart+r.originalLength-t.originalStart,t.modifiedLength=r.modifiedStart+r.modifiedLength-t.modifiedStart):(e.push(r),t=r)}return e}class wn{constructor(e,t,i,s,r){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=s,this.charChanges=r}static createFromDiffResult(e,t,i,s,r,o,a){let l,c,d,h,u;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(d=s.getStartLineNumber(t.modifiedStart)-1,h=0):(d=s.getStartLineNumber(t.modifiedStart),h=s.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&r()){const f=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),g=s.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(f.getElements().length>0&&g.getElements().length>0){let p=wf(f,g,r,!0).changes;a&&(p=Gb(p)),u=[];for(let b=0,w=p.length;b<w;b++)u.push(Bi.createFromDiffChange(p[b],f,g))}}return new wn(l,c,d,h,u)}}class Zb{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new Td(e),this.modified=new Td(t),this.continueLineDiff=Nd(i.maxComputationTime),this.continueCharDiff=Nd(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=wf(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(wn.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const s=[];let r=0,o=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,d=c?c.originalStart:this.originalLines.length,h=c?c.modifiedStart:this.modifiedLines.length;for(;r<d&&o<h;){const u=this.originalLines[r],f=this.modifiedLines[o];if(u!==f){{let g=Ea(u,1),p=Ea(f,1);for(;g>1&&p>1;){const b=u.charCodeAt(g-2),w=f.charCodeAt(p-2);if(b!==w)break;g--,p--}(g>1||p>1)&&this._pushTrimWhitespaceCharChange(s,r+1,1,g,o+1,1,p)}{let g=xa(u,1),p=xa(f,1);const b=u.length+1,w=f.length+1;for(;g<b&&p<w;){const S=u.charCodeAt(g-1),_=u.charCodeAt(p-1);if(S!==_)break;g++,p++}(g<b||p<w)&&this._pushTrimWhitespaceCharChange(s,r+1,g,b,o+1,p,w)}}r++,o++}c&&(s.push(wn.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),r+=c.originalLength,o+=c.modifiedLength)}return{quitEarly:i,changes:s}}_pushTrimWhitespaceCharChange(e,t,i,s,r,o,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,s,r,o,a))return;let l;this.shouldComputeCharChanges&&(l=[new Bi(t,i,t,s,r,o,r,a)]),e.push(new wn(t,t,r,r,l))}_mergeTrimWhitespaceCharChange(e,t,i,s,r,o,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===r?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Bi(t,i,t,s,r,o,r,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===r?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=r,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Bi(t,i,t,s,r,o,r,a)),!0):!1}}function Ea(n,e){const t=Dm(n);return t===-1?e:t+1}function xa(n,e){const t=Rm(n);return t===-1?e:t+2}function Nd(n){if(n===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<n}class wt{static trivial(e,t){return new wt([new ce(q.ofLength(e.length),q.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new wt([new ce(q.ofLength(e.length),q.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class ce{static invert(e,t){const i=[];return Ru(e,(s,r)=>{i.push(ce.fromOffsetPairs(s?s.getEndExclusives():_t.zero,r?r.getStarts():new _t(t,(s?s.seq2Range.endExclusive-s.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new ce(new q(e.offset1,t.offset1),new q(e.offset2,t.offset2))}static assertSorted(e){let t;for(const i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new Wt("Sequence diffs must be sorted");t=i}}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new ce(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new ce(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new ce(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new ce(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new ce(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new ce(t,i)}getStarts(){return new _t(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new _t(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}const Jt=class Jt{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new Jt(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}};Jt.zero=new Jt(0,0),Jt.max=new Jt(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);let _t=Jt;const pr=class pr{isValid(){return!0}};pr.instance=new pr;let Vn=pr;class Kb{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new Wt("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class to{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function Ia(n){return n===32||n===9}const In=class In{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let s=0;for(let r=e.startLineNumber-1;r<e.endLineNumberExclusive-1;r++){const o=t[r];for(let l=0;l<o.length;l++){s++;const c=o[l],d=In.getKey(c);this.histogram[d]=(this.histogram[d]||0)+1}s++;const a=In.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=s}computeSimilarity(e){let t=0;const i=Math.max(this.histogram.length,e.histogram.length);for(let s=0;s<i;s++)t+=Math.abs((this.histogram[s]??0)-(e.histogram[s]??0));return 1-t/(this.totalCount+e.totalCount)}};In.chrKeys=new Map;let Hs=In;class Xb{compute(e,t,i=Vn.instance,s){if(e.length===0||t.length===0)return wt.trivial(e,t);const r=new to(e.length,t.length),o=new to(e.length,t.length),a=new to(e.length,t.length);for(let g=0;g<e.length;g++)for(let p=0;p<t.length;p++){if(!i.isValid())return wt.trivialTimedOut(e,t);const b=g===0?0:r.get(g-1,p),w=p===0?0:r.get(g,p-1);let S;e.getElement(g)===t.getElement(p)?(g===0||p===0?S=0:S=r.get(g-1,p-1),g>0&&p>0&&o.get(g-1,p-1)===3&&(S+=a.get(g-1,p-1)),S+=s?s(g,p):1):S=-1;const _=Math.max(b,w,S);if(_===S){const m=g>0&&p>0?a.get(g-1,p-1):0;a.set(g,p,m+1),o.set(g,p,3)}else _===b?(a.set(g,p,0),o.set(g,p,1)):_===w&&(a.set(g,p,0),o.set(g,p,2));r.set(g,p,_)}const l=[];let c=e.length,d=t.length;function h(g,p){(g+1!==c||p+1!==d)&&l.push(new ce(new q(g+1,c),new q(p+1,d))),c=g,d=p}let u=e.length-1,f=t.length-1;for(;u>=0&&f>=0;)o.get(u,f)===3?(h(u,f),u--,f--):o.get(u,f)===1?u--:f--;return h(-1,-1),l.reverse(),new wt(l,!1)}}class Sf{compute(e,t,i=Vn.instance){if(e.length===0||t.length===0)return wt.trivial(e,t);const s=e,r=t;function o(p,b){for(;p<s.length&&b<r.length&&s.getElement(p)===r.getElement(b);)p++,b++;return p}let a=0;const l=new Yb;l.set(0,o(0,0));const c=new Qb;c.set(0,l.get(0)===0?null:new Ad(null,0,0,l.get(0)));let d=0;e:for(;;){if(a++,!i.isValid())return wt.trivialTimedOut(s,r);const p=-Math.min(a,r.length+a%2),b=Math.min(a,s.length+a%2);for(d=p;d<=b;d+=2){const w=d===b?-1:l.get(d+1),S=d===p?-1:l.get(d-1)+1,_=Math.min(Math.max(w,S),s.length),m=_-d;if(_>s.length||m>r.length)continue;const v=o(_,m);l.set(d,v);const y=_===w?c.get(d+1):c.get(d-1);if(c.set(d,v!==_?new Ad(y,_,m,v-_):y),l.get(d)===s.length&&l.get(d)-d===r.length)break e}}let h=c.get(d);const u=[];let f=s.length,g=r.length;for(;;){const p=h?h.x+h.length:0,b=h?h.y+h.length:0;if((p!==f||b!==g)&&u.push(new ce(new q(p,f),new q(b,g))),!h)break;f=h.x,g=h.y,h=h.prev}return u.reverse(),new wt(u,!1)}}class Ad{constructor(e,t,i,s){this.prev=e,this.x=t,this.y=i,this.length=s}}class Yb{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class Qb{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}class Vs{constructor(e,t,i){this.lines=e,this.range=t,this.considerWhitespaceChanges=i,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let s=this.range.startLineNumber;s<=this.range.endLineNumber;s++){let r=e[s-1],o=0;s===this.range.startLineNumber&&this.range.startColumn>1&&(o=this.range.startColumn-1,r=r.substring(o)),this.lineStartOffsets.push(o);let a=0;if(!i){const c=r.trimStart();a=r.length-c.length,r=c.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);const l=s===this.range.endLineNumber?Math.min(this.range.endColumn-1-o-a,r.length):r.length;for(let c=0;c<l;c++)this.elements.push(r.charCodeAt(c));s<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new q(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=Pd(e>0?this.elements[e-1]:-1),i=Pd(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let s=0;return t!==i&&(s+=10,t===0&&i===1&&(s+=1)),s+=Od(t),s+=Od(i),s}translateOffset(e,t="right"){const i=Fp(this.firstElementOffsetByLineIdx,r=>r<=e),s=e-this.firstElementOffsetByLineIdx[i];return new K(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+s+(s===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){const t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?O.fromPositions(i,i):O.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!io(this.elements[e]))return;let t=e;for(;t>0&&io(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&io(this.elements[i]);)i++;return new q(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){const t=Bs(this.firstElementOffsetByLineIdx,s=>s<=e.start)??0,i=Bp(this.firstElementOffsetByLineIdx,s=>e.endExclusive<=s)??this.elements.length;return new q(t,i)}}function io(n){return n>=97&&n<=122||n>=65&&n<=90||n>=48&&n<=57}const Jb={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function Od(n){return Jb[n]}function Pd(n){return n===10?8:n===13?7:Ia(n)?6:n>=97&&n<=122?0:n>=65&&n<=90?1:n>=48&&n<=57?2:n===-1?3:n===44||n===59?5:4}function ev(n,e,t,i,s,r){let{moves:o,excludedChanges:a}=iv(n,e,t,r);if(!r.isValid())return[];const l=n.filter(d=>!a.has(d)),c=nv(l,i,s,e,t,r);return Mm(o,c),o=sv(o),o=o.filter(d=>{const h=d.original.toOffsetRange().slice(e).map(f=>f.trim());return h.join(`
`).length>=15&&tv(h,f=>f.length>=2)>=2}),o=rv(n,o),o}function tv(n,e){let t=0;for(const i of n)e(i)&&t++;return t}function iv(n,e,t,i){const s=[],r=n.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new Hs(l.original,e,l)),o=new Set(n.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new Hs(l.modified,t,l))),a=new Set;for(const l of r){let c=-1,d;for(const h of o){const u=l.computeSimilarity(h);u>c&&(c=u,d=h)}if(c>.9&&d&&(o.delete(d),s.push(new ve(l.range,d.range)),a.add(l.source),a.add(d.source)),!i.isValid())return{moves:s,excludedChanges:a}}return{moves:s,excludedChanges:a}}function nv(n,e,t,i,s,r){const o=[],a=new _g;for(const u of n)for(let f=u.original.startLineNumber;f<u.original.endLineNumberExclusive-2;f++){const g=`${e[f-1]}:${e[f+1-1]}:${e[f+2-1]}`;a.add(g,{range:new A(f,f+3)})}const l=[];n.sort(Ot(u=>u.modified.startLineNumber,ti));for(const u of n){let f=[];for(let g=u.modified.startLineNumber;g<u.modified.endLineNumberExclusive-2;g++){const p=`${t[g-1]}:${t[g+1-1]}:${t[g+2-1]}`,b=new A(g,g+3),w=[];a.forEach(p,({range:S})=>{for(const m of f)if(m.originalLineRange.endLineNumberExclusive+1===S.endLineNumberExclusive&&m.modifiedLineRange.endLineNumberExclusive+1===b.endLineNumberExclusive){m.originalLineRange=new A(m.originalLineRange.startLineNumber,S.endLineNumberExclusive),m.modifiedLineRange=new A(m.modifiedLineRange.startLineNumber,b.endLineNumberExclusive),w.push(m);return}const _={modifiedLineRange:b,originalLineRange:S};l.push(_),w.push(_)}),f=w}if(!r.isValid())return[]}l.sort(Tm(Ot(u=>u.modifiedLineRange.length,ti)));const c=new Hn,d=new Hn;for(const u of l){const f=u.modifiedLineRange.startLineNumber-u.originalLineRange.startLineNumber,g=c.subtractFrom(u.modifiedLineRange),p=d.subtractFrom(u.originalLineRange).getWithDelta(f),b=g.getIntersection(p);for(const w of b.ranges){if(w.length<3)continue;const S=w,_=w.delta(-f);o.push(new ve(_,S)),c.addRange(S),d.addRange(_)}}o.sort(Ot(u=>u.original.startLineNumber,ti));const h=new rf(n);for(let u=0;u<o.length;u++){const f=o[u],g=h.findLastMonotonous(y=>y.original.startLineNumber<=f.original.startLineNumber),p=Bs(n,y=>y.modified.startLineNumber<=f.modified.startLineNumber),b=Math.max(f.original.startLineNumber-g.original.startLineNumber,f.modified.startLineNumber-p.modified.startLineNumber),w=h.findLastMonotonous(y=>y.original.startLineNumber<f.original.endLineNumberExclusive),S=Bs(n,y=>y.modified.startLineNumber<f.modified.endLineNumberExclusive),_=Math.max(w.original.endLineNumberExclusive-f.original.endLineNumberExclusive,S.modified.endLineNumberExclusive-f.modified.endLineNumberExclusive);let m;for(m=0;m<b;m++){const y=f.original.startLineNumber-m-1,L=f.modified.startLineNumber-m-1;if(y>i.length||L>s.length||c.contains(L)||d.contains(y)||!Fd(i[y-1],s[L-1],r))break}m>0&&(d.addRange(new A(f.original.startLineNumber-m,f.original.startLineNumber)),c.addRange(new A(f.modified.startLineNumber-m,f.modified.startLineNumber)));let v;for(v=0;v<_;v++){const y=f.original.endLineNumberExclusive+v,L=f.modified.endLineNumberExclusive+v;if(y>i.length||L>s.length||c.contains(L)||d.contains(y)||!Fd(i[y-1],s[L-1],r))break}v>0&&(d.addRange(new A(f.original.endLineNumberExclusive,f.original.endLineNumberExclusive+v)),c.addRange(new A(f.modified.endLineNumberExclusive,f.modified.endLineNumberExclusive+v))),(m>0||v>0)&&(o[u]=new ve(new A(f.original.startLineNumber-m,f.original.endLineNumberExclusive+v),new A(f.modified.startLineNumber-m,f.modified.endLineNumberExclusive+v)))}return o}function Fd(n,e,t){if(n.trim()===e.trim())return!0;if(n.length>300&&e.length>300)return!1;const s=new Sf().compute(new Vs([n],new O(1,1,1,n.length),!1),new Vs([e],new O(1,1,1,e.length),!1),t);let r=0;const o=ce.invert(s.diffs,n.length);for(const d of o)d.seq1Range.forEach(h=>{Ia(n.charCodeAt(h))||r++});function a(d){let h=0;for(let u=0;u<n.length;u++)Ia(d.charCodeAt(u))||h++;return h}const l=a(n.length>e.length?n:e);return r/l>.6&&l>10}function sv(n){if(n.length===0)return n;n.sort(Ot(t=>t.original.startLineNumber,ti));const e=[n[0]];for(let t=1;t<n.length;t++){const i=e[e.length-1],s=n[t],r=s.original.startLineNumber-i.original.endLineNumberExclusive,o=s.modified.startLineNumber-i.modified.endLineNumberExclusive;if(r>=0&&o>=0&&r+o<=2){e[e.length-1]=i.join(s);continue}e.push(s)}return e}function rv(n,e){const t=new rf(n);return e=e.filter(i=>{const s=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new ve(new A(1,1),new A(1,1)),r=Bs(n,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return s!==r}),e}function Da(n,e,t){let i=t;return i=Bd(n,e,i),i=Bd(n,e,i),i=ov(n,e,i),i}function Bd(n,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let r=1;r<t.length;r++){const o=i[i.length-1];let a=t[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-o.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(n.getElement(a.seq1Range.start-c)!==n.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new ce(new q(o.seq1Range.start,a.seq1Range.endExclusive-l),new q(o.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const s=[];for(let r=0;r<i.length-1;r++){const o=i[r+1];let a=i[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=o.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!n.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[r+1]=new ce(new q(a.seq1Range.start+l,o.seq1Range.endExclusive),new q(a.seq2Range.start+l,o.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}s.push(a)}return i.length>0&&s.push(i[i.length-1]),s}function ov(n,e,t){if(!n.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const s=i>0?t[i-1]:void 0,r=t[i],o=i+1<t.length?t[i+1]:void 0,a=new q(s?s.seq1Range.endExclusive+1:0,o?o.seq1Range.start-1:n.length),l=new q(s?s.seq2Range.endExclusive+1:0,o?o.seq2Range.start-1:e.length);r.seq1Range.isEmpty?t[i]=Wd(r,n,e,a,l):r.seq2Range.isEmpty&&(t[i]=Wd(r.swap(),e,n,l,a).swap())}return t}function Wd(n,e,t,i,s){let o=1;for(;n.seq1Range.start-o>=i.start&&n.seq2Range.start-o>=s.start&&t.isStronglyEqual(n.seq2Range.start-o,n.seq2Range.endExclusive-o)&&o<100;)o++;o--;let a=0;for(;n.seq1Range.start+a<i.endExclusive&&n.seq2Range.endExclusive+a<s.endExclusive&&t.isStronglyEqual(n.seq2Range.start+a,n.seq2Range.endExclusive+a)&&a<100;)a++;if(o===0&&a===0)return n;let l=0,c=-1;for(let d=-o;d<=a;d++){const h=n.seq2Range.start+d,u=n.seq2Range.endExclusive+d,f=n.seq1Range.start+d,g=e.getBoundaryScore(f)+t.getBoundaryScore(h)+t.getBoundaryScore(u);g>c&&(c=g,l=d)}return n.delta(l)}function av(n,e,t){const i=[];for(const s of t){const r=i[i.length-1];if(!r){i.push(s);continue}s.seq1Range.start-r.seq1Range.endExclusive<=2||s.seq2Range.start-r.seq2Range.endExclusive<=2?i[i.length-1]=new ce(r.seq1Range.join(s.seq1Range),r.seq2Range.join(s.seq2Range)):i.push(s)}return i}function lv(n,e,t){const i=ce.invert(t,n.length),s=[];let r=new _t(0,0);function o(l,c){if(l.offset1<r.offset1||l.offset2<r.offset2)return;const d=n.findWordContaining(l.offset1),h=e.findWordContaining(l.offset2);if(!d||!h)return;let u=new ce(d,h);const f=u.intersect(c);let g=f.seq1Range.length,p=f.seq2Range.length;for(;i.length>0;){const b=i[0];if(!(b.seq1Range.intersects(u.seq1Range)||b.seq2Range.intersects(u.seq2Range)))break;const S=n.findWordContaining(b.seq1Range.start),_=e.findWordContaining(b.seq2Range.start),m=new ce(S,_),v=m.intersect(b);if(g+=v.seq1Range.length,p+=v.seq2Range.length,u=u.join(m),u.seq1Range.endExclusive>=b.seq1Range.endExclusive)i.shift();else break}g+p<(u.seq1Range.length+u.seq2Range.length)*2/3&&s.push(u),r=u.getEndExclusives()}for(;i.length>0;){const l=i.shift();l.seq1Range.isEmpty||(o(l.getStarts(),l),o(l.getEndExclusives().delta(-1),l))}return cv(t,s)}function cv(n,e){const t=[];for(;n.length>0||e.length>0;){const i=n[0],s=e[0];let r;i&&(!s||i.seq1Range.start<s.seq1Range.start)?r=n.shift():r=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=r.seq1Range.start?t[t.length-1]=t[t.length-1].join(r):t.push(r)}return t}function dv(n,e,t){let i=t;if(i.length===0)return i;let s=0,r;do{r=!1;const o=[i[0]];for(let a=1;a<i.length;a++){let d=function(u,f){const g=new q(c.seq1Range.endExclusive,l.seq1Range.start);return n.getText(g).replace(/\s/g,"").length<=4&&(u.seq1Range.length+u.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};const l=i[a],c=o[o.length-1];d(c,l)?(r=!0,o[o.length-1]=o[o.length-1].join(l)):o.push(l)}i=o}while(s++<10&&r);return i}function hv(n,e,t){let i=t;if(i.length===0)return i;let s=0,r;do{r=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let h=function(f,g){const p=new q(d.seq1Range.endExclusive,c.seq1Range.start);if(n.countLinesIn(p)>5||p.length>500)return!1;const w=n.getText(p).trim();if(w.length>20||w.split(/\r\n|\r|\n/).length>1)return!1;const S=n.countLinesIn(f.seq1Range),_=f.seq1Range.length,m=e.countLinesIn(f.seq2Range),v=f.seq2Range.length,y=n.countLinesIn(g.seq1Range),L=g.seq1Range.length,k=e.countLinesIn(g.seq2Range),E=g.seq2Range.length,W=2*40+50;function H(B){return Math.min(B,W)}return Math.pow(Math.pow(H(S*40+_),1.5)+Math.pow(H(m*40+v),1.5),1.5)+Math.pow(Math.pow(H(y*40+L),1.5)+Math.pow(H(k*40+E),1.5),1.5)>(W**1.5)**1.5*1.3};const c=i[l],d=a[a.length-1];h(d,c)?(r=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(s++<10&&r);const o=[];return Nm(i,(a,l,c)=>{let d=l;function h(w){return w.length>0&&w.trim().length<=3&&l.seq1Range.length+l.seq2Range.length>100}const u=n.extendToFullLines(l.seq1Range),f=n.getText(new q(u.start,l.seq1Range.start));h(f)&&(d=d.deltaStart(-f.length));const g=n.getText(new q(l.seq1Range.endExclusive,u.endExclusive));h(g)&&(d=d.deltaEnd(g.length));const p=ce.fromOffsetPairs(a?a.getEndExclusives():_t.zero,c?c.getStarts():_t.max),b=d.intersect(p);o.length>0&&b.getStarts().equals(o[o.length-1].getEndExclusives())?o[o.length-1]=o[o.length-1].join(b):o.push(b)}),o}class Hd{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:Vd(this.lines[e-1]),i=e===this.lines.length?0:Vd(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function Vd(n){let e=0;for(;e<n.length&&(n.charCodeAt(e)===32||n.charCodeAt(e)===9);)e++;return e}class Cf{constructor(){this.dynamicProgrammingDiffing=new Xb,this.myersDiffingAlgorithm=new Sf}computeDiff(e,t,i){if(e.length<=1&&Pt(e,t,(v,y)=>v===y))return new ws([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new ws([new Ve(new A(1,e.length+1),new A(1,t.length+1),[new We(new O(1,1,e.length,e[e.length-1].length+1),new O(1,1,t.length,t[t.length-1].length+1))])],[],!1);const s=i.maxComputationTimeMs===0?Vn.instance:new Kb(i.maxComputationTimeMs),r=!i.ignoreTrimWhitespace,o=new Map;function a(v){let y=o.get(v);return y===void 0&&(y=o.size,o.set(v,y)),y}const l=e.map(v=>a(v.trim())),c=t.map(v=>a(v.trim())),d=new Hd(l,e),h=new Hd(c,t),u=d.length+h.length<1700?this.dynamicProgrammingDiffing.compute(d,h,s,(v,y)=>e[v]===t[y]?t[y].length===0?.1:1+Math.log(1+t[y].length):.99):this.myersDiffingAlgorithm.compute(d,h,s);let f=u.diffs,g=u.hitTimeout;f=Da(d,h,f),f=dv(d,h,f);const p=[],b=v=>{if(r)for(let y=0;y<v;y++){const L=w+y,k=S+y;if(e[L]!==t[k]){const E=this.refineDiff(e,t,new ce(new q(L,L+1),new q(k,k+1)),s,r);for(const W of E.mappings)p.push(W);E.hitTimeout&&(g=!0)}}};let w=0,S=0;for(const v of f){On(()=>v.seq1Range.start-w===v.seq2Range.start-S);const y=v.seq1Range.start-w;b(y),w=v.seq1Range.endExclusive,S=v.seq2Range.endExclusive;const L=this.refineDiff(e,t,v,s,r);L.hitTimeout&&(g=!0);for(const k of L.mappings)p.push(k)}b(e.length-w);const _=Ud(p,e,t);let m=[];return i.computeMoves&&(m=this.computeMoves(_,e,t,l,c,s,r)),On(()=>{function v(L,k){if(L.lineNumber<1||L.lineNumber>k.length)return!1;const E=k[L.lineNumber-1];return!(L.column<1||L.column>E.length+1)}function y(L,k){return!(L.startLineNumber<1||L.startLineNumber>k.length+1||L.endLineNumberExclusive<1||L.endLineNumberExclusive>k.length+1)}for(const L of _){if(!L.innerChanges)return!1;for(const k of L.innerChanges)if(!(v(k.modifiedRange.getStartPosition(),t)&&v(k.modifiedRange.getEndPosition(),t)&&v(k.originalRange.getStartPosition(),e)&&v(k.originalRange.getEndPosition(),e)))return!1;if(!y(L.modified,t)||!y(L.original,e))return!1}return!0}),new ws(_,m,g)}computeMoves(e,t,i,s,r,o,a){return ev(e,t,i,s,r,o).map(d=>{const h=this.refineDiff(t,i,new ce(d.original.toOffsetRange(),d.modified.toOffsetRange()),o,a),u=Ud(h.mappings,t,i,!0);return new bf(d,u)})}refineDiff(e,t,i,s,r){const a=fv(i).toRangeMapping2(e,t),l=new Vs(e,a.originalRange,r),c=new Vs(t,a.modifiedRange,r),d=l.length+c.length<500?this.dynamicProgrammingDiffing.compute(l,c,s):this.myersDiffingAlgorithm.compute(l,c,s);let h=d.diffs;return h=Da(l,c,h),h=lv(l,c,h),h=av(l,c,h),h=hv(l,c,h),{mappings:h.map(f=>new We(l.translateRange(f.seq1Range),c.translateRange(f.seq2Range))),hitTimeout:d.hitTimeout}}}function Ud(n,e,t,i=!1){const s=[];for(const r of hc(n.map(o=>uv(o,e,t)),(o,a)=>o.original.overlapOrTouch(a.original)||o.modified.overlapOrTouch(a.modified))){const o=r[0],a=r[r.length-1];s.push(new Ve(o.original.join(a.original),o.modified.join(a.modified),r.map(l=>l.innerChanges[0])))}return On(()=>!i&&s.length>0&&(s[0].modified.startLineNumber!==s[0].original.startLineNumber||t.length-s[s.length-1].modified.endLineNumberExclusive!==e.length-s[s.length-1].original.endLineNumberExclusive)?!1:dc(s,(r,o)=>o.original.startLineNumber-r.original.endLineNumberExclusive===o.modified.startLineNumber-r.modified.endLineNumberExclusive&&r.original.endLineNumberExclusive<o.original.startLineNumber&&r.modified.endLineNumberExclusive<o.modified.startLineNumber)),s}function uv(n,e,t){let i=0,s=0;n.modifiedRange.endColumn===1&&n.originalRange.endColumn===1&&n.originalRange.startLineNumber+i<=n.originalRange.endLineNumber&&n.modifiedRange.startLineNumber+i<=n.modifiedRange.endLineNumber&&(s=-1),n.modifiedRange.startColumn-1>=t[n.modifiedRange.startLineNumber-1].length&&n.originalRange.startColumn-1>=e[n.originalRange.startLineNumber-1].length&&n.originalRange.startLineNumber<=n.originalRange.endLineNumber+s&&n.modifiedRange.startLineNumber<=n.modifiedRange.endLineNumber+s&&(i=1);const r=new A(n.originalRange.startLineNumber+i,n.originalRange.endLineNumber+1+s),o=new A(n.modifiedRange.startLineNumber+i,n.modifiedRange.endLineNumber+1+s);return new Ve(r,o,[n])}function fv(n){return new ve(new A(n.seq1Range.start+1,n.seq1Range.endExclusive+1),new A(n.seq2Range.start+1,n.seq2Range.endExclusive+1))}const $d={getLegacy:()=>new zb,getDefault:()=>new Cf};function yf(n){const e=[];for(const t of n){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function Lc(n,e,t,i){return{red:n/255,blue:t/255,green:e/255,alpha:i}}function an(n,e){const t=e.index,i=e[0].length;if(!t)return;const s=n.positionAt(t);return{startLineNumber:s.lineNumber,startColumn:s.column,endLineNumber:s.lineNumber,endColumn:s.column+i}}function gv(n,e){if(!n)return;const t=Bt.Format.CSS.parseHex(e);if(t)return{range:n,color:Lc(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function qd(n,e,t){if(!n||e.length!==1)return;const s=e[0].values(),r=yf(s);return{range:n,color:Lc(r[0],r[1],r[2],t?r[3]:1)}}function zd(n,e,t){if(!n||e.length!==1)return;const s=e[0].values(),r=yf(s),o=new Bt(new bg(r[0],r[1]/100,r[2]/100,t?r[3]:1));return{range:n,color:Lc(o.rgba.r,o.rgba.g,o.rgba.b,o.rgba.a)}}function ln(n,e){return typeof n=="string"?[...n.matchAll(e)]:n.findMatches(e)}function mv(n){const e=[],i=ln(n,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(i.length>0)for(const s of i){const r=s.filter(c=>c!==void 0),o=r[1],a=r[2];if(!a)continue;let l;if(o==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=qd(an(n,s),ln(a,c),!1)}else if(o==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=qd(an(n,s),ln(a,c),!0)}else if(o==="hsl"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=zd(an(n,s),ln(a,c),!1)}else if(o==="hsla"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=zd(an(n,s),ln(a,c),!0)}else o==="#"&&(l=gv(an(n,s),o+a));l&&e.push(l)}return e}function pv(n){return!n||typeof n.getValue!="function"||typeof n.positionAt!="function"?[]:mv(n)}const jd=new RegExp("\\bMARK:\\s*(.*)$","d"),_v=/^-+|-+$/g;function bv(n,e){var i;let t=[];if(e.findRegionSectionHeaders&&((i=e.foldingRules)!=null&&i.markers)){const s=vv(n,e);t=t.concat(s)}if(e.findMarkSectionHeaders){const s=wv(n);t=t.concat(s)}return t}function vv(n,e){const t=[],i=n.getLineCount();for(let s=1;s<=i;s++){const r=n.getLineContent(s),o=r.match(e.foldingRules.markers.start);if(o){const a={startLineNumber:s,startColumn:o[0].length+1,endLineNumber:s,endColumn:r.length+1};if(a.endColumn>a.startColumn){const l={range:a,...Lf(r.substring(o[0].length)),shouldBeInComments:!1};(l.text||l.hasSeparatorLine)&&t.push(l)}}}return t}function wv(n){const e=[],t=n.getLineCount();for(let i=1;i<=t;i++){const s=n.getLineContent(i);Sv(s,i,e)}return e}function Sv(n,e,t){jd.lastIndex=0;const i=jd.exec(n);if(i){const s=i.indices[1][0]+1,r=i.indices[1][1]+1,o={startLineNumber:e,startColumn:s,endLineNumber:e,endColumn:r};if(o.endColumn>o.startColumn){const a={range:o,...Lf(i[1]),shouldBeInComments:!0};(a.text||a.hasSeparatorLine)&&t.push(a)}}}function Lf(n){n=n.trim();const e=n.startsWith("-");return n=n.replace(_v,""),{text:n,hasSeparatorLine:e}}class Cv{constructor(e,t,i,s){this._uri=e,this._lines=t,this._eol=i,this._versionId=s,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new K(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let s=0;s<t;s++)i[s]=this._lines[s].length+e;this._lineStarts=new Wp(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=uc(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const s=new Uint32Array(i.length-1);for(let r=1;r<i.length;r++)this._lines.splice(e.lineNumber+r-1,0,i[r]),s[r-1]=i[r].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,s)}}const Gd=60*1e3;class yv extends D{constructor(e,t,i=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const s=new Mu;s.cancelAndSet(()=>this._checkStopModelSync(),Math.round(Gd/2)),this._register(s)}}dispose(){for(const e in this._syncedModels)Ns(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t=!1){for(const i of e){const s=i.toString();this._syncedModels[s]||this._beginModelSync(i,t),this._syncedModels[s]&&(this._syncedModelsLastUsedTime[s]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>Gd&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const s=e.toString();this._proxy.$acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const r=new ie;r.add(i.onDidChangeContent(o=>{this._proxy.$acceptModelChanged(s.toString(),o)})),r.add(i.onWillDispose(()=>{this._stopModelSync(s)})),r.add(le(()=>{this._proxy.$acceptRemovedModel(s)})),this._syncedModels[s]=r}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],Ns(t)}}class Lv{constructor(){this._models=Object.create(null)}getModel(e){return this._models[e]}getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}$acceptNewModel(e){this._models[e.url]=new kv(Ae.parse(e.url),e.lines,e.EOL,e.versionId)}$acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}$acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}class kv extends Cv{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const s=this._lines[i],r=this.offsetAt(new K(i+1,1)),o=s.matchAll(e);for(const a of o)(a.index||a.index===0)&&(a.index=a.index+r),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=bu(e.column,vg(t),this._lines[e.lineNumber-1],0);return i?new O(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let s=0,r="",o=0,a=[];return{*[Symbol.iterator](){for(;;)if(o<a.length){const l=r.substring(a[o].start,a[o].end);o+=1,yield l}else if(s<t.length)r=t[s],a=i(r,e),o=0,s+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],s=this._wordenize(i,t),r=[];for(const o of s)r.push({word:i.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return r}_wordenize(e,t){const i=[];let s;for(t.lastIndex=0;(s=t.exec(e))&&s[0].length!==0;)i.push({start:s.index,end:s.index+s[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,s=e.endLineNumber-1,r=[];r.push(this._lines[i].substring(e.startColumn-1));for(let o=i+1;o<s;o++)r.push(this._lines[o]);return r.push(this._lines[s].substring(0,e.endColumn-1)),r.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!K.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,s=!1;if(t<1)t=1,i=1,s=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,s=!0;else{const r=this._lines[t-1].length+1;i<1?(i=1,s=!0):i>r&&(i=r,s=!0)}return s?{lineNumber:t,column:i}:e}}const _r=class _r{constructor(){this._workerTextModelSyncServer=new Lv}dispose(){}_getModel(e){return this._workerTextModelSyncServer.getModel(e)}_getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(e){this._workerTextModelSyncServer.$acceptNewModel(e)}$acceptModelChanged(e,t){this._workerTextModelSyncServer.$acceptModelChanged(e,t)}$acceptRemovedModel(e){this._workerTextModelSyncServer.$acceptRemovedModel(e)}async $computeUnicodeHighlights(e,t,i){const s=this._getModel(e);return s?Bb.computeUnicodeHighlights(s,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(e,t){const i=this._getModel(e);return i?bv(i,t):[]}async $computeDiff(e,t,i,s){const r=this._getModel(e),o=this._getModel(t);return!r||!o?null:Ss.computeDiff(r,o,i,s)}static computeDiff(e,t,i,s){const r=s==="advanced"?$d.getDefault():$d.getLegacy(),o=e.getLinesContent(),a=t.getLinesContent(),l=r.computeDiff(o,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function d(h){return h.map(u=>{var f;return[u.original.startLineNumber,u.original.endLineNumberExclusive,u.modified.startLineNumber,u.modified.endLineNumberExclusive,(f=u.innerChanges)==null?void 0:f.map(g=>[g.originalRange.startLineNumber,g.originalRange.startColumn,g.originalRange.endLineNumber,g.originalRange.endColumn,g.modifiedRange.startLineNumber,g.modifiedRange.startColumn,g.modifiedRange.endLineNumber,g.modifiedRange.endColumn])]})}return{identical:c,quitEarly:l.hitTimeout,changes:d(l.changes),moves:l.moves.map(h=>[h.lineRangeMapping.original.startLineNumber,h.lineRangeMapping.original.endLineNumberExclusive,h.lineRangeMapping.modified.startLineNumber,h.lineRangeMapping.modified.endLineNumberExclusive,d(h.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),s=t.getLineCount();if(i!==s)return!1;for(let r=1;r<=i;r++){const o=e.getLineContent(r),a=t.getLineContent(r);if(o!==a)return!1}return!0}async $computeMoreMinimalEdits(e,t,i){const s=this._getModel(e);if(!s)return t;const r=[];let o;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return O.compareRangesUsingStarts(l.range,c.range);const d=l.range?0:1,h=c.range?0:1;return d-h});let a=0;for(let l=1;l<t.length;l++)O.getEndPosition(t[a].range).equals(O.getStartPosition(t[l].range))?(t[a].range=O.fromPositions(O.getStartPosition(t[a].range),O.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:d}of t){if(typeof d=="number"&&(o=d),O.isEmpty(l)&&!c)continue;const h=s.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,s.eol),h===c)continue;if(Math.max(c.length,h.length)>Ss._diffLimit){r.push({range:l,text:c});continue}const u=X_(h,c,i),f=s.offsetAt(O.lift(l).getStartPosition());for(const g of u){const p=s.positionAt(f+g.originalStart),b=s.positionAt(f+g.originalStart+g.originalLength),w={text:c.substr(g.modifiedStart,g.modifiedLength),range:{startLineNumber:p.lineNumber,startColumn:p.column,endLineNumber:b.lineNumber,endColumn:b.column}};s.getValueInRange(w.range)!==w.text&&r.push(w)}}return typeof o=="number"&&r.push({eol:o,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),r}async $computeLinks(e){const t=this._getModel(e);return t?Fb(t):null}async $computeDefaultDocumentColors(e){const t=this._getModel(e);return t?pv(t):null}async $textualSuggest(e,t,i,s){const r=new fc,o=new RegExp(i,s),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const d of c.words(o))if(!(d===t||!isNaN(Number(d)))&&(a.add(d),a.size>Ss._suggestionsLimit))break e}}return{words:Array.from(a),duration:r.elapsed()}}async $computeWordRanges(e,t,i,s){const r=this._getModel(e);if(!r)return Object.create(null);const o=new RegExp(i,s),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=r.getLineWords(l,o);for(const d of c){if(!isNaN(Number(d.word)))continue;let h=a[d.word];h||(h=[],a[d.word]=h),h.push({startLineNumber:l,startColumn:d.startColumn,endLineNumber:l,endColumn:d.endColumn})}}return a}async $navigateValueSet(e,t,i,s,r){const o=this._getModel(e);if(!o)return null;const a=new RegExp(s,r);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=o.getValueInRange(t),c=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const d=o.getValueInRange(c);return La.INSTANCE.navigateValueSet(t,l,c,d,i)}};_r._diffLimit=1e5,_r._suggestionsLimit=1e4;let Ra=_r;class Ss extends Ra{constructor(e,t){super(),this._host=e,this._foreignModuleFactory=t,this._foreignModule=null}async $ping(){return"pong"}$loadForeignModule(e,t,i){const o={host:wg(i,(a,l)=>this._host.$fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(o,t),Promise.resolve(bo(this._foreignModule))):new Promise((a,l)=>{const c=d=>{this._foreignModule=d.create(o,t),a(bo(this._foreignModule))};{const d=Du.asBrowserUri(`${e}.js`).toString(!0);Z_(()=>import(`${d}`),[],import.meta.url).then(c).catch(l)}})}$fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}typeof importScripts=="function"&&(globalThis.monaco=mf());const kc=dt("textResourceConfigurationService"),kf=dt("textResourcePropertiesService");var Ec=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Kt=function(n,e){return function(t,i){e(t,i,n)}};const Zd=5*60*1e3;function Xt(n,e){const t=n.getModel(e);return!(!t||t.isTooLargeForSyncing())}let Ma=class extends D{constructor(e,t,i,s,r,o){super(),this._languageConfigurationService=r,this._modelService=t,this._workerManager=this._register(new Ta(e,this._modelService)),this._logService=s,this._register(o.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(a,l)=>{if(!Xt(this._modelService,a.uri))return Promise.resolve({links:[]});const d=await(await this._workerWithResources([a.uri])).$computeLinks(a.uri.toString());return d&&{links:d}}})),this._register(o.completionProvider.register("*",new Ev(this._workerManager,i,this._modelService,this._languageConfigurationService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return Xt(this._modelService,e)}async computedUnicodeHighlights(e,t,i){return(await this._workerWithResources([e])).$computeUnicodeHighlights(e.toString(),t,i)}async computeDiff(e,t,i,s){const o=await(await this._workerWithResources([e,t],!0)).$computeDiff(e.toString(),t.toString(),i,s);if(!o)return null;return{identical:o.identical,quitEarly:o.quitEarly,changes:l(o.changes),moves:o.moves.map(c=>new bf(new ve(new A(c[0],c[1]),new A(c[2],c[3])),l(c[4])))};function l(c){return c.map(d=>{var h;return new Ve(new A(d[0],d[1]),new A(d[2],d[3]),(h=d[4])==null?void 0:h.map(u=>new We(new O(u[0],u[1],u[2],u[3]),new O(u[4],u[5],u[6],u[7]))))})}}async computeMoreMinimalEdits(e,t,i=!1){if(Tu(t)){if(!Xt(this._modelService,e))return Promise.resolve(t);const s=fc.create(),r=this._workerWithResources([e]).then(o=>o.$computeMoreMinimalEdits(e.toString(),t,i));return r.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),s.elapsed())),Promise.race([r,Am(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return Xt(this._modelService,e)}async navigateValueSet(e,t,i){const s=this._modelService.getModel(e);if(!s)return null;const r=this._languageConfigurationService.getLanguageConfiguration(s.getLanguageId()).getWordDefinition(),o=r.source,a=r.flags;return(await this._workerWithResources([e])).$navigateValueSet(e.toString(),t,i,o,a)}canComputeWordRanges(e){return Xt(this._modelService,e)}async computeWordRanges(e,t){const i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);const s=this._languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition(),r=s.source,o=s.flags;return(await this._workerWithResources([e])).$computeWordRanges(e.toString(),t,r,o)}async findSectionHeaders(e,t){return(await this._workerWithResources([e])).$findSectionHeaders(e.toString(),t)}async computeDefaultDocumentColors(e){return(await this._workerWithResources([e])).$computeDefaultDocumentColors(e.toString())}async _workerWithResources(e,t=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(e,t)}};Ma=Ec([Kt(1,Ee),Kt(2,kc),Kt(3,Vt),Kt(4,Jn),Kt(5,Q)],Ma);class Ev{constructor(e,t,i,s){this.languageConfigurationService=s,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}async provideCompletionItems(e,t){const i=this._configurationService.getValue(e.uri,t,"editor");if(i.wordBasedSuggestions==="off")return;const s=[];if(i.wordBasedSuggestions==="currentDocument")Xt(this._modelService,e.uri)&&s.push(e.uri);else for(const h of this._modelService.getModels())Xt(this._modelService,h.uri)&&(h===e?s.unshift(h.uri):(i.wordBasedSuggestions==="allDocuments"||h.getLanguageId()===e.getLanguageId())&&s.push(h.uri));if(s.length===0)return;const r=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),o=e.getWordAtPosition(t),a=o?new O(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):O.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),d=await(await this._workerManager.withWorker()).textualSuggest(s,o==null?void 0:o.word,r);if(d)return{duration:d.duration,suggestions:d.words.map(h=>({kind:18,label:h,insertText:h,range:{insert:l,replace:a}}))}}}let Ta=class extends D{constructor(e,t){super(),this._workerDescriptor=e,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new Om).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(Zd/2),Ue),this._register(this._modelService.onModelRemoved(s=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>Zd&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new Us(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};Ta=Ec([Kt(1,Ee)],Ta);class xv{constructor(e){this._instance=e,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(e,t){throw new Error("Not supported")}}let Us=class extends D{constructor(e,t,i){super(),this._workerDescriptor=e,this._disposed=!1,this._modelService=i,this._keepIdleModels=t,this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(Tb(this._workerDescriptor)),ka.setChannel(this._worker,this._createEditorWorkerHost())}catch(e){Ca(e),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const e=this._getOrCreateWorker().proxy;return await e.$ping(),e}catch(e){return Ca(e),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new xv(new Ss(this._createEditorWorkerHost(),null))}_createEditorWorkerHost(){return{$fhr:(e,t)=>this.fhr(e,t)}}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new yv(e,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(e,t=!1){if(this._disposed)return Promise.reject(Pm());const i=await this._getProxy();return this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i}async textualSuggest(e,t,i){const s=await this.workerWithSyncedResources(e),r=i.source,o=i.flags;return s.$textualSuggest(e.map(a=>a.toString()),t,r,o)}dispose(){super.dispose(),this._disposed=!0}};Us=Ec([Kt(2,Ee)],Us);var Iv=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Dv=function(n,e){return function(t,i){e(t,i,n)}};let Na=class extends D{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new R),this._onCodeEditorAdd=this._register(new R),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new R),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new R),this._onDiffEditorAdd=this._register(new R),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new R),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new Ei,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const s=e.toString();let r;this._modelProperties.has(s)?r=this._modelProperties.get(s):(r=new Map,this._modelProperties.set(s,r)),r.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}async openCodeEditor(e,t,i){for(const s of this._codeEditorOpenHandlers){const r=await s(e,t,i);if(r!==null)return r}return null}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return le(t)}};Na=Iv([Dv(0,yt)],Na);var Rv=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Kd=function(n,e){return function(t,i){e(t,i,n)}};let $s=class extends Na{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(i,s,r)=>s?this.doOpenEditor(s,i):null))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const r=t.resource.scheme;if(r===se.http||r===se.https)return Nu(t.resource.toString()),e}return null}const s=t.options?t.options.selection:null;if(s)if(typeof s.endLineNumber=="number"&&typeof s.endColumn=="number")e.setSelection(s),e.revealRangeInCenter(s,1);else{const r={lineNumber:s.startLineNumber,column:s.startColumn};e.setPosition(r),e.revealPositionInCenter(r,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};$s=Rv([Kd(0,me),Kd(1,yt)],$s);V(Ce,$s,0);const qt=dt("layoutService");var Ef=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},xf=function(n,e){return function(t,i){e(t,i,n)}};let qs=class{get mainContainer(){var e;return((e=Au(this._codeEditorService.listCodeEditors()))==null?void 0:e.getContainerDomNode())??Ue.document.body}get activeContainer(){const e=this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor();return(e==null?void 0:e.getContainerDomNode())??this.mainContainer}get mainContainerDimension(){return nd(this.mainContainer)}get activeContainerDimension(){return nd(this.activeContainer)}get containers(){return cc(this._codeEditorService.listCodeEditors().map(e=>e.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())==null||e.focus()}constructor(e){this._codeEditorService=e,this.onDidLayoutMainContainer=ee.None,this.onDidLayoutActiveContainer=ee.None,this.onDidLayoutContainer=ee.None,this.onDidChangeActiveContainer=ee.None,this.onDidAddContainer=ee.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};qs=Ef([xf(0,Ce)],qs);let Aa=class extends qs{get mainContainer(){return this._container}constructor(e,t){super(t),this._container=e}};Aa=Ef([xf(1,Ce)],Aa);V(qt,qs,1);const If=dt("dialogService");var Mv=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Xd=function(n,e){return function(t,i){e(t,i,n)}};function rs(n){return n.scheme===se.file?n.fsPath:n.path}let Df=0;class os{constructor(e,t,i,s,r,o,a){this.id=++Df,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=s,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Yd{constructor(e,t){this.resourceLabel=e,this.reason=t}}class Qd{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,s]of this.elements)(s.reason===0?e:t).push(s.resourceLabel);const i=[];return e.length>0&&i.push(C({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(C({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class Tv{constructor(e,t,i,s,r,o,a){this.id=++Df,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=s,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new Qd),this.removedResources.has(t)||this.removedResources.set(t,new Yd(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new Qd),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new Yd(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Rf{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,s=this._past.length;i<s;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new of(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,s=0,r=-1;for(let a=0,l=this._past.length;a<l;a++,s++){const c=this._past[a];i&&(s>=t||c.id!==e.elements[s])&&(i=!1,r=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let a=this._future.length-1;a>=0;a--,s++){const l=this._future[a];i&&(s>=t||l.id!==e.elements[s])&&(i=!1,o=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}r!==-1&&(this._past=this._past.slice(0,r)),o!==-1&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class no{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const Mf=new Rf("","");Mf.locked=!0;let Oa=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=Hp.None,i=rn.None){if(e.type===0){const s=rs(e.resource),r=this.getUriComparisonKey(e.resource);this._pushElement(new os(e,s,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const s=new Set,r=[],o=[];for(const a of e.resources){const l=rs(a),c=this.getUriComparisonKey(a);s.has(c)||(s.add(c),r.push(l),o.push(c))}r.length===1?this._pushElement(new os(e,r[0],o[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new Tv(e,r,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const s=e.resourceLabels[t],r=e.strResources[t];let o;this._editStacks.has(r)?o=this._editStacks.get(r):(o=new Rf(s,r),this._editStacks.set(r,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const s=i.getClosestPastElement();return s?s.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),s=new Map;for(const r of i){const o=rs(r.resource),a=this.getUriComparisonKey(r.resource),l=new os(r,o,a,0,0,0,0);s.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitPastWorkspaceElement(e,s)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),s=new Map;for(const r of i){const o=rs(r.resource),a=this.getUriComparisonKey(r.resource),l=new os(r,o,a,0,0,0,0);s.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitFutureWorkspaceElement(e,s)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const s=this.getUriComparisonKey(e);this._editStacks.has(s)&&this._editStacks.get(s).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new of(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,i=s)}return[t,i]}canUndo(e){if(e instanceof rn){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){di(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,s,r){const o=this._acquireLocks(i);let a;try{a=t()}catch(l){return o(),s.dispose(),this._onError(l,e)}return a?a.then(()=>(o(),s.dispose(),r()),l=>(o(),s.dispose(),this._onError(l,e))):(o(),s.dispose(),r())}async _invokeWorkspacePrepare(e){if(typeof e.actual.prepareUndoRedo>"u")return D.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?D.None:t}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(D.None);const i=e.actual.prepareUndoRedo();return i?Ou(i)?t(i):i.then(s=>t(s)):t(D.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||Mf);return new no(t)}_tryToSplitAndUndo(e,t,i,s){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(s),new as(this._undo(e,0,!0));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(s),new as}_checkWorkspaceUndo(e,t,i,s){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,C({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(s&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,C({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndUndo(e,t,null,C({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,C({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,C({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const s=this._getAffectedEditStacks(t),r=this._checkWorkspaceUndo(e,t,s,!1);return r?r.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,s,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const s=t.getSecondClosestPastElement();if(s&&s.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(e,t,i,s){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(d){d[d.All=0]="All",d[d.This=1]="This",d[d.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=await this._dialogService.prompt({type:Ne.Info,message:C("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),buttons:[{label:C({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:C({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;s=!0}let r;try{r=await this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const o=this._checkWorkspaceUndo(e,t,i,!0);if(o)return r.dispose(),o.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,r,()=>this._continueUndoInGroup(t.groupId,s))}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const s=C({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(s);return}return this._invokeResourcePrepare(t,s=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new no([e]),s,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,i=s)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof rn){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const s=this._editStacks.get(e),r=s.getClosestPastElement();if(!r)return;if(r.groupId){const[a,l]=this._findClosestUndoElementInGroup(r.groupId);if(r!==a&&l)return this._undo(l,t,i)}if((r.sourceId!==t||r.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,r);try{return r.type===1?this._workspaceUndo(e,r,i):this._resourceUndo(s,r,i)}finally{}}async _confirmAndContinueUndo(e,t,i){if((await this._dialogService.confirm({message:C("confirmDifferentSource","Would you like to undo '{0}'?",i.label),primaryButton:C({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:C("confirmDifferentSource.no","No")})).confirmed)return this._undo(e,t,!0)}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,i=s)}return[t,i]}canRedo(e){if(e instanceof rn){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,s){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(s),new as(this._redo(e));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(s),new as}_checkWorkspaceRedo(e,t,i,s){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,C({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(s&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,C({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndRedo(e,t,null,C({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,C({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,C({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),s=this._checkWorkspaceRedo(e,t,i,!1);return s?s.returnValue:this._executeWorkspaceRedo(e,t,i)}async _executeWorkspaceRedo(e,t,i){let s;try{s=await this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const r=this._checkWorkspaceRedo(e,t,i,!0);if(r)return s.dispose(),r.returnValue;for(const o of i.editStacks)o.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,s,()=>this._continueRedoInGroup(t.groupId))}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=C({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new no([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,i=s)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof rn){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[s,r]=this._findClosestRedoElementInGroup(i.groupId);if(i!==s&&r)return this._redo(r)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};Oa=Mv([Xd(0,If),Xd(1,$t)],Oa);class as{constructor(e){this.returnValue=e}}V(af,Oa,1);var Nv=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},so=function(n,e){return function(t,i){e(t,i,n)}};let Pa=class{constructor(e,t,i,s){this._legend=e,this._themeService=t,this._languageService=i,this._logService=s,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new Fa}getMetadata(e,t,i){const s=this._languageService.languageIdCodec.encodeLanguageId(i),r=this._hashTable.get(e,t,s);let o;if(r)o=r.metadata;else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let h=0;c>0&&h<this._legend.tokenModifiers.length;h++)c&1&&l.push(this._legend.tokenModifiers[h]),c=c>>1;const d=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof d>"u")o=2147483647;else{if(o=0,typeof d.italic<"u"){const h=(d.italic?1:0)<<11;o|=h|1}if(typeof d.bold<"u"){const h=(d.bold?2:0)<<11;o|=h|2}if(typeof d.underline<"u"){const h=(d.underline?4:0)<<11;o|=h|4}if(typeof d.strikethrough<"u"){const h=(d.strikethrough?8:0)<<11;o|=h|8}if(d.foreground){const h=d.foreground<<15;o|=h|16}o===0&&(o=2147483647)}}else o=2147483647,a="not-in-legend";this._hashTable.add(e,t,s,o)}return o}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,s,r){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${s} is outside the previous data (length ${r}).`))}};Pa=Nv([so(1,yt),so(2,Se),so(3,Vt)],Pa);class Av{constructor(e,t,i,s){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=s,this.next=null}}const pt=class pt{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=pt._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<pt._SIZES.length?2/3*this._currentLength:0),this._elements=[],pt._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const s=this._hashFunc(e,t,i);let r=this._elements[s];for(;r;){if(r.tokenTypeIndex===e&&r.tokenModifierSet===t&&r.languageId===i)return r;r=r.next}return null}add(e,t,i,s){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const r=this._elements;this._currentLengthIndex++,this._currentLength=pt._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<pt._SIZES.length?2/3*this._currentLength:0),this._elements=[],pt._nullOutEntries(this._elements,this._currentLength);for(const o of r){let a=o;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new Av(e,t,i,s))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}};pt._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];let Fa=pt;const Ov=dt("semanticTokensStylingService");var Pv=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ro=function(n,e){return function(t,i){e(t,i,n)}};let Ba=class extends D{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new Pa(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};Ba=Pv([ro(0,yt),ro(1,Vt),ro(2,Se)],Ba);V(Ov,Ba,1);const ls="**",Jd="/",Cs="[/\\\\]",ys="[^/\\\\]",Fv=/\//g;function eh(n,e){switch(n){case 0:return"";case 1:return`${ys}*?`;default:return`(?:${Cs}|${ys}+${Cs}${e?`|${Cs}${ys}+`:""})*?`}}function th(n,e){if(!n)return[];const t=[];let i=!1,s=!1,r="";for(const o of n){switch(o){case e:if(!i&&!s){t.push(r),r="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":s=!0;break;case"]":s=!1;break}r+=o}return r&&t.push(r),t}function Tf(n){if(!n)return"";let e="";const t=th(n,Jd);if(t.every(i=>i===ls))e=".*";else{let i=!1;t.forEach((s,r)=>{if(s===ls){if(i)return;e+=eh(2,r===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const d of s){if(d!=="}"&&o){a+=d;continue}if(l&&(d!=="]"||!c)){let h;d==="-"?h=d:(d==="^"||d==="!")&&!c?h="^":d===Jd?h="":h=Lo(d),c+=h;continue}switch(d){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const u=`(?:${th(a,",").map(f=>Tf(f)).join("|")})`;e+=u,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=ys;continue;case"*":e+=eh(1);continue;default:e+=Lo(d)}}r<t.length-1&&(t[r+1]!==ls||r+2<t.length)&&(e+=Cs)}i=s===ls})}return e}const Bv=/^\*\*\/\*\.[\w\.-]+$/,Wv=/^\*\*\/([\w\.-]+)\/?$/,Hv=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,Vv=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,Uv=/^\*\*((\/[\w\.-]+)+)\/?$/,$v=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,ih=new Sg(1e4),nh=function(){return!1},at=function(){return null};function xc(n,e){if(!n)return at;let t;typeof n!="string"?t=n.pattern:t=n,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let s=ih.get(i);if(s)return sh(s,n);let r;return Bv.test(t)?s=qv(t.substr(4),t):(r=Wv.exec(oo(t,e)))?s=zv(r[1],t):(e.trimForExclusions?Vv:Hv).test(t)?s=jv(t,e):(r=Uv.exec(oo(t,e)))?s=rh(r[1].substr(1),t,!0):(r=$v.exec(oo(t,e)))?s=rh(r[1],t,!1):s=Gv(t),ih.set(i,s),sh(s,n)}function sh(n,e){if(typeof e=="string")return n;const t=function(i,s){return Cg(i,e.base,!Pn)?n(gc(i.substr(e.base.length),vs),s):null};return t.allBasenames=n.allBasenames,t.allPaths=n.allPaths,t.basenames=n.basenames,t.patterns=n.patterns,t}function oo(n,e){return e.trimForExclusions&&n.endsWith("/**")?n.substr(0,n.length-2):n}function qv(n,e){return function(t,i){return typeof t=="string"&&t.endsWith(n)?e:null}}function zv(n,e){const t=`/${n}`,i=`\\${n}`,s=function(o,a){return typeof o!="string"?null:a?a===n?e:null:o===n||o.endsWith(t)||o.endsWith(i)?e:null},r=[n];return s.basenames=r,s.patterns=[e],s.allBasenames=r,s}function jv(n,e){const t=Af(n.slice(1,-1).split(",").map(a=>xc(a,e)).filter(a=>a!==at),n),i=t.length;if(!i)return at;if(i===1)return t[0];const s=function(a,l){for(let c=0,d=t.length;c<d;c++)if(t[c](a,l))return n;return null},r=t.find(a=>!!a.allBasenames);r&&(s.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(s.allPaths=o),s}function rh(n,e,t){const i=vs===ko.sep,s=i?n:n.replace(Fv,vs),r=vs+s,o=ko.sep+n;let a;return t?a=function(l,c){return typeof l=="string"&&(l===s||l.endsWith(r)||!i&&(l===n||l.endsWith(o)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===s||!i&&l===n)?e:null},a.allPaths=[(t?"*/":"./")+n],a}function Gv(n){try{const e=new RegExp(`^${Tf(n)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?n:null}}catch{return at}}function Zv(n,e,t){return!n||typeof e!="string"?!1:Nf(n)(e,void 0,t)}function Nf(n,e={}){if(!n)return nh;if(typeof n=="string"||Kv(n)){const t=xc(n,e);if(t===at)return nh;const i=function(s,r){return!!t(s,r)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return Xv(n,e)}function Kv(n){const e=n;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function Xv(n,e){const t=Af(Object.getOwnPropertyNames(n).map(a=>Yv(a,n[a],e)).filter(a=>a!==at)),i=t.length;if(!i)return at;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(d,h){let u;for(let f=0,g=t.length;f<g;f++){const p=t[f](d,h);if(typeof p=="string")return p;Eo(p)&&(u||(u=[]),u.push(p))}return u?(async()=>{for(const f of u){const g=await f;if(typeof g=="string")return g}return null})():null},l=t.find(d=>!!d.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((d,h)=>h.allPaths?d.concat(h.allPaths):d,[]);return c.length&&(a.allPaths=c),a}const s=function(a,l,c){let d,h;for(let u=0,f=t.length;u<f;u++){const g=t[u];g.requiresSiblings&&c&&(l||(l=Pu(a)),d||(d=l.substr(0,l.length-Fm(a).length)));const p=g(a,l,d,c);if(typeof p=="string")return p;Eo(p)&&(h||(h=[]),h.push(p))}return h?(async()=>{for(const u of h){const f=await u;if(typeof f=="string")return f}return null})():null},r=t.find(a=>!!a.allBasenames);r&&(s.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(s.allPaths=o),s}function Yv(n,e,t){if(e===!1)return at;const i=xc(n,t);if(i===at)return at;if(typeof e=="boolean")return i;if(e){const s=e.when;if(typeof s=="string"){const r=(o,a,l,c)=>{if(!c||!i(o,a))return null;const d=s.replace("$(basename)",()=>l),h=c(d);return Eo(h)?h.then(u=>u?n:null):h?n:null};return r.requiresSiblings=!0,r}}return i}function Af(n,e){const t=n.filter(a=>!!a.basenames);if(t.length<2)return n;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let s;if(e){s=[];for(let a=0,l=i.length;a<l;a++)s.push(e)}else s=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const r=function(a,l){if(typeof a!="string")return null;if(!l){let d;for(d=a.length;d>0;d--){const h=a.charCodeAt(d-1);if(h===47||h===92)break}l=a.substr(d)}const c=i.indexOf(l);return c!==-1?s[c]:null};r.basenames=i,r.patterns=s,r.allBasenames=i;const o=n.filter(a=>!a.basenames);return o.push(r),o}function Of(n,e,t,i,s,r){if(Array.isArray(n)){let o=0;for(const a of n){const l=Of(a,e,t,i,s,r);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof n=="string")return i?n==="*"?5:n===t?10:0:0;if(n){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:d}=n;if(!i&&!c)return 0;d&&s&&(e=s);let h=0;if(l)if(l===e.scheme)h=10;else if(l==="*")h=5;else return 0;if(o)if(o===t)h=10;else if(o==="*")h=Math.max(h,5);else return 0;if(d)if(d===r)h=10;else if(d==="*"&&r!==void 0)h=Math.max(h,5);else return 0;if(a){let u;if(typeof a=="string"?u=a:u={...a,base:Bm(a.base)},u===e.fsPath||Zv(u,e.fsPath))h=10;else return 0}return h}else return 0}}function Pf(n){return typeof n=="string"?!1:Array.isArray(n)?n.every(Pf):!!n.exclusive}class oh{constructor(e,t,i,s,r){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=s,this.recursive=r}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)==null?void 0:t.toString())===((i=e.notebookUri)==null?void 0:i.toString())&&this.recursive===e.recursive}}class Y{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new R,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),le(()=>{if(i){const s=this._entries.indexOf(i);s>=0&&(this._entries.splice(s,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,s=>i.push(s.provider)),i}orderedGroups(e){const t=[];let i,s;return this._orderedForEach(e,!1,r=>{i&&s===r._score?i.push(r.provider):(s=r._score,i=[r.provider],t.push(i))}),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const s of this._entries)s._score>0&&i(s)}_updateScores(e,t){var r,o;const i=(r=this._notebookInfoResolver)==null?void 0:r.call(this,e.uri),s=i?new oh(e.uri,e.getLanguageId(),i.uri,i.type,t):new oh(e.uri,e.getLanguageId(),void 0,void 0,t);if(!((o=this._lastCandidate)!=null&&o.equals(s))){this._lastCandidate=s;for(const a of this._entries)if(a._score=Of(a.selector,s.uri,s.languageId,Vp(e),s.notebookUri,s.notebookType),Pf(a.selector)&&a._score>0)if(t)a._score=0;else{for(const l of this._entries)l._score=0;a._score=1e3;break}this._entries.sort(Y._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:_n(e.selector)&&!_n(t.selector)?1:!_n(e.selector)&&_n(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function _n(n){return typeof n=="string"?!1:Array.isArray(n)?n.some(_n):!!n.isBuiltin}class Qv{constructor(){this.referenceProvider=new Y(this._score.bind(this)),this.renameProvider=new Y(this._score.bind(this)),this.newSymbolNamesProvider=new Y(this._score.bind(this)),this.codeActionProvider=new Y(this._score.bind(this)),this.definitionProvider=new Y(this._score.bind(this)),this.typeDefinitionProvider=new Y(this._score.bind(this)),this.declarationProvider=new Y(this._score.bind(this)),this.implementationProvider=new Y(this._score.bind(this)),this.documentSymbolProvider=new Y(this._score.bind(this)),this.inlayHintsProvider=new Y(this._score.bind(this)),this.colorProvider=new Y(this._score.bind(this)),this.codeLensProvider=new Y(this._score.bind(this)),this.documentFormattingEditProvider=new Y(this._score.bind(this)),this.documentRangeFormattingEditProvider=new Y(this._score.bind(this)),this.onTypeFormattingEditProvider=new Y(this._score.bind(this)),this.signatureHelpProvider=new Y(this._score.bind(this)),this.hoverProvider=new Y(this._score.bind(this)),this.documentHighlightProvider=new Y(this._score.bind(this)),this.multiDocumentHighlightProvider=new Y(this._score.bind(this)),this.selectionRangeProvider=new Y(this._score.bind(this)),this.foldingRangeProvider=new Y(this._score.bind(this)),this.linkProvider=new Y(this._score.bind(this)),this.inlineCompletionsProvider=new Y(this._score.bind(this)),this.inlineEditProvider=new Y(this._score.bind(this)),this.completionProvider=new Y(this._score.bind(this)),this.linkedEditingRangeProvider=new Y(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new Y(this._score.bind(this)),this.documentSemanticTokensProvider=new Y(this._score.bind(this)),this.documentDropEditProvider=new Y(this._score.bind(this)),this.documentPasteEditProvider=new Y(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)==null?void 0:t.call(this,e)}}V(Q,Qv,1);var Jv=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},cn=function(n,e){return function(t,i){e(t,i,n)}};const it=he;let Wa=class extends vu{get _targetWindow(){return ae(this._target.targetElements[0])}get _targetDocumentElement(){return ae(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,s,r,o){var u,f,g,p,b,w,S;super(),this._keybindingService=t,this._configurationService=i,this._openerService=s,this._instantiationService=r,this._accessibilityService=o,this._messageListeners=new ie,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new R),this._onRequestLayout=this._register(new R),this._linkHandler=e.linkHandler||(_=>yg(this._openerService,_,Oi(e.content)?e.content.isTrusted:void 0)),this._target="targetElements"in e.target?e.target:new ew(e.target),this._hoverPointer=(u=e.appearance)!=null&&u.showPointer?it("div.workbench-hover-pointer"):void 0,this._hover=this._register(new Y_),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),(f=e.appearance)!=null&&f.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),(g=e.appearance)!=null&&g.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),(p=e.position)!=null&&p.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=((b=e.position)==null?void 0:b.hoverPosition)??3,this.onmousedown(this._hover.containerDomNode,_=>_.stopPropagation()),this.onkeydown(this._hover.containerDomNode,_=>{_.equals(9)&&this.dispose()}),this._register(I(this._targetWindow,"blur",()=>this.dispose()));const a=it("div.hover-row.markdown-hover"),l=it("div.hover-contents");if(typeof e.content=="string")l.textContent=e.content,l.style.whiteSpace="pre-wrap";else if(ot(e.content))l.appendChild(e.content),l.classList.add("html-hover-contents");else{const _=e.content,m=this._instantiationService.createInstance(Lg,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||kg.fontFamily}),{element:v}=m.render(_,{actionHandler:{callback:y=>this._linkHandler(y),disposables:this._messageListeners},asyncRenderCallback:()=>{l.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});l.appendChild(v)}if(a.appendChild(l),this._hover.contentsDomNode.appendChild(a),e.actions&&e.actions.length>0){const _=it("div.hover-row.status-bar"),m=it("div.actions");e.actions.forEach(v=>{const y=this._keybindingService.lookupKeybinding(v.commandId),L=y?y.getLabel():null;Q_.render(m,{label:v.label,commandId:v.commandId,run:k=>{v.run(k),this.dispose()},iconClass:v.iconClass},L)}),_.appendChild(m),this._hover.containerDomNode.appendChild(_)}this._hoverContainer=it("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let c;if(e.actions&&e.actions.length>0?c=!1:((w=e.persistence)==null?void 0:w.hideOnHover)===void 0?c=typeof e.content=="string"||Oi(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):c=e.persistence.hideOnHover,(S=e.appearance)!=null&&S.showHoverHint){const _=it("div.hover-row.status-bar"),m=it("div.info");m.textContent=C("hoverhint","Hold {0} key to mouse over",ui?"Option":"Alt"),_.appendChild(m),this._hover.containerDomNode.appendChild(_)}const d=[...this._target.targetElements];c||d.push(this._hoverContainer);const h=this._register(new ah(d));if(this._register(h.onMouseOut(()=>{this._isLocked||this.dispose()})),c){const _=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new ah(_)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=h}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=Fu(this._hoverContainer,it("div")),s=G(this._hoverContainer,it("div"));i.tabIndex=0,s.tabIndex=0,this._register(I(s,"focus",r=>{e.focus(),r.preventDefault()})),this._register(I(i,"focus",r=>{t.focus(),r.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const r=i;if(typeof r.tabIndex=="number"&&r.tabIndex>=0)return r}const s=this.findLastFocusableChild(i);if(s)return s}}render(e){var s;e.appendChild(this._hoverContainer);const i=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&J_(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(s=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))==null?void 0:s.getAriaLabel());i&&Eg(i),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=d=>{const h=Bu(d),u=d.getBoundingClientRect();return{top:u.top*h,bottom:u.bottom*h,right:u.right*h,left:u.left*h}},t=this._target.targetElements.map(d=>e(d)),{top:i,right:s,bottom:r,left:o}=t[0],a=s-o,l=r-i,c={top:i,right:s,bottom:r,left:o,width:a,height:l,center:{x:o+a/2,y:i+l/2}};if(this.adjustHorizontalHoverPosition(c),this.adjustVerticalHoverPosition(c),this.adjustHoverMaxHeight(c),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:c.left+=3,c.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:c.left-=3,c.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:c.top+=3,c.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:c.top-=3,c.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}c.center.x=c.left+a/2,c.center.y=c.top+l/2}this.computeXCordinate(c),this.computeYCordinate(c),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(c)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-t-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>this._targetWindow.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x!==void 0)return;const t=this._hoverPointer?3:0;if(this._forcePosition){const i=t+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-e.right-i}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-i}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth+t&&(e.left>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth+t&&(this._targetDocumentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth-t<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(e){if(this._target.y!==void 0||this._forcePosition)return;const t=this._hoverPointer?3:0;this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight-t<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.clientHeight+t>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(e){let t=this._targetWindow.innerHeight/2;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,this._targetWindow.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const s=this._x+i;(s<e.left||s>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};Wa=Jv([cn(1,ht),cn(2,Oe),cn(3,Ar),cn(4,re),cn(5,fi)],Wa);class ah extends vu{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e){super(),this._elements=e,this._isMouseIn=!0,this._onMouseOut=this._register(new R),this._elements.forEach(t=>this.onmouseover(t,()=>this._onTargetMouseOver(t))),this._elements.forEach(t=>this.onmouseleave(t,()=>this._onTargetMouseLeave(t)))}_onTargetMouseOver(e){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout(e)}_onTargetMouseLeave(e){this._isMouseIn=!1,this._evaluateMouseState(e)}_evaluateMouseState(e){this._clearEvaluateMouseStateTimeout(e),this._mouseTimeout=ae(e).setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(e){this._mouseTimeout&&(ae(e).clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class ew{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}function tw(n){const e=n;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var Tt;(function(n){n[n.AVOID=0]="AVOID",n[n.ALIGN=1]="ALIGN"})(Tt||(Tt={}));function Ri(n,e,t){const i=t.mode===Tt.ALIGN?t.offset:t.offset+t.size,s=t.mode===Tt.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=n-i?i:e<=s?s-e:Math.max(n-e,0):e<=s?s-e:e<=n-i?i:0}const Ai=class Ai extends D{constructor(e,t){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=D.None,this.toDisposeOnSetContainer=D.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=he(".context-view"),sd(this.view),this.setContainer(e,t),this._register(le(()=>this.setContainer(null,1)))}setContainer(e,t){var s;this.useFixedPosition=t!==1;const i=this.useShadowDOM;if(this.useShadowDOM=t===3,!(e===this.container&&i===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,(s=this.shadowRootHostElement)==null||s.remove(),this.shadowRootHostElement=null),this.container=null),e)){if(this.container=e,this.useShadowDOM){this.shadowRootHostElement=he(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const o=document.createElement("style");o.textContent=iw,this.shadowRoot.appendChild(o),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(he("slot"))}else this.container.appendChild(this.view);const r=new ie;Ai.BUBBLE_UP_EVENTS.forEach(o=>{r.add(lt(this.container,o,a=>{this.onDOMEvent(a,!1)}))}),Ai.BUBBLE_DOWN_EVENTS.forEach(o=>{r.add(lt(this.container,o,a=>{this.onDOMEvent(a,!0)},!0))}),this.toDisposeOnSetContainer=r}}show(e){var t,i;this.isVisible()&&this.hide(),Wu(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(e.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",Hu(this.view),this.toDisposeOnClean=e.render(this.view)||D.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)==null||i.call(t)}getViewElement(){return this.view}layout(){var e,t;if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(As&&Wm.pointerEvents)){this.hide();return}(t=(e=this.delegate)==null?void 0:e.layout)==null||t.call(e),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(ot(e)){const u=xi(e),f=Bu(e);t={top:u.top*f,left:u.left*f,width:u.width*f,height:u.height*f}}else tw(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=Hm(this.view),s=Vm(this.view),r=this.delegate.anchorPosition||0,o=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;const d=mn();if(a===0){const u={offset:t.top-d.pageYOffset,size:t.height,position:r===0?0:1},f={offset:t.left,size:t.width,position:o===0?0:1,mode:Tt.ALIGN};l=Ri(d.innerHeight,s,u)+d.pageYOffset,pd.intersects({start:l,end:l+s},{start:u.offset,end:u.offset+u.size})&&(f.mode=Tt.AVOID),c=Ri(d.innerWidth,i,f)}else{const u={offset:t.left,size:t.width,position:o===0?0:1},f={offset:t.top,size:t.height,position:r===0?0:1,mode:Tt.ALIGN};c=Ri(d.innerWidth,i,u),pd.intersects({start:c,end:c+i},{start:u.offset,end:u.offset+u.size})&&(f.mode=Tt.AVOID),l=Ri(d.innerHeight,s,f)+d.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(r===0?"bottom":"top"),this.view.classList.add(o===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const h=xi(this.container);this.view.style.top=`${l-(this.useFixedPosition?xi(this.view).top:h.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?xi(this.view).left:h.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),sd(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,ae(e).document.activeElement):t&&!Te(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}};Ai.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],Ai.BUBBLE_DOWN_EVENTS=["click"];let Ha=Ai;const iw=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var nw=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},sw=function(n,e){return function(t,i){e(t,i,n)}};let zs=class extends D{constructor(e){super(),this.layoutService=e,this.contextView=this._register(new Ha(this.layoutService.mainContainer,1)),this.layout(),this._register(e.onDidLayoutContainer(()=>this.layout()))}showContextView(e,t,i){let s;t?t===this.layoutService.getContainer(ae(t))?s=1:i?s=3:s=2:s=1,this.contextView.setContainer(t??this.layoutService.activeContainer,s),this.contextView.show(e);const r={close:()=>{this.openContextView===r&&this.hideContextView()}};return this.openContextView=r,r}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e),this.openContextView=void 0}};zs=nw([sw(0,qt)],zs);class rw extends zs{getContextViewElement(){return this.contextView.getViewElement()}}class ow{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}async update(e,t,i){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let s;if(e===void 0||Um(e)||ot(e))s=e;else if(!$m(e.markdown))s=e.markdown??e.markdownNotSupportedFallback;else{this._hoverWidget||this.show(C("iconLabel.loading","Loading..."),t,i),this._cancellationTokenSource=new Fr;const r=this._cancellationTokenSource.token;if(s=await e.markdown(r),s===void 0&&(s=e.markdownNotSupportedFallback),this.isDisposed||r.isCancellationRequested)return}this.show(s,t,i)}show(e,t,i){var r;const s=this._hoverWidget;if(this.hasContent(e)){const o={content:e,target:this.target,actions:i==null?void 0:i.actions,linkHandler:i==null?void 0:i.linkHandler,trapFocus:i==null?void 0:i.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!s,showHoverHint:(r=i==null?void 0:i.appearance)==null?void 0:r.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(o,t)}s==null||s.dispose()}hasContent(e){return e?Oi(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)==null?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)==null||e.dispose(),(t=this._cancellationTokenSource)==null||t.dispose(!0),this._cancellationTokenSource=void 0}}var aw=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},dn=function(n,e){return function(t,i){e(t,i,n)}};let Va=class extends D{constructor(e,t,i,s,r){super(),this._instantiationService=e,this._keybindingService=i,this._layoutService=s,this._accessibilityService=r,this._managedHovers=new Map,t.onDidShowContextMenu(()=>this.hideHover()),this._contextViewHandler=this._register(new zs(this._layoutService))}showHover(e,t,i){var l,c,d,h;if(lh(this._currentHoverOptions)===lh(e)||this._currentHover&&((c=(l=this._currentHoverOptions)==null?void 0:l.persistence)!=null&&c.sticky))return;this._currentHoverOptions=e,this._lastHoverOptions=e;const s=e.trapFocus||this._accessibilityService.isScreenReaderOptimized(),r=Ft();i||(s&&r?r.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=r):this._lastFocusedElementBeforeOpen=void 0);const o=new ie,a=this._instantiationService.createInstance(Wa,e);if((d=e.persistence)!=null&&d.sticky&&(a.isLocked=!0),a.onDispose(()=>{var f,g;((f=this._currentHover)==null?void 0:f.domNode)&&Vu(this._currentHover.domNode)&&((g=this._lastFocusedElementBeforeOpen)==null||g.focus()),this._currentHoverOptions===e&&(this._currentHoverOptions=void 0),o.dispose()},void 0,o),!e.container){const u=ot(e.target)?e.target:e.target.targetElements[0];e.container=this._layoutService.getContainer(ae(u))}if(this._contextViewHandler.showContextView(new lw(a,t),e.container),a.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,o),(h=e.persistence)!=null&&h.sticky)o.add(I(ae(e.container).document,N.MOUSE_DOWN,u=>{Te(u.target,a.domNode)||this.doHideHover()}));else{if("targetElements"in e.target)for(const f of e.target.targetElements)o.add(I(f,N.CLICK,()=>this.hideHover()));else o.add(I(e.target,N.CLICK,()=>this.hideHover()));const u=Ft();if(u){const f=ae(u).document;o.add(I(u,N.KEY_DOWN,g=>{var p;return this._keyDown(g,a,!!((p=e.persistence)!=null&&p.hideOnKeyDown))})),o.add(I(f,N.KEY_DOWN,g=>{var p;return this._keyDown(g,a,!!((p=e.persistence)!=null&&p.hideOnKeyDown))})),o.add(I(u,N.KEY_UP,g=>this._keyUp(g,a))),o.add(I(f,N.KEY_UP,g=>this._keyUp(g,a)))}}if("IntersectionObserver"in Ue){const u=new IntersectionObserver(g=>this._intersectionChange(g,a),{threshold:0}),f="targetElements"in e.target?e.target.targetElements[0]:e.target;u.observe(f),o.add(le(()=>u.disconnect()))}return this._currentHover=a,a}hideHover(){var e;(e=this._currentHover)!=null&&e.isLocked||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showHover(this._lastHoverOptions,!0,!0)}_keyDown(e,t,i){var o,a;if(e.key==="Alt"){t.isLocked=!0;return}const s=new je(e);this._keybindingService.resolveKeyboardEvent(s).getSingleModifierDispatchChords().some(l=>!!l)||this._keybindingService.softDispatch(s,s.target).kind!==0||i&&(!((o=this._currentHoverOptions)!=null&&o.trapFocus)||e.key!=="Tab")&&(this.hideHover(),(a=this._lastFocusedElementBeforeOpen)==null||a.focus())}_keyUp(e,t){var i;e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),(i=this._lastFocusedElementBeforeOpen)==null||i.focus()))}setupManagedHover(e,t,i,s){t.setAttribute("custom-hover","true"),t.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",t.title),t.title="");let r,o;const a=(_,m)=>{var y;const v=o!==void 0;_&&(o==null||o.dispose(),o=void 0),m&&(r==null||r.dispose(),r=void 0),v&&((y=e.onDidHideHover)==null||y.call(e),o=void 0)},l=(_,m,v,y)=>new mc(async()=>{(!o||o.isDisposed)&&(o=new ow(e,v||t,_>0),await o.update(typeof i=="function"?i():i,m,{...s,trapFocus:y}))},_);let c=!1;const d=I(t,N.MOUSE_DOWN,()=>{c=!0,a(!0,!0)},!0),h=I(t,N.MOUSE_UP,()=>{c=!1},!0),u=I(t,N.MOUSE_LEAVE,_=>{c=!1,a(!1,_.fromElement===t)},!0),f=_=>{if(r)return;const m=new ie,v={targetElements:[t],dispose:()=>{}};if(e.placement===void 0||e.placement==="mouse"){const y=L=>{v.x=L.x+10,ot(L.target)&&ch(L.target,t)!==t&&a(!0,!0)};m.add(I(t,N.MOUSE_MOVE,y,!0))}r=m,!(ot(_.target)&&ch(_.target,t)!==t)&&m.add(l(e.delay,!1,v))},g=I(t,N.MOUSE_OVER,f,!0),p=()=>{if(c||r)return;const _={targetElements:[t],dispose:()=>{}},m=new ie,v=()=>a(!0,!0);m.add(I(t,N.BLUR,v,!0)),m.add(l(e.delay,!1,_)),r=m};let b;const w=t.tagName.toLowerCase();w!=="input"&&w!=="textarea"&&(b=I(t,N.FOCUS,p,!0));const S={show:_=>{a(!1,!0),l(0,_,void 0,_)},hide:()=>{a(!0,!0)},update:async(_,m)=>{i=_,await(o==null?void 0:o.update(i,void 0,m))},dispose:()=>{this._managedHovers.delete(t),g.dispose(),u.dispose(),d.dispose(),h.dispose(),b==null||b.dispose(),a(!0,!0)}};return this._managedHovers.set(t,S),S}showManagedHover(e){const t=this._managedHovers.get(e);t&&t.show(!0)}dispose(){this._managedHovers.forEach(e=>e.dispose()),super.dispose()}};Va=aw([dn(0,re),dn(1,Wr),dn(2,ht),dn(3,qt),dn(4,fi)],Va);function lh(n){if(n!==void 0)return(n==null?void 0:n.id)??n}class lw{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t,this.layer=1}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function ch(n,e){for(e=e??ae(n).document.body;!n.hasAttribute("custom-hover")&&n!==e;)n=n.parentElement;return n}V(qr,Va,1);Up((n,e)=>{const t=n.getColor(xg);t&&(e.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});const ue={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1},cw=Object.freeze({id:"editor",order:5,type:"object",title:C("editorConfigurationTitle","Editor"),scope:5}),js={...cw,properties:{"editor.tabSize":{type:"number",default:Je.tabSize,minimum:1,markdownDescription:C("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:C("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:Je.insertSpaces,markdownDescription:C("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:Je.detectIndentation,markdownDescription:C("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:Je.trimAutoWhitespace,description:C("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:Je.largeFileOptimizations,description:C("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[C("wordBasedSuggestions.off","Turn off Word Based Suggestions."),C("wordBasedSuggestions.currentDocument","Only suggest words from the active document."),C("wordBasedSuggestions.matchingDocuments","Suggest words from all open documents of the same language."),C("wordBasedSuggestions.allDocuments","Suggest words from all open documents.")],description:C("wordBasedSuggestions","Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[C("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),C("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),C("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:C("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:C("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:C("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:C("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:C("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:C("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:C("editor.experimental.treeSitterTelemetry","Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `editor.experimental.preferTreeSitter` for specific languages will take precedence."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:C("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:C("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:C("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:C("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:C("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:C("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:ue.maxComputationTime,description:C("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:ue.maxFileSize,description:C("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:ue.renderSideBySide,description:C("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:ue.renderSideBySideInlineBreakpoint,description:C("renderSideBySideInlineBreakpoint","If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:ue.useInlineViewWhenSpaceIsLimited,description:C("useInlineViewWhenSpaceIsLimited","If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:ue.renderMarginRevertIcon,description:C("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:ue.renderGutterMenu,description:C("renderGutterMenu","When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:ue.ignoreTrimWhitespace,description:C("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:ue.renderIndicators,description:C("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:ue.diffCodeLens,description:C("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:ue.diffWordWrap,markdownEnumDescriptions:[C("wordWrap.off","Lines will never wrap."),C("wordWrap.on","Lines will wrap at the viewport width."),C("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:ue.diffAlgorithm,markdownEnumDescriptions:[C("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),C("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:ue.hideUnchangedRegions.enabled,markdownDescription:C("hideUnchangedRegions.enabled","Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:ue.hideUnchangedRegions.revealLineCount,markdownDescription:C("hideUnchangedRegions.revealLineCount","Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:ue.hideUnchangedRegions.minimumLineCount,markdownDescription:C("hideUnchangedRegions.minimumLineCount","Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:ue.hideUnchangedRegions.contextLineCount,markdownDescription:C("hideUnchangedRegions.contextLineCount","Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:ue.experimental.showMoves,markdownDescription:C("showMoves","Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:ue.experimental.showEmptyDecorations,description:C("showEmptyDecorations","Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:ue.experimental.useTrueInlineView,description:C("useTrueInlineView","If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function dw(n){return typeof n.type<"u"||typeof n.anyOf<"u"}for(const n of Ig){const e=n.schema;if(typeof e<"u")if(dw(e))js.properties[`editor.${n.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(js.properties[t]=e[t])}let cs=null;function Ff(){return cs===null&&(cs=Object.create(null),Object.keys(js.properties).forEach(n=>{cs[n]=!0})),cs}function hw(n){return Ff()[`editor.${n}`]||!1}function uw(n){return Ff()[`diffEditor.${n}`]||!1}const fw=Ut.as(Or.Configuration);fw.registerConfiguration(js);function ds(n){return Object.isFrozen(n)?n:Mg(n)}class de{static createEmptyModel(e){return new de({},[],[],void 0,e)}constructor(e,t,i,s,r){this._contents=e,this._keys=t,this._overrides=i,this.raw=s,this.logService=r,this.overrideConfigurations=new Map}get rawConfiguration(){var e;if(!this._rawConfiguration)if((e=this.raw)!=null&&e.length){const t=this.raw.map(i=>{if(i instanceof de)return i;const s=new gw("",this.logService);return s.parseRaw(i),s.configurationModel});this._rawConfiguration=t.reduce((i,s)=>s===i?s:i.merge(s),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?jc(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return ds(i.rawConfiguration.getValue(e))},get override(){return t?ds(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return ds(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const s=[];for(const{contents:r,identifiers:o,keys:a}of i.rawConfiguration.overrides){const l=new de(r,a,[],void 0,i.logService).getValue(e);l!==void 0&&s.push({identifiers:o,value:l})}return s.length?ds(s):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?jc(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){var o,a;const t=vi(this.contents),i=vi(this.overrides),s=[...this.keys],r=(o=this.raw)!=null&&o.length?[...this.raw]:[this];for(const l of e)if(r.push(...(a=l.raw)!=null&&a.length?l.raw:[l]),!l.isEmpty()){this.mergeContents(t,l.contents);for(const c of l.overrides){const[d]=i.filter(h=>Pt(h.identifiers,c.identifiers));d?(this.mergeContents(d.contents,c.contents),d.keys.push(...c.keys),d.keys=rd(d.keys)):i.push(vi(c))}for(const c of l.keys)s.indexOf(c)===-1&&s.push(c)}return new de(t,s,i,r.every(l=>l instanceof de)?void 0:r,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const s of rd([...Object.keys(this.contents),...Object.keys(t)])){let r=this.contents[s];const o=t[s];o&&(typeof r=="object"&&typeof o=="object"?(r=vi(r),this.mergeContents(r,o)):r=o),i[s]=r}return new de(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&od(e[i])&&od(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=vi(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const s=r=>{r&&(i?this.mergeContents(i,r):i=vi(r))};for(const r of this.overrides)r.identifiers.length===1&&r.identifiers[0]===e?t=r.contents:r.identifiers.includes(e)&&s(r.contents);return s(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),Dg(this.contents,e),Is.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>Pt(i.identifiers,vo(e))),1))}updateValue(e,t,i){if(Rg(this.contents,e,t,s=>this.logService.error(s)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),Is.test(e)){const s=vo(e),r={identifiers:s,keys:Object.keys(this.contents[e]),contents:wo(this.contents[e],a=>this.logService.error(a))},o=this.overrides.findIndex(a=>Pt(a.identifiers,s));o!==-1?this.overrides[o]=r:this.overrides.push(r)}}}class gw{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||de.createEmptyModel(this.logService)}parseRaw(e,t){this._raw=e;const{contents:i,keys:s,overrides:r,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new de(i,s,r,a?[e]:void 0,this.logService),this._restrictedConfigurations=o||[]}doParseRaw(e,t){const i=Ut.as(Or.Configuration).getConfigurationProperties(),s=this.filter(e,i,!0,t);e=s.raw;const r=wo(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),o=Object.keys(e),a=this.toOverrides(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:r,keys:o,overrides:a,restricted:s.restricted,hasExcludedProperties:s.hasExcludedProperties}}filter(e,t,i,s){var l,c,d;let r=!1;if(!(s!=null&&s.scopes)&&!(s!=null&&s.skipRestricted)&&!((l=s==null?void 0:s.exclude)!=null&&l.length))return{raw:e,restricted:[],hasExcludedProperties:r};const o={},a=[];for(const h in e)if(Is.test(h)&&i){const u=this.filter(e[h],t,!1,s);o[h]=u.raw,r=r||u.hasExcludedProperties,a.push(...u.restricted)}else{const u=t[h],f=u?typeof u.scope<"u"?u.scope:3:void 0;u!=null&&u.restricted&&a.push(h),!((c=s.exclude)!=null&&c.includes(h))&&((d=s.include)!=null&&d.includes(h)||(f===void 0||s.scopes===void 0||s.scopes.includes(f))&&!(s.skipRestricted&&(u!=null&&u.restricted)))?o[h]=e[h]:r=!0}return{raw:o,restricted:a,hasExcludedProperties:r}}toOverrides(e,t){const i=[];for(const s of Object.keys(e))if(Is.test(s)){const r={};for(const o in e[s])r[o]=e[s][o];i.push({identifiers:vo(s),keys:Object.keys(r),contents:wo(r,t)})}return i}}class mw{constructor(e,t,i,s,r,o,a,l,c,d,h,u,f){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=s,this.defaultConfiguration=r,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=d,this.workspaceConfiguration=h,this.folderConfigurationModel=u,this.memoryConfigurationModel=f}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class jr{constructor(e,t,i,s,r,o,a,l,c,d){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=s,this._remoteUserConfiguration=r,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=d,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new Ke,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let s;i.resource?(s=this._memoryConfigurationByResource.get(i.resource),s||(s=de.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,s))):s=this._memoryConfiguration,t===void 0?s.removeValue(e):s.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const s=this.getConsolidatedConfigurationModel(e,t,i),r=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of s.overrides)for(const c of l.identifiers)s.getOverrideValue(e,c)!==void 0&&a.add(c);return new mw(e,t,s.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,r||void 0,o)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let s=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(s=s.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(s=s.merge(this._policyConfiguration)),s}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const s=t.getFolder(e);s&&(i=this.getFolderConsolidatedConfiguration(s.uri)||i);const r=this._memoryConfigurationByResource.get(e);r&&(i=i.merge(r))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),s=this._folderConfigurations.get(e);s?(t=i.merge(s),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:s,keys:r}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:s,keys:r}]),e},[])}}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),s=this.parseConfigurationModel(e.policy,t),r=this.parseConfigurationModel(e.application,t),o=this.parseConfigurationModel(e.user,t),a=this.parseConfigurationModel(e.workspace,t),l=e.folders.reduce((c,d)=>(c.set(Ae.revive(d[0]),this.parseConfigurationModel(d[1],t)),c),new Ke);return new jr(i,s,r,o,de.createEmptyModel(t),a,l,de.createEmptyModel(t),new Ke,t)}static parseConfigurationModel(e,t){return new de(e.contents,e.keys,e.overrides,void 0,t)}}class pw{constructor(e,t,i,s,r){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=s,this.logService=r,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const a of o)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=jr.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,s=this._affectsConfigStr.indexOf(i);if(s<0)return!1;const r=s+i.length;if(r>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(r);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!wu(l,c)}return!0}}const Gs={kind:0},_w={kind:1};function bw(n,e,t){return{kind:2,commandId:n,commandArgs:e,isBubble:t}}class Sn{constructor(e,t,i){var s;this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const r of e){const o=r.command;o&&o.charAt(0)!=="-"&&this._defaultBoundCommands.set(o,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=Sn.handleRemovals([].concat(e).concat(t));for(let r=0,o=this._keybindings.length;r<o;r++){const a=this._keybindings[r];if(a.chords.length===0)continue;const l=(s=a.when)==null?void 0:s.substituteConstants();l&&l.type===0||this._addKeyPress(a.chords[0],a)}}static _isTargetedForRemoval(e,t,i){if(t){for(let s=0;s<t.length;s++)if(t[s]!==e.chords[s])return!1}return!(i&&i.type!==1&&(!e.when||!qm(i,e.when)))}static handleRemovals(e){const t=new Map;for(let s=0,r=e.length;s<r;s++){const o=e[s];if(o.command&&o.command.charAt(0)==="-"){const a=o.command.substring(1);t.has(a)?t.get(a).push(o):t.set(a,[o])}}if(t.size===0)return e;const i=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];if(!o.command||o.command.length===0){i.push(o);continue}if(o.command.charAt(0)==="-")continue;const a=t.get(o.command);if(!a||!o.isDefault){i.push(o);continue}let l=!1;for(const c of a){const d=c.when;if(this._isTargetedForRemoval(o,c.chords,d)){l=!0;break}}if(!l){i.push(o);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let s=i.length-1;s>=0;s--){const r=i[s];if(r.command===t.command)continue;let o=!0;for(let a=1;a<r.chords.length&&a<t.chords.length;a++)if(r.chords[a]!==t.chords[a]){o=!1;break}o&&Sn.whenIsEntirelyIncluded(r.when,t.when)&&this._removeFromLookupMap(r)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,s=t.length;i<s;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:zm(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let s=i.length-1;s>=0;s--){const r=i[s];if(t.contextMatchesRules(r.when))return r}return i[i.length-1]}resolve(e,t,i){const s=[...t,i];this._log(`| Resolving ${s}`);const r=this._map.get(s[0]);if(r===void 0)return this._log("\\ No keybinding entries."),Gs;let o=null;if(s.length<2)o=r;else{o=[];for(let l=0,c=r.length;l<c;l++){const d=r[l];if(s.length>d.chords.length)continue;let h=!0;for(let u=1;u<s.length;u++)if(d.chords[u]!==s[u]){h=!1;break}h&&o.push(d)}}const a=this._findCommand(e,o);return a?s.length<a.chords.length?(this._log(`\\ From ${o.length} keybinding entries, awaiting ${a.chords.length-s.length} more chord(s), when: ${dh(a.when)}, source: ${hh(a)}.`),_w):(this._log(`\\ From ${o.length} keybinding entries, matched ${a.command}, when: ${dh(a.when)}, source: ${hh(a)}.`),bw(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${o.length} keybinding entries, no when clauses matched the context.`),Gs)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const s=t[i];if(Sn._contextMatchesRules(e,s.when))return s}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function dh(n){return n?`${n.serialize()}`:"no when condition"}function hh(n){return n.extensionId?n.isBuiltinExtension?`built-in extension ${n.extensionId}`:`user extension ${n.extensionId}`:n.isDefault?"built-in":"user"}const vw=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class ww extends D{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:ee.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,s,r){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=s,this._logService=r,this._onDidUpdateKeybindings=this._register(new R),this._currentChords=[],this._currentChordChecker=new Mu,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=Mi.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new mc,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),Gs;const[s]=i.getDispatchChords();if(s===null)return this._log("\\ Keyboard event cannot be dispatched"),Gs;const r=this._contextKeyService.getContext(t),o=this._currentChords.map(({keypress:a})=>a);return this._getResolver().resolve(r,o,s)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw Uu("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(C("first.chord","({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:s})=>s).join(", ");this._currentChordStatusMessage=this._notificationService.status(C("next.chord","({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),Jr.enabled&&Jr.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],Jr.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[s]=i.getSingleModifierDispatchChords();if(s)return this._ignoreSingleModifiers.has(s)?(this._log(`+ Ignoring single modifier ${s} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=Mi.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=Mi.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${s}.`),this._currentSingleModifier=s,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):s===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${s} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[r]=i.getChords();return this._ignoreSingleModifiers=new Mi(r),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let s=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let r=null,o=null;if(i){const[d]=e.getSingleModifierDispatchChords();r=d,o=d?[d]:[]}else[r]=e.getDispatchChords(),o=this._currentChords.map(({keypress:d})=>d);if(r===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),s;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,o,r);switch(c.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",l,"[ No matching keybinding ]"),this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(C("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),s=!0}return s}case 1:return this._logService.trace("KeybindingService#dispatch",l,"[ Several keybindings match - more chords needed ]"),s=!0,this._expectAnotherChord(r,l),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),s;case 2:{if(this._logService.trace("KeybindingService#dispatch",l,`[ Will dispatch command ${c.commandId} ]`),c.commandId===null||c.commandId===""){if(this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(C("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),s=!0}}else{this.inChordMode&&this._leaveChordMode(),c.isBubble||(s=!0),this._log(`+ Invoking command ${c.commandId}.`),this._currentlyDispatchingCommandId=c.commandId;try{typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,d=>this._notificationService.warn(d)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,d=>this._notificationService.warn(d))}finally{this._currentlyDispatchingCommandId=null}vw.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding",detail:e.getUserSettingsLabel()??void 0})}return s}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}const br=class br{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}};br.EMPTY=new br(null);let Mi=br;class uh{constructor(e,t,i,s,r,o,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?Ua(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=Ua(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=s,this.isDefault=r,this.extensionId=o,this.isBuiltinExtension=a}}function Ua(n){const e=[];for(let t=0,i=n.length;t<i;t++){const s=n[t];if(!s)return[];e.push(s)}return e}class Sw extends jm{constructor(e,t){if(super(),t.length===0)throw Gm("chords");this._os=e,this._chords=t}getLabel(){return $p.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return qp.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:zp.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return jp.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new Zm(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class Un extends Sw{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return sn.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":sn.toString(e.keyCode)}_getElectronAccelerator(e){return sn.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=sn.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return Un.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=sn.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=Km[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof xo)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new xo(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=Ua(e.chords.map(s=>this._toKeyCodeChord(s)));return i.length>0?[new Un(i,t)]:[]}}var fh;(function(n){n.inspectTokensAction=C("inspectTokens","Developer: Inspect Tokens")})(fh||(fh={}));var gh;(function(n){n.gotoLineActionLabel=C("gotoLineActionLabel","Go to Line/Column...")})(gh||(gh={}));var mh;(function(n){n.helpQuickAccessActionLabel=C("helpQuickAccess","Show all Quick Access Providers")})(mh||(mh={}));var ph;(function(n){n.quickCommandActionLabel=C("quickCommandActionLabel","Command Palette"),n.quickCommandHelp=C("quickCommandActionHelp","Show And Run Commands")})(ph||(ph={}));var _h;(function(n){n.quickOutlineActionLabel=C("quickOutlineActionLabel","Go to Symbol..."),n.quickOutlineByCategoryActionLabel=C("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(_h||(_h={}));var $a;(function(n){n.editorViewAccessibleLabel=C("editorViewAccessibleLabel","Editor content")})($a||($a={}));var bh;(function(n){n.toggleHighContrast=C("toggleHighContrast","Toggle High Contrast Theme")})(bh||(bh={}));var qa;(function(n){n.bulkEditServiceSummary=C("bulkEditServiceSummary","Made {0} edits in {1} files")})(qa||(qa={}));const Cw=dt("workspaceTrustManagementService");let zi=[],Ic=[],Bf=[];function hs(n,e=!1){yw(n,!1,e)}function yw(n,e,t){const i=Lw(n,e);zi.push(i),i.userConfigured?Bf.push(i):Ic.push(i),t&&!i.userConfigured&&zi.forEach(s=>{s.mime===i.mime||s.userConfigured||(i.extension&&s.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&s.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&s.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&s.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function Lw(n,e){return{id:n.id,mime:n.mime,filename:n.filename,extension:n.extension,filepattern:n.filepattern,firstline:n.firstline,userConfigured:e,filenameLowercase:n.filename?n.filename.toLowerCase():void 0,extensionLowercase:n.extension?n.extension.toLowerCase():void 0,filepatternLowercase:n.filepattern?Nf(n.filepattern.toLowerCase()):void 0,filepatternOnPath:n.filepattern?n.filepattern.indexOf(ko.sep)>=0:!1}}function kw(){zi=zi.filter(n=>n.userConfigured),Ic=[]}function Ew(n,e){return xw(n,e).map(t=>t.id)}function xw(n,e){let t;if(n)switch(n.scheme){case se.file:t=n.fsPath;break;case se.data:{t=Gc.parseMetaData(n).get(Gc.META_DATA_LABEL);break}case se.vscodeNotebookCell:t=void 0;break;default:t=n.path}if(!t)return[{id:"unknown",mime:nn.unknown}];t=t.toLowerCase();const i=Pu(t),s=vh(t,i,Bf);if(s)return[s,{id:At,mime:nn.text}];const r=vh(t,i,Ic);if(r)return[r,{id:At,mime:nn.text}];if(e){const o=Iw(e);if(o)return[o,{id:At,mime:nn.text}]}return[{id:"unknown",mime:nn.unknown}]}function vh(n,e,t){var o;let i,s,r;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){i=l;break}if(l.filepattern&&(!s||l.filepattern.length>s.filepattern.length)){const c=l.filepatternOnPath?n:e;(o=l.filepatternLowercase)!=null&&o.call(l,c)&&(s=l)}l.extension&&(!r||l.extension.length>r.extension.length)&&e.endsWith(l.extensionLowercase)&&(r=l)}if(i)return i;if(s)return s;if(r)return r}function Iw(n){if($u(n)&&(n=n.substr(1)),n.length>0)for(let e=zi.length-1;e>=0;e--){const t=zi[e];if(!t.firstline)continue;const i=n.match(t.firstline);if(i&&i.length>0)return t}}const us=Object.prototype.hasOwnProperty,wh="vs.editor.nullLanguage";class Dw{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(wh,0),this._register(At,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||wh}}const Dn=class Dn extends D{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new R),this.onDidChange=this._onDidChange.event,Dn.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new Dw,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(Ds.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){Dn.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},kw();const e=[].concat(Ds.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(s=>{this._lowercaseNameMap[s.toLowerCase()]=i.identifier}),i.mimetypes.forEach(s=>{this._mimeTypesMap[s]=i.identifier})}),Ut.as(Or.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;us.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let s=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),s=t.mimetypes[0]),s||(s=`text/x-${i}`,e.mimetypes.push(s)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)hs({id:i,mime:s,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)hs({id:i,mime:s,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)hs({id:i,mime:s,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);Xm(l)||hs({id:i,mime:s,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let r=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?r=[null]:r=t.aliases),r!==null)for(const a of r)!a||a.length===0||e.aliases.push(a);const o=r!==null&&r.length>0;if(!(o&&r[0]===null)){const a=(o?r[0]:null)||i;(o||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?us.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return us.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&us.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:Ew(e,t)}};Dn.instanceCount=0;let za=Dn;function Rw(n,e,t,i){return e||(e=s=>s!=null),new Promise((s,r)=>{let o=!0,a=!1;const l=n.map(d=>({isFinished:e(d),error:!1,state:d})),c=$(d=>{const{isFinished:h,error:u,state:f}=l.read(d);(h||u)&&(o?a=!0:c.dispose(),u?r(u===!0?f:u):s(f))});o=!1,a&&c.dispose()})}class Mw extends Gp{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=t}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const e of this.observers)for(const t of this._deltas)e.handleChange(this,t);this._deltas.length=0}else for(const e of this.observers)e.handleChange(this,void 0)}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const e of this.observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const e=[...this.observers];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this.observers.has(e)&&this._updateCounter>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this._updateCounter>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let s;t||(t=s=new lf(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),i!==void 0&&this._deltas.push(i),t.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(r,o)=>{},handlePossibleChange:r=>{}},this),this._updateCounter>1)for(const r of this.observers)r.handlePossibleChange(this)}finally{s&&s.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function ja(n,e){return n.lazy?new Mw(new _d(n.owner,n.debugName,void 0),e,n.equalsFn??bd):new Zp(new _d(n.owner,n.debugName,void 0),e,n.equalsFn??bd)}const Rn=class Rn extends D{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new R),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new R),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new R({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,Rn.instanceCount++,this._registry=this._register(new za(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){Rn.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){const i=this._registry.guessLanguageIdByFilepathOrFirstLine(e,t);return Au(i,null)}createById(e){return new Sh(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new Sh(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=At),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),Le.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}};Rn.instanceCount=0;let Ga=Rn;class Sh{constructor(e,t){this._value=ne(this,e,()=>t()),this.onDidChange=ee.fromObservable(this._value)}get languageId(){return this._value.get()}}const Za=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,ao=/(&amp;)?(&amp;)([^\s&])/g;var Zs;(function(n){n[n.Right=0]="Right",n[n.Left=1]="Left"})(Zs||(Zs={}));var Ka;(function(n){n[n.Above=0]="Above",n[n.Below=1]="Below"})(Ka||(Ka={}));class Wi extends ni{constructor(e,t,i,s){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const r=document.createElement("div");r.classList.add("monaco-menu"),r.setAttribute("role","presentation"),super(r,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,i,o),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...ui||Pn?[10]:[]],keyDown:!0}}),this.menuStyles=s,this.menuElement=r,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,s),this._register(Rs.addTarget(r)),this._register(I(r,N.KEY_DOWN,c=>{new je(c).equals(2)&&c.preventDefault()})),i.enableMnemonics&&this._register(I(r,N.KEY_DOWN,c=>{const d=c.key.toLocaleLowerCase();if(this.mnemonics.has(d)){pe.stop(c,!0);const h=this.mnemonics.get(d);if(h.length===1&&(h[0]instanceof Ch&&h[0].container&&this.focusItemByElement(h[0].container),h[0].onClick(c)),h.length>1){const u=h.shift();u&&u.container&&(this.focusItemByElement(u.container),h.push(u)),this.mnemonics.set(d,h)}}})),Pn&&this._register(I(r,N.KEY_DOWN,c=>{const d=new je(c);d.equals(14)||d.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),pe.stop(c,!0)):(d.equals(13)||d.equals(12))&&(this.focusedItem=0,this.focusPrevious(),pe.stop(c,!0))})),this._register(I(this.domNode,N.MOUSE_OUT,c=>{const d=c.relatedTarget;Te(d,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(I(this.actionsList,N.MOUSE_OVER,c=>{let d=c.target;if(!(!d||!Te(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}})),this._register(Rs.addTarget(this.actionsList)),this._register(I(this.actionsList,Ms.Tap,c=>{let d=c.initialTarget;if(!(!d||!Te(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}}));const o={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new Su(r,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,s),this._register(I(r,Ms.Change,c=>{pe.stop(c,!0);const d=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:d-c.translationY})})),this._register(I(a,N.MOUSE_UP,c=>{c.preventDefault()}));const l=ae(e);r.style.maxHeight=`${Math.max(10,l.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((c,d)=>{var h;return(h=i.submenuIds)!=null&&h.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof vn&&(d===t.length-1||d===0||t[d-1]instanceof vn))}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof yh)).forEach((c,d,h)=>{c.updatePositionInSet(d+1,h.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(Io(e)?this.styleSheet=Fn(e):(Wi.globalStyleSheet||(Wi.globalStyleSheet=Fn()),this.styleSheet=Wi.globalStyleSheet)),this.styleSheet.textContent=Nw(t,Io(e))}styleScrollElement(e,t){const i=t.foregroundColor??"",s=t.backgroundColor??"",r=t.borderColor?`1px solid ${t.borderColor}`:"",o="5px",a=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=r,e.style.borderRadius=o,e.style.color=i,e.style.backgroundColor=s,e.style.boxShadow=a}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof vn)return new yh(t.context,e,{icon:!0},this.menuStyles);if(e instanceof Ym){const s=new Ch(e,e.actions,i,{...t,submenuIds:new Set([...t.submenuIds||[],e.id])},this.menuStyles);if(t.enableMnemonics){const r=s.getMnemonic();if(r&&s.isEnabled()){let o=[];this.mnemonics.has(r)&&(o=this.mnemonics.get(r)),o.push(s),this.mnemonics.set(r,o)}}return s}else{const s={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const o=t.getKeyBinding(e);if(o){const a=o.getLabel();a&&(s.keybinding=a)}}const r=new Wf(t.context,e,s,this.menuStyles);if(t.enableMnemonics){const o=r.getMnemonic();if(o&&r.isEnabled()){let a=[];this.mnemonics.has(o)&&(a=this.mnemonics.get(o)),a.push(r),this.mnemonics.set(o,a)}}return r}}}class Wf extends Kp{constructor(e,t,i,s){if(i.isMenu=!0,super(t,t,i),this.menuStyle=s,this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){const r=this.action.label;if(r){const o=Za.exec(r);o&&(this.mnemonic=(o[1]?o[1]:o[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new hi(()=>{this.element&&(this._register(I(this.element,N.MOUSE_UP,r=>{if(pe.stop(r,!0),Qm){if(new qu(ae(this.element),r).rightButton)return;this.onClick(r)}else setTimeout(()=>{this.onClick(r)},0)})),this._register(I(this.element,N.CONTEXT_MENU,r=>{pe.stop(r,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=G(this.element,he("a.action-menu-item")),this._action.id===vn.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=G(this.item,he("span.menu-item-check"+$e.asCSSSelector(we.menuSelection))),this.check.setAttribute("role","none"),this.label=G(this.item,he("span.action-label")),this.options.label&&this.options.keybinding&&(G(this.item,he("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var e;super.focus(),(e=this.item)==null||e.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){Wu(this.label);let t=Tg(this.action.label);if(t){const i=Tw(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const s=Za.exec(t);if(s){t=Jm(t),ao.lastIndex=0;let r=ao.exec(t);for(;r&&r[1];)r=ao.exec(t);const o=a=>a.replace(/&amp;&amp;/g,"&amp;");r?this.label.append(gc(o(t.substr(0,r.index))," "),he("u",{"aria-hidden":"true"},r[3]),ep(o(t.substr(r.index+r[0].length))," ")):this.label.innerText=o(t).trim(),(e=this.item)==null||e.setAttribute("aria-keyshortcuts",(s[1]?s[1]:s[3]).toLocaleLowerCase())}else this.label.innerText=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,s=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",r=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=s,this.item.style.outlineOffset=r),this.check&&(this.check.style.color=t??"")}}class Ch extends Wf{constructor(e,t,i,s,r){super(e,e,s,r),this.submenuActions=t,this.parentData=i,this.submenuOptions=s,this.mysubmenu=null,this.submenuDisposables=this._register(new ie),this.mouseOver=!1,this.expandDirection=s&&s.expandDirection!==void 0?s.expandDirection:{horizontal:Zs.Right,vertical:Ka.Below},this.showScheduler=new hi(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new hi(()=>{this.element&&!Te(Ft(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=G(this.item,he("span.submenu-indicator"+$e.asCSSSelector(we.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(I(this.element,N.KEY_UP,t=>{const i=new je(t);(i.equals(17)||i.equals(3))&&(pe.stop(t,!0),this.createSubmenu(!0))})),this._register(I(this.element,N.KEY_DOWN,t=>{const i=new je(t);Ft()===this.item&&(i.equals(17)||i.equals(3))&&pe.stop(t,!0)})),this._register(I(this.element,N.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(I(this.element,N.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(I(this.element,N.FOCUS_OUT,t=>{this.element&&!Te(Ft(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){pe.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,s){const r={top:0,left:0};return r.left=Ri(e.width,t.width,{position:s.horizontal===Zs.Right?0:1,offset:i.left,size:i.width}),r.left>=i.left&&r.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(r.left=i.left+10),i.top+=10,i.height=0),r.top=Ri(e.height,t.height,{position:0,offset:i.top,size:0}),r.top+t.height===i.top&&r.top+i.height+t.height<=e.height&&(r.top+=i.height),r}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=G(this.element,he("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=ae(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Wi(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new tp],this.submenuOptions,this.menuStyle);const s=this.element.getBoundingClientRect(),r={top:s.top-i,left:s.left,height:s.height+2*i,width:s.width},o=this.submenuContainer.getBoundingClientRect(),a=ae(this.element),{top:l,left:c}=this.calculateSubmenuMenuLayout(new ad(a.innerWidth,a.innerHeight),ad.lift(o),r,this.expandDirection);this.submenuContainer.style.left=`${c-o.left}px`,this.submenuContainer.style.top=`${l-o.top}px`,this.submenuDisposables.add(I(this.submenuContainer,N.KEY_UP,d=>{new je(d).equals(15)&&(pe.stop(d,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(I(this.submenuContainer,N.KEY_DOWN,d=>{new je(d).equals(15)&&pe.stop(d,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)==null||t.setAttribute("aria-expanded",e))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class yh extends Xp{constructor(e,t,i,s){super(e,t,i),this.menuStyles=s}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function Tw(n){const e=Za,t=e.exec(n);if(!t)return n;const i=!t[1];return n.replace(e,i?"$2$3":"").trim()}function Lh(n){const e=ip()[n.id];return`.codicon-${n.id}:before { content: '\\${e.toString(16)}'; }`}function Nw(n,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${Lh(we.menuSelection)}
${Lh(we.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const i=n.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const s=n.scrollbarSliderBackground;s&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${s};
				}
			`);const r=n.scrollbarSliderHoverBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${r};
				}
			`);const o=n.scrollbarSliderActiveBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${o};
				}
			`)}return t}class Aw{constructor(e,t,i,s){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=s,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=Ft();let i;const s=ot(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:r=>{var d;this.lastContainer=r;const o=e.getMenuClassName?e.getMenuClassName():"";o&&(r.className+=" "+o),this.options.blockMouse&&(this.block=r.appendChild(he(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(d=this.blockDisposable)==null||d.dispose(),this.blockDisposable=I(this.block,N.MOUSE_DOWN,h=>h.stopPropagation()));const a=new ie,l=e.actionRunner||new zu;l.onWillRun(h=>this.onActionRun(h,!e.skipTelemetry),this,a),l.onDidRun(this.onDidActionRun,this,a),i=new Wi(r,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:h=>this.keybindingService.lookupKeybinding(h.id)},Yp),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a);const c=ae(r);return a.add(I(c,N.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(I(c,N.MOUSE_DOWN,h=>{if(h.defaultPrevented)return;const u=new qu(c,h);let f=u.target;if(!u.rightButton){for(;f;){if(f===r)return;f=f.parentElement}this.contextViewService.hideContextView(!0)}})),ju(a,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:r=>{var o,a,l;(o=e.onHide)==null||o.call(e,!!r),this.block&&(this.block.remove(),this.block=null),(a=this.blockDisposable)==null||a.dispose(),this.blockDisposable=null,this.lastContainer&&(Ft()===this.lastContainer||Te(Ft(),this.lastContainer))&&((l=this.focusToReturn)==null||l.focus()),this.lastContainer=null}},s,!!s)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!Gu(e.error)&&this.notificationService.error(e.error)}}var Ow=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Li=function(n,e){return function(t,i){e(t,i,n)}};let Xa=class extends D{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new Aw(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,s,r,o){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=s,this.menuService=r,this.contextKeyService=o,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new R),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new R)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=Ya.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...e,onHide:t=>{var i;(i=e.onHide)==null||i.call(e,t),this._onDidHideContextMenu.fire()}}),np.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};Xa=Ow([Li(0,Qn),Li(1,$t),Li(2,pc),Li(3,ht),Li(4,Br),Li(5,me)],Xa);var Ya;(function(n){function e(i){return i&&i.menuId instanceof ii}function t(i,s,r){if(!e(i))return i;const{menuId:o,menuActionOptions:a,contextKeyService:l}=i;return{...i,getActions:()=>{const c=[];if(o){const d=s.getMenuActions(o,l??r,a);Qp(d,c)}return i.getActions?vn.join(i.getActions(),c):c}}}n.transform=t})(Ya||(Ya={}));var Ks;(function(n){n[n.API=0]="API",n[n.USER=1]="USER"})(Ks||(Ks={}));var Dc=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Xs=function(n,e){return function(t,i){e(t,i,n)}};let Qa=class{constructor(e){this._commandService=e}async open(e,t){if(!sp(e,se.command))return!1;if(!(t!=null&&t.allowCommands)||(typeof e=="string"&&(e=Ae.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=Zc(decodeURIComponent(e.query))}catch{try{i=Zc(e.query)}catch{}}return Array.isArray(i)||(i=[i]),await this._commandService.executeCommand(e.path,...i),!0}};Qa=Dc([Xs(0,Yi)],Qa);let Ja=class{constructor(e){this._editorService=e}async open(e,t){typeof e=="string"&&(e=Ae.parse(e));const{selection:i,uri:s}=Ng(e);return e=s,e.scheme===se.file&&(e=Ag(e)),await this._editorService.openCodeEditor({resource:e,options:{selection:i,source:t!=null&&t.fromUserGesture?Ks.USER:Ks.API,...t==null?void 0:t.editorOptions}},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0}};Ja=Dc([Xs(0,Ce)],Ja);let el=class{constructor(e,t){this._openers=new Ei,this._validators=new Ei,this._resolvers=new Ei,this._resolvedUriTargets=new Ke(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new Ei,this._defaultExternalOpener={openExternal:async i=>(ld(i,se.http,se.https)?Nu(i):Ue.location.href=i,!0)},this._openers.push({open:async(i,s)=>s!=null&&s.openExternal||ld(i,se.mailto,se.http,se.https,se.vsls)?(await this._doOpenExternal(i,s),!0):!1}),this._openers.push(new Qa(t)),this._openers.push(new Ja(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}async open(e,t){const i=typeof e=="string"?Ae.parse(e):e,s=this._resolvedUriTargets.get(i)??e;for(const r of this._validators)if(!await r.shouldOpen(s,t))return!1;for(const r of this._openers)if(await r.open(e,t))return!0;return!1}async resolveExternalUri(e,t){for(const i of this._resolvers)try{const s=await i.resolveExternalUri(e,t);if(s)return this._resolvedUriTargets.has(s.resolved)||this._resolvedUriTargets.set(s.resolved,e),s}catch{}throw new Error("Could not resolve external URI: "+e.toString())}async _doOpenExternal(e,t){const i=typeof e=="string"?Ae.parse(e):e;let s;try{s=(await this.resolveExternalUri(i,t)).resolved}catch{s=i}let r;if(typeof e=="string"&&i.toString()===s.toString()?r=e:r=encodeURI(s.toString(!0)),t!=null&&t.allowContributedOpeners){const o=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(await a.openExternal(r,{sourceUri:i,preferredOpenerId:o},Bn.None))return!0}return this._defaultExternalOpener.openExternal(r,{sourceUri:i},Bn.None)}dispose(){this._validators.clear()}};el=Dc([Xs(0,Ce),Xs(1,Yi)],el);var Pw=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},kh=function(n,e){return function(t,i){e(t,i,n)}};let tl=class extends D{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new R),this._markerDecorations=new Ke,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new Fw(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var i;const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===se.inMemory||e.uri.scheme===se.internal||e.uri.scheme===se.vscode)&&((i=this._markerService)==null||i.read({resource:e.uri}).map(s=>s.owner).forEach(s=>this._markerService.remove(s,[e.uri])))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});e.update(t)&&this._onDidChangeMarker.fire(e.model)}};tl=Pw([kh(0,Ee),kh(1,gi)],tl);class Fw extends D{constructor(e){super(),this.model=e,this._map=new Og,this._register(le(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=eb(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const s=i.map(a=>this._map.get(a)),r=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),o=this.model.deltaDecorations(s,r);for(const a of i)this._map.delete(a);for(let a=0;a<o.length;a++)this._map.set(t[a],o[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=O.lift(t);if(t.severity===It.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const s=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(s===1||i.endColumn>=s)return i;const r=e.getWordAtPosition(i.getStartPosition());r&&(i=new O(i.startLineNumber,r.startColumn,i.endLineNumber,r.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const s=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);s<i.endColumn&&(i=new O(i.startLineNumber,s,i.endLineNumber,i.endColumn),t.startColumn=s)}return i}_createDecorationOption(e){let t,i,s,r,o;switch(e.severity){case It.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",s=0;break;case It.Info:t="squiggly-info",i=Si(i_),s=10,o={color:Si(Bg),position:1};break;case It.Warning:t="squiggly-warning",i=Si(t_),s=20,o={color:Si(Fg),position:1};break;case It.Error:default:t="squiggly-error",i=Si(e_),s=30,o={color:Si(Pg),position:1};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(r="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(r="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:Jp.Right},minimap:o,zIndex:s,inlineClassName:r}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}var Bw=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},fs=function(n,e){return function(t,i){e(t,i,n)}},ki;function jt(n){return n.toString()}class Ww{constructor(e,t,i){this.model=e,this._modelEventListeners=new ie,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(s=>i(e,s)))}dispose(){this._modelEventListeners.dispose()}}const Hw=Pn||ui?1:2;class Vw{constructor(e,t,i,s,r,o,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=s,this.heapSize=r,this.sha1=o,this.versionId=a,this.alternativeVersionId=l}}var si;let il=(si=class extends D{constructor(e,t,i,s){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._instantiationService=s,this._onModelAdded=this._register(new R),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new R),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new R),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(r=>this._updateModelOptions(r))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){var u;let i=Je.tabSize;if(e.editor&&typeof e.editor.tabSize<"u"){const f=parseInt(e.editor.tabSize,10);isNaN(f)||(i=f),i<1&&(i=1)}let s="tabSize";if(e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"){const f=parseInt(e.editor.indentSize,10);isNaN(f)||(s=Math.max(f,1))}let r=Je.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(r=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let o=Hw;const a=e.eol;a===`\r
`?o=2:a===`
`&&(o=1);let l=Je.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(l=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let c=Je.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(c=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let d=Je.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(d=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let h=Je.bracketPairColorizationOptions;return(u=e.editor)!=null&&u.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"&&(h={enabled:!!e.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!e.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:t,tabSize:i,indentSize:s,insertSpaces:r,detectIndentation:c,defaultEOL:o,trimAutoWhitespace:l,largeFileOptimizations:d,bracketPairColorizationOptions:h}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:Pi===3||Pi===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const s=typeof e=="string"?e:e.languageId;let r=this._modelCreationOptionsByLanguageAndResource[s+t];if(!r){const o=this._configurationService.getValue("editor",{overrideIdentifier:s,resource:t}),a=this._getEOL(t,s);r=ki._readModelOptions({editor:o,eol:a},i),this._modelCreationOptionsByLanguageAndResource[s+t]=r}return r}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let s=0,r=i.length;s<r;s++){const o=i[s],a=this._models[o],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const d=t[l+c],h=this.getCreationOptions(l,c,a.model.isForSimpleWidget);ki._setModelOptionsForModel(a.model,h,d)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&wu(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(jt(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(jt(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(jt(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,s)=>i.time-s.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,s){const r=this.getCreationOptions(t,i,s),o=this._instantiationService.createInstance(n_,e,t,r,i);if(i&&this._disposedModels.has(jt(i))){const c=this._removeDisposedModel(i),d=this._undoRedoService.getElements(i),h=this._getSHA1Computer(),u=h.canComputeSHA1(o)?h.computeSHA1(o)===c.sha1:!1;if(u||c.sharesUndoRedoStack){for(const f of d.past)Ci(f)&&f.matchesResource(i)&&f.setModel(o);for(const f of d.future)Ci(f)&&f.matchesResource(i)&&f.setModel(o);this._undoRedoService.setElementsValidFlag(i,!0,f=>Ci(f)&&f.matchesResource(i)),u&&(o._overwriteVersionId(c.versionId),o._overwriteAlternativeVersionId(c.alternativeVersionId),o._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=jt(o.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new Ww(o,c=>this._onWillDispose(c),(c,d)=>this._onDidChangeLanguage(c,d));return this._models[a]=l,l}createModel(e,t,i,s=!1){let r;return t?r=this._createModelData(e,t,i,s):r=this._createModelData(e,At,i,s),this._onModelAdded.fire(r.model),r.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,s=t.length;i<s;i++){const r=t[i];e.push(this._models[r].model)}return e}getModel(e){const t=jt(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===se.file||e.scheme===se.vscodeRemote||e.scheme===se.vscodeUserData||e.scheme===se.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=jt(e.uri),i=this._models[t],s=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let r=!1,o=0;if(s||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const d of c.past)Ci(d)&&d.matchesResource(e.uri)&&(r=!0,o+=d.heapSize(e.uri),d.setModel(e.uri));for(const d of c.future)Ci(d)&&d.matchesResource(e.uri)&&(r=!0,o+=d.heapSize(e.uri),d.setModel(e.uri))}}const a=ki.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(r)if(!s&&(o>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-o),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>Ci(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new Vw(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),s,o,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!s){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,s=e.getLanguageId(),r=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),o=this.getCreationOptions(s,e.uri,e.isForSimpleWidget);ki._setModelOptionsForModel(e,o,r),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new nl}},ki=si,si.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024,si);il=ki=Bw([fs(0,Oe),fs(1,kf),fs(2,af),fs(3,re)],il);const vr=class vr{canComputeSHA1(e){return e.getValueLength()<=vr.MAX_MODEL_SIZE}computeSHA1(e){const t=new rp,i=e.createSnapshot();let s;for(;s=i.read();)t.update(s);return t.digest()}};vr.MAX_MODEL_SIZE=10*1024*1024;let nl=vr;var sl;(function(n){n[n.PRESERVE=0]="PRESERVE",n[n.LAST=1]="LAST"})(sl||(sl={}));const Hf={Quickaccess:"workbench.contributions.quickaccess"};class Uw{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),le(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return cc([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}Ut.add(Hf.Quickaccess,new Uw);const $w={ctrlCmd:!1,alt:!1};var ji;(function(n){n[n.Blur=1]="Blur",n[n.Gesture=2]="Gesture",n[n.Other=3]="Other"})(ji||(ji={}));var st;(function(n){n[n.NONE=0]="NONE",n[n.FIRST=1]="FIRST",n[n.SECOND=2]="SECOND",n[n.LAST=3]="LAST"})(st||(st={}));var j;(function(n){n[n.First=1]="First",n[n.Second=2]="Second",n[n.Last=3]="Last",n[n.Next=4]="Next",n[n.Previous=5]="Previous",n[n.NextPage=6]="NextPage",n[n.PreviousPage=7]="PreviousPage",n[n.NextSeparator=8]="NextSeparator",n[n.PreviousSeparator=9]="PreviousSeparator"})(j||(j={}));var Ys;(function(n){n[n.Title=1]="Title",n[n.Inline=2]="Inline"})(Ys||(Ys={}));const Gr=dt("quickInputService");var qw=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Eh=function(n,e){return function(t,i){e(t,i,n)}};let rl=class extends D{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=Ut.as(Hf.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var g,p;const[s,r]=this.getOrInstantiateProvider(e,i==null?void 0:i.enabledProviderPrefixes),o=this.visibleQuickAccess,a=o==null?void 0:o.descriptor;if(o&&r&&a===r){e!==r.prefix&&!(i!=null&&i.preserveValue)&&(o.picker.value=e),this.adjustValueSelection(o.picker,r,i);return}if(r&&!(i!=null&&i.preserveValue)){let b;if(o&&a&&a!==r){const w=o.value.substr(a.prefix.length);w&&(b=`${r.prefix}${w}`)}if(!b){const w=s==null?void 0:s.defaultFilterValue;w===sl.LAST?b=this.lastAcceptedPickerValues.get(r):typeof w=="string"&&(b=`${r.prefix}${w}`)}typeof b=="string"&&(e=b)}const l=(g=o==null?void 0:o.picker)==null?void 0:g.valueSelection,c=(p=o==null?void 0:o.picker)==null?void 0:p.value,d=new ie,h=d.add(this.quickInputService.createQuickPick({useSeparators:!0}));h.value=e,this.adjustValueSelection(h,r,i),h.placeholder=(i==null?void 0:i.placeholder)??(r==null?void 0:r.placeholder),h.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,h.hideInput=!!h.quickNavigate&&!o,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(h.itemActivation=(i==null?void 0:i.itemActivation)??st.SECOND),h.contextKey=r==null?void 0:r.contextKey,h.filterValue=b=>b.substring(r?r.prefix.length:0);let u;t&&(u=new Zu,d.add(ee.once(h.onWillAccept)(b=>{b.veto(),h.hide()}))),d.add(this.registerPickerListeners(h,s,r,e,i));const f=d.add(new Fr);if(s&&d.add(s.provide(h,f.token,i==null?void 0:i.providerOptions)),ee.once(h.onDidHide)(()=>{h.selectedItems.length===0&&f.cancel(),d.dispose(),u==null||u.complete(h.selectedItems.slice(0))}),h.show(),l&&c===e&&(h.valueSelection=l),t)return u==null?void 0:u.p}adjustValueSelection(e,t,i){let s;i!=null&&i.preserveValue?s=[e.value.length,e.value.length]:s=[(t==null?void 0:t.prefix.length)??0,e.value.length],e.valueSelection=s}registerPickerListeners(e,t,i,s,r){const o=new ie,a=this.visibleQuickAccess={picker:e,descriptor:i,value:s};return o.add(le(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),o.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l,r==null?void 0:r.enabledProviderPrefixes);c!==t?this.show(l,{enabledProviderPrefixes:r==null?void 0:r.enabledProviderPrefixes,preserveValue:!0,providerOptions:r==null?void 0:r.providerOptions}):a.value=l})),i&&o.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),o}getOrInstantiateProvider(e,t){const i=this.registry.getQuickAccessProvider(e);if(!i||t&&!(t!=null&&t.includes(i.prefix)))return[void 0,void 0];let s=this.mapProviderToDescriptor.get(i);return s||(s=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,s)),[s,i]}};rl=qw([Eh(0,Gr),Eh(1,re)],rl);var zw=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r};class Vf{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}zw([rc],Vf.prototype,"toString",null);const jw=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function Gw(n){const e=[];let t=0,i;for(;i=jw.exec(n);){i.index-t>0&&e.push(n.substring(t,i.index));const[,s,r,,o]=i;o?e.push({label:s,href:r,title:o}):e.push({label:s,href:r}),t=i.index+i[0].length}return t<n.length&&e.push(n.substring(t)),new Vf(e)}const lo={},Zw=new Wg("quick-input-button-icon-");function Kw(n){if(!n)return;let e;const t=n.dark.toString();return lo[t]?e=lo[t]:(e=Zw.nextId(),cd(`.${e}, .hc-light .${e}`,`background-image: ${Os(n.light||n.dark)}`),cd(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${Os(n.dark)}`),lo[t]=e),e}function Cn(n,e,t){let i=n.iconClass||Kw(n.iconPath);return n.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible"),{id:e,label:"",tooltip:n.tooltip||"",class:i,enabled:!0,run:t}}function Xw(n,e,t){He(e);const i=Gw(n);let s=0;for(const r of i.nodes)if(typeof r=="string")e.append(...oc(r));else{let o=r.title;!o&&r.href.startsWith("command:")?o=C("executeCommand","Click to execute command '{0}'",r.href.substring(8)):o||(o=r.href);const a=he("a",{href:r.href,title:o,tabIndex:s++},r.label);a.style.textDecoration="underline";const l=f=>{op(f)&&pe.stop(f,!0),t.callback(r.href)},c=t.disposables.add(new Kr(a,N.CLICK)).event,d=t.disposables.add(new Kr(a,N.KEY_DOWN)).event,h=ee.chain(d,f=>f.filter(g=>{const p=new je(g);return p.equals(10)||p.equals(3)}));t.disposables.add(Rs.addTarget(a));const u=t.disposables.add(new Kr(a,Ms.Tap)).event;ee.any(c,u,h)(l,null,t.disposables),e.appendChild(a)}}var Yw=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},xh=function(n,e){return function(t,i){e(t,i,n)}};const Uf="inQuickInput",Qw=new Qi(Uf,!1,C("inQuickInput","Whether keyboard focus is inside the quick input control")),Jw=Ie.has(Uf),$f="quickInputType",eS=new Qi($f,void 0,C("quickInputType","The type of the currently visible quick input")),qf="cursorAtEndOfQuickInputBox",tS=new Qi(qf,!1,C("cursorAtEndOfQuickInputBox","Whether the cursor in the quick input is at the end of the input box")),iS=Ie.has(qf),ol={iconClass:$e.asClassName(we.quickInputBack),tooltip:C("quickInput.back","Back"),handle:-1},wr=class wr extends D{constructor(e){super(),this.ui=e,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=wr.noPromptMessage,this._severity=Ne.Ignore,this.onDidTriggerButtonEmitter=this._register(new R),this.onDidHideEmitter=this._register(new R),this.onWillHideEmitter=this._register(new R),this.onDisposeEmitter=this._register(new R),this.visibleDisposables=this._register(new ie),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!As;this._ignoreFocusOut=e&&!As,t&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(e){this._leftButtons=e.filter(t=>t===ol),this._rightButtons=e.filter(t=>t!==ol&&t.location!==Ys.Inline),this._inlineButtons=e.filter(t=>t.location===Ys.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=ji.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}willHide(e=ji.Other){this.onWillHideEmitter.fire({reason:e})}update(){var s;if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText=" ");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?He(this.ui.widget,this._widget):He(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new mc,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const r=this._leftButtons.map((l,c)=>Cn(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.leftActionBar.push(r,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const o=this._rightButtons.map((l,c)=>Cn(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.rightActionBar.push(o,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const a=this._inlineButtons.map((l,c)=>Cn(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.inlineActionBar.push(a,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const r=((s=this.toggles)==null?void 0:s.filter(o=>o instanceof s_))??[];this.ui.inputBox.toggles=r}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,He(this.ui.message),Xw(i,this.ui.message,{callback:r=>{this.ui.linkOpenerDelegate(r)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?C("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Ne.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}};wr.noPromptMessage=C("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");let Qs=wr;const Sr=class Sr extends Qs{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new R),this.onWillAcceptEmitter=this._register(new R),this.onDidAcceptEmitter=this._register(new R),this.onDidCustomEmitter=this._register(new R),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=st.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new R),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new R),this.onDidTriggerItemButtonEmitter=this._register(new R),this.onDidTriggerSeparatorButtonEmitter=this._register(new R),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new Ku,this.type="quickPick",this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?$w:this.ui.keyMods}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(j.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(e,t)=>t)(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&Pt(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&Pt(e,this._selectedItems,(i,s)=>i===s)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(ap(t)&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&Pt(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return I(this.ui.container,N.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new je(e),i=t.keyCode;this._quickNavigate.keybindings.some(o=>{const a=o.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.titleButtons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let s=this.ariaLabel;!s&&i.inputBox&&(s=this.placeholder||Sr.DEFAULT_ARIA_LABEL,this.title&&(s+=` - ${this.title}`)),this.ui.list.ariaLabel!==s&&(this.ui.list.ariaLabel=s??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case st.NONE:this._itemActivation=st.FIRST;break;case st.SECOND:this.ui.list.focus(j.Second),this._itemActivation=st.FIRST;break;case st.LAST:this.ui.list.focus(j.Last),this._itemActivation=st.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(j.First)),this.keepScrollPosition&&(this.scrollTop=e)}focus(e){this.ui.list.focus(e),this.canSelectMany&&this.ui.list.domFocus()}accept(e){e&&!this._canAcceptInBackground||this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(e??!1))}};Sr.DEFAULT_ARIA_LABEL=C("quickInputBox.ariaLabel","Type to narrow down results.");let Js=Sr;class nS extends Qs{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new R),this.onDidAcceptEmitter=this._register(new R),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}}let al=class extends Sc{constructor(e,t){super("element",!1,i=>this.getOverrideOptions(i),e,t)}getOverrideOptions(e){const t=(ot(e.content)?e.content.textContent??"":typeof e.content=="string"?e.content:e.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:t,skipFadeInAnimation:!0}}}};al=Yw([xh(0,Oe),xh(1,qr)],al);Bt.white.toString(),Bt.white.toString();class ll extends D{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new R),this._onDidEscape=this._register(new R),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,s=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=s||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this._register(Rs.addTarget(this._element)),[N.CLICK,Ms.Tap].forEach(r=>{this._register(I(this._element,r,o=>{if(!this.enabled){pe.stop(o);return}this._onDidClick.fire(o)}))}),this._register(I(this._element,N.KEY_DOWN,r=>{const o=new je(r);let a=!1;this.enabled&&(o.equals(3)||o.equals(10))?(this._onDidClick.fire(r),a=!0):o.equals(9)&&(this._onDidEscape.fire(r),this._element.blur(),a=!0),a&&pe.stop(o,!0)})),this._register(I(this._element,N.MOUSE_OVER,r=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(I(this._element,N.MOUSE_OUT,r=>{this.updateBackground(!1)})),this.focusTracker=this._register(Xu(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of oc(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const s=document.createElement("span");s.textContent=i,t.push(s)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){var s;if(this._label===e||Oi(this._label)&&Oi(e)&&Hg(this._label,e))return;this._element.classList.add("monaco-text-button");const t=this.options.supportShortLabel?this._labelElement:this._element;if(Oi(e)){const r=Vg(e,{inline:!0});r.dispose();const o=(s=r.element.querySelector("p"))==null?void 0:s.innerHTML;if(o){const a=lp(o,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});t.innerHTML=a}else He(t)}else this.options.supportIcons?He(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=Ug(e)),this.setTitle(i),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",i),this._label=e}get label(){return this._label}set icon(e){this._element.classList.add(...$e.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(r_().setupManagedHover(this.options.hoverDelegate??o_("mouse"),this._element,e)):this._hover&&this._hover.update(e)}}const Ih="done",Dh="active",co="infinite",ho="infinite-long-running",Rh="discrete",Cr=class Cr extends D{constructor(e,t){super(),this.progressSignal=this._register(new Yu),this.workedVal=0,this.showDelayedScheduler=this._register(new hi(()=>Hu(this.element),0)),this.longRunningScheduler=this._register(new hi(()=>this.infiniteLongRunning(),Cr.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(t==null?void 0:t.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(Dh,co,ho,Rh),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(Ih),this.element.classList.contains(co)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(Rh,Ih,ho),this.element.classList.add(Dh,co),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(ho)}getContainer(){return this.element}};Cr.LONG_RUNNING_INFINITE_THRESHOLD=1e4;let cl=Cr;const sS=he;class rS extends D{constructor(e,t,i){super(),this.parent=e,this.onKeyDown=r=>lt(this.findInput.inputBox.inputElement,N.KEY_DOWN,r),this.onDidChange=r=>this.findInput.onDidChange(r),this.container=G(this.parent,sS(".quick-input-box")),this.findInput=this._register(new a_(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const s=this.findInput.inputBox.inputElement;s.role="combobox",s.ariaHasPopup="menu",s.ariaAutoComplete="list",s.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}showDecoration(e){e===Ne.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===Ne.Info?1:e===Ne.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===Ne.Info?1:e===Ne.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}const Mh=new Qu(()=>{const n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:n,collatorIsNumeric:n.resolvedOptions().numeric}});function oS(n,e,t=!1){const i=n||"",s=e||"",r=Mh.value.collator.compare(i,s);return Mh.value.collatorIsNumeric&&r===0&&i!==s?i<s?-1:1:r}function aS(n,e,t){const i=n.toLowerCase(),s=e.toLowerCase(),r=lS(n,e,t);if(r)return r;const o=i.endsWith(t),a=s.endsWith(t);if(o!==a)return o?-1:1;const l=oS(i,s);return l!==0?l:i.localeCompare(s)}function lS(n,e,t){const i=n.toLowerCase(),s=e.toLowerCase(),r=i.startsWith(t),o=s.startsWith(t);if(r!==o)return r?-1:1;if(r&&o){if(i.length<s.length)return-1;if(i.length>s.length)return 1}return 0}var Zr=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},dl=function(n,e){return function(t,i){e(t,i,n)}},hl;const Ye=he;class zf{constructor(e,t,i){this.index=e,this.hasCheckbox=t,this._hidden=!1,this._init=new Qu(()=>{const s=i.label??"",r=gn(s).text.trim(),o=i.ariaLabel||[s,this.saneDescription,this.saneDetail].map(a=>$g(a)).filter(a=>!!a).join(", ");return{saneLabel:s,saneSortLabel:r,saneAriaLabel:o}}),this._saneDescription=i.description,this._saneTooltip=i.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get saneDescription(){return this._saneDescription}set saneDescription(e){this._saneDescription=e}get saneDetail(){return this._saneDetail}set saneDetail(e){this._saneDetail=e}get saneTooltip(){return this._saneTooltip}set saneTooltip(e){this._saneTooltip=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class fe extends zf{constructor(e,t,i,s,r,o){var a,l,c;super(e,t,r),this.fireButtonTriggered=i,this._onChecked=s,this.item=r,this._separator=o,this._checked=!1,this.onChecked=t?ee.map(ee.filter(this._onChecked.event,d=>d.element===this),d=>d.checked):ee.None,this._saneDetail=r.detail,this._labelHighlights=(a=r.highlights)==null?void 0:a.label,this._descriptionHighlights=(l=r.highlights)==null?void 0:l.description,this._detailHighlights=(c=r.highlights)==null?void 0:c.detail}get separator(){return this._separator}set separator(e){this._separator=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({element:this,checked:e}))}get checkboxDisabled(){return!!this.item.disabled}}var rt;(function(n){n[n.NONE=0]="NONE",n[n.MOUSE_HOVER=1]="MOUSE_HOVER",n[n.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(rt||(rt={}));class Gt extends zf{constructor(e,t,i){super(e,!1,i),this.fireSeparatorButtonTriggered=t,this.separator=i,this.children=new Array,this.focusInsideSeparator=rt.NONE}}class cS{getHeight(e){return e instanceof Gt?30:e.saneDetail?44:22}getTemplateId(e){return e instanceof fe?er.ID:tr.ID}}class dS{getWidgetAriaLabel(){return C("quickInput","Quick Input")}getAriaLabel(e){var t;return(t=e.separator)!=null&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(!(!e.hasCheckbox||!(e instanceof fe)))return{get value(){return e.checked},onDidChange:t=>e.onChecked(()=>t())}}}class jf{constructor(e){this.hoverDelegate=e}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=new ie,t.toDisposeTemplate=new ie,t.entry=G(e,Ye(".quick-input-list-entry"));const i=G(t.entry,Ye("label.quick-input-list-label"));t.toDisposeTemplate.add(lt(i,N.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=G(i,Ye("input.quick-input-list-checkbox")),t.checkbox.type="checkbox";const s=G(i,Ye(".quick-input-list-rows")),r=G(s,Ye(".quick-input-list-row")),o=G(s,Ye(".quick-input-list-row"));t.label=new vd(r,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.label),t.icon=Fu(t.label.element,Ye(".quick-input-list-icon"));const a=G(r,Ye(".quick-input-list-entry-keybinding"));t.keybinding=new tb(a,Pi),t.toDisposeTemplate.add(t.keybinding);const l=G(o,Ye(".quick-input-list-label-meta"));return t.detail=new vd(l,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.detail),t.separator=G(t.entry,Ye(".quick-input-list-separator")),t.actionBar=new ni(t.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.add(t.actionBar),t}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}disposeElement(e,t,i){i.toDisposeElement.clear(),i.actionBar.clear()}}var ri;let er=(ri=class extends jf{constructor(e,t){super(e),this.themeService=t,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return hl.ID}renderTemplate(e){const t=super.renderTemplate(e);return t.toDisposeTemplate.add(lt(t.checkbox,N.CHANGE,i=>{t.element.checked=t.checkbox.checked})),t}renderElement(e,t,i){var u;const s=e.element;i.element=s,s.element=i.entry??void 0;const r=s.item;i.checkbox.checked=s.checked,i.toDisposeElement.add(s.onChecked(f=>i.checkbox.checked=f)),i.checkbox.disabled=s.checkboxDisabled;const{labelHighlights:o,descriptionHighlights:a,detailHighlights:l}=s;if(r.iconPath){const f=cf(this.themeService.getColorTheme().type)?r.iconPath.dark:r.iconPath.light??r.iconPath.dark,g=Ae.revive(f);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=Os(g)}else i.icon.style.backgroundImage="",i.icon.className=r.iconClass?`quick-input-list-icon ${r.iconClass}`:"";let c;!s.saneTooltip&&s.saneDescription&&(c={markdown:{value:s.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:s.saneDescription});const d={matches:o||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(d.extraClasses=r.iconClasses,d.italic=r.italic,d.strikethrough=r.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item"),i.label.setLabel(s.saneLabel,s.saneDescription,d),i.keybinding.set(r.keybinding),s.saneDetail){let f;s.saneTooltip||(f={markdown:{value:s.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:s.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(s.saneDetail,void 0,{matches:l,title:f,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";(u=s.separator)!=null&&u.label?(i.separator.textContent=s.separator.label,i.separator.style.display="",this.addItemWithSeparator(s)):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!s.separator);const h=r.buttons;h&&h.length?(i.actionBar.push(h.map((f,g)=>Cn(f,`id-${g}`,()=>s.fireButtonTriggered({button:f,item:s.item}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){this.removeItemWithSeparator(e.element),super.disposeElement(e,t,i)}isItemWithSeparatorVisible(e){return this._itemsWithSeparatorsFrequency.has(e)}addItemWithSeparator(e){this._itemsWithSeparatorsFrequency.set(e,(this._itemsWithSeparatorsFrequency.get(e)||0)+1)}removeItemWithSeparator(e){const t=this._itemsWithSeparatorsFrequency.get(e)||0;t>1?this._itemsWithSeparatorsFrequency.set(e,t-1):this._itemsWithSeparatorsFrequency.delete(e)}},hl=ri,ri.ID="quickpickitem",ri);er=hl=Zr([dl(1,yt)],er);const yr=class yr extends jf{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}get templateId(){return yr.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(e){return this._visibleSeparatorsFrequency.has(e)}renderTemplate(e){const t=super.renderTemplate(e);return t.checkbox.style.display="none",t}renderElement(e,t,i){const s=e.element;i.element=s,s.element=i.entry??void 0,s.element.classList.toggle("focus-inside",!!s.focusInsideSeparator);const r=s.separator,{labelHighlights:o,descriptionHighlights:a,detailHighlights:l}=s;i.icon.style.backgroundImage="",i.icon.className="";let c;!s.saneTooltip&&s.saneDescription&&(c={markdown:{value:s.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:s.saneDescription});const d={matches:o||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(s.saneLabel,s.saneDescription,d),s.saneDetail){let u;s.saneTooltip||(u={markdown:{value:s.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:s.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(s.saneDetail,void 0,{matches:l,title:u,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";i.separator.style.display="none",i.entry.classList.add("quick-input-list-separator-border");const h=r.buttons;h&&h.length?(i.actionBar.push(h.map((u,f)=>Cn(u,`id-${f}`,()=>s.fireSeparatorButtonTriggered({button:u,separator:s.separator}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions"),this.addSeparator(s)}disposeElement(e,t,i){var s;this.removeSeparator(e.element),this.isSeparatorVisible(e.element)||(s=e.element.element)==null||s.classList.remove("focus-inside"),super.disposeElement(e,t,i)}addSeparator(e){this._visibleSeparatorsFrequency.set(e,(this._visibleSeparatorsFrequency.get(e)||0)+1)}removeSeparator(e){const t=this._visibleSeparatorsFrequency.get(e)||0;t>1?this._visibleSeparatorsFrequency.set(e,t-1):this._visibleSeparatorsFrequency.delete(e)}};yr.ID="quickpickseparator";let tr=yr,$n=class extends D{constructor(e,t,i,s,r,o){super(),this.parent=e,this.hoverDelegate=t,this.linkOpenerDelegate=i,this.accessibilityService=o,this._onKeyDown=new R,this._onLeave=new R,this.onLeave=this._onLeave.event,this._visibleCountObservable=F("VisibleCount",0),this.onChangedVisibleCount=ee.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=F("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=ee.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=F("CheckedCount",0),this.onChangedCheckedCount=ee.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=ja({equalsFn:Pt},new Array),this.onChangedCheckedElements=ee.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new R,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new R,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new R,this._elementCheckedEventBufferer=new Ku,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new ie),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=G(this.parent,Ye(".quick-input-list")),this._separatorRenderer=new tr(t),this._itemRenderer=r.createInstance(er,t),this._tree=this._register(r.createInstance(ib,"QuickInput",this._container,new cS,[this._itemRenderer,this._separatorRenderer],{filter:{filter(a){return a.hidden?0:a instanceof Gt?2:1}},sorter:{compare:(a,l)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const c=this._lastQueryString.toLowerCase();return uS(a,l,c)}},accessibilityProvider:new dS,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:nb.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=s,this._registerListeners()}get onDidChangeFocus(){return ee.map(this._tree.onDidChangeFocus,e=>e.elements.filter(t=>t instanceof fe).map(t=>t.item),this._store)}get onDidChangeSelection(){return ee.map(this._tree.onDidChangeSelection,e=>({items:e.elements.filter(t=>t instanceof fe).map(t=>t.item),event:e.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(e){this._tree.scrollTop=e}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(e){this._tree.ariaLabel=e??""}set enabled(e){this._tree.getHTMLElement().style.pointerEvents=e?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}get shouldLoop(){return this._shouldLoop}set shouldLoop(e){this._shouldLoop=e}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(e=>{const t=new je(e);switch(t.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(t)}))}_registerOnContainerClick(){this._register(I(this._container,N.CLICK,e=>{(e.x||e.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(I(this._container,N.AUXCLICK,e=>{e.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const e=this._itemElements.filter(t=>!t.hidden).length;this._visibleCountObservable.set(e,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(e,t)=>t)(e=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(e=>{e.element&&(e.browserEvent.preventDefault(),this._tree.setSelection([e.element]))}))}_registerHoverListeners(){const e=this._register(new cp(this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async t=>{var i;if(dd(t.browserEvent.target)){e.cancel();return}if(!(!dd(t.browserEvent.relatedTarget)&&Te(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)))try{await e.trigger(async()=>{t.element instanceof fe&&this.showHover(t.element)})}catch(s){if(!Gu(s))throw s}})),this._register(this._tree.onMouseOut(t=>{var i;Te(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)||e.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(e=>{const t=e.elements[0]?this._tree.getParentElement(e.elements[0]):null;for(const i of this._separatorRenderer.visibleSeparators){const s=i===t;!!(i.focusInsideSeparator&rt.ACTIVE_ITEM)!==s&&(s?i.focusInsideSeparator|=rt.ACTIVE_ITEM:i.focusInsideSeparator&=~rt.ACTIVE_ITEM,this._tree.rerender(i))}})),this._register(this._tree.onMouseOver(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&rt.MOUSE_HOVER)||(i.focusInsideSeparator|=rt.MOUSE_HOVER,this._tree.rerender(i))}})),this._register(this._tree.onMouseOut(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&rt.MOUSE_HOVER)&&(i.focusInsideSeparator&=~rt.MOUSE_HOVER,this._tree.rerender(i))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(e=>{const t=e.elements.filter(i=>i instanceof fe);t.length!==e.elements.length&&(e.elements.length===1&&e.elements[0]instanceof Gt&&(this._tree.setFocus([e.elements[0].children[0]]),this._tree.reveal(e.elements[0],0)),this._tree.setSelection(t))}))}setAllVisibleChecked(e){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(t=>{!t.hidden&&!t.checkboxDisabled&&(t.checked=e)})})}setElements(e){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=e,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let t;this._itemElements=new Array,this._elementTree=e.reduce((i,s,r)=>{let o;if(s.type==="separator"){if(!s.buttons)return i;t=new Gt(r,a=>this._onSeparatorButtonTriggered.fire(a),s),o=t}else{const a=r>0?e[r-1]:void 0;let l;a&&a.type==="separator"&&!a.buttons&&(t=void 0,l=a);const c=new fe(r,this._hasCheckboxes,d=>this._onButtonTriggered.fire(d),this._elementChecked,s,l);if(this._itemElements.push(c),t)return t.children.push(c),i;o=c}return i.push(o),i},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const i=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),s=i==null?void 0:i.parentNode;if(i&&s){const r=i.nextSibling;i.remove(),s.insertBefore(i,r)}},0)}setFocusedElements(e){const t=e.map(i=>this._itemElements.find(s=>s.item===i)).filter(i=>!!i).filter(i=>!i.hidden);if(this._tree.setFocus(t),e.length>0){const i=this._tree.getFocus()[0];i&&this._tree.reveal(i)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){const t=e.map(i=>this._itemElements.find(s=>s.item===i)).filter(i=>!!i);this._tree.setSelection(t)}getCheckedElements(){return this._itemElements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){this._elementCheckedEventBufferer.bufferEvents(()=>{const t=new Set;for(const i of e)t.add(i);for(const i of this._itemElements)i.checked=t.has(i.item)})}focus(e){var t;if(this._itemElements.length)switch(e===j.Second&&this._itemElements.length<2&&(e=j.First),e){case j.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,i=>i.element instanceof fe);break;case j.Second:{this._tree.scrollTop=0;let i=!1;this._tree.focusFirst(void 0,s=>s.element instanceof fe?i?!0:(i=!i,!1):!1);break}case j.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,i=>i.element instanceof fe);break;case j.Next:{const i=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,r=>r.element instanceof fe?(this._tree.reveal(r.element),!0):!1);const s=this._tree.getFocus();i.length&&i[0]===s[0]&&i[0]===this._itemElements[this._itemElements.length-1]&&this._onLeave.fire();break}case j.Previous:{const i=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,r=>{if(!(r.element instanceof fe))return!1;const o=this._tree.getParentElement(r.element);return o===null||o.children[0]!==r.element?this._tree.reveal(r.element):this._tree.reveal(o),!0});const s=this._tree.getFocus();i.length&&i[0]===s[0]&&i[0]===this._itemElements[0]&&this._onLeave.fire();break}case j.NextPage:this._tree.focusNextPage(void 0,i=>i.element instanceof fe?(this._tree.reveal(i.element),!0):!1);break;case j.PreviousPage:this._tree.focusPreviousPage(void 0,i=>{if(!(i.element instanceof fe))return!1;const s=this._tree.getParentElement(i.element);return s===null||s.children[0]!==i.element?this._tree.reveal(i.element):this._tree.reveal(s),!0});break;case j.NextSeparator:{let i=!1;const s=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,o=>{if(i)return!0;if(o.element instanceof Gt)i=!0,this._separatorRenderer.isSeparatorVisible(o.element)?this._tree.reveal(o.element.children[0]):this._tree.reveal(o.element,0);else if(o.element instanceof fe){if(o.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(o.element)?this._tree.reveal(o.element):this._tree.reveal(o.element,0),!0;if(o.element===this._elementTree[0])return this._tree.reveal(o.element,0),!0}return!1});const r=this._tree.getFocus()[0];s===r&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,o=>o.element instanceof fe));break}case j.PreviousSeparator:{let i,s=!!((t=this._tree.getFocus()[0])!=null&&t.separator);this._tree.focusPrevious(void 0,!0,void 0,r=>{if(r.element instanceof Gt)s?i||(this._separatorRenderer.isSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element.children[0]):s=!0;else if(r.element instanceof fe&&!i){if(r.element.separator)this._itemRenderer.isItemWithSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),i=r.element;else if(r.element===this._elementTree[0])return this._tree.reveal(r.element,0),!0}return!1}),i&&this._tree.setFocus([i]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}filter(e){if(this._lastQueryString=e,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const s=i.index&&this._inputElements[i.index-1];i.item&&(i.separator=s&&s.type==="separator"&&!s.buttons?s:void 0)});else{let i;this._itemElements.forEach(s=>{let r;this.matchOnLabelMode==="fuzzy"?r=this.matchOnLabel?Xr(e,gn(s.saneLabel))??void 0:void 0:r=this.matchOnLabel?hS(t,gn(s.saneLabel))??void 0:void 0;const o=this.matchOnDescription?Xr(e,gn(s.saneDescription||""))??void 0:void 0,a=this.matchOnDetail?Xr(e,gn(s.saneDetail||""))??void 0:void 0;if(r||o||a?(s.labelHighlights=r,s.descriptionHighlights=o,s.detailHighlights=a,s.hidden=!1):(s.labelHighlights=void 0,s.descriptionHighlights=void 0,s.detailHighlights=void 0,s.hidden=s.item?!s.item.alwaysShow:!0),s.item?s.separator=void 0:s.separator&&(s.hidden=!0),!this.sortByLabel){const l=s.index&&this._inputElements[s.index-1]||void 0;(l==null?void 0:l.type)==="separator"&&!l.buttons&&(i=l),i&&!s.hidden&&(s.separator=i,i=void 0)}})}return this._setElementsToTree(this._sortByLabel&&e?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const e=this._tree.getFocus().filter(i=>i instanceof fe),t=this._allVisibleChecked(e);for(const i of e)i.checkboxDisabled||(i.checked=!t)})}style(e){this._tree.style(e)}toggleHover(){const e=this._tree.getFocus()[0];if(!(e!=null&&e.saneTooltip)||!(e instanceof fe))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(e);const t=new ie;t.add(this._tree.onDidChangeFocus(i=>{i.elements[0]instanceof fe&&this.showHover(i.elements[0])})),this._lastHover&&t.add(this._lastHover),this._elementDisposable.add(t)}_setElementsToTree(e){const t=new Array;for(const i of e)i instanceof Gt?t.push({element:i,collapsible:!1,collapsed:!1,children:i.children.map(s=>({element:s,collapsible:!1,collapsed:!1}))}):t.push({element:i,collapsible:!1,collapsed:!1});this._tree.setChildren(null,t)}_allVisibleChecked(e,t=!0){for(let i=0,s=e.length;i<s;i++){const r=e[i];if(!r.hidden)if(r.checked)t=!0;else return!1}return t}_updateCheckedObservables(){ge(e=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),e);const t=this._itemElements.filter(i=>i.checked).length;this._checkedCountObservable.set(t,e),this._checkedElementsObservable.set(this.getCheckedElements(),e)})}showHover(e){var t,i,s;this._lastHover&&!this._lastHover.isDisposed&&((i=(t=this.hoverDelegate).onDidHideHover)==null||i.call(t),(s=this._lastHover)==null||s.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:r=>{this.linkOpenerDelegate(r)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};Zr([rc],$n.prototype,"onDidChangeFocus",null);Zr([rc],$n.prototype,"onDidChangeSelection",null);$n=Zr([dl(4,re),dl(5,fi)],$n);function hS(n,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return Th(n,t);const s=gc(t," "),r=t.length-s.length,o=Th(n,s);if(o)for(const a of o){const l=i[a.start+r]+r;a.start+=l,a.end+=l}return o}function Th(n,e){const t=e.toLowerCase().indexOf(n.toLowerCase());return t!==-1?[{start:t,end:t+n.length}]:null}function uS(n,e,t){const i=n.labelHighlights||[],s=e.labelHighlights||[];return i.length&&!s.length?-1:!i.length&&s.length?1:i.length===0&&s.length===0?0:aS(n.saneSortLabel,e.saneSortLabel,t)}const Gf={weight:200,when:Ie.and(Ie.equals($f,"quickPick"),Jw),metadata:{description:C("quickPick","Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")}};function Me(n,e={}){Ju.registerCommandAndKeybindingRule({...Gf,...n,secondary:fS(n.primary,n.secondary??[],e)})}const ir=ui?256:2048;function fS(n,e,t={}){return t.withAltMod&&e.push(512+n),t.withCtrlMod&&(e.push(ir+n),t.withAltMod&&e.push(512+ir+n)),t.withCmdMod&&ui&&(e.push(2048+n),t.withCtrlMod&&e.push(2304+n),t.withAltMod&&(e.push(2560+n),t.withCtrlMod&&e.push(2816+n))),e}function Be(n,e){return t=>{const i=t.get(Gr).currentQuickInput;if(i)return e&&i.quickNavigate?i.focus(e):i.focus(n)}}Me({id:"quickInput.pageNext",primary:12,handler:Be(j.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Me({id:"quickInput.pagePrevious",primary:11,handler:Be(j.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Me({id:"quickInput.first",primary:ir+14,handler:Be(j.First)},{withAltMod:!0,withCmdMod:!0});Me({id:"quickInput.last",primary:ir+13,handler:Be(j.Last)},{withAltMod:!0,withCmdMod:!0});Me({id:"quickInput.next",primary:18,handler:Be(j.Next)},{withCtrlMod:!0});Me({id:"quickInput.previous",primary:16,handler:Be(j.Previous)},{withCtrlMod:!0});const Nh=C("quickInput.nextSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),Ah=C("quickInput.previousSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");ui?(Me({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:Be(j.NextSeparator,j.Next),metadata:{description:Nh}}),Me({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:Be(j.NextSeparator)},{withCtrlMod:!0}),Me({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:Be(j.PreviousSeparator,j.Previous),metadata:{description:Ah}}),Me({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:Be(j.PreviousSeparator)},{withCtrlMod:!0})):(Me({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:Be(j.NextSeparator,j.Next),metadata:{description:Nh}}),Me({id:"quickInput.nextSeparator",primary:2578,handler:Be(j.NextSeparator)}),Me({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:Be(j.PreviousSeparator,j.Previous),metadata:{description:Ah}}),Me({id:"quickInput.previousSeparator",primary:2576,handler:Be(j.PreviousSeparator)}));Me({id:"quickInput.acceptInBackground",when:Ie.and(Gf.when,Ie.or(sb.negate(),iS)),primary:17,weight:250,handler:n=>{const e=n.get(Gr).currentQuickInput;e==null||e.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});var gS=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},uo=function(n,e){return function(t,i){e(t,i,n)}},ul;const Re=he;var oi;let fl=(oi=class extends D{get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(e,t,i,s){super(),this.options=e,this.layoutService=t,this.instantiationService=i,this.contextKeyService=s,this.enabled=!0,this.onDidAcceptEmitter=this._register(new R),this.onDidCustomEmitter=this._register(new R),this.onDidTriggerButtonEmitter=this._register(new R),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new R),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new R),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=Qw.bindTo(this.contextKeyService),this.quickInputTypeContext=eS.bindTo(this.contextKeyService),this.endOfQuickInputBoxContext=tS.bindTo(this.contextKeyService),this.idPrefix=e.idPrefix,this._container=e.container,this.styles=e.styles,this._register(ee.runAndSubscribe(ef,({window:r,disposables:o})=>this.registerKeyModsListeners(r,o),{window:Ue,disposables:this._store})),this._register(dp(r=>{this.ui&&ae(this.ui.container)===r&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))}))}registerKeyModsListeners(e,t){const i=s=>{this.keyMods.ctrlCmd=s.ctrlKey||s.metaKey,this.keyMods.alt=s.altKey};for(const s of[N.KEY_DOWN,N.KEY_UP,N.MOUSE_DOWN])t.add(I(e,s,i,!0))}getUI(e){if(this.ui)return e&&ae(this._container)!==ae(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const t=G(this._container,Re(".quick-input-widget.show-file-icons"));t.tabIndex=-1,t.style.display="none";const i=Fn(t),s=G(t,Re(".quick-input-titlebar")),r=this._register(new ni(s,{hoverDelegate:this.options.hoverDelegate}));r.domNode.classList.add("quick-input-left-action-bar");const o=G(s,Re(".quick-input-title")),a=this._register(new ni(s,{hoverDelegate:this.options.hoverDelegate}));a.domNode.classList.add("quick-input-right-action-bar");const l=G(t,Re(".quick-input-header")),c=G(l,Re("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",C("quickInput.checkAll","Toggle all checkboxes")),this._register(lt(c,N.CHANGE,M=>{const U=c.checked;B.setAllVisibleChecked(U)})),this._register(I(c,N.CLICK,M=>{(M.x||M.y)&&f.setFocus()}));const d=G(l,Re(".quick-input-description")),h=G(l,Re(".quick-input-and-message")),u=G(h,Re(".quick-input-filter")),f=this._register(new rS(u,this.styles.inputBox,this.styles.toggle));f.setAttribute("aria-describedby",`${this.idPrefix}message`);const g=G(u,Re(".quick-input-visible-count"));g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true");const p=new Ld(g,{countFormat:C({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),b=G(u,Re(".quick-input-count"));b.setAttribute("aria-live","polite");const w=new Ld(b,{countFormat:C({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),S=this._register(new ni(l,{hoverDelegate:this.options.hoverDelegate}));S.domNode.classList.add("quick-input-inline-action-bar");const _=G(l,Re(".quick-input-action")),m=this._register(new ll(_,this.styles.button));m.label=C("ok","OK"),this._register(m.onDidClick(M=>{this.onDidAcceptEmitter.fire()}));const v=G(l,Re(".quick-input-action")),y=this._register(new ll(v,{...this.styles.button,supportIcons:!0}));y.label=C("custom","Custom"),this._register(y.onDidClick(M=>{this.onDidCustomEmitter.fire()}));const L=G(h,Re(`#${this.idPrefix}message.quick-input-message`)),k=this._register(new cl(t,this.styles.progressBar));k.getContainer().classList.add("quick-input-progress");const E=G(t,Re(".quick-input-html-widget"));E.tabIndex=-1;const W=G(t,Re(".quick-input-description")),H=this.idPrefix+"list",B=this._register(this.instantiationService.createInstance($n,t,this.options.hoverDelegate,this.options.linkOpenerDelegate,H));f.setAttribute("aria-controls",H),this._register(B.onDidChangeFocus(()=>{f.setAttribute("aria-activedescendant",B.getActiveDescendant()??"")})),this._register(B.onChangedAllVisibleChecked(M=>{c.checked=M})),this._register(B.onChangedVisibleCount(M=>{p.setCount(M)})),this._register(B.onChangedCheckedCount(M=>{w.setCount(M)})),this._register(B.onLeave(()=>{setTimeout(()=>{this.controller&&(f.setFocus(),this.controller instanceof Js&&this.controller.canSelectMany&&B.clearFocus())},0)}));const J=Xu(t);return this._register(J),this._register(I(t,N.FOCUS,M=>{const U=this.getUI();if(Te(M.relatedTarget,U.inputContainer)){const oe=U.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==oe&&this.endOfQuickInputBoxContext.set(oe)}Te(M.relatedTarget,U.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=ot(M.relatedTarget)?M.relatedTarget:void 0)},!0)),this._register(J.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(ji.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(f.onKeyDown(M=>{const U=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==U&&this.endOfQuickInputBoxContext.set(U)})),this._register(I(t,N.FOCUS,M=>{f.setFocus()})),this._register(lt(t,N.KEY_DOWN,M=>{if(!Te(M.target,E))switch(M.keyCode){case 3:pe.stop(M,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:pe.stop(M,!0),this.hide(ji.Gesture);break;case 2:if(!M.altKey&&!M.ctrlKey&&!M.metaKey){const U=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(t.classList.contains("show-checkboxes")?U.push("input"):U.push("input[type=text]"),this.getUI().list.displayed&&U.push(".monaco-list"),this.getUI().message&&U.push(".quick-input-message a"),this.getUI().widget){if(Te(M.target,this.getUI().widget))break;U.push(".quick-input-html-widget")}const oe=t.querySelectorAll(U.join(", "));M.shiftKey&&M.target===oe[0]?(pe.stop(M,!0),B.clearFocus()):!M.shiftKey&&Te(M.target,oe[oe.length-1])&&(pe.stop(M,!0),oe[0].focus())}break;case 10:M.ctrlKey&&(pe.stop(M,!0),this.getUI().list.toggleHover());break}})),this.ui={container:t,styleSheet:i,leftActionBar:r,titleBar:s,title:o,description1:W,description2:d,widget:E,rightActionBar:a,inlineActionBar:S,checkAll:c,inputContainer:h,filterContainer:u,inputBox:f,visibleCountContainer:g,visibleCount:p,countContainer:b,count:w,okContainer:_,ok:m,message:L,customButtonContainer:v,customButton:y,list:B,progressBar:k,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:M=>this.show(M),hide:()=>this.hide(),setVisibilities:M=>this.setVisibilities(M),setEnabled:M=>this.setEnabled(M),setContextKey:M=>this.options.setContextKey(M),linkOpenerDelegate:M=>this.options.linkOpenerDelegate(M)},this.updateStyles(),this.ui}reparentUI(e){this.ui&&(this._container=e,G(this._container,this.ui.container))}pick(e,t={},i=Bn.None){return new Promise((s,r)=>{let o=d=>{var h;o=s,(h=t.onKeyMods)==null||h.call(t,a.keyMods),s(d)};if(i.isCancellationRequested){o(void 0);return}const a=this.createQuickPick({useSeparators:!0});let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)o(a.selectedItems.slice()),a.hide();else{const d=a.activeItems[0];d&&(o(d),a.hide())}}),a.onDidChangeActive(d=>{const h=d[0];h&&t.onDidFocus&&t.onDidFocus(h)}),a.onDidChangeSelection(d=>{if(!a.canSelectMany){const h=d[0];h&&(o(h),a.hide())}}),a.onDidTriggerItemButton(d=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton({...d,removeItem:()=>{const h=a.items.indexOf(d.item);if(h!==-1){const u=a.items.slice(),f=u.splice(h,1),g=a.activeItems.filter(b=>b!==f[0]),p=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=u,g&&(a.activeItems=g),a.keepScrollPosition=p}}})),a.onDidTriggerSeparatorButton(d=>{var h;return(h=t.onDidTriggerSeparatorButton)==null?void 0:h.call(t,d)}),a.onDidChangeValue(d=>{l&&!d&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{Ns(c),o(void 0)})];a.title=t.title,t.value&&(a.value=t.value),a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([d,h])=>{l=h,a.busy=!1,a.items=d,a.canSelectMany&&(a.selectedItems=d.filter(u=>u.type!=="separator"&&u.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,d=>{r(d),a.hide()})})}createQuickPick(e={useSeparators:!1}){const t=this.getUI(!0);return new Js(t)}createInputBox(){const e=this.getUI(!0);return new nS(e)}show(e){const t=this.getUI(!0);this.onShowEmitter.fire();const i=this.controller;this.controller=e,i==null||i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",He(t.widget),t.rightActionBar.clear(),t.inlineActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Ne.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),He(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const s=this.options.backKeybindingLabel();ol.tooltip=s?C("quickInput.backWithKeybinding","Back ({0})",s):C("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus(),this.quickInputTypeContext.set(e.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.displayed=!!e.list,t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.action.enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.action.enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().inputBox.enabled=e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var r;const t=this.controller;if(!t)return;t.willHide(e);const i=(r=this.ui)==null?void 0:r.container,s=i&&!Vu(i);if(this.controller=null,this.onHideEmitter.fire(),i&&(i.style.display="none"),!s){let o=this.previousFocusElement;for(;o&&!o.offsetParent;)o=o.parentElement??void 0;o!=null&&o.offsetParent?(o.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}t.didHide(e)}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui&&this.isVisible()){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,ul.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:s,widgetShadow:r}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=s?`1px solid ${s}`:"",this.ui.container.style.boxShadow=r?`0 0 8px 2px ${r}`:"",this.ui.list.style(this.styles.list);const o=[];this.styles.pickerGroup.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const a=o.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}},ul=oi,oi.MAX_WIDTH=600,oi);fl=ul=gS([uo(1,qt),uo(2,re),uo(3,me)],fl);var mS=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},hn=function(n,e){return function(t,i){e(t,i,n)}};let gl=class extends l_{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(rl))),this._quickAccess}constructor(e,t,i,s,r){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=s,this.configurationService=r,this._onShow=this._register(new R),this._onHide=this._register(new R),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:r=>this.setContextKey(r),linkOpenerDelegate:r=>{this.instantiationService.invokeFunction(o=>{o.get(Ar).open(r,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(al))},s=this._register(this.instantiationService.createInstance(fl,{...i,...t}));return s.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(r=>{ae(e.activeContainer)===ae(s.container)&&s.layout(r,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{s.isVisible()||s.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(s.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(s.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),s}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new Qi(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=Bn.None){return this.controller.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:zt(Kc),quickInputForeground:zt(qg),quickInputTitleBackground:zt(zg),widgetBorder:zt(jg),widgetShadow:zt(Gg)},inputBox:c_,toggle:d_,countBadge:h_,button:u_,progressBar:f_,keybindingLabel:g_,list:m_({listBackground:Kc,listFocusBackground:Xc,listFocusForeground:Yc,listInactiveFocusForeground:Yc,listInactiveSelectionIconForeground:Zg,listInactiveFocusBackground:Xc,listFocusOutline:Qc,listInactiveFocusOutline:Qc}),pickerGroup:{pickerGroupBorder:zt(Kg),pickerGroupForeground:zt(Xg)}}}};gl=mS([hn(0,re),hn(1,me),hn(2,yt),hn(3,qt),hn(4,Oe)],gl);var Zf=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Yt=function(n,e){return function(t,i){e(t,i,n)}};let ml=class extends gl{constructor(e,t,i,s,r,o){super(t,i,s,new Aa(e.getContainerDomNode(),r),o),this.host=void 0;const a=qn.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get mainContainer(){return l.getDomNode()},getContainer(){return l.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[l.getDomNode()]},get activeContainer(){return l.getDomNode()},get mainContainerDimension(){return e.getLayoutInfo()},get activeContainerDimension(){return e.getLayoutInfo()},get onDidLayoutMainContainer(){return e.onDidLayoutChange},get onDidLayoutActiveContainer(){return e.onDidLayoutChange},get onDidLayoutContainer(){return ee.map(e.onDidLayoutChange,c=>({container:l.getDomNode(),dimension:c}))},get onDidChangeActiveContainer(){return ee.None},get onDidAddContainer(){return ee.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};ml=Zf([Yt(1,re),Yt(2,me),Yt(3,yt),Yt(4,Ce),Yt(5,Oe)],ml);let pl=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(ml,e);this.mapEditorToService.set(e,t),up(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t,i=Bn.None){return this.activeService.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.activeService.createQuickPick(e)}createInputBox(){return this.activeService.createInputBox()}};pl=Zf([Yt(0,re),Yt(1,Ce)],pl);const Lr=class Lr{static get(e){return e.getContribution(Lr.ID)}constructor(e){this.editor=e,this.widget=new _l(this.editor)}dispose(){this.widget.dispose()}};Lr.ID="editor.controller.quickInput";let qn=Lr;const kr=class kr{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return kr.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}};kr.ID="editor.contrib.quickInputWidget";let _l=kr;hp(qn.ID,qn,4);class pS{constructor(e,t,i,s,r){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=s,this.background=r}}function _S(n){if(!n||!Array.isArray(n))return[];const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n[i];let o=-1;if(typeof r.fontStyle=="string"){o=0;const c=r.fontStyle.split(" ");for(let d=0,h=c.length;d<h;d++)switch(c[d]){case"italic":o=o|1;break;case"bold":o=o|2;break;case"underline":o=o|4;break;case"strikethrough":o=o|8;break}}let a=null;typeof r.foreground=="string"&&(a=r.foreground);let l=null;typeof r.background=="string"&&(l=r.background),e[t++]=new pS(r.token||"",i,o,a,l)}return e}function bS(n,e){n.sort((d,h)=>{const u=yS(d.token,h.token);return u!==0?u:d.index-h.index});let t=0,i="000000",s="ffffff";for(;n.length>=1&&n[0].token==="";){const d=n.shift();d.fontStyle!==-1&&(t=d.fontStyle),d.foreground!==null&&(i=d.foreground),d.background!==null&&(s=d.background)}const r=new wS;for(const d of e)r.getId(d);const o=r.getId(i),a=r.getId(s),l=new Rc(t,o,a),c=new Mc(l);for(let d=0,h=n.length;d<h;d++){const u=n[d];c.insert(u.token,u.fontStyle,r.getId(u.foreground),r.getId(u.background))}return new Kf(r,c)}const vS=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class wS{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(vS);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=Bt.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class Kf{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(_S(e),t)}static createFromParsedTokenTheme(e,t){return bS(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const s=this._match(t),r=CS(t);i=(s.metadata|r<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const SS=/\b(comment|string|regex|regexp)\b/;function CS(n){const e=n.match(SS);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function yS(n,e){return n<e?-1:n>e?1:0}class Rc{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new Rc(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class Mc{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,s;t===-1?(i=e,s=""):(i=e.substring(0,t),s=e.substring(t+1));const r=this._children.get(i);return typeof r<"u"?r.match(s):this._mainRule}insert(e,t,i,s){if(e===""){this._mainRule.acceptOverwrite(t,i,s);return}const r=e.indexOf(".");let o,a;r===-1?(o=e,a=""):(o=e.substring(0,r),a=e.substring(r+1));let l=this._children.get(o);typeof l>"u"&&(l=new Mc(this._mainRule.clone()),this._children.set(o,l)),l.insert(a,t,i,s)}}function LS(n){const e=[];for(let t=1,i=n.length;t<i;t++){const s=n[t];e[t]=`.mtk${t} { color: ${s}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const kS={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Xn]:"#FFFFFE",[Pr]:"#000000",[Cu]:"#E5EBF1",[Hr]:"#D3D3D3",[Vr]:"#939393",[yu]:"#ADD6FF4D"}},ES={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Xn]:"#1E1E1E",[Pr]:"#D4D4D4",[Cu]:"#3A3D41",[Hr]:"#404040",[Vr]:"#707070",[yu]:"#ADD6FF26"}},xS={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Xn]:"#000000",[Pr]:"#FFFFFF",[Hr]:"#FFFFFF",[Vr]:"#FFFFFF"}},IS={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Xn]:"#FFFFFF",[Pr]:"#292929",[Hr]:"#292929",[Vr]:"#292929"}};function DS(n){const e=new ie,t=e.add(new R),i=Lu();return e.add(i.onDidChange(()=>t.fire())),n&&e.add(n.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const s=n?n.getProductIconTheme():new Xf,r={},o=[],a=[];for(const l of i.getIcons()){const c=s.getIcon(l);if(!c)continue;const d=c.font,h=`--vscode-icon-${l.id}-font-family`,u=`--vscode-icon-${l.id}-content`;d?(r[d.id]=d.definition,a.push(`${h}: ${Qr(d.id)};`,`${u}: '${c.fontCharacter}';`),o.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; font-family: ${Qr(d.id)}; }`)):(a.push(`${u}: '${c.fontCharacter}'; ${h}: 'codicon';`),o.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; }`))}for(const l in r){const c=r[l],d=c.weight?`font-weight: ${c.weight};`:"",h=c.style?`font-style: ${c.style};`:"",u=c.src.map(f=>`${Os(f.location)} format('${f.format}')`).join(", ");o.push(`@font-face { src: ${u}; font-family: ${Qr(l)};${d}${h} font-display: block; }`)}return o.push(`:root { ${a.join(" ")} }`),o.join(`
`)}}}class Xf{getIcon(e){const t=Lu();let i=e.defaults;for(;$e.isThemeIcon(i);){const s=t.getIcon(i.id);if(!s)return;i=s.defaults}return i}}const Dt="vs",yn="vs-dark",Hi="hc-black",Vi="hc-light",Yf=Ut.as(Yg.ColorContribution),RS=Ut.as(p_.ThemingContribution);class Qf{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(Ls(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,Bt.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=bl(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,Bt.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=Yf.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case Dt:return ns.LIGHT;case Hi:return ns.HIGH_CONTRAST_DARK;case Vi:return ns.HIGH_CONTRAST_LIGHT;default:return ns.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const r=bl(this.themeData.base);e=r.rules,r.encodedTokensColors&&(t=r.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],s=this.themeData.colors["editor.background"];if(i||s){const r={token:""};i&&(r.foreground=i),s&&(r.background=s),e.push(r)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=Kf.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const r=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=Jc.getForeground(r),a=Jc.getFontStyle(r);return{foreground:o,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}}function Ls(n){return n===Dt||n===yn||n===Hi||n===Vi}function bl(n){switch(n){case Dt:return kS;case yn:return ES;case Hi:return xS;case Vi:return IS}}function gs(n){const e=bl(n);return new Qf(n,e)}class MS extends D{constructor(){super(),this._onColorThemeChange=this._register(new R),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new R),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new Xf,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(Dt,gs(Dt)),this._knownThemes.set(yn,gs(yn)),this._knownThemes.set(Hi,gs(Hi)),this._knownThemes.set(Vi,gs(Vi));const e=this._register(DS(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(Dt),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),fp(Ue,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return Io(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Fn(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),D.None}_registerShadowDomContainer(e){const t=Fn(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!Ls(t.base)&&!Ls(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new Qf(e,t)),Ls(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(Dt),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=Ue.matchMedia("(forced-colors: active)").matches;if(e!==__(this._theme.type)){let t;cf(this._theme.type)?t=e?Hi:yn:t=e?Vi:Dt,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:o=>{t[o]||(e.push(o),t[o]=!0)}};RS.getThemingParticipants().forEach(o=>o(this._theme,i,this._environment));const s=[];for(const o of Yf.getColors()){const a=this._theme.getColor(o.id,!0);a&&s.push(`${Qg(o.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${s.join(`
`)} }`);const r=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(LS(r)),this._themeCSS=e.join(`
`),this._updateCSS(),Le.setColorMap(r),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const Xe=dt("themeService");var TS=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},fo=function(n,e){return function(t,i){e(t,i,n)}};let vl=class extends D{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new R,this._onDidChangeReducedMotion=new R,this._onDidChangeLinkUnderline=new R,this._accessibilityModeEnabledContext=b_.bindTo(this._contextKeyService);const s=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("editor.accessibilitySupport")&&(s(),this._onDidChangeScreenReaderOptimized.fire()),o.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),s(),this._register(this.onDidChangeScreenReaderOptimized(()=>s()));const r=Ue.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=r.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(r),this.initLinkUnderlineListeners()}initReducedMotionListeners(e){this._register(I(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("reduce-motion",i),this._layoutService.mainContainer.classList.toggle("enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("accessibility.underlineLinks")){const i=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=i,this._onDidChangeLinkUnderline.fire()}}));const e=()=>{const t=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",t)};e(),this._register(this.onDidChangeLinkUnderlines(()=>e()))}onDidChangeLinkUnderlines(e){return this._onDidChangeLinkUnderline.event(e)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};vl=TS([fo(0,me),fo(1,qt),fo(2,Oe)],vl);var NS=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Oh=function(n,e){return function(t,i){e(t,i,n)}},wl;const Ph="application/vnd.code.resources";var ai;let Sl=(ai=class extends D{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(gp||mp)&&this.installWebKitWriteTextWorkaround(),this._register(ee.runAndSubscribe(ef,({window:i,disposables:s})=>{s.add(I(i.document,"copy",()=>this.clearResourcesState()))},{window:Ue,disposables:this._store}))}installWebKitWriteTextWorkaround(){const e=()=>{const t=new Zu;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,mn().navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(async i=>{(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)})};this._register(ee.runAndSubscribe(this.layoutService.onDidAddContainer,({container:t,disposables:i})=>{i.add(I(t,"click",e)),i.add(I(t,"keydown",e))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(e,t){if(this.clearResourcesState(),t){this.mapTextToType.set(t,e);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return await mn().navigator.clipboard.writeText(e)}catch(i){console.error(i)}this.fallbackWriteText(e)}fallbackWriteText(e){const t=pp(),i=t.activeElement,s=t.body.appendChild(he("textarea",{"aria-hidden":!0}));s.style.height="1px",s.style.width="1px",s.style.position="absolute",s.value=e,s.focus(),s.select(),t.execCommand("copy"),ot(i)&&i.focus(),s.remove()}async readText(e){if(e)return this.mapTextToType.get(e)||"";try{return await mn().navigator.clipboard.readText()}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(e){this.findText=e}async readResources(){try{const t=await mn().navigator.clipboard.read();for(const i of t)if(i.types.includes(`web ${Ph}`)){const s=await i.getType(`web ${Ph}`);return JSON.parse(await s.text()).map(o=>Ae.from(o))}}catch{}const e=await this.computeResourcesStateHash();return this.resourcesStateHash!==e&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const e=await this.readText();return _p(e.substring(0,wl.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}},wl=ai,ai.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3,ai);Sl=wl=NS([Oh(0,qt),Oh(1,Vt)],Sl);var AS=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},OS=function(n,e){return function(t,i){e(t,i,n)}};const Ln="data-keybinding-context";class Tc{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return{...this._value}}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}}const Er=class Er extends Tc{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}};Er.INSTANCE=new Er;let Gi=Er;const Mn=class Mn extends Tc{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=fb.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(s=>{if(s.source===7){const r=Array.from(this._values,([o])=>o);this._values.clear(),i.fire(new Bh(r))}else{const r=[];for(const o of s.affectedKeys){const a=`config.${o}`,l=this._values.findSuperstr(a);l!==void 0&&(r.push(...Ii.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(r.push(a),this._values.delete(a))}i.fire(new Bh(r))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(Mn._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(Mn._keyPrefix.length),i=this._configurationService.getValue(t);let s;switch(typeof i){case"number":case"boolean":case"string":s=i;break;default:Array.isArray(i)?s=JSON.stringify(i):s=i}return this._values.set(e,s),s}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}};Mn._keyPrefix="config.";let Cl=Mn;class PS{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class Fh{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class Bh{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class FS{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function BS(n,e){return n.allKeysContainedIn(new Set(Object.keys(e)))}class Jf extends D{constructor(e){super(),this._onDidChangeContext=this._register(new bp({merge:t=>new FS(t)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new PS(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new WS(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new Fh(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new Fh(e))}getContext(e){return this._isDisposed?Gi.INSTANCE:this.getContextValuesContainer(HS(e))}dispose(){super.dispose(),this._isDisposed=!0}}let yl=class extends Jf{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0;const t=this._register(new Cl(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t)}getContextValuesContainer(e){return this._isDisposed?Gi.INSTANCE:this._contexts.get(e)||Gi.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new Tc(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};yl=AS([OS(0,Oe)],yl);class WS extends Jf{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new Yu),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(Ln)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(Ln,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;BS(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(Ln),super.dispose())}getContextValuesContainer(e){return this._isDisposed?Gi.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function HS(n){for(;n;){if(n.hasAttribute(Ln)){const e=n.getAttribute(Ln);return e?parseInt(e,10):NaN}n=n.parentElement}return 0}function VS(n,e,t){n.get(me).createKey(String(e),US(t))}function US(n){return Jg(n,e=>{if(typeof e=="object"&&e.$mid===1)return Ae.revive(e).toString();if(e instanceof Ae)return e.toString()})}Ct.registerCommand("_setContext",VS);Ct.registerCommand({id:"getContextKeyInfo",handler(){return[...Qi.all()].sort((n,e)=>n.key.localeCompare(e.key))},metadata:{description:C("getContextKeyInfo","A command that returns information about context keys"),args:[]}});Ct.registerCommand("_generateContextKeyInfo",function(){const n=[],e=new Set;for(const t of Qi.all())e.has(t.key)||(e.add(t.key),n.push(t));n.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(n,void 0,2))});class $S{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}}class Wh{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),s=this.lookupOrInsertNode(t);i.outgoing.set(s.key,s),s.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new $S(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),s=this._findCycle(t,i);if(s)return s}}_findCycle(e,t){for(const[i,s]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const r=this._findCycle(s,t);if(r)return r;t.delete(i)}}}const qS=!1;class Hh extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class nr{constructor(e=new es,t=!1,i,s=qS){this._services=e,this._strict=t,this._parent=i,this._enableTracing=s,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(re,this),this._globalGraph=s?(i==null?void 0:i._globalGraph)??new Wh(r=>r):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Ns(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)Ou(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,s=new class extends nr{dispose(){i._children.delete(s),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(s),t==null||t.add(s),s}invokeFunction(e,...t){this._throwIfDisposed();const i=kn.traceInvocation(this._enableTracing,e);let s=!1;try{return e({get:o=>{if(s)throw Uu("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{s=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,s;return e instanceof Lt?(i=kn.traceCreation(this._enableTracing,e.ctor),s=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=kn.traceCreation(this._enableTracing,e),s=this._createInstance(e,t,i)),i.stop(),s}_createInstance(e,t=[],i){const s=hd.getServiceDependencies(e).sort((a,l)=>a.index-l.index),r=[];for(const a of s){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),r.push(l)}const o=s.length>0?s[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(r))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof Lt)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Lt?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var l;const s=new Wh(c=>c.id.toString());let r=0;const o=[{id:e,desc:t,_trace:i}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),s.lookupOrInsertNode(c),r++>1e3)throw new Hh(s);for(const d of hd.getServiceDependencies(c.desc.ctor)){const h=this._getServiceInstanceOrDescriptor(d.id);if(h||this._throwIfStrict(`[createInstance] ${e} depends on ${d.id} which is NOT registered.`,!0),(l=this._globalGraph)==null||l.insertEdge(String(c.id),String(d.id)),h instanceof Lt){const u={id:d.id,desc:h,_trace:c._trace.branch(d.id,!0)};s.insertEdge(c,u),o.push(u)}}}}for(;;){const c=s.roots();if(c.length===0){if(!s.isEmpty())throw new Hh(s);break}for(const{data:d}of c){if(this._getServiceInstanceOrDescriptor(d.id)instanceof Lt){const u=this._createServiceInstanceWithOwner(d.id,d.desc.ctor,d.desc.staticArguments,d.desc.supportsDelayedInstantiation,d._trace);this._setCreatedServiceInstance(d.id,u)}s.removeNode(d)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],s,r){if(this._services.get(e)instanceof Lt)return this._createServiceInstance(e,t,i,s,r,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,s,r);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],s,r,o){if(s){const a=new nr(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new vp(()=>{const d=a._createInstance(t,i,r);for(const[h,u]of l){const f=d[h];if(typeof f=="function")for(const g of u)g.disposable=f.apply(d,g.listener)}return l.clear(),o.add(d),d});return new Proxy(Object.create(null),{get(d,h){if(!c.isInitialized&&typeof h=="string"&&(h.startsWith("onDid")||h.startsWith("onWill"))){let g=l.get(h);return g||(g=new Ei,l.set(h,g)),(b,w,S)=>{if(c.isInitialized)return c.value[h](b,w,S);{const _={listener:[b,w,S],disposable:void 0},m=g.push(_);return le(()=>{var y;m(),(y=_.disposable)==null||y.dispose()})}}}if(h in d)return d[h];const u=c.value;let f=u[h];return typeof f!="function"||(f=f.bind(u),d[h]=f),f},set(d,h,u){return c.value[h]=u,!0},getPrototypeOf(d){return t.prototype}})}else{const a=this._createInstance(t,i,r);return o.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const Fe=class Fe{static traceInvocation(e,t){return e?new Fe(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Fe._None}static traceCreation(e,t){return e?new Fe(1,t.name):Fe._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new Fe(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;Fe._totals+=e;let t=!1;function i(r,o){const a=[],l=new Array(r+1).join("	");for(const[c,d,h]of o._dep)if(d&&h){t=!0,a.push(`${l}CREATES -> ${c}`);const u=i(r+1,h);u&&a.push(u)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const s=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${Fe._totals.toFixed(2)}ms)`];(e>2||t)&&Fe.all.add(s.join(`
`))}};Fe.all=new Set,Fe._None=new class extends Fe{constructor(){super(0,null)}stop(){}branch(){return this}},Fe._totals=0;let kn=Fe;const zS=new Set([se.inMemory,se.vscodeSourceControl,se.walkThrough,se.walkThroughSnippet,se.vscodeChatCodeBlock]);class jS{constructor(){this._byResource=new Ke,this._byOwner=new Map}set(e,t,i){let s=this._byResource.get(e);s||(s=new Map,this._byResource.set(e,s)),s.set(t,i);let r=this._byOwner.get(t);r||(r=new Ke,this._byOwner.set(t,r)),r.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,s=!1;const r=this._byResource.get(e);r&&(i=r.delete(t));const o=this._byOwner.get(t);if(o&&(s=o.delete(e)),i!==s)throw new Error("illegal state");return i&&s}values(e){var t,i;return typeof e=="string"?((t=this._byOwner.get(e))==null?void 0:t.values())??Ii.empty():Ae.isUri(e)?((i=this._byResource.get(e))==null?void 0:i.values())??Ii.empty():Ii.map(Ii.concat(...this._byOwner.values()),s=>s[1])}}class GS{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new Ke,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const s=this._resourceStats(t);this._add(s),this._data.set(t,s)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(zS.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===It.Error?t.errors+=1:i===It.Warning?t.warnings+=1:i===It.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class Et{constructor(){this._onMarkerChanged=new wp({delay:0,merge:Et._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new jS,this._stats=new GS(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(Sp(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const s=[];for(const r of i){const o=Et._toMarker(e,t,r);o&&s.push(o)}this._data.set(t,e,s),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:s,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:f}=i;if(o)return l=l>0?l:1,c=c>0?c:1,d=d>=l?d:l,h=h>0?h:c,{resource:t,owner:e,code:s,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:f}}changeAll(e,t){const i=[],s=this._data.values(e);if(s)for(const r of s){const o=Ii.first(r);o&&(i.push(o.resource),this._data.delete(o.resource,e))}if(Tu(t)){const r=new Ke;for(const{resource:o,marker:a}of t){const l=Et._toMarker(e,o,a);if(!l)continue;const c=r.get(o);c?c.push(l):(r.set(o,[l]),i.push(o))}for(const[o,a]of r)this._data.set(o,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,severities:s,take:r}=e;if((!r||r<0)&&(r=-1),t&&i){const o=this._data.get(i,t);if(o){const a=[];for(const l of o)if(Et._accept(l,s)){const c=a.push(l);if(r>0&&c===r)break}return a}else return[]}else if(!t&&!i){const o=[];for(const a of this._data.values())for(const l of a)if(Et._accept(l,s)){const c=o.push(l);if(r>0&&c===r)return o}return o}else{const o=this._data.values(i??t),a=[];for(const l of o)for(const c of l)if(Et._accept(c,s)){const d=a.push(c);if(r>0&&d===r)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new Ke;for(const i of e)for(const s of i)t.set(s,!0);return Array.from(t.keys())}}class ZS extends D{get configurationModel(){return this._configurationModel}constructor(e){super(),this.logService=e,this._configurationModel=de.createEmptyModel(this.logService)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=de.createEmptyModel(this.logService);const e=Ut.as(Or.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const s of e){const r=i[s],o=t[s];r!==void 0?this._configurationModel.setValue(s,r):o?this._configurationModel.setValue(s,o.default):this._configurationModel.removeValue(s)}}}class KS extends D{constructor(e,t=[]){super(),this.logger=new Cp([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}class XS{getParseResult(e){}}var ft=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},te=function(n,e){return function(t,i){e(t,i,n)}};class YS{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new R}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let Ll=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new yp(new YS(t))):Promise.reject(new Error("Model not found"))}};Ll=ft([te(0,Ee)],Ll);const xr=class xr{show(){return xr.NULL_PROGRESS_RUNNER}async showWhile(e,t){await e}};xr.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};let kl=xr;class QS{withProgress(e,t,i){return t({report:()=>{}})}}class JS{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class eC{async confirm(e){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),Ue.confirm(i)}async prompt(e){var s;let t;if(this.doConfirm(e.message,e.detail)){const r=[...e.buttons??[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&r.push(e.cancelButton),t=await((s=r[0])==null?void 0:s.run({checkboxChecked:!1}))}return{result:t}}async error(e,t){await this.prompt({type:Ne.Error,message:e,detail:t})}}const Tn=class Tn{info(e){return this.notify({severity:Ne.Info,message:e})}warn(e){return this.notify({severity:Ne.Warning,message:e})}error(e){return this.notify({severity:Ne.Error,message:e})}notify(e){switch(e.severity){case Ne.Error:console.error(e.message);break;case Ne.Warning:console.warn(e.message);break;default:console.log(e.message);break}return Tn.NO_OP}prompt(e,t,i,s){return Tn.NO_OP}status(e,t){return D.None}};Tn.NO_OP=new v_;let El=Tn,xl=class{constructor(e){this._onWillExecuteCommand=new R,this._onDidExecuteCommand=new R,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=Ct.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const s=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(s)}catch(s){return Promise.reject(s)}}};xl=ft([te(0,re)],xl);let Zi=class extends ww{constructor(e,t,i,s,r,o){super(e,t,i,s,r),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=f=>{const g=new ie;g.add(I(f,N.KEY_DOWN,p=>{const b=new je(p);this._dispatch(b,b.target)&&(b.preventDefault(),b.stopPropagation())})),g.add(I(f,N.KEY_UP,p=>{const b=new je(p);this._singleModifierDispatch(b,b.target)&&b.preventDefault()})),this._domNodeListeners.push(new tC(f,g))},l=f=>{for(let g=0;g<this._domNodeListeners.length;g++){const p=this._domNodeListeners[g];p.domNode===f&&(this._domNodeListeners.splice(g,1),p.dispose())}},c=f=>{f.getOption(61)||a(f.getContainerDomNode())},d=f=>{f.getOption(61)||l(f.getContainerDomNode())};this._register(o.onCodeEditorAdd(c)),this._register(o.onCodeEditorRemove(d)),o.listCodeEditors().forEach(c);const h=f=>{a(f.getContainerDomNode())},u=f=>{l(f.getContainerDomNode())};this._register(o.onDiffEditorAdd(h)),this._register(o.onDiffEditorRemove(u)),o.listDiffEditors().forEach(h)}addDynamicKeybinding(e,t,i,s){return ju(Ct.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:s}]))}addDynamicKeybindings(e){const t=e.map(i=>({keybinding:Lp(i.keybinding,Pi),command:i.command??null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),le(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(Ju.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new Sn(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return Ue.document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let s=0;for(const r of e){const o=r.when||void 0,a=r.keybinding;if(!a)i[s++]=new uh(void 0,r.command,r.commandArgs,o,t,null,!1);else{const l=Un.resolveKeybinding(a,Pi);for(const c of l)i[s++]=new uh(c,r.command,r.commandArgs,o,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new xo(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new Un([t],Pi)}};Zi=ft([te(0,me),te(1,Yi),te(2,Qn),te(3,$t),te(4,Vt),te(5,Ce)],Zi);class tC extends D{constructor(e,t){super(),this.domNode=e,this._register(t)}}function Vh(n){return n&&typeof n=="object"&&(!n.overrideIdentifier||typeof n.overrideIdentifier=="string")&&(!n.resource||n.resource instanceof Ae)}let sr=class{constructor(e){this.logService=e,this._onDidChangeConfiguration=new R,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new ZS(e);this._configuration=new jr(t.reload(),de.createEmptyModel(e),de.createEmptyModel(e),de.createEmptyModel(e),de.createEmptyModel(e),de.createEmptyModel(e),new Ke,de.createEmptyModel(e),new Ke,e),t.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,s=Vh(e)?e:Vh(t)?t:{};return this._configuration.getValue(i,s,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const s of e){const[r,o]=s;this.getValue(r)!==o&&(this._configuration.updateValue(r,o),i.push(r))}if(i.length>0){const s=new pw({keys:i,overrides:[]},t,this._configuration,void 0,this.logService);s.source=8,this._onDidChangeConfiguration.fire(s)}return Promise.resolve()}updateValue(e,t,i,s){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}};sr=ft([te(0,Vt)],sr);let Il=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new R,this.configurationService.onDidChangeConfiguration(s=>{this._onDidChangeConfiguration.fire({affectedKeys:s.affectedKeys,affectsConfiguration:(r,o)=>s.affectsConfiguration(o)})})}getValue(e,t,i){const s=K.isIPosition(t)?t:null,r=s?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,o=e?this.getLanguage(e,s):void 0;return typeof r>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:o}):this.configurationService.getValue(r,{resource:e,overrideIdentifier:o})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};Il=ft([te(0,Oe),te(1,Ee),te(2,Se)],Il);let Dl=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:Pn||ui?`
`:`\r
`}};Dl=ft([te(0,Oe)],Dl);class iC{publicLog2(){}}const Nn=class Nn{constructor(){const e=Ae.from({scheme:Nn.SCHEME,authority:"model",path:"/"});this.workspace={id:gb,folders:[new mb({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===Nn.SCHEME?this.workspace.folders[0]:null}};Nn.SCHEME="inmemory";let Rl=Nn;function rr(n,e,t){if(!e||!(n instanceof sr))return;const i=[];Object.keys(e).forEach(s=>{hw(s)&&i.push([`editor.${s}`,e[s]]),t&&uw(s)&&i.push([`diffEditor.${s}`,e[s]])}),i.length>0&&n.updateValues(i)}let Ml=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}async apply(e,t){const i=Array.isArray(e)?e:rb.convert(e),s=new Map;for(const a of i){if(!(a instanceof ob))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=s.get(l);c||(c=[],s.set(l,c)),c.push(Ap.replaceMove(O.lift(a.textEdit.range),a.textEdit.text))}let r=0,o=0;for(const[a,l]of s)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),o+=1,r+=l.length;return{ariaSummary:kp(qa.bulkEditServiceSummary,r,o),isApplied:r>0}}};Ml=ft([te(0,Ee)],Ml);class nC{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return em(e)}}let Tl=class extends rw{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const s=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();s&&(t=s.getContainerDomNode())}return super.showContextView(e,t,i)}};Tl=ft([te(0,qt),te(1,Ce)],Tl);class sC{constructor(){this._neverEmitter=new R,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class rC extends Ga{constructor(){super()}}class oC extends KS{constructor(){super(new xp)}}let Nl=class extends Xa{constructor(e,t,i,s,r,o){super(e,t,i,s,r,o),this.configure({blockMouse:!1})}};Nl=ft([te(0,Qn),te(1,$t),te(2,pc),te(3,ht),te(4,Br),te(5,me)],Nl);const Al={amdModuleId:"vs/editor/common/services/editorSimpleWorker",esmModuleLocation:void 0,label:"editorWorkerService"};let Ol=class extends Ma{constructor(e,t,i,s,r){super(Al,e,t,i,s,r)}};Ol=ft([te(0,Ee),te(1,kc),te(2,Vt),te(3,Jn),te(4,Q)],Ol);class aC{async playSignal(e,t){}}V(Vt,oC,0);V(Oe,sr,0);V(kc,Il,0);V(kf,Dl,0);V(pb,Rl,0);V(w_,nC,0);V(Qn,iC,0);V(If,eC,0);V(S_,JS,0);V($t,El,0);V(gi,Et,0);V(Se,rC,0);V(Xe,MS,0);V(Ee,il,0);V(C_,tl,0);V(me,yl,0);V(ub,QS,0);V(Cc,kl,0);V(L_,y_,0);V(nf,Ol,0);V(ab,Ml,0);V(Cw,sC,0);V(Ep,Ll,0);V(fi,vl,0);V(cb,lb,0);V(Yi,xl,0);V(ht,Zi,0);V(Gr,pl,0);V(pc,Tl,0);V(Ar,el,0);V(yc,Sl,0);V(Wr,Nl,0);V(Br,db,0);V(zr,aC,0);V(k_,XS,0);var x;(function(n){const e=new es;for(const[l,c]of md())e.set(l,c);const t=new nr(e,!0);e.set(re,t);function i(l){s||o({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof Lt?t.invokeFunction(d=>d.get(l)):c}n.get=i;let s=!1;const r=new R;function o(l){if(s)return t;s=!0;for(const[d,h]of md())e.get(d)||e.set(d,h);for(const d in l)if(l.hasOwnProperty(d)){const h=dt(d);e.get(h)instanceof Lt&&e.set(h,l[d])}const c=hb();for(const d of c)try{t.createInstance(d)}catch(h){di(h)}return r.fire(),t}n.initialize=o;function a(l){if(s)return l();const c=new ie,d=c.add(r.event(()=>{d.dispose(),c.add(l())}));return c}n.withServices=a})(x||(x={}));function lC(n,e){return new cC(n,e)}class cC extends Us{constructor(e,t){const i={amdModuleId:Al.amdModuleId,esmModuleLocation:Al.esmModuleLocation,label:t.label};super(i,t.keepIdleModels||!1,e),this._foreignModuleId=t.moduleId,this._foreignModuleCreateData=t.createData||null,this._foreignModuleHost=t.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?bo(this._foreignModuleHost):[];return e.$loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const s=(a,l)=>e.$fmr(a,l),r=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)},o={};for(const a of i)o[a]=r(a,s);return o})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this.workerWithSyncedResources(e).then(t=>this.getProxy())}}function dC(n){return Array.isArray(n)}function hC(n){return!dC(n)}function eg(n){return typeof n=="string"}function Uh(n){return!eg(n)}function Qt(n){return!n}function St(n,e){return n.ignoreCase&&e?e.toLowerCase():e}function $h(n){return n.replace(/[&<>'"_]/g,"-")}function uC(n,e){console.log(`${n.languageId}: ${e}`)}function Z(n,e){return new Error(`${n.languageId}: ${e}`)}function Rt(n,e,t,i,s){const r=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let o=null;return e.replace(r,function(a,l,c,d,h,u,f,g,p){return Qt(c)?Qt(d)?!Qt(h)&&h<i.length?St(n,i[h]):!Qt(f)&&n&&typeof n[f]=="string"?n[f]:(o===null&&(o=s.split("."),o.unshift(s)),!Qt(u)&&u<o.length?St(n,o[u]):""):St(n,t):"$"})}function fC(n,e,t){const i=/\$[sS](\d\d?)/g;let s=null;return e.replace(i,function(r,o){return s===null&&(s=t.split("."),s.unshift(t)),!Qt(o)&&o<s.length?St(n,s[o]):""})}function ms(n,e){let t=e;for(;t&&t.length>0;){const i=n.tokenizer[t];if(i)return i;const s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return null}function gC(n,e){let t=e;for(;t&&t.length>0;){if(n.stateNames[t])return!0;const s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return!1}var mC=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},pC=function(n,e){return function(t,i){e(t,i,n)}},Pl;const tg=5,Ir=class Ir{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new Ui(e,t);let i=Ui.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let s=this._entries[i];return s||(s=new Ui(e,t),this._entries[i]=s,s)}};Ir._INSTANCE=new Ir(tg);let zn=Ir;class Ui{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return Ui._equals(this,e)}push(e){return zn.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return zn.create(this.parent,e)}}class Ti{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new Ti(this.languageId,this.state)}}const Dr=class Dr{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new En(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new En(e,t);const i=Ui.getStackElementId(e);let s=this._entries[i];return s||(s=new En(e,null),this._entries[i]=s,s)}};Dr._INSTANCE=new Dr(tg);let Mt=Dr;class En{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Mt.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof En)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class _C{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new xs(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,s){const r=i.languageId,o=i.state,a=Le.get(r);if(!a)return this.enterLanguage(r),this.emit(s,""),o;const l=a.tokenize(e,t,o);if(s!==0)for(const c of l.tokens)this._tokens.push(new xs(c.offset+s,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new Eu(this._tokens,e)}}class or{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const s=e!==null?e.length:0,r=t.length,o=i!==null?i.length:0;if(s===0&&r===0&&o===0)return new Uint32Array(0);if(s===0&&r===0)return i;if(r===0&&o===0)return e;const a=new Uint32Array(s+r+o);e!==null&&a.set(e);for(let l=0;l<r;l++)a[s+l]=t[l];return i!==null&&a.set(i,s+r),a}nestedLanguageTokenize(e,t,i,s){const r=i.languageId,o=i.state,a=Le.get(r);if(!a)return this.enterLanguage(r),this.emit(s,""),o;const l=a.tokenizeEncoded(e,t,o);if(s!==0)for(let c=0,d=l.tokens.length;c<d;c+=2)l.tokens[c]+=s;return this._prependTokens=or._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new ac(or._merge(this._prependTokens,this._tokens,null),e)}}let jn=Pl=class extends D{constructor(e,t,i,s,r){super(),this._configurationService=r,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=s,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._register(Le.onDidChange(a=>{if(o)return;let l=!1;for(let c=0,d=a.changedLanguages.length;c<d;c++){const h=a.changedLanguages[c];if(this._embeddedLanguages[h]){l=!0;break}}l&&(o=!0,Le.handleChange([this._languageId]),o=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=Le.get(t);if(i){if(i instanceof Pl){const s=i.getLoadStatus();s.loaded===!1&&e.push(s.promise)}continue}Le.isResolved(t)||e.push(Le.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=zn.create(null,this._lexer.start);return Mt.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return ku(this._languageId,i);const s=new _C,r=this._tokenize(e,t,i,s);return s.finalize(r)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return tm(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const s=new or(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),r=this._tokenize(e,t,i,s);return s.finalize(r)}_tokenize(e,t,i,s){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,s):this._myTokenize(e,t,i,0,s)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=ms(this._lexer,t.stack.state),!i))throw Z(this._lexer,"tokenizer state is not defined: "+t.stack.state);let s=-1,r=!1;for(const o of i){if(!Uh(o.action)||o.action.nextEmbedded!=="@pop")continue;r=!0;let a=o.resolveRegex(t.stack.state);const l=a.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const d=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),d)}const c=e.search(a);c===-1||c!==0&&o.matchOnlyAtLineStart||(s===-1||c<s)&&(s=c)}if(!r)throw Z(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return s}_nestedTokenize(e,t,i,s,r){const o=this._findLeavingNestedLanguageOffset(e,i);if(o===-1){const c=r.nestedLanguageTokenize(e,t,i.embeddedLanguageData,s);return Mt.create(i.stack,new Ti(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,o);a.length>0&&r.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,s);const l=e.substring(o);return this._myTokenize(l,t,i,s+o,r)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,s,r){r.enterLanguage(this._languageId);const o=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,d=i.stack,h=0,u=null,f=!0;for(;f||h<l;){const g=h,p=d.depth,b=u?u.groups.length:0,w=d.state;let S=null,_=null,m=null,v=null,y=null;if(u){S=u.matches;const E=u.groups.shift();_=E.matched,m=E.action,v=u.rule,u.groups.length===0&&(u=null)}else{if(!f&&h>=l)break;f=!1;let E=this._lexer.tokenizer[w];if(!E&&(E=ms(this._lexer,w),!E))throw Z(this._lexer,"tokenizer state is not defined: "+w);const W=a.substr(h);for(const H of E)if((h===0||!H.matchOnlyAtLineStart)&&(S=W.match(H.resolveRegex(w)),S)){_=S[0],m=H.action;break}}if(S||(S=[""],_=""),m||(h<l&&(S=[a.charAt(h)],_=S[0]),m=this._lexer.defaultToken),_===null)break;for(h+=_.length;hC(m)&&Uh(m)&&m.test;)m=m.test(_,S,w,h===l);let L=null;if(typeof m=="string"||Array.isArray(m))L=m;else if(m.group)L=m.group;else if(m.token!==null&&m.token!==void 0){if(m.tokenSubst?L=Rt(this._lexer,m.token,_,S,w):L=m.token,m.nextEmbedded)if(m.nextEmbedded==="@pop"){if(!c)throw Z(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw Z(this._lexer,"cannot enter embedded language from within an embedded language");y=Rt(this._lexer,m.nextEmbedded,_,S,w)}if(m.goBack&&(h=Math.max(0,h-m.goBack)),m.switchTo&&typeof m.switchTo=="string"){let E=Rt(this._lexer,m.switchTo,_,S,w);if(E[0]==="@"&&(E=E.substr(1)),ms(this._lexer,E))d=d.switchTo(E);else throw Z(this._lexer,"trying to switch to a state '"+E+"' that is undefined in rule: "+this._safeRuleName(v))}else{if(m.transform&&typeof m.transform=="function")throw Z(this._lexer,"action.transform not supported");if(m.next)if(m.next==="@push"){if(d.depth>=this._lexer.maxStack)throw Z(this._lexer,"maximum tokenizer stack size reached: ["+d.state+","+d.parent.state+",...]");d=d.push(w)}else if(m.next==="@pop"){if(d.depth<=1)throw Z(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(v));d=d.pop()}else if(m.next==="@popall")d=d.popall();else{let E=Rt(this._lexer,m.next,_,S,w);if(E[0]==="@"&&(E=E.substr(1)),ms(this._lexer,E))d=d.push(E);else throw Z(this._lexer,"trying to set a next state '"+E+"' that is undefined in rule: "+this._safeRuleName(v))}}m.log&&typeof m.log=="string"&&uC(this._lexer,this._lexer.languageId+": "+Rt(this._lexer,m.log,_,S,w))}if(L===null)throw Z(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(v));const k=E=>{const W=this._languageService.getLanguageIdByLanguageName(E)||this._languageService.getLanguageIdByMimeType(E)||E,H=this._getNestedEmbeddedLanguageData(W);if(h<l){const B=e.substr(h);return this._nestedTokenize(B,t,Mt.create(d,H),s+h,r)}else return Mt.create(d,H)};if(Array.isArray(L)){if(u&&u.groups.length>0)throw Z(this._lexer,"groups cannot be nested: "+this._safeRuleName(v));if(S.length!==L.length+1)throw Z(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(v));let E=0;for(let W=1;W<S.length;W++)E+=S[W].length;if(E!==_.length)throw Z(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(v));u={rule:v,matches:S,groups:[]};for(let W=0;W<L.length;W++)u.groups[W]={action:L[W],matched:S[W+1]};h-=_.length;continue}else{if(L==="@rematch"&&(h-=_.length,_="",S=null,L="",y!==null))return k(y);if(_.length===0){if(l===0||p!==d.depth||w!==d.state||(u?u.groups.length:0)!==b)continue;throw Z(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(v))}let E=null;if(eg(L)&&L.indexOf("@brackets")===0){const W=L.substr(9),H=bC(this._lexer,_);if(!H)throw Z(this._lexer,"@brackets token returned but no bracket defined as: "+_);E=$h(H.token+W)}else{const W=L===""?"":L+this._lexer.tokenPostfix;E=$h(W)}g<o&&r.emit(g+s,E)}if(y!==null)return k(y)}return Mt.create(d,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new Ti(e,So);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),Le.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=Le.get(e);return t?new Ti(e,t.getInitialState()):new Ti(e,So)}};jn=Pl=mC([pC(4,Oe)],jn);function bC(n,e){if(!e)return null;e=St(n,e);const t=n.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}const go=Nr("standaloneColorizer",{createHTML:n=>n});class Nc{static colorizeElement(e,t,i,s){s=s||{};const r=s.theme||"vs",o=s.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(o)||o;e.setTheme(r);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+r;const c=d=>{const h=(go==null?void 0:go.createHTML(d))??d;i.innerHTML=h};return this.colorize(t,l||"",a,s).then(c,d=>console.error(d))}static async colorize(e,t,i,s){const r=e.languageIdCodec;let o=4;s&&typeof s.tabSize=="number"&&(o=s.tabSize),$u(t)&&(t=t.substr(1));const a=uc(t);if(!e.isRegisteredLanguageId(i))return qh(a,o,r);const l=await Le.getOrCreate(i);return l?vC(a,o,l,r):qh(a,o,r)}static colorizeLine(e,t,i,s,r=4){const o=ct.isBasicASCII(e,t),a=ct.containsRTL(e,o,i);return Ur(new ts(!1,!0,e,!1,o,a,0,s,[],r,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const s=e.getLineContent(t);e.tokenization.forceTokenization(t);const o=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(s,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function vC(n,e,t,i){return new Promise((s,r)=>{const o=()=>{const a=wC(n,e,t,i);if(t instanceof jn){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(o,r);return}}s(a)};o()})}function qh(n,e,t){let i=[];const r=new Uint32Array(2);r[0]=0,r[1]=33587200;for(let o=0,a=n.length;o<a;o++){const l=n[o];r[0]=l.length;const c=new Ts(r,l,t),d=ct.isBasicASCII(l,!0),h=ct.containsRTL(l,d,!0),u=Ur(new ts(!1,!0,l,!1,d,h,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(u.html),i.push("<br/>")}return i.join("")}function wC(n,e,t,i){let s=[],r=t.getInitialState();for(let o=0,a=n.length;o<a;o++){const l=n[o],c=t.tokenizeEncoded(l,!0,r);Ts.convertToEndOffset(c.tokens,l.length);const d=new Ts(c.tokens,l,i),h=ct.isBasicASCII(l,!0),u=ct.containsRTL(l,h,!0),f=Ur(new ts(!1,!0,l,!1,h,u,0,d.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));s=s.concat(f.html),s.push("<br/>"),r=c.endState}return s.join("")}function SC(n,e,t,i){if(n.length===0)return e;if(e.length===0)return n;const s=[];let r=0,o=0;for(;r<n.length&&o<e.length;){const a=n[r],l=e[o],c=t(a),d=t(l);c<d?(s.push(a),r++):c>d?(s.push(l),o++):(s.push(i(a,l)),r++,o++)}for(;r<n.length;)s.push(n[r]),r++;for(;o<e.length;)s.push(e[o]),o++;return s}function ar(n,e){const t=new ie,i=n.createDecorationsCollection();return t.add(_c({debugName:()=>`Apply decorations from ${e.debugName}`},s=>{const r=e.read(s);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}function bn(n,e){return n.appendChild(e),le(()=>{e.remove()})}function CC(n,e){return n.prepend(e),le(()=>{e.remove()})}class ig extends D{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new E_(e,t)),this._width=F(this,this.elementSizeObserver.getWidth()),this._height=F(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>ge(s=>{this._width.set(this.elementSizeObserver.getWidth(),s),this._height.set(this.elementSizeObserver.getHeight(),s)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function zh(n,e,t){let i=e.get(),s=i,r=i;const o=F("animatedValue",i);let a=-1;const l=300;let c;t.add($r({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(h,u)=>(h.didChange(e)&&(u.animate=u.animate||h.change),!0)},(h,u)=>{c!==void 0&&(n.cancelAnimationFrame(c),c=void 0),s=r,i=e.read(h),a=Date.now()-(u.animate?0:l),d()}));function d(){const h=Date.now()-a;r=Math.floor(yC(h,s,i-s,l)),h<l?c=n.requestAnimationFrame(d):r=i,o.set(r,void 0)}return o}function yC(n,e,t,i){return n===i?e+t:t*(-Math.pow(2,-10*n/i)+1)+e}class Ac extends D{constructor(e,t,i){super(),this._register(new Fl(e,i)),this._register(Ht(i,{height:t.actualHeight,top:t.actualTop}))}}class Ni{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=F(this,void 0),this._actualHeight=F(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}const Rr=class Rr{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${Rr._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};Rr._counter=0;let Fl=Rr;function Ht(n,e){return $(t=>{for(let[i,s]of Object.entries(e))s&&typeof s=="object"&&"read"in s&&(s=s.read(t)),typeof s=="number"&&(s=`${s}px`),i=i.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),n.style[i]=s})}function lr(n,e,t,i){const s=new ie,r=[];return s.add(et((o,a)=>{const l=e.read(o),c=new Map,d=new Map;t&&t(!0),n.changeViewZones(h=>{for(const u of r)h.removeZone(u),i==null||i.delete(u);r.length=0;for(const u of l){const f=h.addZone(u);u.setZoneId&&u.setZoneId(f),r.push(f),i==null||i.add(f),c.set(u,f)}}),t&&t(!1),a.add($r({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(h,u){const f=d.get(h.changedObservable);return f!==void 0&&u.zoneIds.push(f),!0}},(h,u)=>{for(const f of l)f.onChange&&(d.set(f.onChange,c.get(f)),f.onChange.read(h));t&&t(!0),n.changeViewZones(f=>{for(const g of u.zoneIds)f.layoutZone(g)}),t&&t(!1)}))})),s.add({dispose(){t&&t(!0),n.changeViewZones(o=>{for(const a of r)o.removeZone(a)}),i==null||i.clear(),t&&t(!1)}}),s}function jh(n,e){const t=Do(e,s=>s.original.startLineNumber<=n.lineNumber);if(!t)return O.fromPositions(n);if(t.original.endLineNumberExclusive<=n.lineNumber){const s=n.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return O.fromPositions(new K(s,n.column))}if(!t.innerChanges)return O.fromPositions(new K(t.modified.startLineNumber,1));const i=Do(t.innerChanges,s=>s.originalRange.getStartPosition().isBeforeOrEqual(n));if(!i){const s=n.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return O.fromPositions(new K(s,n.column))}if(i.originalRange.containsPosition(n))return i.modifiedRange;{const s=LC(i.originalRange.getEndPosition(),n);return O.fromPositions(s.addToPosition(i.modifiedRange.getEndPosition()))}}function LC(n,e){return n.lineNumber===e.lineNumber?new Wn(0,e.column-n.column):new Wn(e.lineNumber-n.lineNumber,e.column-1)}function kC(n,e){let t;return n.filter(i=>{const s=e(i,t);return t=i,s})}class cr{static create(e,t=void 0){return new Gh(e,e,t)}static createWithDisposable(e,t,i=void 0){const s=new ie;return s.add(t),s.add(e),new Gh(e,s,i)}}class Gh extends cr{constructor(e,t,i){super(),this.object=e,this._disposable=t,this._debugOwner=i,this._refCount=1,this._isDisposed=!1,this._owners=[],i&&this._addOwner(i)}_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new EC(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){const t=this._owners.indexOf(e);t!==-1&&this._owners.splice(t,1)}}}class EC extends cr{constructor(e,t){super(),this._base=e,this._debugOwner=t,this._isDisposed=!1}get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}var Oc=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Pc=function(n,e){return function(t,i){e(t,i,n)}};const xC=Yn("diff-review-insert",we.add,C("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),IC=Yn("diff-review-remove",we.remove,C("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),DC=Yn("diff-review-close",we.close,C("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));var qi;let ei=(qi=class extends D{constructor(e,t,i,s,r,o,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=s,this._width=r,this._height=o,this._diffs=a,this._models=l,this._instantiationService=c,this._state=Ji(this,(d,h)=>{const u=this._visible.read(d);if(this._parentNode.style.visibility=u?"visible":"hidden",!u)return null;const f=h.add(this._instantiationService.createInstance(Bl,this._diffs,this._models,this._setVisible,this._canClose)),g=h.add(this._instantiationService.createInstance(Wl,this._parentNode,f,this._width,this._height,this._models));return{model:f,view:g}}).recomputeInitiallyAndOnChange(this._store)}next(){ge(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this._state.get().model.nextGroup(e)})}prev(){ge(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){ge(e=>{this._setVisible(!1,e)})}},qi._ttPolicy=Nr("diffReview",{createHTML:e=>e}),qi);ei=Oc([Pc(8,re)],ei);let Bl=class extends D{constructor(e,t,i,s,r){super(),this._diffs=e,this._models=t,this._setVisible=i,this.canClose=s,this._accessibilitySignalService=r,this._groups=F(this,[]),this._currentGroupIdx=F(this,0),this._currentElementIdx=F(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((o,a)=>this._groups.read(a)[o]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((o,a)=>{var l;return(l=this.currentGroup.read(a))==null?void 0:l.lines[o]}),this._register($(o=>{const a=this._diffs.read(o);if(!a){this._groups.set([],void 0);return}const l=RC(a,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());ge(c=>{const d=this._models.getModifiedPosition();if(d){const h=l.findIndex(u=>(d==null?void 0:d.lineNumber)<u.range.modified.endLineNumberExclusive);h!==-1&&this._currentGroupIdx.set(h,c)}this._groups.set(l,c)})})),this._register($(o=>{const a=this.currentElement.read(o);(a==null?void 0:a.type)===ke.Deleted?this._accessibilitySignalService.playSignal(kt.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(a==null?void 0:a.type)===ke.Added&&this._accessibilitySignalService.playSignal(kt.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register($(o=>{const a=this.currentElement.read(o);if(a&&a.type!==ke.Header){const l=a.modifiedLineNumber??a.diff.modified.startLineNumber;this._models.modifiedSetSelection(O.fromPositions(new K(l,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||df(t,s=>{this._currentGroupIdx.set(q.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),s),this._currentElementIdx.set(0,s)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||ge(i=>{this._currentElementIdx.set(q.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&ge(s=>{this._currentElementIdx.set(i,s)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===ke.Deleted?this._models.originalReveal(O.fromPositions(new K(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==ke.Header?O.fromPositions(new K(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};Bl=Oc([Pc(4,zr)],Bl);const un=3;function RC(n,e,t){const i=[];for(const s of hc(n,(r,o)=>o.modified.startLineNumber-r.modified.endLineNumberExclusive<2*un)){const r=[];r.push(new TC);const o=new A(Math.max(1,s[0].original.startLineNumber-un),Math.min(s[s.length-1].original.endLineNumberExclusive+un,e+1)),a=new A(Math.max(1,s[0].modified.startLineNumber-un),Math.min(s[s.length-1].modified.endLineNumberExclusive+un,t+1));Ru(s,(d,h)=>{const u=new A(d?d.original.endLineNumberExclusive:o.startLineNumber,h?h.original.startLineNumber:o.endLineNumberExclusive),f=new A(d?d.modified.endLineNumberExclusive:a.startLineNumber,h?h.modified.startLineNumber:a.endLineNumberExclusive);u.forEach(g=>{r.push(new OC(g,f.startLineNumber+(g-u.startLineNumber)))}),h&&(h.original.forEach(g=>{r.push(new NC(h,g))}),h.modified.forEach(g=>{r.push(new AC(h,g))}))});const l=s[0].modified.join(s[s.length-1].modified),c=s[0].original.join(s[s.length-1].original);i.push(new MC(new ve(l,c),r))}return i}var ke;(function(n){n[n.Header=0]="Header",n[n.Unchanged=1]="Unchanged",n[n.Deleted=2]="Deleted",n[n.Added=3]="Added"})(ke||(ke={}));class MC{constructor(e,t){this.range=e,this.lines=t}}class TC{constructor(){this.type=ke.Header}}class NC{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=ke.Deleted,this.modifiedLineNumber=void 0}}class AC{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=ke.Added,this.originalLineNumber=void 0}}class OC{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=ke.Unchanged}}let Wl=class extends D{constructor(e,t,i,s,r,o){super(),this._element=e,this._model=t,this._width=i,this._height=s,this._models=r,this._languageService=o,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new ni(a)),this._register($(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(new Fi("diffreview.close",C("label.close","Close"),"close-diff-review "+$e.asClassName(DC),!0,async()=>t.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new Su(this._content,{})),He(this.domNode,this._scrollbar.getDomNode(),a),this._register($(l=>{this._height.read(l),this._width.read(l),this._scrollbar.scanDomNode()})),this._register(le(()=>{He(this.domNode)})),this._register(Ht(this.domNode,{width:this._width,height:this._height})),this._register(Ht(this._content,{width:this._width,height:this._height})),this._register(et((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(lt(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),s=document.createElement("div");s.className="diff-review-table",s.setAttribute("role","list"),s.setAttribute("aria-label",C("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),lc(s,i.get(50)),He(this._content,s);const r=this._models.getOriginalModel(),o=this._models.getModifiedModel();if(!r||!o)return;const a=r.getOptions(),l=o.getOptions(),c=i.get(67),d=this._model.currentGroup.get();for(const h of(d==null?void 0:d.lines)||[]){if(!d)break;let u;if(h.type===ke.Header){const g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");const p=d.range,b=this._model.currentGroupIndex.get(),w=this._model.groups.get().length,S=y=>y===0?C("no_lines_changed","no lines changed"):y===1?C("one_line_changed","1 line changed"):C("more_lines_changed","{0} lines changed",y),_=S(p.original.length),m=S(p.modified.length);g.setAttribute("aria-label",C({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",b+1,w,p.original.startLineNumber,_,p.modified.startLineNumber,m));const v=document.createElement("div");v.className="diff-review-cell diff-review-summary",v.appendChild(document.createTextNode(`${b+1}/${w}: @@ -${p.original.startLineNumber},${p.original.length} +${p.modified.startLineNumber},${p.modified.length} @@`)),g.appendChild(v),u=g}else u=this._createRow(h,c,this._width.get(),t,r,a,i,o,l);s.appendChild(u);const f=T(g=>this._model.currentElement.read(g)===h);e.add($(g=>{const p=f.read(g);u.tabIndex=p?0:-1,p&&u.focus()})),e.add(I(u,"focus",()=>{this._model.goToLine(h)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,s,r,o,a,l,c){const d=s.get(146),h=d.glyphMarginWidth+d.lineNumbersWidth,u=a.get(146),f=10+u.glyphMarginWidth+u.lineNumbersWidth;let g="diff-review-row",p="";const b="diff-review-spacer";let w=null;switch(e.type){case ke.Added:g="diff-review-row line-insert",p=" char-insert",w=xC;break;case ke.Deleted:g="diff-review-row line-delete",p=" char-delete",w=IC;break}const S=document.createElement("div");S.style.minWidth=i+"px",S.className=g,S.setAttribute("role","listitem"),S.ariaLevel="";const _=document.createElement("div");_.className="diff-review-cell",_.style.height=`${t}px`,S.appendChild(_);const m=document.createElement("span");m.style.width=h+"px",m.style.minWidth=h+"px",m.className="diff-review-line-number"+p,e.originalLineNumber!==void 0?m.appendChild(document.createTextNode(String(e.originalLineNumber))):m.innerText=" ",_.appendChild(m);const v=document.createElement("span");v.style.width=f+"px",v.style.minWidth=f+"px",v.style.paddingRight="10px",v.className="diff-review-line-number"+p,e.modifiedLineNumber!==void 0?v.appendChild(document.createTextNode(String(e.modifiedLineNumber))):v.innerText=" ",_.appendChild(v);const y=document.createElement("span");if(y.className=b,w){const E=document.createElement("span");E.className=$e.asClassName(w),E.innerText="  ",y.appendChild(E)}else y.innerText="  ";_.appendChild(y);let L;if(e.modifiedLineNumber!==void 0){let E=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);ei._ttPolicy&&(E=ei._ttPolicy.createHTML(E)),_.insertAdjacentHTML("beforeend",E),L=l.getLineContent(e.modifiedLineNumber)}else{let E=this._getLineHtml(r,s,o.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);ei._ttPolicy&&(E=ei._ttPolicy.createHTML(E)),_.insertAdjacentHTML("beforeend",E),L=r.getLineContent(e.originalLineNumber)}L.length===0&&(L=C("blanduty","blank"));let k="";switch(e.type){case ke.Unchanged:e.originalLineNumber===e.modifiedLineNumber?k=C({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",L,e.originalLineNumber):k=C("equalLine","{0} original line {1} modified line {2}",L,e.originalLineNumber,e.modifiedLineNumber);break;case ke.Added:k=C("insertLine","+ {0} modified line {1}",L,e.modifiedLineNumber);break;case ke.Deleted:k=C("deleteLine","- {0} original line {1}",L,e.originalLineNumber);break}return S.setAttribute("aria-label",k),S}_getLineHtml(e,t,i,s,r){const o=e.getLineContent(s),a=t.get(50),l=Ts.createEmpty(o,r),c=ct.isBasicASCII(o,e.mightContainNonBasicASCII()),d=ct.containsRTL(o,c,e.mightContainRTL());return Ur(new ts(a.isMonospace&&!t.get(33),a.canUseHalfwidthRightwardsArrow,o,!1,c,d,0,l,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(118),t.get(100),t.get(95),t.get(51)!==xu.OFF,null)).html}};Wl=Oc([Pc(5,Se)],Wl);class PC{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}Ki("diffEditor.move.border","#8b8b8b9c",C("diffEditor.move.border","The border color for text that got moved in the diff editor."));Ki("diffEditor.moveActive.border","#FFA500",C("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));Ki("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},C("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets."));const FC=Yn("diff-insert",we.add,C("diffInsertIcon","Line decoration for inserts in the diff editor.")),ng=Yn("diff-remove",we.remove,C("diffRemoveIcon","Line decoration for removals in the diff editor.")),Zh=ut.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+$e.asClassName(FC),marginClassName:"gutter-insert"}),Kh=ut.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+$e.asClassName(ng),marginClassName:"gutter-delete"}),Xh=ut.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),Yh=ut.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),Qh=ut.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),BC=ut.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),WC=ut.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),Hl=ut.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),HC=ut.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),VC=ut.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var sg=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Vl=function(n,e){return function(t,i){e(t,i,n)}},Zt;const rg=dt("diffProviderFactoryService");let Ul=class{constructor(e){this.instantiationService=e}createDiffProvider(e){return this.instantiationService.createInstance($l,e)}};Ul=sg([Vl(0,re)],Ul);V(rg,Ul,1);var li;let $l=(li=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new R,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;(e=this.diffAlgorithmOnDidChangeSubscription)==null||e.dispose()}async computeDiff(e,t,i,s){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,s);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new Ve(new A(1,2),new A(1,t.getLineCount()+1),[new We(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const r=JSON.stringify([e.uri.toString(),t.uri.toString()]),o=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=Zt.diffCache.get(r);if(a&&a.context===o)return a.result;const l=fc.create(),c=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),d=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:d,timedOut:(c==null?void 0:c.quitEarly)??!0,detectedMoves:i.computeMoves?(c==null?void 0:c.moves.length)??0:-1}),s.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!c)throw new Error("no diff result available");return Zt.diffCache.size>10&&Zt.diffCache.delete(Zt.diffCache.keys().next().value),Zt.diffCache.set(r,{result:c,context:o}),c}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&((i=this.diffAlgorithmOnDidChangeSubscription)==null||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}},Zt=li,li.diffCache=new Map,li);$l=Zt=sg([Vl(1,nf),Vl(2,Qn)],$l);function Fc(){return ud&&!!ud.VSCODE_DEV}function og(n){if(Fc()){const e=UC();return e.add(n),{dispose(){e.delete(n)}}}else return{dispose(){}}}function UC(){ps||(ps=new Set);const n=globalThis;return n.$hotReload_applyNewExports||(n.$hotReload_applyNewExports=e=>{const t={config:{mode:void 0},...e},i=[];for(const s of ps){const r=s(t);r&&i.push(r)}if(i.length>0)return s=>{let r=!1;for(const o of i)o(s)&&(r=!0);return r}}),ps}let ps;Fc()&&og(({oldExports:n,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return i=>{var s,r;for(const o in i){const a=i[o];if(console.log(`[hot-reload] Patching prototype methods of '${o}'`,{exportedItem:a}),typeof a=="function"&&a.prototype){const l=n[o];if(l){for(const c of Object.getOwnPropertyNames(a.prototype)){const d=Object.getOwnPropertyDescriptor(a.prototype,c),h=Object.getOwnPropertyDescriptor(l.prototype,c);((s=d==null?void 0:d.value)==null?void 0:s.toString())!==((r=h==null?void 0:h.value)==null?void 0:r.toString())&&console.log(`[hot-reload] Patching prototype method '${o}.${c}'`),Object.defineProperty(l.prototype,c,d)}i[o]=l}}}return!0}});function Ze(n,e){return $C([n],e),n}function $C(n,e){Fc()&&ze("reload",i=>og(({oldExports:s})=>{if([...Object.values(s)].some(r=>n.includes(r)))return r=>(i(void 0),!0)})).read(e)}var qC=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},zC=function(n,e){return function(t,i){e(t,i,n)}};let ql=class extends D{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i){super(),this.model=e,this._options=t,this._diffProviderFactoryService=i,this._isDiffUpToDate=F(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=F(this,void 0),this.diff=this._diff,this._unchangedRegions=F(this,void 0),this.unchangedRegions=T(this,a=>{var l;return this._options.hideUnchangedRegions.read(a)?((l=this._unchangedRegions.read(a))==null?void 0:l.regions)??[]:(ge(c=>{var d;for(const h of((d=this._unchangedRegions.get())==null?void 0:d.regions)||[])h.collapseAll(c)}),[])}),this.movedTextToCompare=F(this,void 0),this._activeMovedText=F(this,void 0),this._hoveredMovedText=F(this,void 0),this.activeMovedText=T(this,a=>this.movedTextToCompare.read(a)??this._hoveredMovedText.read(a)??this._activeMovedText.read(a)),this._cancellationTokenSource=new Fr,this._diffProvider=T(this,a=>{const l=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(a)}),c=ze("onDidChange",l.onDidChange);return{diffProvider:l,onChangeSignal:c}}),this._register(le(()=>this._cancellationTokenSource.cancel()));const s=bc("contentChangedSignal"),r=this._register(new hi(()=>s.trigger(void 0),200));this._register($(a=>{const l=this._unchangedRegions.read(a);if(!l||l.regions.some(g=>g.isDragged.read(a)))return;const c=l.originalDecorationIds.map(g=>e.original.getDecorationRange(g)).map(g=>g?A.fromRangeInclusive(g):void 0),d=l.modifiedDecorationIds.map(g=>e.modified.getDecorationRange(g)).map(g=>g?A.fromRangeInclusive(g):void 0),h=l.regions.map((g,p)=>!c[p]||!d[p]?void 0:new Nt(c[p].startLineNumber,d[p].startLineNumber,c[p].length,g.visibleLineCountTop.read(a),g.visibleLineCountBottom.read(a))).filter(Ps),u=[];let f=!1;for(const g of hc(h,(p,b)=>p.getHiddenModifiedRange(a).endLineNumberExclusive===b.getHiddenModifiedRange(a).startLineNumber))if(g.length>1){f=!0;const p=g.reduce((w,S)=>w+S.lineCount,0),b=new Nt(g[0].originalLineNumber,g[0].modifiedLineNumber,p,g[0].visibleLineCountTop.get(),g[g.length-1].visibleLineCountBottom.get());u.push(b)}else u.push(g[0]);if(f){const g=e.original.deltaDecorations(l.originalDecorationIds,u.map(b=>({range:b.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),p=e.modified.deltaDecorations(l.modifiedDecorationIds,u.map(b=>({range:b.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));ge(b=>{this._unchangedRegions.set({regions:u,originalDecorationIds:g,modifiedDecorationIds:p},b)})}}));const o=(a,l,c)=>{const d=Nt.fromDiffs(a.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c));let h;const u=this._unchangedRegions.get();if(u){const b=u.originalDecorationIds.map(m=>e.original.getDecorationRange(m)).map(m=>m?A.fromRangeInclusive(m):void 0),w=u.modifiedDecorationIds.map(m=>e.modified.getDecorationRange(m)).map(m=>m?A.fromRangeInclusive(m):void 0);let _=kC(u.regions.map((m,v)=>{if(!b[v]||!w[v])return;const y=b[v].length;return new Nt(b[v].startLineNumber,w[v].startLineNumber,y,Math.min(m.visibleLineCountTop.get(),y),Math.min(m.visibleLineCountBottom.get(),y-m.visibleLineCountTop.get()))}).filter(Ps),(m,v)=>!v||m.modifiedLineNumber>=v.modifiedLineNumber+v.lineCount&&m.originalLineNumber>=v.originalLineNumber+v.lineCount).map(m=>new ve(m.getHiddenOriginalRange(c),m.getHiddenModifiedRange(c)));_=ve.clip(_,A.ofLength(1,e.original.getLineCount()),A.ofLength(1,e.modified.getLineCount())),h=ve.inverse(_,e.original.getLineCount(),e.modified.getLineCount())}const f=[];if(h)for(const b of d){const w=h.filter(S=>S.original.intersectsStrict(b.originalUnchangedRange)&&S.modified.intersectsStrict(b.modifiedUnchangedRange));f.push(...b.setVisibleRanges(w,l))}else f.push(...d);const g=e.original.deltaDecorations((u==null?void 0:u.originalDecorationIds)||[],f.map(b=>({range:b.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),p=e.modified.deltaDecorations((u==null?void 0:u.modifiedDecorationIds)||[],f.map(b=>({range:b.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:f,originalDecorationIds:g,modifiedDecorationIds:p},l)};this._register(e.modified.onDidChangeContent(a=>{if(this._diff.get()){const c=ss.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register(e.original.onDidChangeContent(a=>{if(this._diff.get()){const c=ss.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),r.schedule()})),this._register(et(async(a,l)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(a),this._options.hideUnchangedRegionsContextLineCount.read(a),r.cancel(),s.read(a);const c=this._diffProvider.read(a);c.onChangeSignal.read(a),Ze(Cf,a),Ze(Da,a),this._isDiffUpToDate.set(!1,void 0);let d=[];l.add(e.original.onDidChangeContent(f=>{const g=ss.fromModelContentChanges(f.changes);d=wd(d,g)}));let h=[];l.add(e.modified.onDidChangeContent(f=>{const g=ss.fromModelContentChanges(f.changes);h=wd(h,g)}));let u=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(a),maxComputationTimeMs:this._options.maxComputationTimeMs.read(a),computeMoves:this._options.showMoves.read(a)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(u=jC(u,e.original,e.modified),u=(e.original,e.modified,void 0)??u,u=(e.original,e.modified,void 0)??u,ge(f=>{o(u,f),this._lastDiff=u;const g=Bc.fromDiffResult(u);this._diff.set(g,f),this._isDiffUpToDate.set(!0,f);const p=this.movedTextToCompare.get();this.movedTextToCompare.set(p?this._lastDiff.moves.find(b=>b.lineRangeMapping.modified.intersect(p.lineRangeMapping.modified)):void 0,f)}))}))}ensureModifiedLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const s=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of s)if(a.getHiddenModifiedRange(void 0).contains(e)){a.showModifiedLine(e,t,i);return}}ensureOriginalLineIsVisible(e,t,i){var r,o;if(((r=this.diff.get())==null?void 0:r.mappings.length)===0)return;const s=((o=this._unchangedRegions.get())==null?void 0:o.regions)||[];for(const a of s)if(a.getHiddenOriginalRange(void 0).contains(e)){a.showOriginalLine(e,t,i);return}}async waitForDiff(){await Rw(this.isDiffUpToDate,e=>e)}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e==null?void 0:e.regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){var s;const t=(s=e.collapsedRegions)==null?void 0:s.map(r=>A.deserialize(r.range)),i=this._unchangedRegions.get();!i||!t||ge(r=>{for(const o of i.regions)for(const a of t)if(o.modifiedUnchangedRange.intersect(a)){o.setHiddenModifiedRange(a,r);break}})}};ql=qC([zC(2,rg)],ql);function jC(n,e,t){return{changes:n.changes.map(i=>new Ve(i.original,i.modified,i.innerChanges?i.innerChanges.map(s=>GC(s,e,t)):void 0)),moves:n.moves,identical:n.identical,quitEarly:n.quitEarly}}function GC(n,e,t){let i=n.originalRange,s=n.modifiedRange;return i.startColumn===1&&s.startColumn===1&&(i.endColumn!==1||s.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&s.endColumn===t.getLineMaxColumn(s.endLineNumber)&&i.endLineNumber<e.getLineCount()&&s.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),s=s.setEndPosition(s.endLineNumber+1,1)),new We(i,s)}class Bc{static fromDiffResult(e){return new Bc(e.changes.map(t=>new ag(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,s){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=s}}class ag{constructor(e){this.lineRangeMapping=e}}class Nt{static fromDiffs(e,t,i,s,r){const o=Ve.inverse(e,t,i),a=[];for(const l of o){let c=l.original.startLineNumber,d=l.modified.startLineNumber,h=l.original.length;const u=c===1&&d===1,f=c+h===t+1&&d+h===i+1;(u||f)&&h>=r+s?(u&&!f&&(h-=r),f&&!u&&(c+=r,d+=r,h-=r),a.push(new Nt(c,d,h,0,0))):h>=r*2+s&&(c+=r,d+=r,h-=r*2,a.push(new Nt(c,d,h,0,0)))}return a}get originalUnchangedRange(){return A.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return A.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,s,r){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=F(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=F(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=T(this,l=>this.visibleLineCountTop.read(l)+this.visibleLineCountBottom.read(l)===this.lineCount&&!this.isDragged.read(l)),this.isDragged=F(this,void 0);const o=Math.max(Math.min(s,this.lineCount),0),a=Math.max(Math.min(r,this.lineCount-s),0);fd(s===o),fd(r===a),this._visibleLineCountTop.set(o,void 0),this._visibleLineCountBottom.set(a,void 0)}setVisibleRanges(e,t){const i=[],s=new Hn(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange);let r=this.originalLineNumber,o=this.modifiedLineNumber;const a=this.modifiedLineNumber+this.lineCount;if(s.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(const c of s.ranges){const d=l===s.ranges.length-1;l++;const h=(d?a:c.endLineNumberExclusive)-o,u=new Nt(r,o,h,0,0);u.setHiddenModifiedRange(c,t),i.push(u),r=u.originalUnchangedRange.endLineNumberExclusive,o=u.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return A.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return A.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,s=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,s,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){const s=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),r=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&s<r||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+s,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+r,i)}showOriginalLine(e,t,i){const s=e-this.originalLineNumber,r=this.originalLineNumber+this.lineCount-e;t===0&&s<r||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+r-s,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+s-r,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}class ZC extends D{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,s,r,o,a,l,c){super(),this._getViewZoneId=e,this._marginDomNode=t,this._modifiedEditor=i,this._diff=s,this._editor=r,this._viewLineCounts=o,this._originalTextModel=a,this._contextMenuService=l,this._clipboardService=c,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=$e.asClassName(we.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=this._modifiedEditor.getOption(67);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);let h=0;const u=i.getOption(128)&&!As,f=(g,p)=>{this._contextMenuService.showContextMenu({domForShadowRoot:u?i.getDomNode()??void 0:void 0,getAnchor:()=>({x:g,y:p}),getActions:()=>{const b=[],w=s.modified.isEmpty;return b.push(new Fi("diff.clipboard.copyDeletedContent",w?s.original.length>1?C("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):C("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):s.original.length>1?C("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):C("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{const _=this._originalTextModel.getValueInRange(s.original.toExclusiveRange());await this._clipboardService.writeText(_)})),s.original.length>1&&b.push(new Fi("diff.clipboard.copyDeletedLineContent",w?C("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",s.original.startLineNumber+h):C("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",s.original.startLineNumber+h),void 0,!0,async()=>{let _=this._originalTextModel.getLineContent(s.original.startLineNumber+h);_===""&&(_=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(_)})),i.getOption(92)||b.push(new Fi("diff.inline.revertChange",C("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),b},autoSelectFirstItem:!0})};this._register(lt(this._diffActions,"mousedown",g=>{if(!g.leftButton)return;const{top:p,height:b}=xi(this._diffActions),w=Math.floor(d/3);g.preventDefault(),f(g.posx,p+b+w)})),this._register(i.onMouseMove(g=>{(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()?(h=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,d),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(g=>{g.event.leftButton&&(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()&&(g.event.preventDefault(),h=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,d),f(g.event.posx,g.event.posy+d))}))}_updateLightBulbPosition(e,t,i){const{top:s}=xi(e),r=t-s,o=Math.floor(r/i),a=o*i;if(this._diffActions.style.top=`${a}px`,this._viewLineCounts){let l=0;for(let c=0;c<this._viewLineCounts.length;c++)if(l+=this._viewLineCounts[c],o<l)return c}return o}}const Jh=Nr("diffEditorWidget",{createHTML:n=>n});function KC(n,e,t,i){lc(i,e.fontInfo);const s=t.length>0,r=new I_(1e4);let o=0,a=0;const l=[];for(let u=0;u<n.lineTokens.length;u++){const f=u+1,g=n.lineTokens[u],p=n.lineBreakData[u],b=Sd.filter(t,f,1,Number.MAX_SAFE_INTEGER);if(p){let w=0;for(const S of p.breakOffsets){const _=g.sliceAndInflate(w,S,0);o=Math.max(o,eu(a,_,Sd.extractWrapped(b,w,S),s,n.mightContainNonBasicASCII,n.mightContainRTL,e,r)),a++,w=S}l.push(p.breakOffsets.length)}else l.push(1),o=Math.max(o,eu(a,g,b,s,n.mightContainNonBasicASCII,n.mightContainRTL,e,r)),a++}o+=e.scrollBeyondLastColumn;const c=r.build(),d=Jh?Jh.createHTML(c):c;i.innerHTML=d;const h=o*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:h,viewLineCounts:l}}class XC{constructor(e,t,i,s){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=s}}class Wc{static fromEditor(e){var r;const t=e.getOptions(),i=t.get(50),s=t.get(146);return new Wc(((r=e.getModel())==null?void 0:r.getOptions().tabSize)||0,i,t.get(33),i.typicalHalfwidthCharacterWidth,t.get(105),t.get(67),s.decorationsWidth,t.get(118),t.get(100),t.get(95),t.get(51))}constructor(e,t,i,s,r,o,a,l,c,d,h){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=s,this.scrollBeyondLastColumn=r,this.lineHeight=o,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=d,this.fontLigatures=h}}function eu(n,e,t,i,s,r,o,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(n*o.lineHeight)),a.appendString('px;width:1000000px;">');const l=e.getLineContent(),c=ct.isBasicASCII(l,s),d=ct.containsRTL(l,c,r),h=x_(new ts(o.fontInfo.isMonospace&&!o.disableMonospaceOptimizations,o.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,c,d,0,e,t,o.tabSize,0,o.fontInfo.spaceWidth,o.fontInfo.middotWidth,o.fontInfo.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==xu.OFF,null),a);return a.appendString("</div>"),h.characterMapping.getHorizontalOffset(h.characterMapping.length)}var YC=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},tu=function(n,e){return function(t,i){e(t,i,n)}};let zl=class extends D{constructor(e,t,i,s,r,o,a,l,c,d){super(),this._targetWindow=e,this._editors=t,this._diffModel=i,this._options=s,this._diffEditorWidget=r,this._canIgnoreViewZoneUpdateEvent=o,this._origViewZonesToIgnore=a,this._modViewZonesToIgnore=l,this._clipboardService=c,this._contextMenuService=d,this._originalTopPadding=F(this,0),this._originalScrollOffset=F(this,0),this._originalScrollOffsetAnimated=zh(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=F(this,0),this._modifiedScrollOffset=F(this,0),this._modifiedScrollOffsetAnimated=zh(this._targetWindow,this._modifiedScrollOffset,this._store);const h=F("invalidateAlignmentsState",0),u=this._register(new hi(()=>{h.set(h.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(_=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(_=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(_=>{(_.hasChanged(147)||_.hasChanged(67))&&u.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(_=>{(_.hasChanged(147)||_.hasChanged(67))&&u.schedule()}));const f=this._diffModel.map(_=>_?ne(this,_.model.original.onDidChangeTokens,()=>_.model.original.tokenization.backgroundTokenizationState===2):void 0).map((_,m)=>_==null?void 0:_.read(m)),g=T(_=>{const m=this._diffModel.read(_),v=m==null?void 0:m.diff.read(_);if(!m||!v)return null;h.read(_);const L=this._options.renderSideBySide.read(_);return iu(this._editors.original,this._editors.modified,v.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,L)}),p=T(_=>{var y;const m=(y=this._diffModel.read(_))==null?void 0:y.movedTextToCompare.read(_);if(!m)return null;h.read(_);const v=m.changes.map(L=>new ag(L));return iu(this._editors.original,this._editors.modified,v,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function b(){const _=document.createElement("div");return _.className="diagonal-fill",_}const w=this._register(new ie);this.viewZones=Ji(this,(_,m)=>{var _e,gt,is,qc;w.clear();const v=g.read(_)||[],y=[],L=[],k=this._modifiedTopPadding.read(_);k>0&&L.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:k,showInHiddenAreas:!0,suppressMouseDown:!0});const E=this._originalTopPadding.read(_);E>0&&y.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:E,showInHiddenAreas:!0,suppressMouseDown:!0});const W=this._options.renderSideBySide.read(_),H=W||(_e=this._editors.modified._getViewModel())==null?void 0:_e.createLineBreaksComputer();if(H){const X=this._editors.original.getModel();for(const Pe of v)if(Pe.diff)for(let tt=Pe.originalRange.startLineNumber;tt<Pe.originalRange.endLineNumberExclusive;tt++){if(tt>X.getLineCount())return{orig:y,mod:L};H==null||H.addRequest(X.getLineContent(tt),null,null)}}const B=(H==null?void 0:H.finalize())??[];let J=0;const M=this._editors.modified.getOption(67),U=(gt=this._diffModel.read(_))==null?void 0:gt.movedTextToCompare.read(_),oe=((is=this._editors.original.getModel())==null?void 0:is.mightContainNonBasicASCII())??!1,qe=((qc=this._editors.original.getModel())==null?void 0:qc.mightContainRTL())??!1,ye=Wc.fromEditor(this._editors.modified);for(const X of v)if(X.diff&&!W&&(!this._options.useTrueInlineDiffRendering.read(_)||!Hc(X.diff))){if(!X.originalRange.isEmpty){f.read(_);const tt=document.createElement("div");tt.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const en=this._editors.original.getModel();if(X.originalRange.endLineNumberExclusive-1>en.getLineCount())return{orig:y,mod:L};const mi=new XC(X.originalRange.mapToLineArray(De=>en.tokenization.getLineTokens(De)),X.originalRange.mapToLineArray(De=>B[J++]),oe,qe),pi=[];for(const De of X.diff.innerChanges||[])pi.push(new D_(De.originalRange.delta(-(X.diff.original.startLineNumber-1)),Hl.className,0));const _i=KC(mi,ye,pi,tt),tn=document.createElement("div");if(tn.className="inline-deleted-margin-view-zone",lc(tn,ye.fontInfo),this._options.renderIndicators.read(_))for(let De=0;De<_i.heightInLines;De++){const bi=document.createElement("div");bi.className=`delete-sign ${$e.asClassName(ng)}`,bi.setAttribute("style",`position:absolute;top:${De*M}px;width:${ye.lineDecorationsWidth}px;height:${M}px;right:0;`),tn.appendChild(bi)}let zc;w.add(new ZC(()=>Ip(zc),tn,this._editors.modified,X.diff,this._diffEditorWidget,_i.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let De=0;De<_i.viewLineCounts.length;De++){const bi=_i.viewLineCounts[De];bi>1&&y.push({afterLineNumber:X.originalRange.startLineNumber+De,domNode:b(),heightInPx:(bi-1)*M,showInHiddenAreas:!0,suppressMouseDown:!0})}L.push({afterLineNumber:X.modifiedRange.startLineNumber-1,domNode:tt,heightInPx:_i.heightInLines*M,minWidthInPx:_i.minWidthInPx,marginDomNode:tn,setZoneId(De){zc=De},showInHiddenAreas:!0,suppressMouseDown:!0})}const Pe=document.createElement("div");Pe.className="gutter-delete",y.push({afterLineNumber:X.originalRange.endLineNumberExclusive-1,domNode:b(),heightInPx:X.modifiedHeightInPx,marginDomNode:Pe,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const Pe=X.modifiedHeightInPx-X.originalHeightInPx;if(Pe>0){if(U!=null&&U.lineRangeMapping.original.delta(-1).deltaLength(2).contains(X.originalRange.endLineNumberExclusive-1))continue;y.push({afterLineNumber:X.originalRange.endLineNumberExclusive-1,domNode:b(),heightInPx:Pe,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let tt=function(){const mi=document.createElement("div");return mi.className="arrow-revert-change "+$e.asClassName(we.arrowRight),m.add(I(mi,"mousedown",pi=>pi.stopPropagation())),m.add(I(mi,"click",pi=>{pi.stopPropagation(),r.revert(X.diff)})),he("div",{},mi)};if(U!=null&&U.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(X.modifiedRange.endLineNumberExclusive-1))continue;let en;X.diff&&X.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(_)&&(en=tt()),L.push({afterLineNumber:X.modifiedRange.endLineNumberExclusive-1,domNode:b(),heightInPx:-Pe,marginDomNode:en,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const X of p.read(_)??[]){if(!(U!=null&&U.lineRangeMapping.original.intersect(X.originalRange))||!(U!=null&&U.lineRangeMapping.modified.intersect(X.modifiedRange)))continue;const Pe=X.modifiedHeightInPx-X.originalHeightInPx;Pe>0?y.push({afterLineNumber:X.originalRange.endLineNumberExclusive-1,domNode:b(),heightInPx:Pe,showInHiddenAreas:!0,suppressMouseDown:!0}):L.push({afterLineNumber:X.modifiedRange.endLineNumberExclusive-1,domNode:b(),heightInPx:-Pe,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:y,mod:L}});let S=!1;this._register(this._editors.original.onDidScrollChange(_=>{_.scrollLeftChanged&&!S&&(S=!0,this._editors.modified.setScrollLeft(_.scrollLeft),S=!1)})),this._register(this._editors.modified.onDidScrollChange(_=>{_.scrollLeftChanged&&!S&&(S=!0,this._editors.original.setScrollLeft(_.scrollLeft),S=!1)})),this._originalScrollTop=ne(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=ne(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register($(_=>{const m=this._originalScrollTop.read(_)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(_))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(_));m!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(m,1)})),this._register($(_=>{const m=this._modifiedScrollTop.read(_)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(_))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(_));m!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(m,1)})),this._register($(_=>{var y;const m=(y=this._diffModel.read(_))==null?void 0:y.movedTextToCompare.read(_);let v=0;if(m){const L=this._editors.original.getTopForLineNumber(m.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();v=this._editors.modified.getTopForLineNumber(m.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-L}v>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(v,void 0)):v<0?(this._modifiedTopPadding.set(-v,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-v,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+v,void 0,!0)}))}};zl=YC([tu(8,yc),tu(9,Wr)],zl);function iu(n,e,t,i,s,r){const o=new gd(nu(n,i)),a=new gd(nu(e,s)),l=n.getOption(67),c=e.getOption(67),d=[];let h=0,u=0;function f(g,p){for(;;){let b=o.peek(),w=a.peek();if(b&&b.lineNumber>=g&&(b=void 0),w&&w.lineNumber>=p&&(w=void 0),!b&&!w)break;const S=b?b.lineNumber-h:Number.MAX_VALUE,_=w?w.lineNumber-u:Number.MAX_VALUE;S<_?(o.dequeue(),w={lineNumber:b.lineNumber-h+u,heightInPx:0}):S>_?(a.dequeue(),b={lineNumber:w.lineNumber-u+h,heightInPx:0}):(o.dequeue(),a.dequeue()),d.push({originalRange:A.ofLength(b.lineNumber,1),modifiedRange:A.ofLength(w.lineNumber,1),originalHeightInPx:l+b.heightInPx,modifiedHeightInPx:c+w.heightInPx,diff:void 0})}}for(const g of t){let _=function(m,v,y=!1){var H,B;if(m<S||v<w)return;if(b)b=!1;else if(!y&&(m===S||v===w))return;const L=new A(S,m),k=new A(w,v);if(L.isEmpty&&k.isEmpty)return;const E=((H=o.takeWhile(J=>J.lineNumber<m))==null?void 0:H.reduce((J,M)=>J+M.heightInPx,0))??0,W=((B=a.takeWhile(J=>J.lineNumber<v))==null?void 0:B.reduce((J,M)=>J+M.heightInPx,0))??0;d.push({originalRange:L,modifiedRange:k,originalHeightInPx:L.length*l+E,modifiedHeightInPx:k.length*c+W,diff:g.lineRangeMapping}),S=m,w=v};const p=g.lineRangeMapping;f(p.original.startLineNumber,p.modified.startLineNumber);let b=!0,w=p.modified.startLineNumber,S=p.original.startLineNumber;if(r)for(const m of p.innerChanges||[]){m.originalRange.startColumn>1&&m.modifiedRange.startColumn>1&&_(m.originalRange.startLineNumber,m.modifiedRange.startLineNumber);const v=n.getModel(),y=m.originalRange.endLineNumber<=v.getLineCount()?v.getLineMaxColumn(m.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;m.originalRange.endColumn<y&&_(m.originalRange.endLineNumber,m.modifiedRange.endLineNumber)}_(p.original.endLineNumberExclusive,p.modified.endLineNumberExclusive,!0),h=p.original.endLineNumberExclusive,u=p.modified.endLineNumberExclusive}return f(Number.MAX_VALUE,Number.MAX_VALUE),d}function nu(n,e){const t=[],i=[],s=n.getOption(147).wrappingColumn!==-1,r=n._getViewModel().coordinatesConverter,o=n.getOption(67);if(s)for(let l=1;l<=n.getModel().getLineCount();l++){const c=r.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:o*(c-1)})}for(const l of n.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new K(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return SC(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}function Hc(n){return n.innerChanges?n.innerChanges.every(e=>su(e.modifiedRange)&&su(e.originalRange)||e.originalRange.equalsRange(new O(1,1,1,1))):!1}function su(n){return n.startLineNumber===n.endLineNumber}const An=class An extends D{constructor(e,t,i,s,r){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=s,this._editors=r,this._originalScrollTop=ne(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=ne(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=ze("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=F(this,0),this._modifiedViewZonesChangedSignal=ze("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=ze("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=Ji(this,(d,h)=>{var L;this._element.replaceChildren();const u=this._diffModel.read(d),f=(L=u==null?void 0:u.diff.read(d))==null?void 0:L.movedTexts;if(!f||f.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(d);const g=this._originalEditorLayoutInfo.read(d),p=this._modifiedEditorLayoutInfo.read(d);if(!g||!p){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(d),this._originalViewZonesChangedSignal.read(d);const b=f.map(k=>{function E(ye,_e){const gt=_e.getTopForLineNumber(ye.startLineNumber,!0),is=_e.getTopForLineNumber(ye.endLineNumberExclusive,!0);return(gt+is)/2}const W=E(k.lineRangeMapping.original,this._editors.original),H=this._originalScrollTop.read(d),B=E(k.lineRangeMapping.modified,this._editors.modified),J=this._modifiedScrollTop.read(d),M=W-H,U=B-J,oe=Math.min(W,B),qe=Math.max(W,B);return{range:new q(oe,qe),from:M,to:U,fromWithoutScroll:W,toWithoutScroll:B,move:k}});b.sort(Dp(Ot(k=>k.fromWithoutScroll>k.toWithoutScroll,Rp),Ot(k=>k.fromWithoutScroll>k.toWithoutScroll?k.fromWithoutScroll:-k.toWithoutScroll,ti)));const w=Vc.compute(b.map(k=>k.range)),S=10,_=g.verticalScrollbarWidth,m=(w.getTrackCount()-1)*10+S*2,v=_+m+(p.contentLeft-An.movedCodeBlockPadding);let y=0;for(const k of b){const E=w.getTrack(y),W=_+S+E*10,H=15,B=15,J=v,M=p.glyphMarginWidth+p.lineNumbersWidth,U=18,oe=document.createElementNS("http://www.w3.org/2000/svg","rect");oe.classList.add("arrow-rectangle"),oe.setAttribute("x",`${J-M}`),oe.setAttribute("y",`${k.to-U/2}`),oe.setAttribute("width",`${M}`),oe.setAttribute("height",`${U}`),this._element.appendChild(oe);const qe=document.createElementNS("http://www.w3.org/2000/svg","g"),ye=document.createElementNS("http://www.w3.org/2000/svg","path");ye.setAttribute("d",`M 0 ${k.from} L ${W} ${k.from} L ${W} ${k.to} L ${J-B} ${k.to}`),ye.setAttribute("fill","none"),qe.appendChild(ye);const _e=document.createElementNS("http://www.w3.org/2000/svg","polygon");_e.classList.add("arrow"),h.add($(gt=>{ye.classList.toggle("currentMove",k.move===u.activeMovedText.read(gt)),_e.classList.toggle("currentMove",k.move===u.activeMovedText.read(gt))})),_e.setAttribute("points",`${J-B},${k.to-H/2} ${J},${k.to} ${J-B},${k.to+H/2}`),qe.appendChild(_e),this._element.appendChild(qe),y++}this.width.set(m,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(le(()=>this._element.remove())),this._register($(d=>{const h=this._originalEditorLayoutInfo.read(d),u=this._modifiedEditorLayoutInfo.read(d);!h||!u||(this._element.style.left=`${h.width-h.verticalScrollbarWidth}px`,this._element.style.height=`${h.height}px`,this._element.style.width=`${h.verticalScrollbarWidth+h.contentLeft-An.movedCodeBlockPadding+this.width.read(d)}px`)})),this._register(vc(this._state));const o=T(d=>{const h=this._diffModel.read(d),u=h==null?void 0:h.diff.read(d);return u?u.movedTexts.map(f=>({move:f,original:new Ni(Cd(f.lineRangeMapping.original.startLineNumber-1),18),modified:new Ni(Cd(f.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(lr(this._editors.original,o.map(d=>d.map(h=>h.original)))),this._register(lr(this._editors.modified,o.map(d=>d.map(h=>h.modified)))),this._register(et((d,h)=>{const u=o.read(d);for(const f of u)h.add(new ru(this._editors.original,f.original,f.move,"original",this._diffModel.get())),h.add(new ru(this._editors.modified,f.modified,f.move,"modified",this._diffModel.get()))}));const a=ze("original.onDidFocusEditorWidget",d=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0))),l=ze("modified.onDidFocusEditorWidget",d=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0)));let c="modified";this._register($r({createEmptyChangeSummary:()=>{},handleChange:(d,h)=>(d.didChange(a)&&(c="original"),d.didChange(l)&&(c="modified"),!0)},d=>{a.read(d),l.read(d);const h=this._diffModel.read(d);if(!h)return;const u=h.diff.read(d);let f;if(u&&c==="original"){const g=this._editors.originalCursor.read(d);g&&(f=u.movedTexts.find(p=>p.lineRangeMapping.original.contains(g.lineNumber)))}if(u&&c==="modified"){const g=this._editors.modifiedCursor.read(d);g&&(f=u.movedTexts.find(p=>p.lineRangeMapping.modified.contains(g.lineNumber)))}f!==h.movedTextToCompare.get()&&h.movedTextToCompare.set(void 0,void 0),h.setActiveMovedText(f)}))}};An.movedCodeBlockPadding=4;let $i=An;class Vc{static compute(e){const t=[],i=[];for(const s of e){let r=t.findIndex(o=>!o.intersectsStrict(s));r===-1&&(t.length>=6?r=R_(t,Ot(a=>a.intersectWithRangeLength(s),ti)):(r=t.length,t.push(new M_))),t[r].addRange(s),i.push(r)}return new Vc(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class ru extends Ac{constructor(e,t,i,s,r){const o=P("div.diff-hidden-lines-widget");super(e,t,o.root),this._editor=e,this._move=i,this._kind=s,this._diffModel=r,this._nodes=P("div.diff-moved-code-block",{style:{marginRight:"4px"}},[P("div.text-content@textContent"),P("div.action-bar@actionBar")]),o.root.appendChild(this._nodes.root);const a=ne(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Ht(this._nodes.root,{paddingRight:a.map(u=>u.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?C("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):C("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?C("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):C("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new ni(this._nodes.actionBar,{highlightToggledItems:!0})),d=new Fi("",l,"",!1);c.push(d,{icon:!1,label:!0});const h=new Fi("","Compare",$e.asClassName(we.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register($(u=>{const f=this._diffModel.movedTextToCompare.read(u)===i;h.checked=f})),c.push(h,{icon:!1,label:!0})}}class QC extends D{constructor(e,t,i,s){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=T(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return null;const l=this._diffModel.read(r).movedTextToCompare.read(r),c=this._options.renderIndicators.read(r),d=this._options.showEmptyDecorations.read(r),h=[],u=[];if(!l)for(const g of a.mappings)if(g.lineRangeMapping.original.isEmpty||h.push({range:g.lineRangeMapping.original.toInclusiveRange(),options:c?Kh:Yh}),g.lineRangeMapping.modified.isEmpty||u.push({range:g.lineRangeMapping.modified.toInclusiveRange(),options:c?Zh:Xh}),g.lineRangeMapping.modified.isEmpty||g.lineRangeMapping.original.isEmpty)g.lineRangeMapping.original.isEmpty||h.push({range:g.lineRangeMapping.original.toInclusiveRange(),options:HC}),g.lineRangeMapping.modified.isEmpty||u.push({range:g.lineRangeMapping.modified.toInclusiveRange(),options:BC});else{const p=this._options.useTrueInlineDiffRendering.read(r)&&Hc(g.lineRangeMapping);for(const b of g.lineRangeMapping.innerChanges||[])if(g.lineRangeMapping.original.contains(b.originalRange.startLineNumber)&&h.push({range:b.originalRange,options:b.originalRange.isEmpty()&&d?VC:Hl}),g.lineRangeMapping.modified.contains(b.modifiedRange.startLineNumber)&&u.push({range:b.modifiedRange,options:b.modifiedRange.isEmpty()&&d&&!p?WC:Qh}),p){const w=o.model.original.getValueInRange(b.originalRange);u.push({range:b.modifiedRange,options:{description:"deleted-text",before:{content:w,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(l)for(const g of l.changes){const p=g.original.toInclusiveRange();p&&h.push({range:p,options:c?Kh:Yh});const b=g.modified.toInclusiveRange();b&&u.push({range:b,options:c?Zh:Xh});for(const w of g.innerChanges||[])h.push({range:w.originalRange,options:Hl}),u.push({range:w.modifiedRange,options:Qh})}const f=this._diffModel.read(r).activeMovedText.read(r);for(const g of a.movedTexts)h.push({range:g.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(g===f?" currentMove":""),blockPadding:[$i.movedCodeBlockPadding,0,$i.movedCodeBlockPadding,$i.movedCodeBlockPadding]}}),u.push({range:g.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(g===f?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:h,modifiedDecorations:u}}),this._register(ar(this._editors.original,this._decorations.map(r=>(r==null?void 0:r.originalDecorations)||[]))),this._register(ar(this._editors.modified,this._decorations.map(r=>(r==null?void 0:r.modifiedDecorations)||[])))}}class JC{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(e,t){this._options=e,this.dimensions=t,this.sashLeft=wc(this,i=>{const s=this._sashRatio.read(i)??this._options.splitViewDefaultRatio.read(i);return this._computeSashLeft(s,i)},(i,s)=>{const r=this.dimensions.width.get();this._sashRatio.set(i/r,s)}),this._sashRatio=F(this,void 0)}_computeSashLeft(e,t){const i=this.dimensions.width.read(t),s=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),r=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):s,o=100;return i<=o*2?s:r<o?o:r>i-o?i-o:r}}class lg extends D{constructor(e,t,i,s,r,o){super(),this._domNode=e,this._dimensions=t,this._enabled=i,this._boundarySashes=s,this.sashLeft=r,this._resetSash=o,this._sash=this._register(new T_(this._domNode,{getVerticalSashTop:a=>0,getVerticalSashLeft:a=>this.sashLeft.get(),getVerticalSashHeight:a=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(a=>{this.sashLeft.set(this._startSashPosition+(a.currentX-a.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register($(a=>{const l=this._boundarySashes.read(a);l&&(this._sash.orthogonalEndSash=l.bottom)})),this._register($(a=>{const l=this._enabled.read(a);this._sash.state=l?3:0,this.sashLeft.read(a),this._dimensions.height.read(a),this._sash.layout()}))}}class ey extends D{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=ne(this,this._editor.onDidScrollChange,o=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(o=>o===0),this.modelAttached=ne(this,this._editor.onDidChangeModel,o=>this._editor.hasModel()),this.editorOnDidChangeViewZones=ze("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=ze("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=bc("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const s=this._domNode.appendChild(P("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),r=new ResizeObserver(()=>{ge(o=>{this.domNodeSizeChanged.trigger(o)})});r.observe(this._domNode),this._register(le(()=>r.disconnect())),this._register($(o=>{s.className=this.isScrollTopZero.read(o)?"":"scroll-decoration"})),this._register($(o=>this.render(o)))}dispose(){super.dispose(),He(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),s=new Set(this.views.keys()),r=q.ofStartAndLength(0,this._domNode.clientHeight);if(!r.isEmpty)for(const o of i){const a=new A(o.startLineNumber,o.endLineNumber+1),l=this.itemProvider.getIntersectingGutterItems(a,e);ge(c=>{for(const d of l){if(!d.range.intersect(a))continue;s.delete(d.id);let h=this.views.get(d.id);if(h)h.item.set(d,c);else{const p=document.createElement("div");this._domNode.appendChild(p);const b=F("item",d),w=this.itemProvider.createView(b,p);h=new ty(b,w,p),this.views.set(d.id,h)}const u=d.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(d.range.startLineNumber,!0)-t:this._editor.getBottomForLineNumber(d.range.startLineNumber-1,!1)-t,g=(d.range.endLineNumberExclusive===1?Math.max(u,this._editor.getTopForLineNumber(d.range.startLineNumber,!1)-t):Math.max(u,this._editor.getBottomForLineNumber(d.range.endLineNumberExclusive-1,!0)-t))-u;h.domNode.style.top=`${u}px`,h.domNode.style.height=`${g}px`,h.gutterItemView.layout(q.ofStartAndLength(u,g),r)}})}for(const o of s){const a=this.views.get(o);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(o)}}}class ty{constructor(e,t,i){this.item=e,this.gutterItemView=t,this.domNode=i}}class cg extends zu{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}class ou extends vf{constructor(e){super(),this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}get length(){const e=this._textModel.getLineCount(),t=this._textModel.getLineLength(e);return new Wn(e-1,t)}}var dg=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ks=function(n,e){return function(t,i){e(t,i,n)}};const mo=[],_s=35;let jl=class extends D{constructor(e,t,i,s,r,o,a,l,c){super(),this._diffModel=t,this._editors=i,this._options=s,this._sashLayout=r,this._boundarySashes=o,this._instantiationService=a,this._contextKeyService=l,this._menuService=c,this._menu=this._register(this._menuService.createMenu(ii.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=ne(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(d=>d.length>0),this._showSash=T(this,d=>this._options.renderSideBySide.read(d)&&this._hasActions.read(d)),this.width=T(this,d=>this._hasActions.read(d)?_s:0),this.elements=P("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:_s+"px"}},[]),this._currentDiff=T(this,d=>{var g;const h=this._diffModel.read(d);if(!h)return;const u=(g=h.diff.read(d))==null?void 0:g.mappings,f=this._editors.modifiedCursor.read(d);if(f)return u==null?void 0:u.find(p=>p.lineRangeMapping.modified.contains(f.lineNumber))}),this._selectedDiffs=T(this,d=>{const h=this._diffModel.read(d),u=h==null?void 0:h.diff.read(d);if(!u)return mo;const f=this._editors.modifiedSelections.read(d);if(f.every(w=>w.isEmpty()))return mo;const g=new Hn(f.map(w=>A.fromRangeInclusive(w))),b=u.mappings.filter(w=>w.lineRangeMapping.innerChanges&&g.intersects(w.lineRangeMapping.modified)).map(w=>({mapping:w,rangeMappings:w.lineRangeMapping.innerChanges.filter(S=>f.some(_=>O.areIntersecting(S.modifiedRange,_)))}));return b.length===0||b.every(w=>w.rangeMappings.length===0)?mo:b}),this._register(CC(e,this.elements.root)),this._register(I(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Ht(this.elements.root,{display:this._hasActions.map(d=>d?"block":"none")})),nt(this,d=>this._showSash.read(d)?new lg(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,wc(this,u=>this._sashLayout.sashLeft.read(u)-_s,(u,f)=>this._sashLayout.sashLeft.set(u+_s,f)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store),this._register(new ey(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(d,h)=>{const u=this._diffModel.read(h);if(!u)return[];const f=u.diff.read(h);if(!f)return[];const g=this._selectedDiffs.read(h);if(g.length>0){const b=Ve.fromRangeMappings(g.flatMap(w=>w.rangeMappings));return[new au(b,!0,ii.DiffEditorSelectionToolbar,void 0,u.model.original.uri,u.model.modified.uri)]}const p=this._currentDiff.read(h);return f.mappings.map(b=>new au(b.lineRangeMapping.withInnerChangesFromLineRanges(),b.lineRangeMapping===(p==null?void 0:p.lineRangeMapping),ii.DiffEditorHunkToolbar,void 0,u.model.original.uri,u.model.modified.uri))},createView:(d,h)=>this._instantiationService.createInstance(Gl,d,h,this)})),this._register(I(this.elements.gutter,N.MOUSE_WHEEL,d=>{this._editors.modified.getOption(104).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(d)},{passive:!1}))}computeStagedValue(e){const t=e.innerChanges??[],i=new ou(this._editors.modifiedModel.get()),s=new ou(this._editors.original.getModel());return new Vb(t.map(a=>a.toTextEdit(i))).apply(s)}layout(e){this.elements.gutter.style.left=e+"px"}};jl=dg([ks(6,re),ks(7,me),ks(8,Br)],jl);class au{constructor(e,t,i,s,r,o){this.mapping=e,this.showAlways=t,this.menuId=i,this.rangeOverride=s,this.originalUri=r,this.modifiedUri=o}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let Gl=class extends D{constructor(e,t,i,s){super(),this._item=e,this._elements=P("div.gutterItem",{style:{height:"20px",width:"34px"}},[P("div.background@background",{},[]),P("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,o=>o.showAlways),this._menuId=this._item.map(this,o=>o.menuId),this._isSmall=F(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const r=this._register(s.createInstance(Sc,"element",!0,{position:{hoverPosition:1}}));this._register(bn(t,this._elements.root)),this._register($(o=>{const a=this._showAlways.read(o);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",a),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(et((o,a)=>{this._elements.buttons.replaceChildren();const l=a.add(s.createInstance(gf,this._elements.buttons,this._menuId.read(o),{orientation:1,hoverDelegate:r,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(o)?1:3},hiddenItemStrategy:0,actionRunner:new cg(()=>{const c=this._item.get(),d=c.mapping;return{mapping:d,originalWithModifiedChanges:i.computeStagedValue(d),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));a.add(l.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(e,t){this._lastItemRange=e,this._lastViewRange=t;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),i=this._elements.buttons.clientHeight;const s=e.length/2-i/2,r=i;let o=e.start+s;const a=q.tryCreate(r,t.endExclusive-r-i),l=q.tryCreate(e.start+r,e.endExclusive-i-r);l&&a&&l.start<l.endExclusive&&(o=a.clip(o),o=l.clip(o)),this._elements.buttons.style.top=`${o-e.start}px`}};Gl=dg([ks(3,re)],Gl);function Gn(n){return Zl.get(n)}const xt=class xt extends D{static get(e){let t=xt._map.get(e);if(!t){t=new xt(e),xt._map.set(e,t);const i=e.onDidDispose(()=>{const s=xt._map.get(e);s&&(xt._map.delete(e),s.dispose(),i.dispose())})}return t}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new lf(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}constructor(e){var t;super(),this.editor=e,this._updateCounter=0,this._currentTransaction=void 0,this._model=F(this,this.editor.getModel()),this.model=this._model,this.isReadonly=ne(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(92)),this._versionId=ja({owner:this,lazy:!0},((t=this.editor.getModel())==null?void 0:t.getVersionId())??null),this.versionId=this._versionId,this._selections=ja({owner:this,equalsFn:yd(N_(Fs.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.isFocused=ne(this,i=>{const s=this.editor.onDidFocusEditorWidget(i),r=this.editor.onDidBlurEditorWidget(i);return{dispose(){s.dispose(),r.dispose()}}},()=>this.editor.hasWidgetFocus()),this.value=wc(this,i=>{var s;return this.versionId.read(i),((s=this.model.read(i))==null?void 0:s.getValue())??""},(i,s)=>{const r=this.model.get();r!==null&&i!==r.getValue()&&r.setValue(i)}),this.valueIsEmpty=T(this,i=>{var s;return this.versionId.read(i),((s=this.editor.getModel())==null?void 0:s.getValueLength())===0}),this.cursorSelection=hf({owner:this,equalsFn:yd(Fs.selectionsEqual)},i=>{var s;return((s=this.selections.read(i))==null?void 0:s[0])??null}),this.onDidType=bc(this),this.scrollTop=ne(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=ne(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=ne(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(i=>i.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(i=>i.decorationsLeft),this.contentWidth=ne(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this._overlayWidgetCounter=0,this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{var s;this._beginUpdate();try{this._versionId.set(((s=this.editor.getModel())==null?void 0:s.getVersionId())??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}}))}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){var e;this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(((e=this.editor.getModel())==null?void 0:e.getVersionId())??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(e){return ne(this,t=>this.editor.onDidChangeConfiguration(i=>{i.hasChanged(e)&&t(void 0)}),()=>this.editor.getOption(e))}setDecorations(e){const t=new ie,i=this.editor.createDecorationsCollection();return t.add(_c({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},s=>{const r=e.read(s);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}createOverlayWidget(e){const t="observableOverlayWidget"+this._overlayWidgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);const s=$(r=>{e.position.read(r),e.minContentWidthInPx.read(r),this.editor.layoutOverlayWidget(i)});return le(()=>{s.dispose(),this.editor.removeOverlayWidget(i)})}};xt._map=new Map;let Zl=xt;var iy=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ny=function(n,e){return function(t,i){e(t,i,n)}},Es,ci;let Kl=(ci=class extends D{static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(e,t,i,s){super(),this._editors=e,this._diffModel=t,this._options=i,this._instantiationService=s,this._modifiedOutlineSource=nt(this,l=>{const c=this._editors.modifiedModel.read(l),d=Es._breadcrumbsSourceFactory.read(l);return!c||!d?void 0:d(c,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();ge(d=>{for(const h of this._editors.original.getSelections()||[])c==null||c.ensureOriginalLineIsVisible(h.getStartPosition().lineNumber,0,d),c==null||c.ensureOriginalLineIsVisible(h.getEndPosition().lineNumber,0,d)})})),this._register(this._editors.modified.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();ge(d=>{for(const h of this._editors.modified.getSelections()||[])c==null||c.ensureModifiedLineIsVisible(h.getStartPosition().lineNumber,0,d),c==null||c.ensureModifiedLineIsVisible(h.getEndPosition().lineNumber,0,d)})}));const r=this._diffModel.map((l,c)=>{var h;const d=(l==null?void 0:l.unchangedRegions.read(c))??[];return d.length===1&&d[0].modifiedLineNumber===1&&d[0].lineCount===((h=this._editors.modifiedModel.read(c))==null?void 0:h.getLineCount())?[]:d});this.viewZones=Ji(this,(l,c)=>{const d=this._modifiedOutlineSource.read(l);if(!d)return{origViewZones:[],modViewZones:[]};const h=[],u=[],f=this._options.renderSideBySide.read(l),g=this._options.compactMode.read(l),p=r.read(l);for(let b=0;b<p.length;b++){const w=p[b];if(!w.shouldHideControls(l)&&!(g&&(b===0||b===p.length-1)))if(g){{const S=T(this,m=>w.getHiddenOriginalRange(m).startLineNumber-1),_=new Ni(S,12);h.push(_),c.add(new lu(this._editors.original,_,w,!f))}{const S=T(this,m=>w.getHiddenModifiedRange(m).startLineNumber-1),_=new Ni(S,12);u.push(_),c.add(new lu(this._editors.modified,_,w))}}else{{const S=T(this,m=>w.getHiddenOriginalRange(m).startLineNumber-1),_=new Ni(S,24);h.push(_),c.add(new cu(this._editors.original,_,w,w.originalUnchangedRange,!f,d,m=>this._diffModel.get().ensureModifiedLineIsVisible(m,2,void 0),this._options))}{const S=T(this,m=>w.getHiddenModifiedRange(m).startLineNumber-1),_=new Ni(S,24);u.push(_),c.add(new cu(this._editors.modified,_,w,w.modifiedUnchangedRange,!1,d,m=>this._diffModel.get().ensureModifiedLineIsVisible(m,2,void 0),this._options))}}}return{origViewZones:h,modViewZones:u}});const o={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new im(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(C("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+$e.asClassName(we.fold),zIndex:10001};this._register(ar(this._editors.original,T(this,l=>{const c=r.read(l),d=c.map(h=>({range:h.originalUnchangedRange.toInclusiveRange(),options:o}));for(const h of c)h.shouldHideControls(l)&&d.push({range:O.fromPositions(new K(h.originalLineNumber,1)),options:a});return d}))),this._register(ar(this._editors.modified,T(this,l=>{const c=r.read(l),d=c.map(h=>({range:h.modifiedUnchangedRange.toInclusiveRange(),options:o}));for(const h of c)h.shouldHideControls(l)&&d.push({range:A.ofLength(h.modifiedLineNumber,1).toInclusiveRange(),options:a});return d}))),this._register($(l=>{const c=r.read(l);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(d=>d.getHiddenOriginalRange(l).toInclusiveRange()).filter(Ps)),this._editors.modified.setHiddenAreas(c.map(d=>d.getHiddenModifiedRange(l).toInclusiveRange()).filter(Ps))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const d=l.target.position.lineNumber,h=this._diffModel.get();if(!h)return;const u=h.unchangedRegions.get().find(f=>f.modifiedUnchangedRange.includes(d));if(!u)return;u.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const d=l.target.position.lineNumber,h=this._diffModel.get();if(!h)return;const u=h.unchangedRegions.get().find(f=>f.originalUnchangedRange.includes(d));if(!u)return;u.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}}))}},Es=ci,ci._breadcrumbsSourceFactory=F(Es,()=>({dispose(){},getBreadcrumbItems(e,t){return[]}})),ci);Kl=Es=iy([ny(3,re)],Kl);class lu extends Ac{constructor(e,t,i,s=!1){const r=P("div.diff-hidden-lines-widget");super(e,t,r.root),this._unchangedRegion=i,this._hide=s,this._nodes=P("div.diff-hidden-lines-compact",[P("div.line-left",[]),P("div.text@text",[]),P("div.line-right",[])]),r.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register($(o=>{if(!this._hide){const a=this._unchangedRegion.getHiddenModifiedRange(o).length,l=C("hiddenLines","{0} hidden lines",a);this._nodes.text.innerText=l}}))}}class cu extends Ac{constructor(e,t,i,s,r,o,a,l){const c=P("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=s,this._hide=r,this._modifiedOutlineSource=o,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=P("div.diff-hidden-lines",[P("div.top@top",{title:C("diff.hiddenLines.top","Click or drag to show more above")}),P("div.center@content",{style:{display:"flex"}},[P("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[he("a",{title:C("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...oc("$(unfold)"))]),P("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),P("div.bottom@bottom",{title:C("diff.bottom","Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root),this._hide?He(this._nodes.first):this._register(Ht(this._nodes.first,{width:Gn(this._editor).layoutInfoContentLeft})),this._register($(h=>{const u=this._unchangedRegion.visibleLineCountTop.read(h)+this._unchangedRegion.visibleLineCountBottom.read(h)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!u),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),this._nodes.top.classList.toggle("canMoveBottom",!u);const f=this._unchangedRegion.isDragged.read(h),g=this._editor.getDomNode();g&&(g.classList.toggle("draggingUnchangedRegion",!!f),f==="top"?(g.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),g.classList.toggle("canMoveBottom",!u)):f==="bottom"?(g.classList.toggle("canMoveTop",!u),g.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0)):(g.classList.toggle("canMoveTop",!1),g.classList.toggle("canMoveBottom",!1)))}));const d=this._editor;this._register(I(this._nodes.top,"mousedown",h=>{if(h.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let f=!1;const g=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const p=ae(this._nodes.top),b=I(p,"mousemove",S=>{const m=S.clientY-u;f=f||Math.abs(m)>2;const v=Math.round(m/d.getOption(67)),y=Math.max(0,Math.min(g+v,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(y,void 0)}),w=I(p,"mouseup",S=>{f||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),b.dispose(),w.dispose()})})),this._register(I(this._nodes.bottom,"mousedown",h=>{if(h.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let f=!1;const g=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const p=ae(this._nodes.bottom),b=I(p,"mousemove",S=>{const m=S.clientY-u;f=f||Math.abs(m)>2;const v=Math.round(m/d.getOption(67)),y=Math.max(0,Math.min(g-v,this._unchangedRegion.getMaxVisibleLineCountBottom())),L=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(y,void 0);const k=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(k-L))}),w=I(p,"mouseup",S=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!f){const _=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const m=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(m-_))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),b.dispose(),w.dispose()})})),this._register($(h=>{const u=[];if(!this._hide){const f=i.getHiddenModifiedRange(h).length,g=C("hiddenLines","{0} hidden lines",f),p=he("span",{title:C("diff.hiddenLines.expandAll","Double click to unfold")},g);p.addEventListener("dblclick",S=>{S.button===0&&(S.preventDefault(),this._unchangedRegion.showAll(void 0))}),u.push(p);const b=this._unchangedRegion.getHiddenModifiedRange(h),w=this._modifiedOutlineSource.getBreadcrumbItems(b,h);if(w.length>0){u.push(he("span",void 0,"  |  "));for(let S=0;S<w.length;S++){const _=w[S],m=nm.toIcon(_.kind),v=P("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[Co(m)," ",_.name,...S===w.length-1?[]:[Co(we.chevronRight)]]).root;u.push(v),v.onclick=()=>{this._revealModifiedHiddenLine(_.startLineNumber)}}}}He(this._nodes.others,...u)}))}}var sy=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ry=function(n,e){return function(t,i){e(t,i,n)}},Qe,vt;let Zn=(vt=class extends D{constructor(e,t,i,s,r,o,a){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=s,this._rootHeight=r,this._modifiedEditorLayoutInfo=o,this._themeService=a,this.width=Qe.ENTIRE_DIFF_OVERVIEW_WIDTH;const l=ne(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=T(u=>{const f=l.read(u),g=f.getColor(rm)||(f.getColor(om)||am).transparent(2),p=f.getColor(lm)||(f.getColor(cm)||dm).transparent(2);return{insertColor:g,removeColor:p}}),d=sm(document.createElement("div"));d.setClassName("diffViewport"),d.setPosition("absolute");const h=P("div.diffOverview",{style:{position:"absolute",top:"0px",width:Qe.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(bn(h,d.domNode)),this._register(lt(h,N.POINTER_DOWN,u=>{this._editors.modified.delegateVerticalScrollbarPointerDown(u)})),this._register(I(h,N.MOUSE_WHEEL,u=>{this._editors.modified.delegateScrollFromMouseWheelEvent(u)},{passive:!1})),this._register(bn(this._rootElement,h)),this._register(et((u,f)=>{const g=this._diffModel.read(u),p=this._editors.original.createOverviewRuler("original diffOverviewRuler");p&&(f.add(p),f.add(bn(h,p.getDomNode())));const b=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(b&&(f.add(b),f.add(bn(h,b.getDomNode()))),!p||!b)return;const w=ze("viewZoneChanged",this._editors.original.onDidChangeViewZones),S=ze("viewZoneChanged",this._editors.modified.onDidChangeViewZones),_=ze("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),m=ze("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);f.add($(v=>{var H;w.read(v),S.read(v),_.read(v),m.read(v);const y=c.read(v),L=(H=g==null?void 0:g.diff.read(v))==null?void 0:H.mappings;function k(B,J,M){const U=M._getViewModel();return U?B.filter(oe=>oe.length>0).map(oe=>{const qe=U.coordinatesConverter.convertModelPositionToViewPosition(new K(oe.startLineNumber,1)),ye=U.coordinatesConverter.convertModelPositionToViewPosition(new K(oe.endLineNumberExclusive,1)),_e=ye.lineNumber-qe.lineNumber;return new A_(qe.lineNumber,ye.lineNumber,_e,J.toString())}):[]}const E=k((L||[]).map(B=>B.lineRangeMapping.original),y.removeColor,this._editors.original),W=k((L||[]).map(B=>B.lineRangeMapping.modified),y.insertColor,this._editors.modified);p==null||p.setZones(E),b==null||b.setZones(W)})),f.add($(v=>{const y=this._rootHeight.read(v),L=this._rootWidth.read(v),k=this._modifiedEditorLayoutInfo.read(v);if(k){const E=Qe.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Qe.ONE_OVERVIEW_WIDTH;p.setLayout({top:0,height:y,right:E+Qe.ONE_OVERVIEW_WIDTH,width:Qe.ONE_OVERVIEW_WIDTH}),b.setLayout({top:0,height:y,right:0,width:Qe.ONE_OVERVIEW_WIDTH});const W=this._editors.modifiedScrollTop.read(v),H=this._editors.modifiedScrollHeight.read(v),B=this._editors.modified.getOption(104),J=new hm(B.verticalHasArrows?B.arrowSize:0,B.verticalScrollbarSize,0,k.height,H,W);d.setTop(J.getSliderPosition()),d.setHeight(J.getSliderSize())}else d.setTop(0),d.setHeight(0);h.style.height=y+"px",h.style.left=L-Qe.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",d.setWidth(Qe.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}},Qe=vt,vt.ONE_OVERVIEW_WIDTH=15,vt.ENTIRE_DIFF_OVERVIEW_WIDTH=vt.ONE_OVERVIEW_WIDTH*2,vt);Zn=Qe=sy([ry(6,yt)],Zn);const po=[];class oy extends D{constructor(e,t,i,s){super(),this._editors=e,this._diffModel=t,this._options=i,this._widget=s,this._selectedDiffs=T(this,r=>{const o=this._diffModel.read(r),a=o==null?void 0:o.diff.read(r);if(!a)return po;const l=this._editors.modifiedSelections.read(r);if(l.every(u=>u.isEmpty()))return po;const c=new Hn(l.map(u=>A.fromRangeInclusive(u))),h=a.mappings.filter(u=>u.lineRangeMapping.innerChanges&&c.intersects(u.lineRangeMapping.modified)).map(u=>({mapping:u,rangeMappings:u.lineRangeMapping.innerChanges.filter(f=>l.some(g=>O.areIntersecting(f.modifiedRange,g)))}));return h.length===0||h.every(u=>u.rangeMappings.length===0)?po:h}),this._register(et((r,o)=>{if(!this._options.shouldRenderOldRevertArrows.read(r))return;const a=this._diffModel.read(r),l=a==null?void 0:a.diff.read(r);if(!a||!l||a.movedTextToCompare.read(r))return;const c=[],d=this._selectedDiffs.read(r),h=new Set(d.map(u=>u.mapping));if(d.length>0){const u=this._editors.modifiedSelections.read(r),f=o.add(new dr(u[u.length-1].positionLineNumber,this._widget,d.flatMap(g=>g.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}for(const u of l.mappings)if(!h.has(u)&&!u.lineRangeMapping.modified.isEmpty&&u.lineRangeMapping.innerChanges){const f=o.add(new dr(u.lineRangeMapping.modified.startLineNumber,this._widget,u.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}o.add(le(()=>{for(const u of c)this._editors.modified.removeGlyphMarginWidget(u)}))}))}}const Mr=class Mr extends D{getId(){return this._id}constructor(e,t,i,s){super(),this._lineNumber=e,this._widget=t,this._diffs=i,this._revertSelection=s,this._id=`revertButton${Mr.counter++}`,this._domNode=P("div.revertButton",{title:this._revertSelection?C("revertSelectedChanges","Revert Selected Changes"):C("revertChange","Revert Change")},[Co(we.arrowRight)]).root,this._register(I(this._domNode,N.MOUSE_DOWN,r=>{r.button!==2&&(r.stopPropagation(),r.preventDefault())})),this._register(I(this._domNode,N.MOUSE_UP,r=>{r.stopPropagation(),r.preventDefault()})),this._register(I(this._domNode,N.CLICK,r=>{this._diffs instanceof ve?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),r.stopPropagation(),r.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:O_.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};Mr.counter=0;let dr=Mr;function mt(n,e,t){const i=n.bindTo(e);return _c({debugName:()=>`Set Context Key "${n.key}"`},s=>{i.set(t(s))})}var ay=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},du=function(n,e){return function(t,i){e(t,i,n)}};let Xl=class extends D{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(e,t,i,s,r,o,a){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._argCodeEditorWidgetOptions=s,this._createInnerEditor=r,this._instantiationService=o,this._keybindingService=a,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new R),this.modifiedScrollTop=ne(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=ne(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=Gn(this.modified),this.originalObs=Gn(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=ne(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=hf({owner:this,equalsFn:K.equals},l=>{var c;return((c=this.modifiedSelections.read(l)[0])==null?void 0:c.getPosition())??new K(1,1)}),this.originalCursor=ne(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new K(1,1)),this._argCodeEditorWidgetOptions=null,this._register($r({createEmptyChangeSummary:()=>({}),handleChange:(l,c)=>(l.didChange(i.editorOptions)&&Object.assign(c,l.change.changedOptions),!0)},(l,c)=>{i.editorOptions.read(l),this._options.renderSideBySide.read(l),this.modified.updateOptions(this._adjustOptionsForRightHandSide(l,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(l,c))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),s=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return s.setContextValue("isInDiffLeftEditor",!0),s}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),s=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return s.setContextValue("isInDiffRightEditor",!0),s}_constructInnerEditor(e,t,i,s){const r=this._createInnerEditor(e,t,i,s);return this._register(r.onDidContentSizeChange(o=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+Zn.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:o.contentHeightChanged,contentWidthChanged:o.contentWidthChanged})})),r}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Xi.revealHorizontalRightPadding.defaultValue+Zn.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t={...e,dimension:{height:0,width:0}};return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar={...t.scrollbar||{}},t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap={...t.minimap||{}},t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var i;e||(e="");const t=C("diff-aria-navigation-tip"," use {0} to open the accessibility help.",(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))==null?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};Xl=ay([du(5,re),du(6,ht)],Xl);const Tr=class Tr extends D{constructor(){super(...arguments),this._id=++Tr.idCounter,this._onDidDispose=this._register(new R),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,s=!0){this._targetEditor.revealRange(e,t,i,s)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};Tr.idCounter=0;let Yl=Tr;var ly=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},cy=function(n,e){return function(t,i){e(t,i,n)}};let Ql=class{get editorOptions(){return this._options}constructor(e,t){this._accessibilityService=t,this._diffEditorWidth=F(this,0),this._screenReaderMode=ne(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=T(this,s=>this._options.read(s).renderSideBySide&&this._diffEditorWidth.read(s)<=this._options.read(s).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=T(this,s=>this._options.read(s).renderOverviewRuler),this.renderSideBySide=T(this,s=>this.compactMode.read(s)&&this.shouldRenderInlineViewInSmartMode.read(s)?!1:this._options.read(s).renderSideBySide&&!(this._options.read(s).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(s)&&!this._screenReaderMode.read(s))),this.readOnly=T(this,s=>this._options.read(s).readOnly),this.shouldRenderOldRevertArrows=T(this,s=>!(!this._options.read(s).renderMarginRevertIcon||!this.renderSideBySide.read(s)||this.readOnly.read(s)||this.shouldRenderGutterMenu.read(s))),this.shouldRenderGutterMenu=T(this,s=>this._options.read(s).renderGutterMenu),this.renderIndicators=T(this,s=>this._options.read(s).renderIndicators),this.enableSplitViewResizing=T(this,s=>this._options.read(s).enableSplitViewResizing),this.splitViewDefaultRatio=T(this,s=>this._options.read(s).splitViewDefaultRatio),this.ignoreTrimWhitespace=T(this,s=>this._options.read(s).ignoreTrimWhitespace),this.maxComputationTimeMs=T(this,s=>this._options.read(s).maxComputationTime),this.showMoves=T(this,s=>this._options.read(s).experimental.showMoves&&this.renderSideBySide.read(s)),this.isInEmbeddedEditor=T(this,s=>this._options.read(s).isInEmbeddedEditor),this.diffWordWrap=T(this,s=>this._options.read(s).diffWordWrap),this.originalEditable=T(this,s=>this._options.read(s).originalEditable),this.diffCodeLens=T(this,s=>this._options.read(s).diffCodeLens),this.accessibilityVerbose=T(this,s=>this._options.read(s).accessibilityVerbose),this.diffAlgorithm=T(this,s=>this._options.read(s).diffAlgorithm),this.showEmptyDecorations=T(this,s=>this._options.read(s).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=T(this,s=>this._options.read(s).onlyShowAccessibleDiffViewer),this.compactMode=T(this,s=>this._options.read(s).compactMode),this.trueInlineDiffRenderingEnabled=T(this,s=>this._options.read(s).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=T(this,s=>!this.renderSideBySide.read(s)&&this.trueInlineDiffRenderingEnabled.read(s)),this.hideUnchangedRegions=T(this,s=>this._options.read(s).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=T(this,s=>this._options.read(s).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=T(this,s=>this._options.read(s).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=T(this,s=>this._options.read(s).hideUnchangedRegions.minimumLineCount),this._model=F(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,s=>P_(this,r=>{const o=s==null?void 0:s.diff.read(r);return o?dy(o,this.trueInlineDiffRenderingEnabled.read(r)):void 0})).flatten().map(this,s=>!!s),this.inlineViewHideOriginalLineNumbers=this.compactMode;const i={...e,...hu(e,ue)};this._options=F(this,i)}updateOptions(e){const t=hu(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}setModel(e){this._model.set(e,void 0)}};Ql=ly([cy(1,fi)],Ql);function dy(n,e){return n.mappings.every(t=>hy(t.lineRangeMapping)||uy(t.lineRangeMapping)||e&&Hc(t.lineRangeMapping))}function hy(n){return n.original.length===0}function uy(n){return n.modified.length===0}function hu(n,e){var t,i,s,r,o,a,l,c;return{enableSplitViewResizing:be(n.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:um(n.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:be(n.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:be(n.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:wi(n.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:wi(n.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:be(n.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:be(n.renderIndicators,e.renderIndicators),originalEditable:be(n.originalEditable,e.originalEditable),diffCodeLens:be(n.diffCodeLens,e.diffCodeLens),renderOverviewRuler:be(n.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:ed(n.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:ed(n.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:be(n.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:be((t=n.experimental)==null?void 0:t.showMoves,e.experimental.showMoves),showEmptyDecorations:be((i=n.experimental)==null?void 0:i.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:be((s=n.experimental)==null?void 0:s.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:be(((r=n.hideUnchangedRegions)==null?void 0:r.enabled)??((o=n.experimental)==null?void 0:o.collapseUnchangedRegions),e.hideUnchangedRegions.enabled),contextLineCount:wi((a=n.hideUnchangedRegions)==null?void 0:a.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:wi((l=n.hideUnchangedRegions)==null?void 0:l.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:wi((c=n.hideUnchangedRegions)==null?void 0:c.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:be(n.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:be(n.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:wi(n.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:be(n.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:be(n.renderGutterMenu,e.renderGutterMenu),compactMode:be(n.compactMode,e.compactMode)}}var fy=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},fn=function(n,e){return function(t,i){e(t,i,n)}};let hr=class extends Yl{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(e,t,i,s,r,o,a,l){super(),this._domElement=e,this._parentContextKeyService=s,this._parentInstantiationService=r,this._accessibilitySignalService=a,this._editorProgressService=l,this.elements=P("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[P("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),P("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),P("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register(uf(this,void 0)),this._diffModel=T(this,m=>{var v;return(v=this._diffModelSrc.read(m))==null?void 0:v.object}),this.onDidChangeModel=ee.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new es([me,this._contextKeyService]))),this._boundarySashes=F(this,void 0),this._accessibleDiffViewerShouldBeVisible=F(this,!1),this._accessibleDiffViewerVisible=T(this,m=>this._options.onlyShowAccessibleDiffViewer.read(m)?!0:this._accessibleDiffViewerShouldBeVisible.read(m)),this._movedBlocksLinesPart=F(this,void 0),this._layoutInfo=T(this,m=>{var qe,ye;const v=this._rootSizeObserver.width.read(m),y=this._rootSizeObserver.height.read(m);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=y+"px";const L=this._sash.read(m),k=this._gutter.read(m),E=(k==null?void 0:k.width.read(m))??0,W=((qe=this._overviewRulerPart.read(m))==null?void 0:qe.width)??0;let H,B,J,M,U;if(!!L){const _e=L.sashLeft.read(m),gt=((ye=this._movedBlocksLinesPart.read(m))==null?void 0:ye.width.read(m))??0;H=0,B=_e-E-gt,U=_e-E,J=_e,M=v-J-W}else{U=0;const _e=this._options.inlineViewHideOriginalLineNumbers.read(m);H=E,_e?B=0:B=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(m)),J=E+B,M=v-J-W}return this.elements.original.style.left=H+"px",this.elements.original.style.width=B+"px",this._editors.original.layout({width:B,height:y},!0),k==null||k.layout(U),this.elements.modified.style.left=J+"px",this.elements.modified.style.width=M+"px",this._editors.modified.layout({width:M,height:y},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((m,v)=>m==null?void 0:m.diff.read(v)),this.onDidUpdateDiff=ee.fromObservableLight(this._diffValue),o.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(le(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new ig(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(t.automaticLayout??!1),this._options=this._instantiationService.createInstance(Ql,t),this._register($(m=>{this._options.setWidth(this._rootSizeObserver.width.read(m))})),this._contextKeyService.createKey(Ge.isEmbeddedDiffEditor.key,!1),this._register(mt(Ge.isEmbeddedDiffEditor,this._contextKeyService,m=>this._options.isInEmbeddedEditor.read(m))),this._register(mt(Ge.comparingMovedCode,this._contextKeyService,m=>{var v;return!!((v=this._diffModel.read(m))!=null&&v.movedTextToCompare.read(m))})),this._register(mt(Ge.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,m=>this._options.couldShowInlineViewBecauseOfSize.read(m))),this._register(mt(Ge.diffEditorInlineMode,this._contextKeyService,m=>!this._options.renderSideBySide.read(m))),this._register(mt(Ge.hasChanges,this._contextKeyService,m=>{var v,y;return(((y=(v=this._diffModel.read(m))==null?void 0:v.diff.read(m))==null?void 0:y.mappings.length)??0)>0})),this._editors=this._register(this._instantiationService.createInstance(Xl,this.elements.original,this.elements.modified,this._options,i,(m,v,y,L)=>this._createInnerEditor(m,v,y,L))),this._register(mt(Ge.diffEditorOriginalWritable,this._contextKeyService,m=>this._options.originalEditable.read(m))),this._register(mt(Ge.diffEditorModifiedWritable,this._contextKeyService,m=>!this._options.readOnly.read(m))),this._register(mt(Ge.diffEditorOriginalUri,this._contextKeyService,m=>{var v;return((v=this._diffModel.read(m))==null?void 0:v.model.original.uri.toString())??""})),this._register(mt(Ge.diffEditorModifiedUri,this._contextKeyService,m=>{var v;return((v=this._diffModel.read(m))==null?void 0:v.model.modified.uri.toString())??""})),this._overviewRulerPart=nt(this,m=>this._options.renderOverviewRuler.read(m)?this._instantiationService.createInstance(Ze(Zn,m),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(v=>v.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((m,v)=>{var y;return m-(((y=this._overviewRulerPart.read(v))==null?void 0:y.width)??0)})};this._sashLayout=new JC(this._options,c),this._sash=nt(this,m=>{const v=this._options.renderSideBySide.read(m);return this.elements.root.classList.toggle("side-by-side",v),v?new lg(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const d=nt(this,m=>this._instantiationService.createInstance(Ze(Kl,m),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);nt(this,m=>this._instantiationService.createInstance(Ze(QC,m),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const h=new Set,u=new Set;let f=!1;const g=nt(this,m=>this._instantiationService.createInstance(Ze(zl,m),ae(this._domElement),this._editors,this._diffModel,this._options,this,()=>f||d.get().isUpdatingHiddenAreas,h,u)).recomputeInitiallyAndOnChange(this._store),p=T(this,m=>{const v=g.read(m).viewZones.read(m).orig,y=d.read(m).viewZones.read(m).origViewZones;return v.concat(y)}),b=T(this,m=>{const v=g.read(m).viewZones.read(m).mod,y=d.read(m).viewZones.read(m).modViewZones;return v.concat(y)});this._register(lr(this._editors.original,p,m=>{f=m},h));let w;this._register(lr(this._editors.modified,b,m=>{f=m,f?w=Op.capture(this._editors.modified):(w==null||w.restore(this._editors.modified),w=void 0)},u)),this._accessibleDiffViewer=nt(this,m=>this._instantiationService.createInstance(Ze(ei,m),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(v,y)=>this._accessibleDiffViewerShouldBeVisible.set(v,y),this._options.onlyShowAccessibleDiffViewer.map(v=>!v),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((v,y)=>{var L;return(L=v==null?void 0:v.diff.read(y))==null?void 0:L.mappings.map(k=>k.lineRangeMapping)}),new PC(this._editors))).recomputeInitiallyAndOnChange(this._store);const S=this._accessibleDiffViewerVisible.map(m=>m?"hidden":"visible");this._register(Ht(this.elements.modified,{visibility:S})),this._register(Ht(this.elements.original,{visibility:S})),this._createDiffEditorContributions(),o.addDiffEditor(this),this._gutter=nt(this,m=>this._options.shouldRenderGutterMenu.read(m)?this._instantiationService.createInstance(Ze(jl,m),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(vc(this._layoutInfo)),nt(this,m=>new(Ze($i,m))(this.elements.root,this._diffModel,this._layoutInfo.map(v=>v.originalEditor),this._layoutInfo.map(v=>v.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,m=>{this._movedBlocksLinesPart.set(m,void 0)}),this._register(ee.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,m=>this._handleCursorPositionChange(m,!0))),this._register(ee.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,m=>this._handleCursorPositionChange(m,!1)));const _=this._diffModel.map(this,(m,v)=>{if(m)return m.diff.read(v)===void 0&&!m.isDiffUpToDate.read(v)});this._register(et((m,v)=>{if(_.read(m)===!0){const y=this._editorProgressService.show(!0,1e3);v.add(le(()=>y.done()))}})),this._register(et((m,v)=>{v.add(new(Ze(oy,m))(this._editors,this._diffModel,this._options,this))})),this._register(et((m,v)=>{const y=this._diffModel.read(m);if(y)for(const L of[y.model.original,y.model.modified])v.add(L.onWillDispose(k=>{di(new Wt("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register($(m=>{this._options.setModel(this._diffModel.read(m))}))}_createInnerEditor(e,t,i,s){return e.createInstance(ff,t,i,s)}_createDiffEditorContributions(){const e=Mp.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){di(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return sf.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var i;const e=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:e,modified:t,modelState:(i=this._diffModel.get())==null?void 0:i.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&((t=this._diffModel.get())==null||t.restoreSerializedState(i.modelState))}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(ql,e,this._options)}getModel(){var e;return((e=this._diffModel.get())==null?void 0:e.model)??null}setModel(e){const t=e?"model"in e?cr.create(e).createNewRef(this):cr.create(this.createViewModel(e),this):null;this.setDiffModel(t)}setDiffModel(e,t){const i=this._diffModel.get();!e&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==(e==null?void 0:e.object)&&df(t,s=>{var a;const r=e==null?void 0:e.object;ne.batchEventsGlobally(s,()=>{this._editors.original.setModel(r?r.model.original:null),this._editors.modified.setModel(r?r.model.modified:null)});const o=(a=this._diffModelSrc.get())==null?void 0:a.createNewRef(this);this._diffModelSrc.set(e==null?void 0:e.createNewRef(this),s),setTimeout(()=>{o==null||o.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?gy(e):null}revert(e){const t=this._diffModel.get();!t||!t.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:t.model.original.getValueInRange(e.original.toExclusiveRange())}])}revertRangeMappings(e){const t=this._diffModel.get();if(!t||!t.isDiffUpToDate.get())return;const i=e.map(s=>({range:s.modifiedRange,text:t.model.original.getValueInRange(s.originalRange)}));this._editors.modified.executeEdits("diffEditor",i)}_goTo(e){this._editors.modified.setPosition(new K(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){var r,o;const t=(o=(r=this._diffModel.get())==null?void 0:r.diff.get())==null?void 0:o.mappings;if(!t||t.length===0)return;const i=this._editors.modified.getPosition().lineNumber;let s;e==="next"?s=t.find(a=>a.lineRangeMapping.modified.startLineNumber>i)??t[0]:s=Do(t,a=>a.lineRangeMapping.modified.startLineNumber<i)??t[t.length-1],this._goTo(s),s.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(kt.diffLineDeleted,{source:"diffEditor.goToDiff"}):s.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(kt.diffLineInserted,{source:"diffEditor.goToDiff"}):s&&this._accessibilitySignalService.playSignal(kt.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const e=this._diffModel.get();e&&this.waitForDiff().then(()=>{var i;const t=(i=e.diff.get())==null?void 0:i.mappings;!t||t.length===0||this._goTo(t[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){var o,a;const e=this._editors.modified.hasWidgetFocus(),t=e?this._editors.modified:this._editors.original,i=e?this._editors.original:this._editors.modified;let s;const r=t.getSelection();if(r){const l=(a=(o=this._diffModel.get())==null?void 0:o.diff.get())==null?void 0:a.mappings.map(c=>e?c.lineRangeMapping.flip():c.lineRangeMapping);if(l){const c=jh(r.getStartPosition(),l),d=jh(r.getEndPosition(),l);s=O.plusRange(c,d)}}return{destination:i,destinationSelection:s}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&ge(i=>{for(const s of e)s.collapseAll(i)})}showAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&ge(i=>{for(const s of e)s.showAll(i)})}_handleCursorPositionChange(e,t){var i,s;if((e==null?void 0:e.reason)===3){const r=(s=(i=this._diffModel.get())==null?void 0:i.diff.get())==null?void 0:s.mappings.find(o=>t?o.lineRangeMapping.modified.contains(e.position.lineNumber):o.lineRangeMapping.original.contains(e.position.lineNumber));r!=null&&r.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(kt.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):r!=null&&r.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(kt.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):r&&this._accessibilitySignalService.playSignal(kt.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};hr=fy([fn(3,me),fn(4,re),fn(5,Ce),fn(6,zr),fn(7,Cc)],hr);function gy(n){return n.mappings.map(e=>{const t=e.lineRangeMapping;let i,s,r,o,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,s=0,a=void 0):(i=t.original.startLineNumber,s=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(r=t.modified.startLineNumber-1,o=0,a=void 0):(r=t.modified.startLineNumber,o=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:s,modifiedStartLineNumber:r,modifiedEndLineNumber:o,charChanges:a==null?void 0:a.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var Uc=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},z=function(n,e){return function(t,i){e(t,i,n)}};let my=0,uu=!1;function py(n){if(!n){if(uu)return;uu=!0}fm(n||Ue.document.body)}let ur=class extends ff{constructor(e,t,i,s,r,o,a,l,c,d,h,u,f){const g={...t};g.ariaLabel=g.ariaLabel||$a.editorViewAccessibleLabel,super(e,g,{},i,s,r,o,c,d,h,u,f),l instanceof Zi?this._standaloneKeybindingService=l:this._standaloneKeybindingService=null,py(g.ariaContainerElement),W_((p,b)=>i.createInstance(Sc,p,b,{})),F_(a)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const s="DYNAMIC_"+ ++my,r=Ie.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(s,e,t,r),s}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),D.None;const t=e.id,i=e.label,s=Ie.and(Ie.equals("editorId",this.getId()),Ie.deserialize(e.precondition)),r=e.keybindings,o=Ie.and(s,Ie.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(f,...g)=>Promise.resolve(e.run(this,...g)),d=new ie,h=this.getId()+":"+t;if(d.add(Ct.registerCommand(h,c)),a){const f={command:{id:h,title:i},when:s,group:a,order:l};d.add(tf.appendMenuItem(ii.EditorContext,f))}if(Array.isArray(r))for(const f of r)d.add(this._standaloneKeybindingService.addDynamicKeybinding(h,f,c,o));const u=new B_(h,i,i,void 0,s,(...f)=>Promise.resolve(e.run(this,...f)),this._contextKeyService);return this._actions.set(t,u),d.add(le(()=>{this._actions.delete(t)})),d}_triggerCommand(e,t){if(this._codeEditorService instanceof $s)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};ur=Uc([z(2,re),z(3,Ce),z(4,Yi),z(5,me),z(6,qr),z(7,ht),z(8,yt),z(9,$t),z(10,fi),z(11,Jn),z(12,Q)],ur);let Jl=class extends ur{constructor(e,t,i,s,r,o,a,l,c,d,h,u,f,g,p,b){const w={...t};rr(h,w,!1);const S=c.registerEditorContainer(e);typeof w.theme=="string"&&c.setTheme(w.theme),typeof w.autoDetectHighContrast<"u"&&c.setAutoDetectHighContrast(!!w.autoDetectHighContrast);const _=w.model;delete w.model,super(e,w,i,s,r,o,a,l,c,d,u,p,b),this._configurationService=h,this._standaloneThemeService=c,this._register(S);let m;if(typeof _>"u"){const v=g.getLanguageIdByMimeType(w.language)||w.language||At;m=hg(f,g,w.value||"",v,void 0),this._ownsModel=!0}else m=_,this._ownsModel=!1;if(this._attachModel(m),m){const v={oldModelUrl:null,newModelUrl:m.uri};this._onDidChangeModel.fire(v)}}dispose(){super.dispose()}updateOptions(e){rr(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};Jl=Uc([z(2,re),z(3,Ce),z(4,Yi),z(5,me),z(6,qr),z(7,ht),z(8,Xe),z(9,$t),z(10,Oe),z(11,fi),z(12,Ee),z(13,Se),z(14,Jn),z(15,Q)],Jl);let ec=class extends hr{constructor(e,t,i,s,r,o,a,l,c,d,h,u){const f={...t};rr(l,f,!0);const g=o.registerEditorContainer(e);typeof f.theme=="string"&&o.setTheme(f.theme),typeof f.autoDetectHighContrast<"u"&&o.setAutoDetectHighContrast(!!f.autoDetectHighContrast),super(e,f,{},s,i,r,u,d),this._configurationService=l,this._standaloneThemeService=o,this._register(g)}dispose(){super.dispose()}updateOptions(e){rr(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(ur,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};ec=Uc([z(2,re),z(3,me),z(4,Ce),z(5,Xe),z(6,$t),z(7,Oe),z(8,Wr),z(9,Cc),z(10,yc),z(11,zr)],ec);function hg(n,e,t,i,s){if(t=t||"",!i){const r=t.indexOf(`
`);let o=t;return r!==-1&&(o=t.substring(0,r)),fu(n,t,e.createByFilepathOrFirstLine(s||null,o),s)}return fu(n,t,e.createById(i),s)}function fu(n,e,t,i){return n.createModel(e,t,i)}var _y=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},gu=function(n,e){return function(t,i){e(t,i,n)}};class by{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let fr=class extends D{constructor(e,t,i,s,r){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=s,this._viewModel=F(this,void 0),this._collapsed=T(this,l=>{var c;return(c=this._viewModel.read(l))==null?void 0:c.collapsed.read(l)}),this._editorContentHeight=F(this,500),this.contentHeight=T(this,l=>(this._collapsed.read(l)?0:this._editorContentHeight.read(l))+this._outerEditorHeight),this._modifiedContentWidth=F(this,0),this._modifiedWidth=F(this,0),this._originalContentWidth=F(this,0),this._originalWidth=F(this,0),this.maxScroll=T(this,l=>{const c=this._modifiedContentWidth.read(l)-this._modifiedWidth.read(l),d=this._originalContentWidth.read(l)-this._originalWidth.read(l);return c>d?{maxScroll:c,width:this._modifiedWidth.read(l)}:{maxScroll:d,width:this._originalWidth.read(l)}}),this._elements=P("div.multiDiffEntry",[P("div.header@header",[P("div.header-content",[P("div.collapse-button@collapseButton"),P("div.file-path",[P("div.title.modified.show-file-icons@primaryPath",[]),P("div.status.deleted@status",["R"]),P("div.title.original.show-file-icons@secondaryPath",[])]),P("div.actions@actions")])]),P("div.editorParent",[P("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(hr,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=Gn(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=Gn(this.editor.getOriginalEditor()).isFocused,this.isFocused=T(this,l=>this.isModifedFocused.read(l)||this.isOriginalFocused.read(l)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new ie),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const o=new ll(this._elements.collapseButton,{});this._register($(l=>{o.element.className="",o.icon=this._collapsed.read(l)?we.chevronRight:we.chevronDown})),this._register(o.onDidClick(()=>{var l;(l=this._viewModel.get())==null||l.collapsed.set(!this._collapsed.get(),void 0)})),this._register($(l=>{this._elements.editor.style.display=this._collapsed.read(l)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(l=>{const c=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(c,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(l=>{const c=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(c,void 0)})),this._register(this.editor.onDidContentSizeChange(l=>{pn(c=>{this._editorContentHeight.set(l.contentHeight,c),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),c),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),c)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(l=>{if(this._isSettingScrollTop||!l.scrollTopChanged||!this._data)return;const c=l.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(c)})),this._register($(l=>{var d;const c=(d=this._viewModel.read(l))==null?void 0:d.isActive.read(l);this._elements.root.classList.toggle("active",c)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(r.createScoped(this._elements.actions));const a=this._register(this._instantiationService.createChild(new es([me,this._contextKeyService])));this._register(a.createInstance(gf,this._elements.actions,ii.MultiDiffEditorFileToolbar,{actionRunner:this._register(new cg(()=>{var l;return(l=this._viewModel.get())==null?void 0:l.modifiedUri})),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:l=>l.startsWith("navigation")},actionViewItemProvider:(l,c)=>H_(a,l,c)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){this._data=e;function t(s){return{...s,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!e){pn(s=>{this._viewModel.set(void 0,s),this.editor.setDiffModel(null,s),this._dataStore.clear()});return}const i=e.viewModel.documentDiffItem;if(pn(s=>{var c,d;(c=this._resourceLabel)==null||c.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:e.viewModel.modifiedUri===void 0});let r=!1,o=!1,a=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",r=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",a=!0):(l="D",o=!0),this._elements.status.classList.toggle("renamed",r),this._elements.status.classList.toggle("deleted",o),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=l,(d=this._resourceLabel2)==null||d.setUri(r?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,s),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,s),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,s=>{s||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[s,r]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(s,r)}render(e,t,i,s){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const r=e.length-this._headerHeight,o=Math.max(0,Math.min(s.start-e.start,r));this._elements.header.style.transform=`translateY(${o}px)`,pn(a=>{this.editor.layout({width:t-2*8-2*1,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",o>0||i>0),this._elements.header.classList.toggle("collapsed",o===r)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};fr=_y([gu(3,re),gu(4,me)],fr);class vy{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(this._unused.size===0)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(s=>this._itemData.get(s).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var wy=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},mu=function(n,e){return function(t,i){e(t,i,n)}};let tc=class extends D{constructor(e,t,i,s,r,o){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=s,this._parentContextKeyService=r,this._parentInstantiationService=o,this._scrollableElements=P("div.scrollContent",[P("div@content",{style:{overflow:"hidden"}}),P("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new gm({forceIntegerValues:!1,scheduleAtNextAnimationFrame:l=>Tp(ae(this._element),l),smoothScrollDuration:100})),this._scrollableElement=this._register(new mm(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=P("div.monaco-component.multiDiffEditor",{},[P("div",{},[this._scrollableElement.getDomNode()]),P("div.placeholder@placeholder",{},[P("div",[C("noChangedFiles","No Changed Files")])])]),this._sizeObserver=this._register(new ig(this._element,void 0)),this._objectPool=this._register(new vy(l=>{const c=this._instantiationService.createInstance(fr,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return c.setData(l),c})),this.scrollTop=ne(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=ne(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=Ji(this,(l,c)=>{const d=this._viewModel.read(l);if(!d)return{items:[],getItem:g=>{throw new Wt}};const h=d.items.read(l),u=new Map;return{items:h.map(g=>{var w;const p=c.add(new Sy(g,this._objectPool,this.scrollLeft,S=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+S})})),b=(w=this._lastDocStates)==null?void 0:w[p.getKey()];return b&&ge(S=>{p.setViewState(b,S)}),u.set(g,p),p}),getItem:g=>u.get(g)}}),this._viewItems=this._viewItemsInfo.map(this,l=>l.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(l,c)=>l.reduce((d,h)=>d+h.contentHeight.read(c)+this._spaceBetweenPx,0)),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new es([me,this._contextKeyService]))),this._lastDocStates={},this._contextKeyService.createKey(Ge.inMultiDiffEditor.key,!0),this._register(et((l,c)=>{const d=this._viewModel.read(l);if(d&&d.contextKeys)for(const[h,u]of Object.entries(d.contextKeys)){const f=this._contextKeyService.createKey(h,void 0);f.set(u),c.add(le(()=>f.reset()))}}));const a=this._parentContextKeyService.createKey(Ge.multiDiffEditorAllCollapsed.key,!1);this._register($(l=>{const c=this._viewModel.read(l);if(c){const d=c.items.read(l).every(h=>h.collapsed.read(l));a.set(d)}})),this._register($(l=>{const c=this._dimension.read(l);this._sizeObserver.observe(c)})),this._register($(l=>{const c=this._viewItems.read(l);this._elements.placeholder.classList.toggle("visible",c.length===0)})),this._scrollableElements.content.style.position="relative",this._register($(l=>{const c=this._sizeObserver.height.read(l);this._scrollableElements.root.style.height=`${c}px`;const d=this._totalHeight.read(l);this._scrollableElements.content.style.height=`${d}px`;const h=this._sizeObserver.width.read(l);let u=h;const f=this._viewItems.read(l),g=V_(f,Ot(p=>p.maxScroll.read(l).maxScroll,ti));if(g){const p=g.maxScroll.read(l);u=h+p.maxScroll}this._scrollableElement.setScrollDimensions({width:h,height:c,scrollHeight:d,scrollWidth:u})})),e.replaceChildren(this._elements.root),this._register(le(()=>{e.replaceChildren()})),this._register(this._register($(l=>{pn(c=>{this.render(l)})})))}render(e){const t=this.scrollTop.read(e);let i=0,s=0,r=0;const o=this._sizeObserver.height.read(e),a=q.ofStartAndLength(t,o),l=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const d=c.contentHeight.read(e),h=Math.min(d,o),u=q.ofStartAndLength(s,h),f=q.ofStartAndLength(r,d);if(f.isBefore(a))i-=d-h,c.hide();else if(f.isAfter(a))c.hide();else{const g=Math.max(0,Math.min(a.start-f.start,d-h));i-=g;const p=q.ofStartAndLength(t+i,o);c.render(u,g,l,p)}s+=h+this._spaceBetweenPx,r+=d+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};tc=wy([mu(4,me),mu(5,re)],tc);class Sy extends D{constructor(e,t,i,s){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=s,this._templateRef=this._register(uf(this,void 0)),this.contentHeight=T(this,r=>{var o,a;return((a=(o=this._templateRef.read(r))==null?void 0:o.object.contentHeight)==null?void 0:a.read(r))??this.viewModel.lastTemplateData.read(r).contentHeight}),this.maxScroll=T(this,r=>{var o;return((o=this._templateRef.read(r))==null?void 0:o.object.maxScroll.read(r))??{maxScroll:0,scrollWidth:0}}),this.template=T(this,r=>{var o;return(o=this._templateRef.read(r))==null?void 0:o.object}),this._isHidden=F(this,!1),this._isFocused=T(this,r=>{var o;return((o=this.template.read(r))==null?void 0:o.isFocused.read(r))??!1}),this.viewModel.setIsFocused(this._isFocused,void 0),this._register($(r=>{var a;const o=this._scrollLeft.read(r);(a=this._templateRef.read(r))==null||a.object.setScrollLeft(o)})),this._register($(r=>{const o=this._templateRef.read(r);!o||!this._isHidden.read(r)||o.object.isFocused.read(r)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){var e;return`VirtualViewItem(${(e=this.viewModel.documentDiffItem.modified)==null?void 0:e.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){var o;this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),s=(o=e.selections)==null?void 0:o.map(Fs.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:s},t);const r=this._templateRef.get();r&&s&&r.object.editor.setSelections(s)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&ge(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,s){this._isHidden.set(!1,void 0);let r=this._templateRef.get();if(!r){r=this._objectPool.getUnusedObj(new by(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(r,void 0);const o=this.viewModel.lastTemplateData.get().selections;o&&r.object.editor.setSelections(o)}r.object.render(e,i,t,s)}}Ki("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},C("multiDiffEditor.headerBackground","The background color of the diff editor's header"));Ki("multiDiffEditor.background",Xn,C("multiDiffEditor.background","The background color of the multi file diff editor"));Ki("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},C("multiDiffEditor.border","The border color of the multi file diff editor"));var Cy=function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},yy=function(n,e){return function(t,i){e(t,i,n)}};let ic=class extends D{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=F(this,void 0),this._viewModel=F(this,void 0),this._widgetImpl=Ji(this,(s,r)=>(Ze(fr,s),r.add(this._instantiationService.createInstance(Ze(tc,s),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory)))),this._register(vc(this._widgetImpl))}};ic=Cy([yy(2,re)],ic);function Ly(n,e,t){return x.initialize(t||{}).createInstance(Jl,n,e)}function ky(n){return x.get(Ce).onCodeEditorAdd(t=>{n(t)})}function Ey(n){return x.get(Ce).onDiffEditorAdd(t=>{n(t)})}function xy(){return x.get(Ce).listCodeEditors()}function Iy(){return x.get(Ce).listDiffEditors()}function Dy(n,e,t){return x.initialize(t||{}).createInstance(ec,n,e)}function Ry(n,e){const t=x.initialize(e||{});return new ic(n,{},t)}function My(n){if(typeof n.id!="string"||typeof n.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return Ct.registerCommand(n.id,n.run)}function Ty(n){if(typeof n.id!="string"||typeof n.label!="string"||typeof n.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=Ie.deserialize(n.precondition),t=(s,...r)=>Np.runEditorCommand(s,r,e,(o,a,l)=>Promise.resolve(n.run(a,...l))),i=new ie;if(i.add(Ct.registerCommand(n.id,t)),n.contextMenuGroupId){const s={command:{id:n.id,title:n.label},when:e,group:n.contextMenuGroupId,order:n.contextMenuOrder||0};i.add(tf.appendMenuItem(ii.EditorContext,s))}if(Array.isArray(n.keybindings)){const s=x.get(ht);if(!(s instanceof Zi))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const r=Ie.and(e,Ie.deserialize(n.keybindingContext));i.add(s.addDynamicKeybindings(n.keybindings.map(o=>({keybinding:o,command:n.id,when:r}))))}}return i}function Ny(n){return ug([n])}function ug(n){const e=x.get(ht);return e instanceof Zi?e.addDynamicKeybindings(n.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:Ie.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),D.None)}function Ay(n,e,t){const i=x.get(Se),s=i.getLanguageIdByMimeType(e)||e;return hg(x.get(Ee),i,n,s,t)}function Oy(n,e){const t=x.get(Se),i=t.getLanguageIdByMimeType(e)||e||At;n.setLanguage(t.createById(i))}function Py(n,e,t){n&&x.get(gi).changeOne(e,n.uri,t)}function Fy(n){x.get(gi).changeAll(n,[])}function By(n){return x.get(gi).read(n)}function Wy(n){return x.get(gi).onMarkerChanged(n)}function Hy(n){return x.get(Ee).getModel(n)}function Vy(){return x.get(Ee).getModels()}function Uy(n){return x.get(Ee).onModelAdded(n)}function $y(n){return x.get(Ee).onModelRemoved(n)}function qy(n){return x.get(Ee).onModelLanguageChanged(t=>{n({model:t.model,oldLanguage:t.oldLanguageId})})}function zy(n){return lC(x.get(Ee),n)}function jy(n,e){const t=x.get(Se),i=x.get(Xe);return Nc.colorizeElement(i,t,n,e).then(()=>{i.registerEditorContainer(n)})}function Gy(n,e,t){const i=x.get(Se);return x.get(Xe).registerEditorContainer(Ue.document.body),Nc.colorize(i,n,e,t)}function Zy(n,e,t=4){return x.get(Xe).registerEditorContainer(Ue.document.body),Nc.colorizeModelLine(n,e,t)}function Ky(n){const e=Le.get(n);return e||{getInitialState:()=>So,tokenize:(t,i,s)=>ku(n,s)}}function Xy(n,e){Le.getOrCreate(e);const t=Ky(e),i=uc(n),s=[];let r=t.getInitialState();for(let o=0,a=i.length;o<a;o++){const l=i[o],c=t.tokenize(l,!0,r);s[o]=c.tokens,r=c.endState}return s}function Yy(n,e){x.get(Xe).defineTheme(n,e)}function Qy(n){x.get(Xe).setTheme(n)}function Jy(){G_.clearAllFontInfos()}function eL(n,e){return Ct.registerCommand({id:n,handler:e})}function tL(n){return x.get(Ar).registerOpener({async open(t){return typeof t=="string"&&(t=Ae.parse(t)),n.open(t)}})}function iL(n){return x.get(Ce).registerCodeEditorOpenHandler(async(t,i,s)=>{var a;if(!i)return null;const r=(a=t.options)==null?void 0:a.selection;let o;return r&&typeof r.endLineNumber=="number"&&typeof r.endColumn=="number"?o=r:r&&(o={lineNumber:r.startLineNumber,column:r.startColumn}),await n.openCodeEditor(i,t.resource,o)?i:null})}function nL(){return{create:Ly,getEditors:xy,getDiffEditors:Iy,onDidCreateEditor:ky,onDidCreateDiffEditor:Ey,createDiffEditor:Dy,addCommand:My,addEditorAction:Ty,addKeybindingRule:Ny,addKeybindingRules:ug,createModel:Ay,setModelLanguage:Oy,setModelMarkers:Py,getModelMarkers:By,removeAllMarkers:Fy,onDidChangeMarkers:Wy,getModels:Vy,getModel:Hy,onDidCreateModel:Uy,onWillDisposeModel:$y,onDidChangeModelLanguage:qy,createWebWorker:zy,colorizeElement:jy,colorize:Gy,colorizeModelLine:Zy,tokenize:Xy,defineTheme:Yy,setTheme:Qy,remeasureFonts:Jy,registerCommand:eL,registerLinkOpener:tL,registerEditorOpener:iL,AccessibilitySupport:Ro,ContentWidgetPositionPreference:Po,CursorChangeReason:Fo,DefaultEndOfLine:Bo,EditorAutoIndentStrategy:Ho,EditorOption:Vo,EndOfLinePreference:Uo,EndOfLineSequence:$o,MinimapPosition:ea,MinimapSectionHeaderStyle:ta,MouseTargetType:ia,OverlayWidgetPositionPreference:ra,OverviewRulerLane:oa,GlyphMarginLane:qo,RenderLineNumbersType:ca,RenderMinimap:da,ScrollbarVisibility:ua,ScrollType:ha,TextEditorCursorBlinkingStyle:ba,TextEditorCursorStyle:va,TrackedRangeStickiness:wa,WrappingIndent:Sa,InjectedTextCursorStops:Go,PositionAffinity:la,ShowLightbulbIconMode:ga,ConfigurationChangedEvent:pm,BareFontInfo:U_,FontInfo:$_,TextModelResolvedOptions:q_,FindMatch:z_,ApplyUpdateResult:_m,EditorZoom:j_,createMultiFileDiffEditor:Ry,EditorType:sf,EditorOptions:Xi}}function sL(n,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!n(t))return!1;return!0}function bs(n,e){return typeof n=="boolean"?n:e}function pu(n,e){return typeof n=="string"?n:e}function rL(n){const e={};for(const t of n)e[t]=!0;return e}function _u(n,e=!1){e&&(n=n.map(function(i){return i.toLowerCase()}));const t=rL(n);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function nc(n,e,t){e=e.replace(/@@/g,"");let i=0,s;do s=!1,e=e.replace(/@(\w+)/g,function(o,a){s=!0;let l="";if(typeof n[a]=="string")l=n[a];else if(n[a]&&n[a]instanceof RegExp)l=n[a].source;else throw n[a]===void 0?Z(n,"language definition does not contain attribute '"+a+"', used at: "+e):Z(n,"attribute reference '"+a+"' must be a string, used at: "+e);return Qt(l)?"":"(?:"+l+")"}),i++;while(s&&i<5);e=e.replace(/\x01/g,"@");const r=(n.ignoreCase?"i":"")+(n.unicode?"u":"");if(t&&e.match(/\$[sS](\d\d?)/g)){let a=null,l=null;return c=>(l&&a===c||(a=c,l=new RegExp(fC(n,e,c),r)),l)}return new RegExp(e,r)}function oL(n,e,t,i){if(i<0)return n;if(i<e.length)return e[i];if(i>=100){i=i-100;const s=t.split(".");if(s.unshift(t),i<s.length)return s[i]}return null}function aL(n,e,t,i){let s=-1,r=t,o=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(s=parseInt(o[3]),o[2]&&(s=s+100)),r=o[4]);let a="~",l=r;!r||r.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(o=r.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(a=o[1],l=o[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const d=_u(l.split("|"),n.ignoreCase);c=function(h){return a==="~"?d(h):!d(h)}}else if(a==="@"||a==="!@"){const d=n[l];if(!d)throw Z(n,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!sL(function(u){return typeof u=="string"},d))throw Z(n,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const h=_u(d,n.ignoreCase);c=function(u){return a==="@"?h(u):!h(u)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const d=nc(n,"^"+l+"$",!1);c=function(h){return a==="~"?d.test(h):!d.test(h)}}else c=function(d,h,u,f){return nc(n,"^"+Rt(n,l,h,u,f)+"$",!1).test(d)};else if(l.indexOf("$")<0){const d=St(n,l);c=function(h){return a==="=="?h===d:h!==d}}else{const d=St(n,l);c=function(h,u,f,g,p){const b=Rt(n,d,u,f,g);return a==="=="?h===b:h!==b}}return s===-1?{name:t,value:i,test:function(d,h,u,f){return c(d,d,h,u,f)}}:{name:t,value:i,test:function(d,h,u,f){const g=oL(d,h,u,s);return c(g||"",d,h,u,f)}}}function sc(n,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw Z(n,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw Z(n,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw Z(n,"the next state must be a string value in rule: "+e);{let s=t.next;if(!/^(@pop|@push|@popall)$/.test(s)&&(s[0]==="@"&&(s=s.substr(1)),s.indexOf("$")<0&&!gC(n,Rt(n,s,"",[],""))))throw Z(n,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=s}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,n.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let s=0,r=t.length;s<r;s++)i[s]=sc(n,e,t[s]);return{group:i}}else if(t.cases){const i=[];for(const r in t.cases)if(t.cases.hasOwnProperty(r)){const o=sc(n,e,t.cases[r]);r==="@default"||r==="@"||r===""?i.push({test:void 0,value:o,name:r}):r==="@eos"?i.push({test:function(a,l,c,d){return d},value:o,name:r}):i.push(aL(n,e,r,o))}const s=n.defaultToken;return{test:function(r,o,a,l){for(const c of i)if(!c.test||c.test(r,o,a,l))return c.value;return s}}}else throw Z(n,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class lL{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw Z(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=nc(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=sc(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function fg(n,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={languageId:n,includeLF:bs(e.includeLF,!1),noThrow:!1,maxStack:100,start:typeof e.start=="string"?e.start:null,ignoreCase:bs(e.ignoreCase,!1),unicode:bs(e.unicode,!1),tokenPostfix:pu(e.tokenPostfix,"."+n),defaultToken:pu(e.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},i=e;i.languageId=n,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function s(o,a,l){for(const c of l){let d=c.include;if(d){if(typeof d!="string")throw Z(t,"an 'include' attribute must be a string at: "+o);if(d[0]==="@"&&(d=d.substr(1)),!e.tokenizer[d])throw Z(t,"include target '"+d+"' is not defined at: "+o);s(o+"."+d,a,e.tokenizer[d])}else{const h=new lL(o);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(h.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")h.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const u=c[1];u.next=c[2],h.setAction(i,u)}else throw Z(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+o);else h.setAction(i,c[1]);else{if(!c.regex)throw Z(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+o);c.name&&typeof c.name=="string"&&(h.name=c.name),c.matchOnlyAtStart&&(h.matchOnlyAtLineStart=bs(c.matchOnlyAtLineStart,!1)),h.setRegex(i,c.regex),h.setAction(i,c.action)}a.push(h)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw Z(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const o in e.tokenizer)if(e.tokenizer.hasOwnProperty(o)){t.start||(t.start=o);const a=e.tokenizer[o];t.tokenizer[o]=new Array,s("tokenizer."+o,t.tokenizer[o],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw Z(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const r=[];for(const o of e.brackets){let a=o;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw Z(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")r.push({token:a.token+t.tokenPostfix,open:St(t,a.open),close:St(t,a.close)});else throw Z(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=r,t.noThrow=!0,t}function cL(n){Ds.registerLanguage(n)}function dL(){let n=[];return n=n.concat(Ds.getLanguages()),n}function hL(n){return x.get(Se).languageIdCodec.encodeLanguageId(n)}function uL(n,e){return x.withServices(()=>{const i=x.get(Se).onDidRequestRichLanguageFeatures(s=>{s===n&&(i.dispose(),e())});return i})}function fL(n,e){return x.withServices(()=>{const i=x.get(Se).onDidRequestBasicLanguageFeatures(s=>{s===n&&(i.dispose(),e())});return i})}function gL(n,e){if(!x.get(Se).isRegisteredLanguageId(n))throw new Error(`Cannot set configuration for unknown language ${n}`);return x.get(Jn).register(n,e,100)}class mL{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return Kn.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const s=this._actual.tokenizeEncoded(e,i);return new ac(s.tokens,s.endState)}}class Kn{constructor(e,t,i,s){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=s}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let s=0;for(let r=0,o=e.length;r<o;r++){const a=e[r];let l=a.startIndex;r===0?l=0:l<s&&(l=s),i[r]=new xs(l,a.scopes,t),s=l}return i}static adaptTokenize(e,t,i,s){const r=t.tokenize(i,s),o=Kn._toClassicTokens(r.tokens,e);let a;return r.endState.equals(s)?a=s:a=r.endState,new Eu(o,a)}tokenize(e,t,i){return Kn.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),s=this._standaloneThemeService.getColorTheme().tokenTheme,r=[];let o=0,a=0;for(let c=0,d=t.length;c<d;c++){const h=t[c],u=s.match(i,h.scopes)|1024;if(o>0&&r[o-1]===u)continue;let f=h.startIndex;c===0?f=0:f<a&&(f=a),r[o++]=f,r[o++]=u,a=f}const l=new Uint32Array(o);for(let c=0;c<o;c++)l[c]=r[c];return l}tokenizeEncoded(e,t,i){const s=this._actual.tokenize(e,i),r=this._toBinaryTokens(this._languageService.languageIdCodec,s.tokens);let o;return s.endState.equals(i)?o=i:o=s.endState,new ac(r,o)}}function pL(n){return typeof n.getInitialState=="function"}function _L(n){return"tokenizeEncoded"in n}function gg(n){return n&&typeof n.then=="function"}function bL(n){const e=x.get(Xe);if(n){const t=[null];for(let i=1,s=n.length;i<s;i++)t[i]=Bt.fromHex(n[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function mg(n,e){return _L(e)?new mL(n,e):new Kn(n,e,x.get(Se),x.get(Xe))}function $c(n,e){const t=new wm(async()=>{const i=await Promise.resolve(e.create());return i?pL(i)?mg(n,i):new jn(x.get(Se),x.get(Xe),n,fg(n,i),x.get(Oe)):null});return Le.registerFactory(n,t)}function vL(n,e){if(!x.get(Se).isRegisteredLanguageId(n))throw new Error(`Cannot set tokens provider for unknown language ${n}`);return gg(e)?$c(n,{create:()=>e}):Le.register(n,mg(n,e))}function wL(n,e){const t=i=>new jn(x.get(Se),x.get(Xe),n,fg(n,i),x.get(Oe));return gg(e)?$c(n,{create:()=>e}):Le.register(n,t(e))}function SL(n,e){return x.get(Q).referenceProvider.register(n,e)}function CL(n,e){return x.get(Q).renameProvider.register(n,e)}function yL(n,e){return x.get(Q).newSymbolNamesProvider.register(n,e)}function LL(n,e){return x.get(Q).signatureHelpProvider.register(n,e)}function kL(n,e){return x.get(Q).hoverProvider.register(n,{provideHover:async(i,s,r,o)=>{const a=i.getWordAtPosition(s);return Promise.resolve(e.provideHover(i,s,r,o)).then(l=>{if(l)return!l.range&&a&&(l.range=new O(s.lineNumber,a.startColumn,s.lineNumber,a.endColumn)),l.range||(l.range=new O(s.lineNumber,s.column,s.lineNumber,s.column)),l})}})}function EL(n,e){return x.get(Q).documentSymbolProvider.register(n,e)}function xL(n,e){return x.get(Q).documentHighlightProvider.register(n,e)}function IL(n,e){return x.get(Q).linkedEditingRangeProvider.register(n,e)}function DL(n,e){return x.get(Q).definitionProvider.register(n,e)}function RL(n,e){return x.get(Q).implementationProvider.register(n,e)}function ML(n,e){return x.get(Q).typeDefinitionProvider.register(n,e)}function TL(n,e){return x.get(Q).codeLensProvider.register(n,e)}function NL(n,e,t){return x.get(Q).codeActionProvider.register(n,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(s,r,o,a)=>{const c=x.get(gi).read({resource:s.uri}).filter(d=>O.areIntersectingOrTouching(d,r));return e.provideCodeActions(s,r,{markers:c,only:o.only,trigger:o.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function AL(n,e){return x.get(Q).documentFormattingEditProvider.register(n,e)}function OL(n,e){return x.get(Q).documentRangeFormattingEditProvider.register(n,e)}function PL(n,e){return x.get(Q).onTypeFormattingEditProvider.register(n,e)}function FL(n,e){return x.get(Q).linkProvider.register(n,e)}function BL(n,e){return x.get(Q).completionProvider.register(n,e)}function WL(n,e){return x.get(Q).colorProvider.register(n,e)}function HL(n,e){return x.get(Q).foldingRangeProvider.register(n,e)}function VL(n,e){return x.get(Q).declarationProvider.register(n,e)}function UL(n,e){return x.get(Q).selectionRangeProvider.register(n,e)}function $L(n,e){return x.get(Q).documentSemanticTokensProvider.register(n,e)}function qL(n,e){return x.get(Q).documentRangeSemanticTokensProvider.register(n,e)}function zL(n,e){return x.get(Q).inlineCompletionsProvider.register(n,e)}function jL(n,e){return x.get(Q).inlineEditProvider.register(n,e)}function GL(n,e){return x.get(Q).inlayHintsProvider.register(n,e)}function ZL(){return{register:cL,getLanguages:dL,onLanguage:uL,onLanguageEncountered:fL,getEncodedLanguageId:hL,setLanguageConfiguration:gL,setColorMap:bL,registerTokensProviderFactory:$c,setTokensProvider:vL,setMonarchTokensProvider:wL,registerReferenceProvider:SL,registerRenameProvider:CL,registerNewSymbolNameProvider:yL,registerCompletionItemProvider:BL,registerSignatureHelpProvider:LL,registerHoverProvider:kL,registerDocumentSymbolProvider:EL,registerDocumentHighlightProvider:xL,registerLinkedEditingRangeProvider:IL,registerDefinitionProvider:DL,registerImplementationProvider:RL,registerTypeDefinitionProvider:ML,registerCodeLensProvider:TL,registerCodeActionProvider:NL,registerDocumentFormattingEditProvider:AL,registerDocumentRangeFormattingEditProvider:OL,registerOnTypeFormattingEditProvider:PL,registerLinkProvider:FL,registerColorProvider:WL,registerFoldingRangeProvider:HL,registerDeclarationProvider:VL,registerSelectionRangeProvider:UL,registerDocumentSemanticTokensProvider:$L,registerDocumentRangeSemanticTokensProvider:qL,registerInlineCompletionsProvider:zL,registerInlineEditProvider:jL,registerInlayHintsProvider:GL,DocumentHighlightKind:Wo,CompletionItemKind:No,CompletionItemTag:Ao,CompletionItemInsertTextRule:To,SymbolKind:pa,SymbolTag:_a,IndentAction:jo,CompletionTriggerKind:Oo,SignatureHelpTriggerKind:ma,InlayHintKind:Zo,InlineCompletionTriggerKind:Ko,InlineEditTriggerKind:Xo,CodeActionTriggerType:Mo,NewSymbolNameTag:na,NewSymbolNameTriggerKind:sa,PartialAcceptTriggerKind:aa,HoverVerbosityAction:zo,FoldingRangeKind:bm,SelectedSuggestionInfo:vm}}Xi.wrappingIndent.defaultValue=0;Xi.glyphMargin.defaultValue=!1;Xi.autoIndent.defaultValue=3;Xi.overviewRulerLanes.defaultValue=2;_b.setFormatterSelector((n,e,t)=>Promise.resolve(n[0]));const xe=mf();xe.editor=nL();xe.languages=ZL();const KL=xe.CancellationTokenSource,XL=xe.Emitter,YL=xe.KeyCode,QL=xe.KeyMod,JL=xe.Position,ek=xe.Range,tk=xe.Selection,ik=xe.SelectionDirection,nk=xe.MarkerSeverity,sk=xe.MarkerTag,rk=xe.Uri,ok=xe.Token,ak=xe.editor,lk=xe.languages,_o=globalThis.MonacoEnvironment;(_o!=null&&_o.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=xe);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const b0=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:KL,Emitter:XL,KeyCode:YL,KeyMod:QL,MarkerSeverity:nk,MarkerTag:sk,Position:JL,Range:ek,Selection:tk,SelectionDirection:ik,Token:ok,Uri:rk,editor:ak,languages:lk},Symbol.toStringTag,{value:"Module"}));export{b0 as m};
