var Vw=Object.defineProperty;var Ww=Object.getPrototypeOf;var qw=Reflect.get;var W1=o=>{throw TypeError(o)};var Hw=(o,e,t)=>e in o?Vw(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var ve=(o,e,t)=>Hw(o,typeof e!="symbol"?e+"":e,t),q1=(o,e,t)=>e.has(o)||W1("Cannot "+t);var Pu=(o,e,t)=>(q1(o,e,"read from private field"),t?t.call(o):e.get(o)),p0=(o,e,t)=>e.has(o)?W1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,t);var Ng=(o,e,t)=>(q1(o,e,"access private method"),t);var H1=(o,e,t)=>qw(Ww(o),t,e);import{r as X_,v as Gw,w as G1,x as Uw,y as Mh,e as So,a as O,z as Bi,b as Ve,l as Hd,t as re,s as Au,c as ua,A as id,B as Wa,n as j2,C as m_,D as R2,f as Yf,E as Yw,p as B2}from"../chunks/stores.CCa09Ksn.js";import{v as Kw,E as Zw,w as Xw,F as O2,J as jv,K as hh,H as V2,Q as C0,aB as Jw,aS as Qw,aR as e5,O as J_,at as W2,as as q2,L as H2,al as t5,P as U1,C as Q_,aY as G2,I as o5,G as s5,l as Th,e as ys,aZ as n5,a_ as i5,a$ as r5,a6 as a5,q as e1,aC as am,b0 as l5,b1 as c5,aK as Y1,Z as K1,av as d5,ac as u5,m as b1,aL as U2,B as p5,A as x,aJ as op,c as m,f as Rt,b2 as pn,r as f,t as Se,p as Mc,ag as Fp,ah as fm,i as n,s as p,a as Tc,ai as nd,j as wp,aj as fp,ab as ee,k as Qe,b3 as Z1,a2 as kp,aI as vc,b as zr,b4 as Nd,b5 as jg,aa as v5,b6 as kf,y as wm,b7 as f5,aH as Sf,a5 as m5}from"../chunks/entry.iySINsB8.js";import{b as Y2,l as os,p as Qs,i as Te,a as D,c as Tu,s as Gu}from"../chunks/runtime.DqVSlXrs.js";import{i as Sp}from"../chunks/lifecycle.C_6CCDag.js";import{s as Nt,t as ii,e as Vs,i as _n,r as Jt,h as Gn,j as cu,k as P0,f as g5,l as B0,b as Bu,m as X1,n as wv,o as t1,A as h5,p as _5}from"../chunks/alert.Bu83PcVU.js";import{c as sp,a as rf,b as du,_ as J1,o as hp}from"../chunks/preload-helper.4w1Iww8Q.js";const y5=[];function tf(o,e=!1){return rh(o,new Map,"",y5)}function rh(o,e,t,s,i=null){if(typeof o=="object"&&o!==null){const a=e.get(o);if(a!==void 0)return a;if(o instanceof Map)return new Map(o);if(o instanceof Set)return new Set(o);if(Kw(o)){const l=[];e.set(o,l),i!==null&&e.set(i,l);for(let c=0;c<o.length;c+=1)l.push(rh(o[c],e,t,s));return l}if(Zw(o)===Xw){const l={};e.set(o,l),i!==null&&e.set(i,l);for(var r in o)l[r]=rh(o[r],e,t,s);return l}if(o instanceof Date)return structuredClone(o);if(typeof o.toJSON=="function")return rh(o.toJSON(),e,t,s,o)}if(o instanceof EventTarget)return o;try{return structuredClone(o)}catch{return o}}function b5(o,e,t,s,i){var r=o,a="",l;O2(()=>{if(a===(a=e()??"")){jv&&hh();return}l!==void 0&&(q2(l),l=void 0),a!==""&&(l=V2(()=>{if(jv){C0.data;for(var c=hh(),d=c;c!==null&&(c.nodeType!==8||c.data!=="");)d=c,c=Jw(c);if(c===null)throw Qw(),e5;X_(C0,d),r=J_(c);return}var v=a+"",g=Gw(v);X_(W2(g),g.lastChild),r.before(g)}))})}function x5(o,e,t,s,i,r){let a=jv;jv&&hh();var l,c,d=null;jv&&C0.nodeType===1&&(d=C0,hh());var v=jv?C0:o,g;O2(()=>{const _=e()||null;var y=G2;_!==l&&(g&&(_===null?o5(g,()=>{g=null,c=null}):_===c?s5(g):(q2(g),G1(!1))),_&&_!==c&&(g=V2(()=>{if(d=jv?d:document.createElementNS(y,_),X_(d,d),s){var k=jv?W2(d):d.appendChild(t5());jv&&(k===null?U1(!1):J_(k)),s(d,k)}Q_.nodes_end=d,v.before(d)})),l=_,l&&(c=l),G1(!0))},H2),a&&(U1(!0),J_(v))}function Q1(o,e,t){Th(()=>{var s=ys(()=>e(o,t==null?void 0:t())||{});if(s!=null&&s.destroy)return()=>s.destroy()})}const w5=()=>performance.now(),Kf={tick:o=>requestAnimationFrame(o),now:()=>w5(),tasks:new Set};function K2(o){Kf.tasks.forEach(e=>{e.c(o)||(Kf.tasks.delete(e),e.f())}),Kf.tasks.size!==0&&Kf.tick(K2)}function k5(o){let e;return Kf.tasks.size===0&&Kf.tick(K2),{promise:new Promise(t=>{Kf.tasks.add(e={c:o,f:t})}),abort(){Kf.tasks.delete(e)}}}function Rg(o,e){o.dispatchEvent(new CustomEvent(e))}function S5(o){if(o==="float")return"cssFloat";if(o==="offset")return"cssOffset";if(o.startsWith("--"))return o;const e=o.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function ey(o){const e={},t=o.split(";");for(const s of t){const[i,r]=s.split(":");if(!i||r===void 0)break;const a=S5(i.trim());e[a]=r.trim()}return e}const C5=o=>o;function Af(o,e,t,s){var i=(o&r5)!==0,r=(o&l5)!==0,a=i&&r,l=(o&c5)!==0,c=a?"both":i?"in":"out",d,v=e.inert,g,_;function y(){var C=d5,T=Q_;Y1(null),K1(null);try{return d??(d=t()(e,(s==null?void 0:s())??{},{direction:c}))}finally{Y1(C),K1(T)}}var k={is_global:l,in(){var C;if(e.inert=v,!i){_==null||_.abort(),(C=_==null?void 0:_.reset)==null||C.call(_);return}r||g==null||g.abort(),Rg(e,"introstart"),g=o1(e,y(),_,1,()=>{Rg(e,"introend"),g==null||g.abort(),g=d=void 0})},out(C){if(!r){C==null||C(),d=void 0;return}e.inert=!0,Rg(e,"outrostart"),_=o1(e,y(),g,0,()=>{Rg(e,"outroend"),C==null||C()})},stop:()=>{g==null||g.abort(),_==null||_.abort()}},S=Q_;if((S.transitions??(S.transitions=[])).push(k),i&&Uw){var M=l;if(!M){for(var I=S.parent;I&&I.f&H2;)for(;(I=I.parent)&&!(I.f&n5););M=!I||(I.f&i5)!==0}M&&Th(()=>{ys(()=>k.in())})}}function o1(o,e,t,s,i){var r=s===1;if(a5(e)){var a,l=!1;return e1(()=>{if(!l){var M=e({direction:r?"in":"out"});a=o1(o,M,t,s,i)}}),{abort:()=>{l=!0,a==null||a.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return i(),{abort:am,deactivate:am,reset:am,t:()=>s};const{delay:c=0,css:d,tick:v,easing:g=C5}=e;var _=[];if(r&&t===void 0&&(v&&v(0,1),d)){var y=ey(d(0,1));_.push(y,y)}var k=()=>1-s,S=o.animate(_,{duration:c});return S.onfinish=()=>{var M=(t==null?void 0:t.t())??1-s;t==null||t.abort();var I=s-M,C=e.duration*Math.abs(I),T=[];if(C>0){if(d)for(var z=Math.ceil(C/16.666666666666668),j=0;j<=z;j+=1){var B=M+I*g(j/z),$=d(B,1-B);T.push(ey($))}k=()=>{var F=S.currentTime;return M+I*g(F/C)},v&&k5(()=>{if(S.playState!=="running")return!1;var F=k();return v(F,1-F),!0})}S=o.animate(T,{duration:C,fill:"forwards"}),S.onfinish=()=>{k=()=>s,v==null||v(s,1-s),i()}},{abort:()=>{S&&(S.cancel(),S.effect=null,S.onfinish=am)},deactivate:()=>{i=am},reset:()=>{s===0&&(v==null||v(1,0))},t:()=>k()}}function Ho(o,e,t=e){var s=u5();Mh(o,"input",()=>{var i=h_(o)?__(o.value):o.value;t(i),s&&i!==(i=e())&&(o.value=i??"")}),b1(()=>{var i=e();if(jv&&o.defaultValue!==o.value){t(h_(o)?__(o.value):o.value);return}h_(o)&&i===__(o.value)||o.type==="date"&&!i&&!o.value||i!==o.value&&(o.value=i??"")})}const g_=new Set;function P5(o,e,t,s,i=s){var r=t.getAttribute("type")==="checkbox",a=o;let l=!1;if(e!==null)for(var c of e)a=a[c]??(a[c]=[]);a.push(t),Mh(t,"change",()=>{var d=t.__value;r&&(d=ty(a,d,t.checked)),i(d)},()=>i(r?[]:null)),b1(()=>{var d=s();if(jv&&t.defaultChecked!==t.checked){l=!0;return}r?(d=d||[],t.checked=d.includes(t.__value)):t.checked=Y2(t.__value,d)}),U2(()=>{var d=a.indexOf(t);d!==-1&&a.splice(d,1)}),g_.has(a)||(g_.add(a),e1(()=>{a.sort((d,v)=>d.compareDocumentPosition(v)===4?-1:1),g_.delete(a)})),e1(()=>{if(l){var d;if(r)d=ty(a,d,t.checked);else{var v=a.find(g=>g.checked);d=v==null?void 0:v.__value}i(d)}})}function _v(o,e,t=e){Mh(o,"change",()=>{var s=o.checked;t(s)}),e()==null&&t(!1),b1(()=>{var s=e();o.checked=!!s})}function ty(o,e,t){for(var s=new Set,i=0;i<o.length;i+=1)o[i].checked&&s.add(o[i].__value);return t||s.delete(e),Array.from(s)}function h_(o){var e=o.type;return e==="number"||e==="range"}function __(o){return o===""?null:+o}function oy(o,e,t){var s=p5(o,e);s&&s.set&&(o[e]=t,U2(()=>{o[e]=null}))}function zf(o,e,t){if(o.multiple)return I5(o,e);for(var s of o.options){var i=I0(s);if(Y2(i,e)){s.selected=!0;return}}(!t||e!==void 0)&&(o.selectedIndex=-1)}function dm(o,e){let t=!0;Th(()=>{e&&zf(o,ys(e),t),t=!1;var s=new MutationObserver(()=>{var i=o.__value;zf(o,i)});return s.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{s.disconnect()}})}function rs(o,e,t=e){var s=!0;Mh(o,"change",()=>{var i;if(o.multiple)i=[].map.call(o.querySelectorAll(":checked"),I0);else{var r=o.querySelector(":checked");i=r&&I0(r)}t(i)}),Th(()=>{var i=e();if(zf(o,i,s),s&&i===void 0){var r=o.querySelector(":checked");r!==null&&(i=I0(r),t(i))}o.__value=i,s=!1}),dm(o)}function I5(o,e){for(var t of o.options)t.selected=~e.indexOf(I0(t))}function I0(o){return"__value"in o?o.__value:o.value}function v0(o){x(o,o.v+1)}function Ru(o,e){if(!(!rv(o)&&!rv(e))){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const s=o[t],i=e[t];rv(i)&&rv(s)?Ru(s,i):Uo(e[t])&&(o[t]=Nm(e[t]))}}}function Nm(o){if(!rv(o))return o;let e=null;Ov(o)?e=[]:e={};for(const t in o)if(Object.prototype.hasOwnProperty.call(o,t)){const s=o[t];rv(s)?e[t]=Nm(s):e[t]=s}return e}function Ov(o){return Object.prototype.toString.call(o)==="[object Array]"}function Vp(o){return typeof o=="function"}function rv(o){return typeof o=="object"&&Uo(o)}function ja(o){return typeof o=="number"&&Number.isFinite(o)}function Uo(o){return o!=null}function $0(o){return typeof o=="boolean"}function pd(o){return typeof o=="string"}const M5=/\\(\\)?/g,T5=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function Hu(o,e,t){if(Uo(o)){const s=[];e.replace(T5,(l,...c)=>{let d=l;return Uo(c[1])?d=c[2].replace(M5,"$1"):Uo(c[0])&&(d=c[0].trim()),s.push(d),""});let i=o,r=0;const a=s.length;for(;Uo(i)&&r<a;)i=i==null?void 0:i[s[r++]];return Uo(i)?i:t??"--"}return t??"--"}function A5(o,e){const t={};return o.formatToParts(new Date(e)).forEach(({type:s,value:i})=>{switch(s){case"year":{t.YYYY=i;break}case"month":{t.MM=i;break}case"day":{t.DD=i;break}case"hour":{t.HH=i==="24"?"00":i;break}case"minute":{t.mm=i;break}case"second":{t.ss=i;break}}}),t}function Z2(o,e,t){const s=A5(o,e);return t.replace(/YYYY|MM|DD|HH|mm|ss/g,i=>s[i])}function vp(o,e){const t=+o;return ja(t)?t.toFixed(e??2):`${o}`}function X2(o){const e=+o;if(ja(e)){if(e>1e9)return`${+(e/1e9).toFixed(3)}B`;if(e>1e6)return`${+(e/1e6).toFixed(3)}M`;if(e>1e3)return`${+(e/1e3).toFixed(3)}K`}return`${o}`}function J2(o,e){const t=`${o}`;if(e.length===0)return t;if(t.includes(".")){const s=t.split(".");return`${s[0].replace(/(\d)(?=(\d{3})+$)/g,i=>`${i}${e}`)}.${s[1]}`}return t.replace(/(\d)(?=(\d{3})+$)/g,s=>`${s}${e}`)}function Q2(o,e){const t=`${o}`;if(new RegExp("\\.0{"+e+",}[1-9][0-9]*$").test(t)){const i=t.split("."),r=i.length-1,a=i[r],l=/0*/.exec(a);if(Uo(l)){const c=l[0].length;return i[r]=a.replace(/0*/,`0{${c}}`),i.join(".")}}return t}function sy(o,e){return o.replace(/\{(\w+)\}/g,(t,s)=>{const i=e[s];return Uo(i)?i:`{${s}}`})}let f0=null;function Xf(o){var e;return((e=o.ownerDocument.defaultView)==null?void 0:e.devicePixelRatio)??1}function Ff(o,e,t){return`${e??"normal"} ${o??12}px ${t??"Helvetica Neue"}`}function mp(o,e,t,s){if(!Uo(f0)){const i=document.createElement("canvas"),r=Xf(i);f0=i.getContext("2d"),f0.scale(r,r)}return f0.font=Ff(e,t,s),Math.round(f0.measureText(o).width)}function _h(o){const e={width:0,height:0,left:0,right:0,top:0,bottom:0};return Uo(o)&&Ru(e,o),e}var hd=(o=>(o[o.Main=0]="Main",o[o.Overlay=1]="Overlay",o[o.Separator=2]="Separator",o[o.Drawer=3]="Drawer",o[o.All=4]="All",o))(hd||{});const y_=-1;function Lf(o){return Vp(window.requestAnimationFrame)?window.requestAnimationFrame(o):window.setTimeout(o,20)}function ny(o){Vp(window.cancelAnimationFrame)?window.cancelAnimationFrame(o):window.clearTimeout(o)}class s1{constructor(e){ve(this,"_options",{duration:500,iterationCount:1});ve(this,"_doFrameCallback");ve(this,"_currentIterationCount",0);ve(this,"_running",!1);ve(this,"_time",0);Ru(this._options,e)}_loop(){this._running=!0;const e=()=>{var t;if(this._running){const s=new Date().getTime()-this._time;s<this._options.duration?((t=this._doFrameCallback)==null||t.call(this,s),Lf(e)):(this.stop(),this._currentIterationCount++,this._currentIterationCount<this._options.iterationCount&&this.start())}};Lf(e)}doFrame(e){return this._doFrameCallback=e,this}setDuration(e){return this._options.duration=e,this}setIterationCount(e){return this._options.iterationCount=e,this}start(){this._running||(this._time=new Date().getTime(),this._loop())}stop(){var e;this._running&&((e=this._doFrameCallback)==null||e.call(this,this._options.duration)),this._running=!1}}let b_=1,iy=new Date().getTime();function b0(o){const e=new Date().getTime();return e===iy?++b_:b_=1,iy=e,`${o??""}${e}_${b_}`}function Df(o,e){const t=document.createElement(o),s=e??{};for(const i in s)t.style[i]=s[i]??"";return t}function n1(o,e,t){let s=0,i=0;for(i=o.length-1;s!==i;){const r=Math.floor((i+s)/2),a=i-s,l=o[r][e];if(t===o[s][e])return s;if(t===o[i][e])return i;if(t===l)return r;if(t>l?s=r:i=r,a<=2)break}return s}function ry(o){const e=Math.floor(Pf(o)),t=lm(e),s=o/t;let i=0;return s<1.5?i=1:s<2.5?i=2:s<3.5?i=3:s<4.5?i=4:s<5.5?i=5:s<6.5?i=6:i=8,o=i*t,+o.toFixed(Math.abs(e))}function ay(o,e){e=Math.max(0,e??0);const t=Math.pow(10,e);return Math.round(o*t)/t}function L5(o){const e=o.toString(),t=e.indexOf("e");if(t>0){const i=+e.slice(t+1);return i<0?-i:0}const s=e.indexOf(".");return s<0?0:e.length-1-s}function eb(o,e,t){const s=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],i=o.length;let r=0;for(;r<i;){const a=o[r];s[0]=Math.max(a[e]??Number.MIN_SAFE_INTEGER,s[0]),s[1]=Math.min(a[t]??Number.MAX_SAFE_INTEGER,s[1]),++r}return s}function Pf(o){return o===0?0:Math.log10(o)}function lm(o){return Math.pow(10,o)}function ly(){return{from:0,to:0,realFrom:0,realTo:0}}function cy(...o){return o.join("_")}const z5=5;class F5{constructor(e){ve(this,"_limit");ve(this,"_running",0);ve(this,"_queue",[]);ve(this,"_taskMap",new Map);this._limit=e??z5}async add(e){return await new Promise((t,s)=>{const{id:i,handler:r}=e,a=()=>{this._running++,r().then(c=>{t(c)}).catch(()=>{s("failed")}).finally(()=>{this._running--,this._taskMap.delete(i),this._next()})},l=this._taskMap.get(i);if(Uo(l)){l.reject("canceled");const c=this._queue.indexOf(l.run);c>-1&&this._queue.splice(c,1)}this._taskMap.set(i,{run:a,reject:s}),this._queue.push(a),this._next()})}_next(){for(;this._running<this._limit&&this._queue.length>0;){const e=this._queue.shift();e==null||e()}}remove(e){const t=this._taskMap.get(e);if(Uo(t)){this._taskMap.delete(e);const s=this._queue.indexOf(t.run);s>-1&&this._queue.splice(s,1),t.reject("canceled")}}clear(){for(const[,{reject:e}]of this._taskMap)e("canceled");this._taskMap.clear(),this._queue=[]}}const gp={PRICE:2,VOLUME:0};class $5{constructor(){ve(this,"_callbacks",[])}subscribe(e){this._callbacks.indexOf(e)<0&&this._callbacks.push(e)}unsubscribe(e){if(Vp(e)){const t=this._callbacks.indexOf(e);t>-1&&this._callbacks.splice(t,1)}else this._callbacks=[]}execute(e){this._callbacks.forEach(t=>{t(e)})}isEmpty(){return this._callbacks.length===0}}function jm(o){return o==="transparent"||o==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(o)||/^[hH][Ss][Ll][Aa]\(([\s]*(360｜3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(o)}function Jf(o,e){const t=o.replace(/^#/,""),s=parseInt(t,16),i=s>>16&255,r=s>>8&255,a=s&255;return`rgba(${i}, ${r}, ${a}, ${e??1})`}const tl={RED:"#F92855",GREEN:"#2DC08E",WHITE:"#FFFFFF",GREY:"#76808F",BLUE:"#1677FF"};function D5(){return{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:"dashed",dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:"dashed",dashedValue:[2,2]}}}function E5(){const o={show:!0,color:tl.GREY,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"};return{type:"candle_solid",bar:{compareRule:"current_open",upColor:tl.GREEN,downColor:tl.RED,noChangeColor:tl.GREY,upBorderColor:tl.GREEN,downBorderColor:tl.RED,noChangeBorderColor:tl.GREY,upWickColor:tl.GREEN,downWickColor:tl.RED,noChangeWickColor:tl.GREY},area:{lineSize:2,lineColor:tl.BLUE,smooth:!1,value:"close",backgroundColor:[{offset:0,color:Jf(tl.BLUE,.01)},{offset:1,color:Jf(tl.BLUE,.2)}],point:{show:!0,color:tl.BLUE,radius:4,rippleColor:Jf(tl.BLUE,.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:{...o},low:{...o},last:{show:!0,compareRule:"current_open",upColor:tl.GREEN,downColor:tl.RED,noChangeColor:tl.GREY,line:{show:!0,style:"dashed",dashedValue:[4,4],size:1},text:{show:!0,style:"fill",size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:"solid",borderSize:0,borderDashedValue:[2,2],color:tl.WHITE,family:"Helvetica Neue",weight:"normal",borderRadius:2},extendTexts:[]}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:"always",showType:"standard",rect:{position:"fixed",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},title:{show:!0,size:14,family:"Helvetica Neue",weight:"normal",color:tl.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,template:"{ticker} · {period}"},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:tl.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a",template:[{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}]},features:[]}}}function N5(){const o=Jf(tl.GREEN,.7),e=Jf(tl.RED,.7);return{ohlc:{compareRule:"current_open",upColor:o,downColor:e,noChangeColor:tl.GREY},bars:[{style:"fill",borderStyle:"solid",borderSize:1,borderDashedValue:[2,2],upColor:o,downColor:e,noChangeColor:tl.GREY}],lines:["#FF9600","#935EBD",tl.BLUE,"#E11D74","#01C5C4"].map(t=>({style:"solid",smooth:!1,size:1,dashedValue:[2,2],color:t})),circles:[{style:"fill",borderStyle:"solid",borderSize:1,borderDashedValue:[2,2],upColor:o,downColor:e,noChangeColor:tl.GREY}],lastValueMark:{show:!1,text:{show:!1,style:"fill",color:tl.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:"always",showType:"standard",title:{show:!0,showName:!0,showParams:!0,size:12,family:"Helvetica Neue",weight:"normal",color:tl.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:tl.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a"},features:[]}}}function dy(){return{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:tl.GREY,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}}}function j5(){return{show:!0,horizontal:{show:!0,line:{show:!0,style:"dashed",dashedValue:[4,2],size:1,color:tl.GREY},text:{show:!0,style:"fill",color:tl.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderColor:tl.GREY,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:tl.GREY},features:[]},vertical:{show:!0,line:{show:!0,style:"dashed",dashedValue:[4,2],size:1,color:tl.GREY},text:{show:!0,style:"fill",color:tl.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderColor:tl.GREY,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:tl.GREY}}}}function R5(){const o=Jf(tl.BLUE,.35),e=Jf(tl.BLUE,.25);function t(){return{style:"fill",color:tl.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:tl.BLUE,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:tl.BLUE}}return{point:{color:tl.BLUE,borderColor:o,borderSize:1,radius:5,activeColor:tl.BLUE,activeBorderColor:o,activeBorderSize:3,activeRadius:5},line:{style:"solid",smooth:!1,color:tl.BLUE,size:1,dashedValue:[2,2]},rect:{style:"fill",color:e,borderColor:tl.BLUE,borderSize:1,borderRadius:0,borderStyle:"solid",borderDashedValue:[2,2]},polygon:{style:"fill",color:tl.BLUE,borderColor:tl.BLUE,borderSize:1,borderStyle:"solid",borderDashedValue:[2,2]},circle:{style:"fill",color:e,borderColor:tl.BLUE,borderSize:1,borderStyle:"solid",borderDashedValue:[2,2]},arc:{style:"solid",color:tl.BLUE,size:1,dashedValue:[2,2]},text:t()}}function B5(){return{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:Jf(tl.BLUE,.08)}}function O5(){return{grid:D5(),candle:E5(),indicator:N5(),xAxis:dy(),yAxis:dy(),separator:B5(),crosshair:j5(),overlay:R5()}}function x1(o,e,t,s){const i=o.result,r=o.figures,a=o.styles,l=Hu(a,"circles",t.circles),c=l.length,d=Hu(a,"bars",t.bars),v=d.length,g=Hu(a,"lines",t.lines),_=g.length;let y=0,k=0,S=0,M,I=0;r.forEach(C=>{var T;switch(C.type){case"circle":{I=y;const z=l[y%c];M={...z,color:z.noChangeColor},y++;break}case"bar":{I=k;const z=d[k%v];M={...z,color:z.noChangeColor},k++;break}case"line":{I=S,M=g[S%_],S++;break}}if(Uo(C.type)){const z=(T=C.styles)==null?void 0:T.call(C,{data:{prev:i[e.prev??""],current:i[e.current??""],next:i[e.next??""]},indicator:o,defaultStyles:t});s(C,{...M,...z},I)}})}class Ah{constructor(e){ve(this,"id");ve(this,"paneId");ve(this,"name");ve(this,"shortName");ve(this,"precision",4);ve(this,"calcParams",[]);ve(this,"shouldOhlc",!1);ve(this,"shouldFormatBigNumber",!1);ve(this,"visible",!0);ve(this,"zLevel",0);ve(this,"extendData");ve(this,"series","normal");ve(this,"figures",[]);ve(this,"minValue",null);ve(this,"maxValue",null);ve(this,"styles",null);ve(this,"shouldUpdate",(e,t)=>{const s=JSON.stringify(e.calcParams)!==JSON.stringify(t.calcParams)||e.figures!==t.figures||e.calc!==t.calc,i=s||e.shortName!==t.shortName||e.series!==t.series||e.minValue!==t.minValue||e.maxValue!==t.maxValue||e.precision!==t.precision||e.shouldOhlc!==t.shouldOhlc||e.shouldFormatBigNumber!==t.shouldFormatBigNumber||e.visible!==t.visible||e.zLevel!==t.zLevel||e.extendData!==t.extendData||e.regenerateFigures!==t.regenerateFigures||e.createTooltipDataSource!==t.createTooltipDataSource||e.draw!==t.draw;return{calc:s,draw:i}});ve(this,"calc",()=>({}));ve(this,"regenerateFigures",null);ve(this,"createTooltipDataSource",null);ve(this,"draw",null);ve(this,"onDataStateChange",null);ve(this,"result",{});ve(this,"_prevIndicator");ve(this,"_lockSeriesPrecision",!1);this.override(e),this._lockSeriesPrecision=!1}override(e){const{result:t,...s}=this;this._prevIndicator={...Nm(s),result:t};const{id:i,name:r,shortName:a,precision:l,styles:c,figures:d,calcParams:v,...g}=e;!pd(this.id)&&pd(i)&&(this.id=i),pd(this.name)||(this.name=r??""),this.shortName=a??this.shortName??this.name,ja(l)&&(this.precision=l,this._lockSeriesPrecision=!0),Uo(c)&&(this.styles??(this.styles={}),Ru(this.styles,c)),Ru(this,g),Uo(v)&&(this.calcParams=v,Vp(this.regenerateFigures)&&(this.figures=this.regenerateFigures(this.calcParams))),this.figures=d??this.figures}setSeriesPrecision(e){this._lockSeriesPrecision||(this.precision=e)}shouldUpdateImp(){const e=this._prevIndicator.zLevel!==this.zLevel,t=this.shouldUpdate(this._prevIndicator,this);return $0(t)?{calc:t,draw:t,sort:e}:{...t,sort:e}}async calcImp(e){try{const t=await this.calc(e,this);return this.result=t,!0}catch{return!1}}static extend(e){class t extends Ah{constructor(){super(e)}}return t}}const V5={name:"AVP",shortName:"AVP",series:"price",precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:o=>{let e=0,t=0;return o.reduce((s,i)=>{const r={},a=i.turnover??0,l=i.volume??0;return e+=a,t+=l,t!==0&&(r.avp=e/t),s[i.timestamp]=r,s},{})}},W5={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:({data:o,indicator:e,defaultStyles:t})=>{const{prev:s,current:i}=o,r=(s==null?void 0:s.ao)??Number.MIN_SAFE_INTEGER,a=(i==null?void 0:i.ao)??Number.MIN_SAFE_INTEGER;let l="";a>r?l=Hu(e.styles,"bars[0].upColor",t.bars[0].upColor):l=Hu(e.styles,"bars[0].downColor",t.bars[0].downColor);const c=a>r?"stroke":"fill";return{color:l,style:c,borderColor:l}}}],calc:(o,e)=>{const t=e.calcParams,s=Math.max(t[0],t[1]);let i=0,r=0,a=0,l=0;return o.reduce((c,d,v)=>{const g={},_=(d.low+d.high)/2;if(i+=_,r+=_,v>=t[0]-1){a=i/t[0];const y=o[v-(t[0]-1)];i-=(y.low+y.high)/2}if(v>=t[1]-1){l=r/t[1];const y=o[v-(t[1]-1)];r-=(y.low+y.high)/2}return v>=s-1&&(g.ao=a-l),c[d.timestamp]=g,c},{})}},q5={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`bias${t+1}`,title:`BIAS${e}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[];return o.reduce((r,a,l)=>{const c={},d=a.close;return t.forEach((v,g)=>{if(i[g]=(i[g]??0)+d,l>=v-1){const _=i[g]/t[g];c[s[g].key]=(d-_)/_*100,i[g]-=o[l-(v-1)].close}}),r[a.timestamp]=c,r},{})}};function H5(o,e){const t=o.length;let s=0;return o.forEach(i=>{const r=i.close-e;s+=r*r}),s=Math.abs(s),Math.sqrt(s/t)}const G5={name:"BOLL",shortName:"BOLL",series:"price",calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=t[0]-1;let i=0;return o.reduce((r,a,l)=>{const c=a.close,d={};if(i+=c,l>=s){d.mid=i/t[0];const v=H5(o.slice(l-s,l+1),d.mid);d.up=d.mid+t[1]*v,d.dn=d.mid-t[1]*v,i-=o[l-s].close}return r[a.timestamp]=d,r},{})}},U5={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0;return o.reduce((l,c,d)=>{const v={},g=c.high,_=c.low,y=c.open,k=(o[d-1]??c).close;if(r+=g-y,a+=y-_,s+=g-k,i+=k-_,d>=t[0]-1){a!==0?v.ar=r/a*100:v.ar=0,i!==0?v.br=s/i*100:v.br=0;const S=o[d-(t[0]-1)],M=S.high,I=S.low,C=S.open,T=(o[d-t[0]]??o[d-(t[0]-1)]).close;s-=M-T,i-=T-I,r-=M-C,a-=C-I}return l[c.timestamp]=v,l},{})}},Y5={name:"BBI",shortName:"BBI",series:"price",precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=Math.max(...t),i=[],r=[];return o.reduce((a,l,c)=>{const d={},v=l.close;if(t.forEach((g,_)=>{i[_]=(i[_]??0)+v,c>=g-1&&(r[_]=i[_]/g,i[_]-=o[c-(g-1)].close)}),c>=s-1){let g=0;r.forEach(_=>{g+=_}),d.bbi=g/4}return a[l.timestamp]=d,a},{})}},K5={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=t[0]-1;let i=0;const r=[];return o.reduce((a,l,c)=>{const d={},v=(l.high+l.low+l.close)/3;if(i+=v,r.push(v),c>=s){const g=i/t[0],_=r.slice(c-s,c+1);let y=0;_.forEach(M=>{y+=Math.abs(M-g)});const k=y/t[0];d.cci=k!==0?(v-g)/k/.015:0;const S=(o[c-s].high+o[c-s].low+o[c-s].close)/3;i-=S}return a[l.timestamp]=d,a},{})}},Z5={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=Math.ceil(t[1]/2.5+1),i=Math.ceil(t[2]/2.5+1),r=Math.ceil(t[3]/2.5+1),a=Math.ceil(t[4]/2.5+1);let l=0;const c=[];let d=0;const v=[];let g=0;const _=[];let y=0;const k=[],S=[],M={};return o.forEach((I,C)=>{const T={},z=o[C-1]??I,j=(z.high+z.close+z.low+z.open)/4,B=Math.max(0,I.high-j),$=Math.max(0,j-I.low);C>=t[0]-1&&($!==0?T.cr=B/$*100:T.cr=0,l+=T.cr,d+=T.cr,g+=T.cr,y+=T.cr,C>=t[0]+t[1]-2&&(c.push(l/t[1]),C>=t[0]+t[1]+s-3&&(T.ma1=c[c.length-1-s]),l-=S[C-(t[1]-1)].cr??0),C>=t[0]+t[2]-2&&(v.push(d/t[2]),C>=t[0]+t[2]+i-3&&(T.ma2=v[v.length-1-i]),d-=S[C-(t[2]-1)].cr??0),C>=t[0]+t[3]-2&&(_.push(g/t[3]),C>=t[0]+t[3]+r-3&&(T.ma3=_[_.length-1-r]),g-=S[C-(t[3]-1)].cr??0),C>=t[0]+t[4]-2&&(k.push(y/t[4]),C>=t[0]+t[4]+a-3&&(T.ma4=k[k.length-1-a]),y-=S[C-(t[4]-1)].cr??0)),S.push(T),M[I.timestamp]=T}),M}},X5={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=Math.max(t[0],t[1]);let i=0,r=0,a=0;const l=[],c={};return o.forEach((d,v)=>{const g={},_=d.close;i+=_,r+=_;let y=0,k=0;if(v>=t[0]-1&&(y=i/t[0],i-=o[v-(t[0]-1)].close),v>=t[1]-1&&(k=r/t[1],r-=o[v-(t[1]-1)].close),v>=s-1){const S=y-k;g.dma=S,a+=S,v>=s+t[2]-2&&(g.ama=a/t[2],a-=l[v-(t[2]-1)].dma??0)}l.push(g),c[d.timestamp]=g}),c}},J5={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0,l=0,c=0,d=0,v=0;const g=[],_={};return o.forEach((y,k)=>{const S={},M=o[k-1]??y,I=M.close,C=y.high,T=y.low,z=C-T,j=Math.abs(C-I),B=Math.abs(I-T),$=C-M.high,F=M.low-T,V=Math.max(Math.max(z,j),B),K=$>0&&$>F?$:0,Y=F>0&&F>$?F:0;if(s+=V,i+=K,r+=Y,k>=t[0]-1){k>t[0]-1?(a=a-a/t[0]+V,l=l-l/t[0]+K,c=c-c/t[0]+Y):(a=s,l=i,c=r);let Z=0,ne=0;a!==0&&(Z=l*100/a,ne=c*100/a),S.pdi=Z,S.mdi=ne;let te=0;ne+Z!==0&&(te=Math.abs(ne-Z)/(ne+Z)*100),d+=te,k>=t[0]*2-2&&(k>t[0]*2-2?v=(v*(t[0]-1)+te)/t[0]:v=d/t[0],S.adx=v,k>=t[0]*2+t[1]-3&&(S.adxr=((g[k-(t[1]-1)].adx??0)+v)/2))}g.push(S),_[y.timestamp]=S}),_}},Q5={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0;const i=[];return o.reduce((r,a,l)=>{const c={};if(l>0){const d=o[l-1],v=a.high,g=a.low,_=a.volume??0,y=(v+g)/2-(d.high+d.low)/2;if(_===0||v-g===0)c.emv=0;else{const k=_/1e8/(v-g);c.emv=y/k}s+=c.emv,i.push(c.emv),l>=t[0]&&(c.maEmv=s/t[0],s-=i[l-t[0]])}return r[a.timestamp]=c,r},{})}},e6={name:"EMA",shortName:"EMA",series:"price",calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`ema${t+1}`,title:`EMA${e}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e;let i=0;const r=[];return o.reduce((a,l,c)=>{const d={},v=l.close;return i+=v,t.forEach((g,_)=>{c>=g-1&&(c>g-1?r[_]=(2*v+(g-1)*r[_])/(g+1):r[_]=i/g,d[s[_].key]=r[_])}),a[l.timestamp]=d,a},{})}},t6={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0;const i=[],r={};return o.forEach((a,l)=>{const c={};if(l>=t[0]){const d=a.close,v=o[l-t[0]].close;c.mtm=d-v,s+=c.mtm,l>=t[0]+t[1]-1&&(c.maMtm=s/t[1],s-=i[l-(t[1]-1)].mtm??0)}i.push(c),r[a.timestamp]=c}),r}},o6={name:"MA",shortName:"MA",series:"price",calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA30: ",type:"line"},{key:"ma4",title:"MA60: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`ma${t+1}`,title:`MA${e}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[];return o.reduce((r,a,l)=>{const c={},d=a.close;return t.forEach((v,g)=>{i[g]=(i[g]??0)+d,l>=v-1&&(c[s[g].key]=i[g]/v,i[g]-=o[l-(v-1)].close)}),r[a.timestamp]=c,r},{})}},s6={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:({data:o,indicator:e,defaultStyles:t})=>{const{prev:s,current:i}=o,r=(s==null?void 0:s.macd)??Number.MIN_SAFE_INTEGER,a=(i==null?void 0:i.macd)??Number.MIN_SAFE_INTEGER;let l="";return a>0?l=Hu(e.styles,"bars[0].upColor",t.bars[0].upColor):a<0?l=Hu(e.styles,"bars[0].downColor",t.bars[0].downColor):l=Hu(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor),{style:r<a?"stroke":"fill",color:l,borderColor:l}}}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0,l=0,c=0;const d=Math.max(t[0],t[1]);return o.reduce((v,g,_)=>{const y={},k=g.close;return s+=k,_>=t[0]-1&&(_>t[0]-1?i=(2*k+(t[0]-1)*i)/(t[0]+1):i=s/t[0]),_>=t[1]-1&&(_>t[1]-1?r=(2*k+(t[1]-1)*r)/(t[1]+1):r=s/t[1]),_>=d-1&&(a=i-r,y.dif=a,l+=a,_>=d+t[2]-2&&(_>d+t[2]-2?c=(a*2+c*(t[2]-1))/(t[2]+1):c=l/t[2],y.macd=(a-c)*2,y.dea=c)),v[g.timestamp]=y,v},{})}},n6={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0;const r=[],a={};return o.forEach((l,c)=>{const d=o[c-1]??l;l.close<d.close?i-=l.volume??0:l.close>d.close&&(i+=l.volume??0);const v={obv:i};s+=i,c>=t[0]-1&&(v.maObv=s/t[0],s-=r[c-(t[0]-1)].obv??0),r.push(v),a[l.timestamp]=v}),a}},i6={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:o=>{let e=0;return o.reduce((t,s,i)=>{const r={},a=s.close,l=s.volume??1,c=(o[i-1]??s).close;let d=0;const v=c*l;return v!==0&&(d=(a-c)/v),e+=d,r.pvt=e,t[s.timestamp]=r,t},{})}},r6={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0;const r=[],a=[],l={};return o.forEach((c,d)=>{const v={},g=(o[d-1]??c).close,_=c.close-g>0?1:0;r.push(_),s+=_,d>=t[0]-1&&(v.psy=s/t[0]*100,i+=v.psy,d>=t[0]+t[1]-2&&(v.maPsy=i/t[1],i-=a[d-(t[1]-1)].psy??0),s-=r[d-(t[0]-1)]),a.push(v),l[c.timestamp]=v}),l}},a6={name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=[],i={};let r=0;return o.forEach((a,l)=>{const c={};if(l>=t[0]-1){const d=a.close,v=(o[l-t[0]]??o[l-(t[0]-1)]).close;v!==0?c.roc=(d-v)/v*100:c.roc=0,r+=c.roc,l>=t[0]-1+t[1]-1&&(c.maRoc=r/t[1],r-=s[l-(t[1]-1)].roc??0)}s.push(c),i[a.timestamp]=c}),i}},l6={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>{const s=t+1;return{key:`rsi${s}`,title:`RSI${s}: `,type:"line"}}),calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[],r=[];return o.reduce((a,l,c)=>{const d={},v=(o[c-1]??l).close,g=l.close-v;return t.forEach((_,y)=>{if(g>0?i[y]=(i[y]??0)+g:r[y]=(r[y]??0)+Math.abs(g),c>=_-1){r[y]!==0?d[s[y].key]=100-100/(1+i[y]/r[y]):d[s[y].key]=0;const k=o[c-(_-1)],S=o[c-_]??k,M=k.close-S.close;M>0?i[y]-=M:r[y]-=Math.abs(M)}}),a[l.timestamp]=d,a},{})}},c6={name:"SMA",shortName:"SMA",series:"price",calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:(o,e)=>{const t=e.calcParams;let s=0,i=0;return o.reduce((r,a,l)=>{const c={},d=a.close;return s+=d,l>=t[0]-1&&(l>t[0]-1?i=(d*t[1]+i*(t[0]-t[1]+1))/(t[0]+1):i=s/t[0],c.sma=i),r[a.timestamp]=c,r},{})}},d6={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=[],i={};return o.forEach((r,a)=>{var d,v;const l={},c=r.close;if(a>=t[0]-1){const g=eb(o.slice(a-(t[0]-1),a+1),"high","low"),_=g[0],y=g[1],k=_-y,S=(c-y)/(k===0?1:k)*100;l.k=((t[1]-1)*(((d=s[a-1])==null?void 0:d.k)??50)+S)/t[1],l.d=((t[2]-1)*(((v=s[a-1])==null?void 0:v.d)??50)+l.k)/t[2],l.j=3*l.k-2*l.d}s.push(l),i[r.timestamp]=l}),i}},u6={name:"SAR",shortName:"SAR",series:"price",calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:({data:o,indicator:e,defaultStyles:t})=>{const{current:s}=o,i=(s==null?void 0:s.sar)??Number.MIN_SAFE_INTEGER,r=(((s==null?void 0:s.high)??0)+((s==null?void 0:s.low)??0))/2;return{color:i<r?Hu(e.styles,"circles[0].upColor",t.circles[0].upColor):Hu(e.styles,"circles[0].downColor",t.circles[0].downColor)}}}],calc:(o,e)=>{const t=e.calcParams,s=t[0]/100,i=t[1]/100,r=t[2]/100;let a=s,l=-100,c=!1,d=0;return o.reduce((v,g,_)=>{const y=d,k=g.high,S=g.low;if(c){(l===-100||l<k)&&(l=k,a=Math.min(a+i,r)),d=y+a*(l-y);const M=Math.min(o[Math.max(1,_)-1].low,S);d>g.low?(d=l,a=s,l=-100,c=!c):d>M&&(d=M)}else{(l===-100||l>S)&&(l=S,a=Math.min(a+i,r)),d=y+a*(l-y);const M=Math.max(o[Math.max(1,_)-1].high,k);d<g.high?(d=l,a=0,l=-100,c=!c):d<M&&(d=M)}return v[g.timestamp]={high:k,low:S,sar:d},v},{})}},p6={name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0,l=0,c=0,d=0;const v=[],g={};return o.forEach((_,y)=>{const k={},S=_.close;if(s+=S,y>=t[0]-1&&(y>t[0]-1?i=(2*S+(t[0]-1)*i)/(t[0]+1):i=s/t[0],l+=i,y>=t[0]*2-2&&(y>t[0]*2-2?r=(2*i+(t[0]-1)*r)/(t[0]+1):r=l/t[0],c+=r,y>=t[0]*3-3))){let M=0,I=0;y>t[0]*3-3?(M=(2*r+(t[0]-1)*a)/(t[0]+1),I=(M-a)/a*100):M=c/t[0],a=M,k.trix=I,d+=I,y>=t[0]*3+t[1]-4&&(k.maTrix=d/t[1],d-=v[y-(t[1]-1)].trix??0)}v.push(k),g[_.timestamp]=k}),g}};function uy(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:({data:o,indicator:e,defaultStyles:t})=>{const s=o.current;let i=Hu(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor);return Uo(s)&&(s.close>s.open?i=Hu(e.styles,"bars[0].upColor",t.bars[0].upColor):s.close<s.open&&(i=Hu(e.styles,"bars[0].downColor",t.bars[0].downColor))),{color:i}}}}const v6={name:"VOL",shortName:"VOL",series:"volume",calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},uy()],regenerateFigures:o=>{const e=o.map((t,s)=>({key:`ma${s+1}`,title:`MA${t}: `,type:"line"}));return e.push(uy()),e},calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[];return o.reduce((r,a,l)=>{const c=a.volume??0,d={volume:c,open:a.open,close:a.close};return t.forEach((v,g)=>{i[g]=(i[g]??0)+c,l>=v-1&&(d[s[g].key]=i[g]/v,i[g]-=o[l-(v-1)].volume??0)}),r[a.timestamp]=d,r},{})}},f6={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0;const l=[],c={};return o.forEach((d,v)=>{const g={},_=d.close,y=(o[v-1]??d).close,k=d.volume??0;if(_>y?s+=k:_<y?i+=k:r+=k,v>=t[0]-1){const S=r/2;i+S===0?g.vr=0:g.vr=(s+S)/(i+S)*100,a+=g.vr,v>=t[0]+t[1]-2&&(g.maVr=a/t[1],a-=l[v-(t[1]-1)].vr??0);const M=o[v-(t[0]-1)],I=o[v-t[0]]??M,C=M.close,T=M.volume??0;C>I.close?s-=T:C<I.close?i-=T:r-=T}l.push(g),c[d.timestamp]=g}),c}},m6={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`wr${t+1}`,title:`WR${t+1}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e;return o.reduce((i,r,a)=>{const l={},c=r.close;return t.forEach((d,v)=>{const g=d-1;if(a>=g){const _=eb(o.slice(a-g,a+1),"high","low"),y=_[0],k=_[1],S=y-k;l[s[v].key]=S===0?0:(c-y)/S*100}}),i[r.timestamp]=l,i},{})}},w1={},g6=[V5,W5,q5,G5,U5,Y5,K5,Z5,X5,J5,Q5,e6,t6,o6,s6,n6,i6,r6,a6,l6,c6,d6,u6,p6,v6,f6,m6];g6.forEach(o=>{w1[o.name]=Ah.extend(o)});function x_(o){w1[o.name]=Ah.extend(o)}function tb(o){return w1[o]??null}function Dv(o,e){const t=(e==null?void 0:e.ignoreEvent)??!1;return $0(t)?!t:!t.includes(o)}const py=1,m0=-1,h6="overlay_",km="overlay_figure_";class Lh{constructor(e){ve(this,"id");ve(this,"groupId","");ve(this,"paneId");ve(this,"name");ve(this,"totalStep",1);ve(this,"currentStep",py);ve(this,"lock",!1);ve(this,"visible",!0);ve(this,"zLevel",0);ve(this,"needDefaultPointFigure",!1);ve(this,"needDefaultXAxisFigure",!1);ve(this,"needDefaultYAxisFigure",!1);ve(this,"mode","normal");ve(this,"modeSensitivity",8);ve(this,"points",[]);ve(this,"extendData");ve(this,"styles",null);ve(this,"createPointFigures",null);ve(this,"createXAxisFigures",null);ve(this,"createYAxisFigures",null);ve(this,"performEventPressedMove",null);ve(this,"performEventMoveForDrawing",null);ve(this,"onDrawStart",null);ve(this,"onDrawing",null);ve(this,"onDrawEnd",null);ve(this,"onClick",null);ve(this,"onDoubleClick",null);ve(this,"onRightClick",null);ve(this,"onPressedMoveStart",null);ve(this,"onPressedMoving",null);ve(this,"onPressedMoveEnd",null);ve(this,"onMouseMove",null);ve(this,"onMouseEnter",null);ve(this,"onMouseLeave",null);ve(this,"onRemoved",null);ve(this,"onSelected",null);ve(this,"onDeselected",null);ve(this,"_prevZLevel",0);ve(this,"_prevOverlay");ve(this,"_prevPressedPoint",null);ve(this,"_prevPressedPoints",[]);this.override(e)}override(e){var c;this._prevOverlay=Nm(this);const{id:t,name:s,currentStep:i,points:r,styles:a,...l}=e;if(Ru(this,l),pd(this.name)||(this.name=s??""),!pd(this.id)&&pd(t)&&(this.id=t),Uo(a)&&(this.styles??(this.styles={}),Ru(this.styles,a)),Ov(r)&&r.length>0){let d=0;if(this.points=[...r],r.length>=this.totalStep-1?(this.currentStep=m0,d=this.totalStep-1):(this.currentStep=r.length+1,d=r.length),Vp(this.performEventMoveForDrawing))for(let v=0;v<d;v++)this.performEventMoveForDrawing({currentStep:v+2,mode:this.mode,points:this.points,performPointIndex:v,performPoint:this.points[v]});this.currentStep===m0&&((c=this.performEventPressedMove)==null||c.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}))}}getPrevZLevel(){return this._prevZLevel}setPrevZLevel(e){this._prevZLevel=e}shouldUpdate(){const e=this._prevOverlay.zLevel!==this.zLevel,t=e||JSON.stringify(this._prevOverlay.points)!==JSON.stringify(this.points)||this._prevOverlay.visible!==this.visible||this._prevOverlay.extendData!==this.extendData||this._prevOverlay.styles!==this.styles;return{sort:e,draw:t}}nextStep(){this.currentStep===this.totalStep-1?this.currentStep=m0:this.currentStep++}forceComplete(){this.currentStep=m0}isDrawing(){return this.currentStep!==m0}isStart(){return this.currentStep===py}eventMoveForDrawing(e){var i;const t=this.currentStep-1,s={};ja(e.timestamp)&&(s.timestamp=e.timestamp),ja(e.dataIndex)&&(s.dataIndex=e.dataIndex),ja(e.value)&&(s.value=e.value),this.points[t]=s,(i=this.performEventMoveForDrawing)==null||i.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:t,performPoint:s})}eventPressedPointMove(e,t){var s;this.points[t].timestamp=e.timestamp,ja(e.value)&&(this.points[t].value=e.value),(s=this.performEventPressedMove)==null||s.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:t,performPoint:this.points[t]})}startPressedMove(e){this._prevPressedPoint={...e},this._prevPressedPoints=Nm(this.points)}eventPressedOtherMove(e,t){if(this._prevPressedPoint!==null){let s=null;ja(e.dataIndex)&&ja(this._prevPressedPoint.dataIndex)&&(s=e.dataIndex-this._prevPressedPoint.dataIndex);let i=null;ja(e.value)&&ja(this._prevPressedPoint.value)&&(i=e.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(r=>{ja(r.timestamp)&&(r.dataIndex=t.timestampToDataIndex(r.timestamp));const a={...r};return ja(s)&&ja(r.dataIndex)&&(a.dataIndex=r.dataIndex+s,a.timestamp=t.dataIndexToTimestamp(a.dataIndex)??void 0),ja(i)&&ja(r.value)&&(a.value=r.value+i),a})}}static extend(e){class t extends Lh{constructor(){super(e)}}return t}}const _6={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({chart:o,coordinates:e,bounding:t,overlay:s,yAxis:i})=>{var a;const r=s.points;if(e.length>0){let l=0;(i==null?void 0:i.isInCandle())??!0?l=((a=o.getSymbol())==null?void 0:a.pricePrecision)??gp.PRICE:o.getIndicators({paneId:s.paneId}).forEach(y=>{l=Math.max(l,y.precision)});const c=[],d=[],v=0,g=t.width;if(e.length>1&&ja(r[0].value)&&ja(r[1].value)){const _=[1,.786,.618,.5,.382,.236,0],y=e[0].y-e[1].y,k=r[0].value-r[1].value;_.forEach(S=>{const M=e[1].y+y*S,I=o.getDecimalFold().format(o.getThousandsSeparator().format(((r[1].value??0)+k*S).toFixed(l)));c.push({coordinates:[{x:v,y:M},{x:g,y:M}]}),d.push({x:v,y:M,text:`${I} (${(S*100).toFixed(1)}%)`,baseline:"bottom"})})}return[{type:"line",attrs:c},{type:"text",isCheckEvent:!1,attrs:d}]}return[]}},y6={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>{const t={x:0,y:o[0].y};return Uo(o[1])&&o[0].x<o[1].x&&(t.x=e.width),[{type:"line",attrs:{coordinates:[o[0],t]}}]},performEventPressedMove:({points:o,performPoint:e})=>{o[0].value=e.value,o[1].value=e.value},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].value=t.value)}},b6={name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=[];return o.length===2&&e.push({coordinates:o}),[{type:"line",attrs:e}]},performEventPressedMove:({points:o,performPoint:e})=>{o[0].value=e.value,o[1].value=e.value},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].value=t.value)}},x6={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:{coordinates:[{x:0,y:o[0].y},{x:e.width,y:o[0].y}]}}]};class k1{constructor(){ve(this,"_children",[]);ve(this,"_callbacks",new Map)}registerEvent(e,t){return this._callbacks.set(e,t),this}onEvent(e,t){const s=this._callbacks.get(e);return Uo(s)&&this.checkEventOn(t)?s(t):!1}dispatchEventToChildren(e,t){const s=this._children.length-1;if(s>-1){for(let i=s;i>-1;i--)if(this._children[i].dispatchEvent(e,t))return!0}return!1}dispatchEvent(e,t){return this.dispatchEventToChildren(e,t)?!0:this.onEvent(e,t)}addChild(e){return this._children.push(e),this}clear(){this._children=[]}}const tp=2;class zh extends k1{constructor(t){super();ve(this,"attrs");ve(this,"styles");this.attrs=t.attrs,this.styles=t.styles}checkEventOn(t){return this.checkEventOnImp(t,this.attrs,this.styles)}setAttrs(t){return this.attrs=t,this}setStyles(t){return this.styles=t,this}draw(t){this.drawImp(t,this.attrs,this.styles)}static extend(t){class s extends zh{checkEventOnImp(r,a,l){return t.checkEventOn(r,a,l)}drawImp(r,a,l){t.draw(r,a,l)}}return s}}function ob(o,e){let t=[];t=t.concat(e);for(const s of t){const{coordinates:i}=s;if(i.length>1)for(let r=1;r<i.length;r++){const a=i[r-1],l=i[r];if(a.x===l.x){if(Math.abs(a.y-o.y)+Math.abs(l.y-o.y)-Math.abs(a.y-l.y)<tp+tp&&Math.abs(o.x-a.x)<tp)return!0}else{const c=Fh(a,l),d=S1(c,o),v=Math.abs(d-o.y);if(Math.abs(a.x-o.x)+Math.abs(l.x-o.x)-Math.abs(a.x-l.x)<tp+tp&&v*v/(c[0]*c[0]+1)<tp*tp)return!0}}}return!1}function S1(o,e){return o!==null?e.x*o[0]+o[1]:e.y}function D0(o,e,t){const s=Fh(o,e);return S1(s,t)}function Fh(o,e){const t=o.x-e.x;if(t!==0){const s=(o.y-e.y)/t,i=o.y-s*o.x;return[s,i]}return null}function sb(o,e,t){const s=e.length,i=ja(t)?t>0&&t<1?t:0:t?.5:0;if(i>0&&s>2){let r=e[0].x,a=e[0].y;for(let c=1;c<s-1;c++){const d=e[c-1],v=e[c],g=e[c+1],_=v.x-d.x,y=v.y-d.y,k=g.x-v.x,S=g.y-v.y;let M=g.x-d.x,I=g.y-d.y;const C=Math.sqrt(_*_+y*y),T=Math.sqrt(k*k+S*S),z=T/(T+C);let j=v.x+M*i*z,B=v.y+I*i*z;j=Math.min(j,Math.max(g.x,v.x)),B=Math.min(B,Math.max(g.y,v.y)),j=Math.max(j,Math.min(g.x,v.x)),B=Math.max(B,Math.min(g.y,v.y)),M=j-v.x,I=B-v.y;let $=v.x-M*C/T,F=v.y-I*C/T;$=Math.min($,Math.max(d.x,v.x)),F=Math.min(F,Math.max(d.y,v.y)),$=Math.max($,Math.min(d.x,v.x)),F=Math.max(F,Math.min(d.y,v.y)),M=v.x-$,I=v.y-F,j=v.x+M*T/C,B=v.y+I*T/C,o.bezierCurveTo(r,a,$,F,v.x,v.y),r=j,a=B}const l=e[s-1];o.bezierCurveTo(r,a,l.x,l.y,l.x,l.y)}else for(let r=1;r<s;r++)o.lineTo(e[r].x,e[r].y)}function w6(o,e,t){let s=[];s=s.concat(e);const{style:i="solid",smooth:r=!1,size:a=1,color:l="currentColor",dashedValue:c=[2,2]}=t;o.lineWidth=a,o.strokeStyle=l,i==="dashed"?o.setLineDash(c):o.setLineDash([]);const d=a%2===1?.5:0;s.forEach(({coordinates:v})=>{v.length>1&&(v.length===2&&(v[0].x===v[1].x||v[0].y===v[1].y)?(o.beginPath(),v[0].x===v[1].x?(o.moveTo(v[0].x+d,v[0].y),o.lineTo(v[1].x+d,v[1].y)):(o.moveTo(v[0].x,v[0].y+d),o.lineTo(v[1].x,v[1].y+d)),o.stroke(),o.closePath()):(o.save(),a%2===1&&o.translate(.5,.5),o.beginPath(),o.moveTo(v[0].x,v[0].y),sb(o,v,r),o.stroke(),o.closePath(),o.restore()))})}const k6={name:"line",checkEventOn:ob,draw:(o,e,t)=>{w6(o,e,t)}};function nb(o,e,t){const s=t??0,i=[];if(o.length>1)if(o[0].x===o[1].x){const a=e.height;if(i.push({coordinates:[{x:o[0].x,y:0},{x:o[0].x,y:a}]}),o.length>2){i.push({coordinates:[{x:o[2].x,y:0},{x:o[2].x,y:a}]});const l=o[0].x-o[2].x;for(let c=0;c<s;c++){const d=l*(c+1);i.push({coordinates:[{x:o[0].x+d,y:0},{x:o[0].x+d,y:a}]})}}}else{const a=e.width,l=Fh(o[0],o[1]),c=l[0],d=l[1];if(i.push({coordinates:[{x:0,y:0*c+d},{x:a,y:a*c+d}]}),o.length>2){const v=o[2].y-c*o[2].x;i.push({coordinates:[{x:0,y:0*c+v},{x:a,y:a*c+v}]});const g=d-v;for(let _=0;_<s;_++){const y=d+g*(_+1);i.push({coordinates:[{x:0,y:0*c+y},{x:a,y:a*c+y}]})}}}return i}const S6={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:nb(o,e)}]},C6={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:nb(o,e,1)}]},P6={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({chart:o,coordinates:e,bounding:t,overlay:s,yAxis:i})=>{var l;let r=0;(i==null?void 0:i.isInCandle())??!0?r=((l=o.getSymbol())==null?void 0:l.pricePrecision)??gp.PRICE:o.getIndicators({paneId:s.paneId}).forEach(d=>{r=Math.max(r,d.precision)});const{value:a=0}=s.points[0];return[{type:"line",attrs:{coordinates:[e[0],{x:t.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:o.getDecimalFold().format(o.getThousandsSeparator().format(a.toFixed(r))),baseline:"bottom"}}]}};function I6(o,e){if(o.length>1){let t={x:0,y:0};return o[0].x===o[1].x&&o[0].y!==o[1].y?o[0].y<o[1].y?t={x:o[0].x,y:e.height}:t={x:o[0].x,y:0}:o[0].x>o[1].x?t={x:0,y:D0(o[0],o[1],{x:0,y:o[0].y})}:t={x:e.width,y:D0(o[0],o[1],{x:e.width,y:o[0].y})},{coordinates:[o[0],t]}}return[]}const M6={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:I6(o,e)}]},T6={name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>o.length===2?[{type:"line",attrs:{coordinates:o}}]:[]},A6={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>o.length===2?o[0].x===o[1].x?[{type:"line",attrs:{coordinates:[{x:o[0].x,y:0},{x:o[0].x,y:e.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:D0(o[0],o[1],{x:0,y:o[0].y})},{x:e.width,y:D0(o[0],o[1],{x:e.width,y:o[0].y})}]}}]:[]},L6={name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>{if(o.length===2){const t={x:o[0].x,y:0};return o[0].y<o[1].y&&(t.y=e.height),[{type:"line",attrs:{coordinates:[o[0],t]}}]}return[]},performEventPressedMove:({points:o,performPoint:e})=>{o[0].timestamp=e.timestamp,o[0].dataIndex=e.dataIndex,o[1].timestamp=e.timestamp,o[1].dataIndex=e.dataIndex},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},z6={name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>o.length===2?[{type:"line",attrs:{coordinates:o}}]:[],performEventPressedMove:({points:o,performPoint:e})=>{o[0].timestamp=e.timestamp,o[0].dataIndex=e.dataIndex,o[1].timestamp=e.timestamp,o[1].dataIndex=e.dataIndex},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},F6={name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:{coordinates:[{x:o[0].x,y:0},{x:o[0].x,y:e.height}]}}]},$6={name:"simpleAnnotation",totalStep:2,styles:{line:{style:"dashed"}},createPointFigures:({overlay:o,coordinates:e})=>{let t="";Uo(o.extendData)&&(Vp(o.extendData)?t=o.extendData(o):t=o.extendData??"");const s=e[0].x,i=e[0].y-6,r=i-50,a=r-5;return[{type:"line",attrs:{coordinates:[{x:s,y:i},{x:s,y:r}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:s,y:r},{x:s-4,y:a},{x:s+4,y:a}]},ignoreEvent:!0},{type:"text",attrs:{x:s,y:a,text:t,align:"center",baseline:"bottom"},ignoreEvent:!0}]}},D6={name:"simpleTag",totalStep:2,styles:{line:{style:"dashed"}},createPointFigures:({bounding:o,coordinates:e})=>({type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:o.width,y:e[0].y}]},ignoreEvent:!0}),createYAxisFigures:({chart:o,overlay:e,coordinates:t,bounding:s,yAxis:i})=>{var d;const r=(i==null?void 0:i.isFromZero())??!1;let a="left",l=0;r?(a="left",l=0):(a="right",l=s.width);let c="";return Uo(e.extendData)&&(Vp(e.extendData)?c=e.extendData(e):c=e.extendData??""),!Uo(c)&&ja(e.points[0].value)&&(c=vp(e.points[0].value,((d=o.getSymbol())==null?void 0:d.pricePrecision)??gp.PRICE)),{type:"text",attrs:{x:l,y:t[0].y,text:c,align:a,baseline:"middle"}}}},C1={},E6=[_6,y6,b6,x6,S6,C6,P6,M6,T6,A6,L6,z6,F6,$6,D6];E6.forEach(o=>{C1[o.name]=Lh.extend(o)});function ib(o){C1[o.name]=Lh.extend(o)}function N6(o){return C1[o]??null}const j6={grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},title:{color:"#76808F"},legend:{color:"#76808F"}}},indicator:{tooltip:{title:{color:"#76808F"},legend:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},R6={grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},title:{color:"#929AA5"},legend:{color:"#929AA5"}}},indicator:{tooltip:{title:{color:"#929AA5"},legend:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}},B6={light:j6,dark:R6};function O6(o){return B6[o]??null}const ah=30,rb=100,pc={CANDLE:"candle_pane",INDICATOR:"indicator_pane_",X_AXIS:"x_axis_pane"},vy={MIN:1,MAX:500},V6=10,W6=80,q6=.2,i1=10,Xd=24*60*60*1e3;function w_(o){if(o.length===0)return 0;const e=o.slice().sort((t,s)=>t-s);return e[Math.floor(e.length/2)]}function k_(o,e){if(o.length===0)return 0;const t=Math.max(0,Math.min(1,e)),s=Math.floor(t*(o.length-1));return o[s]}function H6(o){if(o.length===0)return 0;let e=0,t=0;for(const r of o){const a=2*Math.PI*(r/Xd);e+=Math.sin(a),t+=Math.cos(a)}const s=Math.atan2(e/o.length,t/o.length);return(s<0?s+2*Math.PI:s)/(2*Math.PI)*Xd}function vm(o,e){return Math.floor((o-e)/Xd)*Xd+e}function Rm(o){return new Date(o).getUTCDay()}function ab(o,e,t){if(e<=0)return 0;const s=t.reduce((l,c)=>l+(c?1:0),0);if(s<=0)return 0;let r=Math.floor(e/7)*s;const a=e%7;for(let l=0;l<a;l++){const c=(o+1+l)%7;t[c]&&r++}return r}function G6(o,e,t){if(e<=0)return 0;const s=t.reduce((l,c)=>l+(c?1:0),0);if(s<=0)return 0;let r=Math.floor(e/7)*s;const a=e%7;for(let l=0;l<a;l++){const c=(o+7-(1+l)%7)%7;t[c]&&r++}return r}function U6(o){try{if(!Array.isArray(o)||o.length<20)return null;const e=o.slice(Math.max(0,o.length-2500)),t=[];for(const z of e){const j=z==null?void 0:z.timestamp;typeof j=="number"&&isFinite(j)&&t.push(j)}if(t.length<20)return null;t.sort((z,j)=>z-j);const s=[];for(let z=1;z<t.length;z++){const j=t[z]-t[z-1];j>0&&isFinite(j)&&s.push(j)}if(s.length<10)return null;s.sort((z,j)=>z-j);const i=k_(s,.1)||s[0];if(!i||!isFinite(i)||i<=0)return null;const r=Math.max(i*6,i*3+6e4),a=[];for(let z=1;z<t.length;z++)if(t[z]-t[z-1]>r){const $=((t[z]+t[z-1])/2%Xd+Xd)%Xd;a.push($)}const l=a.length>=4?H6(a):0,c=new Map;for(const z of t){const j=vm(z,l),B=c.get(j);B?(B.count++,z<B.minTs&&(B.minTs=z),z>B.maxTs&&(B.maxTs=z)):c.set(j,{minTs:z,maxTs:z,count:1})}const d=Array.from(c.keys()).sort((z,j)=>z-j),v=d.slice(Math.max(0,d.length-40)),g=[],_=[],y=new Array(7).fill(!1),k=[];for(const z of v){const j=c.get(z);j!=null&&j.count&&k.push(j.count)}const S=w_(k.filter(z=>z>0)),M=Math.max(2,Math.floor(S*.6));for(const z of v){const j=c.get(z);if(!j)continue;const B=Rm(z);y[B]=!0;const $=j.minTs-z,F=j.maxTs-z+i;j.count>=M&&isFinite($)&&isFinite(F)&&$>=0&&F>=0&&$<Xd&&F<=Xd&&F>$&&(g.push($),_.push(F))}let I=0,C=Xd;if(g.length>=5&&_.length>=5)I=w_(g),C=w_(_);else{const z=[];for(const $ of t){const F=(($-l)%Xd+Xd)%Xd;z.push(F)}z.sort(($,F)=>$-F);const j=k_(z,.05),B=k_(z,.95);I=j,C=Math.min(Xd,B+i)}if(I>=0&&C>I&&C<=Xd||(I=0,C=Xd),C-I>Xd*.92&&(I=0,C=Xd),!y.some(Boolean))for(let z=0;z<7;z++)y[z]=!0;return{boundaryOffsetMs:l,openMs:I,closeMs:C,activeWeekdays:y}}catch{return null}}function S_(o,e,t){if(o===e)return 0;let s=1,i=o,r=e;i>r&&(s=-1,i=e,r=o);const{boundaryOffsetMs:a,openMs:l,closeMs:c,activeWeekdays:d}=t,v=Math.max(0,c-l);if(v<=0)return 0;const g=vm(i,a),_=vm(r,a),y=i-g,k=r-_,S=Rm(g),M=Rm(_);if(g===_){if(!d[S])return 0;const z=Math.max(y,l),j=Math.min(k,c);return s*Math.max(0,j-z)}let I=0;d[S]&&(I+=Math.max(0,c-Math.max(y,l))),d[M]&&(I+=Math.max(0,Math.min(k,c)-l));const C=Math.max(0,Math.round((_-g)/Xd)),T=Math.max(0,C-1);if(T>0){const z=ab(S,T,d);I+=z*v}return s*I}function M0(o,e,t){let s=o,i=e;for(let r=0;r<14;r++)if(s+=Xd,i=(i+1)%7,t[i])return{dayStart:s,weekday:i};return{dayStart:o+Xd,weekday:(e+1)%7}}function T0(o,e,t){let s=o,i=e;for(let r=0;r<14;r++)if(s-=Xd,i=(i+6)%7,t[i])return{dayStart:s,weekday:i};return{dayStart:o-Xd,weekday:(e+6)%7}}function C_(o,e,t){if(e===0||!Number.isFinite(e))return o;const{boundaryOffsetMs:s,openMs:i,closeMs:r,activeWeekdays:a}=t;if(Math.max(0,r-i)<=0)return o;let c=o,d=e;const v=d>0;for(d=Math.abs(d);d>0;){let g=vm(c,s),_=Rm(g),y=c-g;if(!a[_]){const k=v?M0(g,_,a):T0(g,_,a);g=k.dayStart,_=k.weekday,y=v?i:r,c=g+y}if(v){if(y<i)y=i,c=g+y;else if(y>=r){const M=M0(g,_,a);g=M.dayStart,_=M.weekday,y=i,c=g+y}const k=Math.max(0,r-y);if(d<k)return c+d;d-=k,c=M0(g,_,a).dayStart+i}else{if(y>r)y=r,c=g+y;else if(y<=i){const M=T0(g,_,a);g=M.dayStart,_=M.weekday,y=r,c=g+y}const k=Math.max(0,y-i);if(d<k)return c-d;d-=k,c=T0(g,_,a).dayStart+r}}return c}function Y6(o,e,t){if(o===e)return 0;const{boundaryOffsetMs:s,activeWeekdays:i}=t,r=vm(o,s),a=vm(e,s);if(r===a)return 0;const l=Rm(r),c=Math.round((a-r)/Xd);return c>0?ab(l,c,i):-G6(l,Math.abs(c),i)}function K6(o,e,t){if(e===0||!Number.isFinite(e))return o;const{boundaryOffsetMs:s,activeWeekdays:i}=t,r=i.reduce((_,y)=>_+(y?1:0),0);if(r<=0)return o;let a=vm(o,s),l=Rm(a),c=o-a;if(!i[l])if(e>0){const _=M0(a,l,i);a=_.dayStart,l=_.weekday}else{const _=T0(a,l,i);a=_.dayStart,l=_.weekday}let d=Math.abs(e);const v=e>0,g=Math.floor(d/r);for(g>0&&(a+=(v?1:-1)*g*7*Xd,d-=g*r);d>0;){const _=v?M0(a,l,i):T0(a,l,i);a=_.dayStart,l=_.weekday,d--}return c=Math.max(0,Math.min(Xd-1,c)),a+c}class Z6{constructor(e,t){ve(this,"_chart");ve(this,"_styles",O5());ve(this,"_formatter",{formatDate:({dateTimeFormat:e,timestamp:t,template:s})=>Z2(e,t,s),formatBigNumber:X2,formatExtendText:e=>""});ve(this,"_innerFormatter",{formatDate:(e,t,s)=>this._formatter.formatDate({dateTimeFormat:this._dateTimeFormat,timestamp:e,template:t,type:s}),formatBigNumber:e=>this._formatter.formatBigNumber(e),formatExtendText:e=>this._formatter.formatExtendText(e)});ve(this,"_locale","en-US");ve(this,"_thousandsSeparator",{sign:",",format:e=>J2(e,this._thousandsSeparator.sign)});ve(this,"_decimalFold",{threshold:3,format:e=>Q2(e,this._decimalFold.threshold)});ve(this,"_symbol",null);ve(this,"_period",null);ve(this,"_sessionCacheKey",null);ve(this,"_sessionCache",null);ve(this,"_sessionBySymbol",new Map);ve(this,"_dataList",[]);ve(this,"_dataLoader",null);ve(this,"_loading",!1);ve(this,"_dataLoadMore",{forward:!1,backward:!1});ve(this,"_dateTimeFormat");ve(this,"_zoomEnabled",!0);ve(this,"_scrollEnabled",!0);ve(this,"_totalBarSpace",0);ve(this,"_barSpace",V6);ve(this,"_gapBarSpace",0);ve(this,"_offsetRightDistance",W6);ve(this,"_lastBarRightSideDiffBarCount");ve(this,"_startLastBarRightSideDiffBarCount",0);ve(this,"_scrollLimitRole","bar_count");ve(this,"_minVisibleBarCount",{left:2,right:2});ve(this,"_maxOffsetDistance",{left:50,right:50});ve(this,"_visibleRange",ly());ve(this,"_visibleRangeDataList",[]);ve(this,"_visibleRangeHighLowPrice",[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}]);ve(this,"_crosshair",{});ve(this,"_actions",new Map);ve(this,"_indicators",new Map);ve(this,"_taskScheduler",new F5);ve(this,"_overlays",new Map);ve(this,"_progressOverlayInfo",null);ve(this,"_lastPriceMarkExtendTextUpdateTimers",[]);ve(this,"_pressedOverlayInfo",{paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null});ve(this,"_hoverOverlayInfo",{paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null});ve(this,"_clickOverlayInfo",{paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null});ve(this,"_layoutRafId",null);ve(this,"_pendingLayoutOptions",{measureWidth:!1,update:!1,buildYAxisTick:!1,cacheYAxisWidth:!1});ve(this,"_overlayRafId",null);ve(this,"_perfScrollCalls",0);ve(this,"_perfZoomCalls",0);ve(this,"_perfLayoutSchedules",0);ve(this,"_perfLastWindowTs",typeof performance<"u"?performance.now():Date.now());this._chart=e,this._calcOptimalBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace;const{styles:s,locale:i,timezone:r,formatter:a,thousandsSeparator:l,decimalFold:c}=t??{};Uo(s)&&this.setStyles(s),pd(i)&&this.setLocale(i),this.setTimezone(r??""),Uo(a)&&this.setFormatter(a),Uo(l)&&this.setThousandsSeparator(l),Uo(c)&&this.setDecimalFold(c)}setStyles(e){var s,i,r,a,l,c;let t=null;if(pd(e)?t=O6(e):t=e,Ru(this._styles,t),Ov((r=(i=(s=t==null?void 0:t.candle)==null?void 0:s.tooltip)==null?void 0:i.legend)==null?void 0:r.template)&&(this._styles.candle.tooltip.legend.template=t.candle.tooltip.legend.template),Uo((c=(l=(a=t==null?void 0:t.candle)==null?void 0:a.priceMark)==null?void 0:l.last)==null?void 0:c.extendTexts)){this._clearLastPriceMarkExtendTextUpdateTimer();const d=[];this._styles.candle.priceMark.last.extendTexts.forEach(v=>{const g=v.updateInterval;if(v.show&&g>0&&!d.includes(g)){d.push(g);const _=setInterval(()=>{this._chart.updatePane(hd.Main,pc.CANDLE)},g);this._lastPriceMarkExtendTextUpdateTimers.push(_)}})}}getStyles(){return this._styles}setFormatter(e){Ru(this._formatter,e)}getFormatter(){return this._formatter}getInnerFormatter(){return this._innerFormatter}setLocale(e){this._locale=e}getLocale(){return this._locale}setTimezone(e){if(!Uo(this._dateTimeFormat)||this.getTimezone()!==e){const t={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};e.length>0&&(t.timeZone=e);let s=null;try{s=new Intl.DateTimeFormat("en",t)}catch{}s!==null&&(this._dateTimeFormat=s)}}getTimezone(){return this._dateTimeFormat.resolvedOptions().timeZone}getDateTimeFormat(){return this._dateTimeFormat}setThousandsSeparator(e){Ru(this._thousandsSeparator,e)}getThousandsSeparator(){return this._thousandsSeparator}setDecimalFold(e){Ru(this._decimalFold,e)}getDecimalFold(){return this._decimalFold}setSymbol(e){this.resetData(()=>{this._symbol={pricePrecision:gp.PRICE,volumePrecision:gp.VOLUME,...this._symbol,...e},this._synchronizeIndicatorSeriesPrecision()})}getSymbol(){return this._symbol}setPeriod(e){this.resetData(()=>{this._period=e})}getPeriod(){return this._period}_getSessionSymbolKey(){var s,i;const e=(s=this._symbol)==null?void 0:s.ticker;if(!e||typeof e!="string")return"";const t=(i=this._symbol)==null?void 0:i.exchange;return`${typeof t=="string"?t:""}:${e}`}_getInferredSession(){var e,t;try{const s=this._getSessionSymbolKey(),i=this._dataList.length,r=i>0?(e=this._dataList[0])==null?void 0:e.timestamp:0,a=i>0?(t=this._dataList[i-1])==null?void 0:t.timestamp:0,l=`${s}|${i}|${r}|${a}`;if(this._sessionCacheKey===l)return this._sessionCache;let c=U6(this._dataList);return c&&s?this._sessionBySymbol.set(s,c):!c&&s&&(c=this._sessionBySymbol.get(s)??null),this._sessionCacheKey=l,this._sessionCache=c,c}catch{return null}}_refineDataIndexByTimestamp(e,t,s){const i=Math.max(0,Math.min(50,Math.floor(s)));let r=t,a=Number.POSITIVE_INFINITY;for(let l=t-i;l<=t+i;l++){const c=this.dataIndexToTimestamp(l);if(!ja(c))continue;const d=Math.abs(c-e);d<a&&(a=d,r=l)}return r}_inferPeriodFromData(){const e=this._dataList.length;if(e<2)return null;const t=this._dataList[e-2].timestamp,s=this._dataList[e-1].timestamp,i=Math.max(1,s-t),r=1e3,a=60*r,l=60*a,c=24*l,d=7*c,v=30*c,g=365*c,_=[{type:"second",unit:r},{type:"minute",unit:a},{type:"hour",unit:l},{type:"day",unit:c},{type:"week",unit:d},{type:"month",unit:v},{type:"year",unit:g}];let y=null,k=Number.MAX_VALUE;for(const S of _){const M=Math.max(1,Math.round(i/S.unit)),I=M*S.unit,C=Math.abs(I-i);C<k&&(k=C,y={type:S.type,span:M})}return y}getDataList(){return this._dataList}getVisibleRangeDataList(){return this._visibleRangeDataList}getVisibleRangeHighLowPrice(){return this._visibleRangeHighLowPrice}_addData(e,t,s){let i=!1,r=!1,a=0;if(Ov(e)){const l={backward:!1,forward:!1};switch($0(s)?(l.backward=s,l.forward=s):(l.backward=(s==null?void 0:s.backward)??!1,l.forward=(s==null?void 0:s.forward)??!1),a=e.length,t){case"init":{this._clearData(),this._dataList=e,this._dataLoadMore.backward=l.backward,this._dataLoadMore.forward=l.forward,this.setOffsetRightDistance(this._offsetRightDistance),r=!0;break}case"backward":{this._dataList=this._dataList.concat(e),this._dataLoadMore.backward=l.backward,this._lastBarRightSideDiffBarCount-=a,r=a>0;break}case"forward":{this._dataList=e.concat(this._dataList),this._dataLoadMore.forward=l.forward,r=a>0;break}}i=!0}else{const l=this._dataList.length,c=e.timestamp,d=Hu(this._dataList[l-1],"timestamp",0);if(c>d){this._dataList.push(e);let v=this.getLastBarRightSideDiffBarCount();v<0&&this.setLastBarRightSideDiffBarCount(--v),a=1,i=!0,r=!0}else c===d&&(this._dataList[l-1]=e,i=!0,r=!0)}i&&r&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this.getIndicatorsByFilter({}).forEach(c=>{this._addIndicatorCalcTask(c,t)}),this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:t!=="init"}))}setDataLoader(e){this.resetData(()=>{this._dataLoader=e})}_calcOptimalBarSpace(){const t=1-q6*Math.atan(Math.max(4,this._barSpace)-4)/(Math.PI*.5);let s=Math.min(Math.floor(this._barSpace*t),Math.floor(this._barSpace));s%2===0&&s+2>=this._barSpace&&--s,this._gapBarSpace=Math.max(1,s)}_adjustVisibleRange(){const e=this._dataList.length,t=this._totalBarSpace/this._barSpace;let s=0,i=0;this._scrollLimitRole==="distance"?(s=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,i=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(s=this._minVisibleBarCount.left,i=this._minVisibleBarCount.right),s=Math.max(0,s),i=Math.max(0,i);const r=t-Math.min(s,e);this._lastBarRightSideDiffBarCount>r&&(this._lastBarRightSideDiffBarCount=r);const a=-e+Math.min(i,e);this._lastBarRightSideDiffBarCount<a&&(this._lastBarRightSideDiffBarCount=a);let l=Math.round(this._lastBarRightSideDiffBarCount+e+.5);const c=l;l>e&&(l=e);let d=Math.round(l-t)-1;d<0&&(d=0);const v=this._lastBarRightSideDiffBarCount>0?Math.round(e+this._lastBarRightSideDiffBarCount-t)-1:d;this._visibleRange={from:d,to:l,realFrom:v,realTo:c},this.executeAction("onVisibleRangeChange",this._visibleRange),this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}];for(let g=v;g<c;g++){const _=this._dataList[g],y=this.dataIndexToCoordinate(g);this._visibleRangeDataList.push({dataIndex:g,x:y,data:{prev:this._dataList[g-1]??_,current:_,next:this._dataList[g+1]??_}}),Uo(_)&&(this._visibleRangeHighLowPrice[0].price<_.high&&(this._visibleRangeHighLowPrice[0].price=_.high,this._visibleRangeHighLowPrice[0].x=y),this._visibleRangeHighLowPrice[1].price>_.low&&(this._visibleRangeHighLowPrice[1].price=_.low,this._visibleRangeHighLowPrice[1].x=y))}d===0?this._dataLoadMore.forward&&this._processDataLoad("forward"):l===e&&this._dataLoadMore.backward&&this._processDataLoad("backward")}_processDataLoad(e){var t,s;if(!this._loading&&Uo(this._dataLoader)&&Uo(this._symbol)&&Uo(this._period)){this._loading=!0,console.warn("ℹ️ klinecharts: data load triggered",{type:e});const i={type:e,symbol:this._symbol,period:this._period,timestamp:null,callback:(r,a)=>{var c,d;this._loading=!1,!(Ov(r)&&r.length>0)&&(e==="forward"?this._dataLoadMore.forward=!1:e==="backward"&&(this._dataLoadMore.backward=!1)),this._addData(r,e,a),e==="init"&&((d=(c=this._dataLoader)==null?void 0:c.subscribeBar)==null||d.call(c,{symbol:this._symbol,period:this._period,callback:v=>{this._addData(v,"update")}}))}};switch(e){case"backward":{i.timestamp=((t=this._dataList[this._dataList.length-1])==null?void 0:t.timestamp)??null;break}case"forward":{i.timestamp=((s=this._dataList[0])==null?void 0:s.timestamp)??null;break}}try{this._dataLoader.getBars(i)}catch(r){this._loading=!1,console.warn("⚠️ klinecharts: getBars threw",r)}}}_processDataUnsubscribe(){var e,t;Uo(this._dataLoader)&&Uo(this._symbol)&&Uo(this._period)&&((t=(e=this._dataLoader).unsubscribeBar)==null||t.call(e,{symbol:this._symbol,period:this._period}))}resetData(e){this._processDataUnsubscribe(),e==null||e(),this._loading=!1,this._processDataLoad("init")}getBarSpace(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}}setBarSpace(e,t){e<vy.MIN||e>vy.MAX||this._barSpace===e||(this._barSpace=e,this._calcOptimalBarSpace(),t==null||t(),this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0}))}setTotalBarSpace(e){this._totalBarSpace!==e&&(this._totalBarSpace=e,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0}))}setOffsetRightDistance(e,t){return this._offsetRightDistance=this._scrollLimitRole==="distance"?Math.min(this._maxOffsetDistance.right,e):e,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,(t??!1)&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0})),this}getInitialOffsetRightDistance(){return this._offsetRightDistance}getOffsetRightDistance(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)}getLastBarRightSideDiffBarCount(){return this._lastBarRightSideDiffBarCount}setLastBarRightSideDiffBarCount(e){this._lastBarRightSideDiffBarCount=e}setMaxOffsetLeftDistance(e){this._scrollLimitRole="distance",this._maxOffsetDistance.left=e}setMaxOffsetRightDistance(e){this._scrollLimitRole="distance",this._maxOffsetDistance.right=e}setLeftMinVisibleBarCount(e){this._scrollLimitRole="bar_count",this._minVisibleBarCount.left=e}setRightMinVisibleBarCount(e){this._scrollLimitRole="bar_count",this._minVisibleBarCount.right=e}getVisibleRange(){return this._visibleRange}startScroll(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount}scroll(e){if(!this._scrollEnabled)return;const t=typeof performance<"u"?performance.now():Date.now();t-this._perfLastWindowTs>500&&(this._perfScrollCalls=0,this._perfZoomCalls=0,this._perfLayoutSchedules=0,this._perfLastWindowTs=t),this._perfScrollCalls++,this._perfScrollCalls>80&&console.warn("⚠️ klinecharts: High-frequency scroll detected");const s=e/this._barSpace,i=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-s;const r=Math.round(i-this._lastBarRightSideDiffBarCount*this._barSpace);r!==0&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0}),this.executeAction("onScroll",{distance:r}))}getDataByDataIndex(e){return this._dataList[e]??null}coordinateToFloatIndex(e){const t=this._dataList.length,s=(this._totalBarSpace-e)/this._barSpace,i=t+this._lastBarRightSideDiffBarCount-s;return Math.round(i*1e6)/1e6}dataIndexToTimestamp(e){const t=this._dataList.length;if(t===0)return null;const s=this.getDataByDataIndex(e);if(Uo(s))return s.timestamp;if(Uo(this._period)||this._dataList.length>0){const i=t-1;let r=null,a=0;if(e>i?(r=this._dataList[i].timestamp,a=e-i):e<0&&(r=this._dataList[0].timestamp,a=e),ja(r)){const l=this._period??this._inferPeriodFromData();if(Uo(l)){const{type:c,span:d}=l;switch(c){case"second":{const v=this._getInferredSession();return v?C_(r,d*1e3*a,v):r+d*1e3*a}case"minute":{const v=this._getInferredSession();return v?C_(r,d*60*1e3*a,v):r+d*60*1e3*a}case"hour":{const v=this._getInferredSession();return v?C_(r,d*60*60*1e3*a,v):r+d*60*60*1e3*a}case"day":{const v=this._getInferredSession();return v?K6(r,d*a,v):r+d*24*60*60*1e3*a}case"week":return r+d*7*24*60*60*1e3*a;case"month":{const v=new Date(r),g=v.getDate();v.setDate(1),v.setMonth(v.getMonth()+d*a);const _=new Date(v.getFullYear(),v.getMonth()+1,0).getDate();return v.setDate(Math.min(g,_)),v.getTime()}case"year":{const v=new Date(r);return v.setFullYear(v.getFullYear()+d*a),v.getTime()}}}}}return null}timestampToDataIndex(e){const t=this._dataList.length;if(t===0)return 0;if(Uo(this._period)||this._dataList.length>0){let s=null,i=0;const r=t-1,a=this._dataList[r].timestamp;e>a&&(s=a,i=r);const l=this._dataList[0].timestamp;if(e<l&&(s=l,i=0),ja(s)){const c=this._period??this._inferPeriodFromData();if(Uo(c)){const{type:d,span:v}=c;switch(d){case"second":{const g=this._getInferredSession();if(g){const _=S_(s,e,g),y=v*1e3,k=i+_/y;return Math.round(k*1e6)/1e6}return i+(e-s)/(v*1e3)}case"minute":{const g=this._getInferredSession();if(g){const _=S_(s,e,g),y=v*60*1e3,k=i+_/y;return Math.round(k*1e6)/1e6}return i+(e-s)/(v*60*1e3)}case"hour":{const g=this._getInferredSession();if(g){const _=S_(s,e,g),y=v*60*60*1e3,k=i+_/y;return Math.round(k*1e6)/1e6}return i+(e-s)/(v*60*60*1e3)}case"day":{const g=this._getInferredSession();if(g){const _=Y6(s,e,g),y=i+Math.floor(_/v);return this._refineDataIndexByTimestamp(e,y,6)}return i+Math.floor((e-s)/(v*24*60*60*1e3))}case"week":return i+Math.floor((e-s)/(v*7*24*60*60*1e3));case"month":{const g=new Date(s),_=new Date(e),y=g.getFullYear(),k=_.getFullYear(),S=g.getMonth(),M=_.getMonth();return i+Math.floor(((k-y)*12+(M-S))/v)}case"year":{const g=new Date(s).getFullYear(),_=new Date(e).getFullYear();return i+Math.floor((_-g)/v)}}}}}return n1(this._dataList,"timestamp",e)}dataIndexToCoordinate(e){const s=this._dataList.length+this._lastBarRightSideDiffBarCount-e;return Math.floor(this._totalBarSpace-(s-.5)*this._barSpace+.5)}coordinateToDataIndex(e){return Math.ceil(this.coordinateToFloatIndex(e))-1}zoom(e,t){if(!this._zoomEnabled)return;const s=typeof performance<"u"?performance.now():Date.now();s-this._perfLastWindowTs>500&&(this._perfScrollCalls=0,this._perfZoomCalls=0,this._perfLayoutSchedules=0,this._perfLastWindowTs=s),this._perfZoomCalls++,this._perfZoomCalls>60&&console.warn("⚠️ klinecharts: High-frequency zoom detected");let i=t??null;ja(i==null?void 0:i.x)||(i={x:this._crosshair.x??this._totalBarSpace/2});const r=i.x,a=this.coordinateToFloatIndex(r),l=this._barSpace,c=this._barSpace+e*(this._barSpace/i1);this.setBarSpace(c,()=>{this._lastBarRightSideDiffBarCount+=a-this.coordinateToFloatIndex(r)});const d=this._barSpace/l;d!==1&&this.executeAction("onZoom",{scale:d})}setZoomEnabled(e){this._zoomEnabled=e}isZoomEnabled(){return this._zoomEnabled}setScrollEnabled(e){this._scrollEnabled=e}isScrollEnabled(){return this._scrollEnabled}setCrosshair(e,t){const{notInvalidate:s,notExecuteAction:i,forceInvalidate:r}=t??{},a=e??{};let l=0,c=0;ja(a.x)?(l=this.coordinateToDataIndex(a.x),l<0?c=0:l>this._dataList.length-1?c=this._dataList.length-1:c=l):(l=this._dataList.length-1,c=l);const d=this._dataList[c],v=this.dataIndexToCoordinate(l),g={x:this._crosshair.x,y:this._crosshair.y,paneId:this._crosshair.paneId};this._crosshair={...a,realX:v,kLineData:d,realDataIndex:l,dataIndex:c,timestamp:this.dataIndexToTimestamp(l)??void 0},(g.x!==a.x||g.y!==a.y||g.paneId!==a.paneId||(r??!1))&&(Uo(d)&&!(i??!1)&&this.hasAction("onCrosshairChange")&&pd(this._crosshair.paneId)&&this.executeAction("onCrosshairChange",e),(s??!1)||this._scheduleOverlayUpdate())}getCrosshair(){return this._crosshair}executeAction(e,t){var s;(s=this._actions.get(e))==null||s.execute(t)}subscribeAction(e,t){var s;this._actions.has(e)||this._actions.set(e,new $5),(s=this._actions.get(e))==null||s.subscribe(t)}unsubscribeAction(e,t){const s=this._actions.get(e);Uo(s)&&(s.unsubscribe(t),s.isEmpty()&&this._actions.delete(e))}hasAction(e){const t=this._actions.get(e);return Uo(t)&&!t.isEmpty()}_sortIndicators(e){var t;pd(e)?(t=this._indicators.get(e))==null||t.sort((s,i)=>s.zLevel-i.zLevel):this._indicators.forEach(s=>{s.sort((i,r)=>i.zLevel-r.zLevel)})}_addIndicatorCalcTask(e,t){var s;(s=e.onDataStateChange)==null||s.call(e,{state:"loading",type:t,indicator:e}),this._taskScheduler.add({id:cy(e.id),handler:async()=>{const i=typeof performance<"u"?performance.now():Date.now(),r=await e.calcImp(this._dataList).then(c=>c),l=(typeof performance<"u"?performance.now():Date.now())-i;return l>50&&console.warn("⚠️ klinecharts: indicator calc slow",{name:e.name,durationMs:Math.round(l)}),r}}).then(i=>{var r;i&&(this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:t!=="init"}),(r=e.onDataStateChange)==null||r.call(e,{state:"ready",type:t,indicator:e}))}).catch(i=>{var r;i!=="canceled"&&((r=e.onDataStateChange)==null||r.call(e,{state:"error",type:t,indicator:e}))})}addIndicator(e,t,s){const{name:i}=e;if(this.getIndicatorsByFilter(e).length>0)return!1;let a=this.getIndicatorsByPaneId(t);const l=tb(i),c=new l;return this._synchronizeIndicatorSeriesPrecision(c),c.paneId=t,c.override(e),s||(this.removeIndicator({paneId:t}),a=[]),a.push(c),this._indicators.set(t,a),this._sortIndicators(t),this._addIndicatorCalcTask(c,"init"),!0}getIndicatorsByPaneId(e){return this._indicators.get(e)??[]}getIndicatorsByFilter(e){const{paneId:t,name:s,id:i}=e,r=Uo(s)?s.split("(")[0].trim():void 0,a=c=>Uo(i)?c.id===i:Uo(r)?c.name===r||c.shortName===r:!0;let l=[];return Uo(t)?l=l.concat(this.getIndicatorsByPaneId(t).filter(a)):this._indicators.forEach(c=>{l=l.concat(c.filter(a))}),l}removeIndicator(e){let t=!1;return this.getIndicatorsByFilter(e??{}).forEach(i=>{const r=this.getIndicatorsByPaneId(i.paneId),a=r.findIndex(l=>l.id===i.id);a>-1&&(this._taskScheduler.remove(cy(i.id)),r.splice(a,1),t=!0),r.length===0&&this._indicators.delete(i.paneId)}),t}hasIndicators(e){return this._indicators.has(e)}_synchronizeIndicatorSeriesPrecision(e){if(Uo(this._symbol)){const{pricePrecision:t=gp.PRICE,volumePrecision:s=gp.VOLUME}=this._symbol,i=r=>{switch(r.series){case"price":{r.setSeriesPrecision(t);break}case"volume":{r.setSeriesPrecision(s);break}}};Uo(e)?i(e):this._indicators.forEach(r=>{r.forEach(a=>{i(a)})})}}overrideIndicator(e){let t=!1,s=!1;return this.getIndicatorsByFilter(e).forEach(r=>{r.override(e);const{calc:a,draw:l,sort:c}=r.shouldUpdateImp();c&&(s=!0),a?this._addIndicatorCalcTask(r,"update"):l&&(t=!0)}),s&&this._sortIndicators(),t?(this._scheduleLayout({update:!0}),!0):!1}_scheduleLayout(e){this._pendingLayoutOptions.measureWidth=this._pendingLayoutOptions.measureWidth||(e.measureWidth??!1),this._pendingLayoutOptions.update=this._pendingLayoutOptions.update||(e.update??!1),this._pendingLayoutOptions.buildYAxisTick=this._pendingLayoutOptions.buildYAxisTick||(e.buildYAxisTick??!1),this._pendingLayoutOptions.cacheYAxisWidth=this._pendingLayoutOptions.cacheYAxisWidth||(e.cacheYAxisWidth??!1);const t=typeof performance<"u"?performance.now():Date.now();t-this._perfLastWindowTs>500&&(this._perfScrollCalls=0,this._perfZoomCalls=0,this._perfLayoutSchedules=0,this._perfLastWindowTs=t),this._perfLayoutSchedules++,this._perfLayoutSchedules>40&&console.warn("⚠️ klinecharts: Frequent layout scheduling detected"),this._layoutRafId===null&&(this._layoutRafId=Lf(()=>{const s={...this._pendingLayoutOptions};this._pendingLayoutOptions={measureWidth:!1,update:!1,buildYAxisTick:!1,cacheYAxisWidth:!1},this._layoutRafId=null,this._chart.layout(s)}))}_scheduleOverlayUpdate(){this._overlayRafId===null&&(this._overlayRafId=Lf(()=>{this._overlayRafId=null,this._chart.updatePane(hd.Overlay)}))}getOverlaysByFilter(e){var d;const{id:t,groupId:s,paneId:i,name:r}=e,a=v=>Uo(t)?v.id===t:Uo(s)?v.groupId===s&&(!Uo(r)||v.name===r):!Uo(r)||v.name===r;let l=[];Uo(i)?l=l.concat(this.getOverlaysByPaneId(i).filter(a)):this._overlays.forEach(v=>{l=l.concat(v.filter(a))});const c=(d=this._progressOverlayInfo)==null?void 0:d.overlay;return Uo(c)&&a(c)&&l.push(c),l}getOverlaysByPaneId(e){if(!pd(e)){let t=[];return this._overlays.forEach(s=>{t=t.concat(s)}),t}return this._overlays.get(e)??[]}_sortOverlays(e){var t;pd(e)?(t=this._overlays.get(e))==null||t.sort((s,i)=>s.zLevel-i.zLevel):this._overlays.forEach(s=>{s.sort((i,r)=>i.zLevel-r.zLevel)})}addOverlays(e,t){const s=[],i=e.map((r,a)=>{var c,d;if(Uo(r.id)){let v=null;for(const g of this._overlays){const y=g[1].find(k=>k.id===r.id);if(Uo(y)){v=y;break}}if(Uo(v))return r.id}const l=N6(r.name);if(Uo(l)){const v=r.id??b0(h6),g=new l,_=r.paneId??pc.CANDLE;r.id=v,r.groupId??(r.groupId=v);const y=this.getOverlaysByPaneId(_).length;return r.zLevel??(r.zLevel=y),g.override(r),s.includes(_)||s.push(_),g.isDrawing()?this._progressOverlayInfo={paneId:_,overlay:g,appointPaneFlag:t[a]}:(this._overlays.has(_)||this._overlays.set(_,[]),(c=this._overlays.get(_))==null||c.push(g)),g.isStart()&&((d=g.onDrawStart)==null||d.call(g,{overlay:g,chart:this._chart})),v}return null});return s.length>0&&(this._sortOverlays(),s.forEach(r=>{this._chart.updatePane(hd.Overlay,r)}),this._chart.updatePane(hd.Overlay,pc.X_AXIS)),i}getProgressOverlayInfo(){return this._progressOverlayInfo}progressOverlayComplete(){var e;if(this._progressOverlayInfo!==null){const{overlay:t,paneId:s}=this._progressOverlayInfo;t.isDrawing()||(this._overlays.has(s)||this._overlays.set(s,[]),(e=this._overlays.get(s))==null||e.push(t),this._sortOverlays(s),this._progressOverlayInfo=null)}}updateProgressOverlayInfo(e,t){this._progressOverlayInfo!==null&&($0(t)&&t&&(this._progressOverlayInfo.appointPaneFlag=t),this._progressOverlayInfo.paneId=e,this._progressOverlayInfo.overlay.override({paneId:e}))}overrideOverlay(e){let t=!1;const s=[];return this.getOverlaysByFilter(e).forEach(r=>{r.override(e);const{sort:a,draw:l}=r.shouldUpdate();a&&(t=!0),(a||l)&&(s.includes(r.paneId)||s.push(r.paneId))}),t&&this._sortOverlays(),s.length>0?(s.forEach(r=>{this._chart.updatePane(hd.Overlay,r)}),this._chart.updatePane(hd.Overlay,pc.X_AXIS),!0):!1}removeOverlay(e){const t=[];return this.getOverlaysByFilter(e??{}).forEach(i=>{var l;const r=i.paneId,a=this.getOverlaysByPaneId(i.paneId);if((l=i.onRemoved)==null||l.call(i,{overlay:i,chart:this._chart}),t.includes(r)||t.push(r),i.isDrawing())this._progressOverlayInfo=null;else{const c=a.findIndex(d=>d.id===i.id);c>-1&&a.splice(c,1)}a.length===0&&this._overlays.delete(r)}),t.length>0?(t.forEach(i=>{this._chart.updatePane(hd.Overlay,i)}),this._chart.updatePane(hd.Overlay,pc.X_AXIS),!0):!1}setPressedOverlayInfo(e){this._pressedOverlayInfo=e}getPressedOverlayInfo(){return this._pressedOverlayInfo}setHoverOverlayInfo(e,t,s){const{overlay:i,figureType:r,figureIndex:a,figure:l}=this._hoverOverlayInfo,c=e.overlay;if(((i==null?void 0:i.id)!==(c==null?void 0:c.id)||r!==e.figureType||a!==e.figureIndex)&&(this._hoverOverlayInfo=e,(i==null?void 0:i.id)!==(c==null?void 0:c.id))){let d=!1,v=!1;i!==null&&(i.override({zLevel:i.getPrevZLevel()}),v=!0,s(i,l)&&(d=!0)),c!==null&&(c.setPrevZLevel(c.zLevel),c.override({zLevel:Number.MAX_SAFE_INTEGER}),v=!0,t(c,e.figure)&&(d=!0)),v&&this._sortOverlays(),d||this._chart.updatePane(hd.Overlay)}}getHoverOverlayInfo(){return this._hoverOverlayInfo}setClickOverlayInfo(e,t,s){const{paneId:i,overlay:r,figureType:a,figure:l,figureIndex:c}=this._clickOverlayInfo,d=e.overlay;((r==null?void 0:r.id)!==(d==null?void 0:d.id)||a!==e.figureType||c!==e.figureIndex)&&(this._clickOverlayInfo=e,(r==null?void 0:r.id)!==(d==null?void 0:d.id)&&(Uo(r)&&s(r,l),Uo(d)&&t(d,e.figure),this._chart.updatePane(hd.Overlay,e.paneId),i!==e.paneId&&this._chart.updatePane(hd.Overlay,i),this._chart.updatePane(hd.Overlay,pc.X_AXIS)))}getClickOverlayInfo(){return this._clickOverlayInfo}isOverlayEmpty(){return this._overlays.size===0&&this._progressOverlayInfo===null}isOverlayDrawing(){var e;return((e=this._progressOverlayInfo)==null?void 0:e.overlay.isDrawing())??!1}_clearLastPriceMarkExtendTextUpdateTimer(){this._lastPriceMarkExtendTextUpdateTimers.forEach(e=>{clearInterval(e)}),this._lastPriceMarkExtendTextUpdateTimers=[]}_clearData(){this._dataLoadMore.backward=!1,this._dataLoadMore.forward=!1,this._loading=!1,this._dataList=[],this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._visibleRange=ly(),this._crosshair={}}getChart(){return this._chart}destroy(){this._clearData(),this._clearLastPriceMarkExtendTextUpdateTimer(),this._taskScheduler.clear(),this._overlays.clear(),this._indicators.clear(),this._actions.clear()}applyNewData(e,t){this._addData(e,"init",t)}addData(e,t,s){this._addData(e,t,s)}}const bc={MAIN:"main",X_AXIS:"xAxis",Y_AXIS:"yAxis",SEPARATOR:"separator"},A0=7;async function X6(){return await new Promise(o=>{const e=new ResizeObserver(t=>{o(t.every(s=>"devicePixelContentBoxSize"in s)),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(()=>!1)}class fy{constructor(e,t){ve(this,"_element");ve(this,"_resizeObserver");ve(this,"_mediaQueryList");ve(this,"_ctx");ve(this,"_listener");ve(this,"_supportedDevicePixelContentBox",!1);ve(this,"_width",0);ve(this,"_height",0);ve(this,"_pixelWidth",0);ve(this,"_pixelHeight",0);ve(this,"_nextPixelWidth",0);ve(this,"_nextPixelHeight",0);ve(this,"_requestAnimationId",y_);ve(this,"_mediaQueryListener",()=>{const e=Xf(this._element);this._nextPixelWidth=Math.round(this._element.clientWidth*e),this._nextPixelHeight=Math.round(this._element.clientHeight*e),this._resetPixelRatio()});this._listener=t,this._element=Df("canvas",e),this._ctx=this._element.getContext("2d"),X6().then(s=>{this._supportedDevicePixelContentBox=s,s?(this._resizeObserver=new ResizeObserver(i=>{const r=i.find(l=>l.target===this._element),a=r==null?void 0:r.devicePixelContentBoxSize[0];Uo(a)&&(this._nextPixelWidth=a.inlineSize,this._nextPixelHeight=a.blockSize,(this._pixelWidth!==this._nextPixelWidth||this._pixelHeight!==this._nextPixelHeight)&&this._resetPixelRatio())}),this._resizeObserver.observe(this._element,{box:"device-pixel-content-box"})):(this._mediaQueryList=window.matchMedia(`(resolution: ${Xf(this._element)}dppx)`),this._mediaQueryList.addListener(this._mediaQueryListener))}).catch(s=>!1)}_resetPixelRatio(){this._executeListener(()=>{const e=this._element.clientWidth,t=this._element.clientHeight;this._width=e,this._height=t,this._pixelWidth=this._nextPixelWidth,this._pixelHeight=this._nextPixelHeight,this._element.width=this._nextPixelWidth,this._element.height=this._nextPixelHeight;const s=this._nextPixelWidth/e,i=this._nextPixelHeight/t;this._ctx.scale(s,i)})}_executeListener(e){this._requestAnimationId===y_&&(this._requestAnimationId=Lf(()=>{this._ctx.clearRect(0,0,this._width,this._height),e==null||e(),this._listener(),this._requestAnimationId=y_}))}update(e,t){if(this._width!==e||this._height!==t){if(this._element.style.width=`${e}px`,this._element.style.height=`${t}px`,!this._supportedDevicePixelContentBox){const s=Xf(this._element);this._nextPixelWidth=Math.round(e*s),this._nextPixelHeight=Math.round(t*s),this._resetPixelRatio()}}else this._executeListener()}getElement(){return this._element}getContext(){return this._ctx}destroy(){Uo(this._resizeObserver)&&this._resizeObserver.unobserve(this._element),Uo(this._mediaQueryList)&&this._mediaQueryList.removeListener(this._mediaQueryListener)}}class lb extends k1{constructor(t,s){super();ve(this,"_rootContainer");ve(this,"_pane");ve(this,"_container");ve(this,"_bounding",_h());ve(this,"_cursor","crosshair");ve(this,"_forceCursor",null);this._pane=s,this._rootContainer=t,this._container=this.createContainer(),t.appendChild(this._container)}setBounding(t){return Ru(this._bounding,t),this}getContainer(){return this._container}getBounding(){return this._bounding}getPane(){return this._pane}checkEventOn(t){return!0}setCursor(t){pd(this._forceCursor)||t!==this._cursor&&(this._cursor=t,this._container.style.cursor=this._cursor)}setForceCursor(t){t!==this._forceCursor&&(this._forceCursor=t,this._container.style.cursor=this._forceCursor??this._cursor)}getForceCursor(){return this._forceCursor}update(t){this.updateImp(this._container,this._bounding,t??hd.Drawer)}destroy(){this._rootContainer.removeChild(this._container)}}class P1 extends lb{constructor(t,s){super(t,s);ve(this,"_mainCanvas");ve(this,"_overlayCanvas");this._mainCanvas=new fy({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},()=>{this.updateMain(this._mainCanvas.getContext())}),this._overlayCanvas=new fy({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},()=>{this.updateOverlay(this._overlayCanvas.getContext())});const i=this.getContainer();i.appendChild(this._mainCanvas.getElement()),i.appendChild(this._overlayCanvas.getElement())}createContainer(){return Df("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})}updateImp(t,s,i){const{width:r,height:a,left:l}=s;t.style.left=`${l}px`;let c=i;const d=t.clientWidth,v=t.clientHeight;switch((r!==d||a!==v)&&(t.style.width=`${r}px`,t.style.height=`${a}px`,c=hd.Drawer),c){case hd.Main:{this._mainCanvas.update(r,a);break}case hd.Overlay:{this._overlayCanvas.update(r,a);break}case hd.Drawer:case hd.All:{this._mainCanvas.update(r,a),this._overlayCanvas.update(r,a);break}}}destroy(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()}getImage(t){const{width:s,height:i}=this.getBounding(),r=Df("canvas",{width:`${s}px`,height:`${i}px`,boxSizing:"border-box"}),a=r.getContext("2d"),l=Xf(r);return r.width=s*l,r.height=i*l,a.scale(l,l),a.drawImage(this._mainCanvas.getElement(),0,0,s,i),t&&a.drawImage(this._overlayCanvas.getElement(),0,0,s,i),r}}function cb(o,e){let t=[];t=t.concat(e);for(const s of t){const{x:i,y:r,r:a}=s,l=o.x-i,c=o.y-r;if(!(l*l+c*c>a*a))return!0}return!1}function J6(o,e,t){let s=[];s=s.concat(e);const{style:i="fill",color:r="currentColor",borderSize:a=1,borderColor:l="currentColor",borderStyle:c="solid",borderDashedValue:d=[2,2]}=t,v=(i==="fill"||t.style==="stroke_fill")&&(!pd(r)||!jm(r));v&&(o.fillStyle=r,s.forEach(({x:g,y:_,r:y})=>{o.beginPath(),o.arc(g,_,y,0,Math.PI*2),o.closePath(),o.fill()})),(i==="stroke"||t.style==="stroke_fill")&&a>0&&!jm(l)&&(o.strokeStyle=l,o.lineWidth=a,c==="dashed"?o.setLineDash(d):o.setLineDash([]),s.forEach(({x:g,y:_,r:y})=>{(!v||y>a)&&(o.beginPath(),o.arc(g,_,y,0,Math.PI*2),o.closePath(),o.stroke())}))}const Q6={name:"circle",checkEventOn:cb,draw:(o,e,t)=>{J6(o,e,t)}};function db(o,e){let t=[];t=t.concat(e);for(const s of t){let i=!1;const{coordinates:r}=s;for(let a=0,l=r.length-1;a<r.length;l=a++)r[a].y>o.y!=r[l].y>o.y&&o.x<(r[l].x-r[a].x)*(o.y-r[a].y)/(r[l].y-r[a].y)+r[a].x&&(i=!i);if(i)return!0}return!1}function e3(o,e,t){let s=[];s=s.concat(e);const{style:i="fill",color:r="currentColor",borderSize:a=1,borderColor:l="currentColor",borderStyle:c="solid",borderDashedValue:d=[2,2]}=t;(i==="fill"||t.style==="stroke_fill")&&(!pd(r)||!jm(r))&&(o.fillStyle=r,s.forEach(({coordinates:v})=>{o.beginPath(),o.moveTo(v[0].x,v[0].y);for(let g=1;g<v.length;g++)o.lineTo(v[g].x,v[g].y);o.closePath(),o.fill()})),(i==="stroke"||t.style==="stroke_fill")&&a>0&&!jm(l)&&(o.strokeStyle=l,o.lineWidth=a,c==="dashed"?o.setLineDash(d):o.setLineDash([]),s.forEach(({coordinates:v})=>{o.beginPath(),o.moveTo(v[0].x,v[0].y);for(let g=1;g<v.length;g++)o.lineTo(v[g].x,v[g].y);o.closePath(),o.stroke()}))}const t3={name:"polygon",checkEventOn:db,draw:(o,e,t)=>{e3(o,e,t)}};function I1(o,e){let t=[];t=t.concat(e);for(const s of t){let i=s.x,r=s.width;r<tp*2&&(i-=tp,r=tp*2);let a=s.y,l=s.height;if(l<tp*2&&(a-=tp,l=tp*2),o.x>=i&&o.x<=i+r&&o.y>=a&&o.y<=a+l)return!0}return!1}function ub(o,e,t){let s=[];s=s.concat(e);const{style:i="fill",color:r="transparent",borderSize:a=1,borderColor:l="transparent",borderStyle:c="solid",borderRadius:d=0,borderDashedValue:v=[2,2]}=t,g=o.roundRect??o.rect,_=(i==="fill"||t.style==="stroke_fill")&&(!pd(r)||!jm(r));if(_&&(o.fillStyle=r,s.forEach(({x:y,y:k,width:S,height:M})=>{o.beginPath(),g.call(o,y,k,S,M,d),o.closePath(),o.fill()})),(i==="stroke"||t.style==="stroke_fill")&&a>0&&!jm(l)){o.strokeStyle=l,o.fillStyle=l,o.lineWidth=a,c==="dashed"?o.setLineDash(v):o.setLineDash([]);const y=a%2===1?.5:0,k=Math.round(y*2);s.forEach(({x:S,y:M,width:I,height:C})=>{I>a*2&&C>a*2?(o.beginPath(),g.call(o,S+y,M+y,I-k,C-k,d),o.closePath(),o.stroke()):_||o.fillRect(S,M,I,C)})}}const o3={name:"rect",checkEventOn:I1,draw:(o,e,t)=>{ub(o,e,t)}};function pb(o,e){const{size:t=12,paddingLeft:s=0,paddingTop:i=0,paddingRight:r=0,paddingBottom:a=0,weight:l="normal",family:c}=e,{x:d,y:v,text:g,align:_="left",baseline:y="top",width:k,height:S}=o,M=k??s+mp(g,t,l,c)+r,I=S??i+t+a;let C=0;switch(_){case"left":case"start":{C=d;break}case"right":case"end":{C=d-M;break}default:{C=d-M/2;break}}let T=0;switch(y){case"top":case"hanging":{T=v;break}case"bottom":case"ideographic":case"alphabetic":{T=v-I;break}default:{T=v-I/2;break}}return{x:C,y:T,width:M,height:I}}function vb(o,e,t){let s=[];s=s.concat(e);for(const i of s){const{x:r,y:a,width:l,height:c}=pb(i,t);if(o.x>=r&&o.x<=r+l&&o.y>=a&&o.y<=a+c)return!0}return!1}function s3(o,e,t){let s=[];s=s.concat(e);const{color:i="currentColor",size:r=12,family:a,weight:l,paddingLeft:c=0,paddingTop:d=0,paddingRight:v=0}=t,g=s.map(_=>pb(_,t));ub(o,g,{...t,color:t.backgroundColor}),o.textAlign="left",o.textBaseline="top",o.font=Ff(r,l,a),o.fillStyle=i,s.forEach((_,y)=>{const k=g[y];o.fillText(_.text,k.x+c,k.y+d,k.width-c-v)})}const n3={name:"text",checkEventOn:vb,draw:(o,e,t)=>{s3(o,e,t)}};function i3(o,e){const t=o.x-e.x,s=o.y-e.y;return Math.sqrt(t*t+s*s)}function fb(o,e){let t=[];t=t.concat(e);for(const s of t)if(Math.abs(i3(o,s)-s.r)<tp){const{r:i,startAngle:r,endAngle:a}=s,l=i*Math.cos(r)+s.x,c=i*Math.sin(r)+s.y,d=i*Math.cos(a)+s.x,v=i*Math.sin(a)+s.y;if(o.x<=Math.max(l,d)+tp&&o.x>=Math.min(l,d)-tp&&o.y<=Math.max(c,v)+tp&&o.y>=Math.min(c,v)-tp)return!0}return!1}function r3(o,e,t){let s=[];s=s.concat(e);const{style:i="solid",size:r=1,color:a="currentColor",dashedValue:l=[2,2]}=t;o.lineWidth=r,o.strokeStyle=a,i==="dashed"?o.setLineDash(l):o.setLineDash([]),s.forEach(({x:c,y:d,r:v,startAngle:g,endAngle:_})=>{o.beginPath(),o.arc(c,d,v,g,_),o.stroke(),o.closePath()})}const a3={name:"arc",checkEventOn:fb,draw:(o,e,t)=>{r3(o,e,t)}};function my(o,e,t,s,i,r,a){const[l,c,d,v,g,_,y]=s,k=a?e+_:_+i,S=a?t+y:y+r;l3(e,t,l,c,d,v,g,k,S).forEach(I=>{o.bezierCurveTo(I[0],I[1],I[2],I[3],I[4],I[5])})}function l3(o,e,t,s,i,r,a,l,c){const{cx:d,cy:v,startAngle:g,deltaAngle:_}=c3(o,e,t,s,i,r,a,l,c),y=[],k=Math.ceil(Math.abs(_)/(Math.PI/2));for(let S=0;S<k;S++){const M=g+S*_/k,I=g+(S+1)*_/k,C=d3(d,v,t,s,i,M,I);y.push(C)}return y}function c3(o,e,t,s,i,r,a,l,c){const d=i*Math.PI/180,v=(o-l)/2,g=(e-c)/2,_=Math.cos(d)*v+Math.sin(d)*g,y=-Math.sin(d)*v+Math.cos(d)*g,k=_**2/t**2+y**2/s**2;k>1&&(t*=Math.sqrt(k),s*=Math.sqrt(k));const S=r===a?-1:1,M=t**2*s**2-t**2*y**2-s**2*_**2,I=t**2*y**2+s**2*_**2,C=S*Math.sqrt(Math.abs(M/I))*(t*y/s),T=S*Math.sqrt(Math.abs(M/I))*(-s*_/t),z=Math.cos(d)*C-Math.sin(d)*T+(o+l)/2,j=Math.sin(d)*C+Math.cos(d)*T+(e+c)/2,B=Math.atan2((y-T)/s,(_-C)/t);let $=Math.atan2((-y-T)/s,(-_-C)/t)-B;return $<0&&a===1?$+=2*Math.PI:$>0&&a===0&&($-=2*Math.PI),{cx:z,cy:j,startAngle:B,deltaAngle:$}}function d3(o,e,t,s,i,r,a){const l=Math.sin(a-r)*(Math.sqrt(4+3*Math.tan((a-r)/2)**2)-1)/3,c=Math.cos(i),d=Math.sin(i),v=o+t*Math.cos(r)*c-s*Math.sin(r)*d,g=e+t*Math.cos(r)*d+s*Math.sin(r)*c,_=o+t*Math.cos(a)*c-s*Math.sin(a)*d,y=e+t*Math.cos(a)*d+s*Math.sin(a)*c,k=v+l*(-t*Math.sin(r)*c-s*Math.cos(r)*d),S=g+l*(-t*Math.sin(r)*d+s*Math.cos(r)*c),M=_-l*(-t*Math.sin(a)*c-s*Math.cos(a)*d),I=y-l*(-t*Math.sin(a)*d+s*Math.cos(a)*c);return[k,S,M,I,_,y]}function u3(o,e,t){let s=[];s=s.concat(e);const{lineWidth:i=1,color:r="currentColor"}=t;o.lineWidth=i,o.strokeStyle=r,o.setLineDash([]),s.forEach(({x:a,y:l,path:c})=>{const d=c.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/gi);if(Uo(d)){const v=a,g=l;o.beginPath(),d.forEach(_=>{let y=0,k=0,S=0,M=0;const I=_[0],C=_.slice(1).trim().split(/[\s,]+/).map(Number);switch(I){case"M":y=C[0]+v,k=C[1]+g,o.moveTo(y,k),S=y,M=k;break;case"m":y+=C[0],k+=C[1],o.moveTo(y,k),S=y,M=k;break;case"L":y=C[0]+v,k=C[1]+g,o.lineTo(y,k);break;case"l":y+=C[0],k+=C[1],o.lineTo(y,k);break;case"H":y=C[0]+v,o.lineTo(y,k);break;case"h":y+=C[0],o.lineTo(y,k);break;case"V":k=C[0]+g,o.lineTo(y,k);break;case"v":k+=C[0],o.lineTo(y,k);break;case"C":o.bezierCurveTo(C[0]+v,C[1]+g,C[2]+v,C[3]+g,C[4]+v,C[5]+g),y=C[4]+v,k=C[5]+g;break;case"c":o.bezierCurveTo(y+C[0],k+C[1],y+C[2],k+C[3],y+C[4],k+C[5]),y+=C[4],k+=C[5];break;case"S":o.bezierCurveTo(y,k,C[0]+v,C[1]+g,C[2]+v,C[3]+g),y=C[2]+v,k=C[3]+g;break;case"s":o.bezierCurveTo(y,k,y+C[0],k+C[1],y+C[2],k+C[3]),y+=C[2],k+=C[3];break;case"Q":o.quadraticCurveTo(C[0]+v,C[1]+g,C[2]+v,C[3]+g),y=C[2]+v,k=C[3]+g;break;case"q":o.quadraticCurveTo(y+C[0],k+C[1],y+C[2],k+C[3]),y+=C[2],k+=C[3];break;case"T":o.quadraticCurveTo(y,k,C[0]+v,C[1]+g),y=C[0]+v,k=C[1]+g;break;case"t":o.quadraticCurveTo(y,k,y+C[0],k+C[1]),y+=C[0],k+=C[1];break;case"A":my(o,y,k,C,v,g,!1),y=C[5]+v,k=C[6]+g;break;case"a":my(o,y,k,C,v,g,!0),y+=C[5],k+=C[6];break;case"Z":case"z":o.closePath(),y=S,k=M;break}}),t.style==="fill"?o.fill():o.stroke()}})}const p3={name:"path",checkEventOn:I1,draw:(o,e,t)=>{u3(o,e,t)}},v3={name:"image",draw:(o,e)=>{const{x:t,y:s,width:i,height:r,image:a,borderRadius:l=0}=e;if(!(!a||!a.complete||a.naturalWidth===0))if(l&&l>0){o.save();const c=Math.min(l,Math.floor(Math.min(i,r)/2));o.beginPath(),o.moveTo(t+c,s),o.arcTo(t+i,s,t+i,s+r,c),o.arcTo(t+i,s+r,t,s+r,c),o.arcTo(t,s+r,t,s,c),o.arcTo(t,s,t+i,s,c),o.closePath(),o.clip(),o.drawImage(a,t,s,i,r),o.restore()}else o.drawImage(a,t,s,i,r)},checkEventOn:(o,e)=>!1},M1={},f3=[Q6,k6,t3,o3,n3,a3,p3,v3];f3.forEach(o=>{M1[o.name]=zh.extend(o)});function m3(o){M1[o.name]=zh.extend(o)}function g3(o){return M1[o]??null}class kv extends k1{constructor(t){super();ve(this,"_widget");this._widget=t}getWidget(){return this._widget}createFigure(t,s){const i=g3(t.name);if(i!==null){const r=new i(t);if(Uo(s)){for(const a in s)s.hasOwnProperty(a)&&r.registerEvent(a,s[a]);this.addChild(r)}return r}return null}draw(t,...s){this.clear(),this.drawImp(t,s)}checkEventOn(t){return!0}}class h3 extends kv{drawImp(e){var c,d;const t=this.getWidget(),s=this.getWidget().getPane(),i=s.getChart(),r=t.getBounding(),a=i.getStyles().grid;if(a.show){e.save(),e.globalCompositeOperation="destination-over";const v=a.horizontal;if(v.show){const S=s.getAxisComponent().getTicks().map(M=>({coordinates:[{x:0,y:M.coord},{x:r.width,y:M.coord}]}));(c=this.createFigure({name:"line",attrs:S,styles:v}))==null||c.draw(e)}const _=a.vertical;if(_.show){const S=i.getXAxisPane().getAxisComponent().getTicks(),M=S.map(I=>({coordinates:[{x:I.coord,y:0},{x:I.coord,y:r.height}]}));if(S.length>=2){const I=S[S.length-1].coord,C=S[S.length-2].coord,T=I-C;if(T>0){let z=I+T;for(;z<=r.width;)M.push({coordinates:[{x:z,y:0},{x:z,y:r.height}]}),z+=T}}(d=this.createFigure({name:"line",attrs:M,styles:_}))==null||d.draw(e)}e.restore()}}}class mb extends kv{eachChildren(e){const s=this.getWidget().getPane().getChart().getChartStore(),i=s.getVisibleRangeDataList(),r=s.getBarSpace(),a=i.length;let l=0;for(;l<a;)e(i[l],r,l),++l}}class gb extends mb{constructor(){super(...arguments);ve(this,"_boundCandleBarClickEvent",t=>()=>(this.getWidget().getPane().getChart().getChartStore().executeAction("onCandleBarClick",t),!1))}drawImp(t){const s=this.getWidget().getPane(),i=s.getId()===pc.CANDLE,r=s.getChart().getChartStore(),a=this.getCandleBarOptions();if(a!==null){const{type:l,styles:c}=a;let d=0,v=0;if(a.type==="ohlc"){const{gapBar:_}=r.getBarSpace();d=Math.min(Math.max(Math.round(_*.2),1),8),d>2&&d%2===1&&d--,v=Math.floor(d/2)}const g=s.getAxisComponent();this.eachChildren((_,y)=>{const{x:k,data:{current:S,prev:M}}=_;if(Uo(S)){const{open:I,high:C,low:T,close:z}=S,j=c.compareRule==="current_open"?I:(M==null?void 0:M.close)??z,B=[];z>j?(B[0]=c.upColor,B[1]=c.upBorderColor,B[2]=c.upWickColor):z<j?(B[0]=c.downColor,B[1]=c.downBorderColor,B[2]=c.downWickColor):(B[0]=c.noChangeColor,B[1]=c.noChangeBorderColor,B[2]=c.noChangeWickColor);const $=g.convertToPixel(I),F=g.convertToPixel(z),V=[$,F,g.convertToPixel(C),g.convertToPixel(T)];V.sort((Z,ne)=>Z-ne);const K=y.gapBar%2===0?1:0;let Y=[];switch(l){case"candle_solid":{Y=this._createSolidBar(k,V,y,B,K);break}case"candle_stroke":{Y=this._createStrokeBar(k,V,y,B,K);break}case"candle_up_stroke":{z>I?Y=this._createStrokeBar(k,V,y,B,K):Y=this._createSolidBar(k,V,y,B,K);break}case"candle_down_stroke":{I>z?Y=this._createStrokeBar(k,V,y,B,K):Y=this._createSolidBar(k,V,y,B,K);break}case"ohlc":{Y=[{name:"rect",attrs:[{x:k-v,y:V[0],width:d,height:V[3]-V[0]},{x:k-y.halfGapBar,y:$+d>V[3]?V[3]-d:$,width:y.halfGapBar-v,height:d},{x:k+v,y:F+d>V[3]?V[3]-d:F,width:y.halfGapBar-v,height:d}],styles:{color:B[0]}}];break}}Y.forEach(Z=>{var te;let ne=null;i&&(ne={mouseClickEvent:this._boundCandleBarClickEvent(_)}),(te=this.createFigure(Z,ne??void 0))==null||te.draw(t)})}})}}getCandleBarOptions(){const t=this.getWidget().getPane().getChart().getStyles().candle;return{type:t.type,styles:t.bar}}_createSolidBar(t,s,i,r,a){return[{name:"rect",attrs:{x:t,y:s[0],width:1,height:s[3]-s[0]},styles:{color:r[2]}},{name:"rect",attrs:{x:t-i.halfGapBar,y:s[1],width:i.gapBar+a,height:Math.max(1,s[2]-s[1])},styles:{style:"stroke_fill",color:r[0],borderColor:r[1]}}]}_createStrokeBar(t,s,i,r,a){return[{name:"rect",attrs:[{x:t,y:s[0],width:1,height:s[1]-s[0]},{x:t,y:s[2],width:1,height:s[3]-s[2]}],styles:{color:r[2]}},{name:"rect",attrs:{x:t-i.halfGapBar,y:s[1],width:i.gapBar+a,height:Math.max(1,s[2]-s[1])},styles:{style:"stroke",borderColor:r[1]}}]}}class _3 extends gb{getCandleBarOptions(){const e=this.getWidget().getPane();if(!e.getAxisComponent().isInCandle()){const s=e.getChart().getChartStore(),i=s.getIndicatorsByPaneId(e.getId());for(const r of i)if(r.shouldOhlc&&r.visible){const a=r.styles,l=s.getStyles().indicator,c=Hu(a,"ohlc.compareRule",l.ohlc.compareRule),d=Hu(a,"ohlc.upColor",l.ohlc.upColor),v=Hu(a,"ohlc.downColor",l.ohlc.downColor),g=Hu(a,"ohlc.noChangeColor",l.ohlc.noChangeColor);return{type:"ohlc",styles:{compareRule:c,upColor:d,downColor:v,noChangeColor:g,upBorderColor:d,downBorderColor:v,noChangeBorderColor:g,upWickColor:d,downWickColor:v,noChangeWickColor:g}}}}return null}drawImp(e){super.drawImp(e);const t=this.getWidget(),s=t.getPane(),i=s.getChart(),r=t.getBounding(),a=i.getXAxisPane().getAxisComponent(),l=s.getAxisComponent(),c=i.getChartStore(),d=c.getIndicatorsByPaneId(s.getId()),v=c.getStyles().indicator;e.save(),d.forEach(g=>{if(g.visible){g.zLevel<0?e.globalCompositeOperation="destination-over":e.globalCompositeOperation="source-over";let _=!1;if(g.draw!==null&&(e.save(),_=g.draw({ctx:e,chart:i,indicator:g,bounding:r,xAxis:a,yAxis:l}),e.restore()),!_){const y=g.result,k=[];this.eachChildren((S,M)=>{var ne,te,oe,U,J,se;const{halfGapBar:I}=M,{dataIndex:C,x:T,data:z}=S,j=a.convertToPixel(C-1),B=a.convertToPixel(C+1),$=y[((ne=z.prev)==null?void 0:ne.timestamp)??""]??{},F=y[((te=z.current)==null?void 0:te.timestamp)??""]??{},V=y[((oe=z.next)==null?void 0:oe.timestamp)??""]??{},K={x:j},Y={x:T},Z={x:B};g.figures.forEach(({key:W})=>{const le=$[W];ja(le)&&(K[W]=l.convertToPixel(le));const ye=F[W];ja(ye)&&(Y[W]=l.convertToPixel(ye));const Ce=V[W];ja(Ce)&&(Z[W]=l.convertToPixel(Ce))}),x1(g,{prev:((U=z.prev)==null?void 0:U.timestamp)??null,current:((J=z.current)==null?void 0:J.timestamp)??null,next:((se=z.next)==null?void 0:se.timestamp)??null},v,(W,le,ye)=>{var Ce,Re;if(Uo(F[W.key])){const Ke=Y[W.key];let st=(Ce=W.attrs)==null?void 0:Ce.call(W,{data:{prev:$,current:F,next:V},coordinate:{prev:K,current:Y,next:Z},bounding:r,barSpace:M,xAxis:a,yAxis:l});if(!Uo(st))switch(W.type){case"circle":{st={x:T,y:Ke,r:Math.max(1,I)};break}case"rect":case"bar":{const Je=W.baseValue??l.getRange().from,ot=l.convertToPixel(Je);let nt=Math.abs(ot-Ke);Je!==F[W.key]&&(nt=Math.max(1,nt));let tt=0;Ke>ot?tt=ot:tt=Ke,st={x:T-I,y:tt,width:Math.max(1,I*2),height:nt};break}case"line":{Uo(k[ye])||(k[ye]=[]),ja(Y[W.key])&&ja(Z[W.key])&&k[ye].push({coordinates:[{x:Y.x,y:Y[W.key]},{x:Z.x,y:Z[W.key]}],styles:le});break}}const vt=W.type;Uo(st)&&vt!=="line"&&((Re=this.createFigure({name:vt==="bar"?"rect":vt,attrs:st,styles:le}))==null||Re.draw(e))}})}),k.forEach(S=>{var M,I,C,T;if(S.length>1){const z=[{coordinates:[S[0].coordinates[0],S[0].coordinates[1]],styles:S[0].styles}];for(let j=1;j<S.length;j++){const B=z[z.length-1],$=S[j],F=B.coordinates[B.coordinates.length-1];F.x===$.coordinates[0].x&&F.y===$.coordinates[0].y&&B.styles.style===$.styles.style&&B.styles.color===$.styles.color&&B.styles.size===$.styles.size&&B.styles.smooth===$.styles.smooth&&((M=B.styles.dashedValue)==null?void 0:M[0])===((I=$.styles.dashedValue)==null?void 0:I[0])&&((C=B.styles.dashedValue)==null?void 0:C[1])===((T=$.styles.dashedValue)==null?void 0:T[1])?B.coordinates.push($.coordinates[1]):z.push({coordinates:[$.coordinates[0],$.coordinates[1]],styles:$.styles})}z.forEach(({coordinates:j,styles:B})=>{var $;($=this.createFigure({name:"line",attrs:{coordinates:j},styles:B}))==null||$.draw(e)})}})}}}),e.restore()}}class y3 extends kv{drawImp(e){const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=t.getPane().getChart().getChartStore(),a=r.getCrosshair(),l=r.getStyles().crosshair;if(pd(a.paneId)&&l.show){if(a.paneId===s.getId()){const d=a.y;this._drawLine(e,[{x:0,y:d},{x:i.width,y:d}],l.horizontal)}const c=a.realX;this._drawLine(e,[{x:c,y:0},{x:c,y:i.height}],l.vertical)}}_drawLine(e,t,s){var i;if(s.show){const r=s.line;r.show&&((i=this.createFigure({name:"line",attrs:{coordinates:t},styles:r}))==null||i.draw(e))}}}class hb extends kv{constructor(t){super(t);ve(this,"_activeFeatureInfo",null);ve(this,"_featureClickEvent",(t,s)=>()=>(this.getWidget().getPane().getChart().getChartStore().executeAction(t,s),!0));ve(this,"_featureMouseMoveEvent",t=>()=>(this._activeFeatureInfo=t,!0));this.registerEvent("mouseMoveEvent",s=>(this._activeFeatureInfo=null,!1))}drawImp(t){const s=this.getWidget(),r=s.getPane().getChart().getChartStore(),a=r.getCrosshair();if(Uo(a.kLineData)){const l=s.getBounding(),{offsetLeft:c,offsetTop:d,offsetRight:v}=r.getStyles().indicator.tooltip;this.drawIndicatorTooltip(t,c,d,l.width-v)}}drawIndicatorTooltip(t,s,i,r){const a=this.getWidget().getPane(),l=a.getChart().getChartStore(),d=l.getStyles().indicator.tooltip;if(this.isDrawTooltip(l.getCrosshair(),d)){const v=l.getIndicatorsByPaneId(a.getId()),g=d.title,_=d.legend;v.forEach(y=>{let k=0;const S={x:s,y:i},{name:M,calcParamsText:I,legends:C,features:T}=this.getIndicatorTooltipData(y),z=M.length>0,j=C.length>0;if(z||j){const B=this.classifyTooltipFeatures(T);if(k=this.drawStandardTooltipFeatures(t,B[0],S,y,s,k,r),z){let $=M;I.length>0&&($=`${$}${I}`);const F=g.color;k=this.drawStandardTooltipLegends(t,[{title:{text:"",color:F},value:{text:$,color:F}}],S,s,k,r,g)}k=this.drawStandardTooltipFeatures(t,B[1],S,y,s,k,r),j&&(k=this.drawStandardTooltipLegends(t,C,S,s,k,r,_)),k=this.drawStandardTooltipFeatures(t,B[2],S,y,s,k,r),i=S.y+k}})}return i}drawStandardTooltipFeatures(t,s,i,r,a,l,c){if(s.length>0){let d=0,v=0;s.forEach(y=>{const{marginLeft:k=0,marginTop:S=0,marginRight:M=0,marginBottom:I=0,paddingLeft:C=0,paddingTop:T=0,paddingRight:z=0,paddingBottom:j=0,size:B=0,type:$,content:F}=y;let V=0;if($==="icon_font"){const K=F;t.font=Ff(B,"normal",K.family),V=t.measureText(K.code).width}else V=B;d+=k+C+V+z+M,v=Math.max(v,S+T+B+j+I)}),i.x+d>c?(i.x=a,i.y+=l,l=v):l=Math.max(l,v);const _=this.getWidget().getPane().getId();s.forEach(y=>{var W,le,ye,Ce,Re;const{marginLeft:k=0,marginTop:S=0,marginRight:M=0,paddingLeft:I=0,paddingTop:C=0,paddingRight:T=0,paddingBottom:z=0,backgroundColor:j,activeBackgroundColor:B,borderRadius:$,size:F=0,color:V,activeColor:K,type:Y,content:Z}=y;let ne=V,te=j;((W=this._activeFeatureInfo)==null?void 0:W.paneId)===_&&((le=this._activeFeatureInfo.indicator)==null?void 0:le.id)===(r==null?void 0:r.id)&&this._activeFeatureInfo.feature.id===y.id&&(ne=K??V,te=B??j);let oe="onCandleTooltipFeatureClick";const U={paneId:_,feature:y};Uo(r)&&(oe="onIndicatorTooltipFeatureClick",U.indicator=r);const J={mouseClickEvent:this._featureClickEvent(oe,U),mouseMoveEvent:this._featureMouseMoveEvent(U)};let se=0;if(Y==="icon_font"){const Ke=Z;(ye=this.createFigure({name:"text",attrs:{text:Ke.code,x:i.x+k,y:i.y+S},styles:{paddingLeft:I,paddingTop:C,paddingRight:T,paddingBottom:z,borderRadius:$,size:F,family:Ke.family,color:ne,backgroundColor:te}},J))==null||ye.draw(t),se=t.measureText(Ke.code).width}else{(Ce=this.createFigure({name:"rect",attrs:{x:i.x+k,y:i.y+S,width:F,height:F},styles:{paddingLeft:I,paddingTop:C,paddingRight:T,paddingBottom:z,color:te}},J))==null||Ce.draw(t);const Ke=Z;(Re=this.createFigure({name:"path",attrs:{path:Ke.path,x:i.x+k+I,y:i.y+S+C,width:F,height:F},styles:{style:Ke.style,lineWidth:Ke.lineWidth,color:ne}}))==null||Re.draw(t),se=F}i.x+=k+I+se+T+M})}return l}drawStandardTooltipLegends(t,s,i,r,a,l,c){if(s.length>0){const{marginLeft:d,marginTop:v,marginRight:g,marginBottom:_,size:y,family:k,weight:S}=c;t.font=Ff(y,S,k),s.forEach(M=>{var F,V;const I=M.title,C=M.value,T=t.measureText(I.text).width,z=t.measureText(C.text).width,j=I.text.length>0&&C.text.length>0?2:0,B=T+j+z,$=v+y+_;i.x+d+B+g>l?(i.x=r,i.y+=a,a=$):a=Math.max(a,$),I.text.length>0&&((F=this.createFigure({name:"text",attrs:{x:i.x+d,y:i.y+v,text:I.text},styles:{color:I.color,size:y,family:k,weight:S}}))==null||F.draw(t)),(V=this.createFigure({name:"text",attrs:{x:i.x+d+T+j,y:i.y+v,text:C.text},styles:{color:C.color,size:y,family:k,weight:S}}))==null||V.draw(t),i.x+=d+B+g})}return a}isDrawTooltip(t,s){const i=s.showRule;return i==="always"||i==="follow_cross"&&pd(t.paneId)}getIndicatorTooltipData(t){var M;const s=this.getWidget().getPane().getChart().getChartStore(),i=s.getStyles().indicator,r=i.tooltip,a=r.title;let l="",c="";if(a.show&&(a.showName&&(l=t.shortName),a.showParams)){const I=t.calcParams;I.length>0&&(c=`(${I.join(",")})`)}const d={name:l,calcParamsText:c,legends:[],features:r.features},v=s.getCrosshair().dataIndex,g=t.result,_=s.getInnerFormatter(),y=s.getDecimalFold(),k=s.getThousandsSeparator(),S=[];if(t.visible){const I=s.getDataList(),C=I[v]??{},T=I[v-1]??{};let z=g[C.timestamp];!Uo(z)&&v===I.length-1&&(z=g[T.timestamp]);const j=r.legend.defaultValue;x1(t,{prev:T.timestamp,current:C.timestamp,next:(M=I[v])==null?void 0:M.timestamp},i,(B,$)=>{if(pd(B.title)){const F=$.color;let V=z==null?void 0:z[B.key];ja(V)&&(V=vp(V,t.precision),t.shouldFormatBigNumber&&(V=_.formatBigNumber(V)),V=y.format(k.format(V))),S.push({title:{text:B.title,color:F},value:{text:V??j,color:F}})}}),d.legends=S}if(Vp(t.createTooltipDataSource)){const I=this.getWidget(),C=I.getPane(),T=C.getChart(),{name:z,calcParamsText:j,legends:B,features:$}=t.createTooltipDataSource({chart:T,indicator:t,crosshair:s.getCrosshair(),bounding:I.getBounding(),xAxis:C.getChart().getXAxisPane().getAxisComponent(),yAxis:C.getAxisComponent()});if(a.show&&(pd(z)&&a.showName&&(d.name=z),pd(j)&&a.showParams&&(d.calcParamsText=j)),Uo($)&&(d.features=$),Uo(B)&&t.visible){const F=[],V=i.tooltip.legend.color;B.forEach(K=>{let Y={text:"",color:V};rv(K.title)?Y=K.title:Y.text=K.title;let Z={text:"",color:V};rv(K.value)?Z=K.value:Z.text=K.value,ja(Number(Z.text))&&(Z.text=y.format(k.format(Z.text))),F.push({title:Y,value:Z})}),d.legends=F}}return d}classifyTooltipFeatures(t){const s=[],i=[],r=[];return t.forEach(a=>{switch(a.position){case"left":{s.push(a);break}case"middle":{i.push(a);break}case"right":{r.push(a);break}}}),[s,i,r]}}class _b extends kv{constructor(e){super(e),this._initEvent()}_initEvent(){const e=this.getWidget(),t=e.getPane(),s=t.getId(),i=t.getChart(),r=i.getChartStore();this.registerEvent("mouseMoveEvent",a=>{var c;const l=r.getProgressOverlayInfo();if(l!==null){const d=l.overlay;let v=l.paneId;d.isStart()&&(r.updateProgressOverlayInfo(s),v=s);const g=d.points.length-1;if(d.isDrawing()&&v===s){const _=this._coordinateToPoint(d,a);d.eventMoveForDrawing(_),(c=d.onDrawing)==null||c.call(d,{chart:i,overlay:d,...a})}return this._figureMouseMoveEvent(d,"point",g,{key:`${km}point_${g}`,type:"circle",attrs:{}})(a)}return r.setHoverOverlayInfo({paneId:s,overlay:null,figureType:"none",figureIndex:-1,figure:null},(d,v)=>this._processOverlayMouseEnterEvent(d,v,a),(d,v)=>this._processOverlayMouseLeaveEvent(d,v,a)),e.setForceCursor(null),!1}).registerEvent("mouseClickEvent",a=>{var c,d;const l=r.getProgressOverlayInfo();if(l!==null){const v=l.overlay;let g=l.paneId;v.isStart()&&(r.updateProgressOverlayInfo(s,!0),g=s);const _=v.points.length-1;if(v.isDrawing()&&g===s){const y=this._coordinateToPoint(v,a);v.eventMoveForDrawing(y),(c=v.onDrawing)==null||c.call(v,{chart:i,overlay:v,...a}),v.nextStep(),v.isDrawing()||(r.progressOverlayComplete(),(d=v.onDrawEnd)==null||d.call(v,{chart:i,overlay:v,...a}))}return this._figureMouseClickEvent(v,"point",_,{key:`${km}point_${_}`,type:"circle",attrs:{}})(a)}return r.setClickOverlayInfo({paneId:s,overlay:null,figureType:"none",figureIndex:-1,figure:null},(v,g)=>this._processOverlaySelectedEvent(v,g,a),(v,g)=>this._processOverlayDeselectedEvent(v,g,a)),!1}).registerEvent("mouseDoubleClickEvent",a=>{var c;const l=r.getProgressOverlayInfo();if(l!==null){const d=l.overlay,v=l.paneId;d.isDrawing()&&v===s&&(d.forceComplete(),d.isDrawing()||(r.progressOverlayComplete(),(c=d.onDrawEnd)==null||c.call(d,{chart:i,overlay:d,...a})));const g=d.points.length-1;return this._figureMouseClickEvent(d,"point",g,{key:`${km}point_${g}`,type:"circle",attrs:{}})(a)}return!1}).registerEvent("mouseRightClickEvent",a=>{const l=r.getProgressOverlayInfo();if(l!==null){const c=l.overlay;if(c.isDrawing()){const d=c.points.length-1;return this._figureMouseRightClickEvent(c,"point",d,{key:`${km}point_${d}`,type:"circle",attrs:{}})(a)}}return!1}).registerEvent("mouseUpEvent",a=>{var d;const{overlay:l,figure:c}=r.getPressedOverlayInfo();return l!==null&&Dv("onPressedMoveEnd",c)&&((d=l.onPressedMoveEnd)==null||d.call(l,{chart:i,overlay:l,figure:c??void 0,...a})),r.setPressedOverlayInfo({paneId:s,overlay:null,figureType:"none",figureIndex:-1,figure:null}),!1}).registerEvent("pressedMouseMoveEvent",a=>{var g;const{overlay:l,figureType:c,figureIndex:d,figure:v}=r.getPressedOverlayInfo();if(l!==null&&Dv("onPressedMoving",v)){if(!l.lock){const _=this._coordinateToPoint(l,a);c==="point"?l.eventPressedPointMove(_,d):l.eventPressedOtherMove(_,this.getWidget().getPane().getChart().getChartStore());let y=!1;(g=l.onPressedMoving)==null||g.call(l,{chart:i,overlay:l,figure:v??void 0,...a,preventDefault:()=>{y=!0}}),y?this.getWidget().setForceCursor(null):this.getWidget().setForceCursor("pointer")}return!0}return this.getWidget().setForceCursor(null),!1})}_createFigureEvents(e,t,s,i){return e.isDrawing()?null:{mouseMoveEvent:this._figureMouseMoveEvent(e,t,s,i),mouseDownEvent:this._figureMouseDownEvent(e,t,s,i),mouseClickEvent:this._figureMouseClickEvent(e,t,s,i),mouseRightClickEvent:this._figureMouseRightClickEvent(e,t,s,i),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(e,t,s,i)}}_processOverlayMouseEnterEvent(e,t,s){return Vp(e.onMouseEnter)&&Dv("onMouseEnter",t)?(e.onMouseEnter({chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_processOverlayMouseLeaveEvent(e,t,s){return Vp(e.onMouseLeave)&&Dv("onMouseLeave",t)?(e.onMouseLeave({chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_processOverlaySelectedEvent(e,t,s){var i;return Dv("onSelected",t)?((i=e.onSelected)==null||i.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_processOverlayDeselectedEvent(e,t,s){var i;return Dv("onDeselected",t)?((i=e.onDeselected)==null||i.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_figureMouseMoveEvent(e,t,s,i){return r=>{var c;const a=this.getWidget().getPane(),l=!e.isDrawing()&&Dv("onMouseMove",i);if(l){let d=!1;(c=e.onMouseMove)==null||c.call(e,{chart:a.getChart(),overlay:e,figure:i,...r,preventDefault:()=>{d=!0}}),d?this.getWidget().setForceCursor(null):this.getWidget().setForceCursor("pointer")}return a.getChart().getChartStore().setHoverOverlayInfo({paneId:a.getId(),overlay:e,figureType:t,figure:i,figureIndex:s},(d,v)=>this._processOverlayMouseEnterEvent(d,v,r),(d,v)=>this._processOverlayMouseLeaveEvent(d,v,r)),l}}_figureMouseDownEvent(e,t,s,i){return r=>{var c;const a=this.getWidget().getPane(),l=a.getId();return e.startPressedMove(this._coordinateToPoint(e,r)),Dv("onPressedMoveStart",i)?((c=e.onPressedMoveStart)==null||c.call(e,{chart:a.getChart(),overlay:e,figure:i,...r}),a.getChart().getChartStore().setPressedOverlayInfo({paneId:l,overlay:e,figureType:t,figureIndex:s,figure:i}),!e.isDrawing()):!1}}_figureMouseClickEvent(e,t,s,i){return r=>{var d;const a=this.getWidget().getPane(),l=a.getId(),c=!e.isDrawing()&&Dv("onClick",i);return c&&((d=e.onClick)==null||d.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:i,...r})),a.getChart().getChartStore().setClickOverlayInfo({paneId:l,overlay:e,figureType:t,figureIndex:s,figure:i},(v,g)=>this._processOverlaySelectedEvent(v,g,r),(v,g)=>this._processOverlayDeselectedEvent(v,g,r)),c}}_figureMouseDoubleClickEvent(e,t,s,i){return r=>{var a;return Dv("onDoubleClick",i)?((a=e.onDoubleClick)==null||a.call(e,{...r,chart:this.getWidget().getPane().getChart(),figure:i,overlay:e}),!e.isDrawing()):!1}}_figureMouseRightClickEvent(e,t,s,i){return r=>{var a;if(Dv("onRightClick",i)){let l=!1;return(a=e.onRightClick)==null||a.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:i,...r,preventDefault:()=>{l=!0}}),l||this.getWidget().getPane().getChart().getChartStore().removeOverlay(e),!e.isDrawing()}return!1}}_coordinateToPoint(e,t){const s={},i=this.getWidget().getPane(),r=i.getChart(),a=i.getId(),l=r.getChartStore();if(this.coordinateToPointTimestampDataIndexFlag()){const d=r.getXAxisPane().getAxisComponent().convertFromPixel(t.x),v=l.dataIndexToTimestamp(d)??void 0;s.timestamp=v,s.dataIndex=d}if(this.coordinateToPointValueFlag()){const c=i.getAxisComponent();let d=c.convertFromPixel(t.y);if(e.mode!=="normal"&&a===pc.CANDLE&&ja(s.dataIndex)){const v=l.getDataByDataIndex(s.dataIndex);if(v!==null){const g=e.modeSensitivity;if(d>v.high)if(e.mode==="weak_magnet"){const _=c.convertToPixel(v.high),y=c.convertFromPixel(_-g);d<y&&(d=v.high)}else d=v.high;else if(d<v.low)if(e.mode==="weak_magnet"){const _=c.convertToPixel(v.low),y=c.convertFromPixel(_-g);d>y&&(d=v.low)}else d=v.low;else{const _=Math.max(v.open,v.close),y=Math.min(v.open,v.close);d>_?d-_<v.high-d?d=_:d=v.high:d<y?d-v.low<y-d?d=v.low:d=y:_-d<d-y?d=_:d=y}}}s.value=d}return s}coordinateToPointValueFlag(){return!0}coordinateToPointTimestampDataIndexFlag(){return!0}dispatchEvent(e,t){return this.getWidget().getPane().getChart().getChartStore().isOverlayDrawing()?this.onEvent(e,t):super.dispatchEvent(e,t)}drawImp(e){this.getCompleteOverlays().forEach(i=>{i.visible&&this._drawOverlay(e,i)});const s=this.getProgressOverlay();Uo(s)&&s.visible&&this._drawOverlay(e,s)}_drawOverlay(e,t){const{points:s}=t,i=this.getWidget().getPane(),r=i.getChart(),a=r.getChartStore(),l=i.getAxisComponent(),c=r.getXAxisPane().getAxisComponent(),v=a.getDataList().length,g=v-1,_=s.map((y,k)=>{let S=null;ja(y.timestamp)?S=a.timestampToDataIndex(y.timestamp):ja(y.dataIndex)?S=y.dataIndex:v>0&&(S=g);const M={x:0,y:0};return ja(S)&&(M.x=c.convertToPixel(S)),ja(y.value)&&(M.y=(l==null?void 0:l.convertToPixel(y.value))??0),M});if(_.length>0){const y=[].concat(this.getFigures(t,_));this.drawFigures(e,t,y)}this.drawDefaultFigures(e,t,_)}drawFigures(e,t,s){const i=this.getWidget().getPane().getChart().getStyles().overlay;s.forEach((r,a)=>{const{type:l,styles:c,attrs:d}=r;[].concat(d).forEach(g=>{var k,S;const _=this._createFigureEvents(t,"other",a,r),y={...i[l],...(k=t.styles)==null?void 0:k[l],...c};(S=this.createFigure({name:l,attrs:g,styles:y},_??void 0))==null||S.draw(e)})})}getCompleteOverlays(){const e=this.getWidget().getPane();return e.getChart().getChartStore().getOverlaysByPaneId(e.getId())}getProgressOverlay(){const e=this.getWidget().getPane(),t=e.getChart().getChartStore().getProgressOverlayInfo();return Uo(t)&&t.paneId===e.getId()?t.overlay:null}getFigures(e,t){var d;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),a=i.getAxisComponent(),l=r.getXAxisPane().getAxisComponent(),c=s.getBounding();return((d=e.createPointFigures)==null?void 0:d.call(e,{chart:r,overlay:e,coordinates:t,bounding:c,xAxis:l,yAxis:a}))??[]}drawDefaultFigures(e,t,s){var i,r;if(t.needDefaultPointFigure){const a=this.getWidget().getPane().getChart().getChartStore(),l=a.getHoverOverlayInfo(),c=a.getClickOverlayInfo();if(((i=l.overlay)==null?void 0:i.id)===t.id&&l.figureType!=="none"||((r=c.overlay)==null?void 0:r.id)===t.id&&c.figureType!=="none"){const d=a.getStyles().overlay,v=t.styles,g={...d.point,...v==null?void 0:v.point};s.forEach(({x:_,y},k)=>{var T,z,j,B;let S=g.radius,M=g.color,I=g.borderColor,C=g.borderSize;((T=l.overlay)==null?void 0:T.id)===t.id&&l.figureType==="point"&&((z=l.figure)==null?void 0:z.key)===`${km}point_${k}`&&(S=g.activeRadius,M=g.activeColor,I=g.activeBorderColor,C=g.activeBorderSize),(j=this.createFigure({name:"circle",attrs:{x:_,y,r:S+C},styles:{color:I}},this._createFigureEvents(t,"point",k,{key:`${km}point_${k}`,type:"circle",attrs:{x:_,y,r:S+C},styles:{color:I}})??void 0))==null||j.draw(e),(B=this.createFigure({name:"circle",attrs:{x:_,y,r:S},styles:{color:M}}))==null||B.draw(e)})}}}}class yb extends P1{constructor(t,s){super(t,s);ve(this,"_gridView",new h3(this));ve(this,"_indicatorView",new _3(this));ve(this,"_crosshairLineView",new y3(this));ve(this,"_tooltipView",this.createTooltipView());ve(this,"_overlayView",new _b(this));this.addChild(this._tooltipView),this.addChild(this._overlayView)}getName(){return bc.MAIN}updateMain(t){this.getPane().getOptions().state!=="minimize"&&(this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t))}createTooltipView(){return new hb(this)}updateMainContent(t){}updateOverlayContent(t){}updateOverlay(t){this.getPane().getOptions().state!=="minimize"&&(this._overlayView.draw(t),this._crosshairLineView.draw(t),this.updateOverlayContent(t)),this._tooltipView.draw(t)}}class b3 extends mb{constructor(){super(...arguments);ve(this,"_ripplePoint",this.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}));ve(this,"_animationFrameTime",0);ve(this,"_animation",new s1({iterationCount:1/0}).doFrame(t=>{this._animationFrameTime=t;const s=this.getWidget().getPane();s.getChart().updatePane(hd.Main,s.getId())}))}drawImp(t){var M,I,C;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),l=r.getDataList().length-1,c=s.getBounding(),d=i.getAxisComponent(),v=r.getStyles().candle.area,g=[];let _=Number.MAX_SAFE_INTEGER,y=Number.MIN_SAFE_INTEGER,k=null;if(this.eachChildren(T=>{const z=T.x,{current:j}=T.data,B=j==null?void 0:j[v.value];if(ja(B)){const $=d.convertToPixel(B);y===Number.MIN_SAFE_INTEGER&&(y=z),g.push({x:z,y:$}),_=Math.min(_,$),T.dataIndex===l&&(k={x:z,y:$})}}),g.length>0){(M=this.createFigure({name:"line",attrs:{coordinates:g},styles:{color:v.lineColor,size:v.lineSize,smooth:v.smooth}}))==null||M.draw(t);const T=v.backgroundColor;let z="";if(Ov(T)){const j=t.createLinearGradient(0,c.height,0,_);try{T.forEach(({offset:B,color:$})=>{j.addColorStop(B,$)})}catch{}z=j}else z=T;t.fillStyle=z,t.beginPath(),t.moveTo(y,c.height),t.lineTo(g[0].x,g[0].y),sb(t,g,v.smooth),t.lineTo(g[g.length-1].x,c.height),t.closePath(),t.fill()}const S=v.point;if(S.show&&Uo(k)){(I=this.createFigure({name:"circle",attrs:{x:k.x,y:k.y,r:S.radius},styles:{style:"fill",color:S.color}}))==null||I.draw(t);let T=S.rippleRadius;S.animation&&(T=S.radius+this._animationFrameTime/S.animationDuration*(S.rippleRadius-S.radius),this._animation.setDuration(S.animationDuration).start()),(C=this._ripplePoint)==null||C.setAttrs({x:k.x,y:k.y,r:T}).setStyles({style:"fill",color:S.rippleColor}).draw(t)}else this.stopAnimation()}stopAnimation(){this._animation.stop()}}class x3 extends kv{drawImp(e){var c;const s=this.getWidget().getPane(),i=s.getChart().getChartStore(),r=i.getStyles().candle.priceMark,a=r.high,l=r.low;if(r.show&&(a.show||l.show)){const d=i.getVisibleRangeHighLowPrice(),v=((c=i.getSymbol())==null?void 0:c.pricePrecision)??gp.PRICE,g=s.getAxisComponent(),{price:_,x:y}=d[0],{price:k,x:S}=d[1],M=g.convertToPixel(_),I=g.convertToPixel(k),C=i.getDecimalFold(),T=i.getThousandsSeparator();a.show&&_!==Number.MIN_SAFE_INTEGER&&this._drawMark(e,C.format(T.format(vp(_,v))),{x:y,y:M},M<I?[-2,-5]:[2,5],a),l.show&&k!==Number.MAX_SAFE_INTEGER&&this._drawMark(e,C.format(T.format(vp(k,v))),{x:S,y:I},M<I?[2,5]:[-2,-5],l)}}_drawMark(e,t,s,i,r){var y,k,S;const a=s.x,l=s.y+i[0];(y=this.createFigure({name:"line",attrs:{coordinates:[{x:a-2,y:l+i[0]},{x:a,y:l},{x:a+2,y:l+i[0]}]},styles:{color:r.color}}))==null||y.draw(e);let c=0,d=0,v="left";const{width:g}=this.getWidget().getBounding();a>g/2?(c=a-5,d=c-r.textOffset,v="right"):(c=a+5,v="left",d=c+r.textOffset);const _=l+i[1];(k=this.createFigure({name:"line",attrs:{coordinates:[{x:a,y:l},{x:a,y:_},{x:c,y:_}]},styles:{color:r.color}}))==null||k.draw(e),(S=this.createFigure({name:"text",attrs:{x:d,y:_,text:t,align:v,baseline:"middle"},styles:{color:r.color,size:r.textSize,family:r.textFamily,weight:r.textWeight}}))==null||S.draw(e)}}class w3 extends kv{drawImp(e){var d,v;const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=s.getChart().getChartStore(),a=r.getStyles().candle.priceMark,l=a.last,c=l.line;if(a.show&&l.show&&c.show){const g=s.getAxisComponent(),_=r.getDataList(),y=_[_.length-1];if(Uo(y)){const{close:k,open:S}=y,M=l.compareRule==="current_open"?S:((d=_[_.length-2])==null?void 0:d.close)??k,I=g.convertToPixel(k);let C="";k>M?C=l.upColor:k<M?C=l.downColor:C=l.noChangeColor,(v=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:I},{x:i.width,y:I}]},styles:{style:c.style,color:C,size:c.size,dashedValue:c.dashedValue}}))==null||v.draw(e)}}}}const k3={second:"HH:mm:ss",minute:"HH:mm",hour:"MM-DD HH:mm",day:"YYYY-MM-DD",week:"YYYY-MM-DD",month:"YYYY-MM",year:"YYYY"},bb={second:"HH:mm:ss",minute:"YYYY-MM-DD HH:mm",hour:"YYYY-MM-DD HH:mm",day:"YYYY-MM-DD",week:"YYYY-MM-DD",month:"YYYY-MM",year:"YYYY"},S3={time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量：",turnover:"成交额：",change:"涨幅：",second:"秒",minute:"",hour:"小时",day:"天",week:"周",month:"月",year:"年"},C3={time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: ",second:"S",minute:"",hour:"H",day:"D",week:"W",month:"M",year:"Y"},P3={"zh-CN":S3,"en-US":C3};function I3(o,e){return P3[e][o]??o}const $m={},Bg={},lh={},ch={};function M3(o){if(o)return $m[o]}function T3(o){const e=ch[o];!e||e.size===0||e.forEach(t=>{try{t()}catch{}})}async function A3(o,e=2){if($m[o])return $m[o];if(Bg[o])return Bg[o];lh[o]="loading";const t=new Promise((s,i)=>{let r=0;const a=()=>{const l=new Image;l.crossOrigin="anonymous";try{l.referrerPolicy="no-referrer"}catch{}const c=async()=>{var v;try{await((v=l.decode)==null?void 0:v.call(l))}catch{}$m[o]=l,lh[o]="loaded",T3(o),s(l)},d=()=>{if(r+=1,r<=e){const v=Math.min(500*r,1500);setTimeout(a,v)}else lh[o]="error",i(new Error("load error"))};l.onload=c,l.onerror=d,l.src=o};a()});Bg[o]=t;try{return await t}finally{delete Bg[o]}}function r1(o){if(o&&!($m[o]||lh[o]==="loading"))try{A3(o)}catch{}}function L3(o,e){if(ch[o]||(ch[o]=new Set),ch[o].add(e),$m[o])try{e()}catch{}}function xb(o){o&&(r1(o.logo),r1(o.logo2))}class z3 extends hb{constructor(){super(...arguments);ve(this,"_logoCache",{});ve(this,"_logoSubscribed",{})}drawImp(t){const s=this.getWidget(),i=s.getPane().getChart().getChartStore(),r=i.getCrosshair();if(Uo(r.kLineData)){const a=s.getBounding(),l=i.getStyles(),c=l.candle,d=l.indicator;if(c.tooltip.showType==="rect"&&d.tooltip.showType==="rect"){const v=this.isDrawTooltip(r,c.tooltip),g=this.isDrawTooltip(r,d.tooltip);this._drawRectTooltip(t,v,g,c.tooltip.offsetTop)}else if(c.tooltip.showType==="standard"&&d.tooltip.showType==="standard"){const{offsetLeft:v,offsetTop:g,offsetRight:_}=c.tooltip,y=a.width-_,k=this._drawCandleStandardTooltip(t,v,g,y);this.drawIndicatorTooltip(t,v,k,y)}else if(c.tooltip.showType==="rect"&&d.tooltip.showType==="standard"){const{offsetLeft:v,offsetTop:g,offsetRight:_}=c.tooltip,y=a.width-_,k=this.drawIndicatorTooltip(t,v,g,y),S=this.isDrawTooltip(r,c.tooltip);this._drawRectTooltip(t,S,!1,k)}else{const{offsetLeft:v,offsetTop:g,offsetRight:_}=c.tooltip,y=a.width-_,k=this._drawCandleStandardTooltip(t,v,g,y),S=this.isDrawTooltip(r,d.tooltip);this._drawRectTooltip(t,!1,S,k)}}}_drawCandleStandardTooltip(t,s,i,r){var y;const a=this.getWidget().getPane().getChart().getChartStore(),c=a.getStyles().candle.tooltip,d=c.legend;let v=0;const g={x:s,y:i},_=a.getCrosshair();if(this.isDrawTooltip(_,c)){const k=c.title;if(k.show){const{type:I="",span:C=""}=a.getPeriod()??{},T=a.getSymbol(),z=((T==null?void 0:T.type)||"").toLowerCase(),j=((T==null?void 0:T.exchange)||"").toUpperCase();let B=z;(B==="forex"||B==="crypto")&&(B="");const $={second:"s",minute:"m",hour:"h",day:"d",week:"w",month:"mo",year:"y"},F=(C?`${C}`:"")+($[I]??"");let V=k.template;!B&&typeof V=="string"&&(V=V.replace(/(?:\s*[·\.]\s*)\{segment\}/i,""));let K=sy(V,{...T,period:F,exchange:j,segment:B});try{if(typeof window<"u"&&window.innerWidth<=768){const oe=(T==null?void 0:T.name)||(T==null?void 0:T.ticker)||"",U=k.marginLeft??0,J=k.marginRight??0,se=20,le=!!(T!=null&&T.logo2)?se*2-6+6:se+6,ye=Math.max(0,r-le-U-J),Ce=k.size??14,Re=k.family,Ke=k.weight,st="...",vt=mp(st,Ce,Ke,Re);let Je=oe;if(mp(Je,Ce,Ke,Re)>ye&&ye>vt){let nt=0,tt=Je.length;for(;nt<tt;){const ct=Math.floor((nt+tt)/2),Ge=Je.slice(0,ct)+st;mp(Ge,Ce,Ke,Re)<=ye?nt=ct+1:tt=ct}const Ze=Math.max(1,nt-1);Je=Je.slice(0,Ze)+st}K=Je}}catch{}const Y=k.color;let Z={...k};try{const te=(T==null?void 0:T.logo)||"",oe=(T==null?void 0:T.logo2)||"",U=20,J=Math.floor(g.x+(Z.marginLeft??0)),se=Math.floor(g.y+(Z.marginTop??0)+Math.max(0,Math.floor(((Z.size??12)-U)/2))),W=[te].filter(Boolean);oe&&W.push(oe);const le=a.getStyles(),ye=((y=le==null?void 0:le.pane)==null?void 0:y.backgroundColor)||"#ffffff";let Ce=255,Re=255,Ke=255;if(ye.startsWith("#")){const tt=ye.replace(/^#/,""),Ze=parseInt(tt.length===3?tt.split("").map(ct=>ct+ct).join(""):tt,16);Ce=Ze>>16&255,Re=Ze>>8&255,Ke=Ze&255}else if(/rgba?\(/i.test(ye)){const tt=ye.match(/rgba?\(([^)]+)\)/i);if(tt){const Ze=tt[1].split(",").map(ct=>parseFloat(ct.trim()));Ce=Ze[0]??Ce,Re=Ze[1]??Re,Ke=Ze[2]??Ke}}const st=.299*Ce+.587*Re+.114*Ke,vt=st>186?"#CBD5E1":"#4B5563",Je=st>186?"rgba(255,255,255,0.7)":"rgba(17,24,39,0.6)",ot=tt=>{var dt,qe;const ct=((T==null?void 0:T.shortName)||(T==null?void 0:T.ticker)||(T==null?void 0:T.name)||""||"").toString().trim().charAt(0).toUpperCase(),Ge=2,pt=Math.max(8,U-Ge*2),ce=mp(ct,pt,Z.weight,Z.family),we=Math.max(0,Math.floor((U-Ge*2-ce)/2)),ze=Ge;(dt=this.createFigure({name:"rect",attrs:{x:tt,y:se,width:U,height:U},styles:{style:"stroke_fill",color:Je,borderColor:vt,borderSize:1,borderRadius:U/2}}))==null||dt.draw(t),(qe=this.createFigure({name:"text",attrs:{x:tt+Ge,y:se+Ge,text:ct,width:U-Ge*2,height:U-Ge*2},styles:{backgroundColor:Je,borderRadius:(U-Ge*2)/2,size:pt,family:Z.family,weight:Z.weight,color:vt,paddingLeft:we,paddingTop:ze,paddingRight:0,paddingBottom:0}}))==null||qe.draw(t)};let nt=U;W.forEach((tt,Ze)=>{var Ge,pt;const ct=Math.floor(J+(Ze===0?0:U-8));if(tt){if(!this._logoSubscribed[tt]){this._logoSubscribed[tt]=!0;try{L3(tt,()=>{try{this.getWidget().getPane().getChart().updatePane(hd.Overlay,pc.CANDLE)}catch{}})}catch{}}r1(tt);let ce=M3(tt)||this._logoCache[tt];ce.complete&&ce.naturalWidth>0?((Ge=this.createFigure({name:"rect",attrs:{x:ct,y:se,width:U,height:U},styles:{style:"stroke_fill",color:Je,borderColor:vt,borderSize:1,borderRadius:U/2}}))==null||Ge.draw(t),(pt=this.createFigure({name:"image",attrs:{x:ct+2,y:se+2,width:U-4,height:U-4,image:ce,borderRadius:(U-4)/2},styles:{}}))==null||pt.draw(t)):ot(ct)}else ot(ct)}),nt=W.length===2?U*2-8:U,Z.marginLeft=(Z.marginLeft??0)+nt+6}catch{}const ne=this.drawStandardTooltipLegends(t,[{title:{text:"",color:Y},value:{text:K,color:Y}}],g,s,0,typeof window<"u"&&window.innerWidth<=768?r-(T!=null&&T.logo2?20*2-6:20):r,Z);v=Math.max(v,ne)}const S=this._getCandleTooltipLegends(),M=this.classifyTooltipFeatures(c.features);v=this.drawStandardTooltipFeatures(t,M[0],g,null,s,v,r),v=this.drawStandardTooltipFeatures(t,M[1],g,null,s,v,r);try{typeof window<"u"&&window.innerWidth<=768&&(g.x=s,g.y+=v,v=0)}catch{}if(S.length>0){let I={...d};try{if(typeof window<"u"&&window.innerWidth<=768){let z=I.size;const j=I.family,B=I.weight;let $=I.marginLeft??0,F=I.marginRight??0;for($=Math.min($,4),F=Math.min(F,4),I.marginLeft=$,I.marginRight=F;z>8;){t.font=Ff(z,B,j);let V=0;if(S.forEach(K=>{const Y=K.title,Z=K.value,ne=Y.text.length>0?t.measureText(Y.text).width:0,te=t.measureText(Z.text).width,oe=Y.text.length>0&&Z.text.length>0?2:0;V+=$+ne+oe+te+F}),g.x+V<=r)break;z-=1}I.size=z}}catch{}const C={...I,marginTop:Math.max(I.marginTop??0,Math.floor((v-I.size)/2))};v=this.drawStandardTooltipLegends(t,S,g,s,v,r,C)}v=this.drawStandardTooltipFeatures(t,M[2],g,null,s,v,r)}return g.y+v}_drawRectTooltip(t,s,i,r){var k;const a=this.getWidget(),l=a.getPane(),c=l.getChart().getChartStore(),d=c.getStyles(),v=d.candle,g=d.indicator,_=v.tooltip,y=g.tooltip;if(s||i){const S=this._getCandleTooltipLegends(),{offsetLeft:M,offsetTop:I,offsetRight:C,offsetBottom:T}=_,{marginLeft:z,marginRight:j,marginTop:B,marginBottom:$,size:F,weight:V,family:K}=_.legend,{position:Y,paddingLeft:Z,paddingRight:ne,paddingTop:te,paddingBottom:oe,offsetLeft:U,offsetRight:J,offsetTop:se,offsetBottom:W,borderSize:le,borderRadius:ye,borderColor:Ce,color:Re}=_.rect;let Ke=0,st=0,vt=0;s&&(t.font=Ff(F,V,K),S.forEach(ce=>{const we=ce.title,ze=ce.value,dt=`${we.text}${ze.text}`,qe=t.measureText(dt).width+z+j;Ke=Math.max(Ke,qe)}),vt+=($+B+F)*S.length);const{marginLeft:Je,marginRight:ot,marginTop:nt,marginBottom:tt,size:Ze,weight:ct,family:Ge}=y.legend,pt=[];if(i){const ce=c.getIndicatorsByPaneId(l.getId());t.font=Ff(Ze,ct,Ge),ce.forEach(we=>{const ze=this.getIndicatorTooltipData(we).legends;pt.push(ze),ze.forEach(dt=>{const qe=dt.title,me=dt.value,Q=`${qe.text}${me.text}`,it=t.measureText(Q).width+Je+ot;Ke=Math.max(Ke,it),vt+=nt+tt+Ze})})}if(st+=Ke,st!==0&&vt!==0){const ce=c.getCrosshair(),we=a.getBounding(),ze=l.getYAxisWidget().getBounding();st+=le*2+Z+ne,vt+=le*2+te+oe;const dt=we.width/2,qe=Y==="pointer"&&ce.paneId===pc.CANDLE,me=(ce.realX??0)>dt;let Q=0;if(qe){const Yt=ce.realX;me?Q=Yt-J-st:Q=Yt+U}else{const Yt=this.getWidget().getPane().getAxisComponent();me?(Q=U+M,Yt.inside&&Yt.position==="left"&&(Q+=ze.width)):(Q=we.width-J-st-C,Yt.inside&&Yt.position==="right"&&(Q-=ze.width))}let it=r+se;qe&&(it=ce.y-vt/2,it+vt>we.height-W-T&&(it=we.height-W-vt-T),it<r+se&&(it=r+se+I)),(k=this.createFigure({name:"rect",attrs:{x:Q,y:it,width:st,height:vt},styles:{style:"stroke_fill",color:Re,borderColor:Ce,borderSize:le,borderRadius:ye}}))==null||k.draw(t);const Vt=Q+le+Z+z;let wt=it+le+te;if(s&&S.forEach(Yt=>{var no,Do;wt+=B;const At=Yt.title;(no=this.createFigure({name:"text",attrs:{x:Vt,y:wt,text:At.text},styles:{color:At.color,size:F,family:K,weight:V}}))==null||no.draw(t);const Gt=Yt.value;(Do=this.createFigure({name:"text",attrs:{x:Q+st-le-j-ne,y:wt,text:Gt.text,align:"right"},styles:{color:Gt.color,size:F,family:K,weight:V}}))==null||Do.draw(t),wt+=F+$}),i){const Yt=Q+le+Z+Je;pt.forEach(At=>{At.forEach(Gt=>{var Eo,bs;wt+=nt;const no=Gt.title,Do=Gt.value;(Eo=this.createFigure({name:"text",attrs:{x:Yt,y:wt,text:no.text},styles:{color:no.color,size:Ze,family:Ge,weight:ct}}))==null||Eo.draw(t),(bs=this.createFigure({name:"text",attrs:{x:Q+st-le-ot-ne,y:wt,text:Do.text,align:"right"},styles:{color:Do.color,size:Ze,family:Ge,weight:ct}}))==null||bs.draw(t),wt+=Ze+tt})})}}}}_getCandleTooltipLegends(){const t=this.getWidget().getPane().getChart().getChartStore(),s=t.getStyles().candle,i=t.getDataList(),r=t.getInnerFormatter(),a=t.getDecimalFold(),l=t.getThousandsSeparator(),c=t.getLocale(),{pricePrecision:d=gp.PRICE,volumePrecision:v=gp.VOLUME}=t.getSymbol()??{},g=t.getPeriod(),_=t.getCrosshair().dataIndex??0,y=t.getSymbol(),S=((y==null?void 0:y.type)||"").toLowerCase()==="stock",I=s.tooltip.legend,{color:C,defaultValue:T}=I,z=I.template,j=i[_-1]??null,B=i[_],$=(j==null?void 0:j.close)??B.close,F=B.close-$,V={...B,time:r.formatDate(B.timestamp,bb[(g==null?void 0:g.type)??"day"],"tooltip"),open:a.format(l.format(vp(B.open,d))),high:a.format(l.format(vp(B.high,d))),low:a.format(l.format(vp(B.low,d))),close:a.format(l.format(vp(B.close,d))),volume:a.format(l.format(r.formatBigNumber(vp(B.volume??T,v)))),turnover:a.format(l.format(vp(B.turnover??T,d))),change:$===0?T:`${l.format(vp(F/$*100))}%`},K=Vp(z)?z({prev:j,current:B,next:i[_+1]??null},s):z;return(S?K:K.filter(Z=>{const ne=rv(Z.title)?Z.title.text:Z.title,te=rv(Z.value)?Z.value.text:Z.value,oe=(ne||"").toString().trim().toLowerCase(),U=(te||"").toString();return!(oe==="volume"||/\{volume\}/i.test(U))})).map(Z=>{const{title:ne,value:te}=Z;let oe={text:"",color:C};rv(ne)?oe=ne:oe.text=ne,oe.text=I3(oe.text,c);let U={text:T,color:C};return rv(te)?U=te:U.text=te,Uo(/{change}/.exec(U.text))&&(U.color=F===0?s.priceMark.last.noChangeColor:F>0?s.priceMark.last.upColor:s.priceMark.last.downColor),U.text=sy(U.text,V),{title:oe,value:U}})}}class F3 extends kv{constructor(t){super(t);ve(this,"_activeFeatureInfo",null);ve(this,"_featureClickEvent",t=>()=>(this.getWidget().getPane().getChart().getChartStore().executeAction("onCrosshairFeatureClick",t),!0));ve(this,"_featureMouseMoveEvent",t=>()=>(this._activeFeatureInfo=t,this.getWidget().setForceCursor("pointer"),!0));this.registerEvent("mouseMoveEvent",s=>(this._activeFeatureInfo=null,this.getWidget().setForceCursor(null),!1))}drawImp(t){var d;const s=this.getWidget(),i=s.getPane(),r=s.getPane().getChart().getChartStore(),a=r.getCrosshair(),l=this.getWidget(),c=l.getPane().getAxisComponent();if(pd(a.paneId)&&a.paneId===i.getId()&&c.isInCandle()){const v=r.getStyles().crosshair,g=v.horizontal.features;if(v.show&&v.horizontal.show&&g.length>0){const _=c.position==="right",y=l.getBounding();let k=0;const S=v.horizontal.text;if(c.inside&&S.show){const C=c.convertFromPixel(a.y),T=c.getRange();let z=c.displayValueToText(c.realValueToDisplayValue(c.valueToRealValue(C,{range:T}),{range:T}),((d=r.getSymbol())==null?void 0:d.pricePrecision)??gp.PRICE);z=r.getDecimalFold().format(r.getThousandsSeparator().format(z)),k=S.paddingLeft+mp(z,S.size,S.weight,S.family)+S.paddingRight}let M=k;_&&(M=y.width-k);const I=a.y;g.forEach(C=>{var Ce,Re,Ke,st;const{marginLeft:T=0,marginTop:z=0,marginRight:j=0,paddingLeft:B=0,paddingTop:$=0,paddingRight:F=0,paddingBottom:V=0,color:K,activeColor:Y,backgroundColor:Z,activeBackgroundColor:ne,borderRadius:te,size:oe=0,type:U,content:J}=C;let se=oe;if(U==="icon_font"){const vt=J;se=B+mp(vt.code,oe,"normal",vt.family)+F}_?M-=se+j:M+=T;let W=K,le=Z;((Ce=this._activeFeatureInfo)==null?void 0:Ce.feature.id)===C.id&&(W=Y??K,le=ne??Z);const ye={mouseClickEvent:this._featureClickEvent({crosshair:a,feature:C}),mouseMoveEvent:this._featureMouseMoveEvent({crosshair:a,feature:C})};if(U==="icon_font"){const vt=J;(Re=this.createFigure({name:"text",attrs:{text:vt.code,x:M,y:I+z,baseline:"middle"},styles:{paddingLeft:B,paddingTop:$,paddingRight:F,paddingBottom:V,borderRadius:te,size:oe,family:vt.family,color:W,backgroundColor:le}},ye))==null||Re.draw(t)}else{(Ke=this.createFigure({name:"rect",attrs:{x:M,y:I+z-oe/2,width:oe,height:oe},styles:{paddingLeft:B,paddingTop:$,paddingRight:F,paddingBottom:V,color:le}},ye))==null||Ke.draw(t);const vt=J;(st=this.createFigure({name:"path",attrs:{path:vt.path,x:M,y:I+z+$-oe/2,width:oe,height:oe},styles:{style:vt.style,lineWidth:vt.lineWidth,color:W}}))==null||st.draw(t)}_?M-=T:M+=se+j})}}}}class $3 extends yb{constructor(t,s){super(t,s);ve(this,"_candleBarView",new gb(this));ve(this,"_candleAreaView",new b3(this));ve(this,"_candleHighLowPriceView",new x3(this));ve(this,"_candleLastPriceLineView",new w3(this));ve(this,"_crosshairFeatureView",new F3(this));this.addChild(this._candleBarView),this.addChild(this._crosshairFeatureView)}updateMainContent(t){this.getPane().getChart().getStyles().candle.type!=="area"?(this._candleBarView.draw(t),this._candleHighLowPriceView.draw(t),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(t),this._candleLastPriceLineView.draw(t)}updateOverlayContent(t){this._crosshairFeatureView.draw(t)}createTooltipView(){return new z3(this)}}class wb extends kv{drawImp(e,t){var c,d;const s=this.getWidget(),i=s.getPane(),r=s.getBounding(),a=i.getAxisComponent(),l=this.getAxisStyles(i.getChart().getStyles());if(l.show&&(l.axisLine.show&&((c=this.createFigure({name:"line",attrs:this.createAxisLine(r,l),styles:l.axisLine}))==null||c.draw(e)),!t[0])){const v=a.getTicks();if(l.tickLine.show&&this.createTickLines(v,r,l).forEach(_=>{var y;(y=this.createFigure({name:"line",attrs:_,styles:l.tickLine}))==null||y.draw(e)}),l.tickText.show){const g=this.createTickTexts(v,r,l);(d=this.createFigure({name:"text",attrs:g,styles:l.tickText}))==null||d.draw(e)}}}}class D3 extends wb{getAxisStyles(e){return e.yAxis}createAxisLine(e,t){const s=this.getWidget().getPane().getAxisComponent(),i=t.axisLine.size;let r=0;return s.isFromZero()?r=0:r=e.width-i,{coordinates:[{x:r,y:0},{x:r,y:e.height}]}}createTickLines(e,t,s){const i=this.getWidget().getPane().getAxisComponent(),r=s.axisLine,a=s.tickLine;let l=0,c=0;return i.isFromZero()?(l=0,r.show&&(l+=r.size),c=l+a.length):(l=t.width,r.show&&(l-=r.size),c=l-a.length),e.map(d=>({coordinates:[{x:l,y:d.coord},{x:c,y:d.coord}]}))}createTickTexts(e,t,s){const i=this.getWidget().getPane().getAxisComponent(),r=s.axisLine,a=s.tickLine,l=s.tickText;let c=0;i.isFromZero()?(c=l.marginStart,r.show&&(c+=r.size),a.show&&(c+=a.length)):(c=t.width-l.marginEnd,r.show&&(c-=r.size),a.show&&(c-=a.length));const d=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return e.map(v=>({x:c,y:v.coord,text:v.text,align:d,baseline:"middle"}))}}class E3 extends kv{drawImp(e){var d,v,g,_,y,k;const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=s.getChart().getChartStore(),a=r.getStyles().candle.priceMark,l=a.last,c=l.text;if(a.show&&l.show&&c.show){const S=r.getStyles().yAxis,M=S.axisLine.show?S.axisLine.size:0,I=S.tickLine.show?S.tickLine.length:0,C=S.tickText.marginStart,T=S.tickText.marginEnd,z=1,j=((d=r.getSymbol())==null?void 0:d.pricePrecision)??gp.PRICE,B=s.getAxisComponent(),$=r.getVisibleRangeDataList(),F=B.position==="right"?$.length-1:0,V=r.getDataList(),K=V[V.length-1];if(Uo(K)){const{close:Y,open:Z}=K,ne=l.compareRule==="current_open"?Z:((v=V[V.length-2])==null?void 0:v.close)??Y,te=B.convertToPixel(Y);let oe="";Y>ne?oe=l.upColor:Y<ne?oe=l.downColor:oe=l.noChangeColor;let U=0,J="left";const se={...c};if(B.isFromZero())U=M+z,J="left",se.paddingLeft=I+C-z;else{U=i.width-M-z,J="right";const we=i.width-M-z,ze=i.width-(S.axisLine.show?S.axisLine.size:0)-(S.tickLine.show?S.tickLine.length:0)-T;se.paddingRight=we-ze}const W=[],le=B.getRange();let ye=B.displayValueToText(B.realValueToDisplayValue(B.valueToRealValue(Y,{range:le}),{range:le}),j);ye=r.getDecimalFold().format(r.getThousandsSeparator().format(ye));const{paddingLeft:Ce,paddingRight:Re,paddingTop:Ke,paddingBottom:st,size:vt,family:Je,weight:ot}=se;let nt=Ce+mp(ye,vt,ot,Je)+Re;const tt=Ke+vt+st;W.push({name:"text",attrs:{x:U,y:te,width:nt,height:tt,text:ye,align:J,baseline:"middle"},styles:{...se,backgroundColor:oe}});const Ze=r.getInnerFormatter().formatExtendText,ct=vt/2;let Ge=te-ct-Ke,pt=te+ct+st;l.extendTexts.forEach((we,ze)=>{const dt=Ze({type:"last_price",data:K,index:ze});if(dt.length>0&&we.show){const qe=we.size/2;let me=0;we.position==="above_price"?(Ge-=we.paddingBottom+qe,me=Ge,Ge-=qe+we.paddingTop):(pt+=we.paddingTop+qe,me=pt,pt+=qe+we.paddingBottom),nt=Math.max(nt,we.paddingLeft+mp(dt,we.size,we.weight,we.family)+we.paddingRight),W.push({name:"text",attrs:{x:U,y:me,width:nt,height:we.paddingTop+we.size+we.paddingBottom,text:dt,align:J,baseline:"middle"},styles:{...we,backgroundColor:oe}})}});const ce=(g=$[F])==null?void 0:g.data.current;if(Uo(ce)&&ce.timestamp!==K.timestamp){const{close:we,open:ze}=ce,dt=B.position==="right"?(_=$[F-1])==null?void 0:_.data.current:(y=$[F+1])==null?void 0:y.data.current,qe=l.compareRule==="current_open"?ze:(dt==null?void 0:dt.close)??((k=V[V.length-2])==null?void 0:k.close)??we,me=B.convertToPixel(we);let Q="";we>qe?Q=l.upColor:we<qe?Q=l.downColor:Q=l.noChangeColor;let it=B.displayValueToText(B.realValueToDisplayValue(B.valueToRealValue(we,{range:le}),{range:le}),j);it=r.getDecimalFold().format(r.getThousandsSeparator().format(it));let Vt=Ce+mp(it,vt,ot,Je)+Re;const wt=Ke+vt+st;W.push({name:"text",attrs:{x:U,y:me,width:Vt,height:wt,text:it,align:J,baseline:"middle"},styles:{...se,backgroundColor:Q}});const Yt=vt/2;let At=me-Yt-Ke,Gt=me+Yt+st;l.extendTexts.forEach((no,Do)=>{const Eo=Ze({type:"last_price",data:ce,index:Do});if(Eo.length>0&&no.show){const bs=no.size/2;let Is=0;no.position==="above_price"?(At-=no.paddingBottom+bs,Is=At,At-=bs+no.paddingTop):(Gt+=no.paddingTop+bs,Is=Gt,Gt+=bs+no.paddingBottom),Vt=Math.max(Vt,no.paddingLeft+mp(Eo,no.size,no.weight,no.family)+no.paddingRight),W.push({name:"text",attrs:{x:U,y:Is,width:Vt,height:no.paddingTop+no.size+no.paddingBottom,text:Eo,align:J,baseline:"middle"},styles:{...no,backgroundColor:Q}})}})}W.forEach(we=>{var ze;(ze=this.createFigure(we))==null||ze.draw(e)})}}}}class N3 extends kv{drawImp(e){var d,v;const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=s.getChart().getChartStore(),a=r.getStyles().indicator,l=a.lastValueMark,c=l.text;if(l.show){const g=r.getStyles().yAxis,_=g.axisLine.show?g.axisLine.size:0,y=g.tickLine.show?g.tickLine.length:0,k=g.tickText.marginStart,S=g.tickText.marginEnd,M=1,I=s.getAxisComponent(),C=I.getRange(),T=r.getVisibleRangeDataList(),z=I.position==="right"?T.length-1:0,j=r.getDataList(),B=((d=T[z])==null?void 0:d.data.current)??j[j.length-1]??{},$=((v=T[z-(I.position==="right"?1:-1)])==null?void 0:v.data.current)??j[j.length-2]??{},F=r.getIndicatorsByPaneId(s.getId()),V=r.getInnerFormatter(),K=r.getDecimalFold(),Y=r.getThousandsSeparator();F.forEach(Z=>{const ne=Z.result,te=ne[B.timestamp]??ne[$.timestamp]??{};if(Uo(te)&&Z.visible){const oe=Z.precision;x1(Z,{prev:$.timestamp,current:B.timestamp,next:null},a,(U,J)=>{var W;const se=te[U.key];if(ja(se)){const le=I.convertToPixel(se);let ye=I.displayValueToText(I.realValueToDisplayValue(I.valueToRealValue(se,{range:C}),{range:C}),oe);Z.shouldFormatBigNumber&&(ye=V.formatBigNumber(ye)),ye=K.format(Y.format(ye));let Ce=0,Re="left";const Ke={...c};if(I.isFromZero())Ce=_+M,Re="left",Ke.paddingLeft=y+k-M;else{Ce=i.width-_-M,Re="right";const st=i.width-_-M,vt=i.width-(g.axisLine.show?g.axisLine.size:0)-(g.tickLine.show?g.tickLine.length:0)-S;Ke.paddingRight=st-vt}(W=this.createFigure({name:"text",attrs:{x:Ce,y:le,text:ye,align:Re,baseline:"middle"},styles:{...Ke,backgroundColor:J.color}}))==null||W.draw(e)}})}})}}}class kb extends _b{coordinateToPointTimestampDataIndexFlag(){return!1}drawDefaultFigures(e,t,s){this.drawFigures(e,t,this.getDefaultFigures(t,s))}getDefaultFigures(e,t){var c;const s=this.getWidget(),i=s.getPane(),r=i.getChart().getChartStore(),a=r.getClickOverlayInfo(),l=[];if(e.needDefaultYAxisFigure&&e.id===((c=a.overlay)==null?void 0:c.id)&&a.paneId===i.getId()){const d=i.getAxisComponent(),v=s.getBounding();let g=Number.MAX_SAFE_INTEGER,_=Number.MIN_SAFE_INTEGER;const y=d.isFromZero();let k="left",S=0;y?(k="left",S=0):(k="right",S=v.width);const M=r.getDecimalFold(),I=r.getThousandsSeparator();t.forEach((C,T)=>{var j;const z=e.points[T];if(ja(z.value)){g=Math.min(g,C.y),_=Math.max(_,C.y);const B=M.format(I.format(vp(z.value,((j=r.getSymbol())==null?void 0:j.pricePrecision)??gp.PRICE)));l.push({type:"text",attrs:{x:S,y:C.y,text:B,align:k,baseline:"middle"},ignoreEvent:!0})}}),t.length>1&&l.unshift({type:"rect",attrs:{x:0,y:g,width:v.width,height:_-g},ignoreEvent:!0})}return l}getFigures(e,t){var d;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),a=i.getAxisComponent(),l=r.getXAxisPane().getAxisComponent(),c=s.getBounding();return((d=e.createYAxisFigures)==null?void 0:d.call(e,{chart:r,overlay:e,coordinates:t,bounding:c,xAxis:l,yAxis:a}))??[]}}class Sb extends kv{drawImp(e){var a;const t=this.getWidget(),s=t.getPane(),i=t.getPane().getChart().getChartStore(),r=i.getCrosshair();if(pd(r.paneId)&&this.compare(r,s.getId())){const l=i.getStyles().crosshair;if(l.show){const c=this.getDirectionStyles(l),d=c.text;if(c.show&&d.show){const v=t.getBounding(),g=s.getAxisComponent(),_=this.getText(r,i,g),y=i.getStyles().yAxis,k=y.axisLine.show?y.axisLine.size:0,S=y.tickLine.show?y.tickLine.length:0,M=y.tickText.marginStart,I=y.tickText.marginEnd,C=1,T=g,z={...d};if(T.isFromZero())z.paddingLeft=S+M-C;else{const j=v.width-k-C,B=v.width-(y.axisLine.show?y.axisLine.size:0)-(y.tickLine.show?y.tickLine.length:0)-I;z.paddingRight=j-B}e.font=Ff(z.size,z.weight,z.family),(a=this.createFigure({name:"text",attrs:this.getTextAttrs(_,e.measureText(_).width,r,v,g,z),styles:z}))==null||a.draw(e)}}}}compare(e,t){return e.paneId===t}getDirectionStyles(e){return e.horizontal}getText(e,t,s){var v;const i=s,r=s.convertFromPixel(e.y);let a=0,l=!1;i.isInCandle()?a=((v=t.getSymbol())==null?void 0:v.pricePrecision)??gp.PRICE:t.getIndicatorsByPaneId(e.paneId).forEach(_=>{a=Math.max(_.precision,a),l||(l=_.shouldFormatBigNumber)});const c=i.getRange();let d=i.displayValueToText(i.realValueToDisplayValue(i.valueToRealValue(r,{range:c}),{range:c}),a);return l&&(d=t.getInnerFormatter().formatBigNumber(d)),t.getDecimalFold().format(t.getThousandsSeparator().format(d))}getTextAttrs(e,t,s,i,r,a){const l=r,c=this.getWidget().getPane().getChart().getStyles(),d=c.yAxis.axisLine.show?c.yAxis.axisLine.size:0,v=1;let g=0,_="left";return l.isFromZero()?(g=d+v,_="left"):(g=i.width-d-v,_="right"),{x:g,y:s.y,text:e,align:_,baseline:"middle"}}}class j3 extends P1{constructor(t,s){super(t,s);ve(this,"_yAxisView",new D3(this));ve(this,"_candleLastPriceLabelView",new E3(this));ve(this,"_indicatorLastValueView",new N3(this));ve(this,"_overlayYAxisView",new kb(this));ve(this,"_crosshairHorizontalLabelView",new Sb(this));this.setCursor("ns-resize"),this.addChild(this._overlayYAxisView)}getName(){return bc.Y_AXIS}updateMain(t){const s=this.getPane().getOptions().state==="minimize";this._yAxisView.draw(t,s),s||(this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t))}updateOverlay(t){this.getPane().getOptions().state!=="minimize"&&(this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t))}}function gy(){return{from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0,displayFrom:0,displayTo:0,displayRange:0}}class Cb{constructor(e){ve(this,"name");ve(this,"scrollZoomEnabled",!0);ve(this,"createTicks");ve(this,"_parent");ve(this,"_range",gy());ve(this,"_prevRange",gy());ve(this,"_ticks",[]);ve(this,"_autoCalcTickFlag",!0);this._parent=e}getParent(){return this._parent}buildTicks(e){if(this._autoCalcTickFlag&&(this._range=this.createRangeImp()),this._prevRange.from!==this._range.from||this._prevRange.to!==this._range.to||e){this._prevRange=this._range;const t=typeof performance<"u"?performance.now():Date.now();this._ticks=this.createTicksImp();const i=(typeof performance<"u"?performance.now():Date.now())-t;return i>20&&console.warn("⚠️ klinecharts: axis createTicks slow",{name:this.name,durationMs:Math.round(i)}),!0}return!1}getTicks(){return this._ticks}setRange(e){this._autoCalcTickFlag=!1,this._range=e}getRange(){return this._range}setAutoCalcTickFlag(e){this._autoCalcTickFlag=e}getAutoCalcTickFlag(){return this._autoCalcTickFlag}}const P_=8;class Dm extends Cb{constructor(t,s){super(t);ve(this,"reverse",!1);ve(this,"inside",!1);ve(this,"position","right");ve(this,"gap",{top:.2,bottom:.1});ve(this,"createRange",t=>t.defaultRange);ve(this,"minSpan",t=>lm(-t));ve(this,"valueToRealValue",t=>t);ve(this,"realValueToDisplayValue",t=>t);ve(this,"displayValueToRealValue",t=>t);ve(this,"realValueToValue",t=>t);ve(this,"displayValueToText",(t,s)=>vp(t,s));this.override(s)}override(t){const{name:s,gap:i,...r}=t;pd(this.name)||(this.name=s),Ru(this.gap,i),Ru(this,r)}createRangeImp(){var le;const t=this.getParent(),s=t.getChart(),i=s.getChartStore(),r=t.getId();let a=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,c=!1,d=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,g=Number.MAX_SAFE_INTEGER;const _=i.getIndicatorsByPaneId(r);_.forEach(ye=>{c||(c=ye.shouldOhlc),g=Math.min(g,ye.precision),ja(ye.minValue)&&(d=Math.min(d,ye.minValue)),ja(ye.maxValue)&&(v=Math.max(v,ye.maxValue))});let y=4;const k=this.isInCandle();if(k){const ye=((le=i.getSymbol())==null?void 0:le.pricePrecision)??gp.PRICE;g!==Number.MAX_SAFE_INTEGER?y=Math.min(g,ye):y=ye}else g!==Number.MAX_SAFE_INTEGER&&(y=g);const S=i.getVisibleRangeDataList(),M=s.getStyles().candle,I=M.type==="area",C=M.area.value,T=k&&!I||!k&&c;S.forEach(ye=>{const Ce=ye.data.current;if(Uo(Ce)){if(T&&(a=Math.min(a,Ce.low),l=Math.max(l,Ce.high)),k&&I){const Re=Ce[C];ja(Re)&&(a=Math.min(a,Re),l=Math.max(l,Re))}_.forEach(({result:Re,figures:Ke})=>{const st=Re[Ce.timestamp]??{};Ke.forEach(vt=>{const Je=st[vt.key];ja(Je)&&(a=Math.min(a,Je),l=Math.max(l,Je))})})}}),a!==Number.MAX_SAFE_INTEGER&&l!==Number.MIN_SAFE_INTEGER?(a=Math.min(d,a),l=Math.max(v,l)):(a=0,l=10);const z=l-a,j={from:a,to:l,range:z,realFrom:a,realTo:l,realRange:z,displayFrom:a,displayTo:l,displayRange:z},B=this.createRange({chart:s,paneId:r,defaultRange:j});let $=B.realFrom,F=B.realTo,V=B.realRange;const K=this.minSpan(y);if($===F||V<K){const ye=d===$,Ce=v===F,Re=P_/2;$=ye?$:Ce?$-P_*K:$-Re*K,F=Ce?F:ye?F+P_*K:F+Re*K}const Y=this.getBounding().height,{top:Z,bottom:ne}=this.gap;let te=Z;te>=1&&(te=te/Y);let oe=ne;oe>=1&&(oe=oe/Y),V=F-$,$=$-V*oe,F=F+V*te;const U=this.realValueToValue($,{range:B}),J=this.realValueToValue(F,{range:B}),se=this.realValueToDisplayValue($,{range:B}),W=this.realValueToDisplayValue(F,{range:B});return{from:U,to:J,range:J-U,realFrom:$,realTo:F,realRange:F-$,displayFrom:se,displayTo:W,displayRange:W-se}}isInCandle(){return this.getParent().getId()===pc.CANDLE}isFromZero(){return this.position==="left"&&this.inside||this.position==="right"&&!this.inside}createTicksImp(){var te,oe;const t=this.getRange(),{displayFrom:s,displayTo:i}=t,r=this.getParent(),a=((te=r.getYAxisWidget())==null?void 0:te.getBounding().height)??0,l=40,c=80,d=60,v=a/Math.max(1e-12,t.realRange),g=d/Math.max(1e-12,v),_=[1,2,5];let y=g,k=Number.MAX_VALUE,S=0;for(let U=-12;U<=12;U++){const J=Math.pow(10,U);for(const se of _){const W=se*J,le=W*v,ye=le>=l&&le<=c,Ce=Math.abs(le-d);ye&&Ce<k&&(k=Ce,y=W,S=le),!ye&&Ce<k&&y===g&&(k=Ce,y=W,S=le)}}let M=y;S<l?M=ry(l/Math.max(1e-12,v)):S>c&&(M=ry(c/Math.max(1e-12,v)));const I=L5(M),C=[];if(M>0){let U=ay(Math.ceil(s/M)*M,I);const J=ay(Math.floor(i/M)*M,I),se=Math.ceil(a/l)+2;let W=0;for(;U<=J&&W<se;){const le=U.toFixed(I);C.push({text:le,coord:0,value:le}),U+=M,W+=1}}const T=r.getChart().getChartStore(),z=[],j=T.getIndicatorsByPaneId(r.getId()),B=T.getStyles();let $=0,F=!1;this.isInCandle()?$=((oe=T.getSymbol())==null?void 0:oe.pricePrecision)??gp.PRICE:j.forEach(U=>{$=Math.max($,U.precision),F||(F=U.shouldFormatBigNumber)});const V=T.getInnerFormatter(),K=T.getThousandsSeparator(),Y=T.getDecimalFold(),Z=B.xAxis.tickText.size;let ne=NaN;return C.forEach(({value:U})=>{let J=this.displayValueToText(+U,$);const se=this.convertToPixel(this.realValueToValue(this.displayValueToRealValue(+U,{range:t}),{range:t}));F&&(J=V.formatBigNumber(U)),J=Y.format(K.format(J));const W=ja(ne);se>Z&&se<a-Z&&(W&&Math.abs(ne-se)>Z*2||!W)&&(z.push({text:J,coord:se,value:U}),ne=se)}),Vp(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:z}):z}getAutoSize(){var S;const t=this.getParent(),i=t.getChart().getChartStore(),r=i.getStyles(),a=r.yAxis,l=a.size;if(l!=="auto")return l;let c=0;if(a.show&&(a.axisLine.show&&(c+=a.axisLine.size),a.tickLine.show&&(c+=a.tickLine.length),a.tickText.show)){let M=0;this.getTicks().forEach(I=>{M=Math.max(M,mp(I.text,a.tickText.size,a.tickText.weight,a.tickText.family))}),c+=a.tickText.marginStart+a.tickText.marginEnd+M}const d=r.candle.priceMark,v=d.show&&d.last.show&&d.last.text.show;let g=0;const _=r.crosshair,y=_.show&&_.horizontal.show&&_.horizontal.text.show;let k=0;if(v||y){const M=((S=i.getSymbol())==null?void 0:S.pricePrecision)??gp.PRICE,I=this.getRange().displayTo;if(v){const C=i.getDataList(),T=C[C.length-1];if(Uo(T)){const{paddingLeft:z,paddingRight:j,size:B,family:$,weight:F}=d.last.text;g=z+mp(vp(T.close,M),B,F,$)+j;const V=i.getInnerFormatter().formatExtendText;d.last.extendTexts.forEach((K,Y)=>{const Z=V({type:"last_price",data:T,index:Y});Z.length>0&&K.show&&(g=Math.max(g,K.paddingLeft+mp(Z,K.size,K.weight,K.family)+K.paddingRight))})}}if(y){const C=i.getIndicatorsByPaneId(t.getId());let T=0,z=!1;C.forEach($=>{T=Math.max($.precision,T),z||(z=$.shouldFormatBigNumber)});let j=2;if(this.isInCandle()){const $=r.indicator.lastValueMark;$.show&&$.text.show?j=Math.max(T,M):j=M}else j=T;let B=vp(I,j);z&&(B=i.getInnerFormatter().formatBigNumber(B)),B=i.getDecimalFold().format(B),k+=_.horizontal.text.paddingLeft+_.horizontal.text.paddingRight+_.horizontal.text.borderSize*2+mp(B,_.horizontal.text.size,_.horizontal.text.weight,_.horizontal.text.family)}}return Math.max(c,g,k)}getBounding(){return this.getParent().getYAxisWidget().getBounding()}convertFromPixel(t){const s=this.getBounding().height,i=this.getRange(),{realFrom:r,realRange:a}=i,c=(this.reverse?t/s:1-t/s)*a+r;return this.realValueToValue(c,{range:i})}convertToPixel(t){var d;const s=this.getRange(),i=this.valueToRealValue(t,{range:s}),r=((d=this.getParent().getYAxisWidget())==null?void 0:d.getBounding().height)??0,{realFrom:a,realRange:l}=s,c=(i-a)/l;return this.reverse?Math.round(c*r):Math.round((1-c)*r)}convertToNicePixel(t){var r;const s=((r=this.getParent().getYAxisWidget())==null?void 0:r.getBounding().height)??0,i=this.convertToPixel(t);return Math.round(Math.max(s*.05,Math.min(i,s*.98)))}static extend(t){class s extends Dm{constructor(r){super(r,t)}}return s}}const R3={name:"normal"},B3={name:"percentage",minSpan:()=>Math.pow(10,-2),displayValueToText:o=>`${vp(o,2)}%`,valueToRealValue:(o,{range:e})=>(o-e.from)/e.range*e.realRange+e.realFrom,realValueToValue:(o,{range:e})=>(o-e.realFrom)/e.realRange*e.range+e.from,createRange:({chart:o,defaultRange:e})=>{const t=o.getDataList(),s=o.getVisibleRange(),i=t[s.from];if(Uo(i)){const{from:r,to:a,range:l}=e,c=(e.from-i.close)/i.close*100,d=(e.to-i.close)/i.close*100,v=d-c;return{from:r,to:a,range:l,realFrom:c,realTo:d,realRange:v,displayFrom:c,displayTo:d,displayRange:v}}return e}},O3={name:"logarithm",minSpan:o=>.05*lm(-o),valueToRealValue:o=>o<0?-Pf(Math.abs(o)):Pf(o),realValueToDisplayValue:o=>o<0?-lm(Math.abs(o)):lm(o),displayValueToRealValue:o=>o<0?-Pf(Math.abs(o)):Pf(o),realValueToValue:o=>o<0?-lm(Math.abs(o)):lm(o),createRange:({defaultRange:o})=>{const{from:e,to:t,range:s}=o,i=e<0?-Pf(Math.abs(e)):Pf(e),r=t<0?-Pf(Math.abs(t)):Pf(t);return{from:e,to:t,range:s,realFrom:i,realTo:r,realRange:r-i,displayFrom:e,displayTo:t,displayRange:s}}},hy={normal:Dm.extend(R3),percentage:Dm.extend(B3),logarithm:Dm.extend(O3)};function V3(o){return hy[o]??hy.normal}class Pb{constructor(e,t){ve(this,"_container");ve(this,"_id");ve(this,"_chart");ve(this,"_bounding",_h());ve(this,"_originalBounding",_h());ve(this,"_visible",!0);this._chart=e,this._id=t,this._container=Df("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"})}getContainer(){return this._container}setVisible(e){this._visible!==e&&(this._container.style.display=e?"block":"none",this._visible=e)}getVisible(){return this._visible}getId(){return this._id}getChart(){return this._chart}getBounding(){return this._bounding}setOriginalBounding(e){Ru(this._originalBounding,e)}getOriginalBounding(){return this._originalBounding}update(e){this._bounding.height!==this._container.clientHeight&&(this._container.style.height=`${this._bounding.height}px`),this.updateImp(e??hd.Drawer,this._container,this._bounding)}}class Ib extends Pb{constructor(t,s,i){super(t,s);ve(this,"_mainWidget");ve(this,"_yAxisWidget",null);ve(this,"_axis");ve(this,"_options",{id:"",minHeight:ah,dragEnabled:!0,order:0,height:rb,state:"normal",axis:{name:"normal",scrollZoomEnabled:!0}});const r=this.getContainer();this._mainWidget=this.createMainWidget(r),this._yAxisWidget=this.createYAxisWidget(r),this.setOptions(i)}setOptions(t){var a,l,c;const s=this.getId();if(s===pc.CANDLE||s===pc.X_AXIS){const d=(a=t.axis)==null?void 0:a.name;(!Uo(this._axis)||Uo(d)&&this._options.axis.name!==d)&&(this._axis=this.createAxisComponent(d??"normal"))}else Uo(this._axis)||(this._axis=this.createAxisComponent("normal"));this._axis instanceof Dm&&this._axis.setAutoCalcTickFlag(!0),Ru(this._options,t),this._axis.override({...this._options.axis,name:((l=t.axis)==null?void 0:l.name)??"normal"});let i=null,r="default";return this.getId()===pc.X_AXIS?(i=this.getMainWidget().getContainer(),r="ew-resize"):(i=this.getYAxisWidget().getContainer(),r="ns-resize"),((c=t.axis)==null?void 0:c.scrollZoomEnabled)??!0?i.style.cursor=r:i.style.cursor="default",this}getOptions(){return this._options}getAxisComponent(){return this._axis}setBounding(t,s,i,r){Ru(this.getBounding(),t);const a={};Uo(t.height)&&(a.height=t.height),Uo(t.top)&&(a.top=t.top),this._mainWidget.setBounding(a);const l=Uo(s);return l&&this._mainWidget.setBounding(s),Uo(this._yAxisWidget)&&(this._yAxisWidget.setBounding(a),this._axis.position==="left"?Uo(i)&&this._yAxisWidget.setBounding({...i,left:0}):Uo(r)&&(this._yAxisWidget.setBounding(r),l&&this._yAxisWidget.setBounding({left:(s.left??0)+(s.width??0)+(s.right??0)-(r.width??0)}))),this}getMainWidget(){return this._mainWidget}getYAxisWidget(){return this._yAxisWidget}updateImp(t){var s;this._mainWidget.update(t),(s=this._yAxisWidget)==null||s.update(t)}destroy(){var t;this._mainWidget.destroy(),(t=this._yAxisWidget)==null||t.destroy()}getImage(t){const{width:s,height:i}=this.getBounding(),r=Df("canvas",{width:`${s}px`,height:`${i}px`,boxSizing:"border-box"}),a=r.getContext("2d"),l=Xf(r);r.width=s*l,r.height=i*l,a.scale(l,l);const c=this._mainWidget.getBounding();if(a.drawImage(this._mainWidget.getImage(t),c.left,0,c.width,c.height),this._yAxisWidget!==null){const d=this._yAxisWidget.getBounding();a.drawImage(this._yAxisWidget.getImage(t),d.left,0,d.width,d.height)}return r}createYAxisWidget(t){return null}}class Mb extends Ib{createAxisComponent(e){const t=V3(e??"default");return new t(this)}createMainWidget(e){return new yb(e,this)}createYAxisWidget(e){return new j3(e,this)}}class W3 extends Mb{createMainWidget(e){return new $3(e,this)}}class q3 extends wb{getAxisStyles(e){return e.xAxis}createAxisLine(e){return{coordinates:[{x:0,y:0},{x:e.width,y:0}]}}createTickLines(e,t,s){const i=s.tickLine,r=s.axisLine.size;return e.map(a=>({coordinates:[{x:a.coord,y:0},{x:a.coord,y:r+i.length}]}))}createTickTexts(e,t,s){const i=s.tickText,r=s.axisLine.size,a=s.tickLine.length;return e.map(l=>({x:l.coord,y:r+a+i.marginStart,text:l.text,align:"center",baseline:"top"}))}}class H3 extends kb{coordinateToPointTimestampDataIndexFlag(){return!0}coordinateToPointValueFlag(){return!1}getCompleteOverlays(){return this.getWidget().getPane().getChart().getChartStore().getOverlaysByPaneId()}getProgressOverlay(){var e;return((e=this.getWidget().getPane().getChart().getChartStore().getProgressOverlayInfo())==null?void 0:e.overlay)??null}getDefaultFigures(e,t){var c;const s=[],i=this.getWidget(),a=i.getPane().getChart().getChartStore(),l=a.getClickOverlayInfo();if(e.needDefaultXAxisFigure&&e.id===((c=l.overlay)==null?void 0:c.id)){let d=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER;t.forEach((g,_)=>{d=Math.min(d,g.x),v=Math.max(v,g.x);const y=e.points[_];if(ja(y.timestamp)){const k=a.getInnerFormatter().formatDate(y.timestamp,"YYYY-MM-DD HH:mm","crosshair");s.push({type:"text",attrs:{x:g.x,y:0,text:k,align:"center"},ignoreEvent:!0})}}),t.length>1&&s.unshift({type:"rect",attrs:{x:d,y:0,width:v-d,height:i.getBounding().height},ignoreEvent:!0})}return s}getFigures(e,t){var d;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),a=i.getAxisComponent(),l=r.getXAxisPane().getAxisComponent(),c=s.getBounding();return((d=e.createXAxisFigures)==null?void 0:d.call(e,{chart:r,overlay:e,coordinates:t,bounding:c,xAxis:l,yAxis:a}))??[]}}class G3 extends Sb{drawImp(e){var a;const t=this.getWidget(),s=t.getPane().getChart().getChartStore(),i=s.getCrosshair(),r=s.getStyles().crosshair;if(r.show){const l=this.getDirectionStyles(r),c=l.text;if(l.show&&c.show&&this.compare(i)){const d=t.getBounding(),v=t.getPane().getAxisComponent(),g=this.getText(i,s),_=s.getStyles().xAxis.tickText,y={...c,size:_.size,family:_.family,weight:_.weight};e.font=Ff(y.size,y.weight,y.family),(a=this.createFigure({name:"text",attrs:this.getTextAttrs(g,e.measureText(g).width,i,d,v,y),styles:y}))==null||a.draw(e)}}}compare(e){return Uo(e.timestamp)}getDirectionStyles(e){return e.vertical}getText(e,t){var i;const s=e.timestamp;return t.getInnerFormatter().formatDate(s,bb[((i=t.getPeriod())==null?void 0:i.type)??"day"],"crosshair")}getTextAttrs(e,t,s,i,r,a){const c=this.getWidget().getPane().getChart().getStyles().xAxis,d=c.axisLine.size,v=c.tickLine.length,g=d+v+c.tickText.marginStart-(a.paddingTop??0),_=s.realX;let y=0,k="center";return _-t/2-a.paddingLeft<0?(y=0,k="left"):_+t/2+a.paddingRight>i.width?(y=i.width,k="right"):y=_,{x:y,y:g,text:e,align:k,baseline:"top"}}}class U3 extends P1{constructor(t,s){super(t,s);ve(this,"_xAxisView",new q3(this));ve(this,"_overlayXAxisView",new H3(this));ve(this,"_crosshairVerticalLabelView",new G3(this));this.setCursor("ew-resize"),this.addChild(this._overlayXAxisView)}getName(){return bc.X_AXIS}updateMain(t){this._xAxisView.draw(t)}updateOverlay(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)}}class T1 extends Cb{constructor(e,t){super(e),this.override(t)}override(e){const{name:t,scrollZoomEnabled:s,createTicks:i}=e;pd(this.name)||(this.name=t),this.scrollZoomEnabled=s??this.scrollZoomEnabled,this.createTicks=i??this.createTicks}createRangeImp(){const t=this.getParent().getChart().getChartStore().getVisibleRange(),{realFrom:s,realTo:i}=t,r=s,a=i,l=i-s+1;return{from:r,to:a,range:l,realFrom:r,realTo:a,realRange:l,displayFrom:r,displayTo:a,displayRange:l}}createTicksImp(){const{realFrom:e,realTo:t,from:s}=this.getRange(),i=this.getParent().getChart().getChartStore(),r=i.getInnerFormatter().formatDate,a=i.getPeriod(),l=[],c=i.getBarSpace().bar,d=i.getStyles().xAxis.tickText,v=60,g=120,_=90,y=[1,2,3,5,10,15,20,30,45,60,90,120],k=Math.max(1,Math.round(_/Math.max(1,c)));let S=y.reduce((B,$)=>{const F=B*c,V=$*c,K=F>=v&&F<=g,Y=V>=v&&V<=g;if(K&&Y)return Math.abs(V-_)<Math.abs(F-_)?$:B;if(Y&&!K)return $;if(!K&&!Y){const Z=Math.abs(F-_);return Math.abs(V-_)<Z?$:B}return B},k);S=Math.max(1,S);const M=Math.max(0,Math.floor(e/S)*S),I=k3[(a==null?void 0:a.type)??"day"],C=mp(I,d.size,d.weight,d.family),T=Math.max(C,v);let z=NaN;const j=this.getBounding().width;for(let B=M;;B+=S){const $=this.convertToPixel(B);if($>j)break;if(B>=s){if(!isNaN(z)&&Math.abs($-z)<T)continue;const F=i.dataIndexToTimestamp(B);if(ja(F)){const V=r(F,I,"xAxis");z=$,l.push({coord:$,value:F,text:V})}}}return Vp(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:l}):l}getAutoSize(){const e=this.getParent().getChart().getStyles(),t=e.xAxis,s=t.size;if(s!=="auto")return s;const i=e.crosshair;let r=0;t.show&&(t.axisLine.show&&(r+=t.axisLine.size),t.tickLine.show&&(r+=t.tickLine.length),t.tickText.show&&(r+=t.tickText.marginStart+t.tickText.marginEnd+t.tickText.size));let a=0;return i.show&&i.vertical.show&&i.vertical.text.show&&(a+=i.vertical.text.paddingTop+i.vertical.text.paddingBottom+i.vertical.text.borderSize*2+i.vertical.text.size),Math.max(r,a)}getBounding(){return this.getParent().getMainWidget().getBounding()}convertTimestampFromPixel(e){const t=this.getParent().getChart().getChartStore(),s=t.coordinateToDataIndex(e);return t.dataIndexToTimestamp(s)}convertTimestampToPixel(e){const t=this.getParent().getChart().getChartStore(),s=t.timestampToDataIndex(e);return t.dataIndexToCoordinate(s)}convertFromPixel(e){return this.getParent().getChart().getChartStore().coordinateToDataIndex(e)}convertToPixel(e){return this.getParent().getChart().getChartStore().dataIndexToCoordinate(e)}static extend(e){class t extends T1{constructor(i){super(i,e)}}return t}}const Y3={name:"normal"},_y={normal:T1.extend(Y3)};function K3(o){return _y[o]??_y.normal}class Z3 extends Ib{createAxisComponent(e){const t=K3(e);return new t(this)}createMainWidget(e){return new U3(e,this)}}function X3(o,e){let t=0;return function(){const s=Date.now();s-t>e&&(o.apply(this,arguments),t=s)}}class J3 extends lb{constructor(t,s){super(t,s);ve(this,"_dragFlag",!1);ve(this,"_dragStartY",0);ve(this,"_topPaneHeight",0);ve(this,"_bottomPaneHeight",0);ve(this,"_topPane",null);ve(this,"_bottomPane",null);ve(this,"_pressedMouseMoveEvent",X3(this._pressedTouchMouseMoveEvent,20));this.registerEvent("touchStartEvent",this._mouseDownEvent.bind(this)).registerEvent("touchMoveEvent",this._pressedMouseMoveEvent.bind(this)).registerEvent("touchEndEvent",this._mouseUpEvent.bind(this)).registerEvent("mouseDownEvent",this._mouseDownEvent.bind(this)).registerEvent("mouseUpEvent",this._mouseUpEvent.bind(this)).registerEvent("pressedMouseMoveEvent",this._pressedMouseMoveEvent.bind(this)).registerEvent("mouseEnterEvent",this._mouseEnterEvent.bind(this)).registerEvent("mouseLeaveEvent",this._mouseLeaveEvent.bind(this))}getName(){return bc.SEPARATOR}_mouseDownEvent(t){this._dragFlag=!0,this._dragStartY=t.pageY;const s=this.getPane(),i=s.getChart();this._topPane=s.getTopPane(),this._bottomPane=s.getBottomPane();const r=i.getDrawPanes();if(this._topPane.getOptions().state==="minimize"){const a=r.findIndex(l=>{var c;return l.getId()===((c=this._topPane)==null?void 0:c.getId())});for(let l=a-1;l>-1;l--){const c=r[l];if(c.getOptions().state!=="minimize"){this._topPane=c;break}}}if(this._bottomPane.getOptions().state==="minimize"){const a=r.findIndex(l=>{var c;return l.getId()===((c=this._bottomPane)==null?void 0:c.getId())});for(let l=a+1;l<r.length;l++){const c=r[l];if(c.getOptions().state!=="minimize"){this._bottomPane=c;break}}}return this._topPaneHeight=this._topPane.getBounding().height,this._bottomPaneHeight=this._bottomPane.getBounding().height,!0}_mouseUpEvent(){return this._dragFlag=!1,this._topPane=null,this._bottomPane=null,this._topPaneHeight=0,this._bottomPaneHeight=0,this._mouseLeaveEvent()}_pressedTouchMouseMoveEvent(t){const s=t.pageY-this._dragStartY,i=s<0;if(Uo(this._topPane)&&Uo(this._bottomPane)){const r=this._bottomPane.getOptions();if(this._topPane.getOptions().state!=="minimize"&&r.state!=="minimize"&&r.dragEnabled){let a=null,l=null,c=0,d=0;i?(a=this._topPane,l=this._bottomPane,c=this._topPaneHeight,d=this._bottomPaneHeight):(a=this._bottomPane,l=this._topPane,c=this._bottomPaneHeight,d=this._topPaneHeight);const v=a.getOptions().minHeight;if(c>v){const g=Math.max(c-Math.abs(s),v),_=c-g;a.setBounding({height:g}),l.setBounding({height:d+_});const y=this.getPane(),k=y.getChart();k.getChartStore().executeAction("onPaneDrag",{paneId:y.getId()}),k.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}}}return!0}_mouseEnterEvent(){const t=this.getPane();if(t.getBottomPane().getOptions().dragEnabled){const r=t.getChart().getStyles().separator;return this.getContainer().style.background=r.activeBackgroundColor,!0}return!1}_mouseLeaveEvent(){return this._dragFlag?!1:(this.getContainer().style.background="transparent",!0)}createContainer(){return Df("div",{width:"100%",height:`${A0}px`,margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})}updateImp(t,s,i){if(i===hd.All||i===hd.Separator){const r=this.getPane().getChart().getStyles().separator;t.style.top=`${-Math.floor((A0-r.size)/2)}px`,t.style.height=`${A0}px`}}}class Q3 extends Pb{constructor(t,s,i,r){super(t,s);ve(this,"_topPane");ve(this,"_bottomPane");ve(this,"_separatorWidget");this.getContainer().style.overflow="",this._topPane=i,this._bottomPane=r,this._separatorWidget=new J3(this.getContainer(),this)}setBounding(t){return Ru(this.getBounding(),t),this}getTopPane(){return this._topPane}setTopPane(t){return this._topPane=t,this}getBottomPane(){return this._bottomPane}setBottomPane(t){return this._bottomPane=t,this}getWidget(){return this._separatorWidget}getImage(t){const{width:s,height:i}=this.getBounding(),r=this.getChart().getStyles().separator,a=Df("canvas",{width:`${s}px`,height:`${i}px`,boxSizing:"border-box"}),l=a.getContext("2d"),c=Xf(a);return a.width=s*c,a.height=i*c,l.scale(c,c),l.fillStyle=r.color,l.fillRect(0,0,s,i),a}updateImp(t,s,i){if(t===hd.All||t===hd.Separator){const r=this.getChart().getStyles().separator;s.style.backgroundColor=r.color,s.style.height=`${i.height}px`,s.style.marginLeft=`${i.left}px`,s.style.width=`${i.width}px`,this._separatorWidget.update(t)}}}function yy(){return typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes("firefox")}function I_(){return typeof window>"u"?!1:/iPhone|iPad|iPod|iOS/.test(window.navigator.userAgent)}const Og={ResetClick:500,LongTap:500,PreventFiresTouchEvents:500},Sm={CancelClick:5,CancelTap:5,DoubleClick:5,DoubleTap:30},g0={Left:0,Middle:1,Right:2},ek=10;class tk{constructor(e,t,s){ve(this,"_target");ve(this,"_handler");ve(this,"_options");ve(this,"_clickCount",0);ve(this,"_clickTimeoutId",null);ve(this,"_clickCoordinate",{x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY});ve(this,"_tapCount",0);ve(this,"_tapTimeoutId",null);ve(this,"_tapCoordinate",{x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY});ve(this,"_longTapTimeoutId",null);ve(this,"_longTapActive",!1);ve(this,"_mouseMoveStartCoordinate",null);ve(this,"_touchMoveStartCoordinate",null);ve(this,"_touchMoveExceededManhattanDistance",!1);ve(this,"_cancelClick",!1);ve(this,"_cancelTap",!1);ve(this,"_unsubscribeOutsideMouseEvents",null);ve(this,"_unsubscribeOutsideTouchEvents",null);ve(this,"_unsubscribeMobileSafariEvents",null);ve(this,"_unsubscribeMousemove",null);ve(this,"_unsubscribeMouseWheel",null);ve(this,"_unsubscribeContextMenu",null);ve(this,"_unsubscribeRootMouseEvents",null);ve(this,"_unsubscribeRootTouchEvents",null);ve(this,"_startPinchMiddleCoordinate",null);ve(this,"_startPinchDistance",0);ve(this,"_pinchPrevented",!1);ve(this,"_preventTouchDragProcess",!1);ve(this,"_mousePressed",!1);ve(this,"_lastTouchEventTimeStamp",0);ve(this,"_activeTouchId",null);ve(this,"_acceptMouseLeave",!I_());ve(this,"_onFirefoxOutsideMouseUp",e=>{this._mouseUpHandler(e)});ve(this,"_onMobileSafariDoubleClick",e=>{if(this._firesTouchEvents(e)){if(++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){const{manhattanDistance:t}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate);t<Sm.DoubleTap&&!this._cancelTap&&this._processEvent(this._makeCompatEvent(e),this._handler.doubleTapEvent),this._resetTapTimeout()}}else if(++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){const{manhattanDistance:t}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._clickCoordinate);t<Sm.DoubleClick&&!this._cancelClick&&this._processEvent(this._makeCompatEvent(e),this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}});this._target=e,this._handler=t,this._options=s,this._init()}destroy(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()}_mouseEnterHandler(e){var r,a,l;(r=this._unsubscribeMousemove)==null||r.call(this),(a=this._unsubscribeMouseWheel)==null||a.call(this),(l=this._unsubscribeContextMenu)==null||l.call(this);const t=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=()=>{this._target.removeEventListener("mousemove",t)},this._target.addEventListener("mousemove",t);const s=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=()=>{this._target.removeEventListener("wheel",s)},this._target.addEventListener("wheel",s,{passive:!1});const i=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=()=>{this._target.removeEventListener("contextmenu",i)},this._target.addEventListener("contextmenu",i,{passive:!1}),!this._firesTouchEvents(e)&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)}_resetClickTimeout(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_resetTapTimeout(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_mouseMoveHandler(e){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)}_mouseWheelHandler(e){if(Math.abs(e.deltaX)>Math.abs(e.deltaY)){if(!Uo(this._handler.mouseWheelHortEvent)||(this._preventDefault(e),Math.abs(e.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(e),-e.deltaX)}else{if(!Uo(this._handler.mouseWheelVertEvent))return;let t=-(e.deltaY/100);if(t===0)return;switch(this._preventDefault(e),e.deltaMode){case e.DOM_DELTA_PAGE:{t*=120;break}case e.DOM_DELTA_LINE:{t*=32;break}}if(t!==0){const s=Math.sign(t)*Math.min(1,Math.abs(t));this._handler.mouseWheelVertEvent(this._makeCompatEvent(e),s)}}}_contextMenuHandler(e){this._preventDefault(e)}_touchMoveHandler(e){const t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t===null||(this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._startPinchMiddleCoordinate!==null)||this._preventTouchDragProcess)return;this._pinchPrevented=!0;const s=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._touchMoveStartCoordinate),{xOffset:i,yOffset:r,manhattanDistance:a}=s;if(!(!this._touchMoveExceededManhattanDistance&&a<Sm.CancelTap)){if(!this._touchMoveExceededManhattanDistance){const l=i*.5,c=r>=l&&!this._options.treatVertDragAsPageScroll(),d=l>r&&!this._options.treatHorzDragAsPageScroll();!c&&!d&&(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(e,t),this._handler.touchMoveEvent)}}_mouseMoveWithDownHandler(e){if(e.button!==g0.Left)return;const t=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._mouseMoveStartCoordinate),{manhattanDistance:s}=t;s>=Sm.CancelClick&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(e),this._handler.pressedMouseMoveEvent)}_mouseTouchMoveWithDownInfo(e,t){const s=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y),r=s+i;return{xOffset:s,yOffset:i,manhattanDistance:r}}_touchEndHandler(e){let t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t===null&&e.touches.length===0&&(t=e.changedTouches[0]),t===null)return;this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);const s=this._makeCompatEvent(e,t);if(this._processEvent(s,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){const{manhattanDistance:i}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._tapCoordinate);i<Sm.DoubleTap&&!this._cancelTap&&this._processEvent(s,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processEvent(s,this._handler.tapEvent),Uo(this._handler.tapEvent)&&this._preventDefault(e));this._tapCount===0&&this._preventDefault(e),e.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(e))}_mouseUpHandler(e){if(e.button!==g0.Left)return;const t=this._makeCompatEvent(e);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),yy()&&this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp),!this._firesTouchEvents(e))if(this._processEvent(t,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){const{manhattanDistance:s}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._clickCoordinate);s<Sm.DoubleClick&&!this._cancelClick&&this._processEvent(t,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processEvent(t,this._handler.mouseClickEvent)}_clearLongTapTimeout(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}_touchStartHandler(e){if(this._activeTouchId!==null)return;const t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(e);const s=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{const i=this._touchMoveHandler.bind(this),r=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=()=>{s.removeEventListener("touchmove",i),s.removeEventListener("touchend",r)},s.addEventListener("touchmove",i,{passive:!1}),s.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),Og.LongTap)}this._processEvent(this._makeCompatEvent(e,t),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),Og.ResetClick),this._tapCoordinate=this._getCoordinate(t))}_mouseDownHandler(e){if(e.button===g0.Right){this._preventDefault(e),this._processEvent(this._makeCompatEvent(e),this._handler.mouseRightClickEvent);return}if(e.button!==g0.Left)return;const t=this._target.ownerDocument.documentElement;yy()&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{const s=this._mouseMoveWithDownHandler.bind(this),i=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=()=>{t.removeEventListener("mousemove",s),t.removeEventListener("mouseup",i)},t.addEventListener("mousemove",s),t.addEventListener("mouseup",i)}this._mousePressed=!0,!this._firesTouchEvents(e)&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),Og.ResetClick),this._clickCoordinate=this._getCoordinate(e)))}_init(){this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{const e=this._target.ownerDocument,t=s=>{this._handler.mouseDownOutsideEvent!=null&&(s.composed&&this._target.contains(s.composedPath()[0])||s.target!==null&&this._target.contains(s.target)||this._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=()=>{e.removeEventListener("touchstart",t)},this._unsubscribeOutsideMouseEvents=()=>{e.removeEventListener("mousedown",t)},e.addEventListener("mousedown",t),e.addEventListener("touchstart",t,{passive:!0})}I_()&&(this._unsubscribeMobileSafariEvents=()=>{this._target.removeEventListener("dblclick",this._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",e=>{if(e.button===g0.Middle)return e.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",()=>{},{passive:!1})}_initPinch(){!Uo(this._handler.pinchStartEvent)&&!Uo(this._handler.pinchEvent)&&!Uo(this._handler.pinchEndEvent)||(this._target.addEventListener("touchstart",e=>{this._checkPinchState(e.touches)},{passive:!0}),this._target.addEventListener("touchmove",e=>{if(!(e.touches.length!==2||this._startPinchMiddleCoordinate===null)&&Uo(this._handler.pinchEvent)){const s=this._getTouchDistance(e.touches[0],e.touches[1])/this._startPinchDistance;this._handler.pinchEvent({...this._startPinchMiddleCoordinate,pageX:0,pageY:0},s),this._preventDefault(e)}},{passive:!1}),this._target.addEventListener("touchend",e=>{this._checkPinchState(e.touches)}))}_checkPinchState(e){e.length===1&&(this._pinchPrevented=!1),e.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)}_startPinch(e){const t=this._target.getBoundingClientRect();this._startPinchMiddleCoordinate={x:(e[0].clientX-t.left+(e[1].clientX-t.left))/2,y:(e[0].clientY-t.top+(e[1].clientY-t.top))/2},this._startPinchDistance=this._getTouchDistance(e[0],e[1]),Uo(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()}_stopPinch(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,Uo(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))}_mouseLeaveHandler(e){var t,s,i;(t=this._unsubscribeMousemove)==null||t.call(this),(s=this._unsubscribeMouseWheel)==null||s.call(this),(i=this._unsubscribeContextMenu)==null||i.call(this),!this._firesTouchEvents(e)&&this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!I_())}_longTapHandler(e){const t=this._touchWithId(e.touches,this._activeTouchId);t!==null&&(this._processEvent(this._makeCompatEvent(e,t),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)}_firesTouchEvents(e){var t;return Uo((t=e.sourceCapabilities)==null?void 0:t.firesTouchEvents)?e.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(e)<this._lastTouchEventTimeStamp+Og.PreventFiresTouchEvents}_processEvent(e,t){t==null||t.call(this._handler,e)}_makeCompatEvent(e,t){const s=t??e,i=this._target.getBoundingClientRect();return{x:s.clientX-i.left,y:s.clientY-i.top,pageX:s.pageX,pageY:s.pageY,isTouch:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click"&&e.type!=="wheel",preventDefault:()=>{e.type!=="touchstart"&&this._preventDefault(e)}}}_getTouchDistance(e,t){const s=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(s*s+i*i)}_preventDefault(e){e.cancelable&&e.preventDefault()}_getCoordinate(e){return{x:e.pageX,y:e.pageY}}_eventTimeStamp(e){return e.timeStamp??performance.now()}_touchWithId(e,t){for(let s=0;s<e.length;++s)if(e[s].identifier===t)return e[s];return null}}class ok{constructor(e,t){ve(this,"_container");ve(this,"_chart");ve(this,"_event");ve(this,"_flingStartTime",new Date().getTime());ve(this,"_flingScrollRequestId",null);ve(this,"_startScrollCoordinate",null);ve(this,"_touchCoordinate",null);ve(this,"_touchCancelCrosshair",!1);ve(this,"_touchZoomed",!1);ve(this,"_pinchScale",1);ve(this,"_mouseDownWidget",null);ve(this,"_prevYAxisRange",null);ve(this,"_xAxisStartScaleCoordinate",null);ve(this,"_xAxisStartScaleDistance",0);ve(this,"_xAxisScale",1);ve(this,"_yAxisStartScaleDistance",0);ve(this,"_mouseMoveTriggerWidgetInfo",{pane:null,widget:null});ve(this,"_wheelScrollAccum",0);ve(this,"_wheelScrollRafId",null);ve(this,"_wheelZoomAccum",0);ve(this,"_wheelZoomRafId",null);ve(this,"_wheelZoomLastCoord",null);ve(this,"_overlayUpdateRafId",null);ve(this,"_yAxisScaleRafId",null);ve(this,"_boundKeyBoardDownEvent",e=>{if(e.shiftKey)switch(e.code){case"Equal":{this._chart.getChartStore().zoom(.5);break}case"Minus":{this._chart.getChartStore().zoom(-.5);break}case"ArrowLeft":{const t=this._chart.getChartStore();t.startScroll(),t.scroll(-3*t.getBarSpace().bar);break}case"ArrowRight":{const t=this._chart.getChartStore();t.startScroll(),t.scroll(3*t.getBarSpace().bar);break}}});this._container=e,this._chart=t,this._event=new tk(e,this,{treatVertDragAsPageScroll:()=>!1,treatHorzDragAsPageScroll:()=>!1}),e.addEventListener("keydown",this._boundKeyBoardDownEvent)}pinchStartEvent(){return this._touchZoomed=!0,this._pinchScale=1,!0}pinchEvent(e,t){const{pane:s,widget:i}=this._findWidgetByEvent(e);if((s==null?void 0:s.getId())!==pc.X_AXIS&&(i==null?void 0:i.getName())===bc.MAIN){const r=this._makeWidgetEvent(e,i),a=(t-this._pinchScale)*5;return this._pinchScale=t,this._chart.getChartStore().zoom(a,{x:r.x,y:r.y}),!0}return!1}mouseWheelHortEvent(e,t){if(this._wheelScrollAccum+=t,this._wheelScrollRafId===null){const s=this._chart.getChartStore();this._wheelScrollRafId=Lf(()=>{const i=this._wheelScrollAccum;this._wheelScrollAccum=0,this._wheelScrollRafId=null,s.startScroll(),s.scroll(i)})}return!0}mouseWheelVertEvent(e,t){const{widget:s}=this._findWidgetByEvent(e),i=this._makeWidgetEvent(e,s);return(s==null?void 0:s.getName())===bc.MAIN?(this._wheelZoomAccum+=t,this._wheelZoomLastCoord={x:i.x,y:i.y},this._wheelZoomRafId===null&&(this._wheelZoomRafId=Lf(()=>{const a=this._wheelZoomAccum,l=this._wheelZoomLastCoord??{x:i.x,y:i.y};this._wheelZoomAccum=0,this._wheelZoomLastCoord=null,this._wheelZoomRafId=null,this._chart.getChartStore().zoom(a,l)})),!0):!1}mouseDownEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);if(this._mouseDownWidget=s,s!==null){const i=this._makeWidgetEvent(e,s);switch(s.getName()){case bc.SEPARATOR:return s.dispatchEvent("mouseDownEvent",i);case bc.MAIN:{const a=t.getAxisComponent();if(!a.getAutoCalcTickFlag()){const l=a.getRange();this._prevYAxisRange={...l}}return this._startScrollCoordinate={x:i.x,y:i.y},this._chart.getChartStore().startScroll(),s.dispatchEvent("mouseDownEvent",i)}case bc.X_AXIS:return this._processXAxisScrollStartEvent(s,i);case bc.Y_AXIS:return this._processYAxisScaleStartEvent(s,i)}}return!1}mouseMoveEvent(e){var r,a,l;const{pane:t,widget:s}=this._findWidgetByEvent(e),i=this._makeWidgetEvent(e,s);if((((r=this._mouseMoveTriggerWidgetInfo.pane)==null?void 0:r.getId())!==(t==null?void 0:t.getId())||((a=this._mouseMoveTriggerWidgetInfo.widget)==null?void 0:a.getName())!==(s==null?void 0:s.getName()))&&(s==null||s.dispatchEvent("mouseEnterEvent",i),(l=this._mouseMoveTriggerWidgetInfo.widget)==null||l.dispatchEvent("mouseLeaveEvent",i),this._mouseMoveTriggerWidgetInfo={pane:t,widget:s}),s!==null){const c=s.getName();switch(c){case bc.MAIN:{const d=s.dispatchEvent("mouseMoveEvent",i);let v={x:i.x,y:i.y,paneId:t==null?void 0:t.getId()};return d?(s.getForceCursor()!=="pointer"&&(v=void 0),s.setCursor("pointer")):s.setCursor("crosshair"),this._chart.getChartStore().setCrosshair(v),d}case bc.SEPARATOR:case bc.X_AXIS:case bc.Y_AXIS:{const d=s.dispatchEvent("mouseMoveEvent",i);return c===bc.X_AXIS?this._chart.getChartStore().setCrosshair({x:i.x,paneId:t==null?void 0:t.getId()}):this._chart.getChartStore().setCrosshair(),d}}}return!1}pressedMouseMoveEvent(e){var i,r;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===bc.SEPARATOR)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",e);const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null&&((i=this._mouseDownWidget)==null?void 0:i.getPane().getId())===(t==null?void 0:t.getId())&&((r=this._mouseDownWidget)==null?void 0:r.getName())===s.getName()){const a=this._makeWidgetEvent(e,s);switch(s.getName()){case bc.MAIN:{let c;const d=s.dispatchEvent("pressedMouseMoveEvent",a);return d||this._processMainScrollingEvent(s,a),(!d||s.getForceCursor()==="pointer")&&(c={x:a.x,y:a.y,paneId:t==null?void 0:t.getId()}),this._chart.getChartStore().setCrosshair(c,{forceInvalidate:!0}),d}case bc.X_AXIS:return this._processXAxisScrollingEvent(s,a);case bc.Y_AXIS:return this._processYAxisScalingEvent(s,a)}}return!1}mouseUpEvent(e){const{widget:t}=this._findWidgetByEvent(e);let s=!1;if(t!==null){const i=this._makeWidgetEvent(e,t);switch(t.getName()){case bc.MAIN:case bc.SEPARATOR:case bc.X_AXIS:case bc.Y_AXIS:{s=t.dispatchEvent("mouseUpEvent",i);break}}s&&this._scheduleOverlayUpdate()}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._yAxisScaleRafId=null,s}mouseClickEvent(e){const{widget:t}=this._findWidgetByEvent(e);if(t!==null){const s=this._makeWidgetEvent(e,t);return t.dispatchEvent("mouseClickEvent",s)}return!1}mouseRightClickEvent(e){const{widget:t}=this._findWidgetByEvent(e);let s=!1;if(t!==null){const i=this._makeWidgetEvent(e,t);switch(t.getName()){case bc.MAIN:case bc.X_AXIS:case bc.Y_AXIS:{s=t.dispatchEvent("mouseRightClickEvent",i);break}}s&&this._scheduleOverlayUpdate()}return!1}mouseDoubleClickEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null)switch(s.getName()){case bc.MAIN:{const r=this._makeWidgetEvent(e,s);return s.dispatchEvent("mouseDoubleClickEvent",r)}case bc.Y_AXIS:{const r=t.getAxisComponent();if(!r.getAutoCalcTickFlag())return r.setAutoCalcTickFlag(!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}),!0;break}}return!1}mouseLeaveEvent(){return this._chart.getChartStore().setCrosshair(),!0}touchStartEvent(e){var i;const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null){const r=this._makeWidgetEvent(e,s);switch((i=r.preventDefault)==null||i.call(r),s.getName()){case bc.MAIN:{const l=this._chart.getChartStore();if(s.dispatchEvent("mouseDownEvent",r))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(hd.Overlay),!0;this._flingScrollRequestId!==null&&(ny(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime();const c=t.getAxisComponent();if(!c.getAutoCalcTickFlag()){const d=c.getRange();this._prevYAxisRange={...d}}if(this._startScrollCoordinate={x:r.x,y:r.y},l.startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){const d=r.x-this._touchCoordinate.x,v=r.y-this._touchCoordinate.y;Math.sqrt(d*d+v*v)<ek?(this._touchCoordinate={x:r.x,y:r.y},l.setCrosshair({x:r.x,y:r.y,paneId:t==null?void 0:t.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,l.setCrosshair())}return!0}case bc.X_AXIS:return this._processXAxisScrollStartEvent(s,r);case bc.Y_AXIS:return this._processYAxisScaleStartEvent(s,r)}}return!1}touchMoveEvent(e){var i;const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null){const r=this._makeWidgetEvent(e,s);(i=r.preventDefault)==null||i.call(r);const a=s.getName(),l=this._chart.getChartStore();switch(a){case bc.MAIN:return s.dispatchEvent("pressedMouseMoveEvent",r)?(l.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(hd.Overlay),!0):(this._touchCoordinate!==null?l.setCrosshair({x:r.x,y:r.y,paneId:t==null?void 0:t.getId()}):this._processMainScrollingEvent(s,r),!0);case bc.X_AXIS:return this._processXAxisScrollingEvent(s,r);case bc.Y_AXIS:return this._processYAxisScalingEvent(s,r)}}return!1}touchEndEvent(e){const{widget:t}=this._findWidgetByEvent(e);if(t!==null){const s=this._makeWidgetEvent(e,t);switch(t.getName()){case bc.MAIN:{if(t.dispatchEvent("mouseUpEvent",s),this._startScrollCoordinate!==null){const r=new Date().getTime()-this._flingStartTime;let l=(s.x-this._startScrollCoordinate.x)/(r>0?r:1)*20;if(r<200&&Math.abs(l)>0){const c=this._chart.getChartStore(),d=()=>{this._flingScrollRequestId=Lf(()=>{c.startScroll(),c.scroll(l),l=l*(1-.025),Math.abs(l)<1?this._flingScrollRequestId!==null&&(ny(this._flingScrollRequestId),this._flingScrollRequestId=null):d()})};d()}}return!0}case bc.X_AXIS:case bc.Y_AXIS:t.dispatchEvent("mouseUpEvent",s)&&this._chart.updatePane(hd.Overlay)}this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._yAxisScaleRafId=null}return!1}tapEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);let i=!1;if(s!==null){const r=this._makeWidgetEvent(e,s),a=s.dispatchEvent("mouseClickEvent",r);if(s.getName()===bc.MAIN){const l=this._makeWidgetEvent(e,s),c=this._chart.getChartStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,c.setCrosshair(void 0,{notInvalidate:!0}),i=!0):(!this._touchCancelCrosshair&&!this._touchZoomed&&(this._touchCoordinate={x:l.x,y:l.y},c.setCrosshair({x:l.x,y:l.y,paneId:t==null?void 0:t.getId()},{notInvalidate:!0}),i=!0),this._touchCancelCrosshair=!1)}(i||a)&&this._scheduleOverlayUpdate()}return i}doubleTapEvent(e){return this.mouseDoubleClickEvent(e)}longTapEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null&&s.getName()===bc.MAIN){const i=this._makeWidgetEvent(e,s);return this._touchCoordinate={x:i.x,y:i.y},this._chart.getChartStore().setCrosshair({x:i.x,y:i.y,paneId:t==null?void 0:t.getId()}),!0}return!1}_processMainScrollingEvent(e,t){if(this._startScrollCoordinate!==null){const s=e.getPane().getAxisComponent();if(this._prevYAxisRange!==null&&!s.getAutoCalcTickFlag()&&s.scrollZoomEnabled){const{from:r,to:a,range:l}=this._prevYAxisRange;let c=0;s.reverse?c=this._startScrollCoordinate.y-t.y:c=t.y-this._startScrollCoordinate.y;const d=e.getBounding(),v=c/d.height,g=l*v,_=r+g,y=a+g,k=s.valueToRealValue(_,{range:this._prevYAxisRange}),S=s.valueToRealValue(y,{range:this._prevYAxisRange}),M=s.realValueToDisplayValue(k,{range:this._prevYAxisRange}),I=s.realValueToDisplayValue(S,{range:this._prevYAxisRange});s.setRange({from:_,to:y,range:y-_,realFrom:k,realTo:S,realRange:S-k,displayFrom:M,displayTo:I,displayRange:I-M})}const i=t.x-this._startScrollCoordinate.x;this._chart.getChartStore().scroll(i)}}_processXAxisScrollStartEvent(e,t){const s=e.dispatchEvent("mouseDownEvent",t);return s&&this._scheduleOverlayUpdate(),this._xAxisStartScaleCoordinate={x:t.x,y:t.y},this._xAxisStartScaleDistance=t.pageX,s}_processXAxisScrollingEvent(e,t){const s=e.dispatchEvent("pressedMouseMoveEvent",t);if(s)this._scheduleOverlayUpdate();else if(e.getPane().getAxisComponent().scrollZoomEnabled&&this._xAxisStartScaleDistance!==0){const r=this._xAxisStartScaleDistance/t.pageX;if(Number.isFinite(r)){const a=(r-this._xAxisScale)*10;this._xAxisScale=r,this._chart.getChartStore().zoom(a,this._xAxisStartScaleCoordinate??void 0)}}return s}_processYAxisScaleStartEvent(e,t){const s=e.dispatchEvent("mouseDownEvent",t);s&&this._scheduleOverlayUpdate();const i=e.getPane().getAxisComponent().getRange();return this._prevYAxisRange={...i},this._yAxisStartScaleDistance=t.pageY,s}_processYAxisScalingEvent(e,t){const s=e.dispatchEvent("pressedMouseMoveEvent",t);if(s)this._chart.updatePane(hd.Overlay);else{const i=e.getPane().getAxisComponent();if(this._prevYAxisRange!==null&&i.scrollZoomEnabled&&this._yAxisStartScaleDistance!==0){const{from:r,to:a,range:l}=this._prevYAxisRange,c=t.pageY/this._yAxisStartScaleDistance,d=Number.isFinite(c)?Math.min(5,Math.max(.2,c)):1,v=l*d,g=(v-l)/2,_=r-g,y=a+g,k=i.valueToRealValue(_,{range:this._prevYAxisRange}),S=i.valueToRealValue(y,{range:this._prevYAxisRange}),M=i.realValueToDisplayValue(k,{range:this._prevYAxisRange}),I=i.realValueToDisplayValue(S,{range:this._prevYAxisRange});i.setRange({from:_,to:y,range:v,realFrom:k,realTo:S,realRange:S-k,displayFrom:M,displayTo:I,displayRange:I-M}),this._yAxisScaleRafId===null&&(this._yAxisScaleRafId=Lf(()=>{this._yAxisScaleRafId=null,this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})}))}}return s}_findWidgetByEvent(e){const{x:t,y:s}=e,i=this._chart.getSeparatorPanes(),r=this._chart.getStyles().separator.size;for(const d of i){const v=d[1],g=v.getBounding(),_=g.top-Math.round((A0-r)/2);if(t>=g.left&&t<=g.left+g.width&&s>=_&&s<=_+A0)return{pane:v,widget:v.getWidget()}}const a=this._chart.getDrawPanes();let l=null;for(const d of a){const v=d.getBounding();if(t>=v.left&&t<=v.left+v.width&&s>=v.top&&s<=v.top+v.height){l=d;break}}let c=null;if(l!==null){if(!Uo(c)){const d=l.getMainWidget(),v=d.getBounding();t>=v.left&&t<=v.left+v.width&&s>=v.top&&s<=v.top+v.height&&(c=d)}if(!Uo(c)){const d=l.getYAxisWidget();if(d!==null){const v=d.getBounding();t>=v.left&&t<=v.left+v.width&&s>=v.top&&s<=v.top+v.height&&(c=d)}}}return{pane:l,widget:c}}_makeWidgetEvent(e,t){const s=(t==null?void 0:t.getBounding())??null;return{...e,x:e.x-((s==null?void 0:s.left)??0),y:e.y-((s==null?void 0:s.top)??0)}}destroy(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()}}class sk{constructor(e,t){ve(this,"id");ve(this,"_container");ve(this,"_chartContainer");ve(this,"_chartBounding",_h());ve(this,"_chartEvent");ve(this,"_chartStore");ve(this,"_drawPanes",[]);ve(this,"_candlePane");ve(this,"_xAxisPane");ve(this,"_separatorPanes",new Map);ve(this,"_layoutOptions",{sort:!0,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!1,cacheYAxisWidth:!1,forceBuildYAxisTick:!1});ve(this,"_layoutPending",!1);ve(this,"_cacheYAxisWidth",{left:0,right:0});this.id=b0("chart"),this._initContainer(e),this._chartEvent=new ok(this._chartContainer,this),this._chartStore=new Z6(this,t),this._initPanes(t),this._layout()}_initContainer(e){this._container=e,this._chartContainer=Df("div",{position:"relative",width:"100%",height:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",overflow:"hidden",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,e.appendChild(this._chartContainer),this._cacheChartBounding()}_cacheChartBounding(){this._chartBounding.width=Math.floor(this._chartContainer.clientWidth),this._chartBounding.height=Math.floor(this._chartContainer.clientHeight)}_initPanes(e){const t=(e==null?void 0:e.layout)??[{type:"candle"}],s=r=>{if(!Uo(this._candlePane)){const a=r.options??{};Ru(a,{id:pc.CANDLE}),this._candlePane=this._createPane(W3,pc.CANDLE,a),(r.content??[]).forEach(c=>{this.createIndicator(c,!0,a)})}},i=r=>{if(!Uo(this._xAxisPane)){const a=this._createPane(Z3,pc.X_AXIS,r??{});this._xAxisPane=a}};t.forEach(r=>{var a;switch(r.type){case"candle":{s(r);break}case"indicator":{const l=r.content??[];if(l.length>0){let c=((a=r.options)==null?void 0:a.id)??null;Uo(c)&&(c=b0(pc.INDICATOR));const d={...r.options,id:c};l.forEach(v=>{this.createIndicator(v,!0,d)})}break}case"xAxis":{i(r.options);break}}}),s({type:"candle"}),i({order:Number.MAX_SAFE_INTEGER})}_createPane(e,t,s){const i=new e(this,t,s??{});return this._drawPanes.push(i),i}_recalculatePaneHeight(e,t,s){if(s===0)return!1;const i=this._drawPanes.filter(a=>{const l=a.getId();return a.getOptions().state==="normal"&&l!==e.getId()&&l!==pc.X_AXIS}),r=i.length;if(r===0)return!1;if(e.getId()!==pc.CANDLE&&Uo(this._candlePane)&&this._candlePane.getOptions().state==="normal"){const a=this._candlePane.getBounding().height;if(a>0){const l=this._candlePane.getOptions().minHeight;let c=a+s;c<l&&(c=l,t-=a+s-c),this._candlePane.setBounding({height:c})}}else{let a=s;const l=Math.floor(s/r);i.forEach((c,d)=>{const v=c.getBounding().height;let g=0;d===r-1?g=v+a:g=v+l,g<c.getOptions().minHeight&&(g=c.getOptions().minHeight),c.setBounding({height:g}),a-=g-v}),Math.abs(a)>0&&(t-=a)}return e.setBounding({height:t}),!0}getDrawPaneById(e){return e===pc.CANDLE?this._candlePane:e===pc.X_AXIS?this._xAxisPane:this._drawPanes.find(s=>s.getId()===e)??null}getContainer(){return this._container}getChartStore(){return this._chartStore}getXAxisPane(){return this._xAxisPane}getDrawPanes(){return this._drawPanes}getSeparatorPanes(){return this._separatorPanes}layout(e){(e.sort??!1)&&(this._layoutOptions.sort=e.sort),(e.measureHeight??!1)&&(this._layoutOptions.measureHeight=e.measureHeight),(e.measureWidth??!1)&&(this._layoutOptions.measureWidth=e.measureWidth),(e.update??!1)&&(this._layoutOptions.update=e.update),(e.buildYAxisTick??!1)&&(this._layoutOptions.buildYAxisTick=e.buildYAxisTick),(e.cacheYAxisWidth??!1)&&(this._layoutOptions.cacheYAxisWidth=e.cacheYAxisWidth),(e.buildYAxisTick??!1)&&(this._layoutOptions.forceBuildYAxisTick=e.forceBuildYAxisTick),this._layoutPending||(this._layoutPending=!0,Promise.resolve().then(t=>{this._layout(),this._layoutPending=!1}).catch(t=>{}))}_layout(){const{sort:e,measureHeight:t,measureWidth:s,update:i,buildYAxisTick:r,cacheYAxisWidth:a,forceBuildYAxisTick:l}=this._layoutOptions,c=typeof performance<"u"?performance.now():Date.now();if(e){for(;Uo(this._chartContainer.firstChild);)this._chartContainer.removeChild(this._chartContainer.firstChild);this._separatorPanes.clear(),this._drawPanes.sort((y,k)=>y.getOptions().order-k.getOptions().order);let _=null;this._drawPanes.forEach(y=>{if(y.getId()!==pc.X_AXIS){if(Uo(_)){const k=new Q3(this,"",_,y);this._chartContainer.appendChild(k.getContainer()),this._separatorPanes.set(y,k)}_=y}this._chartContainer.appendChild(y.getContainer())})}if(t){const _=this._chartBounding.height,y=this.getStyles().separator.size,k=this._xAxisPane.getAxisComponent().getAutoSize();let S=_-k;S<0&&(S=0),this._drawPanes.forEach(I=>{const C=I.getId();if(Uo(this._separatorPanes.get(I))&&(S-=y),C!==pc.X_AXIS&&C!==pc.CANDLE&&I.getVisible()){let T=I.getBounding().height;T>S?(T=S,S=0):S-=T,I.setBounding({height:T})}}),this._candlePane.setBounding({height:Math.max(S,0)}),this._xAxisPane.setBounding({height:k});let M=0;this._drawPanes.forEach(I=>{const C=this._separatorPanes.get(I);Uo(C)&&(C.setBounding({height:y,top:M}),M+=y),I.setBounding({top:M}),M+=I.getBounding().height})}let d=s;if((r||l)&&this._drawPanes.forEach(_=>{const y=_.getAxisComponent().buildTicks(l);d||(d=y)}),d){const _=this._chartBounding.width,y=this.getStyles();let k=0,S=!0,M=0,I=!0;this._drawPanes.forEach(Y=>{if(Y.getId()!==pc.X_AXIS){const Z=Y.getAxisComponent(),ne=Z.inside,te=Z.getAutoSize();Z.position==="left"?(k=Math.max(k,te),ne&&(S=!1)):(M=Math.max(M,te),ne&&(I=!1))}}),a&&(k=Math.max(this._cacheYAxisWidth.left,k),M=Math.max(this._cacheYAxisWidth.right,M)),this._cacheYAxisWidth.left=k,this._cacheYAxisWidth.right=M;let C=_,T=0,z=0;S&&(C-=k,T=k),I&&(C-=M,z=M),this._chartStore.setTotalBarSpace(C);const j={width:_},B={width:C,left:T,right:z},$={width:k},F={width:M},V=y.separator.fill;let K={};V?K=j:K=B,this._drawPanes.forEach(Y=>{var Z;(Z=this._separatorPanes.get(Y))==null||Z.setBounding(K),Y.setBounding(j,B,$,F)})}i&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(hd.All)),this._layoutOptions={sort:!1,measureHeight:!1,measureWidth:!1,update:!1,buildYAxisTick:!1,cacheYAxisWidth:!1,forceBuildYAxisTick:!1};const g=(typeof performance<"u"?performance.now():Date.now())-c;if(g>50){const _=this._chartStore.getDataList().length,y=this._chartStore.getBarSpace().bar,k=this._chartStore.getVisibleRange();console.warn("⚠️ klinecharts: layout slow",{durationMs:Math.round(g),dataLen:_,barSpace:y,visibleFrom:k.from,visibleTo:k.to,update:i})}}updatePane(e,t){if(Uo(t)){const s=this.getDrawPaneById(t);s==null||s.update(e)}else this._drawPanes.forEach(s=>{var i;s.update(e),(i=this._separatorPanes.get(s))==null||i.update(e)})}getDom(e,t){var s;if(Uo(e)){const i=this.getDrawPaneById(e);if(Uo(i))switch(t??"root"){case"root":return i.getContainer();case"main":return i.getMainWidget().getContainer();case"yAxis":return((s=i.getYAxisWidget())==null?void 0:s.getContainer())??null}}else return this._chartContainer;return null}getSize(e,t){var s;if(Uo(e)){const i=this.getDrawPaneById(e);if(Uo(i))switch(t??"root"){case"root":return i.getBounding();case"main":return i.getMainWidget().getBounding();case"yAxis":return((s=i.getYAxisWidget())==null?void 0:s.getBounding())??null}}else return this._chartBounding;return null}_resetYAxisAutoCalcTickFlag(){this._drawPanes.forEach(e=>{e.getAxisComponent().setAutoCalcTickFlag(!0)})}setSymbol(e){e!==this.getSymbol()&&(this._resetYAxisAutoCalcTickFlag(),this._chartStore.setSymbol(e))}getSymbol(){return this._chartStore.getSymbol()}setPeriod(e){e!==this.getPeriod()&&(this._resetYAxisAutoCalcTickFlag(),this._chartStore.setPeriod(e))}getPeriod(){return this._chartStore.getPeriod()}setStyles(e){this._setOptions(()=>{this._chartStore.setStyles(e)})}getStyles(){return this._chartStore.getStyles()}setFormatter(e){this._setOptions(()=>{this._chartStore.setFormatter(e)})}getFormatter(){return this._chartStore.getFormatter()}setLocale(e){this._setOptions(()=>{this._chartStore.setLocale(e)})}getLocale(){return this._chartStore.getLocale()}setTimezone(e){this._setOptions(()=>{this._chartStore.setTimezone(e)})}getTimezone(){return this._chartStore.getTimezone()}setThousandsSeparator(e){this._setOptions(()=>{this._chartStore.setThousandsSeparator(e)})}getThousandsSeparator(){return this._chartStore.getThousandsSeparator()}setDecimalFold(e){this._setOptions(()=>{this._chartStore.setDecimalFold(e)})}getDecimalFold(){return this._chartStore.getDecimalFold()}_setOptions(e){e(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}setOffsetRightDistance(e){this._chartStore.setOffsetRightDistance(e,!0)}getOffsetRightDistance(){return this._chartStore.getOffsetRightDistance()}setMaxOffsetLeftDistance(e){e<0||this._chartStore.setMaxOffsetLeftDistance(e)}setMaxOffsetRightDistance(e){e<0||this._chartStore.setMaxOffsetRightDistance(e)}setLeftMinVisibleBarCount(e){e<0||this._chartStore.setLeftMinVisibleBarCount(Math.ceil(e))}setRightMinVisibleBarCount(e){e<0||this._chartStore.setRightMinVisibleBarCount(Math.ceil(e))}setBarSpace(e){this._chartStore.setBarSpace(e)}getBarSpace(){return this._chartStore.getBarSpace()}getVisibleRange(){return this._chartStore.getVisibleRange()}resetData(){this._chartStore.resetData()}applyNewData(e,t){this._chartStore.applyNewData(e,t)}addData(e,t,s){this._chartStore.addData(e,t,s)}getDataList(){return this._chartStore.getDataList()}setDataLoader(e){this._resetYAxisAutoCalcTickFlag(),this._chartStore.setDataLoader(e)}createIndicator(e,t,s){const i=pd(e)?{name:e}:e;if(tb(i.name)===null)return null;const r=s??{};if(pd(r.id)||(r.id=b0(pc.INDICATOR)),pd(i.id)||(i.id=b0(i.name)),this._chartStore.addIndicator(i,r.id,t??!1)){let l=!1;return Uo(this.getDrawPaneById(r.id))||(this._createPane(Mb,r.id,r),r.height??(r.height=rb),l=!0),this.setPaneOptions(r),this.layout({sort:l,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0}),i.id}return null}overrideIndicator(e){return this._chartStore.overrideIndicator(e)}getIndicators(e){return this._chartStore.getIndicatorsByFilter(e??{})}removeIndicator(e){let t=this._chartStore.removeIndicator(e??{});if(!t&&e){const{name:s,id:i}=e,r=typeof s=="string"?s.split("(")[0].trim():void 0;if(i||r){const a={};i&&(a.id=i),r&&(a.name=r),t=this._chartStore.removeIndicator(a),!t&&r&&(t=this._chartStore.removeIndicator({name:r}))}}if(t){let s=!1;const i=[];this._drawPanes.forEach(r=>{const a=r.getId();a!==pc.CANDLE&&a!==pc.X_AXIS&&i.push(a)}),i.forEach(r=>{if(!this._chartStore.hasIndicators(r)){const a=this._drawPanes.findIndex(c=>c.getId()===r),l=this._drawPanes[a];Uo(l)&&(s=!0,this._recalculatePaneHeight(l,0,l.getBounding().height),this._drawPanes.splice(a,1),l.destroy())}}),this._drawPanes.length===2&&(this._candlePane.setVisible(!0),this._candlePane.setBounding({height:this._chartBounding.height-this._xAxisPane.getBounding().height})),this.layout({sort:s,measureHeight:s,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}return t}createOverlay(e){const t=[],s=[],i=a=>{!Uo(a.paneId)||this.getDrawPaneById(a.paneId)===null?(a.paneId=pc.CANDLE,s.push(!1)):s.push(!0),t.push(a)};pd(e)?i({name:e}):Ov(e)?e.forEach(a=>{let l=null;pd(a)?l={name:a}:l=a,i(l)}):i(e);const r=this._chartStore.addOverlays(t,s);return Ov(e)?r:r[0]}getOverlays(e){return this._chartStore.getOverlaysByFilter(e??{})}overrideOverlay(e){return this._chartStore.overrideOverlay(e)}removeOverlay(e){return this._chartStore.removeOverlay(e??{})}setPaneOptions(e){let t=!1,s=!1;const i=Uo(e.id);for(const r of this._drawPanes){const a=r.getId();if(i&&e.id===a||!i){if(a!==pc.X_AXIS){if(ja(e.height)&&e.height>0){const c=Math.max(e.minHeight??r.getOptions().minHeight,0),d=Math.max(c,e.height);s=!0,t=!0,r.setOriginalBounding({height:d}),this._recalculatePaneHeight(r,d,-d)}if(Uo(e.state)&&r.getOptions().state!==e.state){t=!0,s=!0;const c=e.state;switch(c){case"maximize":{const d=this._drawPanes.find(v=>{const g=v.getId();return v.getOptions().state==="maximize"&&g!==pc.X_AXIS});if(!Uo(d)){r.getOptions().state==="normal"&&r.setOriginalBounding({height:r.getBounding().height}),r.setOptions({state:c});const v=this._chartBounding.height;r.setBounding({height:v-this._xAxisPane.getBounding().height}),this._drawPanes.forEach(g=>{var _;g.getId()!==pc.X_AXIS&&g.getId()!==a&&(g.setBounding({height:g.getOriginalBounding().height}),g.setVisible(!1),(_=this._separatorPanes.get(g))==null||_.setVisible(!1))})}break}case"minimize":{const d=r.getBounding().height,v=r.getOptions().state;let g=d-ah;v==="maximize"&&(g=r.getOriginalBounding().height-ah),this._recalculatePaneHeight(r,ah,g)&&(v==="normal"&&r.setOriginalBounding({height:d}),r.setOptions({state:c})),this._drawPanes.forEach(_=>{var y;_.getId()!==pc.X_AXIS&&(_.setVisible(!0),(y=this._separatorPanes.get(_))==null||y.setVisible(!0))});break}default:{const d=r.getOriginalBounding().height;this._recalculatePaneHeight(r,d,r.getBounding().height-d)&&r.setOptions({state:c}),this._drawPanes.forEach(v=>{var g;v.getId()!==pc.X_AXIS&&(v.setVisible(!0),(g=this._separatorPanes.get(v))==null||g.setVisible(!0))});break}}}}Uo(e.axis)&&(s=!0);const l={...e};if(delete l.state,r.setOptions(l),a===e.id)break}}s&&this.layout({measureHeight:t,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}getPaneOptions(e){if(Uo(e)){const t=this.getDrawPaneById(e);return(t==null?void 0:t.getOptions())??null}return this._drawPanes.map(t=>t.getOptions())}setZoomEnabled(e){this._chartStore.setZoomEnabled(e)}isZoomEnabled(){return this._chartStore.isZoomEnabled()}setScrollEnabled(e){this._chartStore.setScrollEnabled(e)}isScrollEnabled(){return this._chartStore.isScrollEnabled()}scrollByDistance(e,t){const s=ja(t)&&t>0?t:0;if(this._chartStore.startScroll(),s>0){const i=new s1({duration:s});i.doFrame(r=>{const a=e*(r/s);this._chartStore.scroll(a)}),i.start()}else this._chartStore.scroll(e)}scrollToRealTime(e){const{bar:t}=this._chartStore.getBarSpace(),i=(this._chartStore.getLastBarRightSideDiffBarCount()-this._chartStore.getInitialOffsetRightDistance()/t)*t;this.scrollByDistance(i,e)}scrollToDataIndex(e,t){const s=(this._chartStore.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-e))*this._chartStore.getBarSpace().bar;this.scrollByDistance(s,t)}scrollToTimestamp(e,t){const s=n1(this.getDataList(),"timestamp",e);this.scrollToDataIndex(s,t)}zoomAtCoordinate(e,t,s){const i=ja(s)&&s>0?s:0,{bar:r}=this._chartStore.getBarSpace(),l=r*e-r;if(i>0){let c=0;const d=new s1({duration:i});d.doFrame(v=>{const g=l*(v/i),_=(g-c)/this._chartStore.getBarSpace().bar*i1;this._chartStore.zoom(_,t),c=g}),d.start()}else this._chartStore.zoom(l/r*i1,t)}zoomAtDataIndex(e,t,s){const i=this._chartStore.dataIndexToCoordinate(t);this.zoomAtCoordinate(e,{x:i,y:0},s)}zoomAtTimestamp(e,t,s){const i=n1(this.getDataList(),"timestamp",t);this.zoomAtDataIndex(e,i,s)}convertToPixel(e,t){const{paneId:s=pc.CANDLE,absolute:i=!1}=t??{};let r=[];if(s!==pc.X_AXIS){const a=this.getDrawPaneById(s);if(a!==null){const l=a.getBounding(),c=[].concat(e),d=this._xAxisPane.getAxisComponent(),v=a.getAxisComponent();r=c.map(g=>{const _={};let y=g.dataIndex;if(ja(g.timestamp)&&(y=this._chartStore.timestampToDataIndex(g.timestamp)),ja(y)&&(_.x=d.convertToPixel(y)),ja(g.value)){const k=v.convertToPixel(g.value);_.y=i?l.top+k:k}return _})}}return Ov(e)?r:r[0]??{}}convertFromPixel(e,t){const{paneId:s=pc.CANDLE,absolute:i=!1}=t??{};let r=[];if(s!==pc.X_AXIS){const a=this.getDrawPaneById(s);if(a!==null){const l=a.getBounding(),c=[].concat(e),d=this._xAxisPane.getAxisComponent(),v=a.getAxisComponent();r=c.map(g=>{const _={};if(ja(g.x)){const y=d.convertFromPixel(g.x);_.dataIndex=y,_.timestamp=this._chartStore.dataIndexToTimestamp(y)??void 0}if(ja(g.y)){const y=i?g.y-l.top:g.y;_.value=v.convertFromPixel(y)}return _})}}return Ov(e)?r:r[0]??{}}executeAction(e,t){switch(e){case"onCrosshairChange":{const s={...t};s.paneId??(s.paneId=pc.CANDLE),this._chartStore.setCrosshair(s,{notExecuteAction:!0});break}}}subscribeAction(e,t){this._chartStore.subscribeAction(e,t)}unsubscribeAction(e,t){this._chartStore.unsubscribeAction(e,t)}getConvertPictureUrl(e,t,s){const{width:i,height:r}=this._chartBounding,a=Df("canvas",{width:`${i}px`,height:`${r}px`,boxSizing:"border-box"}),l=a.getContext("2d"),c=Xf(a);a.width=i*c,a.height=r*c,l.scale(c,c),l.fillStyle=s??"#FFFFFF",l.fillRect(0,0,i,r);const d=e??!1;return this._drawPanes.forEach(v=>{const g=this._separatorPanes.get(v);if(Uo(g)){const y=g.getBounding();l.drawImage(g.getImage(d),y.left,y.top,y.width,y.height)}const _=v.getBounding();l.drawImage(v.getImage(d),0,_.top,i,_.height)}),a.toDataURL(`image/${t??"jpeg"}`)}resize(){this._cacheChartBounding(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}destroy(){this._chartEvent.destroy(),this._drawPanes.forEach(e=>{e.destroy()}),this._drawPanes=[],this._separatorPanes.clear(),this._chartStore.destroy(),this._container.removeChild(this._chartContainer)}}const by=new Map;let nk=1;function ik(o,e){let t=null;if(pd(o)?t=document.getElementById(o):t=o,t===null)return null;let s=by.get(t.id);if(Uo(s))return s;const i=`k_line_chart_${nk++}`;return s=new sk(t,e),s.id=i,t.setAttribute("k-line-chart-id",i),by.set(i,s),s}const Ef={clone:Nm,merge:Ru,isString:pd,isNumber:ja,isValid:Uo,isObject:rv,isArray:Ov,isFunction:Vp,isBoolean:$0,formatValue:Hu,formatPrecision:vp,formatBigNumber:X2,formatDate:Z2,formatThousands:J2,formatFoldDecimal:Q2,calcTextWidth:mp,getLinearSlopeIntercept:Fh,getLinearYFromSlopeIntercept:S1,getLinearYFromCoordinates:D0,checkCoordinateOnArc:fb,checkCoordinateOnCircle:cb,checkCoordinateOnLine:ob,checkCoordinateOnPolygon:db,checkCoordinateOnRect:I1,checkCoordinateOnText:vb},Oe={Solid:"solid",Dashed:"dashed"},Mm={Fill:"fill",Stroke:"stroke",StrokeFill:"stroke_fill"},Nv={OnZoom:"onZoom",OnScroll:"onScroll",OnVisibleRangeChange:"onVisibleRangeChange",OnCandleTooltipFeatureClick:"onCandleTooltipFeatureClick",OnIndicatorTooltipFeatureClick:"onIndicatorTooltipFeatureClick",OnCrosshairFeatureClick:"onCrosshairFeatureClick",OnCrosshairChange:"onCrosshairChange",OnCandleBarClick:"onCandleBarClick",OnPaneDrag:"onPaneDrag"},rk={Normal:"normal",WeakMagnet:"weak_magnet",StrongMagnet:"strong_magnet"},ak={Left:"left",Middle:"middle",Right:"right"},xy={Always:"always",FollowCross:"follow_cross",None:"none"},lk={CandleSolid:"candle_solid",CandleStroke:"candle_stroke",CandleUpStroke:"candle_up_stroke",CandleDownStroke:"candle_down_stroke",Ohlc:"ohlc",Area:"area"},ck={Tooltip:"tooltip",Crosshair:"crosshair",XAxis:"xAxis"};var M_={local:{},session:{}};function dk(o){return o==="local"?localStorage:sessionStorage}function A1(o,e,t){var s,i,r,a,l,c,d,v;const g=(s=void 0)!=null?s:JSON,_=(i=void 0)!=null?i:"local",y=(r=void 0)!=null?r:!0,k=(l=(a=void 0)!=null?a:void 0)!=null?l:B=>console.error(`Error when writing value from persisted store "${o}" to ${_}`,B),S=(c=void 0)!=null?c:(B,$)=>console.error(`Error when parsing ${B?'"'+B+'"':"value"} from persisted store "${o}"`,$),M=(d=void 0)!=null?d:B=>B,I=(v=void 0)!=null?v:B=>B,C=typeof window<"u"&&typeof document<"u",T=C?dk(_):null;function z(B,$){const F=I($);try{T==null||T.setItem(B,g.stringify(F))}catch(V){k(V)}}function j(){function B(K){try{return g.parse(K)}catch(Y){S(K,Y)}}const $=T==null?void 0:T.getItem(o);if($==null)return e;const F=B($);return F==null?e:M(F)}if(!M_[_][o]){const B=j(),$=op(B,K=>{if(C&&_=="local"&&y){const Y=Z=>{if(Z.key===o&&Z.newValue){let ne;try{ne=g.parse(Z.newValue)}catch(oe){S(Z.newValue,oe);return}const te=M(ne);K(te)}};return window.addEventListener("storage",Y),()=>window.removeEventListener("storage",Y)}}),{subscribe:F,set:V}=$;M_[_][o]={set(K){V(K),z(o,K)},update(K){return $.update(Y=>{const Z=K(Y);return z(o,Z),Z})},reset(){this.set(e)},subscribe:F}}return M_[_][o]}var Tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O0(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Tb={exports:{}};(function(o,e){(function(t,s){o.exports=s()})(Tf,function(){var t=1e3,s=6e4,i=36e5,r="millisecond",a="second",l="minute",c="hour",d="day",v="week",g="month",_="quarter",y="year",k="date",S="Invalid Date",M=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,I=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,C={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(te){var oe=["th","st","nd","rd"],U=te%100;return"["+te+(oe[(U-20)%10]||oe[U]||oe[0])+"]"}},T=function(te,oe,U){var J=String(te);return!J||J.length>=oe?te:""+Array(oe+1-J.length).join(U)+te},z={s:T,z:function(te){var oe=-te.utcOffset(),U=Math.abs(oe),J=Math.floor(U/60),se=U%60;return(oe<=0?"+":"-")+T(J,2,"0")+":"+T(se,2,"0")},m:function te(oe,U){if(oe.date()<U.date())return-te(U,oe);var J=12*(U.year()-oe.year())+(U.month()-oe.month()),se=oe.clone().add(J,g),W=U-se<0,le=oe.clone().add(J+(W?-1:1),g);return+(-(J+(U-se)/(W?se-le:le-se))||0)},a:function(te){return te<0?Math.ceil(te)||0:Math.floor(te)},p:function(te){return{M:g,y,w:v,d,D:k,h:c,m:l,s:a,ms:r,Q:_}[te]||String(te||"").toLowerCase().replace(/s$/,"")},u:function(te){return te===void 0}},j="en",B={};B[j]=C;var $="$isDayjsObject",F=function(te){return te instanceof Z||!(!te||!te[$])},V=function te(oe,U,J){var se;if(!oe)return j;if(typeof oe=="string"){var W=oe.toLowerCase();B[W]&&(se=W),U&&(B[W]=U,se=W);var le=oe.split("-");if(!se&&le.length>1)return te(le[0])}else{var ye=oe.name;B[ye]=oe,se=ye}return!J&&se&&(j=se),se||!J&&j},K=function(te,oe){if(F(te))return te.clone();var U=typeof oe=="object"?oe:{};return U.date=te,U.args=arguments,new Z(U)},Y=z;Y.l=V,Y.i=F,Y.w=function(te,oe){return K(te,{locale:oe.$L,utc:oe.$u,x:oe.$x,$offset:oe.$offset})};var Z=function(){function te(U){this.$L=V(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[$]=!0}var oe=te.prototype;return oe.parse=function(U){this.$d=function(J){var se=J.date,W=J.utc;if(se===null)return new Date(NaN);if(Y.u(se))return new Date;if(se instanceof Date)return new Date(se);if(typeof se=="string"&&!/Z$/i.test(se)){var le=se.match(M);if(le){var ye=le[2]-1||0,Ce=(le[7]||"0").substring(0,3);return W?new Date(Date.UTC(le[1],ye,le[3]||1,le[4]||0,le[5]||0,le[6]||0,Ce)):new Date(le[1],ye,le[3]||1,le[4]||0,le[5]||0,le[6]||0,Ce)}}return new Date(se)}(U),this.init()},oe.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},oe.$utils=function(){return Y},oe.isValid=function(){return this.$d.toString()!==S},oe.isSame=function(U,J){var se=K(U);return this.startOf(J)<=se&&se<=this.endOf(J)},oe.isAfter=function(U,J){return K(U)<this.startOf(J)},oe.isBefore=function(U,J){return this.endOf(J)<K(U)},oe.$g=function(U,J,se){return Y.u(U)?this[J]:this.set(se,U)},oe.unix=function(){return Math.floor(this.valueOf()/1e3)},oe.valueOf=function(){return this.$d.getTime()},oe.startOf=function(U,J){var se=this,W=!!Y.u(J)||J,le=Y.p(U),ye=function(nt,tt){var Ze=Y.w(se.$u?Date.UTC(se.$y,tt,nt):new Date(se.$y,tt,nt),se);return W?Ze:Ze.endOf(d)},Ce=function(nt,tt){return Y.w(se.toDate()[nt].apply(se.toDate("s"),(W?[0,0,0,0]:[23,59,59,999]).slice(tt)),se)},Re=this.$W,Ke=this.$M,st=this.$D,vt="set"+(this.$u?"UTC":"");switch(le){case y:return W?ye(1,0):ye(31,11);case g:return W?ye(1,Ke):ye(0,Ke+1);case v:var Je=this.$locale().weekStart||0,ot=(Re<Je?Re+7:Re)-Je;return ye(W?st-ot:st+(6-ot),Ke);case d:case k:return Ce(vt+"Hours",0);case c:return Ce(vt+"Minutes",1);case l:return Ce(vt+"Seconds",2);case a:return Ce(vt+"Milliseconds",3);default:return this.clone()}},oe.endOf=function(U){return this.startOf(U,!1)},oe.$set=function(U,J){var se,W=Y.p(U),le="set"+(this.$u?"UTC":""),ye=(se={},se[d]=le+"Date",se[k]=le+"Date",se[g]=le+"Month",se[y]=le+"FullYear",se[c]=le+"Hours",se[l]=le+"Minutes",se[a]=le+"Seconds",se[r]=le+"Milliseconds",se)[W],Ce=W===d?this.$D+(J-this.$W):J;if(W===g||W===y){var Re=this.clone().set(k,1);Re.$d[ye](Ce),Re.init(),this.$d=Re.set(k,Math.min(this.$D,Re.daysInMonth())).$d}else ye&&this.$d[ye](Ce);return this.init(),this},oe.set=function(U,J){return this.clone().$set(U,J)},oe.get=function(U){return this[Y.p(U)]()},oe.add=function(U,J){var se,W=this;U=Number(U);var le=Y.p(J),ye=function(Ke){var st=K(W);return Y.w(st.date(st.date()+Math.round(Ke*U)),W)};if(le===g)return this.set(g,this.$M+U);if(le===y)return this.set(y,this.$y+U);if(le===d)return ye(1);if(le===v)return ye(7);var Ce=(se={},se[l]=s,se[c]=i,se[a]=t,se)[le]||1,Re=this.$d.getTime()+U*Ce;return Y.w(Re,this)},oe.subtract=function(U,J){return this.add(-1*U,J)},oe.format=function(U){var J=this,se=this.$locale();if(!this.isValid())return se.invalidDate||S;var W=U||"YYYY-MM-DDTHH:mm:ssZ",le=Y.z(this),ye=this.$H,Ce=this.$m,Re=this.$M,Ke=se.weekdays,st=se.months,vt=se.meridiem,Je=function(tt,Ze,ct,Ge){return tt&&(tt[Ze]||tt(J,W))||ct[Ze].slice(0,Ge)},ot=function(tt){return Y.s(ye%12||12,tt,"0")},nt=vt||function(tt,Ze,ct){var Ge=tt<12?"AM":"PM";return ct?Ge.toLowerCase():Ge};return W.replace(I,function(tt,Ze){return Ze||function(ct){switch(ct){case"YY":return String(J.$y).slice(-2);case"YYYY":return Y.s(J.$y,4,"0");case"M":return Re+1;case"MM":return Y.s(Re+1,2,"0");case"MMM":return Je(se.monthsShort,Re,st,3);case"MMMM":return Je(st,Re);case"D":return J.$D;case"DD":return Y.s(J.$D,2,"0");case"d":return String(J.$W);case"dd":return Je(se.weekdaysMin,J.$W,Ke,2);case"ddd":return Je(se.weekdaysShort,J.$W,Ke,3);case"dddd":return Ke[J.$W];case"H":return String(ye);case"HH":return Y.s(ye,2,"0");case"h":return ot(1);case"hh":return ot(2);case"a":return nt(ye,Ce,!0);case"A":return nt(ye,Ce,!1);case"m":return String(Ce);case"mm":return Y.s(Ce,2,"0");case"s":return String(J.$s);case"ss":return Y.s(J.$s,2,"0");case"SSS":return Y.s(J.$ms,3,"0");case"Z":return le}return null}(tt)||le.replace(":","")})},oe.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},oe.diff=function(U,J,se){var W,le=this,ye=Y.p(J),Ce=K(U),Re=(Ce.utcOffset()-this.utcOffset())*s,Ke=this-Ce,st=function(){return Y.m(le,Ce)};switch(ye){case y:W=st()/12;break;case g:W=st();break;case _:W=st()/3;break;case v:W=(Ke-Re)/6048e5;break;case d:W=(Ke-Re)/864e5;break;case c:W=Ke/i;break;case l:W=Ke/s;break;case a:W=Ke/t;break;default:W=Ke}return se?W:Y.a(W)},oe.daysInMonth=function(){return this.endOf(g).$D},oe.$locale=function(){return B[this.$L]},oe.locale=function(U,J){if(!U)return this.$L;var se=this.clone(),W=V(U,J,!0);return W&&(se.$L=W),se},oe.clone=function(){return Y.w(this.$d,this)},oe.toDate=function(){return new Date(this.valueOf())},oe.toJSON=function(){return this.isValid()?this.toISOString():null},oe.toISOString=function(){return this.$d.toISOString()},oe.toString=function(){return this.$d.toUTCString()},te}(),ne=Z.prototype;return K.prototype=ne,[["$ms",r],["$s",a],["$m",l],["$H",c],["$W",d],["$M",g],["$y",y],["$D",k]].forEach(function(te){ne[te[1]]=function(oe){return this.$g(oe,te[0],te[1])}}),K.extend=function(te,oe){return te.$i||(te(oe,Z,K),te.$i=!0),K},K.locale=V,K.isDayjs=F,K.unix=function(te){return K(1e3*te)},K.en=B[j],K.Ls=B,K.p={},K})})(Tb);var uk=Tb.exports;const zp=O0(uk);var Ab={exports:{}};(function(o,e){(function(t,s){o.exports=s()})(Tf,function(){var t={year:0,month:1,day:2,hour:3,minute:4,second:5},s={};return function(i,r,a){var l,c=function(_,y,k){k===void 0&&(k={});var S=new Date(_),M=function(I,C){C===void 0&&(C={});var T=C.timeZoneName||"short",z=I+"|"+T,j=s[z];return j||(j=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:I,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:T}),s[z]=j),j}(y,k);return M.formatToParts(S)},d=function(_,y){for(var k=c(_,y),S=[],M=0;M<k.length;M+=1){var I=k[M],C=I.type,T=I.value,z=t[C];z>=0&&(S[z]=parseInt(T,10))}var j=S[3],B=j===24?0:j,$=S[0]+"-"+S[1]+"-"+S[2]+" "+B+":"+S[4]+":"+S[5]+":000",F=+_;return(a.utc($).valueOf()-(F-=F%1e3))/6e4},v=r.prototype;v.tz=function(_,y){_===void 0&&(_=l);var k,S=this.utcOffset(),M=this.toDate(),I=M.toLocaleString("en-US",{timeZone:_}),C=Math.round((M-new Date(I))/1e3/60),T=15*-Math.round(M.getTimezoneOffset()/15)-C;if(!Number(T))k=this.utcOffset(0,y);else if(k=a(I,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(T,!0),y){var z=k.utcOffset();k=k.add(S-z,"minute")}return k.$x.$timezone=_,k},v.offsetName=function(_){var y=this.$x.$timezone||a.tz.guess(),k=c(this.valueOf(),y,{timeZoneName:_}).find(function(S){return S.type.toLowerCase()==="timezonename"});return k&&k.value};var g=v.startOf;v.startOf=function(_,y){if(!this.$x||!this.$x.$timezone)return g.call(this,_,y);var k=a(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return g.call(k,_,y).tz(this.$x.$timezone,!0)},a.tz=function(_,y,k){var S=k&&y,M=k||y||l,I=d(+a(),M);if(typeof _!="string")return a(_).tz(M);var C=function(B,$,F){var V=B-60*$*1e3,K=d(V,F);if($===K)return[V,$];var Y=d(V-=60*(K-$)*1e3,F);return K===Y?[V,K]:[B-60*Math.min(K,Y)*1e3,Math.max(K,Y)]}(a.utc(_,S).valueOf(),I,M),T=C[0],z=C[1],j=a(T).utcOffset(z);return j.$x.$timezone=M,j},a.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},a.tz.setDefault=function(_){l=_}}})})(Ab);var pk=Ab.exports;const vk=O0(pk);var Lb={exports:{}};(function(o,e){(function(t,s){o.exports=s()})(Tf,function(){var t="minute",s=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(r,a,l){var c=a.prototype;l.utc=function(S){var M={date:S,utc:!0,args:arguments};return new a(M)},c.utc=function(S){var M=l(this.toDate(),{locale:this.$L,utc:!0});return S?M.add(this.utcOffset(),t):M},c.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var d=c.parse;c.parse=function(S){S.utc&&(this.$u=!0),this.$utils().u(S.$offset)||(this.$offset=S.$offset),d.call(this,S)};var v=c.init;c.init=function(){if(this.$u){var S=this.$d;this.$y=S.getUTCFullYear(),this.$M=S.getUTCMonth(),this.$D=S.getUTCDate(),this.$W=S.getUTCDay(),this.$H=S.getUTCHours(),this.$m=S.getUTCMinutes(),this.$s=S.getUTCSeconds(),this.$ms=S.getUTCMilliseconds()}else v.call(this)};var g=c.utcOffset;c.utcOffset=function(S,M){var I=this.$utils().u;if(I(S))return this.$u?0:I(this.$offset)?g.call(this):this.$offset;if(typeof S=="string"&&(S=function(j){j===void 0&&(j="");var B=j.match(s);if(!B)return null;var $=(""+B[0]).match(i)||["-",0,0],F=$[0],V=60*+$[1]+ +$[2];return V===0?0:F==="+"?V:-V}(S),S===null))return this;var C=Math.abs(S)<=16?60*S:S,T=this;if(M)return T.$offset=C,T.$u=S===0,T;if(S!==0){var z=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(T=this.local().add(C+z,t)).$offset=C,T.$x.$localOffset=z}else T=this.utc();return T};var _=c.format;c.format=function(S){var M=S||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return _.call(this,M)},c.valueOf=function(){var S=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*S},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var y=c.toDate;c.toDate=function(S){return S==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():y.call(this)};var k=c.diff;c.diff=function(S,M,I){if(S&&this.$u===S.$u)return k.call(this,S,M,I);var C=this.local(),T=l(S).local();return k.call(C,T,M,I)}}})})(Lb);var fk=Lb.exports;const mk=O0(fk),h0=ck,gv=Ef.formatDate;let L1=!0,z1="UTC";zp.extend(vk);zp.extend(mk);zp.tz.setDefault("UTC");const a1=60,l1=a1*60,E0=l1*24,wy=E0*7,ky=E0*30,Sy=E0*365,gk={"Africa/Abidjan":"utc","Pacific/Honolulu":"honolulu","America/Juneau":"juneau","America/Los_Angeles":"los_angeles","America/Chicago":"chicago","America/Toronto":"toronto","America/Sao_Paulo":"sao_paulo","Europe/London":"london","Europe/Berlin":"berlin","Asia/Bahrain":"bahrain","Asia/Dubai":"dubai","Asia/Ashkhabad":"ashkhabad","Asia/Almaty":"almaty","Asia/Bangkok":"bangkok","Asia/Shanghai":"shanghai","Asia/Tokyo":"tokyo","Australia/Sydney":"sydney","Pacific/Guadalcanal":"guadalcanal","Pacific/Auckland":"auckland"};function hk(){return zp().valueOf()}function Cy(o){if(!o)return 0;o=o.trim();const e=/^\d+$/.test(o);let t=null;if(e){const s=o.length;if(s==4){const i=new Date().getFullYear();t=zp(`${i}${o}`,"YYYYMMDD")}else if(s==6){const i=parseInt(o.substring(0,2)),r=i>50?1900+i:2e3+i,a=o.substring(2);t=zp(`${r}${a}`,"YYYYMMDD")}else if(s==8)t=zp(o,"YYYYMMDD");else if(s==10)t=zp.unix(parseInt(o));else if(s==12)t=zp(o,"YYYYMMDDHHmm");else if(s==13)t=zp(parseInt(o));else if(s==14)t=zp(o,"YYYYMMDDHHmmss");else return console.error("invalid date format:",o),0}else t=zp(o,["YYYY/MM/DD","YYYY/MM/DD HH:mm","YYYY/MM/DD HH:mm:ss","YYYY-MM-DD","YYYY-MM-DD HH:mm","YYYY-MM-DD HH:mm:ss"],!0);return!t||!t.isValid()?(console.error("Invalid date format or value:",o),0):(L1||console.error("local timezone not applied"),t=t.tz(z1,!0),t.valueOf())}function Py(o,e="YYYY-MM-DD HH:mm:ss",t=void 0){if(!o)return"--";let s=null;return o>1e12?s=zp(o):s=zp.unix(o),s=s.tz(t||z1,!0),L1||console.error("local timezone not applied"),s.format(e)}function _k(o,e,t){let s=e,i=s;switch(o.timespan){case"minute":{s=s-s%(60*1e3),i=s-t*o.multiplier*60*1e3;break}case"hour":{s=s-s%(60*60*1e3),i=s-t*o.multiplier*60*60*1e3;break}case"day":{s=s-s%(60*60*1e3),i=s-t*o.multiplier*24*60*60*1e3;break}case"week":{const a=new Date(s).getDay(),l=a===0?6:a-1;s=s-l*60*60*24;const c=new Date(s);s=new Date(`${c.getFullYear()}-${c.getMonth()+1}-${c.getDate()}`).getTime(),i=t*o.multiplier*7*24*60*60*1e3;break}case"month":{const r=new Date(s),a=r.getFullYear(),l=r.getMonth()+1;s=new Date(`${a}-${l}-01`).getTime(),i=t*o.multiplier*30*24*60*60*1e3;const c=new Date(i);i=new Date(`${c.getFullYear()}-${c.getMonth()+1}-01`).getTime();break}}return[i,s]}function Am(o){if(!o)return 0;const e=o.substring(o.length-1),t=parseInt(o.substring(0,o.length-1));let s=0;if(e=="y")s=31536e3;else if(e=="M")s=2592e3;else if(e=="w")s=604800;else if(e=="d")s=86400;else if(e=="h")s=3600;else if(e=="m")s=60;else if(e=="s")s=1;else throw Error(`unsupport timeframe: ${o}`);return s*t}function yk(o){return o>Sy?`${Math.floor(o/Sy)}y`:o>ky?`${Math.floor(o/ky)}M`:o>wy?`${Math.floor(o/wy)}w`:o>E0?`${Math.floor(o/E0)}d`:o>l1?`${Math.floor(o/l1)}h`:o>a1?`${Math.floor(o/a1)}m`:`${Math.floor(o)}s`}function bk(o){const e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};let t=null;try{t=new Intl.DateTimeFormat("en",e)}catch{console.error("","","Timezone is error!!!")}return t}const hv=bk();function Iy(o){function e(t,s,i){if(!t||isNaN(t)||t<=0)return new Date().toISOString().slice(0,19).replace("T"," ");switch(o){case"second":return i===h0.XAxis?gv(hv,t,"HH:mm:ss"):gv(hv,t,"YYYY-MM-DD HH:mm:ss");case"minute":return i===h0.XAxis?gv(hv,t,"HH:mm"):gv(hv,t,"YYYY-MM-DD HH:mm");case"hour":return i===h0.XAxis?gv(hv,t,"MM-DD HH:mm"):gv(hv,t,"YYYY-MM-DD HH:mm");case"day":case"week":return gv(hv,t,"YYYY-MM-DD");case"month":return i===h0.XAxis?gv(hv,t,"YYYY-MM"):gv(hv,t,"YYYY-MM-DD");case"year":return i===h0.XAxis?gv(hv,t,"YYYY"):gv(hv,t,"YYYY-MM-DD")}return gv(hv,t,"YYYY-MM-DD HH:mm")}return e}async function My(o){o&&(o=="Africa/Abidjan"||o.toLowerCase().indexOf("utc")>=0)&&(o="UTC"),zp.tz.setDefault(o),z1=o,L1=!0}function xk(){return Object.entries(gk).map(([o,e])=>({key:o,text:e}))}const wk=()=>"Time",kk=()=>"时间",Sk=(o={},e={})=>({en:wk,"zh-CN":kk})[e.languageTag??os()](),Ck=()=>"O",Pk=()=>"开",Ik=(o={},e={})=>({en:Ck,"zh-CN":Pk})[e.languageTag??os()](),Mk=()=>"H",Tk=()=>"高",Ak=(o={},e={})=>({en:Mk,"zh-CN":Tk})[e.languageTag??os()](),Lk=()=>"L",zk=()=>"低",Fk=(o={},e={})=>({en:Lk,"zh-CN":zk})[e.languageTag??os()](),$k=()=>"C",Dk=()=>"收",Ek=(o={},e={})=>({en:$k,"zh-CN":Dk})[e.languageTag??os()](),Nk=()=>"vol",jk=()=>"量",Rk=(o={},e={})=>({en:Nk,"zh-CN":jk})[e.languageTag??os()](),Bk=()=>"Chg",Ok=()=>"涨跌",Vk=(o={},e={})=>({en:Bk,"zh-CN":Ok})[e.languageTag??os()](),Wk=()=>"Timeframe",qk=()=>"周期",zb=(o={},e={})=>({en:Wk,"zh-CN":qk})[e.languageTag??os()](),Hk=()=>"No Data",Gk=()=>"数据为空",Uk=(o={},e={})=>({en:Hk,"zh-CN":Gk})[e.languageTag??os()](),Yk=()=>"Indicator",Kk=()=>"指标",F1=(o={},e={})=>({en:Yk,"zh-CN":Kk})[e.languageTag??os()](),Zk=()=>"Timezone",Xk=()=>"时区",Fb=(o={},e={})=>({en:Zk,"zh-CN":Xk})[e.languageTag??os()](),Jk=()=>"Setting",Qk=()=>"设置",e8=(o={},e={})=>({en:Jk,"zh-CN":Qk})[e.languageTag??os()](),t8=()=>"Confirm",o8=()=>"确认",s8=(o={},e={})=>({en:t8,"zh-CN":o8})[e.languageTag??os()](),n8=()=>"Cancel",i8=()=>"取消",r8=(o={},e={})=>({en:n8,"zh-CN":i8})[e.languageTag??os()](),a8=()=>"Search Symbol",l8=()=>"搜索品种",$b=(o={},e={})=>({en:a8,"zh-CN":l8})[e.languageTag??os()](),c8=()=>"This indicator has no parameters",d8=()=>"该指标没有参数",Db=(o={},e={})=>({en:c8,"zh-CN":d8})[e.languageTag??os()](),u8=()=>"Search",p8=()=>"搜索",Eb=(o={},e={})=>({en:u8,"zh-CN":p8})[e.languageTag??os()](),v8=()=>"Settings",f8=()=>"设置",Nb=(o={},e={})=>({en:v8,"zh-CN":f8})[e.languageTag??os()](),m8=()=>"Screenshot",g8=()=>"截图",h8=(o={},e={})=>({en:m8,"zh-CN":g8})[e.languageTag??os()](),_8=()=>"Grid Show",y8=()=>"显示网格",b8=(o={},e={})=>({en:_8,"zh-CN":y8})[e.languageTag??os()](),x8=()=>"Restore",w8=()=>"恢复",k8=(o={},e={})=>({en:x8,"zh-CN":w8})[e.languageTag??os()](),S8=()=>"Reset",C8=()=>"重置",P8=(o={},e={})=>({en:S8,"zh-CN":C8})[e.languageTag??os()](),I8=()=>"Candlestick Type",M8=()=>"蜡烛图类型",T8=(o={},e={})=>({en:I8,"zh-CN":M8})[e.languageTag??os()](),A8=()=>"Candlestick",L8=()=>"全实心",z8=(o={},e={})=>({en:A8,"zh-CN":L8})[e.languageTag??os()](),F8=()=>"Hollow",$8=()=>"全空心",D8=(o={},e={})=>({en:F8,"zh-CN":$8})[e.languageTag??os()](),E8=()=>"Up Hollow",N8=()=>"涨空心",j8=(o={},e={})=>({en:E8,"zh-CN":N8})[e.languageTag??os()](),R8=()=>"Down Hollow",B8=()=>"跌空心",O8=(o={},e={})=>({en:R8,"zh-CN":B8})[e.languageTag??os()](),V8=()=>"OHLC",W8=()=>"OHLC",q8=(o={},e={})=>({en:V8,"zh-CN":W8})[e.languageTag??os()](),H8=()=>"Area",G8=()=>"面积图",U8=(o={},e={})=>({en:H8,"zh-CN":G8})[e.languageTag??os()](),Y8=()=>"Price Axis Type",K8=()=>"价格轴类型",Z8=(o={},e={})=>({en:Y8,"zh-CN":K8})[e.languageTag??os()](),X8=()=>"Reverse Coordinate",J8=()=>"反转坐标",Q8=(o={},e={})=>({en:X8,"zh-CN":J8})[e.languageTag??os()](),e4=()=>"Show Last Price",t4=()=>"显示最新价",o4=(o={},e={})=>({en:e4,"zh-CN":t4})[e.languageTag??os()](),s4=()=>"Show High Price",n4=()=>"显示最高价",i4=(o={},e={})=>({en:s4,"zh-CN":n4})[e.languageTag??os()](),r4=()=>"Show Low Price",a4=()=>"显示最低价",l4=(o={},e={})=>({en:r4,"zh-CN":a4})[e.languageTag??os()](),c4=()=>"Show Indicator Last Value",d4=()=>"显示指标最新值",u4=(o={},e={})=>({en:c4,"zh-CN":d4})[e.languageTag??os()](),p4=()=>"Param ",v4=()=>"参数",jb=(o={},e={})=>({en:p4,"zh-CN":v4})[e.languageTag??os()](),f4=()=>"Period",m4=()=>"周期",c1=(o={},e={})=>({en:f4,"zh-CN":m4})[e.languageTag??os()](),g4=()=>"StdDev",h4=()=>"标准差",Rb=(o={},e={})=>({en:g4,"zh-CN":h4})[e.languageTag??os()](),_4=()=>"Normal",y4=()=>"正常",b4=(o={},e={})=>({en:_4,"zh-CN":y4})[e.languageTag??os()](),x4=()=>"Percentage",w4=()=>"百分比",k4=(o={},e={})=>({en:x4,"zh-CN":w4})[e.languageTag??os()](),S4=()=>"Log",C4=()=>"对数",P4=(o={},e={})=>({en:S4,"zh-CN":C4})[e.languageTag??os()](),I4=()=>" Bars",M4=()=>"根",Bb=(o={},e={})=>({en:I4,"zh-CN":M4})[e.languageTag??os()](),T4=()=>"days",A4=()=>"天",Ob=(o={},e={})=>({en:T4,"zh-CN":A4})[e.languageTag??os()](),L4=()=>"hours",z4=()=>"时",Vb=(o={},e={})=>({en:L4,"zh-CN":z4})[e.languageTag??os()](),F4=()=>"mins",$4=()=>"分",d1=(o={},e={})=>({en:F4,"zh-CN":$4})[e.languageTag??os()](),D4=()=>"Minutes",E4=()=>"分钟",Wb=(o={},e={})=>({en:D4,"zh-CN":E4})[e.languageTag??os()](),N4=()=>"Hours",j4=()=>"小时",qb=(o={},e={})=>({en:N4,"zh-CN":j4})[e.languageTag??os()](),R4=()=>"Days",B4=()=>"日",Hb=(o={},e={})=>({en:R4,"zh-CN":B4})[e.languageTag??os()](),O4=()=>"Weeks",V4=()=>"周",Gb=(o={},e={})=>({en:O4,"zh-CN":V4})[e.languageTag??os()](),W4=()=>"Months",q4=()=>"月",Ub=(o={},e={})=>({en:W4,"zh-CN":q4})[e.languageTag??os()](),H4=()=>"Horizontal Straight Line",G4=()=>"水平直线",U4=(o={},e={})=>({en:H4,"zh-CN":G4})[e.languageTag??os()](),Y4=()=>"Horizontal Ray Line",K4=()=>"水平射线",Z4=(o={},e={})=>({en:Y4,"zh-CN":K4})[e.languageTag??os()](),X4=()=>"Horizontal Segment",J4=()=>"水平线段",Q4=(o={},e={})=>({en:X4,"zh-CN":J4})[e.languageTag??os()](),e9=()=>"Vertical Straight Line",t9=()=>"垂直直线",o9=(o={},e={})=>({en:e9,"zh-CN":t9})[e.languageTag??os()](),s9=()=>"Vertical Ray Line",n9=()=>"垂直射线",i9=(o={},e={})=>({en:s9,"zh-CN":n9})[e.languageTag??os()](),r9=()=>"Vertical Segment",a9=()=>"垂直线段",l9=(o={},e={})=>({en:r9,"zh-CN":a9})[e.languageTag??os()](),c9=()=>"Straight Line",d9=()=>"直线",u9=(o={},e={})=>({en:c9,"zh-CN":d9})[e.languageTag??os()](),p9=()=>"Ray Line",v9=()=>"射线",f9=(o={},e={})=>({en:p9,"zh-CN":v9})[e.languageTag??os()](),m9=()=>"Segment",g9=()=>"线段",h9=(o={},e={})=>({en:m9,"zh-CN":g9})[e.languageTag??os()](),_9=()=>"Arrow",y9=()=>"箭头",b9=(o={},e={})=>({en:_9,"zh-CN":y9})[e.languageTag??os()](),x9=()=>"Price Line",w9=()=>"价格线",k9=(o={},e={})=>({en:x9,"zh-CN":w9})[e.languageTag??os()](),S9=()=>"Price Channel Line",C9=()=>"价格通道线",P9=(o={},e={})=>({en:S9,"zh-CN":C9})[e.languageTag??os()](),I9=()=>"Parallel Straight Line",M9=()=>"平行直线",T9=(o={},e={})=>({en:I9,"zh-CN":M9})[e.languageTag??os()](),A9=()=>"Fibonacci Retracement Segment",L9=()=>"斐波那契回调线段",z9=(o={},e={})=>({en:A9,"zh-CN":L9})[e.languageTag??os()](),F9=()=>"Fibonacci Circle",$9=()=>"斐波那契圆环",D9=(o={},e={})=>({en:F9,"zh-CN":$9})[e.languageTag??os()](),E9=()=>"Fibonacci Spiral",N9=()=>"斐波那契螺旋",j9=(o={},e={})=>({en:E9,"zh-CN":N9})[e.languageTag??os()](),R9=()=>"Fibonacci Speed Resistance Fan",B9=()=>"斐波那契速度阻力扇",O9=(o={},e={})=>({en:R9,"zh-CN":B9})[e.languageTag??os()](),V9=()=>"Fibonacci Extension",W9=()=>"斐波那契趋势扩展",q9=(o={},e={})=>({en:V9,"zh-CN":W9})[e.languageTag??os()](),H9=()=>"Gann Box",G9=()=>"江恩箱",U9=(o={},e={})=>({en:H9,"zh-CN":G9})[e.languageTag??os()](),Y9=()=>"Rectangle",K9=()=>"矩形",Z9=(o={},e={})=>({en:Y9,"zh-CN":K9})[e.languageTag??os()](),X9=()=>"Parallelogram",J9=()=>"平行四边形",Q9=(o={},e={})=>({en:X9,"zh-CN":J9})[e.languageTag??os()](),eS=()=>"Circle",tS=()=>"圆",oS=(o={},e={})=>({en:eS,"zh-CN":tS})[e.languageTag??os()](),sS=()=>"Triangle",nS=()=>"三角形",iS=(o={},e={})=>({en:sS,"zh-CN":nS})[e.languageTag??os()](),rS=()=>"Three Waves",aS=()=>"三浪",lS=(o={},e={})=>({en:rS,"zh-CN":aS})[e.languageTag??os()](),cS=()=>"Five Waves",dS=()=>"五浪",uS=(o={},e={})=>({en:cS,"zh-CN":dS})[e.languageTag??os()](),pS=()=>"Eight Waves",vS=()=>"八浪",fS=(o={},e={})=>({en:pS,"zh-CN":vS})[e.languageTag??os()](),mS=()=>"Any Waves",gS=()=>"任意浪",hS=(o={},e={})=>({en:mS,"zh-CN":gS})[e.languageTag??os()](),_S=()=>"ABCD Pattern",yS=()=>"ABCD形态",bS=(o={},e={})=>({en:_S,"zh-CN":yS})[e.languageTag??os()](),xS=()=>"XABCD Pattern",wS=()=>"XABCD形态",kS=(o={},e={})=>({en:xS,"zh-CN":wS})[e.languageTag??os()](),SS=()=>"Weak Magnet Mode",CS=()=>"弱磁模式",PS=(o={},e={})=>({en:SS,"zh-CN":CS})[e.languageTag??os()](),IS=()=>"Strong Magnet Mode",MS=()=>"强磁模式",TS=(o={},e={})=>({en:IS,"zh-CN":MS})[e.languageTag??os()](),AS=()=>"Moving Average",LS=()=>"移动平均",zS=(o={},e={})=>({en:AS,"zh-CN":LS})[e.languageTag??os()](),FS=()=>"Exponential Moving Average",$S=()=>"指数移动平均",DS=(o={},e={})=>({en:FS,"zh-CN":$S})[e.languageTag??os()](),ES=()=>"Simple Moving Average",NS=()=>"简单移动平均",jS=(o={},e={})=>({en:ES,"zh-CN":NS})[e.languageTag??os()](),RS=()=>"Bollinger Bands",BS=()=>"布林线",OS=(o={},e={})=>({en:RS,"zh-CN":BS})[e.languageTag??os()](),VS=()=>"Parabolic SAR",WS=()=>"抛物线转向",qS=(o={},e={})=>({en:VS,"zh-CN":WS})[e.languageTag??os()](),HS=()=>"Bull and Bear Index",GS=()=>"多空指标",US=(o={},e={})=>({en:HS,"zh-CN":GS})[e.languageTag??os()](),YS=()=>"Volume",KS=()=>"成交量",ZS=(o={},e={})=>({en:YS,"zh-CN":KS})[e.languageTag??os()](),XS=()=>"Moving Average Convergence Divergence",JS=()=>"平滑异同移动平均线",QS=(o={},e={})=>({en:XS,"zh-CN":JS})[e.languageTag??os()](),eC=()=>"KDJ Index",tC=()=>"随机指标",oC=(o={},e={})=>({en:eC,"zh-CN":tC})[e.languageTag??os()](),sC=()=>"Relative Strength Index",nC=()=>"相对强弱指数",iC=(o={},e={})=>({en:sC,"zh-CN":nC})[e.languageTag??os()](),rC=()=>"Bias",aC=()=>"乖离率",lC=(o={},e={})=>({en:rC,"zh-CN":aC})[e.languageTag??os()](),cC=()=>"Bull and Bear Ratio",dC=()=>"人气意愿指标",uC=(o={},e={})=>({en:cC,"zh-CN":dC})[e.languageTag??os()](),pC=()=>"Commodity Channel Index",vC=()=>"顺势指标",fC=(o={},e={})=>({en:pC,"zh-CN":vC})[e.languageTag??os()](),mC=()=>"Energy",gC=()=>"能量指标",hC=(o={},e={})=>({en:mC,"zh-CN":gC})[e.languageTag??os()](),_C=()=>"Psychological Line",yC=()=>"心理线",bC=(o={},e={})=>({en:_C,"zh-CN":yC})[e.languageTag??os()](),xC=()=>"Parallel Line Difference",wC=()=>"平行线差指标",kC=(o={},e={})=>({en:xC,"zh-CN":wC})[e.languageTag??os()](),SC=()=>"Triple Exponential Moving Average",CC=()=>"三重指数平滑移动平均线",PC=(o={},e={})=>({en:SC,"zh-CN":CC})[e.languageTag??os()](),IC=()=>"On Balance Volume",MC=()=>"能量潮",TC=(o={},e={})=>({en:IC,"zh-CN":MC})[e.languageTag??os()](),AC=()=>"Volume Variation Rate",LC=()=>"成交量变异率",zC=(o={},e={})=>({en:AC,"zh-CN":LC})[e.languageTag??os()](),FC=()=>"Williams Percentage Range",$C=()=>"威廉指标",DC=(o={},e={})=>({en:FC,"zh-CN":$C})[e.languageTag??os()](),EC=()=>"Momentum",NC=()=>"动量指标",jC=(o={},e={})=>({en:EC,"zh-CN":NC})[e.languageTag??os()](),RC=()=>"Ease of Movement",BC=()=>"简易波动指标",OC=(o={},e={})=>({en:RC,"zh-CN":BC})[e.languageTag??os()](),VC=()=>"Rate of Change",WC=()=>"变动率指标",qC=(o={},e={})=>({en:VC,"zh-CN":WC})[e.languageTag??os()](),HC=()=>"Price Volume Trend",GC=()=>"量价趋势",UC=(o={},e={})=>({en:HC,"zh-CN":GC})[e.languageTag??os()](),YC=()=>"Awesome Oscillator",KC=()=>"震荡指标",ZC=(o={},e={})=>({en:YC,"zh-CN":KC})[e.languageTag??os()](),XC=()=>"Directional Movement Index",JC=()=>"趋向指标",QC=(o={},e={})=>({en:XC,"zh-CN":JC})[e.languageTag??os()](),e7=()=>"Coordinated Universal Time (UTC)",t7=()=>"世界统一时间",o7=(o={},e={})=>({en:e7,"zh-CN":t7})[e.languageTag??os()](),s7=()=>"(UTC-10) Honolulu",n7=()=>"(UTC-10) 檀香山",i7=(o={},e={})=>({en:s7,"zh-CN":n7})[e.languageTag??os()](),r7=()=>"(UTC-8) Juneau",a7=()=>"(UTC-8) 朱诺",l7=(o={},e={})=>({en:r7,"zh-CN":a7})[e.languageTag??os()](),c7=()=>"(UTC-7) Los Angeles",d7=()=>"(UTC-7) 洛杉矶",u7=(o={},e={})=>({en:c7,"zh-CN":d7})[e.languageTag??os()](),p7=()=>"(UTC-5) Chicago",v7=()=>"(UTC-5) 芝加哥",f7=(o={},e={})=>({en:p7,"zh-CN":v7})[e.languageTag??os()](),m7=()=>"(UTC-4) Toronto",g7=()=>"(UTC-4) 多伦多",h7=(o={},e={})=>({en:m7,"zh-CN":g7})[e.languageTag??os()](),_7=()=>"(UTC-3) São Paulo",y7=()=>"(UTC-3) 圣保罗",b7=(o={},e={})=>({en:_7,"zh-CN":y7})[e.languageTag??os()](),x7=()=>"(UTC+1) London",w7=()=>"(UTC+1) 伦敦",k7=(o={},e={})=>({en:x7,"zh-CN":w7})[e.languageTag??os()](),S7=()=>"(UTC+2) Berlin",C7=()=>"(UTC+2) 柏林",P7=(o={},e={})=>({en:S7,"zh-CN":C7})[e.languageTag??os()](),I7=()=>"(UTC+3) Bahrain",M7=()=>"(UTC+3) 巴林",T7=(o={},e={})=>({en:I7,"zh-CN":M7})[e.languageTag??os()](),A7=()=>"(UTC+4) Dubai",L7=()=>"(UTC+4) 迪拜",z7=(o={},e={})=>({en:A7,"zh-CN":L7})[e.languageTag??os()](),F7=()=>"(UTC+5) Ashkhabad",$7=()=>"(UTC+5) 阿什哈巴德",D7=(o={},e={})=>({en:F7,"zh-CN":$7})[e.languageTag??os()](),E7=()=>"(UTC+6) Almaty",N7=()=>"(UTC+6) 阿拉木图",j7=(o={},e={})=>({en:E7,"zh-CN":N7})[e.languageTag??os()](),R7=()=>"(UTC+7) Bangkok",B7=()=>"(UTC+7) 曼谷",O7=(o={},e={})=>({en:R7,"zh-CN":B7})[e.languageTag??os()](),V7=()=>"(UTC+8) Shanghai",W7=()=>"(UTC+8) 上海",q7=(o={},e={})=>({en:V7,"zh-CN":W7})[e.languageTag??os()](),H7=()=>"(UTC+9) Tokyo",G7=()=>"(UTC+9) 东京",U7=(o={},e={})=>({en:H7,"zh-CN":G7})[e.languageTag??os()](),Y7=()=>"(UTC+10) Sydney",K7=()=>"(UTC+10) 悉尼",Z7=(o={},e={})=>({en:Y7,"zh-CN":K7})[e.languageTag??os()](),X7=()=>"(UTC+11) Solomon Islands",J7=()=>"(UTC+11) 所罗门群岛",Q7=(o={},e={})=>({en:X7,"zh-CN":J7})[e.languageTag??os()](),eP=()=>"(UTC+12) Auckland",tP=()=>"(UTC+12) 奥克兰",oP=(o={},e={})=>({en:eP,"zh-CN":tP})[e.languageTag??os()](),yv=Object.freeze(Object.defineProperty({__proto__:null,AO:ZC,BBI:US,BIAS:lC,BOLL:OS,BRAR:uC,CCI:fC,CR:hC,DMA:kC,DMI:QC,EMA:DS,EMV:OC,KDJ:oC,MA:zS,MACD:QS,MTM:jC,OBV:TC,PSY:bC,PVT:UC,ROC:qC,RSI:iC,SAR:qS,SMA:jS,TRIX:PC,VOL:ZS,VR:zC,WR:DC,abcd:bS,almaty:j7,any_waves:hS,area:U8,arrow:b9,ashkhabad:D7,auckland:oP,bahrain:T7,bangkok:O7,berlin:P7,cancel:r8,candle_down_stroke:O8,candle_solid:z8,candle_stroke:D8,candle_type:T8,candle_up_stroke:j8,change_:Vk,chicago:f7,circle:oS,close_:Ek,confirm:s8,day:Hb,days:Ob,dubai:z7,eight_waves:fS,fibonacci_circle:D9,fibonacci_extension:q9,fibonacci_segment:z9,fibonacci_speed_resistance_fan:O9,fibonacci_spiral:j9,five_waves:uS,gann_box:U9,grid_show:b8,guadalcanal:Q7,high_:Ak,high_price_show:i4,honolulu:i7,horizontal_ray_line:Z4,horizontal_segment:Q4,horizontal_straight_line:U4,hour:qb,hours:Vb,indicator:F1,indicator_last_value_show:u4,juneau:l7,last_price_show:o4,log:P4,london:k7,los_angeles:u7,low_:Fk,low_price_show:l4,mins:d1,minute:Wb,month:Ub,no_data:Uk,no_ind_params:Db,normal:b4,num_bar:Bb,ohlc:q8,open_:Ik,parallel_straight_line:T9,parallelogram:Q9,param:jb,percentage:k4,period:c1,price_axis_type:Z8,price_channel_line:P9,price_line:k9,ray_line:f9,rect:Z9,reset:P8,restore:k8,reverse_coordinate:Q8,sao_paulo:b7,screenshot:h8,search:Eb,segment:h9,setting:e8,settings:Nb,shanghai:q7,standard_deviation:Rb,straight_line:u9,strongMagnet:TS,sydney:Z7,symbol_search:$b,three_waves:lS,time_:Sk,timeframe:zb,timezone:Fb,tokyo:U7,toronto:h7,triangle:iS,utc:o7,vertical_ray_line:i9,vertical_segment:l9,vertical_straight_line:o9,volume_:Rk,weakMagnet:PS,week:Gb,xabcd:kS},Symbol.toStringTag,{value:"Module"})),sP=["MA","EMA","SMA","BOLL","SAR","BBI"],nP=["VOL","MACD","KDJ","RSI","BIAS","BRAR","CCI","DMI","CR","PSY","TRIX","OBV","VR","WR","MTM","EMV","ROC","PVT","AO"];class Yb{constructor(){ve(this,"editPaneId");ve(this,"editIndName");ve(this,"modalIndCfg");ve(this,"fireOhlcv");ve(this,"klineLoaded");ve(this,"cloudIndLoaded");ve(this,"initDone");ve(this,"clickChart");ve(this,"loadingKLine");ve(this,"loadingPairs");ve(this,"timeStart");ve(this,"timeEnd");ve(this,"allInds");ve(this,"isApplyingManualStyles");ve(this,"applyCanvasColors");ve(this,"clearCciGroups");ve(this,"clearEmvGroups");ve(this,"clearMtmGroups");ve(this,"clearObvGroups");ve(this,"clearPsyGroups");ve(this,"clearPvtGroups");ve(this,"clearRocGroups");ve(this,"clearVolGroups");ve(this,"clearWrGroups");this.editPaneId="",this.editIndName="",this.modalIndCfg=!1,this.fireOhlcv=0,this.klineLoaded=0,this.cloudIndLoaded=0,this.initDone=0,this.clickChart=0,this.loadingKLine=!1,this.loadingPairs=!1,this.timeStart=0,this.timeEnd=0,this.allInds=[],this.isApplyingManualStyles=!1,this.clearCciGroups=0,this.clearEmvGroups=0,this.clearMtmGroups=0,this.clearObvGroups=0,this.clearPsyGroups=0,this.clearPvtGroups=0,this.clearRocGroups=0,this.clearVolGroups=0,this.clearWrGroups=0;for(let e of sP){const t=`${e} (${yv[e]()})`;this.allInds.push({name:e,title:t,cloud:!1,is_main:!0})}for(let e of nP){const t=`${e} (${yv[e]()})`;this.allInds.push({name:e,title:t,cloud:!1,is_main:!1})}}}class dh{constructor(){ve(this,"showDrawBar");ve(this,"showSidebar");ve(this,"period");ve(this,"symbol");ve(this,"dateStart");ve(this,"dateEnd");ve(this,"timezone");ve(this,"curSymbols");ve(this,"allSymbols");ve(this,"allExgs");ve(this,"colorLong");ve(this,"colorShort");ve(this,"saveInds");ve(this,"key");ve(this,"theme");ve(this,"styles");ve(this,"options");this.showDrawBar=!0,this.showSidebar=!0,this.symbol={name:"Grameen Phone Limited",ticker:"GP",market:"stock",exchange:"DSEBD",type:"stock",priceCurrency:"BDT"},this.period={multiplier:1,timespan:"day",timeframe:"1d",secs:86400};const e=hk();this.dateEnd=Py(e,"YYYYMMDD");const t=e-this.period.secs*1e3*500;this.dateStart=Py(t,"YYYYMMDD"),this.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone,this.curSymbols=[],this.allSymbols=[],this.allExgs=new Set,this.colorLong="#0000FF",this.colorShort="#FF0000",this.saveInds={},this.key="",this.theme="dark",this.styles={pane:{backgroundColor:"#070211"},candle:{pane:{backgroundColor:"#070211"},type:"renko_atr",renko:{method:"ATR",atrLength:14,source:"close",wick:!1},pnf:{boxSizeMode:"absolute",boxSize:1,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"}},grid:{horizontal:{color:"#081115"},vertical:{color:"#081115"}}},this.options={enableRealtime:!1}}}function u1(o,e){const t=e.x>o.x?0:1,s=Ef.getLinearSlopeIntercept(o,e);let i;s?i=Math.atan(s[0])+Math.PI*t:e.y>o.y?i=Math.PI/2:i=Math.PI/2*3;const r=L0({x:e.x-8,y:e.y+4},e,i),a=L0({x:e.x-8,y:e.y-4},e,i);return[{type:"line",attrs:{coordinates:[o,e]}},{type:"line",ignoreEvent:!0,attrs:{coordinates:[r,e,a]}}]}function L0(o,e,t){const s=(o.x-e.x)*Math.cos(t)-(o.y-e.y)*Math.sin(t)+e.x,i=(o.x-e.x)*Math.sin(t)+(o.y-e.y)*Math.cos(t)+e.y;return{x:s,y:i}}function p1(o,e){if(o.length>1){let t;const s=o[0],i=o[1];return s.x===i.x&&s.y!==i.y?s.y<i.y?t={x:s.x,y:e.height}:t={x:s.x,y:0}:s.x>i.x?t={x:0,y:Ef.getLinearYFromCoordinates(s,i,{x:0,y:s.y})}:t={x:e.width,y:Ef.getLinearYFromCoordinates(s,i,{x:e.width,y:s.y})},{coordinates:[s,t]}}return[]}function Kb(o,e){const t=Math.abs(o.x-e.x),s=Math.abs(o.y-e.y);return Math.sqrt(t*t+s*s)}function $1(o,e,t){let s=2;try{(t==null?void 0:t.isInCandle())??!0?s=2:s=4}catch{s=2}return s}const Zb={name:"arrow",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>o.length>1?u1(o[0],o[1]):[]},Xb={name:"circle",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{circle:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>{if(o.length>1){const e=Kb(o[0],o[1]),t=[];return t.push({type:"circle",attrs:{...o[0],r:e+30},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),t.push({type:"circle",attrs:{...o[0],r:e},styles:{style:"stroke_fill"}}),t}return[]}},Jb={name:"rect",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>{if(o.length>1){const e=[],s=[{x:o[0].x-30,y:o[0].y-30},{x:o[1].x+30,y:o[0].y-30},{x:o[1].x+30,y:o[1].y+30},{x:o[0].x-30,y:o[1].y+30}];return e.push({type:"polygon",attrs:{coordinates:s},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),e.push({type:"polygon",attrs:{coordinates:[o[0],{x:o[1].x,y:o[0].y},o[1],{x:o[0].x,y:o[1].y}]},styles:{style:"stroke_fill"}}),e}return[]}},Qb={name:"parallelogram",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>{if(o.length===2)return[{type:"line",ignoreEvent:!0,attrs:{coordinates:o}}];if(o.length===3){const e={x:o[0].x+(o[2].x-o[1].x),y:o[2].y};return[{type:"polygon",attrs:{coordinates:[o[0],o[1],o[2],e]},styles:{style:"stroke_fill"}}]}return[]},performEventPressedMove:({points:o,performPointIndex:e,performPoint:t})=>{e<2&&(o[0].price=t.price,o[1].price=t.price)},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].price=t.price)}},ex={name:"triangle",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>[{type:"polygon",attrs:{coordinates:o},styles:{style:"stroke_fill"}}]},tx={name:"fibonacciCircle",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,overlay:e})=>{var t,s,i,r;if(o.length>1){const a=Math.abs(o[0].x-o[1].x),l=Math.abs(o[0].y-o[1].y),c=Math.sqrt(a*a+l*l),d=[.236,.382,.5,.618,.786,1],v=[],g=[];return d.forEach(_=>{const y=c*_;v.push({...o[0],r:y}),g.push({x:o[0].x,y:o[0].y+y+6,text:`${(_*100).toFixed(1)}%`})}),[{type:"circle",attrs:v,styles:{style:"stroke",borderSize:((s=(t=e.styles)==null?void 0:t.line)==null?void 0:s.size)??2}},{type:"text",ignoreEvent:!0,attrs:g,styles:{color:((r=(i=e.styles)==null?void 0:i.line)==null?void 0:r.color)??"#666666",backgroundColor:"transparent",backgroundOpacity:0,borderSize:0,borderColor:"transparent"}}]}return[]}},iP=[{value:0,color:"#FF6B6B",visible:!0},{value:.236,color:"#4ECDC4",visible:!0},{value:.382,color:"#45B7D1",visible:!0},{value:.5,color:"#96CEB4",visible:!0},{value:.618,color:"#FFEAA7",visible:!0},{value:1,color:"#98D8C8",visible:!0},{value:1.618,color:"#85C1E9",visible:!0}],ox={name:"fibonacciSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{line:{size:1,color:"#1e88e5"},polygon:{color:"rgba(30, 136, 229, 0.1)"}},createPointFigures:({chart:o,coordinates:e,overlay:t,yAxis:s})=>{var a,l,c,d,v,g,_,y,k,S,M,I,C;const i=$1(o,t,s),r=[];if(e.length>1){const T=t.points,z=(a=T[0])==null?void 0:a.value,j=(l=T[1])==null?void 0:l.value;if(z===void 0||j===void 0)return r;const B=j-z,$=e[0].y,F=e[1].y,V=F-$,Y=(((c=t.extendData)==null?void 0:c.fibonacciLevels)||t.fibonacciLevels||iP).filter(te=>te.visible);for(let te=0;te<Y.length-1;te++){const oe=Y[te],U=Y[te+1],J=F-V*oe.value,se=F-V*U.value;r.push({type:"polygon",attrs:{coordinates:[{x:e[0].x,y:J},{x:e[1].x,y:J},{x:e[1].x,y:se},{x:e[0].x,y:se}]},styles:{style:"fill",color:oe.color+"40"}})}const Z=[],ne=[];Y.forEach(te=>{const oe=F-V*te.value,U=(j-B*te.value).toFixed(i);Z.push({coordinates:[{x:e[0].x,y:oe},{x:e[1].x,y:oe}]}),ne.push({x:e[0].x-8,y:oe,text:`${(te.value*100).toFixed(1)}% (${U})`,baseline:"middle",align:"right"})}),r.push({type:"line",attrs:Z,styles:{size:((v=(d=t.styles)==null?void 0:d.line)==null?void 0:v.size)||1,color:((_=(g=t.styles)==null?void 0:g.line)==null?void 0:_.color)||"#1e88e5"}}),r.push({type:"text",ignoreEvent:!0,attrs:ne,styles:{color:((k=(y=t.styles)==null?void 0:y.text)==null?void 0:k.color)||"#666666",backgroundColor:"transparent"}}),r.push({type:"line",attrs:{coordinates:[e[0],e[1]]},styles:{style:"dashed",size:((M=(S=t.styles)==null?void 0:S.line)==null?void 0:M.size)||1,color:((C=(I=t.styles)==null?void 0:I.line)==null?void 0:C.color)||"#1e88e5"}})}return r}},sx={name:"fibonacciSpiral",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>{if(o.length>1){const t=Kb(o[0],o[1])/Math.sqrt(24),s=o[1].x>o[0].x?0:1,i=Ef.getLinearSlopeIntercept(o[0],o[1]);let r;i?r=Math.atan(i[0])+Math.PI*s:o[1].y>o[0].y?r=Math.PI/2:r=Math.PI/2*3;const a=L0({x:o[0].x-t,y:o[0].y},o[0],r),l=L0({x:o[0].x-t,y:o[0].y-t},o[0],r),c=[{...a,r:t,startAngle:r,endAngle:r+Math.PI/2},{...l,r:t*2,startAngle:r+Math.PI/2,endAngle:r+Math.PI}];let d=o[0].x-t,v=o[0].y-t;for(let g=2;g<9;g++){const _=c[g-2].r+c[g-1].r;let y=0;switch(g%4){case 0:{y=r,d-=c[g-2].r;break}case 1:{y=r+Math.PI/2,v-=c[g-2].r;break}case 2:{y=r+Math.PI,d+=c[g-2].r;break}case 3:{y=r+Math.PI/2*3,v+=c[g-2].r;break}}const k=y+Math.PI/2,S=L0({x:d,y:v},o[0],r);c.push({...S,r:_,startAngle:y,endAngle:k})}return[{type:"arc",attrs:c,styles:{size:2}},{type:"line",attrs:p1(o,e),styles:{size:2}}]}return[]}},nx={name:"fibonacciSpeedResistanceFan",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e,overlay:t})=>{var a,l,c,d,v,g;const s=[];let i=[];const r=[];if(o.length>1){const _=o[1].x>o[0].x?-38:4,y=o[1].y>o[0].y?-2:20,k=o[1].x-o[0].x,S=o[1].y-o[0].y;[1,.75,.618,.5,.382,.25,0].forEach(I=>{const C=o[1].x-k*I,T=o[1].y-S*I;s.push({coordinates:[{x:C,y:o[0].y},{x:C,y:o[1].y}]}),s.push({coordinates:[{x:o[0].x,y:T},{x:o[1].x,y:T}]}),i=i.concat(p1([o[0],{x:C,y:o[1].y}],e)),i=i.concat(p1([o[0],{x:o[1].x,y:T}],e)),r.unshift({x:o[0].x+_,y:T+10,text:`${I.toFixed(3)}`}),r.unshift({x:C-18,y:o[0].y+y,text:`${I.toFixed(3)}`})})}return[{type:"line",attrs:s,styles:{size:((l=(a=t.styles)==null?void 0:a.line)==null?void 0:l.size)??2}},{type:"line",attrs:i,styles:{size:((d=(c=t.styles)==null?void 0:c.line)==null?void 0:d.size)??2}},{type:"text",ignoreEvent:!0,attrs:r,styles:{color:((g=(v=t.styles)==null?void 0:v.line)==null?void 0:g.color)??"#666666",backgroundColor:"transparent",backgroundOpacity:0,borderSize:0,borderColor:"transparent"}}]}},ix={name:"fibonacciExtension",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({chart:o,coordinates:e,overlay:t,yAxis:s})=>{var l,c,d,v,g,_;const i=$1(o,t,s),r=[],a=[];if(e.length>2){const y=t.points,k=y[1].value-y[0].value,S=e[1].y-e[0].y,M=[0,.236,.382,.5,.618,.786,1,1.618,2.618],C=Math.min(e[1].x,e[2].x)-16;M.forEach(T=>{const z=e[2].y+S*T,j=(y[2].value+k*T).toFixed(i);r.push({coordinates:[{x:e[1].x,y:z},{x:e[2].x,y:z}]}),a.push({x:C,y:z,text:`${j} (${(T*100).toFixed(1)}%)`,baseline:"middle",align:"right"})})}return[{type:"line",attrs:{coordinates:e},styles:{style:"dashed",size:((c=(l=t.styles)==null?void 0:l.line)==null?void 0:c.size)??2}},{type:"line",attrs:r,styles:{size:((v=(d=t.styles)==null?void 0:d.line)==null?void 0:v.size)??2}},{type:"text",ignoreEvent:!0,attrs:a,styles:{color:((_=(g=t.styles)==null?void 0:g.line)==null?void 0:_.color)??"#666666",backgroundColor:"transparent",backgroundOpacity:0,borderSize:0,borderColor:"transparent"}}]}},rx={name:"gannBox",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o,overlay:e})=>{var t,s,i,r;if(o.length>1){const a=(o[1].y-o[0].y)/4,l=o[1].x-o[0].x,c=[{coordinates:[o[0],{x:o[1].x,y:o[1].y-a}]},{coordinates:[o[0],{x:o[1].x,y:o[1].y-a*2}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[1].x,y:o[0].y+a}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[1].x,y:o[0].y+a*2}]},{coordinates:[{...o[0]},{x:o[0].x+l*.236,y:o[1].y}]},{coordinates:[{...o[0]},{x:o[0].x+l*.5,y:o[1].y}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[0].x+l*.236,y:o[0].y}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[0].x+l*.5,y:o[0].y}]}],d=[{coordinates:[o[0],o[1]]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[1].x,y:o[0].y}]}];return[{type:"line",attrs:[{coordinates:[o[0],{x:o[1].x,y:o[0].y}]},{coordinates:[{x:o[1].x,y:o[0].y},o[1]]},{coordinates:[o[1],{x:o[0].x,y:o[1].y}]},{coordinates:[{x:o[0].x,y:o[1].y},o[0]]}]},{type:"polygon",ignoreEvent:!0,attrs:{coordinates:[o[0],{x:o[1].x,y:o[0].y},o[1],{x:o[0].x,y:o[1].y}]},styles:{style:"fill"}},{type:"line",attrs:c,styles:{style:"dashed",size:((s=(t=e.styles)==null?void 0:t.line)==null?void 0:s.size)??1}},{type:"line",attrs:d,styles:{size:((r=(i=e.styles)==null?void 0:i.line)==null?void 0:r.size)??1}}]}return[]}},ax={name:"threeWaves",totalStep:5,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},lx={name:"fiveWaves",totalStep:7,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},cx={name:"eightWaves",totalStep:10,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},dx={name:"anyWaves",totalStep:Number.MAX_SAFE_INTEGER,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},ux={name:"abcd",totalStep:5,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{let e=[],t=[];const s=["A","B","C","D"],i=o.map((r,a)=>({...r,baseline:"bottom",text:`(${s[a]})`}));return o.length>2&&(e=[o[0],o[2]],o.length>3&&(t=[o[1],o[3]])),[{type:"line",attrs:{coordinates:o}},{type:"line",attrs:[{coordinates:e},{coordinates:t}],styles:{style:"dashed"}},{type:"text",ignoreEvent:!0,attrs:i}]}},px={name:"xabcd",totalStep:6,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o,overlay:e})=>{const t=[],s=[],i=["X","A","B","C","D"],r=o.map((a,l)=>({...a,baseline:"bottom",text:`(${i[l]})`}));return o.length>2&&(t.push({coordinates:[o[0],o[2]]}),s.push({coordinates:[o[0],o[1],o[2]]}),o.length>3&&(t.push({coordinates:[o[1],o[3]]}),o.length>4&&(t.push({coordinates:[o[2],o[4]]}),s.push({coordinates:[o[2],o[3],o[4]]})))),[{type:"line",attrs:{coordinates:o}},{type:"line",attrs:t,styles:{style:"dashed"}},{type:"polygon",ignoreEvent:!0,attrs:s},{type:"text",ignoreEvent:!0,attrs:r}]}};function rP(o,e,t,s){const i=e==="bottom"?1:-1,r=o.x,a=r+200,l=o.y+3*i,c=l+50*i,d=c+5*i,v=s?{color:s}:{},g=s?{backgroundColor:s,borderColor:s}:{};return[{type:"line",attrs:{coordinates:[{x:r,y:l},{x:r,y:c}]},ignoreEvent:!0},{type:"line",attrs:{coordinates:[{x:r,y:o.y},{x:a,y:o.y}]},ignoreEvent:!0,styles:{...v}},{type:"polygon",attrs:{coordinates:[{x:r,y:c},{x:r-4,y:d},{x:r+4,y:d}]},ignoreEvent:!0,styles:v},{type:"rectText",attrs:{x:r,y:d,text:t??"",align:"center",baseline:"bottom"},ignoreEvent:!0,styles:g}]}const vx={name:"barSignal",totalStep:2,createPointFigures:({overlay:o,coordinates:e})=>{let{postion:t,text:s,bgColor:i}=o.extendData,r=[];return e.forEach(a=>{r.push(...rP(a,t,s,i))}),r}};function aP(o){let i=[];if(o>86400){const r=Math.floor(o/86400);i.push(r.toString(),Ob()),o=o%86400}if(o>3600){const r=Math.floor(o/3600);i.push(r.toString(),Vb()),o=o%3600}if(o>60){const r=Math.floor(o/60);i.push(r.toString(),d1()),o=o%60}return o>0&&i.push("1",d1()),i.join("")}const fx={name:"ruler",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},onDeselected:o=>{var e;return(e=o.chart)==null||e.removeOverlay({id:o.overlay.id}),!0},createPointFigures:({chart:o,coordinates:e,overlay:t,yAxis:s})=>{const i=$1(o,t,s);if(e.length>1){const r=e[0],a=e[1],l=(r.x+a.x)/2,c=(r.y+a.y)/2,d=u1({x:l,y:r.y},{x:l,y:a.y}),v=u1({x:r.x,y:c},{x:a.x,y:c}),g=r.y>a.y?"#F7525F":"#2962FF",_={color:"#ffffff",backgroundColor:g,borderColor:g,paddingLeft:6,paddingTop:6,paddingRight:6,paddingBottom:6},y=t.points,k=y[0].value-y[1].value,S=k.toFixed(i),M=(k/y[0].value*100).toFixed(2),I=y[1].dataIndex-y[0].dataIndex,C=(y[1].timestamp-y[0].timestamp)/1e3,T=`${S} (${M}%)
${I}${Bb()}, ${aP(C)}`;let z=a.y+10,j="top";r.y>a.y&&(z=a.y-10,j="bottom");const B=[],$=30,F=[{x:r.x-$,y:r.y-$},{x:a.x+$,y:r.y-$},{x:a.x+$,y:a.y+$},{x:r.x-$,y:a.y+$}];return B.push({type:"polygon",attrs:{coordinates:F},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),B.push({type:"polygon",attrs:{coordinates:[r,{x:a.x,y:r.y},a,{x:r.x,y:a.y}]},styles:{style:"stroke_fill"}}),B.push({type:"textBox",attrs:{x:l,y:z,text:T,align:"center",baseline:j},ignoreEvent:!0,styles:_}),B.push(...d),B.push(...v),B}return[]}},Ty={color:"#ffffff",paddingLeft:6,paddingTop:6,paddingRight:6,paddingBottom:6},mx={name:"trade",lock:!0,totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,overlay:e})=>{if(o.length<=1)return[];const t=e.extendData,s=o[0],i=o[1],r={size:.5};t&&t.line_color&&(r.color=t.line_color);const a=[],l={type:"line",attrs:{coordinates:[s,i]},styles:{color:"transparent",size:40},ignoreEvent:!1};a.push(l);const c={type:"line",attrs:{coordinates:[s,i]},styles:r};if(a.push(c),!t.active&&!t.selected)return a;const d=t.distance??15;let v="bottom",g=s.y-d,_="top",y=i.y+d;s.y>i.y&&(v="top",g=s.y+d,_="bottom",y=i.y-d);const k={type:"textBox",attrs:{x:s.x,y:g,text:t.in_text,align:"center",baseline:v},ignoreEvent:!0,styles:{...Ty,backgroundColor:t.in_color,borderColor:t.in_color}},S={type:"textBox",attrs:{x:i.x,y,text:t.out_text,align:"center",baseline:_},ignoreEvent:!0,styles:{...Ty,backgroundColor:t.out_color,borderColor:t.out_color}},M={type:"line",attrs:{coordinates:[s,{x:s.x,y:g}]},ignoreEvent:!0,styles:r},I={type:"line",attrs:{coordinates:[i,{x:i.x,y}]},ignoreEvent:!0,styles:r};return[l,c,k,S,M,I]},onSelected:o=>{const e=o.overlay.extendData;return e.selected=!0,!1},onDeselected:o=>{const e=o.overlay.extendData;return e.selected=!1,!1},onMouseEnter:o=>{const e=o.overlay.extendData;return e.active=!0,!1},onMouseLeave:o=>{const e=o.overlay.extendData;return e.active=!1,!1}},lP={color:"#ffffff",paddingLeft:6,paddingTop:6,paddingRight:6,paddingBottom:6},gx={name:"note",lock:!0,totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,overlay:e})=>{if(o.length==0)return[];const t=e.extendData,s=o[0],i={size:.5};t&&t.line_color&&(i.color=t.line_color);const r=t.distance??15;let a="bottom",l=s.y-r;const c={type:"textBox",attrs:{x:s.x,y:l,text:t.in_text,align:"center",baseline:a},ignoreEvent:!0,styles:{...lP,backgroundColor:t.in_color,borderColor:t.in_color}},d={type:"line",attrs:{coordinates:[s,{x:s.x,y:l}]},ignoreEvent:!0,styles:i};return[c,d]}},hx={name:"emoji",totalStep:2,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,styles:{box:{enabled:!1,stroke:"#3b82f6",width:1,fill:"transparent"},handles:{size:6,fill:"#3b82f6",stroke:"#3b82f6"}},createPointFigures:({coordinates:o,overlay:e})=>{if(o.length===0)return[];const t=e.extendData;if(!t||!t.emoji)return[];const s=o[0],i=t.size||24;t.rotation;const r=t.selected||!1;t.active;const a=[],l=e.styles||{box:{enabled:!1,stroke:"#3b82f6",width:1,fill:"transparent"},handles:{size:6,fill:"#3b82f6",stroke:"#3b82f6"}},c={type:"text",attrs:{x:s.x,y:s.y,text:t.emoji,align:"center",baseline:"middle"},styles:{size:i,family:"Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",weight:"normal",backgroundColor:"transparent"}};if(a.push(c),r){const d=i/2,v=4,g={type:"rect",attrs:{x:s.x-d-v,y:s.y-d-v,width:i+v*2,height:i+v*2},styles:{stroke:l.box.stroke,strokeWidth:l.box.width,fill:"transparent",backgroundColor:"transparent"}};a.push(g);const _=l.handles.size,y=d+v;[{x:s.x-y-_/2,y:s.y-y-_/2},{x:s.x+y-_/2,y:s.y-y-_/2},{x:s.x-y-_/2,y:s.y+y-_/2},{x:s.x+y-_/2,y:s.y+y-_/2}].forEach(S=>{const M={type:"rect",attrs:{x:S.x,y:S.y,width:_,height:_},styles:{fill:l.handles.fill,stroke:l.handles.stroke,strokeWidth:1,backgroundColor:"transparent"}};a.push(M)})}return a},onDrawStart:o=>!0,onDrawing:o=>!0,onDrawEnd:o=>!0,onPressedMoveStart:o=>!0,onPressedMoving:o=>!0,onPressedMoveEnd:o=>!0,onSelected:o=>{const e=o.overlay.extendData;return e&&(e.selected=!0),!1},onDeselected:o=>{const e=o.overlay.extendData;return e&&(e.selected=!1),!1},onMouseEnter:o=>{const e=o.overlay.extendData;return e&&(e.active=!0),!1},onMouseLeave:o=>{const e=o.overlay.extendData;return e&&(e.active=!1),!1}},nm="Add text";class cP{constructor(){ve(this,"editor",null);ve(this,"chart",null);ve(this,"overlay",null);ve(this,"pos",{x:0,y:0});ve(this,"raf",null);ve(this,"lastCommitted","");ve(this,"boundPointerHandler",null);ve(this,"boundKeydownShield",null);ve(this,"placeholderCssInjected",!1)}startEditing(e,t){var s;this.chart=e,this.overlay=t,this.lastCommitted=((s=t.extendData)==null?void 0:s.text)??"",this.ensureEditor(),this.updateOverlayEditing(!0),this.syncPosition(),this.addOutsideListeners(),this.addKeydownShield(),setTimeout(()=>{var a,l;(a=this.editor)==null||a.focus();const i=((l=t.extendData)==null?void 0:l.text)??"",r=!i||i===nm;this.editor&&(this.editor.innerText=r?"":i,this.editor.setAttribute("data-placeholder",nm),this.editor.classList.add("kc-inline-text-editor"),this.injectPlaceholderCss());try{const c=window.getSelection();if(c&&this.editor){const d=this.editor.innerText.length;this.editor.firstChild&&c.collapse(this.editor.firstChild,Math.min(d,(this.editor.firstChild.textContent||"").length))}}catch{}},0),this.loop()}reEdit(e,t){this.startEditing(e,t)}updateEditorStyle(e){e&&(this.overlay=e),this.applyStylesFromOverlay()}ensureEditor(){if(this.editor)return;const e=document.createElement("div");e.contentEditable="true",e.style.position="fixed",e.style.zIndex="10000",e.style.outline="none",e.style.padding="8px",e.style.whiteSpace="pre-wrap",e.style.wordBreak="break-word",e.style.userSelect="text",e.style.transform="translate(0, -50%)",e.style.boxSizing="border-box",e.addEventListener("keydown",t=>this.onKeyDown(t)),e.addEventListener("input",()=>this.onInput()),e.addEventListener("blur",()=>this.commit()),document.body.appendChild(e),this.editor=e,this.applyStylesFromOverlay()}applyStylesFromOverlay(){var c;if(!this.editor||!this.overlay)return;const e=this.overlay.extendData||{},t=((c=this.overlay.styles)==null?void 0:c.text)||{},s=e.fontSize??t.size??32,i=e.fontWeight??t.weight??"bold",r=e.textColor??t.color??"#FFFFFF",a=e.backgroundColor??t.backgroundColor??"#00000033",l=e.fontFamily??t.family??'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif';this.editor.style.fontSize=`${s}px`,this.editor.style.lineHeight=`${Math.round(s*1.4)}px`,this.editor.style.fontWeight=i,this.editor.style.color=r,this.editor.style.background=a,this.editor.style.border="none",this.editor.style.fontFamily=l,this.editor.style.minWidth="0px",this.editor.style.minHeight=`${Math.round(s*1.4)}px`}loop(){this.raf&&cancelAnimationFrame(this.raf);const e=()=>{this.syncPosition(),this.raf=requestAnimationFrame(e)};this.raf=requestAnimationFrame(e)}syncPosition(){var s;if(!this.chart||!this.overlay||!((s=this.overlay.points)!=null&&s.length))return;const e=this.overlay.paneId||"candle_pane",t=this.chart.convertToPixel(this.overlay.points[0],{paneId:e});t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.pos={x:t.x,y:t.y},this.editor&&(this.editor.style.left=`${this.pos.x}px`,this.editor.style.top=`${this.pos.y}px`))}addOutsideListeners(){if(this.boundPointerHandler)return;const e=t=>{const s=t.target;if(!this.editor||s&&this.editor.contains(s))return;const i=s;i&&(i.closest(".context-menu-container")||i.closest(".premium-submenu"))||this.finishFromOutside()};this.boundPointerHandler=e,document.addEventListener("pointerdown",e,{capture:!0}),document.addEventListener("touchstart",e,{capture:!0}),document.addEventListener("mousedown",e,{capture:!0})}removeOutsideListeners(){this.boundPointerHandler&&(document.removeEventListener("pointerdown",this.boundPointerHandler,{capture:!0}),document.removeEventListener("touchstart",this.boundPointerHandler,{capture:!0}),document.removeEventListener("mousedown",this.boundPointerHandler,{capture:!0}),this.boundPointerHandler=null)}addKeydownShield(){if(this.boundKeydownShield)return;const e=t=>{if(!this.editor)return;const s=t.target;s&&(s===this.editor||this.editor.contains(s))&&t.stopPropagation()};this.boundKeydownShield=e,document.addEventListener("keydown",e,{capture:!0})}removeKeydownShield(){this.boundKeydownShield&&(document.removeEventListener("keydown",this.boundKeydownShield,{capture:!0}),this.boundKeydownShield=null)}finishFromOutside(){if(!this.editor)return;const e=this.editor.innerText||"";try{this.editor.blur()}catch{}!e||e===nm?this.deleteOverlay():this.commit()}onKeyDown(e){var t;if(e.stopPropagation(),e.key==="Escape"){e.preventDefault();const s=(((t=this.editor)==null?void 0:t.innerText)||"").trim();!s||s===nm?this.deleteOverlay():this.revert()}e.key==="Backspace"||e.key==="Delete"||e.key}onInput(){if(!this.editor||!this.chart||!this.overlay)return;this.editor.innerText.length>0?this.editor.setAttribute("data-placeholder",nm):this.editor.setAttribute("data-placeholder",nm);const e=Math.max(12,this.editor.scrollWidth),t=Math.max(this.editor.scrollHeight,Math.round(parseInt(this.editor.style.lineHeight)||32)),s=getComputedStyle(this.editor),i=parseFloat(s.paddingLeft||"0")+parseFloat(s.paddingRight||"0"),r=parseFloat(s.paddingTop||"0")+parseFloat(s.paddingBottom||"0"),a=Math.max(0,e-i),l=Math.max(0,t-r),c={...this.overlay.extendData||{},text:this.editor.innerText,boxWidth:e,boxHeight:t,contentWidth:a,contentHeight:l};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:c})}catch{}}updateOverlayEditing(e){if(!this.chart||!this.overlay)return;const t={...this.overlay.extendData||{},editing:e};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:t})}catch{}}commit(){var c;if(!this.chart||!this.overlay){this.cleanup();return}const e=((c=this.editor)==null?void 0:c.innerText)||"";if(!e||e===nm){this.deleteOverlay();return}this.lastCommitted=e;const t=this.editor?Math.max(12,this.editor.scrollWidth):void 0,s=this.editor?Math.max(this.editor.scrollHeight,Math.round(parseInt(this.editor.style.lineHeight)||32)):void 0,i=this.editor?getComputedStyle(this.editor):null,r=i?parseFloat(i.paddingLeft||"0")+parseFloat(i.paddingRight||"0"):0,a=i?parseFloat(i.paddingTop||"0")+parseFloat(i.paddingBottom||"0"):0,l={...this.overlay.extendData||{},text:e,editing:!1,...t?{boxWidth:t}:{},...s?{boxHeight:s}:{},...t?{contentWidth:Math.max(0,t-r)}:{},...s?{contentHeight:Math.max(0,s-a)}:{}};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:l})}catch{}this.cleanup()}revert(){if(!this.chart||!this.overlay){this.cleanup();return}const e={...this.overlay.extendData||{},text:this.lastCommitted,editing:!1};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:e})}catch{}this.cleanup()}deleteOverlay(){var e;if(!this.chart||!this.overlay){this.cleanup();return}try{(e=this.editor)==null||e.blur()}catch{}try{this.chart.removeOverlay({id:this.overlay.id})}catch{}this.cleanup()}cleanup(){if(this.raf&&cancelAnimationFrame(this.raf),this.raf=null,this.overlay=null,this.removeOutsideListeners(),this.removeKeydownShield(),this.editor)try{this.editor.remove()}catch{}this.editor=null}getEditorRect(){try{return this.editor?this.editor.getBoundingClientRect():null}catch{return null}}injectPlaceholderCss(){if(!this.placeholderCssInjected)try{const e="kc-inline-text-editor-placeholder-style";if(document.getElementById(e)){this.placeholderCssInjected=!0;return}const t=document.createElement("style");t.id=e,t.textContent=`
        .kc-inline-text-editor:empty::before {
          content: attr(data-placeholder);
          color: rgba(255,255,255,0.6);
        }
      `,document.head.appendChild(t),this.placeholderCssInjected=!0}catch{}}}const Tm=new cP,Ay="system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif",_x={name:"text",totalStep:2,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,zLevel:100,styles:{text:{color:"#FFFFFF",backgroundColor:"#00000033",borderColor:"#1677FF",size:32,weight:"bold",family:Ay,paddingLeft:8,paddingRight:8,paddingTop:8,paddingBottom:8,borderSize:1},box:{stroke:"#1677FF",width:1,fill:"transparent"},handles:{size:6,fill:"#1677FF",stroke:"#1677FF"}},createPointFigures:({coordinates:o,overlay:e})=>{var oe,U,J,se,W,le,ye,Ce,Re,Ke,st,vt,Je,ot,nt,tt,Ze,ct;if(o.length===0)return[];const t=o[0],s=e.extendData||{},i=!!s.editing,r=s.text??"",a=s.fontSize??((U=(oe=e.styles)==null?void 0:oe.text)==null?void 0:U.size)??32,l=s.fontWeight??((se=(J=e.styles)==null?void 0:J.text)==null?void 0:se.weight)??"bold",c=s.fontFamily??((le=(W=e.styles)==null?void 0:W.text)==null?void 0:le.family)??Ay,d=s.textColor??((Ce=(ye=e.styles)==null?void 0:ye.text)==null?void 0:Ce.color)??"#FFFFFF",v=s.backgroundColor??((Ke=(Re=e.styles)==null?void 0:Re.text)==null?void 0:Ke.backgroundColor)??"#00000033",g=((vt=(st=e.styles)==null?void 0:st.text)==null?void 0:vt.paddingLeft)??8,_=((ot=(Je=e.styles)==null?void 0:Je.text)==null?void 0:ot.paddingRight)??8,y=((tt=(nt=e.styles)==null?void 0:nt.text)==null?void 0:tt.paddingTop)??4,k=((ct=(Ze=e.styles)==null?void 0:Ze.text)==null?void 0:ct.paddingBottom)??4;if(i)return[];if(!(r&&r.length>0&&r!=="Add text"))return[];const M=Math.round(a*1.4),I=String(r).split(/\r?\n/),C=I.map(Ge=>Ef.calcTextWidth(Ge,a,l,c)),z=C.length?Math.max(...C):Ef.calcTextWidth(r,a,l,c),j=(I.length||1)*M,B=z+g+_,$=j+y+k,F=B,V=$,K=t.x,Y=t.y-Math.round(V/2),Z=[];Z.push({type:"rect",attrs:{x:K,y:Y,width:F,height:V},styles:{style:Mm.Fill,color:v,borderColor:"transparent",borderSize:0}});const ne=K+Math.round(F/2),te=Y+y+Math.round(M/2);return I.forEach((Ge,pt)=>{const ce=te+pt*M;Z.push({type:"text",attrs:{x:ne,y:ce,text:Ge,align:"center",baseline:"middle"},styles:{size:a,family:c,weight:l,color:d,backgroundColor:"transparent"}})}),Z},onSelected:o=>{var t;const e=o.overlay.extendData||{};e.selected=!0,(t=o.chart)==null||t.overrideOverlay({id:o.overlay.id,extendData:e});try{typeof navigator<"u"&&(navigator.maxTouchPoints||0)>0&&o.chart&&Tm.startEditing(o.chart,o.overlay)}catch{}return!0},onDeselected:o=>{var t;const e=o.overlay.extendData||{};return e.selected=!1,(t=o.chart)==null||t.overrideOverlay({id:o.overlay.id,extendData:e}),!0},onPressedMoveStart:o=>{const e=o.overlay.extendData||{};if(e.editing||o.overlay.lock)return!1;const t=o.overlay.paneId;try{const s=o.chart.convertToPixel(o.overlay.points[0],{paneId:t});s&&typeof o.x=="number"&&typeof o.y=="number"&&(e.__dragOffX=o.x-(s.x||0),e.__dragOffY=o.y-(s.y||0),o.chart.overrideOverlay({id:o.overlay.id,extendData:e}))}catch{}return!0},onPressedMoving:o=>{const e=o.overlay.extendData||{};if(e.editing||o.overlay.lock)return!1;const t=e.__dragOffX||0,s=e.__dragOffY||0,i=o.overlay.paneId;if(typeof o.x!="number"||typeof o.y!="number")return!0;const r=o.x-t,a=o.y-s;try{const l=o.chart.convertFromPixel([{x:r,y:a}],{paneId:i}),c=Array.isArray(l)?l[0]:l;c&&o.chart.overrideOverlay({id:o.overlay.id,points:[{timestamp:c.timestamp,value:c.value}]})}catch{}return!0},onPressedMoveEnd:o=>{const e=o.overlay.extendData||{};if(e.editing||o.overlay.lock)return!1;if("__dragOffX"in e||"__dragOffY"in e){delete e.__dragOffX,delete e.__dragOffY;try{o.chart.overrideOverlay({id:o.overlay.id,extendData:e})}catch{}}return!0}};function dP(o,e){if(o.length>0){const t=o[0].y;return{coordinates:[{x:0,y:t},{x:e.width,y:t}]}}return{coordinates:[]}}function uP(o,e){if(o.length>1){const t=o[0].y,s=o[0],i=o[1];return s.x>i.x?{coordinates:[{x:0,y:t},s]}:{coordinates:[s,{x:e.width,y:t}]}}return{coordinates:[]}}const yx={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createPointFigures:({coordinates:o,overlay:e,bounding:t})=>{var a,l,c;if(o.length<1)return[];console.log("horizontalStraightLine createPointFigures called",{overlayId:e.id,hasExtendData:!!e.extendData,extendData:e.extendData,selected:e.selected===!0}),!e.extendData||typeof e.extendData!="object"?e.extendData={showDot:!1}:"showDot"in e.extendData||(e.extendData.showDot=!1);const s=e.extendData,i=[],r=dP(o,t);if(r.coordinates.length>0){i.push({type:"line",attrs:r,styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),i.push({type:"line",attrs:r});const d=e.selected===!0;if(s.showDot||d){const v=t.width/2,g=o[0].y,_=((l=(a=e.styles)==null?void 0:a.line)==null?void 0:l.color)||((c=e.styles)==null?void 0:c.color)||"#1677FF";console.log("Drawing dot for horizontalStraightLine:",{x:v,y:g,showDot:s.showDot,selected:d,color:_}),i.push({type:"circle",attrs:{x:v,y:g,r:6},styles:{style:"fill",color:_}}),i.push({type:"circle",attrs:{x:v,y:g,r:7},styles:{style:"stroke",color:"#ffffff",borderSize:2}})}}return i},createYAxisFigures:({chart:o,overlay:e,coordinates:t,yAxis:s,bounding:i})=>{var z,j,B,$,F,V;if(t.length<1||!e.points||e.points.length<1)return[];const r=(z=e.points[0])==null?void 0:z.value;if(r===void 0)return[];const a=o.getStyles(),l=a.yAxis,c=l.axisLine.show?l.axisLine.size:0,d=l.tickLine.show?l.tickLine.length:0,v=l.tickText.marginStart,g=l.tickText.marginEnd,_=1,k={...a.crosshair.horizontal.text};let S=0,M="left";if((j=s==null?void 0:s.isFromZero)!=null&&j.call(s))S=c+_,M="left",k.paddingLeft=d+v-_;else{S=((i==null?void 0:i.width)??0)-c-_,M="right";const K=((i==null?void 0:i.width)??0)-c-_,Y=((i==null?void 0:i.width)??0)-(l.axisLine.show?l.axisLine.size:0)-(l.tickLine.show?l.tickLine.length:0)-g;k.paddingRight=K-Y}const I=s.getRange();let C=s.displayValueToText(s.realValueToDisplayValue(s.valueToRealValue(r,{range:I}),{range:I}),((B=o.getSymbol())==null?void 0:B.pricePrecision)??2);C=o.getDecimalFold().format(o.getThousandsSeparator().format(C));const T=((F=($=e.styles)==null?void 0:$.line)==null?void 0:F.color)||((V=e.styles)==null?void 0:V.color)||"#1677FF";return[{type:"text",attrs:{x:S,y:t[0].y,text:C,align:M,baseline:"middle"},styles:{...k,backgroundColor:T},ignoreEvent:!0}]},onClick:o=>{console.log("🟢 horizontalStraightLine onClick called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!e.showDot,console.log("✅ Toggled showDot to:",e.showDot,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onSelected:o=>{console.log("🟢 horizontalStraightLine onSelected called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!0,console.log("✅ Set showDot to true:",e,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onDeselected:o=>{console.log("🔴 horizontalStraightLine onDeselected called"),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!1,o.chart&&o.chart.overrideOverlay({id:o.overlay.id,extendData:e}),!0}},bx={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createPointFigures:({coordinates:o,overlay:e,bounding:t})=>{var a,l,c;if(o.length<2)return[];console.log("horizontalRayLine createPointFigures called",{overlayId:e.id,hasExtendData:!!e.extendData,extendData:e.extendData,selected:e.selected===!0}),!e.extendData||typeof e.extendData!="object"?e.extendData={showDot:!1}:"showDot"in e.extendData||(e.extendData.showDot=!1);const s=e.extendData,i=[],r=uP(o,t);if(r.coordinates.length>0){i.push({type:"line",attrs:r,styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),i.push({type:"line",attrs:r});const d=e.selected===!0;if(s.showDot||d){const v=o[0].x,g=o[0].y,_=((l=(a=e.styles)==null?void 0:a.line)==null?void 0:l.color)||((c=e.styles)==null?void 0:c.color)||"#1677FF";console.log("Drawing dot for horizontalRayLine:",{x:v,y:g,showDot:s.showDot,selected:d,color:_}),i.push({type:"circle",attrs:{x:v,y:g,r:6},styles:{style:"fill",color:_}}),i.push({type:"circle",attrs:{x:v,y:g,r:7},styles:{style:"stroke",color:"#ffffff",borderSize:2}})}}return i},createYAxisFigures:({chart:o,overlay:e,coordinates:t,yAxis:s,bounding:i})=>{var z,j,B,$,F,V;if(t.length<1||!e.points||e.points.length<1)return[];const r=(z=e.points[0])==null?void 0:z.value;if(r===void 0)return[];const a=o.getStyles(),l=a.yAxis,c=l.axisLine.show?l.axisLine.size:0,d=l.tickLine.show?l.tickLine.length:0,v=l.tickText.marginStart,g=l.tickText.marginEnd,_=1,k={...a.crosshair.horizontal.text};let S=0,M="left";if((j=s==null?void 0:s.isFromZero)!=null&&j.call(s))S=c+_,M="left",k.paddingLeft=d+v-_;else{S=((i==null?void 0:i.width)??0)-c-_,M="right";const K=((i==null?void 0:i.width)??0)-c-_,Y=((i==null?void 0:i.width)??0)-(l.axisLine.show?l.axisLine.size:0)-(l.tickLine.show?l.tickLine.length:0)-g;k.paddingRight=K-Y}const I=s.getRange();let C=s.displayValueToText(s.realValueToDisplayValue(s.valueToRealValue(r,{range:I}),{range:I}),((B=o.getSymbol())==null?void 0:B.pricePrecision)??2);C=o.getDecimalFold().format(o.getThousandsSeparator().format(C));const T=((F=($=e.styles)==null?void 0:$.line)==null?void 0:F.color)||((V=e.styles)==null?void 0:V.color)||"#1677FF";return[{type:"text",attrs:{x:S,y:t[0].y,text:C,align:M,baseline:"middle"},styles:{...k,backgroundColor:T},ignoreEvent:!0}]},onClick:o=>{console.log("🟢 horizontalRayLine onClick called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!e.showDot,console.log("✅ Toggled showDot to:",e.showDot,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onSelected:o=>{console.log("🟢 horizontalRayLine onSelected called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!0,console.log("✅ Set showDot to true:",e,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onDeselected:o=>{console.log("🔴 horizontalRayLine onDeselected called"),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!1,o.chart&&o.chart.overrideOverlay({id:o.overlay.id,extendData:e}),!0}};function pP(o,e,t,s,i,r,a){const l=s*.4,c=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.lineJoin="round",o.beginPath(),o.moveTo(e-l,t-c),o.lineTo(e+l,t+c),o.moveTo(e+l,t-c),o.lineTo(e-l,t+c),o.stroke(),o.restore()}function vP(o,e,t,s,i,r,a){const l=s*.4,c=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.beginPath(),o.ellipse(e,t,l,c,0,0,Math.PI*2),o.stroke(),o.restore()}const xx={name:"pointAndFigure",totalStep:0,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createPointFigures:()=>[],draw:o=>{var I,C,T;const{ctx:e,chart:t,bounding:s,xAxis:i,yAxis:r,overlay:a}=o;if(!t||!e||!(i!=null&&i.convertToPixel)||!(r!=null&&r.convertToPixel))return[];const l=(I=t.getVisibleRange)==null?void 0:I.call(t);if(!l)return[];const c=((C=t.getDataList)==null?void 0:C.call(t))||[];if(c.length===0)return[];const d=i.convertToPixel(0),v=i.convertToPixel(1),g=Math.max(1,Math.abs(v-d));let _=g;for(let z=l.from;z<=l.to&&z<c.length;z++){const j=(T=c[z])==null?void 0:T._pnf;if(j!=null&&j.boxes&&j.boxes.length>=2){const B=r.convertToPixel(j.boxes[0].price),$=r.convertToPixel(j.boxes[1].price);if(B!==void 0&&$!==void 0&&!isNaN(B)&&!isNaN($)){const F=Math.abs(B-$);if(F>0){_=F;break}}}}const y=g*.85,k=_*.85,S=(y+k)/2,M=Math.max(.8,S*.08);for(let z=l.from;z<=l.to&&z<c.length;z++){const j=c[z];if(!j)continue;const B=j==null?void 0:j._pnf;if(!B||!B.boxes)continue;const{direction:$,boxes:F,upColor:V="#00E6D8",downColor:K="#FF4D4D"}=B,Y=i.convertToPixel(z);if(!(Y==null||isNaN(Y)))for(const Z of F){const ne=r.convertToPixel(Z.price);ne==null||isNaN(ne)||($==="up"?pP(e,Y,ne,y,k,V,M):vP(e,Y,ne,y,k,K,M))}}return[]}},wx={name:"script-layer",totalStep:0,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,styles:{},createPointFigures:()=>[]},fP=[Zb,Xb,Jb,ex,Qb,tx,ox,sx,nx,ix,rx,ax,lx,cx,dx,ux,px,vx,fx,mx,gx,hx,_x,yx,bx,xx,wx],mP={arrow:Zb,circle:Xb,rect:Jb,triangle:ex,parallelogram:Qb,fibonacciCircle:tx,fibonacciSegment:ox,fibonacciSpiral:sx,fibonacciSpeedResistanceFan:nx,fibonacciExtension:ix,gannBox:rx,threeWaves:ax,fiveWaves:lx,eightWaves:cx,anyWaves:dx,abcd:ux,xabcd:px,barSignal:vx,ruler:fx,trade:mx,note:gx,emoji:hx,text:_x,horizontalStraightLine:yx,horizontalRayLine:bx,pointAndFigure:xx,scriptLayer:wx};function kx(o,e,t){const{size:s=12,paddingLeft:i=0,paddingTop:r=0,paddingRight:a=0,paddingBottom:l=0}=e,{x:c,y:d,text:v,align:g="left",baseline:_="top"}=o;t=t??s*v.length;let y;switch(g){case"left":case"start":{y=c;break}case"right":case"end":{y=c-a-t-i;break}default:{y=c-t/2-i;break}}return y}function Sx(o,e,t,s,i){const{size:r=12,paddingLeft:a=0,paddingTop:l=0,paddingRight:c=0,paddingBottom:d=0}=e,{x:v,y:g,text:_,align:y="left",baseline:k="top"}=o,S=_.length;t=t??r*S,s=s??1,i=i??1.5;const M=r*s*i-(i-1)*r,I=kx(o,e,t);let C;switch(k){case"top":case"hanging":{C=g;break}case"bottom":case"ideographic":case"alphabetic":{C=g-M-l-d;break}default:{C=g-M/2-l;break}}return{x:I,y:C,width:a+t+c,height:l+M+d}}const Cx=Ef.calcTextWidth;function gP(o,e,t){return`${e??"normal"} ${o??12}px ${t??"Helvetica Neue"}`}function hP(o){return typeof o=="string"}function Ly(o){return o==="transparent"||o==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(o)||/^[hH][Ss][Ll][Aa]\(([\s]*(360｜3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(o)}function _P(o,e,t){let s=[];s=s.concat(e);const{style:i=Mm.Fill,color:r="transparent",borderSize:a=1,borderColor:l="transparent",borderStyle:c=Oe.Solid,borderRadius:d=0,borderDashedValue:v=[2,2]}=t,g=o.roundRect??o.rect,_=(i===Mm.Fill||t.style===Mm.StrokeFill)&&(!hP(r)||!Ly(r));if(_&&(o.fillStyle=r,s.forEach(({x:y,y:k,width:S,height:M})=>{o.beginPath(),g.call(o,y,k,S,M,d),o.closePath(),o.fill()})),(i===Mm.Stroke||t.style===Mm.StrokeFill)&&a>0&&!Ly(l)){o.strokeStyle=l,o.fillStyle=l,o.lineWidth=a,c===Oe.Dashed?o.setLineDash(v):o.setLineDash([]);const y=a%2===1?.5:0,k=Math.round(y*2);s.forEach(({x:S,y:M,width:I,height:C})=>{I>a*2&&C>a*2?(o.beginPath(),g.call(o,S+y,M+y,I-k,C-k,d),o.closePath(),o.stroke()):_||o.fillRect(S,M,I,C)})}}function yP(o,e,t){const{text:s}=e,{size:i=12,family:r,weight:a,paddingLeft:l=0,paddingTop:c=0,paddingRight:d=0}=t,v=s.split(`
`),g=v.map(I=>Cx(I,i,a,r)),_=1.5,y=i*_,k=Math.max(...g),S=Sx(e,t,k,v.length,_);_P(o,S,{...t,color:t.backgroundColor});let M=S.y+c;v.forEach((I,C)=>{const T=kx(e,t,g[C])+l;o.textAlign="left",o.textBaseline="top",o.font=gP(i,a,r),o.fillStyle=t.color||"currentColor",o.fillText(I,T,M,S.width-l-d),M+=y})}function bP(o,e,t){const{size:s=12,family:i,weight:r,paddingLeft:a=0,paddingTop:l=0}=t,c=e.text.split(`
`),d=c.map(M=>Cx(M,s,r,i)),v=1.5,g=Math.max(...d),{x:_,y,width:k,height:S}=Sx(e,t,g,c.length,v);return o.x>=_&&o.x<=_+k&&o.y>=y&&o.y<=y+S}const xP={name:"textBox",checkEventOn:(o,e,t)=>bP(o,e,t),draw:(o,e,t)=>{yP(o,e,t)}},wP=[xP],kP={name:"BIAS",shortName:"BIAS",precision:2,calcParams:[6],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"bias",title:"BIAS: ",type:"line"}],styles:{lines:[{color:"#2196F3",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||6;return o.reduce((s,i,r)=>{if(r>=t-1){let a=0;for(let c=r-t+1;c<=r;c++)a+=o[c].close;const l=a/t;s[i.timestamp]={bias:(i.close-l)/l*100}}else s[i.timestamp]={};return s},{})}},SP={name:"CCI",shortName:"CCI",precision:2,calcParams:[20],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"cci",title:"CCI: ",type:"line"}],minValue:void 0,maxValue:void 0,styles:{lines:[{color:"#2563eb",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s]=t;return o.reduce((i,r,a)=>(i[r.timestamp]={cci:CP(o,a,s)},i),{})}};function CP(o,e,t){if(e<t-1)return null;const s=[];for(let d=e-t+1;d<=e;d++){const v=o[d],g=(v.high+v.low+v.close)/3;s.push(g)}const i=s.reduce((d,v)=>d+v,0)/t,r=s.reduce((d,v)=>d+Math.abs(v-i),0)/t;if(r===0)return 0;const a=o[e];return((a.high+a.low+a.close)/3-i)/(.015*r)}const PP={name:"ICHIMOKU",shortName:"ICHIMOKU",precision:4,calcParams:[9,26,52],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"tenkan",title:"Tenkan: ",type:"line"},{key:"kijun",title:"Kijun: ",type:"line"},{key:"senkouA",title:"Senkou A: ",type:"line"},{key:"senkouB",title:"Senkou B: ",type:"line"},{key:"chikou",title:"Chikou: ",type:"line"}],styles:{lines:[{color:"#FF6B6B",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#4ECDC4",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#45B7D1",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#FFA07A",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#9B59B6",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||9,s=e.calcParams[1]||26,i=e.calcParams[2]||52,r=s,a=[],l=(d,v)=>{let g=-1/0,_=1/0;for(let y=d;y<d+v&&y<o.length;y++)o[y].high>g&&(g=o[y].high),o[y].low<_&&(_=o[y].low);return{high:g,low:_}};for(let d=0;d<o.length;d++){const v={};if(d>=t-1){const{high:g,low:_}=l(d-t+1,t);v.tenkan=(g+_)/2}if(d>=s-1){const{high:g,low:_}=l(d-s+1,s);v.kijun=(g+_)/2}if(d>=s-1){const g=d,_=d;if(g>=t-1&&_>=s-1){const{high:y,low:k}=l(g-t+1,t),{high:S,low:M}=l(_-s+1,s),I=(y+k)/2,C=(S+M)/2;v.senkouA=(I+C)/2}}if(d>=i-1){const{high:g,low:_}=l(d-i+1,i);v.senkouB=(g+_)/2}v.chikou=o[d].close,a.push(v)}const c=a.map((d,v)=>{var _,y,k;const g={...d};return v>=r?(g.senkouA=(_=a[v-r])==null?void 0:_.senkouA,g.senkouB=(y=a[v-r])==null?void 0:y.senkouB):(g.senkouA=void 0,g.senkouB=void 0),v+r<a.length?g.chikou=(k=o[v+r])==null?void 0:k.close:g.chikou=void 0,g});return o.reduce((d,v,g)=>(d[v.timestamp]=c[g],d),{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var _;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:c,to:d}=l,v=t.result;o.save();const g=[];for(let y=c;y<d;y++){const k=(_=a[y])==null?void 0:_.timestamp,S=v[k];if(S&&S.senkouA!==void 0&&S.senkouB!==void 0){const M=i.convertToPixel(y),I=r.convertToPixel(S.senkouA),C=r.convertToPixel(S.senkouB);g.push({x:M,yA:I,yB:C})}}if(g.length>1){o.globalAlpha=.2;const y=g[0].yA<g[0].yB;o.fillStyle=y?"#4CAF50":"#F44336",o.beginPath(),o.moveTo(g[0].x,Math.min(g[0].yA,g[0].yB));for(let k=1;k<g.length;k++)o.lineTo(g[k].x,Math.min(g[k].yA,g[k].yB));for(let k=g.length-1;k>=0;k--)o.lineTo(g[k].x,Math.max(g[k].yA,g[k].yB));o.closePath(),o.fill()}return o.restore(),!1}},IP={name:"PVT",shortName:"PVT",precision:2,calcParams:[],shouldOhlc:!1,shouldFormatBigNumber:!0,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"pvt",title:"PVT: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t={};if(o.length===0)return t;let s=0;for(let i=0;i<o.length;i++){const r=o[i];if(i===0){t[r.timestamp]={pvt:0};continue}const a=o[i-1];if(r.close==null||a.close==null||r.volume==null||r.close<=0||a.close<=0){t[r.timestamp]={};continue}const l=(r.close-a.close)/a.close,c=s+(r.volume||0)*l;t[r.timestamp]={pvt:c},s=c}return t}},pp=new Map,uh=o=>({id:o,period:14,lineColor:"#8B5CF6",lineThickness:2,lineStyle:"solid",overboughtLevel:70,oversoldLevel:30,middleLevel:50,overboughtColor:"#EF4444",overboughtThickness:1,overboughtLineStyle:"dashed",oversoldColor:"#22C55E",oversoldThickness:1,oversoldLineStyle:"dashed",overboughtFillColor:"#EF4444",oversoldFillColor:"#22C55E",middleLineColor:"#6B7280",middleLineThickness:1,middleLineStyle:"dashed",fillOpacity:.15,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:70,color:"#EF4444",lineStyle:"dashed",thickness:1,label:"70",visible:!0},{id:"middle",value:50,color:"#6B7280",lineStyle:"dashed",thickness:1,label:"50",visible:!0},{id:"oversold",value:30,color:"#22C55E",lineStyle:"dashed",thickness:1,label:"30",visible:!0}]}),MP=(o,e)=>{const t=[];if(o.length<e+1)return o.map(()=>NaN);let s=[],i=[];for(let d=1;d<=e;d++){const v=o[d].close-o[d-1].close;s.push(v>0?v:0),i.push(v<0?Math.abs(v):0)}let r=s.reduce((d,v)=>d+v,0)/e,a=i.reduce((d,v)=>d+v,0)/e;for(let d=0;d<e;d++)t.push(NaN);let l=r/(a||1e-4),c=100-100/(1+l);t.push(c);for(let d=e+1;d<o.length;d++){const v=o[d].close-o[d-1].close,g=v>0?v:0,_=v<0?Math.abs(v):0;r=(r*(e-1)+g)/e,a=(a*(e-1)+_)/e,l=r/(a||1e-4),c=100-100/(1+l),t.push(c)}return t};function TP(o){if(!o)return null;const e=o.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i);if(e)return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)};const t=o.match(/^#?([a-f\d])([a-f\d])([a-f\d])$/i);if(t)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16)};const s=o.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*[\d.]+\s*)?\)/i);return s?{r:parseInt(s[1],10),g:parseInt(s[2],10),b:parseInt(s[3],10)}:null}function Vg(o,e,t,s,i){if(e<=i&&s>=i||e>=i&&s<=i){if(e===s)return null;const r=(i-e)/(s-e);return{x:o+r*(t-o),y:i}}return null}const Px={name:"RSI",shortName:"RSI",precision:2,calcParams:[14],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:0,maxValue:100,figures:[{key:"rsi",title:"RSI: ",type:"line"}],styles:{lines:[{color:"#8B5CF6",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||14,s=MP(o,t);return o.reduce((i,r,a)=>{const l=s[a];return i[r.timestamp]={rsi:isNaN(l)?null:l},i},{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var k,S,M,I;const a=t.paneId||"default";let l=pp.get(a);l||(l=uh(a),pp.set(a,l));const{left:c,width:d}=s,v=e.getVisibleRange(),g=e.getDataList();o.save();const _=r.convertToPixel(l.overboughtLevel),y=r.convertToPixel(l.oversoldLevel);if(l.showFill){const C=[],T=[];let z=!1,j=!1;for(let B=v.from;B<=v.to;B++){const $=(k=g[B])==null?void 0:k.timestamp,F=t.result[$];if(!F||F.rsi===null||F.rsi===void 0)continue;const V=i.convertToPixel(B),K=r.convertToPixel(F.rsi);if(V===null||K===null)continue;const Y=(S=g[B-1])==null?void 0:S.timestamp,Z=B>0?t.result[Y]:null,ne=Z==null?void 0:Z.rsi,te=B>0?i.convertToPixel(B-1):null,oe=ne!=null?r.convertToPixel(ne):null;if(F.rsi>l.overboughtLevel){if(!z&&(z=!0,te!==null&&oe!==null&&ne!==null&&ne!==void 0&&ne<=l.overboughtLevel)){const U=Vg(te,oe,V,K,_);U&&(C.push({x:U.x,y:_}),U.x)}C.push({x:V,y:K})}else if(z){if(te!==null&&oe!==null&&ne!==null&&ne!==void 0){const U=Vg(te,oe,V,K,_);U&&C.push({x:U.x,y:_})}C.length>=2&&Wg(o,C,_,l.overboughtFillColor,l.fillOpacity,"above"),C.length=0,z=!1}if(F.rsi<l.oversoldLevel){if(!j&&(j=!0,te!==null&&oe!==null&&ne!==null&&ne!==void 0&&ne>=l.oversoldLevel)){const U=Vg(te,oe,V,K,y);U&&(T.push({x:U.x,y}),U.x)}T.push({x:V,y:K})}else if(j){if(te!==null&&oe!==null&&ne!==null&&ne!==void 0){const U=Vg(te,oe,V,K,y);U&&T.push({x:U.x,y})}T.length>=2&&Wg(o,T,y,l.oversoldFillColor,l.fillOpacity,"below"),T.length=0,j=!1}}z&&C.length>=2&&Wg(o,C,_,l.overboughtFillColor,l.fillOpacity,"above"),j&&T.length>=2&&Wg(o,T,y,l.oversoldFillColor,l.fillOpacity,"below")}l.showLevels&&l.levels.forEach(C=>{if(!C.visible)return;const T=r.convertToPixel(C.value);if(T===null)return;o.save(),o.strokeStyle=C.color;let z=1,j="dashed";C.id==="overbought"?(z=l.overboughtThickness??1,j=l.overboughtLineStyle??"dashed"):C.id==="oversold"?(z=l.oversoldThickness??1,j=l.oversoldLineStyle??"dashed"):C.id==="middle"&&(z=l.middleLineThickness??1,j=l.middleLineStyle??"dashed"),z=Math.max(1,Math.round(z)),o.lineWidth=z;const B=z%2===1?Math.floor(T)+.5:Math.round(T);j==="dashed"?o.setLineDash([6*z,4*z]):j==="dotted"?o.setLineDash([z,z*2]):o.setLineDash([]),o.beginPath(),o.moveTo(Math.floor(c),B),o.lineTo(Math.floor(c+d),B),o.stroke(),o.restore()}),o.lineCap="round",o.lineJoin="round";for(let C=v.from;C<v.to;C++){const T=(M=g[C])==null?void 0:M.timestamp,z=(I=g[C+1])==null?void 0:I.timestamp,j=t.result[T],B=t.result[z];if(!j||!B||j.rsi===null||j.rsi===void 0||B.rsi===null||B.rsi===void 0)continue;const $=i.convertToPixel(C),F=i.convertToPixel(C+1),V=r.convertToPixel(j.rsi),K=r.convertToPixel(B.rsi);if($===null||F===null||V===null||K===null)continue;let Y=l.lineColor;j.rsi>l.overboughtLevel?Y=l.overboughtColor:j.rsi<l.oversoldLevel&&(Y=l.oversoldColor),o.strokeStyle=Y,o.lineWidth=l.lineThickness,l.lineStyle==="dashed"?o.setLineDash([6,4]):l.lineStyle==="dotted"?o.setLineDash([2,2]):o.setLineDash([]),o.beginPath(),o.moveTo($,V),o.lineTo(F,K),o.stroke()}return o.restore(),!0}};function Wg(o,e,t,s,i,r){if(e.length<2)return;o.save();let a=TP(s);a||(a=r==="above"?{r:239,g:68,b:68}:{r:34,g:197,b:94});const l=Math.min(...e.map(v=>v.y)),c=Math.max(...e.map(v=>v.y));let d;r==="above"?(d=o.createLinearGradient(0,t,0,l),d.addColorStop(0,`rgba(${a.r}, ${a.g}, ${a.b}, 0.02)`),d.addColorStop(.5,`rgba(${a.r}, ${a.g}, ${a.b}, ${i*.5})`),d.addColorStop(1,`rgba(${a.r}, ${a.g}, ${a.b}, ${i})`)):(d=o.createLinearGradient(0,t,0,c),d.addColorStop(0,`rgba(${a.r}, ${a.g}, ${a.b}, 0.02)`),d.addColorStop(.5,`rgba(${a.r}, ${a.g}, ${a.b}, ${i*.5})`),d.addColorStop(1,`rgba(${a.r}, ${a.g}, ${a.b}, ${i})`)),o.fillStyle=d,o.beginPath(),o.moveTo(e[0].x,e[0].y);for(let v=1;v<e.length;v++)o.lineTo(e[v].x,e[v].y);o.lineTo(e[e.length-1].x,t),o.lineTo(e[0].x,t),o.closePath(),o.fill(),o.restore()}const of={createInstance:(o,e)=>{const t=uh(o);return e&&(e.levels&&(t.levels=e.levels),Object.keys(e).forEach(s=>{s!=="levels"&&e[s]!==void 0&&(t[s]=e[s])})),pp.set(o,t),t},getInstance:o=>pp.get(o),getInstanceConfig:o=>pp.get(o)||null,updateInstance:(o,e)=>{const t=pp.get(o);if(!t){const s=uh(o);return Object.assign(s,e),pp.set(o,s),!0}return e.levels&&(t.levels=e.levels),Object.keys(e).forEach(s=>{s!=="levels"&&e[s]!==void 0&&(t[s]=e[s])}),pp.set(o,t),!0},deleteInstance:o=>pp.delete(o),getAllInstances:()=>new Map(pp),clearAllInstances:()=>{pp.clear()},resetInstance:o=>{const e=uh(o);pp.set(o,e)},exportInstanceConfig:o=>pp.get(o)||null,importInstanceConfig:o=>{try{if(!o||!o.id)return!1;const e={id:o.id,period:o.period??14,lineColor:o.lineColor??"#8B5CF6",lineThickness:o.lineThickness??2,lineStyle:o.lineStyle??"solid",overboughtLevel:o.overboughtLevel??70,oversoldLevel:o.oversoldLevel??30,middleLevel:o.middleLevel??50,overboughtColor:o.overboughtColor??"#EF4444",overboughtThickness:o.overboughtThickness??1,overboughtLineStyle:o.overboughtLineStyle??"dashed",oversoldColor:o.oversoldColor??"#22C55E",oversoldThickness:o.oversoldThickness??1,oversoldLineStyle:o.oversoldLineStyle??"dashed",overboughtFillColor:o.overboughtFillColor??o.overboughtColor??"#EF4444",oversoldFillColor:o.oversoldFillColor??o.oversoldColor??"#22C55E",middleLineColor:o.middleLineColor??"#6B7280",middleLineThickness:o.middleLineThickness??1,middleLineStyle:o.middleLineStyle??"dashed",fillOpacity:o.fillOpacity??.15,showLevels:o.showLevels??!0,showFill:o.showFill??!0,levels:o.levels??[{id:"overbought",value:o.overboughtLevel??70,color:o.overboughtColor??"#EF4444",lineStyle:o.overboughtLineStyle??"dashed",thickness:o.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:o.middleLevel??50,color:o.middleLineColor??"#6B7280",lineStyle:o.middleLineStyle??"dashed",thickness:o.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:o.oversoldLevel??30,color:o.oversoldColor??"#22C55E",lineStyle:o.oversoldLineStyle??"dashed",thickness:o.oversoldThickness??1,label:"30",visible:!0}]};return pp.set(o.id,e),!0}catch(e){return console.error("Failed to import RSI instance config:",e),!1}},updateLevel:(o,e,t)=>{const s=pp.get(o);if(!s)return!1;const i=s.levels.find(r=>r.id===e);return i?(Object.assign(i,t),e==="overbought"&&t.value!==void 0?s.overboughtLevel=t.value:e==="oversold"&&t.value!==void 0?s.oversoldLevel=t.value:e==="middle"&&t.value!==void 0&&(s.middleLevel=t.value),!0):!1},addLevel:(o,e)=>{const t=pp.get(o);if(!t)throw new Error(`RSI instance ${o} not found`);const s=`level_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={...e,id:s,value:Math.max(0,Math.min(100,e.value))};return t.levels.push(i),s},removeLevel:(o,e)=>{const t=pp.get(o);if(!t)return!1;const s=t.levels.findIndex(i=>i.id===e);return s===-1?!1:(t.levels.splice(s,1),!0)}},zy=Object.freeze(Object.defineProperty({__proto__:null,RSIManager:of,rsi:Px},Symbol.toStringTag,{value:"Module"})),AP={name:"SAR",shortName:"SAR",precision:4,calcParams:[.02,.02,.2],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"sar",title:"SAR: ",type:"line"}],styles:{lines:[{color:"#2563eb",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||.02,s=e.calcParams[1]||.02,i=e.calcParams[2]||.2,r={};if(o.length<2)return o.map(()=>({}));let a=!0,l=t,c=o[0].high,d=o[0].low;r[o[0].timestamp]={sar:d};for(let v=1;v<o.length;v++){const g=o[v],_=o[v-1];a?(d=d+l*(c-d),d=Math.min(d,g.low,_.low),g.low<=d?(a=!1,d=c,c=g.low,l=t):g.high>c&&(c=g.high,l=Math.min(l+s,i))):(d=d-l*(d-c),d=Math.max(d,g.high,_.high),g.high>=d?(a=!0,d=c,c=g.high,l=t):g.low<c&&(c=g.low,l=Math.min(l+s,i))),r[o[v].timestamp]={sar:d}}return r},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var _,y,k;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:c,to:d}=l;o.save();const v=((y=(_=t.styles)==null?void 0:_.lines)==null?void 0:y[0])||{color:"#2563eb",size:1},g=v.size||1;for(let S=c;S<=d;S++){const M=(k=a[S])==null?void 0:k.timestamp,I=t.result[M];if(!I||typeof I.sar!="number")continue;const C=i.convertToPixel(S),T=r.convertToPixel(I.sar);C>=s.left&&C<=s.left+s.width&&T>=s.top&&T<=s.top+s.height&&(o.beginPath(),o.arc(C,T,g,0,2*Math.PI),o.fillStyle=v.color,o.fill(),o.strokeStyle=v.color,o.lineWidth=1,o.stroke())}return o.restore(),!0}},qu=new Map,v1=o=>({id:o,period:14,lineColor:"#2563eb",lineThickness:1,lineStyle:"solid",showLevels:!0,showZones:!0,yAxisSync:!0,enableDynamicColoring:!0,overboughtColor:"#EF4444",oversoldColor:"#10B981",overboughtThreshold:-20,oversoldThreshold:-80,levels:[{id:"overbought",value:-20,color:"#EF4444",lineStyle:"solid",thickness:1,label:"Overbought",visible:!0},{id:"middle",value:-50,color:"#6B7280",lineStyle:"dashed",thickness:1,label:"Middle",visible:!0},{id:"oversold",value:-80,color:"#10B981",lineStyle:"solid",thickness:1,label:"Oversold",visible:!0}],zones:[{id:"overbought_zone",topLevel:0,bottomLevel:-20,fillColor:"#EF4444",fillOpacity:.1,visible:!0,type:"overbought"},{id:"oversold_zone",topLevel:-80,bottomLevel:-100,fillColor:"#10B981",fillOpacity:.1,visible:!0,type:"oversold"}]}),LP=(o,e)=>{const t=[];if(o.length<e)return o.map(()=>NaN);for(let s=0;s<o.length;s++){if(s<e-1){t.push(NaN);continue}let i=o[s-e+1].high,r=o[s-e+1].low;for(let c=s-e+2;c<=s;c++)o[c].high>i&&(i=o[c].high),o[c].low<r&&(r=o[c].low);const a=o[s].close,l=(i-a)/(i-r)*-100;t.push(isNaN(l)?0:l)}return t},zP={name:"WR",shortName:"WR",precision:2,calcParams:[14],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:-100,maxValue:0,figures:[{key:"wr",title:"WR: ",type:"line"}],styles:{lines:[{color:"#2563eb",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||14,s=LP(o,t);return o.reduce((i,r,a)=>{const l=s[a];return i[r.timestamp]={wr:isNaN(l)?null:l},i},{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var y,k;const a=t.paneId||"default";let l=qu.get(a);l||(l=v1(a),qu.set(a,l));const{left:c,top:d,width:v,height:g}=s,_=e.getVisibleRange();if(o.save(),l.showZones&&l.zones.forEach(S=>{if(!S.visible)return;const M=r.convertToPixel(S.topLevel),I=r.convertToPixel(S.bottomLevel);if(M!==null&&I!==null){o.save();const C=Math.abs(M-I),T=Math.min(M,I),z=o.createLinearGradient(c,T,c,T+C),B=S.fillColor.match(/\w\w/g);if(B){const $=parseInt(B[0],16),F=parseInt(B[1],16),V=parseInt(B[2],16);z.addColorStop(0,`rgba(${$}, ${F}, ${V}, ${S.fillOpacity*.8})`),z.addColorStop(.3,`rgba(${$}, ${F}, ${V}, ${S.fillOpacity*.6})`),z.addColorStop(.7,`rgba(${$}, ${F}, ${V}, ${S.fillOpacity*.3})`),z.addColorStop(1,`rgba(${$}, ${F}, ${V}, ${S.fillOpacity*.1})`)}else z.addColorStop(0,S.fillColor+Math.floor(S.fillOpacity*255).toString(16).padStart(2,"0")),z.addColorStop(.5,S.fillColor+Math.floor(S.fillOpacity*128).toString(16).padStart(2,"0")),z.addColorStop(1,S.fillColor+Math.floor(S.fillOpacity*32).toString(16).padStart(2,"0"));o.fillStyle=z,o.fillRect(c,T,v,C),o.strokeStyle=S.fillColor+"40",o.lineWidth=.5,o.strokeRect(c,T,v,C),o.restore()}}),l.showLevels&&l.levels.forEach(S=>{if(!S.visible)return;const M=r.convertToPixel(S.value);M!==null&&(o.save(),o.strokeStyle=S.color,o.lineWidth=S.thickness,S.lineStyle==="dashed"?o.setLineDash([4,4]):S.lineStyle==="dotted"?o.setLineDash([2,2]):o.setLineDash([]),o.beginPath(),o.moveTo(c,M),o.lineTo(c+v,M),o.stroke(),l.yAxisSync&&(o.font="11px Arial",o.textAlign="left",o.fillStyle=S.color,o.fillText(`WR ${S.value}`,c+v+5,M+4)),o.restore())}),l.enableDynamicColoring&&t.result){const{from:S,to:M}=_,I=e.getDataList();for(let C=S;C<M;C++){const T=(y=I[C])==null?void 0:y.timestamp,z=(k=t.result[T])==null?void 0:k.wr;if(z!=null){const j=i.convertToPixel(C),B=r.convertToPixel(z);if(j!==null&&B!==null){o.save();let $=l.lineColor;z>l.overboughtThreshold?$=l.overboughtColor:z<l.oversoldThreshold&&($=l.oversoldColor),o.fillStyle=$,o.beginPath(),o.arc(j,B,1,0,2*Math.PI),o.fill(),o.restore()}}}}return o.restore(),!1}},T_={createInstance:(o,e)=>{const t=v1(o);return e&&Object.assign(t,e),qu.set(o,t),t},getInstance:o=>qu.get(o),updateInstance:(o,e)=>{const t=qu.get(o);return t?(Object.assign(t,e),qu.set(o,t),!0):!1},deleteInstance:o=>qu.delete(o),addLevel:(o,e)=>{const t=qu.get(o);if(!t)throw new Error(`WR instance ${o} not found`);const s=`level_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={...e,id:s,value:Math.max(-100,Math.min(0,e.value))};return t.levels.push(i),s},removeLevel:(o,e)=>{const t=qu.get(o);if(!t)return!1;const s=t.levels.findIndex(i=>i.id===e);return s===-1?!1:(t.levels.splice(s,1),!0)},updateLevel:(o,e,t)=>{const s=qu.get(o);if(!s)return!1;const i=s.levels.find(r=>r.id===e);return i?(t.value!==void 0&&(t.value=Math.max(-100,Math.min(0,t.value))),t.thickness!==void 0&&(t.thickness=Math.max(1,Math.min(5,t.thickness))),Object.assign(i,t),!0):!1},addZone:(o,e)=>{const t=qu.get(o);if(!t)throw new Error(`WR instance ${o} not found`);const s=Math.max(-100,Math.min(0,Math.max(e.topLevel,e.bottomLevel))),i=Math.max(-100,Math.min(0,Math.min(e.topLevel,e.bottomLevel))),r=`zone_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,a={...e,id:r,topLevel:s,bottomLevel:i,fillOpacity:Math.max(0,Math.min(1,e.fillOpacity||.15))};return t.zones.push(a),r},removeZone:(o,e)=>{const t=qu.get(o);if(!t)return!1;const s=t.zones.findIndex(i=>i.id===e);return s===-1?!1:(t.zones.splice(s,1),!0)},updateZone:(o,e,t)=>{const s=qu.get(o);if(!s)return!1;const i=s.zones.find(r=>r.id===e);if(!i)return!1;if(t.topLevel!==void 0&&(t.topLevel=Math.max(-100,Math.min(0,t.topLevel))),t.bottomLevel!==void 0&&(t.bottomLevel=Math.max(-100,Math.min(0,t.bottomLevel))),t.fillOpacity!==void 0&&(t.fillOpacity=Math.max(0,Math.min(1,t.fillOpacity))),Object.assign(i,t),i.topLevel<i.bottomLevel){const r=i.topLevel;i.topLevel=i.bottomLevel,i.bottomLevel=r}return!0},getInstanceConfig:o=>qu.get(o)||null,resetInstance:o=>{const e=v1(o);qu.set(o,e)},exportInstanceConfig:o=>{const e=qu.get(o);return e?{id:o,period:e.period,lineColor:e.lineColor,lineThickness:e.lineThickness,lineStyle:e.lineStyle,showLevels:e.showLevels,showZones:e.showZones,yAxisSync:e.yAxisSync,levels:e.levels.map(t=>({...t})),zones:e.zones.map(t=>({...t}))}:null},importInstanceConfig:o=>{try{const e={id:o.id,period:o.period||14,lineColor:o.lineColor||"#FF6B35",lineThickness:o.lineThickness||2,lineStyle:o.lineStyle||"solid",showLevels:o.showLevels??!0,showZones:o.showZones??!0,yAxisSync:o.yAxisSync??!0,enableDynamicColoring:o.enableDynamicColoring??!0,overboughtColor:o.overboughtColor||"#EF4444",oversoldColor:o.oversoldColor||"#10B981",overboughtThreshold:o.overboughtThreshold||-20,oversoldThreshold:o.oversoldThreshold||-80,levels:o.levels||[],zones:o.zones||[]};return qu.set(o.id,e),!0}catch(e){return console.error("Failed to import WR instance config:",e),!1}},getAllInstances:()=>new Map(qu),clearAllInstances:()=>{qu.clear()}},FP={name:"VR",shortName:"VR",precision:2,calcParams:[26,6,12],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:100-1e-9,maxValue:100+1e-9,figures:[{key:"vr",title:"VR: ",type:"line"},{key:"vrShort",title:"VR Short: ",type:"line"},{key:"vrLong",title:"VR Long: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#2196F3",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#4CAF50",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||26,s=e.calcParams[1]||6,i=e.calcParams[2]||12,r={};if(o.length<Math.max(t,s,i)+1)return o.reduce((l,c)=>(l[c.timestamp]={},l),{});const a=(l,c)=>{if(l<c)return 100;let d=0,v=0,g=0;for(let k=l-c+1;k<=l;k++){if(k===0)continue;const S=o[k],M=o[k-1];S.close>M.close?d+=S.volume||0:S.close<M.close?v+=S.volume||0:g+=S.volume||0}const _=d+g/2,y=v+g/2;return y===0?100:_/y*100};for(let l=0;l<o.length;l++){const c=a(l,t),d=a(l,s),v=a(l,i);r[o[l].timestamp]={vr:c,vrShort:d,vrLong:v}}return r},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{e.getVisibleRange(),o.save(),o.lineWidth=1,o.setLineDash([2,2]),o.strokeStyle="rgba(107, 114, 128, 0.6)",o.beginPath();const a=r.convertToPixel(100);o.moveTo(s.left,a),o.lineTo(s.left+s.width,a),o.stroke(),o.strokeStyle="rgba(239, 68, 68, 0.6)",o.beginPath();const l=r.convertToPixel(150);o.moveTo(s.left,l),o.lineTo(s.left+s.width,l),o.stroke(),o.strokeStyle="rgba(34, 197, 94, 0.6)",o.beginPath();const c=r.convertToPixel(70);return o.moveTo(s.left,c),o.lineTo(s.left+s.width,c),o.stroke(),o.restore(),!1}},$P={name:"ROC",shortName:"ROC",precision:2,calcParams:[14],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"roc",title:"ROC: ",type:"line"}],minValue:void 0,maxValue:void 0,styles:{lines:[{color:"#FF6B6B",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s]=t;return o.reduce((i,r,a)=>(i[r.timestamp]={roc:DP(o,a,s)},i),{})}};function DP(o,e,t){if(e<t)return null;const s=o[e].close,i=o[e-t].close;return i===0?null:(s-i)/i*100}const EP={name:"PSY",shortName:"PSY",precision:2,calcParams:[12,6],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"mapsy",title:"MAPSY: ",type:"line"}],minValue:0,maxValue:100,styles:{lines:[{color:"#2563eb",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#dc2626",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s,i]=t;return o.reduce((r,a,l)=>(r[a.timestamp]={psy:Ix(o,l,s),mapsy:NP(o,l,s,i)},r),{})}};function Ix(o,e,t){if(e<t)return null;let s=0;for(let i=e-t+1;i<=e;i++)i>0&&o[i].close>o[i-1].close&&s++;return s/t*100}function NP(o,e,t,s){if(e<t+s-1)return null;let i=0,r=0;for(let a=e-s+1;a<=e;a++){const l=Ix(o,a,t);l!==null&&(i+=l,r++)}return r>0?i/r:null}const jP={name:"OBV",shortName:"OBV",precision:0,calcParams:[30,10],shouldOhlc:!1,shouldFormatBigNumber:!0,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maobv",title:"MAOBV: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#2196F3",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[1]||10,s={};if(o.length===0)return s;let i=0;const r=[];for(let a=0;a<o.length;a++){const l=o[a];if(a===0)i=0;else{const d=o[a-1],v=l.volume||0;l.close>d.close?i+=v:l.close<d.close&&(i-=v)}r.push(i);let c;if(a>=t-1){let d=0;for(let v=a-t+1;v<=a;v++)d+=r[v];c=d/t}s[l.timestamp]={obv:i,maobv:c}}return s}},RP={name:"ZIGZAG",shortName:"ZIGZAG",precision:2,calcParams:[5,5],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:1,extendData:void 0,figures:[],styles:{lines:[{color:"#2962FF",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}],circles:[{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888"}]},calc:(o,e)=>{const t=(e.calcParams[0]||5)/100,s=e.calcParams[1]||5,i=[];if(o.length<s*2)return o.map(()=>({}));let r=0,a=o[0].high,l="high",c=!1;for(let d=0;d<o.length;d++)i.push({});i[0]={zigzag:o[0].close};for(let d=s;d<o.length;d++){const v=o[d].high,g=o[d].low,_=Math.abs(v-a)/a,y=Math.abs(g-a)/a;if(_>=t){r=d,a=v,l="high",c=!1,i[d]={zigzag:v,isHigh:!0};break}else if(y>=t){r=d,a=g,l="low",c=!0,i[d]={zigzag:g,isLow:!0};break}}for(let d=r+s;d<o.length;d++){const v=o[d].high,g=o[d].low;c?(v-a)/a>=t?(r=d,a=v,l="high",c=!1,i[d]={zigzag:v,isHigh:!0}):l==="low"&&g<a&&(i[r]={},r=d,a=g,i[d]={zigzag:g,isLow:!0}):(a-g)/a>=t?(r=d,a=g,l="low",c=!0,i[d]={zigzag:g,isLow:!0}):l==="high"&&v>a&&(i[r]={},r=d,a=v,i[d]={zigzag:v,isHigh:!0})}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var y,k,S,M;if(!t.result||t.result.length===0)return!1;const a=e.getVisibleRange(),{from:l,to:c}=a,d=t.result;o.save();const v=((k=(y=t.styles)==null?void 0:y.lines)==null?void 0:k[0])||{color:"#2962FF",size:2,style:Oe.Solid,dashedValue:[2,2]},g=((M=(S=t.styles)==null?void 0:S.circles)==null?void 0:M[0])||{upColor:"#26A69A",downColor:"#EF5350"},_=[];for(let I=Math.max(0,l-50);I<Math.min(c+1,d.length);I++){const C=d[I];C&&typeof C.zigzag=="number"&&_.push({index:I,price:C.zigzag,isHigh:C.isHigh||!1,isLow:C.isLow||!1})}if(o.strokeStyle=v.color||"#2962FF",o.lineWidth=v.size||2,v.style===Oe.Dashed){const I=Array.isArray(v.dashedValue)?v.dashedValue:[4,4];o.setLineDash(I)}else o.setLineDash([]);for(let I=0;I<_.length-1;I++){const C=_[I],T=_[I+1],z=i.convertToPixel(C.index),j=r.convertToPixel(C.price),B=i.convertToPixel(T.index),$=r.convertToPixel(T.price);o.beginPath(),o.moveTo(z,j),o.lineTo(B,$),o.stroke()}return _.forEach(I=>{if(I.index<l||I.index>=c)return;const C=i.convertToPixel(I.index),T=r.convertToPixel(I.price);C>=s.left&&C<=s.left+s.width&&T>=s.top&&T<=s.top+s.height&&(o.beginPath(),o.arc(C,T,4,0,2*Math.PI),I.isHigh?o.fillStyle=g.downColor:I.isLow?o.fillStyle=g.upColor:o.fillStyle=v.color,o.fill(),o.strokeStyle="#FFFFFF",o.lineWidth=1.5,o.stroke())}),o.restore(),!0}},BP={name:"Custom Momentum",shortName:"CM",calcParams:[12,26],shouldOhlc:!1,shouldFormatBigNumber:!1,precision:5,styles:{lines:[{color:"#26a69a",size:2,style:"solid"}],bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575",size:3,borderColor:"#26a69a",borderSize:0,borderStyle:"solid"}]},figures:[{key:"momentum",title:"Momentum: ",type:"line",baseValue:0},{key:"histogram",title:"Histogram: ",type:"bar",baseValue:0,styles:{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575"}}],calc:(o,e)=>{const t=e.calcParams[0]||12,s=e.calcParams[1]||26,i=[];for(let r=0;r<o.length;r++){const l=o[r].close;if(r>=s-1){let c=0;if(r===s-1){let _=0;for(let y=r-t+1;y<=r;y++)_+=o[y].close;c=_/t}else{const _=2/(t+1);c=l*_+(i[r-1].momentum||0)*(1-_)}let d=0;if(r===s-1){let _=0;for(let y=r-s+1;y<=r;y++)_+=o[y].close;d=_/s}else{const _=2/(s+1);d=l*_+(i[r-1].momentum||0)*(1-_)}const v=c-d,g=v;i.push({momentum:v,histogram:g})}else i.push({})}return i}},OP={name:"Custom AO",shortName:"CAO",calcParams:[5,34],shouldOhlc:!1,shouldFormatBigNumber:!1,precision:5,styles:{bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575",size:3,borderColor:"#26a69a",borderSize:0,borderStyle:"solid",fillColor:"#26a69a",strokeColor:"#26a69a"}]},figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575"}}],calc:(o,e)=>{const t=e.calcParams[0]||5,s=e.calcParams[1]||34,i=[];for(let r=0;r<o.length;r++)if(r>=s-1){const a=[],l=[];for(let g=r-t+1;g<=r;g++){const _=(o[g].high+o[g].low)/2;a.push(_)}for(let g=r-s+1;g<=r;g++){const _=(o[g].high+o[g].low)/2;l.push(_)}const c=a.reduce((g,_)=>g+_,0)/t,d=l.reduce((g,_)=>g+_,0)/s,v=c-d;i.push({ao:v})}else i.push({});return i},draw:(o,e,t,s,i)=>{t.calcParams[0];const r=t.calcParams[1]||34;o.save();for(let a=r-1;a<e.length;a++){const c=e[a].ao;if(c!==void 0){const d=s.convertToPixel(a),v=i.convertToPixel(0),g=i.convertToPixel(c);let _="#757575";c>0?_="#26a69a":c<0&&(_="#ef5350"),o.fillStyle=_,o.strokeStyle=_,o.lineWidth=1;const y=Math.max(2,s.getPixelDistance(1)*.8),k=Math.abs(v-g),S=d-y/2,M=Math.min(v,g);o.fillRect(S,M,y,k),o.strokeRect(S,M,y,k)}}o.restore()}},VP={name:"BOLL",shortName:"BOLL",precision:2,calcParams:[20,2],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"upper",title:"Upper: ",type:"line"},{key:"middle",title:"Middle: ",type:"line"},{key:"lower",title:"Lower: ",type:"line"}],styles:{lines:[{color:"#f23645",size:1,style:Oe.Solid,smooth:!1,dashedValue:[0,0]},{color:"#2962ff",size:1,style:Oe.Solid,smooth:!1,dashedValue:[0,0]},{color:"#089981",size:1,style:Oe.Solid,smooth:!1,dashedValue:[0,0]}],fill:{color:"#2196F3",opacity:.05}},calc:(o,e)=>{const t=e.calcParams[0]||20,s=e.calcParams[1]||2,i={};for(let r=0;r<o.length;r++){const a=o[r].timestamp;if(r<t-1){i[a]={};continue}let l=0;for(let y=r-t+1;y<=r;y++)l+=o[y].close;const c=l/t;let d=0;for(let y=r-t+1;y<=r;y++)d+=Math.pow(o[y].close-c,2);const v=Math.sqrt(d/t),g=c+s*v,_=c-s*v;i[a]={upper:g,middle:c,lower:_}}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var S,M,I,C,T,z,j,B,$,F,V,K,Y,Z,ne,te,oe,U,J,se,W,le,ye,Ce,Re,Ke,st,vt,Je,ot,nt,tt,Ze,ct,Ge,pt;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),c=Math.max(l.from,0),d=Math.min(l.to,a.length-1);o.save();const v={color:((I=(M=(S=t.styles)==null?void 0:S.lines)==null?void 0:M[0])==null?void 0:I.color)||"#2196F3",size:((z=(T=(C=t.styles)==null?void 0:C.lines)==null?void 0:T[0])==null?void 0:z.size)||1,style:(($=(B=(j=t.styles)==null?void 0:j.lines)==null?void 0:B[0])==null?void 0:$.style)||Oe.Solid},g={color:((K=(V=(F=t.styles)==null?void 0:F.lines)==null?void 0:V[1])==null?void 0:K.color)||"#FF9800",size:((ne=(Z=(Y=t.styles)==null?void 0:Y.lines)==null?void 0:Z[1])==null?void 0:ne.size)||1,style:((U=(oe=(te=t.styles)==null?void 0:te.lines)==null?void 0:oe[1])==null?void 0:U.style)||Oe.Solid},_={color:((W=(se=(J=t.styles)==null?void 0:J.lines)==null?void 0:se[2])==null?void 0:W.color)||"#2196F3",size:((Ce=(ye=(le=t.styles)==null?void 0:le.lines)==null?void 0:ye[2])==null?void 0:Ce.size)||1,style:((st=(Ke=(Re=t.styles)==null?void 0:Re.lines)==null?void 0:Ke[2])==null?void 0:st.style)||Oe.Solid},y={color:((Je=(vt=t.styles)==null?void 0:vt.fill)==null?void 0:Je.color)||"rgba(33, 150, 243, 0.1)",opacity:((nt=(ot=t.styles)==null?void 0:ot.fill)==null?void 0:nt.opacity)||.1};o.beginPath();let k=!0;for(let ce=c;ce<=d;ce++){const we=(tt=a[ce])==null?void 0:tt.timestamp,ze=t.result[we];if(!ze||typeof ze.upper!="number")continue;const dt=i.convertToPixel(ce),qe=r.convertToPixel(ze.upper);k?(o.moveTo(dt,qe),k=!1):o.lineTo(dt,qe)}for(let ce=d;ce>=c;ce--){const we=(Ze=a[ce])==null?void 0:Ze.timestamp,ze=t.result[we];if(!ze||typeof ze.lower!="number")continue;const dt=i.convertToPixel(ce),qe=r.convertToPixel(ze.lower);o.lineTo(dt,qe)}o.closePath(),o.globalAlpha=y.opacity,o.fillStyle=y.color,o.fill(),o.globalAlpha=1,o.beginPath(),k=!0;for(let ce=c;ce<=d;ce++){const we=(ct=a[ce])==null?void 0:ct.timestamp,ze=t.result[we];if(!ze||typeof ze.upper!="number")continue;const dt=i.convertToPixel(ce),qe=r.convertToPixel(ze.upper);k?(o.moveTo(dt,qe),k=!1):o.lineTo(dt,qe)}o.strokeStyle=v.color,o.lineWidth=v.size,o.setLineDash(v.style===Oe.Dashed?[4,4]:[]),o.stroke(),o.beginPath(),k=!0;for(let ce=c;ce<=d;ce++){const we=(Ge=a[ce])==null?void 0:Ge.timestamp,ze=t.result[we];if(!ze||typeof ze.lower!="number")continue;const dt=i.convertToPixel(ce),qe=r.convertToPixel(ze.lower);k?(o.moveTo(dt,qe),k=!1):o.lineTo(dt,qe)}o.strokeStyle=_.color,o.lineWidth=_.size,o.setLineDash(_.style===Oe.Dashed?[4,4]:[]),o.stroke(),o.beginPath(),k=!0;for(let ce=c;ce<=d;ce++){const we=(pt=a[ce])==null?void 0:pt.timestamp,ze=t.result[we];if(!ze||typeof ze.middle!="number")continue;const dt=i.convertToPixel(ce),qe=r.convertToPixel(ze.middle);k?(o.moveTo(dt,qe),k=!1):o.lineTo(dt,qe)}return o.strokeStyle=g.color,o.lineWidth=g.size,o.setLineDash(g.style===Oe.Dashed?[4,4]:[]),o.stroke(),o.restore(),!0}};function WP(o,e){const t=e.calcParams||[26,10,20,40,60],[s,i,r,a,l]=t,c={};if(o.length<s+1)return o.reduce((v,g,_)=>(v[g.timestamp]={},v),{});const d=[];for(let v=1;v<o.length;v++){o[v];const g=o[v-1];(g.high+g.low+g.close)/3;let _=0,y=0;const k=Math.max(0,v-s+1);for(let z=k;z<=v;z++){const j=o[z],B=z>0?o[z-1]:j,$=(B.high+B.low+B.close)/3,F=j.high-$,V=$-j.low;F>0&&(_+=F),V>0&&(y+=V)}const S=y!==0?_/y*100:100;d.push(S);const M=qg(d,i),I=qg(d,r),C=qg(d,a),T=qg(d,l);c[o[v].timestamp]={cr:S,ma1:M!==null?M:void 0,ma2:I!==null?I:void 0,ma3:C!==null?C:void 0,ma4:T!==null?T:void 0}}return c}function qg(o,e){return o.length<e?null:o.slice(-e).reduce((s,i)=>s+i,0)/e}const qP={name:"CR",shortName:"CR",precision:2,calcParams:[26,10,20,40,60],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:WP,regenerateFigures:o=>{const[,e,t,s,i]=o;return[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:`MA${e}: `,type:"line"},{key:"ma2",title:`MA${t}: `,type:"line"},{key:"ma3",title:`MA${s}: `,type:"line"},{key:"ma4",title:`MA${i}: `,type:"line"}]},styles:{lines:[{color:"#FF6B35",size:2,style:Oe.Solid},{color:"#2196F3",size:1,style:Oe.Solid},{color:"#4CAF50",size:1,style:Oe.Solid},{color:"#FF9800",size:1,style:Oe.Solid},{color:"#9C27B0",size:1,style:Oe.Solid}]}},HP={name:"EMV",shortName:"EMV",precision:4,calcParams:[14,9],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#2196F3",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{e.calcParams[0];const t=e.calcParams[1]||9,s={};if(o.length<2)return o.reduce((r,a)=>(r[a.timestamp]={},r),{});const i=[];for(let r=0;r<o.length;r++){const a=o[r];if(r===0){s[a.timestamp]={};continue}const l=o[r-1],c=(a.high+a.low)/2,d=(l.high+l.low)/2,v=c-d,g=a.high-a.low,_=a.volume||0;let y=0;if(g>0&&_>0){const S=_/g;y=v/S}i.push(y);let k;if(i.length>=t){let S=0;for(let M=i.length-t;M<i.length;M++)S+=i[M];k=S/t}s[a.timestamp]={emv:y,maEmv:k}}return s},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{e.getVisibleRange(),o.save(),o.lineWidth=1,o.setLineDash([2,2]),o.strokeStyle="rgba(107, 114, 128, 0.6)",o.beginPath();const a=r.convertToPixel(0);return o.moveTo(s.left,a),o.lineTo(s.left+s.width,a),o.stroke(),o.restore(),!1}},GP={name:"MTM",shortName:"MTM",precision:4,calcParams:[12],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"mtm",title:"MTM: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||12;return o.reduce((s,i,r)=>{if(r>=t){const a=i.close,l=o[r-t].close;s[i.timestamp]={mtm:a-l}}else s[i.timestamp]={};return s},{})}},UP={name:"TRIX",shortName:"TRIX",precision:4,calcParams:[14,9],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"signal",title:"Signal: ",type:"line"}],minValue:void 0,maxValue:void 0,styles:{lines:[{color:"#2563eb",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]},{color:"#dc2626",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s,i]=t,r=YP(o,s),a=ph(r,i);return o.reduce((l,c,d)=>(l[c.timestamp]={trix:r[d],signal:a[d]},l),{})}};function YP(o,e){const t=o.map(l=>l.close),s=ph(t,e),i=ph(s,e),r=ph(i,e),a=[];for(let l=0;l<r.length;l++)if(l===0||r[l]===null||r[l-1]===null||r[l-1]===0)a.push(null);else{const c=(r[l]-r[l-1])/r[l-1]*1e4;a.push(c)}return a}function ph(o,e){const t=[],s=2/(e+1);let i=null;for(let r=0;r<o.length;r++){if(o[r]===null){t.push(null);continue}if(i===null){if(r>=e-1){let a=0,l=0;for(let c=r-e+1;c<=r;c++)o[c]!==null&&(a+=o[c],l++);i=l>0?a/l:null}}else i=o[r]*s+i*(1-s);t.push(i)}return t}const KP={name:"VOL",shortName:"VOL",precision:0,calcParams:[20],shouldOhlc:!1,shouldFormatBigNumber:!0,visible:!0,zLevel:-1,extendData:void 0,figures:[],styles:{bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#26a69a"}],lines:[{color:"#8B5CF6",size:1,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{var r,a;const s=e.calcParams[0]||20,i={};for(let l=0;l<o.length;l++){const c=o[l],d=c.volume||0;let v=0;if(l===0)v=d;else{const g=2/(s+1),_=(r=o[l-1])==null?void 0:r.timestamp,y=(_!=null?(a=i[_])==null?void 0:a.ema:void 0)??d;v=d*g+y*(1-g)}i[c.timestamp]={volume:d,ema:v}}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i})=>{var z,j,B,$,F,V,K,Y,Z,ne,te,oe,U,J,se,W,le,ye,Ce,Re,Ke,st,vt,Je,ot,nt,tt,Ze,ct,Ge;if(!t.result||Object.keys(t.result).length===0)return!1;const r=e.getVisibleRange();if(!r)return!1;const{from:a,to:l}=r,c=e.getDataList();if(!c||c.length===0)return!1;const d=((B=(j=(z=t.styles)==null?void 0:z.bars)==null?void 0:j[0])==null?void 0:B.upColor)||"#26a69a",v=((V=(F=($=t.styles)==null?void 0:$.bars)==null?void 0:F[0])==null?void 0:V.downColor)||"#ef5350",g=((Z=(Y=(K=t.styles)==null?void 0:K.bars)==null?void 0:Y[0])==null?void 0:Z.noChangeColor)||"#26a69a",_=((oe=(te=(ne=t.styles)==null?void 0:ne.lines)==null?void 0:te[0])==null?void 0:oe.color)||"#8B5CF6";o.save();let y=0;for(let pt=a;pt<=l&&pt<c.length;pt++){const ce=(U=c[pt])==null?void 0:U.timestamp,we=ce!=null?t.result[ce]:void 0;we&&(we.volume!=null&&we.volume>y&&(y=we.volume),we.ema!=null&&we.ema>y&&(y=Math.max(y,we.ema)))}if(y<=0)return o.restore(),!0;const S=Math.max(10,Math.floor(s.height*.22)),M=s.top+s.height-1,C=Math.max(1,Math.floor(S*.56));for(let pt=a;pt<=l&&pt<c.length;pt++){const ce=(J=c[pt])==null?void 0:J.timestamp,we=ce!=null?t.result[ce]:void 0;if(!we||we.volume==null)continue;const ze=c[pt],dt=pt>0&&pt-1<c.length?c[pt-1]:null;let qe=g;dt&&ze&&typeof ze.close=="number"&&typeof dt.close=="number"&&(ze.close>dt.close?qe=d:ze.close<dt.close&&(qe=v));const me=i.convertToPixel(pt),Q=Math.min(1,we.volume/y),it=Math.max(1,Math.floor(Q*C)),Vt=M-it,wt=Math.max(1,(i.convertToPixel(1)-i.convertToPixel(0))*.8),Yt=(le=(W=(se=t==null?void 0:t.styles)==null?void 0:se.bars)==null?void 0:W[0])==null?void 0:le.opacity;let At=typeof Yt=="number"?Yt:void 0;if(At==null){const Gt=(qe||"").toString().match(/^rgba?\(\s*\d+\s*,\s*\d+\s*,\s*\d+(?:\s*,\s*([0-9]*\.?[0-9]+))?\s*\)$/i);if(Gt){const no=Gt[1]!=null?parseFloat(Gt[1]):1;At=isNaN(no)?.7:no}else At=.7}o.globalAlpha=Math.max(0,Math.min(1,At)),o.fillStyle=qe,o.fillRect(me-wt/2,Vt,wt,it)}if(o.globalAlpha=1,((Re=(Ce=(ye=t==null?void 0:t.styles)==null?void 0:ye.lines)==null?void 0:Ce[0])==null?void 0:Re.visible)===!0){const pt=((vt=(st=(Ke=t.styles)==null?void 0:Ke.lines)==null?void 0:st[0])==null?void 0:vt.style)||Oe.Solid,ce=((nt=(ot=(Je=t.styles)==null?void 0:Je.lines)==null?void 0:ot[0])==null?void 0:nt.size)||1,we=((ct=(Ze=(tt=t.styles)==null?void 0:tt.lines)==null?void 0:Ze[0])==null?void 0:ct.dashedValue)||[2,2];o.lineWidth=ce,o.strokeStyle=_,pt===Oe.Dashed?o.setLineDash(we):o.setLineDash([]);const ze=[];for(let dt=a;dt<=l&&dt<c.length;dt++){const qe=(Ge=c[dt])==null?void 0:Ge.timestamp,me=qe!=null?t.result[qe]:void 0;if(!me||me.ema==null)continue;const Q=i.convertToPixel(dt),it=Math.min(1,me.ema/y),Vt=M-Math.floor(it*C);ze.push({x:Q,y:Vt})}if(ze.length>1){o.save(),o.beginPath(),o.moveTo(ze[0].x,M);for(const dt of ze)o.lineTo(dt.x,dt.y);o.lineTo(ze[ze.length-1].x,M),o.closePath(),o.globalAlpha=.25,o.fillStyle=_,o.fill(),o.globalAlpha=1,o.restore(),o.beginPath(),o.moveTo(ze[0].x,ze[0].y);for(let dt=1;dt<ze.length;dt++)o.lineTo(ze[dt].x,ze[dt].y);o.stroke()}}return o.restore(),!0}},ZP={name:"SMA",shortName:"SMA",precision:2,calcParams:[20],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"sma",title:"SMA: ",type:"line"}],styles:{lines:[{color:"#FF6C37",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||20,s={};for(let i=0;i<o.length;i++){const r=o[i].timestamp;if(i<t-1){s[r]={};continue}let a=0;for(let c=i-t+1;c<=i;c++)a+=o[c].close;const l=a/t;s[r]={sma:l}}return s},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var _,y,k,S,M,I,C,T,z,j;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:c,to:d}=l;o.save();const v={color:((k=(y=(_=t.styles)==null?void 0:_.lines)==null?void 0:y[0])==null?void 0:k.color)??"#FF6C37",size:((I=(M=(S=t.styles)==null?void 0:S.lines)==null?void 0:M[0])==null?void 0:I.size)??2,style:((z=(T=(C=t.styles)==null?void 0:C.lines)==null?void 0:T[0])==null?void 0:z.style)??Oe.Solid};o.beginPath();let g=!0;for(let B=c;B<=d;B++){const $=(j=a[B])==null?void 0:j.timestamp,F=t.result[$];if(!F||typeof F.sma!="number")continue;const V=i.convertToPixel(B),K=r.convertToPixel(F.sma);g?(o.moveTo(V,K),g=!1):o.lineTo(V,K)}return o.strokeStyle=v.color,o.lineWidth=v.size,v.style===Oe.Dashed?o.setLineDash([8,4]):o.setLineDash([]),o.stroke(),o.restore(),!0}},ep=new Map,x0=o=>({id:o,kPeriod:14,dPeriod:3,kLineColor:"#1E90FF",kLineThickness:2,kLineStyle:"solid",dLineColor:"#FF1493",dLineThickness:2,dLineStyle:"dashed",showLevels:!0,showZones:!0,overboughtLevel:80,oversoldLevel:20,midlineLevel:50,showOverbought:!0,showOversold:!0,showMidline:!1,levels:[{id:"overbought",value:80,color:"#EF4444",lineStyle:"dashed",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:20,color:"#10B981",lineStyle:"dashed",thickness:1,label:"Oversold",visible:!0},{id:"midline",value:50,color:"#6B7280",lineStyle:"dotted",thickness:1,label:"Midline",visible:!1}],zones:[{id:"overbought_zone",topLevel:100,bottomLevel:80,fillColor:"#EF4444",fillOpacity:.1,visible:!0,type:"overbought"},{id:"oversold_zone",topLevel:20,bottomLevel:0,fillColor:"#10B981",fillOpacity:.1,visible:!0,type:"oversold"}]}),XP=(o,e,t)=>{const s=[],i=[];if(o.length<e)return{k:o.map(()=>NaN),d:o.map(()=>NaN)};for(let r=0;r<o.length;r++){if(r<e-1){s.push(NaN);continue}let a=o[r-e+1].high,l=o[r-e+1].low;for(let v=r-e+2;v<=r;v++)o[v].high>a&&(a=o[v].high),o[v].low<l&&(l=o[v].low);const c=o[r].close,d=a-l;if(d===0)s.push(50);else{const v=100*((c-l)/d);s.push(v)}}for(let r=0;r<s.length;r++){if(r<e-1+t-1){i.push(NaN);continue}let a=0,l=0;for(let c=r-t+1;c<=r;c++)isNaN(s[c])||(a+=s[c],l++);l===0?i.push(NaN):i.push(a/l)}return{k:s,d:i}},JP={name:"STOCH",shortName:"Stoch",precision:2,calcParams:[14,3],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:0,maxValue:100,figures:[{key:"k",title:"%K: ",type:"line"},{key:"d",title:"%D: ",type:"line"}],styles:{lines:[{color:"#1E90FF",size:2,style:Oe.Solid,smooth:!1,dashedValue:[0,0]},{color:"#FF1493",size:2,style:Oe.Dashed,smooth:!1,dashedValue:[4,4]}]},calc:(o,e)=>{const t=e.calcParams[0]||14,s=e.calcParams[1]||3,{k:i,d:r}=XP(o,t,s);return o.reduce((a,l,c)=>{const d=i[c],v=r[c];return a[l.timestamp]={k:isNaN(d)?null:d,d:isNaN(v)?null:v},a},{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{const a=t.paneId||"default";let l=ep.get(a);l||(l=x0(a),ep.set(a,l));const{left:c,top:d,width:v,height:g}=s;return e.getVisibleRange(),o.save(),l.showZones&&l.zones.forEach(_=>{if(!_.visible)return;const y=r.convertToPixel(_.topLevel),k=r.convertToPixel(_.bottomLevel);if(y!==null&&k!==null&&isFinite(y)&&isFinite(k)&&isFinite(c)&&isFinite(v)){o.save();const S=Math.abs(y-k),M=Math.min(y,k);if(!isFinite(S)||!isFinite(M)||S===0){o.restore();return}const I=o.createLinearGradient(c,M,c,M+S),T=_.fillColor.match(/\w\w/g);if(T){const z=parseInt(T[0],16),j=parseInt(T[1],16),B=parseInt(T[2],16);I.addColorStop(0,`rgba(${z}, ${j}, ${B}, ${_.fillOpacity*.8})`),I.addColorStop(.3,`rgba(${z}, ${j}, ${B}, ${_.fillOpacity*.6})`),I.addColorStop(.7,`rgba(${z}, ${j}, ${B}, ${_.fillOpacity*.3})`),I.addColorStop(1,`rgba(${z}, ${j}, ${B}, ${_.fillOpacity*.1})`)}else I.addColorStop(0,_.fillColor+Math.floor(_.fillOpacity*255).toString(16).padStart(2,"0")),I.addColorStop(.5,_.fillColor+Math.floor(_.fillOpacity*128).toString(16).padStart(2,"0")),I.addColorStop(1,_.fillColor+Math.floor(_.fillOpacity*32).toString(16).padStart(2,"0"));o.fillStyle=I,o.fillRect(c,M,v,S),o.strokeStyle=_.fillColor+"40",o.lineWidth=.5,o.strokeRect(c,M,v,S),o.restore()}}),l.showLevels&&l.levels.forEach(_=>{if(!_.visible)return;const y=r.convertToPixel(_.value);y!==null&&isFinite(y)&&y>=d&&y<=d+g&&isFinite(c)&&isFinite(v)&&(o.save(),o.strokeStyle=_.color,o.lineWidth=_.thickness,_.lineStyle==="dashed"?o.setLineDash([4,4]):_.lineStyle==="dotted"?o.setLineDash([2,6]):o.setLineDash([]),o.beginPath(),o.moveTo(c,y),o.lineTo(c+v,y),o.stroke(),o.fillStyle=_.color,o.font="10px Arial",o.textAlign="left",o.fillText(`${_.value}`,c+5,y-3),o.restore())}),o.restore(),!1}},Hg={createInstance:(o,e)=>{const t={...x0(o),...e};return ep.set(o,t),t},getInstance:o=>ep.get(o),updateInstance:(o,e)=>{const t=ep.get(o);return t?(Object.assign(t,e),!0):!1},deleteInstance:o=>ep.delete(o),addLevel:(o,e)=>{const t=ep.get(o);if(t){const s=`level_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:s,...e};return t.levels.push(i),s}throw new Error(`Stochastic instance ${o} not found`)},removeLevel:(o,e)=>{const t=ep.get(o);if(t){const s=t.levels.findIndex(i=>i.id===e);if(s!==-1)return t.levels.splice(s,1),!0}return!1},updateLevel:(o,e,t)=>{const s=ep.get(o);if(s){const i=s.levels.find(r=>r.id===e);if(i)return Object.assign(i,t),e==="overbought"?s.overboughtLevel=i.value:e==="oversold"?s.oversoldLevel=i.value:e==="midline"&&(s.midlineLevel=i.value),!0}return!1},addZone:(o,e)=>{const t=ep.get(o);if(t){const s=`zone_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:s,...e};return t.zones.push(i),s}throw new Error(`Stochastic instance ${o} not found`)},removeZone:(o,e)=>{const t=ep.get(o);if(t){const s=t.zones.findIndex(i=>i.id===e);if(s!==-1)return t.zones.splice(s,1),!0}return!1},updateZone:(o,e,t)=>{const s=ep.get(o);if(s){const i=s.zones.find(r=>r.id===e);if(i)return Object.assign(i,t),!0}return!1},getInstanceConfig:o=>ep.get(o)||null,resetInstance:o=>{const e=x0(o);ep.set(o,e)},exportInstanceConfig:o=>{const e=ep.get(o);return e?{id:e.id,kPeriod:e.kPeriod,dPeriod:e.dPeriod,kLineColor:e.kLineColor,kLineThickness:e.kLineThickness,kLineStyle:e.kLineStyle,dLineColor:e.dLineColor,dLineThickness:e.dLineThickness,dLineStyle:e.dLineStyle,showLevels:e.showLevels,showZones:e.showZones,overboughtLevel:e.overboughtLevel,oversoldLevel:e.oversoldLevel,midlineLevel:e.midlineLevel,showOverbought:e.showOverbought,showOversold:e.showOversold,showMidline:e.showMidline,levels:e.levels.map(t=>({...t})),zones:e.zones.map(t=>({...t}))}:null},importInstanceConfig:o=>{try{const e={id:o.id,kPeriod:o.kPeriod||14,dPeriod:o.dPeriod||3,kLineColor:o.kLineColor||"#1E90FF",kLineThickness:o.kLineThickness||2,kLineStyle:o.kLineStyle||"solid",dLineColor:o.dLineColor||"#FF1493",dLineThickness:o.dLineThickness||2,dLineStyle:o.dLineStyle||"dashed",showLevels:o.showLevels!==!1,showZones:o.showZones!==!1,overboughtLevel:o.overboughtLevel||80,oversoldLevel:o.oversoldLevel||20,midlineLevel:o.midlineLevel||50,showOverbought:o.showOverbought!==!1,showOversold:o.showOversold!==!1,showMidline:o.showMidline||!1,levels:o.levels||x0(o.id).levels,zones:o.zones||x0(o.id).zones};return ep.set(o.id,e),!0}catch(e){return console.error("Failed to import Stochastic instance config:",e),!1}},getAllInstances:()=>new Map(ep),clearAllInstances:()=>{ep.clear()}},QP={name:"SMARTTREND",shortName:"Smart Trend",precision:2,calcParams:[10,3],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:{showLabels:!0},figures:[{key:"superTrend",title:"Smart Trend: ",type:"line"}],styles:{lines:[{color:"#00FF00",size:2,style:Oe.Solid,smooth:!1,dashedValue:[0,0]}]},calc:(o,e)=>{var k;const t=e.calcParams[0]||10,s=e.calcParams[1]||3,i={},r=(S,M)=>{if(!M)return S.high-S.low;const I=S.high-S.low,C=Math.abs(S.high-M.close),T=Math.abs(S.low-M.close);return Math.max(I,C,T)},a=S=>{if(S<t-1)return 0;let M=0;for(let I=S-t+1;I<=S;I++){const C=o[I],T=I>0?o[I-1]:void 0;M+=r(C,T)}return M/t};let l=1,c=0,d=0,v=-1,g,_=-1,y;for(let S=0;S<o.length;S++){const M=o[S].timestamp;if(S<t-1){i[M]={};continue}const I=o[S],C=S>0?o[S-1]:I,T=a(S),z=(I.high+I.low)/2,j=z+s*T,B=z-s*T;if(S===t-1)c=j,d=B;else{i[S-1];const J=C.close;(j<c||J>c)&&(c=j),(B>d||J<d)&&(d=B)}let $=l,F=0,V,K,Y,Z,ne,te,oe,U;if(S>t-1){const J=o[S-1].timestamp;if((k=i[J])!=null&&k.superTrend,l===1&&I.close<=d?$=-1:l===-1&&I.close>=c&&($=1),$!==l){if($===1){if(V=d,Y=I.close,v=S,g=I.close,y!==void 0&&_>=0){te=I.close,U=y-te;const se=o[_].timestamp,W=i[se];W.sellExit=te,W.sellProfit=U,y=void 0,_=-1}}else if(K=c,Z=I.close,_=S,y=I.close,g!==void 0&&v>=0){ne=I.close,oe=ne-g;const se=o[v].timestamp,W=i[se];W.buyExit=ne,W.buyProfit=oe,g=void 0,v=-1}}}$===1?F=d:F=c,i[M]={superTrend:F,trend:$,buySignal:V,sellSignal:K,buyEntry:Y,sellEntry:Z,buyExit:ne,sellExit:te,buyProfit:oe,sellProfit:U},l=$}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var F,V,K,Y,Z,ne,te;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:c,to:d}=l;o.save();const v=(oe,U,J,se,W,le)=>{const ye=Math.min(le,se/2,W/2);oe.beginPath(),oe.moveTo(U+ye,J),oe.arcTo(U+se,J,U+se,J+W,ye),oe.arcTo(U+se,J+W,U,J+W,ye),oe.arcTo(U,J+W,U,J,ye),oe.arcTo(U,J,U+se,J,ye),oe.closePath()},g=(oe,U)=>{if(!oe)return`rgba(0,0,0,${U})`;if(oe.startsWith("rgb"))return oe.startsWith("rgba")?oe.replace(/rgba\(([^)]+)\)/,(ye,Ce)=>{const Re=Ce.split(",").map(Ke=>Ke.trim());return`rgba(${Re[0]}, ${Re[1]}, ${Re[2]}, ${U})`}):oe.replace(/rgb\(([^)]+)\)/,(ye,Ce)=>`rgba(${Ce}, ${U})`);const J=oe.replace("#",""),se=parseInt(J.substring(0,2),16),W=parseInt(J.substring(2,4),16),le=parseInt(J.substring(4,6),16);return`rgba(${se}, ${W}, ${le}, ${U})`},_=(oe,U,J,se)=>{const W="bold 10px Arial";o.font=W;const le=o.measureText(J),ye=le.actualBoundingBoxAscent&&le.actualBoundingBoxDescent?le.actualBoundingBoxAscent+le.actualBoundingBoxDescent:10,Ce=6,Re=4,Ke=Math.ceil(le.width)+Ce*2,st=Math.ceil(ye)+Re*2,vt=Math.round(oe-Ke/2),Je=Math.round(U-st/2),ot=typeof performance<"u"?performance.now():Date.now(),nt=.35+.25*Math.sin(ot/450);o.save(),o.shadowColor=g(se,Math.max(0,nt)),o.shadowBlur=12,o.fillStyle=g(se,.14),v(o,vt,Je,Ke,st,6),o.fill(),o.restore(),o.lineWidth=1,o.strokeStyle=g(se,.9),v(o,vt,Je,Ke,st,6),o.stroke(),o.fillStyle=g(se,.95),o.textAlign="center",o.textBaseline="middle",o.font=W,o.fillText(J,oe,U+.5)},y=t.extendData,k=(y==null?void 0:y.showLabels)!==!1,S=(y==null?void 0:y.uptrendColor)||"#00FF00",M=(y==null?void 0:y.downtrendColor)||"#FF0000",I=(y==null?void 0:y.uptrendThickness)??2,C=(y==null?void 0:y.downtrendThickness)??2,T=(y==null?void 0:y.uptrendLineStyle)||"solid",z=(y==null?void 0:y.downtrendLineStyle)||"solid";let j=[],B=c,$=((V=t.result[(F=a[c])==null?void 0:F.timestamp])==null?void 0:V.trend)||1;for(let oe=c+1;oe<=d;oe++){const U=(K=a[oe])==null?void 0:K.timestamp,J=t.result[U],se=(J==null?void 0:J.trend)??$,W=oe===d;if(se!==$||W){const le=W&&se===$?oe:oe-1;j.push({start:B,end:le,trend:$}),B=oe,$=se}}if(j.forEach(oe=>{var ye,Ce;const U=oe.trend===1,J=U?S:M,se=U?I:C,W=U?T:z;o.strokeStyle=J,o.lineWidth=Number(se)||2,o.lineCap="round",o.lineJoin="round",W==="dashed"?o.setLineDash([4,4]):W==="dotted"?o.setLineDash([2,6]):o.setLineDash([]),o.beginPath();let le=!0;for(let Re=oe.start;Re<=oe.end;Re++){const Ke=(ye=a[Re])==null?void 0:ye.timestamp,st=t.result[Ke];if(st&&typeof st.superTrend=="number"){const vt=i.convertToPixel(Re),Je=r.convertToPixel(st.superTrend);le?(o.moveTo(vt,Je),le=!1):o.lineTo(vt,Je)}}if(o.stroke(),k){const Re=(Ce=a[oe.end])==null?void 0:Ce.timestamp,Ke=t.result[Re];if(Ke&&typeof Ke.superTrend=="number"){const vt=oe===j[j.length-1]?"HOLD":"EXIT",Je=i.convertToPixel(oe.end),ot=r.convertToPixel(Ke.superTrend);_(Je,ot+(U?22:-22),vt,J)}}}),k){let oe=0;try{const J=(Y=e==null?void 0:e.getDataList)==null?void 0:Y.call(e);if(J&&J.length>0)oe=((Z=J[J.length-1])==null?void 0:Z.close)??0;else{const se=(ne=a[d])==null?void 0:ne.timestamp,W=t.result[se];oe=(W==null?void 0:W.superTrend)??0}}catch{}const U=(t==null?void 0:t.precision)??2;for(let J=c;J<=d;J++){const se=(te=a[J])==null?void 0:te.timestamp,W=t.result[se];if(!W)continue;const le=i.convertToPixel(J);if(W.buySignal!==void 0){const ye=r.convertToPixel(W.buySignal);o.fillStyle="#00FF00",o.beginPath(),o.arc(le,ye-10,4,0,2*Math.PI),o.fill();const Ce=W.buyEntry??W.buySignal,Re=W.buyExit!==void 0?W.buyExit-Ce:oe?oe-Ce:0,Ke=`${Re>=0?"+":""}${Number(Re).toFixed(U)}`;_(le,ye+22,`BUY ${Ke}`,"#10B981")}if(W.sellSignal!==void 0){const ye=r.convertToPixel(W.sellSignal);o.fillStyle="#FF0000",o.beginPath(),o.arc(le,ye+10,4,0,2*Math.PI),o.fill();const Ce=W.sellEntry??W.sellSignal,Re=W.sellExit!==void 0?Ce-W.sellExit:oe?Ce-oe:0,Ke=`${Re>=0?"+":""}${Number(Re).toFixed(U)}`;_(le,ye-22,`SELL ${Ke}`,"#EF4444")}}}return o.restore(),!0}},eI={name:"MACD",shortName:"MACD",calcParams:[12,26,9],shouldOhlc:!1,shouldFormatBigNumber:!1,precision:4,minValue:-1e-9,maxValue:1e-9,styles:{lines:[{color:"#2563eb",size:1,style:Oe.Solid,dashedValue:[2,2]},{color:"#dc2626",size:1,style:Oe.Solid,dashedValue:[2,2]}],bars:[{upColor:"#2563eb",downColor:"#ef4444",noChangeColor:"#2563eb"}]},figures:[{key:"macd",title:"MACD: ",type:"line",baseValue:0},{key:"signal",title:"Signal: ",type:"line",baseValue:0},{key:"hist",title:"Hist: ",type:"bar",baseValue:0}],calc:(o,e)=>{var _,y,k;const t=((_=e.calcParams)==null?void 0:_[0])||12,s=((y=e.calcParams)==null?void 0:y[1])||26,i=((k=e.calcParams)==null?void 0:k[2])||9,r=(S,M)=>{const I=2/(S+1),C=[];let T;for(let z=0;z<M.length;z++){const j=M[z];T===void 0?T=j:T=j*I+T*(1-I),C.push(T)}return C},a=o.map(S=>S.close),l=r(t,a),c=r(s,a),d=a.map((S,M)=>(l[M]??NaN)-(c[M]??NaN)),v=r(i,d.map(S=>Number.isFinite(S)?S:0)),g={};for(let S=0;S<o.length;S++){const M=o[S].timestamp;if(!Number.isFinite(d[S])||!Number.isFinite(v[S])){g[M]={};continue}const I=d[S],C=v[S],T=I-C;g[M]={macd:I,signal:C,hist:T}}return g},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{var S,M,I,C,T,z,j;const r=e.getDataList();if(!t.result||r.length===0)return!1;const a=t.styles||{},l=((M=(S=a==null?void 0:a.bars)==null?void 0:S[0])==null?void 0:M.upColor)||"#2563eb",c=((C=(I=a==null?void 0:a.bars)==null?void 0:I[0])==null?void 0:C.downColor)||"#ef4444",d=((z=(T=a==null?void 0:a.bars)==null?void 0:T[0])==null?void 0:z.noChangeColor)||l,v=(a==null?void 0:a.lines)||[],g=e.getVisibleRange(),_=Math.max(g.from,0),y=Math.min(g.to,r.length-1);o.save();for(let B=_;B<=y;B++){const $=(j=r[B])==null?void 0:j.timestamp,F=t.result[$];if(!F||typeof F.hist!="number")continue;const V=s.convertToPixel(B),K=i.convertToPixel(0),Y=i.convertToPixel(F.hist),Z=s.convertToPixel(1)-s.convertToPixel(0),ne=Math.max(1,Math.floor(Z*.8)),te=Math.min(K,Y),oe=Math.abs(K-Y);let U=d;F.hist>0?U=l:F.hist<0&&(U=c),o.fillStyle=U;const J=Math.round(V-ne/2),se=Math.round(te),W=Math.max(1,Math.round(oe));o.fillRect(J,se,ne,W)}o.restore();const k=(B,$)=>{var Y;o.save(),o.beginPath(),o.lineWidth=($==null?void 0:$.size)??1,($==null?void 0:$.style)===Oe.Dashed?o.setLineDash(($==null?void 0:$.dashedValue)??[4,4]):o.setLineDash([]),o.strokeStyle=($==null?void 0:$.color)||"#ffffff";const V=o.lineWidth%2?.5:0;o.lineCap="butt",o.lineJoin="miter";let K=!0;for(let Z=_;Z<=y;Z++){const ne=(Y=r[Z])==null?void 0:Y.timestamp,te=t.result[ne];if(!te||typeof te[B]!="number")continue;const oe=Math.round(s.convertToPixel(Z))+V,U=Math.round(i.convertToPixel(te[B]))+V;K?(o.moveTo(oe,U),K=!1):o.lineTo(oe,U)}o.stroke(),o.restore()};return k("macd",v[0]),k("signal",v[1]),!0}};function ef(o,e,t){return Math.max(e,Math.min(t,o))}function tI(o,e){const t=new Array(o.length).fill(0);if(e<=1){for(let i=0;i<o.length;i++)t[i]=o[i]??0;return t}let s=0;for(let i=0;i<o.length;i++)s+=o[i]??0,i>=e&&(s-=o[i-e]??0),t[i]=i>=e-1?s/e:0;return t}function oI(o,e,t){const s=Math.max(0,e-t);let i=-1/0;for(let r=s;r<e;r++)o[r]&&o[r].high>i&&(i=o[r].high);return i===-1/0?0:i}function sI(o,e,t){const s=Math.max(0,e-t);let i=1/0;for(let r=s;r<e;r++)o[r]&&o[r].low<i&&(i=o[r].low);return i===1/0?0:i}function Gg(o){const e=Math.max(0,(o.high??0)-(o.low??0)),t=Math.abs((o.close??0)-(o.open??0)),s=Math.max(0,(o.high??0)-Math.max(o.open??0,o.close??0)),i=Math.max(0,Math.min(o.open??0,o.close??0)-(o.low??0)),r=e>0?s/e:0,a=e>0?i/e:0;return{range:e,body:t,upperWick:s,lowerWick:i,upperWickRatio:r,lowerWickRatio:a}}const nI={name:"TRAP_HUNTER",shortName:"TRAP",precision:2,shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,figures:[],styles:{texts:[{color:"#ffffff",size:10}]},calc:(o,e)=>{var j,B;const t=e.calcParams||[],s=t[0]??20,i=t[1]??20,r=Math.max(1,t[2]??3),a=Math.max(1,t[3]??5),l=Math.max(1,t[4]??20),c=t[5]??1.3,d=t[6]??7e-4,v=t[7]??.35,g=t[8]??.5,_=(t[9]??1)>0?1:0,y=Math.max(1,t[10]??5),k=o.map($=>($==null?void 0:$.volume)??0),S=tI(k,l),M=new Array(o.length).fill(null).map(()=>({}));let I=-1e3,C=-1e3,T=-1e3,z=-1e3;for(let $=0;$<o.length;$++){const F=o[$];if(!F||$===0)continue;const V=oI(o,$,s),K=sI(o,$,i);if(V===0||K===0)continue;const Y=S[$]||0,Z=Y>0?(F.volume??0)/Y:0,{range:ne,upperWickRatio:te,lowerWickRatio:oe}=Gg(F),U=ne>0?(F.high-F.close)/ne<.4:!1,J=ne>0?(F.close-F.low)/ne<.4:!1,se=(F.high??0)>=V*(1+d),W=(F.close??0)>(F.open??0)||U,le=Z>=c;if(se&&W&&le){let vt=-1;(F.close??0)<V&&(vt=$);const Je=Math.min(o.length-1,$+r);if(vt===-1){for(let ot=$+1;ot<=Je;ot++)if((((j=o[ot])==null?void 0:j.close)??0)<V){vt=ot;break}}if(vt!==-1){const ot=Math.min(vt,$+a);let nt=te,tt=!1;for(let ze=$;ze<=ot;ze++){const dt=Gg(o[ze]);dt.upperWickRatio>nt&&(nt=dt.upperWickRatio),(o[ze].close??0)<(o[ze].open??0)&&(dt.range>0&&dt.body/dt.range>=.45)&&(tt=!0)}const Ze=ef((F.high-V)/Math.max(1e-8,V)/(d*3),0,1),ct=ef(Z/(c*2),0,1),Ge=ef(nt,0,1),pt=ef((F.high-(o[vt].close??0))/Math.max(1e-8,F.high),0,1),ce=ef(.3*Ze+.3*ct+.2*Ge+.2*pt,0,1);(nt>=v||tt)&&ce>=g&&vt-I>=2&&(I=vt,T=vt,M[vt]={...M[vt],bullTrap:!0,type:"bull",score:ce,breakoutLevel:V,reversalClose:o[vt].close,time:o[vt].timestamp})}}const ye=d*.85,Ce=c*.9,Re=(F.low??0)<=K*(1-ye),Ke=(F.close??0)<(F.open??0)||J||oe>=v,st=Z>=Ce;if(Re&&Ke&&st){const vt=Math.min(o.length-1,$+r);let Je=-1;if((F.close??0)>K&&(Je=$),Je===-1){for(let ot=$+1;ot<=vt;ot++)if((((B=o[ot])==null?void 0:B.close)??0)>K){Je=ot;break}}if(Je!==-1){const ot=Math.min(Je,$+a);let nt=oe,tt=!1;for(let ze=$;ze<=ot;ze++){const dt=Gg(o[ze]);dt.lowerWickRatio>nt&&(nt=dt.lowerWickRatio),(o[ze].close??0)>(o[ze].open??0)&&(dt.range>0&&dt.body/dt.range>=.45)&&(tt=!0)}const Ze=ef((K-F.low)/Math.max(1e-8,K)/(ye*3),0,1),ct=ef(Z/(Ce*2),0,1),Ge=ef(nt,0,1),pt=ef(((o[Je].close??0)-F.low)/Math.max(1e-8,o[Je].close??0),0,1),ce=ef(.3*Ze+.3*ct+.2*Ge+.2*pt,0,1);(nt>=v||tt)&&ce>=g&&Je-C>=2&&(C=Je,T=Je,M[Je]={...M[Je],bearTrap:!0,type:"bear",score:ce,breakoutLevel:K,reversalClose:o[Je].close,time:o[Je].timestamp})}}if(_){const vt=S[$]>0?(F.volume??0)/S[$]:0,{upperWickRatio:Je,lowerWickRatio:ot}=Gg(F),nt=Math.max(.1,v*.8),tt=Math.max(1,c*.85),Ze=(F.close??0)<=V*(1+d*.5)&&(F.close??0)>=K*(1-d*.5),ct=vt<=tt&&Je<=nt&&ot<=nt&&Ze,Ge=$-T,pt=$-z,ce=Math.max(8,y);ct&&Ge>=y&&pt>=ce&&(z=$,M[$]={...M[$],normal:!0,time:o[$].timestamp})}}return M},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{const r=t.result;if(!r||r.length===0)return!1;const a=e.getDataList(),l=e.getVisibleRange(),c=Math.max(0,l.from),d=Math.min(r.length-1,l.to);function v(y,k,S,M){o.save(),o.fillStyle=S,o.strokeStyle=S,o.lineWidth=1,M==="normal"?(o.beginPath(),o.arc(y,k,3.5,0,2*Math.PI),o.fill()):(o.beginPath(),M==="bull"?(o.moveTo(y,k-6),o.lineTo(y-5,k+4),o.lineTo(y+5,k+4)):(o.moveTo(y,k+6),o.lineTo(y-5,k-4),o.lineTo(y+5,k-4)),o.closePath(),o.fill()),o.restore()}function g(y,k,S,M){o.save(),o.font="11px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",o.textAlign="center",o.textBaseline="middle",o.fillStyle=M,o.strokeStyle="rgba(0,0,0,0.2)";const I=6,C=o.measureText(S),T=Math.ceil(C.width)+I*2,z=16,j=4,B=y-T/2,$=k-z/2;o.beginPath(),o.moveTo(B+j,$),o.lineTo(B+T-j,$),o.quadraticCurveTo(B+T,$,B+T,$+j),o.lineTo(B+T,$+z-j),o.quadraticCurveTo(B+T,$+z,B+T-j,$+z),o.lineTo(B+j,$+z),o.quadraticCurveTo(B,$+z,B,$+z-j),o.lineTo(B,$+j),o.quadraticCurveTo(B,$,B+j,$),o.closePath(),o.fillStyle="rgba(0,0,0,0.6)",o.fill(),o.fillStyle=M,o.fillText(S,y,k+.5),o.restore()}function _(y,k,S){o.save(),o.strokeStyle=S,o.lineWidth=1,o.setLineDash([4,3]),o.beginPath(),o.moveTo(y-10,k),o.lineTo(y+10,k),o.stroke(),o.setLineDash([]),o.restore()}for(let y=c;y<=d;y++){const k=r[y];if(!k||!k.bullTrap&&!k.bearTrap&&!k.normal)continue;const S=s.convertToPixel(y),M=a[y];if(M){if(k.bullTrap){const I=i.convertToPixel(M.high)-12;v(S,I,"#EF4444","bull");const T=I-16,z=`Bull Trap ${((k.score??0)*100).toFixed(0)}%`;if(g(S,T,z,"#F59E0B"),k.breakoutLevel){const j=i.convertToPixel(k.breakoutLevel);_(S,j,"#F59E0B")}}if(k.bearTrap){const I=i.convertToPixel(M.low)+12;v(S,I,"#10B981","bear");const T=I+16,z=`Bear Trap ${((k.score??0)*100).toFixed(0)}%`;if(g(S,T,z,"#34D399"),k.breakoutLevel){const j=i.convertToPixel(k.breakoutLevel);_(S,j,"#34D399")}}if(k.normal){const I=(M.high+M.low)/2,C=i.convertToPixel(I);v(S,C,"#3B82F6","normal"),g(S,C-16,"Stable","#60A5FA")}}}return!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{var c;const s=(c=e.result)==null?void 0:c[o];if(!s||!s.bullTrap&&!s.bearTrap&&!s.normal)return{values:[]};const i=s.normal?"Stable":s.bullTrap?"Bull Trap":"Bear Trap",r=s.score!==void 0?Number(s.score).toFixed(2):"—",a=s.breakoutLevel!==void 0?Number(s.breakoutLevel).toFixed(e.precision??2):"—",l=s.reversalClose!==void 0?Number(s.reversalClose).toFixed(e.precision??2):"—";return{styles:t,values:[{title:"Trap",value:i},...s.normal?[]:[{title:"Score",value:r},{title:"Level",value:a},{title:"Reversal",value:l}]]}}};function If(o,e,t){return Math.max(e,Math.min(t,o))}function Mx(o,e){const t=o.length,s=new Array(t).fill(0);if(e<=1){for(let r=0;r<t;r++)s[r]=o[r]??0;return s}let i=0;for(let r=0;r<t;r++)i+=o[r]??0,r>=e&&(i-=o[r-e]??0),s[r]=r>=e-1?i/e:0;return s}function iI(o,e){var i,r,a;const t=o.length,s=new Array(t).fill(0);for(let l=0;l<t;l++){const c=((i=o[l])==null?void 0:i.high)??0,d=((r=o[l])==null?void 0:r.low)??0;if(l===0)s[l]=Math.max(0,c-d);else{const v=((a=o[l-1])==null?void 0:a.close)??0;s[l]=Math.max(c-d,Math.abs(c-v),Math.abs(d-v))}}return Mx(s,Math.max(1,e))}function rI(o){var i,r,a;const e=o.length,t=new Array(e).fill(0);let s=0;for(let l=0;l<e;l++){if(l===0)s=0;else{const c=((i=o[l])==null?void 0:i.close)??0,d=((r=o[l-1])==null?void 0:r.close)??0,v=((a=o[l])==null?void 0:a.volume)??0;c>d?s+=v:c<d&&(s-=v)}t[l]=s}return t}function A_(o,e,t){let s=0,i=0;for(let r=e;r<=t;r++)s+=o[r]??0,i++;return i>0?s/i:0}function aI(o,e,t,s){if(t<=e)return 0;const i=(o[t]-o[e])/(t-e),r=s>0?i/(s*5):0;return If(r,-1,1)}function lI(o,e,t){var l,c;const s=Math.max(0,e-t),i=Math.max(0,e-1),r=((l=o[s])==null?void 0:l.close)??0,a=((c=o[i])==null?void 0:c.close)??0;return r<=0?0:(a-r)/r}function Fy(o,e,t,s,i,r,a){var Ce,Re,Ke,st,vt,Je,ot,nt,tt;const l=[],c=[],d=[];for(let Ze=i;Ze<=r;Ze++)l.push(((Ce=o[Ze])==null?void 0:Ce.high)??0),c.push(((Re=o[Ze])==null?void 0:Re.low)??0),d.push(((Ke=o[Ze])==null?void 0:Ke.close)??0);const v=Math.max(...l),g=Math.min(...c),_=(v+g)/2,y=v-g;if(_<=0)return null;const k=y/_;if(!isFinite(k)||k<=0||k>a.maxZoneWidthPct)return null;const S=A_(s,i,r);if(!(S>=a.minVolumeFactor))return null;const M=[];for(let Ze=i;Ze<=r;Ze++)M.push((((st=o[Ze])==null?void 0:st.high)??0)-(((vt=o[Ze])==null?void 0:vt.low)??0));const I=M.length?M.reduce((Ze,ct)=>Ze+ct,0)/M.length:0,C=A_(t,i,r);if(C>0&&I/C>1.8)return null;let T=0;for(let Ze=i;Ze<=r;Ze++){const ct=((Je=o[Ze])==null?void 0:Je.close)??0;(ot=o[Ze])==null||ot.open;const Ge=y>0?If((ct-g)/y,0,1):.5;T+=Ge}const z=T/Math.max(1,r-i+1)||.5,j=lI(o,i,a.priorTrendLookback),B=j<=-.05,$=j>=.05,F=B?If(Math.abs(j)/.15,0,1):0,V=$?If(Math.abs(j)/.15,0,1):0,K=A_(o.map(Ze=>(Ze==null?void 0:Ze.volume)??0),i,r),Y=aI(e,i,r,K),Z=If((z-.5)/.3+.5,0,1),ne=If((S-a.minVolumeFactor)/Math.max(1e-6,a.minVolumeFactor),0,1),te=.3,oe=.3,U=.2,J=.2,se=te*F+oe*If((Y-a.minOBVTrendStrength)/(1-a.minOBVTrendStrength),0,1)+U*Z+J*ne,W=te*V+oe*If((-Y-a.minOBVTrendStrength)/(1-a.minOBVTrendStrength),0,1)+U*(1-Z)+J*ne,le=If(Math.max(se,W),0,1);if(le<a.minZoneScore)return null;const ye=se>W?"accumulation":"distribution";return{startIndex:i,endIndex:r,startTime:((nt=o[i])==null?void 0:nt.timestamp)??0,endTime:((tt=o[r])==null?void 0:tt.timestamp)??0,low:g,high:v,type:ye,score:le,priorReturn:j,avgVolumeFactor:S,obvTrendScore:Y}}function $y(o,e){if(!e.mergeNearbyZones||o.length<=1)return o.slice(0,e.maxZonesDisplayed);const t=o.slice().sort((l,c)=>l.startIndex-c.startIndex),s=[],i=Math.max(2,Math.floor(e.minZoneBars/2)),r=Math.max(.01,e.maxZoneWidthPct*1.5);function a(l,c){const d=(l.low+l.high)/2,v=(c.low+c.high)/2;return d<=0||v<=0?!1:Math.abs(d-v)/((d+v)/2)<=r}for(const l of t){if(s.length===0){s.push(l);continue}const c=s[s.length-1];if(l.startIndex<=c.endIndex+i&&l.type===c.type&&a(c,l)){const v=Math.min(c.low,l.low),g=Math.max(c.high,l.high);s[s.length-1]={startIndex:Math.min(c.startIndex,l.startIndex),endIndex:Math.max(c.endIndex,l.endIndex),startTime:Math.min(c.startTime,l.startTime),endTime:Math.max(c.endTime,l.endTime),low:v,high:g,type:c.type,score:Math.max(c.score,l.score),priorReturn:Math.abs(l.score)>=Math.abs(c.score)?l.priorReturn:c.priorReturn,avgVolumeFactor:(c.avgVolumeFactor+l.avgVolumeFactor)/2,obvTrendScore:(c.obvTrendScore+l.obvTrendScore)/2}}else s.push(l)}return s.sort((l,c)=>c.score-l.score).slice(0,e.maxZonesDisplayed).sort((l,c)=>l.startIndex-c.startIndex)}const cI={name:"SMART_MONEY",shortName:"SMF",precision:2,shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,figures:[],styles:{},calc:(o,e)=>{const t=e.calcParams||[],s={zoneLookbackBars:Math.max(10,t[0]??40),minZoneBars:Math.max(3,t[1]??5),maxZoneBars:Math.max(5,t[2]??25),atrPeriod:Math.max(1,t[3]??14),volumeMAPeriod:Math.max(1,t[4]??20),minVolumeFactor:t[5]??1.2,maxZoneWidthPct:t[6]??.03,priorTrendLookback:Math.max(1,t[7]??20),minOBVTrendStrength:t[8]??.2,minZoneScore:t[9]??.6,mergeNearbyZones:(t[10]??1)>0,maxZonesDisplayed:Math.max(1,t[11]??20),showLabels:(t[12]??1)>0},i=o.length,r=new Array(i).fill({});if(i===0)return e.zones=[],e.cfg=s,r;const a=iI(o,s.atrPeriod),l=o.map(y=>(y==null?void 0:y.volume)??0),c=Mx(l,s.volumeMAPeriod),d=l.map((y,k)=>{const S=c[k]||0;return S>0?y/S:0}),v=rI(o);let g=[];for(let y=0;y<i;y++){const k=y,S=Math.min(s.zoneLookbackBars,k+1),M=[],I=s.minZoneBars,C=Math.min(s.maxZoneBars,S);if(C>=I){const T=Math.floor((I+C)/2);M.push(I),T!==I&&T!==C&&M.push(T),C!==I&&M.push(C)}for(const T of M){const z=k-T+1;if(z<0)continue;const j=Fy(o,v,a,d,z,k,s);j&&g.push(j)}}let _=$y(g,s);if(_.length===0&&i>=Math.max(60,s.minZoneBars*4)){const y={...s,maxZoneWidthPct:s.maxZoneWidthPct*2,minVolumeFactor:Math.min(s.minVolumeFactor,.9),minOBVTrendStrength:Math.max(.05,s.minOBVTrendStrength*.5),minZoneScore:Math.max(.4,s.minZoneScore-.15)};g=[];for(let k=0;k<i;k++){const S=k,M=Math.min(y.zoneLookbackBars,S+1),I=[],C=y.minZoneBars,T=Math.min(y.maxZoneBars,M);if(T>=C){const z=Math.floor((C+T)/2);I.push(C),z!==C&&z!==T&&I.push(z),T!==C&&I.push(T)}for(const z of I){const j=S-z+1;if(j<0)continue;const B=Fy(o,v,a,d,j,S,y);B&&g.push(B)}}_=$y(g,y)}return e.zones=_,e.cfg=s,r},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{const r=t.zones||[];if(!r.length)return!1;const a=t.cfg||{},l=e.getVisibleRange(),c=Math.max(0,l.from),d=l.to,v="rgba(16, 185, 129, 0.28)",g="rgba(16, 185, 129, 0.7)",_="rgba(239, 68, 68, 0.28)",y="rgba(239, 68, 68, 0.7)";o.save();for(const k of r){if(k.endIndex<c||k.startIndex>d)continue;const S=s.convertToPixel(k.startIndex),M=s.convertToPixel(k.endIndex),I=i.convertToPixel(k.high),C=i.convertToPixel(k.low);if(!isFinite(S)||!isFinite(M)||I==null||C==null)continue;const T=Math.min(S,M),z=Math.max(1,Math.abs(M-S)),j=Math.min(I,C),B=Math.abs(I-C);o.fillStyle=k.type==="accumulation"?v:_;const $=o.roundRect??o.rect;o.beginPath();try{$.call(o,T,j,z,B,4)}catch{o.rect(T,j,z,B)}if(o.closePath(),o.fill(),o.strokeStyle=k.type==="accumulation"?g:y,o.lineWidth=1.5,o.setLineDash([]),o.stroke(),a.showLabels){const F=`${k.type==="accumulation"?"Accumulation":"Distribution"} (${k.score.toFixed(2)})`,V=T+z+6,K=j+B/2;o.save(),o.font="11px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",o.textAlign="left",o.textBaseline="middle";const Y=k.type==="accumulation"?"#10B981":"#EF4444",Z="rgba(0,0,0,0.55)",ne=6,te=o.measureText(F),oe=Math.ceil(te.width)+ne*2,U=16,J=4,se=V,W=K-U/2;o.beginPath(),o.moveTo(se+J,W),o.lineTo(se+oe-J,W),o.quadraticCurveTo(se+oe,W,se+oe,W+J),o.lineTo(se+oe,W+U-J),o.quadraticCurveTo(se+oe,W+U,se+oe-J,W+U),o.lineTo(se+J,W+U),o.quadraticCurveTo(se,W+U,se,W+U-J),o.lineTo(se,W+J),o.quadraticCurveTo(se,W,se+J,W),o.closePath(),o.fillStyle=Z,o.fill(),o.fillStyle=Y,o.fillText(F,se+ne,K+.5),o.restore()}}return o.restore(),!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{const i=(e.zones||[]).find(l=>o>=l.startIndex&&o<=l.endIndex);if(!i)return{values:[]};const r=i.type==="accumulation"?"Accumulation":"Distribution",a=i.endIndex-i.startIndex+1;return{styles:t,values:[{title:"Footprint",value:r},{title:"Score",value:i.score.toFixed(2)},{title:"Price",value:`${i.low.toFixed(e.precision??2)}–${i.high.toFixed(e.precision??2)}`},{title:"Duration",value:`${a} bars`},{title:"Prior Trend",value:`${(i.priorReturn*100).toFixed(1)}%`},{title:"Avg Volume x",value:i.avgVolumeFactor.toFixed(2)},{title:"OBV Trend",value:i.obvTrendScore>.05?"Up":i.obvTrendScore<-.05?"Down":"Flat"}]}}},xc={bbPeriod:16,bbStdDev:2,atrPeriod:14,volMAPeriod:20,lookbackForNorm:60,pressureSMA:2,minPressureForAlert:.55,eruptionConfirmBars:1,minVolExpansion:1,minRangeExpansion:1,minBreakoutBodyPct:.5,breakoutLookback:10,w1:.5,w2:.3,w3:.2,minBarsBetweenEruptions:1,trendEMAPeriod:30,requireTrendAlign:0,breakoutBufferPct:7e-4,requireBBBandBreak:0,retestWindow:1};function vh(o,e,t){return Math.max(e,Math.min(t,o))}function L_(o,e){const t=new Array(o.length).fill(0);if(e<=1){for(let i=0;i<o.length;i++)t[i]=o[i]??0;return t}let s=0;for(let i=0;i<o.length;i++)s+=o[i]??0,i>=e&&(s-=o[i-e]??0),t[i]=i>=e-1?s/e:NaN;return t}function dI(o,e){const t=new Array(o.length).fill(NaN);if(e<=1)return o.map(()=>0);for(let s=0;s<o.length;s++){if(s<e-1)continue;let i=0;for(let l=s-e+1;l<=s;l++)i+=o[l]??0;const r=i/e;let a=0;for(let l=s-e+1;l<=s;l++){const c=(o[l]??0)-r;a+=c*c}t[s]=Math.sqrt(a/e)}return t}function uI(o,e){const t=new Array(o.length).fill(NaN);if(e<=1)return o.slice();const s=2/(e+1);let i=NaN;for(let r=0;r<o.length;r++){const a=o[r]??0;if(Number.isFinite(i))i=a*s+i*(1-s),t[r]=i;else if(r>=e-1){let l=0;for(let c=r-e+1;c<=r;c++)l+=o[c]??0;i=l/e,t[r]=i}}return t}function Tx(o,e){if(!o)return 0;const t=o.high??0,s=o.low??0,i=(e==null?void 0:e.close)??o.close??0;return Math.max(t-s,Math.abs(t-i),Math.abs(s-i))}function pI(o,e){const t=o.map((r,a)=>Tx(r,a>0?o[a-1]:void 0)),s=new Array(o.length).fill(NaN);if(e<=1)return t;let i=0;for(let r=0;r<t.length;r++)i+=t[r]??0,r===e-1?s[r]=i/e:r>=e&&(s[r]=((s[r-1]??0)*(e-1)+(t[r]??0))/e);return s}function Dy(o,e){const t=new Array(o.length).fill(NaN);for(let s=0;s<o.length;s++){const i=Math.max(0,s-e+1);let r=1/0;for(let a=i;a<=s;a++)Number.isFinite(o[a])&&o[a]<r&&(r=o[a]);t[s]=r===1/0?NaN:r}return t}function Ey(o,e){const t=new Array(o.length).fill(NaN);for(let s=0;s<o.length;s++){const i=Math.max(0,s-e+1);let r=-1/0;for(let a=i;a<=s;a++)Number.isFinite(o[a])&&o[a]>r&&(r=o[a]);t[s]=r===-1/0?NaN:r}return t}function Ny(o,e,t){return!Number.isFinite(e)||!Number.isFinite(t)||t===e?.5:vh((o-e)/(t-e),0,1)}function vI(o,e,t){const s=Math.max(0,e-t);let i=-1/0;for(let r=s;r<e;r++)o[r]&&(o[r].high??-1/0)>i&&(i=o[r].high);return i===-1/0?NaN:i}function fI(o,e,t){const s=Math.max(0,e-t);let i=1/0;for(let r=s;r<e;r++)o[r]&&(o[r].low??1/0)<i&&(i=o[r].low);return i===1/0?NaN:i}function Ax(o,e){const t={...xc,...e},s=o.length,i=o.map(W=>(W==null?void 0:W.close)??0),r=o.map(W=>(W==null?void 0:W.volume)??0);if(s===0)return{pressure:[],pressureSmoothed:[],eruptions:[]};const a=L_(i,t.bbPeriod),l=dI(i,t.bbPeriod),c=new Array(s).fill(NaN),d=new Array(s).fill(NaN),v=new Array(s).fill(NaN);for(let W=0;W<s;W++)if(Number.isFinite(a[W])&&Number.isFinite(l[W])){c[W]=a[W]+t.bbStdDev*l[W],d[W]=a[W]-t.bbStdDev*l[W];const le=c[W]-d[W],ye=i[W]||1;v[W]=ye!==0?le/Math.abs(ye):0}const g=Math.max(2,t.trendEMAPeriod??50),_=uI(i,g),y=pI(o,t.atrPeriod),k=y.map((W,le)=>{const ye=i[le]||1;return ye!==0?(W??0)/Math.abs(ye):0}),S=L_(r,t.volMAPeriod),M=r.map((W,le)=>{const ye=S[le]??0;return ye>0?W/ye:0}),I=Math.max(10,t.lookbackForNorm),C=Dy(v,I),T=Ey(v,I),z=Dy(k,I),j=Ey(k,I),B=new Array(s).fill(0),$=new Array(s).fill(0),F=new Array(s).fill(0);for(let W=0;W<s;W++){const le=Ny(v[W]??0,C[W],T[W]),ye=Ny(k[W]??0,z[W],j[W]);B[W]=1-le,$[W]=1-ye;const Ce=Math.max(M[W]??0,1e-8),Re=vh(1/Ce,0,2);F[W]=vh(Re/2,0,1)}const V=t.w1??.5,K=t.w2??.3,Y=t.w3??.2,Z=new Array(s).fill(0);for(let W=0;W<s;W++){const le=V*B[W]+K*$[W]+Y*F[W];Z[W]=vh(le,0,1)}const ne=L_(Z,Math.max(1,t.pressureSMA)).map(W=>Number.isFinite(W)?W:0),te=[],oe=Math.max(1,t.minBarsBetweenEruptions??8);let U=-1e4,J=!1,se=-1;for(let W=0;W<s;W++){const le=ne[W]??0;if(le>=t.minPressureForAlert?J||(J=!0,se=W):J=!1,!(J||se>=0&&W-se<=t.eruptionConfirmBars+2)||W-U<oe)continue;const Ce=Tx(o[W],W>0?o[W-1]:void 0),Re=y[W]??Ce,Ke=Re>0?Ce/Re:0;if(Ke<t.minRangeExpansion)continue;const st=M[W]??0;if(st<t.minVolExpansion)continue;const vt=o[W],Je=Math.max(0,(vt.high??0)-(vt.low??0)),ot=Math.abs((vt.close??0)-(vt.open??0));if((Je>0?ot/Je:0)<t.minBreakoutBodyPct)continue;const tt=vI(o,W,t.breakoutLookback),Ze=fI(o,W,t.breakoutLookback),ct=Math.max(0,t.breakoutBufferPct??.001),Ge=(t.requireBBBandBreak??1)>0,pt=(t.requireTrendAlign??1)>0,ce=_[W],we=W>0?_[W-1]:ce,ze=Number.isFinite(ce)&&Number.isFinite(we)&&(vt.close??0)>ce&&ce>=we,dt=Number.isFinite(ce)&&Number.isFinite(we)&&(vt.close??0)<ce&&ce<=we,qe=c[W],me=d[W];let Q=Number.isFinite(tt)&&(vt.close??0)>tt*(1+ct),it=Number.isFinite(Ze)&&(vt.close??0)<Ze*(1-ct);if(Ge&&(Q=Q&&Number.isFinite(qe)&&(vt.close??0)>qe,it=it&&Number.isFinite(me)&&(vt.close??0)<me),pt&&(Q=Q&&ze,it=it&&dt),!Q&&!it)continue;const Vt=W,wt=Math.min(s-1,Vt+Math.max(1,t.eruptionConfirmBars));let Yt=0,At=!0;const Gt=Math.max(1,t.retestWindow??2);if(Q)for(let Do=Vt;Do<=wt;Do++){const Eo=o[Do];(Eo.close??0)>=(vt.high??0)&&Yt++,Do<=Vt+Gt&&Number.isFinite(tt)&&(Eo.close??0)<tt&&(At=!1)}else if(it)for(let Do=Vt;Do<=wt;Do++){const Eo=o[Do];(Eo.close??0)<=(vt.low??0)&&Yt++,Do<=Vt+Gt&&Number.isFinite(Ze)&&(Eo.close??0)>Ze&&(At=!1)}const no=Math.ceil((wt-Vt+1)/2);if(At&&Yt>=no){const Do=Q?"bullish":"bearish",Eo=Q?tt:Ze;te.push({index:Vt,time:vt.timestamp??0,direction:Do,pressureAtSignal:le,rangeExpansion:Ke,volumeFactor:st,breakoutLevel:Eo}),U=Vt}}return{pressure:Z,pressureSmoothed:ne,eruptions:te}}const mI={name:"VOLCANIC",shortName:"VOLC",precision:2,shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,minValue:0,maxValue:1,figures:[{key:"pressure",title:"Pressure: ",type:"line"}],styles:{lines:[{color:"#60A5FA",size:2,style:Oe.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams,s={bbPeriod:(t==null?void 0:t[0])??xc.bbPeriod,bbStdDev:(t==null?void 0:t[1])??xc.bbStdDev,atrPeriod:(t==null?void 0:t[2])??xc.atrPeriod,volMAPeriod:(t==null?void 0:t[3])??xc.volMAPeriod,lookbackForNorm:(t==null?void 0:t[4])??xc.lookbackForNorm,pressureSMA:(t==null?void 0:t[5])??xc.pressureSMA,minPressureForAlert:(t==null?void 0:t[6])??xc.minPressureForAlert,eruptionConfirmBars:(t==null?void 0:t[7])??xc.eruptionConfirmBars,minVolExpansion:(t==null?void 0:t[8])??xc.minVolExpansion,minRangeExpansion:(t==null?void 0:t[9])??xc.minRangeExpansion,minBreakoutBodyPct:(t==null?void 0:t[10])??xc.minBreakoutBodyPct,breakoutLookback:(t==null?void 0:t[11])??xc.breakoutLookback,minBarsBetweenEruptions:(t==null?void 0:t[12])??xc.minBarsBetweenEruptions,trendEMAPeriod:(t==null?void 0:t[13])??xc.trendEMAPeriod??30,requireTrendAlign:(t==null?void 0:t[14])??xc.requireTrendAlign??0,breakoutBufferPct:(t==null?void 0:t[15])??xc.breakoutBufferPct??7e-4,requireBBBandBreak:(t==null?void 0:t[16])??xc.requireBBBandBreak??0,retestWindow:(t==null?void 0:t[17])??xc.retestWindow??1},{pressureSmoothed:i}=Ax(o,s);return i.map(r=>({pressure:Number.isFinite(r)?r:null}))},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var T,z,j,B,$,F,V;const a=t.result;if(!a||a.length===0)return!1;const l=e.getVisibleRange(),c=Math.max(0,l.from),d=Math.min(a.length-1,l.to),v=t.calcParams,g=(v==null?void 0:v[6])??xc.minPressureForAlert,_=((j=(z=(T=t.styles)==null?void 0:T.lines)==null?void 0:z[0])==null?void 0:j.color)||"#60A5FA",y="#F59E0B",k=((F=($=(B=t.styles)==null?void 0:B.lines)==null?void 0:$[0])==null?void 0:F.size)||2;o.save(),o.lineCap="round",o.lineJoin="round";const S=r.convertToPixel(g);S!==null&&(o.strokeStyle="#9CA3AF",o.lineWidth=1,o.setLineDash([4,4]),o.beginPath(),o.moveTo(s.left,S),o.lineTo(s.left+s.width,S),o.stroke(),o.setLineDash([]));let M=null,I=null,C=null;for(let K=c;K<=d;K++){const Y=((V=a[K])==null?void 0:V.pressure)??null;if(Y==null){M=I=C=null;continue}const Z=i.convertToPixel(K),ne=r.convertToPixel(Y);if(Z===null||ne===null){M=I=C=null;continue}if(M!==null&&I!==null&&C!==null){const te=(C+Y)/2;o.strokeStyle=te>=g?y:_,o.lineWidth=k,o.beginPath(),o.moveTo(M,I),o.lineTo(Z,ne),o.stroke()}M=Z,I=ne,C=Y}return o.restore(),!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{const s=e.result[o];if(!s)return{values:[]};const i=e.calcParams,r=(i==null?void 0:i[6])??xc.minPressureForAlert,a=s.pressure!==null&&s.pressure!==void 0?Number(s.pressure).toFixed(2):"—";return{styles:t,values:[{title:"Pressure",value:a},{title:"Alert ≥",value:Number(r).toFixed(2)}]}}},gI={name:"VOLCANIC_SIG",shortName:"VOLCSIG",precision:2,shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,figures:[],styles:{texts:[{color:"#ffffff",size:10}]},calc:(o,e)=>{const t=e.calcParams,s={bbPeriod:(t==null?void 0:t[0])??xc.bbPeriod,bbStdDev:(t==null?void 0:t[1])??xc.bbStdDev,atrPeriod:(t==null?void 0:t[2])??xc.atrPeriod,volMAPeriod:(t==null?void 0:t[3])??xc.volMAPeriod,lookbackForNorm:(t==null?void 0:t[4])??xc.lookbackForNorm,pressureSMA:(t==null?void 0:t[5])??xc.pressureSMA,minPressureForAlert:(t==null?void 0:t[6])??xc.minPressureForAlert,eruptionConfirmBars:(t==null?void 0:t[7])??xc.eruptionConfirmBars,minVolExpansion:(t==null?void 0:t[8])??xc.minVolExpansion,minRangeExpansion:(t==null?void 0:t[9])??xc.minRangeExpansion,minBreakoutBodyPct:(t==null?void 0:t[10])??xc.minBreakoutBodyPct,breakoutLookback:(t==null?void 0:t[11])??xc.breakoutLookback,minBarsBetweenEruptions:(t==null?void 0:t[12])??xc.minBarsBetweenEruptions,trendEMAPeriod:(t==null?void 0:t[13])??xc.trendEMAPeriod??30,requireTrendAlign:(t==null?void 0:t[14])??xc.requireTrendAlign??0,breakoutBufferPct:(t==null?void 0:t[15])??xc.breakoutBufferPct??7e-4,requireBBBandBreak:(t==null?void 0:t[16])??xc.requireBBBandBreak??0,retestWindow:(t==null?void 0:t[17])??xc.retestWindow??1},{eruptions:i}=Ax(o,s),r=new Array(o.length).fill(null).map(()=>({}));return i.forEach(a=>{const l=r[a.index]||{};a.direction==="bullish"&&(l.bull=!0),a.direction==="bearish"&&(l.bear=!0),l.pressure=a.pressureAtSignal,l.rangeExpansion=a.rangeExpansion,l.volumeFactor=a.volumeFactor,l.breakoutLevel=a.breakoutLevel,r[a.index]=l}),r},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{const r=t.result;if(!r||r.length===0)return!1;const a=e.getDataList(),l=e.getVisibleRange(),c=Math.max(0,l.from),d=Math.min(r.length-1,l.to);function v(_,y,k,S){o.save(),o.fillStyle=k,o.beginPath(),S?(o.moveTo(_,y+6),o.lineTo(_-5,y-4),o.lineTo(_+5,y-4)):(o.moveTo(_,y-6),o.lineTo(_-5,y+4),o.lineTo(_+5,y+4)),o.closePath(),o.fill(),o.restore()}function g(_,y,k,S){o.save(),o.font="11px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",o.textAlign="center",o.textBaseline="middle";const M=6,I=16,C=o.measureText(k),T=Math.ceil(C.width)+M*2,z=4,j=_-T/2,B=y-I/2;o.fillStyle="rgba(0,0,0,0.6)",o.beginPath(),o.moveTo(j+z,B),o.lineTo(j+T-z,B),o.quadraticCurveTo(j+T,B,j+T,B+z),o.lineTo(j+T,B+I-z),o.quadraticCurveTo(j+T,B+I,j+T-z,B+I),o.lineTo(j+z,B+I),o.quadraticCurveTo(j,B+I,j,B+I-z),o.lineTo(j,B+z),o.quadraticCurveTo(j,B,j+z,B),o.closePath(),o.fill(),o.fillStyle=S,o.fillText(k,_,y+.5),o.restore()}for(let _=c;_<=d;_++){const y=r[_];if(!y||!y.bull&&!y.bear)continue;const k=s.convertToPixel(_),S=a[_];if(S){if(y.bull){const M=i.convertToPixel(S.low)+12;v(k,M,"#F59E0B",!0),g(k,M+16,"Volcanic Move (Bullish)","#F59E0B")}if(y.bear){const M=i.convertToPixel(S.high)-12;v(k,M,"#EF4444",!1),g(k,M-16,"Volcanic Move (Bearish)","#EF4444")}}}return!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{var c;const s=(c=e.result)==null?void 0:c[o];if(!s||!s.bull&&!s.bear)return{values:[]};const i=s.bull?"Bullish":"Bearish",r=s.pressure!==void 0?Number(s.pressure).toFixed(2):"—",a=s.rangeExpansion!==void 0?Number(s.rangeExpansion).toFixed(2):"—",l=s.volumeFactor!==void 0?Number(s.volumeFactor).toFixed(2):"—";return{styles:t,values:[{title:"Eruption",value:i},{title:"Pressure",value:r},{title:"Range x",value:a},{title:"Volume x",value:l}]}}};function hI(o,e,t,s,i,r,a){const l=s*.4,c=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.lineJoin="round",o.beginPath(),o.moveTo(e-l,t-c),o.lineTo(e+l,t+c),o.moveTo(e+l,t-c),o.lineTo(e-l,t+c),o.stroke(),o.restore()}function _I(o,e,t,s,i,r,a){const l=s*.4,c=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.beginPath(),o.ellipse(e,t,l,c,0,0,Math.PI*2),o.stroke(),o.restore()}const yI={name:"PNF",shortName:"P&F",calcParams:[],figures:[],calc:(o,e)=>o.map(t=>{const s=t==null?void 0:t._pnf;return s?{direction:s.direction,boxes:s.boxes,upColor:s.upColor,downColor:s.downColor,boxSize:s.boxSize}:{}}),draw:o=>{var I,C;const{ctx:e,visibleRange:t,indicator:s,xAxis:i,yAxis:r}=o,a=s.result||[];if(!(i!=null&&i.convertToPixel)||!(r!=null&&r.convertToPixel))return!1;const l=i.convertToPixel(0),c=i.convertToPixel(1),d=Math.max(1,Math.abs(c-l));let v=d;for(const T of a)if(T!=null&&T.boxes&&T.boxes.length>=2&&(r!=null&&r.convertToPixel)){const z=T.boxes[0],j=T.boxes[1],B=r.convertToPixel(z.price),$=r.convertToPixel(j.price);if(B!==void 0&&$!==void 0&&!isNaN(B)&&!isNaN($)){const F=Math.abs(B-$);if(F>0){v=F;break}}}if(v===d){const T=a.find(z=>(z==null?void 0:z.boxSize)&&z.boxSize>0);if(T!=null&&T.boxSize){const z=((C=(I=T.boxes)==null?void 0:I[0])==null?void 0:C.price)||100,j=r.convertToPixel(z),B=r.convertToPixel(z+T.boxSize);if(j!==void 0&&B!==void 0&&!isNaN(j)&&!isNaN(B)){const $=Math.abs(j-B);$>0&&(v=$)}}}const g=d*.85,_=v*.85,y=(g+_)/2,k=Math.max(.8,y*.08),S=(t==null?void 0:t.from)||0,M=(t==null?void 0:t.to)||a.length;for(let T=S;T<M;T++){const z=a[T];if(!z||!z.boxes||!Array.isArray(z.boxes))continue;const{direction:j,boxes:B,upColor:$="#00E6D8",downColor:F="#FF4D4D"}=z,V=i.convertToPixel(T);if(!(V===void 0||isNaN(V)))for(const K of B){const Y=r.convertToPixel(K.price);Y===void 0||isNaN(Y)||(j==="up"?hI(e,V,Y,g,_,$,k):_I(e,V,Y,g,_,F,k))}}return!1}},bI=[kP,SP,PP,IP,Px,AP,zP,FP,$P,EP,jP,RP,BP,OP,VP,qP,HP,GP,UP,KP,ZP,JP,QP,eI,nI,cI,mI,gI,yI];function xI(o,e){e?console.log(o,e):console.log(o)}function _0(){return Date.now()}function Ug(o,e){const t=o.country||"__";return`${o.ticker}_${t}_${e}`}function Yg(o){return{key:o.key,symbol:o.symbol.ticker,timeframe:o.timeframe,candles:o.candles,oldestTimestampLoaded:o.oldest,newestTimestampLoaded:o.newest,isComplete:o.isComplete,isRunning:o.isRunning,pipelineStarts:o.starts,apiCalls:o.apiCalls,lastUpdatedAt:o.lastUpdatedAt,error:o.error}}function wI(o,e){var i;let t=0,s=o.length;for(;t<s;){const r=t+s>>>1;(((i=o[r])==null?void 0:i.timestamp)??0)>=e?s=r:t=r+1}return t}function jy(o,e){return o<=0?Promise.resolve():new Promise((t,s)=>{const i=setTimeout(t,o);if(!e)return;const r=()=>{clearTimeout(i),s(new DOMException("Aborted","AbortError"))};if(e.aborted)return r();e.addEventListener("abort",r,{once:!0})})}class kI{constructor(e,t={}){ve(this,"entries",new Map);ve(this,"fetchPage");ve(this,"opt");this.fetchPage=e,this.opt={maxKeys:t.maxKeys??16,ttlMs:t.ttlMs??20*6e4,initialLimit:t.initialLimit??600,pageLimit:t.pageLimit??800,pageDelayMs:t.pageDelayMs??75,maxRetries:t.maxRetries??2,retryBaseDelayMs:t.retryBaseDelayMs??400,log:t.log??xI}}start(e,t){const s=Ug(e,t),i=this.getOrCreate(e,t);return this.touch(i),this.ensureRunning(i),{key:s,getSnapshot:()=>this.getSnapshot(e,t),subscribe:r=>this.subscribe(e,t,r)}}getSnapshot(e,t){const s=Ug(e,t),i=this.entries.get(s);return i?(this.touch(i),Yg(i)):{key:s,symbol:e.ticker,timeframe:t,candles:[],oldestTimestampLoaded:null,newestTimestampLoaded:null,isComplete:!1,isRunning:!1,pipelineStarts:0,apiCalls:0,lastUpdatedAt:0,error:null}}async waitForInitial(e,t){const s=this.getOrCreate(e,t);return this.touch(s),this.ensureRunning(s),await this.ensureInitialLoaded(s,s.generation),Yg(s)}requestVisibleRange(e){const t=this.entries.get(Ug(e.symbol,e.timeframe));if(!t||t.candles.length===0)return[];this.touch(t);const s=wI(t.candles,e.beforeTimestamp),i=Math.max(0,s-Math.max(1,e.limit));return t.candles.slice(i,s)}stopSymbol(e){for(const t of this.entries.values())t.symbol.ticker===e&&this.stopEntry(t)}stopAll(){for(const e of this.entries.values())this.stopEntry(e)}clear(){this.stopAll(),this.entries.clear()}subscribe(e,t,s){const i=this.getOrCreate(e,t);this.touch(i),i.subs.add(s);try{s(Yg(i))}catch{}return()=>{i.subs.delete(s)}}getMetrics(){const e=[];for(const t of this.entries.values())e.push({key:t.key,pipelineStarts:t.starts,apiCalls:t.apiCalls,isRunning:t.isRunning,isComplete:t.isComplete,error:t.error});return e}emit(e){const t=Yg(e);for(const s of e.subs)try{s(t)}catch{}}touch(e){e.lastAccessAt=_0(),this.entries.get(e.key)===e&&(this.entries.delete(e.key),this.entries.set(e.key,e)),this.evictIfNeeded()}evictIfNeeded(){const e=_0()-this.opt.ttlMs;for(;;){const t=this.entries.keys().next().value;if(!t)break;const s=this.entries.get(t);if(!s){this.entries.delete(t);continue}if(s.lastAccessAt>=e)break;this.stopEntry(s),this.entries.delete(t)}for(;this.entries.size>this.opt.maxKeys;){const t=this.entries.keys().next().value;if(!t)break;const s=this.entries.get(t);if(!s){this.entries.delete(t);continue}this.stopEntry(s),this.entries.delete(t)}}getOrCreate(e,t){const s=Ug(e,t),i=this.entries.get(s);if(i)return i;const r={key:s,symbol:e,timeframe:t,candles:[],ts:new Set,oldest:null,newest:null,isComplete:!1,isRunning:!1,starts:0,apiCalls:0,lastUpdatedAt:0,lastAccessAt:_0(),error:null,nextSkip:0,generation:0,initialPromise:null,runPromise:null,abort:null,subs:new Set};return this.entries.set(s,r),r}ensureRunning(e){if(e.isComplete||e.runPromise)return;e.isRunning=!0,e.error=null,e.generation+=1,e.starts+=1,e.abort||(e.abort=new AbortController);const t=e.generation;this.opt.log("📡 [pipeline:start]",{key:e.key,gen:t});const s=this.runLoop(e,t).finally(()=>{e.runPromise===s&&(e.runPromise=null),e.isRunning=!1,e.abort=null,this.emit(e),this.opt.log("⏹️ [pipeline:stop]",{key:e.key,gen:t,complete:e.isComplete})});e.runPromise=s}stopEntry(e){var t;e.generation+=1,e.isRunning=!1,e.initialPromise=null;try{(t=e.abort)==null||t.abort()}catch{}e.abort=null}async ensureInitialLoaded(e,t){e.candles.length>0||e.isComplete||(e.initialPromise||(e.initialPromise=(async()=>{const s=e.abort??new AbortController;e.abort=s;const i=e.nextSkip,r=this.opt.initialLimit;try{const a=await this.fetchPageWithRetry(e,{skip:i,limit:r,gen:t,signal:s.signal});if(e.generation!==t)return;this.mergePage(e,a),e.nextSkip=i+a.length,this.emit(e)}finally{e.initialPromise=null}})()),await e.initialPromise.catch(()=>{}))}async runLoop(e,t){for(await this.ensureInitialLoaded(e,t);e.isRunning&&!e.isComplete&&e.generation===t;){const s=e.abort??new AbortController;e.abort=s;const i=e.nextSkip,r=this.opt.pageLimit;let a=[];try{a=await this.fetchPageWithRetry(e,{skip:i,limit:r,gen:t,signal:s.signal})}catch(l){if(e.generation!==t||l instanceof DOMException&&l.name==="AbortError")return;e.error=l instanceof Error?l.message:"Fetch failed",this.emit(e);return}if(e.generation!==t)return;if(!a||a.length===0){e.isComplete=!0,this.emit(e);return}this.mergePage(e,a),e.nextSkip=i+a.length,this.emit(e),await jy(this.opt.pageDelayMs,s.signal).catch(()=>{})}}async fetchPageWithRetry(e,t){let s=0;for(;;)try{e.apiCalls+=1,this.opt.log("🌐 [pipeline:page]",{key:e.key,skip:t.skip,limit:t.limit,calls:e.apiCalls});const i=await this.fetchPage({symbol:e.symbol,timeframe:e.timeframe,skip:t.skip,limit:t.limit,signal:t.signal});return e.lastUpdatedAt=_0(),e.error=null,Array.isArray(i)?i:[]}catch(i){if(i instanceof DOMException&&i.name==="AbortError"||e.generation!==t.gen||s>=this.opt.maxRetries)throw i;const r=this.opt.retryBaseDelayMs*Math.pow(2,s);s+=1,await jy(r,t.signal)}}mergePage(e,t){if(!Array.isArray(t)||t.length===0)return;const s=[];for(const i of t){const r=i==null?void 0:i.timestamp;typeof r=="number"&&(e.ts.has(r)||(e.ts.add(r),s.push(i),(e.oldest==null||r<e.oldest)&&(e.oldest=r),(e.newest==null||r>e.newest)&&(e.newest=r)))}if(s.length>0){if(s.sort((i,r)=>i.timestamp-r.timestamp),e.candles.length===0)e.candles=s;else{const i=new Array(e.candles.length+s.length);let r=0,a=0,l=0;for(;r<e.candles.length&&a<s.length;)e.candles[r].timestamp<=s[a].timestamp?i[l++]=e.candles[r++]:i[l++]=s[a++];for(;r<e.candles.length;)i[l++]=e.candles[r++];for(;a<s.length;)i[l++]=s[a++];i.length=l,e.candles=i}e.lastUpdatedAt=_0()}}}class SI{constructor(){ve(this,"_prevSymbol");ve(this,"_ws");ve(this,"listens",{});ve(this,"polygonApiKey","k2hPDhLy8gIpP4lMCU0gwo92xNRxE2XI");ve(this,"currentPriceCache",new Map);ve(this,"pipeline");this.pipeline=new kI(this.fetchHistoryPage.bind(this),{initialLimit:800,pageLimit:1e3,pageDelayMs:60,maxKeys:24,ttlMs:25*6e4})}async getHistoryKLineData({symbol:e,period:t,from:s,to:i,strategy:r}){const a=(t==null?void 0:t.timeframe)||"1m",c=(await this.pipeline.waitForInitial(e,a)).candles;if(c.length>0){const d=c[c.length-1].close;this.currentPriceCache.set(e.ticker,d)}return{data:c.slice(),lays:[]}}startBackgroundPrefetch(e,t){this.pipeline.start(e,t.timeframe)}hasMoreServerHistory(e,t){return!this.pipeline.getSnapshot(e,t.timeframe).isComplete}async loadMoreHistoricalData(e,t,s,i=2){return{data:this.pipeline.requestVisibleRange({symbol:e,timeframe:t.timeframe,beforeTimestamp:s,limit:350}),lays:[]}}removeDuplicateData(e){const t=new Set;return e.filter(s=>t.has(s[0])?!1:(t.add(s[0]),!0))}getTimeframeInMs(e){return e.endsWith("m")?parseInt(e.slice(0,-1))*60*1e3:e.endsWith("h")?parseInt(e.slice(0,-1))*60*60*1e3:e.endsWith("d")?parseInt(e.slice(0,-1))*24*60*60*1e3:e.endsWith("w")?parseInt(e.slice(0,-1))*7*24*60*60*1e3:60*1e3}canLoadMoreData(e,t){const s=this.pipeline.getSnapshot(e,t.timeframe);return s.candles.length>0&&!s.isComplete}convertResolutionForStockNow(e){return e==="1d"?"1D":e==="1w"?"1W":e==="1M"?"1M":e.endsWith("m")?e.slice(0,-1):e.endsWith("h")?(parseInt(e.slice(0,-1))*60).toString():e.endsWith("d")?(parseInt(e.slice(0,-1))*24*60).toString():e.endsWith("w")?(parseInt(e.slice(0,-1))*7*24*60).toString():e}async fetchHistoryPage(e){const t=this.convertResolutionForStockNow(e.timeframe),s=encodeURIComponent(e.symbol.ticker),i=e.symbol.country||"BD",l=`https://noti.dutyai.app${`/finance/get/chart/${s}/${t}?skip=${e.skip}&limit=${e.limit}&country=${i}`}`,c=await fetch(l,{signal:e.signal});if(!c.ok)return[];const d=await c.text();if(!d||d.trim()==="")return[];try{const v=JSON.parse(d);return Array.isArray(v)?v:[]}catch{return[]}}async getSymbols(){console.log("🚀 getSymbols() method called");try{console.log("🌐 Fetching symbols from API...");const s=await fetch("https://noti.dutyai.app"+"/finance/get/stock/list/latest");if(!s.ok)return console.warn(`⚠️ API request failed with status: ${s.status}`),[];let i=await s.json();if(!Array.isArray(i))return console.warn("⚠️ API response is not an array, using fallback symbols"),[];i.push({ticker:"DSEX",name:"Dhaka Stock Exchange",shortName:"DSEX",market:"stock",exchange:"DSEBD",priceCurrency:"BDT",type:"stock",logo:"",country:"BD"}),console.log(`📊 Received ${i.length} symbols from API`);const a=i.map(l=>({ticker:l.symbol||l.ticker||"",name:l.description||l.fullName||l.name||l.symbol||l.ticker||"",shortName:l.name||l.symbol||l.ticker||"",market:"stock",country:l.country||"BD",exchange:l.exchange||"UNKNOWN",priceCurrency:l.currency||(l.country==="US"?"USD":"BDT"),type:l.type||"stock",logo:l.logo?l.logo.trim():l.symbol||l.ticker?`https://s3-api.bayah.app/cdn/symbol/logo/${l.symbol||l.ticker}.svg`:"",logo2:l.logo2})).filter(l=>l.ticker&&l.ticker.trim()!=="");return console.log(`✅ Successfully processed ${a.length} valid symbols`),console.log("📋 Sample symbols:",a.slice(0,5)),a.length>0?a:[]}catch(e){return console.error("❌ Error fetching symbols from API:",e),console.log("🔄 Falling back to hardcoded symbols"),[]}}watch(e,t){var s;this._ws&&((s=this._ws)==null||s.send(JSON.stringify({action:"watch",key:e})),this.listens[e]=t)}subscribe(e,t){var i;if(((i=this._prevSymbol)==null?void 0:i.ticker)===e.ticker)return;this._prevSymbol=e,this.unsubscribe(),console.log(`Subscribing to real-time updates for ${e.ticker}`);const s=setInterval(()=>{const r=this.currentPriceCache.get(e.ticker)||Math.random()*100+10,a=(Math.random()-.5)*2,l=r+a;this.currentPriceCache.set(e.ticker,l);const d=[Date.now(),r,Math.max(r,l)+Math.random()*.5,Math.min(r,l)-Math.random()*.5,l,Math.random()*1e3];t({bars:[d],secs:1})},2e3);this.listens[e.ticker]=s}unsubscribe(e){this._ws&&(this._ws.close(),this._ws=void 0),Object.values(this.listens).forEach(s=>{typeof s=="number"&&clearInterval(s)}),this.listens={};const t=e==null?void 0:e.ticker;t&&this.pipeline.stopSymbol(t)}getCurrentPrice(e){return this.currentPriceCache.get(e)||null}clearCache(){this.pipeline.clear(),this.currentPriceCache.clear()}getPipelineMetrics(){return this.pipeline.getMetrics()}stopSymbolPipelines(e){this.pipeline.stopSymbol(e)}stopAllPipelines(){this.pipeline.stopAll()}getHistorySnapshot(e,t){return this.pipeline.getSnapshot(e,t)}async ensureHistoryBefore(e,t,s,i=2500){if(!(e!=null&&e.ticker))return this.pipeline.getSnapshot(e,t);this.pipeline.start(e,t);const r=l=>{const c=l.oldestTimestampLoaded;return typeof s!="number"||!Number.isFinite(s)||s<=0?l.candles.length>0:c!=null&&c<=s},a=this.pipeline.getSnapshot(e,t);return r(a)||a.isComplete?a:await new Promise(l=>{let c=!1,d=null,v=null;const g=_=>{if(!c){c=!0;try{d&&clearTimeout(d)}catch{}try{v==null||v()}catch{}l(_)}};v=this.pipeline.subscribe(e,t,_=>{(r(_)||_.isComplete||_.error)&&g(_)}),d=setTimeout(()=>{g(this.pipeline.getSnapshot(e,t))},Math.max(100,i))})}async ensureHistoryCovers(e,t,s,i,r=3500){if(!(e!=null&&e.ticker))return this.pipeline.getSnapshot(e,t);this.pipeline.start(e,t);const a=c=>{const d=c.oldestTimestampLoaded,v=c.newestTimestampLoaded;return typeof s!="number"||!Number.isFinite(s)||s<=0||typeof i!="number"||!Number.isFinite(i)||i<=0?c.candles.length>0:d!=null&&v!=null&&d<=s&&v>=i},l=this.pipeline.getSnapshot(e,t);return a(l)||l.isComplete?l:await new Promise(c=>{let d=!1,v=null,g=null;const _=y=>{if(!d){d=!0;try{v&&clearTimeout(v)}catch{}try{g==null||g()}catch{}c(y)}};g=this.pipeline.subscribe(e,t,y=>{(a(y)||y.isComplete||y.error)&&_(y)}),v=setTimeout(()=>{_(this.pipeline.getSnapshot(e,t))},Math.max(100,r))})}}var CI=Bi('<path d="M12.41465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L12.41465,12C12.20873,12.5826,11.65311,13,11,13C10.34689,13,9.79127,12.5826,9.58535,12L3.5,12C3.223857,12,3,11.77614,3,11.5C3,11.22386,3.223857,11,3.5,11L9.58535,11C9.79127,10.417404,10.34689,10,11,10C11.65311,10,12.20873,10.417404,12.41465,11Z" stroke-opacity="0" stroke="none"></path>'),PI=Bi('<g transform="scale(0.7857142857)"><path fill="currentColor" stroke="currentColor" stroke-width="1" d="M2 9.75a1.5 1.5 0 0 0-1.5 1.5v5.5a1.5 1.5 0 0 0 1.5 1.5h24a1.5 1.5 0 0 0 1.5-1.5v-5.5a1.5 1.5 0 0 0-1.5-1.5zm0 1h3v2.5h1v-2.5h3.25v3.9h1v-3.9h3.25v2.5h1v-2.5h3.25v3.9h1v-3.9H22v2.5h1v-2.5h3a.5.5 0 0 1 .5.5v5.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-5.5a.5.5 0 0 1 .5-.5z" transform="rotate(-45 14 14)"></path></g>'),II=Bi('<path d="M21,5.5C21,6.32843,20.3284,7,19.5,7C19.4136,7,19.3289,6.99269,19.2465,6.97866L15.6257,15.5086C15.8587,15.7729,16,16.119999999999997,16,16.5C16,17.328400000000002,15.3284,18,14.5,18C13.8469,18,13.2913,17.5826,13.0854,17L3.91465,17C3.70873,17.5826,3.15311,18,2.5,18C1.671573,18,1,17.328400000000002,1,16.5C1,15.6716,1.671573,15,2.5,15C2.5840199999999998,15,2.66643,15.0069,2.74668,15.0202L6.36934,6.48574C6.13933,6.22213,6,5.87733,6,5.5C6,4.671573,6.67157,4,7.5,4C8.15311,4,8.70873,4.417404,8.91465,5L18.0854,5C18.2913,4.417404,18.8469,4,19.5,4C20.3284,4,21,4.671573,21,5.5ZM18.0854,6L8.91465,6C8.892579999999999,6.06243,8.8665,6.12296,8.83672,6.18128L13.9814,15.0921C14.143,15.0325,14.3177,15,14.5,15C14.584,15,14.6664,15.0069,14.7467,15.0202L18.3693,6.48574C18.2462,6.3446,18.149,6.1802,18.0854,6ZM13.2036,15.745L8.0861,6.8811800000000005C7.90605,6.95768,7.70797,7,7.5,7C7.41359,7,7.32888,6.99269,7.24647,6.97866L3.62571,15.5086C3.7512,15.651,3.8501,15.8174,3.91465,16L13.0854,16C13.1169,15.9108,13.1566,15.8255,13.2036,15.745Z" stroke-opacity="0" stroke="none"></path>'),MI=Bi('<path d="M9.474616630859375,7.494615087890625L8.844736630859375,7.494615087890625L8.844736630859375,4.149892087890625L8.000006630859374,4.634915087890625L8.004896630859374,4.005035087890625L9.020516630859376,3.414215087890625L9.474616630859375,3.414215087890625L9.474616630859375,7.494615087890625ZM18.529296630859378,4.8318550878906255Q18.307996630859375,5.028795087890625,18.122396630859377,5.385245087890625Q17.868496630859376,5.019035087890625,17.629196630859376,4.8269750878906255Q17.389996630859375,4.634915087890625,17.168596630859376,4.634915087890625Q16.794296630859375,4.634915087890625,16.522496630859376,4.976715087890625Q16.252296630859377,5.3168850878906255,16.252296630859377,5.7856350878906255Q16.252296630859377,6.218575087890625,16.502896630859375,6.521315087890625Q16.755196630859373,6.822415087890625,17.114896630859377,6.822415087890625Q17.368796630859375,6.822415087890625,17.588596630859374,6.625475087890624Q17.809896630859377,6.428535087890625,17.998696630859374,6.0688350878906245Q18.249396630859373,6.439935087890625,18.488596630859377,6.631985087890625Q18.727896630859377,6.822415087890625,18.952496630859375,6.822415087890625Q19.326796630859373,6.822415087890625,19.596996630859376,6.482245087890625Q19.868796630859375,6.140455087890626,19.868796630859375,5.671705087890626Q19.868796630859375,5.238755087890625,19.618196630859376,4.937655087890625Q19.367496630859375,4.634915087890625,19.006196630859375,4.634915087890625Q18.750696630859377,4.634915087890625,18.529296630859378,4.8318550878906255ZM18.337296630859377,5.674955087890625L18.278696630859375,5.596835087890625Q18.449596630859375,5.272935087890625,18.622096630859374,5.1101750878906245Q18.794596630859374,4.947415087890625,18.967096630859373,4.947415087890625Q19.194996630859375,4.947415087890625,19.346396630859374,5.1345950878906255Q19.497696630859377,5.320135087890625,19.497696630859377,5.598455087890625Q19.497696630859377,5.8914250878906245,19.360996630859376,6.096505087890625Q19.224296630859374,6.301585087890626,19.027396630859375,6.301585087890626Q18.915096630859374,6.301585087890626,18.742496630859375,6.146965087890624Q18.569996630859375,5.992335087890625,18.337296630859377,5.674955087890625ZM17.785496630859377,5.779125087890625L17.842496630859372,5.857245087890625Q17.668296630859373,6.186025087890625,17.495796630859374,6.348785087890625Q17.324896630859374,6.509915087890625,17.153996630859375,6.509915087890625Q16.926096630859377,6.509915087890625,16.774796630859377,6.324375087890624Q16.623396630859375,6.137195087890625,16.623396630859375,5.858875087890625Q16.623396630859375,5.565905087890625,16.761696630859376,5.360825087890625Q16.900096630859373,5.1557550878906255,17.095396630859376,5.1557550878906255Q17.228896630859374,5.1557550878906255,17.365596630859375,5.2778250878906245Q17.502296630859377,5.399895087890625,17.785496630859377,5.779125087890625ZM10.710296630859375,10.634915087890626C10.710296630859375,11.024655087890626,10.561656630859375,11.379685087890625,10.317976630859375,11.646395087890625L12.879196630859376,15.171615087890626C12.985696630859374,15.147615087890625,13.096496630859376,15.134915087890626,13.210296630859375,15.134915087890626C13.306796630859376,15.134915087890626,13.401096630859374,15.144015087890624,13.492596630859374,15.161415087890624L16.819096630859377,11.196955087890625C16.748996630859374,11.023375087890624,16.710296630859375,10.833655087890625,16.710296630859375,10.634915087890626C16.710296630859375,9.806495087890625,17.381896630859373,9.134915087890626,18.210296630859375,9.134915087890626C19.038696630859373,9.134915087890626,19.710296630859375,9.806495087890625,19.710296630859375,10.634915087890626C19.710296630859375,11.463345087890625,19.038696630859373,12.134915087890626,18.210296630859375,12.134915087890626C17.949796630859375,12.134915087890626,17.704796630859377,12.068505087890625,17.491296630859374,11.951675087890624L14.364996630859375,15.677415087890624C14.580596630859375,15.937215087890625,14.710296630859375,16.270915087890625,14.710296630859375,16.634915087890626C14.710296630859375,17.463315087890624,14.038696630859375,18.134915087890626,13.210296630859375,18.134915087890626C12.381866630859374,18.134915087890626,11.710296630859375,17.463315087890624,11.710296630859375,16.634915087890626C11.710296630859375,16.284415087890626,11.830486630859374,15.962015087890626,12.031896630859375,15.706715087890625L9.425686630859374,12.119565087890624C9.355346630859376,12.129685087890625,9.283436630859375,12.134915087890626,9.210296630859375,12.134915087890626C8.872396630859374,12.134915087890626,8.560596630859376,12.023195087890626,8.309816630859375,11.834665087890626L5.215876630859375,15.521915087890624C5.519506630859375,15.796415087890624,5.710296630859375,16.193415087890624,5.710296630859375,16.634915087890626C5.710296630859375,17.463315087890624,5.038726630859375,18.134915087890626,4.210296630859375,18.134915087890626C3.381869630859375,18.134915087890626,2.710296630859375,17.463315087890624,2.710296630859375,16.634915087890626C2.710296630859375,15.806515087890626,3.381869630859375,15.134915087890626,4.210296630859375,15.134915087890626C4.218546630859375,15.134915087890626,4.226776630859375,15.135015087890626,4.234996630859375,15.135115087890625L7.744116630859375,10.953115087890625C7.721966630859375,10.850565087890626,7.710296630859375,10.744105087890624,7.710296630859375,10.634915087890626C7.710296630859375,9.806495087890625,8.381866630859374,9.134915087890626,9.210296630859375,9.134915087890626C10.038726630859376,9.134915087890626,10.710296630859375,9.806495087890625,10.710296630859375,10.634915087890626Z" stroke-opacity="0" stroke="none"></path>'),TI=Bi('<path d="M17.0643,7.033864912109375L18,3.585784912109375L14.5078,4.509695912109375L15.3537,5.344934912109375L6.02026,14.560584912109375C5.87635,14.517484912109374,5.72366,14.494284912109375,5.5655,14.494284912109375C4.7009,14.494284912109375,4,15.186384912109375,4,16.040084912109375C4,16.893784912109375,4.7009,17.585784912109375,5.5655,17.585784912109375C6.43011,17.585784912109375,7.13101,16.893784912109375,7.13101,16.040084912109375C7.13101,15.722284912109375,7.03392,15.426984912109376,6.86744,15.181384912109374L16.0917,6.073604912109375L17.0643,7.033864912109375Z" stroke-opacity="0" stroke="none"></path>'),AI=Bi('<g transform="scale(0.7857142857)" fill="none"><path stroke="currentColor" d="M16 14a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4.5 14a9.5 9.5 0 0 1 18.7-2.37 2.5 2.5 0 0 0 0 4.74A9.5 9.5 0 0 1 4.5 14Zm19.7 2.5a10.5 10.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"></path><path fill="currentColor" d="M22.5 14a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></g>'),LI=Bi('<path d="M18.8532,7.020985087890625Q19.0257,6.734525087890625,19.0257,6.369945087890625Q19.0257,6.020005087890625,18.8499,5.754705087890625Q18.6758,5.489415087890626,18.3649,5.339675087890625Q18.5944,5.209465087890625,18.7214,4.994615087890625Q18.8499,4.779775087890625,18.8499,4.5193550878906255Q18.8499,4.2003480878906245,18.7002,3.951324087890625Q18.5505,3.700673087890625,18.277,3.557444087890625Q18.0052,3.414215087890625,17.6455,3.414215087890625Q17.285800000000002,3.414215087890625,17.0107,3.557444087890625Q16.7357,3.700673087890625,16.5843,3.951324087890625Q16.4346,4.2003480878906245,16.4346,4.5193550878906255Q16.4346,4.779775087890625,16.561500000000002,4.994615087890625Q16.6901,5.209465087890625,16.919600000000003,5.339675087890625Q16.6055,5.489415087890626,16.4297,5.757965087890625Q16.255499999999998,6.024895087890625,16.255499999999998,6.369945087890625Q16.255499999999998,6.734525087890625,16.4297,7.020985087890625Q16.6055,7.305815087890625,16.919600000000003,7.465325087890625Q17.2354,7.624825087890625,17.6455,7.624825087890625Q18.0557,7.624825087890625,18.3682,7.465325087890625Q18.6807,7.305815087890625,18.8532,7.020985087890625ZM8.76432,7.559725087890625L8.13444,7.559725087890625L8.13444,4.214996087890625L7.28971,4.700025087890625L7.2946,4.070139087890625L8.310220000000001,3.479319087890625L8.76432,3.479319087890625L8.76432,7.559725087890625ZM17.1816,4.955555087890625Q17.0042,4.784655087890625,17.0042,4.5095950878906255Q17.0042,4.229645087890625,17.18,4.057119087890625Q17.355800000000002,3.884592087890625,17.6455,3.884592087890625Q17.935200000000002,3.884592087890625,18.1077,4.057119087890625Q18.2803,4.229645087890625,18.2803,4.5095950878906255Q18.2803,4.784655087890625,18.1045,4.955555087890625Q17.930300000000003,5.124825087890625,17.6455,5.124825087890625Q17.3607,5.124825087890625,17.1816,4.955555087890625ZM18.2217,5.7953950878906255Q18.4398,6.005365087890625,18.4398,6.3552950878906245Q18.4398,6.705235087890625,18.2217,6.915195087890625Q18.0052,7.125155087890625,17.6455,7.125155087890625Q17.285800000000002,7.125155087890625,17.067700000000002,6.915195087890625Q16.849600000000002,6.705235087890625,16.849600000000002,6.3552950878906245Q16.849600000000002,6.005365087890625,17.064500000000002,5.7953950878906255Q17.2793,5.585435087890625,17.6455,5.585435087890625Q18.0052,5.585435087890625,18.2217,5.7953950878906255ZM9.60768,11.711495087890626C9.85136,11.444785087890626,10,11.089765087890626,10,10.700025087890625C10,9.871595087890626,9.32843,9.200025087890625,8.5,9.200025087890625C7.67157,9.200025087890625,7,9.871595087890626,7,10.700025087890625C7,10.809205087890625,7.01167,10.915665087890625,7.03382,11.018215087890624L3.5247,15.200215087890625C3.51648,15.200115087890625,3.5082500000000003,15.200015087890625,3.5,15.200015087890625C2.671573,15.200015087890625,2,15.871615087890625,2,16.700015087890627C2,17.528415087890625,2.671573,18.200015087890627,3.5,18.200015087890627C4.32843,18.200015087890627,5,17.528415087890625,5,16.700015087890627C5,16.258515087890625,4.80921,15.861515087890625,4.50558,15.587015087890626L7.59952,11.899765087890625C7.8503,12.088295087890625,8.162099999999999,12.200025087890625,8.5,12.200025087890625C8.57314,12.200025087890625,8.645050000000001,12.194785087890626,8.71539,12.184675087890625L11.3216,15.771815087890625C11.12019,16.027215087890625,11,16.349515087890623,11,16.700015087890627C11,17.528415087890625,11.67157,18.200015087890627,12.5,18.200015087890627C13.3284,18.200015087890627,14,17.528415087890625,14,16.700015087890627C14,16.336015087890623,13.8703,16.002315087890626,13.6547,15.742515087890625L16.781,12.016775087890625C16.994500000000002,12.133605087890626,17.2395,12.200025087890625,17.5,12.200025087890625C18.3284,12.200025087890625,19,11.528445087890624,19,10.700025087890625C19,9.871595087890626,18.3284,9.200025087890625,17.5,9.200025087890625C16.671599999999998,9.200025087890625,16,9.871595087890626,16,10.700025087890625C16,10.898765087890624,16.0387,11.088475087890625,16.108800000000002,11.262055087890625L12.7823,15.226515087890625C12.6908,15.209115087890625,12.5965,15.200015087890625,12.5,15.200015087890625C12.3862,15.200015087890625,12.2754,15.212715087890626,12.1689,15.236715087890625L9.60768,11.711495087890626Z" stroke-opacity="0" stroke="none"></path>'),zI=Bi('<ellipse cx="10.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="17.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="10.5" cy="11.5" rx="7" ry="7" fill="none" stroke="currentColor" stroke-width="0.5"></ellipse><ellipse cx="10.5" cy="11.5" rx="5" ry="5" fill="none" stroke="currentColor" stroke-width="0.5"></ellipse><ellipse cx="10.5" cy="11.5" rx="3" ry="3" fill="none" stroke="currentColor" stroke-width="0.5"></ellipse>',1),FI=Bi('<path d="M17,4.5C17,5.32843,16.328400000000002,6,15.5,6C15.0931,6,14.7241,5.83802,14.4539,5.57503L5.98992,8.32515C5.99658,8.38251,6,8.440850000000001,6,8.5C6,9.15311,5.582599999999999,9.70873,5,9.91465L5,11.08535C5.42621,11.236,5.763999999999999,11.57379,5.91465,12L19.5,12C19.7761,12,20,12.22386,20,12.5C20,12.77614,19.7761,13,19.5,13L5.91465,13C5.70873,13.5826,5.15311,14,4.5,14C3.671573,14,3,13.3284,3,12.5C3,11.84689,3.417404,11.29127,4,11.08535L4,9.91465C3.417404,9.70873,3,9.15311,3,8.5C3,7.67157,3.671573,7,4.5,7C4.90411,7,5.2709,7.15981,5.5406200000000005,7.41967L14.0093,4.66802C14.0032,4.6128599999999995,14,4.5568,14,4.5C14,3.671573,14.6716,3,15.5,3C16.328400000000002,3,17,3.671573,17,4.5ZM4,15.5C4,15.2239,4.22386,15,4.5,15L19.5,15C19.7761,15,20,15.2239,20,15.5C20,15.7761,19.7761,16,19.5,16L4.5,16C4.22386,16,4,15.7761,4,15.5ZM4,18.5C4,18.2239,4.22386,18,4.5,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L4.5,19C4.22386,19,4,18.7761,4,18.5Z" stroke-opacity="0" stroke="none"></path>'),$I=Bi('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M21 15H3a1 1 0 0 1 0-2h18a1 1 0 0 1 0 2Zm-2-3a2.99 2.99 0 0 1-2.816-2H3a1 1 0 0 1 0-2h13.184A2.995 2.995 0 1 1 19 12Zm0-4a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm2-3H3a1 1 0 0 1 0-2h18a1 1 0 1 1 0 2ZM5 16a2.99 2.99 0 0 1 2.816 2H21a1 1 0 0 1 0 2H7.816A2.995 2.995 0 1 1 5 16Zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path></g>'),DI=Bi('<path d="M4,17.0854L4,3.5C4,3.223858,4.22386,3,4.5,3C4.77614,3,5,3.223858,5,3.5L5,10L7.57584,10L9.8127,4.46359C9.91614,4.20756,10.20756,4.08386,10.46359,4.1873000000000005C10.71963,4.29075,10.84333,4.58216,10.73988,4.8382000000000005L8.65438,10L11.08535,10C11.29127,9.4174,11.84689,9,12.5,9C12.65154,9,12.79784,9.02247,12.93573,9.06427L16.6464,5.35355C16.8417,5.15829,17.1583,5.15829,17.3536,5.35355C17.5488,5.54882,17.5488,5.8654,17.3536,6.06066L13.7475,9.66675C13.907,9.90508,14,10.19168,14,10.5C14,11.15311,13.5826,11.70873,13,11.91465L13,14.3638L18.3714,12.1936C18.6274,12.09015,18.918799999999997,12.21385,19.0222,12.46989C19.1257,12.72592,19.002,13.0173,18.746000000000002,13.1208L13,15.4423L13,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L5.91465,19C5.70873,19.5826,5.15311,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.846899999999998,3.417404,17.2913,4,17.0854ZM6.3729499999999994,17.0413L12,14.7678L12,11.91465C11.88136,11.87271,11.76956,11.81627,11.66675,11.74746L6.3729499999999994,17.0413ZM12,15.8463L6.6694700000000005,18L12,18L12,15.8463ZM6.38629,15.6137L8.250350000000001,11L11,11L6.38629,15.6137ZM5,11L7.17182,11L5,16.3754L5,11Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),EI=Bi('<path d="M3,7.32468C5.90649,3.3893050000000002,11.49833,2.81306,14.6674,6.31944C14.9056,6.1554199999999994,15.192,6.05979,15.5,6.05979C15.845,6.05979,16.1628,6.17974,16.4162,6.381349999999999L18.4509,4.23827L19,4.816615L16.8945,7.03429C16.962600000000002,7.21075,17,7.40319,17,7.60463C17,8.45782,16.328400000000002,9.14947,15.5,9.14947C14.6716,9.14947,14,8.45782,14,7.60463C14,7.36402,14.0534,7.13625,14.1487,6.93322C11.32695,3.748365,6.25159,4.253956,3.612785,7.82695L3,7.32468ZM14.09,15.4717C15.7427,13.78985,16.244500000000002,11.524740000000001,15.5633,9.30134L15.5618,9.30134L16.3012,9.0502C17.072400000000002,11.56646,16.497700000000002,14.158,14.6282,16.0599C12.28737,18.442,8.62386,18.6988,6.41348,16.4501C4.5526,14.5572,4.52076,11.19671,6.36766,9.3177C7.89069,7.76754,10.07544,7.706189999999999,11.56741,9.22363C11.95453,9.61742,12.24817,10.08363,12.43369,10.57677L14.1451,8.77421L14.6942,9.35256L12.64982,11.50582C12.65827,11.59712,12.66295,11.68839,12.66378,11.77936C12.87398,12.04523,13,12.38451,13,12.7541C13,13.60729,12.32843,14.2989,11.5,14.2989C10.67157,14.2989,10,13.60729,10,12.7541C10,11.90091,10.67157,11.20926,11.5,11.20926C11.60387,11.20926,11.70528,11.220130000000001,11.8032,11.240829999999999L11.81763,11.22564C11.69858,10.71874,11.42858,10.21929,11.0284,9.81179C9.844000000000001,8.60765,8.136890000000001,8.65592,6.90822,9.90586C5.37975,11.460930000000001,5.40693,14.288,6.95404,15.8619C8.84598,17.7867,12.03496,17.5626,14.09,15.4717Z" stroke-opacity="0" stroke="none"></path>'),NI=Bi('<path d="M8.13444,7.494615087890625L8.76432,7.494615087890625L8.76432,3.414215087890625L8.310220000000001,3.414215087890625L7.2946,4.005035087890625L7.28971,4.634915087890625L8.13444,4.149892087890625L8.13444,7.494615087890625ZM18.832,6.929835087890625Q19.0046,6.635245087890625,19.0046,6.2543850878906255Q19.0046,5.889805087890625,18.8451,5.5952050878906245Q18.6855,5.3006050878906255,18.3975,5.132965087890625Q18.1094,4.9653250878906245,17.7399,4.9653250878906245Q17.435499999999998,4.9653250878906245,17.1556,5.149245087890625L17.2793,3.939931087890625L18.8304,3.939931087890625L18.8304,3.414215087890625L16.7406,3.414215087890625L16.5094,5.665195087890625L17.0156,5.795405087890625Q17.095399999999998,5.655425087890626,17.2516,5.570795087890625Q17.4095,5.484525087890625,17.6357,5.484525087890625Q17.9694,5.484525087890625,18.1842,5.697745087890625Q18.4007,5.909335087890625,18.4007,6.2543850878906255Q18.4007,6.604315087890625,18.1842,6.822415087890625Q17.9694,7.0405150878906255,17.6292,7.0405150878906255Q17.3298,7.0405150878906255,17.119799999999998,6.890775087890625Q16.9098,6.739415087890626,16.825200000000002,6.474115087890625L16.3597,6.749175087890626Q16.470399999999998,7.110505087890624,16.807299999999998,7.335115087890625Q17.144199999999998,7.559725087890625,17.6292,7.559725087890625Q18.0296,7.559725087890625,18.3438,7.392075087890625Q18.6595,7.224435087890625,18.832,6.929835087890625ZM10,10.634915087890626C10,11.024655087890626,9.85136,11.379685087890625,9.60768,11.646395087890625L12.1689,15.171615087890626C12.2754,15.147615087890625,12.3862,15.134915087890626,12.5,15.134915087890626C12.5965,15.134915087890626,12.6908,15.144015087890624,12.7823,15.161415087890624L16.108800000000002,11.196955087890625C16.0387,11.023375087890624,16,10.833655087890625,16,10.634915087890626C16,9.806495087890625,16.671599999999998,9.134915087890626,17.5,9.134915087890626C18.3284,9.134915087890626,19,9.806495087890625,19,10.634915087890626C19,11.463345087890625,18.3284,12.134915087890626,17.5,12.134915087890626C17.2395,12.134915087890626,16.994500000000002,12.068505087890625,16.781,11.951675087890624L13.6547,15.677415087890624C13.8703,15.937215087890625,14,16.270915087890625,14,16.634915087890626C14,17.463315087890624,13.3284,18.134915087890626,12.5,18.134915087890626C11.67157,18.134915087890626,11,17.463315087890624,11,16.634915087890626C11,16.284415087890626,11.12019,15.962015087890626,11.3216,15.706715087890625L8.71539,12.119565087890624C8.645050000000001,12.129685087890625,8.57314,12.134915087890626,8.5,12.134915087890626C8.162099999999999,12.134915087890626,7.8503,12.023195087890626,7.59952,11.834665087890626L4.50558,15.521915087890624C4.80921,15.796415087890624,5,16.193415087890624,5,16.634915087890626C5,17.463315087890624,4.32843,18.134915087890626,3.5,18.134915087890626C2.671573,18.134915087890626,2,17.463315087890624,2,16.634915087890626C2,15.806515087890626,2.671573,15.134915087890626,3.5,15.134915087890626C3.5082500000000003,15.134915087890626,3.51648,15.135015087890626,3.5247,15.135115087890625L7.03382,10.953115087890625C7.01167,10.850565087890626,7,10.744105087890624,7,10.634915087890626C7,9.806495087890625,7.67157,9.134915087890626,8.5,9.134915087890626C9.32843,9.134915087890626,10,9.806495087890625,10,10.634915087890626Z" stroke-opacity="0" stroke="none"></path>'),jI=Bi('<path d="M20,3.5C20,4.15311,19.5826,4.70873,19,4.91465L19,18.5C19,18.7761,18.7761,19,18.5,19L4.91465,19C4.70873,19.5826,4.15311,20,3.5,20C2.671573,20,2,19.3284,2,18.5C2,17.846899999999998,2.417404,17.2913,3,17.0854L3,3.5C3,3.22386,3.22386,3,3.5,3L17.0854,3C17.2913,2.417404,17.846899999999998,2,18.5,2C19.3284,2,20,2.671573,20,3.5ZM17.0854,4C17.236,4.42621,17.5738,4.763999999999999,18,4.91465L18,8L14,8L14,4L17.0854,4ZM13,4L13,8L9,8L9,4L13,4ZM13,9L9,9L9,13L13,13L13,9ZM13,14L9,14L9,18L13,18L13,14ZM14,18L14,14L18,14L18,18L14,18ZM18,13L14,13L14,9L18,9L18,13ZM4.91465,18C4.763999999999999,17.5738,4.42621,17.236,4,17.0854L4,14L8,14L8,18L4.91465,18ZM4,8L4,4L8,4L8,8L4,8ZM8,9L8,13L4,13L4,9L8,9Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),RI=Bi('<path d="M6.91465,11L11.08535,11C11.29127,10.417404,11.84689,10,12.5,10C13.15311,10,13.70873,10.417404,13.91465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L13.91465,12C13.70873,12.5826,13.15311,13,12.5,13C11.84689,13,11.29127,12.5826,11.08535,12L6.91465,12C6.70873,12.5826,6.15311,13,5.5,13C4.671573,13,4,12.32843,4,11.5C4,10.671573,4.671573,10,5.5,10C6.15311,10,6.70873,10.417404,6.91465,11Z" stroke-opacity="0" stroke="none"></path>'),BI=Bi('<path d="M6.91465,12.5C6.70873,13.0826,6.15311,13.5,5.5,13.5C4.671573,13.5,4,12.82843,4,12C4,11.171573,4.671573,10.5,5.5,10.5C6.15311,10.5,6.70873,10.917404,6.91465,11.5L16.0853,11.5C16.2913,10.917404,16.846899999999998,10.5,17.5,10.5C18.328400000000002,10.5,19,11.171573,19,12C19,12.82843,18.328400000000002,13.5,17.5,13.5C16.846899999999998,13.5,16.2913,13.0826,16.0853,12.5L6.91465,12.5Z" stroke-opacity="0" stroke="none"></path>'),OI=Bi('<path d="M5.80417,14.9887L4.62563,16.167299999999997C4.43037,16.3625,4.43037,16.6791,4.62563,16.8744C4.82089,17.0696,5.13748,17.0696,5.332739999999999,16.8744L6.62638,15.5807C7.75595,16.290100000000002,9.19328,16.7929,11,16.7929C16.165399999999998,16.7929,18.3323,12.64289,18.8866,11.36789C19.0378,10.99289,19.0378,10.59289,18.8866,10.21789C18.5549,9.45486,17.6456,7.66212,15.8617,6.34545L17.3536,4.853553C17.5488,4.658291,17.5488,4.341709,17.3536,4.146447C17.1583,3.9511845,16.8417,3.9511845,16.6464,4.146447L15.0014,5.7915399999999995C13.9314,5.1969,12.61166,4.792893,11,4.792893C5.80945,4.792893,3.667717,8.94289,3.113386,10.21789C2.9622049,10.59289,2.9622049,10.99289,3.113386,11.36789C3.424435,12.08333,4.2353000000000005,13.70399,5.80417,14.9887ZM7.36012,14.847C8.32327,15.4074,9.52286,15.7929,11,15.7929C15.5606,15.7929,17.4756,12.11789,17.9543,10.99289C18.0047,10.86789,18.0047,10.74289,17.9543,10.61789C17.659,9.90846,16.8171,8.23812,15.1447,7.06241L12.96929,9.23782C13.3134,9.66543,13.5197,10.20642,13.5197,10.79289C13.5197,12.16789,12.38583,13.29289,11,13.29289C10.41596,13.29289,9.87667,13.09308,9.44815,12.75896L7.36012,14.847ZM8.794609999999999,11.99829L6.520099999999999,14.2728C5.06905,13.12119,4.32057,11.628250000000001,4.04567,10.96789C3.995275,10.84289,3.995275,10.71789,4.04567,10.59289C4.52441,9.46789,6.43937,5.79289,11,5.79289C12.28868,5.79289,13.3661,6.086320000000001,14.2596,6.53329L12.19759,8.5953C11.84086,8.40257,11.43271,8.29289,11,8.29289C9.61417,8.29289,8.480319999999999,9.41789,8.480319999999999,10.79289C8.480319999999999,11.22918,8.594470000000001,11.64029,8.794609999999999,11.99829ZM10.16528,12.04183C10.404869999999999,12.20032,10.692070000000001,12.29289,11,12.29289C11.8315,12.29289,12.51181,11.61789,12.51181,10.79289C12.51181,10.48318,12.41593,10.194600000000001,12.25216,9.95494L10.16528,12.04183ZM11.43602,9.35687L9.55616,11.236740000000001C9.512,11.09633,9.48819,10.94724,9.48819,10.79289C9.48819,9.96789,10.1685,9.29289,11,9.29289C11.15142,9.29289,11.29782,9.31528,11.43602,9.35687Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),VI=Bi('<path d="M11,17C5.80945,17,3.667717,12.85,3.113386,11.575C2.9622047,11.2,2.9622047,10.8,3.113386,10.425C3.667717,9.15,5.80945,5,11,5C16.165399999999998,5,18.3323,9.15,18.8866,10.425C19.0378,10.8,19.0378,11.2,18.8866,11.575C18.3323,12.85,16.165399999999998,17,11,17ZM4.04567,10.8C3.995276,10.925,3.995276,11.05,4.04567,11.175C4.52441,12.325,6.43937,16,11,16C15.5606,16,17.4756,12.325,17.9543,11.2C18.0047,11.075,18.0047,10.95,17.9543,10.825C17.4756,9.675,15.5606,6,11,6C6.43937,6,4.52441,9.675,4.04567,10.8ZM11,13.5C9.61417,13.5,8.480319999999999,12.375,8.480319999999999,11C8.480319999999999,9.625,9.61417,8.5,11,8.5C12.38583,8.5,13.5197,9.625,13.5197,11C13.5197,12.375,12.38583,13.5,11,13.5ZM11,9.5C10.1685,9.5,9.48819,10.175,9.48819,11C9.48819,11.825,10.1685,12.5,11,12.5C11.8315,12.5,12.51181,11.825,12.51181,11C12.51181,10.175,11.8315,9.5,11,9.5Z" fill-opacity="1" stroke="currentColor" stroke-width="1"></path>'),WI=Bi('<defs><clipPath id="master_svg0_151_625"><rect x="0" y="0" width="22" height="22" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_151_625)"><path d="M14.5385,9.76923L15.6538,9.76923C16.6538,9.76923,17.4615,10.576920000000001,17.4615,11.576920000000001L17.4615,17.1923C17.4615,18.1923,16.6538,19,15.6538,19L5.80769,19C4.807692,19,4,18.1923,4,17.1923L4,11.576920000000001C4,10.576920000000001,4.807692,9.76923,5.80769,9.76923L7.23077,9.76923L7.23077,7.576919999999999C7.23077,5.61538,8.88462,4,10.88462,4C12.88462,4,14.5385,5.61538,14.5385,7.576919999999999L14.5385,9.76923ZM10.88461,5.15385C9.5,5.15385,8.38461,6.23077,8.38461,7.576919999999999L8.38461,9.76923L13.38462,9.76923L13.38462,7.576919999999999C13.38462,6.23077,12.26923,5.15385,10.88461,5.15385ZM15.6538,17.8462C16,17.8462,16.3077,17.5385,16.3077,17.1923L16.3077,11.576920000000001C16.3077,11.23077,16,10.923079999999999,15.6538,10.923079999999999L5.80769,10.923079999999999C5.46154,10.923079999999999,5.15385,11.23077,5.15385,11.576920000000001L5.15385,17.1923C5.15385,17.5385,5.46154,17.8462,5.80769,17.8462L15.6538,17.8462ZM10.153839999999999,12.65385C10.153839999999999,12.34615,10.42307,12.07692,10.73076,12.07692C11.038450000000001,12.07692,11.307680000000001,12.34615,11.307680000000001,12.65385L11.307680000000001,14.5769C11.307680000000001,14.8846,11.038450000000001,15.1538,10.73076,15.1538C10.42307,15.1538,10.153839999999999,14.8846,10.153839999999999,14.5769L10.153839999999999,12.65385Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></g>',1),qI=Bi('<path d="M19.6401,7.99355C20.4028,7.92291,21,7.2811900000000005,21,6.5C21,5.671573,20.3284,5,19.5,5C18.8469,5,18.2913,5.417404,18.0854,6L7.62067,6C7.34453,6,7.12067,6.22386,7.12067,6.5C7.12067,6.5479,7.12741,6.59423,7.13999,6.63809L3.2294099999999997,15.0243C2.530138,15.1517,2,15.764,2,16.5C2,17.328400000000002,2.671573,18,3.5,18C4.15311,18,4.70873,17.5826,4.91465,17L14.5963,17C14.6456,17.076,14.7162,17.1396,14.8044,17.1807C15.0546,17.2974,15.3521,17.1891,15.4688,16.9388L19.6401,7.99355ZM14.7896,16.0293L18.6551,7.739599999999999C18.3942,7.56144,18.1925,7.30307,18.0854,7L8.0746,7L4.25044,15.2009C4.55701,15.3784,4.79493,15.6613,4.91465,16L14.6207,16C14.68,16,14.7368,16.0103,14.7896,16.0293Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),HI=Bi('<path d="M3.3367688759765626,12.63173C3.5320318759765623,12.82699,3.8486138759765627,12.82699,4.043876875976562,12.63173L11.822052875976562,4.853553C12.017312875976563,4.658291,12.017312875976563,4.341708,11.822052875976562,4.146446C11.626792875976562,3.9511843,11.310202875976563,3.9511843,11.114942875976563,4.146446L3.3367688759765626,11.92462C3.1415071759765625,12.11988,3.1415071759765625,12.43647,3.3367688759765626,12.63173ZM5.001492875976562,17.0351C4.806232875976562,16.8399,4.806232875976562,16.5233,5.001492875976562,16.328L7.304532875976562,14.025C7.210822875976563,13.82916,7.158352875976563,13.60984,7.158352875976563,13.37827C7.158352875976563,12.54984,7.829922875976562,11.87827,8.658352875976561,11.87827C8.889922875976563,11.87827,9.109232875976563,11.93075,9.305052875976562,12.02446L11.304532875976562,10.02498C11.210822875976563,9.82916,11.158352875976561,9.60984,11.158352875976561,9.37827C11.158352875976561,8.54984,11.829922875976562,7.8782700000000006,12.658352875976563,7.8782700000000006C12.889922875976563,7.8782700000000006,13.109232875976563,7.93075,13.305022875976562,8.024460000000001L15.608122875976562,5.72142C15.803322875976562,5.5261499999999995,16.119922875976563,5.5261499999999995,16.315222875976563,5.72142C16.510422875976563,5.9166799999999995,16.510422875976563,6.23326,16.315222875976563,6.42852L14.012122875976562,8.73156C14.105822875976562,8.92738,14.158322875976562,9.1467,14.158322875976562,9.37827C14.158322875976562,10.2067,13.486822875976562,10.87827,12.658352875976563,10.87827C12.426772875976562,10.87827,12.207452875976562,10.82579,12.011642875976563,10.73209L10.012162875976562,12.73156C10.105872875976562,12.92738,10.158352875976561,13.1467,10.158352875976561,13.37827C10.158352875976561,14.2067,9.486772875976563,14.8783,8.658352875976561,14.8783C8.426772875976562,14.8783,8.207452875976562,14.8258,8.011642875976563,14.7321L5.708602875976562,17.0351C5.513342875976562,17.2304,5.196752875976562,17.2304,5.001492875976562,17.0351ZM10.415712875976563,18.328C10.220452875976562,18.5233,9.903862875976563,18.5233,9.708602875976563,18.328C9.513342875976562,18.1328,9.513342875976562,17.816200000000002,9.708602875976563,17.6209L12.304532875976562,15.025C12.210822875976563,14.8292,12.158352875976563,14.6098,12.158352875976563,14.3783C12.158352875976563,13.54984,12.829922875976562,12.87827,13.658322875976562,12.87827C13.889922875976563,12.87827,14.109222875976563,12.93075,14.305022875976562,13.02446L17.486822875976564,9.84274C17.682022875976564,9.64747,17.99862287597656,9.64747,18.19392287597656,9.84274C18.38912287597656,10.038,18.38912287597656,10.35458,18.19392287597656,10.54984L15.012122875976562,13.73156C15.105822875976562,13.92738,15.158322875976562,14.1467,15.158322875976562,14.3783C15.158322875976562,15.2067,14.486822875976562,15.8783,13.658322875976562,15.8783C13.426822875976562,15.8783,13.207422875976562,15.8258,13.011642875976563,15.7321L10.415712875976563,18.328Z" stroke-opacity="0" stroke="none"></path>'),GI=Bi('<path d="M3.146447,14.178126025390625C2.9511847,13.982826025390626,2.9511847,13.666226025390625,3.146447,13.470926025390625L7.39146,9.225966025390626C7.35417,9.095106025390624,7.33421,8.956946025390625,7.33421,8.814116025390625C7.33421,7.985696025390625,8.00578,7.314116025390625,8.834209999999999,7.314116025390625C8.97703,7.314116025390625,9.11519,7.334086025390625,9.24605,7.371366025390625L13.753,2.864373025390625C13.9483,2.669110325390625,14.2649,2.669110325390625,14.4602,2.864373025390625C14.6554,3.059635025390625,14.6554,3.376217025390625,14.4602,3.571479025390625L10.06916,7.962476025390625C10.23631,8.204386025390626,10.334209999999999,8.497826025390625,10.334209999999999,8.814116025390625C10.334209999999999,9.642546025390626,9.66264,10.314116025390625,8.834209999999999,10.314116025390625C8.51791,10.314116025390625,8.22448,10.216226025390625,7.98256,10.049076025390626L3.853554,14.178126025390625C3.658291,14.373326025390625,3.341709,14.373326025390625,3.146447,14.178126025390625ZM7.67736,19.188526025390626C7.4821,18.993226025390626,7.4821,18.676626025390625,7.67736,18.481426025390626L9.9804,16.178326025390625C9.88669,15.982526025390625,9.834209999999999,15.763226025390624,9.834209999999999,15.531626025390626C9.834209999999999,14.703226025390626,10.50578,14.031626025390626,11.33421,14.031626025390626C11.56579,14.031626025390626,11.78511,14.084126025390624,11.98093,14.177826025390624L13.9804,12.178356025390626C13.8867,11.982536025390624,13.8342,11.763216025390625,13.8342,11.531636025390625C13.8342,10.703206025390624,14.5058,10.031636025390625,15.3342,10.031636025390625C15.5658,10.031636025390625,15.7851,10.084116025390625,15.9809,10.177826025390626L18.284,7.874796025390625C18.4792,7.679536025390625,18.7958,7.679536025390625,18.9911,7.874796025390625C19.1863,8.070056025390624,19.1863,8.386636025390626,18.9911,8.581906025390625L16.688000000000002,10.884936025390624C16.7817,11.080756025390626,16.8342,11.300066025390626,16.8342,11.531636025390625C16.8342,12.360066025390624,16.162599999999998,13.031626025390626,15.3342,13.031626025390626C15.1026,13.031626025390626,14.8833,12.979126025390626,14.6875,12.885426025390625L12.68803,14.884926025390625C12.78174,15.080726025390625,12.83421,15.300026025390626,12.83421,15.531626025390626C12.83421,16.360026025390624,12.16264,17.031626025390626,11.33421,17.031626025390626C11.10264,17.031626025390626,10.88333,16.979126025390627,10.68751,16.885426025390625L8.38446,19.188526025390626C8.1892,19.383726025390626,7.87262,19.383726025390626,7.67736,19.188526025390626Z" stroke-opacity="0" stroke="none"></path>'),UI=Bi('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="m2.285 10.333 8.048-8.048a.977.977 0 1 1 1.381 1.381l-8.048 8.049a.977.977 0 0 1-1.381-1.382Zm10 10 8.048-8.048a.977.977 0 1 1 1.381 1.381l-8.048 8.049a.977.977 0 0 1-1.381-1.382ZM19 8a2.966 2.966 0 0 1-1.308-.312l-10 10c.202.408.307.857.308 1.312a3.03 3.03 0 1 1-1.693-2.689l10-10A2.993 2.993 0 1 1 19 8ZM5 18a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM19 4a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"></path></g>'),YI=Bi('<path d="M6.91465,13.00505L18.5,13.00505C18.7761,13.00505,19,13.228909999999999,19,13.50505C19,13.781189999999999,18.7761,14.00505,18.5,14.00505L6.91465,14.00505C6.70873,14.58765,6.15311,15.00505,5.5,15.00505C4.671573,15.00505,4,14.33348,4,13.50505C4,12.67662,4.671573,12.00505,5.5,12.00505C6.15311,12.00505,6.70873,12.422450000000001,6.91465,13.00505ZM7.81404,11.625L10.48591,11.625L10.48591,10.90625L9.65193,10.90625L9.65193,7.125L8.997630000000001,7.125C8.71443,7.306641,8.415600000000001,7.419922,7.96443,7.498047L7.96443,8.05078L8.77497,8.05078L8.77497,10.90625L7.81404,10.90625L7.81404,11.625ZM11.081620000000001,11.625L14.0562,11.625L14.0562,10.88281L13.09724,10.88281C12.8863,10.88281,12.59333,10.90625,12.36482,10.93555C13.17537,10.11328,13.84724,9.2207,13.84724,8.39062C13.84724,7.541016,13.28865,7,12.4488,7C11.84333,7,11.446850000000001,7.234375,11.03279,7.679688L11.52497,8.16797C11.747630000000001,7.914062,12.0113,7.697266,12.33552,7.697266C12.7613,7.697266,13.00154,7.982422,13.00154,8.43359C13.00154,9.14648,12.29255,10.00781,11.081620000000001,11.11523L11.081620000000001,11.625ZM15.9605,11.75C16.8121,11.75,17.526899999999998,11.2832,17.526899999999998,10.4375C17.526899999999998,9.82031,17.142200000000003,9.43945,16.6441,9.30078L16.6441,9.27148C17.1129,9.08594,17.3824,8.7207,17.3824,8.21289C17.3824,7.421875,16.8004,7,15.9429,7C15.4215,7,14.9957,7.210938,14.6109,7.541016L15.066,8.11133C15.3258,7.849609,15.5836,7.697266,15.9019,7.697266C16.2789,7.697266,16.4957,7.914062,16.4957,8.28125C16.4957,8.70898,16.2301,9,15.4215,9L15.4215,9.63672C16.3804,9.63672,16.6383,9.91992,16.6383,10.38086C16.6383,10.79688,16.3336,11.03125,15.8824,11.03125C15.4742,11.03125,15.1578,10.82227,14.8922,10.55078L14.4781,11.13281C14.7906,11.486329999999999,15.2652,11.75,15.9605,11.75Z" stroke-opacity="0" stroke="none"></path>'),KI=Bi('<g transform="scale(0.7857142857)" fill="currentColor" fill-rule="nonzero"><path d="M8.354 20.354l5-5-.707-.707-5 5z"></path><path d="M16.354 12.354l8-8-.707-.707-8 8z"></path><path d="M14.5 15c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM6.5 23c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g>'),ZI=Bi('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M3 6C3 7.30622 3.83481 8.41746 5 8.82929V15.1707C3.83481 15.5825 3 16.6938 3 18C3 19.6569 4.34315 21 6 21C7.30622 21 8.41746 20.1652 8.82929 19H15.1707C15.5825 20.1652 16.6938 21 18 21C19.6569 21 21 19.6569 21 18C21 16.6938 20.1652 15.5825 19 15.1707V8.82929C20.1652 8.41746 21 7.30622 21 6C21 4.34315 19.6569 3 18 3C16.6938 3 15.5825 3.83481 15.1707 5H8.82929C8.41746 3.83481 7.30622 3 6 3C4.34315 3 3 4.34315 3 6ZM6 7C6.55228 7 7 6.55228 7 6C7 5.44772 6.55228 5 6 5C5.44772 5 5 5.44772 5 6C5 6.55228 5.44772 7 6 7ZM17 15.1707V8.82929C16.1476 8.52801 15.472 7.85242 15.1707 7H8.82929C8.52801 7.85241 7.85241 8.52801 7 8.82929V15.1707C7.85241 15.472 8.52801 16.1476 8.82929 17H15.1707C15.472 16.1476 16.1476 15.472 17 15.1707ZM18 7C18.5523 7 19 6.55228 19 6C19 5.44772 18.5523 5 18 5C17.4477 5 17 5.44772 17 6C17 6.55228 17.4477 7 18 7ZM7 18C7 18.5523 6.55228 19 6 19C5.44772 19 5 18.5523 5 18C5 17.4477 5.44772 17 6 17C6.55228 17 7 17.4477 7 18ZM19 18C19 18.5523 18.5523 19 18 19C17.4477 19 17 18.5523 17 18C17 17.4477 17.4477 17 18 17C18.5523 17 19 17.4477 19 18Z"></path></g>'),XI=Bi('<path d="M16.966900000000003,8.67144C16.6669,8.67144,16.4247,8.91558,16.4247,9.21802L16.4247,16.631500000000003C16.4247,17.322,16.007199999999997,17.9068,15.5139,17.9068L13.93072,17.9068L13.93072,9.2162C13.93072,8.91741,13.68675,8.67144,13.38855,8.67144C13.09036,8.67144,12.84639,8.91741,12.84639,9.21802L12.84639,17.9068L10.151810000000001,17.9068L10.151810000000001,9.21802C10.151810000000001,8.91741,9.90783,8.67144,9.609639999999999,8.67144C9.31145,8.67144,9.06747,8.91741,9.06747,9.219850000000001L9.06747,17.9068L7.48614,17.9068C6.99277,17.9068,6.5753,17.322,6.5753,16.631500000000003L6.5753,9.21802C6.5753,8.91558,6.333130000000001,8.67144,6.03313,8.67144C5.73313,8.67144,5.49096,8.91558,5.49096,9.21802L5.49096,16.631500000000003C5.49096,17.9378,6.385540000000001,19,7.48614,19L15.512,19C16.6127,19,17.509,17.9378,17.509,16.631500000000003L17.509,9.21802C17.509,8.91558,17.2669,8.67144,16.966900000000003,8.67144ZM18.4578,6.21183L4.542169,6.21183C4.243976,6.21183,4,6.45779,4,6.75841C4,7.05903,4.243976,7.30499,4.542169,7.30499L18.4578,7.30499C18.756,7.30499,19,7.05903,19,6.75841C19,6.45779,18.756,6.21183,18.4578,6.21183ZM8.68072,5.10045L14.3193,5.10045C14.6175,5.10045,14.8614,4.852666,14.8614,4.550225C14.8614,4.247783,14.6175,4,14.3193,4L8.68072,4C8.38253,4,8.13855,4.247783,8.13855,4.550225C8.13855,4.852666,8.38253,5.10045,8.68072,5.10045Z" fill-opacity="1" stroke="currentColor" stroke-width="1"></path>'),JI=Bi('<circle cx="11" cy="11" r="8" fill="none" stroke="currentColor" stroke-width="1.5"></circle><circle cx="8.5" cy="8.5" r="1" fill="currentColor"></circle><circle cx="13.5" cy="8.5" r="1" fill="currentColor"></circle><path d="M7.5 13.5 Q11 16.5 14.5 13.5" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>',1),QI=Bi('<g fill="currentColor"><path d="M5 5h12v2h-5v10h-2V7H5z"></path></g>'),eM=Bi('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M19.054 7.988a2.988 2.988 0 0 1-1.31-.312l-10 10a3.027 3.027 0 1 1-1.38-1.381l10-10a2.994 2.994 0 1 1 2.69 1.693Zm-14 10a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm14-14a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"></path></g>'),tM=Bi('<path d="M6,4L6,8L4,8L4,16L6,16L6,20L8,20L8,16L10,16L10,8L8,8L8,4L6,4ZM14,2L14,6L12,6L12,14L14,14L14,18L16,18L16,14L18,14L18,6L16,6L16,2L14,2Z" stroke-opacity="0" stroke="none"></path>'),oM=Bi('<path d="M3,18L4.5,16.5L8,13L12,17L16,13L19,16L21,14L19,12L16,15L12,11L8,15L4.5,18.5L3,20Z" stroke-opacity="0" stroke="none"></path>'),sM=Bi('<path d="M3,18L4.5,16.5L8,13L12,17L16,13L19,16L21,14L21,20L3,20Z" stroke-opacity="0" stroke="none"></path>'),nM=Bi('<path d="M6,4L6,8L4,8L4,16L6,16L6,20L8,20L8,16L10,16L10,8L8,8L8,4L6,4ZM14,2L14,6L12,6L12,14L14,14L14,18L16,18L16,14L18,14L18,6L16,6L16,2L14,2Z" stroke-opacity="0" stroke="none" fill="currentColor"></path>'),iM=Bi('<path d="M6,4L6,8M6,16L6,20M14,2L14,6M14,14L14,18" stroke="currentColor" stroke-width="0.5" fill="none"></path><rect x="4" y="8" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect><rect x="12" y="6" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect>',1),rM=Bi('<path d="M6,4L6,8M6,16L6,20M14,2L14,6M14,14L14,18" stroke="currentColor" stroke-width="0.5" fill="none"></path><rect x="4" y="8" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect><rect x="12" y="6" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="currentColor" fill-opacity="0.3"></rect>',1),aM=Bi('<path d="M6,4L6,8M6,16L6,20M14,2L14,6M14,14L14,18" stroke="currentColor" stroke-width="0.5" fill="none"></path><rect x="4" y="8" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="currentColor" fill-opacity="0.3"></rect><rect x="12" y="6" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect>',1),lM=Bi('<path d="M6,4L6,20M12,2L12,22M18,3L18,21" stroke="currentColor" stroke-width="0.5"></path><path d="M4,8L6,8M6,16L8,16M10,6L12,6M12,16L14,16M16,7L18,7M18,13L20,13" stroke="currentColor" stroke-width="0.5"></path>',1),cM=Bi('<g stroke-width="1.2" fill="none"><g stroke="#00E6D8"><line x1="3" y1="13" x2="6" y2="16"></line><line x1="6" y1="13" x2="3" y2="16"></line><line x1="3" y1="9" x2="6" y2="12"></line><line x1="6" y1="9" x2="3" y2="12"></line><line x1="3" y1="5" x2="6" y2="8"></line><line x1="6" y1="5" x2="3" y2="8"></line></g><g stroke="#FF4D4D"><circle cx="10.5" cy="10.5" r="1.8"></circle><circle cx="10.5" cy="14.5" r="1.8"></circle><circle cx="10.5" cy="18.5" r="1.8"></circle></g><g stroke="#00E6D8"><line x1="15" y1="9" x2="18" y2="12"></line><line x1="18" y1="9" x2="15" y2="12"></line><line x1="15" y1="5" x2="18" y2="8"></line><line x1="18" y1="5" x2="15" y2="8"></line></g></g>'),dM=Bi('<path d="M5.146447,15.753C4.9511845,15.9483,4.9511845,16.2649,5.146447,16.4602C5.341709,16.6554,5.658291,16.6554,5.853554,16.4602L8.156600000000001,14.15711C8.352409999999999,14.25082,8.57173,14.3033,8.8033,14.3033C9.631730000000001,14.3033,10.3033,13.63172,10.3033,12.80329C10.3033,12.57172,10.250820000000001,12.352409999999999,10.157119999999999,12.15659L12.156600000000001,10.15711C12.352409999999999,10.250820000000001,12.571729999999999,10.30329,12.8033,10.30329C13.63173,10.30329,14.3033,9.63172,14.3033,8.80329C14.3033,8.57172,14.25082,8.352409999999999,14.15712,8.15659L16.4602,5.853553C16.6554,5.658291,16.6554,5.341709,16.4602,5.146447C16.2649,4.9511843,15.9483,4.9511843,15.753,5.146447L13.45001,7.449479999999999C13.25419,7.35577,13.03487,7.3032900000000005,12.8033,7.3032900000000005C11.97487,7.3032900000000005,11.3033,7.97487,11.3033,8.80329C11.3033,9.03487,11.35578,9.254190000000001,11.44949,9.450009999999999L9.450009999999999,11.449480000000001C9.254190000000001,11.35577,9.03487,11.30329,8.8033,11.30329C7.97487,11.30329,7.3033,11.97487,7.3033,12.80329C7.3033,13.03487,7.35578,13.25419,7.44949,13.45001L5.146447,15.753Z" stroke-opacity="0" stroke="none"></path>'),uM=Bi('<defs><clipPath id="master_svg0_151_615"><rect x="0" y="0" width="22" height="22" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_151_615)"><path d="M19.672,3.0673368C19.4417,2.9354008,19.1463,3.00292252,18.9994,3.2210900000000002L17.4588,5.50622L16.743299999999998,3.781253L13.9915,7.4662L13.9618,7.51108C13.8339,7.72862,13.8936,8.005659999999999,14.1004,8.15391L14.1462,8.183430000000001C14.3683,8.308720000000001,14.6511,8.25001,14.8022,8.047229999999999L16.4907,5.78571L17.246299999999998,7.60713L19.8374,3.7635389999999997L19.8651,3.717088C19.9871,3.484615,19.9023,3.199273,19.672,3.0673368ZM4.79974,8.462530000000001L10.117740000000001,3.252975C10.31381,3.0610145,10.63152,3.0610145,10.82759,3.252975L13.4115,5.78453C13.6076,5.976710000000001,13.6076,6.28833,13.4115,6.4805L8.093869999999999,11.69045C7.48847,12.28368,7.51659,13.3308,8.151309999999999,13.9528C8.786439999999999,14.5755,9.85421,14.6027,10.45961,14.0087L15.7768,8.79831C15.9729,8.60609,16.2909,8.60609,16.487099999999998,8.79831L19.0705,11.33026C19.2667,11.52244,19.2667,11.83406,19.0705,12.02623L13.7533,17.2366C11.32572,19.6158,7.30328,19.578,4.85679,17.1807C2.410298,14.7834,2.371331,10.84174,4.79974,8.462530000000001ZM12.3461,6.1325199999999995L10.47246,4.29654L5.51079,9.15889C3.477674,11.15076,3.510214,14.4688,5.56784,16.4847C7.62506,18.500999999999998,11.01117,18.5325,13.0439,16.540599999999998L15.6842,13.9529L14.2908,12.58718L15.0011,11.89161L16.394399999999997,13.2569L18.0056,11.67786L16.1323,9.84188L11.16985,14.7046C10.18764,15.6679,8.540980000000001,15.6494,7.51498,14.7184L7.44107,14.6487C6.4219,13.65,6.37771,11.98096,7.38362,10.994869999999999L10.02485,8.40693L8.624939999999999,7.03516L9.335180000000001,6.33919L10.73512,7.71099L12.3461,6.1325199999999995Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></g>',1),pM=Bi('<path d="M8.134443814697265,7.494615087890625L8.764323814697265,7.494615087890625L8.764323814697265,3.414215087890625L8.310223814697267,3.414215087890625L7.294603814697266,4.005035087890625L7.289713814697266,4.634915087890625L8.134443814697265,4.149892087890625L8.134443814697265,7.494615087890625ZM18.832003814697266,6.933095087890624Q19.004603814697266,6.635245087890625,19.004603814697266,6.2543850878906255Q19.004603814697266,5.884915087890625,18.845103814697264,5.593575087890625Q18.685503814697267,5.3006050878906255,18.399103814697266,5.136225087890625Q18.114303814697266,4.9702050878906245,17.754603814697266,4.9653250878906245L18.820603814697265,3.840647087890625L18.820603814697265,3.414215087890625L16.519203814697264,3.414215087890625L16.519203814697264,3.939931087890625L18.050803814697264,3.939931087890625L16.719403814697266,5.334785087890625L17.074203814697263,5.7205350878906245Q17.254903814697265,5.484525087890625,17.619503814697268,5.484525087890625Q17.980803814697268,5.484525087890625,18.187503814697266,5.689605087890625Q18.394203814697267,5.894685087890625,18.394203814697267,6.2543850878906255Q18.394203814697267,6.604315087890625,18.187503814697266,6.822415087890625Q17.980803814697268,7.0405150878906255,17.640603814697265,7.0405150878906255Q17.334603814697267,7.0405150878906255,17.124703814697266,6.890775087890625Q16.914703814697265,6.739415087890626,16.820303814697265,6.469225087890624L16.354803814697263,6.744295087890626Q16.480103814697266,7.125155087890625,16.821903814697265,7.341625087890625Q17.165403814697264,7.559725087890625,17.640603814697265,7.559725087890625Q18.039403814697266,7.559725087890625,18.348603814697267,7.393705087890625Q18.659503814697267,7.229315087890625,18.832003814697266,6.933095087890624ZM10.000003814697266,10.634915087890626C10.000003814697266,11.024655087890626,9.851363814697265,11.379685087890625,9.607683814697266,11.646395087890625L12.168903814697266,15.171615087890626C12.275403814697265,15.147615087890625,12.386203814697266,15.134915087890626,12.500003814697266,15.134915087890626C12.596503814697266,15.134915087890626,12.690803814697265,15.144015087890624,12.782303814697265,15.161415087890624L16.108803814697268,11.196955087890625C16.038703814697264,11.023375087890624,16.000003814697266,10.833655087890625,16.000003814697266,10.634915087890626C16.000003814697266,9.806495087890625,16.671603814697264,9.134915087890626,17.500003814697266,9.134915087890626C18.328403814697264,9.134915087890626,19.000003814697266,9.806495087890625,19.000003814697266,10.634915087890626C19.000003814697266,11.463345087890625,18.328403814697264,12.134915087890626,17.500003814697266,12.134915087890626C17.239503814697265,12.134915087890626,16.994503814697268,12.068495087890625,16.781003814697264,11.951675087890624L13.654703814697266,15.677415087890624C13.870303814697266,15.937215087890625,14.000003814697266,16.270915087890625,14.000003814697266,16.634915087890626C14.000003814697266,17.463315087890624,13.328403814697266,18.134915087890626,12.500003814697266,18.134915087890626C11.671573814697265,18.134915087890626,11.000003814697266,17.463315087890624,11.000003814697266,16.634915087890626C11.000003814697266,16.284415087890626,11.120193814697265,15.962015087890626,11.321603814697266,15.706715087890625L8.715393814697265,12.119565087890624C8.645053814697267,12.129685087890625,8.573143814697266,12.134915087890626,8.500003814697266,12.134915087890626C8.162103814697264,12.134915087890626,7.8503038146972655,12.023195087890626,7.599523814697266,11.834665087890626L4.505583814697266,15.521915087890624C4.809213814697266,15.796415087890624,5.000003814697266,16.193415087890624,5.000003814697266,16.634915087890626C5.000003814697266,17.463315087890624,4.328433814697266,18.134915087890626,3.5000038146972656,18.134915087890626C2.6715768146972656,18.134915087890626,2.0000038146972656,17.463315087890624,2.0000038146972656,16.634915087890626C2.0000038146972656,15.806515087890626,2.6715768146972656,15.134915087890626,3.5000038146972656,15.134915087890626C3.508253814697266,15.134915087890626,3.5164838146972657,15.135015087890626,3.524703814697266,15.135115087890625L7.033823814697266,10.953115087890625C7.011673814697265,10.850565087890626,7.000003814697266,10.744105087890624,7.000003814697266,10.634915087890626C7.000003814697266,9.806495087890625,7.671573814697266,9.134915087890626,8.500003814697266,9.134915087890626C9.328433814697267,9.134915087890626,10.000003814697266,9.806495087890625,10.000003814697266,10.634915087890626Z" stroke-opacity="0" stroke="none"></path>'),vM=Bi('<path d="M11.57625,6.9981C11.55099,6.999359999999999,11.52557,7,11.5,7C11.34,7,11.18584,6.97495,11.04125,6.9285499999999995L5.55401,16.4327C5.713760000000001,16.5905,5.83826,16.7839,5.91465,17L16.0854,17C16.2187,16.622700000000002,16.4987,16.314700000000002,16.8569,16.1445L11.57625,6.9981ZM12.50759,6.611219999999999C12.81005,6.336790000000001,13,5.94058,13,5.5C13,4.671573,12.32843,4,11.5,4C10.67157,4,10,4.671573,10,5.5C10,5.80059,10.08841,6.08052,10.24066,6.31522L4.64514,16.0069C4.59738,16.002299999999998,4.54896,16,4.5,16C3.671573,16,3,16.671599999999998,3,17.5C3,18.328400000000002,3.671573,19,4.5,19C5.15311,19,5.70873,18.5826,5.91465,18L16.0854,18C16.2913,18.5826,16.846899999999998,19,17.5,19C18.328400000000002,19,19,18.328400000000002,19,17.5C19,16.8365,18.5691,16.2735,17.971899999999998,16.075699999999998L12.50759,6.611219999999999Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),fM=Bi('<g transform="scale(0.7857142857)"><path fill="currentColor" stroke="currentColor" stroke-width="1" fill-rule="evenodd" d="M14 6a3 3 0 0 0-3 3v3h8.5a2.5 2.5 0 0 1 2.5 2.5v7a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 6 21.5v-7A2.5 2.5 0 0 1 8.5 12H10V9a4 4 0 0 1 8 0h-1a3 3 0 0 0-3-3zm-1 11a1 1 0 1 1 2 0v2a1 1 0 1 1-2 0v-2zm-6-2.5c0-.83.67-1.5 1.5-1.5h11c.83 0 1.5.67 1.5 1.5v7c0 .83-.67 1.5-1.5 1.5h-11A1.5 1.5 0 0 1 7 21.5v-7z"></path></g>'),mM=Bi('<path d="M11.66558837890625,19C10.83716137890625,19,10.16558837890625,18.328400000000002,10.16558837890625,17.5C10.16558837890625,16.846899999999998,10.58298437890625,16.2913,11.16557337890625,16.0854L11.16557337890625,11.91464C10.58298437890625,11.70872,10.16558837890625,11.1531,10.16558837890625,10.5C10.16558837890625,9.8469,10.58298437890625,9.29128,11.16557337890625,9.08536L11.16557337890625,4.5C11.16557337890625,4.223857,11.38942837890625,4,11.66556837890625,4C11.94171837890625,4,12.16556837890625,4.223857,12.16556837890625,4.5L12.16556837890625,9.08535C12.74817837890625,9.291260000000001,13.16558837890625,9.846879999999999,13.16558837890625,10.5C13.16558837890625,11.153120000000001,12.74817837890625,11.708739999999999,12.16556837890625,11.91465L12.16556837890625,16.0854C12.74817837890625,16.2913,13.16558837890625,16.846899999999998,13.16558837890625,17.5C13.16558837890625,18.328400000000002,12.49401837890625,19,11.66558837890625,19Z" stroke-opacity="0" stroke="none"></path>'),gM=Bi('<path d="M11.165603637695312,6.91465C11.748203637695312,6.70873,12.165603637695312,6.15311,12.165603637695312,5.5C12.165603637695312,4.671573,11.494033637695313,4,10.665603637695312,4C9.837176637695313,4,9.165603637695312,4.671573,9.165603637695312,5.5C9.165603637695312,6.15311,9.583007637695312,6.70873,10.165603637695312,6.91465L10.165603637695312,16.0854C9.583007637695312,16.2913,9.165603637695312,16.846899999999998,9.165603637695312,17.5C9.165603637695312,18.328400000000002,9.837176637695313,19,10.665603637695312,19C11.494033637695313,19,12.165603637695312,18.328400000000002,12.165603637695312,17.5C12.165603637695312,16.846899999999998,11.748203637695312,16.2913,11.165603637695312,16.0854L11.165603637695312,6.91465Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),hM=Bi('<path d="M11,12.41465L11,18.5C11,18.7761,11.22386,19,11.5,19C11.77614,19,12,18.7761,12,18.5L12,12.41465C12.5826,12.20873,13,11.65311,13,11C13,10.34689,12.5826,9.79127,12,9.58535L12,3.5C12,3.223857,11.77614,3,11.5,3C11.22386,3,11,3.223857,11,3.5L11,9.58535C10.417404,9.79127,10,10.34689,10,11C10,11.65311,10.417404,12.20873,11,12.41465Z" stroke-opacity="0" stroke="none"></path>'),_M=Bi('<path d="M11,17C5.80945,17,3.667717,12.85,3.113386,11.575C2.9622047,11.2,2.9622047,10.8,3.113386,10.425C3.667717,9.15,5.80945,5,11,5C16.165399999999998,5,18.3323,9.15,18.8866,10.425C19.0378,10.8,19.0378,11.2,18.8866,11.575C18.3323,12.85,16.165399999999998,17,11,17ZM4.04567,10.8C3.995276,10.925,3.995276,11.05,4.04567,11.175C4.52441,12.325,6.43937,16,11,16C15.5606,16,17.4756,12.325,17.9543,11.2C18.0047,11.075,18.0047,10.95,17.9543,10.825C17.4756,9.675,15.5606,6,11,6C6.43937,6,4.52441,9.675,4.04567,10.8ZM11,13.5C9.61417,13.5,8.480319999999999,12.375,8.480319999999999,11C8.480319999999999,9.625,9.61417,8.5,11,8.5C12.38583,8.5,13.5197,9.625,13.5197,11C13.5197,12.375,12.38583,13.5,11,13.5ZM11,9.5C10.1685,9.5,9.48819,10.175,9.48819,11C9.48819,11.825,10.1685,12.5,11,12.5C11.8315,12.5,12.51181,11.825,12.51181,11C12.51181,10.175,11.8315,9.5,11,9.5Z" stroke-opacity="0" fill-opacity="1"></path>'),yM=Bi('<path d="M4.727219638671875,8.007996215820313L9.973849638671876,2.7629472158203123C10.167279638671875,2.5696791158203123,10.480729638671875,2.5696791158203123,10.674169638671875,2.7629472158203123L13.223329638671874,5.311756215820313C13.416929638671874,5.505236215820313,13.416929638671874,5.8189862158203125,13.223329638671874,6.012466215820313L7.977129638671875,11.257906215820313C7.379859638671875,11.855176215820313,7.407609638671875,12.909396215820312,8.033809638671876,13.535596215820313C8.660409638671876,14.162596215820313,9.713849638671874,14.189996215820312,10.311129638671876,13.591896215820313L15.556929638671875,8.346066215820311C15.750429638671875,8.152526215820313,16.064229638671875,8.152526215820313,16.257629638671872,8.346066215820311L18.806529638671876,10.895266215820312C19.000029638671876,11.088746215820313,19.000029638671876,11.402496215820312,18.806529638671876,11.595976215820313L13.560629638671875,16.841796215820313C11.165619638671876,19.237196215820312,7.197149638671875,19.19919621582031,4.783499638671875,16.785496215820313C2.3698426386718747,14.371896215820312,2.331397638671875,10.403416215820313,4.727219638671875,8.007996215820313ZM12.172299638671875,5.662106215820312L10.323809638671875,3.8136162158203124L5.4287196386718755,8.709096215820313C3.422893638671875,10.714536215820312,3.4549956386718748,14.055196215820313,5.484999638671875,16.08479621582031C7.514609638671875,18.114796215820313,10.855289638671875,18.146496215820314,12.860719638671876,16.141096215820312L15.465629638671874,13.535796215820312L14.090929638671875,12.160756215820312L14.791629638671875,11.460436215820312L16.166229638671876,12.834996215820313L17.755829638671877,11.245226215820313L15.907729638671874,9.396736215820312L11.011839638671875,14.292596215820312C10.042809638671875,15.262396215820312,8.418249638671874,15.243796215820312,7.406019638671875,14.306496215820312L7.333099638671875,14.236296215820312C6.327599638671876,13.230796215820313,6.284009638671876,11.550396215820312,7.276419638671875,10.557586215820312L9.882199638671874,7.952026215820313L8.501079638671875,6.570906215820313L9.201789638671876,5.870186215820313L10.582939638671874,7.251336215820312L12.172299638671875,5.662106215820312Z" fill-rule="evenodd" fill-opacity="1" stroke="currentColor" stroke-width="0.5"></path>'),bM=Bi('<g transform="scale(0.7857142857)" fill="currentColor" fill-rule="nonzero" stroke="currentColor" stroke-width="1"><path d="M20.449 8.505l2.103 9.112.974-.225-2.103-9.112zM13.943 14.011l7.631 4.856.537-.844-7.631-4.856zM14.379 11.716l4.812-3.609-.6-.8-4.812 3.609zM10.96 13.828l-4.721 6.744.819.573 4.721-6.744zM6.331 20.67l2.31-13.088-.985-.174-2.31 13.088zM9.041 7.454l1.995 3.492.868-.496-1.995-3.492z"></path><path d="M8.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM12.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM20.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g>'),xM=Bi('<path d="m19.45,17.57l-3.78,-9.16a0.92,0.92 0 0 0 -1.71,0l-3.78,9.16a0.92,0.92 0 1 0 1.71,0.71l0.77,-1.86l4.31,0l0.77,1.86a0.92,0.92 0 0 0 0.85,0.57a0.92,0.92 0 0 0 0.85,-1.28l0,0zm-6.03,-3.01l1.39,-3.37l1.39,3.37l-2.79,0zm-2.81,-0.8a0.92,0.92 0 0 0 -0.21,-1.29c-0.01,-0.01 -0.63,-0.47 -1.53,-1.46c1.67,-2.25 2.61,-4.82 2.99,-6.03l1.36,0a0.92,0.92 0 0 0 0,-1.85l-4.87,0l0,-0.84a0.92,0.92 0 0 0 -1.85,0l0,0.84l-4.87,0a0.92,0.92 0 0 0 0,1.85l8.28,0c-0.4,1.13 -1.14,2.92 -2.26,4.55c-1.32,-1.75 -1.81,-2.88 -1.81,-2.89a0.92,0.92 0 0 0 -1.7,0.71c0.02,0.06 0.61,1.44 2.22,3.53c0.04,0.05 0.08,0.1 0.12,0.15c-1.65,1.86 -3.27,3.02 -3.94,3.39a0.92,0.92 0 1 0 0.88,1.62c0.09,-0.05 2.04,-1.13 4.27,-3.59c0.95,1.01 1.6,1.49 1.64,1.52a0.92,0.92 0 0 0 1.29,-0.21l0,0z" id="svg_1"></path>'),wM=Bi('<g id="svg_7"><path d="m10.02,1.07c-4.98,0 -9.28,4.05 -9.02,9.02c0.35,6.79 8.26,2.87 8.97,8.2a0.9,0.9 0 0 0 0.99,0.77a9.02,9.02 0 0 0 -0.94,-18zm1.77,16.4a0.51,0.51 0 0 1 -0.62,-0.35a4.51,4.51 0 0 0 -1.61,-2.3c-1.03,-0.78 -2.27,-1.08 -3.46,-1.38c-2.39,-0.59 -3.55,-0.99 -3.67,-3.43c-0.1,-1.87 0.58,-3.67 1.93,-5.08a7.84,7.84 0 0 1 5.66,-2.43a7.59,7.59 0 0 1 1.77,14.97z" id="svg_1"></path><path d="m13.04,14.42m-1.38,0a1.38,1.38 0 1 0 2.77,0a1.38,1.38 0 1 0 -2.77,0z" id="svg_2"></path><path d="m15.28,9.07m-1.13,0a1.13,1.13 0 1 0 2.26,0a1.13,1.13 0 1 0 -2.26,0z" id="svg_3"></path><path d="m14.23,6.93a1.13,1.13 0 1 0 -1.58,-0.19a1.13,1.13 0 0 0 1.58,0.19z" id="svg_4"></path><path d="m10.29,4.73m-0.97,0.58a1.13,1.13 0 1 0 1.93,-1.16a1.13,1.13 0 1 0 -1.93,1.16z" id="svg_5"></path><path d="m6.47,4.66a1.13,1.13 0 1 0 1.49,0.58a1.13,1.13 0 0 0 -1.49,-0.58z" id="svg_6"></path></g>'),kM=Bi('<path d="m15.1,6.75c0,-2.31 -1.89,-4.18 -4.21,-4.18c-2.33,0 -4.21,1.87 -4.21,4.18c0,2.31 1.89,4.18 4.21,4.18c2.33,0 4.21,-1.87 4.21,-4.18m5.9,13.26c0.03,0.09 0.05,0.18 0.05,0.28c0,0.54 -0.44,0.98 -0.99,0.98a0.99,0.99 0 0 1 -0.99,-0.98l0,0l-0.03,0c-0.26,-4.12 -3.69,-7.39 -7.9,-7.39c-4.21,0 -7.65,3.27 -7.91,7.39l-0.02,0l0,0c0,0.54 -0.44,0.98 -0.99,0.98a0.99,0.99 0 0 1 -0.99,-0.98c0,-0.09 0.02,-0.18 0.04,-0.27c0.29,-3.74 2.66,-6.9 5.98,-8.3c-1.54,-1.12 -2.55,-2.92 -2.55,-4.97c0,-3.4 2.77,-6.15 6.19,-6.15c3.42,0 6.19,2.75 6.19,6.15a6.12,6.12 0 0 1 -2.39,4.85c3.48,1.33 6,4.56 6.31,8.41" fill="#515151" id="svg_1"></path>'),SM=Bi('<g transform="scale(0.047 0.047)"><path d="M387.6 2.6C385.5 4.7 385 6.2 385 10C385 13.8 385.5 15.3 387.6 17.4L390.3 20H410.9H431.5L382.5 69L333.5 118L314.5 99C304.1 88.6 294.2 79.6 292.6 79C291 78.4 288.3 78.2 286.6 78.6C284.2 79 263.1 99.5 192.7 169.8C142.7 219.7 101.2 261.7 100.4 263.2C98.1 267.5 98.7 271.6 101.9 275.2C104.4 278 105.5 278.5 109.4 278.5H114L201.5 191L289 103.5L308.8 123.3L328.6 143H333.5H338.5L392.2 89.3L446 35.5V52.8C446 71.1 446.7 74.7 450.9 77C453.9 78.6 460.3 78.2 462.6 76.2C466.8 72.8 467 71.3 467 39C467 6.7 466.8 5.2 462.6 1.8C460.7 0.199996 457.1 -4.14997e-06 425.4 -4.14997e-06H390.3L387.6 2.6Z" fill="currentColor"></path><path d="M382.8 147.4C373.9 149.8 366 158.1 364.1 167.1C363.3 170.5 363 222 363 332V492H335.5H308L307.8 400.1L307.5 308.2L303.8 302.9C295.9 291.6 290.4 290.1 256.9 290C244 290 230.7 290.5 227.5 291.1C218.2 292.8 211 298.4 207.1 307C205.1 311.4 205 313.1 205 401.7V492H177.5H150V444.7C150 391.6 150 391.7 143 383.7C140.7 381.2 136.8 378.3 133.8 376.9C128.6 374.5 128 374.5 98 374.5H67.5L61.8 377.3C55.4 380.4 51.7 384.3 48.6 391C46.6 395.3 46.5 397.2 46.2 443.8L45.9 492H32.9C18.2 492 15.9 492.8 14 498.6C12.5 502.9 14.1 508.2 17.5 510.4C19.7 511.8 42.4 512 256 512C469.6 512 492.3 511.8 494.5 510.4C497.9 508.2 499.5 502.9 498 498.6C496.1 492.9 493.7 492 479.5 492H467V331.2C467 150.8 467.5 163.8 459.7 155.3C451.9 146.8 450.7 146.5 417 146.3C395.4 146.1 386.3 146.4 382.8 147.4ZM443.4 169.1L446 171.1V331.6V492H415H384V332V171.9L386.5 169.5L388.9 167H414.8C439.5 167 440.9 167.1 443.4 169.1ZM282.8 312.1C284.8 312.8 286.2 314.2 286.9 316.2C287.7 318.3 288 346.8 288 405.6V492H257H226V403.7C226 320.8 226.1 315.2 227.8 313.8C228.7 312.9 230.2 312 231 311.7C233.9 310.7 279.6 311 282.8 312.1ZM127.1 397.9C128.9 400.1 129 402.4 129 446.1V492H98H67L67.1 446.7C67.1 421.9 67.5 400.7 67.9 399.6C69.6 395.4 72.1 395 99.3 395.3C125.2 395.5 125.2 395.5 127.1 397.9Z" fill="currentColor"></path><path d="M69.2 295.5C65.3 298.7 64.4 302.7 66.4 307.4C69.3 314.4 78.6 315.6 83.5 309.8C91.5 300.3 78.6 287.5 69.2 295.5Z" fill="currentColor"></path><circle cx="2" cy="18" r="1" fill="currentColor"></circle></g>'),CM=Bi('<g id="svg_4" transform="translate(-0.1 -0.1) scale(1.00914 1.00914) translate(0.1 0.1) scale(1.09 1.09) matrix(0.995 0 0 0.995 0 0)"><path d="m18.54,9.09c-0.21,-2.47 -1.25,-4.77 -2.96,-6.45c-1.73,-1.69 -3.96,-2.64 -6.3,-2.64c-1.25,0 -2.46,0.27 -3.61,0.78c-0.01,0 -0.01,0.02 -0.02,0.02c-0.02,0 -0.02,0.01 -0.03,0.01c-1.09,0.5 -2.06,1.21 -2.91,2.12c-0.86,0.92 -1.52,1.98 -1.99,3.18c-0.47,1.23 -0.72,2.54 -0.72,3.89c0,0.87 0.11,1.72 0.31,2.54c0,0.02 0.01,0.05 0.02,0.07c0.41,1.62 1.18,3.11 2.3,4.35c1.44,1.59 3.3,2.6 5.3,2.91c0.03,0 0.04,0.02 0.06,0.02c0.33,0.05 0.67,0.08 1.01,0.08l0.21,0c0.4,0 1.17,-0.03 1.8,-0.27c0.16,-0.07 0.29,-0.19 0.36,-0.36c0.07,-0.16 0.09,-0.35 0.03,-0.53c-0.1,-0.27 -0.34,-0.46 -0.61,-0.46c-0.07,0 -0.16,0.01 -0.23,0.03c-0.47,0.18 -1.1,0.21 -1.36,0.21l-0.1,0c0.1,-0.32 0.14,-0.67 0.05,-1.04c-0.15,-0.66 -0.64,-1.21 -1.57,-1.75l-0.39,-0.23c-0.62,-0.36 -0.96,-0.54 -1.16,-0.84c-0.2,-0.29 -0.34,-0.74 -0.51,-1.75c-0.13,-0.68 -0.47,-1.21 -1.01,-1.52c-0.37,-0.2 -0.8,-0.31 -1.32,-0.31c-0.36,0 -0.76,0.05 -1.18,0.15c-0.21,0.05 -0.41,0.11 -0.59,0.16c-0.08,-0.48 -0.12,-0.98 -0.12,-1.49c0,-3.04 1.47,-5.7 3.69,-7.24c0.01,0.28 0.07,0.57 0.19,0.84c0.3,0.7 0.92,1.14 1.84,1.33c0.05,0.01 0.08,0.01 0.12,0.01l0.04,0c0.09,0 0.39,0.01 0.71,0.14c0.43,0.19 0.68,0.51 0.76,1c0.2,1.56 0.42,4.38 0.14,5.29c-0.02,0.07 -0.03,0.15 -0.03,0.23c0,0.37 0.29,0.69 0.64,0.69c0.18,0 0.34,-0.08 0.46,-0.2c0.12,-0.13 2.76,-3.01 3.46,-3.97c0.08,-0.11 0.17,-0.21 0.26,-0.32c0.34,-0.43 0.69,-0.86 0.82,-1.51c0.15,-0.69 0,-1.46 -0.46,-2.41c-0.32,-0.68 -0.38,-0.98 -0.4,-1.1c0.02,-0.01 0.04,-0.02 0.06,-0.04c2.02,1.39 3.42,3.73 3.65,6.48c0.04,0.37 0.31,0.63 0.65,0.63l0.06,0c0.35,-0.01 0.61,-0.34 0.58,-0.73zm-15.35,3.47c0.3,0 0.53,0.05 0.71,0.15c0.18,0.12 0.29,0.28 0.34,0.56c0.2,1.07 0.37,1.79 0.76,2.34c0.38,0.53 0.86,0.79 1.58,1.21l0.03,0.01c0.1,0.06 0.23,0.13 0.35,0.2c0.74,0.43 0.9,0.72 0.94,0.86c0.03,0.14 -0.05,0.34 -0.15,0.54c-2.83,-0.58 -5.1,-2.74 -6.01,-5.6c0.42,-0.13 0.97,-0.27 1.45,-0.27zm9.6,-8.04c0.64,1.31 0.36,1.67 -0.21,2.37c-0.09,0.12 -0.19,0.23 -0.28,0.36c-0.35,0.48 -1.28,1.53 -2.09,2.43c0,-0.44 -0.02,-0.94 -0.06,-1.49c-0.08,-1.23 -0.22,-2.28 -0.22,-2.32l0,-0.04c-0.18,-0.99 -0.73,-1.71 -1.61,-2.07c-0.49,-0.2 -0.95,-0.22 -1.13,-0.22c-0.45,-0.11 -0.73,-0.3 -0.85,-0.55c-0.14,-0.3 -0.05,-0.74 0.04,-1.02c0.91,-0.38 1.88,-0.59 2.9,-0.59c1.11,0 2.16,0.24 3.13,0.67c-0.07,0.13 -0.13,0.3 -0.16,0.5c-0.04,0.49 0.12,1.1 0.54,1.97z" id="svg_1"></path><path d="m15.22,9.72c-2.63,0 -4.77,2.3 -4.77,5.14c0,2.84 2.13,5.14 4.77,5.14c2.64,0 4.78,-2.3 4.78,-5.14c0,-2.84 -2.15,-5.14 -4.78,-5.14zm0,8.88c-1.91,0 -3.48,-1.68 -3.48,-3.75c0,-2.07 1.56,-3.75 3.48,-3.75c1.93,0 3.49,1.68 3.49,3.75c0,2.07 -1.57,3.75 -3.49,3.75z" id="svg_2"></path><path d="m15.69,15.05l0,-2.37c0,-0.38 -0.29,-0.7 -0.64,-0.7c-0.36,0 -0.65,0.32 -0.65,0.7l0,2.66c0,0.19 0.07,0.35 0.19,0.49l1.16,1.27c0.12,0.12 0.28,0.2 0.46,0.2c0.17,0 0.33,-0.08 0.46,-0.2c0.11,-0.13 0.18,-0.31 0.18,-0.5c0,-0.19 -0.07,-0.36 -0.18,-0.49l-0.98,-1.06z" id="svg_3"></path></g>'),PM=Bi('<path d="M8 5v14l11-7z" fill="currentColor"></path>'),IM=Bi('<rect x="6" y="6" width="10" height="10" fill="currentColor"></rect>'),MM=Bi('<path d="m21.62,13.73l-1.7,-1.37c0.08,-0.46 0.12,-0.94 0.12,-1.41c0,-0.47 -0.04,-0.94 -0.12,-1.41l1.7,-1.37c0.25,-0.21 0.35,-0.55 0.24,-0.85l-0.03,-0.07c-0.46,-1.24 -1.15,-2.38 -2.06,-3.37l-0.04,-0.05c-0.22,-0.24 -0.58,-0.34 -0.91,-0.23l-2.09,0.71c-0.78,-0.6 -1.64,-1.08 -2.57,-1.41l-0.41,-2.08c-0.07,-0.32 -0.33,-0.57 -0.67,-0.62l-0.08,-0.01c-1.34,-0.23 -2.76,-0.23 -4.1,0l-0.08,0.01c-0.34,0.05 -0.6,0.31 -0.67,0.62l-0.41,2.09c-0.93,0.33 -1.78,0.8 -2.55,1.4l-2.11,-0.71c-0.33,-0.11 -0.69,-0.02 -0.91,0.23l-0.04,0.05c-0.91,1.01 -1.6,2.14 -2.06,3.37l-0.03,0.07c-0.11,0.3 -0.01,0.65 0.24,0.85l1.72,1.38c-0.09,0.46 -0.12,0.93 -0.12,1.4c0,0.47 0.03,0.94 0.12,1.39l-1.72,1.39c-0.25,0.21 -0.35,0.55 -0.24,0.85l0.03,0.07c0.46,1.24 1.15,2.37 2.06,3.37l0.04,0.05c0.22,0.24 0.58,0.34 0.91,0.23l2.11,-0.71c0.77,0.6 1.62,1.07 2.55,1.4l0.41,2.09c0.07,0.32 0.33,0.57 0.67,0.62l0.08,0.01c0.67,0.12 1.36,0.18 2.05,0.18c0.69,0 1.38,-0.05 2.05,-0.18l0.08,-0.01c0.34,-0.05 0.6,-0.31 0.67,-0.62l0.41,-2.08c0.93,-0.33 1.8,-0.81 2.57,-1.41l2.09,0.71c0.33,0.11 0.69,0.01 0.91,-0.23l0.04,-0.05c0.91,-1.01 1.6,-2.14 2.06,-3.37l0.03,-0.07c0.11,-0.3 0.01,-0.64 -0.24,-0.85zm-3.53,-3.91c0.07,0.37 0.1,0.76 0.1,1.13c0,0.38 -0.03,0.77 -0.1,1.13l-0.18,0.99l1.93,1.55c-0.28,0.65 -0.66,1.25 -1.09,1.81l-2.4,-0.81l-0.81,0.64c-0.61,0.48 -1.3,0.85 -2.05,1.12l-0.99,0.35l-0.46,2.38c-0.72,0.08 -1.47,0.08 -2.19,0l-0.47,-2.38l-0.97,-0.36c-0.73,-0.26 -1.41,-0.64 -2.03,-1.12l-0.81,-0.64l-2.42,0.82c-0.44,-0.57 -0.8,-1.17 -1.09,-1.81l1.95,-1.58l-0.16,-0.97c-0.07,-0.36 -0.1,-0.74 -0.1,-1.12c0,-0.37 0.03,-0.74 0.1,-1.11l0.16,-0.97l-1.95,-1.58c0.3,-0.65 0.66,-1.25 1.09,-1.81l2.42,0.81l0.81,-0.62c0.61,-0.48 1.29,-0.85 2.03,-1.12l0.99,-0.35l0.46,-2.38c0.72,-0.09 1.47,-0.09 2.19,0l0.46,2.37l0.99,0.35c0.74,0.26 1.43,0.65 2.05,1.12l0.81,0.64l2.4,-0.81c0.44,0.57 0.81,1.17 1.11,1.81l-1.94,1.55l0.18,0.97zm-7.14,-3.42c-2.51,0 -4.54,1.93 -4.54,4.3c0,2.38 2.04,4.3 4.54,4.3c2.51,0 4.54,-1.93 4.54,-4.3c0,-2.38 -2.04,-4.3 -4.54,-4.3zm2.05,6.24c-0.55,0.51 -1.27,0.8 -2.05,0.8c-0.77,0 -1.5,-0.28 -2.05,-0.8c-0.54,-0.51 -0.84,-1.2 -0.84,-1.94c0,-0.73 0.31,-1.41 0.84,-1.94c0.55,-0.51 1.28,-0.8 2.05,-0.8c0.78,0 1.5,0.28 2.05,0.8c0.55,0.53 0.84,1.2 0.84,1.94c0,0.73 -0.3,1.42 -0.84,1.94z" id="svg_1"></path>'),TM=Bi('<path d="m7.13,1l7.64,0c0.16,0 0.31,0.12 0.34,0.28l0.25,1.38c0.12,0.67 0.68,1.15 1.35,1.15l2.45,0c1.51,0 2.74,1.26 2.74,2.81l0,11.27c0,1.55 -1.23,2.81 -2.74,2.81l-16.43,0c-1.51,0 -2.74,-1.26 -2.74,-2.81l0,-11.27c0,-1.55 1.23,-2.81 2.74,-2.81l2.45,0c0.67,0 1.23,-0.48 1.35,-1.15l0.25,-1.38c0.03,-0.16 0.18,-0.28 0.34,-0.28zm9.58,4.23c-1.32,0 -2.45,-0.96 -2.69,-2.3l-0.1,-0.51l-5.93,0l-0.1,0.51c-0.24,1.34 -1.37,2.3 -2.69,2.3l-2.45,0c-0.76,0 -1.37,0.62 -1.37,1.4l0,11.27c0,0.78 0.61,1.4 1.37,1.4l16.43,0c0.76,0 1.37,-0.62 1.37,-1.4l0,-11.27c0,-0.78 -0.61,-1.4 -1.37,-1.4l-2.45,0zm-11.91,2.11l-1.37,0c-0.38,0 -0.69,-0.32 -0.69,-0.71c0,-0.38 0.31,-0.7 0.69,-0.7l1.37,0c0.37,0 0.68,0.32 0.68,0.7c0,0.39 -0.31,0.71 -0.68,0.71zm6.15,-0.71c-3.21,0 -5.81,2.68 -5.81,5.99c0,3.3 2.61,5.98 5.81,5.98c3.21,0 5.81,-2.68 5.81,-5.98c0,-3.31 -2.61,-5.99 -5.81,-5.99zm0,1.41c1.19,0 2.31,0.47 3.14,1.34c0.84,0.87 1.3,2.01 1.3,3.24c0,1.22 -0.46,2.37 -1.3,3.23c-0.83,0.87 -1.95,1.35 -3.14,1.35c-1.19,0 -2.31,-0.48 -3.14,-1.35c-0.84,-0.87 -1.3,-2.01 -1.3,-3.23c0,-1.23 0.46,-2.38 1.3,-3.24c0.83,-0.87 1.95,-1.34 3.14,-1.34zm0,2.46c-1.14,0 -2.05,0.94 -2.05,2.11c0,1.16 0.91,2.11 2.05,2.11c1.14,0 2.06,-0.95 2.06,-2.11c0,-1.17 -0.92,-2.11 -2.06,-2.11zm0,1.4c0.37,0 0.69,0.32 0.69,0.71c0,0.38 -0.32,0.7 -0.69,0.7c-0.37,0 -0.68,-0.32 -0.68,-0.7c0,-0.39 0.31,-0.71 0.68,-0.71z" id="svg_1"></path>'),AM=Bi('<path d="m1.08,0l-1.08,1.08l4.19,4.2l-1.64,1.64l4.36,0l0,-4.36l-1.62,1.62l-4.21,-4.18zm14.73,5.28l4.19,-4.2l-1.08,-1.08l-4.21,4.18l-1.62,-1.62l0,4.36l4.36,0l-1.64,-1.64zm-11.64,9.42l-4.09,4.11l1.08,1.19l4.11,-4.2l1.64,1.64l0,-4.36l-4.36,0l1.62,1.62zm13.28,-1.62l-4.36,0l0,4.36l1.64,-1.64l4.11,4.2l1.08,-1.19l-4.09,-4.11l1.62,-1.62z" id="svg_1" transform="scale(1.09 1.09)"></path>'),LM=Bi('<path d="m2.93,1.77l4.65,4.64l-1.19,1.19l-4.62,-4.67l-1.77,1.77l0,-4.7l4.7,0l-1.77,1.77zm3.48,10.63l-4.64,4.64l-1.77,-1.76l0,4.7l4.7,0l-1.77,-1.77l4.65,-4.64l-1.17,-1.17zm8.87,-12.4l1.76,1.77l-4.64,4.64l1.19,1.19l4.64,-4.64l1.77,1.76l0,-4.72l-4.72,0zm-1.71,12.4l-1.19,1.19l4.64,4.64l-1.77,1.77l4.73,0l0,-4.72l-1.77,1.76l-4.64,-4.64z" id="svg_1" transform="scale(1.095 1.095)"></path>'),zM=Bi('<path d="m12.24,4.81c2.72,0 4.93,2.2 4.93,4.92c0,0.01 0,0.03 0,0.05c-0.01,0.03 -0.01,0.07 -0.01,0.11l-0.02,0.75l0.75,0c1.81,0.01 3.27,1.48 3.27,3.28c0,1.8 -1.46,3.27 -3.26,3.28l-0.16,0l-13.36,0c-2.01,0 -3.65,-1.64 -3.65,-3.64c0,-1.56 0.99,-2.94 2.47,-3.45l0.41,-0.14l0.07,-0.42c0.18,-1.06 1.09,-1.83 2.16,-1.83c0.34,0 0.67,0.08 0.98,0.24l0.67,0.34l0.31,-0.68c0.82,-1.7 2.56,-2.81 4.44,-2.81l0,0.01zm0,-0.73c-2.24,0 -4.19,1.31 -5.1,3.22c-0.39,-0.2 -0.83,-0.31 -1.31,-0.31c-1.44,0 -2.64,1.05 -2.87,2.43c-1.72,0.59 -2.96,2.22 -2.96,4.14c0,2.42 1.96,4.37 4.37,4.37l13.52,0c2.2,-0.01 3.99,-1.8 3.99,-4.01c0,-2.21 -1.79,-4.01 -4,-4.01c0.01,-0.06 0.01,-0.12 0.01,-0.18c0,-3.12 -2.53,-5.65 -5.66,-5.65l0,0z" fill="#000000" id="svg_1"></path>'),FM=Bi('<path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z" fill="currentColor"></path>'),$M=Bi('<g transform="scale(-1,1) translate(-24,0)"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z" fill="currentColor"></path></g>'),DM=Bi('<g transform="scale(0.9166666667)"><path d="M12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M20 13H15.874C15.5122 14.4056 14.4056 15.5122 13 15.874V20C13 20.2652 12.8946 20.5196 12.7071 20.7071C12.5196 20.8946 12.2652 21 12 21C11.7348 21 11.4804 20.8946 11.2929 20.7071C11.1054 20.5196 11 20.2652 11 20V15.874C9.59439 15.5122 8.4878 14.4056 8.12602 13H4C3.73478 13 3.48043 12.8946 3.29289 12.7071C3.10536 12.5196 3 12.2652 3 12C3 11.7348 3.10536 11.4804 3.29289 11.2929C3.48043 11.1054 3.73478 11 4 11H8.12602C8.4878 9.59439 9.59439 8.4878 11 8.12602V4C11 3.73478 11.1054 3.48043 11.2929 3.29289C11.4804 3.10536 11.7348 3 12 3C12.2652 3 12.5196 3.10536 12.7071 3.29289C12.8946 3.48043 13 3.73478 13 4V8.12602C14.4056 8.4878 15.5122 9.59439 15.874 11H20C20.2652 11 20.5196 11.1054 20.7071 11.2929C20.8946 11.4804 21 11.7348 21 12C21 12.2652 20.8946 12.5196 20.7071 12.7071C20.5196 12.8946 20.2652 13 20 13ZM12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10Z"></path></g>'),EM=Bi('<rect x="3" y="4" width="16" height="14" rx="1" fill="none" stroke="currentColor" stroke-width="0.5"></rect><rect x="13" y="4" width="6" height="14" rx="1" fill="currentColor" fill-opacity="0.3"></rect><line x1="13" y1="4" x2="13" y2="18" stroke="currentColor" stroke-width="0.5"></line>',1),NM=Bi('<div class="icon-fallback"> </div>'),jM=Bi('<svg class="icon-overlay fill-current svelte-19kzeyz" viewBox="0 0 22 22"><!></svg>');function bv(o,e){let t=Qs(e,"name",3,"none"),s=Qs(e,"active",3,!1),i=Qs(e,"size",3,32);var r=jM(),a=m(r);Te(a,()=>t()=="horizontalStraightLine",l=>{var c=CI();O(l,c)},l=>{var c=So(),d=Rt(c);Te(d,()=>t()=="ruler",v=>{var g=PI();O(v,g)},v=>{var g=So(),_=Rt(g);Te(_,()=>t()=="abcd",y=>{var k=II();O(y,k)},y=>{var k=So(),S=Rt(k);Te(S,()=>t()=="anyWaves",M=>{var I=MI();O(M,I)},M=>{var I=So(),C=Rt(I);Te(C,()=>t()=="arrow",T=>{var z=TI();O(T,z)},T=>{var z=So(),j=Rt(z);Te(j,()=>t()=="circle",B=>{var $=AI();O(B,$)},B=>{var $=So(),F=Rt($);Te(F,()=>t()=="eightWaves",V=>{var K=LI();O(V,K)},V=>{var K=So(),Y=Rt(K);Te(Y,()=>t()=="fibonacciCircle",Z=>{var ne=zI();pn(4),O(Z,ne)},Z=>{var ne=So(),te=Rt(ne);Te(te,()=>t()=="fibonacciExtension",oe=>{var U=FI();O(oe,U)},oe=>{var U=So(),J=Rt(U);Te(J,()=>t()=="fibonacciSegment",se=>{var W=$I();O(se,W)},se=>{var W=So(),le=Rt(W);Te(le,()=>t()=="fibonacciSpeedResistanceFan",ye=>{var Ce=DI();O(ye,Ce)},ye=>{var Ce=So(),Re=Rt(Ce);Te(Re,()=>t()=="fibonacciSpiral",Ke=>{var st=EI();O(Ke,st)},Ke=>{var st=So(),vt=Rt(st);Te(vt,()=>t()=="fiveWaves",Je=>{var ot=NI();O(Je,ot)},Je=>{var ot=So(),nt=Rt(ot);Te(nt,()=>t()=="gannBox",tt=>{var Ze=jI();O(tt,Ze)},tt=>{var Ze=So(),ct=Rt(Ze);Te(ct,()=>t()=="horizontalRayLine",Ge=>{var pt=RI();O(Ge,pt)},Ge=>{var pt=So(),ce=Rt(pt);Te(ce,()=>t()=="horizontalSegment",we=>{var ze=BI();O(we,ze)},we=>{var ze=So(),dt=Rt(ze);Te(dt,()=>t()=="invisible",qe=>{var me=OI();O(qe,me)},qe=>{var me=So(),Q=Rt(me);Te(Q,()=>t()=="visible",it=>{var Vt=VI();O(it,Vt)},it=>{var Vt=So(),wt=Rt(Vt);Te(wt,()=>t()=="lock",Yt=>{var At=WI();pn(),O(Yt,At)},Yt=>{var At=So(),Gt=Rt(At);Te(Gt,()=>t()=="parallelogram",no=>{var Do=qI();O(no,Do)},no=>{var Do=So(),Eo=Rt(Do);Te(Eo,()=>t()=="parallelStraightLine",bs=>{var Is=HI();O(bs,Is)},bs=>{var Is=So(),qi=Rt(Is);Te(qi,()=>t()=="priceChannelLine",Ks=>{var ws=GI();O(Ks,ws)},Ks=>{var ws=So(),vn=Rt(ws);Te(vn,()=>t()=="priceChannelLineNew",es=>{var Li=UI();O(es,Li)},es=>{var Li=So(),ci=Rt(Li);Te(ci,()=>t()=="priceLine",oa=>{var ol=YI();O(oa,ol)},oa=>{var ol=So(),Xi=Rt(ol);Te(Xi,()=>t()=="rayLine",fc=>{var rd=KI();O(fc,rd)},fc=>{var rd=So(),ml=Rt(rd);Te(ml,()=>t()=="rect",Jl=>{var Wl=ZI();O(Jl,Wl)},Jl=>{var Wl=So(),sl=Rt(Wl);Te(sl,()=>t()=="remove",Uc=>{var Nl=XI();O(Uc,Nl)},Uc=>{var Nl=So(),Yc=Rt(Nl);Te(Yc,()=>t()=="emoji",Ec=>{var Ja=JI();pn(3),O(Ec,Ja)},Ec=>{var Ja=So(),sa=Rt(Ja);Te(sa,()=>t()=="text",jl=>{var Td=QI();O(jl,Td)},jl=>{var Td=So(),_d=Rt(Td);Te(_d,()=>t()=="segment",Fl=>{var qa=eM();O(Fl,qa)},Fl=>{var qa=So(),td=Rt(qa);Te(td,()=>t()=="candle",Nc=>{var be=tM();O(Nc,be)},Nc=>{var be=So(),We=Rt(be);Te(We,()=>t()=="line",de=>{var De=oM();O(de,De)},de=>{var De=So(),Ee=Rt(De);Te(Ee,()=>t()=="area",xe=>{var gt=sM();O(xe,gt)},xe=>{var gt=So(),at=Rt(gt);Te(at,()=>t()=="candle_solid",jt=>{var Lt=nM();O(jt,Lt)},jt=>{var Lt=So(),Mt=Rt(Lt);Te(Mt,()=>t()=="candle_stroke",Io=>{var Bo=iM();pn(2),O(Io,Bo)},Io=>{var Bo=So(),hs=Rt(Bo);Te(hs,()=>t()=="candle_up_stroke",is=>{var Es=rM();pn(2),O(is,Es)},is=>{var Es=So(),bt=Rt(Es);Te(bt,()=>t()=="candle_down_stroke",kt=>{var xo=aM();pn(2),O(kt,xo)},kt=>{var xo=So(),$t=Rt(xo);Te($t,()=>t()=="ohlc",_o=>{var go=lM();pn(),O(_o,go)},_o=>{var go=So(),fs=Rt(go);Te(fs,()=>t()=="point_and_figure",Ms=>{var zn=cM();O(Ms,zn)},Ms=>{var zn=So(),qs=Rt(zn);Te(qs,()=>t()=="straightLine",Vn=>{var Ss=dM();O(Vn,Ss)},Vn=>{var Ss=So(),di=Rt(Ss);Te(di,()=>t()=="strongMagnet",Mn=>{var La=uM();pn(),O(Mn,La)},Mn=>{var La=So(),nn=Rt(La);Te(nn,()=>t()=="threeWaves",tr=>{var Ur=pM();O(tr,Ur)},tr=>{var Ur=So(),cl=Rt(Ur);Te(cl,()=>t()=="triangle",ui=>{var Yr=vM();O(ui,Yr)},ui=>{var Yr=So(),Ra=Rt(Yr);Te(Ra,()=>t()=="unlock",ga=>{var na=fM();O(ga,na)},ga=>{var na=So(),nl=Rt(na);Te(nl,()=>t()=="verticalRayLine",mi=>{var Ha=mM();O(mi,Ha)},mi=>{var Ha=So(),lr=Rt(Ha);Te(lr,()=>t()=="verticalSegment",zi=>{var hr=gM();O(zi,hr)},zi=>{var hr=So(),xa=Rt(hr);Te(xa,()=>t()=="verticalStraightLine",Qa=>{var ue=hM();O(Qa,ue)},Qa=>{var ue=So(),Fe=Rt(ue);Te(Fe,()=>t()=="visiable",ut=>{var Xe=_M();O(ut,Xe)},ut=>{var Xe=So(),ht=Rt(Xe);Te(ht,()=>t()=="weakMagnet",ao=>{var It=yM();O(ao,It)},ao=>{var It=So(),eo=Rt(It);Te(eo,()=>t()=="xabcd",Mo=>{var ho=bM();O(Mo,ho)},Mo=>{var ho=So(),to=Rt(ho);Te(to,()=>t()=="lang",ds=>{var js=xM();O(ds,js)},ds=>{var js=So(),Si=Rt(js);Te(Si,()=>t()=="theme",$r=>{var pa=wM();O($r,pa)},$r=>{var pa=So(),En=Rt(pa);Te(En,()=>t()=="user",za=>{var Rs=kM();O(za,Rs)},za=>{var Rs=So(),Zs=Rt(Rs);Te(Zs,()=>t()=="indicator",gn=>{var Wn=SM();O(gn,Wn)},gn=>{var Wn=So(),Tn=Rt(Wn);Te(Tn,()=>t()=="timezone",Ko=>{var Qt=CM();O(Ko,Qt)},Ko=>{var Qt=So(),H=Rt(Qt);Te(H,()=>t()=="play",Me=>{var Ue=PM();O(Me,Ue)},Me=>{var Ue=So(),yt=Rt(Ue);Te(yt,()=>t()=="stop",St=>{var lo=IM();O(St,lo)},St=>{var lo=So(),he=Rt(lo);Te(he,()=>t()=="setting",ke=>{var Ne=MM();O(ke,Ne)},ke=>{var Ne=So(),ie=Rt(Ne);Te(ie,()=>t()=="screenShot",Ct=>{var Kt=TM();O(Ct,Kt)},Ct=>{var Kt=So(),fo=Rt(Kt);Te(fo,()=>t()=="exitFullScreen",mo=>{var Go=AM();O(mo,Go)},mo=>{var Go=So(),Fo=Rt(Go);Te(Fo,()=>t()=="fullScreen",Wo=>{var us=LM();O(Wo,us)},Wo=>{var us=So(),Un=Rt(us);Te(Un,()=>t()=="cloud",or=>{var $s=zM();O(or,$s)},or=>{var $s=So(),gi=Rt($s);Te(gi,()=>t()=="undo",kn=>{var _r=FM();O(kn,_r)},kn=>{var _r=So(),Kr=Rt(_r);Te(Kr,()=>t()=="redo",Ul=>{var wa=$M();O(Ul,wa)},Ul=>{var wa=So(),wl=Rt(wa);Te(wl,()=>t()=="crosshair",Cl=>{var dl=DM();O(Cl,dl)},Cl=>{var dl=So(),cr=Rt(dl);Te(cr,()=>t()=="sidebar",Br=>{var Fi=EM();pn(2),O(Br,Fi)},Br=>{var Fi=NM(),fr=m(Fi,!0);f(Fi),Se(()=>Ve(fr,t())),O(Br,Fi)},!0),O(Cl,dl)},!0),O(Ul,wa)},!0),O(kn,_r)},!0),O(or,$s)},!0),O(Wo,us)},!0),O(mo,Go)},!0),O(Ct,Kt)},!0),O(ke,Ne)},!0),O(St,lo)},!0),O(Me,Ue)},!0),O(Ko,Qt)},!0),O(gn,Wn)},!0),O(za,Rs)},!0),O($r,pa)},!0),O(ds,js)},!0),O(Mo,ho)},!0),O(ao,It)},!0),O(ut,Xe)},!0),O(Qa,ue)},!0),O(zi,hr)},!0),O(mi,Ha)},!0),O(ga,na)},!0),O(ui,Yr)},!0),O(tr,Ur)},!0),O(Mn,La)},!0),O(Vn,Ss)},!0),O(Ms,zn)},!0),O(_o,go)},!0),O(kt,xo)},!0),O(is,Es)},!0),O(Io,Bo)},!0),O(jt,Lt)},!0),O(xe,gt)},!0),O(de,De)},!0),O(Nc,be)},!0),O(Fl,qa)},!0),O(jl,Td)},!0),O(Ec,Ja)},!0),O(Uc,Nl)},!0),O(Jl,Wl)},!0),O(fc,rd)},!0),O(oa,ol)},!0),O(es,Li)},!0),O(Ks,ws)},!0),O(bs,Is)},!0),O(no,Do)},!0),O(Yt,At)},!0),O(it,Vt)},!0),O(qe,me)},!0),O(we,ze)},!0),O(Ge,pt)},!0),O(tt,Ze)},!0),O(Je,ot)},!0),O(Ke,st)},!0),O(ye,Ce)},!0),O(se,W)},!0),O(oe,U)},!0),O(Z,ne)},!0),O(V,K)},!0),O(B,$)},!0),O(T,z)},!0),O(M,I)},!0),O(y,k)},!0),O(v,g)},!0),O(l,c)}),f(r),Se(()=>{Nt(r,"style",`width: ${i()??""}px; height: ${i()??""}px;`),ii(r,"active",s())}),O(o,r)}var yh={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */yh.exports;(function(o,e){(function(){var t,s="4.17.21",i=200,r="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",d=500,v="__lodash_placeholder__",g=1,_=2,y=4,k=1,S=2,M=1,I=2,C=4,T=8,z=16,j=32,B=64,$=128,F=256,V=512,K=30,Y="...",Z=800,ne=16,te=1,oe=2,U=3,J=1/0,se=9007199254740991,W=17976931348623157e292,le=NaN,ye=4294967295,Ce=ye-1,Re=ye>>>1,Ke=[["ary",$],["bind",M],["bindKey",I],["curry",T],["curryRight",z],["flip",V],["partial",j],["partialRight",B],["rearg",F]],st="[object Arguments]",vt="[object Array]",Je="[object AsyncFunction]",ot="[object Boolean]",nt="[object Date]",tt="[object DOMException]",Ze="[object Error]",ct="[object Function]",Ge="[object GeneratorFunction]",pt="[object Map]",ce="[object Number]",we="[object Null]",ze="[object Object]",dt="[object Promise]",qe="[object Proxy]",me="[object RegExp]",Q="[object Set]",it="[object String]",Vt="[object Symbol]",wt="[object Undefined]",Yt="[object WeakMap]",At="[object WeakSet]",Gt="[object ArrayBuffer]",no="[object DataView]",Do="[object Float32Array]",Eo="[object Float64Array]",bs="[object Int8Array]",Is="[object Int16Array]",qi="[object Int32Array]",Ks="[object Uint8Array]",ws="[object Uint8ClampedArray]",vn="[object Uint16Array]",es="[object Uint32Array]",Li=/\b__p \+= '';/g,ci=/\b(__p \+=) '' \+/g,oa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ol=/&(?:amp|lt|gt|quot|#39);/g,Xi=/[&<>"']/g,fc=RegExp(ol.source),rd=RegExp(Xi.source),ml=/<%-([\s\S]+?)%>/g,Jl=/<%([\s\S]+?)%>/g,Wl=/<%=([\s\S]+?)%>/g,sl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Uc=/^\w*$/,Nl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yc=/[\\^$.*+?()[\]{}|]/g,Ec=RegExp(Yc.source),Ja=/^\s+/,sa=/\s/,jl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Td=/\{\n\/\* \[wrapped with (.+)\] \*/,_d=/,? & /,Fl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qa=/[()=,{}\[\]\/\s]/,td=/\\(\\)?/g,Nc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,be=/\w*$/,We=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,De=/^\[object .+?Constructor\]$/,Ee=/^0o[0-7]+$/i,xe=/^(?:0|[1-9]\d*)$/,gt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,at=/($^)/,jt=/['\n\r\u2028\u2029\\]/g,Lt="\\ud800-\\udfff",Mt="\\u0300-\\u036f",Io="\\ufe20-\\ufe2f",Bo="\\u20d0-\\u20ff",hs=Mt+Io+Bo,is="\\u2700-\\u27bf",Es="a-z\\xdf-\\xf6\\xf8-\\xff",bt="\\xac\\xb1\\xd7\\xf7",kt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",xo="\\u2000-\\u206f",$t=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",_o="A-Z\\xc0-\\xd6\\xd8-\\xde",go="\\ufe0e\\ufe0f",fs=bt+kt+xo+$t,Ms="['’]",zn="["+Lt+"]",qs="["+fs+"]",Vn="["+hs+"]",Ss="\\d+",di="["+is+"]",Mn="["+Es+"]",La="[^"+Lt+fs+Ss+is+Es+_o+"]",nn="\\ud83c[\\udffb-\\udfff]",tr="(?:"+Vn+"|"+nn+")",Ur="[^"+Lt+"]",cl="(?:\\ud83c[\\udde6-\\uddff]){2}",ui="[\\ud800-\\udbff][\\udc00-\\udfff]",Yr="["+_o+"]",Ra="\\u200d",ga="(?:"+Mn+"|"+La+")",na="(?:"+Yr+"|"+La+")",nl="(?:"+Ms+"(?:d|ll|m|re|s|t|ve))?",mi="(?:"+Ms+"(?:D|LL|M|RE|S|T|VE))?",Ha=tr+"?",lr="["+go+"]?",zi="(?:"+Ra+"(?:"+[Ur,cl,ui].join("|")+")"+lr+Ha+")*",hr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xa="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Qa=lr+Ha+zi,ue="(?:"+[di,cl,ui].join("|")+")"+Qa,Fe="(?:"+[Ur+Vn+"?",Vn,cl,ui,zn].join("|")+")",ut=RegExp(Ms,"g"),Xe=RegExp(Vn,"g"),ht=RegExp(nn+"(?="+nn+")|"+Fe+Qa,"g"),ao=RegExp([Yr+"?"+Mn+"+"+nl+"(?="+[qs,Yr,"$"].join("|")+")",na+"+"+mi+"(?="+[qs,Yr+ga,"$"].join("|")+")",Yr+"?"+ga+"+"+nl,Yr+"+"+mi,xa,hr,Ss,ue].join("|"),"g"),It=RegExp("["+Ra+Lt+hs+go+"]"),eo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Mo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ho=-1,to={};to[Do]=to[Eo]=to[bs]=to[Is]=to[qi]=to[Ks]=to[ws]=to[vn]=to[es]=!0,to[st]=to[vt]=to[Gt]=to[ot]=to[no]=to[nt]=to[Ze]=to[ct]=to[pt]=to[ce]=to[ze]=to[me]=to[Q]=to[it]=to[Yt]=!1;var ds={};ds[st]=ds[vt]=ds[Gt]=ds[no]=ds[ot]=ds[nt]=ds[Do]=ds[Eo]=ds[bs]=ds[Is]=ds[qi]=ds[pt]=ds[ce]=ds[ze]=ds[me]=ds[Q]=ds[it]=ds[Vt]=ds[Ks]=ds[ws]=ds[vn]=ds[es]=!0,ds[Ze]=ds[ct]=ds[Yt]=!1;var js={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Si={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pa={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},En=parseFloat,za=parseInt,Rs=typeof Tf=="object"&&Tf&&Tf.Object===Object&&Tf,Zs=typeof self=="object"&&self&&self.Object===Object&&self,gn=Rs||Zs||Function("return this")(),Wn=e&&!e.nodeType&&e,Tn=Wn&&!0&&o&&!o.nodeType&&o,Ko=Tn&&Tn.exports===Wn,Qt=Ko&&Rs.process,H=function(){try{var lt=Tn&&Tn.require&&Tn.require("util").types;return lt||Qt&&Qt.binding&&Qt.binding("util")}catch{}}(),Me=H&&H.isArrayBuffer,Ue=H&&H.isDate,yt=H&&H.isMap,St=H&&H.isRegExp,lo=H&&H.isSet,he=H&&H.isTypedArray;function ke(lt,Zt,qt){switch(qt.length){case 0:return lt.call(Zt);case 1:return lt.call(Zt,qt[0]);case 2:return lt.call(Zt,qt[0],qt[1]);case 3:return lt.call(Zt,qt[0],qt[1],qt[2])}return lt.apply(Zt,qt)}function Ne(lt,Zt,qt,Lo){for(var ks=-1,yr=lt==null?0:lt.length;++ks<yr;){var N=lt[ks];Zt(Lo,N,qt(N),lt)}return Lo}function ie(lt,Zt){for(var qt=-1,Lo=lt==null?0:lt.length;++qt<Lo&&Zt(lt[qt],qt,lt)!==!1;);return lt}function Ct(lt,Zt){for(var qt=lt==null?0:lt.length;qt--&&Zt(lt[qt],qt,lt)!==!1;);return lt}function Kt(lt,Zt){for(var qt=-1,Lo=lt==null?0:lt.length;++qt<Lo;)if(!Zt(lt[qt],qt,lt))return!1;return!0}function fo(lt,Zt){for(var qt=-1,Lo=lt==null?0:lt.length,ks=0,yr=[];++qt<Lo;){var N=lt[qt];Zt(N,qt,lt)&&(yr[ks++]=N)}return yr}function mo(lt,Zt){var qt=lt==null?0:lt.length;return!!qt&&Ul(lt,Zt,0)>-1}function Go(lt,Zt,qt){for(var Lo=-1,ks=lt==null?0:lt.length;++Lo<ks;)if(qt(Zt,lt[Lo]))return!0;return!1}function Fo(lt,Zt){for(var qt=-1,Lo=lt==null?0:lt.length,ks=Array(Lo);++qt<Lo;)ks[qt]=Zt(lt[qt],qt,lt);return ks}function Wo(lt,Zt){for(var qt=-1,Lo=Zt.length,ks=lt.length;++qt<Lo;)lt[ks+qt]=Zt[qt];return lt}function us(lt,Zt,qt,Lo){var ks=-1,yr=lt==null?0:lt.length;for(Lo&&yr&&(qt=lt[++ks]);++ks<yr;)qt=Zt(qt,lt[ks],ks,lt);return qt}function Un(lt,Zt,qt,Lo){var ks=lt==null?0:lt.length;for(Lo&&ks&&(qt=lt[--ks]);ks--;)qt=Zt(qt,lt[ks],ks,lt);return qt}function or(lt,Zt){for(var qt=-1,Lo=lt==null?0:lt.length;++qt<Lo;)if(Zt(lt[qt],qt,lt))return!0;return!1}var $s=dl("length");function gi(lt){return lt.split("")}function kn(lt){return lt.match(Fl)||[]}function _r(lt,Zt,qt){var Lo;return qt(lt,function(ks,yr,N){if(Zt(ks,yr,N))return Lo=yr,!1}),Lo}function Kr(lt,Zt,qt,Lo){for(var ks=lt.length,yr=qt+(Lo?1:-1);Lo?yr--:++yr<ks;)if(Zt(lt[yr],yr,lt))return yr;return-1}function Ul(lt,Zt,qt){return Zt===Zt?lf(lt,Zt,qt):Kr(lt,wl,qt)}function wa(lt,Zt,qt,Lo){for(var ks=qt-1,yr=lt.length;++ks<yr;)if(Lo(lt[ks],Zt))return ks;return-1}function wl(lt){return lt!==lt}function Cl(lt,Zt){var qt=lt==null?0:lt.length;return qt?fr(lt,Zt)/qt:le}function dl(lt){return function(Zt){return Zt==null?t:Zt[lt]}}function cr(lt){return function(Zt){return lt==null?t:lt[Zt]}}function Br(lt,Zt,qt,Lo,ks){return ks(lt,function(yr,N,X){qt=Lo?(Lo=!1,yr):Zt(qt,yr,N,X)}),qt}function Fi(lt,Zt){var qt=lt.length;for(lt.sort(Zt);qt--;)lt[qt]=lt[qt].value;return lt}function fr(lt,Zt){for(var qt,Lo=-1,ks=lt.length;++Lo<ks;){var yr=Zt(lt[Lo]);yr!==t&&(qt=qt===t?yr:qt+yr)}return qt}function gl(lt,Zt){for(var qt=-1,Lo=Array(lt);++qt<lt;)Lo[qt]=Zt(qt);return Lo}function Gs(lt,Zt){return Fo(Zt,function(qt){return[qt,lt[qt]]})}function Ql(lt){return lt&&lt.slice(0,vo(lt)+1).replace(Ja,"")}function ia(lt){return function(Zt){return lt(Zt)}}function jd(lt,Zt){return Fo(Zt,function(qt){return lt[qt]})}function xu(lt,Zt){return lt.has(Zt)}function ip(lt,Zt){for(var qt=-1,Lo=lt.length;++qt<Lo&&Ul(Zt,lt[qt],0)>-1;);return qt}function $p(lt,Zt){for(var qt=lt.length;qt--&&Ul(Zt,lt[qt],0)>-1;);return qt}function Wp(lt,Zt){for(var qt=lt.length,Lo=0;qt--;)lt[qt]===Zt&&++Lo;return Lo}var Yu=cr(js),Lu=cr(Si);function Cp(lt){return"\\"+pa[lt]}function Sv(lt,Zt){return lt==null?t:lt[Zt]}function rp(lt){return It.test(lt)}function jf(lt){return eo.test(lt)}function Ws(lt){for(var Zt,qt=[];!(Zt=lt.next()).done;)qt.push(Zt.value);return qt}function Cv(lt){var Zt=-1,qt=Array(lt.size);return lt.forEach(function(Lo,ks){qt[++Zt]=[ks,Lo]}),qt}function af(lt,Zt){return function(qt){return lt(Zt(qt))}}function Pp(lt,Zt){for(var qt=-1,Lo=lt.length,ks=0,yr=[];++qt<Lo;){var N=lt[qt];(N===Zt||N===v)&&(lt[qt]=v,yr[ks++]=qt)}return yr}function Ip(lt){var Zt=-1,qt=Array(lt.size);return lt.forEach(function(Lo){qt[++Zt]=Lo}),qt}function Rf(lt){var Zt=-1,qt=Array(lt.size);return lt.forEach(function(Lo){qt[++Zt]=[Lo,Lo]}),qt}function lf(lt,Zt,qt){for(var Lo=qt-1,ks=lt.length;++Lo<ks;)if(lt[Lo]===Zt)return Lo;return-1}function pe(lt,Zt,qt){for(var Lo=qt+1;Lo--;)if(lt[Lo]===Zt)return Lo;return Lo}function Pe(lt){return rp(lt)?po(lt):$s(lt)}function Ht(lt){return rp(lt)?Bs(lt):gi(lt)}function vo(lt){for(var Zt=lt.length;Zt--&&sa.test(lt.charAt(Zt)););return Zt}var as=cr($r);function po(lt){for(var Zt=ht.lastIndex=0;ht.test(lt);)++Zt;return Zt}function Bs(lt){return lt.match(ht)||[]}function xs(lt){return lt.match(ao)||[]}var en=function lt(Zt){Zt=Zt==null?gn:Sn.defaults(gn.Object(),Zt,Sn.pick(gn,Mo));var qt=Zt.Array,Lo=Zt.Date,ks=Zt.Error,yr=Zt.Function,N=Zt.Math,X=Zt.Object,fe=Zt.RegExp,Ae=Zt.String,Le=Zt.TypeError,ft=qt.prototype,Bt=yr.prototype,Ft=X.prototype,zt=Zt["__core-js_shared__"],io=Bt.toString,Wt=Ft.hasOwnProperty,zo=0,Et=function(){var u=/[^.]+$/.exec(zt&&zt.keys&&zt.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),Ut=Ft.toString,wo=io.call(X),xt=gn._,Ot=fe("^"+io.call(Wt).replace(Yc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),No=Ko?Zt.Buffer:t,ts=Zt.Symbol,Oo=Zt.Uint8Array,Cn=No?No.allocUnsafe:t,Cs=af(X.getPrototypeOf,X),rn=X.create,ko=Ft.propertyIsEnumerable,Xo=ft.splice,Ro=ts?ts.isConcatSpreadable:t,To=ts?ts.iterator:t,Co=ts?ts.toStringTag:t,Hs=function(){try{var u=Hc(X,"defineProperty");return u({},"",{}),u}catch{}}(),jo=Zt.clearTimeout!==gn.clearTimeout&&Zt.clearTimeout,ls=Lo&&Lo.now!==gn.Date.now&&Lo.now,Rn=Zt.setTimeout!==gn.setTimeout&&Zt.setTimeout,Os=N.ceil,Pn=N.floor,Oi=X.getOwnPropertySymbols,pi=No?No.isBuffer:t,an=Zt.isFinite,tn=ft.join,Hi=af(X.keys,X),ps=N.max,_s=N.min,fn=Lo.now,Ci=Zt.parseInt,dr=N.random,vi=ft.reverse,Fa=Hc(Zt,"DataView"),ri=Hc(Zt,"Map"),ka=Hc(Zt,"Promise"),va=Hc(Zt,"Set"),wc=Hc(Zt,"WeakMap"),$i=Hc(X,"create"),mr=wc&&new wc,ad={},Gd=_f(Fa),Kc=_f(ri),vd=_f(ka),$l=_f(va),ha=_f(wc),et=ts?ts.prototype:t,As=et?et.valueOf:t,yn=et?et.toString:t;function ae(u){if(mn(u)&&!Ts(u)&&!(u instanceof Ls)){if(u instanceof ki)return u;if(Wt.call(u,"__wrapped__"))return X0(u)}return new ki(u)}var Ns=function(){function u(){}return function(h){if(!ns(h))return{};if(rn)return rn(h);u.prototype=h;var P=new u;return u.prototype=t,P}}();function ra(){}function ki(u,h){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=t}ae.templateSettings={escape:ml,evaluate:Jl,interpolate:Wl,variable:"",imports:{_:ae}},ae.prototype=ra.prototype,ae.prototype.constructor=ae,ki.prototype=Ns(ra.prototype),ki.prototype.constructor=ki;function Ls(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ye,this.__views__=[]}function Rl(){var u=new Ls(this.__wrapped__);return u.__actions__=_u(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=_u(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=_u(this.__views__),u}function mc(){if(this.__filtered__){var u=new Ls(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Jd(){var u=this.__wrapped__.value(),h=this.__dir__,P=Ts(u),q=h<0,ge=P?u.length:0,je=bo(0,ge,this.__views__),mt=je.start,Dt=je.end,co=Dt-mt,ms=q?Dt:mt-1,gs=this.__iteratees__,Fs=gs.length,wi=0,da=_s(co,this.__takeCount__);if(!P||!q&&ge==co&&da==co)return Uv(u,this.__actions__);var bl=[];e:for(;co--&&wi<da;){ms+=h;for(var _c=-1,xl=u[ms];++_c<Fs;){var $c=gs[_c],Gc=$c.iteratee,ev=$c.type,Lp=Gc(xl);if(ev==oe)xl=Lp;else if(!Lp){if(ev==te)continue e;break e}}bl[wi++]=xl}return bl}Ls.prototype=Ns(ra.prototype),Ls.prototype.constructor=Ls;function Wc(u){var h=-1,P=u==null?0:u.length;for(this.clear();++h<P;){var q=u[h];this.set(q[0],q[1])}}function nc(){this.__data__=$i?$i(null):{},this.size=0}function Ao(u){var h=this.has(u)&&delete this.__data__[u];return this.size-=h?1:0,h}function ln(u){var h=this.__data__;if($i){var P=h[u];return P===c?t:P}return Wt.call(h,u)?h[u]:t}function ul(u){var h=this.__data__;return $i?h[u]!==t:Wt.call(h,u)}function ql(u,h){var P=this.__data__;return this.size+=this.has(u)?0:1,P[u]=$i&&h===t?c:h,this}Wc.prototype.clear=nc,Wc.prototype.delete=Ao,Wc.prototype.get=ln,Wc.prototype.has=ul,Wc.prototype.set=ql;function Pl(u){var h=-1,P=u==null?0:u.length;for(this.clear();++h<P;){var q=u[h];this.set(q[0],q[1])}}function kl(){this.__data__=[],this.size=0}function od(u){var h=this.__data__,P=Ad(h,u);if(P<0)return!1;var q=h.length-1;return P==q?h.pop():Xo.call(h,P,1),--this.size,!0}function ic(u){var h=this.__data__,P=Ad(h,u);return P<0?t:h[P][1]}function Il(u){return Ad(this.__data__,u)>-1}function kc(u,h){var P=this.__data__,q=Ad(P,u);return q<0?(++this.size,P.push([u,h])):P[q][1]=h,this}Pl.prototype.clear=kl,Pl.prototype.delete=od,Pl.prototype.get=ic,Pl.prototype.has=Il,Pl.prototype.set=kc;function lc(u){var h=-1,P=u==null?0:u.length;for(this.clear();++h<P;){var q=u[h];this.set(q[0],q[1])}}function iu(){this.size=0,this.__data__={hash:new Wc,map:new(ri||Pl),string:new Wc}}function Rd(u){var h=bd(this,u).delete(u);return this.size-=h?1:0,h}function fd(u){return bd(this,u).get(u)}function wu(u){return bd(this,u).has(u)}function Cd(u,h){var P=bd(this,u),q=P.size;return P.set(u,h),this.size+=P.size==q?0:1,this}lc.prototype.clear=iu,lc.prototype.delete=Rd,lc.prototype.get=fd,lc.prototype.has=wu,lc.prototype.set=Cd;function jc(u){var h=-1,P=u==null?0:u.length;for(this.__data__=new lc;++h<P;)this.add(u[h])}function Yl(u){return this.__data__.set(u,c),this}function Ac(u){return this.__data__.has(u)}jc.prototype.add=jc.prototype.push=Yl,jc.prototype.has=Ac;function Ie(u){var h=this.__data__=new Pl(u);this.size=h.size}function ss(){this.__data__=new Pl,this.size=0}function sr(u){var h=this.__data__,P=h.delete(u);return this.size=h.size,P}function Sa(u){return this.__data__.get(u)}function Ml(u){return this.__data__.has(u)}function Zc(u,h){var P=this.__data__;if(P instanceof Pl){var q=P.__data__;if(!ri||q.length<i-1)return q.push([u,h]),this.size=++P.size,this;P=this.__data__=new lc(q)}return P.set(u,h),this.size=P.size,this}Ie.prototype.clear=ss,Ie.prototype.delete=sr,Ie.prototype.get=Sa,Ie.prototype.has=Ml,Ie.prototype.set=Zc;function ec(u,h){var P=Ts(u),q=!P&&Gr(u),ge=!P&&!q&&Ys(u),je=!P&&!q&&!ge&&ca(u),mt=P||q||ge||je,Dt=mt?gl(u.length,Ae):[],co=Dt.length;for(var ms in u)(h||Wt.call(u,ms))&&!(mt&&(ms=="length"||ge&&(ms=="offset"||ms=="parent")||je&&(ms=="buffer"||ms=="byteLength"||ms=="byteOffset")||Di(ms,co)))&&Dt.push(ms);return Dt}function Ku(u){var h=u.length;return h?u[lp(0,h-1)]:t}function Bd(u,h){return em(_u(u),hu(h,0,u.length))}function Od(u){return em(_u(u))}function sd(u,h,P){(P!==t&&!bi(u[h],P)||P===t&&!(h in u))&&Ud(u,h,P)}function Ca(u,h,P){var q=u[h];(!(Wt.call(u,h)&&bi(q,P))||P===t&&!(h in u))&&Ud(u,h,P)}function Ad(u,h){for(var P=u.length;P--;)if(bi(u[P][0],h))return P;return-1}function uu(u,h,P,q){return cs(u,function(ge,je,mt){h(q,ge,P(ge),mt)}),q}function ru(u,h){return u&&Vu(h,Md(h),u)}function Zr(u,h){return u&&Vu(h,Bc(h),u)}function Ud(u,h,P){h=="__proto__"&&Hs?Hs(u,h,{configurable:!0,enumerable:!0,value:P,writable:!0}):u[h]=P}function hl(u,h){for(var P=-1,q=h.length,ge=qt(q),je=u==null;++P<q;)ge[P]=je?t:up(u,h[P]);return ge}function hu(u,h,P){return u===u&&(P!==t&&(u=u<=P?u:P),h!==t&&(u=u>=h?u:h)),u}function md(u,h,P,q,ge,je){var mt,Dt=h&g,co=h&_,ms=h&y;if(P&&(mt=ge?P(u,q,ge,je):P(u)),mt!==t)return mt;if(!ns(u))return u;var gs=Ts(u);if(gs){if(mt=ro(u),!Dt)return _u(u,mt)}else{var Fs=li(u),wi=Fs==ct||Fs==Ge;if(Ys(u))return mf(u,Dt);if(Fs==ze||Fs==st||wi&&!ge){if(mt=co||wi?{}:hn(u),!Dt)return co?vv(u,Zr(mt,u)):Of(u,ru(mt,u))}else{if(!ds[Fs])return ge?u:{};mt=qn(u,Fs,Dt)}}je||(je=new Ie);var da=je.get(u);if(da)return da;je.set(u,mt),Xl(u)?u.forEach(function(xl){mt.add(md(xl,h,P,xl,u,je))}):Ar(u)&&u.forEach(function(xl,$c){mt.set($c,md(xl,h,P,$c,u,je))});var bl=ms?co?ya:Ii:co?Bc:Md,_c=gs?t:bl(u);return ie(_c||u,function(xl,$c){_c&&($c=xl,xl=u[$c]),Ca(mt,$c,md(xl,h,P,$c,u,je))}),mt}function ap(u){var h=Md(u);return function(P){return Nn(P,u,h)}}function Nn(u,h,P){var q=P.length;if(u==null)return!q;for(u=X(u);q--;){var ge=P[q],je=h[ge],mt=u[ge];if(mt===t&&!(ge in u)||!je(mt))return!1}return!0}function on(u,h,P){if(typeof u!="function")throw new Le(a);return qf(function(){u.apply(t,P)},h)}function Pi(u,h,P,q){var ge=-1,je=mo,mt=!0,Dt=u.length,co=[],ms=h.length;if(!Dt)return co;P&&(h=Fo(h,ia(P))),q?(je=Go,mt=!1):h.length>=i&&(je=xu,mt=!1,h=new jc(h));e:for(;++ge<Dt;){var gs=u[ge],Fs=P==null?gs:P(gs);if(gs=q||gs!==0?gs:0,mt&&Fs===Fs){for(var wi=ms;wi--;)if(h[wi]===Fs)continue e;co.push(gs)}else je(h,Fs,q)||co.push(gs)}return co}var cs=hf(Xr),ur=hf(Ji,!0);function Or(u,h){var P=!0;return cs(u,function(q,ge,je){return P=!!h(q,ge,je),P}),P}function Jo(u,h,P){for(var q=-1,ge=u.length;++q<ge;){var je=u[q],mt=h(je);if(mt!=null&&(Dt===t?mt===mt&&!El(mt):P(mt,Dt)))var Dt=mt,co=je}return co}function zs(u,h,P,q){var ge=u.length;for(P=Pr(P),P<0&&(P=-P>ge?0:ge+P),q=q===t||q>ge?ge:Pr(q),q<0&&(q+=ge),q=P>q?0:Zd(q);P<q;)u[P++]=h;return u}function Zo(u,h){var P=[];return cs(u,function(q,ge,je){h(q,ge,je)&&P.push(q)}),P}function br(u,h,P,q,ge){var je=-1,mt=u.length;for(P||(P=Qi),ge||(ge=[]);++je<mt;){var Dt=u[je];h>0&&P(Dt)?h>1?br(Dt,h-1,P,q,ge):Wo(ge,Dt):q||(ge[ge.length]=Dt)}return ge}var cc=Yn(),Xs=Yn(!0);function Xr(u,h){return u&&cc(u,h,Md)}function Ji(u,h){return u&&Xs(u,h,Md)}function Gi(u,h){return fo(h,function(P){return Ri(u[P])})}function jn(u,h){h=yp(h,u);for(var P=0,q=h.length;u!=null&&P<q;)u=u[Zp(h[P++])];return P&&P==q?u:t}function Ga(u,h,P){var q=h(u);return Ts(u)?q:Wo(q,P(u))}function fa(u){return u==null?u===t?wt:we:Co&&Co in X(u)?Tl(u):H0(u)}function Ba(u,h){return u>h}function bn(u,h){return u!=null&&Wt.call(u,h)}function yd(u,h){return u!=null&&h in X(u)}function qo(u,h,P){return u>=_s(h,P)&&u<ps(h,P)}function _l(u,h,P){for(var q=P?Go:mo,ge=u[0].length,je=u.length,mt=je,Dt=qt(je),co=1/0,ms=[];mt--;){var gs=u[mt];mt&&h&&(gs=Fo(gs,ia(h))),co=_s(gs.length,co),Dt[mt]=!P&&(h||ge>=120&&gs.length>=120)?new jc(mt&&gs):t}gs=u[0];var Fs=-1,wi=Dt[0];e:for(;++Fs<ge&&ms.length<co;){var da=gs[Fs],bl=h?h(da):da;if(da=P||da!==0?da:0,!(wi?xu(wi,bl):q(ms,bl,P))){for(mt=je;--mt;){var _c=Dt[mt];if(!(_c?xu(_c,bl):q(u[mt],bl,P)))continue e}wi&&wi.push(bl),ms.push(da)}}return ms}function Kl(u,h,P,q){return Xr(u,function(ge,je,mt){h(q,P(ge),je,mt)}),q}function Sl(u,h,P){h=yp(h,u),u=Vm(u,h);var q=u==null?u:u[Zp(Tp(h))];return q==null?t:ke(q,u,P)}function Pa(u){return mn(u)&&fa(u)==st}function Sc(u){return mn(u)&&fa(u)==Gt}function ai(u){return mn(u)&&fa(u)==nt}function Ir(u,h,P,q,ge){return u===h?!0:u==null||h==null||!mn(u)&&!mn(h)?u!==u&&h!==h:nr(u,h,P,q,Ir,ge)}function nr(u,h,P,q,ge,je){var mt=Ts(u),Dt=Ts(h),co=mt?vt:li(u),ms=Dt?vt:li(h);co=co==st?ze:co,ms=ms==st?ze:ms;var gs=co==ze,Fs=ms==ze,wi=co==ms;if(wi&&Ys(u)){if(!Ys(h))return!1;mt=!0,gs=!1}if(wi&&!gs)return je||(je=new Ie),mt||ca(u)?In(u,h,P,q,ge,je):ma(u,h,co,P,q,ge,je);if(!(P&k)){var da=gs&&Wt.call(u,"__wrapped__"),bl=Fs&&Wt.call(h,"__wrapped__");if(da||bl){var _c=da?u.value():u,xl=bl?h.value():h;return je||(je=new Ie),ge(_c,xl,P,q,je)}}return wi?(je||(je=new Ie),Bl(u,h,P,q,ge,je)):!1}function il(u){return mn(u)&&li(u)==pt}function Dr(u,h,P,q){var ge=P.length,je=ge,mt=!q;if(u==null)return!je;for(u=X(u);ge--;){var Dt=P[ge];if(mt&&Dt[2]?Dt[1]!==u[Dt[0]]:!(Dt[0]in u))return!1}for(;++ge<je;){Dt=P[ge];var co=Dt[0],ms=u[co],gs=Dt[1];if(mt&&Dt[2]){if(ms===t&&!(co in u))return!1}else{var Fs=new Ie;if(q)var wi=q(ms,gs,co,u,h,Fs);if(!(wi===t?Ir(gs,ms,k|S,q,Fs):wi))return!1}}return!0}function qc(u){if(!ns(u)||xp(u))return!1;var h=Ri(u)?Ot:De;return h.test(_f(u))}function ld(u){return mn(u)&&fa(u)==me}function pu(u){return mn(u)&&li(u)==Q}function Vd(u){return mn(u)&&un(u.length)&&!!to[fa(u)]}function ku(u){return typeof u=="function"?u:u==null?Bp:typeof u=="object"?Ts(u)?Zu(u[0],u[1]):qp(u):O1(u)}function Ou(u){if(!Xu(u))return Hi(u);var h=[];for(var P in X(u))Wt.call(u,P)&&P!="constructor"&&h.push(P);return h}function zu(u){if(!ns(u))return jh(u);var h=Xu(u),P=[];for(var q in u)q=="constructor"&&(h||!Wt.call(u,q))||P.push(q);return P}function Xc(u,h){return u<h}function lv(u,h){var P=-1,q=ji(u)?qt(u.length):[];return cs(u,function(ge,je,mt){q[++P]=h(ge,je,mt)}),q}function qp(u){var h=rc(u);return h.length==1&&h[0][2]?Zv(h[0][0],h[0][1]):function(P){return P===u||Dr(P,u,h)}}function Zu(u,h){return Lc(u)&&Vf(h)?Zv(Zp(u),h):function(P){var q=up(P,u);return q===t&&q===h?fv(P,u):Ir(h,q,k|S)}}function Fu(u,h,P,q,ge){u!==h&&cc(h,function(je,mt){if(ge||(ge=new Ie),ns(je))Hp(u,h,mt,P,Fu,q,ge);else{var Dt=q?q(mm(u,mt),je,mt+"",u,h,ge):t;Dt===t&&(Dt=je),sd(u,mt,Dt)}},Bc)}function Hp(u,h,P,q,ge,je,mt){var Dt=mm(u,P),co=mm(h,P),ms=mt.get(co);if(ms){sd(u,P,ms);return}var gs=je?je(Dt,co,P+"",u,h,mt):t,Fs=gs===t;if(Fs){var wi=Ts(co),da=!wi&&Ys(co),bl=!wi&&!da&&ca(co);gs=co,wi||da||bl?Ts(Dt)?gs=Dt:Ln(Dt)?gs=_u(Dt):da?(Fs=!1,gs=mf(co,!0)):bl?(Fs=!1,gs=pv(co,!0)):gs=[]:vl(co)||Gr(co)?(gs=Dt,Gr(Dt)?gs=tu(Dt):(!ns(Dt)||Ri(Dt))&&(gs=hn(co))):Fs=!1}Fs&&(mt.set(co,gs),ge(gs,co,q,je,mt),mt.delete(co)),sd(u,P,gs)}function Gp(u,h){var P=u.length;if(P)return h+=h<0?P:0,Di(h,P)?u[h]:t}function cv(u,h,P){h.length?h=Fo(h,function(je){return Ts(je)?function(mt){return jn(mt,je.length===1?je[0]:je)}:je}):h=[Bp];var q=-1;h=Fo(h,ia(Zn()));var ge=lv(u,function(je,mt,Dt){var co=Fo(h,function(ms){return ms(je)});return{criteria:co,index:++q,value:je}});return Fi(ge,function(je,mt){return Av(je,mt,P)})}function Vv(u,h){return _p(u,h,function(P,q){return fv(u,q)})}function _p(u,h,P){for(var q=-1,ge=h.length,je={};++q<ge;){var mt=h[q],Dt=jn(u,mt);P(Dt,mt)&&Up(je,yp(mt,u),Dt)}return je}function Dp(u){return function(h){return jn(h,u)}}function yc(u,h,P,q){var ge=q?wa:Ul,je=-1,mt=h.length,Dt=u;for(u===h&&(h=_u(h)),P&&(Dt=Fo(u,ia(P)));++je<mt;)for(var co=0,ms=h[je],gs=P?P(ms):ms;(co=ge(Dt,gs,co,q))>-1;)Dt!==u&&Xo.call(Dt,co,1),Xo.call(u,co,1);return u}function Ep(u,h){for(var P=u?h.length:0,q=P-1;P--;){var ge=h[P];if(P==q||ge!==je){var je=ge;Di(ge)?Xo.call(u,ge,1):Hv(u,ge)}}return u}function lp(u,h){return u+Pn(dr()*(h-u+1))}function Wv(u,h,P,q){for(var ge=-1,je=ps(Os((h-u)/(P||1)),0),mt=qt(je);je--;)mt[q?je:++ge]=u,u+=P;return mt}function cf(u,h){var P="";if(!u||h<1||h>se)return P;do h%2&&(P+=u),h=Pn(h/2),h&&(u+=u);while(h);return P}function Er(u,h){return Wm(G0(u,h,Bp),u+"")}function $u(u){return Ku(Qv(u))}function Pv(u,h){var P=Qv(u);return em(P,hu(h,0,P.length))}function Up(u,h,P,q){if(!ns(u))return u;h=yp(h,u);for(var ge=-1,je=h.length,mt=je-1,Dt=u;Dt!=null&&++ge<je;){var co=Zp(h[ge]),ms=P;if(co==="__proto__"||co==="constructor"||co==="prototype")return u;if(ge!=mt){var gs=Dt[co];ms=q?q(gs,co,Dt):t,ms===t&&(ms=ns(gs)?gs:Di(h[ge+1])?[]:{})}Ca(Dt,co,ms),Dt=Dt[co]}return u}var dv=mr?function(u,h){return mr.set(u,h),u}:Bp,Iv=Hs?function(u,h){return Hs(u,"toString",{configurable:!0,enumerable:!1,value:sm(h),writable:!0})}:Bp;function qv(u){return em(Qv(u))}function vu(u,h,P){var q=-1,ge=u.length;h<0&&(h=-h>ge?0:ge+h),P=P>ge?ge:P,P<0&&(P+=ge),ge=h>P?0:P-h>>>0,h>>>=0;for(var je=qt(ge);++q<ge;)je[q]=u[q+h];return je}function df(u,h){var P;return cs(u,function(q,ge,je){return P=h(q,ge,je),!P}),!!P}function Np(u,h,P){var q=0,ge=u==null?q:u.length;if(typeof h=="number"&&h===h&&ge<=Re){for(;q<ge;){var je=q+ge>>>1,mt=u[je];mt!==null&&!El(mt)&&(P?mt<=h:mt<h)?q=je+1:ge=je}return ge}return jp(u,h,Bp,P)}function jp(u,h,P,q){var ge=0,je=u==null?0:u.length;if(je===0)return 0;h=P(h);for(var mt=h!==h,Dt=h===null,co=El(h),ms=h===t;ge<je;){var gs=Pn((ge+je)/2),Fs=P(u[gs]),wi=Fs!==t,da=Fs===null,bl=Fs===Fs,_c=El(Fs);if(mt)var xl=q||bl;else ms?xl=bl&&(q||wi):Dt?xl=bl&&wi&&(q||!da):co?xl=bl&&wi&&!da&&(q||!_c):da||_c?xl=!1:xl=q?Fs<=h:Fs<h;xl?ge=gs+1:je=gs}return _s(je,Ce)}function uf(u,h){for(var P=-1,q=u.length,ge=0,je=[];++P<q;){var mt=u[P],Dt=h?h(mt):mt;if(!P||!bi(Dt,co)){var co=Dt;je[ge++]=mt===0?0:mt}}return je}function Mv(u){return typeof u=="number"?u:El(u)?le:+u}function Su(u){if(typeof u=="string")return u;if(Ts(u))return Fo(u,Su)+"";if(El(u))return yn?yn.call(u):"";var h=u+"";return h=="0"&&1/u==-J?"-0":h}function cp(u,h,P){var q=-1,ge=mo,je=u.length,mt=!0,Dt=[],co=Dt;if(P)mt=!1,ge=Go;else if(je>=i){var ms=h?null:oo(u);if(ms)return Ip(ms);mt=!1,ge=xu,co=new jc}else co=h?[]:Dt;e:for(;++q<je;){var gs=u[q],Fs=h?h(gs):gs;if(gs=P||gs!==0?gs:0,mt&&Fs===Fs){for(var wi=co.length;wi--;)if(co[wi]===Fs)continue e;h&&co.push(Fs),Dt.push(gs)}else ge(co,Fs,P)||(co!==Dt&&co.push(Fs),Dt.push(gs))}return Dt}function Hv(u,h){return h=yp(h,u),u=Vm(u,h),u==null||delete u[Zp(Tp(h))]}function Gv(u,h,P,q){return Up(u,h,P(jn(u,h)),q)}function Tv(u,h,P,q){for(var ge=u.length,je=q?ge:-1;(q?je--:++je<ge)&&h(u[je],je,u););return P?vu(u,q?0:je,q?je+1:ge):vu(u,q?je+1:0,q?ge:je)}function Uv(u,h){var P=u;return P instanceof Ls&&(P=P.value()),us(h,function(q,ge){return ge.func.apply(ge.thisArg,Wo([q],ge.args))},P)}function uv(u,h,P){var q=u.length;if(q<2)return q?cp(u[0]):[];for(var ge=-1,je=qt(q);++ge<q;)for(var mt=u[ge],Dt=-1;++Dt<q;)Dt!=ge&&(je[ge]=Pi(je[ge]||mt,u[Dt],h,P));return cp(br(je,1),h,P)}function pf(u,h,P){for(var q=-1,ge=u.length,je=h.length,mt={};++q<ge;){var Dt=q<je?h[q]:t;P(mt,u[q],Dt)}return mt}function Yv(u){return Ln(u)?u:[]}function vf(u){return typeof u=="function"?u:Bp}function yp(u,h){return Ts(u)?u:Lc(u,h)?[u]:K0(el(u))}var Bf=Er;function Mp(u,h,P){var q=u.length;return P=P===t?q:P,!h&&P>=q?u:vu(u,h,P)}var ff=jo||function(u){return gn.clearTimeout(u)};function mf(u,h){if(h)return u.slice();var P=u.length,q=Cn?Cn(P):new u.constructor(P);return u.copy(q),q}function Kv(u){var h=new u.constructor(u.byteLength);return new Oo(h).set(new Oo(u)),h}function Qf(u,h){var P=h?Kv(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.byteLength)}function Yp(u){var h=new u.constructor(u.source,be.exec(u));return h.lastIndex=u.lastIndex,h}function Kp(u){return As?X(As.call(u)):{}}function pv(u,h){var P=h?Kv(u.buffer):u.buffer;return new u.constructor(P,u.byteOffset,u.length)}function Rp(u,h){if(u!==h){var P=u!==t,q=u===null,ge=u===u,je=El(u),mt=h!==t,Dt=h===null,co=h===h,ms=El(h);if(!Dt&&!ms&&!je&&u>h||je&&mt&&co&&!Dt&&!ms||q&&mt&&co||!P&&co||!ge)return 1;if(!q&&!je&&!ms&&u<h||ms&&P&&ge&&!q&&!je||Dt&&P&&ge||!mt&&ge||!co)return-1}return 0}function Av(u,h,P){for(var q=-1,ge=u.criteria,je=h.criteria,mt=ge.length,Dt=P.length;++q<mt;){var co=Rp(ge[q],je[q]);if(co){if(q>=Dt)return co;var ms=P[q];return co*(ms=="desc"?-1:1)}}return u.index-h.index}function Lv(u,h,P,q){for(var ge=-1,je=u.length,mt=P.length,Dt=-1,co=h.length,ms=ps(je-mt,0),gs=qt(co+ms),Fs=!q;++Dt<co;)gs[Dt]=h[Dt];for(;++ge<mt;)(Fs||ge<je)&&(gs[P[ge]]=u[ge]);for(;ms--;)gs[Dt++]=u[ge++];return gs}function gf(u,h,P,q){for(var ge=-1,je=u.length,mt=-1,Dt=P.length,co=-1,ms=h.length,gs=ps(je-Dt,0),Fs=qt(gs+ms),wi=!q;++ge<gs;)Fs[ge]=u[ge];for(var da=ge;++co<ms;)Fs[da+co]=h[co];for(;++mt<Dt;)(wi||ge<je)&&(Fs[da+P[mt]]=u[ge++]);return Fs}function _u(u,h){var P=-1,q=u.length;for(h||(h=qt(q));++P<q;)h[P]=u[P];return h}function Vu(u,h,P,q){var ge=!P;P||(P={});for(var je=-1,mt=h.length;++je<mt;){var Dt=h[je],co=q?q(P[Dt],u[Dt],Dt,P,u):t;co===t&&(co=u[Dt]),ge?Ud(P,Dt,co):Ca(P,Dt,co)}return P}function Of(u,h){return Vu(u,Rc(u),h)}function vv(u,h){return Vu(u,Kn(u),h)}function zv(u,h){return function(P,q){var ge=Ts(P)?Ne:uu,je=h?h():{};return ge(P,u,Zn(q,2),je)}}function bp(u){return Er(function(h,P){var q=-1,ge=P.length,je=ge>1?P[ge-1]:t,mt=ge>2?P[2]:t;for(je=u.length>3&&typeof je=="function"?(ge--,je):t,mt&&Oa(P[0],P[1],mt)&&(je=ge<3?t:je,ge=1),h=X(h);++q<ge;){var Dt=P[q];Dt&&u(h,Dt,q,je)}return h})}function hf(u,h){return function(P,q){if(P==null)return P;if(!ji(P))return u(P,q);for(var ge=P.length,je=h?ge:-1,mt=X(P);(h?je--:++je<ge)&&q(mt[je],je,mt)!==!1;);return P}}function Yn(u){return function(h,P,q){for(var ge=-1,je=X(h),mt=q(h),Dt=mt.length;Dt--;){var co=mt[u?Dt:++ge];if(P(je[co],co,je)===!1)break}return h}}function vs(u,h,P){var q=h&M,ge=Ps(u);function je(){var mt=this&&this!==gn&&this instanceof je?ge:u;return mt.apply(q?P:this,arguments)}return je}function _a(u){return function(h){h=el(h);var P=rp(h)?Ht(h):t,q=P?P[0]:h.charAt(0),ge=P?Mp(P,1).join(""):h.slice(1);return q[u]()+ge}}function Vr(u){return function(h){return us(bm(Qm(h).replace(ut,"")),u,"")}}function Ps(u){return function(){var h=arguments;switch(h.length){case 0:return new u;case 1:return new u(h[0]);case 2:return new u(h[0],h[1]);case 3:return new u(h[0],h[1],h[2]);case 4:return new u(h[0],h[1],h[2],h[3]);case 5:return new u(h[0],h[1],h[2],h[3],h[4]);case 6:return new u(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new u(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var P=Ns(u.prototype),q=u.apply(P,h);return ns(q)?q:P}}function hi(u,h,P){var q=Ps(u);function ge(){for(var je=arguments.length,mt=qt(je),Dt=je,co=Jc(ge);Dt--;)mt[Dt]=arguments[Dt];var ms=je<3&&mt[0]!==co&&mt[je-1]!==co?[]:Pp(mt,co);if(je-=ms.length,je<P)return Vi(u,h,rt,ge.placeholder,t,mt,ms,t,t,P-je);var gs=this&&this!==gn&&this instanceof ge?q:u;return ke(gs,this,mt)}return ge}function Dl(u){return function(h,P,q){var ge=X(h);if(!ji(h)){var je=Zn(P,3);h=Md(h),P=function(Dt){return je(ge[Dt],Dt,ge)}}var mt=u(h,P,q);return mt>-1?ge[je?h[mt]:mt]:t}}function Ua(u){return xn(function(h){var P=h.length,q=P,ge=ki.prototype.thru;for(u&&h.reverse();q--;){var je=h[q];if(typeof je!="function")throw new Le(a);if(ge&&!mt&&Zl(je)=="wrapper")var mt=new ki([],!0)}for(q=mt?q:P;++q<P;){je=h[q];var Dt=Zl(je),co=Dt=="wrapper"?ei(je):t;co&&yu(co[0])&&co[1]==($|T|j|F)&&!co[4].length&&co[9]==1?mt=mt[Zl(co[0])].apply(mt,co[3]):mt=je.length==1&&yu(je)?mt[Dt]():mt.thru(je)}return function(){var ms=arguments,gs=ms[0];if(mt&&ms.length==1&&Ts(gs))return mt.plant(gs).value();for(var Fs=0,wi=P?h[Fs].apply(this,ms):gs;++Fs<P;)wi=h[Fs].call(this,wi);return wi}})}function rt(u,h,P,q,ge,je,mt,Dt,co,ms){var gs=h&$,Fs=h&M,wi=h&I,da=h&(T|z),bl=h&V,_c=wi?t:Ps(u);function xl(){for(var $c=arguments.length,Gc=qt($c),ev=$c;ev--;)Gc[ev]=arguments[ev];if(da)var Lp=Jc(xl),tv=Wp(Gc,Lp);if(q&&(Gc=Lv(Gc,q,ge,da)),je&&(Gc=gf(Gc,je,mt,da)),$c-=tv,da&&$c<ms){var Cu=Pp(Gc,Lp);return Vi(u,h,rt,xl.placeholder,P,Gc,Cu,Dt,co,ms-$c)}var $v=Fs?P:this,wf=wi?$v[u]:u;return $c=Gc.length,Dt?Gc=Rh(Gc,Dt):bl&&$c>1&&Gc.reverse(),gs&&co<$c&&(Gc.length=co),this&&this!==gn&&this instanceof xl&&(wf=_c||Ps(wf)),wf.apply($v,Gc)}return xl}function He(u,h){return function(P,q){return Kl(P,u,h(q),{})}}function Ye(u,h){return function(P,q){var ge;if(P===t&&q===t)return h;if(P!==t&&(ge=P),q!==t){if(ge===t)return q;typeof P=="string"||typeof q=="string"?(P=Su(P),q=Su(q)):(P=Mv(P),q=Mv(q)),ge=u(P,q)}return ge}}function Tt(u){return xn(function(h){return h=Fo(h,ia(Zn())),Er(function(P){var q=this;return u(h,function(ge){return ke(ge,q,P)})})})}function Pt(u,h){h=h===t?" ":Su(h);var P=h.length;if(P<2)return P?cf(h,u):h;var q=cf(h,Os(u/Pe(h)));return rp(h)?Mp(Ht(q),0,u).join(""):q.slice(0,u)}function Xt(u,h,P,q){var ge=h&M,je=Ps(u);function mt(){for(var Dt=-1,co=arguments.length,ms=-1,gs=q.length,Fs=qt(gs+co),wi=this&&this!==gn&&this instanceof mt?je:u;++ms<gs;)Fs[ms]=q[ms];for(;co--;)Fs[ms++]=arguments[++Dt];return ke(wi,ge?P:this,Fs)}return mt}function yo(u){return function(h,P,q){return q&&typeof q!="number"&&Oa(h,P,q)&&(P=q=t),h=Pc(h),P===t?(P=h,h=0):P=Pc(P),q=q===t?h<P?1:-1:Pc(q),Wv(h,P,q,u)}}function Qo(u){return function(h,P){return typeof h=="string"&&typeof P=="string"||(h=Ic(h),P=Ic(P)),u(h,P)}}function Vi(u,h,P,q,ge,je,mt,Dt,co,ms){var gs=h&T,Fs=gs?mt:t,wi=gs?t:mt,da=gs?je:t,bl=gs?t:je;h|=gs?j:B,h&=~(gs?B:j),h&C||(h&=~(M|I));var _c=[u,h,ge,da,Fs,bl,wi,Dt,co,ms],xl=P.apply(t,_c);return yu(u)&&U0(xl,_c),xl.placeholder=q,qm(xl,u,h)}function fi(u){var h=N[u];return function(P,q){if(P=Ic(P),q=q==null?0:_s(Pr(q),292),q&&an(P)){var ge=(el(P)+"e").split("e"),je=h(ge[0]+"e"+(+ge[1]+q));return ge=(el(je)+"e").split("e"),+(ge[0]+"e"+(+ge[1]-q))}return h(P)}}var oo=va&&1/Ip(new va([,-0]))[1]==J?function(u){return new va(u)}:p_;function Po(u){return function(h){var P=li(h);return P==pt?Cv(h):P==Q?Rf(h):Gs(h,u(h))}}function Ds(u,h,P,q,ge,je,mt,Dt){var co=h&I;if(!co&&typeof u!="function")throw new Le(a);var ms=q?q.length:0;if(ms||(h&=~(j|B),q=ge=t),mt=mt===t?mt:ps(Pr(mt),0),Dt=Dt===t?Dt:Pr(Dt),ms-=ge?ge.length:0,h&B){var gs=q,Fs=ge;q=ge=t}var wi=co?t:ei(u),da=[u,h,P,q,ge,gs,Fs,je,mt,Dt];if(wi&&Om(da,wi),u=da[0],h=da[1],P=da[2],q=da[3],ge=da[4],Dt=da[9]=da[9]===t?co?0:u.length:ps(da[9]-ms,0),!Dt&&h&(T|z)&&(h&=~(T|z)),!h||h==M)var bl=vs(u,h,P);else h==T||h==z?bl=hi(u,h,Dt):(h==j||h==(M|j))&&!ge.length?bl=Xt(u,h,P,q):bl=rt.apply(t,da);var _c=wi?dv:U0;return qm(_c(bl,da),u,h)}function Wi(u,h,P,q){return u===t||bi(u,Ft[P])&&!Wt.call(q,P)?h:u}function Bn(u,h,P,q,ge,je){return ns(u)&&ns(h)&&(je.set(h,u),Fu(u,h,t,Bn,je),je.delete(h)),u}function Qn(u){return vl(u)?t:u}function In(u,h,P,q,ge,je){var mt=P&k,Dt=u.length,co=h.length;if(Dt!=co&&!(mt&&co>Dt))return!1;var ms=je.get(u),gs=je.get(h);if(ms&&gs)return ms==h&&gs==u;var Fs=-1,wi=!0,da=P&S?new jc:t;for(je.set(u,h),je.set(h,u);++Fs<Dt;){var bl=u[Fs],_c=h[Fs];if(q)var xl=mt?q(_c,bl,Fs,h,u,je):q(bl,_c,Fs,u,h,je);if(xl!==t){if(xl)continue;wi=!1;break}if(da){if(!or(h,function($c,Gc){if(!xu(da,Gc)&&(bl===$c||ge(bl,$c,P,q,je)))return da.push(Gc)})){wi=!1;break}}else if(!(bl===_c||ge(bl,_c,P,q,je))){wi=!1;break}}return je.delete(u),je.delete(h),wi}function ma(u,h,P,q,ge,je,mt){switch(P){case no:if(u.byteLength!=h.byteLength||u.byteOffset!=h.byteOffset)return!1;u=u.buffer,h=h.buffer;case Gt:return!(u.byteLength!=h.byteLength||!je(new Oo(u),new Oo(h)));case ot:case nt:case ce:return bi(+u,+h);case Ze:return u.name==h.name&&u.message==h.message;case me:case it:return u==h+"";case pt:var Dt=Cv;case Q:var co=q&k;if(Dt||(Dt=Ip),u.size!=h.size&&!co)return!1;var ms=mt.get(u);if(ms)return ms==h;q|=S,mt.set(u,h);var gs=In(Dt(u),Dt(h),q,ge,je,mt);return mt.delete(u),gs;case Vt:if(As)return As.call(u)==As.call(h)}return!1}function Bl(u,h,P,q,ge,je){var mt=P&k,Dt=Ii(u),co=Dt.length,ms=Ii(h),gs=ms.length;if(co!=gs&&!mt)return!1;for(var Fs=co;Fs--;){var wi=Dt[Fs];if(!(mt?wi in h:Wt.call(h,wi)))return!1}var da=je.get(u),bl=je.get(h);if(da&&bl)return da==h&&bl==u;var _c=!0;je.set(u,h),je.set(h,u);for(var xl=mt;++Fs<co;){wi=Dt[Fs];var $c=u[wi],Gc=h[wi];if(q)var ev=mt?q(Gc,$c,wi,h,u,je):q($c,Gc,wi,u,h,je);if(!(ev===t?$c===Gc||ge($c,Gc,P,q,je):ev)){_c=!1;break}xl||(xl=wi=="constructor")}if(_c&&!xl){var Lp=u.constructor,tv=h.constructor;Lp!=tv&&"constructor"in u&&"constructor"in h&&!(typeof Lp=="function"&&Lp instanceof Lp&&typeof tv=="function"&&tv instanceof tv)&&(_c=!1)}return je.delete(u),je.delete(h),_c}function xn(u){return Wm(G0(u,t,Gm),u+"")}function Ii(u){return Ga(u,Md,Rc)}function ya(u){return Ga(u,Bc,Kn)}var ei=mr?function(u){return mr.get(u)}:p_;function Zl(u){for(var h=u.name+"",P=ad[h],q=Wt.call(ad,h)?P.length:0;q--;){var ge=P[q],je=ge.func;if(je==null||je==u)return ge.name}return h}function Jc(u){var h=Wt.call(ae,"placeholder")?ae:u;return h.placeholder}function Zn(){var u=ae.iteratee||d_;return u=u===d_?ku:u,arguments.length?u(arguments[0],arguments[1]):u}function bd(u,h){var P=u.__data__;return au(h)?P[typeof h=="string"?"string":"hash"]:P.map}function rc(u){for(var h=Md(u),P=h.length;P--;){var q=h[P],ge=u[q];h[P]=[q,ge,Vf(ge)]}return h}function Hc(u,h){var P=Sv(u,h);return qc(P)?P:t}function Tl(u){var h=Wt.call(u,Co),P=u[Co];try{u[Co]=t;var q=!0}catch{}var ge=Ut.call(u);return q&&(h?u[Co]=P:delete u[Co]),ge}var Rc=Oi?function(u){return u==null?[]:(u=X(u),fo(Oi(u),function(h){return ko.call(u,h)}))}:v_,Kn=Oi?function(u){for(var h=[];u;)Wo(h,Rc(u)),u=Cs(u);return h}:v_,li=fa;(Fa&&li(new Fa(new ArrayBuffer(1)))!=no||ri&&li(new ri)!=pt||ka&&li(ka.resolve())!=dt||va&&li(new va)!=Q||wc&&li(new wc)!=Yt)&&(li=function(u){var h=fa(u),P=h==ze?u.constructor:t,q=P?_f(P):"";if(q)switch(q){case Gd:return no;case Kc:return pt;case vd:return dt;case $l:return Q;case ha:return Yt}return h});function bo(u,h,P){for(var q=-1,ge=P.length;++q<ge;){var je=P[q],mt=je.size;switch(je.type){case"drop":u+=mt;break;case"dropRight":h-=mt;break;case"take":h=_s(h,u+mt);break;case"takeRight":u=ps(u,h-mt);break}}return{start:u,end:h}}function $e(u){var h=u.match(Td);return h?h[1].split(_d):[]}function Vo(u,h,P){h=yp(h,u);for(var q=-1,ge=h.length,je=!1;++q<ge;){var mt=Zp(h[q]);if(!(je=u!=null&&P(u,mt)))break;u=u[mt]}return je||++q!=ge?je:(ge=u==null?0:u.length,!!ge&&un(ge)&&Di(mt,ge)&&(Ts(u)||Gr(u)))}function ro(u){var h=u.length,P=new u.constructor(h);return h&&typeof u[0]=="string"&&Wt.call(u,"index")&&(P.index=u.index,P.input=u.input),P}function hn(u){return typeof u.constructor=="function"&&!Xu(u)?Ns(Cs(u)):{}}function qn(u,h,P){var q=u.constructor;switch(h){case Gt:return Kv(u);case ot:case nt:return new q(+u);case no:return Qf(u,P);case Do:case Eo:case bs:case Is:case qi:case Ks:case ws:case vn:case es:return pv(u,P);case pt:return new q;case ce:case it:return new q(u);case me:return Yp(u);case Q:return new q;case Vt:return Kp(u)}}function Fn(u,h){var P=h.length;if(!P)return u;var q=P-1;return h[q]=(P>1?"& ":"")+h[q],h=h.join(P>2?", ":" "),u.replace(jl,`{
/* [wrapped with `+h+`] */
`)}function Qi(u){return Ts(u)||Gr(u)||!!(Ro&&u&&u[Ro])}function Di(u,h){var P=typeof u;return h=h??se,!!h&&(P=="number"||P!="symbol"&&xe.test(u))&&u>-1&&u%1==0&&u<h}function Oa(u,h,P){if(!ns(P))return!1;var q=typeof h;return(q=="number"?ji(P)&&Di(h,P.length):q=="string"&&h in P)?bi(P[h],u):!1}function Lc(u,h){if(Ts(u))return!1;var P=typeof u;return P=="number"||P=="symbol"||P=="boolean"||u==null||El(u)?!0:Uc.test(u)||!sl.test(u)||h!=null&&u in X(h)}function au(u){var h=typeof u;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?u!=="__proto__":u===null}function yu(u){var h=Zl(u),P=ae[h];if(typeof P!="function"||!(h in Ls.prototype))return!1;if(u===P)return!0;var q=ei(P);return!!q&&u===q[0]}function xp(u){return!!Et&&Et in u}var Wu=zt?Ri:f_;function Xu(u){var h=u&&u.constructor,P=typeof h=="function"&&h.prototype||Ft;return u===P}function Vf(u){return u===u&&!ns(u)}function Zv(u,h){return function(P){return P==null?!1:P[u]===h&&(h!==t||u in X(P))}}function Wf(u){var h=kr(u,function(q){return P.size===d&&P.clear(),q}),P=h.cache;return h}function Om(u,h){var P=u[1],q=h[1],ge=P|q,je=ge<(M|I|$),mt=q==$&&P==T||q==$&&P==F&&u[7].length<=h[8]||q==($|F)&&h[7].length<=h[8]&&P==T;if(!(je||mt))return u;q&M&&(u[2]=h[2],ge|=P&M?0:C);var Dt=h[3];if(Dt){var co=u[3];u[3]=co?Lv(co,Dt,h[4]):Dt,u[4]=co?Pp(u[3],v):h[4]}return Dt=h[5],Dt&&(co=u[5],u[5]=co?gf(co,Dt,h[6]):Dt,u[6]=co?Pp(u[5],v):h[6]),Dt=h[7],Dt&&(u[7]=Dt),q&$&&(u[8]=u[8]==null?h[8]:_s(u[8],h[8])),u[9]==null&&(u[9]=h[9]),u[0]=h[0],u[1]=ge,u}function jh(u){var h=[];if(u!=null)for(var P in X(u))h.push(P);return h}function H0(u){return Ut.call(u)}function G0(u,h,P){return h=ps(h===t?u.length-1:h,0),function(){for(var q=arguments,ge=-1,je=ps(q.length-h,0),mt=qt(je);++ge<je;)mt[ge]=q[h+ge];ge=-1;for(var Dt=qt(h+1);++ge<h;)Dt[ge]=q[ge];return Dt[h]=P(mt),ke(u,this,Dt)}}function Vm(u,h){return h.length<2?u:jn(u,vu(h,0,-1))}function Rh(u,h){for(var P=u.length,q=_s(h.length,P),ge=_u(u);q--;){var je=h[q];u[q]=Di(je,P)?ge[je]:t}return u}function mm(u,h){if(!(h==="constructor"&&typeof u[h]=="function")&&h!="__proto__")return u[h]}var U0=Y0(dv),qf=Rn||function(u,h){return gn.setTimeout(u,h)},Wm=Y0(Iv);function qm(u,h,P){var q=h+"";return Wm(u,Fn(q,Z0($e(q),P)))}function Y0(u){var h=0,P=0;return function(){var q=fn(),ge=ne-(q-P);if(P=q,ge>0){if(++h>=Z)return arguments[0]}else h=0;return u.apply(t,arguments)}}function em(u,h){var P=-1,q=u.length,ge=q-1;for(h=h===t?q:h;++P<h;){var je=lp(P,ge),mt=u[je];u[je]=u[P],u[P]=mt}return u.length=h,u}var K0=Wf(function(u){var h=[];return u.charCodeAt(0)===46&&h.push(""),u.replace(Nl,function(P,q,ge,je){h.push(ge?je.replace(td,"$1"):q||P)}),h});function Zp(u){if(typeof u=="string"||El(u))return u;var h=u+"";return h=="0"&&1/u==-J?"-0":h}function _f(u){if(u!=null){try{return io.call(u)}catch{}try{return u+""}catch{}}return""}function Z0(u,h){return ie(Ke,function(P){var q="_."+P[0];h&P[1]&&!mo(u,q)&&u.push(q)}),u.sort()}function X0(u){if(u instanceof Ls)return u.clone();var h=new ki(u.__wrapped__,u.__chain__);return h.__actions__=_u(u.__actions__),h.__index__=u.__index__,h.__values__=u.__values__,h}function J0(u,h,P){(P?Oa(u,h,P):h===t)?h=1:h=ps(Pr(h),0);var q=u==null?0:u.length;if(!q||h<1)return[];for(var ge=0,je=0,mt=qt(Os(q/h));ge<q;)mt[je++]=vu(u,ge,ge+=h);return mt}function Bh(u){for(var h=-1,P=u==null?0:u.length,q=0,ge=[];++h<P;){var je=u[h];je&&(ge[q++]=je)}return ge}function Q0(){var u=arguments.length;if(!u)return[];for(var h=qt(u-1),P=arguments[0],q=u;q--;)h[q-1]=arguments[q];return Wo(Ts(P)?_u(P):[P],br(h,1))}var Oh=Er(function(u,h){return Ln(u)?Pi(u,br(h,1,Ln,!0)):[]}),eg=Er(function(u,h){var P=Tp(h);return Ln(P)&&(P=t),Ln(u)?Pi(u,br(h,1,Ln,!0),Zn(P,2)):[]}),Vh=Er(function(u,h){var P=Tp(h);return Ln(P)&&(P=t),Ln(u)?Pi(u,br(h,1,Ln,!0),t,P):[]});function tg(u,h,P){var q=u==null?0:u.length;return q?(h=P||h===t?1:Pr(h),vu(u,h<0?0:h,q)):[]}function Wh(u,h,P){var q=u==null?0:u.length;return q?(h=P||h===t?1:Pr(h),h=q-h,vu(u,0,h<0?0:h)):[]}function og(u,h){return u&&u.length?Tv(u,Zn(h,3),!0,!0):[]}function qh(u,h){return u&&u.length?Tv(u,Zn(h,3),!0):[]}function sg(u,h,P,q){var ge=u==null?0:u.length;return ge?(P&&typeof P!="number"&&Oa(u,h,P)&&(P=0,q=ge),zs(u,h,P,q)):[]}function ng(u,h,P){var q=u==null?0:u.length;if(!q)return-1;var ge=P==null?0:Pr(P);return ge<0&&(ge=ps(q+ge,0)),Kr(u,Zn(h,3),ge)}function Hm(u,h,P){var q=u==null?0:u.length;if(!q)return-1;var ge=q-1;return P!==t&&(ge=Pr(P),ge=P<0?ps(q+ge,0):_s(ge,q-1)),Kr(u,Zn(h,3),ge,!0)}function Gm(u){var h=u==null?0:u.length;return h?br(u,1):[]}function ig(u){var h=u==null?0:u.length;return h?br(u,J):[]}function rg(u,h){var P=u==null?0:u.length;return P?(h=h===t?1:Pr(h),br(u,h)):[]}function ag(u){for(var h=-1,P=u==null?0:u.length,q={};++h<P;){var ge=u[h];q[ge[0]]=ge[1]}return q}function lg(u){return u&&u.length?u[0]:t}function cg(u,h,P){var q=u==null?0:u.length;if(!q)return-1;var ge=P==null?0:Pr(P);return ge<0&&(ge=ps(q+ge,0)),Ul(u,h,ge)}function Hh(u){var h=u==null?0:u.length;return h?vu(u,0,-1):[]}var dg=Er(function(u){var h=Fo(u,Yv);return h.length&&h[0]===u[0]?_l(h):[]}),Gh=Er(function(u){var h=Tp(u),P=Fo(u,Yv);return h===Tp(P)?h=t:P.pop(),P.length&&P[0]===u[0]?_l(P,Zn(h,2)):[]}),ug=Er(function(u){var h=Tp(u),P=Fo(u,Yv);return h=typeof h=="function"?h:t,h&&P.pop(),P.length&&P[0]===u[0]?_l(P,t,h):[]});function Uh(u,h){return u==null?"":tn.call(u,h)}function Tp(u){var h=u==null?0:u.length;return h?u[h-1]:t}function Yh(u,h,P){var q=u==null?0:u.length;if(!q)return-1;var ge=q;return P!==t&&(ge=Pr(P),ge=ge<0?ps(q+ge,0):_s(ge,q-1)),h===h?pe(u,h,ge):Kr(u,wl,ge,!0)}function pg(u,h){return u&&u.length?Gp(u,Pr(h)):t}var Kh=Er(Um);function Um(u,h){return u&&u.length&&h&&h.length?yc(u,h):u}function Zh(u,h,P){return u&&u.length&&h&&h.length?yc(u,h,Zn(P,2)):u}function vg(u,h,P){return u&&u.length&&h&&h.length?yc(u,h,t,P):u}var Xh=xn(function(u,h){var P=u==null?0:u.length,q=hl(u,h);return Ep(u,Fo(h,function(ge){return Di(ge,P)?+ge:ge}).sort(Rp)),q});function fg(u,h){var P=[];if(!(u&&u.length))return P;var q=-1,ge=[],je=u.length;for(h=Zn(h,3);++q<je;){var mt=u[q];h(mt,q,u)&&(P.push(mt),ge.push(q))}return Ep(u,ge),P}function Ym(u){return u==null?u:vi.call(u)}function mg(u,h,P){var q=u==null?0:u.length;return q?(P&&typeof P!="number"&&Oa(u,h,P)?(h=0,P=q):(h=h==null?0:Pr(h),P=P===t?q:Pr(P)),vu(u,h,P)):[]}function Jh(u,h){return Np(u,h)}function gg(u,h,P){return jp(u,h,Zn(P,2))}function Qh(u,h){var P=u==null?0:u.length;if(P){var q=Np(u,h);if(q<P&&bi(u[q],h))return q}return-1}function hg(u,h){return Np(u,h,!0)}function e_(u,h,P){return jp(u,h,Zn(P,2),!0)}function _g(u,h){var P=u==null?0:u.length;if(P){var q=Np(u,h,!0)-1;if(bi(u[q],h))return q}return-1}function t_(u){return u&&u.length?uf(u):[]}function yg(u,h){return u&&u.length?uf(u,Zn(h,2)):[]}function o_(u){var h=u==null?0:u.length;return h?vu(u,1,h):[]}function s_(u,h,P){return u&&u.length?(h=P||h===t?1:Pr(h),vu(u,0,h<0?0:h)):[]}function n_(u,h,P){var q=u==null?0:u.length;return q?(h=P||h===t?1:Pr(h),h=q-h,vu(u,h<0?0:h,q)):[]}function b(u,h){return u&&u.length?Tv(u,Zn(h,3),!1,!0):[]}function w(u,h){return u&&u.length?Tv(u,Zn(h,3)):[]}var L=Er(function(u){return cp(br(u,1,Ln,!0))}),A=Er(function(u){var h=Tp(u);return Ln(h)&&(h=t),cp(br(u,1,Ln,!0),Zn(h,2))}),E=Er(function(u){var h=Tp(u);return h=typeof h=="function"?h:t,cp(br(u,1,Ln,!0),t,h)});function R(u){return u&&u.length?cp(u):[]}function G(u,h){return u&&u.length?cp(u,Zn(h,2)):[]}function _e(u,h){return h=typeof h=="function"?h:t,u&&u.length?cp(u,t,h):[]}function Be(u){if(!(u&&u.length))return[];var h=0;return u=fo(u,function(P){if(Ln(P))return h=ps(P.length,h),!0}),gl(h,function(P){return Fo(u,dl(P))})}function _t(u,h){if(!(u&&u.length))return[];var P=Be(u);return h==null?P:Fo(P,function(q){return ke(h,t,q)})}var Yo=Er(function(u,h){return Ln(u)?Pi(u,h):[]}),$o=Er(function(u){return uv(fo(u,Ln))}),so=Er(function(u){var h=Tp(u);return Ln(h)&&(h=t),uv(fo(u,Ln),Zn(h,2))}),cn=Er(function(u){var h=Tp(u);return h=typeof h=="function"?h:t,uv(fo(u,Ln),t,h)}),_i=Er(Be);function ac(u,h){return pf(u||[],h||[],Ca)}function xd(u,h){return pf(u||[],h||[],Up)}var fu=Er(function(u){var h=u.length,P=h>1?u[h-1]:t;return P=typeof P=="function"?(u.pop(),P):t,_t(u,P)});function Qd(u){var h=ae(u);return h.__chain__=!0,h}function bu(u,h){return h(u),u}function Wd(u,h){return h(u)}var Yd=xn(function(u){var h=u.length,P=h?u[0]:0,q=this.__wrapped__,ge=function(je){return hl(je,u)};return h>1||this.__actions__.length||!(q instanceof Ls)||!Di(P)?this.thru(ge):(q=q.slice(P,+P+(h?1:0)),q.__actions__.push({func:Wd,args:[ge],thisArg:t}),new ki(q,this.__chain__).thru(function(je){return h&&!je.length&&je.push(t),je}))});function eu(){return Qd(this)}function qd(){return new ki(this.value(),this.__chain__)}function Ld(){this.__values__===t&&(this.__values__=Fd(this.value()));var u=this.__index__>=this.__values__.length,h=u?t:this.__values__[this.__index__++];return{done:u,value:h}}function Kd(){return this}function Wr(u){for(var h,P=this;P instanceof ra;){var q=X0(P);q.__index__=0,q.__values__=t,h?ge.__wrapped__=q:h=q;var ge=q;P=P.__wrapped__}return ge.__wrapped__=u,h}function Ol(){var u=this.__wrapped__;if(u instanceof Ls){var h=u;return this.__actions__.length&&(h=new Ls(this)),h=h.reverse(),h.__actions__.push({func:Wd,args:[Ym],thisArg:t}),new ki(h,this.__chain__)}return this.thru(Ym)}function Pd(){return Uv(this.__wrapped__,this.__actions__)}var $a=zv(function(u,h,P){Wt.call(u,P)?++u[P]:Ud(u,P,1)});function Al(u,h,P){var q=Ts(u)?Kt:Or;return P&&Oa(u,h,P)&&(h=t),q(u,Zn(h,3))}function cd(u,h){var P=Ts(u)?fo:Zo;return P(u,Zn(h,3))}var Da=Dl(ng),zc=Dl(Hm);function Cc(u,h){return br(Hl(u,h),1)}function er(u,h){return br(Hl(u,h),J)}function Ea(u,h,P){return P=P===t?1:Pr(P),br(Hl(u,h),P)}function gc(u,h){var P=Ts(u)?ie:cs;return P(u,Zn(h,3))}function Nr(u,h){var P=Ts(u)?Ct:ur;return P(u,Zn(h,3))}var rl=zv(function(u,h,P){Wt.call(u,P)?u[P].push(h):Ud(u,P,[h])});function tc(u,h,P,q){u=ji(u)?u:Qv(u),P=P&&!q?Pr(P):0;var ge=u.length;return P<0&&(P=ps(ge+P,0)),Vl(u)?P<=ge&&u.indexOf(h,P)>-1:!!ge&&Ul(u,h,P)>-1}var xr=Er(function(u,h,P){var q=-1,ge=typeof h=="function",je=ji(u)?qt(u.length):[];return cs(u,function(mt){je[++q]=ge?ke(h,mt,P):Sl(mt,h,P)}),je}),al=zv(function(u,h,P){Ud(u,P,h)});function Hl(u,h){var P=Ts(u)?Fo:lv;return P(u,Zn(h,3))}function wr(u,h,P,q){return u==null?[]:(Ts(h)||(h=h==null?[]:[h]),P=q?t:P,Ts(P)||(P=P==null?[]:[P]),cv(u,h,P))}var Ia=zv(function(u,h,P){u[P?0:1].push(h)},function(){return[[],[]]});function Ll(u,h,P){var q=Ts(u)?us:Br,ge=arguments.length<3;return q(u,Zn(h,4),P,ge,cs)}function jr(u,h,P){var q=Ts(u)?Un:Br,ge=arguments.length<3;return q(u,Zn(h,4),P,ge,ur)}function Ui(u,h){var P=Ts(u)?fo:Zo;return P(u,Ei(Zn(h,3)))}function ll(u){var h=Ts(u)?Ku:$u;return h(u)}function Jr(u,h,P){(P?Oa(u,h,P):h===t)?h=1:h=Pr(h);var q=Ts(u)?Bd:Pv;return q(u,h)}function An(u){var h=Ts(u)?Od:qv;return h(u)}function pl(u){if(u==null)return 0;if(ji(u))return Vl(u)?Pe(u):u.length;var h=li(u);return h==pt||h==Q?u.size:Ou(u).length}function Hn(u,h,P){var q=Ts(u)?or:df;return P&&Oa(u,h,P)&&(h=t),q(u,Zn(h,3))}var aa=Er(function(u,h){if(u==null)return[];var P=h.length;return P>1&&Oa(u,h[0],h[1])?h=[]:P>2&&Oa(h[0],h[1],h[2])&&(h=[h[0]]),cv(u,br(h,1),[])}),Na=ls||function(){return gn.Date.now()};function qr(u,h){if(typeof h!="function")throw new Le(a);return u=Pr(u),function(){if(--u<1)return h.apply(this,arguments)}}function On(u,h,P){return h=P?t:h,h=u&&h==null?u.length:h,Ds(u,$,t,t,t,t,h)}function Js(u,h){var P;if(typeof h!="function")throw new Le(a);return u=Pr(u),function(){return--u>0&&(P=h.apply(this,arguments)),u<=1&&(h=t),P}}var pr=Er(function(u,h,P){var q=M;if(P.length){var ge=Pp(P,Jc(pr));q|=j}return Ds(u,q,h,P,ge)}),Ya=Er(function(u,h,P){var q=M|I;if(P.length){var ge=Pp(P,Jc(Ya));q|=j}return Ds(h,q,u,P,ge)});function ti(u,h,P){h=P?t:h;var q=Ds(u,T,t,t,t,t,t,h);return q.placeholder=ti.placeholder,q}function ir(u,h,P){h=P?t:h;var q=Ds(u,z,t,t,t,t,t,h);return q.placeholder=ir.placeholder,q}function Hr(u,h,P){var q,ge,je,mt,Dt,co,ms=0,gs=!1,Fs=!1,wi=!0;if(typeof u!="function")throw new Le(a);h=Ic(h)||0,ns(P)&&(gs=!!P.leading,Fs="maxWait"in P,je=Fs?ps(Ic(P.maxWait)||0,h):je,wi="trailing"in P?!!P.trailing:wi);function da(Cu){var $v=q,wf=ge;return q=ge=t,ms=Cu,mt=u.apply(wf,$v),mt}function bl(Cu){return ms=Cu,Dt=qf($c,h),gs?da(Cu):mt}function _c(Cu){var $v=Cu-co,wf=Cu-ms,V1=h-$v;return Fs?_s(V1,je-wf):V1}function xl(Cu){var $v=Cu-co,wf=Cu-ms;return co===t||$v>=h||$v<0||Fs&&wf>=je}function $c(){var Cu=Na();if(xl(Cu))return Gc(Cu);Dt=qf($c,_c(Cu))}function Gc(Cu){return Dt=t,wi&&q?da(Cu):(q=ge=t,mt)}function ev(){Dt!==t&&ff(Dt),ms=0,q=co=ge=Dt=t}function Lp(){return Dt===t?mt:Gc(Na())}function tv(){var Cu=Na(),$v=xl(Cu);if(q=arguments,ge=this,co=Cu,$v){if(Dt===t)return bl(co);if(Fs)return ff(Dt),Dt=qf($c,h),da(co)}return Dt===t&&(Dt=qf($c,h)),mt}return tv.cancel=ev,tv.flush=Lp,tv}var Ka=Er(function(u,h){return on(u,1,h)}),yi=Er(function(u,h,P){return on(u,Ic(h)||0,P)});function Yi(u){return Ds(u,V)}function kr(u,h){if(typeof u!="function"||h!=null&&typeof h!="function")throw new Le(a);var P=function(){var q=arguments,ge=h?h.apply(this,q):q[0],je=P.cache;if(je.has(ge))return je.get(ge);var mt=u.apply(this,q);return P.cache=je.set(ge,mt)||je,mt};return P.cache=new(kr.Cache||lc),P}kr.Cache=lc;function Ei(u){if(typeof u!="function")throw new Le(a);return function(){var h=arguments;switch(h.length){case 0:return!u.call(this);case 1:return!u.call(this,h[0]);case 2:return!u.call(this,h[0],h[1]);case 3:return!u.call(this,h[0],h[1],h[2])}return!u.apply(this,h)}}function Rr(u){return Js(2,u)}var Qr=Bf(function(u,h){h=h.length==1&&Ts(h[0])?Fo(h[0],ia(Zn())):Fo(br(h,1),ia(Zn()));var P=h.length;return Er(function(q){for(var ge=-1,je=_s(q.length,P);++ge<je;)q[ge]=h[ge].call(this,q[ge]);return ke(u,this,q)})}),dn=Er(function(u,h){var P=Pp(h,Jc(dn));return Ds(u,j,t,h,P)}),oi=Er(function(u,h){var P=Pp(h,Jc(oi));return Ds(u,B,t,h,P)}),Mi=xn(function(u,h){return Ds(u,F,t,t,t,h)});function Ni(u,h){if(typeof u!="function")throw new Le(a);return h=h===t?h:Pr(h),Er(u,h)}function Ki(u,h){if(typeof u!="function")throw new Le(a);return h=h==null?0:ps(Pr(h),0),Er(function(P){var q=P[h],ge=Mp(P,0,h);return q&&Wo(ge,q),ke(u,this,ge)})}function Mr(u,h,P){var q=!0,ge=!0;if(typeof u!="function")throw new Le(a);return ns(P)&&(q="leading"in P?!!P.leading:q,ge="trailing"in P?!!P.trailing:ge),Hr(u,h,{leading:q,maxWait:h,trailing:ge})}function si(u){return On(u,1)}function Ti(u,h){return dn(vf(h),u)}function ba(){if(!arguments.length)return[];var u=arguments[0];return Ts(u)?u:[u]}function rr(u){return md(u,y)}function ar(u,h){return h=typeof h=="function"?h:t,md(u,y,h)}function $n(u){return md(u,g|y)}function Us(u,h){return h=typeof h=="function"?h:t,md(u,g|y,h)}function Zi(u,h){return h==null||Nn(u,h,Md(h))}function bi(u,h){return u===h||u!==u&&h!==h}var ni=Qo(Ba),Dn=Qo(function(u,h){return u>=h}),Gr=Pa(function(){return arguments}())?Pa:function(u){return mn(u)&&Wt.call(u,"callee")&&!ko.call(u,"callee")},Ts=qt.isArray,la=Me?ia(Me):Sc;function ji(u){return u!=null&&un(u.length)&&!Ri(u)}function Ln(u){return mn(u)&&ji(u)}function Ma(u){return u===!0||u===!1||mn(u)&&fa(u)==ot}var Ys=pi||f_,wn=Ue?ia(Ue):ai;function vr(u){return mn(u)&&u.nodeType===1&&!vl(u)}function Tr(u){if(u==null)return!0;if(ji(u)&&(Ts(u)||typeof u=="string"||typeof u.splice=="function"||Ys(u)||ca(u)||Gr(u)))return!u.length;var h=li(u);if(h==pt||h==Q)return!u.size;if(Xu(u))return!Ou(u).length;for(var P in u)if(Wt.call(u,P))return!1;return!0}function xi(u,h){return Ir(u,h)}function Sr(u,h,P){P=typeof P=="function"?P:t;var q=P?P(u,h):t;return q===t?Ir(u,h,t,P):!!q}function Ta(u){if(!mn(u))return!1;var h=fa(u);return h==Ze||h==tt||typeof u.message=="string"&&typeof u.name=="string"&&!vl(u)}function Ai(u){return typeof u=="number"&&an(u)}function Ri(u){if(!ns(u))return!1;var h=fa(u);return h==ct||h==Ge||h==Je||h==qe}function gr(u){return typeof u=="number"&&u==Pr(u)}function un(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=se}function ns(u){var h=typeof u;return u!=null&&(h=="object"||h=="function")}function mn(u){return u!=null&&typeof u=="object"}var Ar=yt?ia(yt):il;function sn(u,h){return u===h||Dr(u,h,rc(h))}function Cr(u,h,P){return P=typeof P=="function"?P:t,Dr(u,h,rc(h),P)}function Xn(u){return Za(u)&&u!=+u}function ea(u){if(Wu(u))throw new ks(r);return qc(u)}function zl(u){return u===null}function Va(u){return u==null}function Za(u){return typeof u=="number"||mn(u)&&fa(u)==ce}function vl(u){if(!mn(u)||fa(u)!=ze)return!1;var h=Cs(u);if(h===null)return!0;var P=Wt.call(h,"constructor")&&h.constructor;return typeof P=="function"&&P instanceof P&&io.call(P)==wo}var oc=St?ia(St):ld;function Gl(u){return gr(u)&&u>=-se&&u<=se}var Xl=lo?ia(lo):pu;function Vl(u){return typeof u=="string"||!Ts(u)&&mn(u)&&fa(u)==it}function El(u){return typeof u=="symbol"||mn(u)&&fa(u)==Vt}var ca=he?ia(he):Vd;function hc(u){return u===t}function dd(u){return mn(u)&&li(u)==Yt}function Id(u){return mn(u)&&fa(u)==At}var sc=Qo(Xc),zd=Qo(function(u,h){return u<=h});function Fd(u){if(!u)return[];if(ji(u))return Vl(u)?Ht(u):_u(u);if(To&&u[To])return Ws(u[To]());var h=li(u),P=h==pt?Cv:h==Q?Ip:Qv;return P(u)}function Pc(u){if(!u)return u===0?u:0;if(u=Ic(u),u===J||u===-J){var h=u<0?-1:1;return h*W}return u===u?u:0}function Pr(u){var h=Pc(u),P=h%1;return h===h?P?h-P:h:0}function Zd(u){return u?hu(Pr(u),0,ye):0}function Ic(u){if(typeof u=="number")return u;if(El(u))return le;if(ns(u)){var h=typeof u.valueOf=="function"?u.valueOf():u;u=ns(h)?h+"":h}if(typeof u!="string")return u===0?u:+u;u=Ql(u);var P=de.test(u);return P||Ee.test(u)?za(u.slice(2),P?2:8):We.test(u)?le:+u}function tu(u){return Vu(u,Bc(u))}function $d(u){return u?hu(Pr(u),-se,se):u===0?u:0}function el(u){return u==null?"":Su(u)}var ou=bp(function(u,h){if(Xu(h)||ji(h)){Vu(h,Md(h),u);return}for(var P in h)Wt.call(h,P)&&Ca(u,P,h[P])}),wd=bp(function(u,h){Vu(h,Bc(h),u)}),gd=bp(function(u,h,P,q){Vu(h,Bc(h),u,q)}),Fc=bp(function(u,h,P,q){Vu(h,Md(h),u,q)}),ud=xn(hl);function su(u,h){var P=Ns(u);return h==null?P:ru(P,h)}var Lr=Er(function(u,h){u=X(u);var P=-1,q=h.length,ge=q>2?h[2]:t;for(ge&&Oa(h[0],h[1],ge)&&(q=1);++P<q;)for(var je=h[P],mt=Bc(je),Dt=-1,co=mt.length;++Dt<co;){var ms=mt[Dt],gs=u[ms];(gs===t||bi(gs,Ft[ms])&&!Wt.call(u,ms))&&(u[ms]=je[ms])}return u}),dc=Er(function(u){return u.push(t,Bn),ke(uc,t,u)});function Du(u,h){return _r(u,Zn(h,3),Xr)}function Eu(u,h){return _r(u,Zn(h,3),Ji)}function Ju(u,h){return u==null?u:cc(u,Zn(h,3),Bc)}function mu(u,h){return u==null?u:Xs(u,Zn(h,3),Bc)}function dp(u,h){return u&&Xr(u,Zn(h,3))}function yl(u,h){return u&&Ji(u,Zn(h,3))}function Dd(u){return u==null?[]:Gi(u,Md(u))}function Xv(u){return u==null?[]:Gi(u,Bc(u))}function up(u,h,P){var q=u==null?t:jn(u,h);return q===t?P:q}function Xp(u,h){return u!=null&&Vo(u,h,bn)}function fv(u,h){return u!=null&&Vo(u,h,yd)}var Jp=He(function(u,h,P){h!=null&&typeof h.toString!="function"&&(h=Ut.call(h)),u[h]=P},sm(Bp)),Qp=He(function(u,h,P){h!=null&&typeof h.toString!="function"&&(h=Ut.call(h)),Wt.call(u,h)?u[h].push(P):u[h]=[P]},Zn),Jv=Er(Sl);function Md(u){return ji(u)?ec(u):Ou(u)}function Bc(u){return ji(u)?ec(u,!0):zu(u)}function Ap(u,h){var P={};return h=Zn(h,3),Xr(u,function(q,ge,je){Ud(P,h(q,ge,je),q)}),P}function yf(u,h){var P={};return h=Zn(h,3),Xr(u,function(q,ge,je){Ud(P,ge,h(q,ge,je))}),P}var Oc=bp(function(u,h,P){Fu(u,h,P)}),uc=bp(function(u,h,P,q){Fu(u,h,P,q)}),tm=xn(function(u,h){var P={};if(u==null)return P;var q=!1;h=Fo(h,function(je){return je=yp(je,u),q||(q=je.length>1),je}),Vu(u,ya(u),P),q&&(P=md(P,g|_|y,Qn));for(var ge=h.length;ge--;)Hv(P,h[ge]);return P});function Hf(u,h){return bf(u,Ei(Zn(h)))}var mv=xn(function(u,h){return u==null?{}:Vv(u,h)});function bf(u,h){if(u==null)return{};var P=Fo(ya(u),function(q){return[q]});return h=Zn(h),_p(u,P,function(q,ge){return h(q,ge[0])})}function xf(u,h,P){h=yp(h,u);var q=-1,ge=h.length;for(ge||(ge=1,u=t);++q<ge;){var je=u==null?t:u[Zp(h[q])];je===t&&(q=ge,je=P),u=Ri(je)?je.call(u):je}return u}function gu(u,h,P){return u==null?u:Up(u,h,P)}function bg(u,h,P,q){return q=typeof q=="function"?q:t,u==null?u:Up(u,h,P,q)}var gm=Po(Md),hm=Po(Bc);function Km(u,h,P){var q=Ts(u),ge=q||Ys(u)||ca(u);if(h=Zn(h,4),P==null){var je=u&&u.constructor;ge?P=q?new je:[]:ns(u)?P=Ri(je)?Ns(Cs(u)):{}:P={}}return(ge?ie:Xr)(u,function(mt,Dt,co){return h(P,mt,Dt,co)}),P}function xg(u,h){return u==null?!0:Hv(u,h)}function Zm(u,h,P){return u==null?u:Gv(u,h,vf(P))}function Xm(u,h,P,q){return q=typeof q=="function"?q:t,u==null?u:Gv(u,h,vf(P),q)}function Qv(u){return u==null?[]:jd(u,Md(u))}function wg(u){return u==null?[]:jd(u,Bc(u))}function kg(u,h,P){return P===t&&(P=h,h=t),P!==t&&(P=Ic(P),P=P===P?P:0),h!==t&&(h=Ic(h),h=h===h?h:0),hu(Ic(u),h,P)}function Jm(u,h,P){return h=Pc(h),P===t?(P=h,h=0):P=Pc(P),u=Ic(u),qo(u,h,P)}function i_(u,h,P){if(P&&typeof P!="boolean"&&Oa(u,h,P)&&(h=P=t),P===t&&(typeof h=="boolean"?(P=h,h=t):typeof u=="boolean"&&(P=u,u=t)),u===t&&h===t?(u=0,h=1):(u=Pc(u),h===t?(h=u,u=0):h=Pc(h)),u>h){var q=u;u=h,h=q}if(P||u%1||h%1){var ge=dr();return _s(u+ge*(h-u+En("1e-"+((ge+"").length-1))),h)}return lp(u,h)}var Sg=Vr(function(u,h,P){return h=h.toLowerCase(),u+(P?_m(h):h)});function _m(u){return om(el(u).toLowerCase())}function Qm(u){return u=el(u),u&&u.replace(gt,Yu).replace(Xe,"")}function r_(u,h,P){u=el(u),h=Su(h);var q=u.length;P=P===t?q:hu(Pr(P),0,q);var ge=P;return P-=h.length,P>=0&&u.slice(P,ge)==h}function e0(u){return u=el(u),u&&rd.test(u)?u.replace(Xi,Lu):u}function t0(u){return u=el(u),u&&Ec.test(u)?u.replace(Yc,"\\$&"):u}var Cg=Vr(function(u,h,P){return u+(P?"-":"")+h.toLowerCase()}),o0=Vr(function(u,h,P){return u+(P?" ":"")+h.toLowerCase()}),Pg=_a("toLowerCase");function Ig(u,h,P){u=el(u),h=Pr(h);var q=h?Pe(u):0;if(!h||q>=h)return u;var ge=(h-q)/2;return Pt(Pn(ge),P)+u+Pt(Os(ge),P)}function s0(u,h,P){u=el(u),h=Pr(h);var q=h?Pe(u):0;return h&&q<h?u+Pt(h-q,P):u}function a_(u,h,P){u=el(u),h=Pr(h);var q=h?Pe(u):0;return h&&q<h?Pt(h-q,P)+u:u}function n0(u,h,P){return P||h==null?h=0:h&&(h=+h),Ci(el(u).replace(Ja,""),h||0)}function Mg(u,h,P){return(P?Oa(u,h,P):h===t)?h=1:h=Pr(h),cf(el(u),h)}function Tg(){var u=arguments,h=el(u[0]);return u.length<3?h:h.replace(u[1],u[2])}var i0=Vr(function(u,h,P){return u+(P?"_":"")+h.toLowerCase()});function l_(u,h,P){return P&&typeof P!="number"&&Oa(u,h,P)&&(h=P=t),P=P===t?ye:P>>>0,P?(u=el(u),u&&(typeof h=="string"||h!=null&&!oc(h))&&(h=Su(h),!h&&rp(u))?Mp(Ht(u),0,P):u.split(h,P)):[]}var Ag=Vr(function(u,h,P){return u+(P?" ":"")+om(h)});function Lg(u,h,P){return u=el(u),P=P==null?0:hu(Pr(P),0,u.length),h=Su(h),u.slice(P,P+h.length)==h}function zg(u,h,P){var q=ae.templateSettings;P&&Oa(u,h,P)&&(h=t),u=el(u),h=gd({},h,q,Wi);var ge=gd({},h.imports,q.imports,Wi),je=Md(ge),mt=jd(ge,je),Dt,co,ms=0,gs=h.interpolate||at,Fs="__p += '",wi=fe((h.escape||at).source+"|"+gs.source+"|"+(gs===Wl?Nc:at).source+"|"+(h.evaluate||at).source+"|$","g"),da="//# sourceURL="+(Wt.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ho+"]")+`
`;u.replace(wi,function(xl,$c,Gc,ev,Lp,tv){return Gc||(Gc=ev),Fs+=u.slice(ms,tv).replace(jt,Cp),$c&&(Dt=!0,Fs+=`' +
__e(`+$c+`) +
'`),Lp&&(co=!0,Fs+=`';
`+Lp+`;
__p += '`),Gc&&(Fs+=`' +
((__t = (`+Gc+`)) == null ? '' : __t) +
'`),ms=tv+xl.length,xl}),Fs+=`';
`;var bl=Wt.call(h,"variable")&&h.variable;if(!bl)Fs=`with (obj) {
`+Fs+`
}
`;else if(qa.test(bl))throw new ks(l);Fs=(co?Fs.replace(Li,""):Fs).replace(ci,"$1").replace(oa,"$1;"),Fs="function("+(bl||"obj")+`) {
`+(bl?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Dt?", __e = _.escape":"")+(co?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Fs+`return __p
}`;var _c=d0(function(){return yr(je,da+"return "+Fs).apply(t,mt)});if(_c.source=Fs,Ta(_c))throw _c;return _c}function r0(u){return el(u).toLowerCase()}function c_(u){return el(u).toUpperCase()}function Fg(u,h,P){if(u=el(u),u&&(P||h===t))return Ql(u);if(!u||!(h=Su(h)))return u;var q=Ht(u),ge=Ht(h),je=ip(q,ge),mt=$p(q,ge)+1;return Mp(q,je,mt).join("")}function $g(u,h,P){if(u=el(u),u&&(P||h===t))return u.slice(0,vo(u)+1);if(!u||!(h=Su(h)))return u;var q=Ht(u),ge=$p(q,Ht(h))+1;return Mp(q,0,ge).join("")}function a0(u,h,P){if(u=el(u),u&&(P||h===t))return u.replace(Ja,"");if(!u||!(h=Su(h)))return u;var q=Ht(u),ge=ip(q,Ht(h));return Mp(q,ge).join("")}function ym(u,h){var P=K,q=Y;if(ns(h)){var ge="separator"in h?h.separator:ge;P="length"in h?Pr(h.length):P,q="omission"in h?Su(h.omission):q}u=el(u);var je=u.length;if(rp(u)){var mt=Ht(u);je=mt.length}if(P>=je)return u;var Dt=P-Pe(q);if(Dt<1)return q;var co=mt?Mp(mt,0,Dt).join(""):u.slice(0,Dt);if(ge===t)return co+q;if(mt&&(Dt+=co.length-Dt),oc(ge)){if(u.slice(Dt).search(ge)){var ms,gs=co;for(ge.global||(ge=fe(ge.source,el(be.exec(ge))+"g")),ge.lastIndex=0;ms=ge.exec(gs);)var Fs=ms.index;co=co.slice(0,Fs===t?Dt:Fs)}}else if(u.indexOf(Su(ge),Dt)!=Dt){var wi=co.lastIndexOf(ge);wi>-1&&(co=co.slice(0,wi))}return co+q}function l0(u){return u=el(u),u&&fc.test(u)?u.replace(ol,as):u}var c0=Vr(function(u,h,P){return u+(P?" ":"")+h.toUpperCase()}),om=_a("toUpperCase");function bm(u,h,P){return u=el(u),h=P?t:h,h===t?jf(u)?xs(u):kn(u):u.match(h)||[]}var d0=Er(function(u,h){try{return ke(u,t,h)}catch(P){return Ta(P)?P:new ks(P)}}),Dg=xn(function(u,h){return ie(h,function(P){P=Zp(P),Ud(u,P,pr(u[P],u))}),u});function xm(u){var h=u==null?0:u.length,P=Zn();return u=h?Fo(u,function(q){if(typeof q[1]!="function")throw new Le(a);return[P(q[0]),q[1]]}):[],Er(function(q){for(var ge=-1;++ge<h;){var je=u[ge];if(ke(je[0],this,q))return ke(je[1],this,q)}})}function u0(u){return ap(md(u,g))}function sm(u){return function(){return u}}function Eg(u,h){return u==null||u!==u?h:u}var Fv=Ua(),lw=Ua(!0);function Bp(u){return u}function d_(u){return ku(typeof u=="function"?u:md(u,g))}function cw(u){return qp(md(u,g))}function dw(u,h){return Zu(u,md(h,g))}var uw=Er(function(u,h){return function(P){return Sl(P,u,h)}}),pw=Er(function(u,h){return function(P){return Sl(u,P,h)}});function u_(u,h,P){var q=Md(h),ge=Gi(h,q);P==null&&!(ns(h)&&(ge.length||!q.length))&&(P=h,h=u,u=this,ge=Gi(h,Md(h)));var je=!(ns(P)&&"chain"in P)||!!P.chain,mt=Ri(u);return ie(ge,function(Dt){var co=h[Dt];u[Dt]=co,mt&&(u.prototype[Dt]=function(){var ms=this.__chain__;if(je||ms){var gs=u(this.__wrapped__),Fs=gs.__actions__=_u(this.__actions__);return Fs.push({func:co,args:arguments,thisArg:u}),gs.__chain__=ms,gs}return co.apply(u,Wo([this.value()],arguments))})}),u}function vw(){return gn._===this&&(gn._=xt),this}function p_(){}function fw(u){return u=Pr(u),Er(function(h){return Gp(h,u)})}var mw=Tt(Fo),gw=Tt(Kt),hw=Tt(or);function O1(u){return Lc(u)?dl(Zp(u)):Dp(u)}function _w(u){return function(h){return u==null?t:jn(u,h)}}var yw=yo(),bw=yo(!0);function v_(){return[]}function f_(){return!1}function xw(){return{}}function ww(){return""}function kw(){return!0}function Sw(u,h){if(u=Pr(u),u<1||u>se)return[];var P=ye,q=_s(u,ye);h=Zn(h),u-=ye;for(var ge=gl(q,h);++P<u;)h(P);return ge}function Cw(u){return Ts(u)?Fo(u,Zp):El(u)?[u]:_u(K0(el(u)))}function Pw(u){var h=++zo;return el(u)+h}var Iw=Ye(function(u,h){return u+h},0),Mw=fi("ceil"),Tw=Ye(function(u,h){return u/h},1),Aw=fi("floor");function Lw(u){return u&&u.length?Jo(u,Bp,Ba):t}function zw(u,h){return u&&u.length?Jo(u,Zn(h,2),Ba):t}function Fw(u){return Cl(u,Bp)}function $w(u,h){return Cl(u,Zn(h,2))}function Dw(u){return u&&u.length?Jo(u,Bp,Xc):t}function Ew(u,h){return u&&u.length?Jo(u,Zn(h,2),Xc):t}var Nw=Ye(function(u,h){return u*h},1),jw=fi("round"),Rw=Ye(function(u,h){return u-h},0);function Bw(u){return u&&u.length?fr(u,Bp):0}function Ow(u,h){return u&&u.length?fr(u,Zn(h,2)):0}return ae.after=qr,ae.ary=On,ae.assign=ou,ae.assignIn=wd,ae.assignInWith=gd,ae.assignWith=Fc,ae.at=ud,ae.before=Js,ae.bind=pr,ae.bindAll=Dg,ae.bindKey=Ya,ae.castArray=ba,ae.chain=Qd,ae.chunk=J0,ae.compact=Bh,ae.concat=Q0,ae.cond=xm,ae.conforms=u0,ae.constant=sm,ae.countBy=$a,ae.create=su,ae.curry=ti,ae.curryRight=ir,ae.debounce=Hr,ae.defaults=Lr,ae.defaultsDeep=dc,ae.defer=Ka,ae.delay=yi,ae.difference=Oh,ae.differenceBy=eg,ae.differenceWith=Vh,ae.drop=tg,ae.dropRight=Wh,ae.dropRightWhile=og,ae.dropWhile=qh,ae.fill=sg,ae.filter=cd,ae.flatMap=Cc,ae.flatMapDeep=er,ae.flatMapDepth=Ea,ae.flatten=Gm,ae.flattenDeep=ig,ae.flattenDepth=rg,ae.flip=Yi,ae.flow=Fv,ae.flowRight=lw,ae.fromPairs=ag,ae.functions=Dd,ae.functionsIn=Xv,ae.groupBy=rl,ae.initial=Hh,ae.intersection=dg,ae.intersectionBy=Gh,ae.intersectionWith=ug,ae.invert=Jp,ae.invertBy=Qp,ae.invokeMap=xr,ae.iteratee=d_,ae.keyBy=al,ae.keys=Md,ae.keysIn=Bc,ae.map=Hl,ae.mapKeys=Ap,ae.mapValues=yf,ae.matches=cw,ae.matchesProperty=dw,ae.memoize=kr,ae.merge=Oc,ae.mergeWith=uc,ae.method=uw,ae.methodOf=pw,ae.mixin=u_,ae.negate=Ei,ae.nthArg=fw,ae.omit=tm,ae.omitBy=Hf,ae.once=Rr,ae.orderBy=wr,ae.over=mw,ae.overArgs=Qr,ae.overEvery=gw,ae.overSome=hw,ae.partial=dn,ae.partialRight=oi,ae.partition=Ia,ae.pick=mv,ae.pickBy=bf,ae.property=O1,ae.propertyOf=_w,ae.pull=Kh,ae.pullAll=Um,ae.pullAllBy=Zh,ae.pullAllWith=vg,ae.pullAt=Xh,ae.range=yw,ae.rangeRight=bw,ae.rearg=Mi,ae.reject=Ui,ae.remove=fg,ae.rest=Ni,ae.reverse=Ym,ae.sampleSize=Jr,ae.set=gu,ae.setWith=bg,ae.shuffle=An,ae.slice=mg,ae.sortBy=aa,ae.sortedUniq=t_,ae.sortedUniqBy=yg,ae.split=l_,ae.spread=Ki,ae.tail=o_,ae.take=s_,ae.takeRight=n_,ae.takeRightWhile=b,ae.takeWhile=w,ae.tap=bu,ae.throttle=Mr,ae.thru=Wd,ae.toArray=Fd,ae.toPairs=gm,ae.toPairsIn=hm,ae.toPath=Cw,ae.toPlainObject=tu,ae.transform=Km,ae.unary=si,ae.union=L,ae.unionBy=A,ae.unionWith=E,ae.uniq=R,ae.uniqBy=G,ae.uniqWith=_e,ae.unset=xg,ae.unzip=Be,ae.unzipWith=_t,ae.update=Zm,ae.updateWith=Xm,ae.values=Qv,ae.valuesIn=wg,ae.without=Yo,ae.words=bm,ae.wrap=Ti,ae.xor=$o,ae.xorBy=so,ae.xorWith=cn,ae.zip=_i,ae.zipObject=ac,ae.zipObjectDeep=xd,ae.zipWith=fu,ae.entries=gm,ae.entriesIn=hm,ae.extend=wd,ae.extendWith=gd,u_(ae,ae),ae.add=Iw,ae.attempt=d0,ae.camelCase=Sg,ae.capitalize=_m,ae.ceil=Mw,ae.clamp=kg,ae.clone=rr,ae.cloneDeep=$n,ae.cloneDeepWith=Us,ae.cloneWith=ar,ae.conformsTo=Zi,ae.deburr=Qm,ae.defaultTo=Eg,ae.divide=Tw,ae.endsWith=r_,ae.eq=bi,ae.escape=e0,ae.escapeRegExp=t0,ae.every=Al,ae.find=Da,ae.findIndex=ng,ae.findKey=Du,ae.findLast=zc,ae.findLastIndex=Hm,ae.findLastKey=Eu,ae.floor=Aw,ae.forEach=gc,ae.forEachRight=Nr,ae.forIn=Ju,ae.forInRight=mu,ae.forOwn=dp,ae.forOwnRight=yl,ae.get=up,ae.gt=ni,ae.gte=Dn,ae.has=Xp,ae.hasIn=fv,ae.head=lg,ae.identity=Bp,ae.includes=tc,ae.indexOf=cg,ae.inRange=Jm,ae.invoke=Jv,ae.isArguments=Gr,ae.isArray=Ts,ae.isArrayBuffer=la,ae.isArrayLike=ji,ae.isArrayLikeObject=Ln,ae.isBoolean=Ma,ae.isBuffer=Ys,ae.isDate=wn,ae.isElement=vr,ae.isEmpty=Tr,ae.isEqual=xi,ae.isEqualWith=Sr,ae.isError=Ta,ae.isFinite=Ai,ae.isFunction=Ri,ae.isInteger=gr,ae.isLength=un,ae.isMap=Ar,ae.isMatch=sn,ae.isMatchWith=Cr,ae.isNaN=Xn,ae.isNative=ea,ae.isNil=Va,ae.isNull=zl,ae.isNumber=Za,ae.isObject=ns,ae.isObjectLike=mn,ae.isPlainObject=vl,ae.isRegExp=oc,ae.isSafeInteger=Gl,ae.isSet=Xl,ae.isString=Vl,ae.isSymbol=El,ae.isTypedArray=ca,ae.isUndefined=hc,ae.isWeakMap=dd,ae.isWeakSet=Id,ae.join=Uh,ae.kebabCase=Cg,ae.last=Tp,ae.lastIndexOf=Yh,ae.lowerCase=o0,ae.lowerFirst=Pg,ae.lt=sc,ae.lte=zd,ae.max=Lw,ae.maxBy=zw,ae.mean=Fw,ae.meanBy=$w,ae.min=Dw,ae.minBy=Ew,ae.stubArray=v_,ae.stubFalse=f_,ae.stubObject=xw,ae.stubString=ww,ae.stubTrue=kw,ae.multiply=Nw,ae.nth=pg,ae.noConflict=vw,ae.noop=p_,ae.now=Na,ae.pad=Ig,ae.padEnd=s0,ae.padStart=a_,ae.parseInt=n0,ae.random=i_,ae.reduce=Ll,ae.reduceRight=jr,ae.repeat=Mg,ae.replace=Tg,ae.result=xf,ae.round=jw,ae.runInContext=lt,ae.sample=ll,ae.size=pl,ae.snakeCase=i0,ae.some=Hn,ae.sortedIndex=Jh,ae.sortedIndexBy=gg,ae.sortedIndexOf=Qh,ae.sortedLastIndex=hg,ae.sortedLastIndexBy=e_,ae.sortedLastIndexOf=_g,ae.startCase=Ag,ae.startsWith=Lg,ae.subtract=Rw,ae.sum=Bw,ae.sumBy=Ow,ae.template=zg,ae.times=Sw,ae.toFinite=Pc,ae.toInteger=Pr,ae.toLength=Zd,ae.toLower=r0,ae.toNumber=Ic,ae.toSafeInteger=$d,ae.toString=el,ae.toUpper=c_,ae.trim=Fg,ae.trimEnd=$g,ae.trimStart=a0,ae.truncate=ym,ae.unescape=l0,ae.uniqueId=Pw,ae.upperCase=c0,ae.upperFirst=om,ae.each=gc,ae.eachRight=Nr,ae.first=lg,u_(ae,function(){var u={};return Xr(ae,function(h,P){Wt.call(ae.prototype,P)||(u[P]=h)}),u}(),{chain:!1}),ae.VERSION=s,ie(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){ae[u].placeholder=ae}),ie(["drop","take"],function(u,h){Ls.prototype[u]=function(P){P=P===t?1:ps(Pr(P),0);var q=this.__filtered__&&!h?new Ls(this):this.clone();return q.__filtered__?q.__takeCount__=_s(P,q.__takeCount__):q.__views__.push({size:_s(P,ye),type:u+(q.__dir__<0?"Right":"")}),q},Ls.prototype[u+"Right"]=function(P){return this.reverse()[u](P).reverse()}}),ie(["filter","map","takeWhile"],function(u,h){var P=h+1,q=P==te||P==U;Ls.prototype[u]=function(ge){var je=this.clone();return je.__iteratees__.push({iteratee:Zn(ge,3),type:P}),je.__filtered__=je.__filtered__||q,je}}),ie(["head","last"],function(u,h){var P="take"+(h?"Right":"");Ls.prototype[u]=function(){return this[P](1).value()[0]}}),ie(["initial","tail"],function(u,h){var P="drop"+(h?"":"Right");Ls.prototype[u]=function(){return this.__filtered__?new Ls(this):this[P](1)}}),Ls.prototype.compact=function(){return this.filter(Bp)},Ls.prototype.find=function(u){return this.filter(u).head()},Ls.prototype.findLast=function(u){return this.reverse().find(u)},Ls.prototype.invokeMap=Er(function(u,h){return typeof u=="function"?new Ls(this):this.map(function(P){return Sl(P,u,h)})}),Ls.prototype.reject=function(u){return this.filter(Ei(Zn(u)))},Ls.prototype.slice=function(u,h){u=Pr(u);var P=this;return P.__filtered__&&(u>0||h<0)?new Ls(P):(u<0?P=P.takeRight(-u):u&&(P=P.drop(u)),h!==t&&(h=Pr(h),P=h<0?P.dropRight(-h):P.take(h-u)),P)},Ls.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Ls.prototype.toArray=function(){return this.take(ye)},Xr(Ls.prototype,function(u,h){var P=/^(?:filter|find|map|reject)|While$/.test(h),q=/^(?:head|last)$/.test(h),ge=ae[q?"take"+(h=="last"?"Right":""):h],je=q||/^find/.test(h);ge&&(ae.prototype[h]=function(){var mt=this.__wrapped__,Dt=q?[1]:arguments,co=mt instanceof Ls,ms=Dt[0],gs=co||Ts(mt),Fs=function($c){var Gc=ge.apply(ae,Wo([$c],Dt));return q&&wi?Gc[0]:Gc};gs&&P&&typeof ms=="function"&&ms.length!=1&&(co=gs=!1);var wi=this.__chain__,da=!!this.__actions__.length,bl=je&&!wi,_c=co&&!da;if(!je&&gs){mt=_c?mt:new Ls(this);var xl=u.apply(mt,Dt);return xl.__actions__.push({func:Wd,args:[Fs],thisArg:t}),new ki(xl,wi)}return bl&&_c?u.apply(this,Dt):(xl=this.thru(Fs),bl?q?xl.value()[0]:xl.value():xl)})}),ie(["pop","push","shift","sort","splice","unshift"],function(u){var h=ft[u],P=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",q=/^(?:pop|shift)$/.test(u);ae.prototype[u]=function(){var ge=arguments;if(q&&!this.__chain__){var je=this.value();return h.apply(Ts(je)?je:[],ge)}return this[P](function(mt){return h.apply(Ts(mt)?mt:[],ge)})}}),Xr(Ls.prototype,function(u,h){var P=ae[h];if(P){var q=P.name+"";Wt.call(ad,q)||(ad[q]=[]),ad[q].push({name:h,func:P})}}),ad[rt(t,I).name]=[{name:"wrapper",func:t}],Ls.prototype.clone=Rl,Ls.prototype.reverse=mc,Ls.prototype.value=Jd,ae.prototype.at=Yd,ae.prototype.chain=eu,ae.prototype.commit=qd,ae.prototype.next=Ld,ae.prototype.plant=Wr,ae.prototype.reverse=Ol,ae.prototype.toJSON=ae.prototype.valueOf=ae.prototype.value=Pd,ae.prototype.first=ae.prototype.head,To&&(ae.prototype[To]=Kd),ae},Sn=en();Tn?((Tn.exports=Sn)._=Sn,Wn._=Sn):gn._=Sn}).call(Tf)})(yh,yh.exports);var RM=yh.exports;const uo=O0(RM);function BM(o,e,t){const s=o.target;e(parseInt(s.value)),t("opacityChange",e())}function OM(o,e){o.stopPropagation(),x(e,!0)}function VM(o,e,t,s,i,r,a,l){if(/^#[0-9A-F]{6}$/i.test(n(e))){const c=t(n(e));x(s,c.h),x(i,c.s),x(r,c.l),a(n(e)),l("colorChange",n(e))}}function WM(o,e,t,s,i,r){n(e)&&/^#[0-9A-Fa-f]{6}$/.test(n(e))&&(t(n(e)),s("colorChange",n(e)),n(i).includes(n(e))||x(i,[...n(i),n(e)]),x(r,!1))}var qM=o=>o.stopPropagation(),HM=(o,e)=>e(!1),GM=(o,e,t)=>e(n(t)),UM=re("<button></button>"),YM=re('<div class="flex gap-0.5 mb-0.5"></div>'),KM=(o,e,t)=>e(n(t)),ZM=re("<button></button>"),XM=re(`<div class="flex items-center justify-between mb-3"><span class="text-sm text-gray-900 dark:text-gray-300 font-medium">Color Picker</span> <button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">OK</button></div> <div class="mb-3"></div> <div class="mb-3"><div class="flex items-center gap-2 mb-2"><!> <button class="w-5 h-5 rounded border-2 border-dashed border-gray-400 dark:border-gray-500 hover:border-gray-500 dark:hover:border-gray-300 
                   flex items-center justify-center text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4"></path></svg></button></div></div> <div><div class="flex items-center justify-between mb-2"><span class="text-xs text-gray-900 dark:text-gray-300">Opacity</span> <span class="text-xs text-gray-900 dark:text-gray-300"> </span></div> <div class="relative"><div class="absolute inset-0 h-2 rounded opacity-30" style="background-image: repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 6px 6px;"></div> <input type="range" min="0" max="100" class="relative w-full h-2 rounded appearance-none cursor-pointer opacity-slider svelte-16cejrx"> <div class="absolute top-1/2 w-4 h-4 bg-white border-2 border-gray-800 rounded-full transform -translate-y-1/2 pointer-events-none shadow-sm"></div></div></div>`,1),JM=(o,e)=>e(!1),QM=(o,e)=>x(e,!1),eT=re('<div class="mb-3 flex items-center justify-between"><span class="text-sm text-gray-900 dark:text-gray-300 font-medium">Custom Color Picker</span> <div class="flex items-center gap-2"><button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">OK</button> <button class="text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button></div></div> <div class="mb-3"><label class="block text-xs text-gray-600 dark:text-gray-400 mb-2">Hex Color</label> <input type="text" class="w-full px-3 py-2 bg-white dark:bg-[#1A1A1A] border border-gray-300 dark:border-[#404040] rounded text-gray-900 dark:text-white text-sm focus:border-blue-500 focus:outline-none" placeholder="#000000"></div> <div class="mb-3"><div class="w-full h-6 rounded border border-gray-300 dark:border-[#404040]"></div></div> <div class="mb-3"><label class="block text-xs text-gray-600 dark:text-gray-400 mb-2">Color Picker</label> <div class="relative w-full h-24 rounded border border-gray-300 dark:border-[#404040] cursor-crosshair"><div class="absolute w-3 h-3 border-2 border-white rounded-full transform -translate-x-1/2 -translate-y-1/2 pointer-events-none"></div></div></div> <div class="mb-3"><label class="block text-xs text-gray-600 dark:text-gray-400 mb-2">Hue</label> <div class="relative"><input type="range" min="0" max="360" class="w-full h-4 rounded appearance-none cursor-pointer" style="background: linear-gradient(to right, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000);"> <div class="absolute top-1/2 w-4 h-4 bg-white border-2 border-gray-800 rounded-full transform -translate-y-1/2 pointer-events-none shadow-sm"></div></div></div> <button class="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded transition-colors">Add Color</button>',1),tT=re(`<div class="color-picker-container fixed z-[80] bg-white dark:bg-[#2A2A2A] border border-gray-200 dark:border-[#404040] rounded-lg shadow-xl p-3 transition-all duration-200" style="
      left: 50%; 
      top: 50%; 
      transform: translate(-50%, -50%); 
      max-height: 90vh; 
      max-width: 90vw;
      overflow-y: auto;
    "><!></div>`);function iv(o,e){Mc(e,!1);const t=sp();let s=Qs(e,"selectedColor",12,"#1677FF"),i=Qs(e,"show",12,!1),r=Qs(e,"opacity",12,100),a=nd(),l=nd(),c=!1,d=nd(["#FF4D4F","#1890FF","#52C41A","#FA8C16","#722ED1"]),v=nd(!1),g=nd("#000000"),_=nd(0),y=nd(100),k=nd(50);const S=[["#000000","#1C1C1C","#383838","#545454","#707070","#8C8C8C","#A8A8A8","#C4C4C4","#E0E0E0","#FFFFFF"],["#FF0000","#FF4D4F","#FF7875","#FFA39E","#FFCCC7","#FFF1F0","#FFEDED","#FFF5F5","#FFFAFA","#FFFFFF"],["#FF8C00","#FA541C","#FF7A45","#FF9C6E","#FFBB96","#FFD8BF","#FFE7BA","#FFF2E8","#FFF7E6","#FFFBE6"],["#FFD700","#FADB14","#FFEC3D","#FFF566","#FFFF8F","#FFFFB8","#FFFBE6","#FFFBF0","#FFFBF0","#FFFBF0"],["#32CD32","#52C41A","#73D13D","#95DE64","#B7EB8F","#D9F7BE","#F6FFED","#F6FFED","#F6FFED","#F6FFED"],["#00CED1","#13C2C2","#36CFC9","#5CDBD3","#87E8DE","#B5F5EC","#E6FFFB","#E6FFFB","#E6FFFB","#E6FFFB"],["#1E90FF","#1890FF","#40A9FF","#69C0FF","#91D5FF","#BAE7FF","#E6F7FF","#E6F7FF","#E6F7FF","#E6F7FF"],["#9370DB","#722ED1","#9254DE","#B37FEB","#D3ADF7","#EFDBFF","#F9F0FF","#F9F0FF","#F9F0FF","#F9F0FF"]];function M(Y){s(Y),t("colorChange",Y)}function I(Y,Z,ne){ne/=100;const te=Z*Math.min(ne,1-ne)/100,oe=U=>{const J=(U+Y/30)%12,se=ne-te*Math.max(Math.min(J-3,9-J,1),-1);return Math.round(255*se).toString(16).padStart(2,"0")};return`#${oe(0)}${oe(8)}${oe(4)}`}function C(Y){const Z=parseInt(Y.slice(1,3),16)/255,ne=parseInt(Y.slice(3,5),16)/255,te=parseInt(Y.slice(5,7),16)/255,oe=Math.max(Z,ne,te),U=Math.min(Z,ne,te);let J=0,se=0,W=(oe+U)/2;if(oe!==U){const le=oe-U;switch(se=W>.5?le/(2-oe-U):le/(oe+U),oe){case Z:J=(ne-te)/le+(ne<te?6:0);break;case ne:J=(te-Z)/le+2;break;case te:J=(Z-ne)/le+4;break}J/=6}return{h:J*360,s:se*100,l:W*100}}function T(){x(g,I(n(_),n(y),n(k))),s(n(g)),t("colorChange",n(g))}function z(Y){c=!0,$(Y),document.addEventListener("mousemove",j),document.addEventListener("mouseup",B),Y.preventDefault()}function j(Y){c&&n(l)&&$(Y)}function B(){c=!1,document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",B)}function $(Y){if(!n(l))return;const Z=n(l).getBoundingClientRect(),ne=Math.max(0,Math.min(1,(Y.clientX-Z.left)/Z.width)),te=Math.max(0,Math.min(1,(Y.clientY-Z.top)/Z.height));x(y,ne*100),x(k,(1-te)*100),T()}function F(Y){const Z=Y.target;n(a)&&!n(a).contains(Z)&&(i(!1),x(v,!1),t("close"))}rf(()=>{typeof document<"u"&&document.removeEventListener("click",F,!0)}),Fp(()=>wp(i()),()=>{i()&&typeof document<"u"&&setTimeout(()=>{document.addEventListener("click",F,!0)},0)}),Fp(()=>wp(i()),()=>{!i()&&typeof document<"u"&&document.removeEventListener("click",F,!0)}),fm(),Sp();var V=So(),K=Rt(V);Te(K,i,Y=>{var Z=tT();Z.__click=[qM];var ne=m(Z);Te(ne,()=>!n(v),te=>{var oe=XM(),U=Rt(oe),J=p(m(U),2);J.__click=[HM,i],f(U);var se=p(U,2);Vs(se,5,()=>S,_n,(tt,Ze)=>{var ct=YM();Vs(ct,5,()=>n(Ze),_n,(Ge,pt)=>{var ce=UM();ce.__click=[GM,M,pt],Se(()=>{Gn(ce,`w-4 h-4 border hover:scale-110 transition-transform cursor-pointer
                       ${(s()===n(pt)?"border-white dark:border-white border-2":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-400")??""}`),Nt(ce,"style",`background-color: ${n(pt)??""};`)}),O(Ge,ce)}),f(ct),O(tt,ct)}),f(se);var W=p(se,2),le=m(W),ye=m(le);Vs(ye,1,()=>n(d),_n,(tt,Ze)=>{var ct=ZM();ct.__click=[KM,M,Ze],Se(()=>{Gn(ct,`w-5 h-5 rounded border hover:scale-110 transition-transform cursor-pointer
                     ${(s()===n(Ze)?"border-white dark:border-white border-2":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-400")??""}`),Nt(ct,"style",`background-color: ${n(Ze)??""};`)}),O(tt,ct)});var Ce=p(ye,2);Ce.__click=[OM,v],f(le),f(W);var Re=p(W,2),Ke=m(Re),st=p(m(Ke),2),vt=m(st);f(st),f(Ke);var Je=p(Ke,2),ot=p(m(Je),2);Jt(ot),ot.__input=[BM,r,t];var nt=p(ot,2);f(Je),f(Re),Se(()=>{Ve(vt,`${r()??""}%`),Nt(ot,"style",`background: linear-gradient(to right, transparent, ${s()??""});`),Nt(nt,"style",`left: calc(${r()??""}% - 8px);`)}),Ho(ot,r),O(te,oe)},te=>{var oe=eT(),U=Rt(oe),J=p(m(U),2),se=m(J);se.__click=[JM,i];var W=p(se,2);W.__click=[QM,v],f(J),f(U);var le=p(U,2),ye=p(m(le),2);Jt(ye),ye.__input=[VM,g,C,_,y,k,s,t],f(le);var Ce=p(le,2),Re=m(Ce);f(Ce);var Ke=p(Ce,2),st=p(m(Ke),2);st.__mousedown=z;var vt=m(st);f(st),du(st,ct=>x(l,ct),()=>n(l)),f(Ke);var Je=p(Ke,2),ot=p(m(Je),2),nt=m(ot);Jt(nt),nt.__input=T;var tt=p(nt,2);f(ot),f(Je);var Ze=p(Je,2);Ze.__click=[WM,g,s,t,d,v],Se(()=>{Nt(Re,"style",`background-color: ${n(g)??""};`),Nt(st,"style",`background: linear-gradient(to bottom, transparent, black), linear-gradient(to right, white, hsl(${n(_)??""}, 100%, 50%));`),Nt(vt,"style",`left: ${n(y)??""}%; top: ${100-n(k)}%;`),Nt(tt,"style",`left: calc(${n(_)/360*100}% - 8px);`)}),Ho(ye,()=>n(g),ct=>x(g,ct)),Ho(nt,()=>n(_),ct=>x(_,ct)),O(te,oe)}),f(Z),du(Z,te=>x(a,te),()=>n(a)),Se(()=>{ii(Z,"w-64",!n(v)),ii(Z,"w-80",n(v))}),O(Y,Z)}),O(o,V),Tc()}Hd(["click","input","mousedown"]);const oT={data:null,loading:!1,error:null},Nf=op(oT);async function sT(o,e){const s=`${nT()}/auth/user/preference/${o}${e?"?isFree=true":""}`,i=await iT(s,{},8e3);if(!i.ok)throw i.status===404?new Error("User not found"):new Error(`Failed to fetch user preferences: ${i.statusText}`);return await i.json()}function nT(){var e,t;const o=(t=(e=import.meta)==null?void 0:e.env)==null?void 0:t.VITE_USER_PREFS_BASE_URL;return typeof o=="string"&&o.trim()?o.trim():"https://noti.dutyai.app"}async function iT(o,e={},t=8e3){const s=new AbortController,i=setTimeout(()=>s.abort(),t);try{return await fetch(o,{...e,signal:s.signal})}finally{clearTimeout(i)}}function rT(o){Nf.set({data:o,loading:!1,error:null})}function aT(o){Nf.update(e=>({...e,loading:o}))}function lT(o){Nf.set({data:null,loading:!1,error:o})}async function cT(o,e){const t="https://noti.dutyai.app/auth/user/preference";try{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clerkId:o,theme:e})});if(!s.ok)throw new Error(`Failed to save theme preference: ${s.statusText}`);console.log("✅ Theme preference saved successfully:",{clerkId:o,theme:e})}catch(s){console.error("❌ Failed to save theme preference:",s)}}const Ry=op(null),f1=op(null),dT=ak,Kg={},uT=[{tfsecs:604800,origin:345600,date:"1970-01-05"}];function pT(o){if(o=Math.abs(o),o>=1)return 0;let e=0;for(;o<1;)o=o*10,e+=1;return e}function nv(o){if(Kg[o])return Kg[o];const e=o.length-1,t=o.substring(e),s=o.substring(0,e),i=parseInt(s);let r="minute";if(t=="w")r="week";else if(t=="d")r="day";else if(t=="h")r="hour";else if(t=="m")r="minute";else if(t=="s")r="second";else throw new Error(`unsupport period: ${o}`);const a=Am(o);return Kg[o]={multiplier:i,timespan:r,timeframe:o,secs:a},Kg[o]}nv("1m"),nv("5m"),nv("15m"),nv("30m"),nv("1h"),nv("2h"),nv("4h"),nv("8h"),nv("12h"),nv("1d"),nv("3d"),nv("1w");function Zg(o,e,t){return{id:o,position:dT.Middle,marginLeft:8,marginTop:2,marginRight:0,marginBottom:0,paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,icon:e,fontFamily:"icomoon",size:14,color:t,activeColor:t,backgroundColor:"transparent",activeBackgroundColor:"rgba(22, 119, 255, 0.15)"}}function Sd(o){let e=o==="dark"?"#929AA5":"#76808F",t=o==="dark"?"#555555":"#dddddd";const s=o==="dark"?"#081115":"#F3F3F3",i=o==="dark"?"#070211":"#ffffff",r=o==="dark"?"#FFFFFF":"#333333";try{if(typeof window<"u"){const _=document.querySelector(".menu-container")||document.documentElement,y=window.getComputedStyle(_),k=I=>(y.getPropertyValue(I)||"").trim(),S=k("--menu-text"),M=k("--menu-btn-border")||k("--menu-border");S&&(e=S),M&&(t=M)}}catch{}const a=typeof window<"u"&&window.innerWidth<=768,l=typeof window<"u"&&window.innerWidth<=480,c=l?10:a?11:12,d=l?10:a?11:12,v=l?2:a?3:4,g=l?2:a?3:4;return{pane:{backgroundColor:i},candle:{pane:{backgroundColor:i},type:lk.CandleSolid,priceMark:{last:{show:!0},high:{show:!0},low:{show:!0}},tooltip:{showRule:xy.Always,text:{style:{fontSize:32,fontWeight:"bold",color:"#FFFFFF"}},title:{show:!0,size:18,family:"Helvetica Neue",weight:"normal",color:r,template:"{name} · {period} · {exchange} · {segment}"},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:e,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a",template:({current:_})=>{const y="#32CD32",k="#FF0000",S=((_==null?void 0:_.close)??0)>((_==null?void 0:_.open)??0),M=((_==null?void 0:_.close)??0)<((_==null?void 0:_.open)??0),I=S?y:M?k:e,C=z=>({text:z,color:I});return typeof window<"u"&&window.innerWidth<=768?[{title:"O",value:C("{open}")},{title:"H",value:C("{high}")},{title:"L",value:C("{low}")},{title:"C",value:C("{close}")},{title:"V",value:C("{volume}")}]:[{title:"O",value:C("{open}")},{title:"H",value:C("{high}")},{title:"L",value:C("{low}")},{title:"C",value:C("{close}")},{title:"V",value:C("{volume}")}]}}}},indicator:{lastValueMark:{show:!0},tooltip:{showRule:xy.Always,icons:[Zg("visible","",e),Zg("invisible","",e),Zg("setting","",e),Zg("close","",e)]}},grid:{show:!0,horizontal:{show:!0,color:s,style:Oe.Solid,size:1},vertical:{show:!0,color:s,style:Oe.Solid,size:1}},xAxis:{show:!0,axisLine:{show:!0,color:t,size:5},tickLine:{show:!0,color:t},tickText:{show:!0,style:{fontSize:c,color:e,fontFamily:"Arial, sans-serif"},margin:v}},yAxis:{type:"normal",reverse:!1,show:!0,axisLine:{show:!0,color:t,size:4},tickLine:{show:!0,color:t},tickText:{show:!0,style:{fontSize:d,color:e,fontFamily:"Arial, sans-serif"},margin:g}},separator:{size:1,color:o==="dark"?"rgba(85, 85, 85, 0.3)":"rgba(221, 221, 221, 0.3)",fill:!0,activeBackgroundColor:o==="dark"?"rgba(85, 85, 85, 0.1)":"rgba(221, 221, 221, 0.1)"}}}const kd=jb(),bh={AO:[{title:"Short Period",precision:0,min:1,default:5},{title:"Long Period",precision:0,min:1,default:34},{title:"Increasing Color",type:"color",styleKey:"bars[0].upColor",default:"#26A69A"},{title:"Decreasing Color",type:"color",styleKey:"bars[0].downColor",default:"#EF5350"}],BIAS:[{title:c1(),precision:0,min:1,default:6}],BOLL:[{title:c1(),precision:0,min:1,default:20},{title:Rb(),precision:2,min:1,default:2}],BBI:[{title:kd+"1",precision:0,min:1,default:3},{title:kd+"2",precision:0,min:1,default:6},{title:kd+"3",precision:0,min:1,default:12},{title:kd+"4",precision:0,min:1,default:24}],CCI:[{title:kd+"1",precision:0,min:1,default:20}],CR:[{title:kd+"1",precision:0,min:1,default:26},{title:kd+"2",precision:0,min:1,default:10},{title:kd+"3",precision:0,min:1,default:20},{title:kd+"4",precision:0,min:1,default:40},{title:kd+"5",precision:0,min:1,default:60}],DMI:[{title:"DI Period",precision:0,min:1,default:14},{title:"ADX Period",precision:0,min:1,default:6}],EMV:[{title:kd+"1",precision:0,min:1,default:14},{title:kd+"2",precision:0,min:1,default:9}],EMA:[{title:"Period",precision:0,min:1,default:20},{title:"Line Color",type:"color",styleKey:"lines[0].color",default:"#2563eb"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:2}],ICHIMOKU:[{title:"Tenkan Period",precision:0,min:1,default:9},{title:"Kijun Period",precision:0,min:1,default:26},{title:"Senkou B Period",precision:0,min:1,default:52}],MTM:[{title:kd+"1",precision:0,min:1,default:12},{title:kd+"2",precision:0,min:1,default:6}],MA:[{title:"MA1",precision:0,min:1,styleKey:"lines[0].color",default:5},{title:"MA2",precision:0,min:1,styleKey:"lines[1].color",default:10},{title:"MA3",precision:0,min:1,styleKey:"lines[2].color",default:30}],MACD:[{title:"Fast Period",precision:0,min:1,default:12},{title:"Slow Period",precision:0,min:1,default:26},{title:"Signal Period",precision:0,min:1,default:9}],OBV:[{title:kd+"1",precision:0,min:1,default:30},{title:kd+"2",precision:0,min:1,default:10}],PVT:[],PSY:[{title:kd+"1",precision:0,min:1,default:12},{title:kd+"2",precision:0,min:1,default:6}],ROC:[{title:kd+"1",precision:0,min:1,default:12},{title:kd+"2",precision:0,min:1,default:6}],RSI:[{title:"Period",precision:0,min:1,default:14},{title:"Overbought",precision:0,min:50,max:100,default:70},{title:"Middle",precision:0,min:30,max:70,default:50},{title:"Oversold",precision:0,min:0,max:50,default:30},{title:"Line Color",type:"color",styleKey:"lines[0].color",default:"#FF6B35"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:1}],SMA:[{title:kd+"1",precision:0,min:1,default:12},{title:kd+"2",precision:0,min:1,default:2}],SMARTTREND:[{title:"Period",precision:0,min:1,default:10},{title:"Multiplier",precision:1,min:.1,max:10,default:3},{title:"Uptrend Color",type:"color",styleKey:"lines[0].color",default:"#10B981"},{title:"Downtrend Color",type:"color",styleKey:"lines[1].color",default:"#EF4444"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:2}],KDJ:[{title:kd+"1",precision:0,min:1,default:9},{title:kd+"2",precision:0,min:1,default:3},{title:kd+"3",precision:0,min:1,default:3}],SAR:[{title:"Start",precision:3,min:.001,max:.1,default:.02},{title:"Increment",precision:3,min:.001,max:.1,default:.02},{title:"Max value",precision:2,min:.1,max:1,default:.2}],TRIX:[{title:kd+"1",precision:0,min:1,default:12},{title:kd+"2",precision:0,min:1,default:9}],VOL:[{title:"MA1",precision:0,min:1,default:5},{title:"MA2",precision:0,min:1,default:10},{title:"MA3",precision:0,min:1,default:20}],VR:[{title:kd+"1",precision:0,min:1,default:26},{title:kd+"2",precision:0,min:1,default:6},{title:kd+"3",precision:0,min:1,default:12}],WR:[{title:"Period",precision:0,min:1,default:14},{title:"Line Color",type:"color",styleKey:"lines[0].color",default:"#2563eb"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:1}],TRAP_HUNTER:[{title:"Resistance Lookback",precision:0,min:1,default:20},{title:"Support Lookback",precision:0,min:1,default:20},{title:"Confirmation Bars",precision:0,min:1,default:4},{title:"Max Trap Bars",precision:0,min:1,default:6},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Min Volume Spike",precision:2,min:.1,default:1.2},{title:"Min Breakout Factor",precision:4,min:0,default:5e-4},{title:"Min Wick Ratio",precision:2,min:0,max:1,default:.35},{title:"Min Trap Score",precision:2,min:0,max:1,default:.5},{title:"Enable Normal Signal (0/1)",precision:0,min:0,max:1,default:1},{title:"Normal Quiet Bars",precision:0,min:1,default:5}],SMART_MONEY:[{title:"Zone Lookback Bars",precision:0,min:10,default:40},{title:"Min Zone Bars",precision:0,min:3,default:5},{title:"Max Zone Bars",precision:0,min:5,default:25},{title:"ATR Period",precision:0,min:1,default:14},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Min Volume Factor",precision:2,min:.1,default:1.2},{title:"Max Zone Width %",precision:3,min:.001,default:.03},{title:"Prior Trend Lookback",precision:0,min:1,default:20},{title:"Min OBV Trend Strength",precision:2,min:0,default:.2},{title:"Min Zone Score",precision:2,min:0,max:1,default:.6},{title:"Merge Nearby Zones (0/1)",precision:0,min:0,max:1,default:1},{title:"Max Zones Displayed",precision:0,min:1,default:20},{title:"Show Labels (0/1)",precision:0,min:0,max:1,default:1}],VOLCANIC:[{title:"BB Period",precision:0,min:1,default:16},{title:"BB StdDev",precision:2,min:.1,default:2},{title:"ATR Period",precision:0,min:1,default:14},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Normalize Lookback",precision:0,min:10,default:60},{title:"Pressure SMA",precision:0,min:1,default:2},{title:"Min Pressure Alert",precision:2,min:0,max:1,default:.55},{title:"Confirm Bars",precision:0,min:1,default:1},{title:"Min Volume x",precision:2,min:.5,default:1},{title:"Min Range x",precision:2,min:.5,default:1},{title:"Min Body % of Range",precision:2,min:0,max:1,default:.5},{title:"Breakout Lookback",precision:0,min:5,default:10},{title:"Min Bars Between Signals",precision:0,min:1,default:1},{title:"Trend EMA Period",precision:0,min:2,default:30},{title:"Require Trend Align (0/1)",precision:0,min:0,max:1,default:0},{title:"Breakout Buffer %",precision:4,min:0,default:7e-4},{title:"Require BB Band Break (0/1)",precision:0,min:0,max:1,default:0},{title:"Retest Window (bars)",precision:0,min:1,default:1}],VOLCANIC_SIG:[{title:"BB Period",precision:0,min:1,default:16},{title:"BB StdDev",precision:2,min:.1,default:2},{title:"ATR Period",precision:0,min:1,default:14},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Normalize Lookback",precision:0,min:10,default:60},{title:"Pressure SMA",precision:0,min:1,default:2},{title:"Min Pressure Alert",precision:2,min:0,max:1,default:.55},{title:"Confirm Bars",precision:0,min:1,default:1},{title:"Min Volume x",precision:2,min:.5,default:1},{title:"Min Range x",precision:2,min:.5,default:1},{title:"Min Body % of Range",precision:2,min:0,max:1,default:.5},{title:"Breakout Lookback",precision:0,min:5,default:10},{title:"Min Bars Between Signals",precision:0,min:1,default:1},{title:"Trend EMA Period",precision:0,min:2,default:30},{title:"Require Trend Align (0/1)",precision:0,min:0,max:1,default:0},{title:"Breakout Buffer %",precision:4,min:0,default:7e-4},{title:"Require BB Band Break (0/1)",precision:0,min:0,max:1,default:0},{title:"Retest Window (bars)",precision:0,min:1,default:1}],ZIGZAG:[{title:"Deviation %",precision:1,min:1,max:50,default:5},{title:"Depth",precision:0,min:1,max:50,default:5}]};function vT(o,e){if(o>1e12)throw Error("10 digit timestamp is require for align_tfsecs");let t=0;for(const s of uT){if(e<s.tfsecs)break;if(e%s.tfsecs==0){t=s.origin;break}}return t?Math.floor((o-t)/e)*e+t:Math.floor(o/e)*e}function By(o,e){if((!o||isNaN(o)||o<=0)&&(console.warn("Invalid timestamp in align_tfmsecs:",o),o=Date.now()),o<1e12&&(console.warn("13 digit timestamp is require for align_tfmsecs, got:",o),o<1e9?o=o*1e3:o=Date.now()),e<1e3)throw Error("milliseconds tf_msecs is require for align_tfmsecs");const t=Math.floor(o/1e3),s=Math.floor(e/1e3);return vT(t,s)*1e3}function fT(o,e,t,s=null){if(o=o.map((a,l)=>{const c=a[0];return(!c||isNaN(c)||c<=0)&&(console.warn(`Invalid timestamp in build_ohlcvs at index ${l}:`,c),a[0]=Date.now()),a}),s&&((!s[0]||isNaN(s[0])||s[0]<=0)&&(console.warn("Invalid timestamp in last_bar:",s[0]),s[0]=Date.now()),s[0]=By(s[0],t)),e==t)return s&&o.length>0&&o[0][0]>s[0]&&o.splice(0,0,s),o;const i=s?[s]:[];let r=i.length-1;return o.forEach((a,l)=>{if((!a[0]||isNaN(a[0])||a[0]<=0)&&(console.warn(`Invalid timestamp in build_ohlcvs forEach at index ${l}:`,a[0]),a[0]=Date.now()),a[0]=By(a[0],t),r<0||a[0]>i[r][0])i.push(a),r+=1;else{const c=i[r];c[2]=Math.max(c[2],a[2]),c[3]=Math.min(c[3],a[3]),c[4]=a[4],c[5]+=a[5]}}),i}function Dc(o){var s,i,r,a,l,c,d,v;const e=uo.cloneDeep(o),t=(s=e.candle)==null?void 0:s.type;if(t&&(e._originalChartType=t),e.candle&&e.candle.type==="area"&&!e.candle._isLineChart){e.candle.area||(e.candle.area={});const g=((i=e.candle.bar)==null?void 0:i.upColor)||((r=e.candle.bar)==null?void 0:r.downColor)||((c=(l=(a=e.candle.priceMark)==null?void 0:a.last)==null?void 0:l.text)==null?void 0:c.color)||((v=(d=e.candle.tooltip)==null?void 0:d.text)==null?void 0:v.color)||"#2196F3";e.candle.area={...e.candle.area,backgroundColor:[{offset:0,color:g+"60"},{offset:1,color:g+"10"}]}}if(o.yAxis&&(e.yAxis={...e.yAxis,...o.yAxis}),o.xAxis&&(e.xAxis={...e.xAxis,...o.xAxis}),o.grid&&(e.grid={...e.grid,...o.grid}),o.indicator&&(e.indicator={...e.indicator,...o.indicator}),e.candle&&e.candle.type==="heikin_ashi"&&(e.candle.type="candle_solid"),e.candle&&e.candle.type==="renko_atr"&&(e.candle.type="candle_solid"),e.candle&&e.candle.type==="point_and_figure"){e.candle.type="candle_solid";const g="rgba(0,0,0,0)";e.candle.bar={...e.candle.bar,upColor:g,downColor:g,noChangeColor:g,upBorderColor:g,downBorderColor:g,noChangeBorderColor:g,upWickColor:g,downWickColor:g,noChangeWickColor:g},e.candle.priceMark||(e.candle.priceMark={}),e.candle.priceMark.high={show:!1},e.candle.priceMark.low={show:!1}}else if(e.candle&&e.candle.bar){const g=e.candle.bar,_=M=>!M||M==="transparent"||M==="rgba(0,0,0,0)",y="#26A69A",k="#EF5350",S="#888888";_(g.upColor)&&(g.upColor=y),_(g.downColor)&&(g.downColor=k),_(g.noChangeColor)&&(g.noChangeColor=S),_(g.upBorderColor)&&(g.upBorderColor=y),_(g.downBorderColor)&&(g.downBorderColor=k),_(g.noChangeBorderColor)&&(g.noChangeBorderColor=S),_(g.upWickColor)&&(g.upWickColor=y),_(g.downWickColor)&&(g.downWickColor=k),_(g.noChangeWickColor)&&(g.noChangeWickColor=S),e.candle.bar=g}return e}function mT(o,e){var t,s;return(t=e==null?void 0:e.candle)!=null&&t.type?(console.log("✅ Using chart type from $save.styles:",e.candle.type),e.candle.type):o!=null&&o._originalChartType?(console.log("✅ Using original chart type from marker:",o._originalChartType),o._originalChartType):(s=o==null?void 0:o.candle)!=null&&s.type?(console.log("⚠️ Using chart type from chart.getStyles() (might be converted):",o.candle.type),o.candle.type):(console.log("⚠️ No chart type found, defaulting to candle_solid"),"candle_solid")}function Oy(o){if(!o||o.length===0)return o;const e=[];let t=0,s=0;for(let i=0;i<o.length;i++){const r=o[i],a=(r.open+r.high+r.low+r.close)/4;let l;i===0?l=(r.open+r.close)/2:l=(t+s)/2;const c=Math.max(r.high,l,a),d=Math.min(r.low,l,a),v={...r,open:l,high:c,low:d,close:a};e.push(v),t=l,s=a}return e}function Vy(o,e){if(!Array.isArray(o)||o.length===0)return o;const t=(e==null?void 0:e.method)||"ATR",s=Math.max(1,((e==null?void 0:e.atrLength)??14)|0),i=(e==null?void 0:e.source)||"close",r=!!(e!=null&&e.wick),a=ne=>{const te=Number(ne==null?void 0:ne.open),oe=Number(ne==null?void 0:ne.high),U=Number(ne==null?void 0:ne.low),J=Number(ne==null?void 0:ne.close);return!Number.isFinite(te)||!Number.isFinite(oe)||!Number.isFinite(U)||!Number.isFinite(J)?null:{...ne,open:te,high:oe,low:U,close:J,volume:Number.isFinite(Number(ne==null?void 0:ne.volume))?Number(ne.volume):ne==null?void 0:ne.volume}},l=o.map(a).filter(Boolean);if(l.length===0)return[];const c=ne=>{switch(i){case"open":return ne.open;case"high":return ne.high;case"low":return ne.low;default:return ne.close}},d=[];let v=null,g=1/0,_=-1/0,y=0;for(let ne=0;ne<l.length;ne++){const te=l[ne];g=Math.min(g,te.low),_=Math.max(_,te.high),y+=te.close;const oe=v==null?Math.max(0,te.high-te.low):Math.max(te.high-te.low,Math.abs(te.high-v),Math.abs(te.low-v));d.push(Math.max(0,oe)),v=te.close}const k=new Array(d.length).fill(0);let S=0;for(let ne=0;ne<d.length;ne++)S+=d[ne],ne===s-1?k[ne]=S/s:ne>=s?k[ne]=(k[ne-1]*(s-1)+d[ne])/s:k[ne]=d[ne];const M=y/Math.max(1,l.length),I=Number.isFinite(_-g)?Math.max(0,_-g):0,C=k[Math.min(k.length-1,Math.max(0,s-1))]||d.reduce((ne,te)=>ne+te,0)/Math.max(1,d.length);let T=t==="ATR"&&k[k.length-1]||C;if(!Number.isFinite(T)||T<=0){const ne=I>0?I/Math.max(50,l.length):Math.abs(M)*.001;T=ne>0?ne:1}const z=I>0?I/5e3:0,j=Number.isFinite(M)&&M!==0?Math.abs(M)*1e-6:0;T=Math.max(1e-12,T,z,j);const B=200,$=2e4,F=ne=>{if(!Number.isFinite(ne)||ne<=0)return 0;let te=0,oe=c(l[0]);for(let U=1;U<l.length;U++){const J=c(l[U]);if(!Number.isFinite(J))continue;const se=J-oe,W=Math.floor(Math.abs(se)/ne);if(W<=0)continue;const le=Math.min(W,B);if(te+=le,oe+=Math.sign(se)*le*ne,te>$*4)return te}return te};let V=F(T);for(let ne=0;ne<3&&V>$;ne++){const te=Math.max(1.2,V/$);T*=te,V=F(T)}const K=[];let Y=c(l[0]),Z=l[0]&&typeof l[0].timestamp=="number"&&Number.isFinite(l[0].timestamp)?l[0].timestamp:Date.now();for(let ne=1;ne<l.length;ne++){const te=l[ne],oe=c(te);if(!Number.isFinite(oe))continue;const U=oe-Y,J=U>0?1:U<0?-1:0;if(J===0)continue;let se=Math.floor(Math.abs(U)/T);if(!(se<=0)){se=Math.min(se,B);for(let W=0;W<se;W++){const le=Y,ye=Y+J*T,Ce=Math.max(le,ye),Re=Math.min(le,ye),Ke=W===se-1,st=r&&Ke&&J>0?Math.max(Ce,te.high):Ce,vt=r&&Ke&&J<0?Math.min(Re,te.low):Re,Je=typeof te.timestamp=="number"&&Number.isFinite(te.timestamp)?te.timestamp:Z;Z=Math.max(Je,Z+1),K.push({timestamp:Z,open:le,high:st,low:vt,close:ye,volume:te.volume??0}),Y=ye}}}if(K.length===0){const ne=l[l.length-1],te=ne.open,oe=ne.close,U=r?ne.high:Math.max(te,oe),J=r?ne.low:Math.min(te,oe);K.push({timestamp:typeof ne.timestamp=="number"&&Number.isFinite(ne.timestamp)?ne.timestamp:Z||Date.now(),open:te,high:U,low:J,close:oe,volume:ne.volume??0})}return K}const gT={boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"};function Wy(o,e){if(!Array.isArray(o)||o.length===0)return o;const t={...gT,...e};let s;if(t.boxSizeMode==="ATR"){const I=Math.max(1,t.atrLength||14),C=[];let T=null;for(let $=0;$<o.length;$++){const F=o[$],V=T==null?Math.max(0,F.high-F.low):Math.max(F.high-F.low,Math.abs(F.high-T),Math.abs(F.low-T));C.push(Math.max(0,V)),T=F.close}const z=new Array(C.length).fill(0);let j=0;for(let $=0;$<C.length;$++)j+=C[$],$===I-1?z[$]=j/I:$>=I?z[$]=(z[$-1]*(I-1)+C[$])/I:z[$]=C[$];const B=z[z.length-1]||C.reduce(($,F)=>$+F,0)/Math.max(1,C.length);s=Math.max(1e-4,B)}else if(t.boxSizeMode==="percent"){const I=o.reduce((C,T)=>C+T.close,0)/o.length;s=Math.max(1e-4,I*t.boxSize/100)}else s=Math.max(1e-4,t.boxSize);const i=s*t.reversalBoxes,r=o[0];let a=r.close>=r.open?"up":"down",l=Math.floor(r.high/s)*s,c=Math.ceil(r.low/s)*s;const d=[];let v=0,g={columnIndex:0,direction:a,boxes:[],highPrice:l,lowPrice:c,startTime:r.timestamp||Date.now(),endTime:r.timestamp||Date.now()};const _=Math.max(1,Math.round((l-c)/s));for(let I=0;I<=_;I++){const C=c+I*s;g.boxes.push({columnIndex:0,direction:a,boxIndex:I,price:C,startTime:g.startTime,endTime:g.endTime})}const y=500;for(let I=1;I<o.length;I++){const C=o[I],T=C.timestamp||Date.now();if(g.endTime=T,a==="up"){const z=Math.floor(C.high/s)*s;if(z>l){let j=Math.round((z-l)/s);j=Math.min(j,y-g.boxes.length);for(let B=1;B<=j;B++){const $=l+B*s;g.boxes.push({columnIndex:v,direction:"up",boxIndex:g.boxes.length,price:$,startTime:T,endTime:T})}l=z,g.highPrice=l}if(l-C.low>=i){const j=Math.ceil(C.low/s)*s;d.push(g),v++,a="down",c=j,g={columnIndex:v,direction:"down",boxes:[],highPrice:l-s,lowPrice:c,startTime:T,endTime:T};let B=Math.round((g.highPrice-c)/s);B=Math.min(B,y);for(let $=0;$<=B;$++){const F=g.highPrice-$*s;g.boxes.push({columnIndex:v,direction:"down",boxIndex:$,price:F,startTime:T,endTime:T})}l=g.highPrice}}else{const z=Math.ceil(C.low/s)*s;if(z<c){let j=Math.round((c-z)/s);j=Math.min(j,y-g.boxes.length);for(let B=1;B<=j;B++){const $=c-B*s;g.boxes.push({columnIndex:v,direction:"down",boxIndex:g.boxes.length,price:$,startTime:T,endTime:T})}c=z,g.lowPrice=c}if(C.high-c>=i){const j=Math.floor(C.high/s)*s;d.push(g),v++,a="up",l=j,g={columnIndex:v,direction:"up",boxes:[],highPrice:l,lowPrice:c+s,startTime:T,endTime:T};let B=Math.round((l-g.lowPrice)/s);B=Math.min(B,y);for(let $=0;$<=B;$++){const F=g.lowPrice+$*s;g.boxes.push({columnIndex:v,direction:"up",boxIndex:$,price:F,startTime:T,endTime:T})}c=g.lowPrice}}}if(g.boxes.length>0&&d.push(g),d.length===0)return o;const k=[],S=Date.now(),M=6e4;for(const I of d){const C=I.startTime||S+I.columnIndex*M;k.push({timestamp:C,open:I.direction==="up"?I.lowPrice:I.highPrice,high:I.highPrice,low:I.lowPrice,close:I.direction==="up"?I.highPrice:I.lowPrice,volume:I.boxes.length,_pnf:{columnIndex:I.columnIndex,direction:I.direction,boxes:I.boxes,boxCount:I.boxes.length,boxSize:s,upColor:t.upColor,downColor:t.downColor}})}return k}function $f(o){return o.exchange&&o.ticker?`${o.exchange.toUpperCase()}:${o.ticker.toUpperCase()}`:(o.ticker||o.name||"UNKNOWN").toUpperCase()}function hT(o,e){var r,a,l,c;const t=[];if(e)try{const d=((r=e.getChartStore)==null?void 0:r.call(e))||e;d&&typeof d.getPanes=="function"?d.getPanes().forEach((g,_)=>{t.push({id:g.id||`pane_${_}`,height:g.height,minHeight:g.minHeight,position:_,visible:g.visible!==!1})}):t.push({id:"candle_pane",height:400,position:0,visible:!0})}catch(d){console.warn("Error collecting pane configurations:",d),t.push({id:"candle_pane",height:400,position:0,visible:!0})}const s=[],i=new Map;if(Object.entries(o.saveInds).forEach(([d,v])=>{var S,M,I,C,T,z,j,B,$,F,V,K;const g={};v.params&&Array.isArray(v.params)&&v.params.forEach((Y,Z)=>{g[`param_${Z}`]=Y});const _={};v.styles&&Array.isArray(v.styles)?v.styles.forEach((Y,Z)=>{_[`style_${Z}`]=Y}):v.styles&&typeof v.styles=="object"&&Object.assign(_,v.styles);const y={id:d,type:v.name,params:g,styles:_,paneId:v.pane_id,visible:!0,...Object.fromEntries(Object.entries(v).filter(([Y])=>!["name","pane_id","params","styles"].includes(Y)))};if(y.type==="RSI"){const Y=y;if(!Y.rsiGroups||Y.rsiGroups.length===0){const Z=y.paneId||"pane_RSI",ne=of.getInstance(Z)||of.getInstanceConfig(Z);if(ne){const te=ne.overboughtThreshold??((I=(M=(S=ne.levels)==null?void 0:S.find)==null?void 0:M.call(S,J=>J.id==="overbought"))==null?void 0:I.value)??70,oe=((z=(T=(C=ne.levels)==null?void 0:C.find)==null?void 0:T.call(C,J=>J.id==="middle"))==null?void 0:z.value)??50,U=ne.oversoldThreshold??(($=(B=(j=ne.levels)==null?void 0:j.find)==null?void 0:B.call(j,J=>J.id==="oversold"))==null?void 0:$.value)??30;Y.rsiGroups=[{period:ne.period??14,overboughtLevel:te,middleLevel:oe,oversoldLevel:U,styles:{rsi:{color:ne.lineColor??"#8B5CF6",thickness:ne.lineThickness??2,lineStyle:ne.lineStyle??"solid"},overboughtColor:ne.overboughtColor??"#EF4444",oversoldColor:ne.oversoldColor??"#10B981",middleLineColor:((K=(V=(F=ne.levels)==null?void 0:F.find)==null?void 0:V.call(F,J=>J.id==="middle"))==null?void 0:K.color)??"#6B7280"}}]}}}const k=`${v.name}_${v.pane_id||"candle_pane"}`;i.set(k,y)}),e)try{const d=((a=e.getIndicators)==null?void 0:a.call(e))??[];console.log("📊 Collecting indicators from chart:",d.length,"found"),d.forEach(v=>{if(!v.name)return;const g=v.paneId||"candle_pane",_=`${v.name}_${g}`;if(i.has(_)){console.log(`✅ Indicator ${v.name} (${g}) already in saveInds`);return}console.log(`⚠️ Indicator ${v.name} (${g}) on chart but not in saveInds`);let y=null,k=null;for(const[S,M]of Object.entries(o.saveInds))if(M.name===v.name&&(M.pane_id===g||!M.pane_id&&g==="candle_pane")){y=M,k=S;break}if(y&&k){console.log(`✅ Found matching saveInd for ${v.name} with key: ${k}`);const S={};y.params&&Array.isArray(y.params)&&y.params.forEach((C,T)=>{S[`param_${T}`]=C});const M={};y.styles&&Array.isArray(y.styles)?y.styles.forEach((C,T)=>{M[`style_${T}`]=C}):y.styles&&typeof y.styles=="object"&&Object.assign(M,y.styles);const I={id:k,type:y.name,params:S,styles:M,paneId:y.pane_id||g,visible:!0,...Object.fromEntries(Object.entries(y).filter(([C])=>!["name","pane_id","params","styles"].includes(C)))};i.set(_,I)}else{if(v.name==="RSI"){console.log(`♻️ Skipping fallback SavedIndicator creation for RSI on pane ${g} (no matching saveInd)`);return}console.log(`⚠️ No matching saveInd found for ${v.name}, creating basic entry`);const M={id:`${g}_${v.name}`,type:v.name,params:{},styles:{},paneId:g,visible:!0};i.set(_,M)}})}catch(d){console.warn("⚠️ Failed to get indicators from chart, using saveInds only:",d)}return s.push(...Array.from(i.values())),console.log(`✅ Collected ${s.length} indicators for saving (${Object.keys(o.saveInds).length} from saveInds, ${s.length-Object.keys(o.saveInds).length} from chart)`),{timezone:o.timezone,interval:o.period.timeframe,chartType:((c=(l=o.styles)==null?void 0:l.candle)==null?void 0:c.type)||"candle_solid",theme:o.theme,panes:t,indicators:s,styles:o.styles||{},options:o.options||{}}}async function _T(o,e,t){var s,i,r,a,l,c,d,v,g,_,y,k,S,M,I,C,T,z,j,B,$,F,V,K,Y,Z,ne,te,oe,U,J,se,W,le;try{if(console.log("🔄 Applying global state:",o),t){try{t.removeIndicator({}),console.log("🧹 Removed all existing indicators before applying new layout")}catch(Je){console.warn("Failed to clear existing indicators before applying layout:",Je)}try{const{RSIManager:Je}=await J1(async()=>{const{RSIManager:ot}=await Promise.resolve().then(()=>zy);return{RSIManager:ot}},void 0,import.meta.url);Je.clearAllInstances()}catch{}}const ye={},Ce=["SMART_MONEY","TRAP_HUNTER","VOLCANIC","VOLCANIC_SIG"],Re=(s=fp(Nf))==null?void 0:s.data,Ke=Re&&(Re.isPremium===!0||Re.isTrial===!0),st=[],vt=new Set;if(o.indicators.forEach(Je=>{if(Je.type==="RSI"){const ot=Je.rsiGroups,nt=Array.isArray(ot)&&ot.length>0&&(ot[0].actualPaneId||ot[0].paneId)||Je.paneId;if(nt){if(vt.has(nt)){console.log("♻️ Skipping duplicate RSI indicator for pane:",nt);return}vt.add(nt),Je.paneId=nt,Je.id=`${nt}_RSI`,Array.isArray(ot)&&ot.length>0&&(ot[0].paneId=nt,ot[0].actualPaneId=nt)}}st.push(Je)}),st.forEach(Je=>{if(!Ke&&Je.type&&Ce.includes(Je.type)){console.log(`🔒 Skipping AI indicator ${Je.type} - user does not have premium access`);return}const ot=[];Je.params&&typeof Je.params=="object"&&Object.entries(Je.params).forEach(([Ze,ct])=>{if(Ze.startsWith("param_")){const Ge=parseInt(Ze.replace("param_",""));ot[Ge]=ct}});const nt=[];Je.styles&&typeof Je.styles=="object"&&Object.entries(Je.styles).forEach(([Ze,ct])=>{if(Ze.startsWith("style_")&&typeof ct=="object"){const Ge=parseInt(Ze.replace("style_",""));nt[Ge]=ct}});const tt={name:Je.type,pane_id:Je.paneId,params:ot.length>0?ot:void 0,styles:nt.length>0?nt:void 0,...Object.fromEntries(Object.entries(Je).filter(([Ze])=>!["id","type","paneId","params","styles","visible"].includes(Ze)))};ye[Je.id]=tt}),e.update(Je=>{Je.timezone=o.timezone,Je.period={...Je.period,timeframe:o.interval};const ot=o.styles&&typeof o.styles=="object"?{...o.styles}:{},nt=Je.theme||o.theme||"dark";if((o.theme||nt)!==nt)try{const Ze=Sd(nt),ct=uo.merge({},Ze,ot);delete ct.backgroundColor,delete ct.backgroundOpacity,delete ct.backgroundType,delete ct.backgroundGradient,delete ct.gridColor,delete ct.gridOpacity,delete ct.gridType,delete ct.gridGradient,Je.styles=ct}catch{Je.styles=ot}else Je.styles=ot;return Je.styles.candle||(Je.styles.candle={}),Je.styles.candle.type=o.chartType,Je.options=o.options&&typeof o.options=="object"?{...o.options}:{},Je.saveInds=ye,Je}),t)try{const Je=fp(e);t.setStyles&&Je.styles&&(t.setStyles(Je.styles),console.log("🎨 Applied saved styles to chart"))}catch(Je){console.warn("Failed to apply saved styles to chart:",Je)}if(t&&st.length>0){console.log("Creating indicators on chart:",st.length);for(const Je of st)try{const ot=[];Je.params&&typeof Je.params=="object"&&Object.entries(Je.params).forEach(([Ge,pt])=>{if(Ge.startsWith("param_")){const ce=parseInt(Ge.replace("param_",""));ot[ce]=pt}});const nt=[];Je.styles&&typeof Je.styles=="object"&&Object.entries(Je.styles).forEach(([Ge,pt])=>{if(Ge.startsWith("style_")&&typeof pt=="object"){const ce=parseInt(Ge.replace("style_",""));nt[ce]=pt}});const tt={name:Je.type,calcParams:ot.length>0?ot:void 0,visible:Je.visible!==!1};if(nt.length>0&&(tt.styles={lines:nt.map(Ge=>{const pt=Ge.lineStyle==="dashed"||Ge.lineStyle==="dotted",ce=Ge.lineStyle==="dotted"?[2,2]:[4,4];return{color:Ge.color,size:Ge.thickness??1,style:pt?Oe.Dashed:Oe.Solid,dashedValue:pt?ce:[2,2]}})}),Je.type==="SMARTTREND"){const Ge=Je.superTrendGroup,pt=Ge?{showLabels:!!Ge.showLabels,uptrendColor:((r=(i=Ge.styles)==null?void 0:i.uptrend)==null?void 0:r.color)??"#00FF00",downtrendColor:((l=(a=Ge.styles)==null?void 0:a.downtrend)==null?void 0:l.color)??"#FF0000",uptrendThickness:((d=(c=Ge.styles)==null?void 0:c.uptrend)==null?void 0:d.thickness)??1,downtrendThickness:((g=(v=Ge.styles)==null?void 0:v.downtrend)==null?void 0:g.thickness)??1,uptrendLineStyle:((y=(_=Ge.styles)==null?void 0:_.uptrend)==null?void 0:y.lineStyle)??"dashed",downtrendLineStyle:((S=(k=Ge.styles)==null?void 0:k.downtrend)==null?void 0:S.lineStyle)??"dashed"}:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"};if(tt.extendData=pt,!tt.styles){const ce=pt.uptrendLineStyle==="dotted"||pt.uptrendLineStyle==="dashed";tt.styles={lines:[{color:pt.uptrendColor,size:pt.uptrendThickness,style:ce?Oe.Dashed:Oe.Solid,dashedValue:pt.uptrendLineStyle==="dotted"?[2,2]:[4,4]}]}}}if(Je.type==="RSI"){const Ge=Je.rsiGroups||[],pt=Je.paneId;if(Array.isArray(Ge)&&Ge.length>0){const ce=Ge[0],we=((M=ce.styles)==null?void 0:M.overboughtColor)??"#EF4444",ze=((I=ce.styles)==null?void 0:I.oversoldColor)??"#22C55E",dt=((C=ce.styles)==null?void 0:C.middleLineColor)??"#6B7280",qe=ce.fillOpacity??.15,me=((T=ce.styles)==null?void 0:T.overboughtThickness)??1,Q=((z=ce.styles)==null?void 0:z.oversoldThickness)??1,it=((j=ce.styles)==null?void 0:j.middleLineThickness)??1,Vt=((B=ce.styles)==null?void 0:B.overboughtLineStyle)??"dashed",wt=(($=ce.styles)==null?void 0:$.oversoldLineStyle)??"dashed",Yt=((F=ce.styles)==null?void 0:F.middleLineStyle)??"dashed",At={id:pt,period:ce.period??14,lineColor:((K=(V=ce.styles)==null?void 0:V.rsi)==null?void 0:K.color)??"#8B5CF6",lineThickness:((Z=(Y=ce.styles)==null?void 0:Y.rsi)==null?void 0:Z.thickness)??2,lineStyle:((te=(ne=ce.styles)==null?void 0:ne.rsi)==null?void 0:te.lineStyle)??"solid",overboughtLevel:ce.overboughtLevel??70,oversoldLevel:ce.oversoldLevel??30,middleLevel:ce.middleLevel??50,overboughtColor:we,overboughtThickness:me,overboughtLineStyle:Vt,oversoldColor:ze,oversoldThickness:Q,oversoldLineStyle:wt,overboughtFillColor:we,oversoldFillColor:ze,middleLineColor:dt,middleLineThickness:it,middleLineStyle:Yt,fillOpacity:qe,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:ce.overboughtLevel??70,color:we,lineStyle:Vt,thickness:me,label:String(ce.overboughtLevel??70),visible:!0},{id:"middle",value:ce.middleLevel??50,color:dt,lineStyle:Yt,thickness:it,label:String(ce.middleLevel??50),visible:!0},{id:"oversold",value:ce.oversoldLevel??30,color:ze,lineStyle:wt,thickness:Q,label:String(ce.oversoldLevel??30),visible:!0}]};try{const{RSIManager:Do}=await J1(async()=>{const{RSIManager:Eo}=await Promise.resolve().then(()=>zy);return{RSIManager:Eo}},void 0,import.meta.url);Do.importInstanceConfig(At)}catch{}tt.calcParams=[ce.period??14];const Gt={color:((U=(oe=ce.styles)==null?void 0:oe.rsi)==null?void 0:U.color)??"#8B5CF6",size:((se=(J=ce.styles)==null?void 0:J.rsi)==null?void 0:se.thickness)??2,style:Oe.Solid,dashedValue:[2,2]},no=(le=(W=ce.styles)==null?void 0:W.rsi)==null?void 0:le.lineStyle;no==="dashed"?(Gt.style=Oe.Dashed,Gt.dashedValue=[6,4]):no==="dotted"&&(Gt.style=Oe.Dashed,Gt.dashedValue=[2,2]),tt.styles={lines:[Gt]}}}const Ze=Je.paneId==="candle_pane",ct=t.createIndicator(tt,Ze,{id:Je.paneId});console.log(`Created indicator ${Je.type} with ID:`,ct)}catch(ot){console.error(`Failed to create indicator ${Je.type}:`,ot)}}console.log("Applied global state:",{timezone:o.timezone,interval:o.interval,chartType:o.chartType,theme:o.theme,indicatorCount:st.length,indicatorsCreated:t?st.length:0})}catch(ye){throw console.error("Error applying global state:",ye),ye}}function qy(o){return $f(o.symbol)}class yT{constructor(e){ve(this,"chart");ve(this,"persistenceKey");ve(this,"currentSymbol",null);ve(this,"ephemeralMode",!0);ve(this,"drawingsBySymbol",new Map);ve(this,"renderedDrawingIds",new Set);ve(this,"onDrawingCreated");ve(this,"onDrawingRemoved");ve(this,"onSymbolChanged");ve(this,"symbolChangeCallbacks",new Set);this.chart=e.chart,this.persistenceKey=e.persistenceKey,this.onDrawingCreated=e.onDrawingCreated,this.onDrawingRemoved=e.onDrawingRemoved,this.onSymbolChanged=e.onSymbolChanged,this.ephemeralMode||this.loadFromStorage(),console.log("✅ DrawingManager initialized with key:",this.persistenceKey)}setCurrentSymbol(e){var i;const t=typeof e=="string"?e:$f(e);if(this.currentSymbol===t){console.log("🔄 Symbol unchanged, skipping reload:",t);return}const s=this.currentSymbol;this.currentSymbol=t,console.log(`🔄 Symbol changed: ${s} → ${t}`),this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol(),s&&((i=this.onSymbolChanged)==null||i.call(this,s,t),this.symbolChangeCallbacks.forEach(r=>r(t)))}getCurrentSymbol(){return this.currentSymbol}addDrawing(e){var i;if(!e.symbolKey)throw console.error("❌ Cannot add drawing without symbolKey:",e),new Error("Drawing must have a symbolKey");let t=this.drawingsBySymbol.get(e.symbolKey);t||(t=[],this.drawingsBySymbol.set(e.symbolKey,t));const s=t.findIndex(r=>r.id===e.id);s>=0?(t[s]=e,console.log("🔄 Updated drawing:",e.id,"for symbol:",e.symbolKey)):(t.push(e),console.log("➕ Added drawing:",e.id,"for symbol:",e.symbolKey)),this.saveToStorage(),e.symbolKey===this.currentSymbol&&e.visible!==!1&&this.renderDrawing(e),(i=this.onDrawingCreated)==null||i.call(this,e)}removeDrawing(e){var i,r;let t=!1,s=null;for(const[a,l]of this.drawingsBySymbol.entries()){const c=l.findIndex(d=>d.id===e);if(c>=0){l.splice(c,1),t=!0,s=a,console.log("🗑️ Removed drawing:",e,"from symbol:",a);break}}return t&&(s&&((i=this.drawingsBySymbol.get(s))==null?void 0:i.length)===0&&this.drawingsBySymbol.delete(s),this.saveToStorage(),this.renderedDrawingIds.has(e)&&(this.chart.removeOverlay({id:e}),this.renderedDrawingIds.delete(e)),s&&((r=this.onDrawingRemoved)==null||r.call(this,e,s))),t}removeDrawingForSymbol(e,t){var r;const s=this.drawingsBySymbol.get(t);if(!s)return!1;const i=s.findIndex(a=>a.id===e);return i<0?!1:(s.splice(i,1),s.length===0&&this.drawingsBySymbol.delete(t),this.saveToStorage(),this.renderedDrawingIds.has(e)&&(this.chart.removeOverlay({id:e}),this.renderedDrawingIds.delete(e)),(r=this.onDrawingRemoved)==null||r.call(this,e,t),!0)}getDrawingsForSymbol(e){return this.drawingsBySymbol.get(e)||[]}getCurrentSymbolDrawings(){return this.currentSymbol?this.getDrawingsForSymbol(this.currentSymbol):[]}getAllDrawings(){return new Map(this.drawingsBySymbol)}clearDrawingsForSymbol(e){const t=this.drawingsBySymbol.get(e);t&&(e===this.currentSymbol&&t.forEach(s=>{this.renderedDrawingIds.has(s.id)&&(this.chart.removeOverlay({id:s.id}),this.renderedDrawingIds.delete(s.id))}),this.drawingsBySymbol.delete(e),this.saveToStorage(),console.log("🗑️ Cleared all drawings for symbol:",e))}clearCurrentSymbolDrawings(){this.currentSymbol&&this.clearDrawingsForSymbol(this.currentSymbol)}clearRenderedDrawings(){this.renderedDrawingIds.forEach(e=>{try{this.chart.removeOverlay({id:e})}catch(t){console.warn("Failed to remove overlay:",e,t)}}),this.renderedDrawingIds.clear(),console.log("🧹 Cleared rendered drawings from chart")}hideRenderedDrawings(){this.clearRenderedDrawings()}renderDrawingsForCurrentSymbol(){if(!this.currentSymbol){console.log("⚠️ No current symbol, skipping render");return}const e=this.getDrawingsForSymbol(this.currentSymbol);console.log(`🎨 Rendering ${e.length} drawings for symbol:`,this.currentSymbol),e.forEach(t=>{t.visible!==!1&&this.renderDrawing(t)})}renderCurrentSymbolDrawings(){this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol()}renderDrawing(e){if(e.symbolKey!==this.currentSymbol){console.warn("⛔ Drawing symbolKey mismatch, skipping render:",{drawingSymbol:e.symbolKey,currentSymbol:this.currentSymbol});return}try{const t={id:e.id,groupId:"drawing_tools",name:e.type,points:e.points.map(i=>({timestamp:i.time,value:i.price,t:i.time,p:i.price})),styles:e.styles,lock:e.locked,visible:e.visible,onSelected:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalSelectOverlay&&r.externalSelectOverlay(i.overlay)}catch{}return!0},onDeselected:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalDeselectOverlay&&r.externalDeselectOverlay(i.overlay)}catch{}return!0},onPressedMoveEnd:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalSyncOverlay&&r.externalSyncOverlay(i.overlay)}catch{}return!0},onRemoved:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalRemoved&&r.externalRemoved(i.overlay.id)}catch{}return!0},...Object.fromEntries(Object.entries(e).filter(([i])=>!["id","symbolKey","type","points","styles","locked","visible","seriesId"].includes(i)))};this.chart.createOverlay(t)&&(this.renderedDrawingIds.add(e.id),console.log("✅ Rendered drawing:",e.id,"for symbol:",e.symbolKey))}catch(t){console.error("❌ Failed to render drawing:",e.id,t)}}updateDrawing(e,t){for(const[s,i]of this.drawingsBySymbol.entries()){const r=i.findIndex(a=>a.id===e);if(r>=0){const a=i[r];return i[r]={...a,...t,symbolKey:a.symbolKey},this.saveToStorage(),console.log("🔄 Updated drawing:",e),!0}}return!1}loadDrawingsForSymbol(e,t){const s=t.filter(i=>i.symbolKey!==e?(console.warn("⚠️ Drawing symbolKey mismatch during bulk load:",{expected:e,actual:i.symbolKey,drawingId:i.id}),!1):!0);this.drawingsBySymbol.set(e,s),this.saveToStorage(),e===this.currentSymbol&&(this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol()),console.log(`📥 Loaded ${s.length} drawings for symbol:`,e)}loadAllDrawings(e){this.drawingsBySymbol.clear(),Object.entries(e).forEach(([t,s])=>{const i=s.filter(r=>(r.symbolKey||(console.warn("⚠️ Drawing missing symbolKey, assigning:",t),r.symbolKey=t),!0));this.drawingsBySymbol.set(t,i)}),this.saveToStorage(),this.currentSymbol&&(this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol()),console.log("📥 Loaded drawings for",this.drawingsBySymbol.size,"symbols")}saveToStorage(){if(!this.ephemeralMode)try{const e={drawingsBySymbol:Object.fromEntries(this.drawingsBySymbol),version:1};localStorage.setItem(this.persistenceKey,JSON.stringify(e))}catch(e){console.error("❌ Failed to save drawings to storage:",e)}}clearPersistedStorage(){try{localStorage.removeItem(this.persistenceKey),console.log("🧹 Cleared persisted drawing storage for key:",this.persistenceKey)}catch(e){console.warn("Failed to clear persisted drawing storage:",e)}}loadFromStorage(){if(!this.ephemeralMode)try{const e=localStorage.getItem(this.persistenceKey);if(!e){console.log("📭 No stored drawings found");return}const t=JSON.parse(e);if(!t.version){console.log("🔄 Migrating legacy drawing storage..."),this.migrateLegacyStorage(t);return}Object.entries(t.drawingsBySymbol||{}).forEach(([s,i])=>{const r=i.map(a=>(a.symbolKey||(a.symbolKey=s),a));this.drawingsBySymbol.set(s,r)}),console.log("📂 Loaded drawings from storage:",this.drawingsBySymbol.size,"symbols")}catch(e){console.error("❌ Failed to load drawings from storage:",e),this.drawingsBySymbol.clear()}}migrateLegacyStorage(e){if(console.log("🔄 Starting migration of legacy overlay format..."),typeof e=="object"&&!e.drawingsBySymbol){const t={};Object.entries(e).forEach(([s,i])=>{try{const r=s.split("_");if(r.length<3){console.warn("⚠️ Invalid legacy key format:",s);return}const a=r[r.length-1],l=r[r.length-2],d=r.slice(0,-2).join("_").toUpperCase(),v=this.convertLegacyOverlayToDrawing(a,i,d);v&&(t[d]||(t[d]=[]),t[d].push(v))}catch(r){console.warn("⚠️ Failed to migrate legacy overlay:",s,r)}}),Object.entries(t).forEach(([s,i])=>{this.drawingsBySymbol.set(s,i)}),this.saveToStorage(),console.log("✅ Migration complete:",this.drawingsBySymbol.size,"symbols migrated")}}convertLegacyOverlayToDrawing(e,t,s){try{const i=[];return t.points&&Array.isArray(t.points)&&t.points.forEach(r=>{r&&typeof r=="object"&&(r.timestamp&&r.value!==void 0?i.push({time:r.timestamp,price:r.value}):r.time&&r.price!==void 0?i.push({time:r.time,price:r.price}):r.t&&r.p!==void 0&&i.push({time:r.t,price:r.p}))}),i.length===0?(console.warn("Legacy overlay has no valid data coordinates:",e),null):{id:e,symbolKey:s,type:t.name||"unknown",points:i,styles:t.styles||{},locked:!!t.lock,visible:t.visible!==!1,...Object.fromEntries(Object.entries(t).filter(([r])=>!["name","points","styles","lock","visible"].includes(r)))}}catch(i){return console.warn("Error converting legacy overlay to drawing:",e,i),null}}onSymbolChange(e){this.symbolChangeCallbacks.add(e)}offSymbolChange(e){this.symbolChangeCallbacks.delete(e)}exportDrawings(){return Object.fromEntries(this.drawingsBySymbol)}getStats(){let e=0;return this.drawingsBySymbol.forEach(t=>{e+=t.length}),{totalSymbols:this.drawingsBySymbol.size,totalDrawings:e,currentSymbolDrawings:this.getCurrentSymbolDrawings().length,renderedDrawings:this.renderedDrawingIds.size}}destroy(){this.clearRenderedDrawings(),this.symbolChangeCallbacks.clear(),this.drawingsBySymbol.clear(),console.log("🗑️ DrawingManager destroyed")}}let w0=null;function bT(o){return w0&&(console.warn("⚠️ DrawingManager already initialized, destroying old instance"),w0.destroy()),w0=new yT(o),w0}function Rv(){return w0}class xT{constructor(){ve(this,"state",op({undoStack:[],redoStack:[],maxHistorySize:50}));ve(this,"chart",null);ve(this,"saveStore",null);ve(this,"overlaysStore",null)}init({chart:e,saveStore:t,overlaysStore:s}){this.chart=e,this.saveStore=t,this.overlaysStore=s}addAction(e){this.state.update(t=>(t.redoStack=[],t.undoStack.push(e),t.undoStack.length>t.maxHistorySize&&t.undoStack.shift(),t))}recordAddIndicator(e,t,s,i){const r={type:"ADD_INDICATOR",data:{name:e,paneId:t,params:s,saveKey:i},timestamp:Date.now(),id:`indicator_${e}_${t}_${Date.now()}`};this.addAction(r)}recordRemoveIndicator(e,t,s,i){const r={type:"REMOVE_INDICATOR",data:{name:e,paneId:t,params:s,saveKey:i},timestamp:Date.now(),id:`indicator_${e}_${t}_${Date.now()}`};this.addAction(r)}recordAddOverlay(e,t,s){const i={type:"ADD_OVERLAY",data:{overlayId:e,overlayData:t,overlayKey:s},timestamp:Date.now(),id:`overlay_${e}_${Date.now()}`};this.addAction(i)}recordRemoveOverlay(e,t,s){const i={type:"REMOVE_OVERLAY",data:{overlayId:e,overlayData:t,overlayKey:s},timestamp:Date.now(),id:`overlay_${e}_${Date.now()}`};this.addAction(i)}recordModifyOverlay(e,t,s,i){const r={type:"MODIFY_OVERLAY",data:{overlayId:e,prevData:t,nextData:s,overlayKey:i},timestamp:Date.now(),id:`overlay_${e}_${Date.now()}`};this.addAction(r)}undo(){const e=fp(this.state);if(e.undoStack.length===0)return!1;const t=e.undoStack[e.undoStack.length-1],s=this.executeUndo(t);return s&&this.state.update(i=>{const r=i.undoStack.pop();return r&&i.redoStack.push(r),i}),s}redo(){const e=fp(this.state);if(e.redoStack.length===0)return!1;const t=e.redoStack[e.redoStack.length-1],s=this.executeRedo(t);return s&&this.state.update(i=>{const r=i.redoStack.pop();return r&&i.undoStack.push(r),i}),s}executeUndo(e){var t,s,i,r,a;if(!this.chart)return!1;try{switch(e.type){case"ADD_INDICATOR":this.chart.removeIndicator({paneId:e.data.paneId,name:e.data.name}),this.saveStore&&this.saveStore.update(d=>(delete d.saveInds[e.data.saveKey],d));break;case"REMOVE_INDICATOR":const l=this.chart.createIndicator({name:e.data.name,calcParams:e.data.params},!1,{id:e.data.paneId});this.saveStore&&l&&this.saveStore.update(d=>(d.saveInds[e.data.saveKey]={name:e.data.name,pane_id:e.data.paneId,params:e.data.params},d));break;case"ADD_OVERLAY":this.chart.removeOverlay({id:e.data.overlayId}),this.overlaysStore&&this.overlaysStore.update(d=>(delete d[e.data.overlayKey],d));try{const d=Rv();d&&d.removeDrawing(e.data.overlayId)}catch{}break;case"REMOVE_OVERLAY":const c=this.chart.createOverlay(e.data.overlayData);this.overlaysStore&&c&&this.overlaysStore.update(d=>(d[e.data.overlayKey]=e.data.overlayData,d));try{const d=Rv();if(d){const v=fp(this.saveStore),g=$f(v.symbol),_=e.data.overlayData,y=Array.isArray(_==null?void 0:_.points)?_.points.map(k=>({time:(k==null?void 0:k.timestamp)??(k==null?void 0:k.t)??0,price:(k==null?void 0:k.value)??(k==null?void 0:k.p)??0})):[];if(y.length>0){const k={id:e.data.overlayId,symbolKey:g,type:(_==null?void 0:_.name)||"unknown",points:y,styles:(_==null?void 0:_.styles)||{},..._!=null&&_.extendData?{extendData:_.extendData}:{},locked:!!(_!=null&&_.lock),visible:(_==null?void 0:_.visible)!==!1};d.addDrawing(k)}}}catch{}break;case"MODIFY_OVERLAY":this.chart.overrideOverlay({id:e.data.overlayId,styles:(t=e.data.prevData)==null?void 0:t.styles,extendData:(s=e.data.prevData)==null?void 0:s.extendData,points:(i=e.data.prevData)==null?void 0:i.points,lock:(r=e.data.prevData)==null?void 0:r.lock,visible:(a=e.data.prevData)==null?void 0:a.visible}),this.overlaysStore&&this.overlaysStore.update(d=>(d[e.data.overlayKey]=e.data.prevData,d));try{const d=Rv();if(d){const v=e.data.prevData,g=Array.isArray(v==null?void 0:v.points)?v.points.map(_=>({time:(_==null?void 0:_.timestamp)??(_==null?void 0:_.t)??0,price:(_==null?void 0:_.value)??(_==null?void 0:_.p)??0})):[];d.updateDrawing(e.data.overlayId,{points:g,styles:(v==null?void 0:v.styles)||{},extendData:v==null?void 0:v.extendData,locked:!!(v!=null&&v.lock),visible:(v==null?void 0:v.visible)!==!1})}}catch{}break;default:return!1}return!0}catch(l){return console.error("Error executing undo:",l),!1}}executeRedo(e){var t,s,i,r,a;if(!this.chart)return!1;try{switch(e.type){case"ADD_INDICATOR":const l=this.chart.createIndicator({name:e.data.name,calcParams:e.data.params},!1,{id:e.data.paneId});this.saveStore&&l&&this.saveStore.update(d=>(d.saveInds[e.data.saveKey]={name:e.data.name,pane_id:e.data.paneId,params:e.data.params},d));break;case"REMOVE_INDICATOR":this.chart.removeIndicator({paneId:e.data.paneId,name:e.data.name}),this.saveStore&&this.saveStore.update(d=>(delete d.saveInds[e.data.saveKey],d));break;case"ADD_OVERLAY":const c=this.chart.createOverlay(e.data.overlayData);this.overlaysStore&&c&&this.overlaysStore.update(d=>(d[e.data.overlayKey]=e.data.overlayData,d));try{const d=Rv();if(d){const v=fp(this.saveStore),g=$f(v.symbol),_=e.data.overlayData,y=Array.isArray(_==null?void 0:_.points)?_.points.map(k=>({time:(k==null?void 0:k.timestamp)??(k==null?void 0:k.t)??0,price:(k==null?void 0:k.value)??(k==null?void 0:k.p)??0})):[];if(y.length>0){const k={id:e.data.overlayId,symbolKey:g,type:(_==null?void 0:_.name)||"unknown",points:y,styles:(_==null?void 0:_.styles)||{},..._!=null&&_.extendData?{extendData:_.extendData}:{},locked:!!(_!=null&&_.lock),visible:(_==null?void 0:_.visible)!==!1};d.addDrawing(k)}}}catch{}break;case"REMOVE_OVERLAY":this.chart.removeOverlay({id:e.data.overlayId}),this.overlaysStore&&this.overlaysStore.update(d=>(delete d[e.data.overlayKey],d));try{const d=Rv();d&&d.removeDrawing(e.data.overlayId)}catch{}break;case"MODIFY_OVERLAY":this.chart.overrideOverlay({id:e.data.overlayId,styles:(t=e.data.nextData)==null?void 0:t.styles,extendData:(s=e.data.nextData)==null?void 0:s.extendData,points:(i=e.data.nextData)==null?void 0:i.points,lock:(r=e.data.nextData)==null?void 0:r.lock,visible:(a=e.data.nextData)==null?void 0:a.visible}),this.overlaysStore&&this.overlaysStore.update(d=>(d[e.data.overlayKey]=e.data.nextData,d));try{const d=Rv();if(d){const v=e.data.nextData,g=Array.isArray(v==null?void 0:v.points)?v.points.map(_=>({time:(_==null?void 0:_.timestamp)??(_==null?void 0:_.t)??0,price:(_==null?void 0:_.value)??(_==null?void 0:_.p)??0})):[];d.updateDrawing(e.data.overlayId,{points:g,styles:(v==null?void 0:v.styles)||{},extendData:v==null?void 0:v.extendData,locked:!!(v!=null&&v.lock),visible:(v==null?void 0:v.visible)!==!1})}}catch{}break;default:return!1}return!0}catch(l){return console.error("Error executing redo:",l),!1}}canUndo(){return fp(this.state).undoStack.length>0}canRedo(){return fp(this.state).redoStack.length>0}getState(){return this.state}clearHistory(){this.state.update(e=>({...e,undoStack:[],redoStack:[]}))}}const nu=new xT,wT={"😀":{name:"grinning face",slug:"grinning_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😃":{name:"grinning face with big eyes",slug:"grinning_face_with_big_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😄":{name:"grinning face with smiling eyes",slug:"grinning_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😁":{name:"beaming face with smiling eyes",slug:"beaming_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😆":{name:"grinning squinting face",slug:"grinning_squinting_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😅":{name:"grinning face with sweat",slug:"grinning_face_with_sweat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤣":{name:"rolling on the floor laughing",slug:"rolling_on_the_floor_laughing",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"😂":{name:"face with tears of joy",slug:"face_with_tears_of_joy",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙂":{name:"slightly smiling face",slug:"slightly_smiling_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🙃":{name:"upside-down face",slug:"upside_down_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫠":{name:"melting face",slug:"melting_face",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😉":{name:"winking face",slug:"winking_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😊":{name:"smiling face with smiling eyes",slug:"smiling_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😇":{name:"smiling face with halo",slug:"smiling_face_with_halo",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥰":{name:"smiling face with hearts",slug:"smiling_face_with_hearts",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"😍":{name:"smiling face with heart-eyes",slug:"smiling_face_with_heart_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤩":{name:"star-struck",slug:"star_struck",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😘":{name:"face blowing a kiss",slug:"face_blowing_a_kiss",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😗":{name:"kissing face",slug:"kissing_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☺️":{name:"smiling face",slug:"smiling_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😚":{name:"kissing face with closed eyes",slug:"kissing_face_with_closed_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😙":{name:"kissing face with smiling eyes",slug:"kissing_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥲":{name:"smiling face with tear",slug:"smiling_face_with_tear",group:"Smileys & Emotion",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"😋":{name:"face savoring food",slug:"face_savoring_food",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😛":{name:"face with tongue",slug:"face_with_tongue",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😜":{name:"winking face with tongue",slug:"winking_face_with_tongue",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤪":{name:"zany face",slug:"zany_face",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😝":{name:"squinting face with tongue",slug:"squinting_face_with_tongue",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤑":{name:"money-mouth face",slug:"money_mouth_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤗":{name:"smiling face with open hands",slug:"smiling_face_with_open_hands",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤭":{name:"face with hand over mouth",slug:"face_with_hand_over_mouth",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🫢":{name:"face with open eyes and hand over mouth",slug:"face_with_open_eyes_and_hand_over_mouth",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🫣":{name:"face with peeking eye",slug:"face_with_peeking_eye",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🤫":{name:"shushing face",slug:"shushing_face",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🤔":{name:"thinking face",slug:"thinking_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫡":{name:"saluting face",slug:"saluting_face",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🤐":{name:"zipper-mouth face",slug:"zipper_mouth_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤨":{name:"face with raised eyebrow",slug:"face_with_raised_eyebrow",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😐":{name:"neutral face",slug:"neutral_face",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"😑":{name:"expressionless face",slug:"expressionless_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😶":{name:"face without mouth",slug:"face_without_mouth",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫥":{name:"dotted line face",slug:"dotted_line_face",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😶‍🌫️":{name:"face in clouds",slug:"face_in_clouds",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"😏":{name:"smirking face",slug:"smirking_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😒":{name:"unamused face",slug:"unamused_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙄":{name:"face with rolling eyes",slug:"face_with_rolling_eyes",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😬":{name:"grimacing face",slug:"grimacing_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😮‍💨":{name:"face exhaling",slug:"face_exhaling",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"🤥":{name:"lying face",slug:"lying_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫨":{name:"shaking face",slug:"shaking_face",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🙂‍↔️":{name:"head shaking horizontally",slug:"head_shaking_horizontally",group:"Smileys & Emotion",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🙂‍↕️":{name:"head shaking vertically",slug:"head_shaking_vertically",group:"Smileys & Emotion",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"😌":{name:"relieved face",slug:"relieved_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😔":{name:"pensive face",slug:"pensive_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😪":{name:"sleepy face",slug:"sleepy_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤤":{name:"drooling face",slug:"drooling_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"😴":{name:"sleeping face",slug:"sleeping_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫩":{name:"face with bags under eyes",slug:"face_with_bags_under_eyes",group:"Smileys & Emotion",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"😷":{name:"face with medical mask",slug:"face_with_medical_mask",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤒":{name:"face with thermometer",slug:"face_with_thermometer",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤕":{name:"face with head-bandage",slug:"face_with_head_bandage",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤢":{name:"nauseated face",slug:"nauseated_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🤮":{name:"face vomiting",slug:"face_vomiting",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🤧":{name:"sneezing face",slug:"sneezing_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥵":{name:"hot face",slug:"hot_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥶":{name:"cold face",slug:"cold_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥴":{name:"woozy face",slug:"woozy_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"😵":{name:"face with crossed-out eyes",slug:"face_with_crossed_out_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😵‍💫":{name:"face with spiral eyes",slug:"face_with_spiral_eyes",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"🤯":{name:"exploding head",slug:"exploding_head",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🤠":{name:"cowboy hat face",slug:"cowboy_hat_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥳":{name:"partying face",slug:"partying_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥸":{name:"disguised face",slug:"disguised_face",group:"Smileys & Emotion",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"😎":{name:"smiling face with sunglasses",slug:"smiling_face_with_sunglasses",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤓":{name:"nerd face",slug:"nerd_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧐":{name:"face with monocle",slug:"face_with_monocle",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😕":{name:"confused face",slug:"confused_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫤":{name:"face with diagonal mouth",slug:"face_with_diagonal_mouth",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😟":{name:"worried face",slug:"worried_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🙁":{name:"slightly frowning face",slug:"slightly_frowning_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☹️":{name:"frowning face",slug:"frowning_face",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"😮":{name:"face with open mouth",slug:"face_with_open_mouth",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😯":{name:"hushed face",slug:"hushed_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😲":{name:"astonished face",slug:"astonished_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😳":{name:"flushed face",slug:"flushed_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥺":{name:"pleading face",slug:"pleading_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥹":{name:"face holding back tears",slug:"face_holding_back_tears",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😦":{name:"frowning face with open mouth",slug:"frowning_face_with_open_mouth",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😧":{name:"anguished face",slug:"anguished_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😨":{name:"fearful face",slug:"fearful_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😰":{name:"anxious face with sweat",slug:"anxious_face_with_sweat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😥":{name:"sad but relieved face",slug:"sad_but_relieved_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😢":{name:"crying face",slug:"crying_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😭":{name:"loudly crying face",slug:"loudly_crying_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😱":{name:"face screaming in fear",slug:"face_screaming_in_fear",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😖":{name:"confounded face",slug:"confounded_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😣":{name:"persevering face",slug:"persevering_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😞":{name:"disappointed face",slug:"disappointed_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😓":{name:"downcast face with sweat",slug:"downcast_face_with_sweat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😩":{name:"weary face",slug:"weary_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😫":{name:"tired face",slug:"tired_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥱":{name:"yawning face",slug:"yawning_face",group:"Smileys & Emotion",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"😤":{name:"face with steam from nose",slug:"face_with_steam_from_nose",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😡":{name:"enraged face",slug:"enraged_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😠":{name:"angry face",slug:"angry_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤬":{name:"face with symbols on mouth",slug:"face_with_symbols_on_mouth",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😈":{name:"smiling face with horns",slug:"smiling_face_with_horns",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"👿":{name:"angry face with horns",slug:"angry_face_with_horns",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💀":{name:"skull",slug:"skull",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☠️":{name:"skull and crossbones",slug:"skull_and_crossbones",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💩":{name:"pile of poo",slug:"pile_of_poo",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤡":{name:"clown face",slug:"clown_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"👹":{name:"ogre",slug:"ogre",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👺":{name:"goblin",slug:"goblin",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👻":{name:"ghost",slug:"ghost",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👽":{name:"alien",slug:"alien",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👾":{name:"alien monster",slug:"alien_monster",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤖":{name:"robot",slug:"robot",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😺":{name:"grinning cat",slug:"grinning_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😸":{name:"grinning cat with smiling eyes",slug:"grinning_cat_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😹":{name:"cat with tears of joy",slug:"cat_with_tears_of_joy",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😻":{name:"smiling cat with heart-eyes",slug:"smiling_cat_with_heart_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😼":{name:"cat with wry smile",slug:"cat_with_wry_smile",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😽":{name:"kissing cat",slug:"kissing_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙀":{name:"weary cat",slug:"weary_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😿":{name:"crying cat",slug:"crying_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😾":{name:"pouting cat",slug:"pouting_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙈":{name:"see-no-evil monkey",slug:"see_no_evil_monkey",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙉":{name:"hear-no-evil monkey",slug:"hear_no_evil_monkey",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙊":{name:"speak-no-evil monkey",slug:"speak_no_evil_monkey",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💌":{name:"love letter",slug:"love_letter",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💘":{name:"heart with arrow",slug:"heart_with_arrow",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💝":{name:"heart with ribbon",slug:"heart_with_ribbon",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💖":{name:"sparkling heart",slug:"sparkling_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💗":{name:"growing heart",slug:"growing_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💓":{name:"beating heart",slug:"beating_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💞":{name:"revolving hearts",slug:"revolving_hearts",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💕":{name:"two hearts",slug:"two_hearts",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💟":{name:"heart decoration",slug:"heart_decoration",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❣️":{name:"heart exclamation",slug:"heart_exclamation",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💔":{name:"broken heart",slug:"broken_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❤️‍🔥":{name:"heart on fire",slug:"heart_on_fire",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"❤️‍🩹":{name:"mending heart",slug:"mending_heart",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"❤️":{name:"red heart",slug:"red_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩷":{name:"pink heart",slug:"pink_heart",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🧡":{name:"orange heart",slug:"orange_heart",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"💛":{name:"yellow heart",slug:"yellow_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💚":{name:"green heart",slug:"green_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💙":{name:"blue heart",slug:"blue_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩵":{name:"light blue heart",slug:"light_blue_heart",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"💜":{name:"purple heart",slug:"purple_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤎":{name:"brown heart",slug:"brown_heart",group:"Smileys & Emotion",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🖤":{name:"black heart",slug:"black_heart",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🩶":{name:"grey heart",slug:"grey_heart",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🤍":{name:"white heart",slug:"white_heart",group:"Smileys & Emotion",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"💋":{name:"kiss mark",slug:"kiss_mark",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💯":{name:"hundred points",slug:"hundred_points",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💢":{name:"anger symbol",slug:"anger_symbol",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💥":{name:"collision",slug:"collision",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💫":{name:"dizzy",slug:"dizzy",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💦":{name:"sweat droplets",slug:"sweat_droplets",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💨":{name:"dashing away",slug:"dashing_away",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕳️":{name:"hole",slug:"hole",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💬":{name:"speech balloon",slug:"speech_balloon",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👁️‍🗨️":{name:"eye in speech bubble",slug:"eye_in_speech_bubble",group:"Smileys & Emotion",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🗨️":{name:"left speech bubble",slug:"left_speech_bubble",group:"Smileys & Emotion",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🗯️":{name:"right anger bubble",slug:"right_anger_bubble",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💭":{name:"thought balloon",slug:"thought_balloon",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💤":{name:"ZZZ",slug:"zzz",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👋":{name:"waving hand",slug:"waving_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤚":{name:"raised back of hand",slug:"raised_back_of_hand",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🖐️":{name:"hand with fingers splayed",slug:"hand_with_fingers_splayed",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"✋":{name:"raised hand",slug:"raised_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🖖":{name:"vulcan salute",slug:"vulcan_salute",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🫱":{name:"rightwards hand",slug:"rightwards_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫲":{name:"leftwards hand",slug:"leftwards_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫳":{name:"palm down hand",slug:"palm_down_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫴":{name:"palm up hand",slug:"palm_up_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫷":{name:"leftwards pushing hand",slug:"leftwards_pushing_hand",group:"People & Body",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!0,skin_tone_support_unicode_version:"15.0"},"🫸":{name:"rightwards pushing hand",slug:"rightwards_pushing_hand",group:"People & Body",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!0,skin_tone_support_unicode_version:"15.0"},"👌":{name:"OK hand",slug:"ok_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤌":{name:"pinched fingers",slug:"pinched_fingers",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🤏":{name:"pinching hand",slug:"pinching_hand",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"✌️":{name:"victory hand",slug:"victory_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤞":{name:"crossed fingers",slug:"crossed_fingers",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🫰":{name:"hand with index finger and thumb crossed",slug:"hand_with_index_finger_and_thumb_crossed",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🤟":{name:"love-you gesture",slug:"love_you_gesture",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤘":{name:"sign of the horns",slug:"sign_of_the_horns",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤙":{name:"call me hand",slug:"call_me_hand",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"👈":{name:"backhand index pointing left",slug:"backhand_index_pointing_left",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👉":{name:"backhand index pointing right",slug:"backhand_index_pointing_right",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👆":{name:"backhand index pointing up",slug:"backhand_index_pointing_up",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🖕":{name:"middle finger",slug:"middle_finger",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👇":{name:"backhand index pointing down",slug:"backhand_index_pointing_down",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"☝️":{name:"index pointing up",slug:"index_pointing_up",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🫵":{name:"index pointing at the viewer",slug:"index_pointing_at_the_viewer",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"👍":{name:"thumbs up",slug:"thumbs_up",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👎":{name:"thumbs down",slug:"thumbs_down",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"✊":{name:"raised fist",slug:"raised_fist",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👊":{name:"oncoming fist",slug:"oncoming_fist",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤛":{name:"left-facing fist",slug:"left_facing_fist",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤜":{name:"right-facing fist",slug:"right_facing_fist",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"👏":{name:"clapping hands",slug:"clapping_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙌":{name:"raising hands",slug:"raising_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🫶":{name:"heart hands",slug:"heart_hands",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"👐":{name:"open hands",slug:"open_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤲":{name:"palms up together",slug:"palms_up_together",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤝":{name:"handshake",slug:"handshake",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🙏":{name:"folded hands",slug:"folded_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"✍️":{name:"writing hand",slug:"writing_hand",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💅":{name:"nail polish",slug:"nail_polish",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤳":{name:"selfie",slug:"selfie",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"💪":{name:"flexed biceps",slug:"flexed_biceps",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🦾":{name:"mechanical arm",slug:"mechanical_arm",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦿":{name:"mechanical leg",slug:"mechanical_leg",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦵":{name:"leg",slug:"leg",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦶":{name:"foot",slug:"foot",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👂":{name:"ear",slug:"ear",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🦻":{name:"ear with hearing aid",slug:"ear_with_hearing_aid",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👃":{name:"nose",slug:"nose",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧠":{name:"brain",slug:"brain",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🫀":{name:"anatomical heart",slug:"anatomical_heart",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🫁":{name:"lungs",slug:"lungs",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦷":{name:"tooth",slug:"tooth",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦴":{name:"bone",slug:"bone",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"👀":{name:"eyes",slug:"eyes",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👁️":{name:"eye",slug:"eye",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"👅":{name:"tongue",slug:"tongue",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👄":{name:"mouth",slug:"mouth",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫦":{name:"biting lip",slug:"biting_lip",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"👶":{name:"baby",slug:"baby",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧒":{name:"child",slug:"child",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👦":{name:"boy",slug:"boy",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👧":{name:"girl",slug:"girl",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧑":{name:"person",slug:"person",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👱":{name:"person blond hair",slug:"person_blond_hair",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👨":{name:"man",slug:"man",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧔":{name:"person beard",slug:"person_beard",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧔‍♂️":{name:"man beard",slug:"man_beard",group:"People & Body",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"🧔‍♀️":{name:"woman beard",slug:"woman_beard",group:"People & Body",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍🦰":{name:"man red hair",slug:"man_red_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👨‍🦱":{name:"man curly hair",slug:"man_curly_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👨‍🦳":{name:"man white hair",slug:"man_white_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👨‍🦲":{name:"man bald",slug:"man_bald",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👩":{name:"woman",slug:"woman",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👩‍🦰":{name:"woman red hair",slug:"woman_red_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦰":{name:"person red hair",slug:"person_red_hair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👩‍🦱":{name:"woman curly hair",slug:"woman_curly_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦱":{name:"person curly hair",slug:"person_curly_hair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👩‍🦳":{name:"woman white hair",slug:"woman_white_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦳":{name:"person white hair",slug:"person_white_hair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👩‍🦲":{name:"woman bald",slug:"woman_bald",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦲":{name:"person bald",slug:"person_bald",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👱‍♀️":{name:"woman blond hair",slug:"woman_blond_hair",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👱‍♂️":{name:"man blond hair",slug:"man_blond_hair",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧓":{name:"older person",slug:"older_person",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👴":{name:"old man",slug:"old_man",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👵":{name:"old woman",slug:"old_woman",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙍":{name:"person frowning",slug:"person_frowning",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙍‍♂️":{name:"man frowning",slug:"man_frowning",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙍‍♀️":{name:"woman frowning",slug:"woman_frowning",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙎":{name:"person pouting",slug:"person_pouting",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙎‍♂️":{name:"man pouting",slug:"man_pouting",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙎‍♀️":{name:"woman pouting",slug:"woman_pouting",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙅":{name:"person gesturing NO",slug:"person_gesturing_no",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙅‍♂️":{name:"man gesturing NO",slug:"man_gesturing_no",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙅‍♀️":{name:"woman gesturing NO",slug:"woman_gesturing_no",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙆":{name:"person gesturing OK",slug:"person_gesturing_ok",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙆‍♂️":{name:"man gesturing OK",slug:"man_gesturing_ok",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙆‍♀️":{name:"woman gesturing OK",slug:"woman_gesturing_ok",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💁":{name:"person tipping hand",slug:"person_tipping_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💁‍♂️":{name:"man tipping hand",slug:"man_tipping_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💁‍♀️":{name:"woman tipping hand",slug:"woman_tipping_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙋":{name:"person raising hand",slug:"person_raising_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙋‍♂️":{name:"man raising hand",slug:"man_raising_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙋‍♀️":{name:"woman raising hand",slug:"woman_raising_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧏":{name:"deaf person",slug:"deaf_person",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧏‍♂️":{name:"deaf man",slug:"deaf_man",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧏‍♀️":{name:"deaf woman",slug:"deaf_woman",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🙇":{name:"person bowing",slug:"person_bowing",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙇‍♂️":{name:"man bowing",slug:"man_bowing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙇‍♀️":{name:"woman bowing",slug:"woman_bowing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤦":{name:"person facepalming",slug:"person_facepalming",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤦‍♂️":{name:"man facepalming",slug:"man_facepalming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤦‍♀️":{name:"woman facepalming",slug:"woman_facepalming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤷":{name:"person shrugging",slug:"person_shrugging",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤷‍♂️":{name:"man shrugging",slug:"man_shrugging",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤷‍♀️":{name:"woman shrugging",slug:"woman_shrugging",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍⚕️":{name:"health worker",slug:"health_worker",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍⚕️":{name:"man health worker",slug:"man_health_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍⚕️":{name:"woman health worker",slug:"woman_health_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🎓":{name:"student",slug:"student",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🎓":{name:"man student",slug:"man_student",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🎓":{name:"woman student",slug:"woman_student",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🏫":{name:"teacher",slug:"teacher",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🏫":{name:"man teacher",slug:"man_teacher",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🏫":{name:"woman teacher",slug:"woman_teacher",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍⚖️":{name:"judge",slug:"judge",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍⚖️":{name:"man judge",slug:"man_judge",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍⚖️":{name:"woman judge",slug:"woman_judge",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🌾":{name:"farmer",slug:"farmer",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🌾":{name:"man farmer",slug:"man_farmer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🌾":{name:"woman farmer",slug:"woman_farmer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🍳":{name:"cook",slug:"cook",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🍳":{name:"man cook",slug:"man_cook",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🍳":{name:"woman cook",slug:"woman_cook",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🔧":{name:"mechanic",slug:"mechanic",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🔧":{name:"man mechanic",slug:"man_mechanic",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🔧":{name:"woman mechanic",slug:"woman_mechanic",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🏭":{name:"factory worker",slug:"factory_worker",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🏭":{name:"man factory worker",slug:"man_factory_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🏭":{name:"woman factory worker",slug:"woman_factory_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍💼":{name:"office worker",slug:"office_worker",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍💼":{name:"man office worker",slug:"man_office_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍💼":{name:"woman office worker",slug:"woman_office_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🔬":{name:"scientist",slug:"scientist",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🔬":{name:"man scientist",slug:"man_scientist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🔬":{name:"woman scientist",slug:"woman_scientist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍💻":{name:"technologist",slug:"technologist",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍💻":{name:"man technologist",slug:"man_technologist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍💻":{name:"woman technologist",slug:"woman_technologist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🎤":{name:"singer",slug:"singer",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🎤":{name:"man singer",slug:"man_singer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🎤":{name:"woman singer",slug:"woman_singer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🎨":{name:"artist",slug:"artist",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🎨":{name:"man artist",slug:"man_artist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🎨":{name:"woman artist",slug:"woman_artist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍✈️":{name:"pilot",slug:"pilot",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍✈️":{name:"man pilot",slug:"man_pilot",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍✈️":{name:"woman pilot",slug:"woman_pilot",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🚀":{name:"astronaut",slug:"astronaut",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🚀":{name:"man astronaut",slug:"man_astronaut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🚀":{name:"woman astronaut",slug:"woman_astronaut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🚒":{name:"firefighter",slug:"firefighter",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🚒":{name:"man firefighter",slug:"man_firefighter",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🚒":{name:"woman firefighter",slug:"woman_firefighter",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👮":{name:"police officer",slug:"police_officer",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👮‍♂️":{name:"man police officer",slug:"man_police_officer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👮‍♀️":{name:"woman police officer",slug:"woman_police_officer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🕵️":{name:"detective",slug:"detective",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"2.0"},"🕵️‍♂️":{name:"man detective",slug:"man_detective",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🕵️‍♀️":{name:"woman detective",slug:"woman_detective",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💂":{name:"guard",slug:"guard",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💂‍♂️":{name:"man guard",slug:"man_guard",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💂‍♀️":{name:"woman guard",slug:"woman_guard",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🥷":{name:"ninja",slug:"ninja",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👷":{name:"construction worker",slug:"construction_worker",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👷‍♂️":{name:"man construction worker",slug:"man_construction_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👷‍♀️":{name:"woman construction worker",slug:"woman_construction_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🫅":{name:"person with crown",slug:"person_with_crown",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🤴":{name:"prince",slug:"prince",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"👸":{name:"princess",slug:"princess",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👳":{name:"person wearing turban",slug:"person_wearing_turban",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👳‍♂️":{name:"man wearing turban",slug:"man_wearing_turban",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👳‍♀️":{name:"woman wearing turban",slug:"woman_wearing_turban",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👲":{name:"person with skullcap",slug:"person_with_skullcap",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧕":{name:"woman with headscarf",slug:"woman_with_headscarf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤵":{name:"person in tuxedo",slug:"person_in_tuxedo",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤵‍♂️":{name:"man in tuxedo",slug:"man_in_tuxedo",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🤵‍♀️":{name:"woman in tuxedo",slug:"woman_in_tuxedo",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👰":{name:"person with veil",slug:"person_with_veil",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👰‍♂️":{name:"man with veil",slug:"man_with_veil",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👰‍♀️":{name:"woman with veil",slug:"woman_with_veil",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🤰":{name:"pregnant woman",slug:"pregnant_woman",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🫃":{name:"pregnant man",slug:"pregnant_man",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫄":{name:"pregnant person",slug:"pregnant_person",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🤱":{name:"breast-feeding",slug:"breast_feeding",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👩‍🍼":{name:"woman feeding baby",slug:"woman_feeding_baby",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👨‍🍼":{name:"man feeding baby",slug:"man_feeding_baby",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🧑‍🍼":{name:"person feeding baby",slug:"person_feeding_baby",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👼":{name:"baby angel",slug:"baby_angel",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🎅":{name:"Santa Claus",slug:"santa_claus",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤶":{name:"Mrs. Claus",slug:"mrs_claus",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🧑‍🎄":{name:"Mx Claus",slug:"mx_claus",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🦸":{name:"superhero",slug:"superhero",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦸‍♂️":{name:"man superhero",slug:"man_superhero",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦸‍♀️":{name:"woman superhero",slug:"woman_superhero",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦹":{name:"supervillain",slug:"supervillain",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦹‍♂️":{name:"man supervillain",slug:"man_supervillain",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦹‍♀️":{name:"woman supervillain",slug:"woman_supervillain",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧙":{name:"mage",slug:"mage",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧙‍♂️":{name:"man mage",slug:"man_mage",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧙‍♀️":{name:"woman mage",slug:"woman_mage",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧚":{name:"fairy",slug:"fairy",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧚‍♂️":{name:"man fairy",slug:"man_fairy",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧚‍♀️":{name:"woman fairy",slug:"woman_fairy",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧛":{name:"vampire",slug:"vampire",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧛‍♂️":{name:"man vampire",slug:"man_vampire",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧛‍♀️":{name:"woman vampire",slug:"woman_vampire",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧜":{name:"merperson",slug:"merperson",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧜‍♂️":{name:"merman",slug:"merman",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧜‍♀️":{name:"mermaid",slug:"mermaid",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧝":{name:"elf",slug:"elf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧝‍♂️":{name:"man elf",slug:"man_elf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧝‍♀️":{name:"woman elf",slug:"woman_elf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧞":{name:"genie",slug:"genie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧞‍♂️":{name:"man genie",slug:"man_genie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧞‍♀️":{name:"woman genie",slug:"woman_genie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧟":{name:"zombie",slug:"zombie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧟‍♂️":{name:"man zombie",slug:"man_zombie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧟‍♀️":{name:"woman zombie",slug:"woman_zombie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧌":{name:"troll",slug:"troll",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"💆":{name:"person getting massage",slug:"person_getting_massage",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💆‍♂️":{name:"man getting massage",slug:"man_getting_massage",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💆‍♀️":{name:"woman getting massage",slug:"woman_getting_massage",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💇":{name:"person getting haircut",slug:"person_getting_haircut",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💇‍♂️":{name:"man getting haircut",slug:"man_getting_haircut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💇‍♀️":{name:"woman getting haircut",slug:"woman_getting_haircut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚶":{name:"person walking",slug:"person_walking",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚶‍♂️":{name:"man walking",slug:"man_walking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚶‍♀️":{name:"woman walking",slug:"woman_walking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚶‍➡️":{name:"person walking facing right",slug:"person_walking_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🚶‍♀️‍➡️":{name:"woman walking facing right",slug:"woman_walking_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🚶‍♂️‍➡️":{name:"man walking facing right",slug:"man_walking_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧍":{name:"person standing",slug:"person_standing",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧍‍♂️":{name:"man standing",slug:"man_standing",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧍‍♀️":{name:"woman standing",slug:"woman_standing",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎":{name:"person kneeling",slug:"person_kneeling",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎‍♂️":{name:"man kneeling",slug:"man_kneeling",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎‍♀️":{name:"woman kneeling",slug:"woman_kneeling",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎‍➡️":{name:"person kneeling facing right",slug:"person_kneeling_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧎‍♀️‍➡️":{name:"woman kneeling facing right",slug:"woman_kneeling_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧎‍♂️‍➡️":{name:"man kneeling facing right",slug:"man_kneeling_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧑‍🦯":{name:"person with white cane",slug:"person_with_white_cane",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"🧑‍🦯‍➡️":{name:"person with white cane facing right",slug:"person_with_white_cane_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👨‍🦯":{name:"man with white cane",slug:"man_with_white_cane",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👨‍🦯‍➡️":{name:"man with white cane facing right",slug:"man_with_white_cane_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👩‍🦯":{name:"woman with white cane",slug:"woman_with_white_cane",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👩‍🦯‍➡️":{name:"woman with white cane facing right",slug:"woman_with_white_cane_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧑‍🦼":{name:"person in motorized wheelchair",slug:"person_in_motorized_wheelchair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"🧑‍🦼‍➡️":{name:"person in motorized wheelchair facing right",slug:"person_in_motorized_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👨‍🦼":{name:"man in motorized wheelchair",slug:"man_in_motorized_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👨‍🦼‍➡️":{name:"man in motorized wheelchair facing right",slug:"man_in_motorized_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👩‍🦼":{name:"woman in motorized wheelchair",slug:"woman_in_motorized_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👩‍🦼‍➡️":{name:"woman in motorized wheelchair facing right",slug:"woman_in_motorized_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧑‍🦽":{name:"person in manual wheelchair",slug:"person_in_manual_wheelchair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"🧑‍🦽‍➡️":{name:"person in manual wheelchair facing right",slug:"person_in_manual_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👨‍🦽":{name:"man in manual wheelchair",slug:"man_in_manual_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👨‍🦽‍➡️":{name:"man in manual wheelchair facing right",slug:"man_in_manual_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👩‍🦽":{name:"woman in manual wheelchair",slug:"woman_in_manual_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👩‍🦽‍➡️":{name:"woman in manual wheelchair facing right",slug:"woman_in_manual_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🏃":{name:"person running",slug:"person_running",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏃‍♂️":{name:"man running",slug:"man_running",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏃‍♀️":{name:"woman running",slug:"woman_running",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏃‍➡️":{name:"person running facing right",slug:"person_running_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🏃‍♀️‍➡️":{name:"woman running facing right",slug:"woman_running_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🏃‍♂️‍➡️":{name:"man running facing right",slug:"man_running_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"💃":{name:"woman dancing",slug:"woman_dancing",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🕺":{name:"man dancing",slug:"man_dancing",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🕴️":{name:"person in suit levitating",slug:"person_in_suit_levitating",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👯":{name:"people with bunny ears",slug:"people_with_bunny_ears",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👯‍♂️":{name:"men with bunny ears",slug:"men_with_bunny_ears",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👯‍♀️":{name:"women with bunny ears",slug:"women_with_bunny_ears",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🧖":{name:"person in steamy room",slug:"person_in_steamy_room",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧖‍♂️":{name:"man in steamy room",slug:"man_in_steamy_room",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧖‍♀️":{name:"woman in steamy room",slug:"woman_in_steamy_room",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧗":{name:"person climbing",slug:"person_climbing",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧗‍♂️":{name:"man climbing",slug:"man_climbing",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧗‍♀️":{name:"woman climbing",slug:"woman_climbing",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤺":{name:"person fencing",slug:"person_fencing",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🏇":{name:"horse racing",slug:"horse_racing",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"⛷️":{name:"skier",slug:"skier",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏂":{name:"snowboarder",slug:"snowboarder",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏌️":{name:"person golfing",slug:"person_golfing",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏌️‍♂️":{name:"man golfing",slug:"man_golfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏌️‍♀️":{name:"woman golfing",slug:"woman_golfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏄":{name:"person surfing",slug:"person_surfing",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏄‍♂️":{name:"man surfing",slug:"man_surfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏄‍♀️":{name:"woman surfing",slug:"woman_surfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚣":{name:"person rowing boat",slug:"person_rowing_boat",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚣‍♂️":{name:"man rowing boat",slug:"man_rowing_boat",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚣‍♀️":{name:"woman rowing boat",slug:"woman_rowing_boat",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏊":{name:"person swimming",slug:"person_swimming",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏊‍♂️":{name:"man swimming",slug:"man_swimming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏊‍♀️":{name:"woman swimming",slug:"woman_swimming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"⛹️":{name:"person bouncing ball",slug:"person_bouncing_ball",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"2.0"},"⛹️‍♂️":{name:"man bouncing ball",slug:"man_bouncing_ball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"⛹️‍♀️":{name:"woman bouncing ball",slug:"woman_bouncing_ball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏋️":{name:"person lifting weights",slug:"person_lifting_weights",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"2.0"},"🏋️‍♂️":{name:"man lifting weights",slug:"man_lifting_weights",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏋️‍♀️":{name:"woman lifting weights",slug:"woman_lifting_weights",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚴":{name:"person biking",slug:"person_biking",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚴‍♂️":{name:"man biking",slug:"man_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚴‍♀️":{name:"woman biking",slug:"woman_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚵":{name:"person mountain biking",slug:"person_mountain_biking",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚵‍♂️":{name:"man mountain biking",slug:"man_mountain_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚵‍♀️":{name:"woman mountain biking",slug:"woman_mountain_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤸":{name:"person cartwheeling",slug:"person_cartwheeling",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤸‍♂️":{name:"man cartwheeling",slug:"man_cartwheeling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤸‍♀️":{name:"woman cartwheeling",slug:"woman_cartwheeling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤼":{name:"people wrestling",slug:"people_wrestling",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🤼‍♂️":{name:"men wrestling",slug:"men_wrestling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🤼‍♀️":{name:"women wrestling",slug:"women_wrestling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🤽":{name:"person playing water polo",slug:"person_playing_water_polo",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤽‍♂️":{name:"man playing water polo",slug:"man_playing_water_polo",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤽‍♀️":{name:"woman playing water polo",slug:"woman_playing_water_polo",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤾":{name:"person playing handball",slug:"person_playing_handball",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤾‍♂️":{name:"man playing handball",slug:"man_playing_handball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤾‍♀️":{name:"woman playing handball",slug:"woman_playing_handball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤹":{name:"person juggling",slug:"person_juggling",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤹‍♂️":{name:"man juggling",slug:"man_juggling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤹‍♀️":{name:"woman juggling",slug:"woman_juggling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧘":{name:"person in lotus position",slug:"person_in_lotus_position",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧘‍♂️":{name:"man in lotus position",slug:"man_in_lotus_position",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧘‍♀️":{name:"woman in lotus position",slug:"woman_in_lotus_position",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🛀":{name:"person taking bath",slug:"person_taking_bath",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🛌":{name:"person in bed",slug:"person_in_bed",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🤝‍🧑":{name:"people holding hands",slug:"people_holding_hands",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👭":{name:"women holding hands",slug:"women_holding_hands",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👫":{name:"woman and man holding hands",slug:"woman_and_man_holding_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👬":{name:"men holding hands",slug:"men_holding_hands",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"💏":{name:"kiss",slug:"kiss",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍💋‍👨":{name:"kiss woman, man",slug:"kiss_woman_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍❤️‍💋‍👨":{name:"kiss man, man",slug:"kiss_man_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍💋‍👩":{name:"kiss woman, woman",slug:"kiss_woman_woman",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"💑":{name:"couple with heart",slug:"couple_with_heart",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍👨":{name:"couple with heart woman, man",slug:"couple_with_heart_woman_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍❤️‍👨":{name:"couple with heart man, man",slug:"couple_with_heart_man_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍👩":{name:"couple with heart woman, woman",slug:"couple_with_heart_woman_woman",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍👩‍👦":{name:"family man, woman, boy",slug:"family_man_woman_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👧":{name:"family man, woman, girl",slug:"family_man_woman_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👧‍👦":{name:"family man, woman, girl, boy",slug:"family_man_woman_girl_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👦‍👦":{name:"family man, woman, boy, boy",slug:"family_man_woman_boy_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👧‍👧":{name:"family man, woman, girl, girl",slug:"family_man_woman_girl_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👦":{name:"family man, man, boy",slug:"family_man_man_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👧":{name:"family man, man, girl",slug:"family_man_man_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👧‍👦":{name:"family man, man, girl, boy",slug:"family_man_man_girl_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👦‍👦":{name:"family man, man, boy, boy",slug:"family_man_man_boy_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👧‍👧":{name:"family man, man, girl, girl",slug:"family_man_man_girl_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👦":{name:"family woman, woman, boy",slug:"family_woman_woman_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👧":{name:"family woman, woman, girl",slug:"family_woman_woman_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👧‍👦":{name:"family woman, woman, girl, boy",slug:"family_woman_woman_girl_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👦‍👦":{name:"family woman, woman, boy, boy",slug:"family_woman_woman_boy_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👧‍👧":{name:"family woman, woman, girl, girl",slug:"family_woman_woman_girl_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👦":{name:"family man, boy",slug:"family_man_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👦‍👦":{name:"family man, boy, boy",slug:"family_man_boy_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👧":{name:"family man, girl",slug:"family_man_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👧‍👦":{name:"family man, girl, boy",slug:"family_man_girl_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👧‍👧":{name:"family man, girl, girl",slug:"family_man_girl_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👦":{name:"family woman, boy",slug:"family_woman_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👦‍👦":{name:"family woman, boy, boy",slug:"family_woman_boy_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👧":{name:"family woman, girl",slug:"family_woman_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👧‍👦":{name:"family woman, girl, boy",slug:"family_woman_girl_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👧‍👧":{name:"family woman, girl, girl",slug:"family_woman_girl_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🗣️":{name:"speaking head",slug:"speaking_head",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"👤":{name:"bust in silhouette",slug:"bust_in_silhouette",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👥":{name:"busts in silhouette",slug:"busts_in_silhouette",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫂":{name:"people hugging",slug:"people_hugging",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"👪":{name:"family",slug:"family",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧑‍🧑‍🧒":{name:"family adult, adult, child",slug:"family_adult_adult_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🧑‍🧑‍🧒‍🧒":{name:"family adult, adult, child, child",slug:"family_adult_adult_child_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🧑‍🧒":{name:"family adult, child",slug:"family_adult_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🧑‍🧒‍🧒":{name:"family adult, child, child",slug:"family_adult_child_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"👣":{name:"footprints",slug:"footprints",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫆":{name:"fingerprint",slug:"fingerprint",group:"People & Body",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🐵":{name:"monkey face",slug:"monkey_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐒":{name:"monkey",slug:"monkey",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦍":{name:"gorilla",slug:"gorilla",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦧":{name:"orangutan",slug:"orangutan",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐶":{name:"dog face",slug:"dog_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐕":{name:"dog",slug:"dog",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦮":{name:"guide dog",slug:"guide_dog",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐕‍🦺":{name:"service dog",slug:"service_dog",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐩":{name:"poodle",slug:"poodle",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐺":{name:"wolf",slug:"wolf",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦊":{name:"fox",slug:"fox",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦝":{name:"raccoon",slug:"raccoon",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🐱":{name:"cat face",slug:"cat_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐈":{name:"cat",slug:"cat",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🐈‍⬛":{name:"black cat",slug:"black_cat",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦁":{name:"lion",slug:"lion",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐯":{name:"tiger face",slug:"tiger_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐅":{name:"tiger",slug:"tiger",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐆":{name:"leopard",slug:"leopard",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐴":{name:"horse face",slug:"horse_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫎":{name:"moose",slug:"moose",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🫏":{name:"donkey",slug:"donkey",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🐎":{name:"horse",slug:"horse",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦄":{name:"unicorn",slug:"unicorn",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦓":{name:"zebra",slug:"zebra",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🦌":{name:"deer",slug:"deer",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦬":{name:"bison",slug:"bison",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐮":{name:"cow face",slug:"cow_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐂":{name:"ox",slug:"ox",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐃":{name:"water buffalo",slug:"water_buffalo",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐄":{name:"cow",slug:"cow",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐷":{name:"pig face",slug:"pig_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐖":{name:"pig",slug:"pig",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐗":{name:"boar",slug:"boar",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐽":{name:"pig nose",slug:"pig_nose",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐏":{name:"ram",slug:"ram",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐑":{name:"ewe",slug:"ewe",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐐":{name:"goat",slug:"goat",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐪":{name:"camel",slug:"camel",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐫":{name:"two-hump camel",slug:"two_hump_camel",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦙":{name:"llama",slug:"llama",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦒":{name:"giraffe",slug:"giraffe",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🐘":{name:"elephant",slug:"elephant",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦣":{name:"mammoth",slug:"mammoth",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦏":{name:"rhinoceros",slug:"rhinoceros",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦛":{name:"hippopotamus",slug:"hippopotamus",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🐭":{name:"mouse face",slug:"mouse_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐁":{name:"mouse",slug:"mouse",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐀":{name:"rat",slug:"rat",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐹":{name:"hamster",slug:"hamster",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐰":{name:"rabbit face",slug:"rabbit_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐇":{name:"rabbit",slug:"rabbit",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐿️":{name:"chipmunk",slug:"chipmunk",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦫":{name:"beaver",slug:"beaver",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦔":{name:"hedgehog",slug:"hedgehog",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🦇":{name:"bat",slug:"bat",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐻":{name:"bear",slug:"bear",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐻‍❄️":{name:"polar bear",slug:"polar_bear",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐨":{name:"koala",slug:"koala",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐼":{name:"panda",slug:"panda",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦥":{name:"sloth",slug:"sloth",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦦":{name:"otter",slug:"otter",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦨":{name:"skunk",slug:"skunk",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦘":{name:"kangaroo",slug:"kangaroo",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦡":{name:"badger",slug:"badger",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🐾":{name:"paw prints",slug:"paw_prints",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦃":{name:"turkey",slug:"turkey",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐔":{name:"chicken",slug:"chicken",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐓":{name:"rooster",slug:"rooster",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐣":{name:"hatching chick",slug:"hatching_chick",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐤":{name:"baby chick",slug:"baby_chick",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐥":{name:"front-facing baby chick",slug:"front_facing_baby_chick",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐦":{name:"bird",slug:"bird",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐧":{name:"penguin",slug:"penguin",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕊️":{name:"dove",slug:"dove",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦅":{name:"eagle",slug:"eagle",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦆":{name:"duck",slug:"duck",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦢":{name:"swan",slug:"swan",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦉":{name:"owl",slug:"owl",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦤":{name:"dodo",slug:"dodo",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪶":{name:"feather",slug:"feather",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦩":{name:"flamingo",slug:"flamingo",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦚":{name:"peacock",slug:"peacock",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦜":{name:"parrot",slug:"parrot",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪽":{name:"wing",slug:"wing",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🐦‍⬛":{name:"black bird",slug:"black_bird",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🪿":{name:"goose",slug:"goose",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🐦‍🔥":{name:"phoenix",slug:"phoenix",group:"Animals & Nature",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🐸":{name:"frog",slug:"frog",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐊":{name:"crocodile",slug:"crocodile",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐢":{name:"turtle",slug:"turtle",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦎":{name:"lizard",slug:"lizard",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐍":{name:"snake",slug:"snake",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐲":{name:"dragon face",slug:"dragon_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐉":{name:"dragon",slug:"dragon",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦕":{name:"sauropod",slug:"sauropod",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🦖":{name:"T-Rex",slug:"t_rex",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🐳":{name:"spouting whale",slug:"spouting_whale",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐋":{name:"whale",slug:"whale",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐬":{name:"dolphin",slug:"dolphin",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦭":{name:"seal",slug:"seal",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐟":{name:"fish",slug:"fish",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐠":{name:"tropical fish",slug:"tropical_fish",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐡":{name:"blowfish",slug:"blowfish",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦈":{name:"shark",slug:"shark",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐙":{name:"octopus",slug:"octopus",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐚":{name:"spiral shell",slug:"spiral_shell",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪸":{name:"coral",slug:"coral",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪼":{name:"jellyfish",slug:"jellyfish",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🦀":{name:"crab",slug:"crab",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦞":{name:"lobster",slug:"lobster",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦐":{name:"shrimp",slug:"shrimp",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦑":{name:"squid",slug:"squid",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦪":{name:"oyster",slug:"oyster",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐌":{name:"snail",slug:"snail",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦋":{name:"butterfly",slug:"butterfly",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐛":{name:"bug",slug:"bug",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐜":{name:"ant",slug:"ant",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐝":{name:"honeybee",slug:"honeybee",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪲":{name:"beetle",slug:"beetle",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐞":{name:"lady beetle",slug:"lady_beetle",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦗":{name:"cricket",slug:"cricket",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🪳":{name:"cockroach",slug:"cockroach",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🕷️":{name:"spider",slug:"spider",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕸️":{name:"spider web",slug:"spider_web",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦂":{name:"scorpion",slug:"scorpion",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦟":{name:"mosquito",slug:"mosquito",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪰":{name:"fly",slug:"fly",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪱":{name:"worm",slug:"worm",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦠":{name:"microbe",slug:"microbe",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"💐":{name:"bouquet",slug:"bouquet",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌸":{name:"cherry blossom",slug:"cherry_blossom",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💮":{name:"white flower",slug:"white_flower",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪷":{name:"lotus",slug:"lotus",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🏵️":{name:"rosette",slug:"rosette",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌹":{name:"rose",slug:"rose",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥀":{name:"wilted flower",slug:"wilted_flower",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🌺":{name:"hibiscus",slug:"hibiscus",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌻":{name:"sunflower",slug:"sunflower",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌼":{name:"blossom",slug:"blossom",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌷":{name:"tulip",slug:"tulip",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪻":{name:"hyacinth",slug:"hyacinth",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🌱":{name:"seedling",slug:"seedling",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪴":{name:"potted plant",slug:"potted_plant",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🌲":{name:"evergreen tree",slug:"evergreen_tree",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌳":{name:"deciduous tree",slug:"deciduous_tree",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌴":{name:"palm tree",slug:"palm_tree",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌵":{name:"cactus",slug:"cactus",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌾":{name:"sheaf of rice",slug:"sheaf_of_rice",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌿":{name:"herb",slug:"herb",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☘️":{name:"shamrock",slug:"shamrock",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍀":{name:"four leaf clover",slug:"four_leaf_clover",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍁":{name:"maple leaf",slug:"maple_leaf",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍂":{name:"fallen leaf",slug:"fallen_leaf",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍃":{name:"leaf fluttering in wind",slug:"leaf_fluttering_in_wind",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪹":{name:"empty nest",slug:"empty_nest",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪺":{name:"nest with eggs",slug:"nest_with_eggs",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🍄":{name:"mushroom",slug:"mushroom",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪾":{name:"leafless tree",slug:"leafless_tree",group:"Animals & Nature",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🍇":{name:"grapes",slug:"grapes",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍈":{name:"melon",slug:"melon",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍉":{name:"watermelon",slug:"watermelon",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍊":{name:"tangerine",slug:"tangerine",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍋":{name:"lemon",slug:"lemon",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍋‍🟩":{name:"lime",slug:"lime",group:"Food & Drink",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🍌":{name:"banana",slug:"banana",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍍":{name:"pineapple",slug:"pineapple",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥭":{name:"mango",slug:"mango",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🍎":{name:"red apple",slug:"red_apple",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍏":{name:"green apple",slug:"green_apple",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍐":{name:"pear",slug:"pear",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍑":{name:"peach",slug:"peach",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍒":{name:"cherries",slug:"cherries",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍓":{name:"strawberry",slug:"strawberry",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫐":{name:"blueberries",slug:"blueberries",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥝":{name:"kiwi fruit",slug:"kiwi_fruit",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍅":{name:"tomato",slug:"tomato",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫒":{name:"olive",slug:"olive",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥥":{name:"coconut",slug:"coconut",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥑":{name:"avocado",slug:"avocado",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍆":{name:"eggplant",slug:"eggplant",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥔":{name:"potato",slug:"potato",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥕":{name:"carrot",slug:"carrot",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🌽":{name:"ear of corn",slug:"ear_of_corn",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌶️":{name:"hot pepper",slug:"hot_pepper",group:"Food & Drink",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🫑":{name:"bell pepper",slug:"bell_pepper",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥒":{name:"cucumber",slug:"cucumber",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥬":{name:"leafy green",slug:"leafy_green",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥦":{name:"broccoli",slug:"broccoli",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧄":{name:"garlic",slug:"garlic",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧅":{name:"onion",slug:"onion",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥜":{name:"peanuts",slug:"peanuts",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫘":{name:"beans",slug:"beans",group:"Food & Drink",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🌰":{name:"chestnut",slug:"chestnut",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫚":{name:"ginger root",slug:"ginger_root",group:"Food & Drink",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🫛":{name:"pea pod",slug:"pea_pod",group:"Food & Drink",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🍄‍🟫":{name:"brown mushroom",slug:"brown_mushroom",group:"Food & Drink",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🫜":{name:"root vegetable",slug:"root_vegetable",group:"Food & Drink",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🍞":{name:"bread",slug:"bread",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥐":{name:"croissant",slug:"croissant",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥖":{name:"baguette bread",slug:"baguette_bread",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫓":{name:"flatbread",slug:"flatbread",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥨":{name:"pretzel",slug:"pretzel",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥯":{name:"bagel",slug:"bagel",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥞":{name:"pancakes",slug:"pancakes",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🧇":{name:"waffle",slug:"waffle",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧀":{name:"cheese wedge",slug:"cheese_wedge",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍖":{name:"meat on bone",slug:"meat_on_bone",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍗":{name:"poultry leg",slug:"poultry_leg",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥩":{name:"cut of meat",slug:"cut_of_meat",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥓":{name:"bacon",slug:"bacon",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍔":{name:"hamburger",slug:"hamburger",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍟":{name:"french fries",slug:"french_fries",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍕":{name:"pizza",slug:"pizza",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌭":{name:"hot dog",slug:"hot_dog",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥪":{name:"sandwich",slug:"sandwich",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🌮":{name:"taco",slug:"taco",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌯":{name:"burrito",slug:"burrito",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫔":{name:"tamale",slug:"tamale",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥙":{name:"stuffed flatbread",slug:"stuffed_flatbread",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🧆":{name:"falafel",slug:"falafel",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥚":{name:"egg",slug:"egg",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍳":{name:"cooking",slug:"cooking",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥘":{name:"shallow pan of food",slug:"shallow_pan_of_food",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍲":{name:"pot of food",slug:"pot_of_food",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫕":{name:"fondue",slug:"fondue",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥣":{name:"bowl with spoon",slug:"bowl_with_spoon",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥗":{name:"green salad",slug:"green_salad",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍿":{name:"popcorn",slug:"popcorn",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧈":{name:"butter",slug:"butter",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧂":{name:"salt",slug:"salt",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥫":{name:"canned food",slug:"canned_food",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍱":{name:"bento box",slug:"bento_box",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍘":{name:"rice cracker",slug:"rice_cracker",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍙":{name:"rice ball",slug:"rice_ball",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍚":{name:"cooked rice",slug:"cooked_rice",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍛":{name:"curry rice",slug:"curry_rice",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍜":{name:"steaming bowl",slug:"steaming_bowl",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍝":{name:"spaghetti",slug:"spaghetti",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍠":{name:"roasted sweet potato",slug:"roasted_sweet_potato",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍢":{name:"oden",slug:"oden",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍣":{name:"sushi",slug:"sushi",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍤":{name:"fried shrimp",slug:"fried_shrimp",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍥":{name:"fish cake with swirl",slug:"fish_cake_with_swirl",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥮":{name:"moon cake",slug:"moon_cake",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🍡":{name:"dango",slug:"dango",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥟":{name:"dumpling",slug:"dumpling",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥠":{name:"fortune cookie",slug:"fortune_cookie",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥡":{name:"takeout box",slug:"takeout_box",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍦":{name:"soft ice cream",slug:"soft_ice_cream",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍧":{name:"shaved ice",slug:"shaved_ice",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍨":{name:"ice cream",slug:"ice_cream",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍩":{name:"doughnut",slug:"doughnut",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍪":{name:"cookie",slug:"cookie",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎂":{name:"birthday cake",slug:"birthday_cake",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍰":{name:"shortcake",slug:"shortcake",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧁":{name:"cupcake",slug:"cupcake",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥧":{name:"pie",slug:"pie",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍫":{name:"chocolate bar",slug:"chocolate_bar",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍬":{name:"candy",slug:"candy",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍭":{name:"lollipop",slug:"lollipop",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍮":{name:"custard",slug:"custard",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍯":{name:"honey pot",slug:"honey_pot",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍼":{name:"baby bottle",slug:"baby_bottle",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥛":{name:"glass of milk",slug:"glass_of_milk",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"☕":{name:"hot beverage",slug:"hot_beverage",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫖":{name:"teapot",slug:"teapot",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🍵":{name:"teacup without handle",slug:"teacup_without_handle",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍶":{name:"sake",slug:"sake",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍾":{name:"bottle with popping cork",slug:"bottle_with_popping_cork",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍷":{name:"wine glass",slug:"wine_glass",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍸":{name:"cocktail glass",slug:"cocktail_glass",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍹":{name:"tropical drink",slug:"tropical_drink",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍺":{name:"beer mug",slug:"beer_mug",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍻":{name:"clinking beer mugs",slug:"clinking_beer_mugs",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥂":{name:"clinking glasses",slug:"clinking_glasses",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥃":{name:"tumbler glass",slug:"tumbler_glass",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫗":{name:"pouring liquid",slug:"pouring_liquid",group:"Food & Drink",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🥤":{name:"cup with straw",slug:"cup_with_straw",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧋":{name:"bubble tea",slug:"bubble_tea",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧃":{name:"beverage box",slug:"beverage_box",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧉":{name:"mate",slug:"mate",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧊":{name:"ice",slug:"ice",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥢":{name:"chopsticks",slug:"chopsticks",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍽️":{name:"fork and knife with plate",slug:"fork_and_knife_with_plate",group:"Food & Drink",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🍴":{name:"fork and knife",slug:"fork_and_knife",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥄":{name:"spoon",slug:"spoon",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🔪":{name:"kitchen knife",slug:"kitchen_knife",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫙":{name:"jar",slug:"jar",group:"Food & Drink",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🏺":{name:"amphora",slug:"amphora",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌍":{name:"globe showing Europe-Africa",slug:"globe_showing_europe_africa",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌎":{name:"globe showing Americas",slug:"globe_showing_americas",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌏":{name:"globe showing Asia-Australia",slug:"globe_showing_asia_australia",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌐":{name:"globe with meridians",slug:"globe_with_meridians",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🗺️":{name:"world map",slug:"world_map",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗾":{name:"map of Japan",slug:"map_of_japan",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧭":{name:"compass",slug:"compass",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🏔️":{name:"snow-capped mountain",slug:"snow_capped_mountain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛰️":{name:"mountain",slug:"mountain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌋":{name:"volcano",slug:"volcano",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗻":{name:"mount fuji",slug:"mount_fuji",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏕️":{name:"camping",slug:"camping",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏖️":{name:"beach with umbrella",slug:"beach_with_umbrella",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏜️":{name:"desert",slug:"desert",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏝️":{name:"desert island",slug:"desert_island",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏞️":{name:"national park",slug:"national_park",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏟️":{name:"stadium",slug:"stadium",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏛️":{name:"classical building",slug:"classical_building",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏗️":{name:"building construction",slug:"building_construction",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🧱":{name:"brick",slug:"brick",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪨":{name:"rock",slug:"rock",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪵":{name:"wood",slug:"wood",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🛖":{name:"hut",slug:"hut",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🏘️":{name:"houses",slug:"houses",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏚️":{name:"derelict house",slug:"derelict_house",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏠":{name:"house",slug:"house",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏡":{name:"house with garden",slug:"house_with_garden",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏢":{name:"office building",slug:"office_building",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏣":{name:"Japanese post office",slug:"japanese_post_office",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏤":{name:"post office",slug:"post_office",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏥":{name:"hospital",slug:"hospital",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏦":{name:"bank",slug:"bank",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏨":{name:"hotel",slug:"hotel",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏩":{name:"love hotel",slug:"love_hotel",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏪":{name:"convenience store",slug:"convenience_store",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏫":{name:"school",slug:"school",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏬":{name:"department store",slug:"department_store",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏭":{name:"factory",slug:"factory",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏯":{name:"Japanese castle",slug:"japanese_castle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏰":{name:"castle",slug:"castle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💒":{name:"wedding",slug:"wedding",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗼":{name:"Tokyo tower",slug:"tokyo_tower",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗽":{name:"Statue of Liberty",slug:"statue_of_liberty",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛪":{name:"church",slug:"church",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕌":{name:"mosque",slug:"mosque",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛕":{name:"hindu temple",slug:"hindu_temple",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🕍":{name:"synagogue",slug:"synagogue",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⛩️":{name:"shinto shrine",slug:"shinto_shrine",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕋":{name:"kaaba",slug:"kaaba",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⛲":{name:"fountain",slug:"fountain",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛺":{name:"tent",slug:"tent",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌁":{name:"foggy",slug:"foggy",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌃":{name:"night with stars",slug:"night_with_stars",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏙️":{name:"cityscape",slug:"cityscape",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌄":{name:"sunrise over mountains",slug:"sunrise_over_mountains",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌅":{name:"sunrise",slug:"sunrise",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌆":{name:"cityscape at dusk",slug:"cityscape_at_dusk",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌇":{name:"sunset",slug:"sunset",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌉":{name:"bridge at night",slug:"bridge_at_night",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♨️":{name:"hot springs",slug:"hot_springs",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎠":{name:"carousel horse",slug:"carousel_horse",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛝":{name:"playground slide",slug:"playground_slide",group:"Travel & Places",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🎡":{name:"ferris wheel",slug:"ferris_wheel",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎢":{name:"roller coaster",slug:"roller_coaster",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💈":{name:"barber pole",slug:"barber_pole",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎪":{name:"circus tent",slug:"circus_tent",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚂":{name:"locomotive",slug:"locomotive",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚃":{name:"railway car",slug:"railway_car",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚄":{name:"high-speed train",slug:"high_speed_train",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚅":{name:"bullet train",slug:"bullet_train",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚆":{name:"train",slug:"train",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚇":{name:"metro",slug:"metro",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚈":{name:"light rail",slug:"light_rail",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚉":{name:"station",slug:"station",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚊":{name:"tram",slug:"tram",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚝":{name:"monorail",slug:"monorail",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚞":{name:"mountain railway",slug:"mountain_railway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚋":{name:"tram car",slug:"tram_car",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚌":{name:"bus",slug:"bus",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚍":{name:"oncoming bus",slug:"oncoming_bus",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚎":{name:"trolleybus",slug:"trolleybus",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚐":{name:"minibus",slug:"minibus",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚑":{name:"ambulance",slug:"ambulance",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚒":{name:"fire engine",slug:"fire_engine",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚓":{name:"police car",slug:"police_car",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚔":{name:"oncoming police car",slug:"oncoming_police_car",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚕":{name:"taxi",slug:"taxi",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚖":{name:"oncoming taxi",slug:"oncoming_taxi",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚗":{name:"automobile",slug:"automobile",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚘":{name:"oncoming automobile",slug:"oncoming_automobile",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚙":{name:"sport utility vehicle",slug:"sport_utility_vehicle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛻":{name:"pickup truck",slug:"pickup_truck",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🚚":{name:"delivery truck",slug:"delivery_truck",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚛":{name:"articulated lorry",slug:"articulated_lorry",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚜":{name:"tractor",slug:"tractor",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏎️":{name:"racing car",slug:"racing_car",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏍️":{name:"motorcycle",slug:"motorcycle",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛵":{name:"motor scooter",slug:"motor_scooter",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦽":{name:"manual wheelchair",slug:"manual_wheelchair",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦼":{name:"motorized wheelchair",slug:"motorized_wheelchair",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🛺":{name:"auto rickshaw",slug:"auto_rickshaw",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🚲":{name:"bicycle",slug:"bicycle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛴":{name:"kick scooter",slug:"kick_scooter",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🛹":{name:"skateboard",slug:"skateboard",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🛼":{name:"roller skate",slug:"roller_skate",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🚏":{name:"bus stop",slug:"bus_stop",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛣️":{name:"motorway",slug:"motorway",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛤️":{name:"railway track",slug:"railway_track",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛢️":{name:"oil drum",slug:"oil_drum",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛽":{name:"fuel pump",slug:"fuel_pump",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛞":{name:"wheel",slug:"wheel",group:"Travel & Places",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🚨":{name:"police car light",slug:"police_car_light",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚥":{name:"horizontal traffic light",slug:"horizontal_traffic_light",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚦":{name:"vertical traffic light",slug:"vertical_traffic_light",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛑":{name:"stop sign",slug:"stop_sign",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🚧":{name:"construction",slug:"construction",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚓":{name:"anchor",slug:"anchor",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛟":{name:"ring buoy",slug:"ring_buoy",group:"Travel & Places",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"⛵":{name:"sailboat",slug:"sailboat",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛶":{name:"canoe",slug:"canoe",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🚤":{name:"speedboat",slug:"speedboat",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛳️":{name:"passenger ship",slug:"passenger_ship",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛴️":{name:"ferry",slug:"ferry",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛥️":{name:"motor boat",slug:"motor_boat",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚢":{name:"ship",slug:"ship",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✈️":{name:"airplane",slug:"airplane",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛩️":{name:"small airplane",slug:"small_airplane",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛫":{name:"airplane departure",slug:"airplane_departure",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛬":{name:"airplane arrival",slug:"airplane_arrival",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪂":{name:"parachute",slug:"parachute",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"💺":{name:"seat",slug:"seat",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚁":{name:"helicopter",slug:"helicopter",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚟":{name:"suspension railway",slug:"suspension_railway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚠":{name:"mountain cableway",slug:"mountain_cableway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚡":{name:"aerial tramway",slug:"aerial_tramway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛰️":{name:"satellite",slug:"satellite",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚀":{name:"rocket",slug:"rocket",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛸":{name:"flying saucer",slug:"flying_saucer",group:"Travel & Places",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🛎️":{name:"bellhop bell",slug:"bellhop_bell",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🧳":{name:"luggage",slug:"luggage",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"⌛":{name:"hourglass done",slug:"hourglass_done",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏳":{name:"hourglass not done",slug:"hourglass_not_done",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⌚":{name:"watch",slug:"watch",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏰":{name:"alarm clock",slug:"alarm_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏱️":{name:"stopwatch",slug:"stopwatch",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⏲️":{name:"timer clock",slug:"timer_clock",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🕰️":{name:"mantelpiece clock",slug:"mantelpiece_clock",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕛":{name:"twelve o’clock",slug:"twelve_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕧":{name:"twelve-thirty",slug:"twelve_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕐":{name:"one o’clock",slug:"one_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕜":{name:"one-thirty",slug:"one_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕑":{name:"two o’clock",slug:"two_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕝":{name:"two-thirty",slug:"two_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕒":{name:"three o’clock",slug:"three_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕞":{name:"three-thirty",slug:"three_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕓":{name:"four o’clock",slug:"four_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕟":{name:"four-thirty",slug:"four_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕔":{name:"five o’clock",slug:"five_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕠":{name:"five-thirty",slug:"five_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕕":{name:"six o’clock",slug:"six_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕡":{name:"six-thirty",slug:"six_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕖":{name:"seven o’clock",slug:"seven_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕢":{name:"seven-thirty",slug:"seven_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕗":{name:"eight o’clock",slug:"eight_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕣":{name:"eight-thirty",slug:"eight_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕘":{name:"nine o’clock",slug:"nine_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕤":{name:"nine-thirty",slug:"nine_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕙":{name:"ten o’clock",slug:"ten_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕥":{name:"ten-thirty",slug:"ten_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕚":{name:"eleven o’clock",slug:"eleven_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕦":{name:"eleven-thirty",slug:"eleven_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌑":{name:"new moon",slug:"new_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌒":{name:"waxing crescent moon",slug:"waxing_crescent_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌓":{name:"first quarter moon",slug:"first_quarter_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌔":{name:"waxing gibbous moon",slug:"waxing_gibbous_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌕":{name:"full moon",slug:"full_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌖":{name:"waning gibbous moon",slug:"waning_gibbous_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌗":{name:"last quarter moon",slug:"last_quarter_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌘":{name:"waning crescent moon",slug:"waning_crescent_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌙":{name:"crescent moon",slug:"crescent_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌚":{name:"new moon face",slug:"new_moon_face",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌛":{name:"first quarter moon face",slug:"first_quarter_moon_face",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌜":{name:"last quarter moon face",slug:"last_quarter_moon_face",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌡️":{name:"thermometer",slug:"thermometer",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☀️":{name:"sun",slug:"sun",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌝":{name:"full moon face",slug:"full_moon_face",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌞":{name:"sun with face",slug:"sun_with_face",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪐":{name:"ringed planet",slug:"ringed_planet",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⭐":{name:"star",slug:"star",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌟":{name:"glowing star",slug:"glowing_star",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌠":{name:"shooting star",slug:"shooting_star",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌌":{name:"milky way",slug:"milky_way",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☁️":{name:"cloud",slug:"cloud",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛅":{name:"sun behind cloud",slug:"sun_behind_cloud",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛈️":{name:"cloud with lightning and rain",slug:"cloud_with_lightning_and_rain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌤️":{name:"sun behind small cloud",slug:"sun_behind_small_cloud",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌥️":{name:"sun behind large cloud",slug:"sun_behind_large_cloud",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌦️":{name:"sun behind rain cloud",slug:"sun_behind_rain_cloud",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌧️":{name:"cloud with rain",slug:"cloud_with_rain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌨️":{name:"cloud with snow",slug:"cloud_with_snow",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌩️":{name:"cloud with lightning",slug:"cloud_with_lightning",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌪️":{name:"tornado",slug:"tornado",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌫️":{name:"fog",slug:"fog",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌬️":{name:"wind face",slug:"wind_face",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌀":{name:"cyclone",slug:"cyclone",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌈":{name:"rainbow",slug:"rainbow",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌂":{name:"closed umbrella",slug:"closed_umbrella",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☂️":{name:"umbrella",slug:"umbrella",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☔":{name:"umbrella with rain drops",slug:"umbrella_with_rain_drops",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛱️":{name:"umbrella on ground",slug:"umbrella_on_ground",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚡":{name:"high voltage",slug:"high_voltage",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❄️":{name:"snowflake",slug:"snowflake",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☃️":{name:"snowman",slug:"snowman",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛄":{name:"snowman without snow",slug:"snowman_without_snow",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☄️":{name:"comet",slug:"comet",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔥":{name:"fire",slug:"fire",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💧":{name:"droplet",slug:"droplet",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌊":{name:"water wave",slug:"water_wave",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎃":{name:"jack-o-lantern",slug:"jack_o_lantern",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎄":{name:"Christmas tree",slug:"christmas_tree",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎆":{name:"fireworks",slug:"fireworks",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎇":{name:"sparkler",slug:"sparkler",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧨":{name:"firecracker",slug:"firecracker",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"✨":{name:"sparkles",slug:"sparkles",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎈":{name:"balloon",slug:"balloon",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎉":{name:"party popper",slug:"party_popper",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎊":{name:"confetti ball",slug:"confetti_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎋":{name:"tanabata tree",slug:"tanabata_tree",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎍":{name:"pine decoration",slug:"pine_decoration",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎎":{name:"Japanese dolls",slug:"japanese_dolls",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎏":{name:"carp streamer",slug:"carp_streamer",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎐":{name:"wind chime",slug:"wind_chime",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎑":{name:"moon viewing ceremony",slug:"moon_viewing_ceremony",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧧":{name:"red envelope",slug:"red_envelope",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🎀":{name:"ribbon",slug:"ribbon",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎁":{name:"wrapped gift",slug:"wrapped_gift",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎗️":{name:"reminder ribbon",slug:"reminder_ribbon",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎟️":{name:"admission tickets",slug:"admission_tickets",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎫":{name:"ticket",slug:"ticket",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎖️":{name:"military medal",slug:"military_medal",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏆":{name:"trophy",slug:"trophy",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏅":{name:"sports medal",slug:"sports_medal",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥇":{name:"1st place medal",slug:"1st_place_medal",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥈":{name:"2nd place medal",slug:"2nd_place_medal",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥉":{name:"3rd place medal",slug:"3rd_place_medal",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"⚽":{name:"soccer ball",slug:"soccer_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚾":{name:"baseball",slug:"baseball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥎":{name:"softball",slug:"softball",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🏀":{name:"basketball",slug:"basketball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏐":{name:"volleyball",slug:"volleyball",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏈":{name:"american football",slug:"american_football",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏉":{name:"rugby football",slug:"rugby_football",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🎾":{name:"tennis",slug:"tennis",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥏":{name:"flying disc",slug:"flying_disc",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🎳":{name:"bowling",slug:"bowling",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏏":{name:"cricket game",slug:"cricket_game",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏑":{name:"field hockey",slug:"field_hockey",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏒":{name:"ice hockey",slug:"ice_hockey",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥍":{name:"lacrosse",slug:"lacrosse",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🏓":{name:"ping pong",slug:"ping_pong",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏸":{name:"badminton",slug:"badminton",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥊":{name:"boxing glove",slug:"boxing_glove",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥋":{name:"martial arts uniform",slug:"martial_arts_uniform",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥅":{name:"goal net",slug:"goal_net",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"⛳":{name:"flag in hole",slug:"flag_in_hole",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛸️":{name:"ice skate",slug:"ice_skate",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎣":{name:"fishing pole",slug:"fishing_pole",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤿":{name:"diving mask",slug:"diving_mask",group:"Activities",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🎽":{name:"running shirt",slug:"running_shirt",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎿":{name:"skis",slug:"skis",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛷":{name:"sled",slug:"sled",group:"Activities",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥌":{name:"curling stone",slug:"curling_stone",group:"Activities",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🎯":{name:"bullseye",slug:"bullseye",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪀":{name:"yo-yo",slug:"yo_yo",group:"Activities",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🪁":{name:"kite",slug:"kite",group:"Activities",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🔫":{name:"water pistol",slug:"water_pistol",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎱":{name:"pool 8 ball",slug:"pool_8_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔮":{name:"crystal ball",slug:"crystal_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪄":{name:"magic wand",slug:"magic_wand",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🎮":{name:"video game",slug:"video_game",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕹️":{name:"joystick",slug:"joystick",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎰":{name:"slot machine",slug:"slot_machine",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎲":{name:"game die",slug:"game_die",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧩":{name:"puzzle piece",slug:"puzzle_piece",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧸":{name:"teddy bear",slug:"teddy_bear",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪅":{name:"piñata",slug:"pinata",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪩":{name:"mirror ball",slug:"mirror_ball",group:"Activities",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪆":{name:"nesting dolls",slug:"nesting_dolls",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"♠️":{name:"spade suit",slug:"spade_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♥️":{name:"heart suit",slug:"heart_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♦️":{name:"diamond suit",slug:"diamond_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♣️":{name:"club suit",slug:"club_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♟️":{name:"chess pawn",slug:"chess_pawn",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🃏":{name:"joker",slug:"joker",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🀄":{name:"mahjong red dragon",slug:"mahjong_red_dragon",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎴":{name:"flower playing cards",slug:"flower_playing_cards",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎭":{name:"performing arts",slug:"performing_arts",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖼️":{name:"framed picture",slug:"framed_picture",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎨":{name:"artist palette",slug:"artist_palette",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧵":{name:"thread",slug:"thread",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪡":{name:"sewing needle",slug:"sewing_needle",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧶":{name:"yarn",slug:"yarn",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪢":{name:"knot",slug:"knot",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"👓":{name:"glasses",slug:"glasses",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕶️":{name:"sunglasses",slug:"sunglasses",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🥽":{name:"goggles",slug:"goggles",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥼":{name:"lab coat",slug:"lab_coat",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦺":{name:"safety vest",slug:"safety_vest",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"👔":{name:"necktie",slug:"necktie",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👕":{name:"t-shirt",slug:"t_shirt",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👖":{name:"jeans",slug:"jeans",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧣":{name:"scarf",slug:"scarf",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧤":{name:"gloves",slug:"gloves",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧥":{name:"coat",slug:"coat",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧦":{name:"socks",slug:"socks",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"👗":{name:"dress",slug:"dress",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👘":{name:"kimono",slug:"kimono",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥻":{name:"sari",slug:"sari",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩱":{name:"one-piece swimsuit",slug:"one_piece_swimsuit",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩲":{name:"briefs",slug:"briefs",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩳":{name:"shorts",slug:"shorts",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"👙":{name:"bikini",slug:"bikini",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👚":{name:"woman’s clothes",slug:"woman_s_clothes",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪭":{name:"folding hand fan",slug:"folding_hand_fan",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"👛":{name:"purse",slug:"purse",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👜":{name:"handbag",slug:"handbag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👝":{name:"clutch bag",slug:"clutch_bag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛍️":{name:"shopping bags",slug:"shopping_bags",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎒":{name:"backpack",slug:"backpack",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩴":{name:"thong sandal",slug:"thong_sandal",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"👞":{name:"man’s shoe",slug:"man_s_shoe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👟":{name:"running shoe",slug:"running_shoe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥾":{name:"hiking boot",slug:"hiking_boot",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥿":{name:"flat shoe",slug:"flat_shoe",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"👠":{name:"high-heeled shoe",slug:"high_heeled_shoe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👡":{name:"woman’s sandal",slug:"woman_s_sandal",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩰":{name:"ballet shoes",slug:"ballet_shoes",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"👢":{name:"woman’s boot",slug:"woman_s_boot",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪮":{name:"hair pick",slug:"hair_pick",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"👑":{name:"crown",slug:"crown",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👒":{name:"woman’s hat",slug:"woman_s_hat",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎩":{name:"top hat",slug:"top_hat",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎓":{name:"graduation cap",slug:"graduation_cap",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧢":{name:"billed cap",slug:"billed_cap",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🪖":{name:"military helmet",slug:"military_helmet",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"⛑️":{name:"rescue worker’s helmet",slug:"rescue_worker_s_helmet",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📿":{name:"prayer beads",slug:"prayer_beads",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💄":{name:"lipstick",slug:"lipstick",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💍":{name:"ring",slug:"ring",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💎":{name:"gem stone",slug:"gem_stone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔇":{name:"muted speaker",slug:"muted_speaker",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔈":{name:"speaker low volume",slug:"speaker_low_volume",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔉":{name:"speaker medium volume",slug:"speaker_medium_volume",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔊":{name:"speaker high volume",slug:"speaker_high_volume",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📢":{name:"loudspeaker",slug:"loudspeaker",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📣":{name:"megaphone",slug:"megaphone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📯":{name:"postal horn",slug:"postal_horn",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔔":{name:"bell",slug:"bell",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔕":{name:"bell with slash",slug:"bell_with_slash",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🎼":{name:"musical score",slug:"musical_score",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎵":{name:"musical note",slug:"musical_note",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎶":{name:"musical notes",slug:"musical_notes",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎙️":{name:"studio microphone",slug:"studio_microphone",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎚️":{name:"level slider",slug:"level_slider",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎛️":{name:"control knobs",slug:"control_knobs",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎤":{name:"microphone",slug:"microphone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎧":{name:"headphone",slug:"headphone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📻":{name:"radio",slug:"radio",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎷":{name:"saxophone",slug:"saxophone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪗":{name:"accordion",slug:"accordion",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🎸":{name:"guitar",slug:"guitar",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎹":{name:"musical keyboard",slug:"musical_keyboard",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎺":{name:"trumpet",slug:"trumpet",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎻":{name:"violin",slug:"violin",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪕":{name:"banjo",slug:"banjo",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥁":{name:"drum",slug:"drum",group:"Objects",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🪘":{name:"long drum",slug:"long_drum",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪇":{name:"maracas",slug:"maracas",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🪈":{name:"flute",slug:"flute",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🪉":{name:"harp",slug:"harp",group:"Objects",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"📱":{name:"mobile phone",slug:"mobile_phone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📲":{name:"mobile phone with arrow",slug:"mobile_phone_with_arrow",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☎️":{name:"telephone",slug:"telephone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📞":{name:"telephone receiver",slug:"telephone_receiver",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📟":{name:"pager",slug:"pager",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📠":{name:"fax machine",slug:"fax_machine",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔋":{name:"battery",slug:"battery",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪫":{name:"low battery",slug:"low_battery",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🔌":{name:"electric plug",slug:"electric_plug",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💻":{name:"laptop",slug:"laptop",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖥️":{name:"desktop computer",slug:"desktop_computer",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖨️":{name:"printer",slug:"printer",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⌨️":{name:"keyboard",slug:"keyboard",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🖱️":{name:"computer mouse",slug:"computer_mouse",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖲️":{name:"trackball",slug:"trackball",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💽":{name:"computer disk",slug:"computer_disk",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💾":{name:"floppy disk",slug:"floppy_disk",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💿":{name:"optical disk",slug:"optical_disk",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📀":{name:"dvd",slug:"dvd",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧮":{name:"abacus",slug:"abacus",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🎥":{name:"movie camera",slug:"movie_camera",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎞️":{name:"film frames",slug:"film_frames",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📽️":{name:"film projector",slug:"film_projector",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎬":{name:"clapper board",slug:"clapper_board",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📺":{name:"television",slug:"television",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📷":{name:"camera",slug:"camera",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📸":{name:"camera with flash",slug:"camera_with_flash",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📹":{name:"video camera",slug:"video_camera",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📼":{name:"videocassette",slug:"videocassette",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔍":{name:"magnifying glass tilted left",slug:"magnifying_glass_tilted_left",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔎":{name:"magnifying glass tilted right",slug:"magnifying_glass_tilted_right",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕯️":{name:"candle",slug:"candle",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💡":{name:"light bulb",slug:"light_bulb",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔦":{name:"flashlight",slug:"flashlight",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏮":{name:"red paper lantern",slug:"red_paper_lantern",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪔":{name:"diya lamp",slug:"diya_lamp",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"📔":{name:"notebook with decorative cover",slug:"notebook_with_decorative_cover",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📕":{name:"closed book",slug:"closed_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📖":{name:"open book",slug:"open_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📗":{name:"green book",slug:"green_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📘":{name:"blue book",slug:"blue_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📙":{name:"orange book",slug:"orange_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📚":{name:"books",slug:"books",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📓":{name:"notebook",slug:"notebook",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📒":{name:"ledger",slug:"ledger",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📃":{name:"page with curl",slug:"page_with_curl",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📜":{name:"scroll",slug:"scroll",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📄":{name:"page facing up",slug:"page_facing_up",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📰":{name:"newspaper",slug:"newspaper",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗞️":{name:"rolled-up newspaper",slug:"rolled_up_newspaper",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📑":{name:"bookmark tabs",slug:"bookmark_tabs",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔖":{name:"bookmark",slug:"bookmark",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏷️":{name:"label",slug:"label",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💰":{name:"money bag",slug:"money_bag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪙":{name:"coin",slug:"coin",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"💴":{name:"yen banknote",slug:"yen_banknote",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💵":{name:"dollar banknote",slug:"dollar_banknote",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💶":{name:"euro banknote",slug:"euro_banknote",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💷":{name:"pound banknote",slug:"pound_banknote",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💸":{name:"money with wings",slug:"money_with_wings",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💳":{name:"credit card",slug:"credit_card",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧾":{name:"receipt",slug:"receipt",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"💹":{name:"chart increasing with yen",slug:"chart_increasing_with_yen",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✉️":{name:"envelope",slug:"envelope",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📧":{name:"e-mail",slug:"e_mail",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📨":{name:"incoming envelope",slug:"incoming_envelope",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📩":{name:"envelope with arrow",slug:"envelope_with_arrow",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📤":{name:"outbox tray",slug:"outbox_tray",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📥":{name:"inbox tray",slug:"inbox_tray",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📦":{name:"package",slug:"package",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📫":{name:"closed mailbox with raised flag",slug:"closed_mailbox_with_raised_flag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📪":{name:"closed mailbox with lowered flag",slug:"closed_mailbox_with_lowered_flag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📬":{name:"open mailbox with raised flag",slug:"open_mailbox_with_raised_flag",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📭":{name:"open mailbox with lowered flag",slug:"open_mailbox_with_lowered_flag",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📮":{name:"postbox",slug:"postbox",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗳️":{name:"ballot box with ballot",slug:"ballot_box_with_ballot",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"✏️":{name:"pencil",slug:"pencil",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✒️":{name:"black nib",slug:"black_nib",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖋️":{name:"fountain pen",slug:"fountain_pen",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖊️":{name:"pen",slug:"pen",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖌️":{name:"paintbrush",slug:"paintbrush",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖍️":{name:"crayon",slug:"crayon",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📝":{name:"memo",slug:"memo",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💼":{name:"briefcase",slug:"briefcase",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📁":{name:"file folder",slug:"file_folder",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📂":{name:"open file folder",slug:"open_file_folder",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗂️":{name:"card index dividers",slug:"card_index_dividers",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📅":{name:"calendar",slug:"calendar",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📆":{name:"tear-off calendar",slug:"tear_off_calendar",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗒️":{name:"spiral notepad",slug:"spiral_notepad",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗓️":{name:"spiral calendar",slug:"spiral_calendar",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📇":{name:"card index",slug:"card_index",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📈":{name:"chart increasing",slug:"chart_increasing",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📉":{name:"chart decreasing",slug:"chart_decreasing",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📊":{name:"bar chart",slug:"bar_chart",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📋":{name:"clipboard",slug:"clipboard",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📌":{name:"pushpin",slug:"pushpin",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📍":{name:"round pushpin",slug:"round_pushpin",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📎":{name:"paperclip",slug:"paperclip",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖇️":{name:"linked paperclips",slug:"linked_paperclips",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📏":{name:"straight ruler",slug:"straight_ruler",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📐":{name:"triangular ruler",slug:"triangular_ruler",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✂️":{name:"scissors",slug:"scissors",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗃️":{name:"card file box",slug:"card_file_box",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗄️":{name:"file cabinet",slug:"file_cabinet",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗑️":{name:"wastebasket",slug:"wastebasket",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔒":{name:"locked",slug:"locked",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔓":{name:"unlocked",slug:"unlocked",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔏":{name:"locked with pen",slug:"locked_with_pen",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔐":{name:"locked with key",slug:"locked_with_key",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔑":{name:"key",slug:"key",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗝️":{name:"old key",slug:"old_key",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔨":{name:"hammer",slug:"hammer",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪓":{name:"axe",slug:"axe",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⛏️":{name:"pick",slug:"pick",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚒️":{name:"hammer and pick",slug:"hammer_and_pick",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛠️":{name:"hammer and wrench",slug:"hammer_and_wrench",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗡️":{name:"dagger",slug:"dagger",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚔️":{name:"crossed swords",slug:"crossed_swords",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💣":{name:"bomb",slug:"bomb",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪃":{name:"boomerang",slug:"boomerang",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🏹":{name:"bow and arrow",slug:"bow_and_arrow",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛡️":{name:"shield",slug:"shield",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🪚":{name:"carpentry saw",slug:"carpentry_saw",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🔧":{name:"wrench",slug:"wrench",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪛":{name:"screwdriver",slug:"screwdriver",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🔩":{name:"nut and bolt",slug:"nut_and_bolt",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚙️":{name:"gear",slug:"gear",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🗜️":{name:"clamp",slug:"clamp",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚖️":{name:"balance scale",slug:"balance_scale",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦯":{name:"white cane",slug:"white_cane",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🔗":{name:"link",slug:"link",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛓️‍💥":{name:"broken chain",slug:"broken_chain",group:"Objects",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"⛓️":{name:"chains",slug:"chains",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🪝":{name:"hook",slug:"hook",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧰":{name:"toolbox",slug:"toolbox",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧲":{name:"magnet",slug:"magnet",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪜":{name:"ladder",slug:"ladder",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪏":{name:"shovel",slug:"shovel",group:"Objects",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"⚗️":{name:"alembic",slug:"alembic",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧪":{name:"test tube",slug:"test_tube",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧫":{name:"petri dish",slug:"petri_dish",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧬":{name:"dna",slug:"dna",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🔬":{name:"microscope",slug:"microscope",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔭":{name:"telescope",slug:"telescope",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📡":{name:"satellite antenna",slug:"satellite_antenna",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💉":{name:"syringe",slug:"syringe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩸":{name:"drop of blood",slug:"drop_of_blood",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"💊":{name:"pill",slug:"pill",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩹":{name:"adhesive bandage",slug:"adhesive_bandage",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩼":{name:"crutch",slug:"crutch",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🩺":{name:"stethoscope",slug:"stethoscope",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩻":{name:"x-ray",slug:"x_ray",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🚪":{name:"door",slug:"door",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛗":{name:"elevator",slug:"elevator",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪞":{name:"mirror",slug:"mirror",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪟":{name:"window",slug:"window",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🛏️":{name:"bed",slug:"bed",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛋️":{name:"couch and lamp",slug:"couch_and_lamp",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🪑":{name:"chair",slug:"chair",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🚽":{name:"toilet",slug:"toilet",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪠":{name:"plunger",slug:"plunger",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🚿":{name:"shower",slug:"shower",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛁":{name:"bathtub",slug:"bathtub",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪤":{name:"mouse trap",slug:"mouse_trap",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪒":{name:"razor",slug:"razor",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧴":{name:"lotion bottle",slug:"lotion_bottle",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧷":{name:"safety pin",slug:"safety_pin",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧹":{name:"broom",slug:"broom",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧺":{name:"basket",slug:"basket",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧻":{name:"roll of paper",slug:"roll_of_paper",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪣":{name:"bucket",slug:"bucket",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧼":{name:"soap",slug:"soap",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🫧":{name:"bubbles",slug:"bubbles",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪥":{name:"toothbrush",slug:"toothbrush",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧽":{name:"sponge",slug:"sponge",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧯":{name:"fire extinguisher",slug:"fire_extinguisher",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🛒":{name:"shopping cart",slug:"shopping_cart",group:"Objects",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🚬":{name:"cigarette",slug:"cigarette",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚰️":{name:"coffin",slug:"coffin",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪦":{name:"headstone",slug:"headstone",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"⚱️":{name:"funeral urn",slug:"funeral_urn",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧿":{name:"nazar amulet",slug:"nazar_amulet",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪬":{name:"hamsa",slug:"hamsa",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🗿":{name:"moai",slug:"moai",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪧":{name:"placard",slug:"placard",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪪":{name:"identification card",slug:"identification_card",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🏧":{name:"ATM sign",slug:"atm_sign",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚮":{name:"litter in bin sign",slug:"litter_in_bin_sign",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚰":{name:"potable water",slug:"potable_water",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"♿":{name:"wheelchair symbol",slug:"wheelchair_symbol",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚹":{name:"men’s room",slug:"men_s_room",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚺":{name:"women’s room",slug:"women_s_room",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚻":{name:"restroom",slug:"restroom",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚼":{name:"baby symbol",slug:"baby_symbol",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚾":{name:"water closet",slug:"water_closet",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛂":{name:"passport control",slug:"passport_control",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛃":{name:"customs",slug:"customs",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛄":{name:"baggage claim",slug:"baggage_claim",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛅":{name:"left luggage",slug:"left_luggage",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⚠️":{name:"warning",slug:"warning",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚸":{name:"children crossing",slug:"children_crossing",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⛔":{name:"no entry",slug:"no_entry",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚫":{name:"prohibited",slug:"prohibited",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚳":{name:"no bicycles",slug:"no_bicycles",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚭":{name:"no smoking",slug:"no_smoking",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚯":{name:"no littering",slug:"no_littering",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚱":{name:"non-potable water",slug:"non_potable_water",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚷":{name:"no pedestrians",slug:"no_pedestrians",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📵":{name:"no mobile phones",slug:"no_mobile_phones",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔞":{name:"no one under eighteen",slug:"no_one_under_eighteen",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☢️":{name:"radioactive",slug:"radioactive",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☣️":{name:"biohazard",slug:"biohazard",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⬆️":{name:"up arrow",slug:"up_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↗️":{name:"up-right arrow",slug:"up_right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➡️":{name:"right arrow",slug:"right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↘️":{name:"down-right arrow",slug:"down_right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⬇️":{name:"down arrow",slug:"down_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↙️":{name:"down-left arrow",slug:"down_left_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⬅️":{name:"left arrow",slug:"left_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↖️":{name:"up-left arrow",slug:"up_left_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↕️":{name:"up-down arrow",slug:"up_down_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↔️":{name:"left-right arrow",slug:"left_right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↩️":{name:"right arrow curving left",slug:"right_arrow_curving_left",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↪️":{name:"left arrow curving right",slug:"left_arrow_curving_right",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⤴️":{name:"right arrow curving up",slug:"right_arrow_curving_up",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⤵️":{name:"right arrow curving down",slug:"right_arrow_curving_down",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔃":{name:"clockwise vertical arrows",slug:"clockwise_vertical_arrows",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔄":{name:"counterclockwise arrows button",slug:"counterclockwise_arrows_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔙":{name:"BACK arrow",slug:"back_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔚":{name:"END arrow",slug:"end_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔛":{name:"ON! arrow",slug:"on_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔜":{name:"SOON arrow",slug:"soon_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔝":{name:"TOP arrow",slug:"top_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛐":{name:"place of worship",slug:"place_of_worship",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⚛️":{name:"atom symbol",slug:"atom_symbol",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🕉️":{name:"om",slug:"om",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"✡️":{name:"star of David",slug:"star_of_david",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☸️":{name:"wheel of dharma",slug:"wheel_of_dharma",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☯️":{name:"yin yang",slug:"yin_yang",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"✝️":{name:"latin cross",slug:"latin_cross",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☦️":{name:"orthodox cross",slug:"orthodox_cross",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☪️":{name:"star and crescent",slug:"star_and_crescent",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☮️":{name:"peace symbol",slug:"peace_symbol",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🕎":{name:"menorah",slug:"menorah",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔯":{name:"dotted six-pointed star",slug:"dotted_six_pointed_star",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪯":{name:"khanda",slug:"khanda",group:"Symbols",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"♈":{name:"Aries",slug:"aries",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♉":{name:"Taurus",slug:"taurus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♊":{name:"Gemini",slug:"gemini",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♋":{name:"Cancer",slug:"cancer",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♌":{name:"Leo",slug:"leo",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♍":{name:"Virgo",slug:"virgo",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♎":{name:"Libra",slug:"libra",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♏":{name:"Scorpio",slug:"scorpio",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♐":{name:"Sagittarius",slug:"sagittarius",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♑":{name:"Capricorn",slug:"capricorn",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♒":{name:"Aquarius",slug:"aquarius",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♓":{name:"Pisces",slug:"pisces",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛎":{name:"Ophiuchus",slug:"ophiuchus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔀":{name:"shuffle tracks button",slug:"shuffle_tracks_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔁":{name:"repeat button",slug:"repeat_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔂":{name:"repeat single button",slug:"repeat_single_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"▶️":{name:"play button",slug:"play_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏩":{name:"fast-forward button",slug:"fast_forward_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏭️":{name:"next track button",slug:"next_track_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏯️":{name:"play or pause button",slug:"play_or_pause_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"◀️":{name:"reverse button",slug:"reverse_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏪":{name:"fast reverse button",slug:"fast_reverse_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏮️":{name:"last track button",slug:"last_track_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔼":{name:"upwards button",slug:"upwards_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏫":{name:"fast up button",slug:"fast_up_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔽":{name:"downwards button",slug:"downwards_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏬":{name:"fast down button",slug:"fast_down_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏸️":{name:"pause button",slug:"pause_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏹️":{name:"stop button",slug:"stop_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏺️":{name:"record button",slug:"record_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏏️":{name:"eject button",slug:"eject_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🎦":{name:"cinema",slug:"cinema",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔅":{name:"dim button",slug:"dim_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔆":{name:"bright button",slug:"bright_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📶":{name:"antenna bars",slug:"antenna_bars",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛜":{name:"wireless",slug:"wireless",group:"Symbols",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"📳":{name:"vibration mode",slug:"vibration_mode",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📴":{name:"mobile phone off",slug:"mobile_phone_off",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♀️":{name:"female sign",slug:"female_sign",group:"Symbols",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"♂️":{name:"male sign",slug:"male_sign",group:"Symbols",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"⚧️":{name:"transgender symbol",slug:"transgender_symbol",group:"Symbols",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"✖️":{name:"multiply",slug:"multiply",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➕":{name:"plus",slug:"plus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➖":{name:"minus",slug:"minus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➗":{name:"divide",slug:"divide",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟰":{name:"heavy equals sign",slug:"heavy_equals_sign",group:"Symbols",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"♾️":{name:"infinity",slug:"infinity",group:"Symbols",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"‼️":{name:"double exclamation mark",slug:"double_exclamation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⁉️":{name:"exclamation question mark",slug:"exclamation_question_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❓":{name:"red question mark",slug:"red_question_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❔":{name:"white question mark",slug:"white_question_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❕":{name:"white exclamation mark",slug:"white_exclamation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❗":{name:"red exclamation mark",slug:"red_exclamation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"〰️":{name:"wavy dash",slug:"wavy_dash",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💱":{name:"currency exchange",slug:"currency_exchange",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💲":{name:"heavy dollar sign",slug:"heavy_dollar_sign",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚕️":{name:"medical symbol",slug:"medical_symbol",group:"Symbols",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"♻️":{name:"recycling symbol",slug:"recycling_symbol",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚜️":{name:"fleur-de-lis",slug:"fleur_de_lis",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔱":{name:"trident emblem",slug:"trident_emblem",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📛":{name:"name badge",slug:"name_badge",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔰":{name:"Japanese symbol for beginner",slug:"japanese_symbol_for_beginner",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⭕":{name:"hollow red circle",slug:"hollow_red_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✅":{name:"check mark button",slug:"check_mark_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☑️":{name:"check box with check",slug:"check_box_with_check",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✔️":{name:"check mark",slug:"check_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❌":{name:"cross mark",slug:"cross_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❎":{name:"cross mark button",slug:"cross_mark_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➰":{name:"curly loop",slug:"curly_loop",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➿":{name:"double curly loop",slug:"double_curly_loop",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"〽️":{name:"part alternation mark",slug:"part_alternation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✳️":{name:"eight-spoked asterisk",slug:"eight_spoked_asterisk",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✴️":{name:"eight-pointed star",slug:"eight_pointed_star",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❇️":{name:"sparkle",slug:"sparkle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"©️":{name:"copyright",slug:"copyright",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"®️":{name:"registered",slug:"registered",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"™️":{name:"trade mark",slug:"trade_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫟":{name:"splatter",slug:"splatter",group:"Symbols",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"#️⃣":{name:"keycap #",slug:"keycap_number_sign",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"*️⃣":{name:"keycap *",slug:"keycap_asterisk",group:"Symbols",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"0️⃣":{name:"keycap 0",slug:"keycap_0",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"1️⃣":{name:"keycap 1",slug:"keycap_1",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"2️⃣":{name:"keycap 2",slug:"keycap_2",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"3️⃣":{name:"keycap 3",slug:"keycap_3",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"4️⃣":{name:"keycap 4",slug:"keycap_4",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"5️⃣":{name:"keycap 5",slug:"keycap_5",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"6️⃣":{name:"keycap 6",slug:"keycap_6",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"7️⃣":{name:"keycap 7",slug:"keycap_7",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"8️⃣":{name:"keycap 8",slug:"keycap_8",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"9️⃣":{name:"keycap 9",slug:"keycap_9",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔟":{name:"keycap 10",slug:"keycap_10",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔠":{name:"input latin uppercase",slug:"input_latin_uppercase",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔡":{name:"input latin lowercase",slug:"input_latin_lowercase",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔢":{name:"input numbers",slug:"input_numbers",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔣":{name:"input symbols",slug:"input_symbols",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔤":{name:"input latin letters",slug:"input_latin_letters",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅰️":{name:"A button (blood type)",slug:"a_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆎":{name:"AB button (blood type)",slug:"ab_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅱️":{name:"B button (blood type)",slug:"b_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆑":{name:"CL button",slug:"cl_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆒":{name:"COOL button",slug:"cool_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆓":{name:"FREE button",slug:"free_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"ℹ️":{name:"information",slug:"information",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆔":{name:"ID button",slug:"id_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"Ⓜ️":{name:"circled M",slug:"circled_m",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆕":{name:"NEW button",slug:"new_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆖":{name:"NG button",slug:"ng_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅾️":{name:"O button (blood type)",slug:"o_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆗":{name:"OK button",slug:"ok_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅿️":{name:"P button",slug:"p_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆘":{name:"SOS button",slug:"sos_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆙":{name:"UP! button",slug:"up_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆚":{name:"VS button",slug:"vs_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈁":{name:"Japanese “here” button",slug:"japanese_here_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈂️":{name:"Japanese “service charge” button",slug:"japanese_service_charge_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈷️":{name:"Japanese “monthly amount” button",slug:"japanese_monthly_amount_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈶":{name:"Japanese “not free of charge” button",slug:"japanese_not_free_of_charge_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈯":{name:"Japanese “reserved” button",slug:"japanese_reserved_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🉐":{name:"Japanese “bargain” button",slug:"japanese_bargain_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈹":{name:"Japanese “discount” button",slug:"japanese_discount_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈚":{name:"Japanese “free of charge” button",slug:"japanese_free_of_charge_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈲":{name:"Japanese “prohibited” button",slug:"japanese_prohibited_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🉑":{name:"Japanese “acceptable” button",slug:"japanese_acceptable_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈸":{name:"Japanese “application” button",slug:"japanese_application_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈴":{name:"Japanese “passing grade” button",slug:"japanese_passing_grade_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈳":{name:"Japanese “vacancy” button",slug:"japanese_vacancy_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"㊗️":{name:"Japanese “congratulations” button",slug:"japanese_congratulations_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"㊙️":{name:"Japanese “secret” button",slug:"japanese_secret_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈺":{name:"Japanese “open for business” button",slug:"japanese_open_for_business_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈵":{name:"Japanese “no vacancy” button",slug:"japanese_no_vacancy_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔴":{name:"red circle",slug:"red_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟠":{name:"orange circle",slug:"orange_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟡":{name:"yellow circle",slug:"yellow_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟢":{name:"green circle",slug:"green_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🔵":{name:"blue circle",slug:"blue_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟣":{name:"purple circle",slug:"purple_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟤":{name:"brown circle",slug:"brown_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⚫":{name:"black circle",slug:"black_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚪":{name:"white circle",slug:"white_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟥":{name:"red square",slug:"red_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟧":{name:"orange square",slug:"orange_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟨":{name:"yellow square",slug:"yellow_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟩":{name:"green square",slug:"green_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟦":{name:"blue square",slug:"blue_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟪":{name:"purple square",slug:"purple_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟫":{name:"brown square",slug:"brown_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⬛":{name:"black large square",slug:"black_large_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⬜":{name:"white large square",slug:"white_large_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◼️":{name:"black medium square",slug:"black_medium_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◻️":{name:"white medium square",slug:"white_medium_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◾":{name:"black medium-small square",slug:"black_medium_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◽":{name:"white medium-small square",slug:"white_medium_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"▪️":{name:"black small square",slug:"black_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"▫️":{name:"white small square",slug:"white_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔶":{name:"large orange diamond",slug:"large_orange_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔷":{name:"large blue diamond",slug:"large_blue_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔸":{name:"small orange diamond",slug:"small_orange_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔹":{name:"small blue diamond",slug:"small_blue_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔺":{name:"red triangle pointed up",slug:"red_triangle_pointed_up",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔻":{name:"red triangle pointed down",slug:"red_triangle_pointed_down",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💠":{name:"diamond with a dot",slug:"diamond_with_a_dot",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔘":{name:"radio button",slug:"radio_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔳":{name:"white square button",slug:"white_square_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔲":{name:"black square button",slug:"black_square_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏁":{name:"chequered flag",slug:"chequered_flag",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚩":{name:"triangular flag",slug:"triangular_flag",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎌":{name:"crossed flags",slug:"crossed_flags",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏴":{name:"black flag",slug:"black_flag",group:"Flags",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏳️":{name:"white flag",slug:"white_flag",group:"Flags",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏳️‍🌈":{name:"rainbow flag",slug:"rainbow_flag",group:"Flags",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🏳️‍⚧️":{name:"transgender flag",slug:"transgender_flag",group:"Flags",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🏴‍☠️":{name:"pirate flag",slug:"pirate_flag",group:"Flags",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🇦🇨":{name:"flag Ascension Island",slug:"flag_ascension_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇩":{name:"flag Andorra",slug:"flag_andorra",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇪":{name:"flag United Arab Emirates",slug:"flag_united_arab_emirates",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇫":{name:"flag Afghanistan",slug:"flag_afghanistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇬":{name:"flag Antigua & Barbuda",slug:"flag_antigua_barbuda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇮":{name:"flag Anguilla",slug:"flag_anguilla",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇱":{name:"flag Albania",slug:"flag_albania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇲":{name:"flag Armenia",slug:"flag_armenia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇴":{name:"flag Angola",slug:"flag_angola",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇶":{name:"flag Antarctica",slug:"flag_antarctica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇷":{name:"flag Argentina",slug:"flag_argentina",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇸":{name:"flag American Samoa",slug:"flag_american_samoa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇹":{name:"flag Austria",slug:"flag_austria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇺":{name:"flag Australia",slug:"flag_australia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇼":{name:"flag Aruba",slug:"flag_aruba",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇽":{name:"flag Åland Islands",slug:"flag_aland_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇿":{name:"flag Azerbaijan",slug:"flag_azerbaijan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇦":{name:"flag Bosnia & Herzegovina",slug:"flag_bosnia_herzegovina",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇧":{name:"flag Barbados",slug:"flag_barbados",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇩":{name:"flag Bangladesh",slug:"flag_bangladesh",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇪":{name:"flag Belgium",slug:"flag_belgium",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇫":{name:"flag Burkina Faso",slug:"flag_burkina_faso",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇬":{name:"flag Bulgaria",slug:"flag_bulgaria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇭":{name:"flag Bahrain",slug:"flag_bahrain",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇮":{name:"flag Burundi",slug:"flag_burundi",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇯":{name:"flag Benin",slug:"flag_benin",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇱":{name:"flag St. Barthélemy",slug:"flag_st_barthelemy",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇲":{name:"flag Bermuda",slug:"flag_bermuda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇳":{name:"flag Brunei",slug:"flag_brunei",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇴":{name:"flag Bolivia",slug:"flag_bolivia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇶":{name:"flag Caribbean Netherlands",slug:"flag_caribbean_netherlands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇷":{name:"flag Brazil",slug:"flag_brazil",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇸":{name:"flag Bahamas",slug:"flag_bahamas",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇹":{name:"flag Bhutan",slug:"flag_bhutan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇻":{name:"flag Bouvet Island",slug:"flag_bouvet_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇼":{name:"flag Botswana",slug:"flag_botswana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇾":{name:"flag Belarus",slug:"flag_belarus",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇿":{name:"flag Belize",slug:"flag_belize",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇦":{name:"flag Canada",slug:"flag_canada",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇨":{name:"flag Cocos (Keeling) Islands",slug:"flag_cocos_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇩":{name:"flag Congo - Kinshasa",slug:"flag_congo_kinshasa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇫":{name:"flag Central African Republic",slug:"flag_central_african_republic",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇬":{name:"flag Congo - Brazzaville",slug:"flag_congo_brazzaville",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇭":{name:"flag Switzerland",slug:"flag_switzerland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇮":{name:"flag Côte d’Ivoire",slug:"flag_cote_d_ivoire",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇰":{name:"flag Cook Islands",slug:"flag_cook_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇱":{name:"flag Chile",slug:"flag_chile",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇲":{name:"flag Cameroon",slug:"flag_cameroon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇳":{name:"flag China",slug:"flag_china",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇨🇴":{name:"flag Colombia",slug:"flag_colombia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇵":{name:"flag Clipperton Island",slug:"flag_clipperton_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇶":{name:"flag Sark",slug:"flag_sark",group:"Flags",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🇨🇷":{name:"flag Costa Rica",slug:"flag_costa_rica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇺":{name:"flag Cuba",slug:"flag_cuba",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇻":{name:"flag Cape Verde",slug:"flag_cape_verde",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇼":{name:"flag Curaçao",slug:"flag_curacao",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇽":{name:"flag Christmas Island",slug:"flag_christmas_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇾":{name:"flag Cyprus",slug:"flag_cyprus",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇿":{name:"flag Czechia",slug:"flag_czechia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇪":{name:"flag Germany",slug:"flag_germany",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇩🇬":{name:"flag Diego Garcia",slug:"flag_diego_garcia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇯":{name:"flag Djibouti",slug:"flag_djibouti",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇰":{name:"flag Denmark",slug:"flag_denmark",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇲":{name:"flag Dominica",slug:"flag_dominica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇴":{name:"flag Dominican Republic",slug:"flag_dominican_republic",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇿":{name:"flag Algeria",slug:"flag_algeria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇦":{name:"flag Ceuta & Melilla",slug:"flag_ceuta_melilla",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇨":{name:"flag Ecuador",slug:"flag_ecuador",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇪":{name:"flag Estonia",slug:"flag_estonia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇬":{name:"flag Egypt",slug:"flag_egypt",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇭":{name:"flag Western Sahara",slug:"flag_western_sahara",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇷":{name:"flag Eritrea",slug:"flag_eritrea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇸":{name:"flag Spain",slug:"flag_spain",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇪🇹":{name:"flag Ethiopia",slug:"flag_ethiopia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇺":{name:"flag European Union",slug:"flag_european_union",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇮":{name:"flag Finland",slug:"flag_finland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇯":{name:"flag Fiji",slug:"flag_fiji",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇰":{name:"flag Falkland Islands",slug:"flag_falkland_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇲":{name:"flag Micronesia",slug:"flag_micronesia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇴":{name:"flag Faroe Islands",slug:"flag_faroe_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇷":{name:"flag France",slug:"flag_france",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇬🇦":{name:"flag Gabon",slug:"flag_gabon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇧":{name:"flag United Kingdom",slug:"flag_united_kingdom",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇬🇩":{name:"flag Grenada",slug:"flag_grenada",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇪":{name:"flag Georgia",slug:"flag_georgia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇫":{name:"flag French Guiana",slug:"flag_french_guiana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇬":{name:"flag Guernsey",slug:"flag_guernsey",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇭":{name:"flag Ghana",slug:"flag_ghana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇮":{name:"flag Gibraltar",slug:"flag_gibraltar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇱":{name:"flag Greenland",slug:"flag_greenland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇲":{name:"flag Gambia",slug:"flag_gambia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇳":{name:"flag Guinea",slug:"flag_guinea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇵":{name:"flag Guadeloupe",slug:"flag_guadeloupe",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇶":{name:"flag Equatorial Guinea",slug:"flag_equatorial_guinea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇷":{name:"flag Greece",slug:"flag_greece",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇸":{name:"flag South Georgia & South Sandwich Islands",slug:"flag_south_georgia_south_sandwich_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇹":{name:"flag Guatemala",slug:"flag_guatemala",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇺":{name:"flag Guam",slug:"flag_guam",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇼":{name:"flag Guinea-Bissau",slug:"flag_guinea_bissau",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇾":{name:"flag Guyana",slug:"flag_guyana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇰":{name:"flag Hong Kong SAR China",slug:"flag_hong_kong_sar_china",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇲":{name:"flag Heard & McDonald Islands",slug:"flag_heard_mcdonald_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇳":{name:"flag Honduras",slug:"flag_honduras",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇷":{name:"flag Croatia",slug:"flag_croatia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇹":{name:"flag Haiti",slug:"flag_haiti",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇺":{name:"flag Hungary",slug:"flag_hungary",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇨":{name:"flag Canary Islands",slug:"flag_canary_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇩":{name:"flag Indonesia",slug:"flag_indonesia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇪":{name:"flag Ireland",slug:"flag_ireland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇱":{name:"flag Israel",slug:"flag_israel",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇲":{name:"flag Isle of Man",slug:"flag_isle_of_man",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇳":{name:"flag India",slug:"flag_india",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇴":{name:"flag British Indian Ocean Territory",slug:"flag_british_indian_ocean_territory",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇶":{name:"flag Iraq",slug:"flag_iraq",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇷":{name:"flag Iran",slug:"flag_iran",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇸":{name:"flag Iceland",slug:"flag_iceland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇹":{name:"flag Italy",slug:"flag_italy",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇯🇪":{name:"flag Jersey",slug:"flag_jersey",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇯🇲":{name:"flag Jamaica",slug:"flag_jamaica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇯🇴":{name:"flag Jordan",slug:"flag_jordan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇯🇵":{name:"flag Japan",slug:"flag_japan",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇰🇪":{name:"flag Kenya",slug:"flag_kenya",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇬":{name:"flag Kyrgyzstan",slug:"flag_kyrgyzstan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇭":{name:"flag Cambodia",slug:"flag_cambodia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇮":{name:"flag Kiribati",slug:"flag_kiribati",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇲":{name:"flag Comoros",slug:"flag_comoros",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇳":{name:"flag St. Kitts & Nevis",slug:"flag_st_kitts_nevis",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇵":{name:"flag North Korea",slug:"flag_north_korea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇷":{name:"flag South Korea",slug:"flag_south_korea",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇰🇼":{name:"flag Kuwait",slug:"flag_kuwait",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇾":{name:"flag Cayman Islands",slug:"flag_cayman_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇿":{name:"flag Kazakhstan",slug:"flag_kazakhstan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇦":{name:"flag Laos",slug:"flag_laos",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇧":{name:"flag Lebanon",slug:"flag_lebanon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇨":{name:"flag St. Lucia",slug:"flag_st_lucia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇮":{name:"flag Liechtenstein",slug:"flag_liechtenstein",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇰":{name:"flag Sri Lanka",slug:"flag_sri_lanka",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇷":{name:"flag Liberia",slug:"flag_liberia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇸":{name:"flag Lesotho",slug:"flag_lesotho",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇹":{name:"flag Lithuania",slug:"flag_lithuania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇺":{name:"flag Luxembourg",slug:"flag_luxembourg",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇻":{name:"flag Latvia",slug:"flag_latvia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇾":{name:"flag Libya",slug:"flag_libya",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇦":{name:"flag Morocco",slug:"flag_morocco",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇨":{name:"flag Monaco",slug:"flag_monaco",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇩":{name:"flag Moldova",slug:"flag_moldova",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇪":{name:"flag Montenegro",slug:"flag_montenegro",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇫":{name:"flag St. Martin",slug:"flag_st_martin",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇬":{name:"flag Madagascar",slug:"flag_madagascar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇭":{name:"flag Marshall Islands",slug:"flag_marshall_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇰":{name:"flag North Macedonia",slug:"flag_north_macedonia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇱":{name:"flag Mali",slug:"flag_mali",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇲":{name:"flag Myanmar (Burma)",slug:"flag_myanmar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇳":{name:"flag Mongolia",slug:"flag_mongolia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇴":{name:"flag Macao SAR China",slug:"flag_macao_sar_china",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇵":{name:"flag Northern Mariana Islands",slug:"flag_northern_mariana_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇶":{name:"flag Martinique",slug:"flag_martinique",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇷":{name:"flag Mauritania",slug:"flag_mauritania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇸":{name:"flag Montserrat",slug:"flag_montserrat",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇹":{name:"flag Malta",slug:"flag_malta",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇺":{name:"flag Mauritius",slug:"flag_mauritius",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇻":{name:"flag Maldives",slug:"flag_maldives",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇼":{name:"flag Malawi",slug:"flag_malawi",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇽":{name:"flag Mexico",slug:"flag_mexico",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇾":{name:"flag Malaysia",slug:"flag_malaysia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇿":{name:"flag Mozambique",slug:"flag_mozambique",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇦":{name:"flag Namibia",slug:"flag_namibia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇨":{name:"flag New Caledonia",slug:"flag_new_caledonia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇪":{name:"flag Niger",slug:"flag_niger",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇫":{name:"flag Norfolk Island",slug:"flag_norfolk_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇬":{name:"flag Nigeria",slug:"flag_nigeria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇮":{name:"flag Nicaragua",slug:"flag_nicaragua",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇱":{name:"flag Netherlands",slug:"flag_netherlands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇴":{name:"flag Norway",slug:"flag_norway",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇵":{name:"flag Nepal",slug:"flag_nepal",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇷":{name:"flag Nauru",slug:"flag_nauru",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇺":{name:"flag Niue",slug:"flag_niue",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇿":{name:"flag New Zealand",slug:"flag_new_zealand",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇴🇲":{name:"flag Oman",slug:"flag_oman",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇦":{name:"flag Panama",slug:"flag_panama",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇪":{name:"flag Peru",slug:"flag_peru",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇫":{name:"flag French Polynesia",slug:"flag_french_polynesia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇬":{name:"flag Papua New Guinea",slug:"flag_papua_new_guinea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇭":{name:"flag Philippines",slug:"flag_philippines",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇰":{name:"flag Pakistan",slug:"flag_pakistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇱":{name:"flag Poland",slug:"flag_poland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇲":{name:"flag St. Pierre & Miquelon",slug:"flag_st_pierre_miquelon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇳":{name:"flag Pitcairn Islands",slug:"flag_pitcairn_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇷":{name:"flag Puerto Rico",slug:"flag_puerto_rico",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇸":{name:"flag Palestinian Territories",slug:"flag_palestinian_territories",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇹":{name:"flag Portugal",slug:"flag_portugal",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇼":{name:"flag Palau",slug:"flag_palau",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇾":{name:"flag Paraguay",slug:"flag_paraguay",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇶🇦":{name:"flag Qatar",slug:"flag_qatar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇪":{name:"flag Réunion",slug:"flag_reunion",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇴":{name:"flag Romania",slug:"flag_romania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇸":{name:"flag Serbia",slug:"flag_serbia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇺":{name:"flag Russia",slug:"flag_russia",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇷🇼":{name:"flag Rwanda",slug:"flag_rwanda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇦":{name:"flag Saudi Arabia",slug:"flag_saudi_arabia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇧":{name:"flag Solomon Islands",slug:"flag_solomon_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇨":{name:"flag Seychelles",slug:"flag_seychelles",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇩":{name:"flag Sudan",slug:"flag_sudan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇪":{name:"flag Sweden",slug:"flag_sweden",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇬":{name:"flag Singapore",slug:"flag_singapore",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇭":{name:"flag St. Helena",slug:"flag_st_helena",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇮":{name:"flag Slovenia",slug:"flag_slovenia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇯":{name:"flag Svalbard & Jan Mayen",slug:"flag_svalbard_jan_mayen",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇰":{name:"flag Slovakia",slug:"flag_slovakia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇱":{name:"flag Sierra Leone",slug:"flag_sierra_leone",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇲":{name:"flag San Marino",slug:"flag_san_marino",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇳":{name:"flag Senegal",slug:"flag_senegal",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇴":{name:"flag Somalia",slug:"flag_somalia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇷":{name:"flag Suriname",slug:"flag_suriname",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇸":{name:"flag South Sudan",slug:"flag_south_sudan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇹":{name:"flag São Tomé & Príncipe",slug:"flag_sao_tome_principe",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇻":{name:"flag El Salvador",slug:"flag_el_salvador",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇽":{name:"flag Sint Maarten",slug:"flag_sint_maarten",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇾":{name:"flag Syria",slug:"flag_syria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇿":{name:"flag Eswatini",slug:"flag_eswatini",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇦":{name:"flag Tristan da Cunha",slug:"flag_tristan_da_cunha",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇨":{name:"flag Turks & Caicos Islands",slug:"flag_turks_caicos_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇩":{name:"flag Chad",slug:"flag_chad",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇫":{name:"flag French Southern Territories",slug:"flag_french_southern_territories",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇬":{name:"flag Togo",slug:"flag_togo",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇭":{name:"flag Thailand",slug:"flag_thailand",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇯":{name:"flag Tajikistan",slug:"flag_tajikistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇰":{name:"flag Tokelau",slug:"flag_tokelau",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇱":{name:"flag Timor-Leste",slug:"flag_timor_leste",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇲":{name:"flag Turkmenistan",slug:"flag_turkmenistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇳":{name:"flag Tunisia",slug:"flag_tunisia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇴":{name:"flag Tonga",slug:"flag_tonga",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇷":{name:"flag Türkiye",slug:"flag_turkiye",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇹":{name:"flag Trinidad & Tobago",slug:"flag_trinidad_tobago",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇻":{name:"flag Tuvalu",slug:"flag_tuvalu",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇼":{name:"flag Taiwan",slug:"flag_taiwan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇿":{name:"flag Tanzania",slug:"flag_tanzania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇦":{name:"flag Ukraine",slug:"flag_ukraine",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇬":{name:"flag Uganda",slug:"flag_uganda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇲":{name:"flag U.S. Outlying Islands",slug:"flag_u_s_outlying_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇳":{name:"flag United Nations",slug:"flag_united_nations",group:"Flags",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🇺🇸":{name:"flag United States",slug:"flag_united_states",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇺🇾":{name:"flag Uruguay",slug:"flag_uruguay",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇿":{name:"flag Uzbekistan",slug:"flag_uzbekistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇦":{name:"flag Vatican City",slug:"flag_vatican_city",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇨":{name:"flag St. Vincent & Grenadines",slug:"flag_st_vincent_grenadines",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇪":{name:"flag Venezuela",slug:"flag_venezuela",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇬":{name:"flag British Virgin Islands",slug:"flag_british_virgin_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇮":{name:"flag U.S. Virgin Islands",slug:"flag_u_s_virgin_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇳":{name:"flag Vietnam",slug:"flag_vietnam",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇺":{name:"flag Vanuatu",slug:"flag_vanuatu",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇼🇫":{name:"flag Wallis & Futuna",slug:"flag_wallis_futuna",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇼🇸":{name:"flag Samoa",slug:"flag_samoa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇽🇰":{name:"flag Kosovo",slug:"flag_kosovo",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇾🇪":{name:"flag Yemen",slug:"flag_yemen",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇾🇹":{name:"flag Mayotte",slug:"flag_mayotte",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇿🇦":{name:"flag South Africa",slug:"flag_south_africa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇿🇲":{name:"flag Zambia",slug:"flag_zambia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇿🇼":{name:"flag Zimbabwe",slug:"flag_zimbabwe",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🏴󠁧󠁢󠁥󠁮󠁧󠁿":{name:"flag England",slug:"flag_england",group:"Flags",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🏴󠁧󠁢󠁳󠁣󠁴󠁿":{name:"flag Scotland",slug:"flag_scotland",group:"Flags",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🏴󠁧󠁢󠁷󠁬󠁳󠁿":{name:"flag Wales",slug:"flag_wales",group:"Flags",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1}};function kT(o,e){const t=o.target;x(e,D(t.value))}var ST=(o,e)=>e("recent"),CT=re("<button>Recent</button>"),PT=(o,e,t)=>e(t()),IT=re("<button> </button>"),MT=re('<div class="flex border-b border-base-content/20 overflow-x-auto"><!> <!></div>'),TT=(o,e,t)=>e(n(t).emoji),AT=re('<button class="w-8 h-8 flex items-center justify-center text-lg hover:bg-base-200 rounded transition-colors"> </button>'),LT=(o,e,t)=>e(n(t)),zT=re('<button class="w-8 h-8 flex items-center justify-center text-lg hover:bg-base-200 rounded transition-colors"> </button>'),FT=(o,e,t)=>e(n(t).emoji),$T=re('<button class="w-8 h-8 flex items-center justify-center text-lg hover:bg-base-200 rounded transition-colors"> </button>'),DT=re('<div class="text-center text-base-content/60 py-8">No emojis found</div>'),ET=re('<div class="emoji-picker fixed z-50 bg-base-100 border border-base-content/20 rounded-lg shadow-lg svelte-hsh18a"><div class="p-3 border-b border-base-content/20"><input type="text" placeholder="Search emojis..." class="input input-sm w-full bg-base-200"></div> <!> <div class="p-2 overflow-y-auto" style="height: calc(100% - 120px);"><div class="grid grid-cols-8 gap-1"><!></div> <!></div></div>');function NT(o,e){Mc(e,!0);const t=Au(),s=()=>ua(l,"$recentlyUsed",t),i=sp();let r=Qs(e,"show",15,!1),a=Qs(e,"position",27,()=>D({x:0,y:0}));const l=A1("emoji-recently-used",[]);let c=ee(""),d=ee("smileys");const g=(()=>{const C={smileys:{name:"Smileys & Emotion",emojis:[]},people:{name:"People & Body",emojis:[]},animals:{name:"Animals & Nature",emojis:[]},food:{name:"Food & Drink",emojis:[]},activities:{name:"Activities",emojis:[]},travel:{name:"Travel & Places",emojis:[]},objects:{name:"Objects",emojis:[]},symbols:{name:"Symbols",emojis:[]},flags:{name:"Flags",emojis:[]}};return Object.entries(wT).forEach(([T,z])=>{var F;if(!T||!z.name)return;const j={emoji:T,name:z.name,keywords:z.keywords||[]},B=((F=z.group)==null?void 0:F.toLowerCase())||"",$=z.name.toLowerCase();B.includes("smileys")||B.includes("emotion")||$.includes("face")||$.includes("smile")||$.includes("laugh")||$.includes("cry")?C.smileys.emojis.push(j):B.includes("people")||B.includes("body")||$.includes("hand")||$.includes("body")||$.includes("person")||$.includes("man")||$.includes("woman")?C.people.emojis.push(j):B.includes("animals")||B.includes("nature")||$.includes("animal")||$.includes("cat")||$.includes("dog")||$.includes("bird")||$.includes("plant")||$.includes("tree")?C.animals.emojis.push(j):B.includes("food")||B.includes("drink")||$.includes("food")||$.includes("fruit")||$.includes("drink")||$.includes("coffee")||$.includes("pizza")?C.food.emojis.push(j):B.includes("activities")||B.includes("sport")||$.includes("sport")||$.includes("ball")||$.includes("game")?C.activities.emojis.push(j):B.includes("travel")||B.includes("places")||$.includes("car")||$.includes("plane")||$.includes("train")||$.includes("building")?C.travel.emojis.push(j):B.includes("objects")||$.includes("phone")||$.includes("computer")||$.includes("book")||$.includes("tool")?C.objects.emojis.push(j):B.includes("flags")||$.includes("flag")?C.flags.emojis.push(j):C.symbols.emojis.push(j)}),C})(),_=Qe(()=>{var C;return n(c)?Object.values(g).flatMap(T=>T.emojis).filter(T=>T.emoji.includes(n(c))||T.name.toLowerCase().includes(n(c).toLowerCase())||T.keywords.some(z=>z.toLowerCase().includes(n(c).toLowerCase()))):((C=g[n(d)])==null?void 0:C.emojis)||[]});function y(C){l.update(T=>{const z=T.filter(j=>j!==C);return[C,...z].slice(0,20)}),i("select",{emoji:C}),r(!1)}function k(C){x(d,D(C)),x(c,"")}function S(C){C.target.closest(".emoji-picker")||r(!1)}hp(()=>{if(typeof document<"u")return document.addEventListener("click",S),()=>{document.removeEventListener("click",S)}});var M=So(),I=Rt(M);Te(I,r,C=>{var T=ET(),z=m(T),j=m(z);Jt(j),j.__input=[kT,c],f(z);var B=p(z,2);Te(B,()=>!n(c),Y=>{var Z=MT(),ne=m(Z);Te(ne,()=>s().length>0,oe=>{var U=CT();U.__click=[ST,k],Se(()=>Gn(U,`px-3 py-2 text-xs whitespace-nowrap border-b-2 transition-colors ${(n(d)==="recent"?"border-primary text-primary":"border-transparent hover:text-primary")??""}`)),O(oe,U)});var te=p(ne,2);Vs(te,17,()=>Object.entries(g),_n,(oe,U)=>{let J=()=>n(U)[0],se=()=>n(U)[1];var W=IT();W.__click=[PT,k,J];var le=m(W,!0);f(W),Se(()=>{Gn(W,`px-3 py-2 text-xs whitespace-nowrap border-b-2 transition-colors ${(n(d)===J()?"border-primary text-primary":"border-transparent hover:text-primary")??""}`),Ve(le,se().name)}),O(oe,W)}),f(Z),O(Y,Z)});var $=p(B,2),F=m($),V=m(F);Te(V,()=>n(c),Y=>{var Z=So(),ne=Rt(Z);Vs(ne,17,()=>n(_),_n,(te,oe)=>{var U=AT();U.__click=[TT,y,oe];var J=m(U,!0);f(U),Se(()=>{Nt(U,"title",n(oe).name),Ve(J,n(oe).emoji)}),O(te,U)}),O(Y,Z)},Y=>{var Z=So(),ne=Rt(Z);Te(ne,()=>n(d)==="recent"&&s().length>0,te=>{var oe=So(),U=Rt(oe);Vs(U,1,s,_n,(J,se)=>{var W=zT();W.__click=[LT,y,se];var le=m(W,!0);f(W),Se(()=>{Nt(W,"title",n(se)),Ve(le,n(se))}),O(J,W)}),O(te,oe)},te=>{var oe=So(),U=Rt(oe);Vs(U,17,()=>n(_),_n,(J,se)=>{var W=$T();W.__click=[FT,y,se];var le=m(W,!0);f(W),Se(()=>{Nt(W,"title",n(se).name),Ve(le,n(se).emoji)}),O(J,W)}),O(te,oe)},!0),O(Y,Z)}),f(F);var K=p(F,2);Te(K,()=>n(c)&&n(_).length===0,Y=>{var Z=DT();O(Y,Z)}),f($),f(T),Se(()=>{Nt(T,"style",`left: ${a().x??""}px; top: ${a().y??""}px; width: 320px; height: 400px;`),cu(j,n(c))}),O(C,T)}),O(o,M),Tc()}Hd(["input","click"]);function jT(o,e){e("reset")}function RT(o,e){e("confirm")}function BT(o,e){o.target.classList.contains("modal-backdrop")&&e()}var OT=o=>o.stopPropagation(),VT=re(`<div><input type="checkbox" class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 focus:ring-2
                       sm:w-4 sm:h-4 touch-manipulation"> <input type="number" step="0.001" min="0" max="10"> <button class="w-10 h-10 rounded border-2 border-gray-300 hover:border-gray-400 transition-colors
                       sm:w-8 sm:h-8 touch-manipulation" title="Change color"></button> <span> </span></div>`),WT=re(`<div class="fixed inset-0 bg-transparent flex items-center justify-center z-[9999] modal-backdrop"><div><div><h3>Fibonacci Settings</h3> <button title="Close"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4 max-h-[60vh] overflow-y-auto svelte-ah2kky"><div class="space-y-3"></div></div> <div><button>🔁 Reset</button> <div class="flex gap-3 w-full sm:w-auto sm:gap-2"><button>❌ Cancel</button> <button class="px-6 py-3 text-sm rounded bg-blue-600 hover:bg-blue-700 text-white transition-colors
                   touch-manipulation min-h-[44px] flex-1 sm:flex-none
                   sm:px-4 sm:py-2 sm:min-h-[36px]">✅ Confirm</button></div></div></div></div>`),qT=re('<div class="fixed z-[10000]"><!></div>'),HT=re("<!> <!>",1);function GT(o,e){Mc(e,!1);let t=Qs(e,"visible",8,!1),s=Qs(e,"levels",24,()=>[]),i=Qs(e,"theme",8,"dark");const r=sp();let a=nd(!1),l=nd(-1),c=nd({x:0,y:0});function d(I,C,T){r("levelChange",{index:I,field:C,value:T})}function v(I,C){x(l,C),x(c,{x:I.clientX,y:I.clientY}),x(a,!0)}function g(I){n(l)>=0&&d(n(l),"color",I.detail),x(a,!1)}function _(){x(a,!1),x(l,-1)}function y(){r("cancel")}Sp();var k=HT(),S=Rt(k);Te(S,t,I=>{var C=WT();C.__click=[BT,y];var T=m(C);T.__click=[OT];var z=m(T),j=m(z),B=p(j,2);B.__click=y;var $=m(B);f(B),f(z);var F=p(z,2),V=m(F);Vs(V,5,s,_n,(oe,U,J)=>{var se=VT(),W=m(se);Jt(W),W.__change=()=>d(J,"visible",n(U).visible);var le=p(W,2);Jt(le),le.__change=()=>d(J,"value",n(U).value);var ye=p(le,2);ye.__click=Ke=>v(Ke,J);var Ce=p(ye,2),Re=m(Ce,!0);Se(()=>Ve(Re,n(U).value===0?"Start":n(U).value===1?"End":`${(n(U).value*100).toFixed(1)}%`)),f(Ce),f(se),Se(()=>{Gn(se,`flex items-center gap-3 p-3 rounded-lg ${(i()==="dark"?"bg-[#2a2a2a]":"bg-gray-50")??""}
                        sm:gap-4 sm:p-4`),Gn(le,`w-24 px-3 py-2 text-sm rounded border touch-manipulation
                       sm:w-20 sm:px-2 sm:py-1
                       ${(i()==="dark"?"bg-[#3a3a3a] border-[#555] text-white focus:border-blue-500":"bg-white border-gray-300 text-gray-900 focus:border-blue-500")??""} 
                       focus:outline-none focus:ring-1 focus:ring-blue-500`),Nt(ye,"style",`background-color: ${n(U).color??""}`),Gn(Ce,`text-sm ${(i()==="dark"?"text-gray-300":"text-gray-700")??""} flex-1
                           sm:text-sm`)}),_v(W,()=>n(U).visible,Ke=>(n(U).visible=Ke,Z1(()=>s()))),Ho(le,()=>n(U).value,Ke=>(n(U).value=Ke,Z1(()=>s()))),O(oe,se)}),f(V),f(F);var K=p(F,2),Y=m(K);Y.__click=[jT,r];var Z=p(Y,2),ne=m(Z);ne.__click=y;var te=p(ne,2);te.__click=[RT,r],f(Z),f(K),f(T),f(C),Se(()=>{Gn(T,`relative ${(i()==="dark"?"bg-[#1a1a1a] border-[#404040]":"bg-white border-gray-200")??""} 
             rounded-lg shadow-xl border max-w-md w-full mx-4 max-h-[80vh] overflow-hidden
             sm:max-w-lg md:max-w-xl lg:max-w-2xl svelte-ah2kky`),Gn(z,`flex items-center justify-between p-4 border-b ${(i()==="dark"?"border-[#404040]":"border-gray-200")??""}`),Gn(j,`text-lg font-semibold ${(i()==="dark"?"text-white":"text-gray-900")??""}`),Gn(B,`w-8 h-8 rounded-full ${(i()==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} 
                 flex items-center justify-center transition-colors`),P0($,`w-5 h-5 ${(i()==="dark"?"text-gray-400":"text-gray-600")??""}`),Gn(K,`flex items-center justify-between p-4 border-t ${(i()==="dark"?"border-[#404040]":"border-gray-200")??""}
                  sm:flex-row flex-col gap-3 sm:gap-0`),Gn(Y,`px-6 py-3 text-sm rounded ${(i()==="dark"?"bg-gray-600 hover:bg-gray-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700")??""} 
                 transition-colors touch-manipulation min-h-[44px] w-full sm:w-auto
                 sm:px-4 sm:py-2 sm:min-h-[36px]`),Gn(ne,`px-6 py-3 text-sm rounded ${(i()==="dark"?"bg-gray-600 hover:bg-gray-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700")??""} 
                   transition-colors touch-manipulation min-h-[44px] flex-1 sm:flex-none
                   sm:px-4 sm:py-2 sm:min-h-[36px]`)}),O(I,C)});var M=p(S,2);Te(M,()=>n(a),I=>{var C=qT(),T=m(C),z=kp(()=>{var j;return((j=s()[n(l)])==null?void 0:j.color)||"#FF6B6B"});iv(T,{get selectedColor(){return n(z)},get show(){return n(a)},$$events:{colorChange:g,close:_}}),f(C),Se(()=>Nt(C,"style",`left: ${n(c).x??""}px; top: ${n(c).y??""}px;`)),O(I,C)}),O(o,k),Tc()}Hd(["click","change"]);const D1=op(!1);function xv(){D1.set(!0)}function z_(){D1.set(!1)}function F_(){return fp(D1)===!0}function UT(o,e,t){e.fontWeight=e.fontWeight==="bold"?"normal":"bold",t()}function YT(o,e){e(o)}function KT(o,e,t,s,i,r,a){o.stopPropagation();const l=o.target.getBoundingClientRect();x(e,"line"),x(t,D(s.color)),x(i,D(s.opacity)),x(r,D({x:Math.max(10,Math.min(l.left,window.innerWidth-320)),y:Math.max(10,Math.min(l.bottom+5,window.innerHeight-400))})),x(a,!0)}function ZT(o,e,t,s,i,r,a){x(e,"textColor"),x(t,D(s.textColor)),x(i,D(n(r))),x(a,!0)}function XT(o,e,t,s,i,r,a){x(e,"textBg"),x(t,D(s.backgroundColor)),x(i,D(n(r))),x(a,!0)}function JT(o,e){o.preventDefault(),o.stopPropagation(),e()}var QT=re('<div class="pro-active-indicator absolute bottom-[3px] left-1/2 transform -translate-x-1/2 w-[4px] h-[4px] rounded-full svelte-t6isn6" style="background: var(--menu-accent);"></div>'),eA=(o,e,t)=>e(n(t)),tA=re('<div class="submenu-portal svelte-t6isn6"></div>'),oA=re(`<div class="pro-submenu-arrow flex items-center justify-center absolute top-1/2 right-0 transform -translate-y-1/2
               w-5 h-5 opacity-0 group-hover:opacity-100 hover:opacity-100 transition-all duration-150 cubic-bezier(0.4, 0, 0.2, 1)
               bg-[var(--menu-btn-bg)] border border-[var(--menu-btn-border)] rounded-full
               hover:bg-[var(--menu-hover-bg)] hover:border-[var(--menu-btn-hover-border)] cursor-pointer z-20 backdrop-blur-[8px] svelte-t6isn6" style="backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><svg class="w-2.5 h-2.5 transition-all duration-150 cubic-bezier(0.4, 0, 0.2, 1) text-[var(--menu-text)] svelte-t6isn6" viewBox="0 0 8 12" fill="currentColor"><path d="M1.705 0.295C1.315 -0.095 0.685 -0.095 0.295 0.295C-0.095 0.685 -0.095 1.315 0.295 1.705L5.59 7L0.295 12.295C-0.095 12.685 -0.095 13.315 0.295 13.705C0.685 14.095 1.315 14.095 1.705 13.705L7.705 7.705C8.095 7.315 8.095 6.685 7.705 6.295L1.705 0.295Z" class="svelte-t6isn6"></path></svg></div> <!>`,1),sA=re(`<div class="group flex flex-row items-center justify-center relative w-full mt-2 cursor-pointer transition-all duration-200 ease-out svelte-t6isn6"><div class="pro-draw-button w-[36px] h-[36px] rounded-[8px] flex items-center justify-center relative overflow-hidden transition-all duration-200 cubic-bezier(0.4, 0, 0.2, 1)
             isolation-isolate svelte-t6isn6" style="background: var(--menu-btn-bg); border: 1px solid var(--menu-btn-border); backdrop-filter: blur(16px) saturate(160%); -webkit-backdrop-filter: blur(16px) saturate(160%);"><div class="button-hover-overlay absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200 rounded-[8px] svelte-t6isn6" style="background: var(--menu-hover-bg);"></div> <!> <!></div> <!></div>`),nA=re('<div class="w-full h-[2px] mt-3 mb-2 opacity-90 svelte-t6isn6" style="background: linear-gradient(to right, transparent, var(--menu-accent), transparent); box-shadow: 0 0 10px var(--menu-glow);"></div>'),iA=o=>o.stopPropagation(),rA=re("<!> <!>",1),aA=o=>o.preventDefault(),lA=re('<button class="drawbar-scroll-arrow svelte-t6isn6" title="Scroll to see more tools" aria-label="Scroll down" type="button"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-t6isn6"><polyline points="6 9 12 15 18 9"></polyline></svg></button>'),cA=(o,e,t,s,i,r)=>n(e)==="mode"?t(n(s).key):i(r.findIndex(a=>a.key===n(e)),n(s).key),dA=re(`<li class="px-4 py-3 flex flex-row items-center gap-3 transition-all duration-200 ease-in-out
                   text-[var(--menu-text)] hover:bg-[var(--menu-hover-bg)] hover:text-[var(--menu-glow)] cursor-pointer svelte-t6isn6"><!> <span class="text-sm font-medium"> </span></li>`),uA=re(`<ul class="premium-submenu fixed min-w-[140px] max-h-[70vh] z-[9999] rounded-lg shadow-2xl border border-[var(--menu-btn-border)] overflow-y-auto
                bg-[var(--menu-bg)] backdrop-blur-sm transition-all duration-300 ease-in-out svelte-t6isn6"></ul>`),pA=(o,e,t)=>e(n(t).key),vA=re(`<li class="px-4 py-3 flex flex-row items-center gap-3 transition-all duration-200 ease-in-out
                 text-[var(--menu-text)] hover:bg-[var(--menu-hover-bg)] hover:text-[var(--menu-glow)] cursor-pointer svelte-t6isn6"><!> <span class="text-sm font-medium"> </span></li>`),fA=re(`<ul class="premium-submenu fixed min-w-[140px] max-h-[70vh] z-[9999] rounded-lg shadow-2xl border border-[var(--menu-btn-border)] overflow-y-auto
              bg-[var(--menu-bg)] backdrop-blur-sm transition-all duration-300 ease-in-out svelte-t6isn6"></ul>`),mA=re("<!> <!>",1),gA=o=>o.stopPropagation(),hA=re("<option> </option>"),_A=re(`<select title="Font size"><option>8</option><option>10</option><option>11</option><option>12</option><option>14</option><option>16</option><option>18</option><option>20</option><option>22</option><option>24</option><option>32</option><option>40</option><option>52</option></select> <button title="Bold"><span class="text-xs font-bold">B</span></button> <div class="flex items-center gap-1 svelte-t6isn6"><div class="flex items-center gap-1"><button class="w-6 h-6 rounded-md border border-gray-400 dark:border-gray-600
                       cursor-pointer hover:scale-105 transition-transform touch-manipulation flex items-center justify-center svelte-t6isn6" title="Text color"><!></button> <button class="w-6 h-6 rounded-md border border-gray-400 dark:border-gray-600
                       cursor-pointer hover:scale-105 transition-transform touch-manipulation flex items-center justify-center svelte-t6isn6" title="Background color"><!></button></div> <select title="Font family"></select></div>`,1),yA=re(`<button class="w-6 h-6 rounded-md border border-gray-400 dark:border-gray-600
                 cursor-pointer hover:scale-105 transition-transform touch-manipulation svelte-t6isn6" title="Choose color"></button> <select title="Line thickness"><option>1px</option><option>2px</option><option>3px</option><option>4px</option><option>5px</option><option>6px</option><option>7px</option><option>8px</option></select> <select title="Line style"><option>Line</option><option>Dash</option><option>Dot</option></select>`,1),bA=re('<div title="Drag to move"><div class="flex flex-col gap-0.5"><div class="flex gap-0.5"><div></div> <div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div></div> <div class="flex gap-0.5"><div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div> <div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div></div> <div class="flex gap-0.5"><div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div> <div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div></div></div></div> <!>',1),xA=(o,e)=>{var t;return e(((t=o.target)==null?void 0:t.value)||"24")},wA=re('<div class="flex items-center gap-3 svelte-t6isn6"><div class="flex items-center justify-center w-8 h-8 text-lg"> </div> <div class="flex items-center gap-1 sm:gap-2 min-w-[100px] sm:min-w-[120px]"><span class="text-xs text-gray-500 dark:text-gray-400 hidden sm:inline">Size:</span> <input type="range" min="16" max="64" class="flex-1 h-2 sm:h-1 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer slider touch-manipulation svelte-t6isn6"> <span class="text-xs text-gray-500 dark:text-gray-400 w-6 text-right"> </span></div></div>'),kA=(o,e)=>{e()},SA=re('<button title="Fibonacci Settings"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></button>'),CA=(o,e)=>x(e,!n(e)),PA=o=>o.stopPropagation(),IA=(o,e,t)=>{e(),x(t,!1)},MA=(o,e,t)=>{e(),x(t,!1)},TA=(o,e,t)=>{e(),x(t,!1)},AA=re("<button>Paste</button>"),LA=re("<div><button>Clone</button> <button>Copy</button> <!></div>"),zA=(o,e,t,s)=>{e(),x(t,!1),x(s,null)},FA=re('<div><!> <!> <div class="relative svelte-t6isn6"><button title="More" aria-haspopup="true"><svg viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="5" r="2"></circle><circle cx="12" cy="12" r="2"></circle><circle cx="12" cy="19" r="2"></circle></svg></button> <!></div> <button title="Delete"><svg fill="none" stroke="currentColor" vector-effect="non-scaling-stroke" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>'),$A=re('<div class="fixed z-[200001] bg-red-500 hover:bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center cursor-pointer shadow-lg transition-all duration-200" title="Delete selected drawing"><svg class="w-4 h-4" fill="none" stroke="currentColor" vector-effect="non-scaling-stroke" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></div>'),DA=re('<div class="drawbar-wrapper svelte-t6isn6"><div class="drawbar-container h-full box-border border-r border-l-0 transition-all duration-200 ease-in-out overflow-y-auto scrollbar-hidden svelte-t6isn6" style="background: var(--menu-bg); box-shadow: var(--menu-shadow); backdrop-filter: blur(18px) saturate(170%); -webkit-backdrop-filter: blur(18px) saturate(170%); border-left: none;"><!> <!> <!> <!> <!> <!> <!> <!></div> <!></div> <!> <!> <!> <!>  <!> <!>',1);function EA(o,e){Mc(e,!0);const t=Au(),s=()=>ua(wt,"$chart",t),i=()=>ua(Gt,"$undoRedoState",t),r=()=>ua(it,"$save",t),a=(ue,Fe=am,ut=am,Xe,ht,ao,It)=>{let eo=kp(()=>jg(Xe==null?void 0:Xe(),"")),Mo=kp(()=>jg(ht==null?void 0:ht(),()=>[],!0)),ho=kp(()=>jg(ao==null?void 0:ao(),!1)),to=kp(()=>jg(It==null?void 0:It(),!1));var ds=sA(),js=m(ds);js.__click=function(...Rs){var Zs;(Zs=Fe())==null||Zs.apply(this,Rs)};var Si=p(m(js),2),$r=Qe(()=>fc(ut())),pa=Qe(()=>n(eo)==="mode"&&n(v)===n(d));bv(Si,{get name(){return n($r)},get active(){return n(pa)},size:24,class:"relative z-10 transition-all duration-200 group-hover:scale-[1.05]"});var En=p(Si,2);Te(En,()=>n(eo)==="mode"&&n(v)===n(d)||n(eo)&&n(eo)===n(c),Rs=>{var Zs=QT();O(Rs,Zs)}),f(js);var za=p(js,2);Te(za,()=>n(Mo).length>0,Rs=>{var Zs=oA(),gn=Rt(Zs);gn.__click=[eA,ci,eo];var Wn=m(gn);f(gn);var Tn=p(gn,2);Te(Tn,()=>n(eo)===n(c),Ko=>{var Qt=tA();O(Ko,Qt)}),Se(()=>ii(Wn,"rotate-180",n(c)===n(eo))),O(Rs,Zs)}),f(ds),Se(()=>{Nt(ds,"style",`margin-top: ${(n(ho)||n(to)?"12px":"")??""}`),Nt(js,"title",n(eo)||ut()),Nt(js,"aria-label",n(eo)||ut()),ii(js,"active-btn",n(eo)==="mode"&&n(v)===n(d)||n(eo)&&n(eo)===n(c))}),O(ue,ds)},l=ue=>{var Fe=nA();O(ue,Fe)};let c=ee(""),d=ee("weakMagnet"),v=ee("normal"),g=ee(!1),_=ee(!0),y=D([]),k=ee(""),S=ee(null),M=ee(null),I=ee(!1),C=ee(!1),T=ee(null),z=D({thickness:"1",style:"solid",color:"#1677FF",opacity:100}),j=ee(!1),B=D({x:0,y:0}),$=ee(null),F=ee(0),V=ee(null),K=ee(!1),Y=ee(!1),Z=ee(null),ne=0,te=ee(!1),oe=ee("line"),U=ee("#1677FF"),J=ee(100),se=ee(!1),W=ee(D({x:0,y:0})),le=ee(D({x:0,y:0}));const ye="system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif";let Ce=D({fontSize:"32",fontWeight:"bold",textColor:"#FFFFFF",backgroundColor:"#A00000",fontFamily:ye}),Re=ee(100),Ke=ee(20),st=ee(!1),vt=ee(void 0);function Je(ue){const Fe=ue.replace("#",""),ut=parseInt(Fe.slice(0,2),16),Xe=parseInt(Fe.slice(2,4),16),ht=parseInt(Fe.slice(4,6),16);return{r:ut,g:Xe,b:ht}}function ot(ue){if(!ue||typeof ue!="string"||!ue.startsWith("#"))return"#000000";const Fe=ue.length===9?ue.slice(0,7):ue,{r:ut,g:Xe,b:ht}=Je(Fe);return .2126*ut+.7152*Xe+.0722*ht>128?"#000000":"#FFFFFF"}const nt=[{label:"System",value:ye},{label:"Arial",value:"Arial, Helvetica, sans-serif"},{label:"Helvetica",value:"'Helvetica Neue', Arial, sans-serif"},{label:"Segoe UI",value:"'Segoe UI', Tahoma, Geneva, sans-serif"},{label:"Roboto",value:"Roboto, system-ui, -apple-system, 'Segoe UI', Arial, sans-serif"},{label:"Times New Roman",value:"'Times New Roman', Times, serif"},{label:"Georgia",value:"Georgia, 'Times New Roman', serif"},{label:"Garamond",value:"Garamond, 'Times New Roman', serif"},{label:"Palatino",value:"'Palatino Linotype', 'Book Antiqua', Palatino, serif"},{label:"Verdana",value:"Verdana, Geneva, sans-serif"},{label:"Tahoma",value:"Tahoma, Geneva, sans-serif"},{label:"Trebuchet MS",value:"'Trebuchet MS', 'Lucida Grande', sans-serif"},{label:"Impact",value:"Impact, Charcoal, sans-serif"},{label:"Lucida Sans",value:"'Lucida Sans Unicode', 'Lucida Grande', sans-serif"},{label:"Century Gothic",value:"'Century Gothic', AppleGothic, sans-serif"},{label:"Optima",value:"Optima, 'Segoe', 'Segoe UI', sans-serif"},{label:"Comic Sans MS",value:"'Comic Sans MS', 'Comic Sans', cursive, sans-serif"},{label:"Avenir",value:"'Avenir Next', Avenir, sans-serif"},{label:"Futura",value:"Futura, 'Trebuchet MS', Arial, sans-serif"},{label:"Menlo",value:"Menlo, Monaco, Consolas, 'Courier New', monospace"},{label:"Consolas",value:"Consolas, 'Liberation Mono', Menlo, Monaco, monospace"},{label:"Courier New",value:"'Courier New', Courier, monospace"}];let tt=ee(!1),Ze=ee(D([{value:0,visible:!0,color:"#FF6B6B"},{value:.236,visible:!0,color:"#4ECDC4"},{value:.382,visible:!0,color:"#45B7D1"},{value:.5,visible:!0,color:"#96CEB4"},{value:.618,visible:!0,color:"#FFEAA7"},{value:1,visible:!0,color:"#98D8C8"},{value:1.618,visible:!0,color:"#85C1E9"},{value:.786,visible:!1,color:"#DDA0DD"},{value:1.272,visible:!1,color:"#F7DC6F"},{value:1.414,visible:!1,color:"#BB8FCE"},{value:2,visible:!1,color:"#FFB6C1"},{value:2.272,visible:!1,color:"#98FB98"},{value:2.414,visible:!1,color:"#F0E68C"},{value:2.618,visible:!1,color:"#F8C471"},{value:3,visible:!1,color:"#DEB887"},{value:3.618,visible:!1,color:"#CD853F"},{value:4,visible:!1,color:"#D2691E"},{value:4.236,visible:!1,color:"#A0522D"},{value:4.272,visible:!1,color:"#8B4513"},{value:4.618,visible:!1,color:"#654321"}])),ct=ee(D([{value:0,visible:!0,color:"#FF6B6B"},{value:.236,visible:!0,color:"#4ECDC4"},{value:.382,visible:!0,color:"#45B7D1"},{value:.5,visible:!0,color:"#96CEB4"},{value:.618,visible:!0,color:"#FFEAA7"},{value:1,visible:!0,color:"#98D8C8"},{value:1.618,visible:!0,color:"#85C1E9"},{value:.786,visible:!1,color:"#DDA0DD"},{value:1.272,visible:!1,color:"#F7DC6F"},{value:1.414,visible:!1,color:"#BB8FCE"},{value:2,visible:!1,color:"#FFB6C1"},{value:2.272,visible:!1,color:"#98FB98"},{value:2.414,visible:!1,color:"#F0E68C"},{value:2.618,visible:!1,color:"#F8C471"},{value:3,visible:!1,color:"#DEB887"},{value:3.618,visible:!1,color:"#CD853F"},{value:4,visible:!1,color:"#D2691E"},{value:4.236,visible:!1,color:"#A0522D"},{value:4.272,visible:!1,color:"#8B4513"},{value:4.618,visible:!1,color:"#654321"}])),Ge=null;function pt(){var ut;Ge||(Ge=document.querySelector(".chart-container")||document.querySelector("[data-chart-container]")||document.querySelector(".kline-chart")||document.querySelector("#chart")||((ut=document.querySelector("canvas"))==null?void 0:ut.parentElement)||document.body);const ue=Ge==null?void 0:Ge.getBoundingClientRect();if(!ue)return{left:0,top:0,width:window.innerWidth,height:window.innerHeight};const Fe=10;return{left:ue.left+Fe,top:ue.top+Fe,width:ue.width-Fe*2,height:ue.height-Fe*2}}function ce(ue){try{const Fe=pt();Ge&&(Ge.style.cursor=ue??"default")}catch{}}function we(ue){var H,Me,Ue,yt,St;if(!ue||!ue.points||ue.points.length===0||!s())return null;const Fe=ue.points[0],ut=ue.paneId||"candle_pane",Xe=(H=s())==null?void 0:H.convertToPixel(Fe,{paneId:ut}),ht=(Ge||document.body).getBoundingClientRect();if(!Xe||typeof Xe.x!="number"||typeof Xe.y!="number"||!ht)return null;const ao=pt(),It=window.innerWidth<=768,eo=It?Math.min(300,window.innerWidth-40):300,Mo=It?48:60,ho=It?32:24,to=(Me=ue.extendData)!=null&&Me.editing?Tm.getEditorRect():null,ds=to?to.width:((Ue=ue.extendData)==null?void 0:Ue.boxWidth)??160,js=to?to.height:((yt=ue.extendData)==null?void 0:yt.boxHeight)??Math.round((((St=ue.extendData)==null?void 0:St.fontSize)??32)*1.4)+8,Si=Xe.x-ds/2,$r=Xe.x+ds/2,pa=Xe.y-Math.round(js/2),En=to?to.left:ht.left+Si,za=to?to.right:ht.left+$r,Rs=to?to.top:ht.top+pa,Zs=to?to.bottom:Rs+js;let gn=[{x:za+ho,y:Rs},{x:En,y:Zs+ho},{x:En-eo-ho,y:Rs},{x:En,y:Rs-Mo-ho}];It&&(gn=[{x:En,y:Zs+ho},{x:En,y:Rs-Mo-ho},{x:za+ho,y:Rs},{x:En-eo-ho,y:Rs}]);const Wn=ht.left+(It?4:8),Tn=ht.top+(It?4:8),Ko=ht.left+ao.width-eo-(It?4:8),Qt=ht.top+ao.height-Mo-(It?4:8);for(const lo of gn){let he=Math.max(Wn,Math.min(lo.x,Ko)),ke=Math.max(Tn,Math.min(lo.y,Qt));const Ne=ke<Zs&&ke+Mo>Rs,ie=he<za&&he+eo>En;if(!(Ne&&ie))return{x:he,y:ke}}if(It){let lo=Math.max(Wn,Math.min(En,Ko)),he=Math.max(Tn,Math.min(Zs+ho,Qt));return{x:lo,y:he}}else{let lo=Math.max(Wn,Math.min(za+ho,Ko)),he=Math.max(Tn,Math.min(Rs,Qt));return{x:lo,y:he}}}function ze(ue){function Fe(Xe){const ht=ue.scrollTop>0,ao=ue.scrollTop<ue.scrollHeight-ue.clientHeight;(Xe.deltaY<0&&!ht||Xe.deltaY>0&&!ao)&&Xe.preventDefault(),Xe.stopPropagation()}function ut(Xe){Xe.preventDefault(),Xe.stopPropagation()}return ue.addEventListener("wheel",Fe,{passive:!1,capture:!0}),ue.addEventListener("touchmove",ut,{passive:!1,capture:!0}),{destroy(){ue.removeEventListener("wheel",Fe,{capture:!0}),ue.removeEventListener("touchmove",ut,{capture:!0})}}}function dt(){var ue,Fe;if(n(C)&&n(T)&&n($)&&!(n(T).name==="text"&&((ue=n(T).extendData)!=null&&ue.editing))&&n(T).points&&n(T).points.length>0){const ut=n(T).points[0],Xe=(Fe=s())==null?void 0:Fe.convertToPixel(ut,{paneId:"candle_pane"});if(Xe&&typeof Xe=="object"&&"x"in Xe&&"y"in Xe&&Xe.x!==void 0&&Xe.y!==void 0){const It=Math.max(10,Math.min(Xe.x-80,window.innerWidth-300)),eo=Math.max(10,Math.min(Xe.y-30,window.innerHeight-200));x($,D({x:It,y:eo}))}}n(te)&&x(le,D({x:Math.max(10,Math.min(n(le).x,window.innerWidth-320)),y:Math.max(10,Math.min(n(le).y,window.innerHeight-400))}))}function qe(){if(typeof localStorage<"u"){const ue=localStorage.getItem("contextMenuPosition");if(ue)try{x(Z,D(JSON.parse(ue)))}catch(Fe){console.log("Error loading saved position:",Fe)}}}function me(ue){typeof localStorage<"u"&&(localStorage.setItem("contextMenuPosition",JSON.stringify(ue)),x(Z,D(ue)))}const Q="drawing_tools",it=vc("save"),Vt=vc("ctx"),wt=vc("chart"),Yt=op({}),At=vc("drawingManager"),Gt=nu.getState();let no=ee(!1),Do=ee(!1);zr(()=>{const ue=i();x(no,ue.undoStack.length>0),x(Do,ue.redoStack.length>0)}),zr(()=>{s()&&nu.init({chart:s(),saveStore:it,overlaysStore:Yt})});function Eo(ue){const Fe=r().symbol;return`${Fe.shortName??Fe.name??Fe.ticker}_${r().period.timeframe}_${ue}`}let bs={};const es=D([{key:"single-line",icon:"segment",list:[{key:"segment",text:"segment"},{key:"arrow",text:"arrow"},{key:"rayLine",text:"ray_line"},{key:"straightLine",text:"straight_line"},{key:"priceLine",text:"price_line"},{key:"horizontalStraightLine",text:"horizontal_straight_line"},{key:"horizontalRayLine",text:"horizontal_ray_line"},{key:"horizontalSegment",text:"horizontal_segment"},{key:"verticalStraightLine",text:"vertical_straight_line"},{key:"verticalRayLine",text:"vertical_ray_line"},{key:"verticalSegment",text:"vertical_segment"}]},{key:"more-line",icon:"priceChannelLine",list:[{key:"priceChannelLine",text:"price_channel_line"},{key:"parallelStraightLine",text:"parallel_straight_line"}]},{key:"polygon",icon:"rect",list:[{key:"circle",text:"circle"},{key:"rect",text:"rect"},{key:"parallelogram",text:"parallelogram"},{key:"triangle",text:"triangle"}]},{key:"fibonacci",icon:"fibonacciSegment",list:[{key:"fibonacciSegment",text:"fibonacci_segment"},{key:"fibonacciCircle",text:"fibonacci_circle"},{key:"fibonacciSpiral",text:"fibonacci_spiral"},{key:"fibonacciSpeedResistanceFan",text:"fibonacci_speed_resistance_fan"},{key:"fibonacciExtension",text:"fibonacci_extension"},{key:"gannBox",text:"gann_box"}]},{key:"wave",icon:"xabcd",list:[{key:"xabcd",text:"xabcd"},{key:"abcd",text:"abcd"},{key:"threeWaves",text:"three_waves"},{key:"fiveWaves",text:"five_waves"},{key:"eightWaves",text:"eight_waves"},{key:"anyWaves",text:"any_waves"}]},{key:"emoji",icon:"emoji",list:[]},{key:"text",icon:"text",list:[]}]),Li=D([{key:"weakMagnet",text:"weakMagnet"},{key:"strongMagnet",text:"strongMagnet"}]);function ci(ue){n(c)==ue?x(c,""):x(c,D(ue))}function oa(ue){var ao;let Fe=!1;const ut=mP[ue.name]??{},Xe={groupId:Q,onDrawEnd:It=>{ut.onDrawEnd&&ut.onDrawEnd(It),gt(It.overlay);const eo=Eo(It.overlay.id);if(nu.recordAddOverlay(It.overlay.id,It.overlay,eo),n(S)===It.overlay.id&&x(S,null),It.overlay.name==="text")try{x(T,D(It.overlay)),x(k,D(It.overlay.id));const Mo=we(It.overlay),ho=n(Z)||Mo;ho&&(x($,D({...ho})),x(M,D({x:ho.x,y:ho.y})),x(C,!0),x(I,!1)),s()&&Tm.startEditing(s(),It.overlay)}catch{}return!0},onPressedMoving:It=>{var eo;ut.onPressedMoving&&ut.onPressedMoving(It),Fe=!0;try{if(s()&&((eo=It.overlay)!=null&&eo.id)&&!bs[It.overlay.id]){const Mo=s().getOverlays({id:It.overlay.id});Mo&&Mo[0]&&(bs[It.overlay.id]=JSON.parse(JSON.stringify(Mo[0])))}}catch{}return!1},onPressedMoveEnd:It=>{var eo;if(!Fe)return!0;Fe=!1,gt(It.overlay);try{const Mo=bs[It.overlay.id],ho=It.overlay;if(Mo&&ho){const to=Eo(It.overlay.id);nu.recordModifyOverlay(It.overlay.id,Mo,ho,to)}}catch{}if(delete bs[It.overlay.id],n(k)===It.overlay.id&&It.overlay.points&&It.overlay.points.length>0){const Mo=It.overlay.points[0],ho=It.overlay.paneId||"candle_pane",to=(eo=s())==null?void 0:eo.convertToPixel(Mo,{paneId:ho});to&&typeof to=="object"&&"x"in to&&"y"in to&&to.x!==void 0&&to.y!==void 0&&x(M,D({x:to.x-80,y:to.y-30}))}return!0},onSelected:It=>{var eo;if(ut.onSelected&&ut.onSelected(It),ne=Date.now(),x(k,D(It.overlay.id)),x(T,D(It.overlay)),(eo=It.overlay.styles)!=null&&eo.line){const Mo=It.overlay.styles.line;z.thickness=String(Mo.size||2),z.color=Mo.color||"#1677FF",z.style=Mo.style===Oe.Dashed?"dashed":"solid"}if(It.overlay.points&&It.overlay.points.length>0){const Mo=we(It.overlay),ho=n(Z)||Mo;if(ho&&(x($,D({...ho})),x(M,D({x:ho.x,y:ho.y})),x(C,!0),x(I,!1),It.overlay.styles&&It.overlay.styles.line))if(z.thickness=String(It.overlay.styles.line.size||1),z.color=It.overlay.styles.line.color||"#1677FF",It.overlay.styles.line.style===Oe.Dashed){const to=It.overlay.styles.line.dashedValue;to&&to[0]===2&&to[1]===8?z.style="dotted":z.style="dashed"}else z.style="solid"}return!0},onDeselected:It=>(ut.onDeselected&&ut.onDeselected(It),x(k,""),x(I,!1),x(C,!1),x(Y,!1),x(M,null),x(T,null),!0),onRemoved:It=>{ut.onRemoved&&ut.onRemoved(It),Yt.update(Mo=>(delete Mo[Eo(It.overlay.id)],Mo));const eo=At.get();if(eo)try{eo.removeDrawing(It.overlay.id),console.log("🗑️ Removed drawing from DrawingManager:",It.overlay.id),xv()}catch(Mo){console.error("Error removing drawing from DrawingManager:",Mo)}return!0}},ht=(ao=s())==null?void 0:ao.createOverlay(uo.mergeWith({},Xe,ue,(It,eo,Mo)=>{if(Mo.startsWith("on")&&It&&eo)return ho=>(eo(ho),It(ho))}));return ht&&(Array.isArray(ht)?(y.push(...ht),ht.length>0&&x(S,D(ht[0]))):(y.push(ht),x(S,D(ht)))),ht}function ol(ue){ue==="text"&&ce("text");let Fe=Oe.Solid,ut=[8,4];z.style==="dashed"?(Fe=Oe.Dashed,ut=[8,4]):z.style==="dotted"&&(Fe=Oe.Dashed,ut=[2,6]);const ht={line:{size:Number(z.thickness)||1,color:z.color,style:Fe,dashedValue:ut},text:{color:"#FFFFFF",backgroundColor:"#A0000020",borderColor:"#1677FF"},polygon:{color:z.color+"20"}},ao={origin:"user"};ue==="text"&&(ao.text=Ec,ao.fontSize=32,ao.fontWeight="bold",ao.textColor="#FFFFFF",ao.backgroundColor="#A0000020",ao.fontFamily=ye),oa({name:ue,visible:n(_),lock:n(g),mode:n(v),styles:ht,extendData:ao})}function Xi(ue,Fe){es[ue].icon=Fe,ol(Fe),x(c,"")}function fc(ue){return ue==="priceChannelLine"?"priceChannelLineNew":ue}function rd(){var Fe;let ue=n(d);n(v)!=="normal"&&(ue="normal"),x(v,D(ue)),(Fe=s())==null||Fe.overrideOverlay({mode:ue})}function ml(ue){var Fe;x(d,D(ue)),x(v,D(ue)),x(c,""),(Fe=s())==null||Fe.overrideOverlay({mode:ue})}function Jl(ue){let ut=0;return ue==="crosshair"?ut=0:es.find(Xe=>Xe.key===ue)?ut=1+es.findIndex(Xe=>Xe.key===ue):ue==="ruler"?ut=1+es.length+1:ue==="mode"?ut=1+es.length+2:ue==="lock"?ut=1+es.length+3:ue==="visible"?ut=1+es.length+4:ue==="remove"&&(ut=1+es.length+5),ut*52}function Wl(){var ue;x(g,!n(g)),(ue=s())==null||ue.overrideOverlay({lock:n(g)})}function sl(){var ue;x(_,!n(_)),(ue=s())==null||ue.overrideOverlay({visible:n(_)})}function Uc(){var ue,Fe;if(x(v,"normal"),x(d,"weakMagnet"),ce(null),n(S)){(ue=s())==null||ue.removeOverlay({id:n(S)});const ut=y.indexOf(n(S));ut>-1&&y.splice(ut,1),x(S,null)}(Fe=s())==null||Fe.overrideOverlay({mode:rk.Normal}),x(c,""),x(C,!1),x(I,!1),x(Y,!1),x(M,null),x(T,null),x(k,"")}function Nl(){var ut;let ue={groupId:Q},Fe=null;if(n(k))ue.id=n(k),Fe=n(T);else if(y.length>0){const Xe=y.pop();if(ue.id=Xe,Xe&&s()){const ht=s().getOverlays({id:Xe});ht&&ht.length>0&&(Fe=ht[0])}}if(Fe){const Xe=Eo(Fe.id);nu.recordRemoveOverlay(Fe.id,Fe,Xe)}(ut=s())==null||ut.removeOverlay(ue),x(C,!1),x(I,!1),x(Y,!1),x(M,null),x(T,null)}function Yc(){if(!n(T)||!s())return;const ue=Eo(n(T).id),Fe=JSON.parse(JSON.stringify(n(T))),ut=Number(z.thickness)||1;let Xe=Oe.Solid,ht=[8,4];z.style==="dashed"?(Xe=Oe.Dashed,ht=[8,4]):z.style==="dotted"&&(Xe=Oe.Dashed,ht=[2,6]);const ao=Math.round(z.opacity/100*255).toString(16).padStart(2,"0"),It=z.color+ao,eo={line:{size:ut,color:It,style:Xe,dashedValue:ht},text:{color:"#FFFFFF",backgroundColor:"rgba(0, 100, 255, 0.7)",borderColor:"#FFFFFF"},polygon:{color:It}};try{s().overrideOverlay({id:n(T).id,styles:eo})}catch(Mo){console.log("Error updating overlay styles:",Mo)}gt({...n(T),styles:{...n(T).styles,...eo}});try{const Mo={...n(T),styles:{...n(T).styles,...eo}};nu.recordModifyOverlay(n(T).id,Fe,Mo,ue)}catch{}}const Ec="Add text";function Ja(){var En,za,Rs,Zs,gn,Wn,Tn;if(!n(T)||!s()||n(T).name!=="text")return;const ue=Eo(n(T).id),Fe=JSON.parse(JSON.stringify(n(T))),ut=Number(Ce.fontSize)||12,Xe=Ce.backgroundColor||"#A00000",ht=Ce.textColor||"#FFFFFF",ao=Math.round(n(Ke)/100*255).toString(16).padStart(2,"0"),It=Math.round(n(Re)/100*255).toString(16).padStart(2,"0"),eo=typeof Xe=="string"&&Xe.startsWith("#")&&Xe.length===7?`${Xe}${ao}`:Xe,Mo=typeof ht=="string"&&ht.startsWith("#")&&ht.length===7?`${ht}${It}`:ht,ho=((En=n(T).styles)==null?void 0:En.text)||{},to=ho.size??((za=n(T).extendData)==null?void 0:za.fontSize),ds=ho.weight??((Rs=n(T).extendData)==null?void 0:Rs.fontWeight),js=ho.family??((Zs=n(T).extendData)==null?void 0:Zs.fontFamily),Si=to!==ut||ds!==Ce.fontWeight||js!==Ce.fontFamily,$r={...n(T).extendData||{},fontSize:ut,fontWeight:Ce.fontWeight,textColor:Ce.textColor,backgroundColor:eo,fontFamily:Ce.fontFamily,...Si?{boxWidth:0,boxHeight:0}:{}},pa={...n(T).styles||{},text:{...((gn=n(T).styles)==null?void 0:gn.text)||{},size:ut,color:Mo,backgroundColor:eo,family:Ce.fontFamily,weight:Ce.fontWeight,paddingLeft:8,paddingRight:8,paddingTop:4,paddingBottom:4,borderSize:0,borderColor:"transparent"},box:{...((Wn=n(T).styles)==null?void 0:Wn.box)||{},stroke:"#3b82f6",width:1,fill:"transparent"},handles:{...((Tn=n(T).styles)==null?void 0:Tn.handles)||{},size:6,fill:"#3b82f6",stroke:"#3b82f6"}};try{if(s().overrideOverlay({id:n(T).id,styles:pa,extendData:{...$r,textColor:ht,backgroundColor:eo,textOpacity:n(Re),textBgOpacity:n(Ke)}}),(n(T).extendData||{}).editing)try{Tm.updateEditorStyle(n(T))}catch{}}catch(Ko){console.log("Error updating text overlay styles:",Ko)}x(T,D({...n(T),styles:pa,extendData:$r})),gt(n(T));try{const Ko=JSON.parse(JSON.stringify(n(T)));nu.recordModifyOverlay(n(T).id,Fe,Ko,ue)}catch{}}function sa(ue){var ao;x(j,!0),x(F,D(Date.now()));const Fe=ue instanceof MouseEvent?ue.clientX:ue.touches[0].clientX,ut=ue instanceof MouseEvent?ue.clientY:ue.touches[0].clientY,Xe=(ao=ue.target.closest(".context-menu-container"))==null?void 0:ao.getBoundingClientRect();Xe?(B.x=Fe-Xe.left,B.y=ut-Xe.top):n($)&&(B.x=Fe-n($).x,B.y=ut-n($).y);const ht=ue;typeof ht.preventDefault=="function"&&ht.preventDefault(),typeof ht.stopPropagation=="function"&&ht.stopPropagation()}function jl(ue){if(n(j)&&n($)){x(F,D(Date.now()));const Fe=ue instanceof MouseEvent?ue.clientX:ue.touches[0].clientX,ut=ue instanceof MouseEvent?ue.clientY:ue.touches[0].clientY,Xe=window.innerWidth<=768,ht=Xe?Math.min(250,window.innerWidth-40):300,ao=Xe?40:60,It=Xe?5:10,eo=Ge==null?void 0:Ge.getBoundingClientRect();let Mo=Fe-B.x,ho=ut-B.y;const to=((eo==null?void 0:eo.left)||0)+It,ds=(eo?eo.right:window.innerWidth)-ht-It,js=((eo==null?void 0:eo.top)||0)+It,Si=(eo?eo.bottom:window.innerHeight)-ao-It;n($).x=Math.max(to,Math.min(Mo,ds)),n($).y=Math.max(js,Math.min(ho,Si))}}function Td(){n(j)&&n($)&&me(n($)),x(j,!1),x(F,D(Date.now()))}function _d(ue){jl(ue)}function Fl(){Td()}function qa(ue){const Fe=ue.detail;n(oe)==="line"?(z.color=Fe,Yc()):n(oe)==="textColor"?(Ce.textColor=Fe,Ja()):n(oe)==="textBg"&&(Ce.backgroundColor=Fe,Ja())}function td(ue){const Fe=ue.detail;n(oe)==="line"?(z.opacity=Fe,x(J,D(Fe)),Yc()):n(oe)==="textColor"?(x(Re,D(Fe)),x(J,D(Fe)),Ja()):n(oe)==="textBg"&&(x(Ke,D(Fe)),x(J,D(Fe)),Ja())}function Nc(){x(te,!1)}function be(){const ue=nu.undo();console.log(ue?"Undo successful":"Nothing to undo")}function We(){const ue=nu.redo();console.log(ue?"Redo successful":"Nothing to redo")}function de(ue){(ue.ctrlKey||ue.metaKey)&&ue.key==="z"&&!ue.shiftKey?(ue.preventDefault(),be()):(ue.ctrlKey||ue.metaKey)&&ue.key==="y"||(ue.ctrlKey||ue.metaKey)&&ue.shiftKey&&ue.key==="z"?(ue.preventDefault(),We()):(ue.key==="Delete"||ue.key==="Backspace")&&n(k)?(ue.preventDefault(),Nl()):(ue.ctrlKey||ue.metaKey)&&ue.key==="c"&&n(T)?(ue.preventDefault(),Ee()):(ue.ctrlKey||ue.metaKey)&&ue.key==="v"&&n(V)&&(ue.preventDefault(),xe(ue))}function De(){if(!(!n(T)||!s())){x(K,!0);try{const ue=JSON.parse(JSON.stringify(n(T))),Fe=Date.now();ue.id=`${n(T).name}_clone_${Fe}`,ue.points&&Array.isArray(ue.points)&&(ue.points=ue.points.map(Xe=>Xe&&typeof Xe=="object"?{...Xe,timestamp:Xe.timestamp?Xe.timestamp+1e3*60*5:Xe.timestamp,value:Xe.value?Xe.value*1.002:Xe.value}:Xe));const ut=oa(ue);if(ut){const Xe=Array.isArray(ut)?ut[0]:ut;if(Xe){const ht=Eo(Xe);nu.recordAddOverlay(Xe,ue,ht),setTimeout(()=>{var It,eo;const ao=s().getOverlays({id:Xe})[0];if(ao){if(x(k,D(Xe)),x(T,D(ao)),(It=ao.styles)!=null&&It.line){const Mo=ao.styles.line;z.thickness=String(Mo.size||2),z.color=Mo.color||"#1677FF",z.style=Mo.style===Oe.Dashed?"dashed":"solid"}if(ao.points&&ao.points.length>0){const Mo=ao.points[0],ho=(eo=s())==null?void 0:eo.convertToPixel(Mo,{paneId:"candle_pane"});ho&&typeof ho=="object"&&"x"in ho&&"y"in ho&&ho.x!==void 0&&ho.y!==void 0&&(x(M,D({x:ho.x-80,y:ho.y-30})),n(Z)?x($,D({...n(Z)})):x($,D({x:ho.x-80,y:ho.y-30})),x(C,!0),x(I,!1),x(Y,!1))}}},100)}console.log("Overlay cloned successfully")}}catch(ue){console.error("Error cloning overlay:",ue)}finally{x(K,!1)}}}function Ee(){if(n(T))try{x(V,D(JSON.parse(JSON.stringify(n(T))))),console.log("Overlay copied to clipboard"),x(C,!1),setTimeout(()=>{console.log("Copy operation completed")},100)}catch(ue){console.error("Error copying overlay:",ue)}}function xe(ue){if(!(!n(V)||!s()))try{const Fe=JSON.parse(JSON.stringify(n(V))),ut=Date.now();Fe.id=`${n(V).name}_paste_${ut}`,ue&&Fe.points&&Array.isArray(Fe.points)&&(Fe.points=Fe.points.map(ht=>ht&&typeof ht=="object"?{...ht,timestamp:ht.timestamp?ht.timestamp+1e3*60*10:ht.timestamp,value:ht.value?ht.value*1.005:ht.value}:ht));const Xe=oa(Fe);if(Xe){const ht=Array.isArray(Xe)?Xe[0]:Xe;if(ht){const ao=Eo(ht);nu.recordAddOverlay(ht,Fe,ao),setTimeout(()=>{var eo,Mo;const It=s().getOverlays({id:ht})[0];if(It){if(x(k,D(ht)),x(T,D(It)),(eo=It.styles)!=null&&eo.line){const ho=It.styles.line;z.thickness=String(ho.size||2),z.color=ho.color||"#1677FF",z.style=ho.style===Oe.Dashed?"dashed":"solid"}if(It.points&&It.points.length>0){const ho=It.points[0],to=(Mo=s())==null?void 0:Mo.convertToPixel(ho,{paneId:"candle_pane"});to&&typeof to=="object"&&"x"in to&&"y"in to&&to.x!==void 0&&to.y!==void 0&&(x(M,D({x:to.x-80,y:to.y-30})),n(Z)?x($,D({...n(Z)})):x($,D({x:to.x-80,y:to.y-30})),x(C,!0),x(I,!1),x(Y,!1))}}},100)}console.log("Overlay pasted successfully")}}catch(Fe){console.error("Error pasting overlay:",Fe)}}function gt(ue){if(ue.groupId!==Q)return;const Fe=["extendData","groupId","id","lock","mode","name","paneId","points","styles","totalStep","visible","zLevel"],ut=Eo(ue.id);Yt.update(ht=>(ht[ut]=Object.fromEntries(Fe.map(ao=>[ao,ue[ao]])),ht));const Xe=At.get();if(Xe&&ue.points&&ue.points.length>0)try{const ht=$f(r().symbol),ao={id:ue.id,symbolKey:ht,type:ue.name||"unknown",points:ue.points.map(It=>({time:It.timestamp||It.t||0,price:It.value||It.p||0})),styles:ue.styles||{},...ue.extendData?{extendData:ue.extendData}:{},locked:!!ue.lock,visible:ue.visible!==!1};Xe.addDrawing(ao),xv()}catch(ht){console.error("Error syncing overlay to DrawingManager:",ht)}}function at(){if(x(se,!n(se)),n(se)){const ue=pt();x(W,D({x:ue.left+60,y:ue.top+100}))}}function jt(ue){const{emoji:Fe}=ue.detail;console.log("Selected emoji:",Fe),x(se,!1),oa({name:"emoji",visible:n(_),lock:n(g),mode:n(v),extendData:{emoji:Fe,size:24},styles:{box:{enabled:!1,stroke:"#3b82f6",width:1,fill:"transparent"},handles:{size:6,fill:"#3b82f6",stroke:"#3b82f6"}}})}function Lt(ue){if(!n(T)||n(T).name!=="emoji")return;const Fe=Eo(n(T).id),ut=JSON.parse(JSON.stringify(n(T))),Xe=parseInt(ue);if(!(isNaN(Xe)||Xe<16||Xe>64)&&(n(T).extendData&&(n(T).extendData.size=Xe),s()&&n(T).id)){s().overrideOverlay({id:n(T).id,extendData:n(T).extendData}),gt(n(T));try{const ht=JSON.parse(JSON.stringify(n(T)));nu.recordModifyOverlay(n(T).id,ut,ht,Fe)}catch{}}}function Mt(){var ue,Fe;if(((ue=n(T))==null?void 0:ue.name)==="fibonacciSegment"){const ut=((Fe=n(T).extendData)==null?void 0:Fe.fibonacciLevels)||n(T).fibonacciLevels;ut&&x(Ze,D([...ut])),x(ct,D([...n(Ze)])),x(tt,!0)}}function Io(){x(Ze,D([{value:0,visible:!0,color:"#FF6B6B"},{value:.236,visible:!0,color:"#4ECDC4"},{value:.382,visible:!0,color:"#45B7D1"},{value:.5,visible:!0,color:"#96CEB4"},{value:.618,visible:!0,color:"#FFEAA7"},{value:.786,visible:!0,color:"#DDA0DD"},{value:1,visible:!0,color:"#98D8C8"},{value:1.272,visible:!0,color:"#F7DC6F"},{value:1.414,visible:!0,color:"#BB8FCE"},{value:1.618,visible:!0,color:"#85C1E9"},{value:2.618,visible:!0,color:"#F8C471"}])),is()}function Bo(){is(),x(tt,!1)}function hs(){x(Ze,D([...n(ct)])),x(tt,!1)}function is(){if(!n(T)||n(T).name!=="fibonacciSegment"||!s())return;const ue=Eo(n(T).id),Fe=JSON.parse(JSON.stringify(n(T)));s().overrideOverlay({id:n(T).id,extendData:{...n(T).extendData,fibonacciLevels:[...n(Ze)]}}),n(T).fibonacciLevels=[...n(Ze)],gt(n(T));try{const ut=JSON.parse(JSON.stringify(n(T)));nu.recordModifyOverlay(n(T).id,Fe,ut,ue)}catch{}}function Es(ue,Fe,ut){ue>=0&&ue<n(Ze).length&&(n(Ze)[ue]={...n(Ze)[ue],[Fe]:ut},is())}Nd(Vt,ue=>ue.clickChart).subscribe(()=>{x(c,""),Date.now()-ne>150&&!n(j)&&!n(k)&&!n(T)&&(x(C,!1),x(I,!1),x(Y,!1),x(M,null))}),hp(()=>{if(qe(),typeof document<"u"&&(document.addEventListener("mousemove",jl),document.addEventListener("mouseup",Td),document.addEventListener("touchmove",_d,{passive:!1}),document.addEventListener("touchend",Fl),document.addEventListener("touchcancel",Fl)),typeof window<"u"){window.addEventListener("resize",dt);const ue=Fe=>{if(s()&&n(T)&&n(T).name==="text"){const ut=we(n(T)),Xe=n(Z)||ut;Xe&&(x($,D({...Xe})),x(M,D({x:Xe.x,y:Xe.y})),x(C,!0),x(I,!1)),Tm.startEditing(s(),n(T))}};window.addEventListener("dblclick",ue)}}),hp(()=>{typeof document<"u"&&document.addEventListener("keydown",de)});function kt(){if(!n(vt))return;const{scrollHeight:ue,clientHeight:Fe,scrollTop:ut}=n(vt),Xe=ue>Fe,ht=ut+Fe>=ue-5;x(st,D(Xe&&!ht))}function xo(ue){if(ue&&(ue.preventDefault(),ue.stopPropagation()),!n(vt))return;const{scrollTop:Fe,clientHeight:ut,scrollHeight:Xe}=n(vt),ht=ut*.7,ao=Math.min(Fe+ht,Xe-ut);n(vt).scrollTo({top:ao,behavior:"smooth"})}hp(()=>{kt();const ue=()=>{kt()},Fe=()=>{kt()};return n(vt)&&n(vt).addEventListener("scroll",ue),typeof window<"u"&&window.addEventListener("resize",Fe),setTimeout(kt,500),()=>{n(vt)&&n(vt).removeEventListener("scroll",ue),typeof window<"u"&&window.removeEventListener("resize",Fe)}}),rf(()=>{typeof document<"u"&&(document.removeEventListener("mousemove",jl),document.removeEventListener("mouseup",Td),document.removeEventListener("keydown",de),document.removeEventListener("touchmove",_d),document.removeEventListener("touchend",Fl),document.removeEventListener("touchcancel",Fl)),typeof window<"u"&&window.removeEventListener("resize",dt)});function $t(ue){var Fe;try{if(ne=Date.now(),x(k,D(ue.id)),x(T,D(ue)),(Fe=ue.styles)!=null&&Fe.line){const ut=ue.styles.line;z.thickness=String(ut.size||2),z.color=ut.color||"#1677FF",z.style=ut.style===Oe.Dashed?"dashed":"solid"}if(ue.points&&ue.points.length>0){const ut=we(ue),Xe=n(Z)||ut;Xe&&(x($,D({...Xe})),x(M,D({x:Xe.x,y:Xe.y})),x(C,!0),x(I,!1))}}catch(ut){console.warn("externalSelectOverlay failed:",ut)}}function _o(ue){var Fe;try{(n(k)===ue.id||((Fe=n(T))==null?void 0:Fe.id)===ue.id)&&(x(k,""),x(I,!1),x(C,!1),x(Y,!1),x(M,null),x(T,null))}catch(ut){console.warn("externalDeselectOverlay failed:",ut)}}function go(ue){try{gt(ue)}catch(Fe){console.warn("externalSyncOverlay failed:",Fe)}}function fs(ue){try{n(k)===ue&&(x(k,""),x(I,!1),x(C,!1),x(Y,!1),x(M,null),x(T,null))}catch(Fe){console.warn("externalRemoved failed:",Fe)}}function Ms(ue={}){ol("text"),oa({name:"text",visible:n(_),lock:n(g),mode:n(v),styles:{text:{color:"#FFFFFF",backgroundColor:"#A0000020",borderColor:"#1677FF",size:ue.fontSize??32,weight:ue.fontWeight??"bold",family:ue.fontFamily??ye}},extendData:{text:ue.text??Ec,fontSize:ue.fontSize??32,fontWeight:ue.fontWeight??"bold",textColor:ue.textColor??"#FFFFFF",backgroundColor:ue.backgroundColor??"#A0000020",fontFamily:ue.fontFamily??ye}})}function zn(ue,Fe){s()&&s().overrideOverlay({id:ue,...Fe})}function qs(ue){s()&&s().removeOverlay({id:ue})}function Vn(ue){x(k,D(ue||""))}function Ss(ue){var ut;if(!s())return;const Fe=(ut=s().getOverlays({id:ue}))==null?void 0:ut[0];Fe&&Fe.name==="text"&&Tm.startEditing(s(),Fe)}function di(ue){}var Mn=DA(),La=Rt(Mn),nn=m(La);nn.__click=[iA];var tr=m(nn);a(tr,()=>Uc,()=>"crosshair",()=>"",()=>[],()=>!0);var Ur=p(tr,2);Vs(Ur,17,()=>es,_n,(ue,Fe)=>{var ut=rA(),Xe=Rt(ut),ht=kp(()=>()=>n(Fe).key==="emoji"?at():ol(n(Fe).icon));a(Xe,()=>n(ht),()=>n(Fe).icon,()=>n(Fe).key,()=>n(Fe).list,()=>!0);var ao=p(Xe,2);Te(ao,()=>n(Fe).key==="emoji",It=>{l(It)}),O(ue,ut)});var cl=p(Ur,2),ui=kp(()=>()=>ol("ruler"));a(cl,()=>n(ui),()=>"ruler");var Yr=p(cl,2);a(Yr,()=>rd,()=>n(d),()=>"mode",()=>Li,()=>!1,()=>!0);var Ra=p(Yr,2);a(Ra,()=>Wl,()=>n(g)?"lock":"unlock",()=>"",()=>[],()=>!1,()=>!0);var ga=p(Ra,2);a(ga,()=>sl,()=>n(_)?"visible":"invisible",()=>"",()=>[],()=>!1,()=>!0);var na=p(ga,2);l(na);var nl=p(na,2);a(nl,()=>Nl,()=>"remove"),f(nn),du(nn,ue=>x(vt,ue),()=>n(vt));var mi=p(nn,2);Te(mi,()=>n(st),ue=>{var Fe=lA();Fe.__click=xo,Fe.__touchstart=[JT,xo],Fe.__touchend=[aA],O(ue,Fe)}),f(La);var Ha=p(La,2);Te(Ha,()=>n(c),ue=>{var Fe=mA(),ut=Rt(Fe);Vs(ut,17,()=>es,_n,(ht,ao)=>{var It=So(),eo=Rt(It);Te(eo,()=>n(ao).key===n(c)&&n(ao).list.length>0,Mo=>{var ho=uA();const to=Qe(()=>`left: 60px; top: ${Jl(n(c))??""}px;`);Vs(ho,21,()=>n(ao).list,_n,(ds,js)=>{var Si=dA();Si.__click=[cA,c,ml,js,Xi,es];var $r=m(Si),pa=Qe(()=>fc(n(js).key));bv($r,{get name(){return n(pa)},class:"w-4 h-4"});var En=p($r,2),za=m(En,!0);Se(()=>Ve(za,yv[n(js).text]())),f(En),f(Si),id("mouseenter",Si,Rs=>Rs.currentTarget.style.backgroundColor="var(--menu-hover-bg)"),id("mouseleave",Si,Rs=>Rs.currentTarget.style.backgroundColor="transparent"),O(ds,Si)}),f(ho),Q1(ho,ds=>ze(ds)),Se(()=>Nt(ho,"style",n(to))),O(Mo,ho)}),O(ht,It)});var Xe=p(ut,2);Te(Xe,()=>n(c)==="mode",ht=>{var ao=fA();const It=Qe(()=>`left: 60px; top: ${Jl("mode")??""}px;`);Vs(ao,21,()=>Li,_n,(eo,Mo)=>{var ho=vA();ho.__click=[pA,ml,Mo];var to=m(ho),ds=Qe(()=>fc(n(Mo).key));bv(to,{get name(){return n(ds)},class:"w-4 h-4"});var js=p(to,2),Si=m(js,!0);Se(()=>Ve(Si,yv[n(Mo).text]())),f(js),f(ho),id("mouseenter",ho,$r=>$r.currentTarget.style.backgroundColor="var(--menu-hover-bg)"),id("mouseleave",ho,$r=>$r.currentTarget.style.backgroundColor="transparent"),O(eo,ho)}),f(ao),Q1(ao,eo=>ze(eo)),Se(()=>Nt(ao,"style",n(It))),O(ht,ao)}),O(ue,Fe)});var lr=p(Ha,2);Te(lr,()=>n(C)&&n($),ue=>{var Fe=FA();Fe.__click=[gA];var ut=m(Fe);Te(ut,()=>{var to;return((to=n(T))==null?void 0:to.name)!=="emoji"},to=>{var ds=bA(),js=Rt(ds);js.__mousedown=sa,js.__touchstart=[YT,sa];var Si=m(js),$r=m(Si),pa=m($r);pn(2),f($r),pn(4),f(Si),f(js);var En=p(js,2);Te(En,()=>{var za;return((za=n(T))==null?void 0:za.name)==="text"},za=>{var Rs=_A(),Zs=Rt(Rs);Zs.__change=Ja;var gn=m(Zs);gn.value=(gn.__value="8")==null?"":"8";var Wn=p(gn);Wn.value=(Wn.__value="10")==null?"":"10";var Tn=p(Wn);Tn.value=(Tn.__value="11")==null?"":"11";var Ko=p(Tn);Ko.value=(Ko.__value="12")==null?"":"12";var Qt=p(Ko);Qt.value=(Qt.__value="14")==null?"":"14";var H=p(Qt);H.value=(H.__value="16")==null?"":"16";var Me=p(H);Me.value=(Me.__value="18")==null?"":"18";var Ue=p(Me);Ue.value=(Ue.__value="20")==null?"":"20";var yt=p(Ue);yt.value=(yt.__value="22")==null?"":"22";var St=p(yt);St.value=(St.__value="24")==null?"":"24";var lo=p(St);lo.value=(lo.__value="32")==null?"":"32";var he=p(lo);he.value=(he.__value="40")==null?"":"40";var ke=p(he);ke.value=(ke.__value="52")==null?"":"52",f(Zs);var Ne=p(Zs,2);Ne.__click=[UT,Ce,Ja];var ie=p(Ne,2),Ct=m(ie),Kt=m(Ct);const fo=Qe(()=>`background-color: ${Ce.textColor??""}; color: ${ot(Ce.textColor)??""};`);Kt.__click=[ZT,oe,U,Ce,J,Re,te];var mo=m(Kt);bv(mo,{name:"text",size:12}),f(Kt);var Go=p(Kt,2);const Fo=Qe(()=>`background-color: ${Ce.backgroundColor??""}; color: ${ot(Ce.backgroundColor)??""};`);Go.__click=[XT,oe,U,Ce,J,Ke,te];var Wo=m(Go);bv(Wo,{name:"rect",size:12}),f(Go),f(Ct);var us=p(Ct,2);us.__change=Ja,Vs(us,21,()=>nt,_n,(Un,or)=>{var $s=hA(),gi={},kn=m($s,!0);f($s),Se(()=>{gi!==(gi=n(or).value)&&($s.value=($s.__value=n(or).value)==null?"":n(or).value),Ve(kn,n(or).label)}),O(Un,$s)}),f(us),f(ie),Se(()=>{Gn(Zs,`px-1 py-1 text-xs border rounded cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n w-[72px] h-[28px] svelte-t6isn6`),Gn(Ne,`w-8 h-8 rounded flex items-center justify-center ${(r().theme==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} transition-colors svelte-t6isn6`),Nt(Kt,"style",n(fo)),Nt(Go,"style",n(Fo)),Gn(us,`px-1 py-1 text-xs border rounded cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n max-w-[120px] svelte-t6isn6`)}),rs(Zs,()=>Ce.fontSize,Un=>Ce.fontSize=Un),rs(us,()=>Ce.fontFamily,Un=>Ce.fontFamily=Un),O(za,Rs)},za=>{var Rs=yA(),Zs=Rt(Rs);Zs.__click=[KT,oe,U,z,J,le,te];var gn=p(Zs,2);gn.__change=Yc;var Wn=m(gn);Wn.value=(Wn.__value="1")==null?"":"1";var Tn=p(Wn);Tn.value=(Tn.__value="2")==null?"":"2";var Ko=p(Tn);Ko.value=(Ko.__value="3")==null?"":"3";var Qt=p(Ko);Qt.value=(Qt.__value="4")==null?"":"4";var H=p(Qt);H.value=(H.__value="5")==null?"":"5";var Me=p(H);Me.value=(Me.__value="6")==null?"":"6";var Ue=p(Me);Ue.value=(Ue.__value="7")==null?"":"7";var yt=p(Ue);yt.value=(yt.__value="8")==null?"":"8",f(gn);var St=p(gn,2);St.__change=Yc;var lo=m(St);lo.value=(lo.__value="solid")==null?"":"solid";var he=p(lo);he.value=(he.__value="dashed")==null?"":"dashed";var ke=p(he);ke.value=(ke.__value="dotted")==null?"":"dotted",f(St),Se(()=>{Nt(Zs,"style",`background-color: ${z.color??""};`),Gn(gn,`px-1 py-1 text-xs border rounded-md cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n w-[64px] h-[28px] svelte-t6isn6`),Gn(St,`px-1 py-1 text-xs border rounded-md cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n w-[72px] h-[28px] svelte-t6isn6`)}),rs(gn,()=>z.thickness,Ne=>z.thickness=Ne),rs(St,()=>z.style,Ne=>z.style=Ne),O(za,Rs)}),Se(()=>{Gn(js,`drag-handle cursor-grab hover:cursor-grabbing flex items-center justify-center
                 w-6 h-6 rounded ${(r().theme==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} transition-colors
                 touch-manipulation svelte-t6isn6`),Gn(pa,`w-0.5 h-0.5 ${(r().theme==="dark"?"bg-gray-500":"bg-gray-400")??""} rounded-full`)}),O(to,ds)},to=>{var ds=wA(),js=m(ds),Si=m(js,!0);f(js);var $r=p(js,2),pa=p(m($r),2);Jt(pa),pa.__input=[xA,Lt];var En=p(pa,2),za=m(En,!0);f(En),f($r),f(ds),Se(()=>{var Rs,Zs,gn,Wn,Tn,Ko,Qt,H;Ve(Si,((Zs=(Rs=n(T))==null?void 0:Rs.extendData)==null?void 0:Zs.emoji)||"😀"),cu(pa,((Wn=(gn=n(T))==null?void 0:gn.extendData)==null?void 0:Wn.size)||24),Nt(pa,"title",`Emoji size: ${(((Ko=(Tn=n(T))==null?void 0:Tn.extendData)==null?void 0:Ko.size)||24)??""}px`),Ve(za,((H=(Qt=n(T))==null?void 0:Qt.extendData)==null?void 0:H.size)||24)}),O(to,ds)});var Xe=p(ut,2);Te(Xe,()=>{var to;return((to=n(T))==null?void 0:to.name)==="fibonacciSegment"},to=>{var ds=SA();ds.__click=[kA,Mt];var js=m(ds);f(ds),Se(()=>{Gn(ds,`w-8 h-8 rounded ${(r().theme==="dark"?"hover:bg-blue-900":"hover:bg-blue-100")??""} transition-colors duration-200
                 flex items-center justify-center svelte-t6isn6`),P0(js,`w-4 h-4 ${(r().theme==="dark"?"text-gray-300":"text-gray-600")??""} hover:text-blue-500`)}),O(to,ds)});var ht=p(Xe,2),ao=m(ht);ao.__click=[CA,Y];var It=m(ao);f(ao);var eo=p(ao,2);Te(eo,()=>n(Y),to=>{var ds=LA();ds.__click=[PA];var js=m(ds);js.__click=[IA,De,Y];var Si=p(js,2);Si.__click=[MA,Ee,Y];var $r=p(Si,2);Te($r,()=>n(V),pa=>{var En=AA();En.__click=[TA,xe,Y],Se(()=>Gn(En,`w-full text-left px-3 py-2 text-sm ${(r().theme==="dark"?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-800")??""} svelte-t6isn6`)),O(pa,En)}),f(ds),Se(()=>{Gn(ds,`absolute right-0 top-full mt-1 min-w-[140px] rounded-md shadow-lg border ${(r().theme==="dark"?"bg-[#2B2B2B] border-[#3F3F3F]":"bg-white border-gray-200")??""} z-[200002]`),Gn(js,`w-full text-left px-3 py-2 text-sm ${(r().theme==="dark"?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-800")??""} svelte-t6isn6`),Gn(Si,`w-full text-left px-3 py-2 text-sm ${(r().theme==="dark"?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-800")??""} svelte-t6isn6`)}),O(to,ds)}),f(ht);var Mo=p(ht,2);Mo.__click=[zA,Nl,C,M];var ho=m(Mo);f(Mo),f(Fe),Se(()=>{Gn(Fe,`context-menu-container fixed z-[200001] rounded-md shadow-lg flex items-center gap-1 space-x-1\\n ${(r().theme==="dark"?"bg-[#2B2B2B] border border-[#3F3F3F]":"bg-white border border-gray-200")??""} ${(n(j)?"cursor-grabbing":"")??""}\\n px-2 py-1 sm:px-3 sm:py-1\\n max-w-[85vw] sm:max-w-none svelte-t6isn6`),Nt(Fe,"data-theme",r().theme),Nt(Fe,"style",`left: ${n($).x??""}px; 
           top: ${n($).y??""}px;`),Gn(ao,`w-8 h-8 rounded ${(r().theme==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} transition-colors duration-200 flex items-center justify-center svelte-t6isn6`),Nt(ao,"aria-expanded",n(Y)),P0(It,`w-4 h-4 ${(r().theme==="dark"?"text-gray-300":"text-gray-600")??""}`),Gn(Mo,`w-8 h-8 rounded ${(r().theme==="dark"?"hover:bg-red-900":"hover:bg-red-100")??""} transition-colors duration-200
               flex items-center justify-center svelte-t6isn6`),P0(ho,`w-4 h-4 ${(r().theme==="dark"?"text-gray-300":"text-gray-600")??""} hover:text-red-500`)}),O(ue,Fe)});var zi=p(lr,2);Te(zi,()=>n(I)&&n(M),ue=>{var Fe=$A();Fe.__click=Nl,Se(()=>Nt(Fe,"style",`left: ${n(M).x??""}px; top: ${n(M).y??""}px;`)),O(ue,Fe)});var hr=p(zi,2);iv(hr,{get selectedColor(){return n(U)},set selectedColor(ue){x(U,D(ue))},get opacity(){return n(J)},set opacity(ue){x(J,D(ue))},get show(){return n(te)},set show(ue){x(te,D(ue))},$$events:{colorChange:qa,opacityChange:td,close:Nc}});var xa=p(hr,2);NT(xa,{get show(){return n(se)},set show(ue){x(se,D(ue))},get position(){return n(W)},set position(ue){x(W,D(ue))},$$events:{select:jt}});var Qa=p(xa,2);return GT(Qa,{get visible(){return n(tt)},set visible(ue){x(tt,D(ue))},get levels(){return n(Ze)},set levels(ue){x(Ze,D(ue))},get theme(){return r().theme},$$events:{levelChange:ue=>Es(ue.detail.index,ue.detail.field,ue.detail.value),reset:Io,confirm:Bo,cancel:hs}}),O(o,Mn),Tc({addOverlay:oa,clickRemove:Nl,externalSelectOverlay:$t,externalDeselectOverlay:_o,externalSyncOverlay:go,externalRemoved:fs,createTextDrawing:Ms,updateTextDrawing:zn,deleteTextDrawing:qs,setSelectedDrawing:Vn,enterEditMode:Ss,exitEditMode:di})}Hd(["click","touchstart","touchend","mousedown","change","input"]);const Lx={mode:"none",playing:!1,speed:1,depositAmount:1e5,leverage:null,currency:"USD",balance:1e5,positions:[],history:[],sidebarOpen:!1,pendingOrders:[],onboardingDone:!1},np=op(Lx);function zx(){np.set(Lx)}function Fx(o){var t;const e=o.priceCurrency||((t=o.exchange)!=null&&t.toUpperCase().includes("DSE")?"BDT":"USD");np.update(s=>({...s,currency:e}))}function $x(o){np.update(e=>({...e,currency:o}))}function Dx(o){np.update(e=>({...e,depositAmount:o,balance:o}))}function Ex(o){np.update(e=>({...e,leverage:o}))}function Nx(o){np.update(e=>({...e,onboardingDone:o}))}function jx(o){np.update(e=>({...e,mode:o}))}function V0(o){np.update(e=>({...e,playing:o}))}function E1(o){if(np.update(e=>({...e,speed:o})),typeof window<"u"&&window.setPlaybackSpeed)try{window.setPlaybackSpeed(o)}catch{}}function Rx(o){np.update(e=>({...e,positions:[...e.positions,o],balance:e.balance-o.avgCost*o.quantity}))}function NA(o,e,t){np.update(s=>{const i=s.positions.findIndex(g=>g.id===o);if(i===-1)return s;const r=s.positions[i],a=Math.min(e,r.quantity),l=(t-r.avgCost)*a*(r.leverage||1),c=r.quantity-a,d=[...s.positions];c>0?d[i]={...r,quantity:c}:d.splice(i,1);const v={id:o,symbol:r.symbol,quantity:a,avgCost:r.avgCost,closedAvg:t,pnl:l,closedAt:Date.now()};return{...s,positions:d,history:[v,...s.history],balance:s.balance+t*a+l}})}function jA(o){np.update(e=>({...e,pendingOrders:[...e.pendingOrders||[],o]}))}function $_(o){np.update(e=>({...e,pendingOrders:(e.pendingOrders||[]).filter(t=>t.id!==o)}))}function Hy(o,e,t){e(!1),o.stopPropagation(),t.click&&t.click("close")}var RA=o=>o.stopPropagation(),BA=(o,e,t)=>e(n(t)),OA=re("<button> </button>"),VA=re('<div class="modal-action px-4 sm:px-6 py-4 sm:py-5 border-t modal-footer svelte-1a6y34w"><div class="flex flex-col sm:flex-row gap-2 sm:gap-3 justify-end w-full"></div></div>'),WA=re('<div class="fixed inset-0 z-[70] flex items-center justify-center px-3 sm:px-4 md:px-6 animate-in fade-in duration-200 modal-overlay svelte-1a6y34w"><div><div class="relative px-4 sm:px-6 py-4 sm:py-5 border-b modal-header svelte-1a6y34w"><div class="flex justify-between items-center gap-4"><div class="flex items-center gap-3 min-w-0 flex-1"><div class="icon-badge svelte-1a6y34w"><svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg></div> <h3 class="font-bold text-lg sm:text-xl md:text-2xl tracking-tight text-base-content truncate"> </h3></div> <button class="close-btn flex-shrink-0 svelte-1a6y34w" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 sm:w-6 sm:h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div><!></div> <!></div></div>');function av(o,e){Mc(e,!0);let t=Qs(e,"width",3,600),s=Qs(e,"maxWidth",3,"min(600px, 95vw)"),i=Qs(e,"maxHeight",3,"90vh"),r=Qs(e,"title",3,""),a=Qs(e,"buttons",19,()=>["confirm"]),l=Qs(e,"show",15,!1),c=Qs(e,"center",3,!1),d=Qs(e,"class",3,""),v=Qs(e,"theme",3,"dark");function g(S){S==="close"&&l(!1),e.click&&e.click(S)}function _(S){switch(S){case"confirm":return"btn-primary";case"cancel":return"btn-ghost";default:return"btn-secondary"}}var y=So(),k=Rt(y);Te(k,l,S=>{var M=WA();M.__click=[Hy,l,e];var I=m(M);I.__click=[RA];var C=m(I),T=m(C),z=m(T),j=p(m(z),2),B=m(j,!0);f(j),f(z);var $=p(z,2);$.__click=[Hy,l,e],f(T),f(C);var F=p(C,2),V=m(F);Te(V,()=>e.children,Y=>{var Z=So(),ne=Rt(Z);g5(ne,()=>e.children),O(Y,Z)}),f(F);var K=p(F,2);Te(K,()=>a().length>0,Y=>{var Z=VA(),ne=m(Z);Vs(ne,21,a,_n,(te,oe)=>{var U=OA();const J=Qe(()=>`btn-premium ${_(n(oe))??""} w-full sm:w-auto sm:min-w-[120px] svelte-1a6y34w`);U.__click=[BA,g,oe];var se=m(U,!0);Se(()=>Ve(se,yv[n(oe)]())),f(U),Se(()=>Gn(U,n(J))),O(te,U)}),f(ne),f(Z),O(Y,Z)}),f(I),f(M),Se(()=>{Gn(I,`relative rounded-3xl shadow-luxury animate-in zoom-in-95 duration-300 overflow-hidden flex flex-col modal-container ${d()??""} svelte-1a6y34w`),Nt(I,"data-theme",v()),Nt(I,"style",`width: ${(typeof t()=="string"?t():t()+"px")??""}; max-width: ${s()??""}; max-height: ${i()??""};`),Ve(B,r()),Gn(F,`flex-1 overflow-y-auto premium-scrollbar ${(c()?"flex justify-center items-center":"")??""} px-4 sm:px-6 py-4 sm:py-5 svelte-1a6y34w`)}),O(S,M)}),O(o,y),Tc()}Hd(["click"]);const qA="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Bx=(o=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(o|=0));for(;o--;)e+=qA[t[o]&63];return e};/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 * ---
 * 
 * The MIT License (MIT) (for portions derived from Feather)
 * 
 * Copyright (c) 2013-2023 Cole Bemis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const HA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var GA=Bi("<svg><!><!></svg>");function Uu(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]),s=Tu(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Mc(e,!1);let i=Qs(e,"name",8,void 0),r=Qs(e,"color",8,"currentColor"),a=Qs(e,"size",8,24),l=Qs(e,"strokeWidth",8,2),c=Qs(e,"absoluteStrokeWidth",8,!1),d=Qs(e,"iconNode",24,()=>[]);const v=(...C)=>C.filter((T,z,j)=>!!T&&j.indexOf(T)===z).join(" "),g=B0(),[_,y]=g;Sp();var k=GA();let S;var M=m(k);Vs(M,1,d,_n,(C,T)=>{let z=()=>n(T)[0],j=()=>n(T)[1];var B=So(),$=Rt(B);const F=kp(()=>`${z()}`=="button"?y({...j()},[{attribute_name:"formaction"}]):`${z()}`=="form"?y({...j()},[{attribute_name:"action"}]):`${z()}`=="a"?y({...j()},[{attribute_name:"href",lang_attribute_name:"hreflang"}]):{...j()});x5($,z,!0,(V,K)=>{let Y;Se(()=>Y=X1(V,Y,{...n(F)},void 0,V.namespaceURI===G2,V.nodeName.includes("-")))}),O(C,B)});var I=p(M);Bu(I,e,"default",{}),f(k),Se(()=>S=X1(k,S,{...HA,...s,width:a(),height:a(),stroke:r(),"stroke-width":c()?Number(l())*24/Number(a()):l(),class:v("lucide-icon","lucide",i()?`lucide-${i()}`:"",t.class)},void 0,!0)),O(o,k),Tc()}function UA(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"banknote"},()=>t,{iconNode:[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"}],["circle",{cx:"12",cy:"12",r:"2"}],["path",{d:"M6 12h.01M18 12h.01"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function YA(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"camera"},()=>t,{iconNode:[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z"}],["circle",{cx:"12",cy:"13",r:"3"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function KA(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"clock"},()=>t,{iconNode:[["path",{d:"M12 6v6l4 2"}],["circle",{cx:"12",cy:"12",r:"10"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function ZA(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"code-xml"},()=>t,{iconNode:[["path",{d:"m18 16 4-4-4-4"}],["path",{d:"m6 8-4 4 4 4"}],["path",{d:"m14.5 4-5 16"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function XA(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"download"},()=>t,{iconNode:[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function JA(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"flask-conical"},()=>t,{iconNode:[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2"}],["path",{d:"M6.453 15h11.094"}],["path",{d:"M8.5 2h7"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function QA(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"gauge"},()=>t,{iconNode:[["path",{d:"m12 14 4-4"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function eL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"log-out"},()=>t,{iconNode:[["path",{d:"m16 17 5-5-5-5"}],["path",{d:"M21 12H9"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function tL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"maximize"},()=>t,{iconNode:[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function oL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"minimize"},()=>t,{iconNode:[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function sL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"moon"},()=>t,{iconNode:[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function nL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"pause"},()=>t,{iconNode:[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function iL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"play"},()=>t,{iconNode:[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function rL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"save"},()=>t,{iconNode:[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function aL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"search"},()=>t,{iconNode:[["path",{d:"m21 21-4.34-4.34"}],["circle",{cx:"11",cy:"11",r:"8"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function lL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"settings"},()=>t,{iconNode:[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function cL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"sun"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"4"}],["path",{d:"M12 2v2"}],["path",{d:"M12 20v2"}],["path",{d:"m4.93 4.93 1.41 1.41"}],["path",{d:"m17.66 17.66 1.41 1.41"}],["path",{d:"M2 12h2"}],["path",{d:"M20 12h2"}],["path",{d:"m6.34 17.66-1.41 1.41"}],["path",{d:"m19.07 4.93-1.41 1.41"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function dL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"trending-up"},()=>t,{iconNode:[["path",{d:"M16 7h6v6"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function uL(o,e){const t=Tu(e,["children","$$slots","$$events","$$legacy"]);Uu(o,Gu({name:"wallet"},()=>t,{iconNode:[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"}]],children:(i,r)=>{var a=So(),l=Rt(a);Bu(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}const Ox=["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BRL","BSD","BTN","BWP","BYN","BZD","CAD","CDF","CHF","CLP","CNY","COP","CRC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRU","MUR","MVR","MWK","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STN","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","UYU","UZS","VES","VND","VUV","WST","XAF","XCD","XOF","XPF","YER","ZAR","ZMW","ZWL"];function pL(o,e,t,s){$x(n(e)),Dx(Math.max(0,Number(n(t))||0)),x(s,2)}function vL(){var o;try{(o=window.predictNextCandle)==null||o.call(window)}catch{}V0(!0)}function fL(o){E1(parseFloat(o.target.value))}function mL(o,e,t,s,i){var c,d;if(!(typeof window<"u"?window.confirm("Exit simulator?"):!0))return;e();const a=t().positions;for(const v of a){try{v.lineOverlayId&&((c=s())==null||c.removeOverlay({id:v.lineOverlayId}))}catch{}try{v.noteOverlayId&&((d=s())==null||d.removeOverlay({id:v.noteOverlayId}))}catch{}}zx();const l=window.sidebarHostRef;l&&l.closeSidebar&&l.closeSidebar()}function gL(o,e,t,s,i,r,a,l){x(e,!0),x(t,"instant"),x(s,1),x(i,null),x(r,1),x(a,null),x(l,null)}function hL(o,e,t,s,i,r,a,l,c,d,v,g,_){var j,B;x(e,null);const y=n(t),k=Math.max(0,Number(n(s))||0);if(k<=0||y<=0){x(e,"Invalid quantity");return}if(!i(k,y)){x(e,"Quantity exceeds balance");return}r();const S=Bx(),M=a(),I=(j=l())==null?void 0:j.createOverlay({name:"horizontalStraightLine",points:[{value:y}],styles:{line:{style:Oe.Dashed,size:1}}}),C=(B=l())==null?void 0:B.createOverlay({name:"note",points:[{timestamp:M,value:y}],extendData:{in_text:"BUY",in_color:"#10b981",line_color:"#10b981"}}),T=Array.isArray(I)?I[0]??void 0:I??void 0,z=Array.isArray(C)?C[0]??void 0:C??void 0;Rx({id:S,symbol:d().symbol,quantity:k,avgCost:y,leverage:g().leverage,openedAt:Date.now(),lineOverlayId:T,noteOverlayId:z}),x(_,!1)}function _L(o,e,t,s,i,r,a,l,c,d,v,g,_){var j,B;x(e,null);const y=Math.max(0,Number(n(t))||0),k=Math.max(0,Number(n(s))||0);if(k<=0||y<=0){x(e,"Quantity exceeds balance or invalid price");return}if(!i(k,y)){x(e,"Quantity exceeds balance or invalid price");return}const S=Bx(),M=y>=n(r),I=(j=a())==null?void 0:j.createOverlay({name:"horizontalStraightLine",points:[{value:y}],styles:{line:{style:Oe.Dashed,size:1}}}),C=(B=a())==null?void 0:B.createOverlay({name:"note",points:[{timestamp:c(),value:y}],extendData:{in_text:"PENDING",in_color:"#f59e0b",line_color:"#f59e0b"}}),T=Array.isArray(I)?I[0]??void 0:I??void 0,z=Array.isArray(C)?C[0]??void 0:C??void 0;jA({id:S,symbol:d().symbol,quantity:k,price:y,leverage:g().leverage,createdAt:Date.now(),triggerUp:M,lineOverlayId:T,noteOverlayId:z}),x(_,!1)}var yL=re("<option> </option>"),bL=re('<div class="grid grid-cols-1 sm:grid-cols-3 gap-2 items-end w-full"><div class="flex flex-col gap-1"><div class="text-xs opacity-80">Currency</div> <select class="select select-bordered select-sm"></select></div> <input class="input input-bordered input-sm" type="number" min="0" placeholder="Deposit"> <button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button">Confirm Deposit</button></div>'),xL=(o,e)=>x(e,!0),wL=(o,e)=>x(e,!1),kL=re('<div class="flex items-center gap-2 w-full"><select class="select select-bordered select-sm"><option>1:50</option><option>1:100</option><option>1:200</option><option>1:400</option><option>1:500</option></select> <button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button">Confirm</button></div>'),SL=(o,e,t)=>{x(e,null),t()},CL=re('<button class="btn btn-sm btn-premium-outline svelte-112gz12" type="button">Confirm</button>'),PL=re('<div class="space-y-2 w-full"><div class="text-sm">Take leverage?</div> <div class="flex items-center gap-2 w-full"><label class="label cursor-pointer"><input type="radio" name="lev" class="radio radio-sm"> <span class="label-text ml-2">Yes</span></label> <label class="label cursor-pointer"><input type="radio" name="lev" class="radio radio-sm"> <span class="label-text ml-2">No</span></label></div> <!></div>'),IL=re('<span class="text-success"> </span>'),ML=re('<span class="text-error"> </span>'),TL=re("<span>No trades</span>"),AL=re('<button class="btn btn-sm btn-premium-outline svelte-112gz12" type="button"><!></button>'),LL=re('<button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button"><!></button>'),zL=(o,e)=>E1(e),FL=re('<button type="button"> </button>'),$L=(o,e)=>x(e,"portfolio"),DL=(o,e)=>x(e,"history"),EL=(o,e,t)=>e(n(t)),NL=re('<div class="flex items-center justify-between text-sm mt-2 gap-2"><div class="flex items-center gap-2 min-w-0"><div class="badge badge-outline truncate"> </div> <div class="truncate"> </div> <div class="truncate"> </div></div> <div class="flex items-center gap-2"><button class="btn btn-sm btn-premium-ghost svelte-112gz12" type="button">Cancel</button></div></div>'),jL=re('<div class="card lux-card shadow w-full mb-3 svelte-112gz12"><div class="card-body p-3 min-w-0"><div class="text-sm font-semibold">Pending Orders</div> <!></div></div>'),RL=(o,e,t)=>{x(e,""),x(t,0)},BL=re('<button class="btn btn-xs btn-premium-ghost svelte-112gz12" type="button">Cancel</button>'),OL=(o,e,t)=>e(n(t).id),VL=re('<button class="btn btn-xs btn-premium-outline svelte-112gz12" type="button">Sell</button>'),WL=(o,e)=>e(!0),qL=(o,e)=>e(!1),HL=re('<div class="sell-panel w-full mt-2 space-y-3 svelte-112gz12"><div class="sell-section svelte-112gz12"><div class="flex items-center justify-between"><div class="text-xs opacity-70"> </div> <button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button">Close All</button></div></div> <div class="sell-section svelte-112gz12"><div class="text-xs opacity-70 mb-2">Close partial position</div> <div class="flex items-center gap-2"><input class="input input-bordered input-sm flex-1" type="number" min="0" placeholder="Partial qty"> <button class="btn btn-sm btn-premium-outline svelte-112gz12" type="button">Confirm Partial</button></div> <div class="mt-2 text-xs opacity-70 flex items-center justify-between"><span> </span> <span> </span></div></div></div>'),GL=re('<div class="card lux-card shadow w-full mb-2 svelte-112gz12"><div class="card-body p-3 min-w-0"><div class="flex items-center justify-between"><div class="flex items-center gap-2 text-sm min-w-0"><div class="badge badge-outline truncate"> </div> <div class="truncate"> </div> <div class="truncate"> </div> <div class="truncate"> </div></div> <div class="flex items-center gap-2"><div> </div> <!></div></div> <!></div></div>'),UL=re("<!> <!>",1),YL=re('<div class="card trade-card shadow w-full mb-2 svelte-112gz12"><div class="card-body p-3 text-sm min-w-0"><div class="flex items-center justify-between"><div class="flex items-center gap-2 min-w-0"><div class="badge badge-outline truncate"> </div> <div class="truncate"> </div></div> <div> </div></div> <div class="mt-1 truncate"> </div></div></div>'),KL=re('<div class="card history-summary-card shadow w-full mb-2 svelte-112gz12"><div class="card-body p-3 min-w-0"><div class="grid grid-cols-3 gap-2 items-stretch"><div class="summary-tile win svelte-112gz12"><div class="summary-title svelte-112gz12">Winning</div> <div class="summary-values svelte-112gz12"><div class="badge badge-success text-[10px]"> </div> <div class="summary-amount svelte-112gz12"> </div></div></div> <div class="summary-tile loss svelte-112gz12"><div class="summary-title svelte-112gz12">Losing</div> <div class="summary-values svelte-112gz12"><div class="badge badge-error text-[10px]"> </div> <div class="summary-amount svelte-112gz12"> </div></div></div> <div><div class="summary-title svelte-112gz12">Net</div> <div class="summary-values svelte-112gz12"><div class="summary-amount svelte-112gz12"> </div></div></div></div></div></div> <!>',1),ZL=re('<div class="exit-bar svelte-112gz12"><div class="exit-copy svelte-112gz12">Practice live trading. Check your predictions and improve.</div> <button class="btn btn-sm btn-premium-danger exit-cta svelte-112gz12" type="button"><!> Exit</button></div> <div class="mini-stack grid grid-cols-1 gap-2 w-full svelte-112gz12"><div class="card glass lux-card shadow overflow-hidden mini-tile deposit-tile svelte-112gz12"><div class="card-body p-3 min-w-0 svelte-112gz12"><div class="flex items-center gap-3 w-full"><div class="tile-icon svelte-112gz12"><div class="icon-wrap svelte-112gz12"><!></div></div> <div class="flex-1 min-w-0 tile-content svelte-112gz12"><div class="tile-title svelte-112gz12">Deposit</div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div> <div class="tile-sub truncate svelte-112gz12"> </div></div></div></div></div> <div class="card glass lux-card shadow overflow-hidden mini-tile investment-tile svelte-112gz12"><div class="card-body p-3 min-w-0 svelte-112gz12"><div class="flex items-center gap-3 w-full"><div class="tile-icon svelte-112gz12"><div class="icon-wrap svelte-112gz12"><!></div></div> <div class="flex-1 min-w-0 tile-content svelte-112gz12"><div class="tile-title svelte-112gz12">Investment <span class="badge badge-outline text-[9px] ml-1"> </span></div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div> <div class="tile-sub truncate svelte-112gz12"><!></div></div></div></div></div> <div class="card glass lux-card shadow overflow-hidden mini-tile available-tile svelte-112gz12"><div class="card-body p-3 min-w-0 svelte-112gz12"><div class="flex items-center gap-3 w-full"><div class="tile-icon svelte-112gz12"><div class="icon-wrap svelte-112gz12"><!></div></div> <div class="flex-1 min-w-0 tile-content svelte-112gz12"><div class="tile-title svelte-112gz12">Available</div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div> <div class="tile-sub truncate svelte-112gz12"> </div></div></div></div></div></div> <div class="card speed-card w-full svelte-112gz12"><div class="card-body p-4"><div class="speed-header flex items-center justify-between svelte-112gz12"><div class="flex items-center gap-2"><div class="speed-icon svelte-112gz12"><!></div> <div class="speed-title svelte-112gz12">Playback Speed</div></div> <div class="speed-badge svelte-112gz12"> </div></div> <div class="mt-3 flex items-center gap-3"><input type="range" min="0.5" max="10" step="0.5" class="speed-range flex-1 svelte-112gz12"> <!></div> <div class="mt-2 speed-chips svelte-112gz12"></div></div></div> <div class="card trade-action-card w-full overflow-hidden svelte-112gz12"><div class="card-body p-4 min-w-0"><div class="flex items-center justify-between"><div><div class="text-xs opacity-70">Current Price</div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div></div> <div class="badge badge-success badge-outline">LIVE</div></div> <div class="mt-3"><button class="btn btn-premium-primary w-full svelte-112gz12" type="button">Buy Stock</button></div></div></div> <div class="tabs tabs-boxed w-full mt-3 gap-3 svelte-112gz12"><button type="button">Portfolio</button> <button type="button">History</button></div> <!>',1),XL=(o,e)=>x(e,"instant"),JL=(o,e)=>x(e,"pending"),QL=re('<div class="text-error text-xs mt-1"> </div>'),ez=re('<div class="space-y-2"><div class="card buy-card svelte-112gz12"><div class="card-body p-3"><div class="flex items-center justify-between"><div class="text-xs opacity-70">Current Price</div> <div class="metric-value font-bold truncate whitespace-nowrap svelte-112gz12"> </div></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 items-end mt-2"><input class="input input-bordered input-sm" type="number" min="0" placeholder="Quantity"> <button class="btn btn-sm btn-premium-primary w-full svelte-112gz12" type="button">Confirm Buy</button></div> <!></div></div></div>'),tz=re('<div class="text-error text-xs"> </div>'),oz=re('<div class="space-y-2"><div class="grid grid-cols-2 gap-2 items-end"><input class="input input-bordered input-sm" type="number" min="0" placeholder="Custom Price"> <input class="input input-bordered input-sm" type="number" min="0" placeholder="Quantity"></div> <button class="btn btn-sm btn-premium-primary w-full svelte-112gz12" type="button">Place Pending Buy</button> <!></div>'),sz=re('<div class="space-y-3"><div class="flex items-center gap-2"><div class="badge badge-outline">Mode</div> <label class="label cursor-pointer"><input type="radio" name="buyMode" class="radio radio-sm"> <span class="label-text ml-2">Instant</span></label> <label class="label cursor-pointer"><input type="radio" name="buyMode" class="radio radio-sm"> <span class="label-text ml-2">Pending</span></label></div> <!></div>'),nz=re('<div class="p-4 space-y-4 w-full box-border"><!></div> <!>',1);function iz(o,e){Mc(e,!0);const t=Au(),s=()=>ua(np,"$simulator",t),i=()=>ua(l,"$save",t),r=()=>ua(a,"$chart",t),a=vc("chart"),l=vc("save");let c=ee(D(s().depositAmount)),d=ee(D(s().currency||i().symbol.priceCurrency||"USD")),v=ee(!1),g=ee(null),_=ee(D(s().onboardingDone?3:1)),y=ee(0),k=null,S=ee(0),M=ee(""),I=ee("portfolio"),C=ee(!1),T=ee("instant"),z=ee(null),j=ee(1),B=ee(1),$=ee(null),F=ee(null);const V=Qe(()=>(s().positions||[]).length>0),K=Qe(()=>(s().positions||[]).reduce((Ge,pt)=>Ge+(n(y)-pt.avgCost)*pt.quantity*(pt.leverage||1),0)),Y=Qe(()=>s().history||[]),Z=Qe(()=>n(Y).filter(Ge=>(Ge.pnl??0)>0).length),ne=Qe(()=>n(Y).filter(Ge=>(Ge.pnl??0)<0).length),te=Qe(()=>n(Y).reduce((Ge,pt)=>Ge+((pt.pnl??0)>0?pt.pnl??0:0),0)),oe=Qe(()=>n(Y).reduce((Ge,pt)=>Ge+((pt.pnl??0)<0?Math.abs(pt.pnl??0):0),0)),U=Qe(()=>n(te)-n(oe)),J=Qe(()=>((s().speed||.5)-.5)/9.5*100);function se(){var pt;const Ge=((pt=r())==null?void 0:pt.getDataList())||[];return Ge.length===0?0:Ge[Ge.length-1].close}function W(){var pt;const Ge=((pt=r())==null?void 0:pt.getDataList())||[];return Ge.length===0?Date.now():Ge[Ge.length-1].timestamp}function le(){Ex(n(v)?n(g)||100:null),x(_,3),Nx(!0)}function ye(){var Ge;try{(Ge=window.stopPrediction)==null||Ge.call(window)}catch{}V0(!1)}function Ce(){k||(k=setInterval(()=>{var qe,me,Q,it,Vt;const Ge=((qe=r())==null?void 0:qe.getDataList())||[],pt=Ge.length>0?Ge[Ge.length-1]:null,ce=pt?pt.close??0:0,we=pt?pt.high??ce:ce,ze=pt?pt.low??ce:ce;x(y,D(ce));const dt=[...s().pendingOrders||[]];for(const wt of dt)if(wt.triggerUp?we>=wt.price:ze<=wt.price){const At=s().leverage||1;if(wt.price*wt.quantity/At<=s().balance){if(wt.lineOverlayId)try{(me=r())==null||me.removeOverlay({id:wt.lineOverlayId})}catch{}if(wt.noteOverlayId)try{(Q=r())==null||Q.removeOverlay({id:wt.noteOverlayId})}catch{}$_(wt.id);const no=W(),Do=(it=r())==null?void 0:it.createOverlay({name:"horizontalStraightLine",points:[{value:wt.price}],styles:{line:{style:Oe.Dashed,size:1}}}),Eo=(Vt=r())==null?void 0:Vt.createOverlay({name:"note",points:[{timestamp:no,value:wt.price}],extendData:{in_text:"BUY",in_color:"#10b981",line_color:"#10b981"}}),bs=Array.isArray(Do)?Do[0]??void 0:Do??void 0,Is=Array.isArray(Eo)?Eo[0]??void 0:Eo??void 0;Rx({id:wt.id,symbol:wt.symbol,quantity:wt.quantity,avgCost:wt.price,leverage:wt.leverage,openedAt:Date.now(),lineOverlayId:bs,noteOverlayId:Is})}else $_(wt.id)}},300))}function Re(){k&&(clearInterval(k),k=null)}hp(()=>{x(y,D(se()))}),zr(()=>{s().playing?Ce():Re()});function Ke(Ge,pt){const ce=s().leverage||1;return pt*Ge/ce<=s().balance}function st(Ge){var pt,ce;try{Ge.lineOverlayId&&((pt=r())==null||pt.removeOverlay({id:Ge.lineOverlayId}))}catch{}try{Ge.noteOverlayId&&((ce=r())==null||ce.removeOverlay({id:Ge.noteOverlayId}))}catch{}$_(Ge.id)}function vt(Ge){x(M,D(Ge)),x(S,0),x(I,"portfolio")}function Je(Ge){var ze,dt;const pt=s().positions.find(qe=>qe.id===n(M));if(!pt)return;const ce=se(),we=Ge?pt.quantity:Math.min(pt.quantity,Math.max(0,Number(n(S))||0));if(!(we<=0)){if(NA(pt.id,we,ce),we===pt.quantity){try{pt.lineOverlayId&&((ze=r())==null||ze.removeOverlay({id:pt.lineOverlayId}))}catch{}try{pt.noteOverlayId&&((dt=r())==null||dt.removeOverlay({id:pt.noteOverlayId}))}catch{}}x(M,""),x(S,0)}}function ot(Ge){try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s().currency||"USD",maximumFractionDigits:2}).format(Ge)}catch{return`${Ge.toFixed(2)} ${s().currency||""}`}}var nt=nz(),tt=Rt(nt),Ze=m(tt);Te(Ze,()=>n(_)===1,Ge=>{var pt=bL(),ce=m(pt),we=p(m(ce),2);Vs(we,21,()=>Ox,_n,(qe,me)=>{var Q=yL(),it={},Vt=m(Q,!0);f(Q),Se(()=>{it!==(it=n(me))&&(Q.value=(Q.__value=n(me))==null?"":n(me)),Ve(Vt,n(me))}),O(qe,Q)}),f(we),f(ce);var ze=p(ce,2);Jt(ze);var dt=p(ze,2);dt.__click=[pL,d,c,_],f(pt),rs(we,()=>n(d),qe=>x(d,qe)),Ho(ze,()=>n(c),qe=>x(c,qe)),O(Ge,pt)},Ge=>{var pt=So(),ce=Rt(pt);Te(ce,()=>n(_)===2,we=>{var ze=PL(),dt=p(m(ze),2),qe=m(dt),me=m(qe);Jt(me),me.__click=[xL,v],pn(2),f(qe);var Q=p(qe,2),it=m(Q);Jt(it),it.__click=[wL,v],pn(2),f(Q),f(dt);var Vt=p(dt,2);Te(Vt,()=>n(v),wt=>{var Yt=kL(),At=m(Yt),Gt=m(At);Gt.value=(Gt.__value=50)==null?"":50;var no=p(Gt);no.value=(no.__value=100)==null?"":100;var Do=p(no);Do.value=(Do.__value=200)==null?"":200;var Eo=p(Do);Eo.value=(Eo.__value=400)==null?"":400;var bs=p(Eo);bs.value=(bs.__value=500)==null?"":500,f(At);var Is=p(At,2);Is.__click=le,f(Yt),rs(At,()=>n(g),qi=>x(g,qi)),O(wt,Yt)},wt=>{var Yt=CL();Yt.__click=[SL,g,le],O(wt,Yt)}),f(ze),Se(()=>{wv(me,n(v)),wv(it,!n(v))}),O(we,ze)},we=>{var ze=ZL(),dt=Rt(ze),qe=p(m(dt),2);qe.__click=[mL,ye,s,r,a];var me=m(qe);eL(me,{size:16}),pn(),f(qe),f(dt);var Q=p(dt,2),it=m(Q),Vt=m(it),wt=m(Vt),Yt=m(wt),At=m(Yt),Gt=m(At);uL(Gt,{size:14}),f(At),f(Yt);var no=p(Yt,2),Do=p(m(no),2);Se(()=>Nt(Do,"title",ot(s().depositAmount)));var Eo=m(Do,!0);Se(()=>Ve(Eo,ot(s().depositAmount))),f(Do);var bs=p(Do,2),Is=m(bs);Se(()=>Ve(Is,`${ot(s().depositAmount)??""} • ${s().currency??""}`)),f(bs),f(no),f(wt),f(Vt),f(it);var qi=p(it,2),Ks=m(qi),ws=m(Ks),vn=m(ws),es=m(vn),Li=m(es);dL(Li,{size:14}),f(es),f(vn);var ci=p(vn,2),oa=m(ci),ol=p(m(oa)),Xi=m(ol);f(ol),f(oa);var fc=p(oa,2);Se(()=>Nt(fc,"title",ot((s().positions||[]).reduce((_o,go)=>_o+go.avgCost*go.quantity,0))));var rd=m(fc,!0);Se(()=>Ve(rd,ot((s().positions||[]).reduce((_o,go)=>_o+go.avgCost*go.quantity,0)))),f(fc);var ml=p(fc,2),Jl=m(ml);Te(Jl,()=>(s().positions||[]).length>0,_o=>{var go=So(),fs=Rt(go);Te(fs,()=>(s().positions||[]).reduce((Ms,zn)=>Ms+(n(y)-zn.avgCost)*zn.quantity*(zn.leverage||1),0)>=0,Ms=>{var zn=IL(),qs=m(zn);Se(()=>Ve(qs,`+${ot((s().positions||[]).reduce((Vn,Ss)=>Vn+(n(y)-Ss.avgCost)*Ss.quantity*(Ss.leverage||1),0))??""}`)),f(zn),O(Ms,zn)},Ms=>{var zn=ML(),qs=m(zn);Se(()=>Ve(qs,`-${ot(Math.abs((s().positions||[]).reduce((Vn,Ss)=>Vn+(n(y)-Ss.avgCost)*Ss.quantity*(Ss.leverage||1),0)))??""}`)),f(zn),O(Ms,zn)}),O(_o,go)},_o=>{var go=TL();O(_o,go)}),f(ml),f(ci),f(ws),f(Ks),f(qi);var Wl=p(qi,2),sl=m(Wl),Uc=m(sl),Nl=m(Uc),Yc=m(Nl),Ec=m(Yc);UA(Ec,{size:14}),f(Yc),f(Nl);var Ja=p(Nl,2),sa=p(m(Ja),2);Se(()=>Nt(sa,"title",ot(s().balance*(s().leverage||1))));var jl=m(sa,!0);Se(()=>Ve(jl,ot(s().balance*(s().leverage||1)))),f(sa);var Td=p(sa,2),_d=m(Td);f(Td),f(Ja),f(Uc),f(sl),f(Wl),f(Q);var Fl=p(Q,2),qa=m(Fl),td=m(qa),Nc=m(td),be=m(Nc),We=m(be);QA(We,{size:16}),f(be),pn(2),f(Nc);var de=p(Nc,2),De=m(de);f(de),f(td);var Ee=p(td,2),xe=m(Ee);Jt(xe),xe.__input=[fL];var gt=p(xe,2);Te(gt,()=>s().playing,_o=>{var go=AL();go.__click=ye;var fs=m(go);nL(fs,{size:16}),f(go),O(_o,go)},_o=>{var go=LL();go.__click=[vL];var fs=m(go);iL(fs,{size:16}),f(go),O(_o,go)}),f(Ee);var at=p(Ee,2);Vs(at,20,()=>[.5,1,2,5,10],_n,(_o,go)=>{var fs=FL();fs.__click=[zL,go];var Ms=m(fs);f(fs),Se(()=>{Gn(fs,`speed-chip ${(s().speed===go?"active":"")??""} svelte-112gz12`),Ve(Ms,`${go??""}x`)}),O(_o,fs)}),f(at),f(qa),f(Fl);var jt=p(Fl,2),Lt=m(jt),Mt=m(Lt),Io=m(Mt),Bo=p(m(Io),2);Se(()=>Nt(Bo,"title",n(y).toFixed(2)));var hs=m(Bo,!0);Se(()=>Ve(hs,n(y).toFixed(2))),f(Bo),f(Io),pn(2),f(Mt);var is=p(Mt,2),Es=m(is);Es.__click=[gL,C,T,j,z,B,$,F],f(is),f(Lt),f(jt);var bt=p(jt,2),kt=m(bt);kt.__click=[$L,I];var xo=p(kt,2);xo.__click=[DL,I],f(bt);var $t=p(bt,2);Te($t,()=>n(I)==="portfolio",_o=>{var go=UL(),fs=Rt(go);Te(fs,()=>(s().pendingOrders||[]).length>0,zn=>{var qs=jL(),Vn=m(qs),Ss=p(m(Vn),2);Vs(Ss,1,()=>s().pendingOrders,_n,(di,Mn)=>{var La=NL(),nn=m(La),tr=m(nn),Ur=m(tr,!0);f(tr);var cl=p(tr,2),ui=m(cl);f(cl);var Yr=p(cl,2),Ra=m(Yr);Se(()=>Ve(Ra,`Price ${n(Mn).price.toFixed(2)??""}`)),f(Yr),f(nn);var ga=p(nn,2),na=m(ga);na.__click=[EL,st,Mn],f(ga),f(La),Se(()=>{Ve(Ur,n(Mn).symbol.ticker),Ve(ui,`Qty ${n(Mn).quantity??""}`)}),O(di,La)}),f(Vn),f(qs),O(zn,qs)});var Ms=p(fs,2);Vs(Ms,1,()=>s().positions,_n,(zn,qs)=>{var Vn=GL(),Ss=m(Vn),di=m(Ss),Mn=m(di),La=m(Mn),nn=m(La,!0);f(La);var tr=p(La,2),Ur=m(tr);f(tr);var cl=p(tr,2),ui=m(cl);Se(()=>Ve(ui,`Avg ${n(qs).avgCost.toFixed(2)??""}`)),f(cl);var Yr=p(cl,2),Ra=m(Yr);f(Yr),f(Mn);var ga=p(Mn,2),na=m(ga),nl=m(na);Se(()=>Ve(nl,`${((n(y)-n(qs).avgCost)*n(qs).quantity*(n(qs).leverage||1)>=0?"+":"")??""}${((n(y)-n(qs).avgCost)*n(qs).quantity*(n(qs).leverage||1)).toFixed(2)??""}`)),f(na);var mi=p(na,2);Te(mi,()=>n(M)===n(qs).id,lr=>{var zi=BL();zi.__click=[RL,M,S],O(lr,zi)},lr=>{var zi=VL();zi.__click=[OL,vt,qs],O(lr,zi)}),f(ga),f(di);var Ha=p(di,2);Te(Ha,()=>n(M)===n(qs).id,lr=>{var zi=HL(),hr=m(zi),xa=m(hr),Qa=m(xa),ue=m(Qa);f(Qa);var Fe=p(Qa,2);Fe.__click=[WL,Je],f(xa),f(hr);var ut=p(hr,2),Xe=p(m(ut),2),ht=m(Xe);Jt(ht);var ao=p(ht,2);ao.__click=[qL,Je],Se(()=>ao.disabled=!n(S)||Number(n(S))<=0||Number(n(S))>n(qs).quantity),f(Xe);var It=p(Xe,2),eo=m(It),Mo=m(eo);f(eo);var ho=p(eo,2),to=m(ho);Se(()=>Ve(to,`Est. PnL: ${((n(y)-n(qs).avgCost)*(Number(n(S))||0)*(n(qs).leverage||1)).toFixed(2)??""}`)),f(ho),f(It),f(ut),f(zi),Se(()=>{Ve(ue,`Close entire position (${n(qs).quantity??""})`),Nt(ht,"max",n(qs).quantity),Ve(Mo,`Available: ${n(qs).quantity??""}`)}),Ho(ht,()=>n(S),ds=>x(S,ds)),O(lr,zi)}),f(Ss),f(Vn),Se(()=>{Ve(nn,n(qs).symbol.ticker),Ve(Ur,`Qty ${n(qs).quantity??""}`),Ve(Ra,`Lev ${(n(qs).leverage||1)??""}x`),Gn(na,`badge ${((n(y)-n(qs).avgCost)*n(qs).quantity*(n(qs).leverage||1)>=0?"badge-success":"badge-error")??""}`)}),O(zn,Vn)}),O(_o,go)},_o=>{var go=KL(),fs=Rt(go),Ms=m(fs),zn=m(Ms),qs=m(zn),Vn=p(m(qs),2),Ss=m(Vn),di=m(Ss,!0);f(Ss);var Mn=p(Ss,2);Se(()=>Nt(Mn,"title",ot(n(te))));var La=m(Mn,!0);Se(()=>Ve(La,ot(n(te)))),f(Mn),f(Vn),f(qs);var nn=p(qs,2),tr=p(m(nn),2),Ur=m(tr),cl=m(Ur,!0);f(Ur);var ui=p(Ur,2);Se(()=>Nt(ui,"title",ot(n(oe))));var Yr=m(ui,!0);Se(()=>Ve(Yr,ot(n(oe)))),f(ui),f(tr),f(nn);var Ra=p(nn,2),ga=p(m(Ra),2),na=m(ga);Se(()=>Nt(na,"title",ot(n(U))));var nl=m(na);Se(()=>Ve(nl,`${(n(U)>=0?"+":"")??""}${ot(n(U))??""}`)),f(na),f(ga),f(Ra),f(zn),f(Ms),f(fs);var mi=p(fs,2);Vs(mi,1,()=>s().history,_n,(Ha,lr)=>{var zi=YL(),hr=m(zi),xa=m(hr),Qa=m(xa),ue=m(Qa),Fe=m(ue,!0);f(ue);var ut=p(ue,2),Xe=m(ut);f(ut),f(Qa);var ht=p(Qa,2),ao=m(ht);Se(()=>Ve(ao,`${(n(lr).pnl>=0?"+":"")??""}${n(lr).pnl.toFixed(2)??""}`)),f(ht),f(xa);var It=p(xa,2);const eo=Qe(()=>n(lr).avgCost.toFixed(2)??""),Mo=Qe(()=>n(lr).closedAvg.toFixed(2)??"");var ho=m(It);Se(()=>Ve(ho,`Buy ${n(eo)} • Sell ${n(Mo)}`)),f(It),f(hr),f(zi),Se(()=>{Ve(Fe,n(lr).symbol.ticker),Ve(Xe,`Qty ${n(lr).quantity??""}`),Gn(ht,`badge ${(n(lr).pnl>=0?"badge-success":"badge-error")??""}`)}),O(Ha,zi)}),Se(()=>{Ve(di,n(Z)),Ve(cl,n(ne)),Gn(Ra,`summary-tile net ${(n(U)>=0?"pos":"neg")??""} svelte-112gz12`)}),O(_o,go)}),Se(()=>{ii(qi,"pos",n(V)&&n(K)>=0),ii(qi,"neg",n(V)&&n(K)<0),Ve(Xi,`Open ${(s().positions||[]).length??""}`),Ve(_d,`Leverage ${(s().leverage||1)??""}x`),Ve(De,`${s().speed??""}x`),cu(xe,s().speed),Nt(xe,"style",`background: linear-gradient(to right, var(--menu-active-bg) ${n(J)}%, var(--menu-btn-bg) ${n(J)}%);`),Gn(kt,`tab ${(n(I)==="portfolio"?"tab-active":"")??""} svelte-112gz12`),Gn(xo,`tab ${(n(I)==="history"?"tab-active":"")??""} svelte-112gz12`)}),O(we,ze)},!0),O(Ge,pt)}),f(tt);var ct=p(tt,2);Te(ct,()=>n(C),Ge=>{av(Ge,{title:"Place Buy Order",buttons:[],get show(){return n(C)},set show(pt){x(C,D(pt))},get theme(){return i().theme},children:(pt,ce)=>{var we=sz(),ze=m(we),dt=p(m(ze),2),qe=m(dt);Jt(qe),qe.__click=[XL,T],pn(2),f(dt);var me=p(dt,2),Q=m(me);Jt(Q),Q.__click=[JL,T],pn(2),f(me),f(ze);var it=p(ze,2);Te(it,()=>n(T)==="instant",Vt=>{var wt=ez(),Yt=m(wt),At=m(Yt),Gt=m(At),no=p(m(Gt),2);Se(()=>Nt(no,"title",n(y).toFixed(2)));var Do=m(no,!0);Se(()=>Ve(Do,n(y).toFixed(2))),f(no),f(Gt);var Eo=p(Gt,2),bs=m(Eo);Jt(bs);var Is=p(bs,2);Is.__click=[hL,$,y,j,Ke,ye,W,r,a,i,l,s,C],f(Eo);var qi=p(Eo,2);Te(qi,()=>n($),Ks=>{var ws=QL(),vn=m(ws,!0);f(ws),Se(()=>Ve(vn,n($))),O(Ks,ws)}),f(At),f(Yt),f(wt),Ho(bs,()=>n(j),Ks=>x(j,Ks)),O(Vt,wt)},Vt=>{var wt=oz(),Yt=m(wt),At=m(Yt);Jt(At);var Gt=p(At,2);Jt(Gt),f(Yt);var no=p(Yt,2);no.__click=[_L,F,z,B,Ke,y,r,a,W,i,l,s,C];var Do=p(no,2);Te(Do,()=>n(F),Eo=>{var bs=tz(),Is=m(bs,!0);f(bs),Se(()=>Ve(Is,n(F))),O(Eo,bs)}),f(wt),Ho(At,()=>n(z),Eo=>x(z,Eo)),Ho(Gt,()=>n(B),Eo=>x(B,Eo)),O(Vt,wt)}),f(we),Se(()=>{wv(qe,n(T)==="instant"),wv(Q,n(T)==="pending")}),O(pt,we)},$$slots:{default:!0}})}),O(o,nt),Tc()}Hd(["click","input"]);var rz=re('<div class="top-section svelte-3gnxyq"><div class="section-card svelte-3gnxyq"><button class="sidebar-icon svelte-3gnxyq" title="Watch List"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><path d="M8 6H21M8 12H21M8 18H21M3 6H3.01M3 12H3.01M3 18H3.01" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Watch</span></button> <button class="sidebar-icon svelte-3gnxyq" title="Alerts"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><path d="M18 8A6 6 0 0 0 6 8C6 15 3 17 3 17H21S18 15 18 8Z" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path><path d="M13.73 21A2 2 0 0 1 10.27 21" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Alerts</span></button> <button class="sidebar-icon ask-ai-btn svelte-3gnxyq" title="Ask AI"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path><path d="M12 12C13.1046 12 14 11.1046 14 10C14 8.89543 13.1046 8 12 8C10.8954 8 10 8.89543 10 10C10 11.1046 10.8954 12 12 12Z" fill="currentColor" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Ask AI</span></button></div></div> <div class="bottom-section svelte-3gnxyq"><div class="section-card svelte-3gnxyq"><button class="sidebar-icon svelte-3gnxyq" title="Calendar"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="0.5" class="svelte-3gnxyq"></rect><line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" class="svelte-3gnxyq"></line><line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" class="svelte-3gnxyq"></line><line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="0.5" class="svelte-3gnxyq"></line></svg> <span class="sidebar-label svelte-3gnxyq">Calendar</span></button> <button class="sidebar-icon svelte-3gnxyq" title="Portfolio"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><rect x="2" y="7" width="20" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="0.5" class="svelte-3gnxyq"></rect><path d="M16 21V5A2 2 0 0 0 14 3H10A2 2 0 0 0 8 5V21" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Portfolio</span></button></div></div>',1),az=re("<div><!></div>");function lz(o,e){Mc(e,!1);const t=Au(),s=()=>ua(a,"$save",t),i=()=>ua(np,"$simulator",t);let r=Qs(e,"className",8,"");const a=vc("save");Sp();var l=az(),c=m(l);Te(c,()=>i().mode==="strategy",d=>{iz(d,{})},d=>{var v=rz();pn(2),O(d,v)}),f(l),Se(()=>{Gn(l,`right-sidebar hidden md:flex ${r()??""} svelte-3gnxyq`),Nt(l,"data-theme",s().theme)}),O(o,l),Tc()}function cz(o,e){o.preventDefault(),o.stopPropagation(),e("double-click")}var dz=re('<div role="separator" aria-orientation="vertical" aria-label="Resize sidebar" tabindex="0"><div class="resize-indicator svelte-uwsrre"><div class="resize-dots svelte-uwsrre"><div class="dot svelte-uwsrre"></div> <div class="dot svelte-uwsrre"></div> <div class="dot svelte-uwsrre"></div></div></div></div>');function uz(o,e){Mc(e,!0);let t=Qs(e,"className",3,"");const s=sp();let i=ee(!1),r=0,a=0,l;const c=180,d=480,v=12;function g(T){if(T.button!==0)return;T.preventDefault(),T.stopPropagation(),x(i,!0),r=T.clientX;const z=l.closest(".sidebar-container");z&&(a=z.offsetWidth),l.setPointerCapture(T.pointerId),document.body.style.userSelect="none",document.body.style.pointerEvents="none",l.style.pointerEvents="auto",s("resize:start",{widthPx:a})}function _(T){if(!n(i))return;T.preventDefault(),T.stopPropagation();const z=T.clientX-r,j=Math.max(c,Math.min(d,a-z));requestAnimationFrame(()=>{s("resize:move",{widthPx:j})})}function y(T){if(!n(i))return;T.preventDefault(),T.stopPropagation(),x(i,!1),l.releasePointerCapture(T.pointerId),document.body.style.userSelect="",document.body.style.pointerEvents="",l.style.pointerEvents="";const z=T.clientX-r,j=Math.max(c,Math.min(d,a-z));s("resize:end",{widthPx:j})}function k(T){n(i)&&(x(i,!1),l.releasePointerCapture(T.pointerId),document.body.style.userSelect="",document.body.style.pointerEvents="",l.style.pointerEvents="",s("resize:end",{widthPx:a}))}function S(T){if(!["ArrowLeft","ArrowRight"].includes(T.key))return;T.preventDefault(),T.stopPropagation();const z=l.closest(".sidebar-container");if(!z)return;const j=z.offsetWidth;let B=j;T.key==="ArrowLeft"?B=Math.min(d,j+v):T.key==="ArrowRight"&&(B=Math.max(c,j-v)),B!==j&&(s("resize:start",{widthPx:j}),s("resize:move",{widthPx:B}),s("resize:end",{widthPx:B}))}function M(){}function I(){}var C=dz();C.__pointerdown=g,C.__pointermove=_,C.__pointerup=y,C.__dblclick=[cz,s],C.__keydown=S,du(C,T=>l=T,()=>l),Se(()=>{Gn(C,`sidebar-resize-handle ${t()??""} svelte-uwsrre`),ii(C,"dragging",n(i))}),id("pointercancel",C,k),id("focus",C,M),id("blur",C,I),O(o,C),Tc()}Hd(["pointerdown","pointermove","pointerup","dblclick","keydown"]);const W0=180,$h=480,N0=280;function Vx(o,e=W0,t=$h,s=N0){return isNaN(o)||o<e||o>t?s:o}function fh(){return typeof window<"u"&&window.__sidebarBootstrap?window.__sidebarBootstrap:{visible:!1,widthPx:0,transitionsEnabled:!1}}function N1(o){if(typeof window<"u"){window.__sidebarBootstrap||(window.__sidebarBootstrap=fh()),window.__sidebarBootstrap={...window.__sidebarBootstrap,...o};const e=document.documentElement,t=window.__sidebarBootstrap,s=t.visible?t.widthPx+"px":"0px",i=t.visible?"1":"0";e.style.setProperty("--sidebar-width",s),e.style.setProperty("--sidebar-visible",i),e.style.setProperty("--chart-sidebar-width",s),e.style.setProperty("--chart-sidebar-visible",i)}}function pz(o,e){if(typeof window<"u"&&window.localStorage)try{if(localStorage.setItem("dutyai.chart.sidebar.visible","false"),o){const t=Vx(e,W0,$h,N0);localStorage.setItem("dutyai.chart.sidebar.widthPx",String(t))}}catch(t){console.warn("Failed to persist sidebar state:",t)}}function vz(){if(typeof window>"u")return!0;const o=window.innerWidth,s=W0+80+300;return o>=s}function Gy(){N1({transitionsEnabled:!0})}function fz(){N1({transitionsEnabled:!1})}function D_(o,e){const t=e!==void 0?e:o?N0:0;N1({visible:o,widthPx:o?Vx(t,W0,$h,N0):0}),pz(o,t)}const mz={MIN_WIDTH:W0,MAX_WIDTH:$h,DEFAULT_WIDTH:N0,PRICE_SCALE_WIDTH:80};class gz{constructor(){ve(this,"pending",!1);ve(this,"callbacks",[]);ve(this,"rafId",null)}request(e){this.callbacks.push(e),!this.pending&&(this.pending=!0,this.rafId=requestAnimationFrame(async()=>{this.pending=!1,this.rafId=null;const t=[...this.callbacks];this.callbacks=[];for(const s of t)try{await s()}catch(i){console.error("RenderScheduler: Error executing callback",i)}}))}cancel(){this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.pending=!1,this.callbacks=[]}isPending(){return this.pending}immediate(e){requestAnimationFrame(async()=>{try{await e()}catch(t){console.error("RenderScheduler: Error executing immediate callback",t)}})}}let E_=null;function Dh(){return E_||(E_=new gz),E_}class hz{constructor(){ve(this,"scheduler",Dh());ve(this,"inProgress",!1);ve(this,"queue",[])}async run(e){if(this.inProgress){this.queue.push(e);return}this.inProgress=!0;try{await this.executeTransaction(e)}finally{if(this.inProgress=!1,this.queue.length>0){const t=this.queue.shift();this.run(t)}}}async executeTransaction(e){const{reason:t,chart:s,mutateState:i,measure:r,compute:a,draw:l,commit:c,cleanup:d,skipTransitions:v}=e;console.log(`🔄 RenderTransaction [${t}] starting...`);const g=performance.now();this.scheduler.request(async()=>{try{i&&await i(),r&&await r(),a&&await a(),l&&s&&await l(s),c&&await c();const _=performance.now()-g;console.log(`✅ RenderTransaction [${t}] completed in ${_.toFixed(2)}ms`)}catch(_){console.error(`❌ RenderTransaction [${t}] failed:`,_)}finally{d&&d()}})}async batch(e){if(e.length===0)return;const t={reason:e[0].reason,chart:e[0].chart,mutateState:async()=>{for(const s of e)s.mutateState&&await s.mutateState()},measure:async()=>{for(const s of e)s.measure&&await s.measure()},compute:async()=>{for(const s of e)s.compute&&await s.compute()},draw:async s=>{for(const i of e)i.draw&&await i.draw(s)},commit:async()=>{for(const s of e)s.commit&&await s.commit()},cleanup:()=>{for(const s of e)s.cleanup&&s.cleanup()}};await this.run(t)}isInProgress(){return this.inProgress}getQueueLength(){return this.queue.length}}let N_=null;function _z(){return N_||(N_=new hz),N_}class yz{constructor(){ve(this,"states",new Map);ve(this,"transitionProperty","transition")}register(e,t){this.states.set(e,{enabled:!1,element:t})}disable(e){const t=this.states.get(e);t&&(t.enabled=!1,t.element&&this.applyTransitionStyle(t.element,"none"))}enable(e){const t=this.states.get(e);t&&(t.enabled=!0,t.element&&this.applyTransitionStyle(t.element,""))}withoutTransitions(e,t){this.disable(e);const s=t();return requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.enable(e)})}),s}applyLayout(e,t,s=!0){this.disable(e),t(),s&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.enable(e)})})}isEnabled(e){var t;return((t=this.states.get(e))==null?void 0:t.enabled)??!1}updateElement(e,t){const s=this.states.get(e);s?(s.element=t,s.enabled?this.applyTransitionStyle(t,""):this.applyTransitionStyle(t,"none")):this.register(e,t)}applyTransitionStyle(e,t){e.style.setProperty(this.transitionProperty,t)}clear(){this.states.clear()}getKeys(){return Array.from(this.states.keys())}}let j_=null;function Wx(){return j_||(j_=new yz),j_}class bz{constructor(){ve(this,"rafId",null);ve(this,"pending",!1);ve(this,"lastArgs",null)}throttle(e,...t){this.lastArgs=t,!this.pending&&(this.pending=!0,this.rafId=requestAnimationFrame(async()=>{this.pending=!1,this.rafId=null;const s=this.lastArgs;this.lastArgs=null;try{await e(...s)}catch(i){console.error("Throttler: Error executing function",i)}}))}cancel(){this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.pending=!1,this.lastArgs=null}isPending(){return this.pending}}class xz{constructor(){ve(this,"transaction",_z());ve(this,"layoutManager",Wx());ve(this,"scheduler",Dh());ve(this,"applyCanvasColorsFn",null)}async waitIndicatorReady(e,t,s,i=800){var a;const r=Date.now();for(;Date.now()-r<i;){try{const l=((a=e.getIndicators)==null?void 0:a.call(e,{name:t,paneId:s}))??[];if(l.length>0&&l.some(d=>d&&d.result&&Object.keys(d.result).length>0))return}catch{}await new Promise(l=>setTimeout(l,16))}}setApplyCanvasColorsFunction(e){this.applyCanvasColorsFn=e}reapplyCanvasColors(){this.applyCanvasColorsFn&&this.applyCanvasColorsFn()}async addIndicator(e){let t=null;return await this.transaction.run({reason:"indicator",chart:e.chart,mutateState:()=>{t=e.chart.createIndicator({name:e.name,calcParams:e.params},e.isMain??!1,e.paneId?{id:e.paneId}:void 0)},compute:async()=>{await this.waitIndicatorReady(e.chart,e.name,e.paneId)},commit:()=>{console.log(`✅ Indicator added: ${e.name} (${t})`),this.scheduler.request(()=>{this.reapplyCanvasColors()})}}),t}async removeIndicator(e){await this.transaction.run({reason:"indicator",chart:e.chart,mutateState:()=>{e.chart.removeIndicator({paneId:e.paneId,name:e.name})},commit:()=>{console.log(`✅ Indicator removed: ${e.name}`)}})}async changeTimeframe(e){await this.transaction.run({reason:"timeframe",chart:e.chart,compute:async()=>{await e.loadDataFn()},commit:()=>{console.log("✅ Timeframe changed"),e.skipCanvasReapply||this.scheduler.request(()=>{this.reapplyCanvasColors()})}})}async switchChartType(e){await this.transaction.run({reason:"type",chart:e.chart,mutateState:()=>{},compute:async()=>{await e.reloadDataFn()},commit:()=>{console.log(`✅ Chart type switched to: ${e.newType}`),this.scheduler.request(()=>{this.reapplyCanvasColors()})}})}async sidebarOperation(e){const t="sidebar";this.layoutManager.register(t),await this.transaction.run({reason:"sidebar",chart:e.chart,skipTransitions:!0,mutateState:()=>{this.layoutManager.disable(t)},measure:()=>{},commit:()=>{this.scheduler.request(()=>{e.chart.resize(),this.reapplyCanvasColors(),requestAnimationFrame(()=>{this.layoutManager.enable(t)})})}})}async changeTheme(e,t){await this.transaction.run({reason:"theme",chart:e,mutateState:()=>{t()},commit:()=>{console.log("✅ Theme changed")}})}resizeChart(e){this.scheduler.request(()=>{e.resize()})}async batchIndicatorOperations(e){const t=e.map(s=>({reason:"indicator",chart:s.operation.chart,mutateState:()=>{s.type==="add"?s.operation.chart.createIndicator({name:s.operation.name,calcParams:s.operation.params},s.operation.isMain??!1,s.operation.paneId?{id:s.operation.paneId}:void 0):s.operation.chart.removeIndicator({paneId:s.operation.paneId,name:s.operation.name})}}));await this.transaction.batch(t)}}let R_=null;function j1(){return R_||(R_=new xz),R_}var wz=re('<div class="sidebar-container svelte-1chwdug"><!> <!></div>'),kz=re("<div><!></div>");function Sz(o,e){Mc(e,!0);const t=Au(),s=()=>ua(c,"$chart",t),i=()=>ua(S,"$sidebarWidth",t),r=()=>ua(d,"$save",t),a=()=>ua(M,"$sidebarState",t);let l=Qs(e,"className",3,"");const c=vc("chart"),d=vc("save"),{MIN_WIDTH:v,MAX_WIDTH:g,DEFAULT_WIDTH:_,PRICE_SCALE_WIDTH:y}=mz,k=fh(),S=op(k.widthPx);d.update(Re=>(Re.showSidebar=k.visible,Re));const M=Nd([d,S],([Re,Ke])=>({visible:Re.showSidebar,widthPx:Ke})),I=sp();let C=ee(!1);j1();const T=Dh(),z=Wx(),j=new bz;z.register("sidebar");function B(){s()&&T.request(()=>{var Re;(Re=s())==null||Re.resize()})}function $(){s()&&j.throttle(()=>{T.request(()=>{var Re;(Re=s())==null||Re.resize()})})}function F(){if(!s())return;const Re=i()||_;z.enable("sidebar"),d.update(Ke=>(Ke.showSidebar=!0,Ke)),S.set(Re),D_(!0,Re),I("sidebar:toggle",{visible:!0}),requestAnimationFrame(()=>{B(),setTimeout(()=>{B()},100),setTimeout(()=>{B()},250)})}function V(){s()&&(z.enable("sidebar"),d.update(Re=>(Re.showSidebar=!1,Re)),D_(!1,0),I("sidebar:toggle",{visible:!1}),requestAnimationFrame(()=>{B(),setTimeout(()=>{B()},100),setTimeout(()=>{B()},250)}))}function K(){fh().visible?V():F()}function Y(Re){const Ke=Math.max(v,Math.min(g,Re));S.set(Ke),r().showSidebar&&D_(!0,Ke),I("sidebar:resize:move",{widthPx:Ke}),$()}function Z(){return a()}function ne(Re){z.disable("sidebar"),fz(),I("sidebar:resize:start",{widthPx:i()})}function te(Re){const Ke=Re.detail.widthPx;Y(Ke)}function oe(Re){n(C)&&(z.enable("sidebar"),Gy()),I("sidebar:resize:end",{widthPx:i()})}function U(){Y(_)}function J(){!vz()&&r().showSidebar&&V()}function se(Re){if(Re.key==="S"&&!Re.ctrlKey&&!Re.metaKey&&!Re.altKey){const Ke=Re.target;Ke.tagName!=="INPUT"&&Ke.tagName!=="TEXTAREA"&&!Ke.isContentEditable&&(Re.preventDefault(),K())}}hp(()=>{(async()=>(z.disable("sidebar"),await v5(),J(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{x(C,!0),z.enable("sidebar"),Gy(),console.log("✨ Sidebar transitions enabled"),s()&&B()})})))();const Re=()=>{J()};return window.addEventListener("resize",Re),window.addEventListener("keydown",se),()=>{window.removeEventListener("resize",Re),window.removeEventListener("keydown",se),j.cancel()}});const W=Qe(()=>()=>{const Re=fh(),Ke=Re.visible?`${Re.widthPx}px`:"0px";return{"--sidebar-width":Ke,"--sidebar-visible":Re.visible?"1":"0","--sidebar-transitions":Re.transitionsEnabled?"width 200ms cubic-bezier(0.4, 0, 0.2, 1)":"none",width:Ke}});var le=kz();const ye=Qe(()=>Object.entries(n(W)).map(([Re,Ke])=>`${Re}: ${Ke}`).join("; "));var Ce=m(le);return Te(Ce,()=>a().visible,Re=>{var Ke=wz(),st=m(Ke);lz(st,{});var vt=p(st,2);uz(vt,{$$events:{"resize:start":ne,"resize:move":te,"resize:end":oe,"double-click":U}}),f(Ke),Se(()=>Nt(Ke,"style",`width: ${i()??""}px;`)),O(Re,Ke)}),f(le),Se(()=>{Gn(le,`sidebar-host ${l()??""} svelte-1chwdug`),Nt(le,"style",n(ye))}),O(o,le),Tc({openSidebar:F,closeSidebar:V,toggleSidebar:K,setSidebarWidth:Y,getSidebarState:Z})}const Cz=["XAU","XAG","XPT","XPD","CNH"],Uy=new Set(["USD","EUR","GBP","JPY","CHF","CAD","AUD","NZD","SEK","NOK","DKK","SGD","HKD","CNY","INR","KRW","THB","MYR","IDR","PHP","MXN","BRL","ZAR","TRY","PLN","CZK","HUF","RON","ILS","RUB","AED","SAR","QAR","KWD",...Cz]),Pz=["USDT","USDC","BUSD","DAI","TUSD","FDUSD","USD","BTC","ETH","BNB","SOL","XBT"],Iz=["BINANCE","COINBASE","KRAKEN","BYBIT","OKX","BITFINEX","KUCOIN","GATE","MEXC","BITGET"],Mz=["OANDA","FXCM","FOREX","FX","DUKASCOPY","PEPPERSTONE","ICMARKETS","IG"];function xh(o){if(typeof o=="number"&&Number.isFinite(o))return o;if(typeof o=="string"){const e=Number(o.trim());if(Number.isFinite(e))return e}}function B_(o){return typeof o=="number"&&Number.isFinite(o)}function Cf(o,e,t){return Math.min(t,Math.max(e,Math.trunc(o)))}function qx(o){const e=typeof o.exchange=="string"?o.exchange.trim():"",t=typeof o.ticker=="string"?o.ticker.trim():"";if(!e&&t.includes(":")){const s=t.indexOf(":"),i=t.slice(0,s).trim(),r=t.slice(s+1).trim();return{exchange:i?i.toUpperCase():void 0,ticker:r.toUpperCase()}}return{exchange:e?e.toUpperCase():void 0,ticker:t.toUpperCase()}}function Hx(o){return(o||"").replace(/[^A-Z]/gi,"").toUpperCase()}function Gx(o){const e=(o.market??o.type??"").toString().toLowerCase();if(e.includes("forex")||e==="fx")return"forex";if(e.includes("crypto")||e.includes("coin"))return"crypto";const{exchange:t,ticker:s}=qx(o),i=(t||"").toUpperCase();if(Iz.some(a=>i.includes(a)))return"crypto";if(Mz.some(a=>i.includes(a)))return"forex";const r=Hx(s);if(r.length>=6){const a=r.slice(0,3),l=r.slice(3,6);if(Uy.has(a)&&Uy.has(l))return"forex"}return Pz.some(a=>r.endsWith(a))?"crypto":e.includes("stock")||e.includes("equity")||e.includes("index")?"stock":"unknown"}function Xg(o){return Gx(o)}function Tz(o){const{ticker:e}=qx(o),t=Hx(e),s=t.slice(0,3),i=t.slice(3,6);return s==="XAU"||s==="XAG"||s==="XPT"||s==="XPD"||i==="JPY"?3:5}function Az(o,e){if(!Number.isFinite(o))return 0;try{const t=o.toFixed(e).replace(/\.?0+$/,""),s=t.indexOf(".");return s===-1?0:t.length-s-1}catch{return 0}}function O_(o){if(!Array.isArray(o)||o.length===0)return;const e=o.slice(Math.max(0,o.length-200));let t=0;for(const s of e){const i=[s.open,s.high,s.low,s.close];for(const r of i){const a=xh(r);if(a!=null&&(t=Math.max(t,Az(a,12)),t>=12))return 12}}return t}function Lz(o){var e;if(!(!Array.isArray(o)||o.length===0))for(let t=o.length-1;t>=0;t--){const s=(e=o[t])==null?void 0:e.close,i=xh(s);if(i!=null)return i}}function Jg(o,e){const t=Gx(o);if(t==="forex"){const a=Tz(o),l=xh(o==null?void 0:o.pricePrecision),c=e?O_(e):void 0,d=Math.max(a,l??0,B_(c)?c:0);return Cf(d,0,12)}const s=o==null?void 0:o.pricePrecision,i=xh(s);if(t==="stock")return i!=null?Cf(i,0,12):2;const r=e?O_(e):void 0;if(B_(r))return Cf(r,2,12);if(t==="crypto"){const a=e?O_(e):void 0,l=B_(a)?a:i??6,c=Math.abs(Lz(e)??NaN);return Number.isFinite(c)?c>=1e3?Cf(l,2,2):c>=1?Cf(l,2,4):c>=.01?Cf(l,4,8):Cf(l,6,12):Cf(l,2,12)}return i!=null?Cf(i,0,12):2}var Ux={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(o,e){(function(t,s){o.exports=s()})(Tf,function t(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},i=!s.document&&!!s.postMessage,r=s.IS_PAPA_WORKER||!1,a={},l=0,c={parse:function(F,V){var K=(V=V||{}).dynamicTyping||!1;if($(K)&&(V.dynamicTypingFunction=K,K={}),V.dynamicTyping=K,V.transform=!!$(V.transform)&&V.transform,V.worker&&c.WORKERS_SUPPORTED){var Y=function(){if(!c.WORKERS_SUPPORTED)return!1;var ne=(oe=s.URL||s.webkitURL||null,U=t.toString(),c.BLOB_URL||(c.BLOB_URL=oe.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",U,")();"],{type:"text/javascript"})))),te=new s.Worker(ne),oe,U;return te.onmessage=C,te.id=l++,a[te.id]=te}();return Y.userStep=V.step,Y.userChunk=V.chunk,Y.userComplete=V.complete,Y.userError=V.error,V.step=$(V.step),V.chunk=$(V.chunk),V.complete=$(V.complete),V.error=$(V.error),delete V.worker,void Y.postMessage({input:F,config:V,workerId:Y.id})}var Z=null;return c.NODE_STREAM_INPUT,typeof F=="string"?(F=function(ne){return ne.charCodeAt(0)===65279?ne.slice(1):ne}(F),Z=V.download?new g(V):new y(V)):F.readable===!0&&$(F.read)&&$(F.on)?Z=new k(V):(s.File&&F instanceof File||F instanceof Object)&&(Z=new _(V)),Z.stream(F)},unparse:function(F,V){var K=!1,Y=!0,Z=",",ne=`\r
`,te='"',oe=te+te,U=!1,J=null,se=!1;(function(){if(typeof V=="object"){if(typeof V.delimiter!="string"||c.BAD_DELIMITERS.filter(function(Ce){return V.delimiter.indexOf(Ce)!==-1}).length||(Z=V.delimiter),(typeof V.quotes=="boolean"||typeof V.quotes=="function"||Array.isArray(V.quotes))&&(K=V.quotes),typeof V.skipEmptyLines!="boolean"&&typeof V.skipEmptyLines!="string"||(U=V.skipEmptyLines),typeof V.newline=="string"&&(ne=V.newline),typeof V.quoteChar=="string"&&(te=V.quoteChar),typeof V.header=="boolean"&&(Y=V.header),Array.isArray(V.columns)){if(V.columns.length===0)throw new Error("Option columns is empty");J=V.columns}V.escapeChar!==void 0&&(oe=V.escapeChar+te),(typeof V.escapeFormulae=="boolean"||V.escapeFormulae instanceof RegExp)&&(se=V.escapeFormulae instanceof RegExp?V.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var W=new RegExp(M(te),"g");if(typeof F=="string"&&(F=JSON.parse(F)),Array.isArray(F)){if(!F.length||Array.isArray(F[0]))return le(null,F,U);if(typeof F[0]=="object")return le(J||Object.keys(F[0]),F,U)}else if(typeof F=="object")return typeof F.data=="string"&&(F.data=JSON.parse(F.data)),Array.isArray(F.data)&&(F.fields||(F.fields=F.meta&&F.meta.fields||J),F.fields||(F.fields=Array.isArray(F.data[0])?F.fields:typeof F.data[0]=="object"?Object.keys(F.data[0]):[]),Array.isArray(F.data[0])||typeof F.data[0]=="object"||(F.data=[F.data])),le(F.fields||[],F.data||[],U);throw new Error("Unable to serialize unrecognized input");function le(Ce,Re,Ke){var st="";typeof Ce=="string"&&(Ce=JSON.parse(Ce)),typeof Re=="string"&&(Re=JSON.parse(Re));var vt=Array.isArray(Ce)&&0<Ce.length,Je=!Array.isArray(Re[0]);if(vt&&Y){for(var ot=0;ot<Ce.length;ot++)0<ot&&(st+=Z),st+=ye(Ce[ot],ot);0<Re.length&&(st+=ne)}for(var nt=0;nt<Re.length;nt++){var tt=vt?Ce.length:Re[nt].length,Ze=!1,ct=vt?Object.keys(Re[nt]).length===0:Re[nt].length===0;if(Ke&&!vt&&(Ze=Ke==="greedy"?Re[nt].join("").trim()==="":Re[nt].length===1&&Re[nt][0].length===0),Ke==="greedy"&&vt){for(var Ge=[],pt=0;pt<tt;pt++){var ce=Je?Ce[pt]:pt;Ge.push(Re[nt][ce])}Ze=Ge.join("").trim()===""}if(!Ze){for(var we=0;we<tt;we++){0<we&&!ct&&(st+=Z);var ze=vt&&Je?Ce[we]:we;st+=ye(Re[nt][ze],we)}nt<Re.length-1&&(!Ke||0<tt&&!ct)&&(st+=ne)}}return st}function ye(Ce,Re){if(Ce==null)return"";if(Ce.constructor===Date)return JSON.stringify(Ce).slice(1,25);var Ke=!1;se&&typeof Ce=="string"&&se.test(Ce)&&(Ce="'"+Ce,Ke=!0);var st=Ce.toString().replace(W,oe);return(Ke=Ke||K===!0||typeof K=="function"&&K(Ce,Re)||Array.isArray(K)&&K[Re]||function(vt,Je){for(var ot=0;ot<Je.length;ot++)if(-1<vt.indexOf(Je[ot]))return!0;return!1}(st,c.BAD_DELIMITERS)||-1<st.indexOf(Z)||st.charAt(0)===" "||st.charAt(st.length-1)===" ")?te+st+te:st}}};if(c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!s.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=I,c.ParserHandle=S,c.NetworkStreamer=g,c.FileStreamer=_,c.StringStreamer=y,c.ReadableStreamStreamer=k,s.jQuery){var d=s.jQuery;d.fn.parse=function(F){var V=F.config||{},K=[];return this.each(function(ne){if(!(d(this).prop("tagName").toUpperCase()==="INPUT"&&d(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var te=0;te<this.files.length;te++)K.push({file:this.files[te],inputElem:this,instanceConfig:d.extend({},V)})}),Y(),this;function Y(){if(K.length!==0){var ne,te,oe,U,J=K[0];if($(F.before)){var se=F.before(J.file,J.inputElem);if(typeof se=="object"){if(se.action==="abort")return ne="AbortError",te=J.file,oe=J.inputElem,U=se.reason,void($(F.error)&&F.error({name:ne},te,oe,U));if(se.action==="skip")return void Z();typeof se.config=="object"&&(J.instanceConfig=d.extend(J.instanceConfig,se.config))}else if(se==="skip")return void Z()}var W=J.instanceConfig.complete;J.instanceConfig.complete=function(le){$(W)&&W(le,J.file,J.inputElem),Z()},c.parse(J.file,J.instanceConfig)}else $(F.complete)&&F.complete()}function Z(){K.splice(0,1),Y()}}}function v(F){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(V){var K=j(V);K.chunkSize=parseInt(K.chunkSize),V.step||V.chunk||(K.chunkSize=null),this._handle=new S(K),(this._handle.streamer=this)._config=K}).call(this,F),this.parseChunk=function(V,K){if(this.isFirstChunk&&$(this._config.beforeFirstChunk)){var Y=this._config.beforeFirstChunk(V);Y!==void 0&&(V=Y)}this.isFirstChunk=!1,this._halted=!1;var Z=this._partialLine+V;this._partialLine="";var ne=this._handle.parse(Z,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var te=ne.meta.cursor;this._finished||(this._partialLine=Z.substring(te-this._baseIndex),this._baseIndex=te),ne&&ne.data&&(this._rowCount+=ne.data.length);var oe=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)s.postMessage({results:ne,workerId:c.WORKER_ID,finished:oe});else if($(this._config.chunk)&&!K){if(this._config.chunk(ne,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);ne=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(ne.data),this._completeResults.errors=this._completeResults.errors.concat(ne.errors),this._completeResults.meta=ne.meta),this._completed||!oe||!$(this._config.complete)||ne&&ne.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),oe||ne&&ne.meta.paused||this._nextChunk(),ne}this._halted=!0},this._sendError=function(V){$(this._config.error)?this._config.error(V):r&&this._config.error&&s.postMessage({workerId:c.WORKER_ID,error:V,finished:!1})}}function g(F){var V;(F=F||{}).chunkSize||(F.chunkSize=c.RemoteChunkSize),v.call(this,F),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(K){this._input=K,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(V=new XMLHttpRequest,this._config.withCredentials&&(V.withCredentials=this._config.withCredentials),i||(V.onload=B(this._chunkLoaded,this),V.onerror=B(this._chunkError,this)),V.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var K=this._config.downloadRequestHeaders;for(var Y in K)V.setRequestHeader(Y,K[Y])}if(this._config.chunkSize){var Z=this._start+this._config.chunkSize-1;V.setRequestHeader("Range","bytes="+this._start+"-"+Z)}try{V.send(this._config.downloadRequestBody)}catch(ne){this._chunkError(ne.message)}i&&V.status===0&&this._chunkError()}},this._chunkLoaded=function(){V.readyState===4&&(V.status<200||400<=V.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:V.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(K){var Y=K.getResponseHeader("Content-Range");return Y===null?-1:parseInt(Y.substring(Y.lastIndexOf("/")+1))}(V),this.parseChunk(V.responseText)))},this._chunkError=function(K){var Y=V.statusText||K;this._sendError(new Error(Y))}}function _(F){var V,K;(F=F||{}).chunkSize||(F.chunkSize=c.LocalChunkSize),v.call(this,F);var Y=typeof FileReader<"u";this.stream=function(Z){this._input=Z,K=Z.slice||Z.webkitSlice||Z.mozSlice,Y?((V=new FileReader).onload=B(this._chunkLoaded,this),V.onerror=B(this._chunkError,this)):V=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Z=this._input;if(this._config.chunkSize){var ne=Math.min(this._start+this._config.chunkSize,this._input.size);Z=K.call(Z,this._start,ne)}var te=V.readAsText(Z,this._config.encoding);Y||this._chunkLoaded({target:{result:te}})},this._chunkLoaded=function(Z){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Z.target.result)},this._chunkError=function(){this._sendError(V.error)}}function y(F){var V;v.call(this,F=F||{}),this.stream=function(K){return V=K,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var K,Y=this._config.chunkSize;return Y?(K=V.substring(0,Y),V=V.substring(Y)):(K=V,V=""),this._finished=!V,this.parseChunk(K)}}}function k(F){v.call(this,F=F||{});var V=[],K=!0,Y=!1;this.pause=function(){v.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){v.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Z){this._input=Z,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){Y&&V.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),V.length?this.parseChunk(V.shift()):K=!0},this._streamData=B(function(Z){try{V.push(typeof Z=="string"?Z:Z.toString(this._config.encoding)),K&&(K=!1,this._checkIsFinished(),this.parseChunk(V.shift()))}catch(ne){this._streamError(ne)}},this),this._streamError=B(function(Z){this._streamCleanUp(),this._sendError(Z)},this),this._streamEnd=B(function(){this._streamCleanUp(),Y=!0,this._streamData("")},this),this._streamCleanUp=B(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S(F){var V,K,Y,Z=Math.pow(2,53),ne=-Z,te=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,oe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,U=this,J=0,se=0,W=!1,le=!1,ye=[],Ce={data:[],errors:[],meta:{}};if($(F.step)){var Re=F.step;F.step=function(nt){if(Ce=nt,vt())st();else{if(st(),Ce.data.length===0)return;J+=nt.data.length,F.preview&&J>F.preview?K.abort():(Ce.data=Ce.data[0],Re(Ce,U))}}}function Ke(nt){return F.skipEmptyLines==="greedy"?nt.join("").trim()==="":nt.length===1&&nt[0].length===0}function st(){return Ce&&Y&&(ot("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),Y=!1),F.skipEmptyLines&&(Ce.data=Ce.data.filter(function(nt){return!Ke(nt)})),vt()&&function(){if(!Ce)return;function nt(Ze,ct){$(F.transformHeader)&&(Ze=F.transformHeader(Ze,ct)),ye.push(Ze)}if(Array.isArray(Ce.data[0])){for(var tt=0;vt()&&tt<Ce.data.length;tt++)Ce.data[tt].forEach(nt);Ce.data.splice(0,1)}else Ce.data.forEach(nt)}(),function(){if(!Ce||!F.header&&!F.dynamicTyping&&!F.transform)return Ce;function nt(Ze,ct){var Ge,pt=F.header?{}:[];for(Ge=0;Ge<Ze.length;Ge++){var ce=Ge,we=Ze[Ge];F.header&&(ce=Ge>=ye.length?"__parsed_extra":ye[Ge]),F.transform&&(we=F.transform(we,ce)),we=Je(ce,we),ce==="__parsed_extra"?(pt[ce]=pt[ce]||[],pt[ce].push(we)):pt[ce]=we}return F.header&&(Ge>ye.length?ot("FieldMismatch","TooManyFields","Too many fields: expected "+ye.length+" fields but parsed "+Ge,se+ct):Ge<ye.length&&ot("FieldMismatch","TooFewFields","Too few fields: expected "+ye.length+" fields but parsed "+Ge,se+ct)),pt}var tt=1;return!Ce.data.length||Array.isArray(Ce.data[0])?(Ce.data=Ce.data.map(nt),tt=Ce.data.length):Ce.data=nt(Ce.data,0),F.header&&Ce.meta&&(Ce.meta.fields=ye),se+=tt,Ce}()}function vt(){return F.header&&ye.length===0}function Je(nt,tt){return Ze=nt,F.dynamicTypingFunction&&F.dynamicTyping[Ze]===void 0&&(F.dynamicTyping[Ze]=F.dynamicTypingFunction(Ze)),(F.dynamicTyping[Ze]||F.dynamicTyping)===!0?tt==="true"||tt==="TRUE"||tt!=="false"&&tt!=="FALSE"&&(function(ct){if(te.test(ct)){var Ge=parseFloat(ct);if(ne<Ge&&Ge<Z)return!0}return!1}(tt)?parseFloat(tt):oe.test(tt)?new Date(tt):tt===""?null:tt):tt;var Ze}function ot(nt,tt,Ze,ct){var Ge={type:nt,code:tt,message:Ze};ct!==void 0&&(Ge.row=ct),Ce.errors.push(Ge)}this.parse=function(nt,tt,Ze){var ct=F.quoteChar||'"';if(F.newline||(F.newline=function(ce,we){ce=ce.substring(0,1048576);var ze=new RegExp(M(we)+"([^]*?)"+M(we),"gm"),dt=(ce=ce.replace(ze,"")).split("\r"),qe=ce.split(`
`),me=1<qe.length&&qe[0].length<dt[0].length;if(dt.length===1||me)return`
`;for(var Q=0,it=0;it<dt.length;it++)dt[it][0]===`
`&&Q++;return Q>=dt.length/2?`\r
`:"\r"}(nt,ct)),Y=!1,F.delimiter)$(F.delimiter)&&(F.delimiter=F.delimiter(nt),Ce.meta.delimiter=F.delimiter);else{var Ge=function(ce,we,ze,dt,qe){var me,Q,it,Vt;qe=qe||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var wt=0;wt<qe.length;wt++){var Yt=qe[wt],At=0,Gt=0,no=0;it=void 0;for(var Do=new I({comments:dt,delimiter:Yt,newline:we,preview:10}).parse(ce),Eo=0;Eo<Do.data.length;Eo++)if(ze&&Ke(Do.data[Eo]))no++;else{var bs=Do.data[Eo].length;Gt+=bs,it!==void 0?0<bs&&(At+=Math.abs(bs-it),it=bs):it=bs}0<Do.data.length&&(Gt/=Do.data.length-no),(Q===void 0||At<=Q)&&(Vt===void 0||Vt<Gt)&&1.99<Gt&&(Q=At,me=Yt,Vt=Gt)}return{successful:!!(F.delimiter=me),bestDelimiter:me}}(nt,F.newline,F.skipEmptyLines,F.comments,F.delimitersToGuess);Ge.successful?F.delimiter=Ge.bestDelimiter:(Y=!0,F.delimiter=c.DefaultDelimiter),Ce.meta.delimiter=F.delimiter}var pt=j(F);return F.preview&&F.header&&pt.preview++,V=nt,K=new I(pt),Ce=K.parse(V,tt,Ze),st(),W?{meta:{paused:!0}}:Ce||{meta:{paused:!1}}},this.paused=function(){return W},this.pause=function(){W=!0,K.abort(),V=$(F.chunk)?"":V.substring(K.getCharIndex())},this.resume=function(){U.streamer._halted?(W=!1,U.streamer.parseChunk(V,!0)):setTimeout(U.resume,3)},this.aborted=function(){return le},this.abort=function(){le=!0,K.abort(),Ce.meta.aborted=!0,$(F.complete)&&F.complete(Ce),V=""}}function M(F){return F.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function I(F){var V,K=(F=F||{}).delimiter,Y=F.newline,Z=F.comments,ne=F.step,te=F.preview,oe=F.fastMode,U=V=F.quoteChar===void 0||F.quoteChar===null?'"':F.quoteChar;if(F.escapeChar!==void 0&&(U=F.escapeChar),(typeof K!="string"||-1<c.BAD_DELIMITERS.indexOf(K))&&(K=","),Z===K)throw new Error("Comment character same as delimiter");Z===!0?Z="#":(typeof Z!="string"||-1<c.BAD_DELIMITERS.indexOf(Z))&&(Z=!1),Y!==`
`&&Y!=="\r"&&Y!==`\r
`&&(Y=`
`);var J=0,se=!1;this.parse=function(W,le,ye){if(typeof W!="string")throw new Error("Input must be a string");var Ce=W.length,Re=K.length,Ke=Y.length,st=Z.length,vt=$(ne),Je=[],ot=[],nt=[],tt=J=0;if(!W)return Is();if(F.header&&!le){var Ze=W.split(Y)[0].split(K),ct=[],Ge={},pt=!1;for(var ce in Ze){var we=Ze[ce];$(F.transformHeader)&&(we=F.transformHeader(we,ce));var ze=we,dt=Ge[we]||0;for(0<dt&&(pt=!0,ze=we+"_"+dt),Ge[we]=dt+1;ct.includes(ze);)ze=ze+"_"+dt;ct.push(ze)}if(pt){var qe=W.split(Y);qe[0]=ct.join(K),W=qe.join(Y)}}if(oe||oe!==!1&&W.indexOf(V)===-1){for(var me=W.split(Y),Q=0;Q<me.length;Q++){if(nt=me[Q],J+=nt.length,Q!==me.length-1)J+=Y.length;else if(ye)return Is();if(!Z||nt.substring(0,st)!==Z){if(vt){if(Je=[],no(nt.split(K)),qi(),se)return Is()}else no(nt.split(K));if(te&&te<=Q)return Je=Je.slice(0,te),Is(!0)}}return Is()}for(var it=W.indexOf(K,J),Vt=W.indexOf(Y,J),wt=new RegExp(M(U)+M(V),"g"),Yt=W.indexOf(V,J);;)if(W[J]!==V)if(Z&&nt.length===0&&W.substring(J,J+st)===Z){if(Vt===-1)return Is();J=Vt+Ke,Vt=W.indexOf(Y,J),it=W.indexOf(K,J)}else if(it!==-1&&(it<Vt||Vt===-1))nt.push(W.substring(J,it)),J=it+Re,it=W.indexOf(K,J);else{if(Vt===-1)break;if(nt.push(W.substring(J,Vt)),bs(Vt+Ke),vt&&(qi(),se))return Is();if(te&&Je.length>=te)return Is(!0)}else for(Yt=J,J++;;){if((Yt=W.indexOf(V,Yt+1))===-1)return ye||ot.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Je.length,index:J}),Eo();if(Yt===Ce-1)return Eo(W.substring(J,Yt).replace(wt,V));if(V!==U||W[Yt+1]!==U){if(V===U||Yt===0||W[Yt-1]!==U){it!==-1&&it<Yt+1&&(it=W.indexOf(K,Yt+1)),Vt!==-1&&Vt<Yt+1&&(Vt=W.indexOf(Y,Yt+1));var At=Do(Vt===-1?it:Math.min(it,Vt));if(W.substr(Yt+1+At,Re)===K){nt.push(W.substring(J,Yt).replace(wt,V)),W[J=Yt+1+At+Re]!==V&&(Yt=W.indexOf(V,J)),it=W.indexOf(K,J),Vt=W.indexOf(Y,J);break}var Gt=Do(Vt);if(W.substring(Yt+1+Gt,Yt+1+Gt+Ke)===Y){if(nt.push(W.substring(J,Yt).replace(wt,V)),bs(Yt+1+Gt+Ke),it=W.indexOf(K,J),Yt=W.indexOf(V,J),vt&&(qi(),se))return Is();if(te&&Je.length>=te)return Is(!0);break}ot.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Je.length,index:J}),Yt++}}else Yt++}return Eo();function no(Ks){Je.push(Ks),tt=J}function Do(Ks){var ws=0;if(Ks!==-1){var vn=W.substring(Yt+1,Ks);vn&&vn.trim()===""&&(ws=vn.length)}return ws}function Eo(Ks){return ye||(Ks===void 0&&(Ks=W.substring(J)),nt.push(Ks),J=Ce,no(nt),vt&&qi()),Is()}function bs(Ks){J=Ks,no(nt),nt=[],Vt=W.indexOf(Y,J)}function Is(Ks){return{data:Je,errors:ot,meta:{delimiter:K,linebreak:Y,aborted:se,truncated:!!Ks,cursor:tt+(le||0)}}}function qi(){ne(Is()),Je=[],ot=[]}},this.abort=function(){se=!0},this.getCharIndex=function(){return J}}function C(F){var V=F.data,K=a[V.workerId],Y=!1;if(V.error)K.userError(V.error,V.file);else if(V.results&&V.results.data){var Z={abort:function(){Y=!0,T(V.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:z,resume:z};if($(K.userStep)){for(var ne=0;ne<V.results.data.length&&(K.userStep({data:V.results.data[ne],errors:V.results.errors,meta:V.results.meta},Z),!Y);ne++);delete V.results}else $(K.userChunk)&&(K.userChunk(V.results,Z,V.file),delete V.results)}V.finished&&!Y&&T(V.workerId,V.results)}function T(F,V){var K=a[F];$(K.userComplete)&&K.userComplete(V),K.terminate(),delete a[F]}function z(){throw new Error("Not implemented.")}function j(F){if(typeof F!="object"||F===null)return F;var V=Array.isArray(F)?[]:{};for(var K in F)V[K]=j(F[K]);return V}function B(F,V){return function(){F.apply(V,arguments)}}function $(F){return typeof F=="function"}return r&&(s.onmessage=function(F){var V=F.data;if(c.WORKER_ID===void 0&&V&&(c.WORKER_ID=V.workerId),typeof V.input=="string")s.postMessage({workerId:c.WORKER_ID,results:c.parse(V.input,V.config),finished:!0});else if(s.File&&V.input instanceof File||V.input instanceof Object){var K=c.parse(V.input,V.config);K&&s.postMessage({workerId:c.WORKER_ID,results:K,finished:!0})}}),(g.prototype=Object.create(v.prototype)).constructor=g,(_.prototype=Object.create(v.prototype)).constructor=_,(y.prototype=Object.create(y.prototype)).constructor=y,(k.prototype=Object.create(v.prototype)).constructor=k,c})})(Ux);var zz=Ux.exports;const Fz=O0(zz);function $z(o,e,t,s,i){if(!(!e()||n(t).length===0))switch(o.key){case"ArrowDown":o.preventDefault(),x(s,D(Math.min(n(s)+1,n(t).length-1)));break;case"ArrowUp":o.preventDefault(),x(s,D(Math.max(n(s)-1,-1)));break;case"Enter":o.preventDefault(),n(s)>=0&&n(s)<n(t).length&&i(n(t)[n(s)]);break;case"Escape":o.preventDefault(),e(!1);break}}var Dz=re('<div class="flex justify-center py-16"><div class="relative"><div class="w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin"></div> <div class="absolute inset-0 w-12 h-12 border-4 border-transparent border-t-primary/60 rounded-full animate-spin" style="animation-delay: -0.15s;"></div></div></div>'),Ez=re('<div class="flex flex-col items-center justify-center py-16 text-center"><div class="w-16 h-16 rounded-full bg-base-200/50 flex items-center justify-center mb-4"><svg class="w-8 h-8 text-base-content/40" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div> <p class="text-lg font-semibold text-base-content/60 mb-2">No symbols found</p> <p class="text-sm text-base-content/40">Try a different search term</p></div>'),Nz=(o,e,t)=>e(n(t)),jz=re('<div class="absolute top-0 left-0 w-5 h-5 rounded-full overflow-hidden bg-base-200 ring-2 ring-base-100 z-10"><img class="w-full h-full object-cover"></div> <div class="absolute bottom-0 right-0 w-5 h-5 rounded-full overflow-hidden bg-base-200"><img class="w-full h-full object-cover"></div>',1),Rz=re('<div class="relative w-full h-full rounded-lg overflow-hidden bg-base-200/50"><img class="w-full h-full object-cover"> <div class="absolute inset-0 bg-base-200 flex items-center justify-center hidden"><span class="text-xs font-medium text-base-content/60"> </span></div></div>'),Bz=re('<span class="text-xs px-1.5 py-0.5 rounded bg-base-200/60 border border-base-300/40 text-base-content/60"> </span>'),Oz=re('<p class="text-sm text-base-content/60 truncate mt-0.5"> </p>'),Vz=re('<div class="flex-shrink-0"><svg class="w-4 h-4 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></svg></div>'),Wz=re('<div><div class="relative w-8 h-8 flex-shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><h3 class="font-medium text-base"> </h3> <span class="text-xs text-base-content/50"> </span> <!></div> <!></div> <!></div>'),qz=re('<div class="flex items-center justify-center py-4"><div class="flex items-center gap-3 text-base-content/60"><div class="relative"><div class="w-6 h-6 border-2 border-primary/20 border-t-primary rounded-full animate-spin"></div> <div class="absolute inset-0 w-6 h-6 border-2 border-transparent border-t-primary/60 rounded-full animate-spin" style="animation-delay: -0.15s;"></div></div> <span class="text-sm">Loading more symbols…</span></div></div>'),Hz=re('<div class="divide-y divide-base-300/20"><!> <!></div>'),Gz=re('<div class="flex flex-col gap-6"><div class="relative"><div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-base-content/50 pointer-events-none"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div> <input type="text" class="w-full pl-12 pr-4 py-3 text-sm bg-base-100 border border-base-300/50 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 placeholder:text-base-content/50" placeholder="Search symbols..."></div> <div class="relative rounded-lg overflow-hidden bg-base-100 border border-base-300/30"><div class="h-96 overflow-y-auto luxury-scrollbar svelte-1r1pdks"><!></div></div> <div class="flex justify-center items-center py-2 mt-1"><div class="group relative cursor-pointer"><div class="absolute inset-0 bg-gradient-to-r from-transparent via-primary/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-700 ease-out blur-xl"></div> <div class="relative flex items-center gap-2 px-4 py-1.5 rounded-full bg-gradient-to-r from-base-100/80 to-base-200/60 backdrop-blur-sm border border-base-300/30 shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-500 ease-out"><div class="w-2 h-2 rounded-full bg-gradient-to-r from-primary to-secondary animate-pulse"></div> <span class="text-sm font-medium text-base-content/70 group-hover:text-primary transition-colors duration-300">Powered by</span> <span class="text-sm font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent group-hover:from-secondary group-hover:to-primary transition-all duration-500">Duty AI</span> <div class="w-2 h-2 rounded-full bg-gradient-to-r from-secondary to-primary animate-pulse" style="animation-delay: 0.5s;"></div></div></div></div></div>'),Uz=re("<div><!></div>");function Yz(o,e){Mc(e,!0);const t=Au(),s=()=>ua(I,"$save",t),i=()=>ua(c,"$keyword",t),r=()=>ua(M,"$ctx",t);let a=Qs(e,"show",15);const l=$b();let c=op(""),d=ee(D([]));const v=50;let g=ee(v),_=ee(!1),y,k=ee(D([])),S=ee(-1);const M=vc("ctx"),I=vc("save");zr(()=>{a()&&(console.log("🔍 Modal opened! Available symbols:",s().allSymbols.length),console.log("🔍 Current symbol:",s().symbol),x(d,D(s().allSymbols)),x(g,v),x(S,-1))}),zr(()=>{x(k,D(n(d).slice(0,n(g))))}),typeof window<"u"&&(window.testSymbolChange=()=>{if(s().allSymbols.length>0){const ne=s().allSymbols[1];console.log("🧪 Testing symbol change to:",ne),F(ne)}else console.log("🧪 No symbols available for testing")});function C(ne){return ne.toLowerCase().replace(/[^\p{L}\p{N}]+/gu," ").trim()}function T(ne){return C(ne).split(/\s+/).filter(Boolean).map(oe=>oe[0]).join("")}function z(ne,te){const oe=ne.length,U=te.length;if(oe===0)return U;if(U===0)return oe;const J=new Array(U+1);for(let se=0;se<=U;(se+=1)-1)J[se]=se;for(let se=1;se<=oe;(se+=1)-1){let W=se-1;J[0]=se;for(let le=1;le<=U;(le+=1)-1){const ye=J[le],Ce=ne[se-1]===te[le-1]?0:1;J[le]=Math.min(J[le]+1,J[le-1]+1,W+Ce),W=ye}}return J[U]}function j(ne,te){const oe=Math.max(ne.length,te.length);return oe===0?1:1-z(ne,te)/oe}function B(ne,te){if(!te||!te.trim())return ne;const U=C(te).split(/\s+/).filter(Boolean);return ne.map(se=>{const W=se.ticker.toLowerCase(),le=se.shortName||"";le.toLowerCase();const ye=C(le),Ce=ye.split(/\s+/).filter(Boolean),Re=(se.exchange||"").toLowerCase(),Ke=T(le);let st=0,vt=0;for(const Je of U){let ot=0;W===Je?ot+=1200:W.startsWith(Je)?ot+=800:W.includes(Je)?ot+=600:Ke===Je||Ke.startsWith(Je)?ot+=450:ye.startsWith(Je)?ot+=500:ye.includes(Je)?ot+=300:Re.includes(Je)?ot+=80:$(W,Je)?ot+=60:$(ye,Je)&&(ot+=40);const nt=j(W,Je);nt>.5&&(ot+=Math.floor(nt*300));let tt=0;for(const Ze of Ce){const ct=j(Ze,Je);if(ct>tt&&(tt=ct),tt>=.92)break}tt>.5&&(ot+=Math.floor(tt*200)),ot>0&&(vt+=1),st+=ot}return vt===U.length?st+=100:st+=vt*50,st>0&&W.length<=5&&(st+=20),{symbol:se,score:st}}).filter(se=>se.score>0).sort((se,W)=>W.score!==se.score?W.score-se.score:se.symbol.ticker.localeCompare(W.symbol.ticker)).map(se=>se.symbol)}function $(ne,te){let oe=0;for(let U=0;U<ne.length&&oe<te.length;(U+=1)-1)ne[U]===te[oe]&&(oe+=1);return oe===te.length}c.subscribe(ne=>{if(!ne||!ne.trim()){x(d,D(s().allSymbols)),x(g,v),x(S,-1);return}x(d,D(B(s().allSymbols,ne))),x(g,v),x(S,-1)});function F(ne){try{xb({logo:ne.logo,logo2:ne.logo2})}catch{}Wa(I,ys(s).symbol=ne,ys(s)),a(!1)}async function V(){n(_)||n(g)>=n(d).length||(x(_,!0),await new Promise(ne=>setTimeout(ne,250)),x(g,D(Math.min(n(g)+v,n(d).length))),x(_,!1))}function K(ne){const te=ne.currentTarget;te.scrollTop+te.clientHeight>=te.scrollHeight-24&&V()}var Y=Uz();Y.__keydown=[$z,a,k,S,F];var Z=m(Y);av(Z,{title:l,width:650,maxHeight:"85vh",get show(){return a()},set show(ne){a(ne)},get theme(){return s().theme},buttons:[],children:(ne,te)=>{var oe=Gz(),U=m(oe),J=p(m(U),2);Jt(J),j2(J,!0),f(U);var se=p(U,2),W=m(se),le=m(W);Te(le,()=>r().loadingPairs,ye=>{var Ce=Dz();O(ye,Ce)},ye=>{var Ce=So(),Re=Rt(Ce);Te(Re,()=>n(d).length===0,Ke=>{var st=Ez();O(Ke,st)},Ke=>{var st=Hz(),vt=m(st);Vs(vt,17,()=>n(k),_n,(ot,nt,tt)=>{var Ze=Wz();Ze.__click=[Nz,F,nt];var ct=m(Ze),Ge=m(ct);Te(Ge,()=>n(nt).logo2,Vt=>{var wt=jz(),Yt=Rt(wt),At=m(Yt);f(Yt);var Gt=p(Yt,2),no=m(Gt);f(Gt),Se(()=>{Nt(At,"src",`${n(nt).logo}`),Nt(At,"alt",n(nt).ticker),Nt(no,"src",`${n(nt).logo2}`),Nt(no,"alt",n(nt).ticker)}),id("error",At,Do=>{Do.target.style.display="none"}),m_(At),id("error",no,Do=>{Do.target.style.display="none"}),m_(no),O(Vt,wt)},Vt=>{var wt=Rz(),Yt=m(wt),At=p(Yt,2),Gt=m(At),no=m(Gt,!0);Se(()=>Ve(no,n(nt).ticker.charAt(0))),f(Gt),f(At),f(wt),Se(()=>{Nt(Yt,"src",`${n(nt).logo}`),Nt(Yt,"alt",n(nt).ticker)}),id("error",Yt,Do=>{const Eo=Do.target;if(Eo){Eo.style.display="none";const bs=Eo.nextElementSibling;bs&&(bs.style.display="flex")}}),m_(Yt),O(Vt,wt)}),f(ct);var pt=p(ct,2),ce=m(pt),we=m(ce),ze=m(we,!0);f(we);var dt=p(we,2),qe=m(dt,!0);f(dt);var me=p(dt,2);Te(me,()=>n(nt).type,Vt=>{var wt=Bz(),Yt=m(wt,!0);f(wt),Se(()=>Ve(Yt,n(nt).type)),O(Vt,wt)}),f(ce);var Q=p(ce,2);Te(Q,()=>n(nt).shortName&&n(nt).shortName!==n(nt).ticker,Vt=>{var wt=Oz(),Yt=m(wt,!0);f(wt),Se(()=>Ve(Yt,n(nt).shortName)),O(Vt,wt)}),f(pt);var it=p(pt,2);Te(it,()=>n(S)===tt,Vt=>{var wt=Vz();O(Vt,wt)}),f(Ze),Se(()=>{Gn(Ze,`group flex items-center gap-3 px-4 py-3 cursor-pointer transition-all duration-200
                         ${(n(S)===tt?"bg-primary/10 text-primary border-l-2 border-primary":"hover:bg-base-200/50 text-base-content")??""}`),Ve(ze,n(nt).ticker),Ve(qe,n(nt).exchange)}),O(ot,Ze)});var Je=p(vt,2);Te(Je,()=>n(_),ot=>{var nt=qz();O(ot,nt)}),f(st),O(Ke,st)},!0),O(ye,Ce)}),f(W),du(W,ye=>y=ye,()=>y),f(se),pn(2),f(oe),Ho(J,i,ye=>R2(c,ye)),id("scroll",W,K),O(ne,oe)},$$slots:{default:!0}}),f(Y),O(o,Y),Tc()}Hd(["keydown","click"]);var Kz=(o,e,t)=>e(n(t)),Zz=re('<li class="w-[140px] h-[85px] flex items-center justify-center cursor-pointer rounded-lg svelte-18wwyns"><span> </span></li>'),Xz=re('<div class="p-2"><ul class="flex flex-wrap justify-center gap-2"></ul></div>');function Jz(o,e){Mc(e,!0);const t=Au(),s=()=>ua(l,"$save",t),i=()=>ua(c,"$isRenkoActive",t);let r=Qs(e,"show",15);const a=zb(),l=vc("save"),c=Nd(l,_=>{var y,k;return((k=(y=_.styles)==null?void 0:y.candle)==null?void 0:k.type)==="renko_atr"}),d=[{timeframe:"1m",multiplier:1,timespan:"minute",secs:60},{timeframe:"5m",multiplier:5,timespan:"minute",secs:300},{timeframe:"15m",multiplier:15,timespan:"minute",secs:900},{timeframe:"30m",multiplier:30,timespan:"minute",secs:1800},{timeframe:"1h",multiplier:1,timespan:"hour",secs:3600},{timeframe:"4h",multiplier:4,timespan:"hour",secs:14400},{timeframe:"1d",multiplier:1,timespan:"day",secs:86400},{timeframe:"1w",multiplier:1,timespan:"week",secs:604800},{timeframe:"1M",multiplier:1,timespan:"month",secs:2592e3}];function v(_){var y;Wa(l,ys(s).period=_,ys(s));try{const k=(y=s())!=null&&y.key&&typeof s().key=="string"?s().key:"chart";typeof localStorage<"u"&&localStorage.setItem(`${k}.lastTimeframe`,(_==null?void 0:_.timeframe)||"")}catch{}try{f1.set(_)}catch{}r(!1)}function g(_){switch(_){case"minute":return Wb();case"hour":return qb();case"day":return Hb();case"week":return Gb();case"month":return Ub();default:return _}}av(o,{title:a,width:500,get show(){return r()},set show(_){r(_)},get theme(){return s().theme},buttons:[],children:(_,y)=>{var k=Xz(),S=m(k);Vs(S,21,()=>d,_n,(M,I)=>{var C=So(),T=Rt(C);Te(T,()=>!(i()&&n(I).timeframe==="4h"),z=>{var j=Zz();j.__click=[Kz,v,I];var B=m(j),$=m(B);Se(()=>Ve($,`${n(I).multiplier??""} ${g(n(I).timespan)??""}`)),f(B),f(j),Se(()=>{var F,V,K;ii(j,"hover:bg-base-200",n(I).timeframe!==((F=s().period)==null?void 0:F.timeframe)),ii(j,"bg-primary",n(I).timeframe===((V=s().period)==null?void 0:V.timeframe)),ii(j,"text-primary-content",n(I).timeframe===((K=s().period)==null?void 0:K.timeframe))}),O(z,j)}),O(M,C)}),f(S),f(k),O(_,k)},$$slots:{default:!0}}),Tc()}Hd(["click"]);const Qz=o=>o;function Yx(o){const e=o-1;return e*e*e+1}function Yy(o){const e=typeof o=="string"&&o.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[o,"px"]}function wh(o,{delay:e=0,duration:t=400,easing:s=Qz}={}){const i=+getComputedStyle(o).opacity;return{delay:e,duration:t,easing:s,css:r=>`opacity: ${r*i}`}}function kh(o,{delay:e=0,duration:t=400,easing:s=Yx,x:i=0,y:r=0,opacity:a=0}={}){const l=getComputedStyle(o),c=+l.opacity,d=l.transform==="none"?"":l.transform,v=c*(1-a),[g,_]=Yy(i),[y,k]=Yy(r);return{delay:e,duration:t,easing:s,css:(S,M)=>`
			transform: ${d} translate(${(1-S)*g}${_}, ${(1-S)*y}${k});
			opacity: ${c-v*M}`}}function eF(o,{delay:e=0,duration:t=400,easing:s=Yx,axis:i="y"}={}){const r=getComputedStyle(o),a=+r.opacity,l=i==="y"?"height":"width",c=parseFloat(r[l]),d=i==="y"?["top","bottom"]:["left","right"],v=d.map(I=>`${I[0].toUpperCase()}${I.slice(1)}`),g=parseFloat(r[`padding${v[0]}`]),_=parseFloat(r[`padding${v[1]}`]),y=parseFloat(r[`margin${v[0]}`]),k=parseFloat(r[`margin${v[1]}`]),S=parseFloat(r[`border${v[0]}Width`]),M=parseFloat(r[`border${v[1]}Width`]);return{delay:e,duration:t,easing:s,css:I=>`overflow: hidden;opacity: ${Math.min(I*20,1)*a};${l}: ${I*c}px;padding-${d[0]}: ${I*g}px;padding-${d[1]}: ${I*_}px;margin-${d[0]}: ${I*y}px;margin-${d[1]}: ${I*k}px;border-${d[0]}-width: ${I*S}px;border-${d[1]}-width: ${I*M}px;`}}function m1(o){const e=o-1;return e*e*e+1}const V_={CURRENT_VERSION:1,DEFAULT_FUTURE_MARGIN_MS:30*60*1e3,MAX_FUTURE_MARGIN_MS:24*60*60*1e3,MIN_FUTURE_MARGIN_MS:5*60*1e3,DEFAULT_FUTURE_MARGIN_PERCENT:.2,TIMESTAMP_PRECISION:1,PRICE_PRECISION:1e-6};function Sh(o,e){try{const{chart:t,paneId:s="candle_pane"}=e,i={timestamp:o.t,value:o.p},r=t.convertToPixel(i,{paneId:s,absolute:!0});if(!r||typeof r!="object")return null;const a=Array.isArray(r)?r[0]:r;return!a||typeof a!="object"||typeof a.x!="number"||typeof a.y!="number"||!isFinite(a.x)||!isFinite(a.y)?null:{x:a.x,y:a.y}}catch(t){return console.error("Error converting data-space to screen-space:",t),null}}function tF(o,e,t){try{const{chart:s,paneId:i="candle_pane"}=e,r=s.convertFromPixel([o],{paneId:i});if(!r||!Array.isArray(r)||r.length===0||!r[0])return null;const a=r[0];return typeof a.timestamp!="number"||typeof a.value!="number"||!isFinite(a.timestamp)||!isFinite(a.value)?null:{id:t||oF(),t:Math.round(a.timestamp),p:a.value}}catch(s){return console.error("Error converting screen-space to data-space:",s),null}}function Kx(o,e){const t=[];let s=!0,i=!0;for(const r of o){const a=Sh(r,e);if(!a){i=!1,t.push({x:0,y:0});continue}t.push(a),(a.x<-100||a.x>1e4||a.y<-100||a.y>1e4)&&(s=!1)}return{screenPoints:t,isVisible:s,isValid:i}}function Ky(o,e,t={}){var s,i,r,a,l;try{const c={minMarginMs:V_.MIN_FUTURE_MARGIN_MS,maxMarginMs:V_.MAX_FUTURE_MARGIN_MS,defaultMarginPercent:V_.DEFAULT_FUTURE_MARGIN_PERCENT,...t},d=e.getDataList();if(!d||d.length===0)return;const v=d[d.length-1],g=typeof(v==null?void 0:v.timestamp)=="number"?v.timestamp:null;if(!g||!isFinite(g))return;let _=Number.NEGATIVE_INFINITY;for(const te of o)typeof te.t=="number"&&isFinite(te.t)&&te.t>_&&(_=te.t);if(!Number.isFinite(_)||_<=g)return;const y=Math.max(0,_-g);if(y<=0)return;const k=e.getVisibleRange();let S=0;if(k&&d.length>1){const te=(s=d[Math.max(0,Math.min(d.length-1,k.from))])==null?void 0:s.timestamp,oe=(i=d[Math.max(0,Math.min(d.length-1,k.to))])==null?void 0:i.timestamp;typeof te=="number"&&typeof oe=="number"&&isFinite(te)&&isFinite(oe)&&(S=Math.max(0,oe-te))}const M=S>0?Math.floor(S*c.defaultMarginPercent):Math.floor(y*c.defaultMarginPercent),I=Math.min(Math.max(c.minMarginMs,M),c.maxMarginMs),C=Math.min(y+I,c.maxMarginMs),T=g+C,z=v.timestamp;if(z>=T)return;const j=[];for(let te=Math.max(0,d.length-10);te<d.length-1;te++){const oe=(r=d[te])==null?void 0:r.timestamp,U=(a=d[te+1])==null?void 0:a.timestamp;if(typeof oe=="number"&&typeof U=="number"){const J=U-oe;isFinite(J)&&J>0&&j.push(J)}}const B=j.length?j.sort((te,oe)=>te-oe)[Math.floor(j.length/2)]:6e4;if(!B||!isFinite(B)||B<=0)return;const $=Math.max(0,Math.ceil((T-z)/B));if($<=0)return;const F=typeof(v==null?void 0:v.close)=="number"?v.close:typeof(v==null?void 0:v.open)=="number"?v.open:0,V=[];for(let te=1;te<=$;te++){const oe=z+te*B;V.push({timestamp:oe,open:F,high:F,low:F,close:F,volume:0})}const K=e.getVisibleRange(),Y=K?K.to>=d.length-2:!0,Z=[...d,...V];e.applyNewData(Z,!1);try{(Z??[]).length>0&&(window.hasFirstDataLoaded=!0)}catch{}const ne=Y?Z.length-1:K?K.to:Z.length-1;try{e.scrollToDataIndex(ne)}catch{const te=(l=Z[ne])==null?void 0:l.timestamp;if(typeof te=="number")try{e.scrollToTimestamp(te)}catch{}}}catch{}}function oF(){return`point_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}class sF{constructor(e){ve(this,"chart");ve(this,"context");this.chart=e,this.context={chart:e}}enhanceTemplate(e){const t={...e,originalTemplate:e,createPointFigures:s=>{var a,l;const{overlay:i,coordinates:r}=s;if(this.isDataSpaceOverlay(i)){const c=i,d=Kx(c.points,this.context);return d.isValid?t.createDataSpaceFigures?t.createDataSpaceFigures({overlay:c,chart:this.chart,projectionResult:d,screenCoordinates:d.screenPoints}):((a=e.createPointFigures)==null?void 0:a.call(e,{...s,coordinates:d.screenPoints}))||[]:[]}if(t.createDataSpaceFigures){const c={screenPoints:r||[],isVisible:!0,isValid:Array.isArray(r)&&r.length>0};return t.createDataSpaceFigures({overlay:i,chart:this.chart,projectionResult:c,screenCoordinates:c.screenPoints})}return((l=e.createPointFigures)==null?void 0:l.call(e,s))||[]}};return t}createDataSpaceTemplate(e,t){const s={name:e,totalStep:t.totalStep,needDefaultPointFigure:t.needDefaultPointFigure??!0,needDefaultXAxisFigure:t.needDefaultXAxisFigure??!0,needDefaultYAxisFigure:t.needDefaultYAxisFigure??!0,styles:t.styles,onDrawStart:t.onDrawStart,onDrawing:t.onDrawing,onDrawEnd:t.onDrawEnd,onClick:t.onClick,onDoubleClick:t.onDoubleClick,onRightClick:t.onRightClick,onPressedMoveStart:t.onPressedMoveStart,onPressedMoving:t.onPressedMoving,onPressedMoveEnd:t.onPressedMoveEnd,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,onSelected:t.onSelected,onDeselected:t.onDeselected};return this.enhanceTemplate({...s,createDataSpaceFigures:t.createDataSpaceFigures})}isDataSpaceOverlay(e){return e&&typeof e=="object"&&"points"in e&&Array.isArray(e.points)&&e.points.length>0&&e.points.every(t=>t&&typeof t=="object"&&"t"in t&&"p"in t&&"id"in t&&typeof t.t=="number"&&typeof t.p=="number"&&typeof t.id=="string")}screenToDataSpace(e){return[]}updateChart(e){this.chart=e,this.context={chart:e}}}let Zy=null;function Zx(o){return Zy=new sF(o),Zy}const z0={windowBars:120,horizons:[5,10,20],topK:200,stride:1,distance:"cosine",halfLifeBars:500,atrLen:14,rsiLen:14,adxLen:14,avwapAnchors:["sessionOpen","prevHigh","prevLow","swingHi","swingLo"],candidateSL:[.6,.8,1,1.25,1.5],useSwingStop:!1,minMatches:100,winsor:.98,bandAlpha:.22,showTable:!0,showBothDirections:!0},Xx="npo_mae_settings_v1";function nF(){try{const o=localStorage.getItem(Xx);if(!o)return{...z0};const e=JSON.parse(o);return{...z0,...e}}catch{return{...z0}}}function Xy(o){try{localStorage.setItem(Xx,JSON.stringify(o))}catch{}}function iF(o,e){const t=e.windowBars;if(o.length<t)return new Float32Array;const s=o.length-t,i=o.slice(s),r=T=>{const z=[];for(let j=T;j<i.length;j++){const B=(i[j].close-i[j-T].close)/Math.max(1e-8,i[j-T].close);z.push(B)}return z},a=r(1),l=r(2),c=r(3),d=r(5),v=[];for(let T=0;T<i.length;T++){const z=e.atrLen,j=Math.max(0,T-z+1);let B=0,$=0;for(let F=j;F<=T;F++){const V=i[F].high,K=i[F].low;B+=Math.max(0,V-K),$++}v.push(B/Math.max(1,$))}const _=((T,z)=>{const j=[];for(let B=0;B<T.length;B++){const $=Math.max(0,B-z+1),F=T[$],V=T[B];j.push(V-F)}return j})(v,5),y=[];for(let T=0;T<i.length;T++){const z=i[T],j=Math.max(1e-8,z.high-z.low),B=Math.abs(z.close-z.open);y.push(B/j)}const k=[...a,...l,...c,...d,...v,..._,...y],S=k.reduce((T,z)=>T+z,0)/Math.max(1,k.length),M=Math.sqrt(k.reduce((T,z)=>T+Math.pow(z-S,2),0)/Math.max(1,k.length)),C=k.map(T=>(T-S)/(M>1e-8?M:1)).map(T=>Math.max(-5,Math.min(5,T)));return new Float32Array(C)}function g1(o){const e=o.getDataList();if(!e||e.length===0)return null;const t=e[e.length-1];return{timestamp:t.timestamp,price:t.close}}function rF(o,e,t,s="candle_pane"){try{const i=o.convertToPixel({timestamp:e,value:t},{paneId:s}),r=Array.isArray(i)?i[0]:i;return(r==null?void 0:r.y)??null}catch{return null}}function aF(o){try{const e=o.getSize(),t=o.getVisibleRange();if(!e||!t)return 4;const s=Math.max(1,t.to-t.from+1);return e.width/s}catch{return 4}}function lF(o){try{const e=o.getDataList();if(!e||e.length<2)return 0;const t=Math.min(10,e.length-1);let s=0;for(let r=e.length-t;r<e.length-1;r++){const a=e[r],l=e[r+1],c=Math.max(0,((l==null?void 0:l.timestamp)??0)-((a==null?void 0:a.timestamp)??0));s+=c}const i=s/Math.max(1,t);return isFinite(i)&&i>0?i:0}catch{return 0}}function cF(o){return Zx(o).createDataSpaceTemplate("NearestPatternOutcomeMaeStop",{totalStep:1,needDefaultPointFigure:!0,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createDataSpaceFigures:({overlay:s,screenCoordinates:i,chart:r})=>{var Y,Z,ne,te,oe,U;const a=[];if(i.length<1)return a;const l=i[0],c=s.extendData;if(!c)return a;const d=aF(r),v=g1(r);if(!v)return a;const g=v.timestamp,_=v.price,y=c.forwardPathMedianR||[],k=c.forwardPathP10R||[],S=c.forwardPathP90R||[],M=y.map(J=>_+J),I=k.map(J=>_+J),C=S.map(J=>_+J),T=c.bandAlpha??z0.bandAlpha,z=J=>rF(r,g,J),j=lF(r),B=(J,se)=>{const W=g+(j>0?J*j:0);try{const le=r.convertToPixel({timestamp:W,value:se},{paneId:"candle_pane"}),ye=Array.isArray(le)?le[0]:le,Ce=(ye==null?void 0:ye.y)??z(se);return{x:(ye==null?void 0:ye.x)??l.x+J*d,y:Ce??l.y}}catch{const le=z(se);return{x:l.x+J*d,y:le??l.y}}};if(M.length>0){const J=c.styles&&c.styles.median||{},se=typeof J.size=="number"?J.size:1,W=typeof J.style=="string"?J.style:"solid";for(let le=0;le<M.length-1;le++){const ye=B(le,M[le]),Ce=B(le+1,M[le+1]);a.push({type:"line",attrs:{coordinates:[ye,Ce]},styles:{color:((Y=c.colors)==null?void 0:Y.median)||"#66c2a5",size:se,style:W}})}}if(I.length>0&&C.length>0&&c.showOutcomeBand!==!1){const J=[];for(let W=0;W<C.length;W++)J.push(B(W,C[W]));for(let W=I.length-1;W>=0;W--)J.push(B(W,I[W]));const se=c.colors&&c.colors.band||`rgba(102, 194, 165, ${T})`;a.push({type:"polygon",attrs:{coordinates:J},styles:{color:se}})}const $=c.selectedSL,F=c.lastAtr,V=$&&typeof F=="number"?_-$*F:void 0;if(c.showStopLines!==!1&&typeof V=="number"){const J=z(V);if(J!=null){const se=r.getSize(),W=(se==null?void 0:se.width)??0,le=c.styles&&c.styles.slLong||{},ye=typeof le.size=="number"?le.size:1,Ce=typeof le.style=="string"?le.style:"dashed";a.push({type:"line",attrs:{coordinates:[{x:0,y:J},{x:W,y:J}]},styles:{color:((Z=c.colors)==null?void 0:Z.slLong)||"#e67e22",style:Ce,size:ye}});const Re=(V??0).toFixed(2);a.push({type:"text",attrs:{x:W-4,y:J,text:`SL L ${Re}`},styles:{color:((ne=c.colors)==null?void 0:ne.slLong)||"#e67e22",backgroundColor:"transparent",align:"right",size:11}})}}const K=$&&typeof F=="number"?_+$*F:void 0;if(c.showStopLines!==!1&&typeof K=="number"){const J=z(K);if(J!=null){const se=r.getSize(),W=(se==null?void 0:se.width)??0,le=c.styles&&c.styles.slShort||{},ye=typeof le.size=="number"?le.size:1,Ce=typeof le.style=="string"?le.style:"dashed";a.push({type:"line",attrs:{coordinates:[{x:0,y:J},{x:W,y:J}]},styles:{color:((te=c.colors)==null?void 0:te.slShort)||"#c0392b",style:Ce,size:ye}});const Re=(K??0).toFixed(2);a.push({type:"text",attrs:{x:W-4,y:J,text:`SL S ${Re}`},styles:{color:((oe=c.colors)==null?void 0:oe.slShort)||"#c0392b",backgroundColor:"transparent",align:"right",size:11}})}}if(c.showTable&&Array.isArray(c.evTable)){const J=r.getSize(),se=(J==null?void 0:J.width)??0,W=240,le=10,ye=10,Ce=18,Re=Math.min(c.evTable.length,6),Ke=20,st=ye*2+Ke+Re*Ce,vt=12,ot=Math.max(vt,se-W-vt-80),nt=10,tt=typeof document<"u"&&((U=document==null?void 0:document.documentElement)==null?void 0:U.getAttribute("data-theme"))||"",Ze=String(tt).toLowerCase().includes("dark"),ct=Ze?"rgba(16,20,30,0.85)":"rgba(245,247,255,0.95)",Ge=Ze?"rgba(140,160,220,0.35)":"rgba(80,100,160,0.35)",pt=Ze?"rgba(28,34,50,0.90)":"rgba(232,236,250,0.90)",ce=Ze?"#a7b3d8":"#415277",we=Ze?"#cfd6ee":"#1f2937";a.push({type:"rect",attrs:{x:ot,y:nt,width:W,height:st},styles:{style:"fill",color:ct}}),a.push({type:"rect",attrs:{x:ot,y:nt,width:W,height:st},styles:{style:"stroke",color:Ge,borderSize:1,borderStyle:"solid"}});const ze=W-le*2,dt=it=>Math.min(ot+W-le-4,it),qe={mark:dt(ot+le),side:dt(ot+le+12),mult:dt(ot+le+ze*.1),ev:dt(ot+le+ze*.35),pwin:dt(ot+le+ze*.55),winr:dt(ot+le+ze*.72),lossr:dt(ot+le+ze*.88)};let me=nt+ye+2;a.push({type:"rect",attrs:{x:ot+1,y:nt+1,width:W-2,height:Ke},styles:{style:"fill",color:pt}}),a.push({type:"text",attrs:{x:qe.mult,y:me,text:"SL"},styles:{color:ce,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.ev,y:me,text:"EV"},styles:{color:ce,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.pwin,y:me,text:"pWin"},styles:{color:ce,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.winr,y:me,text:"winR"},styles:{color:ce,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.lossr,y:me,text:"lossR"},styles:{color:ce,size:12,backgroundColor:"transparent"}}),me+=Ke-6;for(let it=0;it<Re;it++){const Vt=c.evTable[it],wt=c.selectedSL===Vt.mult;a.push({type:"text",attrs:{x:qe.mark,y:me,text:wt?"▶":"•"},styles:{color:we,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.side,y:me,text:Vt.side==="long"?"L":"S"},styles:{color:we,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.mult,y:me,text:`${Vt.mult.toFixed(2)}×`},styles:{color:we,size:12,backgroundColor:"transparent"}});const Yt=`${Vt.ev>=0?"+":""}${Vt.ev.toFixed(2)}`;a.push({type:"text",attrs:{x:qe.ev,y:me,text:Yt},styles:{color:we,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.pwin,y:me,text:`${Math.round(Vt.pWin*100)}%`},styles:{color:we,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.winr,y:me,text:Vt.avgWinR.toFixed(2)},styles:{color:we,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:qe.lossr,y:me,text:Vt.avgLossR.toFixed(2)},styles:{color:we,size:12,backgroundColor:"transparent"}}),me+=Ce}const Q=(()=>{const it=c.selectedSide;return c.evTable.find(wt=>wt.mult===c.selectedSL&&(!it||wt.side===it))||c.evTable.find(wt=>wt.mult===c.selectedSL)||null})();if(Q){const Vt=nt+st+6,wt=86,Yt=Q.side==="long"?"Long":"Short",At=`${Q.mult.toFixed(2)}× ATR`,Gt=_.toFixed(2),no=(Q.side==="long"?_-Q.mult*(F??0):_+Q.mult*(F??0)).toFixed(2),Do=Math.round((Q.pWin??0)*100);a.push({type:"rect",attrs:{x:ot,y:Vt,width:W,height:wt},styles:{style:"fill",color:Ze?"rgba(16,20,30,0.85)":"rgba(245,247,255,0.95)"}}),a.push({type:"rect",attrs:{x:ot,y:Vt,width:W,height:wt},styles:{style:"stroke",color:Ge,borderSize:1,borderStyle:"solid"}});let Eo=Vt+8+2;a.push({type:"text",attrs:{x:ot+8,y:Eo,text:`Active: ${Yt}`},styles:{color:ce,size:12,backgroundColor:"transparent"}}),Eo+=18,a.push({type:"text",attrs:{x:ot+8,y:Eo,text:`Anchor: ${Gt}`},styles:{color:we,size:12,backgroundColor:"transparent"}}),Eo+=18,a.push({type:"text",attrs:{x:ot+8,y:Eo,text:`Stop: ${no} (${At})`},styles:{color:we,size:12,backgroundColor:"transparent"}}),Eo+=18,a.push({type:"text",attrs:{x:ot+8,y:Eo,text:`pWin ${Do}% • winR ${Q.avgWinR.toFixed(2)} • lossR ${Q.avgLossR.toFixed(2)}`},styles:{color:we,size:12,backgroundColor:"transparent"}});const bs=Math.abs(_-(Q.side==="long"?_-Q.mult*(F??0):_+Q.mult*(F??0))),Is=S.length&&k.length?Math.max(0,(S[0]??0)-(k[0]??0)):0,qi=Is<=1,Ks=Is>=2,ws=Q.side==="long"&&(Q.ev??0)>=.15&&(Q.pWin??0)>=.52&&!Ks,vn=Q.side==="short"&&(Q.ev??0)>=.1&&(Q.pWin??0)>=.5&&!Ks,es=ws?"BUY":vn?"SELL":"WAIT",Li=ws?"#10b981":vn?"#ef4444":Ze?"#f59e0b":"#b45309",ci=Vt+wt+6,oa=74,ol=Ze?"rgba(20,24,32,0.85)":"rgba(240,244,255,0.95)";a.push({type:"rect",attrs:{x:ot,y:ci,width:W,height:oa},styles:{style:"fill",color:ol}}),a.push({type:"rect",attrs:{x:ot,y:ci,width:W,height:oa},styles:{style:"stroke",color:Ge,borderSize:1,borderStyle:"solid"}});let Xi=ci+8+2;a.push({type:"text",attrs:{x:ot+8,y:Xi,text:`Action: ${es}`},styles:{color:Li,size:13,backgroundColor:"transparent"}}),Xi+=18;const fc=qi?"Band: Narrow":Ks?"Band: Wide":"Band: Normal",rd=`1R: ${bs.toFixed(2)}`,ml=ws?"EV≥0.30, pWin≥55%":vn?"EV≥0.20, pWin≥50%":"Low EV / Wide band / Low pWin";a.push({type:"text",attrs:{x:ot+8,y:Xi,text:`${fc} • ${rd}`},styles:{color:we,size:12,backgroundColor:"transparent"}}),Xi+=18,a.push({type:"text",attrs:{x:ot+8,y:Xi,text:ml},styles:{color:ce,size:12,backgroundColor:"transparent"}})}}return a},onClick:s=>{var c;const i=s.overlay.extendData;if(!i||!Array.isArray(i.evTable))return!0;const a=(i.evTable.findIndex(d=>d.mult===i.selectedSL)+1)%i.evTable.length,l=i.evTable[a];return l&&(i.selectedSL=l.mult,i.selectedSide=l.side,(c=s.chart)==null||c.overrideOverlay({id:s.overlay.id,extendData:i})),!0}})}function dF(){return new Worker(new URL(""+new URL("../workers/npoMae.worker-DaGdsbjp.js",import.meta.url).href,import.meta.url),{type:"module"})}function uF(o,e){const t=cF(o);ib(t);let s={...nF()},i=null,r=!0,a=dF(),l=0,c=-1,d=0,v=!0,g=!0;function _(){var z;if(!i){const j=g1(o),B=j?[{timestamp:j.timestamp,value:j.price}]:[],$=o.createOverlay({name:"NearestPatternOutcomeMaeStop",points:B});i=Array.isArray($)?($==null?void 0:$[0])??null:$,y();try{const F=Rv(),V=((z=F==null?void 0:F.getCurrentSymbol)==null?void 0:z.call(F))||null;F&&V&&i&&F.addDrawing({id:i,symbolKey:V,type:"NearestPatternOutcomeMaeStop",points:j?[{time:j.timestamp,price:j.price}]:[],styles:{},visible:!0})}catch{}}}function y(){var j,B;if(!i)return;const z=g1(o);if(z)try{const $=(j=o.getOverlays)==null?void 0:j.call(o,{id:i}),F=Array.isArray($)&&$.length>0?$[0]:null,V=(B=F==null?void 0:F.points)==null?void 0:B[0],K=(V==null?void 0:V.timestamp)??(V==null?void 0:V.time)??(V==null?void 0:V.t),Y=(V==null?void 0:V.value)??(V==null?void 0:V.price)??(V==null?void 0:V.p);if(typeof K!="number"||typeof Y!="number"||K!==z.timestamp||Math.abs(Y-z.price)>1e-6){o.overrideOverlay({id:i,points:[{timestamp:z.timestamp,value:z.price}]});try{const ne=Rv();ne&&i&&ne.updateDrawing(i,{points:[{time:z.timestamp,price:z.price}]})}catch{}}}catch{}}function k(z){if(!i)return;const j={...z,bandAlpha:s.bandAlpha,showTable:s.showTable,showStopLines:g,showOutcomeBand:v};d&&cancelAnimationFrame(d),d=requestAnimationFrame(()=>{o.overrideOverlay({id:i,extendData:j});try{const B=Rv();B&&i&&B.updateDrawing(i,{extendData:j})}catch{}})}function S(){if(!r||!a)return;y();const z=o.getDataList();if(!z||z.length<Math.max(s.windowBars+Math.max(...s.horizons),10)){k({forwardPathMedian:[],forwardPathP10:[],forwardPathP90:[],evTable:[],suggestedSL:null});return}const j=z.map(V=>({time:V.timestamp,open:V.open,high:V.high,low:V.low,close:V.close,volume:V.volume})),B=iF(j,s),$=++l;c=$;const F={id:$,settings:s,features:B,bars:j};a.postMessage(F,[B.buffer])}function M(z){var K,Y;const j=z.data;if(!j||j.id!==c)return;const B=Math.max(...s.horizons),$=j.byHorizon[B];if(!$)return;const F=j.slSuggest||{},V=pF(o,s.atrLen);k({forwardPathMedianR:$.forwardPathMedian,forwardPathP10R:$.forwardPathP10,forwardPathP90R:$.forwardPathP90,evTable:F.evTable||[],selectedSL:((K=F.long)==null?void 0:K.mult)??((Y=F.short)==null?void 0:Y.mult),selectedSide:F.long?"long":F.short?"short":void 0,lastAtr:V})}a&&(a.onmessage=M),_(),S();const I=window.setInterval(()=>{_(),S()},500),C=z=>{z.key==="O"||z.key==="o"?(v=!v,k({})):(z.key==="S"||z.key==="s")&&(g=!g,k({}))};return window.addEventListener("keydown",C,{capture:!0}),{setEnabled(z){r=z,r&&S()},updateSettings(z){s={...s,...z},Xy(s),S()},setShowOutcomeBand(z){v=z,k({})},setShowStopLines(z){g=z,k({})},setColors(z){k({colors:z})},setStyles(z){k({styles:z})},resetSettings(){s={...z0},Xy(s),S()},getOverlayId(){return i},dispose(){if(window.removeEventListener("keydown",C,{capture:!0}),window.clearInterval(I),a&&(a.terminate(),a=null),i)try{o.removeOverlay({id:i})}catch{}}}}function pF(o,e){const t=o.getDataList();if(!t||t.length===0)return 1;const s=Math.min(e,t.length);let i=0;for(let r=t.length-s;r<t.length;r++){const a=t[r].high,l=t[r].low;i+=Math.max(0,a-l)}return i/Math.max(1,s)}var vF=(o,e)=>x(e,""),fF=re('<button class="absolute right-4 top-1/2 transform -translate-y-1/2 hover:scale-110 transition-all duration-300 z-10 clear-search-btn svelte-1bz53f9" title="Clear search"><svg class="w-4 h-4 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-1bz53f9"></path></svg></button>'),mF=(o,e,t,s)=>!n(e)&&t(n(s).is_main,n(s).name),gF=(o,e)=>{o.stopPropagation(),x(e,!0)},hF=re('<button class="w-8 h-8 rounded-full ml-2 opacity-0 group-hover:opacity-100 hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm info-btn svelte-1bz53f9" title="How it works"><svg class="w-4 h-4 svelte-1bz53f9" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10" class="svelte-1bz53f9"></circle><line x1="12" y1="16" x2="12" y2="12" class="svelte-1bz53f9"></line><line x1="12" y1="8" x2="12.01" y2="8" class="svelte-1bz53f9"></line></svg></button>'),_F=(o,e,t)=>{o.stopPropagation(),e(n(t).name)},yF=(o,e,t)=>{o.stopPropagation(),e(n(t).name)},bF=re('<div class="flex items-center gap-2 ml-4 opacity-100 transition-all duration-300 svelte-1bz53f9"><button class="w-8 h-8 rounded-full hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm edit-btn svelte-1bz53f9" title="Edit Parameters"><svg class="w-3.5 h-3.5 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" class="svelte-1bz53f9"></path></svg></button> <button class="w-8 h-8 rounded-full hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm delete-btn svelte-1bz53f9" title="Remove Indicator"><svg class="w-3.5 h-3.5 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-1bz53f9"></path></svg></button></div>'),xF=re('<div><div></div> <div class="flex-1 min-w-0 svelte-1bz53f9"><span> </span></div> <!> <!></div>'),wF=re('<div class="flex flex-col items-center justify-center py-16 text-center svelte-1bz53f9"><div class="w-16 h-16 rounded-full bg-base-200/50 flex items-center justify-center mb-4 svelte-1bz53f9"><svg class="w-8 h-8 text-base-content/40 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" class="svelte-1bz53f9"></path></svg></div> <p class="text-lg font-semibold text-base-content/60 mb-2 svelte-1bz53f9">No indicators found</p> <p class="text-sm text-base-content/40 svelte-1bz53f9">Try a different search term</p></div>'),kF=re(`<div class="flex flex-col gap-6 svelte-1bz53f9"><div><div class="absolute left-4 top-1/2 transform -translate-y-1/2 pointer-events-none z-10 transition-all duration-300 search-icon svelte-1bz53f9"><svg class="w-4 h-4 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" class="svelte-1bz53f9"></path></svg></div> <input type="text" class="w-full pl-12 pr-12 py-3.5 text-[15px] font-medium tracking-wide backdrop-blur-sm rounded-2xl
               focus:outline-none transition-all duration-500 ease-out
               placeholder:font-normal search-input svelte-1bz53f9"> <!></div> <div class="relative rounded-2xl overflow-hidden backdrop-blur-sm indicator-list-container svelte-1bz53f9"><div class="indicator-scroll ultra-minimal-scrollbar svelte-1bz53f9"><!> <!></div></div> <div class="flex justify-center items-center py-2 mt-1 svelte-1bz53f9"><div class="group relative cursor-pointer svelte-1bz53f9"><div class="absolute inset-0 bg-gradient-to-r from-transparent via-primary/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-700 ease-out blur-xl svelte-1bz53f9"></div> <div class="relative flex items-center gap-2 px-4 py-1.5 rounded-full bg-gradient-to-r from-base-100/80 to-base-200/60 backdrop-blur-sm border border-base-300/30 shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-500 ease-out svelte-1bz53f9"><div class="w-2 h-2 rounded-full bg-gradient-to-r from-primary to-secondary animate-pulse svelte-1bz53f9"></div> <span class="text-sm font-medium text-base-content/70 group-hover:text-primary transition-colors duration-300 svelte-1bz53f9">Powered by</span> <span class="text-sm font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent group-hover:from-secondary group-hover:to-primary transition-all duration-500 svelte-1bz53f9">Duty AI</span> <div class="w-2 h-2 rounded-full bg-gradient-to-r from-secondary to-primary animate-pulse svelte-1bz53f9" style="animation-delay: 0.5s;"></div></div></div></div></div>`),SF=(o,e)=>x(e,!1),CF=(o,e)=>x(e,"bn"),PF=(o,e)=>x(e,"en"),IF=(o,e)=>x(e,!1),MF=re(`<div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">খুব সহজ ব্যাখ্যা</div> <p class="text-sm text-base-content/70 svelte-1bz53f9">মনে করুন আপনি আগের দিনের ছবি দেখে আজকের দিনের কথা অনুমান করছেন।
                এই ইন্ডিকেটরটি ঠিক তেমনই করে—এখনকার দামের সঙ্গে খুব মিল‑থাকা
                আগের প্যাটার্ন খুঁজে নেয়, তাদের পথ ধরে সামনে কী হতে পারে তা
                অনুমান করে, আর অতীতে কতটা উল্টো দিকে গেছে সেটাকে ধরে নিরাপদ
                থামার জায়গা (স্টপ‑লস) বলে দেয়।</p> <p class="text-sm text-base-content/70 svelte-1bz53f9">উদাহরণ: ধরুন আজকের দামের গতি অনেকটা গত মাসের ১৫ তারিখের মতো।
                ইন্ডিকেটরটি তখন গত মাসের ১৫ তারিখের পরের দিনগুলো কী হয়েছিল সেটা
                দেখে আজকের পরের দিনগুলোর জন্য অনুমান করে।</p> <p class="text-sm text-base-content/70 svelte-1bz53f9">চার্টে রঙের ব্যান্ডটি P10–P90 প্রত্যাশিত রেঞ্জ বোঝায়—মানে ১০০‑এর
                মধ্যে ৮০ বার দাম এই সীমার মধ্যে থাকতে পারে। মাঝের রেখাটি মাঝের
                রাস্তা (মিডিয়ান পথ)—দাম সাধারণত এই পথ ধরে চলতে পারে। আর ড্যাশড
                লাইনগুলো লং/শর্টের স্টপ—এগুলোতে পৌঁছালে থামার সংকেত।</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">চার্ট উপাদান</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">মাঝের রাস্তা: দাম সাধারণত কোন পথে যেতে পারে তার মাঝের লাইন।</li> <li class="svelte-1bz53f9">রঙের ব্যান্ড: সম্ভাব্য ওঠা‑নামার এলাকা (P10–P90)। সরু মানে
                  পরিষ্কার পথ, প্রশস্ত মানে বেশি অনিশ্চয়তা।</li> <li class="svelte-1bz53f9">স্টপের দাগ: লং/শর্টের প্রস্তাবিত স্টপ‑লসের ড্যাশড লাইন।</li> <li class="svelte-1bz53f9">ইভি টেবিল: কোন স্টপ নিলে মোটের উপর লাভ‑ক্ষতি কেমন হতে পারে তা
                  দেখায়।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">ওভারলে প্যানেলগুলো</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">তথ্য প্যানেল</span>: <span class="font-medium svelte-1bz53f9">Active</span> (Long/Short), <span class="font-medium svelte-1bz53f9">Anchor</span> (বর্তমান
                  দাম), <span class="font-medium svelte-1bz53f9">Stop</span> (SL মূল্য ও ×ATR), <span class="font-medium svelte-1bz53f9">pWin</span>, <span class="font-medium svelte-1bz53f9">winR</span>, <span class="font-medium svelte-1bz53f9">lossR</span> দেখায়—সিদ্ধান্তের জন্য দ্রুত
                  প্রেক্ষাপট দেয়।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">সিদ্ধান্ত প্যানেল</span>: বড় অক্ষরে <span class="font-medium svelte-1bz53f9">Action: BUY/SELL/WAIT</span> দেখায়। সঙ্গে <span class="font-medium svelte-1bz53f9">Band</span> (Narrow/Normal/Wide), <span class="font-medium svelte-1bz53f9">1R</span> দূরত্ব ও <span class="font-medium svelte-1bz53f9">শর্তের সারাংশ</span> দেখায়। <br class="svelte-1bz53f9">BUY (লং): EV ≥ 0.30 ও pWin ≥ 55%, ব্যান্ড Wide না হলে। <br class="svelte-1bz53f9">SELL (শর্ট): EV ≥ 0.20 ও pWin ≥ 50%, ব্যান্ড Wide না
                  হলে। <br class="svelte-1bz53f9">অন্যথা: WAIT।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">ইভি টেবিল (উদাহরণ)</div> <div class="overflow-x-auto svelte-1bz53f9"><table class="table table-xs svelte-1bz53f9"><thead class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><th class="svelte-1bz53f9">পজিশন</th><th class="svelte-1bz53f9">এসএল (×এটিআর)</th><th class="svelte-1bz53f9">ইভি (আর)</th><th class="svelte-1bz53f9">জেতার সম্ভাবনা (%)</th><th class="svelte-1bz53f9">উইন R</th><th class="svelte-1bz53f9">লস R</th></tr></thead><tbody class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">লং</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">+0.45</td><td class="svelte-1bz53f9">62</td><td class="svelte-1bz53f9">1.60</td><td class="svelte-1bz53f9">0.95</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">লং</td><td class="svelte-1bz53f9">1.25×</td><td class="svelte-1bz53f9">+0.30</td><td class="svelte-1bz53f9">68</td><td class="svelte-1bz53f9">1.35</td><td class="svelte-1bz53f9">0.80</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">শর্ট</td><td class="svelte-1bz53f9">0.80×</td><td class="svelte-1bz53f9">+0.20</td><td class="svelte-1bz53f9">54</td><td class="svelte-1bz53f9">1.10</td><td class="svelte-1bz53f9">0.85</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">শর্ট</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">−0.05</td><td class="svelte-1bz53f9">48</td><td class="svelte-1bz53f9">1.20</td><td class="svelte-1bz53f9">1.10</td></tr></tbody></table></div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">ইভি: মোটের উপর গড় প্রত্যাশা। জেতা‑হারা দুটো মিলিয়ে ফল কেমন
                  হবে।</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা (%): ১০০‑এর মধ্যে সংখ্যা। যত বেশি, জেতার
                  সম্ভাবনা তত বেশি।</li> <li class="svelte-1bz53f9">উইন R ও লস R: জিতলে আনুমানিক কত, হারলে আনুমানিক কত। ভারসাম্য
                  দেখুন।</li> <li class="svelte-1bz53f9">ইভি ≥ 0 হলে সারি বিবেচনা করুন; ইভি যত বেশি, মোট প্রত্যাশা তত
                  ভালো।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">টেবিলের ▶ চিহ্ন (অ্যারো) কীভাবে কাজ করে</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">টেবিলের সারিতে ▶ দেখায় কোন এসএল মাল্টিপ্লায়ার এখন সক্রিয়।
                  ভেতরে ক্লিক করলে ▶ পরের সারিতে যায়।</li> <li class="svelte-1bz53f9">▶ যে সারিতে থাকে, সেই সারির <span class="font-medium svelte-1bz53f9">SL (×ATR)</span> অনুযায়ী চার্টের ড্যাশড স্টপ‑লাইন আপডেট হয়।</li> <li class="svelte-1bz53f9">▶ যদি লং সারিতে থাকে: সিদ্ধান্ত লং বায়াসে ভাবুন; স্টপ সাধারণত
                  বর্তমান দামের নিচে (<span class="font-medium svelte-1bz53f9">anchor − mult × ATR</span>).</li> <li class="svelte-1bz53f9">▶ যদি শর্ট সারিতে থাকে: সিদ্ধান্ত শর্ট বায়াসে ভাবুন; স্টপ
                  সাধারণত বর্তমান দামের উপরে (<span class="font-medium svelte-1bz53f9">anchor + mult × ATR</span>).</li> <li class="svelte-1bz53f9">সেরা নির্বাচন: ▶ কে এমন সারিতে রাখুন যেখানে <span class="font-medium svelte-1bz53f9">EV পজিটিভ</span>, <span class="font-medium svelte-1bz53f9">pWin বেশি</span>, আর <span class="font-medium svelte-1bz53f9">lossR নিয়ন্ত্রণে</span> থাকে।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">অ্যারো উদাহরণ (শর্ট)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">ধরুন ▶ শর্ট সারিতে আছে এবং <span class="font-medium svelte-1bz53f9">SL = 1.50×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.71</span>, <span class="font-medium svelte-1bz53f9">lossR = 1.46</span>।</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.50×</span> মানে স্টপ দূরত্ব <span class="font-medium svelte-1bz53f9">1.5 × ATR</span> উপরে। দূর স্টপ → কম
                    স্টপ‑হিট; কিন্তু রিস্ক ইউনিট বড় হয়।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.71</span> মানে জিতলে গড় লাভ <span class="font-medium svelte-1bz53f9">1.71R</span>। যদি 1R = 100 টাকা
                    রিস্ক ধরেন, জিতলে গড়ে 171 টাকা।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 1.46</span> মানে হারলে গড়
                    ক্ষতি <span class="font-medium svelte-1bz53f9">1.46R</span> ≈ 146 টাকা।</li> <li class="svelte-1bz53f9">সিদ্ধান্ত: pWin যদি ~55% হয়, তাহলে <span class="font-medium svelte-1bz53f9">EV = pWin × winR − (1−pWin) × lossR</span> = 0.55×1.71 − 0.45×1.46 ≈ <span class="font-medium svelte-1bz53f9">+0.28R</span> → গ্রহণযোগ্য।</li> <li class="svelte-1bz53f9">যদি pWin 45%‑এর নিচে নামে বা lossR বেশি হয়, ▶ অন্য সারিতে
                    সরান (কম SL বা ভালো EV)।</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">অ্যারো উদাহরণ (লং)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">ধরুন ▶ লং সারিতে আছে এবং <span class="font-medium svelte-1bz53f9">SL = 1.00×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.40</span>, <span class="font-medium svelte-1bz53f9">lossR = 0.90</span>।</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.00×</span> মানে স্টপ দূরত্ব <span class="font-medium svelte-1bz53f9">1 × ATR</span> নিচে। কাছের স্টপ → ঝুঁকি
                    ছোট; কিন্তু স্টপ‑হিট হতে পারে বেশি।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.40</span> মানে জিতলে গড় লাভ
                    1.40R।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 0.90</span> মানে হারলে গড় ক্ষতি
                    0.90R।</li> <li class="svelte-1bz53f9">pWin যদি ~60% হয়, <span class="font-medium svelte-1bz53f9">EV ≈ 0.60×1.40 − 0.40×0.90 = +0.54R</span> → শক্ত সিদ্ধান্ত।</li> <li class="svelte-1bz53f9">যদি ব্যান্ড খুব প্রশস্ত বা pWin কম হয়, ▶ কে এমন সারিতে নিন
                    যেখানে EV পজিটিভ ও lossR নিয়ন্ত্রিত।</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">ব্যান্ড ভিত্তিক সিদ্ধান্ত</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">ব্যান্ড সরু: পথ পরিষ্কার—আত্মবিশ্বাস একটু বাড়ানো যেতে পারে।</li> <li class="svelte-1bz53f9">ব্যান্ড প্রশস্ত: অনিশ্চয়তা বেশি—সাইজ কমান বা একটু অপেক্ষা
                  করুন।</li> <li class="svelte-1bz53f9">ব্যান্ড যদি বড় সাপোর্ট/রেজিস্ট্যান্সের সঙ্গে মিলে যায়: সতর্ক
                  থাকুন, স্টপ দূরে রাখুন।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">উদাহরণ</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">লং বায়াস</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">মাঝের রাস্তা উপরে দিকে। ইভি +0.30→+0.60, জেতার সম্ভাবনা
                    55–65%। এসএল 1.0×–1.25× নিলে সাধারণত জেতার সম্ভাবনা ও লস
                    R‑এর মধ্যে ভালো ভারসাম্য থাকে।</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">শর্ট বায়াস</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">মাঝের রাস্তা নিচের দিকে। শর্ট ইভি +0.20→+0.45। ব্যান্ড যদি
                    আগের নিচু জায়গার সঙ্গে মিলে যায়, এসএল 0.8×–1.0× নিলে সতর্ক
                    এন্ট্রির জন্য ভালো হয়।</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">কখন কিনবেন/বিক্রি করবেন</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">কিনবেন কখন (লং)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">ইভি +0.30 বা তার বেশি হলে</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা 55% বা তার বেশি হলে</li> <li class="svelte-1bz53f9">ব্যান্ড সরু হলে (পরিষ্কার পথ)</li> <li class="svelte-1bz53f9">মাঝের রাস্তা উপরের দিকে হলে</li> <li class="svelte-1bz53f9">স্টপ-লস 1.0×–1.25× ATR হলে</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">উদাহরণ: ইভি +0.45, pWin 62%, ব্যান্ড সরু → কিনুন</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">বিক্রি করবেন কখন (শর্ট)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">শর্ট ইভি +0.20 বা তার বেশি হলে</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা 50% বা তার বেশি হলে</li> <li class="svelte-1bz53f9">ব্যান্ড সরু হলে</li> <li class="svelte-1bz53f9">মাঝের রাস্তা নিচের দিকে হলে</li> <li class="svelte-1bz53f9">স্টপ-লস 0.8×–1.0× ATR হলে</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">উদাহরণ: ইভি +0.25, pWin 54%, ব্যান্ড সরু → বিক্রি করুন</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">কখন অপেক্ষা করবেন</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">ইভি নেগেটিভ হলে (−0.10 বা তার কম)</li> <li class="svelte-1bz53f9">ব্যান্ড খুব প্রশস্ত হলে (অনিশ্চয়তা বেশি)</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা 45% এর কম হলে</li> <li class="svelte-1bz53f9">ব্যান্ড বড় সাপোর্ট/রেজিস্ট্যান্সের সঙ্গে মিলে গেলে</li> <li class="svelte-1bz53f9">winR/lossR ভারসাম্য খারাপ হলে (winR ≤ 1.0 বা lossR ≥ 1.2)</li></ul> <p class="text-sm text-base-content/70 mt-2 svelte-1bz53f9">উদাহরণ: ইভি −0.15, pWin 42%, ব্যান্ড প্রশস্ত → অপেক্ষা করুন</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">টিপস</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">এডিট পপআপে গিয়ে ব্যান্ডের রং, অপাসিটি ও লাইনের স্টাইল বদলাতে
                  পারেন।</li> <li class="svelte-1bz53f9">ইভি টেবিলে ক্লিক করলে স্টপ পাল্টায়; চার্টের ড্যাশড লাইনও সাথে
                  সাথে বদলে যায়।</li> <li class="svelte-1bz53f9">ট্রেন্ড ফিল্টার বা ভলিউমের সঙ্গে জোড়া দিলে সিদ্ধান্ত আরও শক্ত
                  হয়।</li> <li class="svelte-1bz53f9">রিস্ক ম্যানেজমেন্ট: এক ট্রেডে 1–2% এর বেশি রিস্ক নেবেন না</li> <li class="svelte-1bz53f9">কনফার্মেশন: ক্যান্ডেলস্টিক প্যাটার্ন বা ইন্ডিকেটর কনফার্মেশন
                  নিন</li></ul></div>`,1),TF=re(`<div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Simple Explanation</div> <p class="text-sm text-base-content/70 svelte-1bz53f9">Think of it like looking at old pictures to guess today’s story.
                The indicator finds past patterns that look very similar to now,
                follows their path to estimate what might happen next, and uses
                historical MAE to suggest a safe place to stop (stop‑loss). The
                colored band is the expected range (P10–P90), the middle line is
                the median path, and the dashed lines are suggested long/short
                stops.</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Chart Elements</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">Middle road: the central line showing the likely path.</li> <li class="svelte-1bz53f9">Colored band: the area where price may move (P10–P90). Narrow
                  means clearer path; wide means more uncertainty.</li> <li class="svelte-1bz53f9">Stop marks: dashed lines for suggested long/short stops.</li> <li class="svelte-1bz53f9">EV table: shows overall gain‑loss balance for different stops.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Overlay Panels</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">Info Panel</span>: shows <span class="font-medium svelte-1bz53f9">Active</span> (Long/Short), <span class="font-medium svelte-1bz53f9">Anchor</span> (current
                  price), <span class="font-medium svelte-1bz53f9">Stop</span> (SL price and
                  ×ATR), <span class="font-medium svelte-1bz53f9">pWin</span>, <span class="font-medium svelte-1bz53f9">winR</span>, <span class="font-medium svelte-1bz53f9">lossR</span>—quick context for
                  decisions.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">Decision Panel</span>: prominently
                  displays <span class="font-medium svelte-1bz53f9">Action: BUY/SELL/WAIT</span> with <span class="font-medium svelte-1bz53f9">Band</span> (Narrow/Normal/Wide), <span class="font-medium svelte-1bz53f9">1R</span> distance, and <span class="font-medium svelte-1bz53f9">criteria summary</span>. <br class="svelte-1bz53f9">BUY (Long): EV ≥ 0.30 and pWin ≥ 55%, band not Wide. <br class="svelte-1bz53f9">SELL (Short): EV ≥ 0.20 and pWin ≥ 50%, band not Wide. <br class="svelte-1bz53f9">Otherwise: WAIT.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">EV Table (Example)</div> <div class="overflow-x-auto svelte-1bz53f9"><table class="table table-xs svelte-1bz53f9"><thead class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><th class="svelte-1bz53f9">Side</th><th class="svelte-1bz53f9">SL (×ATR)</th><th class="svelte-1bz53f9">EV (R)</th><th class="svelte-1bz53f9">pWin (%)</th><th class="svelte-1bz53f9">winR</th><th class="svelte-1bz53f9">lossR</th></tr></thead><tbody class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">L</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">+0.45</td><td class="svelte-1bz53f9">62</td><td class="svelte-1bz53f9">1.60</td><td class="svelte-1bz53f9">0.95</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">L</td><td class="svelte-1bz53f9">1.25×</td><td class="svelte-1bz53f9">+0.30</td><td class="svelte-1bz53f9">68</td><td class="svelte-1bz53f9">1.35</td><td class="svelte-1bz53f9">0.80</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">S</td><td class="svelte-1bz53f9">0.80×</td><td class="svelte-1bz53f9">+0.20</td><td class="svelte-1bz53f9">54</td><td class="svelte-1bz53f9">1.10</td><td class="svelte-1bz53f9">0.85</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">S</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">−0.05</td><td class="svelte-1bz53f9">48</td><td class="svelte-1bz53f9">1.20</td><td class="svelte-1bz53f9">1.10</td></tr></tbody></table></div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">EV: the overall expectancy—combines win and loss outcomes.</li> <li class="svelte-1bz53f9">pWin (%): out of 100. Higher means better chance to win.</li> <li class="svelte-1bz53f9">winR and lossR: how much you might win or lose. Balance them.</li> <li class="svelte-1bz53f9">If EV ≥ 0, consider the row; higher EV means better overall
                  expectancy.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">How the ▶ arrow works</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">The ▶ in the table marks the <span class="font-medium svelte-1bz53f9">active SL multiplier</span>. Click inside the table to move it to the next row.</li> <li class="svelte-1bz53f9">Where ▶ sits, the chart’s dashed stop‑lines update using that
                  row’s <span class="font-medium svelte-1bz53f9">SL (×ATR)</span>.</li> <li class="svelte-1bz53f9">If ▶ is on a Long row: think with a long bias; the stop is
                  usually below current price (<span class="font-medium svelte-1bz53f9">anchor − mult × ATR</span>).</li> <li class="svelte-1bz53f9">If ▶ is on a Short row: think with a short bias; the stop is
                  usually above current price (<span class="font-medium svelte-1bz53f9">anchor + mult × ATR</span>).</li> <li class="svelte-1bz53f9">Best practice: place ▶ on rows with <span class="font-medium svelte-1bz53f9">positive EV</span>, <span class="font-medium svelte-1bz53f9">higher pWin</span>, and <span class="font-medium svelte-1bz53f9">controlled lossR</span>.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Arrow Example (Short)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">Suppose ▶ is on a Short row with <span class="font-medium svelte-1bz53f9">SL = 1.50×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.71</span>, <span class="font-medium svelte-1bz53f9">lossR = 1.46</span>.</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.50×</span> means stop
                    distance is <span class="font-medium svelte-1bz53f9">1.5 × ATR</span> above
                    anchor. Far stop → fewer stop‑hits; risk unit is larger.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.71</span> means average win
                    is <span class="font-medium svelte-1bz53f9">1.71R</span>. If 1R = 100 units
                    risk, average win ≈ 171.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 1.46</span> means average
                    loss is <span class="font-medium svelte-1bz53f9">1.46R</span>.</li> <li class="svelte-1bz53f9">Decision: if pWin ≈ 55%, <span class="font-medium svelte-1bz53f9">EV = pWin × winR − (1−pWin) × lossR</span> = 0.55×1.71 − 0.45×1.46 ≈ <span class="font-medium svelte-1bz53f9">+0.28R</span> → acceptable.</li> <li class="svelte-1bz53f9">If pWin drops below ~45% or lossR rises, move ▶ to a better
                    row (smaller SL or higher EV).</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Arrow Example (Long)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">Suppose ▶ is on a Long row with <span class="font-medium svelte-1bz53f9">SL = 1.00×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.40</span>, <span class="font-medium svelte-1bz53f9">lossR = 0.90</span>.</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.00×</span> means stop
                    distance is <span class="font-medium svelte-1bz53f9">1 × ATR</span> below anchor.
                    Closer stop → smaller risk; may get hit more often.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.40</span> means average win
                    is 1.40R.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 0.90</span> means average loss
                    is 0.90R.</li> <li class="svelte-1bz53f9">If pWin ≈ 60%, <span class="font-medium svelte-1bz53f9">EV ≈ 0.60×1.40 − 0.40×0.90 = +0.54R</span> → strong setup.</li> <li class="svelte-1bz53f9">If band is very wide or pWin is low, move ▶ to rows with
                    positive EV and controlled lossR.</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Band‑Based Decisions</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">Narrow band: clearer path—slightly increase conviction if
                  suitable.</li> <li class="svelte-1bz53f9">Wide band: more uncertainty—reduce size or wait for clarity.</li> <li class="svelte-1bz53f9">If band overlaps major support/resistance: be cautious; use a
                  safer stop.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Examples</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Long Bias</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">Middle road is upward. EV +0.30→+0.60, pWin 55–65%. SL
                    1.0×–1.25× often gives a good balance between win chance and
                    lossR.</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Short Bias</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">Middle road is downward. Short EV +0.20→+0.45. If the band
                    overlaps prior lows, SL 0.8×–1.0× is a careful choice.</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">When to Buy/Sell</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Buy When (Long)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">EV +0.30 or higher</li> <li class="svelte-1bz53f9">pWin 55% or higher</li> <li class="svelte-1bz53f9">Band is narrow (clear path)</li> <li class="svelte-1bz53f9">Middle road is upward</li> <li class="svelte-1bz53f9">Stop-loss 1.0×–1.25× ATR</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">Example: EV +0.45, pWin 62%, narrow band → Buy</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Sell When (Short)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">Short EV +0.20 or higher</li> <li class="svelte-1bz53f9">pWin 50% or higher</li> <li class="svelte-1bz53f9">Band is narrow</li> <li class="svelte-1bz53f9">Middle road is downward</li> <li class="svelte-1bz53f9">Stop-loss 0.8×–1.0× ATR</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">Example: EV +0.25, pWin 54%, narrow band → Sell</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">When to Wait</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">EV is negative (−0.10 or worse)</li> <li class="svelte-1bz53f9">Band is very wide (high uncertainty)</li> <li class="svelte-1bz53f9">pWin below 45%</li> <li class="svelte-1bz53f9">Band overlaps major support/resistance</li> <li class="svelte-1bz53f9">Poor winR/lossR balance (winR ≤ 1.0 or lossR ≥ 1.2)</li></ul> <p class="text-sm text-base-content/70 mt-2 svelte-1bz53f9">Example: EV −0.15, pWin 42%, wide band → Wait</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Tips</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">Use the edit popup to change band opacity, colors, and line
                  styles.</li> <li class="svelte-1bz53f9">Click inside the EV table to change stops; dashed lines update
                  instantly.</li> <li class="svelte-1bz53f9">Pair with trend filters or volume to make decisions more
                  robust.</li> <li class="svelte-1bz53f9">Risk management: Don't risk more than 1–2% per trade</li> <li class="svelte-1bz53f9">Confirmation: Wait for candlestick pattern or indicator
                  confirmation</li></ul></div>`,1),AF=re('<div class="fixed inset-0 z-[60] svelte-1bz53f9"><div class="absolute inset-0 bg-base-200/20 svelte-1bz53f9"></div> <div class="absolute inset-0 flex items-center justify-center p-4 svelte-1bz53f9"><div class="w-full max-w-3xl rounded-xl shadow-2xl border border-base-300 bg-base-100 overflow-hidden svelte-1bz53f9"><div class="flex items-center justify-between px-5 py-4 border-b border-base-300 bg-base-50 svelte-1bz53f9"><div class="flex items-center gap-3 svelte-1bz53f9"><div class="w-8 h-8 rounded-lg flex items-center justify-center bg-primary/10 text-primary svelte-1bz53f9"><svg class="w-5 h-5 svelte-1bz53f9" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10" class="svelte-1bz53f9"></circle><line x1="12" y1="16" x2="12" y2="12" class="svelte-1bz53f9"></line><line x1="12" y1="8" x2="12.01" y2="8" class="svelte-1bz53f9"></line></svg></div> <div class="svelte-1bz53f9"><div class="text-base font-semibold text-base-content svelte-1bz53f9"> </div> <div class="text-xs text-base-content/60 svelte-1bz53f9"> </div></div></div> <div class="flex items-center gap-2 svelte-1bz53f9"><button>বাংলা</button> <button>English</button></div> <button class="btn btn-xs btn-ghost svelte-1bz53f9" aria-label="Close"><svg class="w-4 h-4 svelte-1bz53f9" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18" class="svelte-1bz53f9"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-1bz53f9"></line></svg></button></div> <div class="px-5 py-4 space-y-5 max-h-[70vh] overflow-y-auto svelte-1bz53f9"><!></div></div></div></div>'),LF=(o,e)=>x(e,!1),zF=(o,e)=>x(e,!1),FF=re(`<div class="premium-modal-backdrop svelte-1bz53f9" role="presentation"></div> <div class="premium-modal-container svelte-1bz53f9" role="dialog" aria-modal="true" aria-labelledby="premium-modal-title"><div class="premium-background svelte-1bz53f9"><div class="premium-orb premium-orb-1 svelte-1bz53f9"></div> <div class="premium-orb premium-orb-2 svelte-1bz53f9"></div></div> <div class="premium-content svelte-1bz53f9"><button class="premium-close-btn svelte-1bz53f9" aria-label="Close"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><line x1="18" y1="6" x2="6" y2="18" class="svelte-1bz53f9"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-1bz53f9"></line></svg></button> <div class="premium-icon-wrapper svelte-1bz53f9"><div class="premium-icon svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-1bz53f9"></path><path d="M2 17l10 5 10-5" class="svelte-1bz53f9"></path><path d="M2 12l10 5 10-5" class="svelte-1bz53f9"></path></svg> <div class="premium-icon-glow svelte-1bz53f9"></div></div></div> <h2 id="premium-modal-title" class="premium-title svelte-1bz53f9">Premium Feature</h2> <p class="premium-message svelte-1bz53f9">Smart Trend is an exclusive premium indicator. Upgrade to Premium to
        unlock this advanced trend-following tool and enhance your trading
        strategy.</p> <div class="premium-features svelte-1bz53f9"><div class="premium-feature-item svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><polyline points="20 6 9 17 4 12" class="svelte-1bz53f9"></polyline></svg> <span class="svelte-1bz53f9">Smart Trend Indicator</span></div> <div class="premium-feature-item svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><polyline points="20 6 9 17 4 12" class="svelte-1bz53f9"></polyline></svg> <span class="svelte-1bz53f9">AI Indicators (Smart Money, Trap Hunter, Volcanic)</span></div> <div class="premium-feature-item svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><polyline points="20 6 9 17 4 12" class="svelte-1bz53f9"></polyline></svg> <span class="svelte-1bz53f9">More premium features coming soon</span></div></div> <a target="_blank" rel="noopener noreferrer" class="premium-payment-btn svelte-1bz53f9"><span class="svelte-1bz53f9">Upgrade to Premium</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><line x1="5" y1="12" x2="19" y2="12" class="svelte-1bz53f9"></line><polyline points="12 5 19 12 12 19" class="svelte-1bz53f9"></polyline></svg></a></div></div>`,1),$F=re("<!> <!> <!>",1);function DF(o,e){Mc(e,!0);const t=Au(),s=()=>ua(v,"$chart",t),i=()=>ua(d,"$save",t),r=()=>ua(c,"$ctx",t),a=()=>ua(Nf,"$userPreferences",t);let l=Qs(e,"show",15);const c=vc("ctx"),d=vc("save"),v=vc("chart"),g=j1(),_=[{name:"BBI",title:"BBI (Bull and Bear Index)",is_main:!1},{name:"BOLL",title:"BOLL (Bollinger Bands)",is_main:!0},{name:"EMA",title:"EMA (Exponential Moving Average)",is_main:!0},{name:"ICHIMOKU",title:"ICHIMOKU (Ichimoku Kinko Hyo)",is_main:!0},{name:"MA",title:"MA (Moving Average)",is_main:!0},{name:"SAR",title:"SAR (Parabolic SAR)",is_main:!0},{name:"SMA",title:"SMA (Simple Moving Average)",is_main:!0},{name:"SMARTTREND",title:"Smart Trend",is_main:!0},{name:"ZIGZAG",title:"ZigZag (Trend Reversal Indicator)",is_main:!0},{name:"AO",title:"Awesome Oscillator",is_main:!1},{name:"BIAS",title:"BIAS (Bias)",is_main:!1},{name:"CCI",title:"CCI (Commodity Channel Index)",is_main:!1},{name:"CR",title:"CR (Energy)",is_main:!1},{name:"DMI",title:"DMI (Directional Movement Index)",is_main:!1},{name:"EMV",title:"EMV (Ease of Movement)",is_main:!1},{name:"KDJ",title:"KDJ (KDJ Index)",is_main:!1},{name:"MACD",title:"MACD (Moving Average Convergence Divergence)",is_main:!1},{name:"MTM",title:"MTM (Momentum)",is_main:!1},{name:"OBV",title:"OBV (On Balance Volume)",is_main:!1},{name:"PSY",title:"PSY (Psychological Line)",is_main:!1},{name:"PVT",title:"PVT (Price Volume Trend)",is_main:!1},{name:"ROC",title:"ROC (Rate of Change)",is_main:!1},{name:"RSI",title:"RSI (Relative Strength Index)",is_main:!1},{name:"STOCH",title:"STOCH (Stochastic Oscillator)",is_main:!1},{name:"TRIX",title:"TRIX (Triple Exponential Moving Average)",is_main:!1},{name:"VOL",title:"VOL (Volume)",is_main:!0},{name:"VR",title:"VR (Volume Variation Rate)",is_main:!1},{name:"WR",title:"WR (Williams Percentage Range)",is_main:!1}];_.push({name:"NPO_MAE",title:"Nearest‑Pattern Outcome + MAE‑Stop",is_main:!0});const y=_.slice().sort((ce,we)=>ce.name.localeCompare(we.name));function k(ce){const we=_.find(ze=>ze.name===ce);return we?we.title:ce}function S(ce,we){const ze=new Set;if(!(ce!=null&&ce.getIndicators))return ze;try{ce.getIndicators().forEach(qe=>{(qe==null?void 0:qe.name)===we&&(qe!=null&&qe.paneId)&&ze.add(qe.paneId)})}catch(dt){console.warn(`⚠️ Failed to read ${we} pane IDs from chart:`,dt)}return ze}function M(ce,we){if(!we.has(ce))return ce;let ze=2;for(;we.has(`${ce}_${ze}`)&&ze<1e3;)ze+=1;if(!we.has(`${ce}_${ze}`))return`${ce}_${ze}`;let dt=`${ce}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;for(;we.has(dt);)dt=`${ce}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;return dt}function I(ce,we,ze,dt){const qe=S(ce,we);for(const me of qe)if(!ze.has(me))return me;return dt}let C=ee(D(new Set));function T(){var ze,dt,qe,me,Q,it;const ce=new Set;if(s())try{const Vt=((dt=(ze=s()).getIndicators)==null?void 0:dt.call(ze))??[];Vt.forEach(At=>{At&&At.name&&ce.add(At.name)}),console.log("📊 Indicator list - from chart.getIndicators:",Vt.map(At=>At.name));const wt=((me=(qe=s()).getOverlays)==null?void 0:me.call(qe))??[];(wt==null?void 0:wt.some(At=>(At==null?void 0:At.name)==="NearestPatternOutcomeMaeStop"))&&ce.add("NPO_MAE")}catch(Vt){console.warn("⚠️ Indicator list - getIndicators failed, falling back to saveInds",Vt)}if(ce.size===0&&i()&&i().saveInds){Object.values(i().saveInds).forEach(Vt=>{Vt&&Vt.name&&ce.add(Vt.name)}),console.log("📊 Indicator list - from saveInds (fallback):",Array.from(ce));try{(((it=(Q=s())==null?void 0:Q.getOverlays)==null?void 0:it.call(Q))??[]).some(wt=>(wt==null?void 0:wt.name)==="NearestPatternOutcomeMaeStop")||ce.delete("NPO_MAE")}catch{}}const we=Array.from(ce).map(Vt=>k(Vt));console.log("🔄 selectedIndicators updated:",we),x(C,D(ce))}zr(()=>{var ce;l(),s(),(ce=i())==null||ce.saveInds,T()}),hp(()=>{console.log("modalIndSearch mounted"),console.log("Available ActionTypes:",Object.keys(Nv)),console.log("ActionType values:",Object.values(Nv)),console.log("🔍 localStorage content:");for(let ce=0;ce<localStorage.length;(ce+=1)-1){const we=localStorage.key(ce);we&&console.log(`🔍 ${we}:`,localStorage.getItem(we))}window.debugChart=()=>{const ce=JSON.parse(localStorage.getItem("chart")||"{}");return console.log("🔍 localStorage chart data:",ce),console.log("🔍 saveInds keys:",Object.keys(ce.saveInds||{})),console.log("🔍 Current $save.saveInds keys:",Object.keys(i().saveInds)),console.log("🔍 Chart available:",s()?"Yes":"No chart"),{localStorage:ce,currentSave:i().saveInds}},setTimeout(()=>{console.log("🚀 Auto-debug on page load:"),window.debugChart()},2e3),console.log("🔍 Debug function added: window.debugChart()")});let z=ee(""),j=ee(!1),B=ee(D(new Set)),$=ee(!1),F=ee(!1),V=ee(!0),K=ee(0),Y,Z=ee(!1),ne=ee("bn"),te=ee(!1);zr(()=>{n(Z)&&l()?(x(te,!0),l(!1)):!n(Z)&&!l()&&n(te)&&(x(te,!1),l(!0))}),zr(()=>{!r().modalIndCfg&&n(j)&&(x(j,!1),setTimeout(()=>{l(!0)},100))});let oe=Qe(()=>{let ce=y;if(n(z)){const we=n(z).toLowerCase();ce=ce.filter(ze=>ze.name.toLowerCase().includes(we)||ze.title.toLowerCase().includes(we)).sort((ze,dt)=>ze.name.localeCompare(dt.name))}if(l()&&n(B).size>0){const we=ce.filter(dt=>n(B).has(dt.name)),ze=ce.filter(dt=>!n(B).has(dt.name));return[...we,...ze]}return ce});zr(()=>{var ce,we;if(l()!==n($)){if(l()){const ze=new Set;if((we=(ce=n(C)).forEach)==null||we.call(ce,dt=>ze.add(dt)),ze.size===0&&n(C)&&n(C).size>0)for(const dt of n(C).values())ze.add(dt);x(B,D(ze))}else x(B,D(new Set));x($,D(l()))}});function U(){var we;const ce=(we=a())==null?void 0:we.data;return ce?ce.isPremium===!0||ce.isTrial===!0:!1}async function J(ce,we,ze,dt=800){var me;const qe=Date.now();for(;Date.now()-qe<dt;){try{const Q=((me=ce.getIndicators)==null?void 0:me.call(ce,{name:we,paneId:ze}))??[];if(Q.length>0&&Q.some(Vt=>(Vt==null?void 0:Vt.result)&&Object.keys(Vt.result).length>0))return}catch{}await new Promise(Q=>setTimeout(Q,16))}}async function se(ce,we){var ze,dt,qe,me,Q,it,Vt,wt,Yt,At,Gt,no,Do,Eo,bs,Is,qi,Ks;if(we==="SMARTTREND"&&!U()){console.log("🔒 Premium access required for Smart Trend indicator"),x(F,!0);return}if(we==="BBI")ye(we,[3,6,12,24],!0,{id:"pane_BBI"});else if(we==="EMA")ye(we,[20],!0,{id:"candle_pane"});else if(we==="MA"){const ws="candle_pane",vn=s();if(vn){const es=vn.createIndicator({name:"MA",calcParams:[20],styles:{lines:[{color:"#2563eb",size:1,style:Oe.Solid}]},createTooltipDataSource:({indicator:Li})=>{const ci=[Li.visible?1:0,2,3],oa=vn.getStyles().indicator.tooltip;return{icons:ci.map(Xi=>oa.features[Xi])}}},!0,{id:ws});if(await J(vn,"MA",ws),es){const Li={name:"MA",pane_id:ws,params:[20],styles:[{color:"#2563eb",thickness:1,lineStyle:"solid"}]},ci=`${ws}_MA`;d.update(oa=>(oa.saveInds[ci]=Li,oa))}}}else if(we==="SMARTTREND"){const ws="candle_pane",vn=s();if(vn){const es=vn.createIndicator({name:"SMARTTREND",calcParams:[10,3],styles:{lines:[{color:"#00FF00",size:1,style:Oe.Dashed,dashedValue:[4,4]}]},extendData:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"},createTooltipDataSource:({indicator:Li})=>{const ci=[Li.visible?1:0,2,3],oa=vn.getStyles().indicator.tooltip;return{icons:ci.map(Xi=>oa.features[Xi])}}},!0,{id:ws});if(await J(vn,"SMARTTREND",ws),es){const Li={name:"SMARTTREND",pane_id:ws,params:[10,3],superTrendGroups:[{id:"st_default",period:10,multiplier:3,showLabels:!0,styles:{uptrend:{color:"#00FF00",thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}}]},ci=`${ws}_SMARTTREND`;d.update(oa=>(oa.saveInds[ci]=Li,oa))}}}else if(we==="SMA"){const ws="candle_pane",vn=s();if(vn){const es=vn.createIndicator({name:"SMA",calcParams:[20],styles:{lines:[{color:"#FF6C37",size:2,style:Oe.Solid}]},createTooltipDataSource:({indicator:Li})=>{const ci=[Li.visible?1:0,2,3],oa=vn.getStyles().indicator.tooltip;return{icons:ci.map(Xi=>oa.features[Xi])}}},!0,{id:ws});if(await J(vn,"SMA",ws),es){const Li={name:"SMA",pane_id:ws,params:[20],styles:[{color:"#FF6C37",thickness:2,lineStyle:"solid"}]},ci=`${ws}_SMA`;d.update(oa=>(oa.saveInds[ci]=Li,oa))}}}else if(we==="RSI"){const ws=s();if(!ws)return;let vn=[];try{const ml=localStorage.getItem("rsiGroups");ml&&(vn=JSON.parse(ml))}catch(ml){console.warn("Failed to load saved RSI groups:",ml)}vn.length===0&&(vn=[{id:"rsi_default",period:14,overbought:70,middle:50,oversold:30,styles:{rsi:{color:"#8B5CF6",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",oversoldColor:"#10B981",middleLineColor:"#6B7280"}}]);const es=vn[0],Li=es.overboughtLevel??es.overbought??70,ci=es.middleLevel??es.middle??50,oa=es.oversoldLevel??es.oversold??30,ol=S(ws,"RSI"),Xi=new Set(ol);Object.values(i().saveInds).forEach(ml=>{(ml==null?void 0:ml.name)==="RSI"&&(ml!=null&&ml.pane_id)&&Xi.add(ml.pane_id)});const fc=M("pane_RSI",Xi),rd=ws.createIndicator({name:"RSI",calcParams:[es.period],styles:{lines:[{color:((dt=(ze=es.styles)==null?void 0:ze.rsi)==null?void 0:dt.color)||"#8B5CF6",size:((me=(qe=es.styles)==null?void 0:qe.rsi)==null?void 0:me.thickness)??2,style:((it=(Q=es.styles)==null?void 0:Q.rsi)==null?void 0:it.lineStyle)==="dashed"||((wt=(Vt=es.styles)==null?void 0:Vt.rsi)==null?void 0:wt.lineStyle)==="dotted"?Oe.Dashed:Oe.Solid}]}},!1,{id:fc,axis:{gap:{bottom:2}}});if(await J(ws,"RSI",fc),rd){const ml=I(ws,"RSI",ol,fc),Jl={id:es.id||`rsi_${Date.now()}`,period:es.period,overboughtLevel:Li,middleLevel:ci,oversoldLevel:oa,paneId:ml,actualPaneId:ml,styles:{rsi:{color:((At=(Yt=es.styles)==null?void 0:Yt.rsi)==null?void 0:At.color)||"#8B5CF6",thickness:((no=(Gt=es.styles)==null?void 0:Gt.rsi)==null?void 0:no.thickness)??2,lineStyle:((Eo=(Do=es.styles)==null?void 0:Do.rsi)==null?void 0:Eo.lineStyle)||"solid"},overboughtColor:((bs=es.styles)==null?void 0:bs.overboughtColor)||"#EF4444",oversoldColor:((Is=es.styles)==null?void 0:Is.oversoldColor)||"#10B981",middleLineColor:((qi=es.styles)==null?void 0:qi.middleLineColor)||"#6B7280"}},Wl={name:"RSI",pane_id:ml,params:[es.period],rsiGroups:[Jl]},sl=`${ml}_RSI`;d.update(Uc=>(Uc.saveInds[sl]=Wl,Uc))}}else if(we==="STOCH"){const ws="pane_STOCH";let vn=[];try{const ci=localStorage.getItem("stochasticGroups");ci&&(vn=JSON.parse(ci))}catch(ci){console.warn("Failed to load saved Stochastic groups:",ci)}vn.length===0&&(vn=[{id:"stochastic_default",kPeriod:14,dPeriod:3,overbought:80,mid:50,oversold:20,styles:{k:{color:"#3B82F6",thickness:2,lineStyle:"solid"},d:{color:"#EF4444",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",oversoldColor:"#10B981",midColor:"#6B7280"}}]);const es=vn[0],Li=s();if(Li&&Li.createIndicator({name:"STOCH",calcParams:[es.kPeriod,es.dPeriod],styles:{lines:[{color:es.styles.k.color,size:es.styles.k.thickness,style:es.styles.k.lineStyle==="dashed"||es.styles.k.lineStyle==="dotted"?Oe.Dashed:Oe.Solid},{color:es.styles.d.color,size:es.styles.d.thickness,style:es.styles.d.lineStyle==="dashed"||es.styles.d.lineStyle==="dotted"?Oe.Dashed:Oe.Solid}]}},!0,{id:ws})){const oa={name:"STOCH",pane_id:ws,params:[es.kPeriod,es.dPeriod]},ol=`${ws}_STOCH`;d.update(Xi=>(Xi.saveInds[ol]=oa,Xi))}}else if(we==="NPO_MAE"){const ws=s();if(!ws)return;if(!(((Ks=ws.getOverlays)==null?void 0:Ks.call(ws))??[]).some(es=>(es==null?void 0:es.name)==="NearestPatternOutcomeMaeStop")){const es=uF(ws);window.__npoMaeApi=es,d.update(Li=>{const ci="candle_pane_NPO_MAE";return Li.saveInds[ci]={name:"NPO_MAE",pane_id:"candle_pane"},Li})}}else{const ws=ce?"candle_pane":"pane_"+we;ye(we,void 0,!0,{id:ws})}}function W(ce){var ze,dt;let we=Object.entries(i().saveInds).find(([qe,me])=>me.name===ce);if(!we&&s())try{const me=(((dt=(ze=s()).getIndicators)==null?void 0:dt.call(ze))??[]).find(Q=>Q&&Q.name===ce);if(me){Wa(c,ys(r).editIndName=ce,ys(r)),Wa(c,ys(r).editPaneId=me.paneId||r().editPaneId||"candle_pane",ys(r)),Wa(c,ys(r).modalIndCfg=!0,ys(r)),x(j,!0),l(!1);return}}catch(qe){console.warn("⚠️ Failed to locate indicator on chart for edit:",qe)}if(we){const[,qe]=we;Wa(c,ys(r).editIndName=ce,ys(r)),Wa(c,ys(r).editPaneId=qe.pane_id,ys(r)),Wa(c,ys(r).modalIndCfg=!0,ys(r)),x(j,!0),l(!1)}}function le(ce){var we,ze,dt;if(ce==="NPO_MAE"){const qe=s();if(qe)try{(((we=qe.getOverlays)==null?void 0:we.call(qe))??[]).forEach(Q=>{if((Q==null?void 0:Q.name)==="NearestPatternOutcomeMaeStop")try{qe.removeOverlay({id:Q.id})}catch{}})}catch{}try{(dt=(ze=window.__npoMaeApi)==null?void 0:ze.dispose)==null||dt.call(ze),window.__npoMaeApi=null}catch{}d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{var it;((it=me.saveInds[Q])==null?void 0:it.name)==="NPO_MAE"&&delete me.saveInds[Q]}),me));return}if(ce==="MACD")Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="MACD").forEach(([me,Q])=>{Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="MACD"&&delete me.saveInds[Q]}),me));else if(ce==="RSI")Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="RSI").forEach(([me,Q])=>{Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="RSI"&&delete me.saveInds[Q]}),me));else if(ce==="STOCH")Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="STOCH").forEach(([me,Q])=>{Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="STOCH"&&delete me.saveInds[Q]}),me));else if(ce==="BBI")Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="BBI").forEach(([me,Q])=>{Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="BBI"&&delete me.saveInds[Q]}),me));else if(ce==="AO"){if(console.log("🗑️ Starting bulk AO deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="AO");console.log("📊 Found AO indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing AO indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"AO"})}),console.log("✅ All AO indicators removed from chart")}catch(me){console.error("❌ Error removing AO indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="AO");console.log("🗑️ Deleting AO saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="AO"&&(console.log("🗑️ Clearing AO saved data:",Q),delete me.saveInds[Q])}),me)),console.log("✅ Bulk AO deletion completed")}else if(ce==="DMI"){if(console.log("🗑️ Starting bulk DMI deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="DMI");console.log("📊 Found DMI indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing DMI indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"DMI"})}),console.log("✅ All DMI indicators removed from chart")}catch(me){console.error("❌ Error removing DMI indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="DMI");console.log("🗑️ Deleting DMI saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="DMI"&&(console.log("🗑️ Clearing DMI saved data:",Q),delete me.saveInds[Q])}),me)),console.log("✅ Bulk DMI deletion completed")}else if(ce==="SAR"){if(console.log("🗑️ Starting bulk SAR deletion..."),s())try{const me=s().getIndicators().filter(Q=>Q.name==="SAR");console.log("📊 Found SAR indicators on chart:",me.length),me.forEach(Q=>{console.log("🗑️ Removing SAR from pane:",Q.paneId),s().removeIndicator({paneId:Q.paneId,name:"SAR"})})}catch(qe){console.error("❌ Error removing SAR indicators from chart:",qe);try{s().removeIndicator({paneId:"candle_pane",name:"SAR"})}catch{}try{s().removeIndicator({paneId:r().editPaneId,name:"SAR"})}catch{}}d.update(qe=>(Object.keys(qe.saveInds).forEach(me=>{qe.saveInds[me].name==="SAR"&&delete qe.saveInds[me]}),qe)),c.update(qe=>(qe.editIndName==="SAR"&&(qe.editIndName="",qe.editPaneId="",qe.modalIndCfg=!1),qe)),console.log("✅ Bulk SAR deletion completed")}else if(ce==="SMARTTREND"){if(console.log("🗑️ Starting bulk Smart Trend deletion..."),s())try{const me=s().getIndicators().filter(Q=>Q.name==="SMARTTREND");console.log("📊 Found Smart Trend indicators on chart:",me.length),me.forEach(Q=>{console.log("🗑️ Removing Smart Trend from pane:",Q.paneId),s().removeIndicator({paneId:Q.paneId,name:"SMARTTREND"})})}catch(qe){console.error("❌ Error removing Smart Trend indicators from chart:",qe);try{s().removeIndicator({paneId:"candle_pane",name:"SMARTTREND"})}catch{}try{s().removeIndicator({paneId:r().editPaneId,name:"SMARTTREND"})}catch{}}d.update(qe=>(Object.keys(qe.saveInds).forEach(me=>{qe.saveInds[me].name==="SMARTTREND"&&delete qe.saveInds[me]}),qe)),console.log("✅ Bulk Smart Trend deletion completed")}else if(ce==="CR"){if(console.log("🗑️ Starting bulk CR deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="CR");console.log("📊 Found CR indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing CR indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"CR"})}),console.log("✅ All CR indicators removed from chart")}catch(me){console.error("❌ Error removing CR indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="CR");console.log("🗑️ Deleting CR saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="CR"&&(console.log("🗑️ Clearing CR saved data:",Q),delete me.saveInds[Q])}),me)),console.log("✅ Bulk CR deletion completed")}else if(ce==="WR"){if(console.log("🗑️ Starting bulk WR deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="WR");console.log("📊 Found WR indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing WR indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"WR"})}),console.log("✅ All WR indicators removed from chart")}catch(me){console.error("❌ Error removing WR indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="WR");console.log("🗑️ Deleting WR saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="WR"&&(console.log("🗑️ Clearing WR saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearWrGroups+=1,me)),console.log("✅ Bulk WR deletion completed")}else if(ce==="KDJ"){const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="KDJ");console.log("🗑️ Deleting KDJ entries:",qe),qe.forEach(([me,Q])=>{console.log("🗑️ Deleting KDJ from pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="KDJ"&&(console.log("🗑️ Clearing KDJ saved data:",Q),delete me.saveInds[Q])}),me))}else if(ce==="OBV"){const qe=Object.entries(i().saveInds).filter(([Q,it])=>it.name==="OBV");console.log("🗑️ Deleting OBV entries from saveInds:",qe),qe.forEach(([Q,it])=>{console.log("🗑️ Deleting OBV from pane (saveInds):",it.pane_id),it.pane_id&&Ce(it.pane_id,ce)});const me=[r().editPaneId,"pane_OBV_1","pane_OBV_2","pane_OBV_3","pane_OBV_4","pane_OBV_5","main","sub1","sub2","sub3","sub4"];console.log("🗑️ Attempting to remove OBV from common pane locations..."),me.forEach(Q=>{var it;if(Q)try{console.log("🗑️ Trying to remove OBV from pane:",Q),(it=s())==null||it.removeIndicator({paneId:Q,name:"OBV"})}catch{}}),d.update(Q=>(Object.keys(Q.saveInds).forEach(it=>{Q.saveInds[it].name==="OBV"&&(console.log("🗑️ Clearing OBV saved data:",it),delete Q.saveInds[it])}),Q)),c.update(Q=>(Q.clearObvGroups+=1,Q))}else if(ce==="CCI"){if(console.log("🗑️ Starting bulk CCI deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="CCI");console.log("📊 Found CCI indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing CCI indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"CCI"})}),console.log("✅ All CCI indicators removed from chart")}catch(me){console.error("❌ Error removing CCI indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="CCI");console.log("🗑️ Deleting CCI saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="CCI"&&(console.log("🗑️ Clearing CCI saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearCciGroups+=1,me)),console.log("✅ Bulk CCI deletion completed")}else if(ce==="EMV"){const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="EMV");console.log("🗑️ Deleting EMV entries:",qe),qe.forEach(([me,Q])=>{console.log("🗑️ Deleting EMV from pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="EMV"&&(console.log("🗑️ Clearing EMV saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearEmvGroups+=1,me))}else if(ce==="MTM"){const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="MTM");console.log("🗑️ Deleting MTM entries:",qe),qe.forEach(([me,Q])=>{console.log("🗑️ Deleting MTM from pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="MTM"&&(console.log("🗑️ Clearing MTM saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearMtmGroups+=1,me))}else if(ce==="PSY"){const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="PSY");console.log("🗑️ Deleting PSY entries:",qe),qe.forEach(([me,Q])=>{console.log("🗑️ Deleting PSY from pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="PSY"&&(console.log("🗑️ Clearing PSY saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearPsyGroups+=1,me))}else if(ce==="PVT"){if(console.log("🗑️ Starting bulk PVT deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="PVT");console.log("📊 Found PVT indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing PVT indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"PVT"})}),console.log("✅ All PVT indicators removed from chart")}catch(me){console.error("❌ Error removing PVT indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="PVT");console.log("🗑️ Deleting PVT saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="PVT"&&(console.log("🗑️ Clearing PVT saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearPvtGroups+=1,me)),console.log("✅ Bulk PVT deletion completed")}else if(ce==="ROC"){if(console.log("🗑️ Starting bulk ROC deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="ROC");console.log("📊 Found ROC indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing ROC indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"ROC"})}),console.log("✅ All ROC indicators removed from chart")}catch(me){console.error("❌ Error removing ROC indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="ROC");console.log("🗑️ Deleting ROC saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="ROC"&&(console.log("🗑️ Clearing ROC saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearRocGroups+=1,me)),console.log("✅ Bulk ROC deletion completed")}else if(ce==="VR"){if(console.log("🗑️ Starting bulk VR deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="VR");console.log("📊 Found VR indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing VR indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"VR"})}),console.log("✅ All VR indicators removed from chart")}catch(me){console.error("❌ Error removing VR indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="VR");console.log("🗑️ Deleting VR saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="VR"&&(console.log("🗑️ Clearing VR saved data:",Q),delete me.saveInds[Q])}),me)),console.log("✅ Bulk VR deletion completed")}else if(ce==="VOL"){if(console.log("🗑️ Starting bulk VOL deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="VOL");console.log("📊 Found VOL indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing VOL indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"VOL"})}),console.log("✅ All VOL indicators removed from chart")}catch(me){console.error("❌ Error removing VOL indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="VOL");console.log("🗑️ Deleting VOL saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="VOL"&&(console.log("🗑️ Clearing VOL saved data:",Q),delete me.saveInds[Q])}),me)),c.update(me=>(me.clearVolGroups+=1,me)),console.log("✅ Bulk VOL deletion completed")}else if(ce==="BIAS"){if(console.log("🗑️ Starting bulk BIAS deletion..."),s())try{const Q=s().getIndicators().filter(it=>it.name==="BIAS");console.log("📊 Found BIAS indicators on chart:",Q.length),Q.forEach(it=>{console.log("🗑️ Removing BIAS indicator from pane:",it.paneId),s().removeIndicator({paneId:it.paneId,name:"BIAS"})}),console.log("✅ All BIAS indicators removed from chart")}catch(me){console.error("❌ Error removing BIAS indicators from chart:",me)}const qe=Object.entries(i().saveInds).filter(([me,Q])=>Q.name==="BIAS");console.log("🗑️ Deleting BIAS saved entries:",qe.length),qe.forEach(([me,Q])=>{console.log("🗑️ Cleaning saved entry:",me,"pane:",Q.pane_id),Q.pane_id&&Ce(Q.pane_id,ce)}),d.update(me=>(Object.keys(me.saveInds).forEach(Q=>{me.saveInds[Q].name==="BIAS"&&(console.log("🗑️ Clearing BIAS saved data:",Q),delete me.saveInds[Q])}),me)),console.log("✅ Bulk BIAS deletion completed")}else{const qe=Object.entries(i().saveInds).find(([me,Q])=>Q.name===ce);if(qe){const[,me]=qe;Ce(me.pane_id,ce)}}}async function ye(ce,we,ze,dt){const qe=s();if(!qe)return null;let me=we,Q={};if(ce==="VOL"){if((!(dt!=null&&dt.id)||dt.id!=="candle_pane")&&(dt={axis:{gap:{bottom:2}},...dt}),!we||we.length===0){me=[20];const Gt=(no=>{switch(no){case"dashed":return{style:Oe.Dashed,dashedValue:[4,4]};case"dotted":return{style:Oe.Dashed,dashedValue:[2,2]};default:return{style:Oe.Solid,dashedValue:[2,2]}}})("dotted");Q={bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#26a69a"}],lines:[{color:"#8B5CF6",size:1,style:Gt.style,dashedValue:Gt.dashedValue,smooth:!1}]}}}else ce==="EMV"&&((!(dt!=null&&dt.id)||dt.id!=="candle_pane")&&(dt={axis:{gap:{bottom:2}},...dt}),(!we||we.length===0)&&(me=(bh[ce]||[]).filter(Gt=>Gt.type!=="color").map(Gt=>Gt.default)));if(!me||me.length===0){const At=bh[ce]||[];At.length>0&&ce!=="VOL"&&(me=At.filter(no=>no.type!=="color").map(no=>no.default),At.filter(no=>no.styleKey&&no.type==="color").forEach(no=>{const Do=no.styleKey,Eo=no.default,bs=Do.match(/^(\w+)\[(\d+)\]\.(\w+)$/);if(bs){const[,Is,qi,Ks]=bs;Q[Is]||(Q[Is]=[]),Q[Is][parseInt(qi)]||(Q[Is][parseInt(qi)]={}),Q[Is][parseInt(qi)][Ks]=Eo}}))}const it=(dt==null?void 0:dt.id)??"",Vt=`${it}_${ce}`,wt=qe.createIndicator({name:ce,calcParams:me,styles:Object.keys(Q).length>0?Q:void 0,createTooltipDataSource:({indicator:At})=>{const Gt=[At.visible?1:0,2,3],no=qe.getStyles().indicator.tooltip;return{icons:Gt.map(Eo=>no.features[Eo])}}},ze,dt);if(await J(qe,ce,dt==null?void 0:dt.id),!wt)return null;const Yt={name:ce,pane_id:it,params:me};return d.update(At=>(At.saveInds[Vt]=Yt,At)),xv(),nu.recordAddIndicator(ce,it,me||[],Vt),Yt}async function Ce(ce,we){if(console.log("🗑️ delInd called:",{paneId:ce,name:we,chart:!!s()}),!s()){console.log("❌ No chart available");return}const ze=s(),dt=`${ce}_${we}`,qe=i().saveInds[dt];qe&&nu.recordRemoveIndicator(we,ce,qe.params||[],dt),console.log("🔥 Attempting to remove indicator with correct API: removeIndicator(paneId, name)");try{ze.removeIndicator({paneId:ce,name:we}),console.log("✅ removeIndicator successful")}catch(Q){console.log("❌ removeIndicator failed:",Q);try{console.log("🔄 Trying fallback: remove indicator by name directly"),console.log("Attempting to remove indicator:",we,"from pane:",ce),console.log("Direct removal attempt for:",we),[].forEach(Vt=>{console.log("Removing indicator instance:",Vt);try{ze.removeIndicator({paneId:ce,name:Vt.name})}catch(wt){console.log("Failed to remove indicator instance:",wt)}}),console.log("✅ Fallback method successful")}catch(it){console.log("❌ Fallback method also failed:",it)}}console.log("🧹 Cleaning saved state for:",we);const me=JSON.parse(localStorage.getItem("indicators")||"{}");console.log("🧹 Current localStorage indicators:",me),me[ce]&&(me[ce]=me[ce].filter(Q=>Q.name!==we),me[ce].length===0&&delete me[ce],localStorage.setItem("indicators",JSON.stringify(me)),console.log("🧹 Updated localStorage indicators:",me)),d.update(Q=>{if(console.log("🧹 Before cleanup saveInds keys:",Object.keys(Q.saveInds)),we==="ZIGZAG"){const it=`${ce}_ZIGZAG`;Object.keys(Q.saveInds).forEach(Vt=>{const wt=Q.saveInds[Vt];Vt.startsWith(it)&&(wt==null?void 0:wt.name)==="ZIGZAG"&&(console.log("🧹 Removing ZigZag save key:",Vt),delete Q.saveInds[Vt])})}else{const it=`${ce}_${we}`;console.log("🧹 Cleaning saved state key:",it,"existed:",!!Q.saveInds[it]),delete Q.saveInds[it]}return console.log("🧹 After cleanup saveInds keys:",Object.keys(Q.saveInds)),Q}),xv(),g.removeIndicator({chart:ze,name:we,paneId:ce}).catch(Q=>{console.warn("Background color preservation failed:",Q)}),console.log("✅ delInd completed")}Nd(c,ce=>ce.cloudIndLoaded).subscribe(ce=>{console.log("🔄 cloudIndLoaded triggered, saveInds:",Object.keys(i().saveInds)),console.log("🚫 Automatic indicator restoration disabled to prevent deleted indicators from reappearing")});function Ke(ce){const ze=ce.target.scrollTop;ze<n(K)||ze<=10?x(V,!0):ze>n(K)&&ze>50&&x(V,!1),x(K,D(ze))}const st=Nd(c,ce=>ce.initDone);let vt=!1;st.subscribe(ce=>{if(console.log("initDone changed:",ce,"chart:",!!s(),"subscribed:",vt),ce>0&&!vt&&s()){console.log("Subscribing to OnTooltipIconClick with chart:",s()),console.log("Chart methods available:",Object.getOwnPropertyNames(s())),console.log("subscribeAction method:",typeof s().subscribeAction),vt=!0;try{s().subscribeAction(Nv.OnCandleTooltipFeatureClick,we=>{var dt,qe;console.log("🔥 OnTooltipIconClick fired!",we);const ze=we;if(ze.indicatorName)switch(console.log("Processing icon click:",ze.iconId,"for indicator:",ze.indicatorName),ze.iconId){case"visible":{console.log("Making indicator visible"),(dt=s())==null||dt.overrideIndicator({name:ze.indicatorName,paneId:ze.paneId,visible:!0});break}case"invisible":{console.log("Making indicator invisible"),(qe=s())==null||qe.overrideIndicator({name:ze.indicatorName,paneId:ze.paneId,visible:!1});break}case"setting":{console.log("Opening settings"),Wa(c,ys(r).editIndName=ze.indicatorName,ys(r)),Wa(c,ys(r).editPaneId=ze.paneId,ys(r)),Wa(c,ys(r).modalIndCfg=!0,ys(r)),l()&&l(!1);break}case"close":console.log("Deleting indicator:",ze.indicatorName,"from pane:",ze.paneId),Ce(ze.paneId,ze.indicatorName)}}),console.log("✅ Successfully subscribed to OnTooltipIconClick")}catch(we){console.error("❌ Error subscribing to OnTooltipIconClick:",we)}}});const Je=B0(),[ot,nt]=Je;var tt=$F(),Ze=Rt(tt),ct=Qe(()=>F1());av(Ze,{get title(){return n(ct)},width:700,maxWidth:"95vw",maxHeight:"min(92svh, 90vh)",get show(){return l()},set show(ce){l(ce)},get theme(){return i().theme},buttons:[],class:"ind-modal",children:(ce,we)=>{var ze=kF(),dt=m(ze),qe=p(m(dt),2);Jt(qe),Se(()=>Nt(qe,"placeholder",Eb()));var me=p(qe,2);Te(me,()=>n(z),Yt=>{var At=fF();At.__click=[vF,z],O(Yt,At)}),f(dt);var Q=p(dt,2),it=m(Q),Vt=m(it);Vs(Vt,17,()=>n(oe),_n,(Yt,At,Gt)=>{var no=xF();const Do=Qe(()=>n(C).has(n(At).name));no.__click=[mF,Do,se,At];var Eo=m(no),bs=p(Eo,2),Is=m(bs),qi=m(Is,!0);f(Is),f(bs);var Ks=p(bs,2);Te(Ks,()=>n(At).name==="NPO_MAE",vn=>{var es=hF();es.__click=[gF,Z],O(vn,es)});var ws=p(Ks,2);Te(ws,()=>n(Do),vn=>{var es=bF(),Li=m(es);Li.__click=[_F,W,At];var ci=p(Li,2);ci.__click=[yF,le,At],f(es),O(vn,es)}),f(no),Se(()=>{Gn(no,`group indicator-row relative flex items-center min-h-[56px] px-5 py-3 cursor-pointer transition-all duration-500 ease-out
                   ${(Gt<n(oe).length-1?"border-b":"")??""} 
                   ${(n(Do)?"indicator-item-selected":"indicator-item-unselected")??""} svelte-1bz53f9`),Gn(Eo,`flex items-center justify-center w-2 h-2 rounded-full mr-4 transition-all duration-500
                        ${(n(Do)?"indicator-dot-selected":"indicator-dot-unselected")??""} svelte-1bz53f9`),Gn(Is,`indicator-title text-[15px] font-medium tracking-wide leading-relaxed
                           ${(n(Do)?"indicator-text-selected":"indicator-text-unselected")??""} svelte-1bz53f9`),Ve(qi,n(At).title)}),O(Yt,no)});var wt=p(Vt,2);Te(wt,()=>n(oe).length===0,Yt=>{var At=wF();O(Yt,At)}),f(it),du(it,Yt=>Y=Yt,()=>Y),f(Q),pn(2),f(ze),Se(()=>Gn(dt,`relative group transition-all duration-300 ease-out ${(n(V)?"opacity-100 translate-y-0":"opacity-0 -translate-y-4 pointer-events-none")??""} svelte-1bz53f9`)),Ho(qe,()=>n(z),Yt=>x(z,Yt)),id("scroll",it,Ke),O(ce,ze)},$$slots:{default:!0}});var Ge=p(Ze,2);Te(Ge,()=>n(Z),ce=>{var we=AF(),ze=m(we);ze.__click=[SF,Z];var dt=p(ze,2),qe=m(dt),me=m(qe),Q=m(me),it=p(m(Q),2),Vt=m(it),wt=m(Vt,!0);f(Vt);var Yt=p(Vt,2),At=m(Yt,!0);f(Yt),f(it),f(Q);var Gt=p(Q,2),no=m(Gt);no.__click=[CF,ne];var Do=p(no,2);Do.__click=[PF,ne],f(Gt);var Eo=p(Gt,2);Eo.__click=[IF,Z],f(me);var bs=p(me,2),Is=m(bs);Te(Is,()=>n(ne)==="bn",qi=>{var Ks=MF();pn(22),O(qi,Ks)},qi=>{var Ks=TF();pn(22),O(qi,Ks)}),f(bs),f(qe),f(dt),f(we),Se(()=>{Ve(wt,n(ne)==="bn"?"নিকটতম‑প্যাটার্ন আউটকাম + এমএই‑স্টপ":"Nearest‑Pattern Outcome + MAE‑Stop"),Ve(At,n(ne)==="bn"?"কিভাবে কাজ করে এবং কিভাবে ব্যবহার করবেন":"How it works and how to use"),Gn(no,`btn btn-xs ${(n(ne)==="bn"?"btn-primary":"btn-outline")??""} svelte-1bz53f9`),Gn(Do,`btn btn-xs ${(n(ne)==="en"?"btn-primary":"btn-outline")??""} svelte-1bz53f9`)}),O(ce,we)});var pt=p(Ge,2);return Te(pt,()=>n(F),ce=>{var we=FF(),ze=Rt(we);ze.__click=[LF,F];var dt=p(ze,2),qe=p(m(dt),2),me=m(qe);me.__click=[zF,F];var Q=p(me,10);Se(()=>Nt(Q,"href",ot("https://dutyai.app/payment",void 0))),f(qe),f(dt),Af(3,ze,()=>wh,()=>({duration:200})),Af(3,dt,()=>kh,()=>({y:20,duration:300,easing:m1})),O(ce,we)}),O(o,tt),Tc({createIndicator:ye,delInd:Ce})}Hd(["click"]);function EF(o,e){o.target===o.currentTarget&&e(!1)}function NF(o,e,t,s,i){const r=o.target,a=parseInt(r.value);e(isNaN(a)?100:Math.max(0,Math.min(100,a)));const l=t(s(),e());i("opacityChange",{opacity:e(),rgba:l,color:s()}),i("colorChange",{color:s(),opacity:e(),rgba:l})}var jF=(o,e)=>e(!1),RF=(o,e,t)=>e(n(t)),BF=re("<button></button>"),OF=re('<div class="flex gap-1 flex-wrap"></div>'),VF=(o,e,t)=>e(n(t)),WF=re("<button></button>"),qF=(o,e)=>{const t=o.target;t&&e(t.value)},HF=(o,e)=>{const t=o.target;t&&e(t.value)},GF=re('<div class="fixed inset-0 z-[80] flex items-center justify-center bg-black/50 p-4"><div class="bg-base-100 rounded-lg shadow-xl p-4 w-full max-w-md max-h-[80vh] overflow-y-auto"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-base-content">Color Picker</h3> <button class="btn btn-sm btn-primary">OK</button></div> <div class="space-y-1 mb-4 max-h-60 overflow-y-auto"></div> <div class="mb-4"><div class="flex items-center justify-between mb-2"><div class="text-sm text-base-content/70">Opacity</div> <div class="text-sm text-base-content/80"> </div></div> <div class="relative"><div class="absolute inset-0 h-2 rounded opacity-30" style="background-image: repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 8px 8px;"></div> <input type="range" min="0" max="100" class="relative w-full h-2 rounded appearance-none cursor-pointer"> <div class="absolute top-1/2 w-4 h-4 bg-base-100 border-2 border-base-content rounded-full transform -translate-y-1/2 pointer-events-none shadow-sm"></div></div></div> <div class="mb-4"><div class="text-sm text-base-content/70 mb-2">Quick Colors</div> <div class="flex gap-2 flex-wrap"></div></div> <div class="mt-3 pt-3 border-t border-base-300"><div class="text-xs text-base-content/60 mb-2">Custom Color</div> <div class="flex items-center gap-2 flex-wrap"><input type="color" class="w-8 h-8 rounded border border-base-300 cursor-pointer flex-shrink-0"> <input type="text" class="input input-xs flex-1 min-w-0 text-xs" placeholder="#000000"></div></div></div></div>');function Aa(o,e){Mc(e,!0);let t=Qs(e,"show",15),s=Qs(e,"selectedColor",7,"#000000");Qs(e,"position",19,()=>({x:0,y:0}));let i=Qs(e,"opacity",7,100);const r=sp();function a(y){const k=(y||"").trim();if(!k)return null;if(/^#?[0-9A-Fa-f]{6}$/.test(k)){const M=k.startsWith("#")?k.slice(1):k;return{r:parseInt(M.slice(0,2),16),g:parseInt(M.slice(2,4),16),b:parseInt(M.slice(4,6),16)}}const S=k.match(/^rgba?\(([^)]+)\)$/i);if(S){const M=S[1].split(",").map(I=>parseFloat(I.trim()));if(M.length>=3&&M.every(I=>!isNaN(I)))return{r:Math.round(M[0]),g:Math.round(M[1]),b:Math.round(M[2])}}return null}function l(y,k){const S=a(y);if(!S)return null;const M=Math.max(0,Math.min(100,k))/100;return`rgba(${S.r}, ${S.g}, ${S.b}, ${M})`}const c=[["#000000","#1C1C1C","#383838","#545454","#707070","#8C8C8C","#A8A8A8","#C4C4C4","#E0E0E0","#FFFFFF"],["#FF0000","#FF4D4F","#FF7875","#FFA39E","#FFCCC7","#FFF1F0","#FFEDED","#FFF5F5","#FFFAFA","#FFFFFF"],["#FF8C00","#FA541C","#FF7A45","#FF9C6E","#FFBB96","#FFD8BF","#FFE7BA","#FFF2E8","#FFF7E6","#FFFBE6"],["#FFD700","#FADB14","#FFEC3D","#FFF566","#FFFF8F","#FFFFB8","#FFFBE6","#FFFBF0","#FFFBF0","#FFFBF0"],["#32CD32","#52C41A","#73D13D","#95DE64","#B7EB8F","#D9F7BE","#F6FFED","#F6FFED","#F6FFED","#F6FFED"],["#00CED1","#13C2C2","#36CFC9","#5CDBD3","#87E8DE","#B5F5EC","#E6FFFB","#E6FFFB","#E6FFFB","#E6FFFB"],["#1E90FF","#1890FF","#40A9FF","#69C0FF","#91D5FF","#BAE7FF","#E6F7FF","#E6F7FF","#E6F7FF","#E6F7FF"],["#9370DB","#722ED1","#9254DE","#B37FEB","#D3ADF7","#EFDBFF","#F9F0FF","#F9F0FF","#F9F0FF","#F9F0FF"]],d=["#FF4D4F","#1890FF","#52C41A","#FA8C16","#722ED1","#000000"];function v(y){s(y);const k=l(y,i());r("colorChange",{color:y,opacity:i(),rgba:k}),t(!1)}var g=So(),_=Rt(g);Te(_,t,y=>{var k=GF();k.__click=[EF,t];var S=m(k),M=m(S),I=p(m(M),2);I.__click=[jF,t],f(M);var C=p(M,2);Vs(C,21,()=>c,_n,(J,se)=>{var W=OF();Vs(W,21,()=>n(se),_n,(le,ye)=>{var Ce=BF();Ce.__click=[RF,v,ye],Se(()=>{Gn(Ce,`w-6 h-6 rounded border-2 transition-all hover:scale-110 ${(s()===n(ye)?"border-white shadow-lg":"border-base-300")??""}`),Nt(Ce,"style",`background-color: ${n(ye)??""}`),Nt(Ce,"title",n(ye))}),O(le,Ce)}),f(W),O(J,W)}),f(C);var T=p(C,2),z=m(T),j=p(m(z),2),B=m(j);f(j),f(z);var $=p(z,2),F=p(m($),2);Jt(F),F.__input=[NF,i,l,s,r];const V=Qe(()=>`background: linear-gradient(to right, rgba(0,0,0,0), ${(l(s(),100)||s())??""});`);var K=p(F,2);f($),f(T);var Y=p(T,2),Z=p(m(Y),2);Vs(Z,21,()=>d,_n,(J,se)=>{var W=WF();W.__click=[VF,v,se],Se(()=>{Gn(W,`w-8 h-8 rounded border-2 transition-all hover:scale-110 ${(s()===n(se)?"border-white shadow-lg":"border-base-300")??""}`),Nt(W,"style",`background-color: ${n(se)??""}`),Nt(W,"title",n(se))}),O(J,W)}),f(Z),f(Y);var ne=p(Y,2),te=p(m(ne),2),oe=m(te);Jt(oe),oe.__change=[qF,v];var U=p(oe,2);Jt(U),U.__change=[HF,v],f(te),f(ne),f(S),f(k),Se(()=>{Ve(B,`${i()??""}%`),Nt(F,"style",n(V)),Nt(K,"style",`left: calc(${i()??""}% - 8px);`),cu(oe,s()),cu(U,s())}),Ho(F,i),O(y,k)}),O(o,g),Tc()}Hd(["click","input","change"]);const Qu={LAYOUTS:"chart.saves.v1",ACTIVE_SAVE_ID:"chart.activeSaveId",LEGACY_LAYOUTS:"chart.saves.v0"};function Jn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const e=Math.random()*16|0;return(o==="x"?e:e&3|8).toString(16)})}function W_(o){return o.toUpperCase().trim()}function q_(o){return o&&typeof o.id=="string"&&typeof o.name=="string"&&typeof o.createdAt=="string"&&typeof o.updatedAt=="string"&&typeof o.timezone=="string"&&typeof o.interval=="string"&&typeof o.chartType=="string"&&typeof o.theme=="string"&&Array.isArray(o.panes)&&Array.isArray(o.indicators)&&typeof o.drawingsBySymbol=="object"}class Jx{constructor(){ve(this,"initialized",!1);this.initialize()}async initialize(){if(!(this.initialized||!t1))try{await this.migrate(),this.initialized=!0}catch(e){console.error("Failed to initialize storage provider:",e)}}async migrate(){try{const e=localStorage.getItem(Qu.LEGACY_LAYOUTS);if(!e)return;console.log("🔄 Migrating chart saves from v0 to v1...");const t=JSON.parse(e);if(!Array.isArray(t))return;if(localStorage.getItem(Qu.LAYOUTS)){localStorage.removeItem(Qu.LEGACY_LAYOUTS);return}const i=t.map(r=>({id:r.id||Jn(),name:r.name||"Migrated Layout",createdAt:r.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString(),timezone:r.timezone||"UTC",interval:r.interval||"1h",chartType:r.chartType||"candles",theme:r.theme||"dark",panes:r.panes||[],indicators:r.indicators||[],styles:r.styles||{},options:r.options||{},drawingsBySymbol:r.drawings?{[W_(r.symbol||"DEFAULT")]:r.drawings}:{}}));localStorage.setItem(Qu.LAYOUTS,JSON.stringify(i)),localStorage.removeItem(Qu.LEGACY_LAYOUTS),console.log(`✅ Migrated ${i.length} layouts to v1 format`)}catch(e){console.error("Migration failed:",e)}}async listSavedLayouts(){await this.initialize();try{const e=localStorage.getItem(Qu.LAYOUTS);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t.filter(q_).map(s=>({id:s.id,name:s.name,createdAt:s.createdAt,updatedAt:s.updatedAt})).sort((s,i)=>new Date(i.updatedAt).getTime()-new Date(s.updatedAt).getTime()):[]}catch(e){return console.error("Failed to list saved layouts:",e),[]}}async getSavedLayout(e){await this.initialize();try{const t=localStorage.getItem(Qu.LAYOUTS);if(!t)return null;const s=JSON.parse(t);if(!Array.isArray(s))return null;const i=s.find(r=>r.id===e);return i&&q_(i)?i:null}catch(t){return console.error("Failed to get saved layout:",t),null}}async createSavedLayout(e){await this.initialize();try{const t=new Date().toISOString(),s={...e,id:Jn(),createdAt:t,updatedAt:t,drawingsBySymbol:Object.fromEntries(Object.entries(e.drawingsBySymbol).map(([a,l])=>[W_(a),l]))},i=localStorage.getItem(Qu.LAYOUTS),r=i?JSON.parse(i):[];return r.push(s),localStorage.setItem(Qu.LAYOUTS,JSON.stringify(r)),s}catch(t){throw console.error("Failed to create saved layout:",t),new Error("Failed to save layout")}}async updateSavedLayout(e,t){await this.initialize();try{const s=localStorage.getItem(Qu.LAYOUTS);if(!s)throw new Error("Layout not found");const i=JSON.parse(s),r=i.findIndex(l=>l.id===e);if(r===-1)throw new Error("Layout not found");const a={...i[r],...t,id:e,updatedAt:new Date().toISOString(),drawingsBySymbol:t.drawingsBySymbol?Object.fromEntries(Object.entries(t.drawingsBySymbol).map(([l,c])=>[W_(l),c])):i[r].drawingsBySymbol};return i[r]=a,localStorage.setItem(Qu.LAYOUTS,JSON.stringify(i)),a}catch(s){throw console.error("Failed to update saved layout:",s),new Error("Failed to update layout")}}async deleteSavedLayout(e){await this.initialize();try{const t=localStorage.getItem(Qu.LAYOUTS);if(!t)return;const i=JSON.parse(t).filter(a=>a.id!==e);localStorage.setItem(Qu.LAYOUTS,JSON.stringify(i)),await this.getActiveSaveId()===e&&await this.setActiveSaveId(null)}catch(t){throw console.error("Failed to delete saved layout:",t),new Error("Failed to delete layout")}}async setActiveSaveId(e){try{e===null?localStorage.removeItem(Qu.ACTIVE_SAVE_ID):localStorage.setItem(Qu.ACTIVE_SAVE_ID,e)}catch(t){console.error("Failed to set active save ID:",t)}}async getActiveSaveId(){try{return localStorage.getItem(Qu.ACTIVE_SAVE_ID)}catch(e){return console.error("Failed to get active save ID:",e),null}}async layoutNameExists(e,t){return(await this.listSavedLayouts()).some(i=>i.name===e&&i.id!==t)}async cleanup(){try{const e=localStorage.getItem(Qu.LAYOUTS);if(!e)return;const t=JSON.parse(e),s=t.filter(q_);s.length!==t.length&&(localStorage.setItem(Qu.LAYOUTS,JSON.stringify(s)),console.log(`🧹 Cleaned up ${t.length-s.length} invalid layouts`))}catch(e){console.error("Failed to cleanup storage:",e)}}}const UF=new Jx;function ov(o,e,t,s,i,r,a){if(!n(e)||!t()||!i().editPaneId)return;const l=[a.zoneLookbackBars,a.minZoneBars,a.maxZoneBars,a.atrPeriod,a.volumeMAPeriod,a.minVolumeFactor,a.maxZoneWidthPct,a.priorTrendLookback,a.minOBVTrendStrength,a.minZoneScore,a.mergeNearbyZones?1:0,a.maxZonesDisplayed,a.showLabels?1:0];try{t().overrideIndicator({name:"SMART_MONEY",calcParams:l,paneId:i().editPaneId})}catch(c){console.error("SMART_MONEY realtime update failed:",c)}}function YF(o,e,t){const s={id:Jn(),deviation:5,depth:5,styles:{color:"#2962FF",thickness:2,lineStyle:"solid"}};x(e,D([...n(e),s])),t()}function Jy(o,e,t,s){const i=e();i&&i.setStyles({median:{size:n(t),style:n(s)}})}function Qy(o,e,t,s){const i=e();i&&i.setStyles({slLong:{size:n(t),style:n(s)}})}function e2(o,e,t,s){const i=e();i&&i.setStyles({slShort:{size:n(t),style:n(s)}})}function KF(o,e,t){const s=e();s&&s.setShowOutcomeBand(!!n(t))}function ZF(o,e,t){const s=e();s&&s.setShowStopLines(!!n(t))}function XF(o,e,t){const s=e();s&&s.updateSettings({showTable:!!n(t)})}function JF(o,e,t){if(n(e))try{if(n(t).length>=10){console.warn("⚠️ Maximum number of EMV groups (10) reached");return}const i=n(t).length+1,r={id:Jn(),name:`EMV #${i}`,period:14,period2:9,color:"#2563eb",thickness:2,lineStyle:"solid"};n(t).push(r),console.log("✅ Added new EMV group:",r.name)}catch(s){console.error("❌ Error adding EMV group:",s)}}function QF(o,e,t,s){if(n(e))try{if(n(t).length>=10){console.warn("⚠️ Maximum number of MTM groups (10) reached");return}const r=n(t).length+1,a=["#2563eb","#8B5CF6","#F59E0B","#10B981","#EF4444","#EC4899","#06B6D4","#F97316"],l=n(t).length%a.length,c={id:Jn(),name:`MTM #${r}`,period:14,color:a[l],thickness:2,lineStyle:"solid"};n(t).push(c),console.log("✅ Added new MTM group:",c.name),s()}catch(i){console.error("❌ Error adding MTM group:",i)}}function e$(o,e,t,s){if(!n(e))return;const i=n(t).length+1;n(t).push({id:Jn(),name:`BIAS${i}`,period:6,color:"#2196F3",thickness:1,lineStyle:"solid"}),s()}function t$(o,e,t,s){if(!n(e))return;const i=n(t).length+1,r=i===1?"CCI":`CCI${i}`;n(t).push({id:Jn(),name:r,period:14,color:"#FF9800",thickness:1,lineStyle:"solid"}),console.log("➕ Added new CCI group:",r),s()}function o$(o,e,t,s){if(!n(e))return;const i=n(t)[n(t).length-1]||n(t)[0],r={id:Jn(),start:(i==null?void 0:i.start)??.02,increment:(i==null?void 0:i.increment)??.02,maxValue:(i==null?void 0:i.maxValue)??.2,color:"#2563eb",dotSize:1};x(t,D([...n(t),r])),s()}function s$(o,e,t,s){if(!n(e))return;const i=["#00FF00","#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8"],r=n(t).map(v=>v.styles.uptrend.color),a=i.filter(v=>!r.includes(v)),l=a.length>0?a[0]:i[n(t).length%i.length],c=n(t)[n(t).length-1]||n(t)[0],d={id:Jn(),period:((c==null?void 0:c.period)||10)+2,multiplier:(c==null?void 0:c.multiplier)||3,showLabels:!0,styles:{uptrend:{color:l,thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}};x(t,D([...n(t),d])),console.log("✅ Added new Smart Trend group:",d),s()}function n$(o,e,t,s){if(!n(e))return;const i=n(t).length+1;n(t).push({id:Jn(),name:`DMI${i}`,diPeriod:14,adxPeriod:6,styles:{diPlus:{color:"#22c55e",thickness:1,lineStyle:"solid"},diMinus:{color:"#ef4444",thickness:1,lineStyle:"solid"},adx:{color:"#3b82f6",thickness:1,lineStyle:"solid"}}}),console.log("➕ Added new DMI group"),s()}function i$(o,e,t,s){if(!n(e))return;const i=n(t).length+1;n(t).push({id:Jn(),name:`CR${i}`,crPeriod:26,crMa1Period:10,crMa2Period:20,crMa3Period:40,crMa4Period:60,styles:{cr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},ma1:{color:"#2196F3",thickness:1,lineStyle:"solid"},ma2:{color:"#4CAF50",thickness:1,lineStyle:"solid"},ma3:{color:"#FF9800",thickness:1,lineStyle:"solid"},ma4:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}}),console.log("➕ Added new CR group"),s()}function r$(o,e,t,s){if(!n(e))return;const i=["#26A69A","#EF5350","#8B5CF6","#F59E0B","#10B981","#F97316","#06B6D4","#84CC16"],r=n(t).length%i.length;n(t).push({id:Jn(),shortPeriod:5,longPeriod:34,styles:{increasing:{color:i[r]},decreasing:{color:i[(r+1)%i.length]}}}),s()}function a$(o,e,t){x(e,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(t,!0)}function Qg(o,e,t,s,i,r,a,l,c,d,v,g,_,y,k,S,M){if(n(e))return;if(n(t)){s();return}if(n(i)){r();return}if(n(a)){l();return}if(n(c)){d();return}if(v.length>=10)return;const I=v[v.length-1],C={...I,title:`${I.title.replace(/\d+$/,"")}${v.length+1}`};v.push(C),g.push(C.default||0),_.push({color:"#2563eb",thickness:1,lineStyle:"solid"}),n(y)?k():n(S)&&M()}function l$(o,e,t,s,i,r,a,l,c,d,v,g,_,y,k){if(!n(e))return;const S=t().editPaneId||"candle_pane";n(i).push({id:Jn(),paneId:S,period:n(r),stdDev:n(a),styles:{fillColor:n(l),fillOpacity:n(c),upperColor:n(d),middleColor:n(v),lowerColor:n(g),thickness:n(_),lineStyle:n(y)}}),k()}var c$=(o,e,t)=>e(n(t).id),d$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove MACD"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),u$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Fast</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Slow</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Signal</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">MACD Line:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">Signal Line:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">Positive Bar:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">Negative Bar:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button></div></div></div>'),p$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More MACD"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add MACD</span></button></div></div>'),v$=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Zone Lookback Bars</label> <input type="number" min="10" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Prior Trend Lookback</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Zone Bars</label> <input type="number" min="3" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Zone Bars</label> <input type="number" min="5" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ATR Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Zone Width %</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.005" max="0.10" step="0.005" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Factor</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.5" max="2.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min OBV Trend</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="0.6" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Zone Score</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.3" max="0.9" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center justify-between bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="flex flex-col svelte-fy2ox8"><span class="text-xs font-medium svelte-fy2ox8">Merge Nearby Zones</span> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">Overlap/adjacent similar zones merge</span></div> <input type="checkbox" class="toggle toggle-sm svelte-fy2ox8"></div> <div class="flex items-center justify-between bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="flex flex-col svelte-fy2ox8"><span class="text-xs font-medium svelte-fy2ox8">Show Labels</span> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">Type + score label</span></div> <input type="checkbox" class="toggle toggle-sm svelte-fy2ox8"></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Zones Displayed</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm w-28 svelte-fy2ox8"></div></div>'),f$=(o,e,t)=>{e[9]=o.currentTarget.checked?1:0,t()},m$=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Resistance Lookback</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Support Lookback</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Confirmation Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Trap Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Spike (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="1.0" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Breakout Factor (%)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="number" step="0.0001" min="0.0000" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm w-28 svelte-fy2ox8"> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">e.g. 0.0005 = 0.05%</span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Wick Ratio</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Trap Score</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center justify-between bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="flex flex-col svelte-fy2ox8"><span class="text-xs font-medium svelte-fy2ox8">Stable Signal</span> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">Show blue “Stable” dots</span></div> <input type="checkbox" class="toggle toggle-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Normal Quiet Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm w-28 svelte-fy2ox8"></div></div></div>'),g$=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Compression Inputs</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB StdDev</label> <input type="number" step="0.1" min="0.1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ATR Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Normalize Lookback</label> <input type="number" min="10" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Pressure SMA</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Alert & Breakout Behavior</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Pressure for Alert</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Confirmation Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Range Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Body % of Range</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Breakout Lookback</label> <input type="number" min="5" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Bars Between Signals</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div></div>'),h$=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Detection Parameters</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB StdDev</label> <input type="number" step="0.1" min="0.1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ATR Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Normalize Lookback</label> <input type="number" min="10" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Pressure SMA</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Alert & Breakout Filters</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Pressure for Alert</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Confirmation Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Range Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Body % of Range</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Breakout Lookback</label> <input type="number" min="5" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Bars Between Signals</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div></div>'),_$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove RSI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),y$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Period</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="1" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Overbought</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="50" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Middle</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Oversold</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="50"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/70 svelte-fy2ox8">RSI Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change RSI Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option><option class="svelte-fy2ox8">4</option><option class="svelte-fy2ox8">5</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 border-t border-base-200 pt-2 svelte-fy2ox8"><span class="text-xs text-base-content/70 font-medium svelte-fy2ox8">Level Lines</span> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Overbought</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Overbought Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Oversold</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Oversold Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Middle Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Middle Line Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div> <div class="flex items-center justify-between mt-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Fill Opacity</span> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.05" max="0.5" step="0.05" class="range range-xs w-20 svelte-fy2ox8"> <span class="text-xs text-base-content/60 w-8 svelte-fy2ox8"> </span></div></div></div></div>'),b$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 sm:gap-2 svelte-fy2ox8" title="Add More RSI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add RSI</span></button></div></div>'),x$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Stochastic"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),w$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">%K Period</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="1" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">%D Period</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="1" max="50"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Overbought</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="50" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Oversold</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="50"></div></div> <div class="grid grid-cols-1 gap-2 sm:gap-3 svelte-fy2ox8"><div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Mid Level</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="100"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/70 svelte-fy2ox8">%K Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change %K Line Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option><option class="svelte-fy2ox8">4</option><option class="svelte-fy2ox8">5</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/70 svelte-fy2ox8">%D Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change %D Line Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option><option class="svelte-fy2ox8">4</option><option class="svelte-fy2ox8">5</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 border-t border-base-200 pt-2 svelte-fy2ox8"><span class="text-xs text-base-content/70 font-medium svelte-fy2ox8">Level Colors</span> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Overbought</span> <button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Overbought Color"></button></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Oversold</span> <button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Oversold Color"></button></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Mid Line</span> <button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Mid Line Color"></button></div></div></div>'),k$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 sm:gap-2 svelte-fy2ox8" title="Add More Stochastic"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add Stochastic</span></button></div></div>'),S$=(o,e,t)=>e(n(t).id),C$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove DMI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),P$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">DI Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ADX Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">DI+:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">DI-:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">ADX:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),I$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More DMI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add DMI</span></button></div></div>'),M$=(o,e,t)=>e(n(t).id),T$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Williams %R"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),A$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Overbought</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="-50" max="0"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Middle Level</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="-70" max="-30"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Oversold</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="-100" max="-50"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">WR Line:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 border-b border-base-200 pb-1 svelte-fy2ox8">Level Lines</div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 font-medium svelte-fy2ox8">Overbought:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 font-medium svelte-fy2ox8">Middle:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 font-medium svelte-fy2ox8">Oversold:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),L$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More Williams %R"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add Williams %R</span></button></div></div>'),z$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove VR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),F$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Short Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 sm:col-span-1 col-span-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Long Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/70 svelte-fy2ox8">VR Main Line</div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/70 svelte-fy2ox8">VR Short Line</div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/70 svelte-fy2ox8">VR Long Line</div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),$$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More VR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add More VR</span></button></div></div>'),D$=(o,e,t)=>e(n(t).id),E$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove BBI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),N$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 1</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 2</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 3</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 4</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),j$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More BBI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add BBI</span></button></div></div>'),R$=(o,e,t)=>e(n(t).id),B$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove EMV"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),O$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 1</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 2</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),V$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More EMV"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add EMV</span></button></div></div>'),W$=(o,e,t)=>e(n(t).id),q$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove MTM"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),H$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="grid grid-cols-1 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),G$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More MTM"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add MTM</span></button></div></div>'),U$=(o,e,t)=>e(n(t).id),Y$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove this AO"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Short Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Long Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="border-t border-base-300 pt-2 mt-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 mb-2 block svelte-fy2ox8">Histogram Colors</label> <div class="grid grid-cols-1 gap-2 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Increasing Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Decreasing Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div></div></div>'),K$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More Awesome Oscillator"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add More AO</span></button></div></div>'),Z$=(o,e,t)=>e(n(t).id),X$=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove CR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),J$=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">CR Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA1 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA2 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA3 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA4 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">CR:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA1:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA2:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA3:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA4:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),Q$=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More CR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add CR</span></button></div></div>'),eD=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Deviation %</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="50" step="0.1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Depth</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="50"></div></div> <div class="border-t border-base-300 pt-2 mt-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 mb-2 block svelte-fy2ox8">ZigZag Line Style</label> <div class="space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Line Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Line Thickness</span> <select class="select select-bordered select-xs w-20 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Line Style</span> <select class="select select-bordered select-xs w-24 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),tD=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more ZigZag"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More ZigZag</button></div></div>'),oD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Delete this PVT instance">✕</button>'),sD=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-20 sm:w-24 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),nD=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-sm btn-primary svelte-fy2ox8">➕ Add More PVT</button></div></div>'),iD=(o,e,t)=>e(n(t).id),rD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove SAR Group"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),aD=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Start</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.001" max="0.1" step="0.001"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Increment</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.001" max="0.1" step="0.001"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max value</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="1.0" step="0.01"></div></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Dot size:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div></div></div>'),lD=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-sm btn-primary svelte-fy2ox8">➕ Add More SAR</button></div></div>'),cD=(o,e,t)=>e(n(t).id),dD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Smart Trend Group"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),uD=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="100" step="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Multiplier</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="10" step="0.1"></div></div> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="checkbox" class="checkbox checkbox-sm svelte-fy2ox8"> <label class="text-xs text-base-content/60 svelte-fy2ox8">Show Labels</label></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 svelte-fy2ox8">Uptrend Line</div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-20 sm:w-24 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 svelte-fy2ox8">Downtrend Line</div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-20 sm:w-24 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div></div>'),pD=re('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary svelte-fy2ox8" title="Add more Smart Trend"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add Smart Trend</button></div></div>'),vD=(o,e)=>e(),fD=re('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete EMA parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),mD=re('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),gD=(o,e)=>e(),hD=(o,e)=>e(),_D=re('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div>'),yD=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-20 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <!></div>'),bD=re('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more EMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add EMA</button></div>'),xD=re('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),wD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Delete this SMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),kD=re('<div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="flex flex-col gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/70 font-medium svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-sm svelte-fy2ox8" min="1" max="500"></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Color</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Line Thickness</label> <select class="select select-bordered select-xs w-20 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Line Style</label> <select class="select select-bordered select-xs w-24 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),SD=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more SMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add SMA</button></div></div>'),CD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Volume"><span class="text-xs svelte-fy2ox8">×</span></button>'),PD=re('<div class="w-6 svelte-fy2ox8"></div>'),ID=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs svelte-fy2ox8" min="1" max="200"></div></div> <div class="space-y-2 svelte-fy2ox8"><h4 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Volume Histogram</h4> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Up Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Down Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div> <div class="space-y-2 svelte-fy2ox8"><h4 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">EMA Line</h4> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="checkbox" class="checkbox checkbox-sm svelte-fy2ox8"> <label class="text-xs text-base-content/60 svelte-fy2ox8">Show EMA with Volume</label></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),MD=re('<div class="space-y-3 mt-3 svelte-fy2ox8"></div>'),TD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove TRIX"><span class="text-xs svelte-fy2ox8">×</span></button>'),AD=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">TRIX:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">Signal:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">TRIX Line:</span> <div class="w-3 h-2 rounded svelte-fy2ox8"></div></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <input type="color" class="w-8 h-6 rounded border border-base-300 cursor-pointer svelte-fy2ox8"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-12 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Signal Line:</span> <div class="w-3 h-2 rounded svelte-fy2ox8"></div></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <input type="color" class="w-8 h-6 rounded border border-base-300 cursor-pointer svelte-fy2ox8"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-12 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),LD=(o,e)=>e(),zD=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add More TRIX"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More TRIX</button></div></div>'),FD=(o,e,t)=>e(n(t).id),$D=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove BIAS"><span class="text-xs svelte-fy2ox8">×</span></button>'),DD=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">Period:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-wrap items-center gap-2 sm:gap-3 text-xs svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Color:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Width:</span> <select class="select select-bordered select-xs w-12 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option></select></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-14 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div></div>'),ED=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More BIAS"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add BIAS</span></button></div></div>'),ND=(o,e,t)=>e(n(t).id),jD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove CCI"><span class="text-xs svelte-fy2ox8">×</span></button>'),RD=re('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">Period:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-wrap items-center gap-2 sm:gap-3 text-xs svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Color:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Width:</span> <select class="select select-bordered select-xs w-12 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option></select></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-14 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div></div>'),BD=re('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More CCI"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add CCI</span></button></div></div>'),OD=re('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Ichimoku"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),VD=re('<div class="grid grid-cols-1 sm:grid-cols-[1.4fr_0.8fr_0.8fr_0.8fr_0.9fr] gap-3 items-center px-1 py-2 border-b border-base-200 last:border-b-0 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><div class="w-4 h-4 rounded-full border border-base-300 svelte-fy2ox8"></div> <span class="text-sm font-medium text-base-content svelte-fy2ox8"> </span></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Period</span> <input type="number" class="input input-bordered input-sm w-24 text-center svelte-fy2ox8" min="1" max="200"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Color</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-5 h-5 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Thickness</span> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Style</span> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div>'),WD=re('<div class="space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-sm sm:text-base font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="hidden sm:grid grid-cols-[1.4fr_0.8fr_0.8fr_0.8fr_0.9fr] gap-3 text-xs text-base-content/60 px-1 svelte-fy2ox8"><div class="svelte-fy2ox8">Component</div> <div class="svelte-fy2ox8">Period</div> <div class="svelte-fy2ox8">Color</div> <div class="svelte-fy2ox8">Thickness</div> <div class="svelte-fy2ox8">Style</div></div> <!></div>'),qD=re('<div class="mt-3 sm:mt-5 svelte-fy2ox8"><div class="border border-base-300 rounded-lg p-4 bg-base-50/50 svelte-fy2ox8"><div class="flex items-center gap-3 mb-6 pb-4 border-b border-base-200 svelte-fy2ox8"><div class="w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center svelte-fy2ox8"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" class="svelte-fy2ox8"></path></svg></div> <div class="svelte-fy2ox8"><h3 class="text-lg font-semibold text-base-content svelte-fy2ox8">Ichimoku Kinko Hyo</h3> <p class="text-sm text-base-content/60 svelte-fy2ox8">Complete cloud indicator with all components</p></div></div> <div class="space-y-6 svelte-fy2ox8"></div> <div class="flex justify-center pt-4 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add Ichimoku"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add Ichimoku</span></button></div> <div class="mt-6 pt-4 border-t border-base-200 svelte-fy2ox8"><div class="text-xs text-base-content/60 space-y-1 svelte-fy2ox8"><p class="svelte-fy2ox8"><strong class="svelte-fy2ox8">Components:</strong> Tenkan Sen (Conversion), Kijun Sen (Base), Senkou Span A & B (Cloud)</p> <p class="svelte-fy2ox8"><strong class="svelte-fy2ox8">Usage:</strong> Trend direction, support/resistance levels, and momentum analysis</p></div></div></div></div>'),HD=re('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete SMA parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),GD=re('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),UD=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-20 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),YD=re('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more SMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add SMA</button></div>'),KD=re('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),ZD=(o,e)=>e(),XD=re('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete MA parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),JD=re('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),QD=(o,e)=>e(),eE=(o,e)=>e(),tE=re('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div>'),oE=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-20 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <!></div>'),sE=re('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more MA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add MA</button></div>'),nE=re('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),iE=(o,e,t)=>e(n(t).id),rE=re('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove ROC"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),aE=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Period</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),lE=re('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more ROC"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More ROC</button></div></div>'),cE=(o,e,t)=>e(n(t).id),dE=re('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove PSY"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),uE=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Param 1 (PSY Period)</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">PSY Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Param 2 (MAPSY Period)</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">MAPSY Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex items-center gap-2 pt-2 svelte-fy2ox8"><input type="checkbox" class="checkbox checkbox-primary checkbox-sm svelte-fy2ox8"> <label class="text-sm text-base-content/80 cursor-pointer svelte-fy2ox8">Show MAPSY</label></div></div></div>'),pE=re('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more PSY"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More PSY</button></div></div>'),vE=(o,e,t)=>e(n(t).id),fE=re('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove OBV"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),mE=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-2 svelte-fy2ox8" style="display: none;"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Param 1 (OBV Period)</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">OBV Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">MAOBV Period</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"> <span class="text-xs text-base-content/50 svelte-fy2ox8">Moving average period for OBV smoothing</span></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">MAOBV Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div></div>'),gE=re('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more OBV"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More OBV</button></div></div>'),hE=(o,e,t)=>e(n(t).id),_E=re('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove KDJ"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),yE=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">K Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">D Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">K Line Style</span> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">K:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">D Line Style</span> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">D:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">J Line Style</span> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">J:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),bE=re('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more KDJ"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More KDJ</button></div></div>'),xE=(o,e)=>e("band"),wE=(o,e)=>e("slLong"),kE=(o,e)=>e("slShort"),SE=(o,e)=>e("median"),CE=re('<div class="space-y-4 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Outcome Band</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Show Band:</label> <input type="checkbox" class="toggle toggle-xs svelte-fy2ox8"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Fill Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Opacity</label> <span class="text-xs font-medium text-primary svelte-fy2ox8"> </span></div> <input type="range" class="range range-primary range-xs svelte-fy2ox8" min="0" max="100" step="1"></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Stop Lines</h4> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Show Stops:</label> <input type="checkbox" class="toggle toggle-xs svelte-fy2ox8"></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Long SL Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Short SL Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Long Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Long Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Short Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Short Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Median Path</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">EV Table</h4> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Show Table:</label> <input type="checkbox" class="toggle toggle-xs svelte-fy2ox8"></div></div></div>'),PE=(o,e)=>e("fill",0),IE=(o,e)=>e("upper",0),ME=(o,e)=>e("middle",0),TE=(o,e)=>e("lower",0),AE=(o,e)=>e(0),LE=re('<button class="btn btn-xs btn-outline btn-error gap-1 text-xs svelte-fy2ox8" title="Remove BOLL 1"><svg class="w-3 h-3 svelte-fy2ox8" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg> Remove BOLL 1</button>'),zE=(o,e,t)=>e(n(t)),FE=(o,e,t)=>e("fill",n(t)),$E=(o,e,t)=>e("upper",n(t)),DE=(o,e,t)=>e("middle",n(t)),EE=(o,e,t)=>e("lower",n(t)),NE=re('<div class="bg-base-50 border border-primary/20 rounded-md p-3 space-y-3 mt-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-semibold text-primary svelte-fy2ox8"> </h4> <button class="btn btn-xs btn-ghost text-error svelte-fy2ox8"><svg class="w-3.5 h-3.5 svelte-fy2ox8" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="200"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Standard Deviation</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="10" step="0.1"></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h5 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Fill Area</h5> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Fill Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Opacity</label> <span class="text-xs font-medium text-primary svelte-fy2ox8"> </span></div> <input type="range" class="range range-primary range-xs svelte-fy2ox8" min="0" max="100" step="1"></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h5 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Line Colors</h5> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Upper Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Middle Line (SMA)</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Lower Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h5 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Line Style</h5> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),jE=re('<div class="space-y-4 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Parameters</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="200"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Standard Deviation</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="10" step="0.1"></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Fill Area Settings</h4> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Fill Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Opacity</label> <span class="text-xs font-medium text-primary svelte-fy2ox8"> </span></div> <input type="range" class="range range-primary range-xs svelte-fy2ox8" min="0" max="100" step="1"> <div class="flex justify-between text-xs text-base-content/50 svelte-fy2ox8"><span class="svelte-fy2ox8">0%</span> <span class="svelte-fy2ox8">50%</span> <span class="svelte-fy2ox8">100%</span></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Line Colors</h4> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Upper Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Middle Line (SMA)</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Lower Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Line Style</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex justify-center gap-2 pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more BOLL"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More BOLL</button> <!></div> <!></div>'),RE=re('<div class="flex justify-center items-center min-h-[120px] svelte-fy2ox8"><div class="text-base-content/70 svelte-fy2ox8"> </div></div>'),BE=re('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),OE=re('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),VE=re('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-16 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),WE=re('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg></button></div>'),qE=re('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),HE=re('<div class="ai-branding-container svelte-fy2ox8"><div class="ai-branding-badge svelte-fy2ox8"><svg class="ai-branding-icon svelte-fy2ox8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-fy2ox8"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-fy2ox8"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-fy2ox8"></line></svg> <div class="ai-branding-text svelte-fy2ox8"><div class="ai-branding-main svelte-fy2ox8">Duty AI Algorithm Included</div> <div class="ai-branding-sub svelte-fy2ox8">Powered by Duty AI</div></div> <div class="ai-branding-glow svelte-fy2ox8"></div></div></div>'),GE=re('<div class="responsive-modal-content svelte-fy2ox8"><!> <!></div>'),UE=re("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function YE(o,e){Mc(e,!0);const t=Au(),s=()=>ua(d,"$chart",t),i=()=>ua(l,"$ctx",t),r=()=>ua(c,"$save",t);let a=Qs(e,"show",15);const l=vc("ctx"),c=vc("save"),d=vc("chart");let v=D([]),g=D([]),_=D([]);function y(b){const w=(b||"").trim();if(!w)return null;if(/^#?[0-9A-Fa-f]{6}$/.test(w)){const A=w.startsWith("#")?w.slice(1):w;return{r:parseInt(A.slice(0,2),16),g:parseInt(A.slice(2,4),16),b:parseInt(A.slice(4,6),16)}}const L=w.match(/^rgba?\(([^)]+)\)$/i);if(L){const A=L[1].split(",").map(E=>parseFloat(E.trim()));if(A.length>=3&&A.every(E=>!isNaN(E)))return{r:Math.round(A[0]),g:Math.round(A[1]),b:Math.round(A[2])}}return null}function k(b,w){const L=y(b);if(!L)return b;const A=Math.max(0,Math.min(100,w))/100;return`rgba(${L.r}, ${L.g}, ${L.b}, ${A})`}let S=ee("#2196F3"),M=ee(5),I=ee("#f23645"),C=ee("#2962ff"),T=ee("#089981"),z=ee(1),j=ee("solid"),B=ee(20),$=ee(2),F=ee(!1),V=ee(D({x:0,y:0})),K=ee(0),Y=ee("macdLine"),Z=ee(!1),ne=ee(D({x:0,y:0})),te=ee(0),oe=ee(!1),U=ee(D({x:0,y:0})),J=ee(0),se=ee("diPlus"),W=ee(!1),le=ee(D({x:0,y:0})),ye=ee(!1),Ce=ee(D({x:0,y:0})),Re=ee(!1),Ke=ee(D({x:0,y:0})),st=ee(0),vt=ee(!1),Je=ee(D({x:0,y:0})),ot=ee(0),nt=ee(!1),tt=ee(D({x:0,y:0})),Ze=ee(D([])),ct=ee(!1),Ge=ee(D({x:0,y:0})),pt=ee(0),ce=ee("histogram"),we=ee(!1),ze=ee(D({x:0,y:0})),dt=ee(!1),qe=ee(D({x:0,y:0})),me=ee(!1),Q=ee(D({x:0,y:0})),it=ee(!1),Vt=ee(D({x:0,y:0})),wt=ee(0),Yt=ee(!1),At=ee(D({x:0,y:0})),Gt=ee(0),no=ee("vr"),Do=ee(!1),Eo=ee(D({x:0,y:0})),bs=ee(0),Is=ee(!1),qi=ee(D({x:0,y:0})),Ks=ee(0),ws=ee(!1),vn=ee(D({x:0,y:0})),es=ee(0),Li=ee(!1),ci=ee(D({x:0,y:0})),oa=ee(!1),ol=ee(D({x:0,y:0})),Xi=ee(0),fc=ee(!1),rd=ee(D({x:0,y:0})),ml=ee(0),Jl=ee(!1),Wl=D({x:0,y:0}),sl=ee(0),Uc=ee("uptrend"),Nl=ee(!1),Yc=ee(D({x:0,y:0})),Ec=ee(0),Ja=ee(!1),sa=ee(D({x:0,y:0})),jl=ee(!1),Td=ee(D({x:0,y:0})),_d=ee(!1),Fl=ee(D({x:0,y:0})),qa=ee(0),td=ee(!1),Nc=ee(D({x:0,y:0})),be=ee(0),We=ee("cr"),de=ee(!1),De=ee(D({x:0,y:0})),Ee=ee(!1),xe=ee(D({x:0,y:0})),gt=ee(!1),at=ee(D({x:0,y:0})),jt=ee(0),Lt=ee(!1),Mt=ee(D({x:0,y:0})),Io=ee(!1),Bo=ee(D({x:0,y:0})),hs=ee(!1),is=D({x:0,y:0}),Es=ee(!1),bt=D({x:0,y:0}),kt=ee(!1),xo=ee(D({x:0,y:0})),$t=ee(!1),_o=ee(D({x:0,y:0})),go=ee(!1),fs=ee(D({x:0,y:0})),Ms=ee(!1),zn=ee(D({x:0,y:0})),qs=ee(!1),Vn=ee(D({x:0,y:0})),Ss=ee(!1),di=ee(D({x:0,y:0})),Mn=ee(!1),La=ee(D({x:0,y:0})),nn=ee(!1),tr=ee(D({x:0,y:0})),Ur=ee(!1),cl=ee(D({x:0,y:0})),ui=ee(1),Yr=ee("solid"),Ra=ee(1),ga=ee("dashed"),na=ee(1),nl=ee("dashed"),mi=ee(22),Ha=ee("#66c2a5"),lr=ee("#66c2a5"),zi=ee("#e67e22"),hr=ee("#c0392b"),xa=ee(!0),Qa=ee(!0),ue=ee(!0),Fe=ee(!1),ut=ee(D({x:0,y:0})),Xe=ee(0),ht=ee(!1),ao=ee(D({x:0,y:0})),It=ee(0),eo=ee(0),Mo=ee(0),ho=ee(!1),to=ee(D({x:0,y:0})),ds=ee(0),js=ee(!1),Si=ee(D({x:0,y:0})),$r=ee(0),pa=ee(!1),En=ee(D({x:0,y:0})),za=ee(0),Rs=ee(!1),Zs=ee(!1),gn=ee(!1),Wn=ee(!1),Tn=ee(!1),Ko=ee(D({x:0,y:0})),Qt=ee(0);function H(b,w){if(s()){try{s().removeIndicator({paneId:b,name:w})}catch(L){console.log("Error removing indicator:",L)}c.update(L=>{const A=`${b}_${w}`;return delete L.saveInds[A],L})}}const Me=Qe(()=>i().editIndName==="BOLL"),Ue=Qe(()=>i().editIndName==="MACD"),yt=Qe(()=>i().editIndName==="BIAS"),St=Qe(()=>i().editIndName==="AO"),lo=Qe(()=>i().editIndName==="WR"),he=Qe(()=>i().editIndName==="VR"),ke=Qe(()=>i().editIndName==="BBI"),Ne=Qe(()=>i().editIndName==="EMA"),ie=Qe(()=>i().editIndName==="SMA"),Ct=Qe(()=>i().editIndName==="MA"),Kt=Qe(()=>i().editIndName==="ICHIMOKU"),fo=Qe(()=>i().editIndName==="PVT"),mo=Qe(()=>i().editIndName==="VOL"),Go=Qe(()=>i().editIndName==="SAR"),Fo=Qe(()=>i().editIndName==="DMI"),Wo=Qe(()=>i().editIndName==="TRIX"),us=Qe(()=>i().editIndName==="ROC"),Un=Qe(()=>i().editIndName==="ZIGZAG"),or=Qe(()=>i().editIndName==="PSY"),$s=Qe(()=>i().editIndName==="OBV"),gi=Qe(()=>i().editIndName==="CR"),kn=Qe(()=>i().editIndName==="NPO_MAE"),_r=Qe(()=>i().editIndName==="KDJ"),Kr=Qe(()=>i().editIndName==="CCI"),Ul=Qe(()=>i().editIndName==="EMV"),wa=Qe(()=>i().editIndName==="MTM"),wl=Qe(()=>i().editIndName==="RSI"),Cl=Qe(()=>i().editIndName==="STOCH"),dl=Qe(()=>i().editIndName==="SMARTTREND"),cr=Qe(()=>i().editIndName==="SMART_MONEY"),Br=Qe(()=>i().editIndName==="TRAP_HUNTER"),Fi=Qe(()=>i().editIndName==="VOLCANIC"),fr=Qe(()=>i().editIndName==="VOLCANIC_SIG"),gl=Qe(()=>n(cr)||n(Br)||n(Fi)||n(fr));function Gs(){if(!(i().editIndName!=="TRAP_HUNTER"||!s()))try{const b=(v||[]).map(w=>Number(w));s().overrideIndicator({name:"TRAP_HUNTER",calcParams:b,paneId:i().editPaneId})}catch(b){console.error("❌ Error updating Trap Hunter:",b)}}function Ql(){if(!(i().editIndName!=="VOLCANIC"||!s()))try{const b=(v||[]).map(w=>Number(w));s().overrideIndicator({name:"VOLCANIC",calcParams:b,paneId:i().editPaneId})}catch(b){console.error("❌ Error updating VOLCANIC:",b)}}function ia(){if(!(i().editIndName!=="VOLCANIC_SIG"||!s()))try{const b=(v||[]).map(w=>Number(w));s().overrideIndicator({name:"VOLCANIC_SIG",calcParams:b,paneId:i().editPaneId})}catch(b){console.error("❌ Error updating VOLCANIC_SIG:",b)}}let jd=ee("");zr(()=>{if(!n(Fi))return;const b=JSON.stringify(v??[]);b!==n(jd)&&(x(jd,D(b)),Ql())});let xu=ee("");zr(()=>{if(!n(fr))return;const b=JSON.stringify(v??[]);b!==n(xu)&&(x(xu,D(b)),ia())});const ip=Qe(()=>i().editIndName==="SMARTTREND"?"Smart Trend":i().editIndName);let $p=ee("#2962FF"),Wp=ee(2),Yu=ee("solid"),Lu=ee(26),Cp=ee(10),Sv=ee(20),rp=ee(40),jf=ee(60),Ws=D({zoneLookbackBars:40,minZoneBars:5,maxZoneBars:25,atrPeriod:14,volumeMAPeriod:20,minVolumeFactor:1.2,maxZoneWidthPct:.03,priorTrendLookback:20,minOBVTrendStrength:.2,minZoneScore:.6,mergeNearbyZones:!0,maxZonesDisplayed:20,showLabels:!0});function Cv(){if(!n(cr)||!Array.isArray(v))return;const b=v;Ws.zoneLookbackBars=Number(b[0]??Ws.zoneLookbackBars),Ws.minZoneBars=Number(b[1]??Ws.minZoneBars),Ws.maxZoneBars=Number(b[2]??Ws.maxZoneBars),Ws.atrPeriod=Number(b[3]??Ws.atrPeriod),Ws.volumeMAPeriod=Number(b[4]??Ws.volumeMAPeriod),Ws.minVolumeFactor=Number(b[5]??Ws.minVolumeFactor),Ws.maxZoneWidthPct=Number(b[6]??Ws.maxZoneWidthPct),Ws.priorTrendLookback=Number(b[7]??Ws.priorTrendLookback),Ws.minOBVTrendStrength=Number(b[8]??Ws.minOBVTrendStrength),Ws.minZoneScore=Number(b[9]??Ws.minZoneScore),Ws.mergeNearbyZones=Number(b[10]??(Ws.mergeNearbyZones?1:0))>0,Ws.maxZonesDisplayed=Number(b[11]??Ws.maxZonesDisplayed),Ws.showLabels=Number(b[12]??(Ws.showLabels?1:0))>0}zr(()=>{n(cr)&&Cv()});function af(){var w;const b=[Ws.zoneLookbackBars,Ws.minZoneBars,Ws.maxZoneBars,Ws.atrPeriod,Ws.volumeMAPeriod,Ws.minVolumeFactor,Ws.maxZoneWidthPct,Ws.priorTrendLookback,Ws.minOBVTrendStrength,Ws.minZoneScore,Ws.mergeNearbyZones?1:0,Ws.maxZonesDisplayed,Ws.showLabels?1:0];(w=s())==null||w.overrideIndicator({name:"SMART_MONEY",calcParams:b,paneId:i().editPaneId}),c.update(L=>(L.saveInds[`${i().editPaneId}_SMART_MONEY`]={name:"SMART_MONEY",params:b,pane_id:i().editPaneId},L))}let Pp=ee("#FF6B35"),Ip=ee("#2196F3"),Rf=ee("#4CAF50"),lf=ee("#FF9800"),pe=ee("#9C27B0"),Pe=ee(2),Ht=ee(1),vo=ee(1),as=ee(1),po=ee(1),Bs=ee("solid"),xs=ee("solid"),en=ee("solid"),Sn=ee("solid"),lt=ee("solid");zr(()=>{n(us)&&!n(tn)?(console.log("🎯 ROC modal opened, initializing..."),x(tn,!0),Kl(),setTimeout(()=>{Sl()},100)):!n(us)&&n(tn)&&x(tn,!1)});let Zt=ee(!1),qt=ee(!1);zr(()=>{n(wl)&&!n(Zt)?(console.log("🎯 RSI modal opened, initializing..."),x(Zt,!0),mc()):!n(wl)&&n(Zt)&&x(Zt,!1)}),zr(()=>{n(Cl)&&!n(qt)?(console.log("🎯 Stochastic modal opened, initializing..."),x(qt,!0),ul()):!n(Cl)&&n(qt)&&x(qt,!1)}),zr(()=>{n(Wo)&&!n(Hi)?(console.log("🎯 TRIX modal opened, initializing..."),x(Hi,!0),Nn()):!n(Wo)&&n(Hi)&&x(Hi,!1)});let Lo=ee(!1);zr(()=>{n(ie)&&!n(Lo)?(console.log("🎯 SMA modal opened, initializing..."),x(Lo,!0),uu()):!n(ie)&&n(Lo)&&x(Lo,!1)});let ks=ee(!1);zr(()=>{n(he)&&!n(ks)?(console.log("🎯 VR modal opened, initializing..."),x(ks,!0),Sa()):!n(he)&&n(ks)&&x(ks,!1)});let yr=ee(!1);zr(()=>{n(mo)&&!n(yr)?(console.log("🎯 Volume modal opened, initializing..."),x(yr,!0),Ml()):!n(mo)&&n(yr)&&x(yr,!1)});let N=ee(!1);zr(()=>{n(ke)&&!n(N)?(console.log("🎯 BBI modal opened, initializing..."),x(N,!0),hu()):!n(ke)&&n(N)&&x(N,!1)}),zr(()=>{n(ke)&&n(N)&&s()&&n(xt).forEach((b,w)=>{const{period1:L,period2:A,period3:E,period4:R,color:G,thickness:_e,lineStyle:Be}=b;if(L&&A&&E&&R&&G&&_e&&Be){const _t=setTimeout(()=>{sd(w)},100);return()=>clearTimeout(_t)}})});let X=ee(!1);zr(()=>{n(Me)&&!n(X)?(console.log("🎯 Bollinger Bands modal opened, initializing..."),x(X,!0),Vv()):!n(Me)&&n(X)&&x(X,!1)}),zr(()=>{if(n(Me)&&n(X)&&s()){const b=n(B),w=n($),L=n(S),A=n(M),E=n(I),R=n(C),G=n(T),_e=n(z),Be=n(j);if(b&&w&&L&&E&&R&&G&&_e&&Be){const _t=setTimeout(()=>{n(Ot).length===0?x(Ot,D([{id:Jn(),paneId:i().editPaneId||"candle_pane",period:b,stdDev:w,styles:{fillColor:L,fillOpacity:A,upperColor:E,middleColor:R,lowerColor:G,thickness:_e,lineStyle:Be}}])):(n(Ot)[0].period=b,n(Ot)[0].stdDev=w,n(Ot)[0].styles.fillColor=L,n(Ot)[0].styles.fillOpacity=A,n(Ot)[0].styles.upperColor=E,n(Ot)[0].styles.middleColor=R,n(Ot)[0].styles.lowerColor=G,n(Ot)[0].styles.thickness=_e,n(Ot)[0].styles.lineStyle=Be),Co()},100);return()=>clearTimeout(_t)}}});let fe=ee(!1);zr(()=>{n(Go)&&!n(fe)?(console.log("🎯 SAR modal opened, initializing..."),x(fe,!0),br()):!n(Go)&&n(fe)&&x(fe,!1)}),zr(()=>{n(Go)&&n(fe)&&s()&&n(Rn).forEach((b,w)=>{const{start:L,increment:A,maxValue:E,color:R,dotSize:G}=b;if(L!==void 0&&A!==void 0&&E!==void 0&&R&&G){const _e=setTimeout(()=>{Xs(w)},100);return()=>clearTimeout(_e)}})});let Ae=ee(!1);zr(()=>{n(St)&&!n(Ae)?(console.log("🎯 AO modal opened, initializing..."),x(Ae,!0),cv()):!n(St)&&n(Ae)&&x(Ae,!1)}),zr(()=>{n(St)&&n(Ae)&&s()&&n(wo).forEach((b,w)=>{const{shortPeriod:L,longPeriod:A,styles:E}=b;if(L&&A&&E){const R=setTimeout(()=>{_p()},100);return()=>clearTimeout(R)}})});let Le=ee(!1);zr(()=>{n(yt)&&!n(Le)?(console.log("🎯 BIAS modal opened, initializing..."),x(Le,!0),cs()):!n(yt)&&n(Le)&&x(Le,!1)}),zr(()=>{n(yt)&&n(Le)&&s()&&n(jo).forEach((b,w)=>{const{period:L,color:A,thickness:E,lineStyle:R}=b;if(L&&A&&E&&R){const G=setTimeout(()=>{ur()},100);return()=>clearTimeout(G)}})});let ft=ee(!1);zr(()=>{n(wa)&&!n(ft)?(console.log("🎯 MTM modal opened, initializing..."),x(ft,!0),wu()):!n(wa)&&n(ft)&&x(ft,!1)}),zr(()=>{n(wa)&&n(ft)&&s()&&n(ri).forEach((b,w)=>{const{period:L,color:A,thickness:E,lineStyle:R}=b;if(L&&A&&E&&R){const G=setTimeout(()=>{Yl()},100);return()=>clearTimeout(G)}})});let Bt=ee(!1),Ft=ee(!1);zr(()=>{n($s)&&!n(Bt)?(console.log("🎯 OBV modal opened, initializing..."),x(Bt,!0),qc()):!n($s)&&n(Bt)&&x(Bt,!1)}),zr(()=>{if(n(Ft)){console.log("⏸️ Skipping OBV effect - removal in progress");return}n($s)&&n(Bt)&&s()&&n(_s).forEach((b,w)=>{const{obvPeriod:L,maobvPeriod:A,showMaobv:E,styles:R}=b;if(L&&A&&R){const G=setTimeout(()=>{Vd()},100);return()=>clearTimeout(G)}})});let zt=ee(!1);zr(()=>{n(Kr)&&!n(zt)?(console.log("🎯 CCI modal opened, initializing..."),x(zt,!0),Jo()):!n(Kr)&&n(zt)&&x(zt,!1)}),zr(()=>{n(Kr)&&n(zt)&&s()&&n(Ci).forEach((b,w)=>{const{period:L,color:A,thickness:E,lineStyle:R}=b;if(L&&A&&E&&R){const G=setTimeout(()=>{zs()},100);return()=>clearTimeout(G)}})});let io=ee(!1);zr(()=>{n(gi)&&!n(io)?(console.log("🎯 CR modal opened, initializing..."),x(io,!0),Ba()):!n(gi)&&n(io)&&x(io,!1)}),zr(()=>{n(gi)&&n(io)&&s()&&n(pi).forEach((b,w)=>{const{crPeriod:L,crMa1Period:A,crMa2Period:E,crMa3Period:R,crMa4Period:G,styles:_e}=b;if(L&&A&&E&&R&&G&&_e){const Be=setTimeout(()=>{qo()},100);return()=>clearTimeout(Be)}})});let Wt=ee(!1);zr(()=>{n(Fo)&&!n(Wt)?(console.log("🎯 DMI modal opened, initializing..."),x(Wt,!0),fa()):!n(Fo)&&n(Wt)&&x(Wt,!1)}),zr(()=>{n(Fo)&&n(Wt)&&s()&&n(Pn).forEach((b,w)=>{const{diPeriod:L,adxPeriod:A,styles:E}=b;if(L&&A&&E){const R=setTimeout(()=>{bn()},100);return()=>clearTimeout(R)}})}),zr(()=>{n(he)&&n(ks)&&s()&&n(Ut).forEach((b,w)=>{const{period:L,shortPeriod:A,longPeriod:E,styles:R}=b;if(L&&A&&E&&R){const G=setTimeout(()=>{Bd(w)},100);return()=>clearTimeout(G)}})}),zr(()=>{n(Ue)&&s()&&n(zo).length>0&&n(zo).forEach((b,w)=>{const{fastPeriod:L,slowPeriod:A,signalPeriod:E,styles:R}=b;if(L&&A&&E&&R){const G=setTimeout(()=>{kc(w)},100);return()=>clearTimeout(G)}})});let zo=ee(D([])),Et=ee(D([])),Ut=ee(D([])),wo=ee(D([])),xt=ee(D([])),Ot=ee(D([])),No=ee(0),ts=ee(D([])),Oo=ee(0);function Cn(b){x(Oo,D(b)),x(ci,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Li,!0)}function Cs(){if(!s())return;const b=i().editPaneId||"candle_pane";for(let w=0;w<6;(w+=1)-1)try{s().removeIndicator({paneId:b,name:"ZIGZAG"})}catch{}n(ts).forEach((w,L)=>{const A=w.styles.lineStyle==="solid"?Oe.Solid:Oe.Dashed,E=w.styles.lineStyle==="dashed"?[4,4]:w.styles.lineStyle==="dotted"?[2,6]:[2,2],R={lines:[{color:w.styles.color,size:w.styles.thickness,style:A,dashedValue:E,smooth:!1}]};s().createIndicator({name:"ZIGZAG",calcParams:[w.deviation,w.depth],styles:R},!0,{id:b});const G=L===0?`${b}_ZIGZAG`:`${b}_ZIGZAG_${L+1}`;c.update(_e=>(_e.saveInds[G]={name:"ZIGZAG",pane_id:b,params:[w.deviation,w.depth],styles:R},_e))}),c.update(w=>{const L=`${b}_ZIGZAG`;return Object.keys(w.saveInds).filter(E=>E.startsWith(L)).forEach(E=>{const R=E.match(/_ZIGZAG(?:_(\d+))?$/);(R&&R[1]?parseInt(R[1],10):1)>n(ts).length&&delete w.saveInds[E]}),w})}function rn(b,w){x(No,D(w));const L={x:window.innerWidth/2,y:window.innerHeight/2};b==="fill"&&(x(_o,D(L)),x($t,!0)),b==="upper"&&(x(fs,D(L)),x(go,!0)),b==="middle"&&(x(zn,D(L)),x(Ms,!0)),b==="lower"&&(x(Vn,D(L)),x(qs,!0))}function ko(){return window.__npoMaeApi}function Xo(b){const w={x:window.innerWidth/2,y:window.innerHeight/2};b==="median"&&(x(di,D(w)),x(Ss,!0)),b==="band"&&(x(La,D(w)),x(Mn,!0)),b==="slLong"&&(x(tr,D(w)),x(nn,!0)),b==="slShort"&&(x(cl,D(w)),x(Ur,!0))}function Ro(){const b=ko();if(!b)return;b.updateSettings({bandAlpha:Math.max(0,Math.min(100,n(mi)))/100});const w=k(n(Ha),n(mi));b.setColors({band:w})}let To=ee(!1);zr(()=>{var b,w;if(!(!n(kn)||n(To)||!s()))try{const A=(((w=(b=s()).getOverlays)==null?void 0:w.call(b))??[]).find(_e=>(_e==null?void 0:_e.name)==="NearestPatternOutcomeMaeStop"),E=(A==null?void 0:A.extendData)||{},R=E.colors||{};R.median&&x(lr,D(R.median)),R.band&&x(Ha,D(R.band)),R.slLong&&x(zi,D(R.slLong)),R.slShort&&x(hr,D(R.slShort)),typeof E.showOutcomeBand=="boolean"&&x(xa,D(E.showOutcomeBand)),typeof E.showStopLines=="boolean"&&x(Qa,D(E.showStopLines)),typeof E.showTable=="boolean"&&x(ue,D(E.showTable));const G=E.styles||{};G.median&&(typeof G.median.size=="number"&&x(ui,D(G.median.size)),typeof G.median.style=="string"&&x(Yr,D(G.median.style))),G.slLong&&(typeof G.slLong.size=="number"&&x(Ra,D(G.slLong.size)),typeof G.slLong.style=="string"&&x(ga,D(G.slLong.style))),G.slShort&&(typeof G.slShort.size=="number"&&x(na,D(G.slShort.size)),typeof G.slShort.style=="string"&&x(nl,D(G.slShort.style))),typeof E.bandAlpha=="number"&&x(mi,D(Math.round((E.bandAlpha||0)*100))),x(To,!0)}catch{}});function Co(){if(!s())return;const b=i().editPaneId||"candle_pane";for(let w=0;w<6;(w+=1)-1)try{s().removeIndicator({paneId:b,name:"BOLL"})}catch{}n(Ot).forEach((w,L)=>{const A=w.styles.lineStyle==="solid"?Oe.Solid:Oe.Dashed,E=w.styles.lineStyle==="dashed"?[4,4]:[0,0],R={lines:[{color:w.styles.upperColor,size:w.styles.thickness,style:A,dashedValue:E},{color:w.styles.middleColor,size:w.styles.thickness,style:A,dashedValue:E},{color:w.styles.lowerColor,size:w.styles.thickness,style:A,dashedValue:E}],fill:{color:w.styles.fillColor,opacity:(w.styles.fillOpacity||0)/100}};s().createIndicator({name:"BOLL",calcParams:[w.period,w.stdDev],styles:R},!0,{id:b});const G=L===0?`${b}_BOLL`:`${b}_BOLL_${L+1}`;c.update(_e=>(_e.saveInds[G]={name:"BOLL",pane_id:b,params:[w.period,w.stdDev],bollingerStyles:{fillColor:w.styles.fillColor,fillOpacity:w.styles.fillOpacity,upperColor:w.styles.upperColor,middleColor:w.styles.middleColor,lowerColor:w.styles.lowerColor,thickness:w.styles.thickness,lineStyle:w.styles.lineStyle}},_e))}),c.update(w=>{const L=`${b}_BOLL`;return Object.keys(w.saveInds).filter(E=>E.startsWith(L)).forEach(E=>{const R=E.match(/_BOLL(?:_(\d+))?$/);(R&&R[1]?parseInt(R[1],10):1)>n(Ot).length&&delete w.saveInds[E]}),w})}function Hs(b){if(n(Ot).length<=1)return;x(Ot,D(n(Ot).filter((L,A)=>A!==b)));const w=n(Ot)[0];w&&(x(B,D(w.period)),x($,D(w.stdDev)),x(S,D(w.styles.fillColor)),x(M,D(w.styles.fillOpacity)),x(I,D(w.styles.upperColor)),x(C,D(w.styles.middleColor)),x(T,D(w.styles.lowerColor)),x(z,D(w.styles.thickness)),x(j,D(w.styles.lineStyle))),Co()}let jo=ee(D([])),ls=ee(D([])),Rn=ee(D([])),Os=ee(D([])),Pn=ee(D([])),Oi=ee(D([])),pi=ee(D([])),an=ee(D([])),tn=ee(!1),Hi=ee(!1),ps=ee(D([])),_s=ee(D([])),fn=ee(D([])),Ci=ee(D([]));function dr(){x(Ci,D([])),console.log("✅ CCI groups cleared from modal state")}let vi=ee(D([]));function Fa(){x(vi,D([])),console.log("✅ EMV groups cleared from modal state")}let ri=ee(D([]));function ka(){x(ri,D([])),console.log("✅ MTM groups cleared from modal state")}function va(){x(_s,D([])),console.log("✅ OBV groups cleared from modal state")}function wc(){x(ps,D([])),console.log("✅ PSY groups cleared from modal state")}let $i=ee(D([]));function mr(){x($i,D([])),console.log("✅ PVT groups cleared from modal state")}function ad(){x(Ze,D([])),console.log("✅ VOL groups cleared from modal state")}function Gd(){x(Et,D([])),console.log("✅ WR groups cleared from modal state")}function Kc(){if(!n(fo))return;const b=`${i().editPaneId}_PVT`,w=r().saveInds[b];w&&w.pvtGroups&&w.pvtGroups.length>0?x($i,D([...w.pvtGroups])):n($i).length===0&&x($i,D([{id:Jn(),name:"PVT #1",color:"#2563eb",thickness:1,lineStyle:"solid"}]))}function vd(){var w;if(!n(fo))return;const b={id:Jn(),name:`PVT #${n($i).length+1}`,color:"#2563eb",thickness:1,lineStyle:"solid"};if(n($i).push(b),s()){let L=Oe.Solid,A=[2,2];b.lineStyle==="dashed"?(L=Oe.Dashed,A=[4,4]):b.lineStyle==="dotted"&&(L=Oe.Dashed,A=[2,2]);const E={lines:[{color:b.color,size:b.thickness,style:L,dashedValue:A}]},R=(w=s())==null?void 0:w.createIndicator({name:"PVT",styles:E,figures:[{key:"pvt",title:"PVT: ",type:"line"}]},!1);console.log("✅ Created PVT indicator on pane:",R),R&&c.update(G=>{const _e=`${R}_PVT`;return G.saveInds[_e]||(G.saveInds[_e]={name:"PVT",pane_id:R,pvtGroups:[]}),G.saveInds[_e].pvtGroups||(G.saveInds[_e].pvtGroups=[]),G.saveInds[_e].pvtGroups.push({...b}),console.log("💾 Saved new PVT group to storage:",_e,b),G})}console.log("➕ Added new PVT group:",b.name,"ID:",b.id)}function $l(b){var L,A;if(!n(fo)||n($i).length<=1||b<0||b>=n($i).length)return;console.log("🗑️ Removing PVT group at index:",b);const w=n($i).length;if(n($i)[b],n($i).splice(b,1),console.log(`📝 Removed group: ${w} -> ${n($i).length}`),n($i).forEach((E,R)=>{E.name=`PVT #${R+1}`}),s())try{const R=((L=s())==null?void 0:L.getIndicators()).filter(G=>G.name==="PVT");console.log("📈 PVT indicators found:",R.length);for(const G of R)console.log("🗑️ Removing PVT from pane:",G.paneId),(A=s())==null||A.removeIndicator({paneId:G.paneId,name:"PVT"});n($i).forEach((G,_e)=>{var so;let Be=Oe.Solid,_t=[2,2];G.lineStyle==="dashed"?(Be=Oe.Dashed,_t=[4,4]):G.lineStyle==="dotted"&&(Be=Oe.Dashed,_t=[2,2]);const Yo={lines:[{color:G.color,size:G.thickness,style:Be,dashedValue:_t}]};console.log("➕ Re-adding PVT group:",G.name,"at index:",_e);const $o=(so=s())==null?void 0:so.createIndicator({name:"PVT",styles:Yo,figures:[{key:"pvt",title:"PVT: ",type:"line"}]},!1);$o&&c.update(cn=>{const _i=`${$o}_PVT`;return cn.saveInds[_i]||(cn.saveInds[_i]={name:"PVT",pane_id:$o,pvtGroups:[]}),cn.saveInds[_i].pvtGroups||(cn.saveInds[_i].pvtGroups=[]),cn.saveInds[_i].pvtGroups[_e]={...G},cn})}),console.log("✅ Successfully updated PVT indicators on chart")}catch(E){console.error("❌ Error updating PVT indicators:",E)}console.log("✅ PVT group removed. Remaining groups:",n($i).length)}function ha(){x(an,D([])),console.log("✅ ROC groups cleared from modal state")}let et=ee(D([]));function As(){x(et,D([])),console.log("✅ RSI groups cleared from modal state")}function yn(){const b=new Set,w=s();if(!(w!=null&&w.getIndicators))return b;try{w.getIndicators().forEach(A=>{(A==null?void 0:A.name)==="RSI"&&(A!=null&&A.paneId)&&b.add(A.paneId)})}catch(L){console.warn("⚠️ Failed to read RSI pane IDs from chart:",L)}return b}function ae(b,w){const L=yn();for(const A of L)if(!b.has(A))return A;return w}function Ns(b){const w="pane_RSI";if(!b.has(w))return w;let L=2;for(;b.has(`${w}_${L}`)&&L<1e3;)L+=1;if(!b.has(`${w}_${L}`))return`${w}_${L}`;let A=`${w}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;for(;b.has(A);)A=`${w}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;return A}function ra(b,w={}){return{...b,...w,styles:{...b.styles,rsi:{...b.styles.rsi}}}}function ki(b){var E,R,G;if(!b||b.name!=="RSI")return null;const w=Array.isArray(b.rsiGroups)&&b.rsiGroups.length>0?b.rsiGroups[0]:null;if(!w)return null;const L=w.actualPaneId||w.paneId||b.pane_id,A=w.styles||{};return{id:w.id||Jn(),period:w.period??(Array.isArray(b.params)?b.params[0]:14),overboughtLevel:w.overboughtLevel??70,middleLevel:w.middleLevel??50,oversoldLevel:w.oversoldLevel??30,fillOpacity:w.fillOpacity??.15,paneId:L||b.pane_id,actualPaneId:L||b.pane_id,styles:{rsi:{color:((E=A.rsi)==null?void 0:E.color)??"#8B5CF6",thickness:((R=A.rsi)==null?void 0:R.thickness)??2,lineStyle:((G=A.rsi)==null?void 0:G.lineStyle)??"solid"},overboughtColor:A.overboughtColor??"#EF4444",overboughtThickness:A.overboughtThickness??1,overboughtLineStyle:A.overboughtLineStyle??"dashed",oversoldColor:A.oversoldColor??"#22C55E",oversoldThickness:A.oversoldThickness??1,oversoldLineStyle:A.oversoldLineStyle??"dashed",middleLineColor:A.middleLineColor??"#6B7280",middleLineThickness:A.middleLineThickness??1,middleLineStyle:A.middleLineStyle??"dashed"}}}function Ls(){const b=new Map;Object.values(r().saveInds||{}).forEach(L=>{if(!L||L.name!=="RSI")return;const A=ki(L);A!=null&&A.actualPaneId&&!b.has(A.actualPaneId)&&b.set(A.actualPaneId,A)});const w=Array.from(b.values());return i().editPaneId&&w.sort((L,A)=>L.actualPaneId===i().editPaneId?-1:A.actualPaneId===i().editPaneId?1:(L.actualPaneId||"").localeCompare(A.actualPaneId||"")),w}function Rl(){if(!n(wl))return;const b=n(et).map(w=>{const L=w.actualPaneId||w.paneId||i().editPaneId;return ra(w,{paneId:L,actualPaneId:L})});c.update(w=>(Object.keys(w.saveInds||{}).forEach(L=>{var A;((A=w.saveInds[L])==null?void 0:A.name)==="RSI"&&delete w.saveInds[L]}),b.forEach(L=>{const A=L.actualPaneId;if(!A)return;const E=`${A}_RSI`;w.saveInds[E]={name:"RSI",pane_id:A,params:[L.period],rsiGroups:[ra(L)]}}),w))}function mc(){if(!n(wl))return;const b=Ls(),w=yn();if(w.size>0&&b.length<w.size){const L=[];if(w.forEach(A=>{try{const E=of.getInstance(A)||of.getInstanceConfig(A);if(!E)return;const R={id:Jn(),period:E.period??14,overboughtLevel:E.overboughtLevel??70,middleLevel:E.middleLevel??50,oversoldLevel:E.oversoldLevel??30,fillOpacity:E.fillOpacity??.15,paneId:A,actualPaneId:A,styles:{rsi:{color:E.lineColor??"#8B5CF6",thickness:E.lineThickness??2,lineStyle:E.lineStyle??"solid"},overboughtColor:E.overboughtColor??"#EF4444",overboughtThickness:E.overboughtThickness??1,overboughtLineStyle:E.overboughtLineStyle??"dashed",oversoldColor:E.oversoldColor??"#22C55E",oversoldThickness:E.oversoldThickness??1,oversoldLineStyle:E.oversoldLineStyle??"dashed",middleLineColor:E.middleLineColor??"#6B7280",middleLineThickness:E.middleLineThickness??1,middleLineStyle:E.middleLineStyle??"dashed"}};L.push(R)}catch(E){console.warn("⚠️ Failed to reconstruct RSI group from instance:",E)}}),L.length>0){x(et,D(L)),Rl();return}}if(b.length>0){x(et,D(b)),Rl();return}if(n(et).length===0){const L={id:Jn(),period:14,overboughtLevel:70,middleLevel:50,oversoldLevel:30,fillOpacity:.15,paneId:i().editPaneId,actualPaneId:i().editPaneId,styles:{rsi:{color:"#8B5CF6",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",overboughtThickness:1,overboughtLineStyle:"dashed",oversoldColor:"#22C55E",oversoldThickness:1,oversoldLineStyle:"dashed",middleLineColor:"#6B7280",middleLineThickness:1,middleLineStyle:"dashed"}};x(et,D([L])),of.createInstance(L.actualPaneId,{period:L.period,lineColor:L.styles.rsi.color,lineThickness:L.styles.rsi.thickness,lineStyle:L.styles.rsi.lineStyle,overboughtLevel:L.overboughtLevel,oversoldLevel:L.oversoldLevel,middleLevel:L.middleLevel,overboughtColor:L.styles.overboughtColor,overboughtThickness:L.styles.overboughtThickness??1,overboughtLineStyle:L.styles.overboughtLineStyle||"dashed",oversoldColor:L.styles.oversoldColor,oversoldThickness:L.styles.oversoldThickness??1,oversoldLineStyle:L.styles.oversoldLineStyle||"dashed",overboughtFillColor:L.styles.overboughtColor,oversoldFillColor:L.styles.oversoldColor,middleLineColor:L.styles.middleLineColor,middleLineThickness:L.styles.middleLineThickness??1,middleLineStyle:L.styles.middleLineStyle||"dashed",fillOpacity:L.fillOpacity,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:L.overboughtLevel,color:L.styles.overboughtColor,lineStyle:L.styles.overboughtLineStyle||"dashed",thickness:L.styles.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:L.middleLevel,color:L.styles.middleLineColor,lineStyle:L.styles.middleLineStyle||"dashed",thickness:L.styles.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:L.oversoldLevel,color:L.styles.oversoldColor,lineStyle:L.styles.oversoldLineStyle||"dashed",thickness:L.styles.oversoldThickness??1,label:"30",visible:!0}]}),Rl()}}function Jd(){if(!n(wl))return;const b=yn(),w=new Set(b);n(et).forEach(R=>{const G=R.actualPaneId||R.paneId;G&&w.add(G)});const L=Ns(w),A={id:Jn(),period:14,overboughtLevel:70,middleLevel:50,oversoldLevel:30,fillOpacity:.15,paneId:L,actualPaneId:L,styles:{rsi:{color:"#8B5CF6",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",overboughtThickness:1,overboughtLineStyle:"dashed",oversoldColor:"#22C55E",oversoldThickness:1,oversoldLineStyle:"dashed",middleLineColor:"#6B7280",middleLineThickness:1,middleLineStyle:"dashed"}};n(et).push(A);let E=L;if(s()){const R=s(),G=new Set(b);let _e=Oe.Solid,Be=[2,2];A.styles.rsi.lineStyle==="dashed"?(_e=Oe.Dashed,Be=[6,4]):A.styles.rsi.lineStyle==="dotted"&&(_e=Oe.Dashed,Be=[2,2]);const _t=R.createIndicator({name:"RSI",calcParams:[A.period],styles:{lines:[{color:A.styles.rsi.color,size:A.styles.rsi.thickness,style:_e,dashedValue:Be}]}},!1,{id:L,axis:{gap:{bottom:2}}});if(E=ae(G,L),A.paneId=E,A.actualPaneId=E,of.createInstance(E,{period:A.period,lineColor:A.styles.rsi.color,lineThickness:A.styles.rsi.thickness,lineStyle:A.styles.rsi.lineStyle,overboughtLevel:A.overboughtLevel,oversoldLevel:A.oversoldLevel,middleLevel:A.middleLevel,overboughtColor:A.styles.overboughtColor,overboughtThickness:A.styles.overboughtThickness??1,overboughtLineStyle:A.styles.overboughtLineStyle||"dashed",oversoldColor:A.styles.oversoldColor,oversoldThickness:A.styles.oversoldThickness??1,oversoldLineStyle:A.styles.oversoldLineStyle||"dashed",overboughtFillColor:A.styles.overboughtColor,oversoldFillColor:A.styles.oversoldColor,middleLineColor:A.styles.middleLineColor,middleLineThickness:A.styles.middleLineThickness??1,middleLineStyle:A.styles.middleLineStyle||"dashed",fillOpacity:A.fillOpacity,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:A.overboughtLevel,color:A.styles.overboughtColor,lineStyle:A.styles.overboughtLineStyle||"dashed",thickness:A.styles.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:A.middleLevel,color:A.styles.middleLineColor,lineStyle:A.styles.middleLineStyle||"dashed",thickness:A.styles.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:A.oversoldLevel,color:A.styles.oversoldColor,lineStyle:A.styles.oversoldLineStyle||"dashed",thickness:A.styles.oversoldThickness??1,label:"30",visible:!0}]}),_t){const Yo=`${E}_RSI`;c.update($o=>($o.saveInds[Yo]={name:"RSI",pane_id:E,params:[A.period],rsiGroups:[{id:A.id,period:A.period,overboughtLevel:A.overboughtLevel,middleLevel:A.middleLevel,oversoldLevel:A.oversoldLevel,paneId:E,actualPaneId:E,styles:A.styles}]},$o))}}else of.createInstance(E,{period:A.period,lineColor:A.styles.rsi.color,lineThickness:A.styles.rsi.thickness,lineStyle:A.styles.rsi.lineStyle,overboughtLevel:A.overboughtLevel,oversoldLevel:A.oversoldLevel,middleLevel:A.middleLevel,overboughtColor:A.styles.overboughtColor,overboughtThickness:A.styles.overboughtThickness??1,overboughtLineStyle:A.styles.overboughtLineStyle||"dashed",oversoldColor:A.styles.oversoldColor,oversoldThickness:A.styles.oversoldThickness??1,oversoldLineStyle:A.styles.oversoldLineStyle||"dashed",overboughtFillColor:A.styles.overboughtColor,oversoldFillColor:A.styles.oversoldColor,middleLineColor:A.styles.middleLineColor,middleLineThickness:A.styles.middleLineThickness??1,middleLineStyle:A.styles.middleLineStyle||"dashed",fillOpacity:A.fillOpacity,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:A.overboughtLevel,color:A.styles.overboughtColor,lineStyle:A.styles.overboughtLineStyle||"dashed",thickness:A.styles.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:A.middleLevel,color:A.styles.middleLineColor,lineStyle:A.styles.middleLineStyle||"dashed",thickness:A.styles.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:A.oversoldLevel,color:A.styles.oversoldColor,lineStyle:A.styles.oversoldLineStyle||"dashed",thickness:A.styles.oversoldThickness??1,label:"30",visible:!0}]});Rl()}function Wc(b){var E;if(!n(wl)||n(et).length<=1||b<0||b>=n(et).length)return;console.log("🗑️ Removing RSI group at index:",b);const w=n(et)[b];let L=w.actualPaneId||w.paneId||i().editPaneId;if(!L&&((E=s())!=null&&E.getIndicators))try{const R=new Set(n(et).filter((Be,_t)=>_t!==b).map(Be=>Be.actualPaneId||Be.paneId).filter(Be=>!!Be)),_e=s().getIndicators().find(Be=>(Be==null?void 0:Be.name)==="RSI"&&(Be==null?void 0:Be.paneId)&&!R.has(Be.paneId));_e!=null&&_e.paneId&&(L=_e.paneId)}catch(R){console.warn("⚠️ Failed to resolve RSI pane ID for removal:",R)}const A=n(et).length;if(n(et).splice(b,1),console.log(`📝 Removed group: ${A} -> ${n(et).length}`),s()&&L)try{console.log("🗑️ Removing RSI from pane:",L),of.deleteInstance(L),H(L,"RSI")}catch(R){console.error("❌ Error removing RSI indicator:",R)}Rl(),console.log("✅ RSI group removed. Remaining groups:",n(et).length)}function nc(b){if(!n(wl)||!s()||b<0||b>=n(et).length)return;const w=n(et)[b],L=w.actualPaneId||w.paneId||i().editPaneId;if(!L){console.warn("⚠️ Unable to resolve pane ID for RSI update");return}try{of.updateInstance(L,{period:w.period,lineColor:w.styles.rsi.color,lineThickness:w.styles.rsi.thickness,lineStyle:w.styles.rsi.lineStyle,overboughtLevel:w.overboughtLevel,oversoldLevel:w.oversoldLevel,middleLevel:w.middleLevel,overboughtColor:w.styles.overboughtColor||"#EF4444",overboughtThickness:w.styles.overboughtThickness??1,overboughtLineStyle:w.styles.overboughtLineStyle||"dashed",oversoldColor:w.styles.oversoldColor||"#22C55E",oversoldThickness:w.styles.oversoldThickness??1,oversoldLineStyle:w.styles.oversoldLineStyle||"dashed",overboughtFillColor:w.styles.overboughtColor||"#EF4444",oversoldFillColor:w.styles.oversoldColor||"#22C55E",middleLineColor:w.styles.middleLineColor||"#6B7280",middleLineThickness:w.styles.middleLineThickness??1,middleLineStyle:w.styles.middleLineStyle||"dashed",fillOpacity:w.fillOpacity??.15,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:w.overboughtLevel,color:w.styles.overboughtColor||"#EF4444",lineStyle:w.styles.overboughtLineStyle||"dashed",thickness:w.styles.overboughtThickness??1,label:String(w.overboughtLevel),visible:!0},{id:"middle",value:w.middleLevel,color:w.styles.middleLineColor||"#6B7280",lineStyle:w.styles.middleLineStyle||"dashed",thickness:w.styles.middleLineThickness??1,label:String(w.middleLevel),visible:!0},{id:"oversold",value:w.oversoldLevel,color:w.styles.oversoldColor||"#22C55E",lineStyle:w.styles.oversoldLineStyle||"dashed",thickness:w.styles.oversoldThickness??1,label:String(w.oversoldLevel),visible:!0}]}),s().removeIndicator({paneId:L,name:"RSI"});let A=Oe.Solid,E=[2,2];w.styles.rsi.lineStyle==="dashed"?(A=Oe.Dashed,E=[6,4]):w.styles.rsi.lineStyle==="dotted"&&(A=Oe.Dashed,E=[2,2]);const R=s().createIndicator({name:"RSI",calcParams:[w.period],styles:{lines:[{color:w.styles.rsi.color,size:w.styles.rsi.thickness,style:A,dashedValue:E}]}},!1,{id:L,axis:{gap:{bottom:2}}});try{typeof s().resize=="function"&&s().resize()}catch{}if(w.actualPaneId=L,w.paneId=L,R){const G=`${L}_RSI`;c.update(_e=>{const Be=(n(et)||[]).filter(_t=>(_t.actualPaneId||_t.paneId)===L);return _e.saveInds[G]={name:"RSI",pane_id:L,params:[w.period],rsiGroups:Be},_e})}Rl()}catch(A){console.error("❌ Error updating RSI indicator:",A)}}let Ao=ee(D([]));function ln(){x(Ao,D([])),console.log("✅ Stochastic groups cleared from modal state")}function ul(){if(!n(Cl))return;const b=`${i().editPaneId}_STOCH`,w=r().saveInds[b];if(w&&w.stochasticGroups&&w.stochasticGroups.length>0)x(Ao,D([...w.stochasticGroups]));else if(n(Ao).length===0){const L={id:Jn(),kPeriod:14,dPeriod:3,overboughtLevel:80,oversoldLevel:20,midLevel:50,paneId:i().editPaneId,styles:{kLine:{color:"#1E90FF",thickness:2,lineStyle:"solid"},dLine:{color:"#FF1493",thickness:2,lineStyle:"dashed"},overboughtColor:"#EF4444",oversoldColor:"#10B981",midLineColor:"#6B7280"}};x(Ao,D([L])),Hg.createInstance(i().editPaneId,{kPeriod:L.kPeriod,dPeriod:L.dPeriod,kLineColor:L.styles.kLine.color,kLineThickness:L.styles.kLine.thickness,kLineStyle:L.styles.kLine.lineStyle,dLineColor:L.styles.dLine.color,dLineThickness:L.styles.dLine.thickness,dLineStyle:L.styles.dLine.lineStyle,levels:[{id:"overbought",value:L.overboughtLevel,color:L.styles.overboughtColor,lineStyle:"dashed",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:L.oversoldLevel,color:L.styles.oversoldColor,lineStyle:"dashed",thickness:1,label:"Oversold",visible:!0},{id:"mid",value:L.midLevel,color:L.styles.midLineColor,lineStyle:"dashed",thickness:1,label:"Mid",visible:!0}]})}}function ql(){var w;if(!n(Cl))return;const b={id:Jn(),kPeriod:14,dPeriod:3,overboughtLevel:80,oversoldLevel:20,midLevel:50,paneId:void 0,styles:{kLine:{color:"#1E90FF",thickness:2,lineStyle:"solid"},dLine:{color:"#FF1493",thickness:2,lineStyle:"dashed"},overboughtColor:"#EF4444",oversoldColor:"#10B981",midLineColor:"#6B7280"}};if(x(Ao,D([...n(Ao),b])),n(Ao).length>1){const L=Object.values(r().saveInds).filter(_t=>_t.name==="STOCH"&&_t.pane_id).map(_t=>_t.pane_id);let A=2;for(;L.includes(`pane_STOCH_${A}`);)A+=1;const E=n(Ao).length-1,R=[b.kPeriod,b.dPeriod,1],G={lines:[{color:b.styles.kLine.color,size:b.styles.kLine.thickness,style:b.styles.kLine.lineStyle==="dashed"||b.styles.kLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:b.styles.kLine.lineStyle==="dashed"?[4,4]:b.styles.kLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:b.styles.dLine.color,size:b.styles.dLine.thickness,style:b.styles.dLine.lineStyle==="dashed"||b.styles.dLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:b.styles.dLine.lineStyle==="dashed"?[4,4]:b.styles.dLine.lineStyle==="dotted"?[2,2]:[2,2]}]},_e=`pane_STOCH_${A}`;console.log(`🆕 Immediately creating Stochastic ${A} with pane ID:`,_e),((w=s())==null?void 0:w.createIndicator({name:"STOCH",calcParams:R,styles:G},!1,{id:_e,axis:{gap:{bottom:2}}}))&&(console.log(`✅ Stochastic ${A} created with pane ID:`,_e),b.paneId=_e,Hg.updateInstance(_e,{kPeriod:b.kPeriod,dPeriod:b.dPeriod,levels:[{id:"overbought",value:b.overboughtLevel,color:b.styles.overboughtColor,lineStyle:"solid",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:b.oversoldLevel,color:b.styles.oversoldColor,lineStyle:"solid",thickness:1,label:"Oversold",visible:!0},{id:"midline",value:b.midLevel,color:b.styles.midLineColor,lineStyle:"solid",thickness:1,label:"Midline",visible:!0}],zones:[{id:"overbought_zone",type:"overbought",topLevel:100,bottomLevel:b.overboughtLevel,fillColor:b.styles.overboughtColor,fillOpacity:.1,visible:!0},{id:"oversold_zone",type:"oversold",topLevel:b.oversoldLevel,bottomLevel:0,fillColor:b.styles.oversoldColor,fillOpacity:.1,visible:!0}],kLineColor:b.styles.kLine.color,dLineColor:b.styles.dLine.color,showLevels:!0,showZones:!0,overboughtLevel:b.overboughtLevel,oversoldLevel:b.oversoldLevel,midlineLevel:b.midLevel}),c.update(_t=>{const Yo=`pane_STOCH_${A}_STOCH`;return _t.saveInds[Yo]={name:"STOCH",stochasticGroup:b,pane_id:_e,groupIndex:E,params:[b.kPeriod,b.dPeriod,1]},_t}))}console.log("✅ New Stochastic group added:",b)}function Pl(b){if(!n(Cl)||b<0||b>=n(Ao).length)return;const L=n(Ao)[b].paneId||i().editPaneId;try{Hg.deleteInstance(L),s()&&s().removeIndicator({paneId:L,name:"STOCH"}),c.update(A=>(Object.keys(A.saveInds).filter(R=>A.saveInds[R].name==="STOCH"&&A.saveInds[R].pane_id===L).forEach(R=>{delete A.saveInds[R]}),A)),x(Ao,D(n(Ao).filter((A,E)=>E!==b))),console.log("✅ Stochastic group removed successfully")}catch(A){console.error("❌ Error removing Stochastic group:",A)}}function kl(b){if(!n(Cl)||b<0||b>=n(Ao).length)return;const w=n(Ao)[b],L=w.paneId||i().editPaneId;try{Hg.updateInstance(L,{kPeriod:w.kPeriod,dPeriod:w.dPeriod,kLineColor:w.styles.kLine.color,kLineThickness:w.styles.kLine.thickness,kLineStyle:w.styles.kLine.lineStyle,dLineColor:w.styles.dLine.color,dLineThickness:w.styles.dLine.thickness,dLineStyle:w.styles.dLine.lineStyle,overboughtLevel:w.overboughtLevel,oversoldLevel:w.oversoldLevel,midlineLevel:w.midLevel,showZones:!0,zones:[{id:"overbought-zone",topLevel:100,bottomLevel:w.overboughtLevel,fillColor:w.styles.overboughtColor||"#EF4444",fillOpacity:.1,visible:!0,type:"overbought"},{id:"oversold-zone",topLevel:w.oversoldLevel,bottomLevel:0,fillColor:w.styles.oversoldColor||"#10B981",fillOpacity:.1,visible:!0,type:"oversold"}],levels:[{id:"overbought",value:w.overboughtLevel,color:w.styles.overboughtColor||"#EF4444",lineStyle:"dashed",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:w.oversoldLevel,color:w.styles.oversoldColor||"#10B981",lineStyle:"dashed",thickness:1,label:"Oversold",visible:!0},{id:"mid",value:w.midLevel,color:w.styles.midLineColor||"#6B7280",lineStyle:"dashed",thickness:1,label:"Mid",visible:!0}]}),s()&&s().removeIndicator({paneId:L,name:"STOCH"});let A=Oe.Solid,E=[2,2],R=Oe.Solid,G=[2,2];if(w.styles.kLine.lineStyle==="dashed"?(A=Oe.Dashed,E=[4,4]):w.styles.kLine.lineStyle==="dotted"&&(A=Oe.Dashed,E=[2,2]),w.styles.dLine.lineStyle==="dashed"?(R=Oe.Dashed,G=[4,4]):w.styles.dLine.lineStyle==="dotted"&&(R=Oe.Dashed,G=[2,2]),s()?s().createIndicator({name:"STOCH",calcParams:[w.kPeriod,w.dPeriod],styles:{lines:[{color:w.styles.kLine.color,size:w.styles.kLine.thickness,style:A,dashedValue:E},{color:w.styles.dLine.color,size:w.styles.dLine.thickness,style:R,dashedValue:G}]}},L===i().editPaneId,{id:L}):null){const Be=`${L}_STOCH`;c.update(_t=>(_t.saveInds[Be]={name:"STOCH",pane_id:L,params:[w.kPeriod,w.dPeriod],stochasticGroups:n(Ao)},_t))}console.log("✅ Stochastic indicator and levels updated successfully")}catch(A){console.error("❌ Error updating Stochastic indicator:",A)}}function od(){if(!n(Ue))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="MACD").sort();console.log("🔍 Found existing MACD keys:",b),b.length>0?(x(zo,D([])),b.forEach((w,L)=>{const A=r().saveInds[w];if(A){if(A.macdGroup){const E={...A.macdGroup};L>0&&A.pane_id&&(E.actualPaneId=A.pane_id),n(zo).push(E)}else if(A.params&&A.params.length>=3){const E={id:Jn(),fastPeriod:A.params[0]||12,slowPeriod:A.params[1]||26,signalPeriod:A.params[2]||9,actualPaneId:void 0,styles:{macdLine:{color:"#2563eb",thickness:1,lineStyle:"solid"},signalLine:{color:"#dc2626",thickness:1,lineStyle:"solid"},positiveHistogram:{color:"#22c55e"},negativeHistogram:{color:"#ef4444"}}};L>0&&A.pane_id&&(E.actualPaneId=A.pane_id),n(zo).push(E)}}}),console.log("✅ Loaded",n(zo).length,"existing MACD groups")):n(zo).length===0&&(x(zo,D([{id:Jn(),fastPeriod:12,slowPeriod:26,signalPeriod:9,styles:{macdLine:{color:"#2563eb",thickness:1,lineStyle:"solid"},signalLine:{color:"#dc2626",thickness:1,lineStyle:"solid"},positiveHistogram:{color:"#22c55e"},negativeHistogram:{color:"#ef4444"}}}])),console.log("🆕 Created default MACD group"))}function ic(){var A;if(!n(Ue))return;const b=[{macdLine:"#2563eb",signalLine:"#dc2626",positiveHistogram:"#22c55e",negativeHistogram:"#ef4444"},{macdLine:"#9333ea",signalLine:"#ea580c",positiveHistogram:"#059669",negativeHistogram:"#dc2626"},{macdLine:"#ec4899",signalLine:"#f59e0b",positiveHistogram:"#0891b2",negativeHistogram:"#f97316"}],w=n(zo).length%b.length,L={id:Jn(),fastPeriod:12,slowPeriod:26,signalPeriod:9,actualPaneId:void 0,styles:{macdLine:{color:b[w].macdLine,thickness:1,lineStyle:"solid"},signalLine:{color:b[w].signalLine,thickness:1,lineStyle:"solid"},positiveHistogram:{color:b[w].positiveHistogram},negativeHistogram:{color:b[w].negativeHistogram}}};if(n(zo).push(L),n(zo).length>1){const E=Object.values(r().saveInds).filter($o=>$o.name==="MACD"&&$o.pane_id).map($o=>$o.pane_id);let R=2;for(;E.includes(`pane_MACD_${R}`);)R+=1;const G=n(zo).length-1,_e=[L.fastPeriod,L.slowPeriod,L.signalPeriod],Be={lines:[{color:L.styles.macdLine.color,size:L.styles.macdLine.thickness,style:L.styles.macdLine.lineStyle==="dashed"||L.styles.macdLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:L.styles.macdLine.lineStyle==="dashed"?[4,4]:L.styles.macdLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:L.styles.signalLine.color,size:L.styles.signalLine.thickness,style:L.styles.signalLine.lineStyle==="dashed"||L.styles.signalLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:L.styles.signalLine.lineStyle==="dashed"?[4,4]:L.styles.signalLine.lineStyle==="dotted"?[2,2]:[2,2]}],bars:[{upColor:L.styles.positiveHistogram.color,downColor:L.styles.negativeHistogram.color,noChangeColor:L.styles.positiveHistogram.color,borderSize:0,borderColor:L.styles.positiveHistogram.color}]},_t=`pane_MACD_${R}`;console.log(`🆕 Immediately creating MACD ${R} with pane ID:`,_t),((A=s())==null?void 0:A.createIndicator({name:"MACD",calcParams:_e,styles:Be},!1,{id:_t,axis:{gap:{bottom:2}}}))&&(console.log(`✅ MACD ${R} created with pane ID:`,_t),L.actualPaneId=_t,c.update($o=>{const so=`pane_MACD_${R}_MACD`;return $o.saveInds[so]={name:"MACD",macdGroup:L,pane_id:_t,groupIndex:G,params:[L.fastPeriod,L.slowPeriod,L.signalPeriod]},$o}))}}function Il(b){var L,A;if(!n(Ue)||n(zo).length<=1)return;const w=n(zo).findIndex(E=>E.id===b);if(w!==-1){console.log("🗑️ Removing MACD group at index:",w,"ID:",b);try{if(w===0&&n(zo).length>1){console.log("🔄 Special handling: First MACD removed, promoting second MACD to first position"),x(zo,D(n(zo).filter(R=>R.id!==b))),console.log("✅ MACD group removed from array. Remaining groups:",n(zo).length);const E=n(zo)[0];E.actualPaneId&&(console.log("🗑️ Removing old second MACD from sub-pane:",E.actualPaneId),(L=s())==null||L.removeIndicator({paneId:E.actualPaneId,name:"MACD"})),E.actualPaneId=void 0,console.log("📊 Updating MACD in edit pane with new first group settings"),kc(0)}else{const E=n(zo)[w];E.actualPaneId&&(console.log("🗑️ Removing MACD from actual pane:",E.actualPaneId),(A=s())==null||A.removeIndicator({paneId:E.actualPaneId,name:"MACD"}),console.log("✅ Successfully removed MACD from actual pane:",E.actualPaneId)),x(zo,D(n(zo).filter(R=>R.id!==b))),console.log("✅ MACD group removed from array. Remaining groups:",n(zo).length)}c.update(E=>(Object.keys(E.saveInds).forEach(R=>{E.saveInds[R].name==="MACD"&&(console.log("🧹 Cleaning saved state for key:",R),delete E.saveInds[R])}),n(zo).forEach((R,G)=>{const _e=G===0?`${i().editPaneId}_MACD`:`pane_MACD_${G+1}_MACD`,Be=G===0?i().editPaneId:R.actualPaneId||`pane_MACD_${G+1}`;console.log(`💾 Re-saving MACD group ${G+1} with key:`,_e,"pane ID:",Be),E.saveInds[_e]={name:"MACD",macdGroup:R,pane_id:Be,groupIndex:G,macdGroups:G===0?[...n(zo)]:void 0,params:[R.fastPeriod,R.slowPeriod,R.signalPeriod]}}),E)),console.log("🔄 MACD groups reindexed successfully")}catch(E){console.log("❌ Error removing MACD indicator:",E)}}}function kc(b){var R;const w=n(zo)[b];if(!w||!s())return;const L=b===0?i().editPaneId:w.actualPaneId||`pane_MACD_${b+1}`,A={lines:[{color:w.styles.macdLine.color,size:w.styles.macdLine.thickness,style:w.styles.macdLine.lineStyle==="dashed"||w.styles.macdLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:w.styles.macdLine.lineStyle==="dashed"?[4,4]:w.styles.macdLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:w.styles.signalLine.color,size:w.styles.signalLine.thickness,style:w.styles.signalLine.lineStyle==="dashed"||w.styles.signalLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:w.styles.signalLine.lineStyle==="dashed"?[4,4]:w.styles.signalLine.lineStyle==="dotted"?[2,2]:[2,2]}],bars:[{upColor:w.styles.positiveHistogram.color,downColor:w.styles.negativeHistogram.color,noChangeColor:w.styles.positiveHistogram.color,borderSize:0,borderColor:w.styles.positiveHistogram.color}]};(R=s())==null||R.overrideIndicator({name:"MACD",paneId:L,styles:A,calcParams:[w.fastPeriod,w.slowPeriod,w.signalPeriod]});const E=b===0?`${i().editPaneId}_MACD`:`pane_MACD_${b+1}_MACD`;c.update(G=>(G.saveInds[E]&&(G.saveInds[E].params=[w.fastPeriod,w.slowPeriod,w.signalPeriod],G.saveInds[E].macdGroup={...w},console.log("💾 Persisted MACD changes to save data:",E,w)),G)),console.log("🔄 Updated MACD indicator:",b,w)}function lc(b,w){var R;const L=n(zo)[b];if(!L||!s())return;const A=b===0?i().editPaneId:L.actualPaneId||`pane_MACD_${b+1}`,E={lines:[{color:L.styles.macdLine.color,size:L.styles.macdLine.thickness,style:L.styles.macdLine.lineStyle==="dashed"||L.styles.macdLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:L.styles.macdLine.lineStyle==="dashed"?[4,4]:L.styles.macdLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:L.styles.signalLine.color,size:L.styles.signalLine.thickness,style:L.styles.signalLine.lineStyle==="dashed"||L.styles.signalLine.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:L.styles.signalLine.lineStyle==="dashed"?[4,4]:L.styles.signalLine.lineStyle==="dotted"?[2,2]:[2,2]}],bars:[{upColor:L.styles.positiveHistogram.color,downColor:L.styles.negativeHistogram.color,noChangeColor:L.styles.positiveHistogram.color,borderSize:0,borderColor:L.styles.positiveHistogram.color}]};(R=s())==null||R.overrideIndicator({name:"MACD",paneId:A,styles:E}),console.log("🎨 Updated MACD color:",w,L.styles[w].color)}function iu(){if(n(Ul))try{const b=`${i().editPaneId}_EMV`,w=r().saveInds[b];if(w&&w.emvGroups&&Array.isArray(w.emvGroups)&&w.emvGroups.length>0){const L=w.emvGroups.filter(A=>A&&typeof A.id=="string"&&typeof A.name=="string"&&typeof A.period=="number"&&A.period>0&&typeof A.period2=="number"&&A.period2>0&&typeof A.color=="string"&&typeof A.thickness=="number"&&A.thickness>0&&typeof A.lineStyle=="string");L.length>0?(x(vi,D([...L])),console.log("✅ Loaded",L.length,"valid EMV groups")):(console.warn("⚠️ No valid EMV groups found in saved data, creating default"),Rd())}else n(vi).length===0&&Rd()}catch(b){console.error("❌ Error initializing EMV groups:",b),Rd()}}function Rd(){x(vi,D([{id:Jn(),name:"EMV #1",period:14,period2:9,color:"#2563eb",thickness:2,lineStyle:"solid"}])),console.log("✅ Created default EMV group")}function fd(b){if(!n(Ul)||n(vi).length<=1){console.warn("⚠️ Cannot remove EMV group: minimum one group required");return}try{if(!b||typeof b!="string"){console.error("❌ Invalid group ID provided for EMV group removal");return}const w=n(vi).length;x(vi,D(n(vi).filter(L=>L.id!==b))),n(vi).length<w?console.log("✅ Removed EMV group with ID:",b):console.warn("⚠️ EMV group not found for removal:",b)}catch(w){console.error("❌ Error removing EMV group:",w)}}function wu(){if(n(wa))try{const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w]&&r().saveInds[w].name==="MTM").sort((w,L)=>w===`${i().editPaneId}_MTM`?-1:L===`${i().editPaneId}_MTM`?1:w.localeCompare(L));b.length>0?(x(ri,D([])),b.forEach((w,L)=>{const A=r().saveInds[w];if(A){if(A.mtmGroup){const E={...A.mtmGroup};L>0&&A.pane_id&&(E.actualPaneId=A.pane_id),n(ri).push(E)}else if(A.mtmGroups&&Array.isArray(A.mtmGroups)&&L===0){const E=A.mtmGroups.filter(R=>R&&typeof R.id=="string"&&typeof R.name=="string"&&typeof R.period=="number"&&R.period>0&&typeof R.color=="string"&&typeof R.thickness=="number"&&R.thickness>0&&typeof R.lineStyle=="string");x(ri,D([...E]))}}}),n(ri).length>0?console.log("✅ Loaded",n(ri).length,"MTM groups from saved data"):(console.warn("⚠️ No valid MTM groups found, creating default"),Cd())):n(ri).length===0&&Cd()}catch(b){console.error("❌ Error initializing MTM groups:",b),Cd()}}function Cd(){x(ri,D([{id:Jn(),name:"MTM #1",period:14,color:"#2563eb",thickness:2,lineStyle:"solid"}])),console.log("✅ Created default MTM group")}function jc(b){if(!n(wa)||n(ri).length<=1){console.warn("⚠️ Cannot remove MTM group: minimum one group required");return}try{if(!b||typeof b!="string"){console.error("❌ Invalid group ID provided for MTM group removal");return}const w=n(ri).length;x(ri,D(n(ri).filter(L=>L.id!==b))),n(ri).length<w?(console.log("✅ Removed MTM group with ID:",b),Yl()):console.warn("⚠️ MTM group not found for removal:",b)}catch(w){console.error("❌ Error removing MTM group:",w)}}function Yl(){var b;if(!(!n(wa)||!s()))try{console.log("🔄 Applying MTM changes to chart...");const w=Object.keys(r().saveInds).filter(A=>r().saveInds[A]&&r().saveInds[A].name==="MTM").sort((A,E)=>A===`${i().editPaneId}_MTM`?-1:E===`${i().editPaneId}_MTM`?1:A.localeCompare(E));console.log("🔧 Applying MTM changes. Existing keys:",w),console.log("🔧 Current MTM groups:",n(ri).length);const L=n(ri).length;if(w.length>L)for(let A=L;A<w.length;(A+=1)-1){const E=w[A],R=r().saveInds[E];if(R&&R.pane_id)try{console.log("🗑️ Removing excess MTM indicator from pane:",R.pane_id),(b=s())==null||b.removeIndicator({paneId:R.pane_id,name:"MTM"})}catch(G){console.log("❌ Error removing excess MTM indicator:",G)}}n(ri).forEach((A,E)=>{var _e,Be,_t;const R=[A.period],G={lines:[{color:A.color,size:A.thickness,style:A.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:A.lineStyle==="dashed"?[4,4]:A.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(E===0)console.log("🔄 Updating first MTM in pane:",i().editPaneId),(_e=s())==null||_e.overrideIndicator({name:"MTM",calcParams:R,styles:G,paneId:i().editPaneId});else{const Yo=`pane_MTM_${E+1}_MTM`,$o=w.find(so=>so===Yo);if($o){const so=r().saveInds[$o];so&&so.pane_id&&(console.log("🔄 Updating existing MTM in pane:",so.pane_id),(Be=s())==null||Be.overrideIndicator({name:"MTM",calcParams:R,styles:G,paneId:so.pane_id}),A.actualPaneId=so.pane_id)}else{const so=`pane_MTM_${E+1}`;console.log("🆕 Creating new MTM in pane:",so);const cn=(_t=s())==null?void 0:_t.createIndicator({name:"MTM",calcParams:R,styles:G},!0,{id:so,axis:{gap:{bottom:2}}});cn&&(A.actualPaneId=so,console.log("✅ Created new MTM indicator with ID:",cn,"in pane:",so))}}}),c.update(A=>{try{Object.keys(A.saveInds).forEach(E=>{A.saveInds[E]&&A.saveInds[E].name==="MTM"&&delete A.saveInds[E]}),n(ri).forEach((E,R)=>{try{const G=R===0?`${i().editPaneId}_MTM`:`pane_MTM_${R+1}_MTM`,_e=R===0?i().editPaneId:E.actualPaneId||`pane_MTM_${R+1}`;if(!G||!_e){console.error(`❌ Invalid save key or pane ID for MTM group ${R}`);return}const Be={name:"MTM",mtmGroup:E,pane_id:_e,groupIndex:R,mtmGroups:R===0?[...n(ri)]:void 0,params:[E.period]};A.saveInds[G]=Be,console.log("💾 Saved MTM group",R,"with key:",G,"and pane ID:",_e)}catch(G){console.error(`❌ Error saving MTM group ${R}:`,G)}})}catch(E){console.error("❌ Error in MTM save operation:",E)}return A}),console.log("✅ MTM changes applied successfully")}catch(w){console.error("❌ Critical error in applyMtm:",w)}}function Ac(){if(!n(lo))return;const b=`${i().editPaneId}_WR`,w=r().saveInds[b];if(w&&w.wrGroups&&w.wrGroups.length>0){x(Et,D([...w.wrGroups]));return}const L=[];Object.keys(r().saveInds).forEach(A=>{if((A.includes("_WR")||A.startsWith("WR_"))&&A!==b){const E=r().saveInds[A];E&&E.wrGroup&&L.push(E.wrGroup)}}),w&&w.wrGroup&&L.unshift(w.wrGroup),L.length>0?x(Et,D([...L])):n(Et).length===0&&x(Et,D([{id:Jn(),period:14,overboughtLevel:-20,middleLevel:-50,oversoldLevel:-80,paneId:i().editPaneId,styles:{wr:{color:"#2563eb",thickness:1,lineStyle:"solid"},overbought:{color:"#EF4444",thickness:1,lineStyle:"solid"},oversold:{color:"#10B981",thickness:1,lineStyle:"solid"},middleLine:{color:"#6B7280",thickness:1,lineStyle:"solid"}}}]))}function Ie(){if(!n(lo))return;const b=`pane_WR_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,w={id:Jn(),period:14,overboughtLevel:-20,middleLevel:-50,oversoldLevel:-80,paneId:b,styles:{wr:{color:"#2563eb",thickness:1,lineStyle:"solid"},overbought:{color:"#EF4444",thickness:1,lineStyle:"solid"},oversold:{color:"#10B981",thickness:1,lineStyle:"solid"},middleLine:{color:"#6B7280",thickness:1,lineStyle:"solid"}}};if(n(Et).push(w),T_.createInstance(b,{period:w.period,lineColor:w.styles.wr.color,lineThickness:w.styles.wr.thickness,lineStyle:w.styles.wr.lineStyle,levels:[{id:"overbought",value:w.overboughtLevel,color:w.styles.overbought.color,lineStyle:w.styles.overbought.lineStyle,thickness:w.styles.overbought.thickness,label:"Overbought",visible:!0},{id:"middle",value:w.middleLevel,color:w.styles.middleLine.color,lineStyle:w.styles.middleLine.lineStyle,thickness:w.styles.middleLine.thickness,label:"Middle",visible:!0},{id:"oversold",value:w.oversoldLevel,color:w.styles.oversold.color,lineStyle:w.styles.oversold.lineStyle,thickness:w.styles.oversold.thickness,label:"Oversold",visible:!0}]}),s()){let L=Oe.Solid,A=[2,2];if(w.styles.wr.lineStyle==="dashed"?(L=Oe.Dashed,A=[4,4]):w.styles.wr.lineStyle==="dotted"&&(L=Oe.Dashed,A=[2,2]),s().createIndicator({name:"WR",calcParams:[w.period],styles:{lines:[{color:w.styles.wr.color,size:w.styles.wr.thickness,style:L,dashedValue:A}]}},!1,{id:b})){const R=`${b}_WR`;c.update(G=>(G.saveInds[R]={name:"WR",pane_id:b,params:[w.period]},G))}}console.log("➕ Added new WR group in new pane:",w.id,b)}function ss(b){if(!n(lo)||n(Et).length<=1)return;const w=n(Et).find(A=>A.id===b);if(!w)return;n(Et).findIndex(A=>A.id===b);const L=w.paneId;x(Et,D(n(Et).filter(A=>A.id!==b))),L&&T_.deleteInstance(L),L&&H(L,"WR"),console.log("🗑️ Removed WR group from pane:",L)}function sr(b){if(!n(lo)||!s()||b<0||b>=n(Et).length)return;const w=n(Et)[b],L=w.paneId||i().editPaneId;console.log("🔄 Updating WR indicator:",b,L);try{T_.updateInstance(L,{period:w.period,lineColor:w.styles.wr.color,lineThickness:w.styles.wr.thickness,lineStyle:w.styles.wr.lineStyle,enableDynamicColoring:!0,overboughtColor:w.styles.overbought.color||"#EF4444",oversoldColor:w.styles.oversold.color||"#10B981",overboughtThreshold:w.overboughtLevel,oversoldThreshold:w.oversoldLevel,levels:[{id:"overbought",value:w.overboughtLevel,color:w.styles.overbought.color||"#EF4444",lineStyle:w.styles.overbought.lineStyle,thickness:w.styles.overbought.thickness,label:"Overbought",visible:!0},{id:"middle",value:w.middleLevel,color:w.styles.middleLine.color||"#6B7280",lineStyle:w.styles.middleLine.lineStyle,thickness:w.styles.middleLine.thickness,label:"Middle",visible:!0},{id:"oversold",value:w.oversoldLevel,color:w.styles.oversold.color||"#10B981",lineStyle:w.styles.oversold.lineStyle,thickness:w.styles.oversold.thickness,label:"Oversold",visible:!0}]}),s().removeIndicator({paneId:L,name:"WR"});let A=Oe.Solid,E=[2,2];if(w.styles.wr.lineStyle==="dashed"?(A=Oe.Dashed,E=[4,4]):w.styles.wr.lineStyle==="dotted"&&(A=Oe.Dashed,E=[2,2]),s().createIndicator({name:"WR",calcParams:[w.period],styles:{lines:[{color:w.styles.wr.color,size:w.styles.wr.thickness,style:A,dashedValue:E}]}},L===i().editPaneId,{id:L})){const G=`${L}_WR`;c.update(_e=>(_e.saveInds[G]={name:"WR",pane_id:L,params:[w.period]},_e))}console.log("✅ WR indicator and levels updated successfully")}catch(A){console.error("❌ Error updating WR indicator:",A)}}function Sa(){if(!n(he))return;const b=Object.entries(r().saveInds).filter(([w,L])=>L.name==="VR");if(b.length>0)x(Ut,D(b.map(([w,L])=>{var A,E,R;return L.vrGroups&&L.vrGroups.length>0?L.vrGroups[0]:L.vrGroup?L.vrGroup:{id:Jn(),paneId:L.pane_id,period:((A=L.params)==null?void 0:A[0])||26,shortPeriod:((E=L.params)==null?void 0:E[1])||6,longPeriod:((R=L.params)==null?void 0:R[2])||12,styles:{vr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},vrShort:{color:"#2196F3",thickness:1,lineStyle:"solid"},vrLong:{color:"#4CAF50",thickness:1,lineStyle:"solid"}}}}))),console.log("✅ Loaded VR groups from save system:",n(Ut).length);else if(n(Ut).length===0){const w={id:Jn(),paneId:i().editPaneId,period:26,shortPeriod:6,longPeriod:12,styles:{vr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},vrShort:{color:"#2196F3",thickness:1,lineStyle:"solid"},vrLong:{color:"#4CAF50",thickness:1,lineStyle:"solid"}}};x(Ut,D([w])),console.log("✅ Created default VR group with pane ID:",i().editPaneId)}}function Ml(){if(!n(mo))return;const b=Object.entries(r().saveInds).filter(([w,L])=>L.name==="VOL");if(b.length>0)x(Ze,D(b.map(([w,L])=>{var A,E,R,G,_e;if(L.volGroups&&L.volGroups.length>0){const Be=L.volGroups[0];return{...Be,paneId:"candle_pane",styles:{...Be.styles,ema:{visible:((E=(A=Be.styles)==null?void 0:A.ema)==null?void 0:E.visible)??!1,...Be.styles.ema}}}}else if(L.volGroup){const Be=L.volGroup;return{...Be,paneId:"candle_pane",styles:{...Be.styles,ema:{visible:((G=(R=Be.styles)==null?void 0:R.ema)==null?void 0:G.visible)??!1,...Be.styles.ema}}}}else return{id:Jn(),paneId:"candle_pane",period:((_e=L.params)==null?void 0:_e[0])||20,styles:{histogram:{upColor:"#26a69a",downColor:"#ef5350",thickness:1,lineStyle:"solid"},ema:{color:"#8B5CF6",thickness:1,lineStyle:"dotted",visible:!1}}}}))),console.log("✅ Loaded Volume groups from save system:",n(Ze).length);else if(n(Ze).length===0){const w={id:Jn(),paneId:"candle_pane",period:20,styles:{histogram:{upColor:"#26a69a",downColor:"#ef5350",thickness:1,lineStyle:"solid"},ema:{color:"#8B5CF6",thickness:1,lineStyle:"dotted",visible:!1}}};x(Ze,D([w])),console.log("✅ Created default Volume group:",w)}}function Zc(){if(!n(he))return;const b=`pane_VR_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,w={id:Jn(),paneId:b,period:26,shortPeriod:6,longPeriod:12,styles:{vr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},vrShort:{color:"#2196F3",thickness:1,lineStyle:"solid"},vrLong:{color:"#4CAF50",thickness:1,lineStyle:"solid"}}};if(n(Ut).push(w),s()){let L=Oe.Solid,A=[2,2];if(w.styles.vr.lineStyle==="dashed"?(L=Oe.Dashed,A=[4,4]):w.styles.vr.lineStyle==="dotted"&&(L=Oe.Dashed,A=[2,2]),s().createIndicator({name:"VR",calcParams:[w.period,w.shortPeriod,w.longPeriod],styles:{lines:[{color:w.styles.vr.color,size:w.styles.vr.thickness,style:L,dashedValue:A}]}},!1,{id:b})){const R=`${b}_VR`;c.update(G=>(G.saveInds[R]={name:"VR",pane_id:b,params:[w.period,w.shortPeriod,w.longPeriod]},G))}}console.log("➕ Added new VR group in new pane:",w.id,b)}function ec(b){if(!n(he)||n(Ut).length<=1||b<0||b>=n(Ut).length)return;console.log("🗑️ Removing VR group at index:",b);const L=n(Ut)[b].paneId,A=n(Ut).length;if(n(Ut).splice(b,1),console.log(`📝 Removed group: ${A} -> ${n(Ut).length}`),s()&&L)try{console.log("🗑️ Removing VR from pane:",L),H(L,"VR")}catch(E){console.error("❌ Error removing VR indicator:",E)}console.log("✅ VR group removed. Remaining groups:",n(Ut).length),console.log("🗑️ Removed VR group from list (will be applied on confirm)")}function Ku(b){if(!n(mo)||n(Ze).length<=1||b<0||b>=n(Ze).length)return;console.log("🗑️ Removing Volume group at index:",b),n(Ze)[b];const w="candle_pane",L=n(Ze).length;if(n(Ze).splice(b,1),console.log(`📝 Removed group: ${L} -> ${n(Ze).length}`),s()&&w)try{console.log("🗑️ Removing Volume from pane:",w),H(w,"VOL")}catch(A){console.error("❌ Error removing Volume indicator:",A)}console.log("✅ Volume group removed. Remaining groups:",n(Ze).length),console.log("🗑️ Removed Volume group from list (will be applied on confirm)")}function Bd(b){if(i().editIndName!=="VR"||!s()||b<0||b>=n(Ut).length)return;const w=n(Ut)[b],L=w.paneId||i().editPaneId;console.log("🔄 Updating VR indicator:",b,L);try{s().removeIndicator({paneId:L,name:"VR"});const A=Be=>{switch(Be){case"dashed":return{style:Oe.Dashed,dashedValue:[4,4]};case"dotted":return{style:Oe.Dashed,dashedValue:[2,2]};default:return{style:Oe.Solid,dashedValue:[2,2]}}},E=A(w.styles.vr.lineStyle),R=A(w.styles.vrShort.lineStyle),G=A(w.styles.vrLong.lineStyle);if(s().createIndicator({name:"VR",calcParams:[w.period,w.shortPeriod,w.longPeriod],styles:{lines:[{color:w.styles.vr.color,size:w.styles.vr.thickness,style:E.style,dashedValue:E.dashedValue},{color:w.styles.vrShort.color,size:w.styles.vrShort.thickness,style:R.style,dashedValue:R.dashedValue},{color:w.styles.vrLong.color,size:w.styles.vrLong.thickness,style:G.style,dashedValue:G.dashedValue}]}},L===i().editPaneId,{id:L})){const Be=`${L}_VR`;c.update(_t=>(_t.saveInds[Be]={name:"VR",pane_id:L,params:[w.period,w.shortPeriod,w.longPeriod]},_t))}console.log("✅ VR indicator updated successfully")}catch(A){console.error("❌ Error updating VR indicator:",A)}}function Od(b){if(i().editIndName!=="VOL"||!s()||b<0||b>=n(Ze).length)return;const w=n(Ze)[b],L="candle_pane";try{console.log("🔄 Updating Volume indicator for group:",b,"paneId:",L),s().removeIndicator({paneId:L,name:"VOL"});let A=Oe.Solid,E=[2,2];if(w.styles.ema.lineStyle==="dashed"?(A=Oe.Dashed,E=[4,4]):w.styles.ema.lineStyle==="dotted"&&(A=Oe.Dashed,E=[2,2]),console.log("updateVolIndicator - Colors being applied:",{upColor:w.styles.histogram.upColor,downColor:w.styles.histogram.downColor,noChangeColor:w.styles.histogram.upColor,emaColor:w.styles.ema.color}),s().createIndicator({name:"VOL",calcParams:[w.period],styles:{bars:[{upColor:w.styles.histogram.upColor,downColor:w.styles.histogram.downColor,noChangeColor:w.styles.histogram.upColor}],lines:[{color:w.styles.ema.color,size:w.styles.ema.thickness,style:A,dashedValue:E}]}},!0,{id:L})){const G=`${L}_VOL`;c.update(_e=>(_e.saveInds[G]={name:"VOL",pane_id:L,params:[w.period],volGroup:w},_e))}console.log("✅ Volume indicator updated successfully")}catch(A){console.error("❌ Error updating Volume indicator:",A)}}function sd(b){if(i().editIndName!=="BBI"||!s()||b<0||b>=n(xt).length)return;const w=n(xt)[b],L=w.paneId||i().editPaneId;console.log("🔄 Updating BBI indicator:",b,L);try{s().removeIndicator({paneId:L,name:"BBI"});const E=(G=>{switch(G){case"dashed":return{style:Oe.Dashed,dashedValue:[4,4]};case"dotted":return{style:Oe.Dashed,dashedValue:[2,2]};default:return{style:Oe.Solid,dashedValue:[2,2]}}})(w.lineStyle);if(s().createIndicator({name:"BBI",calcParams:[w.period1,w.period2,w.period3,w.period4],styles:{lines:[{color:w.color,size:w.thickness,style:E.style,dashedValue:E.dashedValue}]}},L===i().editPaneId,{id:L})){const G=`${L}_BBI`;c.update(_e=>(_e.saveInds[G]={name:"BBI",pane_id:L,params:[w.period1,w.period2,w.period3,w.period4],bbiGroup:w},_e))}console.log("✅ BBI indicator updated successfully")}catch(A){console.error("❌ Error updating BBI indicator:",A)}}function Ca(){if(!(i().editIndName!=="EMA"||!s()))try{console.log("🔄 Updating EMA indicator"),s().removeIndicator({paneId:i().editPaneId,name:"EMA"});const b=s().createIndicator({name:"EMA",calcParams:v,styles:{lines:v.map((w,L)=>{const A=_[L];let E=Oe.Solid,R=[2,2];return(A==null?void 0:A.lineStyle)==="dashed"?(E=Oe.Dashed,R=[4,4]):(A==null?void 0:A.lineStyle)==="dotted"&&(E=Oe.Dashed,R=[2,2]),{color:(A==null?void 0:A.color)||"#FF6B6B",size:(A==null?void 0:A.thickness)||1,style:E,dashedValue:R}})}},!0,{id:i().editPaneId});console.log("✅ EMA indicator updated successfully")}catch(b){console.error("❌ Error updating EMA indicator:",b)}}function Ad(){if(!(i().editIndName!=="MA"||!s()))try{console.log("🔄 Updating MA indicator"),s().removeIndicator({paneId:i().editPaneId,name:"MA"});const b=s().createIndicator({name:"MA",calcParams:v,styles:{lines:v.map((L,A)=>{const E=_[A];let R=Oe.Solid,G=[2,2];return(E==null?void 0:E.lineStyle)==="dashed"?(R=Oe.Dashed,G=[4,4]):(E==null?void 0:E.lineStyle)==="dotted"&&(R=Oe.Dashed,G=[2,2]),{color:(E==null?void 0:E.color)||"#2563eb",size:(E==null?void 0:E.thickness)||1,style:R,dashedValue:G}})}},!0,{id:i().editPaneId}),w=`${i().editPaneId}_MA`;c.update(L=>(L.saveInds[w]&&(L.saveInds[w].params=[...v],L.saveInds[w].styles=_.map(A=>({...A}))),L)),console.log("✅ MA indicator updated successfully")}catch(b){console.error("❌ Error updating MA indicator:",b)}}function uu(){var L,A,E;if(!n(ie))return;const b=`${i().editPaneId}_SMA`,w=r().saveInds[b];w&&w.smaGroups&&w.smaGroups.length>0?(x(ls,D([...w.smaGroups])),console.log("✅ Loaded",n(ls).length,"SMA groups from saved data")):w&&w.params&&w.params.length>0&&w.styles?(x(ls,D([{id:Jn(),name:"SMA",period:w.params[0]||20,color:((L=w.styles[0])==null?void 0:L.color)||"#FF6C37",thickness:((A=w.styles[0])==null?void 0:A.thickness)||2,lineStyle:((E=w.styles[0])==null?void 0:E.lineStyle)||"solid"}])),console.log("✅ Loaded SMA from saved data (old format)")):n(ls).length===0&&(x(ls,D([{id:Jn(),name:"SMA",period:20,color:"#FF6C37",thickness:2,lineStyle:"solid"}])),console.log("✅ Created default SMA group"))}function ru(b){var w,L;if(!(i().editIndName!=="SMA"||!s()||n(ls).length===0||b>=n(ls).length))try{console.log("🔄 Updating SMA indicator at index:",b);const A=n(ls)[b],R=((w=s())==null?void 0:w.getIndicators()).filter(_e=>_e.name==="SMA");for(const _e of R)(L=s())==null||L.removeIndicator({paneId:_e.paneId,name:"SMA"});n(ls).forEach((_e,Be)=>{var $o;let _t=Oe.Solid,Yo=[2,2];_e.lineStyle==="dashed"?(_t=Oe.Dashed,Yo=[8,4]):_e.lineStyle==="dotted"&&(_t=Oe.Dashed,Yo=[2,2]),($o=s())==null||$o.createIndicator({name:"SMA",calcParams:[_e.period],styles:{lines:[{color:_e.color,size:_e.thickness,style:_t,dashedValue:Yo}]}},!0,{id:i().editPaneId})});const G=`${i().editPaneId}_SMA`;c.update(_e=>(_e.saveInds[G]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(ls).map(Be=>({...Be}))},_e)),console.log("✅ SMA indicators updated successfully")}catch(A){console.error("❌ Error updating SMA indicator:",A)}}function Zr(){if(!n(ie))return;const b=n(ls).length>0?n(ls)[n(ls).length-1].period+10:20,w=["#FF6C37","#2563eb","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899"],L=w[n(ls).length%w.length],A={id:Jn(),name:"SMA",period:b,color:L,thickness:2,lineStyle:"solid"};if(n(ls).push(A),s()){s().createIndicator({name:"SMA",calcParams:[A.period],styles:{lines:[{color:A.color,size:A.thickness,style:Oe.Solid,dashedValue:[2,2]}]}},!0,{id:i().editPaneId});const E=`${i().editPaneId}_SMA`;c.update(R=>(R.saveInds[E]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(ls).map(G=>({...G}))},R))}console.log("➕ Added new SMA group:",A)}function Ud(b){var w,L;if(!(!n(ie)||n(ls).length<=1||b<0||b>=n(ls).length)&&(console.log("🗑️ Removing SMA group at index:",b),n(ls).splice(b,1),s()))try{const E=((w=s())==null?void 0:w.getIndicators()).filter(G=>G.name==="SMA");for(const G of E)(L=s())==null||L.removeIndicator({paneId:G.paneId,name:"SMA"});n(ls).forEach(G=>{var _t;let _e=Oe.Solid,Be=[2,2];G.lineStyle==="dashed"?(_e=Oe.Dashed,Be=[8,4]):G.lineStyle==="dotted"&&(_e=Oe.Dashed,Be=[2,2]),(_t=s())==null||_t.createIndicator({name:"SMA",calcParams:[G.period],styles:{lines:[{color:G.color,size:G.thickness,style:_e,dashedValue:Be}]}},!0,{id:i().editPaneId})});const R=`${i().editPaneId}_SMA`;c.update(G=>(n(ls).length>0?G.saveInds[R]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(ls).map(_e=>({..._e}))}:delete G.saveInds[R],G)),console.log("✅ SMA group removed and chart updated")}catch(A){console.error("❌ Error removing SMA group:",A)}}function hl(){var b,w;if(n(ie)){console.log("🔧 SMA Confirm: Saving",n(ls).length,"SMA groups");try{const L=(b=s())==null?void 0:b.getIndicators(),A=(L==null?void 0:L.filter(R=>R.name==="SMA"))||[];for(const R of A)(w=s())==null||w.removeIndicator({paneId:R.paneId,name:"SMA"});n(ls).forEach(R=>{var Be;let G=Oe.Solid,_e=[2,2];R.lineStyle==="dashed"?(G=Oe.Dashed,_e=[8,4]):R.lineStyle==="dotted"&&(G=Oe.Dashed,_e=[2,2]),(Be=s())==null||Be.createIndicator({name:"SMA",calcParams:[R.period],styles:{lines:[{color:R.color,size:R.thickness,style:G,dashedValue:_e}]}},!0,{id:i().editPaneId}),console.log("✅ Created SMA with period:",R.period)});const E=`${i().editPaneId}_SMA`;c.update(R=>(R.saveInds[E]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(ls).map(G=>({...G}))},console.log("💾 Saved",n(ls).length,"SMA groups to:",E),R)),console.log("✅ SMA confirm completed successfully"),l.update(R=>(R.editIndName="",R.editPaneId="",R.modalIndCfg=!1,R))}catch(L){console.error("❌ Error in SMA confirm:",L)}}}function hu(){if(!n(ke))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="BBI").sort((w,L)=>w===`${i().editPaneId}_BBI`?-1:L===`${i().editPaneId}_BBI`?1:w.localeCompare(L));console.log("🔍 Found existing BBI keys:",b),b.length>0?(x(xt,D([])),b.forEach((w,L)=>{const A=r().saveInds[w];if(A){const E=A.pane_id||w.replace("_BBI","");if(A.bbiGroup){const R={...A.bbiGroup};R.paneId||(R.paneId=E),n(xt).push(R)}else A.params&&A.params.length===4&&n(xt).push({id:Jn(),name:`BBI${L+1}`,paneId:E,period1:A.params[0]||3,period2:A.params[1]||6,period3:A.params[2]||12,period4:A.params[3]||24,color:"#8B5CF6",thickness:1,lineStyle:"solid"})}}),console.log("✅ Loaded",n(xt).length,"existing BBI groups")):n(xt).length===0&&(x(xt,D([{id:Jn(),name:"BBI",paneId:i().editPaneId,period1:3,period2:6,period3:12,period4:24,color:"#8B5CF6",thickness:1,lineStyle:"solid"}])),console.log("🆕 Created default BBI group"))}function md(){if(!n(ke))return;const b=`pane_BBI_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,w=n(xt).length+1,L={id:Jn(),name:`BBI${w}`,paneId:b,period1:3,period2:6,period3:12,period4:24,color:"#8B5CF6",thickness:1,lineStyle:"solid"};if(n(xt).push(L),s()){const E=(G=>{switch(G){case"dashed":return{style:Oe.Dashed,dashedValue:[4,4]};case"dotted":return{style:Oe.Dashed,dashedValue:[2,2]};default:return{style:Oe.Solid,dashedValue:[2,2]}}})(L.lineStyle);if(s().createIndicator({name:"BBI",calcParams:[L.period1,L.period2,L.period3,L.period4],styles:{lines:[{color:L.color,size:L.thickness,style:E.style,dashedValue:E.dashedValue}]}},!1,{id:b})){const G=`${b}_BBI`;c.update(_e=>(_e.saveInds[G]={name:"BBI",pane_id:b,params:[L.period1,L.period2,L.period3,L.period4],bbiGroup:L},_e))}}console.log("➕ Added new BBI group in new pane:",L.id,b)}function ap(b){var E;if(!n(ke)||n(xt).length<=1)return;const w=n(xt).findIndex(R=>R.id===b);if(w===-1)return;const L=n(xt)[w];console.log("🗑️ Removing BBI group at index:",w,"ID:",b,"paneId:",L.paneId);const A=L.paneId||(w===0?i().editPaneId:null);if(s()&&A){try{console.log("🗑️ Removing BBI from pane:",A),(E=s())==null||E.removeIndicator({paneId:A,name:"BBI"}),console.log("✅ Successfully removed BBI from pane:",A)}catch(R){console.log("❌ Error removing BBI indicator from pane:",A,R)}c.update(R=>{const G=`${A}_BBI`;return console.log("🧹 Cleaning saved state key:",G),delete R.saveInds[G],R})}else console.log("❌ Cannot remove BBI: no valid paneId found for group:",L);x(xt,D(n(xt).filter(R=>R.id!==b))),console.log("✅ BBI group removed from array. Remaining groups:",n(xt).length)}function Nn(){if(!n(Wo))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="TRIX").sort((w,L)=>w===`${i().editPaneId}_TRIX`?-1:L===`${i().editPaneId}_TRIX`?1:w.localeCompare(L));console.log("🔍 Found existing TRIX keys:",b),b.length>0?(x(Oi,D([])),b.forEach((w,L)=>{const A=r().saveInds[w];if(A)if(A.trixGroup){const E={...A.trixGroup};E.paneId||(E.paneId=A.pane_id||i().editPaneId),n(Oi).push(E)}else A.params&&A.params.length>=2&&n(Oi).push({id:Jn(),name:`TRIX${L+1}`,trixPeriod:A.params[0]||15,signalPeriod:A.params[1]||9,paneId:A.pane_id||i().editPaneId,styles:{trix:{color:"#2563eb",thickness:2,lineStyle:"solid"},signal:{color:"#dc2626",thickness:1,lineStyle:"solid"}}})}),console.log("✅ Loaded",n(Oi).length,"existing TRIX groups")):n(Oi).length===0&&(x(Oi,D([{id:Jn(),name:"TRIX",trixPeriod:15,signalPeriod:9,paneId:i().editPaneId,styles:{trix:{color:"#2563eb",thickness:2,lineStyle:"solid"},signal:{color:"#dc2626",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default TRIX group"))}function on(){if(!n(Wo))return;const b=`pane_TRIX_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,w={id:Jn(),name:`TRIX${n(Oi).length+1}`,trixPeriod:15,signalPeriod:9,paneId:b,styles:{trix:{color:"#2563eb",thickness:2,lineStyle:"solid"},signal:{color:"#dc2626",thickness:1,lineStyle:"solid"}}};if(n(Oi).push(w),s()){let L=Oe.Solid,A=[2,2],E=Oe.Solid,R=[2,2];if(w.styles.trix.lineStyle==="dashed"?(L=Oe.Dashed,A=[4,4]):w.styles.trix.lineStyle==="dotted"&&(L=Oe.Dashed,A=[2,2]),w.styles.signal.lineStyle==="dashed"?(E=Oe.Dashed,R=[4,4]):w.styles.signal.lineStyle==="dotted"&&(E=Oe.Dashed,R=[2,2]),s().createIndicator({name:"TRIX",calcParams:[w.trixPeriod,w.signalPeriod],styles:{lines:[{color:w.styles.trix.color,size:w.styles.trix.thickness,style:L,dashedValue:A},{color:w.styles.signal.color,size:w.styles.signal.thickness,style:E,dashedValue:R}]}},!1,{id:b})){const _e=`${b}_TRIX`;c.update(Be=>(Be.saveInds[_e]={name:"TRIX",pane_id:b,params:[w.trixPeriod,w.signalPeriod]},Be))}}console.log("➕ Added new TRIX group in new pane:",w.id,b)}function Pi(b){if(!n(Wo)||n(Oi).length<=1||b<0||b>=n(Oi).length)return;console.log("🗑️ Removing TRIX group at index:",b);const L=n(Oi)[b].paneId||i().editPaneId,A=n(Oi).length;if(n(Oi).splice(b,1),console.log(`📝 Removed group: ${A} -> ${n(Oi).length}`),s()&&L)try{console.log("🗑️ Removing TRIX from pane:",L),H(L,"TRIX")}catch(E){console.error("❌ Error removing TRIX indicator:",E)}console.log("✅ TRIX group removed. Remaining groups:",n(Oi).length)}function cs(){if(!n(yt))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="BIAS").sort((w,L)=>w===`${i().editPaneId}_BIAS`?-1:L===`${i().editPaneId}_BIAS`?1:w.localeCompare(L));console.log("🔍 Found existing BIAS keys:",b),b.length>0?(x(jo,D([])),b.forEach((w,L)=>{const A=r().saveInds[w];A&&(A.biasGroup?n(jo).push({...A.biasGroup}):A.params&&A.params.length>=1&&n(jo).push({id:Jn(),name:`BIAS${L+1}`,period:A.params[0]||6,color:"#2196F3",thickness:1,lineStyle:"solid"}))}),console.log("✅ Loaded",n(jo).length,"existing BIAS groups")):n(jo).length===0&&(x(jo,D([{id:Jn(),name:"BIAS",period:6,color:"#2196F3",thickness:1,lineStyle:"solid"}])),console.log("🆕 Created default BIAS group"))}function ur(){var L;if(!n(yt)||!s())return;console.log("🔄 Applying BIAS changes in real-time, groups:",n(jo).length);const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="BIAS").sort((A,E)=>A===`${i().editPaneId}_BIAS`?-1:E===`${i().editPaneId}_BIAS`?1:A.localeCompare(E));console.log("🔍 Existing BIAS keys:",b);const w=n(jo).length;if(b.length>w){console.log(`🗑️ Removing ${b.length-w} excess BIAS indicators`);for(let A=w;A<b.length;(A+=1)-1){const E=b[A],R=r().saveInds[E];if(R&&R.pane_id){console.log("🗑️ Removing BIAS indicator from pane:",R.pane_id);try{(L=s())==null||L.removeIndicator({paneId:R.pane_id,name:"BIAS"})}catch(G){console.log("Error removing excess BIAS indicator:",G)}}}}n(jo).forEach((A,E)=>{var _e,Be,_t;const R=[A.period],G={lines:[{color:A.color,size:A.thickness,style:A.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:A.lineStyle==="dashed"?[4,4]:A.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(E===0)console.log("🔄 Updating first BIAS indicator in pane:",i().editPaneId),(_e=s())==null||_e.overrideIndicator({name:"BIAS",calcParams:R,styles:G,paneId:i().editPaneId});else{const Yo=`pane_BIAS_${E+1}_BIAS`,$o=b.find(so=>so===Yo);if($o){const so=r().saveInds[$o];so&&so.pane_id&&(console.log(`🔄 Updating existing BIAS ${E+1} in pane:`,so.pane_id),(Be=s())==null||Be.overrideIndicator({name:"BIAS",calcParams:R,styles:G,paneId:so.pane_id}))}else{const so=`pane_BIAS_${E+1}`;console.log(`🆕 Creating new BIAS ${E+1} with pane ID:`,so),(_t=s())==null||_t.createIndicator({name:"BIAS",calcParams:R,styles:G},!0,{id:so})}}}),c.update(A=>(Object.keys(A.saveInds).forEach(E=>{A.saveInds[E].name==="BIAS"&&delete A.saveInds[E]}),n(jo).forEach((E,R)=>{const G=R===0?`${i().editPaneId}_BIAS`:`pane_BIAS_${R+1}_BIAS`,_e=R===0?i().editPaneId:`pane_BIAS_${R+1}`;console.log(`💾 Saving BIAS group ${R+1} with key:`,G),A.saveInds[G]={name:"BIAS",biasGroup:E,pane_id:_e,groupIndex:R,biasGroups:R===0?[...n(jo)]:void 0,params:[E.period]}}),A))}function Or(b){if(!n(yt)||n(jo).length<=1)return;const w=n(jo).findIndex(L=>L.id===b);w!==-1&&(console.log("🗑️ Removing BIAS group at index:",w,"ID:",b),x(jo,D(n(jo).filter(L=>L.id!==b))),ur(),console.log("✅ BIAS group removed. Remaining groups:",n(jo).length))}function Jo(){if(!n(Kr))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="CCI").sort((w,L)=>w===`${i().editPaneId}_CCI`?-1:L===`${i().editPaneId}_CCI`?1:w.localeCompare(L));if(console.log("🔍 Found existing CCI keys:",b),b.length>0){x(Ci,D([]));let w=1;b.forEach((L,A)=>{const E=r().saveInds[L];if(E)if(E.cciGroup){const R={...E.cciGroup};R.name=w===1?"CCI":`CCI${w}`,n(Ci).push(R),w+=1}else E.params&&E.params.length>=1&&(n(Ci).push({id:Jn(),name:w===1?"CCI":`CCI${w}`,period:E.params[0]||14,color:"#FF9800",thickness:1,lineStyle:"solid"}),w+=1)}),console.log("✅ Loaded",n(Ci).length,"existing CCI groups with proper naming")}else n(Ci).length===0&&(x(Ci,D([{id:Jn(),name:"CCI",period:14,color:"#FF9800",thickness:1,lineStyle:"solid"}])),console.log("🆕 Created default CCI group"))}function zs(){if(!n(Kr)||!s())return;console.log("🔄 Applying CCI changes in real-time, groups:",n(Ci).length);const b=Object.keys(r().saveInds).filter(R=>r().saveInds[R].name==="CCI").sort((R,G)=>R===`${i().editPaneId}_CCI`?-1:G===`${i().editPaneId}_CCI`?1:R.localeCompare(G));console.log("🔍 Existing CCI keys:",b);const w=new Map,L=new Set;n(Ci).forEach((R,G)=>{let _e=null;for(const Be of b){if(L.has(Be))continue;const _t=r().saveInds[Be];if(_t&&_t.cciGroup&&_t.cciGroup.id===R.id){_e=Be,L.add(Be);break}}if(!_e){if(G===0&&!L.has(`${i().editPaneId}_CCI`))_e=`${i().editPaneId}_CCI`;else{let Be=2;for(;L.has(`pane_CCI_${Be}_CCI`)||b.includes(`pane_CCI_${Be}_CCI`);)Be+=1;_e=`pane_CCI_${Be}_CCI`}L.add(_e)}w.set(R.id,_e)});const A=Array.from(w.values()),E=b.filter(R=>!A.includes(R));E.forEach(R=>{var _e;const G=r().saveInds[R];if(G&&G.pane_id){console.log("🗑️ Removing CCI indicator from pane:",G.pane_id,"key:",R);try{(_e=s())==null||_e.removeIndicator({paneId:G.pane_id,name:"CCI"})}catch(Be){console.log("Error removing excess CCI indicator:",Be)}}}),n(Ci).forEach((R,G)=>{var $o,so;const _e=[R.period],Be=w.get(R.id),_t={lines:[{color:R.color,size:R.thickness,style:R.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.lineStyle==="dashed"?[4,4]:R.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},Yo=b.includes(Be)?r().saveInds[Be]:null;if(Yo&&Yo.pane_id)console.log("🔄 Updating existing CCI in pane:",Yo.pane_id),($o=s())==null||$o.overrideIndicator({name:"CCI",calcParams:_e,styles:_t,paneId:Yo.pane_id});else{const cn=Be===`${i().editPaneId}_CCI`?i().editPaneId:Be.replace("_CCI","");console.log("🆕 Creating new CCI with pane ID:",cn,"key:",Be),(so=s())==null||so.createIndicator({name:"CCI",calcParams:_e,styles:_t},!0,{id:cn})}}),c.update(R=>(E.forEach(G=>{delete R.saveInds[G],console.log("🗑️ Deleted save data for key:",G)}),n(Ci).forEach((G,_e)=>{const Be=w.get(G.id),_t=Be===`${i().editPaneId}_CCI`?i().editPaneId:Be.replace("_CCI","");console.log(`💾 Saving CCI group ${_e+1} with key:`,Be),R.saveInds[Be]={name:"CCI",cciGroup:G,pane_id:_t,groupIndex:_e,cciGroups:_e===0?[...n(Ci)]:void 0,params:[G.period]}}),R))}function Zo(b){if(!n(Kr)||n(Ci).length<=1)return;const w=n(Ci).findIndex(L=>L.id===b);w!==-1&&(console.log("🗑️ Removing CCI group at index:",w,"ID:",b),x(Ci,D(n(Ci).filter(L=>L.id!==b))),zs(),console.log("✅ CCI group removed. Remaining groups:",n(Ci).length))}function br(){if(!n(Go))return;const w=Object.values(r().saveInds||{}).filter(L=>(L==null?void 0:L.name)==="SAR").filter(L=>(L==null?void 0:L.pane_id)==="candle_pane");if(w.length>0){const L=w[0];L.sarGroups&&Array.isArray(L.sarGroups)&&L.sarGroups.length>0?x(Rn,D([...L.sarGroups])):x(Rn,D(w.map(A=>{const[E=.02,R=.02,G=.2]=A.params||[];return{id:Jn(),start:E,increment:R,maxValue:G,color:"#2563eb",dotSize:1}})))}else x(Rn,D([{id:Jn(),start:.02,increment:.02,maxValue:.2,color:"#2563eb",dotSize:1}]));s()&&n(Rn).length>0&&Xr()}function cc(b){!n(Go)||n(Rn).length<=1||(x(Rn,D(n(Rn).filter(w=>w.id!==b))),Xr())}function Xs(b){!n(Go)||!s()||b>=n(Rn).length||Xr()}function Xr(){if(!s()||!n(Go))return;const b="candle_pane";for(let w=0;w<6;(w+=1)-1)try{s().removeIndicator({paneId:b,name:"SAR"})}catch{}n(Rn).forEach(w=>{var E;const L=[w.start,w.increment,w.maxValue],A={lines:[{color:w.color,size:w.dotSize,style:Oe.Solid}]};(E=s())==null||E.createIndicator({name:"SAR",calcParams:L,styles:A},!0,{id:b})})}function Ji(){if(!n(dl))return;const b=`${i().editPaneId}_SMARTTREND`,w=r().saveInds[b];if(w&&w.superTrendGroups&&w.superTrendGroups.length>0)x(Os,D([...w.superTrendGroups]));else if(w&&Array.isArray(w.params)){const L=Number(w.params[0]??10),A=Number(w.params[1]??3);x(Os,D([{id:Jn(),period:L,multiplier:A,showLabels:!0,styles:{uptrend:{color:"#00FF00",thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}}]))}else n(Os).length===0&&x(Os,D([{id:Jn(),period:10,multiplier:3,showLabels:!0,styles:{uptrend:{color:"#00FF00",thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}}]));Ga()}function Gi(b){!n(dl)||n(Os).length<=1||(x(Os,D(n(Os).filter(w=>w.id!==b))),Ga())}function jn(b){!n(dl)||!s()||b>=n(Os).length||(n(Os)[b],Ga())}function Ga(){if(!s()||!n(dl))return;const b="candle_pane";for(let w=0;w<6;(w+=1)-1)try{s().removeIndicator({paneId:b,name:"SMARTTREND"})}catch{}n(Os).forEach((w,L)=>{var R;const A=[w.period,w.multiplier],E={lines:[{color:w.styles.uptrend.color,size:w.styles.uptrend.thickness,style:w.styles.uptrend.lineStyle==="dashed"?Oe.Dashed:Oe.Solid}]};(R=s())==null||R.createIndicator({name:"SMARTTREND",calcParams:A,styles:E,extendData:{showLabels:w.showLabels,uptrendColor:w.styles.uptrend.color,downtrendColor:w.styles.downtrend.color,uptrendThickness:w.styles.uptrend.thickness,downtrendThickness:w.styles.downtrend.thickness,uptrendLineStyle:w.styles.uptrend.lineStyle,downtrendLineStyle:w.styles.downtrend.lineStyle}},!0,{id:b})}),c.update(w=>(Object.keys(w.saveInds).forEach(L=>{w.saveInds[L].name==="SMARTTREND"&&delete w.saveInds[L]}),n(Os).forEach((L,A)=>{const E=A===0?`${b}_SMARTTREND`:`${b}_SMARTTREND_${A+1}`;w.saveInds[E]={name:"SMARTTREND",pane_id:b,params:[L.period,L.multiplier],superTrendGroup:L,groupIndex:A}}),w))}function fa(){if(!n(Fo))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="DMI").sort((w,L)=>w===`${i().editPaneId}_DMI`?-1:L===`${i().editPaneId}_DMI`?1:w.localeCompare(L));if(console.log("🔍 Found existing DMI keys:",b),b.length>0){x(Pn,D([]));let w=1;b.forEach((L,A)=>{const E=r().saveInds[L];if(E.dmiGroup){const R={...E.dmiGroup};R.name=w===1?"DMI":`DMI${w}`,n(Pn).push(R),w+=1}else E.params&&E.params.length>=2&&(n(Pn).push({id:Jn(),name:w===1?"DMI":`DMI${w}`,diPeriod:E.params[0]||14,adxPeriod:E.params[1]||6,styles:{diPlus:{color:"#22c55e",thickness:1,lineStyle:"solid"},diMinus:{color:"#ef4444",thickness:1,lineStyle:"solid"},adx:{color:"#3b82f6",thickness:1,lineStyle:"solid"}}}),w+=1)}),console.log("✅ Loaded",n(Pn).length,"existing DMI groups with proper naming")}else n(Pn).length===0&&(x(Pn,D([{id:Jn(),name:"DMI",diPeriod:14,adxPeriod:6,styles:{diPlus:{color:"#22c55e",thickness:1,lineStyle:"solid"},diMinus:{color:"#ef4444",thickness:1,lineStyle:"solid"},adx:{color:"#3b82f6",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default DMI group"))}function Ba(){if(!n(gi))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="CR").sort((w,L)=>w===`${i().editPaneId}_CR`?-1:L===`${i().editPaneId}_CR`?1:w.localeCompare(L));console.log("🔍 Found existing CR keys:",b),b.length>0?(x(pi,D([])),b.forEach((w,L)=>{var E,R,G,_e,Be;const A=r().saveInds[w];A.crGroup?n(pi).push({...A.crGroup}):n(pi).push({id:Jn(),name:`CR${L+1}`,crPeriod:((E=A.params)==null?void 0:E[0])||26,crMa1Period:((R=A.params)==null?void 0:R[1])||10,crMa2Period:((G=A.params)==null?void 0:G[2])||20,crMa3Period:((_e=A.params)==null?void 0:_e[3])||40,crMa4Period:((Be=A.params)==null?void 0:Be[4])||60,styles:{cr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},ma1:{color:"#2196F3",thickness:1,lineStyle:"solid"},ma2:{color:"#4CAF50",thickness:1,lineStyle:"solid"},ma3:{color:"#FF9800",thickness:1,lineStyle:"solid"},ma4:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}})}),console.log("✅ Loaded",n(pi).length,"existing CR groups")):n(pi).length===0&&(x(pi,D([{id:Jn(),name:"CR",crPeriod:26,crMa1Period:10,crMa2Period:20,crMa3Period:40,crMa4Period:60,styles:{cr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},ma1:{color:"#2196F3",thickness:1,lineStyle:"solid"},ma2:{color:"#4CAF50",thickness:1,lineStyle:"solid"},ma3:{color:"#FF9800",thickness:1,lineStyle:"solid"},ma4:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default CR group"))}function bn(){if(!n(Fo)||!s())return;console.log("🔄 Applying DMI changes in real-time, groups:",n(Pn).length);const b=Object.keys(r().saveInds).filter(R=>r().saveInds[R].name==="DMI").sort((R,G)=>R===`${i().editPaneId}_DMI`?-1:G===`${i().editPaneId}_DMI`?1:R.localeCompare(G));console.log("🔍 Existing DMI keys:",b);const w=new Map,L=new Set;n(Pn).forEach((R,G)=>{for(const _e of b){if(L.has(_e))continue;const Be=r().saveInds[_e];if(Be&&Be.dmiGroup&&Be.dmiGroup.id===R.id){w.set(R.id,_e),L.add(_e),console.log(`✅ Matched group ${G+1} (ID: ${R.id}) to existing key: ${_e}`);break}}}),n(Pn).forEach((R,G)=>{if(w.has(R.id))return;let _e=null;if(G===0&&!L.has(`${i().editPaneId}_DMI`)&&!b.includes(`${i().editPaneId}_DMI`))_e=`${i().editPaneId}_DMI`;else{let Be=2;for(;L.has(`pane_DMI_${Be}_DMI`)||b.includes(`pane_DMI_${Be}_DMI`);)Be+=1;_e=`pane_DMI_${Be}_DMI`}w.set(R.id,_e),L.add(_e),console.log(`🆕 Assigned new key for group ${G+1} (ID: ${R.id}): ${_e}`)});const A=Array.from(w.values()),E=b.filter(R=>!A.includes(R));E.forEach(R=>{var _e;const G=r().saveInds[R];if(G&&G.pane_id){console.log("🗑️ Removing DMI indicator from pane:",G.pane_id,"key:",R);try{(_e=s())==null||_e.removeIndicator({paneId:G.pane_id,name:"DMI"})}catch(Be){console.log("Error removing excess DMI indicator:",Be)}}}),n(Pn).forEach((R,G)=>{var cn,_i,ac,xd;const _e=[R.diPeriod,R.adxPeriod],Be=w.get(R.id),_t=G===0?i().editPaneId:`pane_DMI_${G+1}`;console.log(`📍 Group ${G+1} (ID: ${R.id}) -> Target pane: ${_t}, Save key: ${Be}`);const Yo={lines:[{color:R.styles.diPlus.color,size:R.styles.diPlus.thickness,style:R.styles.diPlus.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.diPlus.lineStyle==="dashed"?[4,4]:R.styles.diPlus.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:R.styles.diMinus.color,size:R.styles.diMinus.thickness,style:R.styles.diMinus.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.diMinus.lineStyle==="dashed"?[4,4]:R.styles.diMinus.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:R.styles.adx.color,size:R.styles.adx.thickness,style:R.styles.adx.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.adx.lineStyle==="dashed"?[4,4]:R.styles.adx.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},$o=b.includes(Be)?r().saveInds[Be]:null,so=$o==null?void 0:$o.pane_id;if(so&&so!==_t){console.log(`🔀 Moving DMI from pane ${so} to ${_t}`);try{(cn=s())==null||cn.removeIndicator({paneId:so,name:"DMI"})}catch(fu){console.log("Note: Indicator may not exist in old pane:",fu)}(_i=s())==null||_i.createIndicator({name:"DMI",calcParams:_e,styles:Yo},!0,{id:_t})}else so?(console.log(`🔄 Updating existing DMI in pane: ${_t}`),(ac=s())==null||ac.overrideIndicator({name:"DMI",calcParams:_e,styles:Yo,paneId:_t})):(console.log(`🆕 Creating new DMI in pane: ${_t}`),(xd=s())==null||xd.createIndicator({name:"DMI",calcParams:_e,styles:Yo},!0,{id:_t}))}),c.update(R=>(E.forEach(G=>{delete R.saveInds[G],console.log("🗑️ Deleted save data for key:",G)}),n(Pn).forEach((G,_e)=>{const Be=w.get(G.id),_t=_e===0?i().editPaneId:`pane_DMI_${_e+1}`;console.log(`💾 Saving DMI group ${_e+1} with key: ${Be}, pane: ${_t}`),R.saveInds[Be]={name:"DMI",dmiGroup:G,pane_id:_t,groupIndex:_e,dmiGroups:_e===0?[...n(Pn)]:void 0,params:[G.diPeriod,G.adxPeriod]}}),R))}function yd(b){if(!n(Fo)||n(Pn).length<=1)return;const w=n(Pn).findIndex(L=>L.id===b);w!==-1&&(console.log("🗑️ Removing DMI group at index:",w,"ID:",b),x(Pn,D(n(Pn).filter(L=>L.id!==b))),bn(),console.log("✅ DMI group removed. Remaining groups:",n(Pn).length))}function qo(){if(!n(gi)||!s())return;console.log("🔄 Applying CR changes in real-time, groups:",n(pi).length);const b=Object.keys(r().saveInds).filter(R=>r().saveInds[R].name==="CR").sort((R,G)=>R===`${i().editPaneId}_CR`?-1:G===`${i().editPaneId}_CR`?1:R.localeCompare(G));console.log("🔍 Existing CR keys:",b);const w=new Map,L=new Set;n(pi).forEach((R,G)=>{let _e=null;for(const Be of b){if(L.has(Be))continue;const _t=r().saveInds[Be];if(_t&&_t.crGroup&&_t.crGroup.id===R.id){_e=Be,L.add(Be);break}}if(!_e){if(G===0&&!L.has(`${i().editPaneId}_CR`))_e=`${i().editPaneId}_CR`;else{let Be=2;for(;L.has(`pane_CR_${Be}_CR`)||b.includes(`pane_CR_${Be}_CR`);)Be+=1;_e=`pane_CR_${Be}_CR`}L.add(_e)}w.set(R.id,_e)});const A=Array.from(w.values()),E=b.filter(R=>!A.includes(R));E.forEach(R=>{var _e;const G=r().saveInds[R];if(G&&G.pane_id){console.log("🗑️ Removing CR indicator from pane:",G.pane_id,"key:",R);try{(_e=s())==null||_e.removeIndicator({paneId:G.pane_id,name:"CR"})}catch(Be){console.log("Error removing excess CR indicator:",Be)}}}),n(pi).forEach((R,G)=>{var $o,so;const _e=[R.crPeriod,R.crMa1Period,R.crMa2Period,R.crMa3Period,R.crMa4Period],Be=w.get(R.id),_t={lines:[{color:R.styles.cr.color,size:R.styles.cr.thickness,style:R.styles.cr.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.cr.lineStyle==="dashed"?[4,4]:R.styles.cr.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:R.styles.ma1.color,size:R.styles.ma1.thickness,style:R.styles.ma1.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.ma1.lineStyle==="dashed"?[4,4]:R.styles.ma1.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:R.styles.ma2.color,size:R.styles.ma2.thickness,style:R.styles.ma2.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.ma2.lineStyle==="dashed"?[4,4]:R.styles.ma2.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:R.styles.ma3.color,size:R.styles.ma3.thickness,style:R.styles.ma3.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.ma3.lineStyle==="dashed"?[4,4]:R.styles.ma3.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:R.styles.ma4.color,size:R.styles.ma4.thickness,style:R.styles.ma4.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.styles.ma4.lineStyle==="dashed"?[4,4]:R.styles.ma4.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},Yo=b.includes(Be)?r().saveInds[Be]:null;if(Yo&&Yo.pane_id)console.log("🔄 Updating existing CR in pane:",Yo.pane_id),($o=s())==null||$o.overrideIndicator({name:"CR",calcParams:_e,styles:_t,paneId:Yo.pane_id});else{const cn=Be===`${i().editPaneId}_CR`?i().editPaneId:Be.replace("_CR","");console.log("🆕 Creating new CR with pane ID:",cn,"key:",Be),(so=s())==null||so.createIndicator({name:"CR",calcParams:_e,styles:_t},!0,{id:cn})}}),c.update(R=>(E.forEach(G=>{delete R.saveInds[G],console.log("🗑️ Deleted save data for key:",G)}),n(pi).forEach((G,_e)=>{const Be=w.get(G.id),_t=Be===`${i().editPaneId}_CR`?i().editPaneId:Be.replace("_CR","");console.log(`💾 Saving CR group ${_e+1} with key:`,Be),R.saveInds[Be]={name:"CR",crGroup:G,pane_id:_t,groupIndex:_e,crGroups:_e===0?[...n(pi)]:void 0,params:[G.crPeriod,G.crMa1Period,G.crMa2Period,G.crMa3Period,G.crMa4Period]}}),R))}function _l(b){if(!n(gi)||n(pi).length<=1)return;const w=n(pi).findIndex(L=>L.id===b);w!==-1&&(console.log("🗑️ Removing CR group at index:",w,"ID:",b),x(pi,D(n(pi).filter(L=>L.id!==b))),qo(),console.log("✅ CR group removed. Remaining groups:",n(pi).length))}function Kl(){if(!n(us))return;const b=`${i().editPaneId}_ROC`,w=r().saveInds[b];w&&w.rocGroups&&w.rocGroups.length>0?(x(an,D([...w.rocGroups])),n(an).forEach((L,A)=>{L.paneId||(L.paneId=A===0?i().editPaneId:void 0)})):w&&w.rocGroup?(x(an,D([w.rocGroup])),n(an)[0]&&!n(an)[0].paneId&&(n(an)[0].paneId=i().editPaneId)):n(an).length===0&&x(an,D([{id:Jn(),period:14,period2:21,paneId:i().editPaneId,styles:{roc:{color:"#2563eb",thickness:1,lineStyle:"solid"},roc2:{color:"#dc2626",thickness:1,lineStyle:"solid",visible:!1}}}]))}function Sl(){var b;if(!(!s()||!n(us)))try{const L=((b=s())==null?void 0:b.getIndicators()).filter(A=>A.name==="ROC");console.log("🔍 Detecting paneIds for ROC indicators:",L.length),L.forEach((A,E)=>{E<n(an).length&&!n(an)[E].paneId&&(n(an)[E].paneId=A.paneId,console.log(`📍 Set paneId ${A.paneId} for ROC group ${E}`))})}catch(w){console.error("❌ Error detecting ROC paneIds:",w)}}function Pa(){var _t,Yo;if(!n(us)||!s())return;const b=["#2563eb","#dc2626","#16a34a","#ca8a04","#9333ea","#c2410c"],w=n(an).length%b.length,L={id:Jn(),period:14,period2:21,paneId:void 0,styles:{roc:{color:b[w],thickness:1,lineStyle:"solid"},roc2:{color:b[(w+1)%b.length],thickness:1,lineStyle:"solid",visible:!1}}};n(an).push(L);const A=[L.period];let E=Oe.Solid,R=[2,2];L.styles.roc.lineStyle==="dashed"?(E=Oe.Dashed,R=[4,4]):L.styles.roc.lineStyle==="dotted"&&(E=Oe.Dashed,R=[2,2]);const G={lines:[{color:L.styles.roc.color,size:L.styles.roc.thickness,style:E,dashedValue:R,smooth:!1}]},_e={name:"ROC",calcParams:A,styles:G,figures:[{key:"roc",title:"ROC: ",type:"line"}]};let Be;n(an).length===1?((_t=s())==null||_t.overrideIndicator({..._e,paneId:i().editPaneId}),Be=i().editPaneId):Be=(Yo=s())==null?void 0:Yo.createIndicator(_e,!1,{axis:{gap:{bottom:2}}}),L.paneId=Be??void 0,c.update($o=>{const so=`${i().editPaneId}_ROC`;return $o.saveInds[so]||($o.saveInds[so]={name:"ROC",pane_id:i().editPaneId,params:[L.period],rocGroups:[]}),$o.saveInds[so].rocGroups||($o.saveInds[so].rocGroups=[]),$o.saveInds[so].rocGroups=[...n(an)],$o})}function Sc(b){var A,E;if(!n(us)||n(an).length<=1)return;const w=n(an).findIndex(R=>R.id===b);if(w===-1)return;console.log("🗑️ Removing ROC group at index:",w,"with ID:",b);const L=n(an).length;if(n(an).splice(w,1),console.log(`📝 Removed ROC group: ${L} -> ${n(an).length}`),n(an).forEach((R,G)=>{R.name=`ROC #${G+1}`}),s())try{const G=((A=s())==null?void 0:A.getIndicators()).filter(_e=>_e.name==="ROC");console.log("📈 ROC indicators found:",G.length);for(const _e of G)console.log("🗑️ Removing ROC from pane:",_e.paneId),(E=s())==null||E.removeIndicator({paneId:_e.paneId,name:"ROC"});n(an).forEach((_e,Be)=>{var cn;let _t=Oe.Solid,Yo=[2,2];_e.styles.roc.lineStyle==="dashed"?(_t=Oe.Dashed,Yo=[4,4]):_e.styles.roc.lineStyle==="dotted"&&(_t=Oe.Dashed,Yo=[2,2]);const $o={lines:[{color:_e.styles.roc.color,size:_e.styles.roc.thickness,style:_t,dashedValue:Yo}]};console.log("➕ Re-adding ROC group:",`ROC_${Be+1}`,"at index:",Be);const so=(cn=s())==null?void 0:cn.createIndicator({name:"ROC",calcParams:[_e.period],styles:$o,figures:[{key:"roc",title:"ROC: ",type:"line"}]},!1);so&&(_e.paneId=so,c.update(_i=>{const ac=`${so}_ROC`;return _i.saveInds[ac]||(_i.saveInds[ac]={name:"ROC",pane_id:so,rocGroups:[]}),_i.saveInds[ac].rocGroups||(_i.saveInds[ac].rocGroups=[]),_i.saveInds[ac].rocGroups[Be]={..._e},_i}))}),console.log("✅ Successfully updated ROC indicators on chart")}catch(R){console.error("❌ Error updating ROC indicators:",R)}console.log("✅ ROC group removed. Remaining groups:",n(an).length)}function ai(b){var G,_e;const w=n(an)[b];if(!w||!s()){console.warn("❌ updateRocIndicator: Missing group or chart",{group:w,chart:!!s()});return}console.log("🔄 updateRocIndicator called:",{groupIndex:b,group:w});let L=Oe.Solid,A=[2,2];w.styles.roc.lineStyle==="dashed"?(L=Oe.Dashed,A=[4,4]):w.styles.roc.lineStyle==="dotted"&&(L=Oe.Dashed,A=[2,2]);const R=((G=s())==null?void 0:G.getIndicators()).filter(Be=>Be.name==="ROC");if(console.log("📊 Found ROC indicators on chart:",R.length),console.log("📊 Looking for group index:",b),R.length>b){const Be=R[b];console.log("✅ Found matching ROC indicator by index, updating styles...");const _t=(_e=s())==null?void 0:_e.overrideIndicator({name:"ROC",paneId:Be.paneId,calcParams:[w.period],styles:{lines:[{color:w.styles.roc.color,size:w.styles.roc.thickness,style:L,dashedValue:A,smooth:!1}]},figures:[{key:"roc",title:"ROC: ",type:"line"}]});console.log("🎨 overrideIndicator result:",_t),console.log("🎨 Applied styles:",{color:w.styles.roc.color,size:w.styles.roc.thickness,style:L,dashedValue:A});const Yo=`${Be.paneId}_ROC`;console.log("💾 Using save key:",Yo),c.update($o=>{$o.saveInds[Yo]||($o.saveInds[Yo]={name:"ROC",pane_id:Be.paneId,params:[w.period],rocGroups:[]}),$o.saveInds[Yo].rocGroups||($o.saveInds[Yo].rocGroups=[]);const so=$o.saveInds[Yo].rocGroups||[];for(;so.length<=b;)so.push({});return so[b]={...w},$o.saveInds[Yo].rocGroups=so,$o.saveInds[Yo].params=[w.period],console.log("💾 Persisted ROC changes to save data:",Yo,w),$o}),console.log("✅ ROC indicator updated successfully:",b,w)}else console.error("❌ ROC indicator not found on chart for group index:",b),console.log("📊 Available ROC indicators:",R.length),console.log("📊 Requested group index:",b)}function Ir(){if(!n(or))return;x(ps,D([]));const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="PSY").sort((w,L)=>w===`${i().editPaneId}_PSY`?-1:L===`${i().editPaneId}_PSY`?1:w.localeCompare(L));b.length>0?x(ps,D(b.map((w,L)=>{const A=r().saveInds[w];if(A.psyGroup)return{...A.psyGroup,id:A.psyGroup.id||Jn(),actualPaneId:A.pane_id};if(A.psyGroups){const E=A.psyGroups[L]||A.psyGroups[0];return{...E,id:E.id||Jn(),actualPaneId:A.pane_id}}else{const[E=12,R=6]=A.params||[12,6],G=["#2563eb","#dc2626","#16a34a","#ca8a04","#9333ea","#c2410c"];return{id:Jn(),psyPeriod:E,mapsyPeriod:R,showMapsy:!0,actualPaneId:A.pane_id,styles:{psy:{color:G[L%G.length],thickness:1,lineStyle:"solid"},mapsy:{color:G[(L+1)%G.length],thickness:1,lineStyle:"solid"}}}}}))):n(ps).push({id:Jn(),psyPeriod:12,mapsyPeriod:6,showMapsy:!0,styles:{psy:{color:"#2563eb",thickness:1,lineStyle:"solid"},mapsy:{color:"#dc2626",thickness:1,lineStyle:"solid"}}}),x(ps,D(n(ps).map(w=>({...w,id:w.id||Jn()}))))}function nr(){var E;if(!n(or))return;const b=["#2563eb","#dc2626","#16a34a","#ca8a04","#9333ea","#c2410c"],w=n(ps).length%b.length,L={id:Jn(),psyPeriod:12,mapsyPeriod:6,showMapsy:!0,actualPaneId:void 0,styles:{psy:{color:b[w],thickness:1,lineStyle:"solid"},mapsy:{color:b[(w+1)%b.length],thickness:1,lineStyle:"solid"}}};if(n(ps).push(L),n(ps).length>1){let R=2;for(;Object.keys(r().saveInds).some(_i=>_i===`psy_${String(R).padStart(3,"0")}_PSY`);)R+=1;const G=n(ps).length-1,_e=[L.psyPeriod,L.mapsyPeriod],Be=[{key:"psy",title:"PSY: ",type:"line"}];L.showMapsy&&Be.push({key:"mapsy",title:"MAPSY: ",type:"line"});const _t={lines:[]};let Yo=Oe.Solid,$o=[2,2];if(L.styles.psy.lineStyle==="dashed"?(Yo=Oe.Dashed,$o=[4,4]):L.styles.psy.lineStyle==="dotted"&&(Yo=Oe.Dashed,$o=[2,2]),_t.lines.push({color:L.styles.psy.color,size:L.styles.psy.thickness,style:Yo,dashedValue:$o,smooth:!1}),L.showMapsy){let _i=Oe.Solid,ac=[2,2];L.styles.mapsy.lineStyle==="dashed"?(_i=Oe.Dashed,ac=[4,4]):L.styles.mapsy.lineStyle==="dotted"&&(_i=Oe.Dashed,ac=[2,2]),_t.lines.push({color:L.styles.mapsy.color,size:L.styles.mapsy.thickness,style:_i,dashedValue:ac,smooth:!1})}const so=`psy_${String(R).padStart(3,"0")}`;console.log(`🆕 Immediately creating PSY ${R} with pane ID:`,so),((E=s())==null?void 0:E.createIndicator({name:"PSY",calcParams:_e,styles:_t,figures:Be},!1,{id:so,axis:{gap:{bottom:2}}}))&&(console.log(`✅ PSY ${R} created with pane ID:`,so),L.actualPaneId=so,c.update(_i=>{const ac=`psy_${String(R).padStart(3,"0")}_PSY`;return _i.saveInds[ac]={name:"PSY",psyGroup:L,pane_id:so,groupIndex:G,params:[L.psyPeriod,L.mapsyPeriod]},_i}))}else console.log("📝 New PSY group will be added to edit pane on confirm")}function il(b){var L,A,E;if(!n(or)||n(ps).length<=1)return;const w=n(ps).findIndex(R=>R.id===b);if(w!==-1){console.log("🗑️ Removing PSY group at index:",w,"ID:",b);try{if(w===0&&n(ps).length>1){console.log("🔄 Special handling: First PSY removed, promoting second PSY to first position"),x(ps,D(n(ps).filter(G=>G.id!==b))),console.log("✅ PSY group removed from array. Remaining groups:",n(ps).length);const R=n(ps)[0];R.actualPaneId&&(console.log("🗑️ Removing old second PSY from sub-pane:",R.actualPaneId),(L=s())==null||L.removeIndicator({paneId:R.actualPaneId,name:"PSY"})),R.actualPaneId=void 0,console.log("📊 Updating PSY in edit pane with new first group settings"),Dr(0)}else{const R=`pane_PSY_${w+1}_PSY`;if(r().saveInds[R]){const G=r().saveInds[R];console.log("🗑️ Removing PSY from pane:",G.pane_id),(A=s())==null||A.removeIndicator({paneId:G.pane_id,name:"PSY"}),console.log("✅ Successfully removed PSY from pane:",G.pane_id)}else{const G=n(ps)[w];G.actualPaneId&&(console.log("🗑️ Removing PSY from actual pane:",G.actualPaneId),(E=s())==null||E.removeIndicator({paneId:G.actualPaneId,name:"PSY"}),console.log("✅ Successfully removed PSY from actual pane:",G.actualPaneId))}x(ps,D(n(ps).filter(G=>G.id!==b))),console.log("✅ PSY group removed from array. Remaining groups:",n(ps).length)}c.update(R=>(Object.keys(R.saveInds).forEach(G=>{R.saveInds[G].name==="PSY"&&(console.log("🧹 Cleaning saved state for key:",G),delete R.saveInds[G])}),n(ps).forEach((G,_e)=>{const Be=_e===0?`${i().editPaneId}_PSY`:`pane_PSY_${_e+1}_PSY`,_t=_e===0?i().editPaneId:G.actualPaneId||`pane_PSY_${_e+1}`;R.saveInds[Be]={name:"PSY",psyGroup:G,pane_id:_t,groupIndex:_e,psyGroups:_e===0?[...n(ps)]:void 0,params:[G.psyPeriod,G.mapsyPeriod]},console.log("💾 Re-saved PSY group",_e,"with key:",Be,"and pane ID:",_t)}),R))}catch(R){console.error("❌ Error removing PSY group:",R)}}}function Dr(b){var Be;const w=n(ps)[b];if(!w||!s())return;const L=b===0?i().editPaneId:w.actualPaneId||`psy_${String(b+1).padStart(3,"0")}`,A=[{key:"psy",title:"PSY: ",type:"line"}];w.showMapsy&&A.push({key:"mapsy",title:"MAPSY: ",type:"line"});const E={lines:[]};let R=Oe.Solid,G=[2,2];if(w.styles.psy.lineStyle==="dashed"?(R=Oe.Dashed,G=[4,4]):w.styles.psy.lineStyle==="dotted"&&(R=Oe.Dashed,G=[2,2]),E.lines.push({color:w.styles.psy.color,size:w.styles.psy.thickness,style:R,dashedValue:G,smooth:!1}),w.showMapsy){let _t=Oe.Solid,Yo=[2,2];w.styles.mapsy.lineStyle==="dashed"?(_t=Oe.Dashed,Yo=[4,4]):w.styles.mapsy.lineStyle==="dotted"&&(_t=Oe.Dashed,Yo=[2,2]),E.lines.push({color:w.styles.mapsy.color,size:w.styles.mapsy.thickness,style:_t,dashedValue:Yo,smooth:!1})}(Be=s())==null||Be.overrideIndicator({name:"PSY",paneId:L,styles:E,calcParams:[w.psyPeriod,w.mapsyPeriod],figures:A});const _e=b===0?`${i().editPaneId}_PSY`:`psy_${String(b+1).padStart(3,"0")}_PSY`;c.update(_t=>(_t.saveInds[_e]&&(_t.saveInds[_e].params=[w.psyPeriod,w.mapsyPeriod],_t.saveInds[_e].psyGroup={...w},console.log("💾 Persisted PSY changes to save data:",_e,w)),_t)),console.log("🔄 Updated PSY indicator:",b,w)}function qc(){if(!n($s))return;x(_s,D([]));const b=Object.entries(r().saveInds).filter(([w,L])=>L.name==="OBV");b.length>0?(b.sort(([w,L],[A,E])=>{const R=L.groupIndex||0,G=E.groupIndex||0;return R-G}),b.forEach(([w,L])=>{var E,R;const A=L;if(A.obvGroup){const G=A.obvGroup;A.pane_id&&(G.actualPaneId=A.pane_id),n(_s).push(G)}else if(A.obvGroups&&A.obvGroups.length>0)x(_s,D([...A.obvGroups])),n(_s).forEach((G,_e)=>{G.actualPaneId||(_e===0?G.actualPaneId=i().editPaneId:A.pane_id&&(G.actualPaneId=A.pane_id))});else{const G={id:Jn(),obvPeriod:((E=A.params)==null?void 0:E[0])||30,maobvPeriod:((R=A.params)==null?void 0:R[1])||10,showMaobv:!0,actualPaneId:void 0,styles:{obv:{color:"#FF6B35",thickness:2,lineStyle:"solid"},maobv:{color:"#2196F3",thickness:1,lineStyle:"solid"}}};A.pane_id&&(G.actualPaneId=A.pane_id),n(_s).push(G)}})):n(_s).push({id:Jn(),obvPeriod:30,maobvPeriod:10,showMaobv:!0,actualPaneId:i().editPaneId,styles:{obv:{color:"#FF6B35",thickness:2,lineStyle:"solid"},maobv:{color:"#2196F3",thickness:1,lineStyle:"solid"}}})}function ld(){if(!n($s))return;const b=["#FF6B35","#2196F3","#16a34a","#ca8a04","#9333ea","#c2410c"],w=n(_s).length%b.length,L={id:Jn(),obvPeriod:30,maobvPeriod:10,showMaobv:!0,actualPaneId:void 0,styles:{obv:{color:b[w],thickness:2,lineStyle:"solid"},maobv:{color:b[(w+1)%b.length],thickness:1,lineStyle:"solid"}}},A=new Set;n(_s).forEach(G=>{G.actualPaneId&&A.add(G.actualPaneId)}),Object.keys(r().saveInds).forEach(G=>{r().saveInds[G]&&r().saveInds[G].name==="OBV"&&r().saveInds[G].pane_id&&A.add(r().saveInds[G].pane_id)}),console.log("🔍 Existing OBV pane IDs:",Array.from(A));let E=2;for(;A.has(`pane_OBV_${E}`);)E+=1;const R=`pane_OBV_${E}`;L.actualPaneId=R,console.log("✅ Adding new OBV group with pane ID:",R),n(_s).push(L),Vd()}function pu(b){var A;if(!n($s)||n(_s).length<=1)return;x(Ft,!0),console.log("🚫 Set obvRemovalInProgress = true");const w=n(_s).findIndex(E=>E.id===b);if(w===-1){x(Ft,!1);return}const L=n(_s)[w];console.log("🗑️ Removing OBV group at index:",w,"ID:",b),console.log("🗑️ Group to remove:",L);try{let E;E=L.actualPaneId,E||Object.keys(r().saveInds).forEach(R=>{const G=r().saveInds[R];G&&G.name==="OBV"&&G.groupIndex===w&&(E=G.pane_id)}),!E&&w===0&&(E=i().editPaneId),console.log("🗑️ Removing OBV at index",w,"from pane:",E),E&&(console.log("🗑️ Removing OBV indicator from pane:",E),(A=s())==null||A.removeIndicator({paneId:E,name:"OBV"}),console.log("✅ Successfully removed OBV from pane:",E)),x(_s,D(n(_s).filter(R=>R.id!==b))),console.log("✅ OBV group removed from array. Remaining groups:",n(_s).length),c.update(R=>{const G=[];return Object.keys(R.saveInds).forEach(_e=>{R.saveInds[_e]&&R.saveInds[_e].name==="OBV"&&G.push(_e)}),console.log("🧹 Clearing all OBV save data:",G),G.forEach(_e=>delete R.saveInds[_e]),n(_s).forEach((_e,Be)=>{const _t=_e.actualPaneId||i().editPaneId;if(!_t){console.error(`❌ No pane ID for OBV group ${Be} during removal cleanup`);return}const Yo=`${_t}_OBV`;R.saveInds[Yo]={name:"OBV",obvGroup:_e,pane_id:_t,groupIndex:Be,obvGroups:Be===0?[...n(_s)]:void 0,params:[_e.obvPeriod,_e.maobvPeriod]},console.log("💾 Re-saved OBV group",Be,"with key:",Yo,"pane:",_t)}),R}),console.log("✅ OBV removal and reindexing completed"),setTimeout(()=>{x(Ft,!1),console.log("✅ Reset obvRemovalInProgress = false")},200)}catch(E){console.error("❌ Error removing OBV group:",E)}}function Vd(){if(!(!n($s)||!s()))try{console.log("🔄 Applying OBV changes to chart..."),console.log("🔧 Current OBV groups:",n(_s).length);const b=Object.keys(r().saveInds).filter(L=>r().saveInds[L]&&r().saveInds[L].name==="OBV");console.log("🔧 Existing OBV keys in save data:",b);const w=new Set;n(_s).forEach((L,A)=>{const E=L.actualPaneId||i().editPaneId;w.add(E)}),console.log("🔧 Pane IDs that should exist:",Array.from(w)),b.forEach(L=>{var E;const A=r().saveInds[L];if(A&&A.pane_id&&!w.has(A.pane_id))try{console.log("🗑️ Removing stale OBV indicator from pane:",A.pane_id),(E=s())==null||E.removeIndicator({paneId:A.pane_id,name:"OBV"})}catch(R){console.log("❌ Error removing stale OBV indicator:",R)}}),n(_s).forEach((L,A)=>{var G,_e,Be;const E=[L.obvPeriod,L.maobvPeriod],R={lines:[{color:L.styles.obv.color,size:L.styles.obv.thickness,style:L.styles.obv.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:L.styles.obv.lineStyle==="dashed"?[4,4]:L.styles.obv.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:L.styles.maobv.color,size:L.styles.maobv.thickness,style:L.styles.maobv.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:L.styles.maobv.lineStyle==="dashed"?[4,4]:L.styles.maobv.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(A===0){const _t=L.actualPaneId||i().editPaneId;L.actualPaneId||(L.actualPaneId=i().editPaneId),console.log("🔄 Updating first OBV in pane:",_t),(G=s())==null||G.overrideIndicator({name:"OBV",calcParams:E,styles:R,paneId:_t})}else{const _t=L.actualPaneId||`pane_OBV_${A+1}`;if(b.find($o=>{const so=r().saveInds[$o];return so&&so.pane_id===_t}))console.log("🔄 Updating existing OBV in pane:",_t),(_e=s())==null||_e.overrideIndicator({name:"OBV",calcParams:E,styles:R,paneId:_t}),L.actualPaneId=_t;else{const $o=L.actualPaneId||`pane_OBV_${A+1}`;console.log("🆕 Creating new OBV in pane:",$o);const so=(Be=s())==null?void 0:Be.createIndicator({name:"OBV",calcParams:E,styles:R},!0,{id:$o,axis:{gap:{bottom:2}}});so&&(L.actualPaneId=$o,console.log("✅ Created new OBV indicator with ID:",so,"in pane:",$o))}}}),c.update(L=>{try{Object.keys(L.saveInds).forEach(A=>{L.saveInds[A]&&L.saveInds[A].name==="OBV"&&delete L.saveInds[A]}),n(_s).forEach((A,E)=>{try{const R=A.actualPaneId||i().editPaneId;if(!R){console.error(`❌ No pane ID for OBV group ${E}`);return}const G=`${R}_OBV`,_e={name:"OBV",obvGroup:A,pane_id:R,groupIndex:E,obvGroups:E===0?[...n(_s)]:void 0,params:[A.obvPeriod,A.maobvPeriod]};L.saveInds[G]=_e,console.log("💾 Saved OBV group",E,"with key:",G,"and pane ID:",R)}catch(R){console.error(`❌ Error saving OBV group ${E}:`,R)}})}catch(A){console.error("❌ Error in OBV save operation:",A)}return L}),console.log("✅ OBV changes applied successfully")}catch(b){console.error("❌ Critical error in applyObv:",b)}}function ku(){if(!n(_r))return;console.log("🔄 Initializing KDJ groups for edit pane:",i().editPaneId);const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="KDJ").sort((w,L)=>w===`${i().editPaneId}_KDJ`?-1:L===`${i().editPaneId}_KDJ`?1:w.localeCompare(L));console.log("🔍 Found KDJ keys:",b),b.length>0?(x(fn,D([])),b.forEach((w,L)=>{const A=r().saveInds[w];if(console.log(`🔄 Loading KDJ group ${L+1} from key:`,w,A),A){if(A.kdjGroup){const E={...A.kdjGroup};L>0&&A.pane_id&&(E.actualPaneId=A.pane_id),n(fn).push(E)}else if(A.params&&A.params.length>=2){const E={id:Jn(),kPeriod:A.params[0]||9,dPeriod:A.params[1]||3,actualPaneId:void 0,styles:{k:{color:"#FF6B35",thickness:1,lineStyle:"solid"},d:{color:"#2196F3",thickness:1,lineStyle:"solid"},j:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}};L>0&&A.pane_id&&(E.actualPaneId=A.pane_id),n(fn).push(E)}}}),console.log("✅ Loaded",n(fn).length,"existing KDJ groups")):n(fn).length===0&&(x(fn,D([{id:Jn(),kPeriod:9,dPeriod:3,styles:{k:{color:"#FF6B35",thickness:1,lineStyle:"solid"},d:{color:"#2196F3",thickness:1,lineStyle:"solid"},j:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default KDJ group"))}function Ou(){var A;if(!n(_r))return;const b=["#FF6B35","#2196F3","#9C27B0","#16a34a","#ca8a04","#dc2626"],w=n(fn).length%b.length,L={id:Jn(),kPeriod:9,dPeriod:3,actualPaneId:void 0,styles:{k:{color:b[w],thickness:1,lineStyle:"solid"},d:{color:b[(w+1)%b.length],thickness:1,lineStyle:"solid"},j:{color:b[(w+2)%b.length],thickness:1,lineStyle:"solid"}}};if(n(fn).push(L),n(fn).length>1){const E=Object.values(r().saveInds).filter($o=>$o.name==="KDJ"&&$o.pane_id).map($o=>$o.pane_id);let R=2;for(;E.includes(`pane_KDJ_${R}`);)R+=1;const G=n(fn).length-1,_e=[L.kPeriod,L.dPeriod,3],Be={lines:[{color:L.styles.k.color,size:L.styles.k.thickness,style:L.styles.k.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:L.styles.k.lineStyle==="dashed"?[4,4]:[2,2]},{color:L.styles.d.color,size:L.styles.d.thickness,style:L.styles.d.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:L.styles.d.lineStyle==="dashed"?[4,4]:[2,2]},{color:L.styles.j.color,size:L.styles.j.thickness,style:L.styles.j.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:L.styles.j.lineStyle==="dashed"?[4,4]:[2,2]}]},_t=`pane_KDJ_${R}`;console.log(`🆕 Immediately creating KDJ ${R} with pane ID:`,_t),((A=s())==null?void 0:A.createIndicator({name:"KDJ",calcParams:_e,styles:Be},!1,{id:_t,axis:{gap:{bottom:2}}}))&&(console.log(`✅ KDJ ${R} created with pane ID:`,_t),L.actualPaneId=_t,c.update($o=>{const so=`pane_KDJ_${R}_KDJ`;return $o.saveInds[so]={name:"KDJ",kdjGroup:L,pane_id:_t,groupIndex:G,params:[L.kPeriod,L.dPeriod,3]},$o}))}}function zu(b){var R;const w=n(fn)[b];if(!w||!s())return;const L=b===0?i().editPaneId:w.actualPaneId||`pane_KDJ_${b+1}`,A={lines:[{color:w.styles.k.color,size:w.styles.k.thickness,style:w.styles.k.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:w.styles.k.lineStyle==="dashed"?[4,4]:[2,2]},{color:w.styles.d.color,size:w.styles.d.thickness,style:w.styles.d.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:w.styles.d.lineStyle==="dashed"?[4,4]:[2,2]},{color:w.styles.j.color,size:w.styles.j.thickness,style:w.styles.j.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:w.styles.j.lineStyle==="dashed"?[4,4]:[2,2]}]};(R=s())==null||R.overrideIndicator({name:"KDJ",paneId:L,styles:A,calcParams:[w.kPeriod,w.dPeriod,3]});const E=b===0?`${i().editPaneId}_KDJ`:`pane_KDJ_${b+1}_KDJ`;c.update(G=>(G.saveInds[E]&&(G.saveInds[E].params=[w.kPeriod,w.dPeriod,3],G.saveInds[E].kdjGroup={...w},console.log("💾 Persisted KDJ changes to save data:",E,w)),G)),console.log("🔄 Updated KDJ indicator:",b,w)}let Xc=ee(D([]));function lv(){if(!n(Kt)||n(Xc).length>0)return;const b=`${i().editPaneId}_ICHIMOKU`,w=r().saveInds[b];if(w&&Array.isArray(w.ichimokuGroups)&&w.ichimokuGroups.length>0)x(Xc,D(w.ichimokuGroups.map((L,A)=>{var E;return{id:L.id||Jn(),name:L.name||`Ichimoku #${A+1}`,params:L.params||[9,26,52],styles:((E=L.styles)==null?void 0:E.map(R=>({color:R.color||"#2563eb",thickness:R.thickness??1,lineStyle:R.lineStyle||"solid"})))||[{color:"#ef4444",thickness:1,lineStyle:"solid"},{color:"#3b82f6",thickness:1,lineStyle:"solid"},{color:"#10b981",thickness:1,lineStyle:"solid"}]}})));else{const L=[v[0]||9,v[1]||26,v[2]||52],A=[0,1,2].map(E=>{var R,G,_e;return{color:((R=_[E])==null?void 0:R.color)||["#ef4444","#3b82f6","#10b981"][E]||"#2563eb",thickness:((G=_[E])==null?void 0:G.thickness)??1,lineStyle:((_e=_[E])==null?void 0:_e.lineStyle)||"solid"}});x(Xc,D([{id:Jn(),name:"Ichimoku #1",params:L,styles:A}]))}}function qp(){var E;if(!n(Kt))return;const b=n(Xc).length+1,w=[["#ef4444","#3b82f6","#10b981"],["#f59e0b","#8b5cf6","#06b6d4"],["#22c55e","#e11d48","#0ea5e9"]],L=w[(b-1)%w.length],A={id:Jn(),name:`Ichimoku #${b}`,params:[9,26,52],styles:[{color:L[0],thickness:1,lineStyle:"solid"},{color:L[1],thickness:1,lineStyle:"solid"},{color:L[2],thickness:1,lineStyle:"solid"}]};x(Xc,D([...n(Xc),A]));try{const R={lines:A.styles.map(_e=>({color:_e.color,size:_e.thickness,style:_e.lineStyle==="dashed"||_e.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:_e.lineStyle==="dashed"?[4,4]:_e.lineStyle==="dotted"?[2,2]:[2,2]}))};(E=s())==null||E.createIndicator({name:"ICHIMOKU",calcParams:A.params,styles:R},!0,{id:i().editPaneId});const G=`${i().editPaneId}_ICHIMOKU`;c.update(_e=>{var Be;return _e.saveInds[G]={name:"ICHIMOKU",pane_id:i().editPaneId,params:((Be=n(Xc)[0])==null?void 0:Be.params)||[9,26,52],ichimokuGroups:n(Xc).map(_t=>({..._t}))},_e})}catch(R){console.error("❌ Error adding Ichimoku group:",R)}}function Zu(b){var w,L,A;if(!(!n(Kt)||!s()))try{const R=(((L=(w=s())==null?void 0:w.getIndicators)==null?void 0:L.call(w))||[]).filter(_e=>_e.name==="ICHIMOKU"&&_e.paneId===i().editPaneId);for(const _e of R)(A=s())==null||A.removeIndicator({paneId:_e.paneId,name:"ICHIMOKU"});n(Xc).forEach(_e=>{var _t;const Be={lines:_e.styles.map(Yo=>({color:Yo.color,size:Yo.thickness,style:Yo.lineStyle==="dashed"||Yo.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:Yo.lineStyle==="dashed"?[4,4]:Yo.lineStyle==="dotted"?[2,2]:[2,2]}))};(_t=s())==null||_t.createIndicator({name:"ICHIMOKU",calcParams:_e.params,styles:Be},!0,{id:i().editPaneId})});const G=`${i().editPaneId}_ICHIMOKU`;c.update(_e=>{var Be;return _e.saveInds[G]={name:"ICHIMOKU",pane_id:i().editPaneId,params:((Be=n(Xc)[0])==null?void 0:Be.params)||[9,26,52],ichimokuGroups:n(Xc).map(_t=>({..._t}))},_e}),console.log("🔄 Updated Ichimoku groups")}catch(E){console.error("❌ Error updating Ichimoku groups:",E)}}function Fu(b){if(n(Kt)&&!(n(Xc).length<=1)&&!(b<0||b>=n(Xc).length))try{x(Xc,D(n(Xc).filter((w,L)=>L!==b))),Zu(0),console.log("🗑️ Removed Ichimoku group at index:",b)}catch(w){console.error("❌ Error removing Ichimoku group:",w)}}function Hp(){var b,w,L;if(!(!n(Kt)||!s()))try{const E=(((w=(b=s())==null?void 0:b.getIndicators)==null?void 0:w.call(b))||[]).filter(G=>G.name==="ICHIMOKU"&&G.paneId===i().editPaneId);for(const G of E)(L=s())==null||L.removeIndicator({paneId:G.paneId,name:"ICHIMOKU"});n(Xc).forEach(G=>{var Be;const _e={lines:G.styles.map(_t=>({color:_t.color,size:_t.thickness,style:_t.lineStyle==="dashed"||_t.lineStyle==="dotted"?Oe.Dashed:Oe.Solid,dashedValue:_t.lineStyle==="dashed"?[4,4]:_t.lineStyle==="dotted"?[2,2]:[2,2]}))};(Be=s())==null||Be.createIndicator({name:"ICHIMOKU",calcParams:G.params,styles:_e},!0,{id:i().editPaneId})});const R=`${i().editPaneId}_ICHIMOKU`;c.update(G=>{var _e;return G.saveInds[R]={name:"ICHIMOKU",pane_id:i().editPaneId,params:((_e=n(Xc)[0])==null?void 0:_e.params)||[9,26,52],ichimokuGroups:n(Xc).map(Be=>({...Be}))},G}),l.update(G=>(G.editIndName="",G.editPaneId="",G.modalIndCfg=!1,G)),a(!1),console.log("✅ Ichimoku confirm applied")}catch(A){console.error("❌ Error confirming Ichimoku groups:",A)}}function Gp(b){var L,A;if(!n(_r)||n(fn).length<=1)return;const w=n(fn).findIndex(E=>E.id===b);if(w!==-1){console.log("🗑️ Removing KDJ group at index:",w,"ID:",b);try{if(w===0&&n(fn).length>1){console.log("🔄 Special handling: First KDJ removed, promoting second KDJ to first position"),x(fn,D(n(fn).filter(R=>R.id!==b))),console.log("✅ KDJ group removed from array. Remaining groups:",n(fn).length);const E=n(fn)[0];E.actualPaneId&&(console.log("🗑️ Removing old second KDJ from sub-pane:",E.actualPaneId),(L=s())==null||L.removeIndicator({paneId:E.actualPaneId,name:"KDJ"})),E.actualPaneId=void 0,console.log("📊 Updating KDJ in edit pane with new first group settings"),zu(0)}else{const E=n(fn)[w];E.actualPaneId&&(console.log("🗑️ Removing KDJ from actual pane:",E.actualPaneId),(A=s())==null||A.removeIndicator({paneId:E.actualPaneId,name:"KDJ"}),console.log("✅ Successfully removed KDJ from actual pane:",E.actualPaneId)),x(fn,D(n(fn).filter(R=>R.id!==b))),console.log("✅ KDJ group removed from array. Remaining groups:",n(fn).length)}c.update(E=>(Object.keys(E.saveInds).forEach(R=>{E.saveInds[R].name==="KDJ"&&(console.log("🧹 Cleaning saved state for key:",R),delete E.saveInds[R])}),n(fn).forEach((R,G)=>{const _e=G===0?`${i().editPaneId}_KDJ`:`pane_KDJ_${G+1}_KDJ`,Be=G===0?i().editPaneId:R.actualPaneId||`pane_KDJ_${G+1}`;console.log(`💾 Re-saving KDJ group ${G+1} with key:`,_e,"pane ID:",Be),E.saveInds[_e]={name:"KDJ",kdjGroup:R,pane_id:Be,groupIndex:G,kdjGroups:G===0?[...n(fn)]:void 0,params:[R.kPeriod,R.dPeriod,3]}}),E)),console.log("🔄 KDJ groups reindexed successfully")}catch(E){console.log("❌ Error removing KDJ indicator:",E)}}}function cv(){var w,L;if(!n(St))return;console.log("🔄 Initializing AO groups for edit pane:",i().editPaneId);const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="AO").sort((A,E)=>A===`${i().editPaneId}_AO`?-1:E===`${i().editPaneId}_AO`?1:A.localeCompare(E));if(console.log("🔍 Found AO keys:",b),b.length>0)x(wo,D([])),b.forEach((A,E)=>{const R=r().saveInds[A];console.log(`🔄 Loading AO group ${E+1} from key:`,A,R),R&&(R.aoGroup?n(wo).push({...R.aoGroup}):R.params&&R.params.length===2&&n(wo).push({id:Jn(),shortPeriod:R.params[0]||5,longPeriod:R.params[1]||34,styles:{increasing:{color:"#26A69A"},decreasing:{color:"#EF5350"}}}))}),console.log("✅ Loaded AO groups:",n(wo).length);else{const A=Object.entries(r().saveInds).find(([E,R])=>R.name==="AO"&&E.includes(i().editPaneId||""));if(A){const[,E]=A;console.log("🔄 Found existing AO indicator, creating group from it"),x(wo,D([{id:Jn(),shortPeriod:((w=E.params)==null?void 0:w[0])||5,longPeriod:((L=E.params)==null?void 0:L[1])||34,styles:{increasing:{color:"#26A69A"},decreasing:{color:"#EF5350"}}}]))}else console.log("🔄 Creating default AO group"),x(wo,D([{id:Jn(),shortPeriod:5,longPeriod:34,styles:{increasing:{color:"#26A69A"},decreasing:{color:"#EF5350"}}}]))}}function Vv(){if(!n(Me))return;const b=i().editPaneId||"candle_pane",w=Object.entries(r().saveInds).filter(([A,E])=>E&&E.name==="BOLL"&&E.pane_id===b);if(w.length>0){const A=w.sort(([E],[R])=>{var Be,_t;const G=(Be=E.match(/_BOLL_(\d+)$/))!=null&&Be[1]?parseInt(E.match(/_BOLL_(\d+)$/)[1],10):1,_e=(_t=R.match(/_BOLL_(\d+)$/))!=null&&_t[1]?parseInt(R.match(/_BOLL_(\d+)$/)[1],10):1;return G-_e});x(Ot,D(A.map(([E,R])=>{var G,_e,Be,_t,Yo,$o,so;return{id:Jn(),paneId:b,period:R.params&&R.params[0]||20,stdDev:R.params&&R.params[1]||2,styles:{fillColor:((G=R.bollingerStyles)==null?void 0:G.fillColor)||"#2196F3",fillOpacity:((_e=R.bollingerStyles)==null?void 0:_e.fillOpacity)??5,upperColor:((Be=R.bollingerStyles)==null?void 0:Be.upperColor)||"#f23645",middleColor:((_t=R.bollingerStyles)==null?void 0:_t.middleColor)||"#2962ff",lowerColor:((Yo=R.bollingerStyles)==null?void 0:Yo.lowerColor)||"#089981",thickness:(($o=R.bollingerStyles)==null?void 0:$o.thickness)||1,lineStyle:((so=R.bollingerStyles)==null?void 0:so.lineStyle)||"solid"}}})))}else x(Ot,D([{id:Jn(),paneId:b,period:n(B)||20,stdDev:n($)||2,styles:{fillColor:n(S)||"#2196F3",fillOpacity:n(M)??5,upperColor:n(I)||"#f23645",middleColor:n(C)||"#2962ff",lowerColor:n(T)||"#089981",thickness:n(z)||1,lineStyle:n(j)||"solid"}}]));const L=n(Ot)[0];L&&(x(B,D(L.period)),x($,D(L.stdDev)),x(S,D(L.styles.fillColor)),x(M,D(L.styles.fillOpacity)),x(I,D(L.styles.upperColor)),x(C,D(L.styles.middleColor)),x(T,D(L.styles.lowerColor)),x(z,D(L.styles.thickness)),x(j,D(L.styles.lineStyle))),Co()}function _p(){var L;if(!n(St)||!s())return;console.log("🔄 Applying AO changes in real-time, groups:",n(wo).length);const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="AO").sort((A,E)=>A===`${i().editPaneId}_AO`?-1:E===`${i().editPaneId}_AO`?1:A.localeCompare(E));console.log("🔍 Existing AO keys:",b);const w=n(wo).length;if(b.length>w){console.log(`🗑️ Removing ${b.length-w} excess AO indicators`);for(let A=w;A<b.length;(A+=1)-1){const E=b[A],R=r().saveInds[E];if(R&&R.pane_id){console.log("🗑️ Removing AO indicator from pane:",R.pane_id);try{(L=s())==null||L.removeIndicator({paneId:R.pane_id,name:"AO"})}catch(G){console.log("Error removing excess AO indicator:",G)}}}}n(wo).forEach((A,E)=>{var _e,Be,_t;const R=[A.shortPeriod,A.longPeriod],G={bars:[{upColor:A.styles.increasing.color,downColor:A.styles.decreasing.color,noChangeColor:"#888888"}]};if(E===0)console.log("🔄 Updating first AO indicator in pane:",i().editPaneId),(_e=s())==null||_e.overrideIndicator({name:"AO",calcParams:R,styles:G,paneId:i().editPaneId});else{const Yo=`pane_AO_${E+1}_AO`,$o=b.find(so=>so===Yo);if($o){const so=r().saveInds[$o];so&&so.pane_id&&(console.log(`🔄 Updating existing AO ${E+1} in pane:`,so.pane_id),(Be=s())==null||Be.overrideIndicator({name:"AO",calcParams:R,styles:G,paneId:so.pane_id}))}else{const so=`pane_AO_${E+1}`;console.log(`🆕 Creating new AO ${E+1} with pane ID:`,so),(_t=s())==null||_t.createIndicator({name:"AO",calcParams:R,styles:G},!0,{id:so})}}}),c.update(A=>(Object.keys(A.saveInds).forEach(E=>{A.saveInds[E].name==="AO"&&delete A.saveInds[E]}),n(wo).forEach((E,R)=>{const G=R===0?`${i().editPaneId}_AO`:`pane_AO_${R+1}_AO`,_e=R===0?i().editPaneId:`pane_AO_${R+1}`;console.log(`💾 Saving AO group ${R+1} with key:`,G),A.saveInds[G]={name:"AO",aoGroup:E,pane_id:_e,groupIndex:R,aoGroups:R===0?[...n(wo)]:void 0,params:[E.shortPeriod,E.longPeriod]}}),A))}function Dp(b){!n(St)||n(wo).length<=1||!n(wo).find(L=>L.id===b)||(n(wo).findIndex(L=>L.id===b),x(wo,D(n(wo).filter(L=>L.id!==b))),_p())}function yc(){const b=`${i().editPaneId}_CR`,w=r().saveInds[b];w&&(x(Lu,D(w.crPeriod||26)),x(Cp,D(w.crMa1Period||10)),x(Sv,D(w.crMa2Period||20)),x(rp,D(w.crMa3Period||40)),x(jf,D(w.crMa4Period||60)),x(Pp,D(w.crColor||"#FF6B35")),x(Ip,D(w.crMa1Color||"#2196F3")),x(Rf,D(w.crMa2Color||"#4CAF50")),x(lf,D(w.crMa3Color||"#FF9800")),x(pe,D(w.crMa4Color||"#9C27B0")),x(Pe,D(w.crThickness||2)),x(Ht,D(w.crMa1Thickness||1)),x(vo,D(w.crMa2Thickness||1)),x(as,D(w.crMa3Thickness||1)),x(po,D(w.crMa4Thickness||1)),x(Bs,D(w.crLineStyle||"solid")),x(xs,D(w.crMa1LineStyle||"solid")),x(en,D(w.crMa2LineStyle||"solid")),x(Sn,D(w.crMa3LineStyle||"solid")),x(lt,D(w.crMa4LineStyle||"solid")))}function Ep(b,w){return L=>{x(K,D(b)),x(Y,D(w)),x(V,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(F,!0)}}function lp(b){return w=>{x(te,D(b)),x(ne,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Z,!0)}}function Wv(b,w){return L=>{x(J,D(b)),x(se,D(w)),x(U,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(oe,!0)}}function cf(b){return w=>{x(ot,D(b)),x(Je,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(vt,!0)}}function Er(b,w){return L=>{x(be,D(b)),x(We,D(w)),x(Nc,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(td,!0)}}function $u(b,w){return L=>{x(st,b*3+w),x(Ke,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Re,!0)}}function Pv(b,w){return L=>{if(x(pt,D(b)),x(ce,D(w)),x(Ge,D({x:L.clientX,y:L.clientY})),x(ct,!0),n(Ze).length>b&&(w==="histogram"||w==="histogram-down")){const A=n(Ze)[b];w==="histogram"?A.styles.histogram.upColor=k(A.styles.histogram.upColor||"#26a69a",70):A.styles.histogram.downColor=k(A.styles.histogram.downColor||"#ef5350",70),Od(b)}}}function Up(b){return w=>{if(x(wt,D(b)),w.currentTarget&&w.currentTarget instanceof Element){const L=w.currentTarget.getBoundingClientRect();x(ze,D({x:L.left+L.width/2,y:L.bottom+5}))}else x(ze,D({x:window.innerWidth/2,y:window.innerHeight/2}));x(we,!0)}}function dv(b){return w=>{if(x(wt,D(b)),w.currentTarget&&w.currentTarget instanceof Element){const L=w.currentTarget.getBoundingClientRect();x(qe,D({x:L.left+L.width/2,y:L.bottom+5}))}else x(qe,D({x:window.innerWidth/2,y:window.innerHeight/2}));x(dt,!0)}}function Iv(b){return w=>{if(x(wt,D(b)),w.currentTarget&&w.currentTarget instanceof Element){const L=w.currentTarget.getBoundingClientRect();x(Q,D({x:L.left+L.width/2,y:L.bottom+5}))}else x(Q,D({x:window.innerWidth/2,y:window.innerHeight/2}));x(me,!0)}}function qv(b){return w=>{if(x(wt,D(b)),w.currentTarget&&w.currentTarget instanceof Element){const L=w.currentTarget.getBoundingClientRect();x(Vt,D({x:L.left+L.width/2,y:L.bottom+5}))}else x(Vt,D({x:window.innerWidth/2,y:window.innerHeight/2}));x(it,!0)}}function vu(b,w){return L=>{x(Gt,D(b)),x(no,D(w)),x(At,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Yt,!0)}}function df(b){return w=>{x(bs,D(b)),x(Eo,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Do,!0)}}function Np(b){return w=>{x(Ks,D(b)),x(qi,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Is,!0)}}function jp(b){return w=>{x(es,D(b)),x(vn,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(ws,!0)}}function uf(b){return w=>{x(Xi,D(b)),x(ol,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(oa,!0)}}function Mv(b){return w=>{x(ml,D(b)),x(rd,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(fc,!0)}}function Su(b){return w=>{x(qa,D(b)),x(Fl,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(_d,!0)}}function cp(b){return w=>{x(Ec,D(b)),x(Yc,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Nl,!0)}}function Hv(b){return w=>{x(Xe,D(b)),x(ut,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Fe,!0)}}function Gv(b){return w=>{x(It,D(b)),x(ao,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(ht,!0)}}function Tv(b,w=0){return L=>{x(Mo,D(w)),x(eo,D(b)),x(sa,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(Ja,!0)}}function Uv(b){return w=>{x(ds,D(b)),x(to,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(ho,!0)}}function uv(b){return w=>{x($r,D(b)),x(Si,D({x:window.innerWidth/2,y:window.innerHeight/2})),x(js,!0)}}Nd(l,b=>b.modalIndCfg).subscribe(()=>{if(!i().editIndName)return;if(n(Kt)){lv();const L=bh.ICHIMOKU||[];g.splice(0,g.length,...L);return}if(n(Un)){const A=`${i().editPaneId||"candle_pane"}_ZIGZAG`,E=Object.keys(r().saveInds).filter(G=>{var _e;return G.startsWith(A)&&((_e=r().saveInds[G])==null?void 0:_e.name)==="ZIGZAG"}).sort((G,_e)=>{const Be=_t=>{const Yo=_t.match(/_ZIGZAG(?:_(\d+))?$/);return Yo&&Yo[1]?parseInt(Yo[1],10):1};return Be(G)-Be(_e)});x(ts,D([])),E.length>0?E.forEach(G=>{var $o,so,cn,_i;const _e=r().saveInds[G],Be=((so=($o=_e==null?void 0:_e.styles)==null?void 0:$o.lines)==null?void 0:so[0])||{},_t=Array.isArray(Be.dashedValue)?Be.dashedValue.join(","):"",Yo=Be.style===Oe.Solid?"solid":_t==="2,6"?"dotted":"dashed";n(ts).push({id:Jn(),deviation:Number(((cn=_e==null?void 0:_e.params)==null?void 0:cn[0])??5),depth:Number(((_i=_e==null?void 0:_e.params)==null?void 0:_i[1])??5),styles:{color:Be.color??"#2962FF",thickness:Number(Be.size??2),lineStyle:Yo}})}):x(ts,D([{id:Jn(),deviation:5,depth:5,styles:{color:"#2962FF",thickness:2,lineStyle:"solid"}}]));const R=n(ts)[0];v.splice(0,v.length,R.deviation,R.depth),x($p,D(R.styles.color)),x(Wp,D(R.styles.thickness)),x(Yu,D(R.styles.lineStyle));return}if(n(Ue)){od();return}if(n(fo)){Kc();return}if(n(Ul)){iu();return}if(n(wa)){wu();return}if(n(lo)){Ac();return}if(n(he)){Sa();return}if(n(ke)){hu();return}if(n(Wo)){Nn();return}if(n(yt)){cs();return}if(n(Kr)){Jo();return}if(n(Go)){br();return}if(n(dl)){Ji();return}if(n(Fo)){fa();return}if(n(gi)){Ba();return}if(n(us)){Kl();return}if(n(or)){Ir();return}if(n($s)){qc();return}if(n(_r)){ku();return}if(n(St)){cv();return}if(n(gi)){yc();return}if(n(Me)){Vv();return}const b=`${i().editPaneId}_${i().editIndName}`,w=r().saveInds[b];if(w&&w.fields&&!n(Me))g.splice(0,g.length,...w.fields),v.splice(0,v.length,...w.params||[]),_.splice(0,_.length,...w.styles||[]);else{const L=bh[i().editIndName]||[];if(n(Me)){g.splice(0,g.length,...L);const A=L.map(E=>E.default);v.splice(0,v.length,...A),w&&w.params&&w.params.length>=2&&(v[0]=w.params[0],v[1]=w.params[1])}else if(g.splice(0,g.length,...L),w&&w.params)v.splice(0,v.length,...w.params),_.splice(0,_.length,...w.styles||[]),(n(Ct)||n(Ne))&&g.length>v.length&&g.splice(v.length,g.length-v.length);else{const A=L.filter(E=>E.type!=="color").map(E=>E.default);v.splice(0,v.length,...A)}}if(n(Wo)){for(;_.length<2;)_.length===0?_.push({color:"#2563eb",thickness:1,lineStyle:"solid"}):_.push({color:"#dc2626",thickness:1,lineStyle:"solid"});for(;_.length>2;)_.pop()}else{for(;_.length<v.length;)_.push({color:"#2563eb",thickness:1,lineStyle:"solid"});for(;_.length>v.length;)_.pop()}}),Nd(l,b=>b.clearCciGroups).subscribe(b=>{b>0&&dr()}),Nd(l,b=>b.clearEmvGroups).subscribe(b=>{b>0&&Fa()}),Nd(l,b=>b.clearMtmGroups).subscribe(b=>{b>0&&ka()}),Nd(l,b=>b.clearObvGroups).subscribe(b=>{b>0&&va()}),Nd(l,b=>b.clearPsyGroups).subscribe(b=>{b>0&&wc()}),Nd(l,b=>b.clearPvtGroups).subscribe(b=>{b>0&&mr()}),Nd(l,b=>b.clearRocGroups).subscribe(b=>{b>0&&ha()}),Nd(l,b=>b.clearVolGroups).subscribe(b=>{b>0&&ad()}),Nd(l,b=>b.clearWrGroups).subscribe(b=>{b>0&&Gd()});function Yp(b){n(Me)||v.length<=1||(v.splice(b,1),g.splice(b,1),_.splice(b,1),n(Ct)?Ad():n(Ne)&&Ca())}function Kp(){const b=s();if(!b)return;const w=[6],L=b.createIndicator({name:"BIAS",calcParams:w,createTooltipDataSource:({indicator:G})=>{const _e=[G.visible?1:0,2,3],Be=b.getStyles().indicator.tooltip;return{icons:_e.map(Yo=>Be.features[Yo])}}},!1,{axis:{gap:{bottom:2}}});if(!L)return;const A=L,E={name:"BIAS",pane_id:A,params:w},R=`${A}_BIAS`;c.update(G=>(G.saveInds[R]=E,G)),a(!1)}function pv(){const b=s();if(!b)return;const w=[5,34],L=b.createIndicator({name:"AO",calcParams:w,createTooltipDataSource:({indicator:G})=>{const _e=[G.visible?1:0,2,3],Be=b.getStyles().indicator.tooltip;return{icons:_e.map(Yo=>Be.features[Yo])}}},!1,{axis:{gap:{bottom:2}}});if(L){const G=b.getStyles();b.setStyles({...G,indicator:{...G.indicator,bars:[{upColor:"#8B5CF6",downColor:"#EF4444",noChangeColor:"#8B5CF6"}]}})}if(!L)return;const A=L,E={name:"AO",pane_id:A,params:w},R=`${A}_AO`;c.update(G=>(G.saveInds[R]=E,G)),a(!1)}function Rp(){const b=s();if(!b)return;const w=[14],L=b.createIndicator({name:"WR",calcParams:w,createTooltipDataSource:({indicator:G})=>{const _e=[G.visible?1:0,2,3],Be=b.getStyles().indicator.tooltip;return{icons:_e.map(Yo=>Be.features[Yo])}}},!1,{axis:{gap:{bottom:2}}});if(!L)return;const A=L,E={name:"WR",pane_id:A,params:w},R=`${A}_WR`;c.update(G=>(G.saveInds[R]=E,G)),a(!1)}function Av(){const b=s();if(!b)return;const w=[15,9],L=b.createIndicator({name:"TRIX",calcParams:w,createTooltipDataSource:({indicator:G})=>{const _e=[G.visible?1:0,2,3],Be=b.getStyles().indicator.tooltip;return{icons:_e.map(Yo=>Be.features[Yo])}}},!1,{axis:{gap:{bottom:2}}});if(!L)return;const A=L,E={name:"TRIX",pane_id:A,params:w},R=`${A}_TRIX`;c.update(G=>(G.saveInds[R]=E,G)),a(!1)}function Lv(){var L;if(!n(gi))return;const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="CR").sort((A,E)=>A===`${i().editPaneId}_CR`?-1:E===`${i().editPaneId}_CR`?1:A.localeCompare(E));console.log("🔧 Applying CR changes. Existing keys:",b),console.log("🔧 Current CR groups:",n(pi).length);const w=n(pi).length;if(b.length>w)for(let A=w;A<b.length;(A+=1)-1){const E=b[A],R=r().saveInds[E];try{console.log("🗑️ Removing excess CR indicator from pane:",R.pane_id),(L=s())==null||L.removeIndicator({paneId:R.pane_id,name:"CR"})}catch(G){console.log("❌ Error removing excess CR indicator:",G)}delete r().saveInds[E]}n(pi).forEach((A,E)=>{var _e,Be,_t;const R=[A.crPeriod,A.crMa1Period,A.crMa2Period,A.crMa3Period,A.crMa4Period],G={lines:[{color:A.styles.cr.color,size:A.styles.cr.thickness,style:A.styles.cr.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.cr.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:A.styles.ma1.color,size:A.styles.ma1.thickness,style:A.styles.ma1.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.ma1.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:A.styles.ma2.color,size:A.styles.ma2.thickness,style:A.styles.ma2.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.ma2.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:A.styles.ma3.color,size:A.styles.ma3.thickness,style:A.styles.ma3.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.ma3.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:A.styles.ma4.color,size:A.styles.ma4.thickness,style:A.styles.ma4.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.ma4.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1}]};if(E===0)console.log("🔄 Updating first CR in pane:",i().editPaneId),(_e=s())==null||_e.overrideIndicator({name:"CR",calcParams:R,styles:G,paneId:i().editPaneId});else{const Yo=`pane_CR_${E+1}_CR`,$o=b.find(so=>so===Yo);if($o){const so=r().saveInds[$o];console.log("🔄 Updating existing CR in pane:",so.pane_id),(Be=s())==null||Be.overrideIndicator({name:"CR",calcParams:R,styles:G,paneId:so.pane_id})}else{const so=`pane_CR_${E+1}`;console.log("🆕 Creating new CR in pane:",so);const cn=(_t=s())==null?void 0:_t.createIndicator({name:"CR",calcParams:R,styles:G},!0,{id:so});console.log("✅ Created new CR indicator with ID:",cn,"in pane:",so)}}}),c.update(A=>(Object.keys(A.saveInds).forEach(E=>{A.saveInds[E].name==="CR"&&delete A.saveInds[E]}),n(pi).forEach((E,R)=>{const G=R===0?`${i().editPaneId}_CR`:`pane_CR_${R+1}_CR`,_e=R===0?i().editPaneId:`pane_CR_${R+1}`,Be={name:"CR",crGroup:E,pane_id:_e,groupIndex:R,crGroups:R===0?[...n(pi)]:void 0,params:[E.crPeriod,E.crMa1Period,E.crMa2Period,E.crMa3Period,E.crMa4Period]};A.saveInds[G]=Be,console.log("💾 Saved CR group",R,"with key:",G,"and pane ID:",_e)}),A)),l.update(A=>(A.editIndName="",A.editPaneId="",A.modalIndCfg=!1,A)),a(!1)}function gf(){n(zo).forEach((b,w)=>{kc(w)}),c.update(b=>(Object.keys(b.saveInds).forEach(w=>{b.saveInds[w].name==="MACD"&&delete b.saveInds[w]}),n(zo).forEach((w,L)=>{const A=L===0?`${i().editPaneId}_MACD`:`pane_MACD_${L+1}_MACD`,E=L===0?i().editPaneId:w.actualPaneId||`pane_MACD_${L+1}`;b.saveInds[A]={name:"MACD",macdGroup:w,pane_id:E,groupIndex:L,params:[w.fastPeriod,w.slowPeriod,w.signalPeriod]}}),b)),console.log("🔄 Clearing edit state and closing popup..."),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,console.log("✅ Context updated - modalIndCfg set to false"),b)),a(!1)}function _u(){if(n(lo)){n(Et).forEach((b,w)=>{b.paneId&&sr(w)}),c.update(b=>{const w=`${i().editPaneId}_WR`,L={name:"WR",wrGroups:n(Et),pane_id:i().editPaneId};return b.saveInds[w]=L,n(Et).forEach((A,E)=>{const R=E===0?`${i().editPaneId}_WR_single`:`WR_${E+1}`,G={name:"WR",wrGroup:A,pane_id:E===0?i().editPaneId:`new_pane_${E}`,groupIndex:E};b.saveInds[R]=G}),b});try{console.log("🔄 Clearing edit state and closing popup..."),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,console.log("✅ Context updated - modalIndCfg set to false"),b)),a(!1),console.log("✅ Popup show flag set to false - handleKdjConfirm completed successfully")}catch(b){console.error("❌ Error in handleKdjConfirm:",b),console.log("🔄 Forcing popup close due to error..."),l.update(w=>(w.editIndName="",w.editPaneId="",w.modalIndCfg=!1,w)),a(!1),console.log("✅ Popup forcefully closed after error")}}}function Vu(){n(he)&&(n(Ut).forEach((b,w)=>{var E;const L=[b.period,b.shortPeriod,b.longPeriod],A={lines:[{color:b.styles.vr.color,size:b.styles.vr.thickness,style:b.styles.vr.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:b.styles.vr.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:b.styles.vrShort.color,size:b.styles.vrShort.thickness,style:b.styles.vrShort.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:b.styles.vrShort.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:b.styles.vrLong.color,size:b.styles.vrLong.thickness,style:b.styles.vrLong.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:b.styles.vrLong.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1}]};b.paneId&&((E=s())==null||E.overrideIndicator({name:"VR",calcParams:L,styles:A,paneId:b.paneId}),console.log(`✅ Updated VR indicator in pane: ${b.paneId}`))}),c.update(b=>(n(Ut).forEach((w,L)=>{const A=`${w.paneId}_VR`,E={name:"VR",vrGroup:w,pane_id:w.paneId,params:[w.period,w.shortPeriod,w.longPeriod],groupIndex:L};b.saveInds[A]=E,console.log(`💾 Saved VR group to: ${A}`)}),b)),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1))}function Of(){n(mo)&&(n(Ze).forEach((b,w)=>{var E;const L=[b.period],A={bars:[{upColor:b.styles.histogram.upColor,downColor:b.styles.histogram.downColor,noChangeColor:b.styles.histogram.upColor}],lines:[{color:b.styles.ema.color,size:b.styles.ema.thickness,style:b.styles.ema.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:b.styles.ema.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1,visible:b.styles.ema.visible===!0}]};b.paneId&&((E=s())==null||E.overrideIndicator({name:"VOL",calcParams:L,styles:A,paneId:b.paneId}),console.log(`✅ Updated Volume indicator in pane: ${b.paneId}`))}),c.update(b=>(n(Ze).forEach((w,L)=>{const A=`${w.paneId}_VOL`,E={name:"VOL",volGroup:w,pane_id:w.paneId,params:[w.period],groupIndex:L};b.saveInds[A]=E,console.log(`💾 Saved Volume group to: ${A}`)}),b)),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1))}function vv(){n(ke)&&(console.log("🔧 Applying BBI changes. Current BBI groups:",n(xt).length),n(xt).forEach((b,w)=>{var _e;const L=[b.period1,b.period2,b.period3,b.period4],E=(Be=>{switch(Be){case"dashed":return{style:Oe.Dashed,dashedValue:[4,4]};case"dotted":return{style:Oe.Dashed,dashedValue:[2,2]};default:return{style:Oe.Solid,dashedValue:[2,2]}}})(b.lineStyle),R={lines:[{color:b.color,size:b.thickness,style:E.style,dashedValue:E.dashedValue,smooth:!1}]},G=b.paneId||(w===0?i().editPaneId:`pane_BBI_${w+1}`);console.log("🔄 Updating BBI group",w,"in pane:",G),(_e=s())==null||_e.overrideIndicator({name:"BBI",calcParams:L,styles:R,paneId:G}),b.paneId||(b.paneId=G)}),c.update(b=>(Object.keys(b.saveInds).forEach(w=>{b.saveInds[w].name==="BBI"&&delete b.saveInds[w]}),n(xt).forEach((w,L)=>{const A=`${w.paneId}_BBI`,E={name:"BBI",bbiGroup:w,pane_id:w.paneId,groupIndex:L,bbiGroups:L===0?[...n(xt)]:void 0,params:[w.period1,w.period2,w.period3,w.period4]};b.saveInds[A]=E,console.log("💾 Saved BBI group",L,"with key:",A,"and pane ID:",w.paneId)}),b)),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1))}function zv(){var b;if(!n(Ul)){console.warn("⚠️ handleEmvConfirm called but not in EMV mode");return}try{if(!n(vi)||n(vi).length===0){console.error("❌ No EMV groups to process");return}const w=n(vi).filter(E=>!(!E||typeof E!="object"||typeof E.period!="number"||E.period<=0||typeof E.period2!="number"||E.period2<=0||typeof E.color!="string"||!E.color||typeof E.thickness!="number"||E.thickness<=0||typeof E.lineStyle!="string"||!E.lineStyle));if(w.length===0){console.error("❌ No valid EMV groups found");return}w.length!==n(vi).length&&(console.warn(`⚠️ ${n(vi).length-w.length} invalid EMV groups filtered out`),x(vi,D(w)));const L=Object.keys(r().saveInds).filter(E=>r().saveInds[E]&&r().saveInds[E].name==="EMV").sort((E,R)=>E===`${i().editPaneId}_EMV`?-1:R===`${i().editPaneId}_EMV`?1:E.localeCompare(R));console.log("🔧 Applying EMV changes. Existing keys:",L),console.log("🔧 Current EMV groups:",n(vi).length);const A=n(vi).length;if(L.length>A)for(let E=A;E<L.length;(E+=1)-1){const R=L[E],G=r().saveInds[R];if(G&&G.pane_id)try{console.log("🗑️ Removing excess EMV indicator from pane:",G.pane_id),(b=s())==null||b.removeIndicator({paneId:G.pane_id,name:"EMV"})}catch(_e){console.log("❌ Error removing excess EMV indicator:",_e)}}n(vi).forEach((E,R)=>{var Be,_t,Yo;const G=[E.period,E.period2],_e={lines:[{color:E.color,size:E.thickness,style:E.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:E.lineStyle==="dashed"?[4,4]:E.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(R===0)console.log("🔄 Updating first EMV in pane:",i().editPaneId),(Be=s())==null||Be.overrideIndicator({name:"EMV",calcParams:G,styles:_e,paneId:i().editPaneId});else{const $o=`pane_EMV_${R+1}_EMV`,so=L.find(cn=>cn===$o);if(so){const cn=r().saveInds[so];cn&&cn.pane_id&&(console.log("🔄 Updating existing EMV in pane:",cn.pane_id),(_t=s())==null||_t.overrideIndicator({name:"EMV",calcParams:G,styles:_e,paneId:cn.pane_id}))}else{const cn=`pane_EMV_${R+1}`;console.log("🆕 Creating new EMV in pane:",cn);const _i=(Yo=s())==null?void 0:Yo.createIndicator({name:"EMV",calcParams:G,styles:_e},!0,{id:cn});_i&&console.log("✅ Created new EMV indicator with ID:",_i,"in pane:",cn)}}}),c.update(E=>{try{Object.keys(E.saveInds).forEach(R=>{E.saveInds[R]&&E.saveInds[R].name==="EMV"&&delete E.saveInds[R]}),n(vi).forEach((R,G)=>{try{const _e=G===0?`${i().editPaneId}_EMV`:`pane_EMV_${G+1}_EMV`,Be=G===0?i().editPaneId:`pane_EMV_${G+1}`;if(!_e||!Be){console.error(`❌ Invalid save key or pane ID for EMV group ${G}`);return}const _t={name:"EMV",emvGroup:R,pane_id:Be,groupIndex:G,emvGroups:G===0?[...n(vi)]:void 0,params:[R.period,R.period2]};E.saveInds[_e]=_t,console.log("💾 Saved EMV group",G,"with key:",_e,"and pane ID:",Be)}catch(_e){console.error(`❌ Error saving EMV group ${G}:`,_e)}})}catch(R){console.error("❌ Error in EMV save operation:",R)}return E}),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),a(!1),console.log("✅ EMV configuration completed successfully")}catch(w){console.error("❌ Critical error in handleEmvConfirm:",w)}}function bp(){var b;if(!n(wa)){console.warn("⚠️ handleMtmConfirm called but not in MTM mode");return}try{if(!n(ri)||n(ri).length===0){console.error("❌ No MTM groups to process");return}const w=n(ri).filter(E=>!(!E||typeof E!="object"||typeof E.period!="number"||E.period<=0||typeof E.color!="string"||!E.color||typeof E.thickness!="number"||E.thickness<=0||typeof E.lineStyle!="string"||!E.lineStyle));if(w.length===0){console.error("❌ No valid MTM groups found");return}w.length!==n(ri).length&&(console.warn(`⚠️ ${n(ri).length-w.length} invalid MTM groups filtered out`),x(ri,D(w)));const L=Object.keys(r().saveInds).filter(E=>r().saveInds[E]&&r().saveInds[E].name==="MTM").sort((E,R)=>E===`${i().editPaneId}_MTM`?-1:R===`${i().editPaneId}_MTM`?1:E.localeCompare(R));console.log("🔧 Applying MTM changes. Existing keys:",L),console.log("🔧 Current MTM groups:",n(ri).length);const A=n(ri).length;if(L.length>A)for(let E=A;E<L.length;(E+=1)-1){const R=L[E],G=r().saveInds[R];if(G&&G.pane_id)try{console.log("🗑️ Removing excess MTM indicator from pane:",G.pane_id),(b=s())==null||b.removeIndicator({paneId:G.pane_id,name:"MTM"})}catch(_e){console.log("❌ Error removing excess MTM indicator:",_e)}}n(ri).forEach((E,R)=>{var Be,_t,Yo;const G=[E.period],_e={lines:[{color:E.color,size:E.thickness,style:E.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:E.lineStyle==="dashed"?[4,4]:E.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(R===0)console.log("🔄 Updating first MTM in pane:",i().editPaneId),(Be=s())==null||Be.overrideIndicator({name:"MTM",calcParams:G,styles:_e,paneId:i().editPaneId});else{const $o=`pane_MTM_${R+1}_MTM`,so=L.find(cn=>cn===$o);if(so){const cn=r().saveInds[so];cn&&cn.pane_id&&(console.log("🔄 Updating existing MTM in pane:",cn.pane_id),(_t=s())==null||_t.overrideIndicator({name:"MTM",calcParams:G,styles:_e,paneId:cn.pane_id}))}else{const cn=`pane_MTM_${R+1}`;console.log("🆕 Creating new MTM in pane:",cn);const _i=(Yo=s())==null?void 0:Yo.createIndicator({name:"MTM",calcParams:G,styles:_e},!0,{id:cn});_i&&console.log("✅ Created new MTM indicator with ID:",_i,"in pane:",cn)}}}),c.update(E=>{try{Object.keys(E.saveInds).forEach(R=>{E.saveInds[R]&&E.saveInds[R].name==="MTM"&&delete E.saveInds[R]}),n(ri).forEach((R,G)=>{try{const _e=G===0?`${i().editPaneId}_MTM`:`pane_MTM_${G+1}_MTM`,Be=G===0?i().editPaneId:`pane_MTM_${G+1}`;if(!_e||!Be){console.error(`❌ Invalid save key or pane ID for MTM group ${G}`);return}const _t={name:"MTM",mtmGroup:R,pane_id:Be,groupIndex:G,mtmGroups:G===0?[...n(ri)]:void 0,params:[R.period]};E.saveInds[_e]=_t,console.log("💾 Saved MTM group",G,"with key:",_e,"and pane ID:",Be)}catch(_e){console.error(`❌ Error saving MTM group ${G}:`,_e)}})}catch(R){console.error("❌ Error in MTM save operation:",R)}return E}),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),a(!1),console.log("✅ MTM configuration completed successfully")}catch(w){console.error("❌ Critical error in handleMtmConfirm:",w)}}function hf(){var L;if(!n(yt))return;const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="BIAS").sort((A,E)=>A===`${i().editPaneId}_BIAS`?-1:E===`${i().editPaneId}_BIAS`?1:A.localeCompare(E));console.log("🔧 Applying BIAS changes. Existing keys:",b),console.log("🔧 Current BIAS groups:",n(jo).length);const w=n(jo).length;if(b.length>w)for(let A=w;A<b.length;(A+=1)-1){const E=b[A],R=r().saveInds[E];if(R&&R.pane_id)try{console.log("🗑️ Removing excess BIAS indicator from pane:",R.pane_id),(L=s())==null||L.removeIndicator({paneId:R.pane_id,name:"BIAS"})}catch(G){console.log("❌ Error removing excess BIAS indicator:",G)}}n(jo).forEach((A,E)=>{var _e,Be,_t;const R=[A.period],G={lines:[{color:A.color,size:A.thickness,style:A.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:A.lineStyle==="dashed"?[4,4]:A.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(E===0)console.log("🔄 Updating first BIAS in pane:",i().editPaneId),(_e=s())==null||_e.overrideIndicator({name:"BIAS",calcParams:R,styles:G,paneId:i().editPaneId});else{const Yo=`pane_BIAS_${E+1}_BIAS`,$o=b.find(so=>so===Yo);if($o){const so=r().saveInds[$o];so&&so.pane_id&&(console.log("🔄 Updating existing BIAS in pane:",so.pane_id),(Be=s())==null||Be.overrideIndicator({name:"BIAS",calcParams:R,styles:G,paneId:so.pane_id}))}else{const so=`pane_BIAS_${E+1}`;console.log("🆕 Creating new BIAS in pane:",so);const cn=(_t=s())==null?void 0:_t.createIndicator({name:"BIAS",calcParams:R,styles:G},!0,{id:so});cn&&console.log("✅ Created new BIAS indicator with ID:",cn,"in pane:",so)}}}),c.update(A=>(Object.keys(A.saveInds).forEach(E=>{A.saveInds[E].name==="BIAS"&&delete A.saveInds[E]}),n(jo).forEach((E,R)=>{const G=R===0?`${i().editPaneId}_BIAS`:`pane_BIAS_${R+1}_BIAS`,_e=R===0?i().editPaneId:`pane_BIAS_${R+1}`,Be={name:"BIAS",biasGroup:E,pane_id:_e,groupIndex:R,biasGroups:R===0?[...n(jo)]:void 0,params:[E.period]};A.saveInds[G]=Be,console.log("💾 Saved BIAS group",R,"with key:",G,"and pane ID:",_e)}),A)),l.update(A=>(A.editIndName="",A.editPaneId="",A.modalIndCfg=!1,A)),a(!1),console.log("✅ BIAS configuration saved successfully")}function Yn(){if(!n(Kr))return;const b=Object.keys(r().saveInds).filter(R=>r().saveInds[R].name==="CCI").sort((R,G)=>R===`${i().editPaneId}_CCI`?-1:G===`${i().editPaneId}_CCI`?1:R.localeCompare(G));console.log("🔧 Applying CCI changes. Existing keys:",b),console.log("🔧 Current CCI groups:",n(Ci).length);const w=new Map,L=[],A=new Set;n(Ci).forEach((R,G)=>{let _e=null;for(const Be of b){if(A.has(Be))continue;const _t=r().saveInds[Be];if(_t&&_t.cciGroup&&(_t.cciGroup.id===R.id||_t.cciGroup.period===R.period&&_t.cciGroup.color===R.color&&_t.cciGroup.thickness===R.thickness&&_t.cciGroup.lineStyle===R.lineStyle)){_e=Be,A.add(Be);break}}if(!_e){let Be=G+1,_t;do _t=Be===1?`${i().editPaneId}_CCI`:`pane_CCI_${Be}_CCI`,Be+=1;while(A.has(_t)||b.includes(_t));_e=_t,A.add(_e)}w.set(R.id,_e),L.push(_e)});const E=b.filter(R=>!L.includes(R));E.forEach(R=>{var _e;const G=r().saveInds[R];if(G&&G.pane_id)try{console.log("🗑️ Removing CCI indicator from pane:",G.pane_id,"key:",R),(_e=s())==null||_e.removeIndicator({paneId:G.pane_id,name:"CCI"})}catch(Be){console.log("❌ Error removing CCI indicator:",Be)}}),n(Ci).forEach((R,G)=>{var $o,so;const _e=[R.period],Be={lines:[{color:R.color,size:R.thickness,style:R.lineStyle==="solid"?Oe.Solid:Oe.Dashed,dashedValue:R.lineStyle==="dashed"?[4,4]:R.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},_t=w.get(R.id),Yo=r().saveInds[_t];if(Yo&&Yo.pane_id)console.log("🔄 Updating existing CCI in pane:",Yo.pane_id,"with key:",_t),($o=s())==null||$o.overrideIndicator({name:"CCI",calcParams:_e,styles:Be,paneId:Yo.pane_id});else{const cn=_t===`${i().editPaneId}_CCI`?i().editPaneId:_t.replace("_CCI","");console.log("🆕 Creating new CCI in pane:",cn,"with key:",_t);const _i=(so=s())==null?void 0:so.createIndicator({name:"CCI",calcParams:_e,styles:Be},!0,{id:cn});_i&&console.log("✅ Created new CCI indicator with ID:",_i,"in pane:",cn)}}),c.update(R=>(E.forEach(G=>{delete R.saveInds[G],console.log("🗑️ Deleted save data for key:",G)}),n(Ci).forEach((G,_e)=>{const Be=w.get(G.id),_t=Be===`${i().editPaneId}_CCI`?i().editPaneId:Be.replace("_CCI",""),Yo={name:"CCI",cciGroup:G,pane_id:_t,groupIndex:_e,cciGroups:_e===0?[...n(Ci)]:void 0,params:[G.period]};R.saveInds[Be]=Yo,console.log("💾 Saved CCI group",_e,"with key:",Be,"and pane ID:",_t)}),R)),l.update(R=>(R.editIndName="",R.editPaneId="",R.modalIndCfg=!1,R)),a(!1),console.log("✅ CCI configuration saved successfully")}function vs(){n(Go)&&(Xr(),c.update(b=>(Object.keys(b.saveInds).forEach(w=>{b.saveInds[w].name==="SAR"&&delete b.saveInds[w]}),n(Rn).forEach((w,L)=>{const A=L===0?"candle_pane_SAR":`SAR_${L+1}`,E={name:"SAR",sarGroup:w,pane_id:"candle_pane",groupIndex:L,sarGroups:L===0?[...n(Rn)]:void 0,params:[w.start,w.increment,w.maxValue]};b.saveInds[A]=E}),b)),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1))}function _a(){n(dl)&&(Ga(),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1))}function Vr(){var L;if(!n(Fo))return;const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="DMI").sort((A,E)=>A===`${i().editPaneId}_DMI`?-1:E===`${i().editPaneId}_DMI`?1:A.localeCompare(E));console.log("🔧 Applying DMI changes. Existing keys:",b),console.log("🔧 Current DMI groups:",n(Pn).length);const w=n(Pn).length;if(b.length>w)for(let A=w;A<b.length;(A+=1)-1){const E=b[A],R=r().saveInds[E];try{console.log("🗑️ Removing excess DMI indicator from pane:",R.pane_id),(L=s())==null||L.removeIndicator({paneId:R.pane_id,name:"DMI"})}catch(G){console.log("❌ Error removing excess DMI indicator:",G)}delete r().saveInds[E]}n(Pn).forEach((A,E)=>{var _e,Be,_t;const R=[A.diPeriod,A.adxPeriod],G={lines:[{color:A.styles.diPlus.color,size:A.styles.diPlus.thickness,style:A.styles.diPlus.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.diPlus.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:A.styles.diMinus.color,size:A.styles.diMinus.thickness,style:A.styles.diMinus.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.diMinus.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:A.styles.adx.color,size:A.styles.adx.thickness,style:A.styles.adx.lineStyle==="dashed"?Oe.Dashed:Oe.Solid,dashedValue:A.styles.adx.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1}]};if(E===0)console.log("🔄 Updating first DMI in pane:",i().editPaneId),(_e=s())==null||_e.overrideIndicator({name:"DMI",calcParams:R,styles:G,paneId:i().editPaneId});else{const Yo=`pane_DMI_${E+1}_DMI`,$o=b.find(so=>so===Yo);if($o){const so=r().saveInds[$o];console.log("🔄 Updating existing DMI in pane:",so.pane_id),(Be=s())==null||Be.overrideIndicator({name:"DMI",calcParams:R,styles:G,paneId:so.pane_id})}else{const so=`pane_DMI_${E+1}`;console.log("🆕 Creating new DMI in pane:",so);const cn=(_t=s())==null?void 0:_t.createIndicator({name:"DMI",calcParams:R,styles:G},!0,{id:so});console.log("✅ Created new DMI indicator with ID:",cn,"in pane:",so)}}}),c.update(A=>(Object.keys(A.saveInds).forEach(E=>{A.saveInds[E].name==="DMI"&&delete A.saveInds[E]}),n(Pn).forEach((E,R)=>{const G=R===0?`${i().editPaneId}_DMI`:`pane_DMI_${R+1}_DMI`,_e=R===0?i().editPaneId:`pane_DMI_${R+1}`,Be={name:"DMI",dmiGroup:E,pane_id:_e,groupIndex:R,dmiGroups:R===0?[...n(Pn)]:void 0,params:[E.diPeriod,E.adxPeriod]};A.saveInds[G]=Be,console.log("💾 Saved DMI group",R,"with key:",G,"and pane ID:",_e)}),A)),l.update(A=>(A.editIndName="",A.editPaneId="",A.modalIndCfg=!1,A)),a(!1)}function Ps(b){var G,_e;const w=n($i)[b];if(!w||!s()){console.warn("❌ updatePvtIndicator: Missing group or chart",{group:w,chart:!!s()});return}console.log("🔄 updatePvtIndicator called:",{groupIndex:b,group:w});let L=Oe.Solid,A=[2,2];w.lineStyle==="dashed"?(L=Oe.Dashed,A=[4,4]):w.lineStyle==="dotted"&&(L=Oe.Dashed,A=[2,2]);const R=((G=s())==null?void 0:G.getIndicators()).filter(Be=>Be.name==="PVT");if(console.log("📊 Found PVT indicators on chart:",R.length),console.log("📊 Looking for group index:",b),R.length>b){const Be=R[b];console.log("✅ Found matching PVT indicator by index, updating styles...");const _t=(_e=s())==null?void 0:_e.overrideIndicator({name:"PVT",paneId:Be.paneId,styles:{lines:[{color:w.color,size:w.thickness,style:L,dashedValue:A,smooth:!1}]},figures:[{key:"pvt",title:"PVT: ",type:"line"}]});console.log("🎨 overrideIndicator result:",_t),console.log("🎨 Applied styles:",{color:w.color,size:w.thickness,style:L,dashedValue:A});const Yo=`${Be.paneId}_PVT`;console.log("💾 Using save key:",Yo),c.update($o=>{$o.saveInds[Yo]||($o.saveInds[Yo]={name:"PVT",pane_id:Be.paneId,pvtGroups:[]}),$o.saveInds[Yo].pvtGroups||($o.saveInds[Yo].pvtGroups=[]);const so=$o.saveInds[Yo].pvtGroups||[];for(;so.length<=b;)so.push({});return so[b]={...w},$o.saveInds[Yo].pvtGroups=so,console.log("💾 Persisted PVT changes to save data:",Yo,w),$o}),console.log("✅ PVT indicator updated successfully:",b,w)}else console.error("❌ PVT indicator not found on chart for group index:",b),console.log("📊 Available PVT indicators:",R.length),console.log("📊 Requested group index:",b)}function hi(b){if(!n(Wo)||!s()||b<0||b>=n(Oi).length)return;const w=n(Oi)[b];console.log("🔄 Updating TRIX indicator:",b,w);try{let A=function(_e){let Be=Oe.Solid,_t=[2,2];return _e==="dashed"?(Be=Oe.Dashed,_t=[4,4]):_e==="dotted"&&(Be=Oe.Dashed,_t=[2,2]),{lineStyle:Be,dashedValue:_t}},L=w.paneId||i().editPaneId;console.log("🔍 Using pane ID for TRIX update:",L,"for group:",b),s().removeIndicator({paneId:L,name:"TRIX"});const E=A(w.styles.trix.lineStyle),R=A(w.styles.signal.lineStyle);if(s().createIndicator({name:"TRIX",calcParams:[w.trixPeriod,w.signalPeriod],styles:{lines:[{color:w.styles.trix.color,size:w.styles.trix.thickness,style:E.lineStyle,dashedValue:E.dashedValue},{color:w.styles.signal.color,size:w.styles.signal.thickness,style:R.lineStyle,dashedValue:R.dashedValue}]}},L===i().editPaneId,{id:L})){const _e=`${L}_TRIX`;c.update(Be=>(Be.saveInds[_e]?Be.saveInds[_e].params=[w.trixPeriod,w.signalPeriod]:Be.saveInds[_e]={name:"TRIX",pane_id:L,params:[w.trixPeriod,w.signalPeriod]},Be.saveInds[_e].trixGroup={...w},Be))}console.log("✅ TRIX indicator updated successfully:",b)}catch(L){console.error("❌ Error updating TRIX indicator:",L)}}function Dl(){var L;if(!n(us)||!s())return;const w=((L=s())==null?void 0:L.getIndicators()).filter(A=>A.name==="ROC");console.log("📊 Found ROC indicators on chart:",w.length),console.log("📊 ROC groups to apply:",n(an).length),n(an).forEach((A,E)=>{var _t,Yo;const R=[A.period];let G=Oe.Solid,_e=[2,2];A.styles.roc.lineStyle==="dashed"?(G=Oe.Dashed,_e=[4,4]):A.styles.roc.lineStyle==="dotted"&&(G=Oe.Dashed,_e=[2,2]);const Be=w[E];if(Be){console.log(`🎨 Updating existing ROC indicator ${E} in pane:`,Be.paneId);const $o=(_t=s())==null?void 0:_t.overrideIndicator({name:"ROC",paneId:Be.paneId,calcParams:R,styles:{lines:[{color:A.styles.roc.color,size:A.styles.roc.thickness,style:G,dashedValue:_e,smooth:!1}]},figures:[{key:"roc",title:"ROC: ",type:"line"}]});console.log("🎨 overrideIndicator result:",$o);const so=`${Be.paneId}_ROC`;c.update(cn=>{cn.saveInds[so]||(cn.saveInds[so]={name:"ROC",pane_id:Be.paneId,params:R,rocGroups:[]}),cn.saveInds[so].rocGroups||(cn.saveInds[so].rocGroups=[]);const _i=cn.saveInds[so].rocGroups||[];for(;_i.length<=E;)_i.push({});return _i[E]={...A},cn.saveInds[so].rocGroups=_i,cn.saveInds[so].params=R,console.log("💾 Persisted ROC changes to save data:",so,A),cn}),console.log("✅ ROC indicator updated successfully:",E,A)}else{console.log(`➕ Creating new ROC indicator for group ${E}`);const $o={name:"ROC",calcParams:R,styles:{lines:[{color:A.styles.roc.color,size:A.styles.roc.thickness,style:G,dashedValue:_e,smooth:!1}]},figures:[{key:"roc",title:"ROC: ",type:"line"}]};(Yo=s())==null||Yo.createIndicator($o,!1,{axis:{gap:{bottom:2}}})}}),l.update(A=>(A.editIndName="",A.editPaneId="",A.modalIndCfg=!1,A)),a(!1)}function Ua(){var L;if(!n(or))return;const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="PSY").sort((A,E)=>A===`${i().editPaneId}_PSY`?-1:E===`${i().editPaneId}_PSY`?1:A.localeCompare(E)),w=n(ps).length;if(b.length>w)for(let A=w;A<b.length;(A+=1)-1){const E=b[A],R=r().saveInds[E];if(R&&R.pane_id)try{(L=s())==null||L.removeIndicator({paneId:R.pane_id,name:"PSY"})}catch(G){console.log("Error removing excess PSY indicator:",G)}}n(ps).forEach((A,E)=>{var $o,so,cn;const R=[A.psyPeriod,A.mapsyPeriod],G=[{key:"psy",title:"PSY: ",type:"line"}];A.showMapsy&&G.push({key:"mapsy",title:"MAPSY: ",type:"line"});const _e={lines:[]};let Be=Oe.Solid,_t=[2,2];if(A.styles.psy.lineStyle==="dashed"?(Be=Oe.Dashed,_t=[4,4]):A.styles.psy.lineStyle==="dotted"&&(Be=Oe.Dashed,_t=[2,2]),_e.lines.push({color:A.styles.psy.color,size:A.styles.psy.thickness,style:Be,dashedValue:_t,smooth:!1}),A.showMapsy){let _i=Oe.Solid,ac=[2,2];A.styles.mapsy.lineStyle==="dashed"?(_i=Oe.Dashed,ac=[4,4]):A.styles.mapsy.lineStyle==="dotted"&&(_i=Oe.Dashed,ac=[2,2]),_e.lines.push({color:A.styles.mapsy.color,size:A.styles.mapsy.thickness,style:_i,dashedValue:ac,smooth:!1})}const Yo={name:"PSY",calcParams:R,styles:_e,figures:G};if(E===0)($o=s())==null||$o.overrideIndicator({...Yo,paneId:i().editPaneId});else{const _i=`psy_${String(E+1).padStart(3,"0")}_PSY`,ac=b.find(xd=>xd===_i);if(ac){const xd=r().saveInds[ac];xd&&xd.pane_id&&((so=s())==null||so.overrideIndicator({...Yo,paneId:xd.pane_id}))}else{const xd=`psy_${String(E+1).padStart(3,"0")}`;((cn=s())==null?void 0:cn.createIndicator(Yo,!1,{id:xd,axis:{gap:{bottom:2}}}))&&(console.log(`✅ PSY ${E+1} created with pane ID:`,xd),A.actualPaneId=xd)}}}),c.update(A=>(Object.keys(A.saveInds).forEach(E=>{A.saveInds[E].name==="PSY"&&delete A.saveInds[E]}),n(ps).forEach((E,R)=>{const G=R===0?`${i().editPaneId}_PSY`:`psy_${String(R+1).padStart(3,"0")}_PSY`,_e=R===0?i().editPaneId:E.actualPaneId||`psy_${String(R+1).padStart(3,"0")}`;A.saveInds[G]={name:"PSY",psyGroup:E,pane_id:_e,groupIndex:R,params:[E.psyPeriod,E.mapsyPeriod]}}),A)),l.update(A=>(A.editIndName="",A.editPaneId="",A.modalIndCfg=!1,A)),a(!1)}function rt(){if(!n($s))return;const b=Object.keys(r().saveInds).filter(w=>r().saveInds[w].name==="OBV");n(_s).forEach((w,L)=>{var _t,Yo,$o;const A=[w.obvPeriod,w.maobvPeriod],E=[{key:"obv",title:"OBV: ",type:"line"}];w.showMaobv&&E.push({key:"maobv",title:"MAOBV: ",type:"line"});const R={lines:[]};let G=Oe.Solid,_e=[2,2];if(w.styles.obv.lineStyle==="dashed"?(G=Oe.Dashed,_e=[4,4]):w.styles.obv.lineStyle==="dotted"&&(G=Oe.Dashed,_e=[2,2]),R.lines.push({color:w.styles.obv.color,size:w.styles.obv.thickness,style:G,dashedValue:_e,smooth:!1}),w.showMaobv){let so=Oe.Solid,cn=[2,2];w.styles.maobv.lineStyle==="dashed"?(so=Oe.Dashed,cn=[4,4]):w.styles.maobv.lineStyle==="dotted"&&(so=Oe.Dashed,cn=[2,2]),R.lines.push({color:w.styles.maobv.color,size:w.styles.maobv.thickness,style:so,dashedValue:cn,smooth:!1})}const Be={name:"OBV",calcParams:A,styles:R,figures:E};if(L===0)(_t=s())==null||_t.overrideIndicator({...Be,paneId:i().editPaneId});else{const so=`pane_OBV_${L+1}_OBV`,cn=b.find(_i=>_i===so);if(cn){const _i=r().saveInds[cn];_i&&_i.pane_id&&((Yo=s())==null||Yo.overrideIndicator({...Be,paneId:_i.pane_id}))}else{const _i=`pane_OBV_${L+1}`;(($o=s())==null?void 0:$o.createIndicator(Be,!1,{id:_i,axis:{gap:{bottom:2}}}))&&(console.log(`✅ OBV ${L+1} created with pane ID:`,_i),w.actualPaneId=_i)}}}),c.update(w=>(Object.keys(w.saveInds).forEach(L=>{w.saveInds[L].name==="OBV"&&delete w.saveInds[L]}),n(_s).forEach((L,A)=>{const E=A===0?`${i().editPaneId}_OBV`:`pane_OBV_${A+1}_OBV`,R=A===0?i().editPaneId:L.actualPaneId||`pane_OBV_${A+1}`,G={name:"OBV",obvGroup:L,pane_id:R,groupIndex:A,obvGroups:A===0?[...n(_s)]:void 0,params:[L.obvPeriod,L.maobvPeriod]};w.saveInds[E]=G}),w)),l.update(w=>(w.editIndName="",w.editPaneId="",w.modalIndCfg=!1,w)),a(!1)}function He(){if(console.log("🚀 handleKdjConfirm started"),!n(_r)){console.log("❌ Not KDJ indicator, returning early");return}try{console.log("🔄 Applying KDJ changes, groups:",n(fn).length),console.log("📊 Current KDJ groups data:",JSON.parse(JSON.stringify(n(fn)))),console.log("🔄 Preserving existing indicators and updating with current values"),n(fn).forEach((b,w)=>{console.log(`🔄 Applying KDJ group ${w+1} with current values`),zu(w)}),c.update(b=>(n(fn).forEach((w,L)=>{const A=L===0?`${i().editPaneId}_KDJ`:`pane_KDJ_${L+1}_KDJ`,E=L===0?i().editPaneId:w.actualPaneId||`pane_KDJ_${L+1}`;console.log(`💾 Updating saved KDJ group ${L+1} with key:`,A,"pane ID:",E),b.saveInds[A]={name:"KDJ",kdjGroup:w,pane_id:E,groupIndex:L,kdjGroups:L===0?[...n(fn)]:void 0,params:[w.kPeriod,w.dPeriod,3]}}),b)),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1)}catch(b){console.error("❌ Error in handleKdjConfirm main logic:",b),console.log("🔄 Forcing popup close due to error in main logic..."),l.update(w=>(w.editIndName="",w.editPaneId="",w.modalIndCfg=!1,w)),a(!1),console.log("✅ Popup forcefully closed after error in main logic")}}function Ye(){n(Un)&&(Cs(),x(Li,!1),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1))}function Tt(){var L;if(!n(St))return;console.log("🔄 Applying AO changes, groups:",n(wo).length);const b=Object.keys(r().saveInds).filter(A=>r().saveInds[A].name==="AO").sort((A,E)=>A===`${i().editPaneId}_AO`?-1:E===`${i().editPaneId}_AO`?1:A.localeCompare(E));console.log("🔍 Existing AO keys:",b);const w=n(wo).length;if(b.length>w){console.log(`🗑️ Removing ${b.length-w} excess AO indicators`);for(let A=w;A<b.length;(A+=1)-1){const E=b[A],R=r().saveInds[E];if(R&&R.pane_id){console.log("🗑️ Removing AO indicator from pane:",R.pane_id);try{(L=s())==null||L.removeIndicator({paneId:R.pane_id,name:"AO"})}catch(G){console.log("Error removing excess AO indicator:",G)}}}}n(wo).forEach((A,E)=>{var _e,Be,_t;const R=[A.shortPeriod,A.longPeriod],G={bars:[{upColor:A.styles.increasing.color,downColor:A.styles.decreasing.color,noChangeColor:"#888888"}]};if(E===0)console.log("🔄 Updating first AO indicator in pane:",i().editPaneId),(_e=s())==null||_e.overrideIndicator({name:"AO",calcParams:R,styles:G,paneId:i().editPaneId});else{const Yo=`pane_AO_${E+1}_AO`,$o=b.find(so=>so===Yo);if($o){const so=r().saveInds[$o];so&&so.pane_id&&(console.log(`🔄 Updating existing AO ${E+1} in pane:`,so.pane_id),(Be=s())==null||Be.overrideIndicator({name:"AO",calcParams:R,styles:G,paneId:so.pane_id}))}else{const so=`pane_AO_${E+1}`;console.log(`🆕 Creating new AO ${E+1} with pane ID:`,so),(_t=s())==null||_t.createIndicator({name:"AO",calcParams:R,styles:G},!0,{id:so})}}}),c.update(A=>(Object.keys(A.saveInds).forEach(E=>{A.saveInds[E].name==="AO"&&delete A.saveInds[E]}),n(wo).forEach((E,R)=>{const G=R===0?`${i().editPaneId}_AO`:`pane_AO_${R+1}_AO`,_e=R===0?i().editPaneId:`pane_AO_${R+1}`;console.log(`💾 Saving AO group ${R+1} with key:`,G),A.saveInds[G]={name:"AO",aoGroup:E,pane_id:_e,groupIndex:R,aoGroups:R===0?[...n(wo)]:void 0,params:[E.shortPeriod,E.longPeriod]}}),A)),l.update(A=>(A.editIndName="",A.editPaneId="",A.modalIndCfg=!1,A)),a(!1)}function Pt(){n(Me)&&(n(Ot).length===0?x(Ot,D([{id:Jn(),paneId:i().editPaneId||"candle_pane",period:n(B),stdDev:n($),styles:{fillColor:n(S),fillOpacity:n(M),upperColor:n(I),middleColor:n(C),lowerColor:n(T),thickness:n(z),lineStyle:n(j)}}])):(n(Ot)[0].period=n(B),n(Ot)[0].stdDev=n($),n(Ot)[0].styles.fillColor=n(S),n(Ot)[0].styles.fillOpacity=n(M),n(Ot)[0].styles.upperColor=n(I),n(Ot)[0].styles.middleColor=n(C),n(Ot)[0].styles.lowerColor=n(T),n(Ot)[0].styles.thickness=n(z),n(Ot)[0].styles.lineStyle=n(j)),Co(),l.update(b=>(b.editIndName="",b.editPaneId="",b.modalIndCfg=!1,b)),a(!1))}function Xt(b){var A;if(console.log("🔄 handleConfirm called with:",b),console.log("📊 Current context:",{editIndName:i().editIndName,editPaneId:i().editPaneId,isKdj:n(_r),kdjGroups:n(fn)}),b==="close"||b==="cancel"){l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),x(Li,!1),a(!1);return}if(b==="confirm"&&n(Ue)&&i().editIndName&&i().editPaneId){gf();return}if(b==="confirm"&&n(cr)&&i().editIndName&&i().editPaneId){af(),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),a(!1);return}if(b==="confirm"&&n(fo)&&i().editIndName&&i().editPaneId){console.log("🔄 PVT Confirm: Applying all changes to chart"),n($i).forEach((E,R)=>{console.log(`🔄 Applying PVT group ${R}:`,E),Ps(R)}),c.update(E=>{const R=`${i().editPaneId}_PVT`;return E.saveInds[R]={...E.saveInds[R],pvtGroups:[...n($i)]},console.log("💾 Saved PVT groups to:",R),E}),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),a(!1);return}if(b==="confirm"&&n(gi)&&i().editIndName&&i().editPaneId){Lv();return}if(b==="confirm"&&n(lo)&&i().editIndName&&i().editPaneId){_u();return}if(b==="confirm"&&n(he)&&i().editIndName&&i().editPaneId){Vu();return}if(b==="confirm"&&n(mo)&&i().editIndName&&i().editPaneId){Of();return}if(b==="confirm"&&n(ke)&&i().editIndName&&i().editPaneId){vv();return}if(b==="confirm"&&n(wl)&&i().editIndName&&i().editPaneId){n(et).forEach((E,R)=>{nc(R)}),Rl(),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),a(!1);return}if(b==="confirm"&&n(Ul)&&i().editIndName&&i().editPaneId){zv();return}if(b==="confirm"&&n(wa)&&i().editIndName&&i().editPaneId){bp();return}if(b==="confirm"&&n(yt)&&i().editIndName&&i().editPaneId){hf();return}if(b==="confirm"&&n(ie)&&i().editIndName&&i().editPaneId){hl();return}if(b==="confirm"&&n(Kr)&&i().editIndName&&i().editPaneId){Yn();return}if(b==="confirm"&&n(Go)&&i().editIndName&&i().editPaneId){vs();return}if(b==="confirm"&&n(dl)&&i().editIndName&&i().editPaneId){_a();return}if(b==="confirm"&&n(Fo)&&i().editIndName&&i().editPaneId){Vr();return}if(b==="confirm"&&n(us)&&i().editIndName&&i().editPaneId){Dl();return}if(b==="confirm"&&n(or)&&i().editIndName&&i().editPaneId){Ua();return}if(b==="confirm"&&n($s)&&i().editIndName&&i().editPaneId){rt();return}if(b==="confirm"&&n(Kt)&&i().editIndName&&i().editPaneId){Hp();return}if(b==="confirm"&&n(_r)&&i().editIndName&&i().editPaneId){console.log("✅ KDJ confirm condition met, calling handleKdjConfirm"),He();return}if(b==="confirm"&&n(St)&&i().editIndName&&i().editPaneId){Tt();return}if(b==="confirm"&&n(Me)&&i().editIndName&&i().editPaneId){Pt();return}if(b==="confirm"&&n(Un)&&i().editIndName&&i().editPaneId){Ye();return}if(b!=="confirm"||!i().editIndName||!i().editPaneId||g.length===0){a(!1);return}const w=[],L={lines:[],bars:[]};v.forEach((E,R)=>{const G=g[R];if(G&&G.type==="color"){const _e=G.styleKey;if(_e){const Be=_e.match(/^(\w+)\[(\d+)\]\.(\w+)$/);if(Be){const[,_t,Yo,$o]=Be,so=parseInt(Yo);L[_t]||(L[_t]=[]),L[_t][so]||(L[_t][so]={}),L[_t][so][$o]=E||G.default}}}else(!Ef.isValid(E)||E==="")&&G&&G.default&&(E=G.default),w.push(Number(E))}),_.forEach((E,R)=>{let G=Oe.Solid,_e=[2,2];E.lineStyle==="dashed"?(G=Oe.Dashed,_e=[4,4]):E.lineStyle==="dotted"&&(G=Oe.Dashed,_e=[2,6]),L.lines[R]={color:E.color,size:E.thickness,style:G,dashedValue:_e}}),(A=s())==null||A.overrideIndicator({name:i().editIndName,calcParams:w,styles:L,paneId:i().editPaneId}),c.update(E=>{const R={name:i().editIndName,params:w,pane_id:i().editPaneId,styles:[..._]};return n(Me)||(R.fields=[...g]),E.saveInds[`${i().editPaneId}_${i().editIndName}`]=R,E}),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),a(!1)}B0();var yo=UE(),Qo=Rt(yo);av(Qo,{get title(){return n(ip)},width:600,maxWidth:"min(600px, 95vw)",maxHeight:"90vh",get show(){return a()},set show(b){a(b)},get theme(){return r().theme},click:Xt,children:(b,w)=>{var L=GE(),A=m(L);Te(A,()=>n(Ue),R=>{var G=p$(),_e=m(G);Vs(_e,17,()=>n(zo),_n,(Yo,$o,so)=>{var cn=u$(),_i=m(cn),ac=m(_i);ac.textContent=`MACD ${so+1}`;var xd=p(ac,2);Te(xd,()=>n(zo).length>1,On=>{var Js=d$();Js.__click=[c$,Il,$o],O(On,Js)}),f(_i);var fu=p(_i,2),Qd=m(fu),bu=p(m(Qd),2);Jt(bu),f(Qd);var Wd=p(Qd,2),Yd=p(m(Wd),2);Jt(Yd),f(Wd);var eu=p(Wd,2),qd=p(m(eu),2);Jt(qd),f(eu),f(fu);var Ld=p(fu,2),Kd=m(Ld),Wr=p(m(Kd),2),Ol=Qe(()=>Ep(so,"macdLine"));Wr.__click=function(...On){var Js;(Js=n(Ol))==null||Js.apply(this,On)};var Pd=p(Wr,2);Pd.__change=()=>kc(so);var $a=m(Pd);$a.value=($a.__value=1)==null?"":1;var Al=p($a);Al.value=(Al.__value=2)==null?"":2;var cd=p(Al);cd.value=(cd.__value=3)==null?"":3;var Da=p(cd);Da.value=(Da.__value=4)==null?"":4;var zc=p(Da);zc.value=(zc.__value=5)==null?"":5,f(Pd);var Cc=p(Pd,2);Cc.__change=()=>kc(so);var er=m(Cc);er.value=(er.__value="solid")==null?"":"solid";var Ea=p(er);Ea.value=(Ea.__value="dashed")==null?"":"dashed";var gc=p(Ea);gc.value=(gc.__value="dotted")==null?"":"dotted",f(Cc),f(Kd);var Nr=p(Kd,2),rl=p(m(Nr),2),tc=Qe(()=>Ep(so,"signalLine"));rl.__click=function(...On){var Js;(Js=n(tc))==null||Js.apply(this,On)};var xr=p(rl,2);xr.__change=()=>kc(so);var al=m(xr);al.value=(al.__value=1)==null?"":1;var Hl=p(al);Hl.value=(Hl.__value=2)==null?"":2;var wr=p(Hl);wr.value=(wr.__value=3)==null?"":3;var Ia=p(wr);Ia.value=(Ia.__value=4)==null?"":4;var Ll=p(Ia);Ll.value=(Ll.__value=5)==null?"":5,f(xr);var jr=p(xr,2);jr.__change=()=>kc(so);var Ui=m(jr);Ui.value=(Ui.__value="solid")==null?"":"solid";var ll=p(Ui);ll.value=(ll.__value="dashed")==null?"":"dashed";var Jr=p(ll);Jr.value=(Jr.__value="dotted")==null?"":"dotted",f(jr),f(Nr);var An=p(Nr,2),pl=p(m(An),2),Hn=Qe(()=>Ep(so,"positiveHistogram"));pl.__click=function(...On){var Js;(Js=n(Hn))==null||Js.apply(this,On)},f(An);var aa=p(An,2),Na=p(m(aa),2),qr=Qe(()=>Ep(so,"negativeHistogram"));Na.__click=function(...On){var Js;(Js=n(qr))==null||Js.apply(this,On)},f(aa),f(Ld),f(cn),Se(()=>{Nt(Wr,"style",`background-color: ${n($o).styles.macdLine.color??""}; border: 1px solid #ddd;`),Nt(rl,"style",`background-color: ${n($o).styles.signalLine.color??""}; border: 1px solid #ddd;`),Nt(pl,"style",`background-color: ${n($o).styles.positiveHistogram.color??""}; border: 1px solid #ddd;`),Nt(Na,"style",`background-color: ${n($o).styles.negativeHistogram.color??""}; border: 1px solid #ddd;`)}),Ho(bu,()=>n($o).fastPeriod,On=>n($o).fastPeriod=On),Ho(Yd,()=>n($o).slowPeriod,On=>n($o).slowPeriod=On),Ho(qd,()=>n($o).signalPeriod,On=>n($o).signalPeriod=On),rs(Pd,()=>n($o).styles.macdLine.thickness,On=>n($o).styles.macdLine.thickness=On),rs(Cc,()=>n($o).styles.macdLine.lineStyle,On=>n($o).styles.macdLine.lineStyle=On),rs(xr,()=>n($o).styles.signalLine.thickness,On=>n($o).styles.signalLine.thickness=On),rs(jr,()=>n($o).styles.signalLine.lineStyle,On=>n($o).styles.signalLine.lineStyle=On),O(Yo,cn)});var Be=p(_e,2),_t=m(Be);_t.__click=ic,f(Be),f(G),O(R,G)},R=>{var G=So(),_e=Rt(G);Te(_e,()=>n(cr),Be=>{var _t=v$(),Yo=m(_t),$o=m(Yo),so=p(m($o),2);Jt(so),so.__input=[ov,cr,s,d,i,l,Ws],f($o);var cn=p($o,2),_i=p(m(cn),2);Jt(_i),_i.__input=[ov,cr,s,d,i,l,Ws],f(cn);var ac=p(cn,2),xd=p(m(ac),2);Jt(xd),xd.__input=[ov,cr,s,d,i,l,Ws],f(ac);var fu=p(ac,2),Qd=p(m(fu),2);Jt(Qd),Qd.__input=[ov,cr,s,d,i,l,Ws],f(fu);var bu=p(fu,2),Wd=p(m(bu),2);Jt(Wd),Wd.__input=[ov,cr,s,d,i,l,Ws],f(bu);var Yd=p(bu,2),eu=p(m(Yd),2);Jt(eu),eu.__input=[ov,cr,s,d,i,l,Ws],f(Yd),f(Yo);var qd=p(Yo,2),Ld=m(qd),Kd=p(m(Ld),2),Wr=m(Kd);Jt(Wr),Wr.__input=[ov,cr,s,d,i,l,Ws];var Ol=p(Wr,2),Pd=m(Ol);Se(()=>Ve(Pd,`${(Ws.maxZoneWidthPct*100).toFixed(1)??""}%`)),f(Ol),f(Kd),f(Ld);var $a=p(Ld,2),Al=p(m($a),2),cd=m(Al);Jt(cd),cd.__input=[ov,cr,s,d,i,l,Ws];var Da=p(cd,2),zc=m(Da);Se(()=>Ve(zc,`${Ws.minVolumeFactor.toFixed(2)??""}x`)),f(Da),f(Al),f($a);var Cc=p($a,2),er=p(m(Cc),2),Ea=m(er);Jt(Ea),Ea.__input=[ov,cr,s,d,i,l,Ws];var gc=p(Ea,2),Nr=m(gc,!0);Se(()=>Ve(Nr,Ws.minOBVTrendStrength.toFixed(2))),f(gc),f(er),f(Cc);var rl=p(Cc,2),tc=p(m(rl),2),xr=m(tc);Jt(xr),xr.__input=[ov,cr,s,d,i,l,Ws];var al=p(xr,2),Hl=m(al,!0);Se(()=>Ve(Hl,Ws.minZoneScore.toFixed(2))),f(al),f(tc),f(rl),f(qd);var wr=p(qd,2),Ia=m(wr),Ll=p(m(Ia),2);Jt(Ll),Ll.__change=[ov,cr,s,d,i,l,Ws],f(Ia);var jr=p(Ia,2),Ui=p(m(jr),2);Jt(Ui),Ui.__change=[ov,cr,s,d,i,l,Ws],f(jr),f(wr);var ll=p(wr,2),Jr=p(m(ll),2);Jt(Jr),Jr.__input=[ov,cr,s,d,i,l,Ws],f(ll),f(_t),Ho(so,()=>Ws.zoneLookbackBars,An=>Ws.zoneLookbackBars=An),Ho(_i,()=>Ws.priorTrendLookback,An=>Ws.priorTrendLookback=An),Ho(xd,()=>Ws.minZoneBars,An=>Ws.minZoneBars=An),Ho(Qd,()=>Ws.maxZoneBars,An=>Ws.maxZoneBars=An),Ho(Wd,()=>Ws.atrPeriod,An=>Ws.atrPeriod=An),Ho(eu,()=>Ws.volumeMAPeriod,An=>Ws.volumeMAPeriod=An),Ho(Wr,()=>Ws.maxZoneWidthPct,An=>Ws.maxZoneWidthPct=An),Ho(cd,()=>Ws.minVolumeFactor,An=>Ws.minVolumeFactor=An),Ho(Ea,()=>Ws.minOBVTrendStrength,An=>Ws.minOBVTrendStrength=An),Ho(xr,()=>Ws.minZoneScore,An=>Ws.minZoneScore=An),_v(Ll,()=>Ws.mergeNearbyZones,An=>Ws.mergeNearbyZones=An),_v(Ui,()=>Ws.showLabels,An=>Ws.showLabels=An),Ho(Jr,()=>Ws.maxZonesDisplayed,An=>Ws.maxZonesDisplayed=An),O(Be,_t)},Be=>{var _t=So(),Yo=Rt(_t);Te(Yo,()=>n(Br),$o=>{var so=m$(),cn=m(so),_i=m(cn),ac=p(m(_i),2);Jt(ac),ac.__input=Gs,f(_i);var xd=p(_i,2),fu=p(m(xd),2);Jt(fu),fu.__input=Gs,f(xd);var Qd=p(xd,2),bu=p(m(Qd),2);Jt(bu),bu.__input=Gs,f(Qd);var Wd=p(Qd,2),Yd=p(m(Wd),2);Jt(Yd),Yd.__input=Gs,f(Wd);var eu=p(Wd,2),qd=p(m(eu),2);Jt(qd),qd.__input=Gs,f(eu);var Ld=p(eu,2),Kd=p(m(Ld),2),Wr=m(Kd);Jt(Wr),Wr.__input=Gs;var Ol=p(Wr,2),Pd=m(Ol);Se(()=>Ve(Pd,`${Number(v[5]??1.2).toFixed(2)??""}x`)),f(Ol),f(Kd),f(Ld),f(cn);var $a=p(cn,2),Al=m($a),cd=p(m(Al),2),Da=m(cd);Jt(Da),Da.__input=Gs,pn(2),f(cd),f(Al);var zc=p(Al,2),Cc=p(m(zc),2),er=m(Cc);Jt(er),er.__input=Gs;var Ea=p(er,2),gc=m(Ea,!0);Se(()=>Ve(gc,Number(v[7]??.35).toFixed(2))),f(Ea),f(Cc),f(zc);var Nr=p(zc,2),rl=p(m(Nr),2),tc=m(rl);Jt(tc),tc.__input=Gs;var xr=p(tc,2),al=m(xr,!0);Se(()=>Ve(al,Number(v[8]??.5).toFixed(2))),f(xr),f(rl),f(Nr),f($a);var Hl=p($a,2),wr=m(Hl),Ia=p(m(wr),2);Jt(Ia),Se(()=>wv(Ia,Number(v[9]??1)>0)),Ia.__change=[f$,v,Gs],f(wr);var Ll=p(wr,2),jr=p(m(Ll),2);Jt(jr),jr.__input=Gs,f(Ll),f(Hl),f(so),Ho(ac,()=>v[0],Ui=>v[0]=Ui),Ho(fu,()=>v[1],Ui=>v[1]=Ui),Ho(bu,()=>v[2],Ui=>v[2]=Ui),Ho(Yd,()=>v[3],Ui=>v[3]=Ui),Ho(qd,()=>v[4],Ui=>v[4]=Ui),Ho(Wr,()=>v[5],Ui=>v[5]=Ui),Ho(Da,()=>v[6],Ui=>v[6]=Ui),Ho(er,()=>v[7],Ui=>v[7]=Ui),Ho(tc,()=>v[8],Ui=>v[8]=Ui),Ho(jr,()=>v[10],Ui=>v[10]=Ui),O($o,so)},$o=>{var so=So(),cn=Rt(so);Te(cn,()=>n(Fi),_i=>{var ac=g$(),xd=m(ac),fu=p(m(xd),2),Qd=m(fu),bu=p(m(Qd),2);Jt(bu),bu.__input=Ql,f(Qd);var Wd=p(Qd,2),Yd=p(m(Wd),2);Jt(Yd),Yd.__input=Ql,f(Wd);var eu=p(Wd,2),qd=p(m(eu),2);Jt(qd),qd.__input=Ql,f(eu);var Ld=p(eu,2),Kd=p(m(Ld),2);Jt(Kd),Kd.__input=Ql,f(Ld);var Wr=p(Ld,2),Ol=p(m(Wr),2);Jt(Ol),Ol.__input=Ql,f(Wr);var Pd=p(Wr,2),$a=p(m(Pd),2);Jt($a),$a.__input=Ql,f(Pd),f(fu),f(xd);var Al=p(xd,2),cd=p(m(Al),2),Da=m(cd),zc=p(m(Da),2),Cc=m(zc);Jt(Cc),Cc.__input=Ql;var er=p(Cc,2),Ea=m(er,!0);Se(()=>Ve(Ea,Number(v[6]??.7).toFixed(2))),f(er),f(zc),f(Da);var gc=p(Da,2),Nr=p(m(gc),2);Jt(Nr),Nr.__input=Ql,f(gc);var rl=p(gc,2),tc=p(m(rl),2),xr=m(tc);Jt(xr),xr.__input=Ql;var al=p(xr,2),Hl=m(al);Se(()=>Ve(Hl,`${Number(v[8]??1.3).toFixed(2)??""}x`)),f(al),f(tc),f(rl);var wr=p(rl,2),Ia=p(m(wr),2),Ll=m(Ia);Jt(Ll),Ll.__input=Ql;var jr=p(Ll,2),Ui=m(jr);Se(()=>Ve(Ui,`${Number(v[9]??1.3).toFixed(2)??""}x`)),f(jr),f(Ia),f(wr);var ll=p(wr,2),Jr=p(m(ll),2),An=m(Jr);Jt(An),An.__input=Ql;var pl=p(An,2),Hn=m(pl,!0);Se(()=>Ve(Hn,Number(v[10]??.6).toFixed(2))),f(pl),f(Jr),f(ll);var aa=p(ll,2),Na=p(m(aa),2);Jt(Na),Na.__input=Ql,f(aa);var qr=p(aa,2),On=p(m(qr),2);Jt(On),On.__input=Ql,f(qr),f(cd),f(Al),f(ac),Ho(bu,()=>v[0],Js=>v[0]=Js),Ho(Yd,()=>v[1],Js=>v[1]=Js),Ho(qd,()=>v[2],Js=>v[2]=Js),Ho(Kd,()=>v[3],Js=>v[3]=Js),Ho(Ol,()=>v[4],Js=>v[4]=Js),Ho($a,()=>v[5],Js=>v[5]=Js),Ho(Cc,()=>v[6],Js=>v[6]=Js),Ho(Nr,()=>v[7],Js=>v[7]=Js),Ho(xr,()=>v[8],Js=>v[8]=Js),Ho(Ll,()=>v[9],Js=>v[9]=Js),Ho(An,()=>v[10],Js=>v[10]=Js),Ho(Na,()=>v[11],Js=>v[11]=Js),Ho(On,()=>v[12],Js=>v[12]=Js),O(_i,ac)},_i=>{var ac=So(),xd=Rt(ac);Te(xd,()=>n(fr),fu=>{var Qd=h$(),bu=m(Qd),Wd=p(m(bu),2),Yd=m(Wd),eu=p(m(Yd),2);Jt(eu),eu.__input=ia,f(Yd);var qd=p(Yd,2),Ld=p(m(qd),2);Jt(Ld),Ld.__input=ia,f(qd);var Kd=p(qd,2),Wr=p(m(Kd),2);Jt(Wr),Wr.__input=ia,f(Kd);var Ol=p(Kd,2),Pd=p(m(Ol),2);Jt(Pd),Pd.__input=ia,f(Ol);var $a=p(Ol,2),Al=p(m($a),2);Jt(Al),Al.__input=ia,f($a);var cd=p($a,2),Da=p(m(cd),2);Jt(Da),Da.__input=ia,f(cd),f(Wd),f(bu);var zc=p(bu,2),Cc=p(m(zc),2),er=m(Cc),Ea=p(m(er),2),gc=m(Ea);Jt(gc),gc.__input=ia;var Nr=p(gc,2),rl=m(Nr,!0);Se(()=>Ve(rl,Number(v[6]??.7).toFixed(2))),f(Nr),f(Ea),f(er);var tc=p(er,2),xr=p(m(tc),2);Jt(xr),xr.__input=ia,f(tc);var al=p(tc,2),Hl=p(m(al),2),wr=m(Hl);Jt(wr),wr.__input=ia;var Ia=p(wr,2),Ll=m(Ia);Se(()=>Ve(Ll,`${Number(v[8]??1.3).toFixed(2)??""}x`)),f(Ia),f(Hl),f(al);var jr=p(al,2),Ui=p(m(jr),2),ll=m(Ui);Jt(ll),ll.__input=ia;var Jr=p(ll,2),An=m(Jr);Se(()=>Ve(An,`${Number(v[9]??1.3).toFixed(2)??""}x`)),f(Jr),f(Ui),f(jr);var pl=p(jr,2),Hn=p(m(pl),2),aa=m(Hn);Jt(aa),aa.__input=ia;var Na=p(aa,2),qr=m(Na,!0);Se(()=>Ve(qr,Number(v[10]??.6).toFixed(2))),f(Na),f(Hn),f(pl);var On=p(pl,2),Js=p(m(On),2);Jt(Js),Js.__input=ia,f(On);var pr=p(On,2),Ya=p(m(pr),2);Jt(Ya),Ya.__input=ia,f(pr),f(Cc),f(zc),f(Qd),Ho(eu,()=>v[0],ti=>v[0]=ti),Ho(Ld,()=>v[1],ti=>v[1]=ti),Ho(Wr,()=>v[2],ti=>v[2]=ti),Ho(Pd,()=>v[3],ti=>v[3]=ti),Ho(Al,()=>v[4],ti=>v[4]=ti),Ho(Da,()=>v[5],ti=>v[5]=ti),Ho(gc,()=>v[6],ti=>v[6]=ti),Ho(xr,()=>v[7],ti=>v[7]=ti),Ho(wr,()=>v[8],ti=>v[8]=ti),Ho(ll,()=>v[9],ti=>v[9]=ti),Ho(aa,()=>v[10],ti=>v[10]=ti),Ho(Js,()=>v[11],ti=>v[11]=ti),Ho(Ya,()=>v[12],ti=>v[12]=ti),O(fu,Qd)},fu=>{var Qd=So(),bu=Rt(Qd);Te(bu,()=>n(wl),Wd=>{var Yd=b$(),eu=m(Yd);Vs(eu,17,()=>n(et),_n,(Kd,Wr,Ol)=>{var Pd=y$(),$a=m(Pd),Al=m($a);Al.textContent=`RSI ${Ol+1}`;var cd=p(Al,2);Te(cd,()=>n(et).length>1,Ys=>{var wn=_$();wn.__click=()=>Wc(Ol),O(Ys,wn)}),f($a);var Da=p($a,2),zc=m(Da),Cc=p(m(zc),2);Jt(Cc),Cc.__change=()=>{x(et,D([...n(et)])),nc(Ol)},f(zc);var er=p(zc,2),Ea=p(m(er),2);Jt(Ea),Ea.__change=()=>{x(et,D([...n(et)])),nc(Ol)},f(er);var gc=p(er,2),Nr=p(m(gc),2);Jt(Nr),Nr.__change=()=>{x(et,D([...n(et)])),nc(Ol)},f(gc);var rl=p(gc,2),tc=p(m(rl),2);Jt(tc),tc.__change=()=>{x(et,D([...n(et)])),nc(Ol)},f(rl),f(Da);var xr=p(Da,2),al=m(xr),Hl=p(m(al),2),wr=m(Hl);wr.__click=Ys=>{x(za,D(Ol));const wn=Ys.currentTarget.getBoundingClientRect();x(En,D({x:wn.left+wn.width/2,y:wn.bottom+5})),x(pa,!0)};var Ia=p(wr,2);Ia.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var Ll=m(Ia);Ll.value=(Ll.__value=1)==null?"":1;var jr=p(Ll);jr.value=(jr.__value=2)==null?"":2;var Ui=p(jr);Ui.value=(Ui.__value=3)==null?"":3;var ll=p(Ui);ll.value=(ll.__value=4)==null?"":4;var Jr=p(ll);Jr.value=(Jr.__value=5)==null?"":5,f(Ia);var An=p(Ia,2);An.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var pl=m(An);pl.value=(pl.__value="solid")==null?"":"solid";var Hn=p(pl);Hn.value=(Hn.__value="dashed")==null?"":"dashed";var aa=p(Hn);aa.value=(aa.__value="dotted")==null?"":"dotted",f(An),f(Hl),f(al),f(xr);var Na=p(xr,2),qr=p(m(Na),2),On=p(m(qr),2),Js=m(On);Js.__click=Ys=>{x(jt,D(Ol));const wn=Ys.currentTarget.getBoundingClientRect();x(De,D({x:wn.left+wn.width/2,y:wn.bottom+5})),x(de,!0)};var pr=p(Js,2);pr.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var Ya=m(pr);Ya.value=(Ya.__value=1)==null?"":1;var ti=p(Ya);ti.value=(ti.__value=2)==null?"":2;var ir=p(ti);ir.value=(ir.__value=3)==null?"":3,f(pr);var Hr=p(pr,2);Hr.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var Ka=m(Hr);Ka.value=(Ka.__value="solid")==null?"":"solid";var yi=p(Ka);yi.value=(yi.__value="dashed")==null?"":"dashed";var Yi=p(yi);Yi.value=(Yi.__value="dotted")==null?"":"dotted",f(Hr),f(On),f(qr);var kr=p(qr,2),Ei=p(m(kr),2),Rr=m(Ei);Rr.__click=Ys=>{x(jt,D(Ol));const wn=Ys.currentTarget.getBoundingClientRect();x(xe,D({x:wn.left+wn.width/2,y:wn.bottom+5})),x(Ee,!0)};var Qr=p(Rr,2);Qr.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var dn=m(Qr);dn.value=(dn.__value=1)==null?"":1;var oi=p(dn);oi.value=(oi.__value=2)==null?"":2;var Mi=p(oi);Mi.value=(Mi.__value=3)==null?"":3,f(Qr);var Ni=p(Qr,2);Ni.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var Ki=m(Ni);Ki.value=(Ki.__value="solid")==null?"":"solid";var Mr=p(Ki);Mr.value=(Mr.__value="dashed")==null?"":"dashed";var si=p(Mr);si.value=(si.__value="dotted")==null?"":"dotted",f(Ni),f(Ei),f(kr);var Ti=p(kr,2),ba=p(m(Ti),2),rr=m(ba);rr.__click=Ys=>{x(jt,D(Ol));const wn=Ys.currentTarget.getBoundingClientRect();x(at,D({x:wn.left+wn.width/2,y:wn.bottom+5})),x(gt,!0)};var ar=p(rr,2);ar.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var $n=m(ar);$n.value=($n.__value=1)==null?"":1;var Us=p($n);Us.value=(Us.__value=2)==null?"":2;var Zi=p(Us);Zi.value=(Zi.__value=3)==null?"":3,f(ar);var bi=p(ar,2);bi.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var ni=m(bi);ni.value=(ni.__value="solid")==null?"":"solid";var Dn=p(ni);Dn.value=(Dn.__value="dashed")==null?"":"dashed";var Gr=p(Dn);Gr.value=(Gr.__value="dotted")==null?"":"dotted",f(bi),f(ba),f(Ti);var Ts=p(Ti,2),la=p(m(Ts),2),ji=m(la);Jt(ji),ji.__change=()=>{x(et,D([...n(et)])),nc(Ol)};var Ln=p(ji,2),Ma=m(Ln);Se(()=>Ve(Ma,`${Math.round((n(Wr).fillOpacity??.15)*100)??""}%`)),f(Ln),f(la),f(Ts),f(Na),f(Pd),Se(()=>{Nt(wr,"style",`background-color: ${n(Wr).styles.rsi.color??""}`),Nt(Js,"style",`background-color: ${(n(Wr).styles.overboughtColor||"#EF4444")??""}`),Nt(Rr,"style",`background-color: ${(n(Wr).styles.oversoldColor||"#22C55E")??""}`),Nt(rr,"style",`background-color: ${(n(Wr).styles.middleLineColor||"#6B7280")??""}`)}),Ho(Cc,()=>n(Wr).period,Ys=>n(Wr).period=Ys),Ho(Ea,()=>n(Wr).overboughtLevel,Ys=>n(Wr).overboughtLevel=Ys),Ho(Nr,()=>n(Wr).middleLevel,Ys=>n(Wr).middleLevel=Ys),Ho(tc,()=>n(Wr).oversoldLevel,Ys=>n(Wr).oversoldLevel=Ys),rs(Ia,()=>n(Wr).styles.rsi.thickness,Ys=>n(Wr).styles.rsi.thickness=Ys),rs(An,()=>n(Wr).styles.rsi.lineStyle,Ys=>n(Wr).styles.rsi.lineStyle=Ys),rs(pr,()=>n(Wr).styles.overboughtThickness,Ys=>n(Wr).styles.overboughtThickness=Ys),rs(Hr,()=>n(Wr).styles.overboughtLineStyle,Ys=>n(Wr).styles.overboughtLineStyle=Ys),rs(Qr,()=>n(Wr).styles.oversoldThickness,Ys=>n(Wr).styles.oversoldThickness=Ys),rs(Ni,()=>n(Wr).styles.oversoldLineStyle,Ys=>n(Wr).styles.oversoldLineStyle=Ys),rs(ar,()=>n(Wr).styles.middleLineThickness,Ys=>n(Wr).styles.middleLineThickness=Ys),rs(bi,()=>n(Wr).styles.middleLineStyle,Ys=>n(Wr).styles.middleLineStyle=Ys),Ho(ji,()=>n(Wr).fillOpacity,Ys=>n(Wr).fillOpacity=Ys),O(Kd,Pd)});var qd=p(eu,2),Ld=m(qd);Ld.__click=Jd,f(qd),f(Yd),O(Wd,Yd)},Wd=>{var Yd=So(),eu=Rt(Yd);Te(eu,()=>n(Cl),qd=>{var Ld=k$(),Kd=m(Ld);Vs(Kd,17,()=>n(Ao),_n,(Pd,$a,Al)=>{var cd=w$(),Da=m(cd),zc=m(Da);zc.textContent=`Stochastic ${Al+1}`;var Cc=p(zc,2);Te(Cc,()=>n(Ao).length>1,$n=>{var Us=x$();Us.__click=()=>Pl(Al),O($n,Us)}),f(Da);var er=p(Da,2),Ea=m(er),gc=p(m(Ea),2);Jt(gc),gc.__change=()=>kl(Al),f(Ea);var Nr=p(Ea,2),rl=p(m(Nr),2);Jt(rl),rl.__change=()=>kl(Al),f(Nr);var tc=p(Nr,2),xr=p(m(tc),2);Jt(xr),xr.__change=()=>kl(Al),f(tc);var al=p(tc,2),Hl=p(m(al),2);Jt(Hl),Hl.__change=()=>kl(Al),f(al),f(er);var wr=p(er,2),Ia=m(wr),Ll=p(m(Ia),2);Jt(Ll),Ll.__change=()=>kl(Al),f(Ia),f(wr);var jr=p(wr,2),Ui=m(jr),ll=p(m(Ui),2),Jr=m(ll);Jr.__click=$n=>{const Us=$n.currentTarget.getBoundingClientRect();x(Ko,D({x:Us.left,y:Us.bottom+5})),x(Qt,D(Al)),x(Rs,!0)};var An=p(Jr,2);An.__change=()=>kl(Al);var pl=m(An);pl.value=(pl.__value=1)==null?"":1;var Hn=p(pl);Hn.value=(Hn.__value=2)==null?"":2;var aa=p(Hn);aa.value=(aa.__value=3)==null?"":3;var Na=p(aa);Na.value=(Na.__value=4)==null?"":4;var qr=p(Na);qr.value=(qr.__value=5)==null?"":5,f(An);var On=p(An,2);On.__change=()=>kl(Al);var Js=m(On);Js.value=(Js.__value="solid")==null?"":"solid";var pr=p(Js);pr.value=(pr.__value="dashed")==null?"":"dashed";var Ya=p(pr);Ya.value=(Ya.__value="dotted")==null?"":"dotted",f(On),f(ll),f(Ui),f(jr);var ti=p(jr,2),ir=m(ti),Hr=p(m(ir),2),Ka=m(Hr);Ka.__click=$n=>{const Us=$n.currentTarget.getBoundingClientRect();x(Ko,D({x:Us.left,y:Us.bottom+5})),x(Qt,D(Al)),x(Zs,!0)};var yi=p(Ka,2);yi.__change=()=>kl(Al);var Yi=m(yi);Yi.value=(Yi.__value=1)==null?"":1;var kr=p(Yi);kr.value=(kr.__value=2)==null?"":2;var Ei=p(kr);Ei.value=(Ei.__value=3)==null?"":3;var Rr=p(Ei);Rr.value=(Rr.__value=4)==null?"":4;var Qr=p(Rr);Qr.value=(Qr.__value=5)==null?"":5,f(yi);var dn=p(yi,2);dn.__change=()=>kl(Al);var oi=m(dn);oi.value=(oi.__value="solid")==null?"":"solid";var Mi=p(oi);Mi.value=(Mi.__value="dashed")==null?"":"dashed";var Ni=p(Mi);Ni.value=(Ni.__value="dotted")==null?"":"dotted",f(dn),f(Hr),f(ir),f(ti);var Ki=p(ti,2),Mr=p(m(Ki),2),si=p(m(Mr),2);si.__click=$n=>{const Us=$n.currentTarget.getBoundingClientRect();x(Ko,D({x:Us.left,y:Us.bottom+5})),x(Qt,D(Al)),x(gn,!0)},f(Mr);var Ti=p(Mr,2),ba=p(m(Ti),2);ba.__click=$n=>{const Us=$n.currentTarget.getBoundingClientRect();x(Ko,D({x:Us.left,y:Us.bottom+5})),x(Qt,D(Al)),x(Wn,!0)},f(Ti);var rr=p(Ti,2),ar=p(m(rr),2);ar.__click=$n=>{const Us=$n.currentTarget.getBoundingClientRect();x(Ko,D({x:Us.left,y:Us.bottom+5})),x(Qt,D(Al)),x(Tn,!0)},f(rr),f(Ki),f(cd),Se(()=>{Nt(Jr,"style",`background-color: ${n($a).styles.kLine.color??""}`),Nt(Ka,"style",`background-color: ${n($a).styles.dLine.color??""}`),Nt(si,"style",`background-color: ${(n($a).styles.overboughtColor||"#EF4444")??""}`),Nt(ba,"style",`background-color: ${(n($a).styles.oversoldColor||"#10B981")??""}`),Nt(ar,"style",`background-color: ${(n($a).styles.midLineColor||"#6B7280")??""}`)}),Ho(gc,()=>n($a).kPeriod,$n=>n($a).kPeriod=$n),Ho(rl,()=>n($a).dPeriod,$n=>n($a).dPeriod=$n),Ho(xr,()=>n($a).overboughtLevel,$n=>n($a).overboughtLevel=$n),Ho(Hl,()=>n($a).oversoldLevel,$n=>n($a).oversoldLevel=$n),Ho(Ll,()=>n($a).midLevel,$n=>n($a).midLevel=$n),rs(An,()=>n($a).styles.kLine.thickness,$n=>n($a).styles.kLine.thickness=$n),rs(On,()=>n($a).styles.kLine.lineStyle,$n=>n($a).styles.kLine.lineStyle=$n),rs(yi,()=>n($a).styles.dLine.thickness,$n=>n($a).styles.dLine.thickness=$n),rs(dn,()=>n($a).styles.dLine.lineStyle,$n=>n($a).styles.dLine.lineStyle=$n),O(Pd,cd)});var Wr=p(Kd,2),Ol=m(Wr);Ol.__click=ql,f(Wr),f(Ld),O(qd,Ld)},qd=>{var Ld=So(),Kd=Rt(Ld);Te(Kd,()=>n(Fo),Wr=>{var Ol=I$(),Pd=m(Ol);Vs(Pd,17,()=>n(Pn),_n,(cd,Da,zc)=>{var Cc=P$(),er=m(Cc),Ea=m(er);Ea.textContent=`DMI ${zc+1}`;var gc=p(Ea,2);Te(gc,()=>n(Pn).length>1,ni=>{var Dn=C$();Dn.__click=[S$,yd,Da],O(ni,Dn)}),f(er);var Nr=p(er,2),rl=m(Nr),tc=p(m(rl),2);Jt(tc),tc.__input=bn,f(rl);var xr=p(rl,2),al=p(m(xr),2);Jt(al),al.__input=bn,f(xr),f(Nr);var Hl=p(Nr,2),wr=m(Hl),Ia=p(m(wr),2),Ll=Qe(()=>Wv(zc,"diPlus"));Ia.__click=function(...ni){var Dn;(Dn=n(Ll))==null||Dn.apply(this,ni)};var jr=m(Ia);f(Ia);var Ui=p(Ia,2);Ui.__change=bn;var ll=m(Ui);ll.value=(ll.__value=1)==null?"":1;var Jr=p(ll);Jr.value=(Jr.__value=2)==null?"":2;var An=p(Jr);An.value=(An.__value=3)==null?"":3;var pl=p(An);pl.value=(pl.__value=4)==null?"":4;var Hn=p(pl);Hn.value=(Hn.__value=5)==null?"":5,f(Ui);var aa=p(Ui,2);aa.__change=bn;var Na=m(aa);Na.value=(Na.__value="solid")==null?"":"solid";var qr=p(Na);qr.value=(qr.__value="dashed")==null?"":"dashed";var On=p(qr);On.value=(On.__value="dotted")==null?"":"dotted",f(aa),f(wr);var Js=p(wr,2),pr=p(m(Js),2),Ya=Qe(()=>Wv(zc,"diMinus"));pr.__click=function(...ni){var Dn;(Dn=n(Ya))==null||Dn.apply(this,ni)};var ti=m(pr);f(pr);var ir=p(pr,2);ir.__change=bn;var Hr=m(ir);Hr.value=(Hr.__value=1)==null?"":1;var Ka=p(Hr);Ka.value=(Ka.__value=2)==null?"":2;var yi=p(Ka);yi.value=(yi.__value=3)==null?"":3;var Yi=p(yi);Yi.value=(Yi.__value=4)==null?"":4;var kr=p(Yi);kr.value=(kr.__value=5)==null?"":5,f(ir);var Ei=p(ir,2);Ei.__change=bn;var Rr=m(Ei);Rr.value=(Rr.__value="solid")==null?"":"solid";var Qr=p(Rr);Qr.value=(Qr.__value="dashed")==null?"":"dashed";var dn=p(Qr);dn.value=(dn.__value="dotted")==null?"":"dotted",f(Ei),f(Js);var oi=p(Js,2),Mi=p(m(oi),2),Ni=Qe(()=>Wv(zc,"adx"));Mi.__click=function(...ni){var Dn;(Dn=n(Ni))==null||Dn.apply(this,ni)};var Ki=m(Mi);f(Mi);var Mr=p(Mi,2);Mr.__change=bn;var si=m(Mr);si.value=(si.__value=1)==null?"":1;var Ti=p(si);Ti.value=(Ti.__value=2)==null?"":2;var ba=p(Ti);ba.value=(ba.__value=3)==null?"":3;var rr=p(ba);rr.value=(rr.__value=4)==null?"":4;var ar=p(rr);ar.value=(ar.__value=5)==null?"":5,f(Mr);var $n=p(Mr,2);$n.__change=bn;var Us=m($n);Us.value=(Us.__value="solid")==null?"":"solid";var Zi=p(Us);Zi.value=(Zi.__value="dashed")==null?"":"dashed";var bi=p(Zi);bi.value=(bi.__value="dotted")==null?"":"dotted",f($n),f(oi),f(Hl),f(Cc),Se(()=>{Nt(jr,"style",`background-color: ${n(Da).styles.diPlus.color??""}`),Nt(ti,"style",`background-color: ${n(Da).styles.diMinus.color??""}`),Nt(Ki,"style",`background-color: ${n(Da).styles.adx.color??""}`)}),Ho(tc,()=>n(Da).diPeriod,ni=>n(Da).diPeriod=ni),Ho(al,()=>n(Da).adxPeriod,ni=>n(Da).adxPeriod=ni),rs(Ui,()=>n(Da).styles.diPlus.thickness,ni=>n(Da).styles.diPlus.thickness=ni),rs(aa,()=>n(Da).styles.diPlus.lineStyle,ni=>n(Da).styles.diPlus.lineStyle=ni),rs(ir,()=>n(Da).styles.diMinus.thickness,ni=>n(Da).styles.diMinus.thickness=ni),rs(Ei,()=>n(Da).styles.diMinus.lineStyle,ni=>n(Da).styles.diMinus.lineStyle=ni),rs(Mr,()=>n(Da).styles.adx.thickness,ni=>n(Da).styles.adx.thickness=ni),rs($n,()=>n(Da).styles.adx.lineStyle,ni=>n(Da).styles.adx.lineStyle=ni),O(cd,Cc)});var $a=p(Pd,2),Al=m($a);Al.__click=[n$,Fo,Pn,bn],f($a),f(Ol),O(Wr,Ol)},Wr=>{var Ol=So(),Pd=Rt(Ol);Te(Pd,()=>n(lo),$a=>{var Al=L$(),cd=m(Al);Vs(cd,17,()=>n(Et),_n,(Cc,er,Ea)=>{var gc=A$(),Nr=m(gc),rl=m(Nr);rl.textContent=`Williams %R ${Ea+1}`;var tc=p(rl,2);Te(tc,()=>n(Et).length>1,sn=>{var Cr=T$();Cr.__click=[M$,ss,er],O(sn,Cr)}),f(Nr);var xr=p(Nr,2),al=m(xr),Hl=p(m(al),2);Jt(Hl),Hl.__change=()=>sr(Ea),f(al);var wr=p(al,2),Ia=p(m(wr),2);Jt(Ia),Ia.__change=()=>sr(Ea),f(wr);var Ll=p(wr,2),jr=p(m(Ll),2);Jt(jr),jr.__change=()=>sr(Ea),f(Ll);var Ui=p(Ll,2),ll=p(m(Ui),2);Jt(ll),ll.__change=()=>sr(Ea),f(Ui),f(xr);var Jr=p(xr,2),An=m(Jr),pl=p(m(An),2),Hn=Qe(()=>Up(Ea));pl.__click=function(...sn){var Cr;(Cr=n(Hn))==null||Cr.apply(this,sn)};var aa=m(pl);f(pl);var Na=p(pl,2);Na.__change=()=>sr(Ea);var qr=m(Na);qr.value=(qr.__value=1)==null?"":1;var On=p(qr);On.value=(On.__value=2)==null?"":2;var Js=p(On);Js.value=(Js.__value=3)==null?"":3;var pr=p(Js);pr.value=(pr.__value=4)==null?"":4;var Ya=p(pr);Ya.value=(Ya.__value=5)==null?"":5,f(Na);var ti=p(Na,2);ti.__change=()=>sr(Ea);var ir=m(ti);ir.value=(ir.__value="solid")==null?"":"solid";var Hr=p(ir);Hr.value=(Hr.__value="dashed")==null?"":"dashed";var Ka=p(Hr);Ka.value=(Ka.__value="dotted")==null?"":"dotted",f(ti),f(An),f(Jr);var yi=p(Jr,2),Yi=p(m(yi),2),kr=p(m(Yi),2),Ei=Qe(()=>dv(Ea));kr.__click=function(...sn){var Cr;(Cr=n(Ei))==null||Cr.apply(this,sn)};var Rr=m(kr);f(kr);var Qr=p(kr,2);Qr.__change=()=>sr(Ea);var dn=m(Qr);dn.value=(dn.__value=1)==null?"":1;var oi=p(dn);oi.value=(oi.__value=2)==null?"":2;var Mi=p(oi);Mi.value=(Mi.__value=3)==null?"":3;var Ni=p(Mi);Ni.value=(Ni.__value=4)==null?"":4;var Ki=p(Ni);Ki.value=(Ki.__value=5)==null?"":5,f(Qr);var Mr=p(Qr,2);Mr.__change=()=>sr(Ea);var si=m(Mr);si.value=(si.__value="solid")==null?"":"solid";var Ti=p(si);Ti.value=(Ti.__value="dashed")==null?"":"dashed";var ba=p(Ti);ba.value=(ba.__value="dotted")==null?"":"dotted",f(Mr),f(Yi);var rr=p(Yi,2),ar=p(m(rr),2),$n=Qe(()=>qv(Ea));ar.__click=function(...sn){var Cr;(Cr=n($n))==null||Cr.apply(this,sn)};var Us=m(ar);f(ar);var Zi=p(ar,2);Zi.__change=()=>sr(Ea);var bi=m(Zi);bi.value=(bi.__value=1)==null?"":1;var ni=p(bi);ni.value=(ni.__value=2)==null?"":2;var Dn=p(ni);Dn.value=(Dn.__value=3)==null?"":3;var Gr=p(Dn);Gr.value=(Gr.__value=4)==null?"":4;var Ts=p(Gr);Ts.value=(Ts.__value=5)==null?"":5,f(Zi);var la=p(Zi,2);la.__change=()=>sr(Ea);var ji=m(la);ji.value=(ji.__value="solid")==null?"":"solid";var Ln=p(ji);Ln.value=(Ln.__value="dashed")==null?"":"dashed";var Ma=p(Ln);Ma.value=(Ma.__value="dotted")==null?"":"dotted",f(la),f(rr);var Ys=p(rr,2),wn=p(m(Ys),2),vr=Qe(()=>Iv(Ea));wn.__click=function(...sn){var Cr;(Cr=n(vr))==null||Cr.apply(this,sn)};var Tr=m(wn);f(wn);var xi=p(wn,2);xi.__change=()=>sr(Ea);var Sr=m(xi);Sr.value=(Sr.__value=1)==null?"":1;var Ta=p(Sr);Ta.value=(Ta.__value=2)==null?"":2;var Ai=p(Ta);Ai.value=(Ai.__value=3)==null?"":3;var Ri=p(Ai);Ri.value=(Ri.__value=4)==null?"":4;var gr=p(Ri);gr.value=(gr.__value=5)==null?"":5,f(xi);var un=p(xi,2);un.__change=()=>sr(Ea);var ns=m(un);ns.value=(ns.__value="solid")==null?"":"solid";var mn=p(ns);mn.value=(mn.__value="dashed")==null?"":"dashed";var Ar=p(mn);Ar.value=(Ar.__value="dotted")==null?"":"dotted",f(un),f(Ys),f(yi),f(gc),Se(()=>{Nt(aa,"style",`background-color: ${n(er).styles.wr.color??""}`),Nt(Rr,"style",`background-color: ${n(er).styles.overbought.color??""}`),Nt(Us,"style",`background-color: ${n(er).styles.middleLine.color??""}`),Nt(Tr,"style",`background-color: ${n(er).styles.oversold.color??""}`)}),Ho(Hl,()=>n(er).period,sn=>n(er).period=sn),Ho(Ia,()=>n(er).overboughtLevel,sn=>n(er).overboughtLevel=sn),Ho(jr,()=>n(er).middleLevel,sn=>n(er).middleLevel=sn),Ho(ll,()=>n(er).oversoldLevel,sn=>n(er).oversoldLevel=sn),rs(Na,()=>n(er).styles.wr.thickness,sn=>n(er).styles.wr.thickness=sn),rs(ti,()=>n(er).styles.wr.lineStyle,sn=>n(er).styles.wr.lineStyle=sn),rs(Qr,()=>n(er).styles.overbought.thickness,sn=>n(er).styles.overbought.thickness=sn),rs(Mr,()=>n(er).styles.overbought.lineStyle,sn=>n(er).styles.overbought.lineStyle=sn),rs(Zi,()=>n(er).styles.middleLine.thickness,sn=>n(er).styles.middleLine.thickness=sn),rs(la,()=>n(er).styles.middleLine.lineStyle,sn=>n(er).styles.middleLine.lineStyle=sn),rs(xi,()=>n(er).styles.oversold.thickness,sn=>n(er).styles.oversold.thickness=sn),rs(un,()=>n(er).styles.oversold.lineStyle,sn=>n(er).styles.oversold.lineStyle=sn),O(Cc,gc)});var Da=p(cd,2),zc=m(Da);zc.__click=Ie,f(Da),f(Al),O($a,Al)},$a=>{var Al=So(),cd=Rt(Al);Te(cd,()=>n(he),Da=>{var zc=$$(),Cc=m(zc);Vs(Cc,17,()=>n(Ut),_n,(gc,Nr,rl)=>{var tc=F$(),xr=m(tc),al=m(xr);al.textContent=`VR ${rl+1}`;var Hl=p(al,2);Te(Hl,()=>n(Ut).length>1,ns=>{var mn=z$();mn.__click=()=>ec(rl),O(ns,mn)}),f(xr);var wr=p(xr,2),Ia=m(wr),Ll=p(m(Ia),2);Jt(Ll),f(Ia);var jr=p(Ia,2),Ui=p(m(jr),2);Jt(Ui),f(jr);var ll=p(jr,2),Jr=p(m(ll),2);Jt(Jr),f(ll),f(wr);var An=p(wr,2),pl=p(m(An),2),Hn=m(pl),aa=p(m(Hn),2),Na=Qe(()=>vu(rl,"vr"));aa.__click=function(...ns){var mn;(mn=n(Na))==null||mn.apply(this,ns)};var qr=m(aa);f(aa),f(Hn);var On=p(Hn,2),Js=p(m(On),2);Js.__change=()=>Bd(rl);var pr=m(Js);pr.value=(pr.__value=1)==null?"":1;var Ya=p(pr);Ya.value=(Ya.__value=2)==null?"":2;var ti=p(Ya);ti.value=(ti.__value=3)==null?"":3;var ir=p(ti);ir.value=(ir.__value=4)==null?"":4;var Hr=p(ir);Hr.value=(Hr.__value=5)==null?"":5,f(Js),f(On);var Ka=p(On,2),yi=p(m(Ka),2);yi.__change=()=>Bd(rl);var Yi=m(yi);Yi.value=(Yi.__value="solid")==null?"":"solid";var kr=p(Yi);kr.value=(kr.__value="dashed")==null?"":"dashed";var Ei=p(kr);Ei.value=(Ei.__value="dotted")==null?"":"dotted",f(yi),f(Ka),f(pl),f(An);var Rr=p(An,2),Qr=p(m(Rr),2),dn=m(Qr),oi=p(m(dn),2),Mi=Qe(()=>vu(rl,"vrShort"));oi.__click=function(...ns){var mn;(mn=n(Mi))==null||mn.apply(this,ns)};var Ni=m(oi);f(oi),f(dn);var Ki=p(dn,2),Mr=p(m(Ki),2);Mr.__change=()=>Bd(rl);var si=m(Mr);si.value=(si.__value=1)==null?"":1;var Ti=p(si);Ti.value=(Ti.__value=2)==null?"":2;var ba=p(Ti);ba.value=(ba.__value=3)==null?"":3;var rr=p(ba);rr.value=(rr.__value=4)==null?"":4;var ar=p(rr);ar.value=(ar.__value=5)==null?"":5,f(Mr),f(Ki);var $n=p(Ki,2),Us=p(m($n),2);Us.__change=()=>Bd(rl);var Zi=m(Us);Zi.value=(Zi.__value="solid")==null?"":"solid";var bi=p(Zi);bi.value=(bi.__value="dashed")==null?"":"dashed";var ni=p(bi);ni.value=(ni.__value="dotted")==null?"":"dotted",f(Us),f($n),f(Qr),f(Rr);var Dn=p(Rr,2),Gr=p(m(Dn),2),Ts=m(Gr),la=p(m(Ts),2),ji=Qe(()=>vu(rl,"vrLong"));la.__click=function(...ns){var mn;(mn=n(ji))==null||mn.apply(this,ns)};var Ln=m(la);f(la),f(Ts);var Ma=p(Ts,2),Ys=p(m(Ma),2);Ys.__change=()=>Bd(rl);var wn=m(Ys);wn.value=(wn.__value=1)==null?"":1;var vr=p(wn);vr.value=(vr.__value=2)==null?"":2;var Tr=p(vr);Tr.value=(Tr.__value=3)==null?"":3;var xi=p(Tr);xi.value=(xi.__value=4)==null?"":4;var Sr=p(xi);Sr.value=(Sr.__value=5)==null?"":5,f(Ys),f(Ma);var Ta=p(Ma,2),Ai=p(m(Ta),2);Ai.__change=()=>Bd(rl);var Ri=m(Ai);Ri.value=(Ri.__value="solid")==null?"":"solid";var gr=p(Ri);gr.value=(gr.__value="dashed")==null?"":"dashed";var un=p(gr);un.value=(un.__value="dotted")==null?"":"dotted",f(Ai),f(Ta),f(Gr),f(Dn),f(tc),Se(()=>{Nt(qr,"style",`background-color: ${n(Nr).styles.vr.color??""}`),Nt(Ni,"style",`background-color: ${n(Nr).styles.vrShort.color??""}`),Nt(Ln,"style",`background-color: ${n(Nr).styles.vrLong.color??""}`)}),Ho(Ll,()=>n(Nr).period,ns=>n(Nr).period=ns),Ho(Ui,()=>n(Nr).shortPeriod,ns=>n(Nr).shortPeriod=ns),Ho(Jr,()=>n(Nr).longPeriod,ns=>n(Nr).longPeriod=ns),rs(Js,()=>n(Nr).styles.vr.thickness,ns=>n(Nr).styles.vr.thickness=ns),rs(yi,()=>n(Nr).styles.vr.lineStyle,ns=>n(Nr).styles.vr.lineStyle=ns),rs(Mr,()=>n(Nr).styles.vrShort.thickness,ns=>n(Nr).styles.vrShort.thickness=ns),rs(Us,()=>n(Nr).styles.vrShort.lineStyle,ns=>n(Nr).styles.vrShort.lineStyle=ns),rs(Ys,()=>n(Nr).styles.vrLong.thickness,ns=>n(Nr).styles.vrLong.thickness=ns),rs(Ai,()=>n(Nr).styles.vrLong.lineStyle,ns=>n(Nr).styles.vrLong.lineStyle=ns),O(gc,tc)});var er=p(Cc,2),Ea=m(er);Ea.__click=Zc,f(er),f(zc),O(Da,zc)},Da=>{var zc=So(),Cc=Rt(zc);Te(Cc,()=>n(ke),er=>{var Ea=j$(),gc=m(Ea);Vs(gc,17,()=>n(xt),_n,(tc,xr,al)=>{var Hl=N$(),wr=m(Hl),Ia=m(wr);Ia.textContent=`BBI ${al+1}`;var Ll=p(Ia,2);Te(Ll,()=>n(xt).length>1,Mi=>{var Ni=E$();Ni.__click=[D$,ap,xr],O(Mi,Ni)}),f(wr);var jr=p(wr,2),Ui=m(jr),ll=p(m(Ui),2);Jt(ll),ll.__change=()=>sd(al),f(Ui);var Jr=p(Ui,2),An=p(m(Jr),2);Jt(An),An.__change=()=>sd(al),f(Jr);var pl=p(Jr,2),Hn=p(m(pl),2);Jt(Hn),Hn.__change=()=>sd(al),f(pl);var aa=p(pl,2),Na=p(m(aa),2);Jt(Na),Na.__change=()=>sd(al),f(aa),f(jr);var qr=p(jr,2),On=m(qr),Js=p(m(On),2),pr=Qe(()=>uv(al));Js.__click=function(...Mi){var Ni;(Ni=n(pr))==null||Ni.apply(this,Mi)};var Ya=m(Js);f(Js),f(On);var ti=p(On,2),ir=p(m(ti),2);ir.__change=()=>sd(al);var Hr=m(ir);Hr.value=(Hr.__value=1)==null?"":1;var Ka=p(Hr);Ka.value=(Ka.__value=2)==null?"":2;var yi=p(Ka);yi.value=(yi.__value=3)==null?"":3;var Yi=p(yi);Yi.value=(Yi.__value=4)==null?"":4;var kr=p(Yi);kr.value=(kr.__value=5)==null?"":5,f(ir),f(ti);var Ei=p(ti,2),Rr=p(m(Ei),2);Rr.__change=()=>sd(al);var Qr=m(Rr);Qr.value=(Qr.__value="solid")==null?"":"solid";var dn=p(Qr);dn.value=(dn.__value="dashed")==null?"":"dashed";var oi=p(dn);oi.value=(oi.__value="dotted")==null?"":"dotted",f(Rr),f(Ei),f(qr),f(Hl),Se(()=>Nt(Ya,"style",`background-color: ${n(xr).color??""}`)),Ho(ll,()=>n(xr).period1,Mi=>n(xr).period1=Mi),Ho(An,()=>n(xr).period2,Mi=>n(xr).period2=Mi),Ho(Hn,()=>n(xr).period3,Mi=>n(xr).period3=Mi),Ho(Na,()=>n(xr).period4,Mi=>n(xr).period4=Mi),rs(ir,()=>n(xr).thickness,Mi=>n(xr).thickness=Mi),rs(Rr,()=>n(xr).lineStyle,Mi=>n(xr).lineStyle=Mi),O(tc,Hl)});var Nr=p(gc,2),rl=m(Nr);rl.__click=md,f(Nr),f(Ea),O(er,Ea)},er=>{var Ea=So(),gc=Rt(Ea);Te(gc,()=>n(Ul),Nr=>{var rl=V$(),tc=m(rl);Vs(tc,17,()=>n(vi),_n,(Hl,wr)=>{var Ia=O$(),Ll=m(Ia),jr=m(Ll),Ui=m(jr,!0);f(jr);var ll=p(jr,2);Te(ll,()=>n(vi).length>1,dn=>{var oi=B$();oi.__click=[R$,fd,wr],O(dn,oi)}),f(Ll);var Jr=p(Ll,2),An=m(Jr),pl=p(m(An),2);Jt(pl),f(An);var Hn=p(An,2),aa=p(m(Hn),2);Jt(aa),f(Hn),f(Jr);var Na=p(Jr,2),qr=m(Na),On=p(m(qr),2);On.__click=[a$,le,W];var Js=m(On);f(On),f(qr);var pr=p(qr,2),Ya=p(m(pr),2),ti=m(Ya);ti.value=(ti.__value=1)==null?"":1;var ir=p(ti);ir.value=(ir.__value=2)==null?"":2;var Hr=p(ir);Hr.value=(Hr.__value=3)==null?"":3;var Ka=p(Hr);Ka.value=(Ka.__value=4)==null?"":4;var yi=p(Ka);yi.value=(yi.__value=5)==null?"":5,f(Ya),f(pr);var Yi=p(pr,2),kr=p(m(Yi),2),Ei=m(kr);Ei.value=(Ei.__value="solid")==null?"":"solid";var Rr=p(Ei);Rr.value=(Rr.__value="dashed")==null?"":"dashed";var Qr=p(Rr);Qr.value=(Qr.__value="dotted")==null?"":"dotted",f(kr),f(Yi),f(Na),f(Ia),Se(()=>{Ve(Ui,n(wr).name),Nt(Js,"style",`background-color: ${n(wr).color??""}`)}),Ho(pl,()=>n(wr).period,dn=>n(wr).period=dn),Ho(aa,()=>n(wr).period2,dn=>n(wr).period2=dn),rs(Ya,()=>n(wr).thickness,dn=>n(wr).thickness=dn),rs(kr,()=>n(wr).lineStyle,dn=>n(wr).lineStyle=dn),O(Hl,Ia)});var xr=p(tc,2),al=m(xr);al.__click=[JF,Ul,vi],f(xr),f(rl),O(Nr,rl)},Nr=>{var rl=So(),tc=Rt(rl);Te(tc,()=>n(wa),xr=>{var al=G$(),Hl=m(al);Vs(Hl,17,()=>n(ri),_n,(Ll,jr,Ui)=>{var ll=H$(),Jr=m(ll),An=m(Jr),pl=m(An,!0);f(An);var Hn=p(An,2);Te(Hn,()=>n(ri).length>1,Ni=>{var Ki=q$();Ki.__click=[W$,jc,jr],O(Ni,Ki)}),f(Jr);var aa=p(Jr,2),Na=m(aa),qr=p(m(Na),2);Jt(qr),qr.__input=Yl,f(Na),f(aa);var On=p(aa,2),Js=m(On),pr=p(m(Js),2),Ya=Qe(()=>cf(Ui));pr.__click=function(...Ni){var Ki;(Ki=n(Ya))==null||Ki.apply(this,Ni)};var ti=m(pr);f(pr),f(Js);var ir=p(Js,2),Hr=p(m(ir),2);Hr.__change=Yl;var Ka=m(Hr);Ka.value=(Ka.__value=1)==null?"":1;var yi=p(Ka);yi.value=(yi.__value=2)==null?"":2;var Yi=p(yi);Yi.value=(Yi.__value=3)==null?"":3;var kr=p(Yi);kr.value=(kr.__value=4)==null?"":4;var Ei=p(kr);Ei.value=(Ei.__value=5)==null?"":5,f(Hr),f(ir);var Rr=p(ir,2),Qr=p(m(Rr),2);Qr.__change=Yl;var dn=m(Qr);dn.value=(dn.__value="solid")==null?"":"solid";var oi=p(dn);oi.value=(oi.__value="dashed")==null?"":"dashed";var Mi=p(oi);Mi.value=(Mi.__value="dotted")==null?"":"dotted",f(Qr),f(Rr),f(On),f(ll),Se(()=>{Ve(pl,n(jr).name),Nt(ti,"style",`background-color: ${n(jr).color??""}`)}),Ho(qr,()=>n(jr).period,Ni=>n(jr).period=Ni),rs(Hr,()=>n(jr).thickness,Ni=>n(jr).thickness=Ni),rs(Qr,()=>n(jr).lineStyle,Ni=>n(jr).lineStyle=Ni),O(Ll,ll)});var wr=p(Hl,2),Ia=m(wr);Ia.__click=[QF,wa,ri,Yl],f(wr),f(al),O(xr,al)},xr=>{var al=So(),Hl=Rt(al);Te(Hl,()=>n(St),wr=>{var Ia=K$(),Ll=m(Ia);Vs(Ll,17,()=>n(wo),_n,(ll,Jr,An)=>{var pl=Y$(),Hn=m(pl),aa=m(Hn);aa.textContent=An===0?"Awesome Oscillator":`AO ${An+1}`;var Na=p(aa,2);Na.__click=[U$,Dp,Jr],f(Hn);var qr=p(Hn,2),On=m(qr),Js=p(m(On),2);Jt(Js),Js.__input=_p,f(On);var pr=p(On,2),Ya=p(m(pr),2);Jt(Ya),Ya.__input=_p,f(pr),f(qr);var ti=p(qr,2),ir=p(m(ti),2),Hr=m(ir),Ka=p(m(Hr),2),yi=m(Ka),Yi=p(yi,2),kr=Qe(()=>Su(An*2));Yi.__click=function(...Ki){var Mr;(Mr=n(kr))==null||Mr.apply(this,Ki)};var Ei=m(Yi);f(Yi),f(Ka),f(Hr);var Rr=p(Hr,2),Qr=p(m(Rr),2),dn=m(Qr),oi=p(dn,2),Mi=Qe(()=>Su(An*2+1));oi.__click=function(...Ki){var Mr;(Mr=n(Mi))==null||Mr.apply(this,Ki)};var Ni=m(oi);f(oi),f(Qr),f(Rr),f(ir),f(ti),f(pl),Se(()=>{Nt(yi,"style",`background-color: ${n(Jr).styles.increasing.color??""}`),Nt(Ei,"style",`background-color: ${n(Jr).styles.increasing.color??""}`),Nt(dn,"style",`background-color: ${n(Jr).styles.decreasing.color??""}`),Nt(Ni,"style",`background-color: ${n(Jr).styles.decreasing.color??""}`)}),Ho(Js,()=>n(Jr).shortPeriod,Ki=>n(Jr).shortPeriod=Ki),Ho(Ya,()=>n(Jr).longPeriod,Ki=>n(Jr).longPeriod=Ki),O(ll,pl)});var jr=p(Ll,2),Ui=m(jr);Ui.__click=[r$,St,wo,_p],f(jr),f(Ia),O(wr,Ia)},wr=>{var Ia=So(),Ll=Rt(Ia);Te(Ll,()=>n(gi),jr=>{var Ui=Q$(),ll=m(Ui);Vs(ll,17,()=>n(pi),_n,(pl,Hn,aa)=>{var Na=J$(),qr=m(Na),On=m(qr);On.textContent=`CR ${aa+1}`;var Js=p(On,2);Te(Js,()=>n(pi).length>1,Lr=>{var dc=X$();dc.__click=[Z$,_l,Hn],O(Lr,dc)}),f(qr);var pr=p(qr,2),Ya=m(pr),ti=p(m(Ya),2);Jt(ti),ti.__input=qo,f(Ya);var ir=p(Ya,2),Hr=p(m(ir),2);Jt(Hr),Hr.__input=qo,f(ir);var Ka=p(ir,2),yi=p(m(Ka),2);Jt(yi),yi.__input=qo,f(Ka);var Yi=p(Ka,2),kr=p(m(Yi),2);Jt(kr),kr.__input=qo,f(Yi);var Ei=p(Yi,2),Rr=p(m(Ei),2);Jt(Rr),Rr.__input=qo,f(Ei),f(pr);var Qr=p(pr,2),dn=m(Qr),oi=p(m(dn),2),Mi=Qe(()=>Er(aa,"cr"));oi.__click=function(...Lr){var dc;(dc=n(Mi))==null||dc.apply(this,Lr)};var Ni=m(oi);f(oi);var Ki=p(oi,2);Ki.__change=qo;var Mr=m(Ki);Mr.value=(Mr.__value=1)==null?"":1;var si=p(Mr);si.value=(si.__value=2)==null?"":2;var Ti=p(si);Ti.value=(Ti.__value=3)==null?"":3;var ba=p(Ti);ba.value=(ba.__value=4)==null?"":4;var rr=p(ba);rr.value=(rr.__value=5)==null?"":5,f(Ki);var ar=p(Ki,2);ar.__change=qo;var $n=m(ar);$n.value=($n.__value="solid")==null?"":"solid";var Us=p($n);Us.value=(Us.__value="dashed")==null?"":"dashed";var Zi=p(Us);Zi.value=(Zi.__value="dotted")==null?"":"dotted",f(ar),f(dn);var bi=p(dn,2),ni=p(m(bi),2),Dn=Qe(()=>Er(aa,"ma1"));ni.__click=function(...Lr){var dc;(dc=n(Dn))==null||dc.apply(this,Lr)};var Gr=m(ni);f(ni);var Ts=p(ni,2);Ts.__change=qo;var la=m(Ts);la.value=(la.__value=1)==null?"":1;var ji=p(la);ji.value=(ji.__value=2)==null?"":2;var Ln=p(ji);Ln.value=(Ln.__value=3)==null?"":3;var Ma=p(Ln);Ma.value=(Ma.__value=4)==null?"":4;var Ys=p(Ma);Ys.value=(Ys.__value=5)==null?"":5,f(Ts);var wn=p(Ts,2);wn.__change=qo;var vr=m(wn);vr.value=(vr.__value="solid")==null?"":"solid";var Tr=p(vr);Tr.value=(Tr.__value="dashed")==null?"":"dashed";var xi=p(Tr);xi.value=(xi.__value="dotted")==null?"":"dotted",f(wn),f(bi);var Sr=p(bi,2),Ta=p(m(Sr),2),Ai=Qe(()=>Er(aa,"ma2"));Ta.__click=function(...Lr){var dc;(dc=n(Ai))==null||dc.apply(this,Lr)};var Ri=m(Ta);f(Ta);var gr=p(Ta,2);gr.__change=qo;var un=m(gr);un.value=(un.__value=1)==null?"":1;var ns=p(un);ns.value=(ns.__value=2)==null?"":2;var mn=p(ns);mn.value=(mn.__value=3)==null?"":3;var Ar=p(mn);Ar.value=(Ar.__value=4)==null?"":4;var sn=p(Ar);sn.value=(sn.__value=5)==null?"":5,f(gr);var Cr=p(gr,2);Cr.__change=qo;var Xn=m(Cr);Xn.value=(Xn.__value="solid")==null?"":"solid";var ea=p(Xn);ea.value=(ea.__value="dashed")==null?"":"dashed";var zl=p(ea);zl.value=(zl.__value="dotted")==null?"":"dotted",f(Cr),f(Sr);var Va=p(Sr,2),Za=p(m(Va),2),vl=Qe(()=>Er(aa,"ma3"));Za.__click=function(...Lr){var dc;(dc=n(vl))==null||dc.apply(this,Lr)};var oc=m(Za);f(Za);var Gl=p(Za,2);Gl.__change=qo;var Xl=m(Gl);Xl.value=(Xl.__value=1)==null?"":1;var Vl=p(Xl);Vl.value=(Vl.__value=2)==null?"":2;var El=p(Vl);El.value=(El.__value=3)==null?"":3;var ca=p(El);ca.value=(ca.__value=4)==null?"":4;var hc=p(ca);hc.value=(hc.__value=5)==null?"":5,f(Gl);var dd=p(Gl,2);dd.__change=qo;var Id=m(dd);Id.value=(Id.__value="solid")==null?"":"solid";var sc=p(Id);sc.value=(sc.__value="dashed")==null?"":"dashed";var zd=p(sc);zd.value=(zd.__value="dotted")==null?"":"dotted",f(dd),f(Va);var Fd=p(Va,2),Pc=p(m(Fd),2),Pr=Qe(()=>Er(aa,"ma4"));Pc.__click=function(...Lr){var dc;(dc=n(Pr))==null||dc.apply(this,Lr)};var Zd=m(Pc);f(Pc);var Ic=p(Pc,2);Ic.__change=qo;var tu=m(Ic);tu.value=(tu.__value=1)==null?"":1;var $d=p(tu);$d.value=($d.__value=2)==null?"":2;var el=p($d);el.value=(el.__value=3)==null?"":3;var ou=p(el);ou.value=(ou.__value=4)==null?"":4;var wd=p(ou);wd.value=(wd.__value=5)==null?"":5,f(Ic);var gd=p(Ic,2);gd.__change=qo;var Fc=m(gd);Fc.value=(Fc.__value="solid")==null?"":"solid";var ud=p(Fc);ud.value=(ud.__value="dashed")==null?"":"dashed";var su=p(ud);su.value=(su.__value="dotted")==null?"":"dotted",f(gd),f(Fd),f(Qr),f(Na),Se(()=>{Nt(Ni,"style",`background-color: ${n(Hn).styles.cr.color??""}`),Nt(Gr,"style",`background-color: ${n(Hn).styles.ma1.color??""}`),Nt(Ri,"style",`background-color: ${n(Hn).styles.ma2.color??""}`),Nt(oc,"style",`background-color: ${n(Hn).styles.ma3.color??""}`),Nt(Zd,"style",`background-color: ${n(Hn).styles.ma4.color??""}`)}),Ho(ti,()=>n(Hn).crPeriod,Lr=>n(Hn).crPeriod=Lr),Ho(Hr,()=>n(Hn).crMa1Period,Lr=>n(Hn).crMa1Period=Lr),Ho(yi,()=>n(Hn).crMa2Period,Lr=>n(Hn).crMa2Period=Lr),Ho(kr,()=>n(Hn).crMa3Period,Lr=>n(Hn).crMa3Period=Lr),Ho(Rr,()=>n(Hn).crMa4Period,Lr=>n(Hn).crMa4Period=Lr),rs(Ki,()=>n(Hn).styles.cr.thickness,Lr=>n(Hn).styles.cr.thickness=Lr),rs(ar,()=>n(Hn).styles.cr.lineStyle,Lr=>n(Hn).styles.cr.lineStyle=Lr),rs(Ts,()=>n(Hn).styles.ma1.thickness,Lr=>n(Hn).styles.ma1.thickness=Lr),rs(wn,()=>n(Hn).styles.ma1.lineStyle,Lr=>n(Hn).styles.ma1.lineStyle=Lr),rs(gr,()=>n(Hn).styles.ma2.thickness,Lr=>n(Hn).styles.ma2.thickness=Lr),rs(Cr,()=>n(Hn).styles.ma2.lineStyle,Lr=>n(Hn).styles.ma2.lineStyle=Lr),rs(Gl,()=>n(Hn).styles.ma3.thickness,Lr=>n(Hn).styles.ma3.thickness=Lr),rs(dd,()=>n(Hn).styles.ma3.lineStyle,Lr=>n(Hn).styles.ma3.lineStyle=Lr),rs(Ic,()=>n(Hn).styles.ma4.thickness,Lr=>n(Hn).styles.ma4.thickness=Lr),rs(gd,()=>n(Hn).styles.ma4.lineStyle,Lr=>n(Hn).styles.ma4.lineStyle=Lr),O(pl,Na)});var Jr=p(ll,2),An=m(Jr);An.__click=[i$,gi,pi,qo],f(Jr),f(Ui),O(jr,Ui)},jr=>{var Ui=So(),ll=Rt(Ui);Te(ll,()=>n(Un),Jr=>{var An=tD(),pl=m(An);Vs(pl,17,()=>n(ts),_n,(Na,qr,On)=>{var Js=eD(),pr=m(Js),Ya=m(pr);Ya.textContent=`ZigZag ${On+1}`,f(pr);var ti=p(pr,2),ir=m(ti),Hr=p(m(ir),2);Jt(Hr),Hr.__input=Cs,f(ir);var Ka=p(ir,2),yi=p(m(Ka),2);Jt(yi),yi.__input=Cs,f(Ka),f(ti);var Yi=p(ti,2),kr=p(m(Yi),2),Ei=m(kr),Rr=p(m(Ei),2),Qr=m(Rr),dn=p(Qr,2);dn.__click=()=>Cn(On);var oi=m(dn);f(dn),f(Rr),f(Ei);var Mi=p(Ei,2),Ni=p(m(Mi),2);Ni.__change=Cs;var Ki=m(Ni);Ki.value=(Ki.__value=1)==null?"":1;var Mr=p(Ki);Mr.value=(Mr.__value=2)==null?"":2;var si=p(Mr);si.value=(si.__value=3)==null?"":3;var Ti=p(si);Ti.value=(Ti.__value=4)==null?"":4;var ba=p(Ti);ba.value=(ba.__value=5)==null?"":5,f(Ni),f(Mi);var rr=p(Mi,2),ar=p(m(rr),2);ar.__change=Cs;var $n=m(ar);$n.value=($n.__value="solid")==null?"":"solid";var Us=p($n);Us.value=(Us.__value="dashed")==null?"":"dashed";var Zi=p(Us);Zi.value=(Zi.__value="dotted")==null?"":"dotted",f(ar),f(rr),f(kr),f(Yi),f(Js),Se(()=>{Nt(Qr,"style",`background-color: ${n(qr).styles.color??""}`),Nt(oi,"style",`background-color: ${n(qr).styles.color??""}`)}),Ho(Hr,()=>n(qr).deviation,bi=>n(qr).deviation=bi),Ho(yi,()=>n(qr).depth,bi=>n(qr).depth=bi),rs(Ni,()=>n(qr).styles.thickness,bi=>n(qr).styles.thickness=bi),rs(ar,()=>n(qr).styles.lineStyle,bi=>n(qr).styles.lineStyle=bi),O(Na,Js)});var Hn=p(pl,2),aa=m(Hn);aa.__click=[YF,ts,Cs],f(Hn),f(An),O(Jr,An)},Jr=>{var An=So(),pl=Rt(An);Te(pl,()=>n(fo),Hn=>{var aa=nD(),Na=m(aa);Vs(Na,17,()=>n($i),_n,(Js,pr,Ya)=>{var ti=sD(),ir=m(ti),Hr=m(ir),Ka=m(Hr);Se(()=>Ve(Ka,`${n(pr).name??""} (ID: ${n(pr).id.slice(0,8)??""})`)),f(Hr);var yi=p(Hr,2);Te(yi,()=>n($i).length>1,Us=>{var Zi=oD();Zi.__click=()=>$l(Ya),O(Us,Zi)}),f(ir);var Yi=p(ir,2),kr=m(Yi),Ei=p(m(kr),2),Rr=Qe(()=>uf(Ya));Ei.__click=function(...Us){var Zi;(Zi=n(Rr))==null||Zi.apply(this,Us)};var Qr=m(Ei);f(Ei),f(kr);var dn=p(kr,2),oi=p(m(dn),2);oi.__change=Us=>{Us.target&&(n(pr).thickness=parseInt(Us.target.value),Ps(Ya))};var Mi=m(oi);Mi.value=(Mi.__value=1)==null?"":1;var Ni=p(Mi);Ni.value=(Ni.__value=2)==null?"":2;var Ki=p(Ni);Ki.value=(Ki.__value=3)==null?"":3;var Mr=p(Ki);Mr.value=(Mr.__value=4)==null?"":4;var si=p(Mr);si.value=(si.__value=5)==null?"":5,f(oi),f(dn);var Ti=p(dn,2),ba=p(m(Ti),2);ba.__change=Us=>{Us.target&&(n(pr).lineStyle=Us.target.value,Ps(Ya))};var rr=m(ba);rr.value=(rr.__value="solid")==null?"":"solid";var ar=p(rr);ar.value=(ar.__value="dashed")==null?"":"dashed";var $n=p(ar);$n.value=($n.__value="dotted")==null?"":"dotted",f(ba),f(Ti),f(Yi),f(ti),Se(()=>Nt(Qr,"style",`background-color: ${n(pr).color??""}`)),rs(oi,()=>n(pr).thickness,Us=>n(pr).thickness=Us),rs(ba,()=>n(pr).lineStyle,Us=>n(pr).lineStyle=Us),O(Js,ti)});var qr=p(Na,2),On=m(qr);On.__click=vd,f(qr),f(aa),O(Hn,aa)},Hn=>{var aa=So(),Na=Rt(aa);Te(Na,()=>n(Go),qr=>{var On=lD(),Js=m(On);Vs(Js,17,()=>n(Rn),_n,(ti,ir,Hr)=>{var Ka=aD(),yi=m(Ka),Yi=m(yi);Yi.textContent=`SAR ${Hr+1}`;var kr=p(Yi,2);Te(kr,()=>n(Rn).length>1,Dn=>{var Gr=rD();Gr.__click=[iD,cc,ir],O(Dn,Gr)}),f(yi);var Ei=p(yi,2),Rr=m(Ei),Qr=p(m(Rr),2);Jt(Qr),f(Rr);var dn=p(Rr,2),oi=p(m(dn),2);Jt(oi),f(dn);var Mi=p(dn,2),Ni=p(m(Mi),2);Jt(Ni),f(Mi),f(Ei);var Ki=p(Ei,2),Mr=m(Ki),si=p(m(Mr),2),Ti=Qe(()=>Mv(Hr));si.__click=function(...Dn){var Gr;(Gr=n(Ti))==null||Gr.apply(this,Dn)};var ba=m(si);f(si),f(Mr);var rr=p(Mr,2),ar=p(m(rr),2),$n=m(ar);$n.value=($n.__value=1)==null?"":1;var Us=p($n);Us.value=(Us.__value=2)==null?"":2;var Zi=p(Us);Zi.value=(Zi.__value=3)==null?"":3;var bi=p(Zi);bi.value=(bi.__value=4)==null?"":4;var ni=p(bi);ni.value=(ni.__value=5)==null?"":5,f(ar),f(rr),f(Ki),f(Ka),Se(()=>Nt(ba,"style",`background-color: ${n(ir).color??""}`)),Ho(Qr,()=>n(ir).start,Dn=>n(ir).start=Dn),Ho(oi,()=>n(ir).increment,Dn=>n(ir).increment=Dn),Ho(Ni,()=>n(ir).maxValue,Dn=>n(ir).maxValue=Dn),rs(ar,()=>n(ir).dotSize,Dn=>n(ir).dotSize=Dn),O(ti,Ka)});var pr=p(Js,2),Ya=m(pr);Ya.__click=[o$,Go,Rn,Xr],f(pr),f(On),O(qr,On)},qr=>{var On=So(),Js=Rt(On);Te(Js,()=>n(dl),pr=>{var Ya=pD(),ti=m(Ya);Vs(ti,17,()=>n(Os),_n,(Ka,yi,Yi)=>{var kr=uD(),Ei=m(kr),Rr=m(Ei);Rr.textContent=`Smart Trend ${Yi+1}`;var Qr=p(Rr,2);Te(Qr,()=>n(Os).length>1,Xn=>{var ea=dD();ea.__click=[cD,Gi,yi],O(Xn,ea)}),f(Ei);var dn=p(Ei,2),oi=m(dn),Mi=p(m(oi),2);Jt(Mi),Mi.__change=()=>jn(Yi),f(oi);var Ni=p(oi,2),Ki=p(m(Ni),2);Jt(Ki),Ki.__change=()=>jn(Yi),f(Ni),f(dn);var Mr=p(dn,2),si=m(Mr);Jt(si),si.__change=()=>jn(Yi),pn(2),f(Mr);var Ti=p(Mr,2),ba=p(m(Ti),2),rr=m(ba),ar=p(m(rr),2);ar.__click=()=>{x(Jl,!0),x(sl,D(Yi)),x(Uc,"uptrend")};var $n=m(ar);f(ar),f(rr);var Us=p(rr,2),Zi=p(m(Us),2);Zi.__change=()=>jn(Yi);var bi=m(Zi);bi.value=(bi.__value=1)==null?"":1;var ni=p(bi);ni.value=(ni.__value=2)==null?"":2;var Dn=p(ni);Dn.value=(Dn.__value=3)==null?"":3;var Gr=p(Dn);Gr.value=(Gr.__value=4)==null?"":4;var Ts=p(Gr);Ts.value=(Ts.__value=5)==null?"":5,f(Zi),f(Us);var la=p(Us,2),ji=p(m(la),2);ji.__change=()=>jn(Yi);var Ln=m(ji);Ln.value=(Ln.__value="solid")==null?"":"solid";var Ma=p(Ln);Ma.value=(Ma.__value="dashed")==null?"":"dashed",f(ji),f(la),f(ba),f(Ti);var Ys=p(Ti,2),wn=p(m(Ys),2),vr=m(wn),Tr=p(m(vr),2);Tr.__click=()=>{x(Jl,!0),x(sl,D(Yi)),x(Uc,"downtrend")};var xi=m(Tr);f(Tr),f(vr);var Sr=p(vr,2),Ta=p(m(Sr),2);Ta.__change=()=>jn(Yi);var Ai=m(Ta);Ai.value=(Ai.__value=1)==null?"":1;var Ri=p(Ai);Ri.value=(Ri.__value=2)==null?"":2;var gr=p(Ri);gr.value=(gr.__value=3)==null?"":3;var un=p(gr);un.value=(un.__value=4)==null?"":4;var ns=p(un);ns.value=(ns.__value=5)==null?"":5,f(Ta),f(Sr);var mn=p(Sr,2),Ar=p(m(mn),2);Ar.__change=()=>jn(Yi);var sn=m(Ar);sn.value=(sn.__value="solid")==null?"":"solid";var Cr=p(sn);Cr.value=(Cr.__value="dashed")==null?"":"dashed",f(Ar),f(mn),f(wn),f(Ys),f(kr),Se(()=>{Nt($n,"style",`background-color: ${n(yi).styles.uptrend.color??""}`),Nt(xi,"style",`background-color: ${n(yi).styles.downtrend.color??""}`)}),Ho(Mi,()=>n(yi).period,Xn=>n(yi).period=Xn),Ho(Ki,()=>n(yi).multiplier,Xn=>n(yi).multiplier=Xn),_v(si,()=>n(yi).showLabels,Xn=>n(yi).showLabels=Xn),rs(Zi,()=>n(yi).styles.uptrend.thickness,Xn=>n(yi).styles.uptrend.thickness=Xn),rs(ji,()=>n(yi).styles.uptrend.lineStyle,Xn=>n(yi).styles.uptrend.lineStyle=Xn),rs(Ta,()=>n(yi).styles.downtrend.thickness,Xn=>n(yi).styles.downtrend.thickness=Xn),rs(Ar,()=>n(yi).styles.downtrend.lineStyle,Xn=>n(yi).styles.downtrend.lineStyle=Xn),O(Ka,kr)});var ir=p(ti,2),Hr=m(ir);Hr.__click=[s$,dl,Os,Ga],f(ir),f(Ya),O(pr,Ya)},pr=>{var Ya=So(),ti=Rt(Ya);Te(ti,()=>n(Ne),ir=>{var Hr=xD(),Ka=m(Hr);Vs(Ka,17,()=>g,_n,(Yi,kr,Ei)=>{var Rr=yD(),Qr=m(Rr),dn=m(Qr),oi=m(dn,!0);f(dn);var Mi=p(dn,2),Ni=m(Mi);Jt(Ni),Ni.__change=[vD,Ca];var Ki=p(Ni,2);Te(Ki,()=>v.length>1,si=>{var Ti=fD();Ti.__click=()=>Yp(Ei),O(si,Ti)},si=>{var Ti=mD();O(si,Ti)}),f(Mi),f(Qr);var Mr=p(Qr,2);Te(Mr,()=>_[Ei],si=>{var Ti=_D(),ba=m(Ti),rr=p(m(ba),2),ar=Qe(()=>Hv(Ei));rr.__click=function(...wn){var vr;(vr=n(ar))==null||vr.apply(this,wn)};var $n=m(rr);f(rr),f(ba);var Us=p(ba,2),Zi=p(m(Us),2);Zi.__change=[gD,Ca];var bi=m(Zi);bi.value=(bi.__value=1)==null?"":1;var ni=p(bi);ni.value=(ni.__value=2)==null?"":2;var Dn=p(ni);Dn.value=(Dn.__value=3)==null?"":3;var Gr=p(Dn);Gr.value=(Gr.__value=4)==null?"":4;var Ts=p(Gr);Ts.value=(Ts.__value=5)==null?"":5,f(Zi),f(Us);var la=p(Us,2),ji=p(m(la),2);ji.__change=[hD,Ca];var Ln=m(ji);Ln.value=(Ln.__value="solid")==null?"":"solid";var Ma=p(Ln);Ma.value=(Ma.__value="dashed")==null?"":"dashed";var Ys=p(Ma);Ys.value=(Ys.__value="dotted")==null?"":"dotted",f(ji),f(la),f(Ti),Se(()=>Nt($n,"style",`background-color: ${_[Ei].color??""}`)),rs(Zi,()=>_[Ei].thickness,wn=>_[Ei].thickness=wn),rs(ji,()=>_[Ei].lineStyle,wn=>_[Ei].lineStyle=wn),O(si,Ti)}),f(Rr),Se(()=>Ve(oi,n(kr).title)),Ho(Ni,()=>v[Ei],si=>v[Ei]=si),O(Yi,Rr)});var yi=p(Ka,2);Te(yi,()=>g.length<10,Yi=>{var kr=bD(),Ei=m(kr);Ei.__click=[Qg,Me,yt,Kp,St,pv,lo,Rp,Wo,Av,g,v,_,Ct,Ad,Ne,Ca],f(kr),O(Yi,kr)}),f(Hr),O(ir,Hr)},ir=>{var Hr=So(),Ka=Rt(Hr);Te(Ka,()=>n(ie),yi=>{var Yi=SD(),kr=m(Yi);Vs(kr,17,()=>n(ls),_n,(Qr,dn,oi)=>{var Mi=kD(),Ni=m(Mi),Ki=m(Ni),Mr=m(Ki);f(Ki);var si=p(Ki,2);Te(si,()=>n(ls).length>1,vr=>{var Tr=wD();Tr.__click=()=>Ud(oi),O(vr,Tr)}),f(Ni);var Ti=p(Ni,2),ba=p(m(Ti),2);Jt(ba),ba.__change=()=>ru(oi),f(Ti);var rr=p(Ti,2),ar=m(rr),$n=p(m(ar),2);$n.__click=vr=>{x(It,D(oi));const Tr=vr.currentTarget.getBoundingClientRect();x(ao,D({x:Tr.left+Tr.width/2,y:Tr.bottom+5})),x(ht,!0)};var Us=m($n);f($n),f(ar);var Zi=p(ar,2),bi=p(m(Zi),2);bi.__change=()=>ru(oi);var ni=m(bi);ni.value=(ni.__value=1)==null?"":1;var Dn=p(ni);Dn.value=(Dn.__value=2)==null?"":2;var Gr=p(Dn);Gr.value=(Gr.__value=3)==null?"":3;var Ts=p(Gr);Ts.value=(Ts.__value=4)==null?"":4;var la=p(Ts);la.value=(la.__value=5)==null?"":5,f(bi),f(Zi);var ji=p(Zi,2),Ln=p(m(ji),2);Ln.__change=()=>ru(oi);var Ma=m(Ln);Ma.value=(Ma.__value="solid")==null?"":"solid";var Ys=p(Ma);Ys.value=(Ys.__value="dashed")==null?"":"dashed";var wn=p(Ys);wn.value=(wn.__value="dotted")==null?"":"dotted",f(Ln),f(ji),f(rr),f(Mi),Se(()=>{Ve(Mr,`SMA (${n(dn).period??""})`),Nt(Us,"style",`background-color: ${n(dn).color??""}`)}),Ho(ba,()=>n(dn).period,vr=>n(dn).period=vr),rs(bi,()=>n(dn).thickness,vr=>n(dn).thickness=vr),rs(Ln,()=>n(dn).lineStyle,vr=>n(dn).lineStyle=vr),O(Qr,Mi)});var Ei=p(kr,2),Rr=m(Ei);Rr.__click=Zr,f(Ei),f(Yi),O(yi,Yi)},yi=>{var Yi=So(),kr=Rt(Yi);Te(kr,()=>n(mo),Ei=>{var Rr=MD();Vs(Rr,21,()=>n(Ze),_n,(Qr,dn,oi)=>{var Mi=ID(),Ni=m(Mi),Ki=m(Ni);Ki.textContent=`Volume ${oi+1}`;var Mr=p(Ki,2);Te(Mr,()=>n(Ze).length>1,Xn=>{var ea=CD();ea.__click=()=>Ku(oi),O(Xn,ea)},Xn=>{var ea=PD();O(Xn,ea)}),f(Ni);var si=p(Ni,2),Ti=m(si),ba=p(m(Ti),2);Jt(ba),ba.__change=()=>Od(oi),f(Ti),f(si);var rr=p(si,2),ar=p(m(rr),2),$n=m(ar),Us=p(m($n),2),Zi=Qe(()=>Pv(oi,"histogram"));Us.__click=function(...Xn){var ea;(ea=n(Zi))==null||ea.apply(this,Xn)};var bi=m(Us);f(Us),f($n);var ni=p($n,2),Dn=p(m(ni),2),Gr=Qe(()=>Pv(oi,"histogram-down"));Dn.__click=function(...Xn){var ea;(ea=n(Gr))==null||ea.apply(this,Xn)};var Ts=m(Dn);f(Dn),f(ni),f(ar),f(rr);var la=p(rr,2),ji=p(m(la),2),Ln=m(ji);Jt(Ln),Ln.__change=()=>Od(oi),pn(2),f(ji);var Ma=p(ji,2),Ys=m(Ma),wn=p(m(Ys),2),vr=Qe(()=>Pv(oi,"ema"));wn.__click=function(...Xn){var ea;(ea=n(vr))==null||ea.apply(this,Xn)};var Tr=m(wn);f(wn),f(Ys);var xi=p(Ys,2),Sr=p(m(xi),2);Sr.__change=()=>Od(oi);var Ta=m(Sr);Ta.value=(Ta.__value=1)==null?"":1;var Ai=p(Ta);Ai.value=(Ai.__value=2)==null?"":2;var Ri=p(Ai);Ri.value=(Ri.__value=3)==null?"":3;var gr=p(Ri);gr.value=(gr.__value=4)==null?"":4;var un=p(gr);un.value=(un.__value=5)==null?"":5,f(Sr),f(xi);var ns=p(xi,2),mn=p(m(ns),2);mn.__change=()=>Od(oi);var Ar=m(mn);Ar.value=(Ar.__value="solid")==null?"":"solid";var sn=p(Ar);sn.value=(sn.__value="dashed")==null?"":"dashed";var Cr=p(sn);Cr.value=(Cr.__value="dotted")==null?"":"dotted",f(mn),f(ns),f(Ma),f(la),f(Mi),Se(()=>{Nt(bi,"style",`background-color: ${n(dn).styles.histogram.upColor??""}`),Nt(Ts,"style",`background-color: ${n(dn).styles.histogram.downColor??""}`),Nt(Tr,"style",`background-color: ${n(dn).styles.ema.color??""}`)}),Ho(ba,()=>n(dn).period,Xn=>n(dn).period=Xn),_v(Ln,()=>n(dn).styles.ema.visible,Xn=>n(dn).styles.ema.visible=Xn),rs(Sr,()=>n(dn).styles.ema.thickness,Xn=>n(dn).styles.ema.thickness=Xn),rs(mn,()=>n(dn).styles.ema.lineStyle,Xn=>n(dn).styles.ema.lineStyle=Xn),O(Qr,Mi)}),f(Rr),O(Ei,Rr)},Ei=>{var Rr=So(),Qr=Rt(Rr);Te(Qr,()=>n(Wo),dn=>{var oi=zD(),Mi=m(oi);Vs(Mi,17,()=>n(Oi),_n,(Mr,si,Ti)=>{var ba=AD(),rr=m(ba),ar=m(rr),$n=m(ar,!0);f(ar);var Us=p(ar,2);Te(Us,()=>n(Oi).length>1,sc=>{var zd=TD();zd.__click=()=>Pi(Ti),O(sc,zd)}),f(rr);var Zi=p(rr,2),bi=m(Zi),ni=p(m(bi),2);Jt(ni),ni.__input=()=>hi(Ti),f(bi);var Dn=p(bi,2),Gr=p(m(Dn),2);Jt(Gr),Gr.__input=()=>hi(Ti),f(Dn),f(Zi);var Ts=p(Zi,2),la=m(Ts),ji=p(m(la),2);f(la);var Ln=p(la,2),Ma=m(Ln),Ys=p(m(Ma),2);Jt(Ys),Ys.__input=()=>hi(Ti),f(Ma);var wn=p(Ma,2),vr=p(m(wn),2);vr.__change=()=>hi(Ti);var Tr=m(vr);Tr.value=(Tr.__value=1)==null?"":1;var xi=p(Tr);xi.value=(xi.__value=2)==null?"":2;var Sr=p(xi);Sr.value=(Sr.__value=3)==null?"":3;var Ta=p(Sr);Ta.value=(Ta.__value=4)==null?"":4;var Ai=p(Ta);Ai.value=(Ai.__value=5)==null?"":5,f(vr),f(wn);var Ri=p(wn,2),gr=p(m(Ri),2);gr.__change=()=>hi(Ti);var un=m(gr);un.value=(un.__value="solid")==null?"":"solid";var ns=p(un);ns.value=(ns.__value="dashed")==null?"":"dashed";var mn=p(ns);mn.value=(mn.__value="dotted")==null?"":"dotted",f(gr),f(Ri),f(Ln),f(Ts);var Ar=p(Ts,2),sn=m(Ar),Cr=p(m(sn),2);f(sn);var Xn=p(sn,2),ea=m(Xn),zl=p(m(ea),2);Jt(zl),zl.__input=()=>hi(Ti),f(ea);var Va=p(ea,2),Za=p(m(Va),2);Za.__change=()=>hi(Ti);var vl=m(Za);vl.value=(vl.__value=1)==null?"":1;var oc=p(vl);oc.value=(oc.__value=2)==null?"":2;var Gl=p(oc);Gl.value=(Gl.__value=3)==null?"":3;var Xl=p(Gl);Xl.value=(Xl.__value=4)==null?"":4;var Vl=p(Xl);Vl.value=(Vl.__value=5)==null?"":5,f(Za),f(Va);var El=p(Va,2),ca=p(m(El),2);ca.__change=()=>hi(Ti);var hc=m(ca);hc.value=(hc.__value="solid")==null?"":"solid";var dd=p(hc);dd.value=(dd.__value="dashed")==null?"":"dashed";var Id=p(dd);Id.value=(Id.__value="dotted")==null?"":"dotted",f(ca),f(El),f(Xn),f(Ar),f(ba),Se(()=>{Ve($n,n(si).name),Nt(ji,"style",`background-color: ${n(si).styles.trix.color??""}`),Nt(Cr,"style",`background-color: ${n(si).styles.signal.color??""}`)}),Ho(ni,()=>n(si).trixPeriod,sc=>n(si).trixPeriod=sc),Ho(Gr,()=>n(si).signalPeriod,sc=>n(si).signalPeriod=sc),Ho(Ys,()=>n(si).styles.trix.color,sc=>n(si).styles.trix.color=sc),rs(vr,()=>n(si).styles.trix.thickness,sc=>n(si).styles.trix.thickness=sc),rs(gr,()=>n(si).styles.trix.lineStyle,sc=>n(si).styles.trix.lineStyle=sc),Ho(zl,()=>n(si).styles.signal.color,sc=>n(si).styles.signal.color=sc),rs(Za,()=>n(si).styles.signal.thickness,sc=>n(si).styles.signal.thickness=sc),rs(ca,()=>n(si).styles.signal.lineStyle,sc=>n(si).styles.signal.lineStyle=sc),O(Mr,ba)});var Ni=p(Mi,2),Ki=m(Ni);Ki.__click=[LD,on],f(Ni),f(oi),O(dn,oi)},dn=>{var oi=So(),Mi=Rt(oi);Te(Mi,()=>n(yt),Ni=>{var Ki=ED(),Mr=m(Ki);Vs(Mr,17,()=>n(jo),_n,(ba,rr,ar)=>{var $n=DD(),Us=m($n),Zi=m(Us);Zi.textContent=`BIAS ${ar+1}`;var bi=p(Zi,2);Te(bi,()=>n(jo).length>1,un=>{var ns=$D();ns.__click=[FD,Or,rr],O(un,ns)}),f(Us);var ni=p(Us,2),Dn=p(m(ni),2);Jt(Dn),Dn.__input=ur,f(ni);var Gr=p(ni,2),Ts=m(Gr),la=p(m(Ts),2),ji=Qe(()=>cp(ar));la.__click=function(...un){var ns;(ns=n(ji))==null||ns.apply(this,un)};var Ln=m(la);f(la),f(Ts);var Ma=p(Ts,2),Ys=p(m(Ma),2);Ys.__change=ur;var wn=m(Ys);wn.value=(wn.__value=1)==null?"":1;var vr=p(wn);vr.value=(vr.__value=2)==null?"":2;var Tr=p(vr);Tr.value=(Tr.__value=3)==null?"":3;var xi=p(Tr);xi.value=(xi.__value=4)==null?"":4,f(Ys),f(Ma);var Sr=p(Ma,2),Ta=p(m(Sr),2);Ta.__change=ur;var Ai=m(Ta);Ai.value=(Ai.__value="solid")==null?"":"solid";var Ri=p(Ai);Ri.value=(Ri.__value="dashed")==null?"":"dashed";var gr=p(Ri);gr.value=(gr.__value="dotted")==null?"":"dotted",f(Ta),f(Sr),f(Gr),f($n),Se(()=>Nt(Ln,"style",`background-color: ${n(rr).color??""}`)),Ho(Dn,()=>n(rr).period,un=>n(rr).period=un),rs(Ys,()=>n(rr).thickness,un=>n(rr).thickness=un),rs(Ta,()=>n(rr).lineStyle,un=>n(rr).lineStyle=un),O(ba,$n)});var si=p(Mr,2),Ti=m(si);Ti.__click=[e$,yt,jo,ur],f(si),f(Ki),O(Ni,Ki)},Ni=>{var Ki=So(),Mr=Rt(Ki);Te(Mr,()=>n(Kr),si=>{var Ti=BD(),ba=m(Ti);Vs(ba,17,()=>n(Ci),_n,($n,Us,Zi)=>{var bi=RD(),ni=m(bi),Dn=m(ni);Dn.textContent=`CCI ${Zi+1}`;var Gr=p(Dn,2);Te(Gr,()=>n(Ci).length>1,Ar=>{var sn=jD();sn.__click=[ND,Zo,Us],O(Ar,sn)}),f(ni);var Ts=p(ni,2),la=p(m(Ts),2);Jt(la),la.__input=zs,f(Ts);var ji=p(Ts,2),Ln=m(ji),Ma=p(m(Ln),2),Ys=Qe(()=>lp(Zi));Ma.__click=function(...Ar){var sn;(sn=n(Ys))==null||sn.apply(this,Ar)};var wn=m(Ma);f(Ma),f(Ln);var vr=p(Ln,2),Tr=p(m(vr),2);Tr.__change=zs;var xi=m(Tr);xi.value=(xi.__value=1)==null?"":1;var Sr=p(xi);Sr.value=(Sr.__value=2)==null?"":2;var Ta=p(Sr);Ta.value=(Ta.__value=3)==null?"":3;var Ai=p(Ta);Ai.value=(Ai.__value=4)==null?"":4,f(Tr),f(vr);var Ri=p(vr,2),gr=p(m(Ri),2);gr.__change=zs;var un=m(gr);un.value=(un.__value="solid")==null?"":"solid";var ns=p(un);ns.value=(ns.__value="dashed")==null?"":"dashed";var mn=p(ns);mn.value=(mn.__value="dotted")==null?"":"dotted",f(gr),f(Ri),f(ji),f(bi),Se(()=>Nt(wn,"style",`background-color: ${n(Us).color??""}`)),Ho(la,()=>n(Us).period,Ar=>n(Us).period=Ar),rs(Tr,()=>n(Us).thickness,Ar=>n(Us).thickness=Ar),rs(gr,()=>n(Us).lineStyle,Ar=>n(Us).lineStyle=Ar),O($n,bi)});var rr=p(ba,2),ar=m(rr);ar.__click=[t$,Kr,Ci,zs],f(rr),f(Ti),O(si,Ti)},si=>{var Ti=So(),ba=Rt(Ti);Te(ba,()=>n(Kt),rr=>{var ar=qD(),$n=m(ar),Us=p(m($n),2);Vs(Us,21,()=>n(Xc),_n,(ni,Dn,Gr)=>{var Ts=WD(),la=m(Ts),ji=m(la),Ln=m(ji,!0);f(ji);var Ma=p(ji,2);Te(Ma,()=>n(Xc).length>1,wn=>{var vr=OD();vr.__click=()=>Fu(Gr),O(wn,vr)}),f(la);var Ys=p(la,4);Vs(Ys,17,()=>g,_n,(wn,vr,Tr)=>{var xi=VD(),Sr=m(xi),Ta=m(Sr),Ai=p(Ta,2),Ri=m(Ai,!0);f(Ai),f(Sr);var gr=p(Sr,2),un=p(m(gr),2);Jt(un),un.__change=()=>Zu(),f(gr);var ns=p(gr,2),mn=p(m(ns),2),Ar=Qe(()=>Tv(Tr,Gr));mn.__click=function(...ca){var hc;(hc=n(Ar))==null||hc.apply(this,ca)};var sn=m(mn);f(mn),f(ns);var Cr=p(ns,2),Xn=p(m(Cr),2);Xn.__change=()=>Zu();var ea=m(Xn);ea.value=(ea.__value=1)==null?"":1;var zl=p(ea);zl.value=(zl.__value=2)==null?"":2;var Va=p(zl);Va.value=(Va.__value=3)==null?"":3;var Za=p(Va);Za.value=(Za.__value=4)==null?"":4;var vl=p(Za);vl.value=(vl.__value=5)==null?"":5,f(Xn),f(Cr);var oc=p(Cr,2),Gl=p(m(oc),2);Gl.__change=()=>Zu();var Xl=m(Gl);Xl.value=(Xl.__value="solid")==null?"":"solid";var Vl=p(Xl);Vl.value=(Vl.__value="dashed")==null?"":"dashed";var El=p(Vl);El.value=(El.__value="dotted")==null?"":"dotted",f(Gl),f(oc),f(xi),Se(()=>{var ca,hc;Nt(Ta,"style",`background-color: ${((ca=n(Dn).styles[Tr])==null?void 0:ca.color)??""}`),Ve(Ri,n(vr).title),Nt(sn,"style",`background-color: ${((hc=n(Dn).styles[Tr])==null?void 0:hc.color)??""}`)}),Ho(un,()=>n(Dn).params[Tr],ca=>n(Dn).params[Tr]=ca),rs(Xn,()=>n(Dn).styles[Tr].thickness,ca=>n(Dn).styles[Tr].thickness=ca),rs(Gl,()=>n(Dn).styles[Tr].lineStyle,ca=>n(Dn).styles[Tr].lineStyle=ca),O(wn,xi)}),f(Ts),Se(()=>Ve(Ln,n(Dn).name)),O(ni,Ts)}),f(Us);var Zi=p(Us,2),bi=m(Zi);bi.__click=qp,f(Zi),pn(2),f($n),f(ar),O(rr,ar)},rr=>{var ar=So(),$n=Rt(ar);Te($n,()=>n(ie),Us=>{var Zi=KD(),bi=m(Zi);Vs(bi,17,()=>g,_n,(Dn,Gr,Ts)=>{var la=UD(),ji=m(la),Ln=m(ji),Ma=m(Ln,!0);f(Ln);var Ys=p(Ln,2),wn=m(Ys);Jt(wn);var vr=p(wn,2);Te(vr,()=>v.length>1,Za=>{var vl=HD();vl.__click=()=>Yp(Ts),O(Za,vl)},Za=>{var vl=GD();O(Za,vl)}),f(Ys),f(ji);var Tr=p(ji,2),xi=m(Tr),Sr=p(m(xi),2),Ta=Qe(()=>Gv(Ts));Sr.__click=function(...Za){var vl;(vl=n(Ta))==null||vl.apply(this,Za)};var Ai=m(Sr);f(Sr),f(xi);var Ri=p(xi,2),gr=p(m(Ri),2),un=m(gr);un.value=(un.__value=1)==null?"":1;var ns=p(un);ns.value=(ns.__value=2)==null?"":2;var mn=p(ns);mn.value=(mn.__value=3)==null?"":3;var Ar=p(mn);Ar.value=(Ar.__value=4)==null?"":4;var sn=p(Ar);sn.value=(sn.__value=5)==null?"":5,f(gr),f(Ri);var Cr=p(Ri,2),Xn=p(m(Cr),2),ea=m(Xn);ea.value=(ea.__value="solid")==null?"":"solid";var zl=p(ea);zl.value=(zl.__value="dashed")==null?"":"dashed";var Va=p(zl);Va.value=(Va.__value="dotted")==null?"":"dotted",f(Xn),f(Cr),f(Tr),f(la),Se(()=>{Ve(Ma,n(Gr).title),Nt(Ai,"style",`background-color: ${_[Ts].color??""}`)}),Ho(wn,()=>v[Ts],Za=>v[Ts]=Za),rs(gr,()=>_[Ts].thickness,Za=>_[Ts].thickness=Za),rs(Xn,()=>_[Ts].lineStyle,Za=>_[Ts].lineStyle=Za),O(Dn,la)});var ni=p(bi,2);Te(ni,()=>g.length<10,Dn=>{var Gr=YD(),Ts=m(Gr);Ts.__click=[Qg,Me,yt,Kp,St,pv,lo,Rp,Wo,Av,g,v,_,Ct,Ad,Ne,Ca],f(Gr),O(Dn,Gr)}),f(Zi),O(Us,Zi)},Us=>{var Zi=So(),bi=Rt(Zi);Te(bi,()=>n(Ct),ni=>{var Dn=nE(),Gr=m(Dn);Vs(Gr,17,()=>g,_n,(la,ji,Ln)=>{var Ma=oE(),Ys=m(Ma),wn=m(Ys),vr=m(wn,!0);f(wn);var Tr=p(wn,2),xi=m(Tr);Jt(xi),xi.__change=[ZD,Ad];var Sr=p(xi,2);Te(Sr,()=>v.length>1,Ai=>{var Ri=XD();Ri.__click=()=>Yp(Ln),O(Ai,Ri)},Ai=>{var Ri=JD();O(Ai,Ri)}),f(Tr),f(Ys);var Ta=p(Ys,2);Te(Ta,()=>_[Ln],Ai=>{var Ri=tE(),gr=m(Ri),un=p(m(gr),2),ns=Qe(()=>Uv(Ln));un.__click=function(...Vl){var El;(El=n(ns))==null||El.apply(this,Vl)};var mn=m(un);f(un),f(gr);var Ar=p(gr,2),sn=p(m(Ar),2);sn.__change=[QD,Ad];var Cr=m(sn);Cr.value=(Cr.__value=1)==null?"":1;var Xn=p(Cr);Xn.value=(Xn.__value=2)==null?"":2;var ea=p(Xn);ea.value=(ea.__value=3)==null?"":3;var zl=p(ea);zl.value=(zl.__value=4)==null?"":4;var Va=p(zl);Va.value=(Va.__value=5)==null?"":5,f(sn),f(Ar);var Za=p(Ar,2),vl=p(m(Za),2);vl.__change=[eE,Ad];var oc=m(vl);oc.value=(oc.__value="solid")==null?"":"solid";var Gl=p(oc);Gl.value=(Gl.__value="dashed")==null?"":"dashed";var Xl=p(Gl);Xl.value=(Xl.__value="dotted")==null?"":"dotted",f(vl),f(Za),f(Ri),Se(()=>Nt(mn,"style",`background-color: ${_[Ln].color??""}`)),rs(sn,()=>_[Ln].thickness,Vl=>_[Ln].thickness=Vl),rs(vl,()=>_[Ln].lineStyle,Vl=>_[Ln].lineStyle=Vl),O(Ai,Ri)}),f(Ma),Se(()=>Ve(vr,n(ji).title)),Ho(xi,()=>v[Ln],Ai=>v[Ln]=Ai),O(la,Ma)});var Ts=p(Gr,2);Te(Ts,()=>g.length<10,la=>{var ji=sE(),Ln=m(ji);Ln.__click=[Qg,Me,yt,Kp,St,pv,lo,Rp,Wo,Av,g,v,_,Ct,Ad,Ne,Ca],f(ji),O(la,ji)}),f(Dn),O(ni,Dn)},ni=>{var Dn=So(),Gr=Rt(Dn);Te(Gr,()=>n(us),Ts=>{var la=lE(),ji=m(la);Vs(ji,17,()=>n(an),_n,(Ys,wn,vr)=>{var Tr=aE(),xi=m(Tr),Sr=m(xi);Sr.textContent=`ROC ${vr+1}`;var Ta=p(Sr,2);Te(Ta,()=>n(an).length>1,ca=>{var hc=rE();hc.__click=[iE,Sc,wn],O(ca,hc)}),f(xi);var Ai=p(xi,2),Ri=m(Ai),gr=p(m(Ri),2);Jt(gr),gr.__change=()=>ai(vr),f(Ri);var un=p(Ri,2),ns=m(un),mn=p(m(ns),2),Ar=Qe(()=>df(vr));mn.__click=function(...ca){var hc;(hc=n(Ar))==null||hc.apply(this,ca)};var sn=m(mn);f(mn),f(ns);var Cr=p(ns,2),Xn=p(m(Cr),2);Xn.__change=()=>ai(vr);var ea=m(Xn);ea.value=(ea.__value=1)==null?"":1;var zl=p(ea);zl.value=(zl.__value=2)==null?"":2;var Va=p(zl);Va.value=(Va.__value=3)==null?"":3;var Za=p(Va);Za.value=(Za.__value=4)==null?"":4;var vl=p(Za);vl.value=(vl.__value=5)==null?"":5,f(Xn),f(Cr);var oc=p(Cr,2),Gl=p(m(oc),2);Gl.__change=()=>ai(vr);var Xl=m(Gl);Xl.value=(Xl.__value="solid")==null?"":"solid";var Vl=p(Xl);Vl.value=(Vl.__value="dashed")==null?"":"dashed";var El=p(Vl);El.value=(El.__value="dotted")==null?"":"dotted",f(Gl),f(oc),f(un),f(Ai),f(Tr),Se(()=>Nt(sn,"style",`background-color: ${n(wn).styles.roc.color??""}`)),Ho(gr,()=>n(wn).period,ca=>n(wn).period=ca),rs(Xn,()=>n(wn).styles.roc.thickness,ca=>n(wn).styles.roc.thickness=ca),rs(Gl,()=>n(wn).styles.roc.lineStyle,ca=>n(wn).styles.roc.lineStyle=ca),O(Ys,Tr)});var Ln=p(ji,2),Ma=m(Ln);Ma.__click=Pa,f(Ln),f(la),O(Ts,la)},Ts=>{var la=So(),ji=Rt(la);Te(ji,()=>n(or),Ln=>{var Ma=pE(),Ys=m(Ma);Vs(Ys,17,()=>n(ps),_n,(Tr,xi,Sr)=>{var Ta=uE(),Ai=m(Ta),Ri=m(Ai);Ri.textContent=`PSY ${Sr+1}`;var gr=p(Ri,2);Te(gr,()=>n(ps).length>1,yl=>{var Dd=dE();Dd.__click=[cE,il,xi],O(yl,Dd)}),f(Ai);var un=p(Ai,2),ns=m(un),mn=p(m(ns),2);Jt(mn),mn.__change=()=>Dr(Sr),f(ns);var Ar=p(ns,2),sn=p(m(Ar),2),Cr=m(sn),Xn=p(m(Cr),2),ea=Qe(()=>Np(Sr*2));Xn.__click=function(...yl){var Dd;(Dd=n(ea))==null||Dd.apply(this,yl)};var zl=m(Xn);f(Xn),f(Cr);var Va=p(Cr,2),Za=p(m(Va),2);Za.__change=()=>Dr(Sr);var vl=m(Za);vl.value=(vl.__value=1)==null?"":1;var oc=p(vl);oc.value=(oc.__value=2)==null?"":2;var Gl=p(oc);Gl.value=(Gl.__value=3)==null?"":3;var Xl=p(Gl);Xl.value=(Xl.__value=4)==null?"":4;var Vl=p(Xl);Vl.value=(Vl.__value=5)==null?"":5,f(Za),f(Va);var El=p(Va,2),ca=p(m(El),2);ca.__change=()=>Dr(Sr);var hc=m(ca);hc.value=(hc.__value="solid")==null?"":"solid";var dd=p(hc);dd.value=(dd.__value="dashed")==null?"":"dashed";var Id=p(dd);Id.value=(Id.__value="dotted")==null?"":"dotted",f(ca),f(El),f(sn),f(Ar);var sc=p(Ar,2),zd=p(m(sc),2);Jt(zd),zd.__change=()=>Dr(Sr),f(sc);var Fd=p(sc,2),Pc=p(m(Fd),2),Pr=m(Pc),Zd=p(m(Pr),2),Ic=Qe(()=>Np(Sr*2+1));Zd.__click=function(...yl){var Dd;(Dd=n(Ic))==null||Dd.apply(this,yl)};var tu=m(Zd);f(Zd),f(Pr);var $d=p(Pr,2),el=p(m($d),2);el.__change=()=>Dr(Sr);var ou=m(el);ou.value=(ou.__value=1)==null?"":1;var wd=p(ou);wd.value=(wd.__value=2)==null?"":2;var gd=p(wd);gd.value=(gd.__value=3)==null?"":3;var Fc=p(gd);Fc.value=(Fc.__value=4)==null?"":4;var ud=p(Fc);ud.value=(ud.__value=5)==null?"":5,f(el),f($d);var su=p($d,2),Lr=p(m(su),2);Lr.__change=()=>Dr(Sr);var dc=m(Lr);dc.value=(dc.__value="solid")==null?"":"solid";var Du=p(dc);Du.value=(Du.__value="dashed")==null?"":"dashed";var Eu=p(Du);Eu.value=(Eu.__value="dotted")==null?"":"dotted",f(Lr),f(su),f(Pc),f(Fd);var Ju=p(Fd,2),mu=m(Ju);Jt(mu),mu.__change=()=>Dr(Sr);var dp=p(mu,2);f(Ju),f(un),f(Ta),Se(()=>{Nt(zl,"style",`background-color: ${n(xi).styles.psy.color??""}`),Nt(tu,"style",`background-color: ${n(xi).styles.mapsy.color??""}`),Nt(mu,"id",`showMapsy_${n(xi).id??""}`),Nt(dp,"for",`showMapsy_${n(xi).id??""}`)}),Ho(mn,()=>n(xi).psyPeriod,yl=>n(xi).psyPeriod=yl),rs(Za,()=>n(xi).styles.psy.thickness,yl=>n(xi).styles.psy.thickness=yl),rs(ca,()=>n(xi).styles.psy.lineStyle,yl=>n(xi).styles.psy.lineStyle=yl),Ho(zd,()=>n(xi).mapsyPeriod,yl=>n(xi).mapsyPeriod=yl),rs(el,()=>n(xi).styles.mapsy.thickness,yl=>n(xi).styles.mapsy.thickness=yl),rs(Lr,()=>n(xi).styles.mapsy.lineStyle,yl=>n(xi).styles.mapsy.lineStyle=yl),_v(mu,()=>n(xi).showMapsy,yl=>n(xi).showMapsy=yl),O(Tr,Ta)});var wn=p(Ys,2),vr=m(wn);vr.__click=nr,f(wn),f(Ma),O(Ln,Ma)},Ln=>{var Ma=So(),Ys=Rt(Ma);Te(Ys,()=>n($s),wn=>{var vr=gE(),Tr=m(vr);Vs(Tr,17,()=>n(_s),_n,(Ta,Ai,Ri)=>{var gr=mE(),un=m(gr),ns=m(un);ns.textContent=`OBV ${Ri+1}`;var mn=p(ns,2);Te(mn,()=>n(_s).length>1,yl=>{var Dd=fE();Dd.__click=[vE,pu,Ai],O(yl,Dd)}),f(un);var Ar=p(un,2),sn=m(Ar),Cr=p(m(sn),2);Jt(Cr),Cr.__input=Vd,f(sn);var Xn=p(sn,2),ea=p(m(Xn),2),zl=m(ea),Va=p(m(zl),2),Za=Qe(()=>jp(Ri*2));Va.__click=function(...yl){var Dd;(Dd=n(Za))==null||Dd.apply(this,yl)};var vl=m(Va);f(Va),f(zl);var oc=p(zl,2),Gl=p(m(oc),2);Gl.__change=Vd;var Xl=m(Gl);Xl.value=(Xl.__value=1)==null?"":1;var Vl=p(Xl);Vl.value=(Vl.__value=2)==null?"":2;var El=p(Vl);El.value=(El.__value=3)==null?"":3;var ca=p(El);ca.value=(ca.__value=4)==null?"":4;var hc=p(ca);hc.value=(hc.__value=5)==null?"":5,f(Gl),f(oc);var dd=p(oc,2),Id=p(m(dd),2);Id.__change=Vd;var sc=m(Id);sc.value=(sc.__value="solid")==null?"":"solid";var zd=p(sc);zd.value=(zd.__value="dashed")==null?"":"dashed";var Fd=p(zd);Fd.value=(Fd.__value="dotted")==null?"":"dotted",f(Id),f(dd),f(ea),f(Xn);var Pc=p(Xn,2),Pr=p(m(Pc),2);Jt(Pr),Pr.__input=Vd,pn(2),f(Pc);var Zd=p(Pc,2),Ic=p(m(Zd),2),tu=m(Ic),$d=p(m(tu),2),el=Qe(()=>jp(Ri*2+1));$d.__click=function(...yl){var Dd;(Dd=n(el))==null||Dd.apply(this,yl)};var ou=m($d);f($d),f(tu);var wd=p(tu,2),gd=p(m(wd),2);gd.__change=Vd;var Fc=m(gd);Fc.value=(Fc.__value=1)==null?"":1;var ud=p(Fc);ud.value=(ud.__value=2)==null?"":2;var su=p(ud);su.value=(su.__value=3)==null?"":3;var Lr=p(su);Lr.value=(Lr.__value=4)==null?"":4;var dc=p(Lr);dc.value=(dc.__value=5)==null?"":5,f(gd),f(wd);var Du=p(wd,2),Eu=p(m(Du),2);Eu.__change=Vd;var Ju=m(Eu);Ju.value=(Ju.__value="solid")==null?"":"solid";var mu=p(Ju);mu.value=(mu.__value="dashed")==null?"":"dashed";var dp=p(mu);dp.value=(dp.__value="dotted")==null?"":"dotted",f(Eu),f(Du),f(Ic),f(Zd),f(Ar),f(gr),Se(()=>{Nt(vl,"style",`background-color: ${n(Ai).styles.obv.color??""}`),Nt(ou,"style",`background-color: ${n(Ai).styles.maobv.color??""}`)}),Ho(Cr,()=>n(Ai).obvPeriod,yl=>n(Ai).obvPeriod=yl),rs(Gl,()=>n(Ai).styles.obv.thickness,yl=>n(Ai).styles.obv.thickness=yl),rs(Id,()=>n(Ai).styles.obv.lineStyle,yl=>n(Ai).styles.obv.lineStyle=yl),Ho(Pr,()=>n(Ai).maobvPeriod,yl=>n(Ai).maobvPeriod=yl),rs(gd,()=>n(Ai).styles.maobv.thickness,yl=>n(Ai).styles.maobv.thickness=yl),rs(Eu,()=>n(Ai).styles.maobv.lineStyle,yl=>n(Ai).styles.maobv.lineStyle=yl),O(Ta,gr)});var xi=p(Tr,2),Sr=m(xi);Sr.__click=ld,f(xi),f(vr),O(wn,vr)},wn=>{var vr=So(),Tr=Rt(vr);Te(Tr,()=>n(_r),xi=>{var Sr=bE(),Ta=m(Sr);Vs(Ta,17,()=>n(fn),_n,(gr,un,ns)=>{var mn=yE(),Ar=m(mn),sn=m(Ar);sn.textContent=`KDJ ${ns+1}`;var Cr=p(sn,2);Te(Cr,()=>n(fn).length>1,Oc=>{var uc=_E();uc.__click=[hE,Gp,un],O(Oc,uc)}),f(Ar);var Xn=p(Ar,2),ea=m(Xn),zl=m(ea),Va=p(m(zl),2);Jt(Va),Va.__input=Oc=>{Oc.target&&(console.log("📊 K Period changed to:",Oc.target.value,"for group:",ns),zu(ns))},f(zl);var Za=p(zl,2),vl=p(m(Za),2);Jt(vl),vl.__input=Oc=>{Oc.target&&(console.log("📊 D Period changed to:",Oc.target.value,"for group:",ns),zu(ns))},f(Za),f(ea);var oc=p(ea,2),Gl=p(m(oc),2),Xl=p(m(Gl),2),Vl=Qe(()=>$u(ns,0));Xl.__click=function(...Oc){var uc;(uc=n(Vl))==null||uc.apply(this,Oc)};var El=m(Xl);f(Xl);var ca=p(Xl,2);ca.__change=()=>zu(ns);var hc=m(ca);hc.value=(hc.__value=1)==null?"":1;var dd=p(hc);dd.value=(dd.__value=2)==null?"":2;var Id=p(dd);Id.value=(Id.__value=3)==null?"":3;var sc=p(Id);sc.value=(sc.__value=4)==null?"":4;var zd=p(sc);zd.value=(zd.__value=5)==null?"":5,f(ca);var Fd=p(ca,2);Fd.__change=()=>zu(ns);var Pc=m(Fd);Pc.value=(Pc.__value="solid")==null?"":"solid";var Pr=p(Pc);Pr.value=(Pr.__value="dashed")==null?"":"dashed";var Zd=p(Pr);Zd.value=(Zd.__value="dotted")==null?"":"dotted",f(Fd),f(Gl),f(oc);var Ic=p(oc,2),tu=p(m(Ic),2),$d=p(m(tu),2),el=Qe(()=>$u(ns,1));$d.__click=function(...Oc){var uc;(uc=n(el))==null||uc.apply(this,Oc)};var ou=m($d);f($d);var wd=p($d,2);wd.__change=()=>zu(ns);var gd=m(wd);gd.value=(gd.__value=1)==null?"":1;var Fc=p(gd);Fc.value=(Fc.__value=2)==null?"":2;var ud=p(Fc);ud.value=(ud.__value=3)==null?"":3;var su=p(ud);su.value=(su.__value=4)==null?"":4;var Lr=p(su);Lr.value=(Lr.__value=5)==null?"":5,f(wd);var dc=p(wd,2);dc.__change=()=>zu(ns);var Du=m(dc);Du.value=(Du.__value="solid")==null?"":"solid";var Eu=p(Du);Eu.value=(Eu.__value="dashed")==null?"":"dashed";var Ju=p(Eu);Ju.value=(Ju.__value="dotted")==null?"":"dotted",f(dc),f(tu),f(Ic);var mu=p(Ic,2),dp=p(m(mu),2),yl=p(m(dp),2),Dd=Qe(()=>$u(ns,2));yl.__click=function(...Oc){var uc;(uc=n(Dd))==null||uc.apply(this,Oc)};var Xv=m(yl);f(yl);var up=p(yl,2);up.__change=()=>zu(ns);var Xp=m(up);Xp.value=(Xp.__value=1)==null?"":1;var fv=p(Xp);fv.value=(fv.__value=2)==null?"":2;var Jp=p(fv);Jp.value=(Jp.__value=3)==null?"":3;var Qp=p(Jp);Qp.value=(Qp.__value=4)==null?"":4;var Jv=p(Qp);Jv.value=(Jv.__value=5)==null?"":5,f(up);var Md=p(up,2);Md.__change=()=>zu(ns);var Bc=m(Md);Bc.value=(Bc.__value="solid")==null?"":"solid";var Ap=p(Bc);Ap.value=(Ap.__value="dashed")==null?"":"dashed";var yf=p(Ap);yf.value=(yf.__value="dotted")==null?"":"dotted",f(Md),f(dp),f(mu),f(Xn),f(mn),Se(()=>{Nt(El,"style",`background-color: ${n(un).styles.k.color??""}`),Nt(ou,"style",`background-color: ${n(un).styles.d.color??""}`),Nt(Xv,"style",`background-color: ${n(un).styles.j.color??""}`)}),Ho(Va,()=>n(un).kPeriod,Oc=>n(un).kPeriod=Oc),Ho(vl,()=>n(un).dPeriod,Oc=>n(un).dPeriod=Oc),rs(ca,()=>n(un).styles.k.thickness,Oc=>n(un).styles.k.thickness=Oc),rs(Fd,()=>n(un).styles.k.lineStyle,Oc=>n(un).styles.k.lineStyle=Oc),rs(wd,()=>n(un).styles.d.thickness,Oc=>n(un).styles.d.thickness=Oc),rs(dc,()=>n(un).styles.d.lineStyle,Oc=>n(un).styles.d.lineStyle=Oc),rs(up,()=>n(un).styles.j.thickness,Oc=>n(un).styles.j.thickness=Oc),rs(Md,()=>n(un).styles.j.lineStyle,Oc=>n(un).styles.j.lineStyle=Oc),O(gr,mn)});var Ai=p(Ta,2),Ri=m(Ai);Ri.__click=Ou,f(Ai),f(Sr),O(xi,Sr)},xi=>{var Sr=So(),Ta=Rt(Sr);Te(Ta,()=>n(kn),Ai=>{var Ri=CE(),gr=m(Ri),un=p(m(gr),2),ns=m(un),mn=p(m(ns),2);Jt(mn),mn.__change=[KF,ko,xa],f(ns);var Ar=p(ns,2),sn=p(m(Ar),2);sn.__click=[xE,Xo];var Cr=m(sn);const Xn=Qe(()=>`background-color: ${k(n(Ha),n(mi))}`);f(sn),f(Ar),f(un);var ea=p(un,2),zl=m(ea),Va=p(m(zl),2),Za=m(Va);f(Va),f(zl);var vl=p(zl,2);Jt(vl),vl.__change=Ro,f(ea),f(gr);var oc=p(gr,2),Gl=p(m(oc),2),Xl=p(m(Gl),2);Jt(Xl),Xl.__change=[ZF,ko,Qa],f(Gl);var Vl=p(Gl,2),El=m(Vl),ca=p(m(El),2);ca.__click=[wE,Xo];var hc=m(ca);f(ca),f(El);var dd=p(El,2),Id=p(m(dd),2);Id.__click=[kE,Xo];var sc=m(Id);f(Id),f(dd),f(Vl);var zd=p(Vl,2),Fd=m(zd),Pc=p(m(Fd),2);Pc.__change=[Qy,ko,Ra,ga];var Pr=m(Pc);Pr.value=(Pr.__value=1)==null?"":1;var Zd=p(Pr);Zd.value=(Zd.__value=2)==null?"":2;var Ic=p(Zd);Ic.value=(Ic.__value=3)==null?"":3;var tu=p(Ic);tu.value=(tu.__value=4)==null?"":4;var $d=p(tu);$d.value=($d.__value=5)==null?"":5,f(Pc),f(Fd);var el=p(Fd,2),ou=p(m(el),2);ou.__change=[Qy,ko,Ra,ga];var wd=m(ou);wd.value=(wd.__value="solid")==null?"":"solid";var gd=p(wd);gd.value=(gd.__value="dashed")==null?"":"dashed",f(ou),f(el);var Fc=p(el,2),ud=p(m(Fc),2);ud.__change=[e2,ko,na,nl];var su=m(ud);su.value=(su.__value=1)==null?"":1;var Lr=p(su);Lr.value=(Lr.__value=2)==null?"":2;var dc=p(Lr);dc.value=(dc.__value=3)==null?"":3;var Du=p(dc);Du.value=(Du.__value=4)==null?"":4;var Eu=p(Du);Eu.value=(Eu.__value=5)==null?"":5,f(ud),f(Fc);var Ju=p(Fc,2),mu=p(m(Ju),2);mu.__change=[e2,ko,na,nl];var dp=m(mu);dp.value=(dp.__value="solid")==null?"":"solid";var yl=p(dp);yl.value=(yl.__value="dashed")==null?"":"dashed",f(mu),f(Ju),f(zd),f(oc);var Dd=p(oc,2),Xv=p(m(Dd),2),up=m(Xv),Xp=p(m(up),2);Xp.__click=[SE,Xo];var fv=m(Xp);f(Xp),f(up);var Jp=p(up,2),Qp=p(m(Jp),2);Qp.__change=[Jy,ko,ui,Yr];var Jv=m(Qp);Jv.value=(Jv.__value=1)==null?"":1;var Md=p(Jv);Md.value=(Md.__value=2)==null?"":2;var Bc=p(Md);Bc.value=(Bc.__value=3)==null?"":3;var Ap=p(Bc);Ap.value=(Ap.__value=4)==null?"":4;var yf=p(Ap);yf.value=(yf.__value=5)==null?"":5,f(Qp),f(Jp);var Oc=p(Jp,2),uc=p(m(Oc),2);uc.__change=[Jy,ko,ui,Yr];var tm=m(uc);tm.value=(tm.__value="solid")==null?"":"solid";var Hf=p(tm);Hf.value=(Hf.__value="dashed")==null?"":"dashed",f(uc),f(Oc),f(Xv),f(Dd);var mv=p(Dd,2),bf=p(m(mv),2),xf=p(m(bf),2);Jt(xf),xf.__change=[XF,ko,ue],f(bf),f(mv),f(Ri),Se(()=>{Nt(Cr,"style",n(Xn)),Ve(Za,`${n(mi)??""}%`),Nt(hc,"style",`background-color: ${n(zi)}`),Nt(sc,"style",`background-color: ${n(hr)}`),Nt(fv,"style",`background-color: ${n(lr)}`)}),_v(mn,()=>n(xa),gu=>x(xa,gu)),Ho(vl,()=>n(mi),gu=>x(mi,gu)),_v(Xl,()=>n(Qa),gu=>x(Qa,gu)),rs(Pc,()=>n(Ra),gu=>x(Ra,gu)),rs(ou,()=>n(ga),gu=>x(ga,gu)),rs(ud,()=>n(na),gu=>x(na,gu)),rs(mu,()=>n(nl),gu=>x(nl,gu)),rs(Qp,()=>n(ui),gu=>x(ui,gu)),rs(uc,()=>n(Yr),gu=>x(Yr,gu)),_v(xf,()=>n(ue),gu=>x(ue,gu)),O(Ai,Ri)},Ai=>{var Ri=So(),gr=Rt(Ri);Te(gr,()=>n(Me),un=>{var ns=jE(),mn=m(ns),Ar=p(m(mn),2),sn=m(Ar),Cr=p(m(sn),2);Jt(Cr),f(sn);var Xn=p(sn,2),ea=p(m(Xn),2);Jt(ea),f(Xn),f(Ar),f(mn);var zl=p(mn,2),Va=p(m(zl),2),Za=p(m(Va),2),vl=m(Za),oc=p(vl,2);oc.__click=[PE,rn];var Gl=m(oc);f(oc),f(Za),f(Va);var Xl=p(Va,2),Vl=m(Xl),El=p(m(Vl),2),ca=m(El);f(El),f(Vl);var hc=p(Vl,2);Jt(hc),pn(2),f(Xl),f(zl);var dd=p(zl,2),Id=p(m(dd),2),sc=m(Id),zd=p(m(sc),2),Fd=m(zd),Pc=p(Fd,2);Pc.__click=[IE,rn];var Pr=m(Pc);f(Pc),f(zd),f(sc);var Zd=p(sc,2),Ic=p(m(Zd),2),tu=m(Ic),$d=p(tu,2);$d.__click=[ME,rn];var el=m($d);f($d),f(Ic),f(Zd);var ou=p(Zd,2),wd=p(m(ou),2),gd=m(wd),Fc=p(gd,2);Fc.__click=[TE,rn];var ud=m(Fc);f(Fc),f(wd),f(ou),f(Id),f(dd);var su=p(dd,2),Lr=p(m(su),2),dc=m(Lr),Du=p(m(dc),2),Eu=m(Du);Eu.value=(Eu.__value=1)==null?"":1;var Ju=p(Eu);Ju.value=(Ju.__value=2)==null?"":2;var mu=p(Ju);mu.value=(mu.__value=3)==null?"":3;var dp=p(mu);dp.value=(dp.__value=4)==null?"":4;var yl=p(dp);yl.value=(yl.__value=5)==null?"":5,f(Du),f(dc);var Dd=p(dc,2),Xv=p(m(Dd),2),up=m(Xv);up.value=(up.__value="solid")==null?"":"solid";var Xp=p(up);Xp.value=(Xp.__value="dashed")==null?"":"dashed";var fv=p(Xp);fv.value=(fv.__value="dotted")==null?"":"dotted",f(Xv),f(Dd),f(Lr),f(su);var Jp=p(su,2),Qp=m(Jp);Qp.__click=[l$,Me,i,l,Ot,B,$,S,M,I,C,T,z,j,Co];var Jv=p(Qp,2);Te(Jv,()=>n(Ot).length>1,Bc=>{var Ap=LE();Ap.__click=[AE,Hs],O(Bc,Ap)}),f(Jp);var Md=p(Jp,2);Te(Md,()=>n(Ot).length>1,Bc=>{var Ap=So(),yf=Rt(Ap);Vs(yf,17,()=>n(Ot).slice(1),_n,(Oc,uc,tm)=>{var Hf=NE();const mv=Qe(()=>tm+1);var bf=m(Hf),xf=m(bf),gu=m(xf);f(xf);var bg=p(xf,2);bg.__click=[zE,Hs,mv],f(bf);var gm=p(bf,2),hm=m(gm),Km=p(m(hm),2);Jt(Km),Km.__change=Co,f(hm);var xg=p(hm,2),Zm=p(m(xg),2);Jt(Zm),Zm.__change=Co,f(xg),f(gm);var Xm=p(gm,2),Qv=p(m(Xm),2),wg=p(m(Qv),2),kg=m(wg),Jm=p(kg,2);Jm.__click=[FE,rn,mv];var i_=m(Jm);f(Jm),f(wg),f(Qv);var Sg=p(Qv,2),_m=m(Sg),Qm=p(m(_m),2),r_=m(Qm);f(Qm),f(_m);var e0=p(_m,2);Jt(e0),e0.__change=Co,f(Sg),f(Xm);var t0=p(Xm,2),Cg=p(m(t0),2),o0=m(Cg),Pg=p(m(o0),2),Ig=m(Pg),s0=p(Ig,2);s0.__click=[$E,rn,mv];var a_=m(s0);f(s0),f(Pg),f(o0);var n0=p(o0,2),Mg=p(m(n0),2),Tg=m(Mg),i0=p(Tg,2);i0.__click=[DE,rn,mv];var l_=m(i0);f(i0),f(Mg),f(n0);var Ag=p(n0,2),Lg=p(m(Ag),2),zg=m(Lg),r0=p(zg,2);r0.__click=[EE,rn,mv];var c_=m(r0);f(r0),f(Lg),f(Ag),f(Cg),f(t0);var Fg=p(t0,2),$g=p(m(Fg),2),a0=m($g),ym=p(m(a0),2);ym.__change=Co;var l0=m(ym);l0.value=(l0.__value=1)==null?"":1;var c0=p(l0);c0.value=(c0.__value=2)==null?"":2;var om=p(c0);om.value=(om.__value=3)==null?"":3;var bm=p(om);bm.value=(bm.__value=4)==null?"":4;var d0=p(bm);d0.value=(d0.__value=5)==null?"":5,f(ym),f(a0);var Dg=p(a0,2),xm=p(m(Dg),2);xm.__change=Co;var u0=m(xm);u0.value=(u0.__value="solid")==null?"":"solid";var sm=p(u0);sm.value=(sm.__value="dashed")==null?"":"dashed";var Eg=p(sm);Eg.value=(Eg.__value="dotted")==null?"":"dotted",f(xm),f(Dg),f($g),f(Fg),f(Hf),Se(()=>{Ve(gu,`BOLL ${n(mv)+1}`),Nt(bg,"title",`Remove BOLL ${n(mv)+1}`),Nt(kg,"style",`background-color: ${n(uc).styles.fillColor}; opacity: ${(n(uc).styles.fillOpacity||0)/100}`),Nt(i_,"style",`background-color: ${n(uc).styles.fillColor}; opacity: ${(n(uc).styles.fillOpacity||0)/100}`),Ve(r_,`${n(uc).styles.fillOpacity??""}%`),Nt(Ig,"style",`background-color: ${n(uc).styles.upperColor}`),Nt(a_,"style",`background-color: ${n(uc).styles.upperColor}`),Nt(Tg,"style",`background-color: ${n(uc).styles.middleColor}`),Nt(l_,"style",`background-color: ${n(uc).styles.middleColor}`),Nt(zg,"style",`background-color: ${n(uc).styles.lowerColor}`),Nt(c_,"style",`background-color: ${n(uc).styles.lowerColor}`)}),Ho(Km,()=>n(uc).period,Fv=>n(uc).period=Fv),Ho(Zm,()=>n(uc).stdDev,Fv=>n(uc).stdDev=Fv),Ho(e0,()=>n(uc).styles.fillOpacity,Fv=>n(uc).styles.fillOpacity=Fv),rs(ym,()=>n(uc).styles.thickness,Fv=>n(uc).styles.thickness=Fv),rs(xm,()=>n(uc).styles.lineStyle,Fv=>n(uc).styles.lineStyle=Fv),O(Oc,Hf)}),O(Bc,Ap)}),f(ns),Se(()=>{Nt(vl,"style",`background-color: ${n(S)??""}; opacity: ${n(M)/100}`),Nt(Gl,"style",`background-color: ${n(S)??""}; opacity: ${n(M)/100}`),Ve(ca,`${n(M)??""}%`),Nt(Fd,"style",`background-color: ${n(I)??""}`),Nt(Pr,"style",`background-color: ${n(I)??""}`),Nt(tu,"style",`background-color: ${n(C)??""}`),Nt(el,"style",`background-color: ${n(C)??""}`),Nt(gd,"style",`background-color: ${n(T)??""}`),Nt(ud,"style",`background-color: ${n(T)??""}`)}),Ho(Cr,()=>n(B),Bc=>x(B,Bc)),Ho(ea,()=>n($),Bc=>x($,Bc)),Ho(hc,()=>n(M),Bc=>x(M,Bc)),rs(Du,()=>n(z),Bc=>x(z,Bc)),rs(Xv,()=>n(j),Bc=>x(j,Bc)),O(un,ns)},un=>{var ns=So(),mn=Rt(ns);Te(mn,()=>!g.length,Ar=>{var sn=RE(),Cr=m(sn),Xn=m(Cr,!0);Se(()=>Ve(Xn,Db())),f(Cr),f(sn),O(Ar,sn)},Ar=>{var sn=qE(),Cr=m(sn);Vs(Cr,17,()=>g,_n,(ea,zl,Va)=>{var Za=VE(),vl=m(Za),oc=m(vl),Gl=m(oc,!0);f(oc);var Xl=p(oc,2),Vl=m(Xl);Jt(Vl);var El=p(Vl,2);Te(El,()=>v.length>1&&!n(Me),Fc=>{var ud=BE();ud.__click=()=>Yp(Va),O(Fc,ud)},Fc=>{var ud=So(),su=Rt(ud);Te(su,()=>!n(Me),Lr=>{var dc=OE();O(Lr,dc)},null,!0),O(Fc,ud)}),f(Xl),f(vl);var ca=p(vl,2),hc=m(ca),dd=p(m(hc),2),Id=Qe(()=>lp(Va));dd.__click=function(...Fc){var ud;(ud=n(Id))==null||ud.apply(this,Fc)};var sc=m(dd);f(dd),f(hc);var zd=p(hc,2),Fd=p(m(zd),2),Pc=m(Fd);Pc.value=(Pc.__value=1)==null?"":1;var Pr=p(Pc);Pr.value=(Pr.__value=2)==null?"":2;var Zd=p(Pr);Zd.value=(Zd.__value=3)==null?"":3;var Ic=p(Zd);Ic.value=(Ic.__value=4)==null?"":4;var tu=p(Ic);tu.value=(tu.__value=5)==null?"":5,f(Fd),f(zd);var $d=p(zd,2),el=p(m($d),2),ou=m(el);ou.value=(ou.__value="solid")==null?"":"solid";var wd=p(ou);wd.value=(wd.__value="dashed")==null?"":"dashed";var gd=p(wd);gd.value=(gd.__value="dotted")==null?"":"dotted",f(el),f($d),f(ca),f(Za),Se(()=>{Ve(Gl,n(zl).title),Nt(sc,"style",`background-color: ${_[Va].color??""}`)}),Ho(Vl,()=>v[Va],Fc=>v[Va]=Fc),rs(Fd,()=>_[Va].thickness,Fc=>_[Va].thickness=Fc),rs(el,()=>_[Va].lineStyle,Fc=>_[Va].lineStyle=Fc),O(ea,Za)});var Xn=p(Cr,2);Te(Xn,()=>g.length<10&&!n(Me)&&!n(fo)&&!n(Un),ea=>{var zl=WE(),Va=m(zl);Va.__click=[Qg,Me,yt,Kp,St,pv,lo,Rp,Wo,Av,g,v,_,Ct,Ad,Ne,Ca],f(zl),Se(()=>Nt(Va,"title",n(yt)?"Add more BIAS indicator":n(St)?"Add more Awesome Oscillator":n(lo)?"Add more WR indicator":n(Ne)?"Add more EMA":"Add parameter")),O(ea,zl)}),f(sn),O(Ar,sn)},!0),O(un,ns)},!0),O(Ai,Ri)},!0),O(xi,Sr)},!0),O(wn,vr)},!0),O(Ln,Ma)},!0),O(Ts,la)},!0),O(ni,Dn)},!0),O(Us,Zi)},!0),O(rr,ar)},!0),O(si,Ti)},!0),O(Ni,Ki)},!0),O(dn,oi)},!0),O(Ei,Rr)},!0),O(yi,Yi)},!0),O(ir,Hr)},!0),O(pr,Ya)},!0),O(qr,On)},!0),O(Hn,aa)},!0),O(Jr,An)},!0),O(jr,Ui)},!0),O(wr,Ia)},!0),O(xr,al)},!0),O(Nr,rl)},!0),O(er,Ea)},!0),O(Da,zc)},!0),O($a,Al)},!0),O(Wr,Ol)},!0),O(qd,Ld)},!0),O(Wd,Yd)},!0),O(fu,Qd)},!0),O(_i,ac)},!0),O($o,so)},!0),O(Be,_t)},!0),O(R,G)});var E=p(A,2);Te(E,()=>n(gl),R=>{var G=HE();O(R,G)}),f(L),O(b,L)},$$slots:{default:!0}});var Vi=p(Qo,2),fi=Qe(()=>{var b,w;return((w=(b=n(Ot)[n(No)])==null?void 0:b.styles)==null?void 0:w.upperColor)||"#f23645"});Aa(Vi,{get show(){return n(go)},set show(b){x(go,D(b))},get selectedColor(){return n(fi)},get position(){return n(fs)},$$events:{colorChange:b=>{n(Ot)[n(No)]?(n(Ot)[n(No)].styles.upperColor=b.detail.rgba||b.detail.color,Co()):x(I,D(b.detail.rgba||b.detail.color))}}});var oo=p(Vi,2),Po=Qe(()=>{var b,w;return((w=(b=n(Ot)[n(No)])==null?void 0:b.styles)==null?void 0:w.middleColor)||"#2962ff"});Aa(oo,{get show(){return n(Ms)},set show(b){x(Ms,D(b))},get selectedColor(){return n(Po)},get position(){return n(zn)},$$events:{colorChange:b=>{n(Ot)[n(No)]?(n(Ot)[n(No)].styles.middleColor=b.detail.rgba||b.detail.color,Co()):x(C,D(b.detail.rgba||b.detail.color))}}});var Ds=p(oo,2),Wi=Qe(()=>{var b,w;return((w=(b=n(Ot)[n(No)])==null?void 0:b.styles)==null?void 0:w.lowerColor)||"#089981"});Aa(Ds,{get show(){return n(qs)},set show(b){x(qs,D(b))},get selectedColor(){return n(Wi)},get position(){return n(Vn)},$$events:{colorChange:b=>{n(Ot)[n(No)]?(n(Ot)[n(No)].styles.lowerColor=b.detail.rgba||b.detail.color,Co()):x(T,D(b.detail.rgba||b.detail.color))}}});var Bn=p(Ds,2),Qn=Qe(()=>{var b,w;return((w=(b=n(Ot)[n(No)])==null?void 0:b.styles)==null?void 0:w.fillColor)||"#2196F3"});Aa(Bn,{get show(){return n($t)},set show(b){x($t,D(b))},get selectedColor(){return n(Qn)},get position(){return n(_o)},$$events:{colorChange:b=>{n(Ot)[n(No)]?(n(Ot)[n(No)].styles.fillColor=b.detail.rgba||b.detail.color,Co()):x(S,D(b.detail.rgba||b.detail.color))}}});var In=p(Bn,2);Aa(In,{get show(){return n(Ss)},set show(b){x(Ss,D(b))},get selectedColor(){return n(lr)},get position(){return n(di)},$$events:{colorChange:b=>{var L;x(lr,D(b.detail.rgba||b.detail.color));const w=window.__npoMaeApi;(L=w==null?void 0:w.setColors)==null||L.call(w,{median:n(lr)})}}});var ma=p(In,2),Bl=Qe(()=>k(n(Ha),n(mi)));Aa(ma,{get show(){return n(Mn)},set show(b){x(Mn,D(b))},get selectedColor(){return n(Bl)},get position(){return n(La)},$$events:{colorChange:b=>{x(Ha,D(b.detail.rgba||b.detail.color)),Ro()}}});var xn=p(ma,2);Aa(xn,{get show(){return n(nn)},set show(b){x(nn,D(b))},get selectedColor(){return n(zi)},get position(){return n(tr)},$$events:{colorChange:b=>{var L;x(zi,D(b.detail.rgba||b.detail.color));const w=window.__npoMaeApi;(L=w==null?void 0:w.setColors)==null||L.call(w,{slLong:n(zi)})}}});var Ii=p(xn,2);Aa(Ii,{get show(){return n(Ur)},set show(b){x(Ur,D(b))},get selectedColor(){return n(hr)},get position(){return n(cl)},$$events:{colorChange:b=>{var L;x(hr,D(b.detail.rgba||b.detail.color));const w=window.__npoMaeApi;(L=w==null?void 0:w.setColors)==null||L.call(w,{slShort:n(hr)})}}});var ya=p(Ii,2),ei=Qe(()=>{var b,w,L;return((L=(w=(b=n(zo)[n(K)])==null?void 0:b.styles)==null?void 0:w[n(Y)])==null?void 0:L.color)||"#2563eb"});Aa(ya,{get show(){return n(F)},set show(b){x(F,D(b))},get selectedColor(){return n(ei)},get position(){return n(V)},$$events:{colorChange:b=>{n(zo).length>n(K)&&(n(zo)[n(K)].styles[n(Y)].color=b.detail.rgba||b.detail.color,lc(n(K),n(Y)))}}});var Zl=p(ya,2),Jc=Qe(()=>{var b,w,L;return((L=(w=(b=n(Os)[n(sl)])==null?void 0:b.styles)==null?void 0:w[n(Uc)])==null?void 0:L.color)||"#2563eb"});Aa(Zl,{get show(){return n(Jl)},set show(b){x(Jl,D(b))},get selectedColor(){return n(Jc)},get position(){return Wl},$$events:{colorChange:b=>{n(Os).length>n(sl)&&n(Os)[n(sl)].styles[n(Uc)]&&(n(Os)[n(sl)].styles[n(Uc)].color=b.detail.rgba||b.detail.color,Ga())}}});var Zn=p(Zl,2),bd=Qe(()=>{var b;return((b=n(Ci)[n(te)])==null?void 0:b.color)||"#2563eb"});Aa(Zn,{get show(){return n(Z)},set show(b){x(Z,D(b))},get selectedColor(){return n(bd)},get position(){return n(ne)},$$events:{colorChange:b=>{n(Ci).length>n(te)&&(n(Ci)[n(te)].color=b.detail.rgba||b.detail.color,zs())}}});var rc=p(Zn,2),Hc=Qe(()=>{var b,w,L;return((L=(w=(b=n(Pn)[0])==null?void 0:b.styles)==null?void 0:w.diPlus)==null?void 0:L.color)||"#2563eb"});Aa(rc,{get show(){return n(oe)},set show(b){x(oe,D(b))},get selectedColor(){return n(Hc)},get position(){return n(U)},$$events:{colorChange:b=>{n(Pn).length>0&&(n(Pn)[0].styles.diPlus.color=b.detail.rgba||b.detail.color)}}});var Tl=p(rc,2),Rc=Qe(()=>{var b;return((b=_[0])==null?void 0:b.color)||"#2563eb"});Aa(Tl,{get show(){return n(W)},set show(b){x(W,D(b))},get selectedColor(){return n(Rc)},get position(){return n(le)},$$events:{colorChange:b=>{_.length>0&&(_[0].color=b.detail.rgba||b.detail.color)}}});var Kn=p(Tl,2),li=Qe(()=>{var b;return((b=n(ri)[n(ot)])==null?void 0:b.color)||"#2563eb"});Aa(Kn,{get show(){return n(vt)},set show(b){x(vt,D(b))},get selectedColor(){return n(li)},get position(){return n(Je)},$$events:{colorChange:b=>{n(ri)[n(ot)]&&(n(ri)[n(ot)].color=b.detail.rgba||b.detail.color,Yl())}}});var bo=p(Kn,2),$e=Qe(()=>{var b;return((b=_[0])==null?void 0:b.color)||"#2563eb"});Aa(bo,{get show(){return n(ye)},set show(b){x(ye,D(b))},get selectedColor(){return n($e)},get position(){return n(Ce)},$$events:{colorChange:b=>{_.length>0&&(_[0].color=b.detail.rgba||b.detail.color)}}});var Vo=p(bo,2),ro=Qe(()=>{var b;return((b=_[0])==null?void 0:b.color)||"#2563eb"});Aa(Vo,{get show(){return n(nt)},set show(b){x(nt,D(b))},get selectedColor(){return n(ro)},get position(){return n(tt)},$$events:{colorChange:b=>{_.length>0&&(_[0].color=b.detail.rgba||b.detail.color)}}});var hn=p(Vo,2),qn=Qe(()=>{var b,w,L,A,E,R,G,_e,Be;return n(ce)==="histogram"?((L=(w=(b=n(Ze)[n(pt)])==null?void 0:b.styles)==null?void 0:w.histogram)==null?void 0:L.upColor)||"#26a69a":n(ce)==="histogram-down"?((R=(E=(A=n(Ze)[n(pt)])==null?void 0:A.styles)==null?void 0:E.histogram)==null?void 0:R.downColor)||"#ef5350":((Be=(_e=(G=n(Ze)[n(pt)])==null?void 0:G.styles)==null?void 0:_e.ema)==null?void 0:Be.color)||"#2563eb"}),Fn=Qe(()=>n(ce)==="histogram"||n(ce)==="histogram-down"?70:100);Aa(hn,{get show(){return n(ct)},set show(b){x(ct,D(b))},get selectedColor(){return n(qn)},get opacity(){return n(Fn)},get position(){return n(Ge)},$$events:{colorChange:b=>{n(Ze).length>n(pt)&&(n(ce)==="histogram"?n(Ze)[n(pt)].styles.histogram.upColor=b.detail.rgba||b.detail.color:n(ce)==="histogram-down"?n(Ze)[n(pt)].styles.histogram.downColor=b.detail.rgba||b.detail.color:n(ce)==="ema"&&(n(Ze)[n(pt)].styles.ema.color=b.detail.rgba||b.detail.color),Od(n(pt)))}}});var Qi=p(hn,2),Di=Qe(()=>{var b,w,L;return((L=(w=(b=n(Et)[n(wt)])==null?void 0:b.styles)==null?void 0:w.wr)==null?void 0:L.color)||"#2563eb"});Aa(Qi,{get show(){return n(we)},set show(b){x(we,D(b))},get selectedColor(){return n(Di)},get position(){return n(ze)},$$events:{colorChange:b=>{n(Et).length>n(wt)&&n(Et)[n(wt)].styles.wr&&(n(Et)[n(wt)].styles.wr.color=b.detail.rgba||b.detail.color,sr(n(wt)))}}});var Oa=p(Qi,2),Lc=Qe(()=>{var b,w,L;return((L=(w=(b=n(Et)[n(wt)])==null?void 0:b.styles)==null?void 0:w.overbought)==null?void 0:L.color)||"#FF4444"});Aa(Oa,{get show(){return n(dt)},set show(b){x(dt,D(b))},get selectedColor(){return n(Lc)},get position(){return n(qe)},$$events:{colorChange:b=>{n(Et).length>n(wt)&&n(Et)[n(wt)].styles.overbought&&(n(Et)[n(wt)].styles.overbought.color=b.detail.rgba||b.detail.color,sr(n(wt)))}}});var au=p(Oa,2),yu=Qe(()=>{var b,w,L;return((L=(w=(b=n(Et)[n(wt)])==null?void 0:b.styles)==null?void 0:w.oversold)==null?void 0:L.color)||"#00C851"});Aa(au,{get show(){return n(me)},set show(b){x(me,D(b))},get selectedColor(){return n(yu)},get position(){return n(Q)},$$events:{colorChange:b=>{n(Et).length>n(wt)&&n(Et)[n(wt)].styles.oversold&&(n(Et)[n(wt)].styles.oversold.color=b.detail.rgba||b.detail.color,sr(n(wt)))}}});var xp=p(au,2),Wu=Qe(()=>{var b,w,L;return((L=(w=(b=n(Et)[n(wt)])==null?void 0:b.styles)==null?void 0:w.middleLine)==null?void 0:L.color)||"#808080"});Aa(xp,{get show(){return n(it)},set show(b){x(it,D(b))},get selectedColor(){return n(Wu)},get position(){return n(Vt)},$$events:{colorChange:b=>{n(Et).length>n(wt)&&n(Et)[n(wt)].styles.middleLine&&(n(Et)[n(wt)].styles.middleLine.color=b.detail.rgba||b.detail.color,sr(n(wt)))}}});var Xu=p(xp,2),Vf=Qe(()=>{var b,w,L;return((L=(w=(b=n(Ut)[n(Gt)])==null?void 0:b.styles)==null?void 0:w[n(no)])==null?void 0:L.color)||"#2563eb"});Aa(Xu,{get show(){return n(Yt)},set show(b){x(Yt,D(b))},get selectedColor(){return n(Vf)},get position(){return n(At)},$$events:{colorChange:b=>{n(Ut).length>n(Gt)&&n(Ut)[n(Gt)].styles[n(no)]&&(n(Ut)[n(Gt)].styles[n(no)].color=b.detail.rgba||b.detail.color,Bd(n(Gt)))}}});var Zv=p(Xu,2),Wf=Qe(()=>{var b,w,L;return((L=(w=(b=n(an)[n(bs)])==null?void 0:b.styles)==null?void 0:w.roc)==null?void 0:L.color)||"#2563eb"});Aa(Zv,{get show(){return n(Do)},set show(b){x(Do,D(b))},get selectedColor(){return n(Wf)},get position(){return n(Eo)},$$events:{colorChange:b=>{n(an).length>n(bs)&&(n(an)[n(bs)].styles.roc.color=b.detail.rgba||b.detail.color,ai(n(bs)))}}});var Om=p(Zv,2),jh=Qe(()=>{var b,w,L,A,E,R;return n(Ks)%2===0?((L=(w=(b=n(ps)[Math.floor(n(Ks)/2)])==null?void 0:b.styles)==null?void 0:w.psy)==null?void 0:L.color)||"#2563eb":((R=(E=(A=n(ps)[Math.floor(n(Ks)/2)])==null?void 0:A.styles)==null?void 0:E.mapsy)==null?void 0:R.color)||"#dc2626"});Aa(Om,{get show(){return n(Is)},set show(b){x(Is,D(b))},get selectedColor(){return n(jh)},get position(){return n(qi)},$$events:{colorChange:b=>{const w=Math.floor(n(Ks)/2);n(ps).length>w&&(n(Ks)%2===0?(n(ps)[w].styles.psy.color=b.detail.rgba||b.detail.color,console.log("🎨 Updated PSY color to:",b.detail.color)):(n(ps)[w].styles.mapsy.color=b.detail.rgba||b.detail.color,console.log("🎨 Updated MAPSY color to:",b.detail.color)),Dr(w))}}});var H0=p(Om,2),G0=Qe(()=>{var b,w,L,A,E,R;return n(es)%2===0?((L=(w=(b=n(_s)[Math.floor(n(es)/2)])==null?void 0:b.styles)==null?void 0:w.obv)==null?void 0:L.color)||"#FF6B35":((R=(E=(A=n(_s)[Math.floor(n(es)/2)])==null?void 0:A.styles)==null?void 0:E.maobv)==null?void 0:R.color)||"#2196F3"});Aa(H0,{get show(){return n(ws)},set show(b){x(ws,D(b))},get selectedColor(){return n(G0)},get position(){return n(vn)},$$events:{colorChange:b=>{const w=Math.floor(n(es)/2);n(_s).length>w&&(n(es)%2===0?(n(_s)[w].styles.obv.color=b.detail.rgba||b.detail.color,console.log("🎨 Updated OBV color to:",b.detail.color)):(n(_s)[w].styles.maobv.color=b.detail.rgba||b.detail.color,console.log("🎨 Updated MAOBV color to:",b.detail.color)),Vd())}}});var Vm=p(H0,2),Rh=Qe(()=>{var b;return((b=n(ts)[n(Oo)])==null?void 0:b.styles.color)||"#2962FF"});Aa(Vm,{get show(){return n(Li)},set show(b){x(Li,D(b))},get selectedColor(){return n(Rh)},get position(){return n(ci)},$$events:{colorChange:b=>{n(ts).length>n(Oo)&&(n(ts)[n(Oo)].styles.color=b.detail.rgba||b.detail.color,Cs())}}});var mm=p(Vm,2),U0=Qe(()=>{var b;return((b=n($i)[n(Xi)])==null?void 0:b.color)||"#FF6B35"});Aa(mm,{get show(){return n(oa)},set show(b){x(oa,D(b))},get selectedColor(){return n(U0)},get position(){return n(ol)},$$events:{colorChange:b=>{n($i).length>n(Xi)&&(n($i)[n(Xi)].color=b.detail.rgba||b.detail.color,console.log("🎨 Updated PVT color to:",b.detail.color),Ps(n(Xi)))}}});var qf=p(mm,2),Wm=Qe(()=>{var b;return((b=n(Rn)[n(ml)])==null?void 0:b.color)||"#2563eb"});Aa(qf,{get show(){return n(fc)},set show(b){x(fc,D(b))},get selectedColor(){return n(Wm)},get position(){return n(rd)},$$events:{colorChange:b=>{n(Rn).length>n(ml)&&(n(Rn)[n(ml)].color=b.detail.rgba||b.detail.color)}}});var qm=p(qf,2),Y0=Qe(()=>{var b;return((b=n(jo)[n(Ec)])==null?void 0:b.color)||"#2563eb"});Aa(qm,{get show(){return n(Nl)},set show(b){x(Nl,D(b))},get selectedColor(){return n(Y0)},get position(){return n(Yc)},$$events:{colorChange:b=>{n(jo).length>n(Ec)&&(n(jo)[n(Ec)].color=b.detail.rgba||b.detail.color,ur())}}});var em=p(qm,2),K0=Qe(()=>{var b,w;return((w=(b=n(Xc)[n(Mo)])==null?void 0:b.styles[n(eo)])==null?void 0:w.color)||"#2563eb"});Aa(em,{get show(){return n(Ja)},set show(b){x(Ja,D(b))},get selectedColor(){return n(K0)},get position(){return n(sa)},$$events:{colorChange:b=>{const w=n(Xc)[n(Mo)];w&&w.styles&&w.styles.length>n(eo)&&(w.styles[n(eo)].color=b.detail.rgba||b.detail.color,Zu(n(Mo)))}}});var Zp=p(em,2),_f=Qe(()=>{var b;return((b=_[0])==null?void 0:b.color)||"#2563eb"});Aa(Zp,{get show(){return n(jl)},set show(b){x(jl,D(b))},get selectedColor(){return n(_f)},get position(){return n(Td)},$$events:{colorChange:b=>{_.length>0&&(_[0].color=b.detail.rgba||b.detail.color)}}});var Z0=p(Zp,2),X0=Qe(()=>{var b,w,L,A,E,R;return n(qa)%2===0?((L=(w=(b=n(wo)[Math.floor(n(qa)/2)])==null?void 0:b.styles)==null?void 0:w.increasing)==null?void 0:L.color)||"#00C851":((R=(E=(A=n(wo)[Math.floor(n(qa)/2)])==null?void 0:A.styles)==null?void 0:E.decreasing)==null?void 0:R.color)||"#FF4444"});Aa(Z0,{get show(){return n(_d)},set show(b){x(_d,D(b))},get selectedColor(){return n(X0)},get position(){return n(Fl)},$$events:{colorChange:b=>{const w=Math.floor(n(qa)/2);n(wo)[w]&&(n(qa)%2===0?n(wo)[w].styles.increasing.color=b.detail.rgba||b.detail.color:n(wo)[w].styles.decreasing.color=b.detail.rgba||b.detail.color,_p())}}});var J0=p(Z0,2),Bh=Qe(()=>{var b,w,L;return((L=(w=(b=n(Pn)[n(J)])==null?void 0:b.styles)==null?void 0:w[n(se)])==null?void 0:L.color)||"#2563eb"});Aa(J0,{get show(){return n(oe)},set show(b){x(oe,D(b))},get selectedColor(){return n(Bh)},get position(){return n(U)},$$events:{colorChange:b=>{n(Pn).length>n(J)&&n(Pn)[n(J)].styles[n(se)]&&(n(Pn)[n(J)].styles[n(se)].color=b.detail.rgba||b.detail.color,bn())}}});var Q0=p(J0,2),Oh=Qe(()=>{var b,w,L;return((L=(w=(b=n(wo)[0])==null?void 0:b.styles)==null?void 0:w.increasing)==null?void 0:L.color)||"#16a34a"});Aa(Q0,{get show(){return n(Lt)},set show(b){x(Lt,D(b))},get selectedColor(){return n(Oh)},get position(){return n(Mt)},$$events:{colorChange:b=>{n(wo).length>0&&(n(wo)[0].styles.increasing.color=b.detail.rgba||b.detail.color)}}});var eg=p(Q0,2),Vh=Qe(()=>{var b,w,L;return((L=(w=(b=n(wo)[0])==null?void 0:b.styles)==null?void 0:w.decreasing)==null?void 0:L.color)||"#dc2626"});Aa(eg,{get show(){return n(Io)},set show(b){x(Io,D(b))},get selectedColor(){return n(Vh)},get position(){return n(Bo)},$$events:{colorChange:b=>{n(wo).length>0&&(n(wo)[0].styles.decreasing.color=b.detail.rgba||b.detail.color)}}});var tg=p(eg,2),Wh=Qe(()=>{var b;return((b=_[0])==null?void 0:b.color)||"#2563eb"});Aa(tg,{get show(){return n(hs)},set show(b){x(hs,D(b))},get selectedColor(){return n(Wh)},get position(){return is},$$events:{colorChange:b=>{_.length>0&&(_[0].color=b.detail.rgba||b.detail.color)}}});var og=p(tg,2),qh=Qe(()=>{var b;return((b=_[1])==null?void 0:b.color)||"#dc2626"});Aa(og,{get show(){return n(Es)},set show(b){x(Es,D(b))},get selectedColor(){return n(qh)},get position(){return bt},$$events:{colorChange:b=>{_.length>1&&(_[1].color=b.detail.rgba||b.detail.color)}}});var sg=p(og,2),ng=Qe(()=>{var b;return((b=_[2])==null?void 0:b.color)||"#16a34a"});Aa(sg,{get show(){return n(kt)},set show(b){x(kt,D(b))},get selectedColor(){return n(ng)},get position(){return n(xo)},$$events:{colorChange:b=>{_.length>2&&(_[2].color=b.detail.rgba||b.detail.color)}}});var Hm=p(sg,2);Aa(Hm,{get show(){return n($t)},set show(b){x($t,D(b))},get selectedColor(){return n(S)},get position(){return n(_o)},$$events:{colorChange:b=>{x(S,D(b.detail.rgba||b.detail.color))}}});var Gm=p(Hm,2);Aa(Gm,{get show(){return n(go)},set show(b){x(go,D(b))},get selectedColor(){return n(I)},get position(){return n(fs)},$$events:{colorChange:b=>{x(I,D(b.detail.rgba||b.detail.color))}}});var ig=p(Gm,2);Aa(ig,{get show(){return n(Ms)},set show(b){x(Ms,D(b))},get selectedColor(){return n(C)},get position(){return n(zn)},$$events:{colorChange:b=>{x(C,D(b.detail.rgba||b.detail.color))}}});var rg=p(ig,2);Aa(rg,{get show(){return n(qs)},set show(b){x(qs,D(b))},get selectedColor(){return n(T)},get position(){return n(Vn)},$$events:{colorChange:b=>{x(T,D(b.detail.rgba||b.detail.color))}}});var ag=p(rg,2),lg=Qe(()=>{var b;return((b=_[n(Xe)])==null?void 0:b.color)||"#2563eb"});Aa(ag,{get show(){return n(Fe)},set show(b){x(Fe,D(b))},get selectedColor(){return n(lg)},get position(){return n(ut)},$$events:{colorChange:b=>{_.length>n(Xe)&&(_[n(Xe)].color=b.detail.rgba||b.detail.color,Ca())}}});var cg=p(ag,2),Hh=Qe(()=>{var b;return((b=n(ls)[n(It)])==null?void 0:b.color)||"#FF6C37"});Aa(cg,{get show(){return n(ht)},set show(b){x(ht,D(b))},get selectedColor(){return n(Hh)},get position(){return n(ao)},$$events:{colorChange:b=>{n(ls).length>n(It)&&(n(ls)[n(It)].color=b.detail.rgba||b.detail.color,ru(n(It)))}}});var dg=p(cg,2),Gh=Qe(()=>{var b;return((b=_[n(ds)])==null?void 0:b.color)||"#2563eb"});Aa(dg,{get show(){return n(ho)},set show(b){x(ho,D(b))},get selectedColor(){return n(Gh)},get position(){return n(to)},$$events:{colorChange:b=>{_.length>n(ds)&&(_[n(ds)].color=b.detail.rgba||b.detail.color,Ad())}}});var ug=p(dg,2),Uh=Qe(()=>{var b;return((b=n(xt)[n($r)])==null?void 0:b.color)||"#2563eb"});Aa(ug,{get show(){return n(js)},set show(b){x(js,D(b))},get selectedColor(){return n(Uh)},get position(){return n(Si)},$$events:{colorChange:b=>{n(xt).length>n($r)&&(n(xt)[n($r)].color=b.detail.rgba||b.detail.color,sd(n($r)))}}});var Tp=p(ug,2),Yh=Qe(()=>(()=>{const b=Math.floor(n(st)/3),w=n(st)%3,L=n(fn)[b];if(!L)return"#2563eb";switch(w){case 0:return L.styles.k.color;case 1:return L.styles.d.color;case 2:return L.styles.j.color;default:return"#2563eb"}})());Aa(Tp,{get show(){return n(Re)},set show(b){x(Re,D(b))},get selectedColor(){return n(Yh)},get position(){return n(Ke)},$$events:{colorChange:b=>{const w=Math.floor(n(st)/3),L=n(st)%3,A=n(fn)[w];if(console.log("🎨 KDJ Color change:",{groupIndex:w,lineIndex:L,newColor:b.detail.color,group:A}),A){switch(L){case 0:A.styles.k.color=b.detail.rgba||b.detail.color,console.log("🎨 Updated K color to:",b.detail.color);break;case 1:A.styles.d.color=b.detail.rgba||b.detail.color,console.log("🎨 Updated D color to:",b.detail.color);break;case 2:A.styles.j.color=b.detail.rgba||b.detail.color,console.log("🎨 Updated J color to:",b.detail.color);break}console.log("🎨 Updated KDJ group:",A),zu(w)}}}});var pg=p(Tp,2),Kh=Qe(()=>(()=>{const b=n(pi)[n(be)];if(!b)return"#2563eb";switch(n(We)){case"cr":return b.styles.cr.color;case"ma1":return b.styles.ma1.color;case"ma2":return b.styles.ma2.color;case"ma3":return b.styles.ma3.color;case"ma4":return b.styles.ma4.color;default:return"#2563eb"}})());Aa(pg,{get show(){return n(td)},set show(b){x(td,D(b))},get selectedColor(){return n(Kh)},get position(){return n(Nc)},$$events:{colorChange:b=>{const w=n(pi)[n(be)];if(w){switch(n(We)){case"cr":w.styles.cr.color=b.detail.rgba||b.detail.color;break;case"ma1":w.styles.ma1.color=b.detail.rgba||b.detail.color;break;case"ma2":w.styles.ma2.color=b.detail.rgba||b.detail.color;break;case"ma3":w.styles.ma3.color=b.detail.rgba||b.detail.color;break;case"ma4":w.styles.ma4.color=b.detail.rgba||b.detail.color;break}qo()}}}});var Um=p(pg,2),Zh=Qe(()=>{var b,w,L;return((L=(w=(b=n(et)[n(za)])==null?void 0:b.styles)==null?void 0:w.rsi)==null?void 0:L.color)||"#8B5CF6"});Aa(Um,{get show(){return n(pa)},set show(b){x(pa,D(b))},get selectedColor(){return n(Zh)},get position(){return n(En)},$$events:{colorChange:b=>{n(et).length>n(za)&&(n(et)[n(za)].styles.rsi.color=b.detail.rgba||b.detail.color,nc(n(za)))}}});var vg=p(Um,2),Xh=Qe(()=>{var b,w;return((w=(b=n(et)[n(jt)])==null?void 0:b.styles)==null?void 0:w.overboughtColor)||"#EF4444"});Aa(vg,{get show(){return n(de)},set show(b){x(de,D(b))},get selectedColor(){return n(Xh)},get position(){return n(De)},$$events:{colorChange:b=>{if(n(et).length>n(jt)){const w=b.detail.rgba||b.detail.color;n(et)[n(jt)].styles.overboughtColor=w,x(et,D([...n(et)])),nc(n(jt))}}}});var fg=p(vg,2),Ym=Qe(()=>{var b,w;return((w=(b=n(et)[n(jt)])==null?void 0:b.styles)==null?void 0:w.oversoldColor)||"#22C55E"});Aa(fg,{get show(){return n(Ee)},set show(b){x(Ee,D(b))},get selectedColor(){return n(Ym)},get position(){return n(xe)},$$events:{colorChange:b=>{if(n(et).length>n(jt)){const w=b.detail.rgba||b.detail.color;n(et)[n(jt)].styles.oversoldColor=w,x(et,D([...n(et)])),nc(n(jt))}}}});var mg=p(fg,2),Jh=Qe(()=>{var b,w;return((w=(b=n(et)[n(jt)])==null?void 0:b.styles)==null?void 0:w.middleLineColor)||"#6B7280"});Aa(mg,{get show(){return n(gt)},set show(b){x(gt,D(b))},get selectedColor(){return n(Jh)},get position(){return n(at)},$$events:{colorChange:b=>{if(n(et).length>n(jt)){const w=b.detail.rgba||b.detail.color;n(et)[n(jt)].styles.middleLineColor=w,x(et,D([...n(et)])),nc(n(jt))}}}});var gg=p(mg,2),Qh=Qe(()=>{var b,w,L;return((L=(w=(b=n(Ao)[n(Qt)])==null?void 0:b.styles)==null?void 0:w.kLine)==null?void 0:L.color)||"#2962FF"});Aa(gg,{get show(){return n(Rs)},set show(b){x(Rs,D(b))},get selectedColor(){return n(Qh)},get position(){return n(Ko)},$$events:{colorChange:b=>{n(Ao).length>n(Qt)&&(n(Ao)[n(Qt)].styles.kLine.color=b.detail.rgba||b.detail.color,kl(n(Qt)))}}});var hg=p(gg,2),e_=Qe(()=>{var b,w,L;return((L=(w=(b=n(Ao)[n(Qt)])==null?void 0:b.styles)==null?void 0:w.dLine)==null?void 0:L.color)||"#FF6D00"});Aa(hg,{get show(){return n(Zs)},set show(b){x(Zs,D(b))},get selectedColor(){return n(e_)},get position(){return n(Ko)},$$events:{colorChange:b=>{n(Ao).length>n(Qt)&&(n(Ao)[n(Qt)].styles.dLine.color=b.detail.rgba||b.detail.color,kl(n(Qt)))}}});var _g=p(hg,2),t_=Qe(()=>{var b,w;return((w=(b=n(Ao)[n(Qt)])==null?void 0:b.styles)==null?void 0:w.overboughtColor)||"#EF4444"});Aa(_g,{get show(){return n(gn)},set show(b){x(gn,D(b))},get selectedColor(){return n(t_)},get position(){return n(Ko)},$$events:{colorChange:b=>{n(Ao).length>n(Qt)&&(n(Ao)[n(Qt)].styles.overboughtColor=b.detail.rgba||b.detail.color,kl(n(Qt)))}}});var yg=p(_g,2),o_=Qe(()=>{var b,w;return((w=(b=n(Ao)[n(Qt)])==null?void 0:b.styles)==null?void 0:w.oversoldColor)||"#10B981"});Aa(yg,{get show(){return n(Wn)},set show(b){x(Wn,D(b))},get selectedColor(){return n(o_)},get position(){return n(Ko)},$$events:{colorChange:b=>{n(Ao).length>n(Qt)&&(n(Ao)[n(Qt)].styles.oversoldColor=b.detail.rgba||b.detail.color,kl(n(Qt)))}}});var s_=p(yg,2),n_=Qe(()=>{var b,w;return((w=(b=n(Ao)[n(Qt)])==null?void 0:b.styles)==null?void 0:w.midLineColor)||"#6B7280"});return Aa(s_,{get show(){return n(Tn)},set show(b){x(Tn,D(b))},get selectedColor(){return n(n_)},get position(){return n(Ko)},$$events:{colorChange:b=>{n(Ao).length>n(Qt)&&(n(Ao)[n(Qt)].styles.midLineColor=b.detail.rgba||b.detail.color,kl(n(Qt)))}}}),O(o,yo),Tc({clearCciGroups:dr,clearEmvGroups:Fa,clearMtmGroups:ka,clearObvGroups:va,clearPsyGroups:wc,clearPvtGroups:mr,clearVolGroups:ad,clearWrGroups:Gd,clearRocGroups:ha,clearRsiGroups:As,clearStochasticGroups:ln})}Hd(["click","change","input"]);function KE(o,e,t){const s=o.target;x(e,parseInt(s.value)),t()}function ZE(o,e){o.target===o.currentTarget&&e(!1)}var XE=o=>o.stopPropagation(),JE=(o,e)=>e(!1),QE=(o,e)=>e("linear"),eN=(o,e)=>e("radial"),tN=(o,e,t)=>e(n(t).angle),oN=re('<button class="w-8 h-8 text-sm rounded border transition-colors flex items-center justify-center"> </button>'),sN=re('<div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Direction</label> <div class="grid grid-cols-4 gap-1 mb-3"></div> <div class="relative"><input type="range" min="0" max="360" class="w-full h-2 rounded appearance-none cursor-pointer bg-[#404040] svelte-e3zmk9"> <div class="flex justify-between text-xs text-gray-500 mt-1"><span>0°</span> <span class="text-gray-300"> </span> <span>360°</span></div></div></div>'),nN=re('<button class="absolute -top-2 -right-1 w-3 h-3 bg-red-500 text-white text-xs rounded-full flex items-center justify-center hover:bg-red-600 transition-colors">×</button>'),iN=re('<div class="absolute top-0 w-4 h-6 border-2 rounded cursor-grab transform -translate-x-1/2"><!></div>'),rN=re('<button class="mt-2 w-full py-1 text-xs text-gray-400 border border-dashed border-gray-600 rounded hover:border-gray-400 hover:text-gray-300 transition-colors">+ Add Color Stop</button>'),aN=(o,e,t)=>e(n(t),parseInt(o.currentTarget.value)),lN=(o,e,t)=>e(o,n(t)),cN=(o,e,t)=>e(n(t),o.currentTarget.value),dN=(o,e,t)=>e(n(t),parseInt(o.currentTarget.value)),uN=re('<div class="mb-4 p-3 bg-[#1A1A1A] rounded border border-[#404040]"><h4 class="text-xs font-medium text-gray-300 mb-3"> </h4> <div class="mb-3"><label class="block text-xs text-gray-400 mb-1">Position</label> <div class="flex items-center gap-2"><input type="range" min="0" max="100" class="flex-1 h-2 rounded appearance-none cursor-pointer bg-[#404040] svelte-e3zmk9"> <span class="text-xs text-gray-300 w-8"> </span></div></div> <div class="mb-3"><label class="block text-xs text-gray-400 mb-1">Color</label> <div class="flex items-center gap-2"><button class="w-8 h-8 rounded border-2 border-[#404040] cursor-pointer hover:border-gray-300 transition-colors"></button> <input type="text" class="flex-1 px-2 py-1 bg-[#404040] border border-[#555] rounded text-white text-xs focus:border-blue-500 focus:outline-none" placeholder="#000000"></div></div> <div><label class="block text-xs text-gray-400 mb-1">Opacity</label> <div class="flex items-center gap-2"><input type="range" min="0" max="100" class="flex-1 h-2 rounded appearance-none cursor-pointer bg-[#404040] svelte-e3zmk9"> <span class="text-xs text-gray-300 w-8"> </span></div></div></div>'),pN=re('<div class="fixed inset-0 z-[70] flex items-center justify-center p-4"><div class="gradient-editor-container bg-[#2A2A2A] border border-[#404040] rounded-lg shadow-xl w-full max-w-sm max-h-[90vh] overflow-y-auto svelte-e3zmk9"><div class="p-4"><div class="mb-4"><div class="flex items-center justify-between mb-3"><h3 class="text-sm font-semibold text-white">Gradient Editor</h3> <button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">OK</button></div> <div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Gradient Type</label> <div class="flex gap-2"><button class="flex-1 px-3 py-2 text-xs rounded transition-colors">Linear</button> <button class="flex-1 px-3 py-2 text-xs rounded transition-colors">Radial</button></div></div> <!> <div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Preview</label> <div class="w-full h-12 rounded border border-[#404040]"></div></div> <div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Color Stops</label> <div class="relative"><div class="relative w-full h-6 rounded border border-[#404040] cursor-pointer"></div> <!></div></div> <!></div></div></div></div>'),vN=re("<!> <!>",1);function t2(o,e){Mc(e,!1);const t=sp();let s=Qs(e,"show",12,!1),i=Qs(e,"initialGradient",24,()=>({type:"linear",direction:0,stops:[{position:0,color:"#ffffff",opacity:100},{position:100,color:"#000000",opacity:100}]})),r=nd(),a=nd(),l=!1,c=-1,d=nd(!1),v=nd(0),g=nd(i().type),_=nd(i().direction),y=nd([...i().stops]);const k=[{angle:0,label:"→",title:"Left to Right"},{angle:45,label:"↗",title:"Bottom-Left to Top-Right"},{angle:90,label:"↑",title:"Bottom to Top"},{angle:135,label:"↖",title:"Bottom-Right to Top-Left"},{angle:180,label:"←",title:"Right to Left"},{angle:225,label:"↙",title:"Top-Right to Bottom-Left"},{angle:270,label:"↓",title:"Top to Bottom"},{angle:315,label:"↘",title:"Top-Left to Bottom-Right"}];function S(){const W=[...n(y)].sort((le,ye)=>le.position-ye.position).map(le=>`${M(le.color,le.opacity/100)} ${le.position}%`);return n(g)==="linear"?`linear-gradient(${n(_)}deg, ${W.join(", ")})`:`radial-gradient(circle, ${W.join(", ")})`}function M(se,W){const le=parseInt(se.slice(1,3),16),ye=parseInt(se.slice(3,5),16),Ce=parseInt(se.slice(5,7),16);return`rgba(${le}, ${ye}, ${Ce}, ${W})`}function I(se){x(g,se),te()}function C(se){x(_,se),te()}function T(){if(n(y).length>=5)return;const se=[...n(y)].sort((Re,Ke)=>Re.position-Ke.position);let W=50,le=0,ye=50;for(let Re=0;Re<se.length-1;(Re+=1)-1){const Ke=se[Re+1].position-se[Re].position;Ke>le&&(le=Ke,ye=se[Re].position+Ke/2)}le>10&&(W=ye);const Ce={position:W,color:"#808080",opacity:100};x(y,[...n(y),Ce]),x(v,n(y).length-1),te()}function z(se){n(y).length<=2||(x(y,n(y).filter((W,le)=>le!==se)),n(v)>=n(y).length&&x(v,n(y).length-1),te())}function j(se,W){kf(y,n(y)[se].position=Math.max(0,Math.min(100,W))),te()}function B(se,W){kf(y,n(y)[se].color=W),te()}function $(se,W){kf(y,n(y)[se].opacity=Math.max(0,Math.min(100,W))),te()}function F(se,W){const le=se.target.getBoundingClientRect();le.right+10,le.top,x(v,W),x(d,!0)}function V(se){n(v)>=0&&n(v)<n(y).length&&(kf(y,n(y)[n(v)].color=se.detail),te())}function K(se){n(v)>=0&&n(v)<n(y).length&&(kf(y,n(y)[n(v)].opacity=se.detail),te())}function Y(se){if(!n(a))return;const W=n(a).getBoundingClientRect(),le=se.clientX-W.left,ye=le/W.width*100;let Ce=-1;const Re=8;if(n(y).forEach((Ke,st)=>{const vt=Ke.position/100*W.width;Math.abs(le-vt)<=Re&&(Ce=st)}),Ce>=0)l=!0,c=Ce,x(v,Ce);else if(n(y).length<5){const Ke={position:Math.max(0,Math.min(100,ye)),color:"#808080",opacity:100};x(y,[...n(y),Ke]),x(v,n(y).length-1),te()}}function Z(se){if(!l||c<0||!n(a))return;const W=n(a).getBoundingClientRect(),le=se.clientX-W.left,ye=Math.max(0,Math.min(100,le/W.width*100));kf(y,n(y)[c].position=ye),te()}function ne(){l=!1,c=-1}function te(){const se={type:n(g),direction:n(_),stops:[...n(y)],css:S()};t("gradientChange",se)}rf(()=>{typeof document<"u"&&(document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",ne))}),hp(()=>{te()}),Fp(()=>wp(s()),()=>{s()&&typeof document<"u"&&setTimeout(()=>{document.addEventListener("mousemove",Z),document.addEventListener("mouseup",ne)},0)}),Fp(()=>wp(s()),()=>{!s()&&typeof document<"u"&&(document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",ne))}),fm(),Sp();var oe=vN(),U=Rt(oe);Te(U,s,se=>{var W=pN();W.__click=[ZE,s];var le=m(W);le.__click=[XE];var ye=m(le),Ce=m(ye),Re=m(Ce),Ke=p(m(Re),2);Ke.__click=[JE,s],f(Re);var st=p(Re,2),vt=p(m(st),2),Je=m(vt);Je.__click=[QE,I];var ot=p(Je,2);ot.__click=[eN,I],f(vt),f(st);var nt=p(st,2);Te(nt,()=>n(g)==="linear",qe=>{var me=sN(),Q=p(m(me),2);Vs(Q,5,()=>k,_n,(Gt,no)=>{var Do=oN();Do.__click=[tN,C,no];var Eo=m(Do,!0);f(Do),Se(()=>{Nt(Do,"title",n(no).title),ii(Do,"border-blue-500",n(_)===n(no).angle),ii(Do,"bg-blue-600",n(_)===n(no).angle),ii(Do,"text-white",n(_)===n(no).angle),ii(Do,"border-[#404040]",n(_)!==n(no).angle),ii(Do,"text-gray-300",n(_)!==n(no).angle),Ve(Eo,n(no).label)}),O(Gt,Do)}),f(Q);var it=p(Q,2),Vt=m(it);Jt(Vt),Vt.__input=[KE,_,te];var wt=p(Vt,2),Yt=p(m(wt),2),At=m(Yt);f(Yt),pn(2),f(wt),f(it),f(me),Se(()=>Ve(At,`${n(_)??""}°`)),Ho(Vt,()=>n(_),Gt=>x(_,Gt)),O(qe,me)});var tt=p(nt,2),Ze=p(m(tt),2);const ct=kp(()=>`background: ${S()??""};`);f(tt);var Ge=p(tt,2),pt=p(m(Ge),2),ce=m(pt);const we=kp(()=>`background: ${S()??""};`);ce.__mousedown=Y,Vs(ce,5,()=>n(y),_n,(qe,me,Q)=>{var it=iN();it.__click=wt=>{wt.stopPropagation(),x(v,Q)};var Vt=m(it);Te(Vt,()=>n(y).length>2,wt=>{var Yt=nN();Yt.__click=At=>{At.stopPropagation(),z(Q)},O(wt,Yt)}),f(it),Se(()=>{Nt(it,"style",`left: ${n(me).position??""}%; background-color: ${n(me).color??""};`),ii(it,"border-white",Q===n(v)),ii(it,"border-gray-500",Q!==n(v))}),O(qe,it)}),f(ce),du(ce,qe=>x(a,qe),()=>n(a));var ze=p(ce,2);Te(ze,()=>n(y).length<5,qe=>{var me=rN();me.__click=T,O(qe,me)}),f(pt),f(Ge);var dt=p(Ge,2);Te(dt,()=>n(v)>=0&&n(v)<n(y).length,qe=>{var me=uN(),Q=m(me),it=m(Q);f(Q);var Vt=p(Q,2),wt=p(m(Vt),2),Yt=m(wt);Jt(Yt),Yt.__input=[aN,j,v];var At=p(Yt,2),Gt=m(At);f(At),f(wt),f(Vt);var no=p(Vt,2),Do=p(m(no),2),Eo=m(Do);Eo.__click=[lN,F,v];var bs=p(Eo,2);Jt(bs),bs.__input=[cN,B,v],f(Do),f(no);var Is=p(no,2),qi=p(m(Is),2),Ks=m(qi);Jt(Ks),Ks.__input=[dN,$,v];var ws=p(Ks,2),vn=m(ws);f(ws),f(qi),f(Is),f(me),Se(()=>{Ve(it,`Stop ${n(v)+1} Configuration`),Ve(Gt,`${n(y)[n(v)].position??""}%`),Nt(Eo,"style",`background-color: ${n(y)[n(v)].color??""};`),Ve(vn,`${n(y)[n(v)].opacity??""}%`)}),Ho(Yt,()=>n(y)[n(v)].position,es=>kf(y,n(y)[n(v)].position=es)),Ho(bs,()=>n(y)[n(v)].color,es=>kf(y,n(y)[n(v)].color=es)),Ho(Ks,()=>n(y)[n(v)].opacity,es=>kf(y,n(y)[n(v)].opacity=es)),O(qe,me)}),f(Ce),f(ye),f(le),du(le,qe=>x(r,qe),()=>n(r)),f(W),Se(()=>{ii(Je,"bg-blue-600",n(g)==="linear"),ii(Je,"text-white",n(g)==="linear"),ii(Je,"bg-[#404040]",n(g)!=="linear"),ii(Je,"text-gray-300",n(g)!=="linear"),ii(ot,"bg-blue-600",n(g)==="radial"),ii(ot,"text-white",n(g)==="radial"),ii(ot,"bg-[#404040]",n(g)!=="radial"),ii(ot,"text-gray-300",n(g)!=="radial"),Nt(Ze,"style",n(ct)),Nt(ce,"style",n(we))}),O(se,W)});var J=p(U,2);Te(J,()=>n(d),se=>{var W=kp(()=>{var ye;return((ye=n(y)[n(v)])==null?void 0:ye.color)||"#000000"}),le=kp(()=>{var ye;return((ye=n(y)[n(v)])==null?void 0:ye.opacity)||100});iv(se,{get show(){return n(d)},set show(ye){x(d,ye)},get selectedColor(){return n(W)},get opacity(){return n(le)},$$events:{colorChange:V,opacityChange:K},$$legacy:!0})}),O(o,oe),Tc()}Hd(["click","input","mousedown"]);var sf,nf,Mf,Em,mh;const B1=class B1 extends Map{constructor(t){super();p0(this,Em);p0(this,sf,new Map);p0(this,nf,wm(0));p0(this,Mf,wm(0));if(t){for(var[s,i]of t)super.set(s,i);Pu(this,Mf).v=super.size}}has(t){var s=Pu(this,sf),i=s.get(t);if(i===void 0){var r=super.get(t);if(r!==void 0)i=wm(0),s.set(t,i);else return n(Pu(this,nf)),!1}return n(i),!0}forEach(t,s){Ng(this,Em,mh).call(this),super.forEach(t,s)}get(t){var s=Pu(this,sf),i=s.get(t);if(i===void 0){var r=super.get(t);if(r!==void 0)i=wm(0),s.set(t,i);else{n(Pu(this,nf));return}}return n(i),super.get(t)}set(t,s){var g;var i=Pu(this,sf),r=i.get(t),a=super.get(t),l=super.set(t,s),c=Pu(this,nf);if(r===void 0)i.set(t,wm(0)),x(Pu(this,Mf),super.size),v0(c);else if(a!==s){v0(r);var d=c.reactions===null?null:new Set(c.reactions),v=d===null||!((g=r.reactions)!=null&&g.every(_=>d.has(_)));v&&v0(c)}return l}delete(t){var s=Pu(this,sf),i=s.get(t),r=super.delete(t);return i!==void 0&&(s.delete(t),x(Pu(this,Mf),super.size),x(i,-1),v0(Pu(this,nf))),r}clear(){if(super.size!==0){super.clear();var t=Pu(this,sf);x(Pu(this,Mf),0);for(var s of t.values())x(s,-1);v0(Pu(this,nf)),t.clear()}}keys(){return n(Pu(this,nf)),super.keys()}values(){return Ng(this,Em,mh).call(this),super.values()}entries(){return Ng(this,Em,mh).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return n(Pu(this,Mf)),super.size}};sf=new WeakMap,nf=new WeakMap,Mf=new WeakMap,Em=new WeakSet,mh=function(){n(Pu(this,nf));var t=Pu(this,sf);if(Pu(this,Mf).v!==t.size)for(var s of H1(B1.prototype,this,"keys").call(this))t.has(s)||t.set(s,wm(0));for(var[,i]of Pu(this,sf))n(i)};let j0=B1;function h1(o="dark"){return{version:2,canvas:{background:{mode:"solid",solid:{color:o==="dark"?"#070211":"#ffffff",alpha:1}},grid:{mode:"solid",solid:{color:o==="dark"?"#081115":"#F3F3F3",alpha:1}}}}}function eh(o){return JSON.parse(JSON.stringify(o))}function fN(o,e="dark"){const s={current:h1(e),pending:null,chartId:o};return op(s)}function mN(o,e){if(typeof window>"u"||!window.localStorage)return;const t=`dutyai.chart.theme.${o}`;try{localStorage.setItem(t,JSON.stringify(e)),console.debug("THEME_PERSIST",{chartId:o,settings:e})}catch(s){console.error("Failed to persist theme settings:",s)}}function o2(o,e="dark"){if(typeof window>"u"||!window.localStorage)return h1(e);const t=`dutyai.chart.theme.${o}`;try{const s=localStorage.getItem(t);if(s){const i=JSON.parse(s);if(i.version===2&&i.canvas)return console.debug("THEME_LOAD",{chartId:o,settings:i}),i}}catch(s){console.error("Failed to load persisted theme settings:",s)}return h1(e)}function gN(o){if(!o||!o.stops||o.stops.length===0)return"transparent";const e=o.stops.map(t=>{const s=t.alpha!==void 0?t.alpha:1,i=t.color;if(s!==1&&i.startsWith("#")){const r=parseInt(i.slice(1,3),16),a=parseInt(i.slice(3,5),16),l=parseInt(i.slice(5,7),16);return`rgba(${r}, ${a}, ${l}, ${s}) ${t.offset*100}%`}return`${i} ${t.offset*100}%`}).join(", ");if(o.type==="linear")return`linear-gradient(${o.angle||0}deg, ${e})`;if(o.type==="radial"){const t=o.cx||.5,s=o.cy||.5;return o.r,`radial-gradient(circle at ${t*100}% ${s*100}%, ${e})`}return"transparent"}function H_(o,e=1){if(!o.startsWith("#"))return o;const t=parseInt(o.slice(1,3),16),s=parseInt(o.slice(3,5),16),i=parseInt(o.slice(5,7),16);return`rgba(${t}, ${s}, ${i}, ${e})`}class R1{constructor(e,t,s="dark"){ve(this,"settingsStore");ve(this,"chart");ve(this,"chartId");ve(this,"pendingThemeApplication",null);ve(this,"chartUnsubscribe",null);ve(this,"chartReadinessTimeout",null);ve(this,"applyCanvasColorsFn",null);this.chartId=e,this.chart=t,this.settingsStore=fN(e,s),this.setupChartReadinessMonitoring(),this.loadPersistedSettings(s)}setApplyCanvasColorsFunction(e){this.applyCanvasColorsFn=e,console.log("🎨 Canvas colors function registered with theme manager")}applyCanvasColorsIfAvailable(){this.applyCanvasColorsFn&&(console.log("🎨 Applying canvas colors via theme manager"),this.applyCanvasColorsFn())}getStore(){return this.settingsStore}setupChartReadinessMonitoring(){this.chartUnsubscribe=this.chart.subscribe(e=>{e&&this.pendingThemeApplication&&(console.log("📊 Chart became available, applying pending theme"),this.applyTheme(this.pendingThemeApplication,{preview:!1}),this.pendingThemeApplication=null,this.chartReadinessTimeout&&(clearTimeout(this.chartReadinessTimeout),this.chartReadinessTimeout=null))})}setupChartReadinessTimeout(){this.chartReadinessTimeout&&clearTimeout(this.chartReadinessTimeout),this.chartReadinessTimeout=setTimeout(()=>{this.pendingThemeApplication&&(console.warn("📊 Chart readiness timeout - clearing pending theme application"),this.pendingThemeApplication=null),this.chartReadinessTimeout=null},1e4)}destroy(){this.chartUnsubscribe&&(this.chartUnsubscribe(),this.chartUnsubscribe=null),this.chartReadinessTimeout&&(clearTimeout(this.chartReadinessTimeout),this.chartReadinessTimeout=null)}loadPersistedSettings(e){let t=o2(this.chartId,e);const s=this.loadFromLegacySystem();s&&(t=this.mergeThemeSettings(t,s)),this.settingsStore.update(r=>({...r,current:t})),fp(this.chart)?this.applyTheme(t,{preview:!1}):(console.log("📊 Chart not ready, deferring theme application"),this.pendingThemeApplication=t,this.setupChartReadinessTimeout())}loadFromLegacySystem(){var e,t,s,i,r,a;try{const l=localStorage.getItem("chart");if(!l)return null;const c=JSON.parse(l);if(!c.styles)return null;console.log("📦 Loading from localStorage - chart type:",(t=(e=c.styles)==null?void 0:e.candle)==null?void 0:t.type);const d={canvas:{background:{},grid:{}}},v=c.styles.backgroundType||"solid";v==="solid"&&c.styles.backgroundColor?d.canvas.background={mode:"solid",solid:{color:c.styles.backgroundColor,alpha:(c.styles.backgroundOpacity??100)/100}}:v==="gradient"&&c.styles.backgroundGradient&&(d.canvas.background={mode:"gradient",gradient:c.styles.backgroundGradient});const g=c.styles.gridType||"solid";if(g==="solid"){const _=((i=(s=c.styles.grid)==null?void 0:s.horizontal)==null?void 0:i.color)||((a=(r=c.styles.grid)==null?void 0:r.vertical)==null?void 0:a.color);if(_){const y=this.extractHexFromColor(_),k=c.styles.gridOpacity??100;d.canvas.grid={mode:"solid",solid:{color:y,alpha:k/100}}}}else g==="gradient"&&c.styles.gridGradient&&(d.canvas.grid={mode:"gradient",gradient:c.styles.gridGradient});return console.debug("LEGACY_LOAD",{loadedSettings:d}),d}catch(l){return console.error("Failed to load from legacy system:",l),null}}extractHexFromColor(e){if(e.startsWith("#"))return e;if(e.startsWith("rgba")||e.startsWith("rgb")){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(t){const s=parseInt(t[1]).toString(16).padStart(2,"0"),i=parseInt(t[2]).toString(16).padStart(2,"0"),r=parseInt(t[3]).toString(16).padStart(2,"0");return`#${s}${i}${r}`}}return e}mergeThemeSettings(e,t){var i,r;const s=eh(e);return(i=t.canvas)!=null&&i.background&&(s.canvas.background=t.canvas.background),(r=t.canvas)!=null&&r.grid&&(s.canvas.grid=t.canvas.grid),s}openModal(){this.settingsStore.update(e=>(e.pending===null&&(e.pending=eh(e.current),console.debug("THEME_MODAL_OPEN",{pending:e.pending})),e))}updatePending(e,t=!1){this.settingsStore.update(s=>(s.pending&&(e(s.pending),t&&this.applyTheme(s.pending,{preview:!0}),console.debug("THEME_PENDING_UPDATE",{pending:s.pending,applyPreview:t})),s))}confirm(){this.settingsStore.update(e=>(e.pending&&(e.current=eh(e.pending),mN(this.chartId,e.current),this.applyTheme(e.current,{preview:!1}),this.syncToLegacySystem(e.current),console.debug("THEME_COMMIT",{current:e.current}),e.pending=null),e))}syncToLegacySystem(e){var t,s;try{const i=localStorage.getItem("chart");if(i){const r=JSON.parse(i),a=(s=(t=r.styles)==null?void 0:t.candle)==null?void 0:s.type;if(console.log("🔒 Preserving chart type in syncToLegacySystem:",a),r.styles||(r.styles={}),e.canvas.background.mode==="solid"&&e.canvas.background.solid?(r.styles.backgroundColor=e.canvas.background.solid.color,r.styles.backgroundOpacity=(e.canvas.background.solid.alpha??1)*100,r.styles.backgroundType="solid",delete r.styles.backgroundGradient):e.canvas.background.mode==="gradient"&&e.canvas.background.gradient&&(r.styles.backgroundGradient=e.canvas.background.gradient,r.styles.backgroundType="gradient",delete r.styles.backgroundColor,delete r.styles.backgroundOpacity),e.canvas.grid.mode==="solid"&&e.canvas.grid.solid){r.styles.grid||(r.styles.grid={}),r.styles.grid.horizontal||(r.styles.grid.horizontal={}),r.styles.grid.vertical||(r.styles.grid.vertical={});const l=e.canvas.grid.solid.alpha!==void 0&&e.canvas.grid.solid.alpha!==1?H_(e.canvas.grid.solid.color,e.canvas.grid.solid.alpha):e.canvas.grid.solid.color;r.styles.grid.horizontal.color=l,r.styles.grid.vertical.color=l,r.styles.gridOpacity=(e.canvas.grid.solid.alpha??1)*100,r.styles.gridType="solid",delete r.styles.gridGradient}else e.canvas.grid.mode==="gradient"&&e.canvas.grid.gradient&&(r.styles.gridGradient=e.canvas.grid.gradient,r.styles.gridType="gradient");a&&(r.styles.candle||(r.styles.candle={}),r.styles.candle.type=a,console.log("✅ Restored chart type in syncToLegacySystem:",a)),localStorage.setItem("chart",JSON.stringify(r)),console.debug("LEGACY_SYNC",{syncedStyles:r.styles,preservedChartType:a})}}catch(i){console.error("Failed to sync to legacy system:",i)}}cancel(){this.settingsStore.update(e=>(e.pending&&(this.applyTheme(e.current,{preview:!1}),console.debug("THEME_CANCEL",{reverted_to:e.current}),e.pending=null),e))}reset(){this.settingsStore.update(e=>(e.pending&&(e.pending=eh(e.current),this.applyTheme(e.pending,{preview:!0}),console.debug("THEME_RESET",{pending:e.pending})),e))}applyTheme(e,t={}){const s=fp(this.chart);if(!s){console.log("📊 Chart not available for theme application, storing for later"),t.preview||(this.pendingThemeApplication=e,this.setupChartReadinessTimeout());return}if(!e||!e.canvas){console.warn("Invalid theme configuration, skipping application");return}const i=t.preview||!1;i?this.addPreviewWatermark():this.removePreviewWatermark();try{e.canvas.background&&this.applyBackground(e.canvas.background),i||(e.canvas.grid&&this.applyGrid(e.canvas.grid,s),setTimeout(()=>{this.applyCanvasColorsIfAvailable()},150)),console.debug("THEME_APPLIED",{theme:e.canvas,preview:i,chartId:this.chartId,appliedGrid:!i})}catch(r){console.error("Failed to apply theme:",r)}}applyBackground(e){const t=document.querySelector(".kline-main"),s=document.querySelector(".kline-widget");if(!t&&!s){console.warn("Chart containers not found for background application");return}if(!e){console.warn("Background configuration is null or undefined, skipping");return}let i;if(e.mode==="solid"&&e.solid&&e.solid.color){const r=e.solid.alpha!==void 0?e.solid.alpha:1;i=r!==1?H_(e.solid.color,r):e.solid.color}else e.mode==="gradient"&&e.gradient?i=gN(e.gradient):(console.warn("Invalid background configuration, using fallback"),i="#070211");console.log("🎨 Applying background:",i),[t,s].forEach(r=>{r&&(r.style.removeProperty("background"),r.style.removeProperty("background-color"),r.offsetHeight,r.style.background=i,r.style.backgroundColor=i,r.style.setProperty("--chart-background-color",i),r.offsetHeight)})}applyGrid(e,t){var a,l;const s=t.getStyles()??{},i=uo.cloneDeep(s);try{const c=localStorage.getItem("chart");if(c){const d=JSON.parse(c);(l=(a=d.styles)==null?void 0:a.candle)!=null&&l.type&&(i.candle||(i.candle={}),i.candle.type=d.styles.candle.type,console.log("🔒 Preserved chart type in applyGrid:",d.styles.candle.type))}}catch(c){console.warn("Failed to preserve chart type:",c)}let r;if(e.mode==="solid"&&e.solid){const c=e.solid.alpha!==void 0?e.solid.alpha:1;r=c!==1?H_(e.solid.color,c):e.solid.color}else if(e.mode==="gradient"&&e.gradient){const c=e.gradient.stops;if(c.length===1)r=c[0].color;else if(c.length>=2)r=this.blendColors(c[0].color,c[c.length-1].color,.5);else{console.warn("Invalid grid gradient configuration");return}}else{console.warn("Invalid grid configuration");return}console.log("🎨 ThemeManager applying grid color:",r),uo.set(i,"grid.horizontal.color",r),uo.set(i,"grid.vertical.color",r),t.setStyles(i),console.log("✅ Applied grid styles directly:",{gridColor:r,gridConfig:i.grid})}blendColors(e,t,s){if(!e.startsWith("#")||!t.startsWith("#"))return e;const i=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16),l=parseInt(t.slice(1,3),16),c=parseInt(t.slice(3,5),16),d=parseInt(t.slice(5,7),16),v=Math.round(i*(1-s)+l*s),g=Math.round(r*(1-s)+c*s),_=Math.round(a*(1-s)+d*s);return`#${v.toString(16).padStart(2,"0")}${g.toString(16).padStart(2,"0")}${_.toString(16).padStart(2,"0")}`}addPreviewWatermark(){this.removePreviewWatermark();const e=document.querySelector(".kline-main");if(!e)return;const t=document.createElement("div");t.id="theme-preview-watermark",t.style.cssText=`
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 1000;
      pointer-events: none;
    `,t.textContent="PREVIEW",e.style.position="relative",e.appendChild(t)}removePreviewWatermark(){const e=document.getElementById("theme-preview-watermark");e&&e.remove()}getCurrentSettings(){return fp(this.settingsStore).current}getPendingSettings(){return fp(this.settingsStore).pending}isModalOpen(){return fp(this.settingsStore).pending!==null}resetToThemeDefaults(e){const t=o2(this.chartId,e);this.settingsStore.update(s=>({...s,current:t,pending:null})),console.log("🔄 Reset TransactionalThemeManager to theme defaults:",e)}}function hN(o,e,t){const s=o.target.checked;x(e,D(s)),t({wick:s})}function _N(o,e,t){const s=o.target.value;x(e,D(s)),t({source:s})}function yN(o,e,t){const s="ATR";x(e,s),t({method:s})}function bN(o,e,t){const s=parseInt(o.target.value||"14",10),i=Math.max(1,isNaN(s)?14:s);x(e,D(i)),t({atrLength:i})}function xN(o,e,t){const s=o.target.value;x(e,D(s)),t({boxSizeMode:s})}function wN(o,e,t){const s=parseFloat(o.target.value||"1"),i=Math.max(1e-4,isNaN(s)?1:s);x(e,D(i)),t({boxSize:i})}function kN(o,e,t){const s=parseInt(o.target.value||"14",10),i=Math.max(1,isNaN(s)?14:s);x(e,D(i)),t({atrLength:i})}function SN(o,e,t){const s=parseInt(o.target.value||"3",10),i=Math.max(1,isNaN(s)?3:s);x(e,D(i)),t({reversalBoxes:i})}function CN(o,e,t){const s=o.target.value;x(e,D(s)),t({upColor:s})}function PN(o,e,t){const s=o.target.value;x(e,D(s)),t({downColor:s})}function IN(o,e,t,s,i,r,a,l){x(e,"ATR"),x(t,1),x(s,14),x(i,3),x(r,"#00E6D8"),x(a,"#FF4D4D"),l({boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"})}function MN(o,e,t,s,i,r,a,l,c,d){if(n(e)==="solid"){const v=o.target.getBoundingClientRect();x(t,D({x:v.right+10,y:v.top})),x(s,!0),x(i,!1),x(r,!1),x(a,!1),x(l,!1),x(c,!1),d()}else n(e)==="gradient"&&(x(r,!0),x(s,!1),x(i,!1),x(a,!1),x(l,!1),x(c,!1))}function TN(o,e,t,s,i,r,a,l,c){if(console.log("🔥 Grid picker clicked, type:",n(e)),n(e)==="solid"){const d=o.target.getBoundingClientRect();x(t,D({x:d.right+10,y:d.top})),console.log("🔥 Opening grid color picker at:",n(t)),x(s,!0),x(i,!1),x(r,!1),x(a,!1),x(l,!1),x(c,!1)}else n(e)==="gradient"&&(x(a,!0),x(s,!1),x(i,!1),x(r,!1),x(l,!1),x(c,!1))}function AN(o,e,t,s,i,r,a,l,c){const d=o.target.getBoundingClientRect();x(e,D({x:d.right+10,y:d.top})),x(t,!0),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c()}function LN(o,e,t,s,i,r,a,l,c){const d=o.target.getBoundingClientRect();x(e,D({x:d.right+10,y:d.top})),x(t,!0),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c()}function zN(o,e,t,s,i,r,a,l,c,d){const v=o.target.getBoundingClientRect();x(e,D({x:v.right+10,y:v.top})),x(t,!1),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c(),x(d,!0)}function FN(o,e,t,s,i,r,a,l,c,d){const v=o.target.getBoundingClientRect();x(e,D({x:v.right+10,y:v.top})),x(t,!1),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c(),x(d,!0)}function $N(o,e,t,s,i,r,a,l,c,d){const v=o.target.getBoundingClientRect();x(e,D({x:v.right+10,y:v.top})),x(t,!1),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c(),x(d,!0)}function DN(o,e,t,s,i,r,a,l,c,d){const v=o.target.getBoundingClientRect();x(e,D({x:v.right+10,y:v.top})),x(t,!1),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c(),x(d,!0)}function EN(o,e,t,s,i,r,a,l,c,d){const v=o.target.getBoundingClientRect();x(e,D({x:v.right+10,y:v.top})),x(t,!1),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c(),x(d,!0)}function NN(o,e,t,s,i,r,a,l,c,d){const v=o.target.getBoundingClientRect();x(e,D({x:v.right+10,y:v.top})),x(t,!1),x(s,!1),x(i,!1),x(r,!1),x(a,!1),x(l,!1),c(),x(d,!0)}function jN(o,e,t){x(e,!n(e)),t()}function RN(o,e,t){x(e,!n(e)),t()}function BN(o,e,t){x(e,!n(e)),t()}var ON=(o,e)=>x(e,"canvas"),VN=(o,e)=>x(e,"other"),WN=(o,e)=>x(e,"candle"),qN=(o,e)=>x(e,"renko"),HN=re('<button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Duty AI Renko</button>'),GN=(o,e)=>x(e,"pnf"),UN=re('<button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Point & Figure</button>'),YN=re('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Canvas Settings</h4> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">Background color</label> <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3"><select class="select select-bordered select-sm w-full sm:w-32"><option>Solid</option><option>Gradient</option></select> <button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">Grid color</label> <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3"><select class="select select-bordered select-sm w-full sm:w-32"><option>Solid</option><option>Gradient</option></select> <button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">X-Axis tick text color</label> <div class="flex items-center space-x-3"><button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">Y-Axis tick text color</label> <div class="flex items-center space-x-3"><button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div></div>'),KN=(o,e,t)=>e(n(t).key,o.target.value),ZN=re("<option> </option>"),XN=re('<select class="select select-bordered select-sm w-full sm:w-32 flex-shrink-0"></select>'),JN=(o,e,t)=>e(n(t).key,o.target.checked),QN=re('<input type="checkbox" class="toggle toggle-sm flex-shrink-0">'),ej=re('<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-2 space-y-2 sm:space-y-0"><label class="text-sm font-medium text-base-content/80 flex-1"> </label> <!></div>'),tj=re('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Other Settings</h4> <div class="grid grid-cols-1 gap-4"></div></div>'),oj=re('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Candle Color Customization</h4> <div class="space-y-4"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-3 border-b border-base-300"><div class="flex items-center space-x-3 mb-3 sm:mb-0"><input type="checkbox" class="checkbox checkbox-sm"> <label class="text-sm font-medium text-base-content">Body</label></div> <div class="flex space-x-3"><div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bull</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div> <div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bear</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div></div></div> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-3 border-b border-base-300"><div class="flex items-center space-x-3 mb-3 sm:mb-0"><input type="checkbox" class="checkbox checkbox-sm"> <label class="text-sm font-medium text-base-content">Borders</label></div> <div class="flex space-x-3"><div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bull</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div> <div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bear</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div></div></div> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-3"><div class="flex items-center space-x-3 mb-3 sm:mb-0"><input type="checkbox" class="checkbox checkbox-sm"> <label class="text-sm font-medium text-base-content">Wick</label></div> <div class="flex space-x-3"><div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bull</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div> <div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bear</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div></div></div></div></div>'),sj=re('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Duty AI Renko Settings</h4> <div class="space-y-4 p-3 rounded-lg border border-base-300"><div class="flex items-center gap-3"><label class="flex items-center gap-2"><input type="checkbox" class="checkbox checkbox-sm"> <span>Wick</span></label></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3"><div class="flex flex-col gap-1"><label class="text-xs opacity-80">Source</label> <select class="select select-bordered select-sm"><option>Close</option><option>Open</option><option>High</option><option>Low</option></select></div> <div class="flex flex-col gap-1"><label class="text-xs opacity-80">Box size assignment method</label> <select class="select select-bordered select-sm" disabled><option>ATR</option></select></div> <div class="flex flex-col gap-1"><label class="text-xs opacity-80">ATR length</label> <input type="number" min="1" class="input input-bordered input-sm"></div></div></div></div>'),nj=re('<div class="flex flex-col gap-1"><label class="text-xs opacity-80">ATR Length</label> <input type="number" min="1" max="200" step="1" class="input input-bordered input-sm"></div>'),ij=re('<div class="flex flex-col gap-1"><label class="text-xs opacity-80"> </label> <input type="number" min="0.0001" step="0.1" class="input input-bordered input-sm"></div>'),rj=re('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Point & Figure Settings</h4> <div class="space-y-4 p-3 rounded-lg border border-base-300"><div class="grid grid-cols-1 sm:grid-cols-2 gap-3"><div class="flex flex-col gap-1"><label class="text-xs opacity-80">Box Size Mode</label> <select class="select select-bordered select-sm"><option>ATR (Auto-fit)</option><option>Absolute (Price Units)</option><option>Percent (%)</option></select></div> <!></div> <div class="flex flex-col gap-1"><label class="text-xs opacity-80">Reversal Boxes (typical: 3)</label> <input type="number" min="1" max="10" step="1" class="input input-bordered input-sm w-32"></div> <div class="pt-2 border-t border-base-300"><h5 class="text-sm font-medium mb-3">Symbol Colors</h5> <div class="grid grid-cols-2 gap-4"><div class="flex flex-col items-center gap-2"><label class="text-xs opacity-80">Up Column (X)</label> <div class="flex items-center gap-2"><input type="color" class="w-10 h-10 cursor-pointer rounded border border-base-300"> <span class="text-xs font-mono opacity-70"> </span></div></div> <div class="flex flex-col items-center gap-2"><label class="text-xs opacity-80">Down Column (O)</label> <div class="flex items-center gap-2"><input type="color" class="w-10 h-10 cursor-pointer rounded border border-base-300"> <span class="text-xs font-mono opacity-70"> </span></div></div></div></div> <div class="pt-4 border-t border-base-300"><button class="btn btn-sm btn-outline">Reset P&F to Defaults</button></div></div></div>'),aj=re('<div class="flex flex-col lg:flex-row min-h-[400px] max-h-[70vh] overflow-hidden"><div class="w-full lg:w-48 border-b lg:border-b-0 lg:border-r border-base-300 pb-4 lg:pb-0 lg:pr-4 mb-4 lg:mb-0"><div class="flex lg:flex-col space-x-2 lg:space-x-0 lg:space-y-2 overflow-x-auto lg:overflow-x-visible"><button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Canvas</button> <button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Other Settings</button> <button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Candle</button> <!> <!></div></div> <div class="flex-1 lg:pl-6 overflow-y-auto"><!></div></div>'),lj=re("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function Qx(o,e){Mc(e,!0);const t=Au(),s=()=>ua(c,"$save",t),i=()=>ua(d,"$chart",t),r=()=>ua(l,"$ctx",t);let a=Qs(e,"show",15);const l=vc("ctx"),c=vc("save"),d=vc("chart"),v=new R1("chart-settings",d,"dark");rf(()=>{v.destroy()});let g=ee(!1),_=null;zr(()=>{var bt,kt,xo,$t,_o;if(a())console.log("🔧 Settings modal OPENED"),console.log("  - Current $save.styles.candle.type:",(kt=(bt=s().styles)==null?void 0:bt.candle)==null?void 0:kt.type),console.log("  - Current chart.getStyles().candle.type:",(_o=($t=(xo=i())==null?void 0:xo.getStyles())==null?void 0:$t.candle)==null?void 0:_o.type),x(g,!1),v.openModal();else if(!n(g)){console.log("🚫 Settings modal CANCELLED"),_&&(clearTimeout(_),_=null);try{window.__forceApplySavedCanvasColors=!0}catch{}r().applyCanvasColors&&r().applyCanvasColors()}});let y=ee("canvas");const k=new j0;let S=ee(!1),M=ee(!1),I=ee(!1),C=ee(!1),T=ee(D({x:0,y:0})),z=ee(D({x:0,y:0})),j=ee(D({x:0,y:0})),B=ee(D({x:0,y:0})),$=ee(!1),F=ee(!1),V=ee(!1),K=ee(!1),Y=ee(!1),Z=ee(!1),ne=ee(D({x:0,y:0})),te=ee(D({x:0,y:0})),oe=ee(D({x:0,y:0})),U=ee(D({x:0,y:0})),J=ee(D({x:0,y:0})),se=ee(D({x:0,y:0})),W=ee(!1),le=ee(!1),ye=ee(!1),Ce=ee(D(uo.get(s().styles,"backgroundType")||"solid")),Re=ee(D(uo.get(s().styles,"gridType")||"solid")),Ke=ee(D(uo.get(s().styles,"backgroundColor")||"#000000")),st=ee(D(uo.get(s().styles,"grid.horizontal.color")||"#333333")),vt=ee(100),Je=ee(100),ot=ee(100),nt=ee(100);const tt=[{key:"candle.priceMark.last.show",label:"Show Last Price",type:"switch",default:!0},{key:"candle.priceMark.high.show",label:"Show High Price",type:"switch",default:!0},{key:"candle.priceMark.low.show",label:"Show Low Price",type:"switch",default:!0},{key:"indicator.lastValueMark.show",label:"Show Indicator Last Value",type:"switch",default:!0},{key:"yAxis.reverse",label:"Reverse Coordinate",type:"switch",default:!1},{key:"grid.show",label:"Grid Show",type:"switch",default:!0}],Ze=new j0;let ct=ee(!0),Ge=ee(!0),pt=ee(!0),ce=ee("#26a69a"),we=ee("#ef5350"),ze=ee("#26a69a"),dt=ee("#ef5350"),qe=ee("#26a69a"),me=ee("#ef5350");const Q=Qe(()=>{var bt,kt;return((kt=(bt=s().styles)==null?void 0:bt.candle)==null?void 0:kt.type)==="renko_atr"});let it=ee(!1),Vt=ee("close"),wt=ee("ATR"),Yt=ee(14);zr(()=>{var kt,xo;if(!a())return;const bt=((xo=(kt=s().styles)==null?void 0:kt.candle)==null?void 0:xo.renko)||{};x(it,!!bt.wick),x(Vt,D(bt.source||"close")),x(wt,D(bt.method||"ATR")),x(Yt,D(Math.max(1,(bt.atrLength??14)|0)))}),zr(()=>{a()&&(n(Q)?x(y,D(n(y)==="canvas"||n(y)==="other"?n(y):"renko")):n(y)==="renko"&&x(y,"candle"))});function At(bt){c.update(kt=>{kt.styles||(kt.styles={}),kt.styles.candle||(kt.styles.candle={});const xo=kt.styles.candle;return xo.renko||(xo.renko={method:"ATR",atrLength:14,source:"close",wick:!1}),xo.renko={...xo.renko,...bt},kt})}const Gt=Qe(()=>{var bt,kt;return((kt=(bt=s().styles)==null?void 0:bt.candle)==null?void 0:kt.type)==="point_and_figure"});let no=ee("ATR"),Do=ee(1),Eo=ee(14),bs=ee(3),Is=ee("#00E6D8"),qi=ee("#FF4D4D");zr(()=>{var kt,xo;if(!a())return;const bt=((xo=(kt=s().styles)==null?void 0:kt.candle)==null?void 0:xo.pnf)||{};x(no,D(bt.boxSizeMode||"ATR")),x(Do,D(Math.max(1e-4,bt.boxSize??1))),x(Eo,D(Math.max(1,Math.round(bt.atrLength??14)))),x(bs,D(Math.max(1,Math.round(bt.reversalBoxes??3)))),x(Is,D(bt.upColor||"#00E6D8")),x(qi,D(bt.downColor||"#FF4D4D"))}),zr(()=>{a()&&(n(Gt)?x(y,D(n(y)==="canvas"||n(y)==="other"?n(y):"pnf")):n(y)==="pnf"&&x(y,"candle"))});function Ks(bt){c.update(kt=>{kt.styles||(kt.styles={}),kt.styles.candle||(kt.styles.candle={});const xo=kt.styles.candle;return xo.pnf||(xo.pnf={boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"}),xo.pnf={...xo.pnf,...bt},kt})}let ws=ee(D(uo.get(s().styles,"backgroundGradient")||{type:"linear",direction:90,stops:[{position:0,color:"#1a1a1a",opacity:100},{position:100,color:"#4a4a4a",opacity:100}]})),vn=ee(D(uo.get(s().styles,"gridGradient")||{type:"linear",direction:90,stops:[{position:0,color:"#2a2a2a",opacity:100},{position:100,color:"#3a3a3a",opacity:100}]}));function es(bt){if(!bt||!bt.stops)return"";const xo=[...bt.stops].sort(($t,_o)=>$t.position-_o.position).map($t=>{const _o=parseInt($t.color.slice(1,3),16),go=parseInt($t.color.slice(3,5),16),fs=parseInt($t.color.slice(5,7),16),Ms=$t.opacity/100;return`rgba(${_o}, ${go}, ${fs}, ${Ms}) ${$t.position}%`});return bt.type==="linear"?`linear-gradient(${bt.direction}deg, ${xo.join(", ")})`:`radial-gradient(circle, ${xo.join(", ")})`}function Li(bt){if(typeof bt=="string"&&bt.startsWith("rgba(")){const kt=bt.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*[\d.]+\)/);if(kt){const xo=parseInt(kt[1]),$t=parseInt(kt[2]),_o=parseInt(kt[3]);return`#${xo.toString(16).padStart(2,"0")}${$t.toString(16).padStart(2,"0")}${_o.toString(16).padStart(2,"0")}`}}return bt}function ci(){const bt=s().theme;return{backgroundColor:bt==="dark"?"#070211":"#ffffff",backgroundOpacity:100,gridColor:bt==="dark"?"#081115":"#F3F3F3",gridOpacity:100,xAxisTickTextColor:bt==="dark"?"#ffffff":"#000000",yAxisTickTextColor:bt==="dark"?"#ffffff":"#000000"}}zr(()=>{a()&&i()&&(console.log("📂 Modal opened - restoring saved values..."),x(ye,!0),k.clear(),oa(),queueMicrotask(()=>{x(ye,!1),console.log("✅ Restoration complete - preview enabled")}))}),zr(()=>{if(!i()||!a()||n(ye))return;const bt=n(vt),kt=n(Ke),xo=n(Ce),$t=n(ws);$t==null||$t.stops,$t==null||$t.type,$t==null||$t.direction;const _o=document.querySelector(".kline-main"),go=document.querySelector(".kline-widget");if(xo==="solid"){const fs=k.get("backgroundColor")||kt||ci().backgroundColor,zn=(k.get("backgroundOpacity")??bt??100)/100,qs=sa(fs,zn);[_o,go].forEach(Vn=>{if(Vn){const Ss=Vn;Ss.style.removeProperty("background"),Ss.style.removeProperty("background-color"),Ss.offsetHeight,Ss.style.setProperty("background",qs,"important"),Ss.style.setProperty("background-color",qs,"important"),Ss.style.setProperty("--chart-background-color",qs),Ss.offsetHeight}})}else if(xo==="gradient"){const fs=k.get("backgroundGradient")||$t;let Ms=fs;(!fs||!fs.stops||fs.stops.length===0)&&(Ms={type:"linear",direction:90,stops:[{position:0,color:"#1a1a1a",opacity:100},{position:100,color:"#4a4a4a",opacity:100}]},k.set("backgroundGradient",Ms));const zn=Ms.css||es(Ms);[_o,go].forEach(qs=>{if(qs){const Vn=qs;Vn.style.removeProperty("background"),Vn.style.removeProperty("background-color"),Vn.offsetHeight,Vn.style.setProperty("background",zn,"important"),Vn.style.setProperty("background-color",zn,"important"),Vn.style.setProperty("--chart-background-color",zn),Vn.offsetHeight}})}}),zr(()=>{var _o,go,fs,Ms;if(!i()||!a()||n(ye))return;const bt=n(Je),kt=n(st),xo=n(Re),$t=n(vn);if($t==null||$t.stops,$t==null||$t.type,$t==null||$t.direction,console.log("🔄 Grid effect triggered:",{gridColorType:xo,gridColor:kt,gridOpacity:bt}),xo==="solid"){const zn=k.get("gridColor")||kt||ci().gridColor,qs=k.get("gridOpacity")??bt??100,Vn=sa(zn,qs/100);console.log("🎨 Applying solid grid color via effect:",Vn);const Ss=i().getStyles()??{},di=uo.cloneDeep(Ss);(go=(_o=s().styles)==null?void 0:_o.candle)!=null&&go.type&&uo.set(di,"candle.type",s().styles.candle.type);const Mn=uo.get(Ss,"grid.show",!0);uo.set(di,"grid.show",Mn),uo.set(di,"grid.horizontal.show",Mn),uo.set(di,"grid.horizontal.color",Vn),uo.set(di,"grid.vertical.show",Mn),uo.set(di,"grid.vertical.color",Vn),i().setStyles(di)}else if(xo==="gradient"){const zn=k.get("gridGradient")||$t;if(zn&&zn.stops&&zn.stops.length>0){const qs=zn.stops[0],Vn=zn.stops[zn.stops.length-1],Ss=Yc(qs.color,Vn.color,.5);console.log("🎨 Applying gradient grid color via effect:",Ss);const di=i().getStyles()??{},Mn=uo.cloneDeep(di);(Ms=(fs=s().styles)==null?void 0:fs.candle)!=null&&Ms.type&&uo.set(Mn,"candle.type",s().styles.candle.type);const La=uo.get(di,"grid.show",!0);uo.set(Mn,"grid.show",La),uo.set(Mn,"grid.horizontal.show",La),uo.set(Mn,"grid.horizontal.color",Ss),uo.set(Mn,"grid.vertical.show",La),uo.set(Mn,"grid.vertical.color",Ss),i().setStyles(Mn)}}});function oa(){const bt=ci();console.log("🔄 Restoring saved values...",{backgroundType:uo.get(s().styles,"backgroundType"),gridType:uo.get(s().styles,"gridType")});const kt=uo.get(s().styles,"backgroundType")||"solid";if(x(Ce,D(kt)),kt==="solid"){const nn=uo.get(s().styles,"backgroundColor")||bt.backgroundColor,tr=uo.get(s().styles,"backgroundOpacity")||bt.backgroundOpacity,Ur=Li(nn);x(Ke,D(Ur)),x(vt,D(tr)),k.set("backgroundColor",Ur),k.set("backgroundOpacity",tr),console.log("✅ Restored solid BG:",Ur,"opacity:",tr)}else if(kt==="gradient"){const nn=uo.get(s().styles,"backgroundGradient");nn&&(x(ws,D({...nn})),k.set("backgroundGradient",nn),console.log("✅ Restored gradient BG:",nn))}const xo=uo.get(s().styles,"gridType")||"solid";if(x(Re,D(xo)),xo==="solid"){const nn=uo.get(s().styles,"grid.horizontal.color")||uo.get(s().styles,"grid.vertical.color")||bt.gridColor,tr=uo.get(s().styles,"gridOpacity")||bt.gridOpacity,Ur=Li(nn);x(st,D(Ur)),x(Je,D(tr)),k.set("gridColor",Ur),k.set("gridOpacity",tr),console.log("✅ Restored solid Grid:",Ur,"opacity:",tr)}else if(xo==="gradient"){const nn=uo.get(s().styles,"gridGradient");nn&&(x(vn,D({...nn})),k.set("gridGradient",nn),console.log("✅ Restored gradient Grid:",nn))}const $t=uo.get(s().styles,"xAxis.tickText.color")||bt.xAxisTickTextColor,_o=uo.get(s().styles,"xAxis.tickText.opacity")||100,go=Li($t);x(ot,D(_o)),k.set("xAxisTickTextColor",go),k.set("xAxisTickTextOpacity",_o);const fs=uo.get(s().styles,"yAxis.tickText.color")||bt.yAxisTickTextColor,Ms=uo.get(s().styles,"yAxis.tickText.opacity")||100,zn=Li(fs);x(nt,D(Ms)),k.set("yAxisTickTextColor",zn),k.set("yAxisTickTextOpacity",Ms);try{if(i()&&typeof i().getStyles=="function"){const nn=i().getStyles()??{},tr=uo.get(nn,"xAxis.tickText.color"),Ur=uo.get(nn,"yAxis.tickText.color");if(tr){const cl=Li(tr);k.set("xAxisTickTextColor",cl)}if(Ur){const cl=Li(Ur);k.set("yAxisTickTextColor",cl)}}}catch(nn){console.warn("Failed to read live axis styles from chart:",nn)}const qs=uo.get(s().styles,"candle.bar.upColor")||"#26a69a",Vn=uo.get(s().styles,"candle.bar.downColor")||"#ef5350",Ss=uo.get(s().styles,"candle.bar.upBorderColor")||"#26a69a",di=uo.get(s().styles,"candle.bar.downBorderColor")||"#ef5350",Mn=uo.get(s().styles,"candle.bar.upWickColor")||"#26a69a",La=uo.get(s().styles,"candle.bar.downWickColor")||"#ef5350";x(ce,D(qs)),x(we,D(Vn)),x(ze,D(Ss)),x(dt,D(di)),x(qe,D(Mn)),x(me,D(La)),tt.forEach(nn=>{const tr=uo.get(s().styles,nn.key);tr!==void 0?Ze.set(nn.key,tr):Ze.set(nn.key,nn.default)})}function ol(bt){if(x(Ke,D(bt.detail)),k.set("backgroundColor",bt.detail),n(Ce)==="solid"){const kt=n(vt)/100,xo=sa(bt.detail,kt),$t=document.querySelector(".kline-main"),_o=document.querySelector(".kline-widget");[$t,_o].forEach(go=>{if(go){const fs=go;fs.style.removeProperty("background"),fs.style.removeProperty("background-color"),fs.style.removeProperty("background-image"),fs.offsetHeight,fs.style.setProperty("background",xo,"important"),fs.style.setProperty("background-color",xo,"important"),fs.style.setProperty("--chart-background-color",xo),fs.offsetHeight}})}}function Xi(bt){if(x(vt,D(bt.detail)),k.set("backgroundOpacity",bt.detail),n(Ce)==="solid"){const kt=k.get("backgroundColor")||n(Ke)||ci().backgroundColor,xo=bt.detail/100,$t=sa(kt,xo),_o=document.querySelector(".kline-main"),go=document.querySelector(".kline-widget");[_o,go].forEach(fs=>{if(fs){const Ms=fs;Ms.style.removeProperty("background"),Ms.style.removeProperty("background-color"),Ms.offsetHeight,Ms.style.setProperty("background",$t,"important"),Ms.style.setProperty("background-color",$t,"important"),Ms.style.setProperty("--chart-background-color",$t),Ms.offsetHeight}})}}function fc(bt){var go,fs;if(console.log("🎨 Grid color changed to:",bt.detail),x(st,D(bt.detail)),k.set("gridColor",bt.detail),!i()){console.warn("⚠️ No chart available for grid color preview");return}const kt=sa(bt.detail,n(Je)/100);console.log("🎨 Applying grid color:",kt);const xo=i().getStyles()??{},$t=uo.cloneDeep(xo);(fs=(go=s().styles)==null?void 0:go.candle)!=null&&fs.type&&uo.set($t,"candle.type",s().styles.candle.type);const _o=uo.get(xo,"grid.show",!0);uo.set($t,"grid.show",_o),uo.set($t,"grid.horizontal.show",_o),uo.set($t,"grid.horizontal.color",kt),uo.set($t,"grid.vertical.show",_o),uo.set($t,"grid.vertical.color",kt),console.log("🎨 New grid styles:",$t.grid);try{i().setStyles($t),console.log("✅ Grid styles applied successfully")}catch(Ms){console.error("❌ Failed to apply grid styles:",Ms)}}function rd(bt){var fs,Ms;if(console.log("🎨 Grid opacity changed to:",bt.detail),x(Je,D(bt.detail)),k.set("gridOpacity",bt.detail),!i()){console.warn("⚠️ No chart available for grid opacity preview");return}const kt=k.get("gridColor")||n(st)||ci().gridColor,xo=sa(kt,bt.detail/100);console.log("🎨 Applying grid opacity:",xo);const $t=i().getStyles()??{},_o=uo.cloneDeep($t);(Ms=(fs=s().styles)==null?void 0:fs.candle)!=null&&Ms.type&&uo.set(_o,"candle.type",s().styles.candle.type);const go=uo.get($t,"grid.show",!0);uo.set(_o,"grid.show",go),uo.set(_o,"grid.horizontal.show",go),uo.set(_o,"grid.horizontal.color",xo),uo.set(_o,"grid.vertical.show",go),uo.set(_o,"grid.vertical.color",xo),console.log("🎨 New grid styles:",_o.grid);try{i().setStyles(_o),console.log("✅ Grid opacity applied successfully")}catch(zn){console.error("❌ Failed to apply grid opacity:",zn)}}function ml(bt){if(k.set("xAxisTickTextColor",bt.detail),i()){const kt=i().getStyles()??{},xo=uo.cloneDeep(kt);uo.set(xo,"xAxis.tickText.color",bt.detail);const $t=Dc(xo);i().setStyles($t)}}function Jl(bt){if(k.set("yAxisTickTextColor",bt.detail),i()){const kt=i().getStyles()??{},xo=uo.cloneDeep(kt);uo.set(xo,"yAxis.tickText.color",bt.detail);const $t=Dc(xo);i().setStyles($t)}}function Wl(bt){if(x(ot,D(bt.detail)),k.set("xAxisTickTextOpacity",bt.detail),i()){const kt=i().getStyles()??{},xo=uo.cloneDeep(kt),$t=k.get("xAxisTickTextColor")||ci().xAxisTickTextColor,_o=bt.detail/100,go=sa($t,_o);uo.set(xo,"xAxis.tickText.color",go);const fs=Dc(xo);i().setStyles(fs)}}function sl(bt){if(x(nt,D(bt.detail)),k.set("yAxisTickTextOpacity",bt.detail),i()){const kt=i().getStyles()??{},xo=uo.cloneDeep(kt),$t=k.get("yAxisTickTextColor")||ci().yAxisTickTextColor,_o=bt.detail/100,go=sa($t,_o);uo.set(xo,"yAxis.tickText.color",go);const fs=Dc(xo);i().setStyles(fs)}}function Uc(bt){if(x(ws,D({...bt.detail})),k.set("backgroundGradient",n(ws)),n(Ce)==="gradient"){const kt=document.querySelector(".kline-main"),xo=document.querySelector(".kline-widget"),$t=es(n(ws));[kt,xo].forEach(_o=>{if(_o){const go=_o;go.style.removeProperty("background"),go.style.removeProperty("background-color"),go.offsetHeight,go.style.setProperty("background",$t,"important"),go.style.setProperty("background-color",$t,"important"),go.style.setProperty("--chart-background-color",$t),go.offsetHeight}})}}function Nl(bt){var kt,xo;if(x(vn,D({...bt.detail})),k.set("gridGradient",n(vn)),i()&&n(Re)==="gradient"){const $t=bt.detail.stops[0],_o=bt.detail.stops[bt.detail.stops.length-1],go=Yc($t.color,_o.color,.5),fs=i().getStyles()??{},Ms=uo.cloneDeep(fs);(xo=(kt=s().styles)==null?void 0:kt.candle)!=null&&xo.type&&uo.set(Ms,"candle.type",s().styles.candle.type),uo.set(Ms,"grid.horizontal.color",go),uo.set(Ms,"grid.vertical.color",go);const zn=Dc(Ms);i().setStyles(zn)}}function Yc(bt,kt,xo){const $t=bt.replace("#",""),_o=kt.replace("#",""),go=parseInt($t.substr(0,2),16),fs=parseInt($t.substr(2,2),16),Ms=parseInt($t.substr(4,2),16),zn=parseInt(_o.substr(0,2),16),qs=parseInt(_o.substr(2,2),16),Vn=parseInt(_o.substr(4,2),16),Ss=Math.round(go*(1-xo)+zn*xo),di=Math.round(fs*(1-xo)+qs*xo),Mn=Math.round(Ms*(1-xo)+Vn*xo);return`#${Ss.toString(16).padStart(2,"0")}${di.toString(16).padStart(2,"0")}${Mn.toString(16).padStart(2,"0")}`}function Ec(bt,kt){var fs,Ms,zn;const xo=(fs=i())==null?void 0:fs.getStyles(),$t=uo.get(xo,bt);if(bt==="yAxis.reverse")try{(Ms=i())==null||Ms.setPaneOptions({axis:{reverse:kt}}),c.update(qs=>(uo.set(qs.styles,bt,kt),qs)),Ze.set(bt,kt);return}catch(qs){console.warn("setPaneOptions not available, falling back to styles:",qs)}else if(bt==="yAxis.type"){console.warn("yAxis.type is not supported in klinecharts v10");return}if($t==kt)return;Ze.set(bt,kt),c.update(qs=>(uo.set(qs.styles,bt,kt),qs));const _o=Sd(s().theme),go=uo.merge({},_o,s().styles);(zn=i())==null||zn.setStyles(Dc(go))}function Ja(){let bt=i();if(!bt)return;const kt=bt.getStyles()??{};tt.forEach(xo=>{const $t=uo.get(kt,xo.key);xo.key==="yAxis.reverse"?Ze.set(xo.key,$t||!1):Ze.set(xo.key,$t??xo.default)})}function sa(bt,kt){const xo=bt.replace("#",""),$t=parseInt(xo.substr(0,2),16),_o=parseInt(xo.substr(2,2),16),go=parseInt(xo.substr(4,2),16);return`rgba(${$t}, ${_o}, ${go}, ${kt})`}function jl(){x($,!1),x(F,!1),x(V,!1),x(K,!1),x(Y,!1),x(Z,!1)}function Td(bt){x(ce,D(bt.detail)),be()}function _d(bt){x(we,D(bt.detail)),be()}function Fl(bt){x(ze,D(bt.detail)),be()}function qa(bt){x(dt,D(bt.detail)),be()}function td(bt){x(qe,D(bt.detail)),be()}function Nc(bt){x(me,D(bt.detail)),be()}function be(){_&&clearTimeout(_),_=setTimeout(()=>{var $t,_o;if(!i())return;const bt=i().getStyles()??{},kt=uo.cloneDeep(bt);(_o=($t=s().styles)==null?void 0:$t.candle)!=null&&_o.type&&uo.set(kt,"candle.type",s().styles.candle.type),n(ct)&&(uo.set(kt,"candle.bar.upColor",n(ce)),uo.set(kt,"candle.bar.downColor",n(we))),n(Ge)&&(uo.set(kt,"candle.bar.upBorderColor",n(ze)),uo.set(kt,"candle.bar.downBorderColor",n(dt))),n(pt)&&(uo.set(kt,"candle.bar.upWickColor",n(qe)),uo.set(kt,"candle.bar.downWickColor",n(me)));const xo=Dc(kt);i().setStyles(xo),_=null},16)}function We(bt){var kt,xo;if(bt==="confirm"){console.log("🔧 CONFIRM CLICKED - Using theme manager"),v.updatePending($t=>{if(n(Ce)==="solid"){const _o=k.get("backgroundColor")||n(Ke),go=k.get("backgroundOpacity")??n(vt);$t.canvas.background.mode="solid",$t.canvas.background.solid={color:_o,alpha:go/100},delete $t.canvas.background.gradient}else if(n(Ce)==="gradient"){const _o=k.get("backgroundGradient")||n(ws);$t.canvas.background.mode="gradient",$t.canvas.background.gradient=_o,delete $t.canvas.background.solid}if(n(Re)==="solid"){const _o=k.get("gridColor")||n(st),go=k.get("gridOpacity")??n(Je);$t.canvas.grid.mode="solid",$t.canvas.grid.solid={color:_o,alpha:go/100},delete $t.canvas.grid.gradient}else if(n(Re)==="gradient"){const _o=k.get("gridGradient")||n(vn);$t.canvas.grid.mode="gradient",$t.canvas.grid.gradient=_o,delete $t.canvas.grid.solid}}),c.update($t=>{var go,fs,Ms,zn,qs,Vn;$t.styles||($t.styles={}),$t.styles.candle||($t.styles.candle={}),$t.styles.candle.bar||($t.styles.candle.bar={}),console.log("🎨 Saving settings - Background Type:",n(Ce)),console.log("🎨 Saving settings - Grid Type:",n(Re));const _o=(fs=(go=$t.styles)==null?void 0:go.candle)==null?void 0:fs.type;if(_o&&console.log("🔒 Preserving chart type:",_o),n(Ce)==="solid"){const Ss=k.get("backgroundColor")||n(Ke),di=k.get("backgroundOpacity")??n(vt);console.log("🎨 Solid BG:",{bgColor:Ss,bgOpacity:di}),Ss&&($t.styles.backgroundColor=Ss,$t.styles.backgroundOpacity=di,$t.styles.backgroundType="solid",delete $t.styles.backgroundGradient)}else if(n(Ce)==="gradient"){const Ss=k.get("backgroundGradient")||n(ws);console.log("🎨 Gradient BG:",Ss),Ss&&Ss.stops&&Ss.stops.length>0?($t.styles.backgroundGradient=Ss,$t.styles.backgroundType="gradient",delete $t.styles.backgroundColor,delete $t.styles.backgroundOpacity,console.log("✅ Gradient background saved to $save.styles")):console.warn("⚠️ Invalid gradient data:",Ss)}if(n(Re)==="solid"){const Ss=k.get("gridColor")||n(st),di=k.get("gridOpacity")??100;console.log("🎨 Solid Grid:",{gridColor:Ss,gridOpacity:di}),Ss&&($t.styles.grid||($t.styles.grid={}),$t.styles.grid.horizontal||($t.styles.grid.horizontal={}),$t.styles.grid.vertical||($t.styles.grid.vertical={}),$t.styles.grid.horizontal.color=Ss,$t.styles.grid.vertical.color=Ss,$t.styles.gridOpacity=di,$t.styles.gridType="solid",delete $t.styles.gridGradient)}else if(n(Re)==="gradient"){const Ss=k.get("gridGradient")||n(vn);console.log("🎨 Gradient Grid:",Ss),Ss&&Ss.stops&&Ss.stops.length>0?($t.styles.gridGradient=Ss,$t.styles.gridType="gradient",(zn=(Ms=$t.styles.grid)==null?void 0:Ms.horizontal)==null||delete zn.color,(Vn=(qs=$t.styles.grid)==null?void 0:qs.vertical)==null||delete Vn.color,delete $t.styles.gridOpacity,console.log("✅ Gradient grid saved to $save.styles")):console.warn("⚠️ Invalid grid gradient data:",Ss)}try{const Ss=k.get("xAxisTickTextColor")||ci().xAxisTickTextColor,di=k.get("xAxisTickTextOpacity")??100,Mn=sa(Ss,di/100);uo.set($t.styles,"xAxis.tickText.color",Mn),uo.set($t.styles,"xAxis.tickText.opacity",di);const La=k.get("yAxisTickTextColor")||ci().yAxisTickTextColor,nn=k.get("yAxisTickTextOpacity")??100,tr=sa(La,nn/100);uo.set($t.styles,"yAxis.tickText.color",tr),uo.set($t.styles,"yAxis.tickText.opacity",nn)}catch(Ss){console.warn("Failed to persist axis tick text colors:",Ss)}try{const Ss=$t.styles.candle.bar;n(ct)&&(Ss.upColor=n(ce),Ss.downColor=n(we)),n(Ge)&&(Ss.upBorderColor=n(ze),Ss.downBorderColor=n(dt)),n(pt)&&(Ss.upWickColor=n(qe),Ss.downWickColor=n(me))}catch(Ss){console.warn("Failed to persist candle colors to $save.styles:",Ss)}return _o&&$t.styles.candle&&($t.styles.candle.type=_o,console.log("✅ Restored chart type:",_o)),$t}),v.confirm(),x(g,!0);try{window.__forceApplySavedCanvasColors=!0}catch{}r().applyCanvasColors&&r().applyCanvasColors(),a(!1)}else if(bt==="reset"){console.log("🔄 RESET CLICKED - Using theme manager"),v.reset();const $t=ci();x(Ce,"solid"),x(vt,D($t.backgroundOpacity)),x(Re,"solid"),x(Je,D($t.gridOpacity)),x(ot,100),x(nt,100),x(ct,!0),x(Ge,!0),x(pt,!0),x(ce,"#26a69a"),x(we,"#ef5350"),x(ze,"#26a69a"),x(dt,"#ef5350"),x(qe,"#26a69a"),x(me,"#ef5350");try{const _o=ci();if(c.update(go=>{go.styles||(go.styles={}),go.styles.backgroundType="solid",go.styles.backgroundColor=_o.backgroundColor,go.styles.backgroundOpacity=_o.backgroundOpacity,delete go.styles.backgroundGradient,go.styles.grid||(go.styles.grid={}),go.styles.grid.horizontal||(go.styles.grid.horizontal={}),go.styles.grid.vertical||(go.styles.grid.vertical={}),go.styles.gridType="solid",go.styles.gridOpacity=_o.gridOpacity,go.styles.grid.horizontal.color=_o.gridColor,go.styles.grid.vertical.color=_o.gridColor,delete go.styles.gridGradient;const fs=_o.xAxisTickTextColor,Ms=_o.yAxisTickTextColor,zn=sa(fs,1),qs=sa(Ms,1);uo.set(go.styles,"xAxis.tickText.color",zn),uo.set(go.styles,"xAxis.tickText.opacity",100),uo.set(go.styles,"yAxis.tickText.color",qs),uo.set(go.styles,"yAxis.tickText.opacity",100),go.styles.candle||(go.styles.candle={}),go.styles.candle.bar||(go.styles.candle.bar={});const Vn=go.styles.candle.bar;return Vn.upColor=n(ce),Vn.downColor=n(we),Vn.upBorderColor=n(ze),Vn.downBorderColor=n(dt),Vn.upWickColor=n(qe),Vn.downWickColor=n(me),go}),i()){const go=Sd(s().theme),fs=uo.merge({},go,s().styles);(xo=(kt=s().styles)==null?void 0:kt.candle)!=null&&xo.type&&uo.set(fs,"candle.type",s().styles.candle.type);const Ms=ci().xAxisTickTextColor,zn=ci().yAxisTickTextColor,qs=sa(Ms,1),Vn=sa(zn,1);uo.set(fs,"xAxis.tickText.color",qs),uo.set(fs,"yAxis.tickText.color",Vn);const Ss=Dc(fs);i().setStyles(Ss);try{const di=document.querySelector(".kline-main"),Mn=document.querySelector(".kline-widget");[di,Mn].forEach(La=>{if(La){const nn=La;nn.style.removeProperty("background"),nn.style.removeProperty("background-color"),nn.style.removeProperty("background-image"),nn.style.removeProperty("--chart-background-color")}})}catch{}try{window.__forceApplySavedCanvasColors=!0}catch{}r().applyCanvasColors&&r().applyCanvasColors()}}catch(_o){console.warn("Failed to apply default candle colors on reset:",_o)}Ja(),k.clear(),k.set("backgroundColor",$t.backgroundColor),k.set("backgroundOpacity",$t.backgroundOpacity),k.set("gridColor",$t.gridColor),k.set("gridOpacity",$t.gridOpacity),k.set("xAxisTickTextColor",$t.xAxisTickTextColor),k.set("xAxisTickTextOpacity",100),k.set("yAxisTickTextColor",$t.yAxisTickTextColor),k.set("yAxisTickTextOpacity",100)}else console.log("🚫 CANCEL CLICKED - Using theme manager"),v.cancel(),a(!1);x(S,!1),x(M,!1),x(I,!1),x(C,!1),x(W,!1),x(le,!1),jl()}var de=lj(),De=Rt(de);av(De,{title:"Chart Setting",width:"min(90vw, 700px)",get show(){return a()},set show(bt){a(bt)},get theme(){return s().theme},click:We,buttons:["confirm","reset"],children:(bt,kt)=>{var xo=aj(),$t=m(xo),_o=m($t),go=m(_o);go.__click=[ON,y];var fs=p(go,2);fs.__click=[VN,y];var Ms=p(fs,2);Ms.__click=[WN,y];var zn=p(Ms,2);Te(zn,()=>n(Q),di=>{var Mn=HN();Mn.__click=[qN,y],Se(()=>{ii(Mn,"bg-primary",n(y)==="renko"),ii(Mn,"text-primary-content",n(y)==="renko"),ii(Mn,"hover:bg-base-200",n(y)!=="renko")}),O(di,Mn)});var qs=p(zn,2);Te(qs,()=>n(Gt),di=>{var Mn=UN();Mn.__click=[GN,y],Se(()=>{ii(Mn,"bg-primary",n(y)==="pnf"),ii(Mn,"text-primary-content",n(y)==="pnf"),ii(Mn,"hover:bg-base-200",n(y)!=="pnf")}),O(di,Mn)}),f(_o),f($t);var Vn=p($t,2),Ss=m(Vn);Te(Ss,()=>n(y)==="canvas",di=>{var Mn=YN(),La=p(m(Mn),2),nn=p(m(La),2),tr=m(nn),Ur=m(tr);Ur.value=(Ur.__value="solid")==null?"":"solid";var cl=p(Ur);cl.value=(cl.__value="gradient")==null?"":"gradient",f(tr);var ui=p(tr,2);const Yr=Qe(()=>{var ht;return`background: ${(n(Ce)==="gradient"?((ht=k.get("backgroundGradient"))==null?void 0:ht.css)||es(n(ws))||"linear-gradient(0deg, #ffffff 0%, #000000 100%)":k.get("backgroundColor")||ci().backgroundColor)??""}`});ui.__click=[MN,Ce,T,S,M,W,le,I,C,jl],f(nn),f(La);var Ra=p(La,2),ga=p(m(Ra),2),na=m(ga),nl=m(na);nl.value=(nl.__value="solid")==null?"":"solid";var mi=p(nl);mi.value=(mi.__value="gradient")==null?"":"gradient",f(na);var Ha=p(na,2);const lr=Qe(()=>{var ht;return`background: ${(n(Re)==="gradient"?((ht=k.get("gridGradient"))==null?void 0:ht.css)||es(n(vn))||"linear-gradient(0deg, #f3f3f3 0%, #1c1c1c 100%)":k.get("gridColor")||n(st)||ci().gridColor)??""}`});Ha.__click=[TN,Re,z,M,S,W,le,I,C],f(ga),f(Ra);var zi=p(Ra,2),hr=p(m(zi),2),xa=m(hr);const Qa=Qe(()=>`background: ${(k.get("xAxisTickTextColor")||ci().xAxisTickTextColor)??""}`);xa.__click=[AN,j,I,S,M,W,le,C,jl],f(hr),f(zi);var ue=p(zi,2),Fe=p(m(ue),2),ut=m(Fe);const Xe=Qe(()=>`background: ${(k.get("yAxisTickTextColor")||ci().yAxisTickTextColor)??""}`);ut.__click=[LN,B,C,S,M,W,le,I,jl],f(Fe),f(ue),f(Mn),Se(()=>{Nt(ui,"style",n(Yr)),Nt(Ha,"style",n(lr)),Nt(xa,"style",n(Qa)),Nt(ut,"style",n(Xe))}),rs(tr,()=>n(Ce),ht=>x(Ce,ht)),rs(na,()=>n(Re),ht=>x(Re,ht)),O(di,Mn)},di=>{var Mn=So(),La=Rt(Mn);Te(La,()=>n(y)==="other",nn=>{var tr=tj(),Ur=p(m(tr),2);Vs(Ur,21,()=>tt,_n,(cl,ui)=>{var Yr=ej(),Ra=m(Yr),ga=m(Ra,!0);f(Ra);var na=p(Ra,2);Te(na,()=>n(ui).type==="select",nl=>{var mi=XN();dm(mi,()=>Ze.get(n(ui).key)??n(ui).default);var Ha;mi.__change=[KN,Ec,ui],Vs(mi,21,()=>n(ui).options||[],_n,(lr,zi)=>{var hr=ZN(),xa={},Qa=m(hr,!0);f(hr),Se(()=>{xa!==(xa=n(zi).value)&&(hr.value=(hr.__value=n(zi).value)==null?"":n(zi).value),Ve(Qa,n(zi).label)}),O(lr,hr)}),f(mi),Se(()=>{Ha!==(Ha=Ze.get(n(ui).key)??n(ui).default)&&(mi.value=(mi.__value=Ze.get(n(ui).key)??n(ui).default)==null?"":Ze.get(n(ui).key)??n(ui).default,zf(mi,Ze.get(n(ui).key)??n(ui).default))}),O(nl,mi)},nl=>{var mi=So(),Ha=Rt(mi);Te(Ha,()=>n(ui).type==="switch",lr=>{var zi=QN();Jt(zi),Se(()=>wv(zi,Ze.get(n(ui).key)??n(ui).default)),zi.__change=[JN,Ec,ui],O(lr,zi)},null,!0),O(nl,mi)}),f(Yr),Se(()=>Ve(ga,n(ui).label)),O(cl,Yr)}),f(Ur),f(tr),O(nn,tr)},nn=>{var tr=So(),Ur=Rt(tr);Te(Ur,()=>n(y)==="candle",cl=>{var ui=oj(),Yr=p(m(ui),2),Ra=m(Yr),ga=m(Ra),na=m(ga);Jt(na),na.__change=[jN,ct,be],pn(2),f(ga);var nl=p(ga,2),mi=m(nl),Ha=p(m(mi),2);Ha.__click=[zN,ne,S,M,I,C,W,le,jl,$],f(mi);var lr=p(mi,2),zi=p(m(lr),2);zi.__click=[FN,te,S,M,I,C,W,le,jl,F],f(lr),f(nl),f(Ra);var hr=p(Ra,2),xa=m(hr),Qa=m(xa);Jt(Qa),Qa.__change=[RN,Ge,be],pn(2),f(xa);var ue=p(xa,2),Fe=m(ue),ut=p(m(Fe),2);ut.__click=[$N,oe,S,M,I,C,W,le,jl,V],f(Fe);var Xe=p(Fe,2),ht=p(m(Xe),2);ht.__click=[DN,U,S,M,I,C,W,le,jl,K],f(Xe),f(ue),f(hr);var ao=p(hr,2),It=m(ao),eo=m(It);Jt(eo),eo.__change=[BN,pt,be],pn(2),f(It);var Mo=p(It,2),ho=m(Mo),to=p(m(ho),2);to.__click=[EN,J,S,M,I,C,W,le,jl,Y],f(ho);var ds=p(ho,2),js=p(m(ds),2);js.__click=[NN,se,S,M,I,C,W,le,jl,Z],f(ds),f(Mo),f(ao),f(Yr),f(ui),Se(()=>{Nt(Ha,"style",`background-color: ${n(ce)??""}`),Ha.disabled=!n(ct),ii(Ha,"opacity-50",!n(ct)),Nt(zi,"style",`background-color: ${n(we)??""}`),zi.disabled=!n(ct),ii(zi,"opacity-50",!n(ct)),Nt(ut,"style",`background-color: ${n(ze)??""}`),ut.disabled=!n(Ge),ii(ut,"opacity-50",!n(Ge)),Nt(ht,"style",`background-color: ${n(dt)??""}`),ht.disabled=!n(Ge),ii(ht,"opacity-50",!n(Ge)),Nt(to,"style",`background-color: ${n(qe)??""}`),to.disabled=!n(pt),ii(to,"opacity-50",!n(pt)),Nt(js,"style",`background-color: ${n(me)??""}`),js.disabled=!n(pt),ii(js,"opacity-50",!n(pt))}),_v(na,()=>n(ct),Si=>x(ct,Si)),_v(Qa,()=>n(Ge),Si=>x(Ge,Si)),_v(eo,()=>n(pt),Si=>x(pt,Si)),O(cl,ui)},cl=>{var ui=So(),Yr=Rt(ui);Te(Yr,()=>n(y)==="renko",Ra=>{var ga=sj(),na=p(m(ga),2),nl=m(na),mi=m(nl),Ha=m(mi);Jt(Ha),Ha.__change=[hN,it,At],pn(2),f(mi),f(nl);var lr=p(nl,2),zi=m(lr),hr=p(m(zi),2);hr.__change=[_N,Vt,At];var xa=m(hr);xa.value=(xa.__value="close")==null?"":"close";var Qa=p(xa);Qa.value=(Qa.__value="open")==null?"":"open";var ue=p(Qa);ue.value=(ue.__value="high")==null?"":"high";var Fe=p(ue);Fe.value=(Fe.__value="low")==null?"":"low",f(hr),f(zi);var ut=p(zi,2),Xe=p(m(ut),2);Xe.__change=[yN,wt,At];var ht=m(Xe);ht.value=(ht.__value="ATR")==null?"":"ATR",f(Xe),f(ut);var ao=p(ut,2),It=p(m(ao),2);Jt(It),It.__input=[bN,Yt,At],f(ao),f(lr),f(na),f(ga),Se(()=>{wv(Ha,n(it)),cu(It,n(Yt))}),rs(hr,()=>n(Vt),eo=>x(Vt,eo)),rs(Xe,()=>n(wt),eo=>x(wt,eo)),O(Ra,ga)},Ra=>{var ga=So(),na=Rt(ga);Te(na,()=>n(y)==="pnf",nl=>{var mi=rj(),Ha=p(m(mi),2),lr=m(Ha),zi=m(lr),hr=p(m(zi),2);hr.__change=[xN,no,Ks];var xa=m(hr);xa.value=(xa.__value="ATR")==null?"":"ATR";var Qa=p(xa);Qa.value=(Qa.__value="absolute")==null?"":"absolute";var ue=p(Qa);ue.value=(ue.__value="percent")==null?"":"percent",f(hr),f(zi);var Fe=p(zi,2);Te(Fe,()=>n(no)==="ATR",Rs=>{var Zs=nj(),gn=p(m(Zs),2);Jt(gn),gn.__input=[kN,Eo,Ks],f(Zs),Se(()=>cu(gn,n(Eo))),O(Rs,Zs)},Rs=>{var Zs=ij(),gn=m(Zs),Wn=m(gn);f(gn);var Tn=p(gn,2);Jt(Tn),Tn.__input=[wN,Do,Ks],f(Zs),Se(()=>{Ve(Wn,`Box Size ${(n(no)==="percent"?"(%)":"(Price)")??""}`),cu(Tn,n(Do))}),O(Rs,Zs)}),f(lr);var ut=p(lr,2),Xe=p(m(ut),2);Jt(Xe),Xe.__input=[SN,bs,Ks],f(ut);var ht=p(ut,2),ao=p(m(ht),2),It=m(ao),eo=p(m(It),2),Mo=m(eo);Jt(Mo),Mo.__input=[CN,Is,Ks];var ho=p(Mo,2),to=m(ho,!0);f(ho),f(eo),f(It);var ds=p(It,2),js=p(m(ds),2),Si=m(js);Jt(Si),Si.__input=[PN,qi,Ks];var $r=p(Si,2),pa=m($r,!0);f($r),f(js),f(ds),f(ao),f(ht);var En=p(ht,2),za=m(En);za.__click=[IN,no,Do,Eo,bs,Is,qi,Ks],f(En),f(Ha),f(mi),Se(()=>{cu(Xe,n(bs)),Ve(to,n(Is)),Ve(pa,n(qi))}),rs(hr,()=>n(no),Rs=>x(no,Rs)),Ho(Mo,()=>n(Is),Rs=>x(Is,Rs)),Ho(Si,()=>n(qi),Rs=>x(qi,Rs)),O(nl,mi)},null,!0),O(Ra,ga)},!0),O(cl,ui)},!0),O(nn,tr)},!0),O(di,Mn)}),f(Vn),f(xo),Se(()=>{ii(go,"bg-primary",n(y)==="canvas"),ii(go,"text-primary-content",n(y)==="canvas"),ii(go,"hover:bg-base-200",n(y)!=="canvas"),ii(fs,"bg-primary",n(y)==="other"),ii(fs,"text-primary-content",n(y)==="other"),ii(fs,"hover:bg-base-200",n(y)!=="other"),ii(Ms,"bg-primary",n(y)==="candle"),ii(Ms,"text-primary-content",n(y)==="candle"),ii(Ms,"hover:bg-base-200",n(y)!=="candle")}),O(bt,xo)},$$slots:{default:!0}});var Ee=p(De,2);Te(Ee,()=>n(S),bt=>{var kt=Qe(()=>k.get("backgroundColor")||ci().backgroundColor);iv(bt,{get show(){return n(S)},set show(xo){x(S,D(xo))},get selectedColor(){return n(kt)},get opacity(){return n(vt)},$$events:{colorChange:ol,opacityChange:Xi}})});var xe=p(Ee,2);Te(xe,()=>n(M),bt=>{var kt=Qe(()=>k.get("gridColor")||n(st)||ci().gridColor);iv(bt,{get show(){return n(M)},set show(xo){x(M,D(xo))},get selectedColor(){return n(kt)},get opacity(){return n(Je)},$$events:{colorChange:fc,opacityChange:rd}})});var gt=p(xe,2);Te(gt,()=>n(I),bt=>{var kt=Qe(()=>k.get("xAxisTickTextColor")||ci().xAxisTickTextColor);iv(bt,{get show(){return n(I)},set show(xo){x(I,D(xo))},get selectedColor(){return n(kt)},get opacity(){return n(ot)},$$events:{colorChange:ml,opacityChange:Wl}})});var at=p(gt,2);Te(at,()=>n(C),bt=>{var kt=Qe(()=>k.get("yAxisTickTextColor")||ci().yAxisTickTextColor);iv(bt,{get show(){return n(C)},set show(xo){x(C,D(xo))},get selectedColor(){return n(kt)},get opacity(){return n(nt)},$$events:{colorChange:Jl,opacityChange:sl}})});var jt=p(at,2);Te(jt,()=>n($),bt=>{iv(bt,{get show(){return n($)},set show(kt){x($,D(kt))},get selectedColor(){return n(ce)},$$events:{colorChange:Td}})});var Lt=p(jt,2);Te(Lt,()=>n(F),bt=>{iv(bt,{get show(){return n(F)},set show(kt){x(F,D(kt))},get selectedColor(){return n(we)},$$events:{colorChange:_d}})});var Mt=p(Lt,2);Te(Mt,()=>n(V),bt=>{iv(bt,{get show(){return n(V)},set show(kt){x(V,D(kt))},get selectedColor(){return n(ze)},$$events:{colorChange:Fl}})});var Io=p(Mt,2);Te(Io,()=>n(K),bt=>{iv(bt,{get show(){return n(K)},set show(kt){x(K,D(kt))},get selectedColor(){return n(dt)},$$events:{colorChange:qa}})});var Bo=p(Io,2);Te(Bo,()=>n(Y),bt=>{iv(bt,{get show(){return n(Y)},set show(kt){x(Y,D(kt))},get selectedColor(){return n(qe)},$$events:{colorChange:td}})});var hs=p(Bo,2);Te(hs,()=>n(Z),bt=>{iv(bt,{get show(){return n(Z)},set show(kt){x(Z,D(kt))},get selectedColor(){return n(me)},$$events:{colorChange:Nc}})});var is=p(hs,2);Te(is,()=>n(W),bt=>{t2(bt,{get show(){return n(W)},set show(kt){x(W,D(kt))},get initialGradient(){return n(ws)},$$events:{gradientChange:Uc}})});var Es=p(is,2);Te(Es,()=>n(le),bt=>{t2(bt,{get show(){return n(le)},set show(kt){x(le,D(kt))},get initialGradient(){return n(vn)},$$events:{gradientChange:Nl}})}),O(o,de),Tc()}Hd(["click","change","input"]);var cj=(o,e,t)=>e(n(t).key,o.currentTarget.value),dj=re("<option> </option>"),uj=re('<select class="select select-bordered select-sm w-full"></select>'),pj=(o,e,t)=>e(n(t).key,o.currentTarget.checked),vj=re('<input type="checkbox" class="toggle toggle-sm">'),fj=re('<span class="text-base-content/70 text-right"> </span> <!>',1),mj=(o,e)=>x(e,!0),gj=re('<div class="grid grid-cols-[3fr_2fr_3fr_2fr] gap-5 mx-7 my-5 items-center"><!> <div class="col-span-4 mt-4 pt-4 border-t border-base-300"><button class="btn btn-outline btn-primary w-full">Chart Setting</button></div></div>'),hj=re("<!> <!>",1);function _j(o,e){Mc(e,!0);const t=Au(),s=()=>ua(d,"$chart",t),i=()=>ua(c,"$save",t);let r=Qs(e,"show",15);const a=new j0,l=vc("ctx"),c=vc("save"),d=vc("chart");let v=ee(!1);const g=[{key:"candle.priceMark.last.show",text:"last_price_show",component:"switch"},{key:"candle.priceMark.high.show",text:"high_price_show",component:"switch"},{key:"candle.priceMark.low.show",text:"low_price_show",component:"switch"},{key:"indicator.lastValueMark.show",text:"indicator_last_value_show",component:"switch"},{key:"yAxis.reverse",text:"reverse_coordinate",component:"switch"},{key:"grid.show",text:"grid_show",component:"switch"}];function _(z,j){var K,Y,Z,ne,te,oe,U,J,se,W,le,ye,Ce,Re,Ke,st,vt,Je,ot,nt,tt,Ze,ct,Ge,pt,ce,we;const B=(K=s())==null?void 0:K.getStyles(),$=uo.get(B,z);if(z==="yAxis.reverse")try{(Y=s())==null||Y.setPaneOptions({axis:{reverse:j}}),c.update(ze=>(uo.set(ze.styles,z,j),ze)),a.set(z,j);return}catch(ze){console.warn("setPaneOptions not available, falling back to styles:",ze)}if($==j)return;a.set(z,j),c.update(ze=>(uo.set(ze.styles,z,j),ze));const F=Sd(i().theme);console.log("🟡 Settings.update key:",z,"value:",j,"theme:",i().theme),console.log("🎨 theme axis colors:",(te=(ne=(Z=F==null?void 0:F.xAxis)==null?void 0:Z.tickText)==null?void 0:ne.style)==null?void 0:te.color,(J=(U=(oe=F==null?void 0:F.yAxis)==null?void 0:oe.tickText)==null?void 0:U.style)==null?void 0:J.color),console.log("💾 saved axis colors:",uo.get(i().styles,"xAxis.tickText.style.color"),uo.get(i().styles,"yAxis.tickText.style.color"));const V=uo.merge({},F,i().styles);try{const ze=(le=(W=(se=F==null?void 0:F.xAxis)==null?void 0:se.tickText)==null?void 0:W.style)==null?void 0:le.color,dt=(Re=(Ce=(ye=F==null?void 0:F.yAxis)==null?void 0:ye.tickText)==null?void 0:Ce.style)==null?void 0:Re.color;ze&&((st=(Ke=V==null?void 0:V.xAxis)==null?void 0:Ke.tickText)!=null&&st.style)&&(V.xAxis.tickText.style.color=ze,(vt=V==null?void 0:V.xAxis)!=null&&vt.tickText&&(delete V.xAxis.tickText.color,delete V.xAxis.tickText.opacity)),dt&&((ot=(Je=V==null?void 0:V.yAxis)==null?void 0:Je.tickText)!=null&&ot.style)&&(V.yAxis.tickText.style.color=dt,(nt=V==null?void 0:V.yAxis)!=null&&nt.tickText&&(delete V.yAxis.tickText.color,delete V.yAxis.tickText.opacity))}catch{}console.log("🔄 merged axis colors before apply:",(ct=(Ze=(tt=V==null?void 0:V.xAxis)==null?void 0:tt.tickText)==null?void 0:Ze.style)==null?void 0:ct.color,(ce=(pt=(Ge=V==null?void 0:V.yAxis)==null?void 0:Ge.tickText)==null?void 0:pt.style)==null?void 0:ce.color),(we=s())==null||we.setStyles(Dc(V)),setTimeout(()=>{var me,Q,it,Vt,wt,Yt,At,Gt,no,Do,Eo;const ze=((me=s())==null?void 0:me.getStyles())||{},dt=((Vt=(it=(Q=ze==null?void 0:ze.xAxis)==null?void 0:Q.tickText)==null?void 0:it.style)==null?void 0:Vt.color)??((Yt=(wt=ze==null?void 0:ze.xAxis)==null?void 0:wt.tickText)==null?void 0:Yt.color),qe=((no=(Gt=(At=ze==null?void 0:ze.yAxis)==null?void 0:At.tickText)==null?void 0:Gt.style)==null?void 0:no.color)??((Eo=(Do=ze==null?void 0:ze.yAxis)==null?void 0:Do.tickText)==null?void 0:Eo.color);console.log("✅ chart axis colors after apply:",dt,qe)},0)}function y(z){var j,B,$,F,V,K,Y,Z,ne,te,oe,U,J,se,W,le,ye,Ce,Re,Ke,st,vt,Je,ot,nt,tt,Ze;if(z==="reset"){const ct=(B=(j=i().styles)==null?void 0:j.candle)==null?void 0:B.type,Ge=Sd(i().theme),pt=i().styles;g.forEach(we=>{uo.unset(pt,we.key)}),c.update(we=>(we.styles=pt,ct&&(we.styles.candle||(we.styles.candle={}),we.styles.candle.type=ct),we));const ce=uo.merge({},Ge,i().styles);console.log("🟠 Settings.reset theme:",i().theme),console.log("🎨 default axis colors:",(V=(F=($=Ge==null?void 0:Ge.xAxis)==null?void 0:$.tickText)==null?void 0:F.style)==null?void 0:V.color,(Z=(Y=(K=Ge==null?void 0:Ge.yAxis)==null?void 0:K.tickText)==null?void 0:Y.style)==null?void 0:Z.color);try{const we=(oe=(te=(ne=Ge==null?void 0:Ge.xAxis)==null?void 0:ne.tickText)==null?void 0:te.style)==null?void 0:oe.color,ze=(se=(J=(U=Ge==null?void 0:Ge.yAxis)==null?void 0:U.tickText)==null?void 0:J.style)==null?void 0:se.color;we&&((le=(W=ce==null?void 0:ce.xAxis)==null?void 0:W.tickText)!=null&&le.style)&&(ce.xAxis.tickText.style.color=we,(ye=ce==null?void 0:ce.xAxis)!=null&&ye.tickText&&(delete ce.xAxis.tickText.color,delete ce.xAxis.tickText.opacity)),ze&&((Re=(Ce=ce==null?void 0:ce.yAxis)==null?void 0:Ce.tickText)!=null&&Re.style)&&(ce.yAxis.tickText.style.color=ze,(Ke=ce==null?void 0:ce.yAxis)!=null&&Ke.tickText&&(delete ce.yAxis.tickText.color,delete ce.yAxis.tickText.opacity))}catch{}console.log("🔄 merged axis colors on reset:",(Je=(vt=(st=ce==null?void 0:ce.xAxis)==null?void 0:st.tickText)==null?void 0:vt.style)==null?void 0:Je.color,(tt=(nt=(ot=ce==null?void 0:ce.yAxis)==null?void 0:ot.tickText)==null?void 0:nt.style)==null?void 0:tt.color),(Ze=s())==null||Ze.setStyles(Dc(ce)),setTimeout(()=>{var qe,me,Q,it,Vt,wt,Yt,At,Gt,no,Do;const we=((qe=s())==null?void 0:qe.getStyles())||{},ze=((it=(Q=(me=we==null?void 0:we.xAxis)==null?void 0:me.tickText)==null?void 0:Q.style)==null?void 0:it.color)??((wt=(Vt=we==null?void 0:we.xAxis)==null?void 0:Vt.tickText)==null?void 0:wt.color),dt=((Gt=(At=(Yt=we==null?void 0:we.yAxis)==null?void 0:Yt.tickText)==null?void 0:At.style)==null?void 0:Gt.color)??((Do=(no=we==null?void 0:we.yAxis)==null?void 0:no.tickText)==null?void 0:Do.color);console.log("✅ chart axis colors after reset apply:",ze,dt)},0),k()}else r(!1)}function k(){let z=s();if(!z)return;const j=z.getStyles()??{};g.forEach(B=>{const $=uo.get(j,B.key);B.key==="yAxis.reverse"?a.set(B.key,$||!1):a.set(B.key,$)})}Nd(l,z=>z.initDone).subscribe(k),zr(()=>{r()&&s()&&k()});var M=hj(),I=Rt(M),C=Qe(()=>Nb());av(I,{get title(){return n(C)},width:760,get show(){return r()},set show(z){r(z)},get theme(){return i().theme},click:y,buttons:["confirm","reset"],children:(z,j)=>{var B=gj(),$=m(B);Vs($,17,()=>g,_n,(K,Y)=>{var Z=fj(),ne=Rt(Z),te=m(ne,!0);Se(()=>{var U;return Ve(te,(U=yv[n(Y).text])==null?void 0:U.call(yv))}),f(ne);var oe=p(ne,2);Te(oe,()=>n(Y).component==="select",U=>{var J=uj();dm(J,()=>a.get(n(Y).key));var se;J.__change=[cj,_,Y],Vs(J,21,()=>n(Y).dataSource||[],_n,(W,le)=>{var ye=dj(),Ce={},Re=m(ye,!0);Se(()=>{var Ke;return Ve(Re,((Ke=yv[n(le).text])==null?void 0:Ke.call(yv))||n(le).text)}),f(ye),Se(()=>{Ce!==(Ce=n(le).key)&&(ye.value=(ye.__value=n(le).key)==null?"":n(le).key)}),O(W,ye)}),f(J),Se(()=>{se!==(se=a.get(n(Y).key))&&(J.value=(J.__value=a.get(n(Y).key))==null?"":a.get(n(Y).key),zf(J,a.get(n(Y).key)))}),O(U,J)},U=>{var J=So(),se=Rt(J);Te(se,()=>n(Y).component==="switch",W=>{var le=vj();Jt(le),Se(()=>wv(le,!!a.get(n(Y).key))),le.__change=[pj,_,Y],O(W,le)},null,!0),O(U,J)}),O(K,Z)});var F=p($,2),V=m(F);V.__click=[mj,v],f(F),f(B),O(z,B)},$$slots:{default:!0}});var T=p(I,2);Qx(T,{get show(){return n(v)},set show(z){x(v,D(z))}}),O(o,M),Tc()}Hd(["change","click"]);var yj=re('<img alt="screenshot" class="w-[500px] mt-5">');function bj(o,e){Mc(e,!0);const t=Au(),s=()=>ua(r,"$save",t);let i=Qs(e,"show",15);const r=vc("save");function a(l){if(l==="confirm"){const c=document.createElement("a");c.download="screenshot",c.href=e.url,document.body.appendChild(c),c.click(),c.remove()}i(!1)}av(o,{title:"Screenshot",width:540,get show(){return i()},set show(l){i(l)},get theme(){return s().theme},click:a,children:(l,c)=>{var d=yj();Se(()=>Nt(d,"src",e.url)),O(l,d)},$$slots:{default:!0}}),Tc()}function xj(o,e,t){const s=o.target;Wa(t,ys(e).timezone=s.value,ys(e))}var wj=re("<option> </option>"),kj=re('<div class="flex justify-center items-center min-h-[70px]"><select class="select select-bordered w-[70%]"></select></div>');function Sj(o,e){Mc(e,!0);const t=Au(),s=()=>ua(r,"$save",t);let i=Qs(e,"show",15);const r=vc("save"),a=xk();function l(d){i(!1)}var c=Qe(()=>Fb());av(o,{get title(){return n(c)},width:400,get show(){return i()},set show(d){i(d)},get theme(){return s().theme},click:l,children:(d,v)=>{var g=kj(),_=m(g);dm(_,()=>s().timezone);var y;_.__change=[xj,s,r],Vs(_,21,()=>a,_n,(k,S)=>{var M=wj(),I={},C=m(M,!0);Se(()=>Ve(C,yv[n(S).text]())),f(M),Se(()=>{I!==(I=n(S).key)&&(M.value=(M.__value=n(S).key)==null?"":n(S).key)}),O(k,M)}),f(_),f(g),Se(()=>{y!==(y=s().timezone)&&(_.value=(_.__value=s().timezone)==null?"":s().timezone,zf(_,s().timezone))}),O(d,g)},$$slots:{default:!0}}),Tc()}Hd(["change"]);var Cj=re('<div class="warning-banner"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 9v2m0 4h.01M10.29 3.86l-7.6 13.17A1 1 0 003.53 19h16.94a1 1 0 00.84-1.5L13.71 3.86a1 1 0 00-1.73 0z"></path></svg> <span> </span></div>'),Pj=(o,e,t)=>e(n(t),o),Ij=re('<div class="selection-badge"><svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M13.3 4.3L6 11.6 2.7 8.3l1.1-1.1L6 9.4l6.2-6.2 1.1 1.1z" fill="currentColor" stroke="currentColor" stroke-width="0.5"></path></svg></div>'),Mj=re('<button class="chart-card"><div class="card-bg"></div> <!> <div class="icon-container"><div class="icon-glow"></div> <!></div> <span class="chart-name"> </span> <div class="shine-effect"></div></button>'),Tj=re(`<!> <div class="premium-grid"></div> <style>/* ===== PREMIUM GRID LAYOUT ===== */
    .premium-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      padding: 8px;
    }
    
    @media (max-width: 640px) {
      .premium-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        padding: 6px;
      }
    }
    
    @media (max-width: 480px) {
      .premium-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        padding: 8px;
      }
    }
    
    /* ===== PREMIUM CHART CARD ===== */
    .chart-card {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 20px 12px 18px;
      background: linear-gradient(145deg, 
        rgba(30, 35, 48, 0.6) 0%, 
        rgba(20, 25, 35, 0.4) 100%);
      border: 1.5px solid rgba(255, 255, 255, 0.06);
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    
    @media (max-width: 640px) {
      .chart-card {
        padding: 16px 10px 14px;
        gap: 8px;
      }
    }
    
    @media (max-width: 480px) {
      .chart-card {
        padding: 22px 14px 20px;
        gap: 12px;
      }
    }
    
    /* Animated background */
    .card-bg {
      position: absolute;
      inset: 0;
      background: linear-gradient(145deg,
        rgba(45, 55, 75, 0.3) 0%,
        rgba(30, 40, 60, 0.2) 50%,
        rgba(20, 30, 50, 0.3) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 0;
    }
    
    /* Hover state */
    .chart-card:hover {
      transform: translateY(-3px);
      border-color: rgba(255, 255, 255, 0.12);
      background: linear-gradient(145deg, 
        rgba(35, 45, 60, 0.7) 0%, 
        rgba(25, 35, 50, 0.5) 100%);
      box-shadow: 
        0 12px 40px rgba(0, 0, 0, 0.4),
        0 6px 20px rgba(20, 30, 50, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.08);
    }
    
    .chart-card:hover .card-bg {
      opacity: 1;
    }
    
    /* Active state */
    .chart-card.active {
      background: linear-gradient(145deg, 
        rgba(30, 50, 80, 0.5) 0%,
        rgba(20, 40, 70, 0.4) 50%,
        rgba(25, 45, 75, 0.5) 100%);
      border-color: rgba(70, 120, 180, 0.4);
      box-shadow: 
        0 8px 32px rgba(30, 60, 100, 0.3),
        0 4px 16px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 0 1px rgba(60, 100, 150, 0.2);
      transform: translateY(-2px);
    }
    
    .chart-card.active .card-bg {
      background: linear-gradient(145deg,
        rgba(40, 65, 95, 0.4) 0%,
        rgba(30, 55, 85, 0.3) 50%,
        rgba(35, 60, 90, 0.4) 100%);
      opacity: 1;
    }
    
    .chart-card.active:hover {
      transform: translateY(-2px);
      border-color: rgba(80, 130, 190, 0.5);
    }
    
    /* ===== SELECTION BADGE ===== */
    .selection-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, 
        rgba(70, 120, 180, 0.9) 0%, 
        rgba(50, 100, 160, 0.85) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 
        0 3px 10px rgba(30, 60, 100, 0.4),
        0 1px 3px rgba(0, 0, 0, 0.3);
      animation: badgePulse 2.5s ease-in-out infinite;
    }
    
    @keyframes badgePulse {
      0%, 100% {
        transform: scale(1);
        box-shadow: 
          0 3px 10px rgba(30, 60, 100, 0.4),
          0 1px 3px rgba(0, 0, 0, 0.3);
      }
      50% {
        transform: scale(1.05);
        box-shadow: 
          0 4px 14px rgba(40, 70, 110, 0.5),
          0 2px 5px rgba(0, 0, 0, 0.35);
      }
    }
    
    /* ===== ICON CONTAINER ===== */
    .icon-container {
      position: relative;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      background: linear-gradient(145deg, 
        rgba(40, 50, 65, 0.5) 0%, 
        rgba(25, 35, 50, 0.3) 100%);
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 
        0 3px 12px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.06);
      z-index: 1;
    }
    
    @media (max-width: 640px) {
      .icon-container {
        width: 42px;
        height: 42px;
        border-radius: 10px;
      }
    }
    
    @media (max-width: 480px) {
      .icon-container {
        width: 50px;
        height: 50px;
        border-radius: 12px;
      }

    }
    
    .icon-glow {
      position: absolute;
      inset: -3px;
      background: linear-gradient(145deg, 
        rgba(50, 90, 140, 0.3) 0%, 
        rgba(35, 70, 120, 0.25) 100%);
      border-radius: inherit;
      opacity: 0;
      filter: blur(10px);
      transition: opacity 0.3s ease;
      z-index: -1;
    }
    
    .chart-card:hover .icon-container {
      transform: scale(1.06);
      background: linear-gradient(145deg, 
        rgba(50, 65, 85, 0.6) 0%, 
        rgba(35, 50, 70, 0.4) 100%);
      box-shadow: 
        0 5px 18px rgba(0, 0, 0, 0.25),
        0 2px 10px rgba(30, 50, 80, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    
    .chart-card.active .icon-container {
      background: linear-gradient(145deg, 
        rgba(40, 70, 110, 0.5) 0%, 
        rgba(30, 60, 95, 0.4) 100%);
      border-color: rgba(70, 110, 160, 0.3);
      transform: scale(1.04);
      box-shadow: 
        0 6px 20px rgba(30, 60, 100, 0.3),
        0 3px 12px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.12);
    }
    
    .chart-card.active .icon-glow {
      opacity: 0.5;
    }
    
    /* ===== CHART ICON ===== */
    :global(.chart-icon) {
      color: rgba(200, 210, 230, 0.85);
      filter: drop-shadow(0 2px 5px rgba(0, 0, 0, 0.3));
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 2;
    }
    
    .chart-card:hover :global(.chart-icon) {
      color: rgba(220, 230, 245, 0.95);
      filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.35));
      transform: scale(1.05);
    }
    
    .chart-card.active :global(.chart-icon) {
      color: rgba(160, 200, 240, 1);
      filter: drop-shadow(0 4px 12px rgba(40, 80, 130, 0.5));
      transform: scale(1.03);
    }
    
    /* ===== CHART NAME ===== */
    .chart-name {
      color: rgba(180, 190, 210, 0.85);
      font-size: 12px;
      font-weight: 500;
      text-align: center;
      line-height: 1.3;
      letter-spacing: 0.4px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1;
    }
    
    @media (max-width: 640px) {
      .chart-name {
        font-size: 11px;
      }
    }
    
    @media (max-width: 480px) {
      .chart-name {
        font-size: 12.5px;
      }
    }
    
    .chart-card:hover .chart-name {
      color: rgba(210, 220, 235, 0.95);
      transform: translateY(-1px);
    }
    
    .chart-card.active .chart-name {
      color: rgba(180, 210, 240, 1);
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    
    /* ===== SHINE EFFECT ===== */
    .shine-effect {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        115deg,
        transparent 25%,
        rgba(255, 255, 255, 0.08) 45%,
        rgba(200, 220, 240, 0.12) 50%,
        rgba(255, 255, 255, 0.08) 55%,
        transparent 75%
      );
      transform: translateX(-100%) skewX(-15deg);
      transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .chart-card:hover .shine-effect {
      transform: translateX(100%) skewX(-15deg);
    }
    
    /* ===== LIGHT THEME ===== */
    :global([data-theme="light"]) .chart-card {
      background: linear-gradient(145deg, #ffffff 0%, #f9fbff 100%);
      border-color: rgba(59, 130, 246, 0.15);
      box-shadow: 
        0 2px 6px rgba(59, 130, 246, 0.08),
        0 1px 2px rgba(0, 0, 0, 0.04);
    }
    
    :global([data-theme="light"]) .card-bg {
      background: transparent;
      opacity: 0;
    }
    
    :global([data-theme="light"]) .chart-card:hover {
      background: #ffffff;
      border-color: rgba(59, 130, 246, 0.25);
      box-shadow: 
        0 6px 14px rgba(59, 130, 246, 0.10),
        0 3px 8px rgba(0, 0, 0, 0.05);
    }
    
    :global([data-theme="light"]) .chart-card.active {
      background: linear-gradient(145deg, #e8f4ff 0%, #f0f8ff 100%);
      border-color: rgba(100, 150, 220, 0.4);
      box-shadow: 
        0 3px 10px rgba(100, 150, 220, 0.15),
        0 1px 4px rgba(0, 0, 0, 0.05);
    }
    
    :global([data-theme="light"]) .chart-card.active .card-bg {
      opacity: 0;
    }
    
    :global([data-theme="light"]) .icon-container {
      background: #f3f6fb;
      border-color: rgba(59, 130, 246, 0.15);
      box-shadow: 
        0 1px 3px rgba(0, 0, 0, 0.04),
        inset 0 0.5px 0 rgba(255, 255, 255, 1);
    }
    
    :global([data-theme="light"]) .chart-card:hover .icon-container {
      background: #f0f2f5;
      box-shadow: 
        0 2px 6px rgba(0, 0, 0, 0.05),
        inset 0 0.5px 0 rgba(255, 255, 255, 1);
    }
    
    :global([data-theme="light"]) .chart-card.active .icon-container {
      background: linear-gradient(145deg, #dceeff 0%, #e6f3ff 100%);
      border-color: rgba(100, 150, 220, 0.2);
      box-shadow: 
        0 2px 8px rgba(100, 150, 220, 0.12),
        inset 0 0.5px 0 rgba(255, 255, 255, 1);
    }
    
    :global([data-theme="light"]) .icon-glow {
      opacity: 0;
    }
    
    :global([data-theme="light"]) :global(.chart-icon) {
      color: #3b82f6;
      filter: drop-shadow(0 0.5px 1px rgba(59, 130, 246, 0.15));
    }
    
    :global([data-theme="light"]) .chart-card:hover :global(.chart-icon) {
      color: #2563eb;
      filter: drop-shadow(0 1px 2px rgba(37, 99, 235, 0.2));
    }
    
    :global([data-theme="light"]) .chart-card.active :global(.chart-icon) {
      color: #1d4ed8;
      filter: drop-shadow(0 1px 3px rgba(29, 78, 216, 0.3));
    }
    
    :global([data-theme="light"]) .chart-name {
      color: #334155;
    }
    
    :global([data-theme="light"]) .chart-card:hover .chart-name {
      color: #1f2937;
    }
    
    :global([data-theme="light"]) .chart-card.active .chart-name {
      color: #2563eb;
      font-weight: 600;
    }
    
    :global([data-theme="light"]) .selection-badge {
      background: linear-gradient(135deg, #5ba3f5 0%, #4a90e2 100%);
      border-color: rgba(255, 255, 255, 0.8);
      box-shadow: 
        0 2px 8px rgba(74, 144, 226, 0.3),
        0 1px 2px rgba(0, 0, 0, 0.1);
    }
    
    /* ===== WARNING BANNER ===== */
    .warning-banner {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 18px;
      margin-bottom: 16px;
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(239, 68, 68, 0.1) 100%);
      border: 1px solid rgba(245, 158, 11, 0.3);
      border-radius: 12px;
      color: rgba(251, 191, 36, 0.95);
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.15);
    }
    
    .warning-banner svg {
      flex-shrink: 0;
      color: rgba(251, 191, 36, 1);
      filter: drop-shadow(0 2px 4px rgba(245, 158, 11, 0.3));
    }
    
    :global([data-theme="light"]) .warning-banner {
      background: linear-gradient(135deg, rgba(254, 243, 199, 0.9) 0%, rgba(254, 226, 226, 0.8) 100%);
      border-color: rgba(217, 119, 6, 0.3);
      color: rgba(146, 64, 14, 0.95);
      box-shadow: 0 2px 8px rgba(217, 119, 6, 0.15);
    }
    
    :global([data-theme="light"]) .warning-banner svg {
      color: rgba(217, 119, 6, 1);
      filter: drop-shadow(0 1px 2px rgba(217, 119, 6, 0.2));
    }
    
    /* ===== DISABLED STATE ===== */
    .chart-card.disabled {
      opacity: 0.35;
      cursor: not-allowed;
      pointer-events: auto;
    }
    
    .chart-card.disabled:hover {
      transform: none;
      opacity: 0.35;
      border-color: rgba(255, 255, 255, 0.06);
      background: linear-gradient(145deg, 
        rgba(30, 35, 48, 0.6) 0%, 
        rgba(20, 25, 35, 0.4) 100%);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    
    .chart-card.disabled .card-bg {
      opacity: 0;
    }
    
    .chart-card.disabled .icon-container {
      transform: none;
    }
    
    .chart-card.disabled .shine-effect {
      display: none;
    }
    
    :global([data-theme="light"]) .chart-card.disabled {
      opacity: 0.4;
    }
    
    :global([data-theme="light"]) .chart-card.disabled:hover {
      opacity: 0.4;
    }</style>`,1);function Aj(o,e){Mc(e,!0);const t=Au(),s=()=>ua(a,"$save",t),i=()=>ua(l,"$chart",t);let r=Qs(e,"show",15);vc("ctx");const a=vc("save"),l=vc("chart"),c=[{id:"candle_solid",name:"Candlestick",icon:"candle_solid"},{id:"candle_stroke",name:"Hollow",icon:"candle_stroke"},{id:"candle_up_stroke",name:"Up Hollow",icon:"candle_up_stroke"},{id:"candle_down_stroke",name:"Down Hollow",icon:"candle_down_stroke"},{id:"heikin_ashi",name:"Heikin Ashi",icon:"candle_solid"},{id:"renko_atr",name:"Duty AI Renko",icon:"candle_solid"},{id:"point_and_figure",name:"Point & Figure",icon:"point_and_figure"},{id:"ohlc",name:"OHLC",icon:"ohlc"},{id:"area",name:"Area",icon:"area"},{id:"line_chart",name:"Line",icon:"line"}],d=["SMART_MONEY","TRAP_HUNTER","VOLCANIC","VOLCANIC_SIG"];function v(){return!s()||!s().saveInds?!1:Object.values(s().saveInds).some(S=>S&&d.includes(S.name))}let g=ee(!1),_=ee("");zr(()=>{if(n(g)){const S=setTimeout(()=>{x(g,!1)},5e3);return()=>clearTimeout(S)}});function y(S,M){var z,j,B,$,F;const I=S;if(I.id==="renko_atr"&&v()){x(_,"You cannot use Duty AI Renko chart with AI Indicator"),x(g,!0),console.log("⚠️ Cannot add Renko chart: AI indicators present");return}if(I.id==="point_and_figure"&&v()){x(_,"You cannot use Point & Figure chart with AI Indicator"),x(g,!0),console.log("⚠️ Cannot add P&F chart: AI indicators present");return}if(console.log("📊 CHART TYPE CLICK:",I.id),M){const V=M.currentTarget;V.classList.add("selecting"),setTimeout(()=>{V.classList.remove("selecting")},800)}if(s().styles.candle||Wa(a,ys(s).styles.candle={},ys(s)),I.id==="line_chart"){console.log("🎯 Setting up LINE CHART (using area with transparent background)"),Wa(a,ys(s).styles.candle.type="area",ys(s));const V=((j=(z=s().styles.candle)==null?void 0:z.bar)==null?void 0:j.upColor)||"#2196F3";Wa(a,ys(s).styles.candle.area={lineSize:2,lineColor:V,lineSmooth:!1,value:"close",backgroundColor:[{offset:0,color:"rgba(0, 0, 0, 0)"},{offset:1,color:"rgba(0, 0, 0, 0)"}]},ys(s)),Wa(a,ys(s).styles.candle._isLineChart=!0,ys(s)),console.log("✅ Line chart configured with area type and transparent background")}else if(I.id==="area"){console.log("🎯 Setting up AREA CHART with gradient fill"),Wa(a,ys(s).styles.candle.type="area",ys(s)),delete s().styles.candle._isLineChart;const V=(($=(B=s().styles.candle)==null?void 0:B.bar)==null?void 0:$.upColor)||"#2196F3";Wa(a,ys(s).styles.candle.area={lineSize:2,lineColor:V,lineSmooth:!1,value:"close",backgroundColor:[{offset:0,color:V+"60"},{offset:1,color:V+"10"}]},ys(s)),console.log("✅ Area chart configured with gradient background")}else I.id==="renko_atr"?(console.log("🎯 Setting up RENKO (ATR) chart"),Wa(a,ys(s).styles.candle.type="renko_atr",ys(s)),s().styles.candle.renko||Wa(a,ys(s).styles.candle.renko={method:"ATR",atrLength:14,source:"close",wick:!1},ys(s)),delete s().styles.candle._isLineChart,delete s().styles.candle.area):I.id==="point_and_figure"?(console.log("🎯 Setting up POINT & FIGURE chart"),Wa(a,ys(s).styles.candle.type="point_and_figure",ys(s)),s().styles.candle.pnf||Wa(a,ys(s).styles.candle.pnf={boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"},ys(s)),delete s().styles.candle._isLineChart,delete s().styles.candle.area):(Wa(a,ys(s).styles.candle.type=I.id,ys(s)),delete s().styles.candle._isLineChart,delete s().styles.candle.area);console.log("✅ Saved chart type to $save.styles:",{type:s().styles.candle.type,isLineChart:s().styles.candle._isLineChart,area:s().styles.candle.area});const C=Sd(s().theme);uo.merge(C,s().styles);const T=Dc(C);(F=i())==null||F.setStyles(T),console.log("✅ Styles applied to chart with processing"),r(!1)}function k(){var M,I,C,T;return(I=(M=s().styles)==null?void 0:M.candle)!=null&&I._isLineChart?"line_chart":((T=(C=s().styles)==null?void 0:C.candle)==null?void 0:T.type)||"renko_atr"}av(o,{get show(){return r()},set show(S){r(S)},title:"Chart Type",width:"550px",maxWidth:"95vw",maxHeight:"90vh",buttons:[],get theme(){return s().theme},class:"chart-type-modal-premium",children:(S,M)=>{var I=Tj(),C=Rt(I);Te(C,()=>n(g),z=>{var j=Cj(),B=p(m(j),2),$=m(B,!0);f(B),f(j),Se(()=>Ve($,n(_))),Af(3,j,()=>kh,()=>({y:-20,duration:300})),O(z,j)});var T=p(C,2);Vs(T,21,()=>c,z=>z.id,(z,j)=>{var B=Mj();const $=Qe(()=>(n(j).id==="renko_atr"||n(j).id==="point_and_figure")&&v());B.__click=[Pj,y,j];const F=Qe(()=>k()===n(j).id);Se(()=>ii(B,"active",n(F)));var V=p(m(B),2);Te(V,()=>k()===n(j).id&&!n($),te=>{var oe=Ij();O(te,oe)});var K=p(V,2),Y=p(m(K),2);bv(Y,{get name(){return n(j).icon},size:26,class:"chart-icon"}),f(K);var Z=p(K,2),ne=m(Z,!0);f(Z),pn(2),f(B),Se(()=>{ii(B,"disabled",n($)),Ve(ne,n(j).name)}),O(z,B)}),f(T),pn(2),O(S,I)},$$slots:{default:!0}}),Tc()}Hd(["click"]);function s2(o,e){e(!1)}var Lj=(o,e,t,s,i)=>!n(e)&&!n(t)&&s(n(i).is_main,n(i).name),zj=re('<div class="particle svelte-uswuii"></div>'),Fj=re('<div class="stream-line svelte-uswuii"></div>'),$j=re('<div class="segment svelte-uswuii"></div>'),Dj=re('<div class="ai-loading-overlay svelte-uswuii"><div class="particles-container svelte-uswuii"></div> <div class="data-stream svelte-uswuii"></div> <div class="loading-content svelte-uswuii"><div class="ai-loader-icon svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-uswuii"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-uswuii"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-uswuii"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-uswuii"></line></svg> <div class="ai-pulse-ring ring-1 svelte-uswuii"></div> <div class="ai-pulse-ring ring-2 svelte-uswuii"></div> <div class="ai-pulse-ring ring-3 svelte-uswuii"></div> <div class="ai-glow svelte-uswuii"></div></div> <div class="loading-text-container svelte-uswuii"><div class="loading-text-main svelte-uswuii"> </div> <div class="loading-text-sub svelte-uswuii"> </div></div> <div class="progress-container svelte-uswuii"><div class="progress-bar svelte-uswuii"><div class="progress-glow svelte-uswuii"></div></div> <div class="progress-segments svelte-uswuii"></div></div> <div class="progress-info svelte-uswuii"><div class="progress-percentage svelte-uswuii"> </div> <div class="progress-status svelte-uswuii"> </div></div></div></div>'),Ej=(o,e,t,s)=>{o.stopPropagation(),e(n(t),n(s).name)},Nj=(o,e,t,s)=>{o.stopPropagation(),e(n(t),n(s).name)},jj=re('<div class="indicator-actions svelte-uswuii"><button class="action-btn edit-btn svelte-uswuii" title="Edit Parameters"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" class="svelte-uswuii"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" class="svelte-uswuii"></path></svg></button> <button class="action-btn delete-btn svelte-uswuii" title="Remove Indicator"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="3 6 5 6 21 6" class="svelte-uswuii"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" class="svelte-uswuii"></path><line x1="10" y1="11" x2="10" y2="17" class="svelte-uswuii"></line><line x1="14" y1="11" x2="14" y2="17" class="svelte-uswuii"></line></svg></button></div>'),Rj=re('<div class="add-indicator-hint svelte-uswuii"><span class="svelte-uswuii">Click to add</span></div>'),Bj=re('<div class="indicator-icon svelte-uswuii"> </div> <div class="indicator-info svelte-uswuii"><span class="indicator-name svelte-uswuii"> </span></div> <!>',1),Oj=re("<div><!></div>"),Vj=o=>o.stopPropagation(),Wj=re('<div class="ai-modal-backdrop svelte-uswuii" role="presentation"></div> <div class="ai-modal-container svelte-uswuii" role="dialog" aria-modal="true" aria-labelledby="ai-modal-title"><div class="ai-background svelte-uswuii"><div class="orb orb-1 svelte-uswuii"></div> <div class="orb orb-2 svelte-uswuii"></div> <div class="orb orb-3 svelte-uswuii"></div></div> <div class="ai-content svelte-uswuii"><div class="ai-header svelte-uswuii"><div class="ai-header-left svelte-uswuii"><div class="ai-icon-small svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-uswuii"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-uswuii"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-uswuii"></line></svg></div> <div class="ai-header-text svelte-uswuii"><h2 id="ai-modal-title" class="ai-title svelte-uswuii">AI Indicators</h2> <p class="ai-subtitle svelte-uswuii">Duty AI Advanced Algorithm - Exclusive for Pro Traders</p></div></div> <button class="close-btn svelte-uswuii" aria-label="Close"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><line x1="18" y1="6" x2="6" y2="18" class="svelte-uswuii"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-uswuii"></line></svg></button></div> <div class="indicators-list svelte-uswuii"><!> <div class="indicator-row coming-soon-item disabled svelte-uswuii"><div class="coming-soon-glitter-bg svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-1 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-2 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-3 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-4 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-5 svelte-uswuii"></div> <div class="coming-soon-shine-sweep svelte-uswuii"></div> <div class="indicator-icon svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-uswuii"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-uswuii"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-uswuii"></line></svg></div> <div class="indicator-info svelte-uswuii"><span class="indicator-name svelte-uswuii">AI Trade Entry Finder and more AI algorithms</span> <span class="coming-soon-badge svelte-uswuii">Coming Soon</span></div></div></div> <div class="ai-powered-footer svelte-uswuii"><span class="powered-by-text svelte-uswuii">Powered by Duty AI</span></div></div></div>',1),qj=(o,e)=>x(e,!1),Hj=(o,e)=>x(e,!1),Gj=re('<div class="premium-modal-backdrop svelte-uswuii" role="presentation"></div> <div class="premium-modal-container svelte-uswuii" role="dialog" aria-modal="true" aria-labelledby="premium-modal-title"><div class="premium-background svelte-uswuii"><div class="premium-orb premium-orb-1 svelte-uswuii"></div> <div class="premium-orb premium-orb-2 svelte-uswuii"></div></div> <div class="premium-content svelte-uswuii"><button class="premium-close-btn svelte-uswuii" aria-label="Close"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><line x1="18" y1="6" x2="6" y2="18" class="svelte-uswuii"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-uswuii"></line></svg></button> <div class="premium-icon-wrapper svelte-uswuii"><div class="premium-icon svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-uswuii"></path><path d="M2 17l10 5 10-5" class="svelte-uswuii"></path><path d="M2 12l10 5 10-5" class="svelte-uswuii"></path></svg> <div class="premium-icon-glow svelte-uswuii"></div></div></div> <h2 id="premium-modal-title" class="premium-title svelte-uswuii">Premium Feature</h2> <p class="premium-message svelte-uswuii">AI Indicators are exclusive premium features. Upgrade to Premium to unlock all advanced AI algorithms and take your trading to the next level.</p> <div class="premium-features svelte-uswuii"><div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">Smart Money Footprint</span></div> <div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">Trap Hunter (Bull/Bear Traps)</span></div> <div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">Volcanic Move & Eruptions</span></div> <div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">More AI algorithms coming soon</span></div></div> <a target="_blank" rel="noopener noreferrer" class="premium-payment-btn svelte-uswuii"><span class="svelte-uswuii">Upgrade to Premium</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><line x1="5" y1="12" x2="19" y2="12" class="svelte-uswuii"></line><polyline points="12 5 19 12 12 19" class="svelte-uswuii"></polyline></svg></a></div></div>',1),Uj=re("<!> <!>",1);function Yj(o,e){Mc(e,!0);const t=Au(),s=()=>ua(v,"$chart",t),i=()=>ua(d,"$save",t),r=()=>ua(c,"$ctx",t),a=()=>ua(Nf,"$userPreferences",t);let l=Qs(e,"show",15);const c=vc("ctx"),d=vc("save"),v=vc("chart"),g=[{name:"SMART_MONEY",title:"Smart Money Footprint",is_main:!0,icon:"💰"},{name:"TRAP_HUNTER",title:"Trap Hunter (Bull/Bear Traps)",is_main:!0,icon:"🎯"},{name:"VOLCANIC",title:"Volcanic Move (Pressure) (Sub Pane)",is_main:!1,icon:"🌋"},{name:"VOLCANIC_SIG",title:"Volcanic Eruptions (Markers) (Main Pane)",is_main:!0,icon:"💥"}],_={SMART_MONEY:[{text:"💰 Tracking institutional money flow",duration:1200,subtext:"Analyzing whale movements..."},{text:"🏦 Detecting smart money footprints",duration:1400,subtext:"Scanning OBV patterns..."},{text:"📊 Mapping accumulation zones",duration:1300,subtext:"Identifying support levels..."},{text:"🎯 Calculating volume clusters",duration:1200,subtext:"Processing 50,000+ trades..."},{text:"✨ Activating smart money radar",duration:1100,subtext:"Deploying footprint tracker..."}],TRAP_HUNTER:[{text:"🎯 Scanning for bull/bear traps",duration:1200,subtext:"Analyzing false breakouts..."},{text:"🔍 Detecting fake-out patterns",duration:1400,subtext:"Identifying trap signatures..."},{text:"⚡ Processing trap probability",duration:1300,subtext:"Calculating 20+ parameters..."},{text:"🚨 Mapping high-risk zones",duration:1200,subtext:"Locating potential traps..."},{text:"✨ Deploying trap detection AI",duration:1100,subtext:"Activating alert system..."}],VOLCANIC:[{text:"🌋 Measuring market pressure",duration:1200,subtext:"Analyzing momentum buildup..."},{text:"📈 Detecting volcanic activity",duration:1400,subtext:"Scanning RSI extremes..."},{text:"🔥 Calculating eruption zones",duration:1300,subtext:"Processing pressure levels..."},{text:"⚡ Tracking explosive setups",duration:1200,subtext:"Identifying breakout points..."},{text:"✨ Activating volcanic pressure",duration:1100,subtext:"Deploying oscillator..."}],VOLCANIC_SIG:[{text:"💥 Detecting eruption signals",duration:1200,subtext:"Scanning breakout candles..."},{text:"🚀 Analyzing explosive moves",duration:1400,subtext:"Tracking volume spikes..."},{text:"🎯 Mapping eruption markers",duration:1300,subtext:"Calculating signal strength..."},{text:"⚡ Processing 15,000+ patterns",duration:1200,subtext:"Identifying eruption points..."},{text:"✨ Deploying eruption markers",duration:1100,subtext:"Activating signal alerts..."}]};let y=ee(D(new Set));zr(()=>{var se;if(!l()||!s())return;const U=s();let J=new Set;try{const W=((se=U.getIndicators)==null?void 0:se.call(U))??[];J=new Set(W.map(le=>le.name)),console.log("🧠 AI Modal (open) - from chart.getIndicators:",W)}catch(W){console.warn("⚠️ AI Modal - getIndicators failed, falling back to saveInds",W);const le=new Set;i()&&i().saveInds&&Object.values(i().saveInds).forEach(ye=>{ye&&ye.name&&le.add(ye.name)}),J=le}console.log("🔄 AI Modal (open) - selectedIndicators updated:",Array.from(J)),console.log("🔍 AI Modal (open) - saveInds keys:",Object.keys(i().saveInds||{})),x(y,D(J))});let k=ee(!1),S=ee(null),M=ee(0),I=ee(0),C=ee(D([])),T=ee(!1);zr(()=>{!r().modalIndCfg&&n(k)&&(x(k,!1),setTimeout(()=>{l(!0)},100))}),zr(()=>{l()&&(console.log("🎯 AI Modal opened"),console.log("📊 Current saveInds:",i().saveInds),console.log("✅ AI indicators in chart:",Array.from(n(y))))});function z(){var J,se,W;if(((se=(J=i().styles)==null?void 0:J.candle)==null?void 0:se.type)==="renko_atr"){console.log("🔄 Converting Renko chart to Candlestick for AI indicator compatibility"),Wa(d,ys(i).styles.candle.type="candle_solid",ys(i)),delete i().styles.candle.renko,delete i().styles.candle._isLineChart,delete i().styles.candle.area;const le=Sd(i().theme);uo.merge(le,i().styles);const ye=Dc(le);return(W=s())==null||W.setStyles(ye),console.log("✅ Chart converted from Renko to Candlestick"),!0}return!1}async function j(U){x(S,D(U)),x(M,0),x(I,0),x(C,D(_[U]||_.SMART_MONEY));for(let J=0;J<n(C).length;(J+=1)-1){x(M,D(J));const se=n(C)[J],W=J/n(C).length*100,le=(J+1)/n(C).length*100,ye=20,Ce=se.duration/ye;for(let Re=0;Re<=ye;(Re+=1)-1)x(I,W+(le-W)*(Re/ye)),await new Promise(Ke=>setTimeout(Ke,Ce))}x(S,null),x(M,0),x(I,0),x(C,D([]))}function B(){var J;const U=(J=a())==null?void 0:J.data;return U?U.isPremium===!0||U.isTrial===!0:!1}async function $(U,J){if(!B()){console.log("🔒 Premium access required for AI indicators"),x(T,!0);return}await j(J),z();let se=!1;if(J==="SMART_MONEY"){const W="candle_pane",le=s();if(le&&le.createIndicator({name:"SMART_MONEY",calcParams:[40,5,25,14,20,1.2,.03,20,.2,.6,1,20,1]},!0,{id:W})){const Ce={name:"SMART_MONEY",pane_id:W,params:[40,5,25,14,20,1.2,.03,20,.2,.6,1,20,1]},Re=`${W}_SMART_MONEY`;d.update(Ke=>(Ke.saveInds[Re]=Ce,Ke)),xv(),nu.recordAddIndicator(J,W,Ce.params,Re),se=!0}}else if(J==="TRAP_HUNTER"){const W="candle_pane",le=s();if(le){const ye=[20,20,3,5,20,1.3,7e-4,.35,.5,1,5];if(le.createIndicator({name:"TRAP_HUNTER",calcParams:ye},!0,{id:W})){const Re={name:"TRAP_HUNTER",pane_id:W,params:ye},Ke=`${W}_TRAP_HUNTER`;d.update(st=>(st.saveInds[Ke]=Re,st)),xv(),nu.recordAddIndicator(J,W,Re.params,Ke),se=!0}}}else if(J==="VOLCANIC"){const W="pane_VOLCANIC",le=s();if(le){const ye=[16,2,14,20,60,2,.5,1,.8,.8,.4,10,1,30,0,7e-4,0,1];if(le.createIndicator({name:"VOLCANIC",calcParams:ye},!1,{id:W})){const Re={name:"VOLCANIC",pane_id:W,params:ye},Ke=`${W}_VOLCANIC`;d.update(st=>(st.saveInds[Ke]=Re,st)),xv(),nu.recordAddIndicator(J,W,Re.params,Ke),se=!0}}}else if(J==="VOLCANIC_SIG"){const W="candle_pane",le=s();if(le){const ye=[16,2,14,20,60,2,.5,1,.8,.8,.4,10,1,30,0,7e-4,0,1];if(le.createIndicator({name:"VOLCANIC_SIG",calcParams:ye},!0,{id:W})){const Re={name:"VOLCANIC_SIG",pane_id:W,params:ye},Ke=`${W}_VOLCANIC_SIG`;d.update(st=>(st.saveInds[Ke]=Re,st)),xv(),nu.recordAddIndicator(J,W,Re.params,Ke),se=!0}}}se&&console.log(`✅ ${J} added successfully from AI modal`)}function F(U,J){x(k,!0),l(!1),c.update(se=>(se.editPaneId=U,se.editIndName=J,se.modalIndCfg=!0,se))}async function V(U,J){if(console.log("🗑️ Deleting indicator:",{paneId:U,name:J}),!s()){console.log("❌ No chart available");return}const se=s(),W=`${U}_${J}`,le=i().saveInds[W];le&&nu.recordRemoveIndicator(J,U,le.params||[],W);try{se.removeIndicator({paneId:U,name:J}),console.log("✅ Indicator removed"),d.update(ye=>(delete ye.saveInds[W],ye)),xv()}catch(ye){console.log("❌ Error removing indicator:",ye)}}const K=B0(),[Y,Z]=K;var ne=Uj(),te=Rt(ne);Te(te,l,U=>{var J=Wj(),se=Rt(J);se.__click=[s2,l];var W=p(se,2),le=p(m(W),2),ye=m(le),Ce=p(m(ye),2);Ce.__click=[s2,l],f(ye);var Re=p(ye,2),Ke=m(Re);Vs(Ke,19,()=>g,vt=>vt.name,(vt,Je)=>{var ot=Oj();const nt=Qe(()=>n(y).has(n(Je).name)),tt=Qe(()=>n(S)===n(Je).name),Ze=Qe(()=>n(Je).is_main?"candle_pane":`pane_${n(Je).name}`);ot.__click=[Lj,nt,tt,$,Je];var ct=m(ot);Te(ct,()=>n(tt),Ge=>{var pt=Dj(),ce=m(pt);Vs(ce,20,()=>Array(12),_n,(Ks,ws,vn)=>{var es=zj();Nt(es,"style",`--delay: ${vn*.15}s; --x: ${Math.random()*100}%; --y: ${Math.random()*100}%`),O(Ks,es)}),f(ce);var ze=p(ce,2);Vs(ze,20,()=>Array(8),_n,(Ks,ws,vn)=>{var es=Fj();Nt(es,"style",`--stream-delay: ${vn*.2}s; left: ${10+vn*12}%`),O(Ks,es)}),f(ze);var qe=p(ze,2),me=p(m(qe),2),Q=m(me),it=m(Q,!0);f(Q);var Vt=p(Q,2),wt=m(Vt,!0);f(Vt),f(me);var Yt=p(me,2),At=m(Yt),Gt=p(At,2);Vs(Gt,20,()=>Array(5),_n,(Ks,ws,vn)=>{var es=$j();Se(()=>ii(es,"active",n(M)>=vn)),O(Ks,es)}),f(Gt),f(Yt);var Do=p(Yt,2),Eo=m(Do),bs=m(Eo);Se(()=>Ve(bs,`${Math.round(n(I))??""}%`)),f(Eo);var Is=p(Eo,2),qi=m(Is);f(Is),f(Do),f(qe),f(pt),Se(()=>{var Ks,ws;Ve(it,((Ks=n(C)[n(M)])==null?void 0:Ks.text)||""),Ve(wt,((ws=n(C)[n(M)])==null?void 0:ws.subtext)||""),Nt(At,"style",`width: ${n(I)??""}%`),Ve(qi,`Phase ${n(M)+1}/5`)}),O(Ge,pt)},Ge=>{var pt=Bj(),ce=Rt(pt),we=m(ce,!0);f(ce);var ze=p(ce,2),dt=m(ze),qe=m(dt,!0);f(dt),f(ze);var me=p(ze,2);Te(me,()=>n(nt),Q=>{var it=jj(),Vt=m(it);Vt.__click=[Ej,F,Ze,Je];var wt=p(Vt,2);wt.__click=[Nj,V,Ze,Je],f(it),O(Q,it)},Q=>{var it=Rj();O(Q,it)}),Se(()=>{Ve(we,n(Je).icon),Ve(qe,n(Je).title)}),O(Ge,pt)}),f(ot),Se(()=>Gn(ot,`indicator-row ${(n(nt)?"indicator-selected":"")??""} ${(n(tt)?"indicator-loading":"")??""} svelte-uswuii`)),O(vt,ot)});var st=p(Ke,2);st.__click=[Vj],f(Re),pn(2),f(le),f(W),Af(3,se,()=>wh,()=>({duration:200})),Af(3,W,()=>kh,()=>({y:20,duration:300,easing:m1})),O(U,J)});var oe=p(te,2);Te(oe,()=>n(T),U=>{var J=Gj(),se=Rt(J);se.__click=[qj,T];var W=p(se,2),le=p(m(W),2),ye=m(le);ye.__click=[Hj,T];var Ce=p(ye,10);Se(()=>Nt(Ce,"href",Y("https://dutyai.app/payment",void 0))),f(le),f(W),Af(3,se,()=>wh,()=>({duration:200})),Af(3,W,()=>kh,()=>({y:20,duration:300,easing:m1})),O(U,J)}),O(o,ne),Tc()}Hd(["click"]);var Kj=re('<span class="loading loading-spinner loading-xs"></span>'),Zj=re('<span class="text-xs">•</span>'),Xj=re('<button class="btn btn-primary btn-sm min-w-[100px] transition-all duration-200 svelte-1ib83i5" title="Save Layout Options"><!> Save <!></button>');function Jj(o,e){Mc(e,!1);const t=nd(),s=nd();let i=Qs(e,"savedLayouts",24,()=>[]),r=Qs(e,"activeSaveId",8,null),a=Qs(e,"isLoading",8,!1),l=Qs(e,"hasUnsavedChanges",8,!1);const c=sp();function d(){c("showPopup")}Fp(()=>(wp(r()),wp(i())),()=>{x(t,r()?i().find(y=>y.id===r()):null)}),Fp(()=>n(t),()=>{x(s,!!n(t))}),fm(),Sp();var v=Xj(),g=m(v);Te(g,a,y=>{var k=Kj();O(y,k)},y=>{rL(y,{class:"h-4 w-4"})});var _=p(g,2);Te(_,l,y=>{var k=Zj();O(y,k)}),f(v),Se(()=>{v.disabled=a(),ii(v,"btn-warning",l())}),id("click",v,d),O(o,v),Tc()}function Qj(o,e,t,s,i){o.key==="Enter"&&n(e).valid&&n(t).trim()?(o.preventDefault(),s()):o.key==="Escape"&&(o.preventDefault(),i())}var eR=re('<div class="flex items-center gap-2 text-sm text-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </div>'),tR=re('<div class="flex items-center gap-2 text-sm text-success"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Layout name is available</div>'),oR=re('<div class="flex items-center justify-between text-sm"><span class="text-base-content/80"> </span> <span class="text-xs text-base-content/50"> </span></div>'),sR=re('<div class="space-y-2"><h4 class="text-sm font-medium text-base-content/70"> </h4> <div class="max-h-32 overflow-y-auto space-y-1 p-3 bg-base-200/30 rounded-lg border border-base-300/50 svelte-bhlz05"></div></div>'),nR=re('<span class="loading loading-spinner loading-sm"></span> Saving...',1),iR=re('<div class="space-y-6"><div class="space-y-2"><label for="layout-name" class="block text-sm font-medium text-base-content">Layout Name</label> <input id="layout-name" type="text" placeholder="Enter layout name..." class="w-full px-4 py-3 border border-base-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 bg-base-100 text-base-content placeholder-base-content/50"> <!></div> <!> <div class="flex gap-3 justify-end pt-4 border-t border-base-300/50"><button class="btn btn-ghost min-w-[100px] rounded-lg font-medium transition-all duration-200">Cancel</button> <button class="btn btn-primary min-w-[100px] rounded-lg font-medium transition-all duration-200 hover:scale-105"><!></button></div></div>');function rR(o,e){Mc(e,!1);const t=nd();let s=Qs(e,"show",12,!1),i=Qs(e,"savedLayouts",24,()=>[]),r=Qs(e,"isLoading",8,!1),a=Qs(e,"mode",8,"save"),l=Qs(e,"showExisting",8,!1),c=nd(""),d=nd({valid:!0}),v=nd(!1);const g=sp();function _(S){if(x(v,!0),!S){x(d,{valid:!1,error:"Layout name is required"}),x(v,!1);return}if(S.length<2){x(d,{valid:!1,error:"Layout name must be at least 2 characters"}),x(v,!1);return}if(S.length>50){x(d,{valid:!1,error:"Layout name must be less than 50 characters"}),x(v,!1);return}if(/[<>:"/\\|?*]/.test(S)){x(d,{valid:!1,error:"Layout name contains invalid characters"}),x(v,!1);return}if(i().some(C=>C.name.toLowerCase()===S.toLowerCase())){x(d,{valid:!1,error:"A layout with this name already exists"}),x(v,!1);return}x(d,{valid:!0}),x(v,!1)}function y(){const S=n(c).trim();n(d).valid&&S&&g("save",{name:S})}function k(){s(!1),g("cancel")}Fp(()=>wp(s()),()=>{s()&&(x(c,""),x(d,{valid:!0}),x(v,!1))}),Fp(()=>n(c),()=>{n(c).trim()?_(n(c).trim()):x(d,{valid:!1,error:"Layout name is required"})}),Fp(()=>wp(a()),()=>{x(t,a()==="save"?"Save Chart Layout":"Save Layout As")}),fm(),Sp(),av(o,{get show(){return s()},set show(S){s(S)},get title(){return n(t)},width:450,buttons:[],children:(S,M)=>{var I=iR(),C=m(I),T=p(m(C),2);Jt(T),T.__keydown=[Qj,d,c,y,k],j2(T,!0);const z=kp(()=>!n(d).valid&&n(c).trim()),j=kp(()=>n(d).valid&&n(c).trim());var B=p(T,2);Te(B,()=>n(c).trim()&&!n(d).valid,Z=>{var ne=eR(),te=p(m(ne));f(ne),Se(()=>Ve(te,` ${n(d).error??""}`)),O(Z,ne)},Z=>{var ne=So(),te=Rt(ne);Te(te,()=>n(d).valid&&n(c).trim(),oe=>{var U=tR();O(oe,U)},null,!0),O(Z,ne)}),f(C);var $=p(C,2);Te($,()=>l()&&i().length>0,Z=>{var ne=sR(),te=m(ne),oe=m(te);f(te);var U=p(te,2);Vs(U,5,i,_n,(J,se)=>{var W=oR(),le=m(W),ye=m(le,!0);f(le);var Ce=p(le,2),Re=m(Ce,!0);Se(()=>Ve(Re,new Date(n(se).updatedAt).toLocaleDateString())),f(Ce),f(W),Se(()=>Ve(ye,n(se).name)),O(J,W)}),f(U),f(ne),Se(()=>Ve(oe,`Existing Layouts (${i().length??""})`)),O(Z,ne)});var F=p($,2),V=m(F);V.__click=k;var K=p(V,2);K.__click=y,Se(()=>K.disabled=!n(d).valid||!n(c).trim()||r()||n(v));var Y=m(K);Te(Y,r,Z=>{var ne=nR();pn(),O(Z,ne)},Z=>{var ne=Yf("Save Layout");O(Z,ne)}),f(K),f(F),f(I),Se(()=>{T.disabled=r(),ii(T,"border-error",n(z)),ii(T,"border-success",n(j)),V.disabled=r()}),Ho(T,()=>n(c),Z=>x(c,Z)),O(S,I)},$$slots:{default:!0},$$legacy:!0}),Tc()}Hd(["keydown","click"]);var aR=re('<span class="loading loading-spinner loading-xs"></span>'),lR=re('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path></svg>'),cR=re('<span class="text-xs text-warning">• Unsaved changes</span>'),dR=re('<div class="p-4 bg-primary/5 border-b border-base-300/50"><div class="flex items-center gap-2 text-sm"><div class="w-2 h-2 bg-primary rounded-full"></div> <span class="font-medium text-base-content"> </span> <!></div> <div class="text-xs text-base-content/60 mt-1"> </div></div>'),uR=re('<div class="p-6 text-center text-base-content/60 text-sm">No saved layouts yet</div>'),pR=re('<div class="w-1.5 h-1.5 bg-primary rounded-full"></div>'),vR=re('<div><div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="text-sm font-medium text-base-content truncate"> </span> <!></div> <div class="text-xs text-base-content/60"> </div></div> <button class="opacity-0 group-hover:opacity-100 p-1 hover:bg-error/20 rounded transition-all duration-150" title="Delete layout"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>'),fR=re('<div class="p-4"><div class="text-xs font-medium text-base-content/70 px-2 py-2"> </div> <div class="space-y-1"></div></div>'),mR=re('<div class="max-h-48 overflow-y-auto svelte-10s4pck"><!></div>'),gR=re('<div class="fixed inset-0 bg-transparent z-40"></div> <div class="fixed z-50 bg-base-100 border border-base-300 rounded-lg shadow-xl animate-in fade-in zoom-in-95 duration-200"><div class="flex items-center justify-between p-4 border-b border-base-300/50"><h3 class="text-lg font-semibold text-base-content">Save Chart Layout</h3> <button class="btn btn-ghost btn-sm btn-circle" title="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4 border-b border-base-300/50"><div class="space-y-2"><button class="w-full flex items-center gap-3 px-4 py-3 text-sm bg-primary text-primary-content hover:bg-primary/90 rounded-md transition-colors duration-150"><!> </button> <button class="w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-base-200 rounded-md transition-colors duration-150"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> Save As...</button> <button class="w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-base-200 rounded-md transition-colors duration-150"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> New Layout</button></div></div> <!> <!></div>',1);function hR(o,e){Mc(e,!1);const t=nd(),s=nd();let i=Qs(e,"show",12,!1),r=Qs(e,"savedLayouts",24,()=>[]),a=Qs(e,"activeSaveId",8,null),l=Qs(e,"isLoading",8,!1),c=Qs(e,"hasUnsavedChanges",8,!1),d=Qs(e,"position",24,()=>({x:0,y:0})),v=Qs(e,"showLayouts",8,!0),g=nd();const _=sp();function y(V){n(g)&&!n(g).contains(V.target)&&S()}function k(V){V.key==="Escape"&&S()}hp(()=>{console.log("🎯 ChartSavePopup mounted with props:",{show:i(),savedLayouts:r(),activeSaveId:a(),isLoading:l(),hasUnsavedChanges:c(),position:d()}),i()&&(document.addEventListener("click",y),document.addEventListener("keydown",k))}),rf(()=>{document.removeEventListener("click",y),document.removeEventListener("keydown",k)});function S(){i(!1),_("close")}function M(){n(s)?_("quickSave"):(_("save"),S())}function I(){_("saveAs"),S()}function C(){_("newLayout"),S()}function T(V){_("load",{layoutId:V}),S()}function z(V,K){V.stopPropagation(),_("delete",{layoutId:K})}function j(V){return new Date(V).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function B(){const Y=document.querySelector(".chart-container")||document.querySelector(".kline-widget");if(!Y)return`left: ${d().x}px; top: ${d().y}px;`;const Z=Y.getBoundingClientRect();let ne=Z.left+Z.width/2-320/2,te=Z.top+Z.height/2-400/2;return ne=Math.max(20,Math.min(ne,window.innerWidth-320-20)),te=Math.max(20,Math.min(te,window.innerHeight-400-20)),`left: ${ne}px; top: ${te}px;`}Fp(()=>(wp(a()),wp(r())),()=>{x(t,a()?r().find(V=>V.id===a()):null)}),Fp(()=>n(t),()=>{x(s,!!n(t))}),Fp(()=>(wp(i()),wp(r()),wp(a()),n(t),n(s)),()=>{var V;i()&&console.log("🔄 ChartSavePopup reactive update (visible):",{show:i(),savedLayouts:((V=r())==null?void 0:V.length)||0,savedLayoutsData:r(),activeSaveId:a(),activeLayout:n(t),hasActiveSave:n(s)})}),Fp(()=>wp(i()),()=>{i()?setTimeout(()=>{document.addEventListener("click",y),document.addEventListener("keydown",k)},0):(document.removeEventListener("click",y),document.removeEventListener("keydown",k))}),fm(),Sp();var $=So(),F=Rt($);Te(F,i,V=>{var K=gR(),Y=Rt(K),Z=p(Y,2);const ne=kp(B);var te=m(Z),oe=p(m(te),2);f(te);var U=p(te,2),J=m(U),se=m(J),W=m(se);Te(W,l,st=>{var vt=aR();O(st,vt)},st=>{var vt=lR();O(st,vt)});var le=p(W);f(se);var ye=p(se,2),Ce=p(ye,2);f(J),f(U);var Re=p(U,2);Te(Re,()=>n(t),st=>{var vt=dR(),Je=m(vt),ot=p(m(Je),2),nt=m(ot);f(ot);var tt=p(ot,2);Te(tt,c,Ge=>{var pt=cR();O(Ge,pt)}),f(Je);var Ze=p(Je,2),ct=m(Ze);Se(()=>Ve(ct,`Last saved: ${j(new Date(n(t).updatedAt).getTime())??""}`)),f(Ze),f(vt),Se(()=>Ve(nt,`Active: ${n(t).name??""}`)),O(st,vt)});var Ke=p(Re,2);Te(Ke,v,st=>{var vt=mR(),Je=m(vt);Te(Je,()=>r().length===0,ot=>{var nt=uR();O(ot,nt)},ot=>{var nt=fR(),tt=m(nt),Ze=m(tt);f(tt);var ct=p(tt,2);Vs(ct,5,r,_n,(Ge,pt)=>{var ce=vR(),we=m(ce),ze=m(we),dt=m(ze),qe=m(dt,!0);f(dt);var me=p(dt,2);Te(me,()=>n(pt).id===a(),wt=>{var Yt=pR();O(wt,Yt)}),f(ze);var Q=p(ze,2),it=m(Q,!0);Se(()=>Ve(it,j(new Date(n(pt).updatedAt).getTime()))),f(Q),f(we);var Vt=p(we,2);f(ce),Se(()=>{Gn(ce,`group flex items-center justify-between px-3 py-2 hover:bg-base-200 rounded-md transition-colors duration-150 cursor-pointer ${(n(pt).id===a()?"bg-primary/10":"")??""}`),Ve(qe,n(pt).name)}),id("click",Vt,wt=>z(wt,n(pt).id)),id("click",ce,()=>T(n(pt).id)),O(Ge,ce)}),f(ct),f(nt),Se(()=>Ve(Ze,`Saved Layouts (${r().length??""})`)),O(ot,nt)}),f(vt),O(st,vt)}),f(Z),du(Z,st=>x(g,st),()=>n(g)),Se(()=>{Nt(Z,"style",n(ne)),se.disabled=l(),Ve(le,` ${(n(s)?"Save to Current Layout":"Save New Layout")??""}`)}),id("click",Y,S),id("click",oe,S),id("click",se,M),id("click",ye,I),id("click",Ce,C),O(V,K)}),O(o,$),Tc()}var _R=re('<div class="p-6 text-center text-base-content/60 text-sm"><span class="loading loading-spinner loading-xs"></span></div>'),yR=re('<div class="p-6 text-center text-base-content/60 text-sm">No saved layouts yet</div>'),bR=re('<div class="w-1.5 h-1.5 bg-primary rounded-full"></div>'),xR=re('<div><div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="text-sm font-medium text-base-content truncate"> </span> <!></div> <div class="text-xs text-base-content/60"> </div></div> <button class="opacity-0 group-hover:opacity-100 p-1 hover:bg-error/20 rounded transition-all duration-150" title="Delete layout"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>'),wR=re('<div class="p-4"><div class="text-xs font-medium text-base-content/70 px-2 py-2"> </div> <div class="space-y-1"></div></div>'),kR=re('<div class="fixed inset-0 bg-transparent z-40"></div> <div class="fixed z-50 bg-base-100 border border-base-300 rounded-lg shadow-xl animate-in fade-in zoom-in-95 duration-200"><div class="flex items-center justify-between p-4 border-b border-base-300/50"><h3 class="text-lg font-semibold text-base-content">Load Chart Layout</h3> <button class="btn btn-ghost btn-sm btn-circle" title="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="max-h-80 overflow-y-auto svelte-ciowbr"><!></div></div>',1);function SR(o,e){Mc(e,!1);let t=Qs(e,"show",12,!1),s=Qs(e,"savedLayouts",24,()=>[]),i=Qs(e,"activeSaveId",8,null),r=Qs(e,"isLoading",8,!1),a=Qs(e,"position",24,()=>({x:0,y:0})),l=nd();const c=sp();function d(T){n(l)&&!n(l).contains(T.target)&&g()}function v(T){T.key==="Escape"&&g()}hp(()=>{t()&&(document.addEventListener("click",d),document.addEventListener("keydown",v))}),rf(()=>{document.removeEventListener("click",d),document.removeEventListener("keydown",v)});function g(){t(!1),c("close")}function _(T){c("load",{layoutId:T}),g()}function y(T){T!==i()&&_(T)}function k(T,z){T.stopPropagation(),c("delete",{layoutId:z})}function S(T){return new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function M(){const j=document.querySelector(".chart-container")||document.querySelector(".kline-widget");if(!j)return`left: ${a().x}px; top: ${a().y}px;`;const B=j.getBoundingClientRect();let $=B.left+B.width/2-320/2,F=B.top+B.height/2-400/2;return $=Math.max(20,Math.min($,window.innerWidth-320-20)),F=Math.max(20,Math.min(F,window.innerHeight-400-20)),`left: ${$}px; top: ${F}px;`}Fp(()=>wp(t()),()=>{t()?setTimeout(()=>{document.addEventListener("click",d),document.addEventListener("keydown",v)},0):(document.removeEventListener("click",d),document.removeEventListener("keydown",v))}),fm(),Sp();var I=So(),C=Rt(I);Te(C,t,T=>{var z=kR(),j=Rt(z),B=p(j,2);const $=kp(M);var F=m(B),V=p(m(F),2);f(F);var K=p(F,2),Y=m(K);Te(Y,r,Z=>{var ne=_R();O(Z,ne)},Z=>{var ne=So(),te=Rt(ne);Te(te,()=>s().length===0,oe=>{var U=yR();O(oe,U)},oe=>{var U=wR(),J=m(U),se=m(J);f(J);var W=p(J,2);Vs(W,5,s,_n,(le,ye)=>{var Ce=xR(),Re=m(Ce),Ke=m(Re),st=m(Ke),vt=m(st,!0);f(st);var Je=p(st,2);Te(Je,()=>n(ye).id===i(),Ze=>{var ct=bR();O(Ze,ct)}),f(Ke);var ot=p(Ke,2),nt=m(ot,!0);Se(()=>Ve(nt,S(new Date(n(ye).updatedAt).getTime()))),f(ot),f(Re);var tt=p(Re,2);f(Ce),Se(()=>{Gn(Ce,`group flex items-center justify-between px-3 py-2 hover:bg-base-200 rounded-md transition-colors duration-150 cursor-pointer ${(n(ye).id===i()?"bg-primary/10":"")??""}`),Ve(vt,n(ye).name)}),id("click",tt,Ze=>k(Ze,n(ye).id)),id("click",Ce,()=>y(n(ye).id)),O(le,Ce)}),f(W),f(U),Se(()=>Ve(se,`Saved Layouts (${s().length??""})`)),O(oe,U)},!0),O(Z,ne)}),f(K),f(B),du(B,Z=>x(l,Z),()=>n(l)),Se(()=>Nt(B,"style",n($))),id("click",j,g),id("click",V,g),O(T,z)}),O(o,I),Tc()}function CR(o,e,t){n(e)?(console.log("💾 SaveAsSelectModal dispatching saveTo event with layoutId:",n(e)),t("saveTo",{layoutId:n(e)})):console.log("❌ SaveAsSelectModal: No layout selected")}function PR(o,e){e("back")}function IR(o,e){e("cancel")}var MR=re('<div class="p-6 text-center text-base-content/60 text-sm"><span class="loading loading-spinner loading-xs"></span></div>'),TR=re('<div class="p-6 text-center text-base-content/60 text-sm">No saved layouts found.</div>'),AR=re('<label class="flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-base-200"><input type="radio" name="save-as-target" class="radio radio-primary"> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-base-content truncate"> </div> <div class="text-xs text-base-content/60"> </div></div></label>'),LR=re('<span class="loading loading-spinner loading-xs"></span> Saving...',1),zR=re('<div class="space-y-4"><div class="flex items-center justify-between"><button class="btn btn-ghost btn-sm" title="Back">← Back</button> <div></div></div> <div class="text-sm text-base-content/70">Select a saved layout to overwrite with the current chart.</div> <div class="max-h-80 overflow-y-auto divide-y divide-base-300/50 rounded-lg border border-base-300/50 svelte-1a3gcnl"><!></div> <div class="flex justify-end gap-3 pt-2"><button class="btn btn-ghost">Cancel</button> <button class="btn btn-primary"><!></button></div></div>');function FR(o,e){Mc(e,!1);const t=[];let s=Qs(e,"show",12,!1),i=Qs(e,"savedLayouts",24,()=>[]),r=Qs(e,"isLoading",8,!1),a=nd(null);const l=sp();Fp(()=>wp(s()),()=>{s()&&x(a,null)}),fm(),Sp(),av(o,{get show(){return s()},set show(c){s(c)},title:"Save As: Choose Layout to Overwrite",width:520,buttons:[],children:(c,d)=>{var v=zR(),g=m(v),_=m(g);_.__click=[PR,l],pn(2),f(g);var y=p(g,4),k=m(y);Te(k,r,T=>{var z=MR();O(T,z)},T=>{var z=So(),j=Rt(z);Te(j,()=>i().length===0,B=>{var $=TR();O(B,$)},B=>{var $=So(),F=Rt($);Vs(F,1,i,_n,(V,K)=>{var Y=AR(),Z=m(Y);Jt(Z);var ne,te=p(Z,2),oe=m(te),U=m(oe,!0);f(oe);var J=p(oe,2),se=m(J,!0);Se(()=>Ve(se,new Date(n(K).updatedAt).toLocaleString())),f(J),f(te),f(Y),Se(()=>{ne!==(ne=n(K).id)&&(Z.value=(Z.__value=n(K).id)==null?"":n(K).id),Ve(U,n(K).name)}),P5(t,[],Z,()=>(n(K).id,n(a)),W=>x(a,W)),O(V,Y)}),O(B,$)},!0),O(T,z)}),f(y);var S=p(y,2),M=m(S);M.__click=[IR,l];var I=p(M,2);I.__click=[CR,a,l];var C=m(I);Te(C,r,T=>{var z=LR();pn(),O(T,z)},T=>{var z=Yf("Save");O(T,z)}),f(I),f(S),f(v),Se(()=>{M.disabled=r(),I.disabled=!n(a)||r()}),O(c,v)},$$slots:{default:!0},$$legacy:!0}),Tc()}Hd(["click"]);function $R(o,e,t,s,i){jx("normal"),V0(!0),Fx(e().symbol),s(!1),i("close");try{window.predictNextCandle&&window.predictNextCandle()}catch{}}function DR(o,e,t,s){Fx(e().symbol),x(s,"deposit")}function ER(o,e,t,s){$x(n(e)),Dx(Math.max(0,Number(n(t))||0)),x(s,"leverage")}function n2(o,e,t,s,i){Ex(n(e)?n(t)||100:null),Nx(!0),jx("strategy"),s(!1),i("close");const r=window.sidebarHostRef;r&&r.openSidebar&&r.openSidebar()}var NR=re('<div class="grid grid-cols-1 md:grid-cols-2 gap-3 items-stretch"><div class="card lux-card shadow overflow-hidden h-full svelte-ojcx6s"><div class="card-body p-4 min-w-0 flex flex-col h-full"><div class="flex items-center gap-2"><div class="text-sm font-semibold">Normal Price Simulator</div></div> <div class="text-xs opacity-70 mt-1">Auto-play historical candles to simulate price movement.</div> <div class="mt-auto pt-3"><button class="btn btn-premium-primary w-full svelte-ojcx6s" type="button">Start Normal Mode</button></div></div></div> <div class="card lux-card shadow overflow-hidden h-full svelte-ojcx6s"><div class="card-body p-4 min-w-0 flex flex-col h-full"><div class="flex items-center gap-2"><div class="p-2 rounded-full bg-base-300/60"><!></div> <div class="text-sm font-semibold">Trade Strategy Test</div></div> <div class="text-xs opacity-70 mt-1">Deposit, set leverage, buy/pending orders, and track portfolio & PnL.</div> <div class="mt-auto pt-3"><button class="btn btn-premium-outline w-full svelte-ojcx6s" type="button">Start Strategy Mode</button></div></div></div></div>'),jR=(o,e)=>x(e,"choose"),RR=re("<option> </option>"),BR=re('<div class="card lux-card shadow overflow-hidden svelte-ojcx6s"><div class="card-body p-4 min-w-0"><div class="text-sm font-semibold">Confirm Deposit</div> <div class="mt-2 flex items-center"><button class="btn btn-xs btn-premium-outline svelte-ojcx6s" type="button">Back</button></div> <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-2 items-end"><div class="flex flex-col gap-1"><div class="text-xs opacity-80">Currency</div> <select class="select select-bordered select-sm"></select></div> <input class="input input-bordered input-sm" type="number" min="0" placeholder="Deposit"> <button class="btn btn-sm btn-premium-primary svelte-ojcx6s" type="button">Confirm Deposit</button></div></div></div>'),OR=(o,e)=>x(e,"deposit"),VR=(o,e)=>x(e,!0),WR=(o,e)=>x(e,!1),qR=re('<div class="mt-2 flex items-center gap-2"><select class="select select-bordered select-sm"><option>1:50</option><option>1:100</option><option>1:200</option><option>1:400</option><option>1:500</option></select> <button class="btn btn-sm btn-premium-primary svelte-ojcx6s" type="button">Confirm</button></div>'),HR=re('<div class="mt-2"><button class="btn btn-sm btn-premium-outline svelte-ojcx6s" type="button">Confirm</button></div>'),GR=re('<div class="card lux-card shadow overflow-hidden svelte-ojcx6s"><div class="card-body p-4 min-w-0"><div class="text-sm font-semibold">Take leverage?</div> <div class="mt-2 flex items-center"><button class="btn btn-xs btn-premium-outline svelte-ojcx6s" type="button">Back</button></div> <div class="mt-2 flex items-center gap-2"><label class="label cursor-pointer"><input type="radio" name="lev-modal" class="radio radio-sm"> <span class="label-text ml-2">Yes</span></label> <label class="label cursor-pointer"><input type="radio" name="lev-modal" class="radio radio-sm"> <span class="label-text ml-2">No</span></label></div> <!></div></div>'),UR=re('<div class="p-3 space-y-3"><!></div>');function YR(o,e){Mc(e,!0);const t=Au(),s=()=>ua(d,"$save",t);let i=Qs(e,"show",15),r=ee("choose"),a=ee(1e5),l=ee(!1),c=ee(null);const d=vc("save");let v=ee(D(s().symbol.priceCurrency||"USD"));const g=sp();function _(y){y==="close"&&g("close")}av(o,{get show(){return i()},set show(y){i(y)},title:"Choose Simulator Mode",buttons:[],click:_,get theme(){return s().theme},children:(y,k)=>{var S=UR(),M=m(S);Te(M,()=>n(r)==="choose",I=>{var C=NR(),T=m(C),z=m(T),j=p(m(z),4),B=m(j);B.__click=[$R,s,d,i,g],f(j),f(z),f(T);var $=p(T,2),F=m($),V=m(F),K=m(V),Y=m(K);JA(Y,{size:18}),f(K),pn(2),f(V);var Z=p(V,4),ne=m(Z);ne.__click=[DR,s,d,r],f(Z),f(F),f($),f(C),O(I,C)},I=>{var C=So(),T=Rt(C);Te(T,()=>n(r)==="deposit",z=>{var j=BR(),B=m(j),$=p(m(B),2),F=m($);F.__click=[jR,r],f($);var V=p($,2),K=m(V),Y=p(m(K),2);Vs(Y,21,()=>Ox,_n,(te,oe)=>{var U=RR(),J={},se=m(U,!0);f(U),Se(()=>{J!==(J=n(oe))&&(U.value=(U.__value=n(oe))==null?"":n(oe)),Ve(se,n(oe))}),O(te,U)}),f(Y),f(K);var Z=p(K,2);Jt(Z);var ne=p(Z,2);ne.__click=[ER,v,a,r],f(V),f(B),f(j),rs(Y,()=>n(v),te=>x(v,te)),Ho(Z,()=>n(a),te=>x(a,te)),O(z,j)},z=>{var j=GR(),B=m(j),$=p(m(B),2),F=m($);F.__click=[OR,r],f($);var V=p($,2),K=m(V),Y=m(K);Jt(Y),Y.__click=[VR,l],pn(2),f(K);var Z=p(K,2),ne=m(Z);Jt(ne),ne.__click=[WR,l],pn(2),f(Z),f(V);var te=p(V,2);Te(te,()=>n(l),oe=>{var U=qR(),J=m(U),se=m(J);se.value=(se.__value=50)==null?"":50;var W=p(se);W.value=(W.__value=100)==null?"":100;var le=p(W);le.value=(le.__value=200)==null?"":200;var ye=p(le);ye.value=(ye.__value=400)==null?"":400;var Ce=p(ye);Ce.value=(Ce.__value=500)==null?"":500,f(J);var Re=p(J,2);Re.__click=[n2,l,c,i,g],f(U),rs(J,()=>n(c),Ke=>x(c,Ke)),O(oe,U)},oe=>{var U=HR(),J=m(U);J.__click=[n2,l,c,i,g],f(U),O(oe,U)}),f(B),f(j),Se(()=>{wv(Y,n(l)),wv(ne,!n(l))}),O(z,j)},!0),O(I,C)}),f(S),O(y,S)},$$slots:{default:!0}}),Tc()}Hd(["click"]);var KR=re('<div class="toast svelte-66mo1o"><span class="toast-message svelte-66mo1o"> </span></div>');function ew(o,e){Mc(e,!1);let t=Qs(e,"message",8,""),s=Qs(e,"duration",8,3e3),i=Qs(e,"visible",12,!1);const r=sp();let a=nd();hp(()=>{i()&&l()});function l(){i(!0),setTimeout(()=>{c()},s())}function c(){i(!1),r("hide")}Sp();var d=So(),v=Rt(d);return Te(v,i,g=>{var _=KR(),y=m(_),k=m(y,!0);f(y),f(_),du(_,S=>x(a,S),()=>n(a)),Se(()=>{ii(_,"show",i()),Ve(k,t())}),O(g,_)}),O(o,d),oy(e,"showToast",l),oy(e,"hideToast",c),Tc({showToast:l,hideToast:c})}function ZR(o,e,t,s,i,r,a){const l=e().theme==="dark"?"light":"dark";if(s()){x(i,D(l)),x(r,!0);return}a(l,!0)}function XR(o,e,t,s){n(e)&&(t(n(e),!0),x(s,!1),x(e,null))}function JR(o,e,t,s){n(e)&&(t(n(e),!1),x(s,!1),x(e,null))}function QR(o,e,t,s,i,r,a,l){const c=o.target;if(!c.files||!c.files.length)return;const d=c.files[0],v=d.name.split(".").shift()||"Unknown";Fz.parse(d,{skipEmptyLines:!0,complete:g=>{var y;const _=g.data.map(k=>({timestamp:parseInt(k[0]),open:parseFloat(k[1]),high:parseFloat(k[2]),low:parseFloat(k[3]),close:parseFloat(k[4]),volume:parseFloat(k[5])}));if(x(e,D(v)),_.length>1){const k=_.length-1,S=Math.min(_[1].timestamp-_[0].timestamp,_[k].timestamp-_[k-1].timestamp);Wa(s,ys(t).period=nv(yk(S/1e3)),ys(t))}_.length>0&&pT(Math.min(_[0].low,_[_.length-1].low))+3,(y=i())==null||y.applyNewData(_,!1),Wa(l,ys(a).loadingKLine=!1,ys(a)),Wa(l,ys(a).klineLoaded+=1,ys(a))}})}function eB(o,e,t,s,i){const r=!n(e);x(e,r);try{sessionStorage.setItem("drawbarShown",String(r))}catch{}try{const a=t();a&&a.style.setProperty("--drawing-bar-width",r?"52px":"0px");const l=typeof document<"u"?document.querySelector(".kline-main"):null;l&&l.style.setProperty("--drawing-bar-width",r?"52px":"0px");const c=typeof document<"u"?document.querySelector(".drawbar-host"):null;c&&(c.style.width=r?"52px":"0px",c.style.overflow="hidden");const d=typeof document<"u"?document.querySelector(".drawbar-container"):null;d&&r&&(d.style.borderRightWidth="2px",d.style.borderRightStyle="solid",d.style.borderRightColor="var(--menu-border)");const v=typeof document<"u"?document.querySelector(".drawbar-wrapper"):null;v&&r&&(v.style.display="")}catch{}requestAnimationFrame(()=>{var a;(a=s())==null||a.resize()})}async function tB(o,e,t,s,i,r,a,l,c,d,v,g){if(!n(e)){x(e,!0);try{if(n(t))if(s())try{d();let _=!1;if(document.webkitExitFullscreen)try{document.webkitExitFullscreen(),_=!0}catch(y){console.log("webkitExitFullscreen failed:",y)}if(window.iosFullscreenCleanup)try{window.iosFullscreenCleanup(),delete window.iosFullscreenCleanup,_=!0}catch(y){console.log("iOS cleanup function failed:",y)}if(!_)try{document.body.classList.remove("ios-fullscreen");const y=document.getElementById("ios-fullscreen-style");y&&y.remove();const k=document.querySelector('meta[name="viewport"]');k&&k.setAttribute("content","width=device-width, initial-scale=1.0")}catch(y){console.log("Manual iOS cleanup failed:",y)}x(t,!1),x(v,!1),setTimeout(()=>{a()&&a().resize(),setTimeout(()=>{x(e,!1)},50)},150)}catch(_){console.log("iOS exit rotation failed:",_),x(t,!1),x(v,!1),x(e,!1)}else{try{"screen"in window&&"orientation"in window.screen&&"unlock"in window.screen.orientation&&window.screen.orientation.unlock()}catch(_){console.log("Screen orientation unlock failed:",_)}await g(),x(t,!1),a()?setTimeout(()=>{a().resize(),setTimeout(()=>{x(e,!1)},50)},150):setTimeout(()=>{x(e,!1)},50)}else if(s())try{await i(),window.DeviceOrientationEvent&&r(),x(t,!0),setTimeout(()=>{window.scrollTo(0,1),setTimeout(()=>{window.scrollTo(0,0),a()&&a().resize(),setTimeout(()=>{x(e,!1)},50)},50)},100)}catch(_){console.log("iOS rotation setup failed:",_),x(t,!0),x(e,!1)}else await c(),setTimeout(async()=>{try{"screen"in window&&"orientation"in window.screen&&"lock"in window.screen.orientation?await window.screen.orientation.lock("landscape"):console.log("Screen Orientation API not supported. Please rotate your device manually.")}catch(_){console.log("Screen orientation lock failed:",_)}x(t,!0),a()?setTimeout(()=>{a().resize(),setTimeout(()=>{x(e,!1)},50)},100):setTimeout(()=>{x(e,!1)},50)},50)}catch(_){console.error("Rotation failed:",_),x(t,!1),x(e,!1)}}}function oB(o,e,t,s){if(e()){const i=e().querySelector(".chart-container");if(i){const r=i.getBoundingClientRect();x(t,D({x:r.left+r.width/2,y:r.top+r.height/2}))}else{const r=e().getBoundingClientRect();x(t,D({x:r.left+r.width/2,y:r.top+r.height/2}))}}x(s,!0)}var sB=re('<div class="save-overlay svelte-pyr5xt"><div class="save-success svelte-pyr5xt">Saved to current layout</div></div>'),nB=(o,e)=>{var t;return(t=n(e))==null?void 0:t.click()},iB=re('<div class="custom-load-section svelte-pyr5xt"><input type="file" class="hidden svelte-pyr5xt" accept="text/csv"> <button class="custom-load-btn svelte-pyr5xt"><span class="custom-load-text svelte-pyr5xt">打开</span> <div class="custom-load-glow svelte-pyr5xt"></div></button></div>'),rB=re('<div class="rotate-loading-overlay svelte-pyr5xt"><div class="rotate-loading-spinner svelte-pyr5xt"><div class="rotate-spinner-ring svelte-pyr5xt"></div> <div class="rotate-spinner-ring svelte-pyr5xt"></div> <div class="rotate-spinner-ring svelte-pyr5xt"></div></div> <div class="rotate-loading-text svelte-pyr5xt">Rotating...</div></div>'),aB=Bi('<path d="M322.402 1.33524C319.002 2.83524 282.402 41.3352 279.802 46.2352C277.602 50.4352 277.602 56.6352 279.802 60.9352C282.102 65.5352 317.402 107.535 320.802 109.735C324.702 112.235 335.002 112.035 338.602 109.335C345.002 104.635 347.402 97.6352 345.002 90.4352C344.302 88.4352 340.902 83.3352 337.402 79.1352C333.902 74.9352 331.302 71.3352 331.502 71.1352C331.702 70.8352 334.802 71.2352 338.202 71.8352C379.802 79.7352 409.802 111.735 415.002 153.835C416.302 163.835 417.802 167.035 422.702 170.435C430.002 175.335 440.902 173.135 445.702 165.735C448.202 162.135 448.302 161.435 447.702 152.135C446.102 124.435 432.902 96.5352 411.102 74.9352C390.202 54.0352 367.102 42.7352 336.702 38.4352L331.902 37.8352L338.402 30.9352C345.302 23.5352 347.002 18.9352 345.502 12.0352C343.502 2.73524 331.702 -2.66476 322.402 1.33524Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M169.504 40.9358C163.204 42.2358 157.004 44.7358 152.004 47.9358C149.504 49.5358 125.204 73.2358 97.8044 100.636C44.9044 153.736 44.8044 153.936 41.4044 167.236C39.3044 175.336 40.0044 188.336 43.0044 196.136C44.1044 199.336 47.1044 204.436 49.4044 207.636C51.8044 210.836 95.8043 255.336 147.104 306.536C217.704 376.836 241.704 400.236 245.604 402.236C259.904 409.736 277.304 409.836 292.304 402.336C296.404 400.336 308.404 388.836 348.304 349.136C393.904 303.636 399.404 297.736 402.504 291.736C406.904 282.936 408.404 275.436 407.704 265.436C407.104 255.636 404.304 247.836 398.604 240.236C396.204 237.036 352.404 192.736 301.404 141.836C200.004 40.8358 204.204 44.5358 189.304 41.4358C181.904 39.8358 175.704 39.7358 169.504 40.9358ZM185.804 74.8358C187.904 75.9358 229.704 117.136 281.704 169.136C363.504 251.136 373.904 261.836 374.504 265.236C376.204 274.436 377.804 272.436 326.204 324.336C299.004 351.536 277.104 372.736 275.304 373.536C270.904 375.436 266.604 375.336 262.204 373.036C257.604 370.636 76.8043 189.636 74.6043 185.236C72.4043 180.936 72.6043 175.636 75.0043 170.936C78.3043 164.336 78.8044 164.436 94.8044 172.336C108.704 179.136 109.704 179.436 117.404 179.736C123.904 180.036 126.704 179.636 131.504 177.936C136.904 175.836 139.304 173.836 156.604 156.536C173.904 139.236 175.904 136.836 178.004 131.436C179.704 126.636 180.104 123.836 179.804 117.336C179.504 109.636 179.204 108.636 172.404 94.7358C164.504 78.8358 164.504 78.3358 170.804 74.9358C175.604 72.4358 181.104 72.4358 185.804 74.8358ZM133.404 133.036L119.404 147.036L112.204 143.736L105.004 140.436L122.804 122.636L140.504 104.936L144.004 111.936L147.504 118.936L133.404 133.036Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M310.402 275.936C308.602 276.336 305.902 277.536 304.402 278.736C299.102 282.436 278.102 304.436 277.102 307.336C275.502 311.236 275.802 318.536 277.502 321.836C280.902 328.436 288.102 331.836 295.802 330.436C298.802 329.836 302.002 327.236 313.902 315.636C321.802 307.836 328.902 300.036 329.602 298.236C334.902 285.836 323.602 272.736 310.402 275.936Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M7.40372 276.837C-0.296283 281.537 -1.79628 290.337 2.00372 309.037C12.9037 362.537 55.5037 401.637 111.304 409.437L116.104 410.037L109.604 416.937C102.704 424.337 101.004 428.937 102.504 435.837C104.504 445.137 116.004 450.537 125.304 446.537C128.904 445.037 165.304 407.037 168.304 401.637C170.504 397.537 170.504 391.337 168.204 386.937C165.904 382.337 130.604 340.337 127.204 338.137C123.304 335.637 113.004 335.837 109.404 338.537C103.004 343.237 100.604 350.237 103.004 357.437C103.704 359.437 107.104 364.537 110.604 368.737C114.104 372.937 116.704 376.537 116.504 376.737C116.304 377.037 113.204 376.637 109.804 376.037C79.4037 370.237 54.9037 351.637 41.9037 324.437C36.6037 313.337 34.4037 305.937 32.9037 293.737C31.7037 284.037 30.2037 280.837 25.3037 277.437C20.5037 274.237 12.1037 273.937 7.40372 276.837Z" fill="currentColor" class="svelte-pyr5xt"></path>',1),lB=Bi('<path d="M322.402 1.33524C319.002 2.83524 282.402 41.3352 279.802 46.2352C277.602 50.4352 277.602 56.6352 279.802 60.9352C282.102 65.5352 317.402 107.535 320.802 109.735C324.702 112.235 335.002 112.035 338.602 109.335C345.002 104.635 347.402 97.6352 345.002 90.4352C344.302 88.4352 340.902 83.3352 337.402 79.1352C333.902 74.9352 331.302 71.3352 331.502 71.1352C331.702 70.8352 334.802 71.2352 338.202 71.8352C379.802 79.7352 409.802 111.735 415.002 153.835C416.302 163.835 417.802 167.035 422.702 170.435C430.002 175.335 440.902 173.135 445.702 165.735C448.202 162.135 448.302 161.435 447.702 152.135C446.102 124.435 432.902 96.5352 411.102 74.9352C390.202 54.0352 367.102 42.7352 336.702 38.4352L331.902 37.8352L338.402 30.9352C345.302 23.5352 347.002 18.9352 345.502 12.0352C343.502 2.73524 331.702 -2.66476 322.402 1.33524Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M169.504 40.9358C163.204 42.2358 157.004 44.7358 152.004 47.9358C149.504 49.5358 125.204 73.2358 97.8044 100.636C44.9044 153.736 44.8044 153.936 41.4044 167.236C39.3044 175.336 40.0044 188.336 43.0044 196.136C44.1044 199.336 47.1044 204.436 49.4044 207.636C51.8044 210.836 95.8043 255.336 147.104 306.536C217.704 376.836 241.704 400.236 245.604 402.236C259.904 409.736 277.304 409.836 292.304 402.336C296.404 400.336 308.404 388.836 348.304 349.136C393.904 303.636 399.404 297.736 402.504 291.736C406.904 282.936 408.404 275.436 407.704 265.436C407.104 255.636 404.304 247.836 398.604 240.236C396.204 237.036 352.404 192.736 301.404 141.836C200.004 40.8358 204.204 44.5358 189.304 41.4358C181.904 39.8358 175.704 39.7358 169.504 40.9358ZM185.804 74.8358C187.904 75.9358 229.704 117.136 281.704 169.136C363.504 251.136 373.904 261.836 374.504 265.236C376.204 274.436 377.804 272.436 326.204 324.336C299.004 351.536 277.104 372.736 275.304 373.536C270.904 375.436 266.604 375.336 262.204 373.036C257.604 370.636 76.8043 189.636 74.6043 185.236C72.4043 180.936 72.6043 175.636 75.0043 170.936C78.3043 164.336 78.8044 164.436 94.8044 172.336C108.704 179.136 109.704 179.436 117.404 179.736C123.904 180.036 126.704 179.636 131.504 177.936C136.904 175.836 139.304 173.836 156.604 156.536C173.904 139.236 175.904 136.836 178.004 131.436C179.704 126.636 180.104 123.836 179.804 117.336C179.504 109.636 179.204 108.636 172.404 94.7358C164.504 78.8358 164.504 78.3358 170.804 74.9358C175.604 72.4358 181.104 72.4358 185.804 74.8358ZM133.404 133.036L119.404 147.036L112.204 143.736L105.004 140.436L122.804 122.636L140.504 104.936L144.004 111.936L147.504 118.936L133.404 133.036Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M310.402 275.936C308.602 276.336 305.902 277.536 304.402 278.736C299.102 282.436 278.102 304.436 277.102 307.336C275.502 311.236 275.802 318.536 277.502 321.836C280.902 328.436 288.102 331.836 295.802 330.436C298.802 329.836 302.002 327.236 313.902 315.636C321.802 307.836 328.902 300.036 329.602 298.236C334.902 285.836 323.602 272.736 310.402 275.936Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M7.40372 276.837C-0.296283 281.537 -1.79628 290.337 2.00372 309.037C12.9037 362.537 55.5037 401.637 111.304 409.437L116.104 410.037L109.604 416.937C102.704 424.337 101.004 428.937 102.504 435.837C104.504 445.137 116.004 450.537 125.304 446.537C128.904 445.037 165.304 407.037 168.304 401.637C170.504 397.537 170.504 391.337 168.204 386.937C165.904 382.337 130.604 340.337 127.204 338.137C123.304 335.637 113.004 335.837 109.404 338.537C103.004 343.237 100.604 350.237 103.004 357.437C103.704 359.437 107.104 364.537 110.604 368.737C114.104 372.937 116.704 376.537 116.504 376.737C116.304 377.037 113.204 376.637 109.804 376.037C79.4037 370.237 54.9037 351.637 41.9037 324.437C36.6037 313.337 34.4037 305.937 32.9037 293.737C31.7037 284.037 30.2037 280.837 25.3037 277.437C20.5037 274.237 12.1037 273.937 7.40372 276.837Z" fill="currentColor" class="svelte-pyr5xt"></path>',1),cB=(o,e)=>x(e,!0),dB=(o,e,t)=>e(n(t)),uB=re('<button><span class="timeframe-text svelte-pyr5xt"> </span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),pB=(o,e,t)=>e(t[0]),vB=re('<button><span class="timeframe-text svelte-pyr5xt">4h</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),fB=(o,e,t)=>e(n(t)),mB=re('<button><span class="timeframe-text svelte-pyr5xt"> </span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),gB=re('<div class="timeframe-group desktop-only svelte-pyr5xt"><!> <!> <!></div>'),hB=(o,e,t)=>e(t.find(s=>s.timeframe==="1d")),_B=re('<button><span class="timeframe-text svelte-pyr5xt">1d</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),yB=(o,e,t)=>e(t.find(s=>s.timeframe==="1w")),bB=re('<button><span class="timeframe-text svelte-pyr5xt">1w</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),xB=(o,e)=>x(e,!n(e)),wB=(o,e,t)=>e(n(t)),kB=re('<button><span class="timeframe-text svelte-pyr5xt"> </span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),SB=(o,e,t)=>e(t[0]),CB=re('<button><span class="timeframe-text svelte-pyr5xt">4h</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),PB=(o,e,t)=>e(t.find(s=>s.timeframe==="1M")),IB=re('<button><span class="timeframe-text svelte-pyr5xt">1M</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),MB=re('<div class="timeframe-inline-expand svelte-pyr5xt"><!> <!> <!></div>'),TB=re('<div class="timeframe-group mobile-only svelte-pyr5xt"><!> <!> <button aria-label="More timeframes" title="More"><span class="timeframe-text svelte-pyr5xt">⋯</span> <div class="timeframe-glow svelte-pyr5xt"></div></button> <!></div>'),AB=(o,e)=>x(e,!0),LB=(o,e)=>x(e,!0),zB=(o,e)=>x(e,!0),FB=(o,e)=>x(e,!0),$B=re('<button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Play" type="button"><!></button>'),DB=re('<button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" disabled title="Simulator active" type="button"><!></button>'),EB=(o,e)=>x(e,!0),NB=(o,e)=>x(e,!0),jB=(o,e,t)=>{e("🖱️ Fullscreen button clicked!"),t()},RB=(o,e)=>e(o),BB=(o,e)=>e(o),OB=o=>{o.preventDefault(),o.stopPropagation()},VB=(o,e)=>e(o),WB=re('<button class="menu-scroll-arrow svelte-pyr5xt" title="Scroll to see more" aria-label="Scroll right" type="button"><span class="arrow-icon svelte-pyr5xt"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-pyr5xt"><polyline points="9 18 15 12 9 6" class="svelte-pyr5xt"></polyline></svg></span></button>'),qB=re(`<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/50 svelte-pyr5xt" role="dialog" aria-modal="true"><div class="bg-base-100 rounded-lg shadow-xl p-6 w-full max-w-md svelte-pyr5xt"><div class="text-base-content text-lg font-semibold mb-2 svelte-pyr5xt">Switch chart template theme?</div> <div class="text-base-content/80 text-sm mb-5 svelte-pyr5xt"> <br class="svelte-pyr5xt"> Would you like to switch the chart template's theme too?</div> <div class="flex justify-end gap-2 svelte-pyr5xt"><button class="btn btn-sm svelte-pyr5xt" type="button">No</button> <button class="btn btn-sm btn-primary svelte-pyr5xt" type="button">Yes</button></div></div></div>`),HB=re('<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <div class="menu-wrapper svelte-pyr5xt"><div class="menu-container svelte-pyr5xt"><div class="menu-left-section svelte-pyr5xt"><div class="menu-toggle-wrapper svelte-pyr5xt"><button class="menu-toggle-btn svelte-pyr5xt" title="Toggle Left Panel"><div class="menu-toggle-icon-wrapper svelte-pyr5xt"><svg viewBox="0 0 1024 1024"><path d="M192.037 287.953h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32zM832.161 479.169H438.553c-17.673 0-32 14.327-32 32s14.327 32 32 32h393.608c17.673 0 32-14.327 32-32s-14.327-32-32-32zM832.161 735.802H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32zM319.028 351.594l-160 160 160 160z" class="svelte-pyr5xt"></path></svg></div> <div class="menu-toggle-glow svelte-pyr5xt"></div></button></div> <!> <div class="rotate-button-wrapper-mobile svelte-pyr5xt"><button type="button"><!> <div class="menu-btn-content svelte-pyr5xt"><div class="menu-icon-wrapper svelte-pyr5xt"><svg width="20" height="20" viewBox="0 0 448 448" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-pyr5xt"><!></svg></div></div> <div class="menu-btn-glow svelte-pyr5xt"></div></button></div> <div class="symbol-search-section svelte-pyr5xt"><div class="symbol-search-content svelte-pyr5xt"><div class="symbol-search-icon svelte-pyr5xt"><!></div> <span class="symbol-name svelte-pyr5xt"> </span></div></div> <div class="timeframe-section svelte-pyr5xt"><!> <!></div> <div class="ai-section svelte-pyr5xt"><button class="ai-btn group relative overflow-hidden svelte-pyr5xt" aria-label="AI Indicators" title="AI Powered Indicators" type="button"><div class="ai-glitter-bg svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-1 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-2 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-3 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-4 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-5 svelte-pyr5xt"></div> <div class="ai-shine-sweep svelte-pyr5xt"></div> <div class="ai-btn-content svelte-pyr5xt"><div class="ai-icon-wrapper svelte-pyr5xt"><svg class="ai-icon svelte-pyr5xt" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-pyr5xt"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-pyr5xt"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-pyr5xt"></line></svg></div> <span class="ai-text svelte-pyr5xt">AI</span> <div class="ai-badge-mini svelte-pyr5xt">New</div></div></button></div> <div class="chart-type-section svelte-pyr5xt"><button class="pro-menu-btn svelte-pyr5xt" title="Chart Type"><!> <span class="pro-menu-text svelte-pyr5xt"> </span></button></div> <div class="indicator-section svelte-pyr5xt"><button class="pro-menu-btn svelte-pyr5xt" title="Indicators"><!> <span class="pro-menu-text svelte-pyr5xt"> </span></button></div> <div class="undo-redo-section svelte-pyr5xt"><button title="Undo (Ctrl+Z)"><!></button> <button title="Redo (Ctrl+Y)"><!></button></div></div> <div class="menu-right-section svelte-pyr5xt"><!> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Load Chart Layout" type="button"><!></button> <!> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Timezone" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Settings" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Script Studio" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Screenshot" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Toggle Theme" type="button"><!></button></div></div> <!></div> <!> <!>',1);function GB(o,e){Mc(e,!0);const t=Au(),s=()=>ua(g,"$chart",t),i=()=>ua(y,"$save",t),r=()=>ua(_,"$ctx",t),a=()=>ua(Nf,"$userPreferences",t),l=()=>ua(Ks,"$isRenkoActive",t),c=()=>ua(np,"$simulator",t);let d=Qs(e,"customLoad",3,!1),v=Qs(e,"mainContainer",15);const g=vc("chart"),_=vc("ctx"),y=vc("save");let k=ee(!0);hp(()=>{try{const he=sessionStorage.getItem("drawbarShown");if(he!=null){x(k,he==="true");const ke=v(),Ne=typeof document<"u"?document.querySelector(".kline-main"):null,ie=typeof document<"u"?document.querySelector(".drawbar-host"):null,Ct=n(k)?"52px":"0px";ke&&ke.style.setProperty("--drawing-bar-width",Ct),Ne&&Ne.style.setProperty("--drawing-bar-width",Ct),ie&&(ie.style.width=Ct)}else{const ke=typeof document<"u"?document.querySelector(".drawbar-host"):null;if(ke){const Ne=parseFloat(getComputedStyle(ke).width||"52");x(k,Ne>0)}}}catch{}});const S="*";function M(){let he=document;return(he.fullscreenElement||he.mozFullScreenElement||he.webkitFullscreenElement||he.msFullscreenElement)!=null}let I=ee(D(M())),C=ee(!1);{const he=()=>{const Ne=n(I);if(x(I,D(M())),Ne&&!n(I)){if(s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const ie=Sd(i().theme);uo.merge(ie,i().styles),s().setStyles(Dc(ie)),r().applyCanvasColors&&r().applyCanvasColors(),console.log("🎨 Pre-applied chart styles before fullscreen exit")}v()&&(v(v().style.cssText="",!0),v().classList.remove("fullscreen")),setTimeout(()=>{var ie;if(v()&&(v().offsetHeight,v().offsetWidth,window.getComputedStyle(v()).height),(ie=s())==null||ie.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Ct=Sd(i().theme);uo.merge(Ct,i().styles),s().setStyles(Dc(Ct)),r().applyCanvasColors&&r().applyCanvasColors()}},10),setTimeout(()=>{var ie;if((ie=s())==null||ie.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Ct=Sd(i().theme);uo.merge(Ct,i().styles),s().setStyles(Dc(Ct)),r().applyCanvasColors&&r().applyCanvasColors()}},100),setTimeout(()=>{var ie;if((ie=s())==null||ie.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Ct=Sd(i().theme);if(uo.merge(Ct,i().styles),s().setStyles(Dc(Ct)),r().applyCanvasColors){r().applyCanvasColors();const Kt=s().getVisibleRange();Kt&&s().scrollToDataIndex(Kt.to,0)}console.log("✅ Final chart colors applied after fullscreen exit")}},300),setTimeout(()=>{var ie;(ie=s())==null||ie.resize()},600),setTimeout(()=>{var ie;(ie=s())==null||ie.resize()},1200)}else setTimeout(()=>{var ie;(ie=s())==null||ie.resize()},100)},ke=()=>{if(console.log("📱 handleIOSFullscreenChange triggered"),Xi()){const Ne=window.innerHeight===screen.height,ie=document.body.classList.contains("ios-fullscreen"),Ct=window.navigator.standalone;console.log("🔍 iOS fullscreen checks:",{heightMatch:Ne,hasIOSClass:ie,isStandalone:Ct,windowHeight:window.innerHeight,screenHeight:screen.height,currentFullScreen:n(I)});const Kt=Ne||ie||Ct,fo=n(I);if(n(I)!==Kt){if(console.log(`🔄 iOS fullscreen state changed: ${n(I)} → ${Kt}`),x(I,D(Kt)),fo&&!Kt&&s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const mo=Sd(i().theme);uo.merge(mo,i().styles),s().setStyles(Dc(mo)),r().applyCanvasColors&&r().applyCanvasColors(),console.log("🎨 Pre-applied chart styles for iOS exit")}console.log("📏 Scheduling iOS chart resizes..."),setTimeout(()=>{var mo;if((mo=s())==null||mo.resize(),fo&&!Kt&&s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Go=Sd(i().theme);uo.merge(Go,i().styles),s().setStyles(Dc(Go)),r().applyCanvasColors&&r().applyCanvasColors()}},100),setTimeout(()=>{var mo;if((mo=s())==null||mo.resize(),fo&&!Kt&&s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Go=Sd(i().theme);if(uo.merge(Go,i().styles),s().setStyles(Dc(Go)),r().applyCanvasColors){r().applyCanvasColors();const Fo=s().getVisibleRange();Fo&&s().scrollToDataIndex(Fo.to,0)}console.log("✅ Final iOS chart colors applied")}},300)}else console.log("✅ No iOS fullscreen state change needed")}else console.log("❌ Not iOS Safari, skipping handler")};document.addEventListener("fullscreenchange",he),document.addEventListener("webkitfullscreenchange",he),document.addEventListener("mozfullscreenchange",he),document.addEventListener("MSFullscreenChange",he),Xi()&&(window.addEventListener("resize",ke),window.addEventListener("orientationchange",ke),document.addEventListener("webkitfullscreenchange",ke),"standalone"in window.navigator&&window.addEventListener("beforeunload",()=>{n(ce)&&n(ce)()}))}let T=ee(!1),z=ee(!1),j=ee(!1),B=ee(!1),$=ee(!1),F=ee(!1),V=ee(!1),K=ee(!1),Y=ee(""),Z=ee(""),ne=ee(!1),te=ee(!1),oe=ee(!1),U=ee(!1),J=ee(!1),se=ee(null),W=ee(!1),le=ee(!1),ye=ee(!1),Ce=ee(D({x:0,y:0})),Re=ee(!1),Ke=ee(D({x:0,y:0})),st=ee(D([])),vt=ee(null),Je=ee(!1),ot=ee(!1),nt=!1,tt=ee(!1),Ze=ee(""),ct=ee(!1),Ge=ee(D({x:0,y:0}));function pt(){try{if(v()){const ke=(v().querySelector(".chart-container")||v()).getBoundingClientRect();x(Ge,D({x:ke.left+ke.width/2,y:ke.top+ke.height/2}))}else{const he=typeof window<"u"?window.innerWidth:0,ke=typeof window<"u"?window.innerHeight:0;x(Ge,D({x:he/2,y:ke/2}))}}catch{}}let ce=ee(null);function we(he){console.log(he)}let ze=ee(void 0);const dt=[{timeframe:"1m",multiplier:1,timespan:"minute",secs:60},{timeframe:"5m",multiplier:5,timespan:"minute",secs:300},{timeframe:"15m",multiplier:15,timespan:"minute",secs:900},{timeframe:"30m",multiplier:30,timespan:"minute",secs:1800},{timeframe:"1h",multiplier:1,timespan:"hour",secs:3600}],qe=[{timeframe:"1d",multiplier:1,timespan:"day",secs:86400},{timeframe:"1w",multiplier:1,timespan:"week",secs:604800},{timeframe:"1M",multiplier:1,timespan:"month",secs:2592e3}],me=[{timeframe:"4h",multiplier:4,timespan:"hour",secs:14400}],Q=[{id:"candle_solid",name:"Candlestick",icon:"candle_solid"},{id:"candle_stroke",name:"Hollow",icon:"candle_stroke"},{id:"candle_up_stroke",name:"Up Hollow",icon:"candle_up_stroke"},{id:"candle_down_stroke",name:"Down Hollow",icon:"candle_down_stroke"},{id:"heikin_ashi",name:"Heikin Ashi",icon:"candle_solid"},{id:"renko_atr",name:"Duty AI Renko",icon:"candle_solid"},{id:"point_and_figure",name:"Point & Figure",icon:"point_and_figure"},{id:"ohlc",name:"OHLC",icon:"ohlc"},{id:"area",name:"Area",icon:"area"},{id:"line_chart",name:"Line",icon:"line"}];let it=ee(!1),Vt=ee(!1),wt=ee(!1),Yt=ee(!1),At=ee(void 0);zr(()=>{let he=null,ke=null;function Ne(){return typeof window<"u"&&window.saveManager?(he=window.saveManager.state.subscribe(Ct=>{console.log("📊 SaveManager state updated:",Ct),Ct.initialized?(console.log("🔗 SaveManager is initialized, updating UI state..."),x(st,D(Ct.savedLayouts)),x(vt,D(Ct.activeSaveId)),x(Je,D(Ct.isLoading)),ke&&(clearInterval(ke),ke=null)):console.log("⏳ SaveManager exists but not yet initialized...")}),!0):!1}return Ne()||(console.log("⏳ Waiting for SaveManager to be available..."),ke=setInterval(()=>{Ne()},100)),()=>{he&&he(),ke&&clearInterval(ke)}});function Gt(){s()&&setTimeout(()=>{s().resize()},300)}hp(()=>{nu.init({chart:s(),saveStore:y,overlaysStore:null});const he=()=>{x(Vt,D(nu.canUndo())),x(wt,D(nu.canRedo()))};he();const ke=setInterval(he,100);"screen"in window&&"orientation"in window.screen?window.screen.orientation.addEventListener("change",Gt):window.addEventListener("orientationchange",Gt),qa();const Ne=()=>{qa()},ie=()=>{qa(),typeof window<"u"&&x(U,window.innerWidth<=768)};return n(At)&&n(At).addEventListener("scroll",Ne),window.addEventListener("resize",ie),setTimeout(()=>{qa(),typeof window<"u"&&x(U,window.innerWidth<=768)},500),()=>{clearInterval(ke),"screen"in window&&"orientation"in window.screen?window.screen.orientation.removeEventListener("change",Gt):window.removeEventListener("orientationchange",Gt),n(At)&&n(At).removeEventListener("scroll",Ne),window.removeEventListener("resize",ie)}});function no(){n(Vt)&&nu.undo()}function Do(){n(wt)&&nu.redo()}function Eo(he){var ke;Wa(y,ys(i).period=he,ys(i));try{const Ne=(ke=i())!=null&&ke.key&&typeof i().key=="string"?i().key:"chart";typeof localStorage<"u"&&localStorage.setItem(`${Ne}.lastTimeframe`,(he==null?void 0:he.timeframe)||"")}catch{}n(oe)&&x(oe,!1)}function bs(){var Ne,ie,Ct,Kt;if((ie=(Ne=i().styles)==null?void 0:Ne.candle)!=null&&ie._isLineChart)return Q.find(fo=>fo.id==="line_chart")||Q[0];const he=((Kt=(Ct=i().styles)==null?void 0:Ct.candle)==null?void 0:Kt.type)||"renko_atr";return Q.find(fo=>fo.id===he)||Q[0]}const Is=Nd(y,he=>he.symbol.ticker),qi=Nd(y,he=>he.symbol.shortName),Ks=Nd(y,he=>{var ke,Ne;return((Ne=(ke=he.styles)==null?void 0:ke.candle)==null?void 0:Ne.type)==="renko_atr"});Is.subscribe(()=>{x(Z,D(i().symbol.shortName||i().symbol.ticker))}),qi.subscribe(()=>{x(Z,D(i().symbol.shortName||i().symbol.ticker))});function ws(){const he=i().styles||{},ke=Sd(i().theme);if(he.backgroundColor||he.backgroundGradient||he.backgroundType||he.backgroundOpacity!==void 0||he.gridGradient||he.gridType||he.gridOpacity!==void 0)return!0;const Ne=Wo=>{if(!Wo||typeof Wo!="string")return"";const us=Wo.trim().toLowerCase();if(us.startsWith("rgba(")){const Un=us.match(/rgba\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)/);if(Un){const or=Number(Un[1]).toString(16).padStart(2,"0"),$s=Number(Un[2]).toString(16).padStart(2,"0"),gi=Number(Un[3]).toString(16).padStart(2,"0");return`#${or}${$s}${gi}`}}return us},ie=Ne(uo.get(he,"pane.backgroundColor")),Ct=Ne(uo.get(he,"candle.pane.backgroundColor")),Kt=Ne(uo.get(ke,"pane.backgroundColor"));if(ie&&Kt&&ie!==Kt||Ct&&Kt&&Ct!==Kt)return!0;const fo=Ne(uo.get(he,"grid.horizontal.color")),mo=Ne(uo.get(he,"grid.vertical.color")),Go=Ne(uo.get(ke,"grid.horizontal.color")),Fo=Ne(uo.get(ke,"grid.vertical.color"));return!!(fo&&Go&&fo!==Go||mo&&Fo&&mo!==Fo)}function vn(he){try{if(window.self!==window.top){const ke={type:"theme-change",theme:he};let Ne=S;try{window.parent.location&&(Ne=window.parent.location.origin)}catch{Ne=S}window.parent.postMessage(ke,Ne),console.log("📤 Sent theme-change message to parent:",ke,"origin:",Ne)}}catch(ke){console.error("Failed to send theme-change message to parent:",ke)}}function es(he,ke){var Ct,Kt,fo,mo,Go;const Ne=document.querySelector(".kline-main");if(Ne&&Ne.setAttribute("data-theme",he),ke){try{const Fo=localStorage.getItem("chart");if(Fo){const Wo=JSON.parse(Fo);Wo.styles&&(delete Wo.styles.backgroundColor,delete Wo.styles.backgroundOpacity,delete Wo.styles.backgroundType,delete Wo.styles.backgroundGradient,Wo.styles.grid&&(delete Wo.styles.grid.horizontal,delete Wo.styles.grid.vertical),delete Wo.styles.gridColor,delete Wo.styles.gridOpacity,delete Wo.styles.gridType,delete Wo.styles.gridGradient,localStorage.setItem("chart",JSON.stringify(Wo)),console.log("🧹 Cleared custom background and grid colors from localStorage"))}}catch(Fo){console.error("Failed to clear custom colors from localStorage:",Fo)}if(s()){window.__forceApplyThemeDefaults=!0;const Fo=Sd(he),Wo=JSON.parse(JSON.stringify(i().styles||{})),us=Fo,Un={...Wo,pane:{...Wo.pane,backgroundColor:us.pane.backgroundColor},candle:{...Wo.candle,pane:{...(Ct=Wo.candle)==null?void 0:Ct.pane,backgroundColor:us.candle.pane.backgroundColor}},grid:{...Wo.grid,horizontal:{...(Kt=Wo.grid)==null?void 0:Kt.horizontal,color:us.grid.horizontal.color},vertical:{...(fo=Wo.grid)==null?void 0:fo.vertical,color:us.grid.vertical.color}}},or=(mo=Wo==null?void 0:Wo.candle)==null?void 0:mo.type,$s=uo.merge({},Fo,Un);delete $s.backgroundColor,delete $s.backgroundOpacity,delete $s.backgroundType,delete $s.backgroundGradient,delete $s.gridColor,delete $s.gridOpacity,delete $s.gridType,delete $s.gridGradient,or&&$s.candle&&($s.candle.type=or),s().setStyles(Dc($s)),Wa(y,ys(i).styles=$s,ys(i))}try{const Fo=new R1("chart-settings",g,he);Fo.resetToThemeDefaults(he),Fo.destroy(),console.log("🔄 Reset TransactionalThemeManager for theme toggle")}catch(Fo){console.error("Failed to reset TransactionalThemeManager:",Fo)}}Wa(y,ys(i).theme=he,ys(i));const ie=(Go=a())==null?void 0:Go.data;if(ie!=null&&ie.clerkId){const Fo=he==="dark"?"Dark":"Light";cT(ie.clerkId,Fo).catch(Wo=>{console.error("Failed to save theme to API:",Wo)})}vn(he)}function Li(){const he=uo.get(i().styles,"backgroundType")==="gradient",ke=uo.get(i().styles,"backgroundGradient"),Ne=he&&ke&&Array.isArray(ke.stops)&&ke.stops.length>0,ie=(Kt,fo)=>{const mo=(Kt||"#000000").replace("#",""),Go=parseInt(mo.substring(0,2),16)||0,Fo=parseInt(mo.substring(2,4),16)||0,Wo=parseInt(mo.substring(4,6),16)||0,us=Math.max(0,Math.min(1,fo??1));return`rgba(${Go}, ${Fo}, ${Wo}, ${us})`};if(Ne){requestAnimationFrame(()=>{var Kt,fo;try{const mo=(Kt=s())==null?void 0:Kt.getConvertPictureUrl(!0,"png","rgba(0, 0, 0, 0)");if(!mo)return;const Go=new Image;Go.onload=()=>{const Fo=Go.naturalWidth||Go.width,Wo=Go.naturalHeight||Go.height,us=document.createElement("canvas");us.width=Fo,us.height=Wo;const Un=us.getContext("2d");if(!Un)return;let or;if((ke.type==="radial"?"radial":"linear")==="radial")or=Un.createRadialGradient(Fo/2,Wo/2,0,Fo/2,Wo/2,Math.max(Fo,Wo)/2);else{const _r=((typeof ke.direction=="number"?ke.direction:90)-90)*Math.PI/180,Kr=Math.cos(_r),Ul=Math.sin(_r),wa=Fo/2-Fo/2*Kr,wl=Wo/2-Wo/2*Ul,Cl=Fo/2+Fo/2*Kr,dl=Wo/2+Wo/2*Ul;or=Un.createLinearGradient(wa,wl,Cl,dl)}[...ke.stops].sort((kn,_r)=>(kn.position??0)-(_r.position??0)).forEach(kn=>{const _r=Math.max(0,Math.min(1,(kn.position??0)/100)),Kr=ie(kn.color,(kn.opacity??100)/100);or.addColorStop(_r,Kr)}),Un.fillStyle=or,Un.fillRect(0,0,Fo,Wo),Un.drawImage(Go,0,0,Fo,Wo),x(Y,D(us.toDataURL("image/png"))),x(F,!0)},Go.src=mo}catch{let Go=i().theme==="dark"?"#151517":"#ffffff";x(Y,D(((fo=s())==null?void 0:fo.getConvertPictureUrl(!0,"jpeg",Go))??"")),x(F,!0)}});return}let Ct;try{const Kt=document.querySelector(".kline-widget"),fo=document.querySelector(".kline-main"),mo=Go=>{if(!Go)return"";const Fo=getComputedStyle(Go).getPropertyValue("--chart-background-color").trim();return Fo&&!Fo.includes("gradient")?Fo:""};if(Ct=mo(Kt)||mo(fo)||void 0,!Ct&&s()&&typeof s().getStyles=="function"){const Go=s().getStyles()??{};Ct=uo.get(Go,"pane.backgroundColor")||uo.get(Go,"candle.pane.backgroundColor")||void 0}if(!Ct){const Go=uo.get(i().styles,"backgroundColor");Ct=Go&&typeof Go=="string"?Go:void 0}}catch{}Ct||(Ct=i().theme==="dark"?"#151517":"#ffffff"),requestAnimationFrame(()=>{var Kt;x(Y,D(((Kt=s())==null?void 0:Kt.getConvertPictureUrl(!0,"jpeg",Ct))??"")),x(F,!0)})}function ci(){if(Xi()&&n(ce)){n(ce)();return}let he=document;const ke=he.exitFullscreen??he.mozCancelFullScreen??he.webkitExitFullscreen??he.msExitFullscreen;ke?ke.call(he):Xi()&&rd()}function oa(){we("🔄 toggleFullscreen called, current fullScreen: "+n(I)),we("🔍 iOS detection - isIOS(): "+ol()+", isIOSSafari(): "+Xi()),n(I)?(we("🚪 Exiting fullscreen..."),ci()):Xi()?(we("📱 Using iOS Safari fullscreen method"),fc()):(we("🖥️ Using standard fullscreen method"),ml())}function ol(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1}function Xi(){const he=navigator.userAgent,ke=/iPad|iPhone|iPod/.test(he)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,Ne=/Safari/.test(he)&&!/Chrome|CriOS|FxiOS/.test(he);return ke&&Ne}function fc(){return we("📱 enterFullscreenIOS called"),new Promise(he=>{var Ne;const ke=v();if(we("🎯 mainContainer element: "+(ke?"Found":"Not found")),ke&&ke.webkitRequestFullscreen){we("🔧 Trying webkitRequestFullscreen...");try{ke.webkitRequestFullscreen(),setTimeout(()=>{we("✅ webkitRequestFullscreen success, setting fullScreen = true"),x(I,!0),he(!0)},300);return}catch(ie){we("❌ webkitRequestFullscreen failed: "+ie)}}else we("❌ webkitRequestFullscreen not available");if(ke&&ke.webkitEnterFullscreen)try{ke.webkitEnterFullscreen(),setTimeout(()=>{x(I,!0),he(!0)},300);return}catch(ie){console.log("webkitEnterFullscreen failed:",ie)}we("🔧 Trying viewport manipulation fallback...");try{const ie=document.querySelector('meta[name="viewport"]'),Ct=(ie==null?void 0:ie.getAttribute("content"))||"";we("📋 Original viewport content: "+Ct);const Kt=ie||document.createElement("meta");Kt.setAttribute("name","viewport"),Kt.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"),ie?console.log("🔄 Updated existing viewport meta tag"):(document.head.appendChild(Kt),console.log("➕ Added new viewport meta tag")),window.scrollTo(0,1),console.log("📜 Scrolled to hide Safari UI");const fo=document.createElement("style");fo.id="ios-fullscreen-style",fo.textContent=`
          body.ios-fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100vh !important;
            overflow: hidden !important;
            -webkit-overflow-scrolling: touch !important;
          }
          
          .ios-fullscreen #main-container {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999 !important;
          }
          
          /* Hide Safari bottom bar */
          @supports (padding: max(0px)) {
            .ios-fullscreen {
              padding-bottom: env(safe-area-inset-bottom) !important;
            }
          }
        `,document.head.appendChild(fo),console.log("🎨 Added iOS fullscreen CSS styles");const mo=((Ne=v())==null?void 0:Ne.getAttribute("data-theme"))||i().theme;we("🎨 Preserving theme during iOS fullscreen: "+mo),document.body.classList.add("ios-fullscreen"),console.log("✅ Applied ios-fullscreen class to body"),v()&&(v().setAttribute("data-theme",mo),we("🔄 Restored theme attribute: "+mo)),setTimeout(()=>{window.scrollTo(0,0),x(I,!0),we("🎯 iOS fullscreen activated successfully!"),x(ce,()=>{var Wo;we("🧹 Cleaning up iOS fullscreen...");const Go=((Wo=v())==null?void 0:Wo.getAttribute("data-theme"))||i().theme;we("🎨 Preserving theme during cleanup: "+Go),document.body.classList.remove("ios-fullscreen");const Fo=document.getElementById("ios-fullscreen-style");Fo&&Fo.remove(),ie&&Ct&&ie.setAttribute("content",Ct),v()&&(v().setAttribute("data-theme",Go),we("🔄 Restored theme attribute after cleanup: "+Go)),x(I,!1),we("✅ iOS fullscreen cleanup completed")}),he(!0)},100)}catch(ie){console.log("iOS Safari viewport fallback failed:",ie),he(!1)}})}function rd(){var he;if(console.log("🚪 exitFullscreenIOS called"),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const ke=Sd(i().theme);uo.merge(ke,i().styles),s().setStyles(Dc(ke)),r().applyCanvasColors&&r().applyCanvasColors(),console.log("🎨 Pre-applied styles before iOS exit")}try{document.webkitExitFullscreen?(console.log("🔧 Trying webkitExitFullscreen..."),document.webkitExitFullscreen()):console.log("❌ webkitExitFullscreen not available"),n(ce)?(console.log("🧹 Using stored cleanup function..."),n(ce)(),x(ce,null)):console.log("❌ No stored cleanup function available"),console.log("🔧 Performing manual cleanup...");const ke=((he=v())==null?void 0:he.getAttribute("data-theme"))||i().theme;console.log("🎨 Preserving theme during manual cleanup: "+ke),document.body.classList.remove("ios-fullscreen");const Ne=document.getElementById("ios-fullscreen-style");Ne&&(Ne.remove(),console.log("🗑️ Removed iOS fullscreen styles"));const ie=document.querySelector('meta[name="viewport"]');ie&&(ie.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),console.log("📱 Restored viewport meta tag")),v()&&(v().setAttribute("data-theme",ke),console.log("🔄 Restored theme attribute after manual cleanup: "+ke)),x(I,!1),console.log("✅ Set fullScreen = false"),setTimeout(()=>{var Ct;if(console.log("📏 First chart resize..."),(Ct=s())==null||Ct.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Kt=Sd(i().theme);uo.merge(Kt,i().styles),s().setStyles(Dc(Kt)),r().applyCanvasColors&&r().applyCanvasColors()}},10),setTimeout(()=>{var Ct;if((Ct=s())==null||Ct.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Kt=Sd(i().theme);uo.merge(Kt,i().styles),s().setStyles(Dc(Kt)),r().applyCanvasColors&&r().applyCanvasColors()}},100),setTimeout(()=>{var Ct;if((Ct=s())==null||Ct.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Kt=Sd(i().theme);if(uo.merge(Kt,i().styles),s().setStyles(Dc(Kt)),r().applyCanvasColors){r().applyCanvasColors();const fo=s().getVisibleRange();fo&&s().scrollToDataIndex(fo.to,0)}console.log("✅ Final iOS chart colors applied after exit")}},300)}catch(ke){console.log("❌ iOS exit fullscreen failed:",ke)}}function ml(){return ol()?fc():new Promise(he=>{let ke=v();ke&&ke.requestFullscreen?ke.requestFullscreen().then(()=>he(!0)).catch(()=>he(!1)):ke&&ke.mozRequestFullScreen?(ke.mozRequestFullScreen(),setTimeout(()=>he(!0),100)):ke&&ke.webkitRequestFullscreen?(ke.webkitRequestFullscreen(),setTimeout(()=>he(!0),100)):ke&&ke.msRequestFullscreen?(ke.msRequestFullscreen(),setTimeout(()=>he(!0),100)):he(!1)})}function Jl(){Wl();const he=document.createElement("div");he.id="ios-rotation-hint",he.innerHTML=`
      <div style="
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        z-index: 10000;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        max-width: 280px;
        backdrop-filter: blur(10px);
      ">
        <div style="font-size: 24px; margin-bottom: 10px;">📱</div>
        <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Rotate Your Device</div>
        <div style="font-size: 14px; opacity: 0.8;">Turn your device to landscape mode for the best experience</div>
        <div style="margin-top: 15px; font-size: 12px; opacity: 0.6;">Tap anywhere to dismiss</div>
      </div>
    `,he.onclick=Wl,document.body.appendChild(he),setTimeout(Wl,4e3)}function Wl(){const he=document.getElementById("ios-rotation-hint");he&&he.remove()}async function sl(){if(typeof window<"u"&&window.saveManager){const he=window.saveManager,ke=he.getState();if(x(ct,!1),ke.activeSaveId){const Ne=await he.quickSave();Ne.success||console.error("Quick save failed:",Ne.error),Ne.success&&(x(ye,!1),x(Ze,"Saved to current layout"),x(tt,!0),setTimeout(()=>{x(tt,!1)},2e3),x(ct,!0),pt(),setTimeout(()=>{x(ct,!1)},1500))}else x(ye,!1),x(W,!0)}}function Uc(){x(ye,!1),x(le,!0)}function Nl(){x(ye,!1),x(W,!0)}async function Yc(he){const{layoutId:ke}=he.detail;if(typeof window<"u"&&window.saveManager){const Ne=window.saveManager;x(ot,!0);const ie=await Ne.load(ke);x(ot,!1),ie.success||console.error("Load failed:",ie.error)}}async function Ec(he){const{layoutId:ke}=he.detail;if(typeof window<"u"&&window.saveManager){const ie=await window.saveManager.delete(ke);if(!ie.success){console.error("Delete failed:",ie.error);return}x(st,D((n(st)||[]).filter(Ct=>Ct.id!==ke))),n(vt)===ke&&x(vt,null),x(Je,!1)}}async function Ja(he){const{name:ke}=he.detail;if(typeof window<"u"&&window.saveManager){const Ne=window.saveManager;x(ct,!1);const ie=await Ne.save(ke);ie.success?(x(W,!1),x(ct,!0),pt(),setTimeout(()=>{x(ct,!1)},1500)):console.error("Save failed:",ie.error)}}function sa(){x(W,!1)}async function jl(he){const{layoutId:ke}=he.detail;if(console.log("💾 SaveAsSelectSave triggered with layoutId:",ke),typeof window<"u"&&window.saveManager){const Ne=window.saveManager;console.log("✅ SaveManager found, calling saveTo..."),x(ct,!1);const ie=await Ne.saveTo(ke);ie.success?(console.log("✅ Save to existing successful"),x(le,!1),x(ct,!0),pt(),setTimeout(()=>{x(ct,!1)},1500)):console.error("❌ Save to existing failed:",ie.error)}else console.error("❌ SaveManager not available")}function Td(){x(le,!1),Fl()}function _d(){x(le,!1)}function Fl(){console.log("🎯 Save button clicked, showing popup..."),console.log("📊 Current savedLayouts:",n(st)),console.log("🎯 Current activeSaveId:",n(vt)),console.log("💾 SaveManager available:",!!window.saveManager);try{if(typeof window<"u"&&window.saveManager){const ke=window.saveManager.getState();if(!ke||!Array.isArray(ke.savedLayouts)||ke.savedLayouts.length===0){x(ye,!1),x(W,!0);return}}else if(!n(st)||n(st).length===0){x(ye,!1),x(W,!0);return}}catch{x(ye,!1),x(W,!0);return}if(v()){const he=v().querySelector(".chart-container");if(he){const ke=he.getBoundingClientRect();x(Ce,D({x:ke.left+ke.width/2,y:ke.top+ke.height/2}))}else{const ke=v().getBoundingClientRect();x(Ce,D({x:ke.left+ke.width/2,y:ke.top+ke.height/2}))}}x(ye,!0)}function qa(){if(!n(At))return;const{scrollWidth:he,clientWidth:ke,scrollLeft:Ne}=n(At),ie=he>ke,Ct=Ne+ke>=he-5;x(Yt,D(ie&&!Ct))}function td(he){if(he&&(he.preventDefault(),he.stopPropagation()),!n(At))return;const{scrollLeft:ke,clientWidth:Ne,scrollWidth:ie}=n(At),Ct=Ne*.7,Kt=Math.min(ke+Ct,ie-Ne);try{n(At).scrollTo({left:Kt,behavior:"smooth"})}catch{n(At).scrollLeft=Kt}}function Nc(he){he.preventDefault(),he.stopPropagation(),td()}var be=HB(),We=Rt(be);Yz(We,{get show(){return n(T)},set show(he){x(T,D(he))}});var de=p(We,2);Jz(de,{get show(){return n(z)},set show(he){x(z,D(he))}});var De=p(de,2);DF(De,{get show(){return n(j)},set show(he){x(j,D(he))}});var Ee=p(De,2);YE(Ee,{get show(){return r().modalIndCfg},set show(he){Wa(_,ys(r).modalIndCfg=he,ys(r))}});var xe=p(Ee,2);_j(xe,{get show(){return n(B)},set show(he){x(B,D(he))}});var gt=p(xe,2);Qx(gt,{get show(){return n($)},set show(he){x($,D(he))}});var at=p(gt,2);bj(at,{get show(){return n(F)},set show(he){x(F,D(he))},get url(){return n(Y)},set url(he){x(Y,D(he))}});var jt=p(at,2);Sj(jt,{get show(){return n(V)},set show(he){x(V,D(he))}});var Lt=p(jt,2);Aj(Lt,{get show(){return n(it)},set show(he){x(it,D(he))}});var Mt=p(Lt,2);Yj(Mt,{get show(){return n(K)},set show(he){x(K,D(he))}});var Io=p(Mt,2);rR(Io,{get show(){return n(W)},set show(he){x(W,D(he))},get savedLayouts(){return n(st)},get isLoading(){return n(Je)},mode:"save",showExisting:!1,$$events:{save:Ja,cancel:sa}});var Bo=p(Io,2);FR(Bo,{get show(){return n(le)},set show(he){x(le,D(he))},get savedLayouts(){return n(st)},get isLoading(){return n(Je)},$$events:{saveTo:jl,back:Td,cancel:_d}});var hs=p(Bo,2);hR(hs,{get show(){return n(ye)},set show(he){x(ye,D(he))},get savedLayouts(){return n(st)},get activeSaveId(){return n(vt)},get isLoading(){return n(Je)},get hasUnsavedChanges(){return nt},get position(){return n(Ce)},showLayouts:!1,$$events:{save:sl,saveAs:Uc,quickSave:sl,newLayout:Nl}});var is=p(hs,2);SR(is,{get show(){return n(Re)},set show(he){x(Re,D(he))},get savedLayouts(){return n(st)},get activeSaveId(){return n(vt)},get position(){return n(Ke)},get isLoading(){return n(Je)},$$events:{load:Yc,delete:Ec}});var Es=p(is,2);ew(Es,{get visible(){return n(tt)},set visible(he){x(tt,D(he))},get message(){return n(Ze)},duration:2e3});var bt=p(Es,2);Te(bt,()=>n(ct),he=>{var ke=sB();Se(()=>Nt(ke,"style",`left: ${n(Ge).x??""}px; top: ${n(Ge).y??""}px;`)),O(he,ke)});var kt=p(bt,2),xo=m(kt),$t=m(xo),_o=m($t),go=m(_o);go.__click=[eB,k,v,s,g];var fs=m(go),Ms=m(fs);f(fs),pn(2),f(go),f(_o);var zn=p(_o,2);Te(zn,d,he=>{var ke=iB(),Ne=m(ke);Ne.__change=[QR,Z,i,y,s,g,r,_],du(Ne,Ct=>x(ze,Ct),()=>n(ze));var ie=p(Ne,2);ie.__click=[nB,ze],f(ke),O(he,ke)});var qs=p(zn,2),Vn=m(qs);Vn.__click=[tB,te,ne,ol,fc,Jl,s,g,ml,Wl,I,ci];var Ss=m(Vn);Te(Ss,()=>n(te),he=>{var ke=rB();O(he,ke)});var di=p(Ss,2),Mn=m(di),La=m(Mn),nn=m(La);Te(nn,()=>n(ne),he=>{var ke=aB();pn(3),O(he,ke)},he=>{var ke=lB();pn(3),O(he,ke)}),f(La),f(Mn),f(di),pn(2),f(Vn),f(qs);var tr=p(qs,2);tr.__click=[cB,T];var Ur=m(tr),cl=m(Ur),ui=m(cl);aL(ui,{class:"search-icon"}),f(cl);var Yr=p(cl,2),Ra=m(Yr,!0);f(Yr),f(Ur),f(tr);var ga=p(tr,2),na=m(ga);Te(na,()=>!n(U),he=>{var ke=gB(),Ne=m(ke);Vs(Ne,17,()=>dt,_n,(Kt,fo)=>{var mo=uB();mo.__click=[dB,Eo,fo];var Go=m(mo),Fo=m(Go,!0);f(Go),pn(2),f(mo),Se(()=>{var Wo;Gn(mo,`timeframe-btn ${(n(fo).timeframe===((Wo=i().period)==null?void 0:Wo.timeframe)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),Ve(Fo,n(fo).timeframe)}),O(Kt,mo)});var ie=p(Ne,2);Te(ie,()=>!l(),Kt=>{var fo=vB();fo.__click=[pB,Eo,me],Se(()=>{var mo;return Gn(fo,`timeframe-btn ${(((mo=i().period)==null?void 0:mo.timeframe)==="4h"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(Kt,fo)});var Ct=p(ie,2);Vs(Ct,17,()=>qe,_n,(Kt,fo)=>{var mo=mB();mo.__click=[fB,Eo,fo];var Go=m(mo),Fo=m(Go,!0);f(Go),pn(2),f(mo),Se(()=>{var Wo;Gn(mo,`timeframe-btn ${(n(fo).timeframe===((Wo=i().period)==null?void 0:Wo.timeframe)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),Ve(Fo,n(fo).timeframe)}),O(Kt,mo)}),f(ke),O(he,ke)});var nl=p(na,2);Te(nl,()=>n(U),he=>{var ke=TB(),Ne=m(ke);Te(Ne,()=>qe.find(fo=>fo.timeframe==="1d"),fo=>{var mo=_B();mo.__click=[hB,Eo,qe],Se(()=>{var Go;return Gn(mo,`timeframe-btn ${(((Go=i().period)==null?void 0:Go.timeframe)==="1d"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(fo,mo)});var ie=p(Ne,2);Te(ie,()=>qe.find(fo=>fo.timeframe==="1w"),fo=>{var mo=bB();mo.__click=[yB,Eo,qe],Se(()=>{var Go;return Gn(mo,`timeframe-btn ${(((Go=i().period)==null?void 0:Go.timeframe)==="1w"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(fo,mo)});var Ct=p(ie,2);Ct.__click=[xB,oe];var Kt=p(Ct,2);Te(Kt,()=>n(oe),fo=>{var mo=MB(),Go=m(mo);Vs(Go,17,()=>dt,_n,(us,Un)=>{var or=kB();or.__click=[wB,Eo,Un];var $s=m(or),gi=m($s,!0);f($s),pn(2),f(or),Se(()=>{var kn;Gn(or,`timeframe-btn ${(n(Un).timeframe===((kn=i().period)==null?void 0:kn.timeframe)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),Ve(gi,n(Un).timeframe)}),O(us,or)});var Fo=p(Go,2);Te(Fo,()=>!l(),us=>{var Un=CB();Un.__click=[SB,Eo,me],Se(()=>{var or;return Gn(Un,`timeframe-btn ${(((or=i().period)==null?void 0:or.timeframe)==="4h"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(us,Un)});var Wo=p(Fo,2);Te(Wo,()=>qe.find(us=>us.timeframe==="1M"),us=>{var Un=IB();Un.__click=[PB,Eo,qe],Se(()=>{var or;return Gn(Un,`timeframe-btn ${(((or=i().period)==null?void 0:or.timeframe)==="1M"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(us,Un)}),f(mo),Af(1,mo,()=>eF,()=>({duration:180})),Af(2,mo,()=>wh,()=>({duration:120})),O(fo,mo)}),f(ke),Se(()=>{Gn(Ct,`timeframe-btn timeframe-more-btn ${(n(oe)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),Nt(Ct,"aria-expanded",n(oe))}),O(he,ke)}),f(ga);var mi=p(ga,2),Ha=m(mi);Ha.__click=[AB,K],f(mi);var lr=p(mi,2),zi=m(lr);zi.__click=[LB,it];var hr=m(zi);bv(hr,{get name(){return bs().icon},size:16});var xa=p(hr,2),Qa=m(xa,!0);Se(()=>Ve(Qa,bs().name)),f(xa),f(zi),f(lr);var ue=p(lr,2),Fe=m(ue);Fe.__click=[zB,j];var ut=m(Fe);bv(ut,{name:"indicator",size:16});var Xe=p(ut,2),ht=m(Xe,!0);Se(()=>Ve(ht,F1())),f(Xe),f(Fe),f(ue);var ao=p(ue,2),It=m(ao);It.__click=function(...he){var ke;(ke=n(Vt)?no:void 0)==null||ke.apply(this,he)};var eo=m(It);bv(eo,{class:"undo-redo-icon",name:"undo",size:16}),f(It);var Mo=p(It,2);Mo.__click=function(...he){var ke;(ke=n(wt)?Do:void 0)==null||ke.apply(this,he)};var ho=m(Mo);bv(ho,{class:"undo-redo-icon",name:"redo",size:16}),f(Mo),f(ao),f($t);var to=p($t,2),ds=m(to),js=Qe(()=>n(Je)&&!n(ot));Jj(ds,{get savedLayouts(){return n(st)},get activeSaveId(){return n(vt)},get isLoading(){return n(js)},get hasUnsavedChanges(){return nt},$$events:{save:sl,saveAs:Uc,quickSave:sl,load:Yc,delete:Ec,newLayout:Nl,showPopup:Fl}});var Si=p(ds,2);Si.__click=[oB,v,Ke,Re];var $r=m(Si);XA($r,{size:18}),f(Si);var pa=p(Si,2);Te(pa,()=>c().mode==="none",he=>{var ke=$B();ke.__click=[FB,C];var Ne=m(ke);bv(Ne,{name:"play",size:18}),f(ke),O(he,ke)},he=>{var ke=DB(),Ne=m(ke);bv(Ne,{name:"play",size:18}),f(ke),O(he,ke)});var En=p(pa,2);En.__click=[EB,V];var za=m(En);KA(za,{size:18}),f(En);var Rs=p(En,2);Rs.__click=[NB,$];var Zs=m(Rs);lL(Zs,{size:18}),f(Rs);var gn=p(Rs,2);gn.__click=function(...he){var ke;(ke=e.onToggleScriptStudio)==null||ke.apply(this,he)};var Wn=m(gn);ZA(Wn,{size:18}),f(gn);var Tn=p(gn,2);Tn.__click=Li;var Ko=m(Tn);YA(Ko,{size:18}),f(Tn);var Qt=p(Tn,2);Qt.__click=[jB,we,oa];var H=m(Qt);Te(H,()=>n(I),he=>{oL(he,{size:18})},he=>{tL(he,{size:18})}),f(Qt);var Me=p(Qt,2);Me.__click=[ZR,i,y,ws,se,J,es];var Ue=m(Me);Te(Ue,()=>i().theme==="dark",he=>{sL(he,{size:20})},he=>{cL(he,{size:20})}),f(Me),f(to),f(xo),du(xo,he=>x(At,he),()=>n(At));var yt=p(xo,2);Te(yt,()=>n(Yt),he=>{var ke=WB();ke.__click=[RB,td],ke.__touchstart=[BB,Nc],ke.__touchend=[OB],ke.__pointerdown=[VB,td],O(he,ke)}),f(kt);var St=p(kt,2);Te(St,()=>n(J),he=>{var ke=qB(),Ne=m(ke),ie=p(m(Ne),2),Ct=m(ie);pn(2),f(ie);var Kt=p(ie,2),fo=m(Kt);fo.__click=[JR,se,es,J];var mo=p(fo,2);mo.__click=[XR,se,es,J],f(Kt),f(Ne),f(ke),Se(()=>Ve(Ct,`${`You're changing the user interface to the ${n(se)==="light"?"Light":"Dark"} theme.`??""} `)),O(he,ke)});var lo=p(St,2);YR(lo,{get show(){return n(C)},$$events:{close:()=>x(C,!1)}}),Se(()=>{P0(Ms,`menu-toggle-icon ${(n(k)?"":"rotate")??""} svelte-pyr5xt`),Gn(Vn,`menu-btn ${(n(ne)?"menu-btn-active":"")??""} ${(n(te)?"rotate-loading":"")??""} svelte-pyr5xt`),Nt(Vn,"title",n(ne)?"Exit Fullscreen & Rotation":"Fullscreen & Rotate to Landscape"),Vn.disabled=n(te),ii(di,"rotate-content-hidden",n(te)),ii(La,"rotate-icon-spinning",n(te)),Ve(Ra,n(Z)),Gn(It,`undo-redo-btn ${(n(Vt)?"":"undo-redo-disabled")??""} svelte-pyr5xt`),Gn(Mo,`undo-redo-btn ${(n(wt)?"":"undo-redo-disabled")??""} svelte-pyr5xt`),Nt(Qt,"title",n(I)?"Exit Fullscreen":"Fullscreen")}),O(o,be),Tc()}Hd(["click","change","touchstart","touchend","pointerdown"]);var UB=re('<div class="modal-backdrop svelte-1oypfgf"><div class="modal-content svelte-1oypfgf"><div class="modal-actions svelte-1oypfgf"><button class="action-btn copy-btn svelte-1oypfgf"><svg width="12" height="12" viewBox="0 0 24 24" fill="none"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"></rect><path d="M5 15H4C2.9 15 2 14.1 2 13V4C2 2.9 2.9 2 4 2H13C14.1 2 15 2.9 15 4V5" stroke="currentColor" stroke-width="2"></path></svg> <span class="svelte-1oypfgf"> </span></button> <button class="action-btn reset-btn svelte-1oypfgf"><svg width="12" height="12" viewBox="0 0 24 24" fill="none"><path d="M3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12C21 16.97 16.97 21 12 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><path d="M3 12L7 8M3 12L7 16" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path></svg> <span class="svelte-1oypfgf">Reset View</span></button></div></div></div>');function YB(o,e){Mc(e,!1);let t=Qs(e,"isOpen",12,!1),s=Qs(e,"x",8,0),i=Qs(e,"y",8,0),r=Qs(e,"currentPrice",8,"");const a=sp();function l(){t(!1),a("close")}function c(){a("reset"),l()}function d(){a("copy",{price:r()}),l()}function v(k){k.target===k.currentTarget&&l()}function g(k){k.key==="Escape"&&l()}Sp();var _=So();id("keydown",f5,g);var y=Rt(_);Te(y,t,k=>{var S=UB(),M=m(S),I=m(M),C=m(I),T=p(m(C),2),z=m(T);f(T),f(C);var j=p(C,2);f(I),f(M),f(S),Se(()=>{Nt(M,"style",`left: ${s()??""}px; top: ${i()??""}px;`),Ve(z,`Copy Price ${(r()?`(${r()})`:"")??""}`)}),id("click",C,d),id("click",j,c),id("click",S,v),O(k,S)}),O(o,_),Tc()}class KB{constructor(e){ve(this,"chart");ve(this,"overlays",new Map);ve(this,"projectionQueue",new Set);ve(this,"isProjecting",!1);ve(this,"eventListeners",new Map);ve(this,"resizeObserver");ve(this,"periodicProjectionId");ve(this,"lastViewportState");ve(this,"animationFrameId",null);this.chart=e,this.initializeEventListeners()}initializeEventListeners(){if(typeof ResizeObserver<"u"){const e=this.chart.getDom();if(e){const t=new ResizeObserver(()=>{this.scheduleProjection("resize")});t.observe(e),this.resizeObserver=t}}this.setupPeriodicProjection()}setupPeriodicProjection(){this.periodicProjectionId=window.setInterval(()=>{const e=this.getViewportState();e!==this.lastViewportState&&(this.lastViewportState=e,this.scheduleProjection("scroll"))},100)}getViewportState(){try{const e=this.chart.getVisibleRange(),t=this.chart.getSize();return JSON.stringify({visibleRange:e,chartSize:t})}catch{return""}}scheduleProjection(e){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.animationFrameId=requestAnimationFrame(()=>{this.projectAllOverlays(e),this.animationFrameId=null})}addOverlay(e){this.overlays.set(e.id,e),e.points.length>0&&Ky(e.points,this.chart),this.projectOverlay(e)}removeOverlay(e){this.overlays.delete(e);try{this.chart.removeOverlay({id:e})}catch(t){console.warn("Could not remove overlay from chart:",t)}}updateOverlay(e){this.overlays.has(e.id)&&(this.overlays.set(e.id,e),e.points.length>0&&Ky(e.points,this.chart),this.projectOverlay(e))}getOverlay(e){return this.overlays.get(e)}getAllOverlays(){return Array.from(this.overlays.values())}projectOverlay(e){const t={chart:this.chart,paneId:"candle_pane"},s=Kx(e.points,t);return s.isValid&&e.visible!==!1&&this.updateChartOverlay(e,s.screenPoints),s}projectAllOverlays(e){if(!this.isProjecting){this.isProjecting=!0;try{const t={type:e,chart:this.chart,timestamp:Date.now()};this.emitEvent(e,t);for(const s of this.overlays.values())s.visible!==!1&&this.projectOverlay(s)}finally{this.isProjecting=!1}}}updateChartOverlay(e,t){try{const s=t.map(l=>({x:l.x,y:l.y})),i={id:e.id,name:e.type,points:s.map((l,c)=>{var d,v;return{...l,timestamp:(d=e.points[c])==null?void 0:d.t,value:(v=e.points[c])==null?void 0:v.p}}),styles:this.convertOverlayStyles(e.style),visible:e.visible,lock:e.lock},r=this.chart.getOverlays({id:e.id});(r.length>0?r[0]:null)?this.chart.overrideOverlay(i):this.chart.createOverlay(i)}catch(s){console.error("Error updating chart overlay:",s)}}convertOverlayStyles(e){const t={};return e.line&&(t.line={color:e.line.color,size:e.line.size,style:e.line.style==="dashed"?"dashed":"solid"},e.line.dashedValue&&(t.line.dashedValue=e.line.dashedValue)),e.text&&(t.text={color:e.text.color,backgroundColor:e.text.backgroundColor,borderColor:e.text.borderColor,fontSize:e.text.fontSize}),e.polygon&&(t.polygon={color:e.polygon.color,fillColor:e.polygon.fillColor}),t}onTimeframeChange(){this.scheduleProjection("timeframeChange")}onTimezoneChange(){this.scheduleProjection("timezoneChange")}onPriceScaleChange(){this.scheduleProjection("priceScaleChange")}addEventListener(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}removeEventListener(e,t){const s=this.eventListeners.get(e);s&&s.delete(t)}emitEvent(e,t){const s=this.eventListeners.get(e);s&&s.forEach(i=>{try{i(t)}catch(r){console.error("Error in overlay event listener:",r)}})}forceProjection(){this.projectAllOverlays("resize")}clearAllOverlays(){for(const e of this.overlays.keys())this.removeOverlay(e);this.overlays.clear()}dispose(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0),this.periodicProjectionId&&(clearInterval(this.periodicProjectionId),this.periodicProjectionId=void 0),this.clearAllOverlays(),this.eventListeners.clear()}}const ZB={timeframeChange:{debounceMs:100,enabled:!0},zoom:{throttleMs:16,enabled:!0},scroll:{throttleMs:16,enabled:!0},resize:{debounceMs:250,enabled:!0},dataUpdate:{debounceMs:50,enabled:!0},priceScaleChange:{debounceMs:100,enabled:!0}};class XB{constructor(e,t={}){ve(this,"chart");ve(this,"projectionManager",null);ve(this,"creationManager",null);ve(this,"eventListeners",new Map);ve(this,"resizeObserver",null);ve(this,"config");ve(this,"debounceTimers",new Map);ve(this,"throttleTimers",new Map);this.chart=e,this.config={...ZB,...t}}setProjectionManager(e){this.projectionManager=e}setCreationManager(e){this.creationManager=e}initialize(){this.setupChartEventListeners(),this.setupResizeObserver(),this.setupCustomEventListeners()}setupChartEventListeners(){this.setupViewportChangeDetection()}setupViewportChangeDetection(){let e=null;const s=setInterval(()=>{try{const i=this.chart.getVisibleRange();i&&this.hasRangeChanged(e,i)&&(e=i,this.handleEvent("scroll"))}catch(i){console.error("Error checking viewport changes:",i)}},16);this.eventListeners.set("viewportPolling",()=>clearInterval(s))}setupResizeObserver(){const e=this.chart.getDom();e&&(this.resizeObserver=new ResizeObserver(()=>{this.handleEvent("resize")}),this.resizeObserver.observe(e))}setupCustomEventListeners(){const e=this.chart.getDom();if(!e)return;const t=()=>this.handleEvent("timeframeChange"),s=()=>this.handleEvent("dataUpdate");e.addEventListener("timeframeChange",t),e.addEventListener("dataUpdate",s),this.eventListeners.set("timeframeChange",()=>{e.removeEventListener("timeframeChange",t)}),this.eventListeners.set("dataUpdate",()=>{e.removeEventListener("dataUpdate",s)})}handleEvent(e){const t=this.config[e];t.enabled&&(t.debounceMs?this.debounceEvent(e,t.debounceMs):t.throttleMs?this.throttleEvent(e,t.throttleMs):this.executeEvent(e))}debounceEvent(e,t){const s=this.debounceTimers.get(e);s&&clearTimeout(s);const i=setTimeout(()=>{this.executeEvent(e),this.debounceTimers.delete(e)},t);this.debounceTimers.set(e,i)}throttleEvent(e,t){const s=this.throttleTimers.get(e)||0,i=Date.now();i-s>=t&&(this.executeEvent(e),this.throttleTimers.set(e,i))}executeEvent(e){try{this.projectionManager&&this.projectionManager.forceProjection();const t=this.chart.getDom();t&&t.dispatchEvent(new CustomEvent("overlayEvent",{detail:{type:e,timestamp:Date.now()}}))}catch(t){console.error(`Error handling ${e} event:`,t)}}hasRangeChanged(e,t){return e?e.from!==t.from||e.to!==t.to:!0}hasPriceRangeChanged(e,t){return e?Math.abs(e.min-t.min)>1e-8||Math.abs(e.max-t.max)>1e-8:!0}triggerEvent(e){this.handleEvent(e)}updateConfig(e,t){this.config[e]={...this.config[e],...t}}setEventEnabled(e,t){this.config[e].enabled=t}destroy(){this.debounceTimers.forEach(e=>clearTimeout(e)),this.debounceTimers.clear(),this.throttleTimers.clear(),this.eventListeners.forEach(e=>e()),this.eventListeners.clear(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}}function i2(o){return typeof o=="object"&&o!==null&&typeof o.x=="number"&&typeof o.y=="number"}function r2(o){return typeof o=="object"&&o!==null&&typeof o.timestamp=="number"&&typeof o.value=="number"}function G_(o){return typeof o=="object"&&o!==null}class JB{constructor(e){ve(this,"chart");ve(this,"currentSymbolKey",null);this.chart=e}toDrawing(e,t){try{if(!this.currentSymbolKey)return null;const s=Array.isArray(t==null?void 0:t.points)?t.points.map(d=>{if(d&&typeof d=="object"){if(typeof d.timestamp=="number"&&typeof d.value=="number")return{time:d.timestamp,price:d.value};if(typeof d.t=="number"&&typeof d.p=="number")return{time:d.t,price:d.p}}return null}).filter(Boolean):[];if(s.length===0)return null;const i=(t==null?void 0:t.name)||(t==null?void 0:t.type)||"unknown",r=(t==null?void 0:t.styles)||(t==null?void 0:t.style)||{},a=!!(t!=null&&t.lock),l=(t==null?void 0:t.visible)!==!1;return{id:e,symbolKey:this.currentSymbolKey,type:i,points:s,styles:r,...t!=null&&t.extendData?{extendData:t.extendData}:{},locked:a,visible:l}}catch{return null}}setCurrentSymbolKey(e){this.currentSymbolKey=e,console.log("📍 OverlayCreationManager symbol set:",e)}getCurrentSymbolKey(){return this.currentSymbolKey}createPointFromMouse(e,t){try{const s={x:e,y:t},i={chart:this.chart},r=tF(s,i);return r?{timestamp:r.t,value:r.p}:null}catch(s){return console.error("Failed to create point from mouse coordinates:",s),null}}createDataSpaceOverlay(e){if(!G_(e)||!e.points||!Array.isArray(e.points))return e;const t=e.points.map(s=>{if(i2(s)){const i=this.createPointFromMouse(s.x,s.y);return i?{timestamp:i.timestamp,value:i.value}:s}else if(r2(s))return s;return s});return{...e,points:t,_isDataSpace:!0}}convertLegacyOverlay(e){if(!G_(e)||e._isDataSpace||!e.points)return e;const t=e.points.map(s=>{if(i2(s)){const i=this.createPointFromMouse(s.x,s.y);return i?{timestamp:i.timestamp,value:i.value}:s}return s});return{...e,points:t,_isDataSpace:!0}}projectOverlayToScreen(e){if(!G_(e)||!e._isDataSpace||!e.points)return e;const t=e.points.map(s=>{if(r2(s)){const i={id:s.id||"temp",t:s.timestamp,p:s.value},r={chart:this.chart},a=Sh(i,r);return a?{x:a.x,y:a.y}:s}return s});return{...e,points:t}}addOverlay(e){try{const t=this.createDataSpaceOverlay(e),s=this.projectOverlayToScreen(t),i=this.chart.createOverlay(s);if(i){const r=Array.isArray(i)?i[0]:i;if(typeof r=="string"){const a=Rv();if(a){const l=this.toDrawing(r,t);if(l){a.addDrawing(l);try{xv()}catch{}}}}return r}return null}catch(t){return console.error("Failed to add overlay:",t),null}}storeDataSpaceOverlay(e,t){}getStoredDataSpaceOverlay(e){try{const t=localStorage.getItem("dataSpaceOverlays");return t&&JSON.parse(t)[e]||null}catch(t){return console.error("Failed to retrieve data-space overlay:",t),null}}removeStoredDataSpaceOverlay(e){try{const t=Rv();if(t){t.removeDrawing(e);try{xv()}catch{}}}catch(t){console.error("Failed to remove overlay from DrawingManager:",t)}}}function QB(o){return o.createDataSpaceTemplate("enhancedRect",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{var c,d,v,g,_,y;if(s.length<2)return[];const[i,r]=s,a=[],l=30;return a.push({type:"rect",attrs:{x:Math.min(i.x,r.x)-l,y:Math.min(i.y,r.y)-l,width:Math.abs(r.x-i.x)+l*2,height:Math.abs(r.y-i.y)+l*2},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),a.push({type:"rect",attrs:{x:Math.min(i.x,r.x),y:Math.min(i.y,r.y),width:Math.abs(r.x-i.x),height:Math.abs(r.y-i.y)},styles:{style:"stroke",color:((d=(c=e.style)==null?void 0:c.line)==null?void 0:d.color)||"#1677FF",borderSize:((g=(v=e.style)==null?void 0:v.line)==null?void 0:g.size)||1,borderStyle:((y=(_=e.style)==null?void 0:_.line)==null?void 0:y.style)||"solid"}}),a},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function eO(o){return o.createDataSpaceTemplate("enhancedCircle",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{var d,v,g,_,y,k;if(s.length<2)return[];const[i,r]=s,a=Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)),l=[];return l.push({type:"circle",attrs:{x:i.x,y:i.y,r:a+30},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),l.push({type:"circle",attrs:{x:i.x,y:i.y,r:a},styles:{style:"stroke",color:((v=(d=e.style)==null?void 0:d.line)==null?void 0:v.color)||"#1677FF",borderSize:((_=(g=e.style)==null?void 0:g.line)==null?void 0:_.size)||1,borderStyle:((k=(y=e.style)==null?void 0:y.line)==null?void 0:k.style)||"solid"}}),l},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function tO(o){return o.createDataSpaceTemplate("enhancedLine",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{var r,a,l,c,d,v;if(s.length<2)return[];const i=[];for(let g=0;g<s.length-1;g++){const _=s[g],y=s[g+1];i.push({type:"line",attrs:{coordinates:[{x:_.x,y:_.y},{x:y.x,y:y.y}]},styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),i.push({type:"line",attrs:{coordinates:[{x:_.x,y:_.y},{x:y.x,y:y.y}]},styles:{color:((a=(r=e.style)==null?void 0:r.line)==null?void 0:a.color)||"#1677FF",size:((c=(l=e.style)==null?void 0:l.line)==null?void 0:c.size)||.5,style:((v=(d=e.style)==null?void 0:d.line)==null?void 0:v.style)||"solid"}})}return i},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function oO(o){return o.createDataSpaceTemplate("enhancedTrendLine",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s,chart:i})=>{var _,y,k,S,M,I;if(s.length<2)return[];const[r,a]=s,l=[];let c=r,d=a;const v=e.extendLeft,g=e.extendRight;if(v||g){const C=i.getSize();if(C){const T=(a.y-r.y)/(a.x-r.x);if(v&&(c={x:0,y:r.y+T*(0-r.x)}),g){const z=r.y+T*(C.width-r.x);d={x:C.width,y:z}}}}return l.push({type:"line",attrs:{coordinates:[{x:c.x,y:c.y},{x:d.x,y:d.y}]},styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),l.push({type:"line",attrs:{coordinates:[{x:c.x,y:c.y},{x:d.x,y:d.y}]},styles:{color:((y=(_=e.style)==null?void 0:_.line)==null?void 0:y.color)||"#1677FF",size:((S=(k=e.style)==null?void 0:k.line)==null?void 0:S.size)||.5,style:((I=(M=e.style)==null?void 0:M.line)==null?void 0:I.style)||"solid"}}),l},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function sO(o){return o.createDataSpaceTemplate("enhancedFibonacci",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{if(s.length<2)return[];const[i,r]=s,a=[],l=[0,.236,.382,.5,.618,.786,1,1.618,2.618],c=r.y-i.y;return l.forEach(d=>{var g,_,y,k,S,M,I,C;const v=i.y+c*d;a.push({type:"line",attrs:{coordinates:[{x:Math.min(i.x,r.x),y:v},{x:Math.max(i.x,r.x),y:v}]},styles:{color:"transparent",size:30,style:"solid"},ignoreEvent:!1}),a.push({type:"line",attrs:{coordinates:[{x:Math.min(i.x,r.x),y:v},{x:Math.max(i.x,r.x),y:v}]},styles:{color:((_=(g=e.style)==null?void 0:g.line)==null?void 0:_.color)||"#1677FF",style:"dashed",size:((k=(y=e.style)==null?void 0:y.line)==null?void 0:k.size)||2}}),a.push({type:"text",attrs:{x:Math.max(i.x,r.x)+5,y:v,text:`${(d*100).toFixed(1)}%`},styles:{color:((M=(S=e.style)==null?void 0:S.text)==null?void 0:M.color)||"#666666",size:((C=(I=e.style)==null?void 0:I.text)==null?void 0:C.fontSize)||12}})}),a},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function nO(o){return{enhancedRect:QB(o),enhancedCircle:eO(o),enhancedLine:tO(o),enhancedTrendLine:oO(o),enhancedFibonacci:sO(o)}}const th=o=>o>="0"&&o<="9",a2=o=>o>="a"&&o<="z"||o>="A"&&o<="Z"||o==="_"||o==="$";class iO{constructor(e){ve(this,"pos",0);this.input=e}next(){const e=this.input,t=e.length;for(;this.pos<t&&/\s/.test(e[this.pos]??"");)this.pos++;if(this.pos>=t)return{type:"eof",start:this.pos,end:this.pos};const s=e[this.pos],i=this.pos;if(th(s)||s==="."&&th(e[this.pos+1]??"")){let r=s===".";for(this.pos++;this.pos<t;){const a=e[this.pos];if(th(a))this.pos++;else if(a==="."&&!r)r=!0,this.pos++;else break}return{type:"number",value:e.slice(i,this.pos),start:i,end:this.pos}}if(a2(s)){for(this.pos++;this.pos<t;){const l=e[this.pos];if(a2(l)||th(l))this.pos++;else break}const r=e.slice(i,this.pos),a=r.toLowerCase();return a==="and"?{type:"and",start:i,end:this.pos}:a==="or"?{type:"or",start:i,end:this.pos}:a==="not"?{type:"not",start:i,end:this.pos}:{type:"identifier",value:r,start:i,end:this.pos}}switch(this.pos++,s){case">":return e[this.pos]==="="?(this.pos++,{type:"gte",start:i,end:this.pos}):{type:"gt",start:i,end:this.pos};case"<":return e[this.pos]==="="?(this.pos++,{type:"lte",start:i,end:this.pos}):{type:"lt",start:i,end:this.pos};case"=":if(e[this.pos]==="=")return this.pos++,{type:"eq",start:i,end:this.pos};throw new Error(`Unexpected '=' at position ${i}`);case"!":if(e[this.pos]==="=")return this.pos++,{type:"neq",start:i,end:this.pos};throw new Error(`Unexpected '!' at position ${i}`);case"+":return{type:"plus",start:i,end:this.pos};case"-":return{type:"minus",start:i,end:this.pos};case"*":return{type:"star",start:i,end:this.pos};case"/":return{type:"slash",start:i,end:this.pos};case"%":return{type:"percent",start:i,end:this.pos};case"(":return{type:"lparen",start:i,end:this.pos};case")":return{type:"rparen",start:i,end:this.pos};case",":return{type:"comma",start:i,end:this.pos};case"?":return{type:"qmark",start:i,end:this.pos};case":":return{type:"colon",start:i,end:this.pos};default:throw new Error(`Unexpected character "${s}" at position ${i}`)}}}class um extends Error{constructor(e,t){super(e),this.position=t,this.name="ParseError"}}class rO{constructor(e){ve(this,"current");this.tokenizer=e,this.current=e.next()}eat(e){if(this.current.type!==e)throw new um(`Expected ${e} but found ${this.current.type}`,this.current.start);const t=this.current;return this.current=this.tokenizer.next(),t}match(e){return this.current.type===e?(this.current=this.tokenizer.next(),!0):!1}parseExpression(){return this.parseTernary()}parseTernary(){const e=this.parseOr();if(this.current.type==="qmark"){this.current=this.tokenizer.next();const t=this.parseExpression();this.eat("colon");const s=this.parseExpression();return{kind:"CallExpression",callee:"iff",args:[e,t,s]}}return e}parseOr(){let e=this.parseAnd();for(;this.current.type==="or";){this.current=this.tokenizer.next();const t=this.parseAnd();e={kind:"BinaryExpression",operator:"or",left:e,right:t}}return e}parseAnd(){let e=this.parseComparison();for(;this.current.type==="and";){this.current=this.tokenizer.next();const t=this.parseComparison();e={kind:"BinaryExpression",operator:"and",left:e,right:t}}return e}parseComparison(){let e=this.parseAddSub();for(;this.current.type==="gt"||this.current.type==="lt"||this.current.type==="gte"||this.current.type==="lte"||this.current.type==="eq"||this.current.type==="neq";){const t=this.current;this.current=this.tokenizer.next();const s=this.parseAddSub();let i="==";t.type==="gt"?i=">":t.type==="lt"?i="<":t.type==="gte"?i=">=":t.type==="lte"?i="<=":t.type==="neq"&&(i="!="),e={kind:"BinaryExpression",operator:i,left:e,right:s}}return e}parseAddSub(){let e=this.parseTerm();for(;this.current.type==="plus"||this.current.type==="minus";){const t=this.current;this.current=this.tokenizer.next();const s=this.parseTerm();e={kind:"BinaryExpression",operator:t.type==="plus"?"+":"-",left:e,right:s}}return e}parseTerm(){let e=this.parseFactor();for(;this.current.type==="star"||this.current.type==="slash"||this.current.type==="percent";){const t=this.current;this.current=this.tokenizer.next();const s=this.parseFactor();e={kind:"BinaryExpression",operator:t.type==="star"?"*":t.type==="slash"?"/":"%",left:e,right:s}}return e}parseFactor(){if(this.current.type==="not")return this.current=this.tokenizer.next(),{kind:"UnaryExpression",operator:"not",expr:this.parseFactor()};if(this.current.type==="plus"||this.current.type==="minus"){const e=this.current.type==="minus";this.current=this.tokenizer.next();const t=this.parseFactor();return e?{kind:"BinaryExpression",operator:"*",left:{kind:"NumberLiteral",value:-1},right:t}:t}return this.parsePrimary()}parsePrimary(){const e=this.current;switch(e.type){case"number":{this.current=this.tokenizer.next();const t=Number(e.value);if(!Number.isFinite(t))throw new um("Invalid number literal",e.start);return{kind:"NumberLiteral",value:t}}case"identifier":{this.current=this.tokenizer.next();const t=(e.value||"").toString();if(this.current.type==="lparen"){this.eat("lparen");const s=[];if(this.current.type!=="rparen")for(;s.push(this.parseExpression()),!!this.match("comma"););return this.eat("rparen"),{kind:"CallExpression",callee:t,args:s}}return{kind:"Identifier",name:t}}case"lparen":{this.eat("lparen");const t=this.parseExpression();return this.eat("rparen"),t}default:throw new um(`Unexpected token ${e.type}`,e.start)}}}function R0(o){const e=new rO(new iO(o)),t=e.parseExpression();if(e.current.type!=="eof")throw new um("Unexpected input after end of expression",e.current.start);return t}class Fr extends Error{constructor(e){super(e),this.name="ExpressionEngineError"}}function aO(o,e){const t=o.length,s=new Float32Array(t);let i=0;for(let r=0;r<t;r++){const a=o[r];if(Number.isFinite(a)&&(i+=a),r>=e){const l=o[r-e];Number.isFinite(l)&&(i-=l)}s[r]=r>=e-1?i:NaN}return s}function lO(o,e){const t=o.length,s=new Float32Array(t),i=Math.max(1,Math.floor(e));for(let r=0;r<t;r++){const a=r-i,l=o[r],c=a>=0?o[a]:NaN;s[r]=Number.isFinite(l)&&Number.isFinite(c)?l-c:NaN}return s}function ed(o,e){if(o.kind==="series")return o.value;const t=new Float32Array(e.length);return t.fill(o.value),t}function Cm(o){if(o.kind==="scalar")return o.value;const e=o.value;return e.length?e[e.length-1]:NaN}function cO(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++)s[i]=e(o[i]);return s}function dO(o,e,t){const s=o.length,i=new Float32Array(s);for(let r=0;r<s;r++)i[r]=t(o[r],e[r]);return i}function uO(o,e,t,s){const i=e.kind==="series",r=t.kind==="series",a=g=>Number.isFinite(g)&&g!==0;if(!i&&!r){const g=e.value,_=t.value;switch(o){case"+":return{kind:"scalar",value:g+_};case"-":return{kind:"scalar",value:g-_};case"*":return{kind:"scalar",value:g*_};case"/":return{kind:"scalar",value:_===0?NaN:g/_};case"%":return{kind:"scalar",value:_===0?NaN:g%_};case">":return{kind:"scalar",value:Number.isFinite(g)&&Number.isFinite(_)&&g>_?1:0};case"<":return{kind:"scalar",value:Number.isFinite(g)&&Number.isFinite(_)&&g<_?1:0};case">=":return{kind:"scalar",value:Number.isFinite(g)&&Number.isFinite(_)&&g>=_?1:0};case"<=":return{kind:"scalar",value:Number.isFinite(g)&&Number.isFinite(_)&&g<=_?1:0};case"==":return{kind:"scalar",value:Number.isFinite(g)&&Number.isFinite(_)&&Math.abs(g-_)<1e-9?1:0};case"!=":return{kind:"scalar",value:Number.isFinite(g)&&Number.isFinite(_)&&Math.abs(g-_)>=1e-9?1:0};case"and":return{kind:"scalar",value:a(g)&&a(_)?1:0};case"or":return{kind:"scalar",value:a(g)||a(_)?1:0}}}const l=ed(e,s),c=ed(t,s),d=s.length,v=new Float32Array(d);for(let g=0;g<d;g++){const _=l[g],y=c[g];switch(o){case"+":v[g]=_+y;break;case"-":v[g]=_-y;break;case"*":v[g]=_*y;break;case"/":v[g]=y===0?NaN:_/y;break;case"%":v[g]=y===0?NaN:_%y;break;case">":v[g]=Number.isFinite(_)&&Number.isFinite(y)&&_>y?1:0;break;case"<":v[g]=Number.isFinite(_)&&Number.isFinite(y)&&_<y?1:0;break;case">=":v[g]=Number.isFinite(_)&&Number.isFinite(y)&&_>=y?1:0;break;case"<=":v[g]=Number.isFinite(_)&&Number.isFinite(y)&&_<=y?1:0;break;case"==":v[g]=Number.isFinite(_)&&Number.isFinite(y)&&Math.abs(_-y)<1e-9?1:0;break;case"!=":v[g]=Number.isFinite(_)&&Number.isFinite(y)&&Math.abs(_-y)>=1e-9?1:0;break;case"and":v[g]=a(_)&&a(y)?1:0;break;case"or":v[g]=a(_)||a(y)?1:0;break}}return{kind:"series",value:v}}function pO(o,e){const t=o.length,s=new Float32Array(t);let i=0,r=0;for(let a=0;a<t;a++){const l=o[a];if(Number.isFinite(l)&&(i+=l,r+=1),a>=e){const c=o[a-e];Number.isFinite(c)&&(i-=c,r-=1)}a>=e-1?s[a]=r>0?i/r:NaN:s[a]=NaN}return s}function vO(o,e){const t=o.length,s=new Float32Array(t),i=2/(e+1);let r;for(let a=0;a<t;a++){const l=o[a];if(!Number.isFinite(l)){s[a]=r===void 0?NaN:r;continue}if(r===void 0||!Number.isFinite(r)){r=l,s[a]=l;continue}r=l*i+r*(1-i),s[a]=r}return s}function l2(o,e){const t=o.length,s=new Float32Array(t);let i,r=0,a=0;for(let l=0;l<t;l++){const c=o[l];if(i===void 0){if(Number.isFinite(c)&&(r+=c,a+=1),a<e){s[l]=NaN;continue}i=r/e,s[l]=i;continue}Number.isFinite(c)&&(i=(i*(e-1)+c)/e),s[l]=i}return s}function fO(o,e){const t=o.length,s=new Float32Array(t);let i,r=0,a=0,l=!1;const c=[],d=[];for(let v=0;v<t;v++){const g=o[v];if(!Number.isFinite(g)){s[v]=NaN;continue}if(i===void 0){i=g,s[v]=NaN;continue}if(!Number.isFinite(i)){i=g,s[v]=NaN;continue}const _=g-i;i=g;const y=_>0?_:0,k=_<0?-_:0;if(l)r=(r*(e-1)+y)/e,a=(a*(e-1)+k)/e;else{c.push(y),d.push(k);const S=c.length,M=Math.max(1,Math.min(e,S));r=c.reduce((I,C)=>I+C,0)/M,a=d.reduce((I,C)=>I+C,0)/M,S>=e&&(l=!0)}if(a===0)s[v]=100;else{const S=r/a;s[v]=100-100/(1+S)}}return s}function mO(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){if(i<e-1){s[i]=NaN;continue}let r=0,a=0;for(let d=i-e+1;d<=i;d++){const v=o[d];Number.isFinite(v)&&(r+=v,a+=1)}if(a<2){s[i]=NaN;continue}const l=r/a;let c=0;for(let d=i-e+1;d<=i;d++){const v=o[d];if(!Number.isFinite(v))continue;const g=v-l;c+=g*g}s[i]=Math.sqrt(c/a)}return s}function gO(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){if(i<e-1){s[i]=NaN;continue}let r=0,a=0;for(let l=0;l<e;l++){const c=o[i-l],d=e-l;Number.isFinite(c)&&(r+=c*d,a+=d)}s[i]=a>0?r/a:NaN}return s}function hO(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){let r=-1/0,a=!1;const l=Math.max(0,i-e+1);for(let c=l;c<=i;c++){const d=o[c];Number.isFinite(d)&&(a=!0,d>r&&(r=d))}s[i]=a?r:NaN}return s}function _O(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){let r=1/0,a=!1;const l=Math.max(0,i-e+1);for(let c=l;c<=i;c++){const d=o[c];Number.isFinite(d)&&(a=!0,d<r&&(r=d))}s[i]=a?r:NaN}return s}function yO(o,e){const t=o.callee.toLowerCase(),s=o.args.map(r=>F0(r,e)),i=()=>{if(s.length!==2)throw new Fr(`${t} expects (series, period)`);const r=ed(s[0],e),a=Math.max(1,Math.floor(Cm(s[1])));return[r,a]};switch(t){case"iff":case"iif":case"if":{if(s.length!==3)throw new Fr(`${o.callee} expects (cond, a, b)`);const r=s[0],a=s[1],l=s[2],c=r.kind==="series",d=a.kind==="series",v=l.kind==="series";if(!c&&!d&&!v){const M=r.value;return{kind:"scalar",value:Number.isFinite(M)&&M!==0?a.value:l.value}}const g=ed(r,e),_=ed(a,e),y=ed(l,e),k=e.length,S=new Float32Array(k);for(let M=0;M<k;M++){const I=g[M],C=Number.isFinite(I)&&I!==0;S[M]=C?_[M]:y[M]}return{kind:"series",value:S}}case"nz":{if(s.length<1||s.length>2)throw new Fr("nz expects (series[, fallback])");const r=s[0],a=s[1]??{kind:"scalar",value:0};if(r.kind==="scalar"&&a.kind==="scalar")return{kind:"scalar",value:Number.isFinite(r.value)?r.value:a.value};const l=ed(r,e),c=ed(a,e),d=e.length,v=new Float32Array(d);for(let g=0;g<d;g++){const _=l[g];v[g]=Number.isFinite(_)?_:c[g]}return{kind:"series",value:v}}case"add":case"sub":case"mul":case"div":{if(s.length!==2)throw new Fr(`${t} expects 2 arguments`);const r=s[0],a=s[1];if(r.kind==="scalar"&&a.kind==="scalar"){const g=r.value,_=a.value;return t==="add"?{kind:"scalar",value:g+_}:t==="sub"?{kind:"scalar",value:g-_}:t==="mul"?{kind:"scalar",value:g*_}:{kind:"scalar",value:_===0?NaN:g/_}}const l=ed(r,e),c=ed(a,e),d=e.length,v=new Float32Array(d);for(let g=0;g<d;g++){const _=l[g],y=c[g];t==="add"?v[g]=_+y:t==="sub"?v[g]=_-y:t==="mul"?v[g]=_*y:v[g]=y===0?NaN:_/y}return{kind:"series",value:v}}case"pow":{if(s.length!==2)throw new Fr("pow expects 2 arguments");const r=s[0],a=s[1];if(r.kind==="scalar"&&a.kind==="scalar")return{kind:"scalar",value:Math.pow(r.value,a.value)};const l=ed(r,e),c=ed(a,e);return{kind:"series",value:dO(l,c,(d,v)=>Math.pow(d,v))}}case"sqrt":case"log":case"log10":case"exp":case"floor":case"ceil":case"round":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"sign":{if(s.length!==1)throw new Fr(`${t} expects 1 argument`);const r=t==="sqrt"?Math.sqrt:t==="log"?Math.log:t==="log10"?Math.log10:t==="exp"?Math.exp:t==="floor"?Math.floor:t==="ceil"?Math.ceil:t==="round"?Math.round:t==="sin"?Math.sin:t==="cos"?Math.cos:t==="tan"?Math.tan:t==="asin"?Math.asin:t==="acos"?Math.acos:t==="atan"?Math.atan:Math.sign,a=s[0];return a.kind==="scalar"?{kind:"scalar",value:r(a.value)}:{kind:"series",value:cO(ed(a,e),r)}}case"cum":case"cumsum":{if(s.length!==1)throw new Fr(`${t} expects 1 argument`);const r=ed(s[0],e),a=e.length,l=new Float32Array(a);let c=0;for(let d=0;d<a;d++){const v=r[d];Number.isFinite(v)&&(c+=v),l[d]=c}return{kind:"series",value:l}}case"barssince":{if(s.length!==1)throw new Fr("barssince expects (condition)");const r=ed(s[0],e),a=e.length,l=new Float32Array(a);let c=NaN;for(let d=0;d<a;d++){const v=r[d];Number.isFinite(v)&&v!==0?(c=0,l[d]=0):Number.isFinite(c)?(c+=1,l[d]=c):l[d]=NaN}return{kind:"series",value:l}}case"sma":{const[r,a]=i();return{kind:"series",value:pO(r,a)}}case"wma":{const[r,a]=i();return{kind:"series",value:gO(r,a)}}case"ema":{const[r,a]=i();return{kind:"series",value:vO(r,a)}}case"smma":{const[r,a]=i();return{kind:"series",value:l2(r,a)}}case"rsi":{const[r,a]=i();return{kind:"series",value:fO(r,a)}}case"rma":{const[r,a]=i();return{kind:"series",value:l2(r,a)}}case"tr":{if(s.length!==0&&s.length!==3)throw new Fr("tr expects () or (high, low, close)");const r=s.length===3?ed(s[0],e):e.series.high,a=s.length===3?ed(s[1],e):e.series.low,l=s.length===3?ed(s[2],e):e.series.close;if(!r||!a||!l)throw new Fr("tr requires high/low/close series");const c=e.length,d=new Float32Array(c);let v=NaN;for(let g=0;g<c;g++){const _=r[g],y=a[g],k=l[g];let S=Math.max(0,_-y);Number.isFinite(v)&&(S=Math.max(S,Math.abs(_-v),Math.abs(y-v))),d[g]=S,v=k}return{kind:"series",value:d}}case"atr":{if(s.length!==4)throw new Fr("atr expects (high, low, close, period)");const r=ed(s[0],e),a=ed(s[1],e),l=ed(s[2],e),c=Math.max(1,Math.floor(Cm(s[3]))),d=e.length,v=new Float32Array(d);let g=NaN;for(let k=0;k<d;k++){const S=r[k],M=a[k],I=l[k];let C=Math.max(0,S-M);Number.isFinite(g)&&(C=Math.max(C,Math.abs(S-g),Math.abs(M-g))),v[k]=C,g=I}const _=new Float32Array(d);let y=0;for(let k=0;k<d;k++)y+=v[k],k===c-1?_[k]=y/c:k>=c?_[k]=(_[k-1]*(c-1)+v[k])/c:_[k]=NaN;return{kind:"series",value:_}}case"stdev":{const[r,a]=i();return{kind:"series",value:mO(r,a)}}case"highest":{const[r,a]=i();return{kind:"series",value:hO(r,a)}}case"lowest":{const[r,a]=i();return{kind:"series",value:_O(r,a)}}case"sum":{const[r,a]=i();return{kind:"series",value:aO(r,a)}}case"lag":{const[r,a]=i();return{kind:"series",value:d2(r,a)}}case"prev":{if(s.length<1||s.length>2)throw new Fr("prev expects (series[, n])");const r=ed(s[0],e),a=Math.max(1,Math.floor(Cm(s[1]??{kind:"scalar",value:1})));return{kind:"series",value:d2(r,a)}}case"change":{if(s.length<1||s.length>2)throw new Fr("change expects (series[, n])");const r=ed(s[0],e),a=Math.max(1,Math.floor(Cm(s[1]??{kind:"scalar",value:1})));return{kind:"series",value:lO(r,a)}}case"crossover":case"crossunder":{if(s.length<2||s.length>3)throw new Fr(`${o.callee} expects (series, series[, tol])`);const r=ed(s[0],e),a=s[1],l=a.kind==="series",c=ed(a,e),d=s[2]?Math.max(0,Cm(s[2])):0,v=e.length,g=new Float32Array(v);g[0]=0;for(let _=1;_<v;_++){const y=r[_-1],k=r[_],S=l?c[_-1]:c[0],M=l?c[_]:c[0];if(![y,k,S,M].every(Number.isFinite)){g[_]=0;continue}t==="crossover"?g[_]=y<=S+d&&k>M+d?1:0:g[_]=y>=S-d&&k<M-d?1:0}return{kind:"series",value:g}}case"hl2":{if(s.length!==0)throw new Fr("hl2 expects no arguments");const r=e.series.high,a=e.series.low;if(!r||!a)throw new Fr("hl2 requires high/low series");const l=e.length,c=new Float32Array(l);for(let d=0;d<l;d++)c[d]=(r[d]+a[d])/2;return{kind:"series",value:c}}case"hlc3":{if(s.length!==0)throw new Fr("hlc3 expects no arguments");const r=e.series.high,a=e.series.low,l=e.series.close;if(!r||!a||!l)throw new Fr("hlc3 requires high/low/close series");const c=e.length,d=new Float32Array(c);for(let v=0;v<c;v++)d[v]=(r[v]+a[v]+l[v])/3;return{kind:"series",value:d}}case"ohlc4":{if(s.length!==0)throw new Fr("ohlc4 expects no arguments");const r=e.series.open,a=e.series.high,l=e.series.low,c=e.series.close;if(!r||!a||!l||!c)throw new Fr("ohlc4 requires open/high/low/close series");const d=e.length,v=new Float32Array(d);for(let g=0;g<d;g++)v[g]=(r[g]+a[g]+l[g]+c[g])/4;return{kind:"series",value:v}}case"vwap":{if(s.length!==2)throw new Fr("vwap expects (close, volume)");const r=ed(s[0],e),a=ed(s[1],e),l=e.length,c=new Float32Array(l);let d=0,v=0;for(let g=0;g<l;g++){const _=r[g],y=a[g];if(!Number.isFinite(_)||!Number.isFinite(y)){c[g]=NaN;continue}d+=_*y,v+=y,c[g]=v===0?NaN:d/v}return{kind:"series",value:c}}case"vwma":{if(s.length!==3)throw new Fr("vwma expects (close, volume, period)");const r=ed(s[0],e),a=ed(s[1],e),l=Math.max(1,Math.floor(Cm(s[2]))),c=e.length,d=new Float32Array(c);let v=0,g=0;for(let _=0;_<c;_++){const y=r[_],k=a[_];if(Number.isFinite(y)&&Number.isFinite(k)&&(v+=y*k,g+=k),_>=l){const S=r[_-l],M=a[_-l];Number.isFinite(S)&&Number.isFinite(M)&&(v-=S*M,g-=M)}d[_]=_>=l-1&&g!==0?v/g:NaN}return{kind:"series",value:d}}case"min":{if(s.length!==2)throw new Fr("min expects 2 arguments");const r=s[0],a=s[1];if(r.kind==="scalar"&&a.kind==="scalar")return{kind:"scalar",value:Math.min(r.value,a.value)};const l=ed(r,e),c=ed(a,e),d=e.length,v=new Float32Array(d);for(let g=0;g<d;g++)v[g]=Math.min(l[g],c[g]);return{kind:"series",value:v}}case"max":{if(s.length!==2)throw new Fr("max expects 2 arguments");const r=s[0],a=s[1];if(r.kind==="scalar"&&a.kind==="scalar")return{kind:"scalar",value:Math.max(r.value,a.value)};const l=ed(r,e),c=ed(a,e),d=e.length,v=new Float32Array(d);for(let g=0;g<d;g++)v[g]=Math.max(l[g],c[g]);return{kind:"series",value:v}}case"abs":{if(s.length!==1)throw new Fr("abs expects 1 argument");const r=s[0];if(r.kind==="scalar")return{kind:"scalar",value:Math.abs(r.value)};const a=r.value,l=e.length,c=new Float32Array(l);for(let d=0;d<l;d++)c[d]=Math.abs(a[d]);return{kind:"series",value:c}}default:throw new Fr(`Unknown function "${o.callee}"`)}}function F0(o,e){var t;switch(o.kind){case"NumberLiteral":return{kind:"scalar",value:o.value};case"Identifier":{const s=o.name.replace(/\s+/g,"_").toLowerCase();if(s==="na"||s==="nan")return{kind:"scalar",value:NaN};const i=e.series[s];if(i)return{kind:"series",value:i};const r=(t=e.scalars)==null?void 0:t[s];if(typeof r=="number"&&Number.isFinite(r))return{kind:"scalar",value:r};throw e.seriesNames.has(s)?new Fr(`Series "${o.name}" is used before it is defined (circular or forward reference)`):new Fr(`Unknown identifier "${o.name}"`)}case"UnaryExpression":{const s=F0(o.expr,e);if(o.operator==="not"){if(s.kind==="scalar"){const a=s.value;return{kind:"scalar",value:Number.isFinite(a)&&a!==0?0:1}}const i=s.value,r=new Float32Array(i.length);for(let a=0;a<i.length;a++){const l=i[a];r[a]=Number.isFinite(l)&&l!==0?0:1}return{kind:"series",value:r}}throw new Fr("Unsupported unary operator")}case"BinaryExpression":return uO(o.operator,F0(o.left,e),F0(o.right,e),e);case"CallExpression":return yO(o,e);default:throw new Fr("Unsupported expression node")}}function pm(o,e,t){var I;const s=new Set;for(const C of o){const T=C.name.replace(/\s+/g,"_").toLowerCase();s.add(T)}const i=Object.entries(e),r=((I=i[0])==null?void 0:I[1].length)??0;for(const[,C]of i)if(C.length!==r)throw new Fr("All base series must have the same length");const a=o.map(C=>{try{const T=R0(C.expr);return{name:C.name.replace(/\s+/g,"_").toLowerCase(),expr:C.expr,ast:T}}catch(T){throw T instanceof um?new Fr(`Syntax error in series "${C.name}" at position ${T.position}: ${T.message}`):T}}),l={length:r,series:{...e},seriesNames:s,scalars:(()=>{if(!t||typeof t!="object")return;const C={};return Object.entries(t).forEach(([T,z])=>{const j=T.replace(/\s+/g,"_").toLowerCase();if(typeof z=="number"&&Number.isFinite(z)){C[j]=z;return}if(typeof z=="string"){const B=Number(z);Number.isFinite(B)&&(C[j]=B)}}),Object.keys(C).length?C:void 0})()},c={},d=C=>{const T=new Set,z=j=>{switch(j.kind){case"Identifier":{const B=j.name.replace(/\s+/g,"_").toLowerCase();T.add(B);break}case"BinaryExpression":z(j.left),z(j.right);break;case"UnaryExpression":z(j.expr);break;case"CallExpression":j.args.forEach(B=>z(B));break}};return z(C),T},v=new Set(a.map(C=>C.name)),g={},_={};a.forEach(C=>{g[C.name]=new Set,_[C.name]=new Set}),a.forEach(C=>{d(C.ast).forEach(z=>{v.has(z)&&z!==C.name&&(g[C.name].add(z),_[z].add(C.name))})});const y={};Object.keys(g).forEach(C=>{var T;y[C]=((T=g[C])==null?void 0:T.size)??0});const k=Object.keys(y).filter(C=>(y[C]||0)===0),S=[];for(;k.length;){const C=k.shift();S.push(C);for(const T of _[C]||[])y[T]=(y[T]||0)-1,y[T]===0&&k.push(T)}if(S.length!==a.length){const C=a.map(T=>T.name).filter(T=>!S.includes(T));throw new Fr(`Circular dependency detected among series: ${C.join(" -> ")}`)}const M={};a.forEach(C=>{M[C.name]=C});for(const C of S){const T=M[C];if(l.series[T.name])throw new Fr(`Series name "${T.name}" conflicts with an existing base series`);const z=F0(T.ast,l),j=ed(z,l);l.series[T.name]=j,c[T.name]=j}return c}function bO(o,e){var r;const t=o.replace(/\s+/g,"_").toLowerCase();if(t==="na"||t==="nan")return NaN;if(e.selfKey&&e.selfOut&&t===e.selfKey){if(e.selfMode==="current"){const l=e.selfOut[e.index];if(Number.isFinite(l))return l}const a=e.index-1;return a>=0?e.selfOut[a]:NaN}const s=e.series[t];if(s)return s[e.index]??NaN;const i=(r=e.scalars)==null?void 0:r[t];if(typeof i=="number"&&Number.isFinite(i))return i;throw new Fr(`Unknown identifier "${o}"`)}function Mu(o,e){switch(o.kind){case"NumberLiteral":return o.value;case"Identifier":return bO(o.name,e);case"UnaryExpression":{if(o.operator==="not"){const t=Mu(o.expr,e);return Number.isFinite(t)&&t!==0?0:1}return NaN}case"BinaryExpression":{const t=Mu(o.left,e),s=Mu(o.right,e);switch(o.operator){case"+":return t+s;case"-":return t-s;case"*":return t*s;case"/":return s===0?NaN:t/s;case"%":return s===0?NaN:t%s;case">":return Number.isFinite(t)&&Number.isFinite(s)&&t>s?1:0;case"<":return Number.isFinite(t)&&Number.isFinite(s)&&t<s?1:0;case">=":return Number.isFinite(t)&&Number.isFinite(s)&&t>=s?1:0;case"<=":return Number.isFinite(t)&&Number.isFinite(s)&&t<=s?1:0;case"==":return Number.isFinite(t)&&Number.isFinite(s)&&Math.abs(t-s)<1e-9?1:0;case"!=":return Number.isFinite(t)&&Number.isFinite(s)&&Math.abs(t-s)>=1e-9?1:0;case"and":return Number.isFinite(t)&&t!==0&&Number.isFinite(s)&&s!==0?1:0;case"or":return Number.isFinite(t)&&t!==0||Number.isFinite(s)&&s!==0?1:0;default:return NaN}}case"CallExpression":{const t=o.callee.toLowerCase(),s=o.args[0],i=o.args[1];if(t==="nz"){if(o.args.length<1||o.args.length>2)throw new Fr("nz expects (x[, fallback])");const r=Mu(s,e);return Number.isFinite(r)?r:o.args.length===2?Mu(i,e):0}if(t==="iff"||t==="iif"||t==="if"){if(o.args.length!==3)throw new Fr(`${o.callee} expects (cond, a, b)`);const r=Mu(s,e),a=Number.isFinite(r)&&r!==0,l=Mu(o.args[1],e),c=Mu(o.args[2],e);return a?l:c}if(t==="add"||t==="sub"||t==="mul"||t==="div"){if(o.args.length!==2)throw new Fr(`${o.callee} expects 2 arguments`);const r=Mu(s,e),a=Mu(i,e);return t==="add"?r+a:t==="sub"?r-a:t==="mul"?r*a:a===0?NaN:r/a}if(t==="min"||t==="max"){if(o.args.length!==2)throw new Fr(`${o.callee} expects 2 arguments`);const r=Mu(s,e),a=Mu(i,e);return t==="min"?Math.min(r,a):Math.max(r,a)}if(t==="abs"){if(o.args.length!==1)throw new Fr("abs expects 1 argument");return Math.abs(Mu(s,e))}if(t==="pow"){if(o.args.length!==2)throw new Fr("pow expects 2 arguments");const r=Mu(s,e),a=Mu(i,e);return Math.pow(r,a)}if(t==="sqrt"||t==="log"||t==="log10"||t==="exp"||t==="floor"||t==="ceil"||t==="round"||t==="sin"||t==="cos"||t==="tan"||t==="asin"||t==="acos"||t==="atan"||t==="sign"){if(o.args.length!==1)throw new Fr(`${o.callee} expects 1 argument`);const r=Mu(s,e);switch(t){case"sqrt":return Math.sqrt(r);case"log":return Math.log(r);case"log10":return Math.log10(r);case"exp":return Math.exp(r);case"floor":return Math.floor(r);case"ceil":return Math.ceil(r);case"round":return Math.round(r);case"sin":return Math.sin(r);case"cos":return Math.cos(r);case"tan":return Math.tan(r);case"asin":return Math.asin(r);case"acos":return Math.acos(r);case"atan":return Math.atan(r);default:return Math.sign(r)}}if(t==="cum"||t==="cumsum"){if(o.args.length!==1)throw new Fr(`${o.callee} expects 1 argument`);const r=s;if(r.kind!=="Identifier")throw new Fr(`${o.callee} expects a series identifier`);const a=r.name.replace(/\s+/g,"_").toLowerCase(),l=e.series[a];if(!l)throw new Fr(`Unknown identifier "${r.name}"`);let c=0;for(let d=0;d<=e.index;d++){const v=l[d];Number.isFinite(v)&&(c+=v)}return c}if(t==="barssince"){if(o.args.length!==1)throw new Fr("barssince expects (condition)");const r=s;if(r.kind!=="Identifier")throw new Fr("barssince expects a series identifier");const a=r.name.replace(/\s+/g,"_").toLowerCase(),l=e.series[a];if(!l)throw new Fr(`Unknown identifier "${r.name}"`);for(let c=e.index;c>=0;c--){const d=l[c];if(Number.isFinite(d)&&d!==0)return e.index-c}return NaN}if(t==="tr"){if(o.args.length!==0&&o.args.length!==3)throw new Fr("tr expects () or (high, low, close)");const r=(y,k)=>{if(!y){const I=e.series[k];if(!I)throw new Fr(`Unknown identifier "${k}"`);return I}if(y.kind!=="Identifier")throw new Fr("tr expects series identifiers");const S=y.name.replace(/\s+/g,"_").toLowerCase(),M=e.series[S];if(!M)throw new Fr(`Unknown identifier "${y.name}"`);return M},a=r(o.args[0],"high"),l=r(o.args[1],"low"),c=r(o.args[2],"close"),d=a[e.index],v=l[e.index],g=e.index>0?c[e.index-1]:NaN;let _=Math.max(0,d-v);return Number.isFinite(g)&&(_=Math.max(_,Math.abs(d-g),Math.abs(v-g))),_}if(t==="prev"||t==="lag"||t==="change"){if(o.args.length!==2)throw new Fr(`${o.callee} expects (series, n)`);const r=s;if(r.kind!=="Identifier")throw new Fr(`${o.callee} expects first argument to be a series identifier`);const a=r.name.replace(/\s+/g,"_").toLowerCase(),l=Mu(i,e),c=Math.max(1,Math.floor(l)),d=e.index-c,v=y=>{if(y<0)return NaN;if(e.selfKey&&e.selfOut&&a===e.selfKey)return e.selfOut[y]??NaN;const k=e.series[a];if(!k)throw new Fr(`Unknown identifier "${r.name}"`);return k[y]??NaN};if(t==="prev"||t==="lag")return v(d);const g=v(e.index),_=v(d);return Number.isFinite(g)&&Number.isFinite(_)?g-_:NaN}if(t==="crossover"||t==="crossunder"){if(o.args.length<2||o.args.length>3)throw new Fr(`${o.callee} expects (series, series[, tol])`);const r=s;if(r.kind!=="Identifier")throw new Fr(`${o.callee} expects first argument to be a series identifier`);const a=r.name.replace(/\s+/g,"_").toLowerCase(),l=e.series[a];if(!l)throw new Fr(`Unknown identifier "${r.name}"`);const c=o.args[1];let d=null,v=NaN;if(c.kind==="Identifier"){const M=c.name.replace(/\s+/g,"_").toLowerCase();if(d=e.series[M]||null,!d){const I=Number(c.name);v=Number.isFinite(I)?I:NaN}}else v=Mu(c,e);const g=o.args[2]?Math.max(0,Mu(o.args[2],e)):0;if(e.index<=0)return 0;const _=l[e.index-1],y=l[e.index],k=d?d[e.index-1]:v,S=d?d[e.index]:v;return[_,y,k,S].every(Number.isFinite)?t==="crossover"?_<=k+g&&y>S+g?1:0:_>=k-g&&y<S-g?1:0:0}throw new Fr(`Unknown function "${o.callee}"`)}default:return NaN}}function c2(o,e,t){var v;const s=Object.entries(e),i=((v=s[0])==null?void 0:v[1].length)??0;for(const[,g]of s)if(g.length!==i)throw new Fr("All base series must have the same length");const r=(()=>{if(!t||typeof t!="object")return;const g={};return Object.entries(t).forEach(([_,y])=>{const k=_.replace(/\s+/g,"_").toLowerCase();if(typeof y=="number"&&Number.isFinite(y)){g[k]=y;return}if(typeof y=="string"){const S=Number(y);Number.isFinite(S)&&(g[k]=S)}}),Object.keys(g).length?g:void 0})(),a=o.map(g=>{const _=g.name.replace(/\s+/g,"_").toLowerCase();try{const y=g.initExpr?R0(g.initExpr):null,k=R0(g.updateExpr);return{name:_,initAst:y,updateAst:k,initExpr:g.initExpr,updateExpr:g.updateExpr,selfMode:g.selfMode}}catch(y){throw y instanceof um?new Fr(`Syntax error in series "${g.name}" at position ${y.position}: ${y.message}`):y}}),l={},c={...e},d=new Set(Object.keys(e));for(const g of a){if(d.has(g.name))throw new Fr(`Series name "${g.name}" conflicts with an existing base series`);if(c[g.name])l[g.name]||(l[g.name]=c[g.name]);else{const _=new Float32Array(i);_.fill(NaN),c[g.name]=_,l[g.name]=_}}for(let g=0;g<i;g++)for(const _ of a){const y=l[_.name],k={series:c,scalars:r,length:i,index:g,selfKey:_.name,selfOut:y,selfMode:_.selfMode},S=g===0&&_.initAst?_.initAst:_.updateAst,M=Mu(S,k);y[g]=M}return l}function xO(o,e,t){var c;const s=Object.entries(e),i=((c=s[0])==null?void 0:c[1].length)??0;for(const[,d]of s)if(d.length!==i)throw new Fr("All base series must have the same length");const r=(()=>{if(!t||typeof t!="object")return;const d={};return Object.entries(t).forEach(([v,g])=>{const _=v.replace(/\s+/g,"_").toLowerCase();if(typeof g=="number"&&Number.isFinite(g)){d[_]=g;return}if(typeof g=="string"){const y=Number(g);Number.isFinite(y)&&(d[_]=y)}}),Object.keys(d).length?d:void 0})();let a;try{a=R0(o)}catch(d){throw d instanceof um?new Fr(`Syntax error at position ${d.position}: ${d.message}`):d}const l=new Float32Array(i);for(let d=0;d<i;d++){const v={series:e,scalars:r,length:i,index:d};l[d]=Mu(a,v)}return l}function d2(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){const r=i-e;s[i]=r>=0?o[r]:NaN}return s}function Ch(o){return typeof o=="number"&&Number.isFinite(o)}function k0(o,e,t){const s=o[t];if(Ch(s))return s;const i=e[t];return Ch(i)?i:NaN}function S0(o,e,t){const s=o[t];if(Ch(s))return s;const i=e[t];return Ch(i)?i:NaN}function u2(o,e,t,s){let i=-1,r=-1/0;for(let a=t;a<=s;a++){const l=k0(o,e,a);Number.isFinite(l)&&l>r&&(r=l,i=a)}return i}function p2(o,e,t,s){let i=-1,r=1/0;for(let a=t;a<=s;a++){const l=S0(o,e,a);Number.isFinite(l)&&l<r&&(r=l,i=a)}return i}function tw(o,e,t,s,i){const r=Math.min(o.length,e.length,t.length);if(r<=1)return null;const a=Math.min(r-1,Math.max(0,Math.trunc(s))),l=Math.max(2,Math.trunc(i.lookback||200)),c=Math.max(0,a-l+1),d=i.direction==="down"?"down":"up";if((i.method==="pivots"?"pivots":"extremes")==="pivots"){const S=Math.max(1,Math.floor(Number(i.pivotLeft??3))),M=Math.max(1,Math.floor(Number(i.pivotRight??3))),I=a;if(I<M)return null;const C=[],T=[],z=K=>{const Y=k0(o,t,K);if(!Number.isFinite(Y))return null;const Z=Math.max(0,K-S),ne=Math.min(I,K+M);if(ne<K+M)return null;for(let te=Z;te<=ne;te++){if(te===K)continue;const oe=k0(o,t,te);if(!Number.isFinite(oe)||oe>=Y)return null}return Y},j=K=>{const Y=S0(e,t,K);if(!Number.isFinite(Y))return null;const Z=Math.max(0,K-S),ne=Math.min(I,K+M);if(ne<K+M)return null;for(let te=Z;te<=ne;te++){if(te===K)continue;const oe=S0(e,t,te);if(!Number.isFinite(oe)||oe<=Y)return null}return Y},B=Math.max(c,0),$=Math.min(a-M,a);for(let K=B;K<=$;K++){const Y=z(K);Y!=null&&C.push({index:K,value:Y});const Z=j(K);Z!=null&&T.push({index:K,value:Z})}const F=C.length?C[C.length-1]:null,V=T.length?T[T.length-1]:null;if(!(!F||!V))if(d==="up"){let K=null;for(let Y=T.length-1;Y>=0;Y--)if(T[Y].index<F.index){K=T[Y];break}if(K)return{fromIndex:K.index,toIndex:F.index,fromValue:K.value,toValue:F.value}}else{let K=null;for(let Y=C.length-1;Y>=0;Y--)if(C[Y].index<V.index){K=C[Y];break}if(K)return{fromIndex:K.index,toIndex:V.index,fromValue:K.value,toValue:V.value}}}if(d==="up"){const S=u2(o,t,c,a);if(S<0)return null;const M=p2(e,t,c,S);if(M<0)return null;const I=S0(e,t,M),C=k0(o,t,S);return[I,C].every(Number.isFinite)?{fromIndex:M,toIndex:S,fromValue:I,toValue:C}:null}const g=p2(e,t,c,a);if(g<0)return null;const _=u2(o,t,c,g);if(_<0)return null;const y=S0(e,t,g),k=k0(o,t,_);return[y,k].every(Number.isFinite)?{fromIndex:_,toIndex:g,fromValue:k,toValue:y}:null}function wO(o,e,t,s){const i=Math.min(o.length,e.length,t.length),r=new Array(i),a=new Array(i),l=new Array(i),c=new Array(i),d=new Array(i),v=new Array(i),g=new Array(i);for(let _=0;_<i;_++){const y=tw(o,e,t,_,s);if(!y){r[_]=void 0,a[_]=void 0,l[_]=void 0,c[_]=void 0,d[_]=void 0,v[_]=void 0,g[_]=void 0;continue}r[_]=y.fromValue,a[_]=y.toValue,l[_]=y.fromIndex,c[_]=y.toIndex,d[_]=y.fromValue,g[_]=y.toValue,v[_]=y.fromValue+(y.toValue-y.fromValue)*.5}return{from:r,to:a,fromIndex:l,toIndex:c,lvl0:d,lvl50:v,lvl100:g}}function Bm(o,e){const t=[];let s=0;for(let i=0;i<o.length;i++){const r=o[i];s+=r??0,i>=e&&(s-=o[i-e]??0),t.push(i>=e-1?s/e:void 0)}return t}function kO(o,e){const t=[],s=e*(e+1)/2;for(let i=0;i<o.length;i++){if(i<e-1){t.push(void 0);continue}let r=0;for(let a=0;a<e;a++)r+=(o[i-a]??0)*(e-a);t.push(r/s)}return t}function SO(o,e){const t=[];let s,i=0;for(let r=0;r<o.length;r++){const a=o[r];if(a==null){t.push(void 0);continue}if(s===void 0){if(i+=a,r<e-1){t.push(void 0);continue}s=i/e,t.push(s);continue}s=(s*(e-1)+a)/e,t.push(s)}return t}function Zf(o,e){const t=[],s=2/(e+1);let i;for(let r=0;r<o.length;r++){const a=o[r];if(a==null){t.push(void 0);continue}i=i===void 0?a:a*s+i*(1-s),t.push(i)}return t}function CO(o,e){const t=[];let s,i=0,r=0,a=!1;const l=[],c=[];for(let d=0;d<o.length;d++){const v=o[d];if(v==null){t.push(void 0);continue}if(s===void 0){s=v,t.push(void 0);continue}const g=v-s;s=v;const _=g>0?g:0,y=g<0?-g:0;if(a)i=(i*(e-1)+_)/e,r=(r*(e-1)+y)/e;else{if(l.push(_),c.push(y),l.length<e){t.push(void 0);continue}i=l.reduce((k,S)=>k+S,0)/e,r=c.reduce((k,S)=>k+S,0)/e,a=!0}if(r===0)t.push(100);else{const k=i/r;t.push(100-100/(1+k))}}return t}function Ph(o,e,t,s){const i=t.length,r=new Array(i).fill(0);let a;for(let d=0;d<i;d++){const v=o[d]??t[d]??NaN,g=e[d]??t[d]??NaN,_=t[d]??NaN;let y=Math.max(0,v-g);a!==void 0&&(y=Math.max(y,Math.abs(v-a),Math.abs(g-a))),r[d]=y,a=_}const l=new Array(i);let c=0;for(let d=0;d<i;d++)c+=r[d],d===s-1?l[d]=c/s:d>=s?l[d]=(l[d-1]*(s-1)+r[d])/s:l[d]=void 0;return l}function PO(o,e){const t=new Array(o.length);let s=0,i;for(let r=0;r<o.length;r++){const a=o[r],l=e[r]??0;if(i===void 0||a===void 0){t[r]=void 0,i=a;continue}a>i?s+=l:a<i&&(s-=l),t[r]=s,i=a}return t}function IO(o,e,t,s){const i=t.length,r=new Array(i);for(let c=0;c<i;c++)r[c]=((o[c]??t[c]??0)+(e[c]??t[c]??0)+(t[c]??0))/3;const a=Bm(r.map(c=>c),s).map(c=>c),l=new Array(i);for(let c=0;c<i;c++){if(c<s-1){l[c]=void 0;continue}let d=0;for(let g=c-s+1;g<=c;g++)d+=Math.abs(r[g]-a[c]);d=d/s;const v=.015*d;l[c]=v===0?void 0:(r[c]-a[c])/v}return l}function MO(o,e,t,s,i){const r=t.length,a=new Array(r),l=new Array(r);for(let d=0;d<r;d++)l[d]=((o[d]??t[d]??0)+(e[d]??t[d]??0)+(t[d]??0))/3;const c=new Array(r);for(let d=0;d<r;d++)c[d]=l[d]*(s[d]??0);for(let d=0;d<r;d++){if(d<i){a[d]=void 0;continue}let v=0,g=0;for(let y=d-i+1;y<=d;y++)l[y]>=l[y-1]?v+=c[y]:g+=c[y];const _=g===0?1/0:v/g;a[d]=100-100/(1+_)}return a}function TO(o,e){const t=o.map((a,l)=>((a??0)+(e[l]??0))/2),s=Bm(t,5),i=Bm(t,34),r=new Array(t.length);for(let a=0;a<t.length;a++){const l=s[a],c=i[a];r[a]=l===void 0||c===void 0?void 0:l-c}return r}function AO(o,e){const t=Zf(o,e).map(a=>a??NaN),s=Zf(t,e).map(a=>a??NaN),i=Zf(s,e).map(a=>a??NaN),r=new Array(o.length);for(let a=1;a<o.length;a++){const l=i[a-1],c=i[a];r[a]=l===void 0||c===void 0||l===0?void 0:(c/l-1)*100}return r[0]=void 0,r}function v2(o,e){const t=new Array(o.length);let s=0,i=0;for(let r=0;r<o.length;r++){const a=o[r],l=e[r]??0;if(a===void 0){t[r]=void 0;continue}s+=a*l,i+=l,t[r]=i===0?void 0:s/i}return t}function LO(o,e,t){const s=new Array(o.length);let i=0,r=0;for(let a=0;a<o.length;a++){const l=o[a],c=e[a]??0;if(l!==void 0&&(i+=l*c,r+=c),a>=t){const d=o[a-t],v=e[a-t]??0;d!==void 0&&(i-=d*v,r-=v)}s[a]=a>=t-1&&r!==0?i/r:void 0}return s}function f2(o,e,t){const s=o.map(c=>c??NaN),i=Bm(s,e),r=[];for(let c=0;c<s.length;c++){if(c<e-1){r.push(void 0);continue}let d=0;for(let _=c-e+1;_<=c;_++)d+=s[_];const v=d/e;let g=0;for(let _=c-e+1;_<=c;_++){const y=s[_]-v;g+=y*y}r.push(Math.sqrt(g/e))}const a=new Array(s.length),l=new Array(s.length);for(let c=0;c<s.length;c++){const d=i[c],v=r[c];a[c]=d===void 0||v===void 0?void 0:d+t*v,l[c]=d===void 0||v===void 0?void 0:d-t*v}return{mid:i,upper:a,lower:l}}function zO(o,e,t,s,i){const r=t.length,a=Ph(o,e,t,s).map(y=>y??NaN),l=new Array(r),c=new Array(r);for(let y=0;y<r;y++){const k=((o[y]??t[y]??0)+(e[y]??t[y]??0))/2,S=a[y];l[y]=k+i*S,c[y]=k-i*S}const d=new Array(r);let v=NaN,g=NaN,_=!0;for(let y=0;y<r;y++){v=Number.isFinite(v)?Math.min(l[y],v):l[y],g=Number.isFinite(g)?Math.max(c[y],g):c[y];const k=t[y]??NaN;if(!Number.isFinite(k)){d[y]=void 0;continue}_?(k<g&&(_=!1,v=l[y]),d[y]=g):(k>v&&(_=!0,g=c[y]),d[y]=v)}return d}function FO(o,e,t,s,i){const r=Zf(t,s).map(v=>v??NaN),a=Ph(o,e,t,s).map(v=>v??NaN),l=t.length,c=new Array(l),d=new Array(l);for(let v=0;v<l;v++){const g=r[v],_=a[v];c[v]=Number.isFinite(g)&&Number.isFinite(_)?g+i*_:void 0,d[v]=Number.isFinite(g)&&Number.isFinite(_)?g-i*_:void 0}return{mid:r,upper:c,lower:d}}function $O(o,e,t){const s=o.length,i=new Array(s),r=new Array(s),a=new Array(s);for(let l=0;l<s;l++){if(l<t-1){i[l]=void 0,r[l]=void 0,a[l]=void 0;continue}let c=-1/0,d=1/0;for(let v=l-t+1;v<=l;v++){const g=o[v]??e[v]??NaN,_=e[v]??o[v]??NaN;Number.isFinite(g)&&g>c&&(c=g),Number.isFinite(_)&&_<d&&(d=_)}i[l]=c,r[l]=d,a[l]=Number.isFinite(c)&&Number.isFinite(d)?(c+d)/2:void 0}return{upper:i,lower:r,mid:a}}function ow(o,e){const t=o.length,s=new Array(t);for(let i=0;i<t;i++){if(i<e-1){s[i]=void 0;continue}let r=0;for(let v=i-e+1;v<=i;v++)r+=o[v]??0;const a=r/e;let l=0;for(let v=i-e+1;v<=i;v++){const g=(o[v]??0)-a;l+=g*g}const c=Math.sqrt(l/e),d=o[i]??NaN;s[i]=Number.isFinite(c)&&c!==0?(d-a)/c:void 0}return s}function m2(o,e){const t=o.length,s=new Array(t);let i=o[0];for(let r=0;r<t;r++){const a=o[r],l=e[r]??0;if(a==null){s[r]=void 0;continue}const c=a>=(i??a)?1:-1;s[r]=c*l,i=a}return s}function DO(o){const e=o.length,t=new Array(e);let s=0;for(let i=0;i<e;i++){const r=o[i];if(r==null){t[i]=void 0;continue}s+=r,t[i]=s}return t}function EO(o,e){const t=o.length,s=new Array(t),i=new Array(t),r=new Array(t);for(let a=0;a<t;a++){if(a<e-1){s[a]=void 0,i[a]=void 0,r[a]=void 0;continue}let l=0,c=0,d=0,v=0,g=0;for(let T=a-e+1;T<=a;T++){const z=T-(a-e+1),j=o[T]??NaN;Number.isFinite(j)&&(l+=z,c+=j,d+=z*z,v+=z*j,g++)}const _=g*d-l*l;if(_===0||g===0){s[a]=void 0,i[a]=void 0,r[a]=void 0;continue}const y=(g*v-l*c)/_,k=(c-y*l)/g,S=e-1,M=y*S+k;s[a]=M;const I=ow(o.slice(a-e+1,a+1).map(T=>T??NaN),e).pop(),C=Number(I)*(o[a]??0?1:0);i[a]=Number.isFinite(M)?M+Math.abs(C||0):void 0,r[a]=Number.isFinite(M)?M-Math.abs(C||0):void 0}return{mid:s,upper:i,lower:r}}function NO(o,e,t){const s=o.length,i=new Array(s);let r=0;for(let a=0;a<s;a++){const l=o[a],c=e[a]??0;if(l==null){i[a]=void 0;continue}const d=c/Math.max(1,e[a-1]??c);r=(r*(t-1)+l*d)/t,i[a]=r}return i}function jO(o){const{seriesMap:e,calcDefs:t,len:s,params:i,lastPrevSource:r,resolveNum:a,onError:l}=o,c=i||{};for(const d of t){const v=d.name||d.type;if(!v)continue;const g=String(v).replace(/\s+/g,"_").toLowerCase(),_=String(d.type||"").toLowerCase();if(_!=="security"){if(_==="sma"){const y=d.source||"close";e[g]=Bm(e[y]||e.close,Math.max(1,a(d.period,`${g}_period`,14)))}else if(_==="smma"){const y=d.source||"close";e[g]=SO(e[y]||e.close,Math.max(1,a(d.period,`${g}_period`,13)))}else if(_==="ema"){const y=d.source||"close";e[g]=Zf(e[y]||e.close,Math.max(1,a(d.period,`${g}_period`,14)))}else if(_==="wma"){const y=d.source||"close";e[g]=kO(e[y]||e.close,Math.max(1,a(d.period,`${g}_period`,14)))}else if(_==="rsi"){const y=d.source||"close";e[g]=CO(e[y]||e.close,Math.max(1,a(d.period,`${g}_period`,14)))}else if(_==="bbands"||_==="bollinger"||_==="bollinger_bands"){const y=d.source||"close",k=Math.max(1,a(d.period,`${g}_period`,20)),S=Math.max(.1,a(d.std,`${g}_std`,a(d.deviation,`${g}_deviation`,2))),{mid:M,upper:I,lower:C}=f2(e[y]||e.close,k,S);e[g+"_mid"]=M,e[g+"_upper"]=I,e[g+"_lower"]=C}else if(_==="atr"){const y=Math.max(1,a(d.period,`${g}_period`,14));e[g]=Ph(e.high,e.low,e.close,y)}else if(_==="obv")e[g]=PO(e.close,e.volume);else if(_==="cci"){const y=Math.max(1,a(d.period,`${g}_period`,20));e[g]=IO(e.high,e.low,e.close,y)}else if(_==="mfi"){const y=Math.max(1,a(d.period,`${g}_period`,14));e[g]=MO(e.high,e.low,e.close,e.volume,y)}else if(_==="ao")e[g]=TO(e.high,e.low);else if(_==="trix"){const y=Math.max(1,a(d.period,`${g}_period`,12));e[g]=AO(e.close,y)}else if(_==="vwap")e[g]=v2(e.close,e.volume);else if(_==="vwma"){const y=Math.max(1,a(d.period,`${g}_period`,20));e[g]=LO(e.close,e.volume,y)}else if(_==="macd"){const y=(d.source||"close").replace(/\s+/g,"_").toLowerCase(),k=Math.max(1,Number(d.fast)||12),S=Math.max(1,Number(d.slow)||26),M=Math.max(1,Number(d.signal)||9),I=e[y]||e.close,C=Zf(I,k),T=Zf(I,S),z=new Array(s);for(let F=0;F<s;F++)z[F]=C[F]===void 0||T[F]===void 0?void 0:C[F]-T[F];const j=Zf(z,M),B=new Array(s),$=new Array(s);for(let F=0;F<s;F++){const V=z[F],K=j[F];B[F]=typeof K=="number"&&Number.isFinite(K)?K:void 0,$[F]=V!==void 0&&K!==void 0?V-K:void 0}e.macd_line=z,e.macd_signal=B,e.macd_hist=$}else if(_==="supertrend"){const y=Math.max(1,Number(d.period)||10),k=Math.max(.1,Number(d.factor)||3);e[g]=zO(e.high,e.low,e.close,y,k)}else if(_==="kc"||_==="keltner"){const y=Math.max(1,Number(d.period)||20),k=Math.max(.1,Number(d.mult)||2),S=FO(e.high,e.low,e.close,y,k);e[g+"_mid"]=S.mid,e[g+"_upper"]=S.upper,e[g+"_lower"]=S.lower}else if(_==="donchian"){const y=Math.max(1,Number(d.period)||20),k=$O(e.high,e.low,y);e[g+"_mid"]=k.mid,e[g+"_upper"]=k.upper,e[g+"_lower"]=k.lower}else if(_==="atr_bands"){const y=Math.max(1,Number(d.period)||14),k=Math.max(.1,Number(d.mult)||2),S=Ph(e.high,e.low,e.close,y),M=new Array(s),I=new Array(s);for(let C=0;C<s;C++){const T=S[C],z=e.close[C];M[C]=T!=null&&z!=null?z+k*T:void 0,I[C]=T!=null&&z!=null?z-k*T:void 0}e[g+"_upper"]=M,e[g+"_lower"]=I}else if(_==="zscore"){const y=Math.max(1,Number(d.period)||20),k=d.source||"close";e[g]=ow(e[k]||e.close,y)}else if(_==="volume_delta")e[g]=m2(e.close,e.volume);else if(_==="cum_delta"){const y=m2(e.close,e.volume);e[g]=DO(y)}else if(_==="vwap_bands"){const y=Math.max(1,Number(d.period)||20),k=v2(e.close,e.volume),{upper:S,lower:M}=f2(Array.from(k).map(I=>I),y,Math.max(.1,Number(d.std)||2));e[g+"_mid"]=Array.from(k),e[g+"_upper"]=S,e[g+"_lower"]=M}else if(_==="linreg_channel"){const y=Math.max(1,Number(d.period)||20),k=d.source||"close",S=EO(e[k]||e.close,y);e[g+"_mid"]=S.mid,e[g+"_upper"]=S.upper,e[g+"_lower"]=S.lower}else if(_==="evwma"){const y=Math.max(1,Number(d.period)||20);e[g]=NO(e.close,e.volume,y)}else if(_==="sar"){const y=Math.max(.001,Number(d.step)||.02),k=Math.max(y,Number(d.max)||.2),S=e.high,M=e.low,I=new Array(s);let C=y,T=S[0],z=M[0],j=!0;for(let B=1;B<s;B++){const $=S[B]??NaN,F=M[B]??NaN;if(!Number.isFinite($)||!Number.isFinite(F)){I[B]=void 0;continue}let V=z;j?(V=z+C*(T-z),$>T&&(T=$,C=Math.min(k,C+y)),V>F&&(j=!1,V=T,T=F,C=y)):(V=z-C*(z-T),F<T&&(T=F,C=Math.min(k,C+y)),V<$&&(j=!0,V=T,T=$,C=y)),I[B]=V,z=V}I[0]=z,e.sar=I}else if(_==="stoch"){const y=Number(d.kPeriod)||14,k=Number(d.dPeriod)||3,S=[],M=[];for(let C=0;C<s;C++){const T=Math.max(0,C-y+1);let z=-1/0,j=1/0;for(let V=T;V<=C;V++){const K=e.high[V]??e.close[V]??NaN,Y=e.low[V]??e.close[V]??NaN;K>z&&(z=K),Y<j&&(j=Y)}const B=e.close[C]??NaN,$=z-j,F=$===0?void 0:100*((B-j)/$);S.push(F)}const I=Bm(S.map(C=>C??NaN),k);for(let C=0;C<s;C++)M.push(isNaN(I[C])?void 0:I[C]);e[g+"_k"]=S,e[g+"_d"]=M}else if(_==="roc"){const y=d.source||"close",k=e[y]||e.close,S=Math.max(1,Number(d.period)||10),M=new Array(s);for(let I=0;I<s;I++){const C=k[I],T=k[I-S];C===void 0||T===void 0||T===0?M[I]=void 0:M[I]=(C/T-1)*100}e[g]=M}else if(_==="ichimoku"){const y=Math.max(1,Number(d.tenkan)||9),k=Math.max(1,Number(d.kijun)||26),S=Math.max(1,Number(d.senkouB)||52),M=k,I=new Array(s),C=new Array(s),T=new Array(s),z=new Array(s),j=new Array(s),B=new Array(s),$=new Array(s),F=e.high,V=e.low,K=e.close,Y=(Z,ne)=>{let te=-1/0,oe=1/0;const U=Math.max(0,Z-ne+1);for(let J=U;J<=Z;J++){const se=F[J]??K[J]??NaN,W=V[J]??K[J]??NaN;se>te&&(te=se),W<oe&&(oe=W)}return{hi:te,lo:oe}};for(let Z=0;Z<s;Z++){if(Z>=y-1){const{hi:ne,lo:te}=Y(Z,y);I[Z]=(ne+te)/2}if(Z>=k-1){const{hi:ne,lo:te}=Y(Z,k);C[Z]=(ne+te)/2}if(I[Z]!==void 0&&C[Z]!==void 0&&(T[Z]=(I[Z]+C[Z])/2),Z>=S-1){const{hi:ne,lo:te}=Y(Z,S);z[Z]=(ne+te)/2}$[Z]=Z+M<s?K[Z+M]:void 0}for(let Z=0;Z<s;Z++)j[Z]=Z>=M?T[Z-M]:void 0,B[Z]=Z>=M?z[Z-M]:void 0;e.tenkan=I,e.kijun=C,e.spana=j,e.spanb=B,e.chikou=$}else if(_==="pivot_high"){const y=Math.max(0,Number(d.left)||3),k=Math.max(0,Number(d.right)||3),S=new Array(s);for(let M=0;M<s;M++){const I=e.high[M]??e.close[M]??NaN;if(!Number.isFinite(I)){S[M]=void 0;continue}let C=!0;const T=Math.max(0,M-y),z=Math.min(s-1,M+k);for(let j=T;j<=z;j++){if(j===M)continue;const B=e.high[j]??e.close[j]??NaN;if(!Number.isFinite(B)){C=!1;break}if(B>=I){C=!1;break}}S[M]=C?I:void 0}e[g]=S}else if(_==="pivot_low"){const y=Math.max(0,Number(d.left)||3),k=Math.max(0,Number(d.right)||3),S=new Array(s);for(let M=0;M<s;M++){const I=e.low[M]??e.close[M]??NaN;if(!Number.isFinite(I)){S[M]=void 0;continue}let C=!0;const T=Math.max(0,M-y),z=Math.min(s-1,M+k);for(let j=T;j<=z;j++){if(j===M)continue;const B=e.low[j]??e.close[j]??NaN;if(!Number.isFinite(B)){C=!1;break}if(B<=I){C=!1;break}}S[M]=C?I:void 0}e[g]=S}else if(_==="auto_fib"||_==="autofib"){const y=Math.max(2,Math.floor(a(d.lookback,`${g}_lookback`,200))),S=String(d.direction||"up").trim().toLowerCase()==="down"?"down":"up",M=String(d.method||d.mode||"extremes").trim().toLowerCase(),I=M==="pivots"||M==="pivot"||M==="swing"?"pivots":"extremes",C=Math.max(1,Math.floor(Number(d.pivotLeft??d.left??3))),T=Math.max(1,Math.floor(Number(d.pivotRight??d.right??3))),z=wO(e.high,e.low,e.close,{lookback:y,direction:S,method:I,pivotLeft:C,pivotRight:T});e[`${g}_from`]=z.from,e[`${g}_to`]=z.to,e[`${g}_from_idx`]=z.fromIndex,e[`${g}_to_idx`]=z.toIndex,e[`${g}_0`]=z.lvl0,e[`${g}_50`]=z.lvl50,e[`${g}_100`]=z.lvl100}else if(_==="last_value"){const y=String(d.source||"close").replace(/\s+/g,"_").toLowerCase(),k=e[y]||e.close,S=new Array(s);let M;for(let I=0;I<s;I++){const C=k[I];C!=null&&Number.isFinite(C)&&(M=C),S[I]=M}e[g]=S,r[g]=y}else if(_==="prev_value"){const y=String(d.source||"close").replace(/\s+/g,"_").toLowerCase(),k=e[y]||e.close,S=new Array(s);let M,I;for(let C=0;C<s;C++){const T=k[C];if(T!=null&&Number.isFinite(T)){const z=T;(M===void 0||z!==M)&&(I=M,M=z)}S[C]=I}e[g]=S,r[g]=y}else if(_==="line_value"){const y=String(d.startValue||"").replace(/\s+/g,"_").toLowerCase(),k=String(d.endValue||"").replace(/\s+/g,"_").toLowerCase();let M=r[y]||r[k]||"";M||(/pl|low/i.test(y)||/pl|low/i.test(k)?M="pl":(/ph|high/i.test(y)||/ph|high/i.test(k))&&(M="ph"));const I=e[M],C=new Array(s);if(I){const T=[];for(let z=s-1;z>=0&&T.length<2;z--){const j=I[z];j!=null&&Number.isFinite(j)&&T.push(z)}if(T.reverse(),T.length===2){const z=T[0],j=T[1],B=I[z],$=I[j];if(Number.isFinite(B)&&Number.isFinite($)&&j!==z){const F=($-B)/(j-z),V=B-F*z,K=Math.max(1,Number(d.lookback)||s),Y=Math.max(0,j-K);for(let Z=0;Z<s;Z++)C[Z]=Z>=Y?F*Z+V:void 0}}}e[g]=C}else if(_==="compare"){const y=String(d.left??"").trim(),k=String(d.right??"").trim(),S=String(d.op||">"),M=/^[-+]?\d+(?:\.\d+)?$/.test(y),I=/^[-+]?\d+(?:\.\d+)?$/.test(k),C=y.replace(/\s+/g,"_").toLowerCase(),T=k.replace(/\s+/g,"_").toLowerCase(),z=M?null:e[C]||e.close,j=I?null:e[T]||e.close,B=M?Number(y):NaN,$=I?Number(k):NaN,F=new Array(s);for(let V=0;V<s;V++){const K=M?B:(z==null?void 0:z[V])??NaN,Y=I?$:(j==null?void 0:j[V])??NaN;if(!Number.isFinite(K)||!Number.isFinite(Y)){F[V]=0;continue}let Z=!1;switch(S){case">":Z=K>Y;break;case"<":Z=K<Y;break;case">=":Z=K>=Y;break;case"<=":Z=K<=Y;break;case"==":Z=Math.abs(K-Y)<1e-9;break;default:Z=K>Y;break}F[V]=Z?1:0}e[g]=F}else if(typeof d.expr=="string"&&String(d.expr).trim().length)try{const y={};Object.entries(e).forEach(([I,C])=>{const T=new Float32Array(s);for(let z=0;z<s;z++)T[z]=C[z]??NaN;y[I.replace(/\s+/g,"_").toLowerCase()]=T});const k=pm([{name:g,expr:String(d.expr).replace(/\$\{([^}]+)\}/g,(I,C)=>String(c[C]??I))}],y,c),S=new Array(s),M=k[g];for(let I=0;I<s;I++){const C=M==null?void 0:M[I];S[I]=Number.isFinite(C)?C:void 0}e[g]=S}catch(y){if(l){const k=(y==null?void 0:y.message)!=null?String(y.message):String(y);l(`Expression error: ${k}`,y)}}}}}const oh=o=>o>="0"&&o<="9",g2=o=>o>="a"&&o<="z"||o>="A"&&o<="Z"||o==="_"||o==="$";class RO{constructor(e){ve(this,"pos",0);this.input=e}next(){const e=this.input,t=e.length;for(;this.pos<t&&/\s/.test(e[this.pos]??"");)this.pos++;if(this.pos>=t)return{type:"eof",pos:this.pos};const s=this.pos,i=e[this.pos];if(oh(i)||i==="."&&oh(e[this.pos+1]??"")){let r=i===".";for(this.pos++;this.pos<t;){const a=e[this.pos];if(oh(a))this.pos++;else if(a==="."&&!r)r=!0,this.pos++;else break}return{type:"number",value:e.slice(s,this.pos),pos:s}}if(g2(i)){for(this.pos++;this.pos<t;){const l=e[this.pos];if(g2(l)||oh(l))this.pos++;else break}const r=e.slice(s,this.pos),a=r.toLowerCase();return a==="and"?{type:"and",pos:s}:a==="or"?{type:"or",pos:s}:a==="not"?{type:"not",pos:s}:a==="crossesabove"?{type:"crossesAbove",pos:s}:a==="crossesbelow"?{type:"crossesBelow",pos:s}:{type:"identifier",value:r,pos:s}}switch(this.pos++,i){case">":return e[this.pos]==="="?(this.pos++,{type:"gte",pos:s}):{type:"gt",pos:s};case"<":return e[this.pos]==="="?(this.pos++,{type:"lte",pos:s}):{type:"lt",pos:s};case"=":{if(e[this.pos]==="=")return this.pos++,{type:"eq",pos:s};throw new Error(`Unexpected '=' at ${s}, expected '=='`)}case"!":{if(e[this.pos]==="=")return this.pos++,{type:"neq",pos:s};throw new Error(`Unexpected '!' at ${s}, expected '!='`)}case"(":return{type:"lparen",pos:s};case")":return{type:"rparen",pos:s};case",":return{type:"comma",pos:s};default:throw new Error(`Unexpected character "${i}" at position ${s}`)}}}class Uf extends Error{constructor(e,t){super(e),this.position=t,this.name="ConditionParseError"}}class BO{constructor(e){ve(this,"current");this.tokenizer=e,this.current=e.next()}cur(){return this.current.type}eat(e){if(this.current.type!==e)throw new Uf(`Expected ${e} but found ${this.current.type}`,this.current.pos);const t=this.current;return this.current=this.tokenizer.next(),t}match(e){return this.current.type===e?(this.current=this.tokenizer.next(),!0):!1}parseCondition(){const e=this.parseOr();if(this.current.type!=="eof")throw new Uf("Unexpected input after end of condition",this.current.pos);return e}parseOr(){let e=this.parseAnd();for(;this.current.type==="or";){this.eat("or");const t=this.parseAnd();e={kind:"Logical",op:"or",left:e,right:t}}return e}parseAnd(){let e=this.parsePrimary();for(;this.current.type==="and";){this.eat("and");const t=this.parsePrimary();e={kind:"Logical",op:"and",left:e,right:t}}return e}parsePrimary(){if(this.current.type==="lparen"){this.eat("lparen");const e=this.parseOr();return this.eat("rparen"),e}if(this.current.type==="not")return this.eat("not"),{kind:"Negation",expr:this.parsePrimary()};if(this.current.type==="identifier"){const e=this.eat("identifier");if(this.cur()==="lparen"){this.eat("lparen");const a=[];if(this.cur()!=="rparen")for(;a.push(this.parseValue()),!!this.match("comma"););return this.eat("rparen"),String(e.value||"").toLowerCase()==="between"&&a.length===3?{kind:"Between",value:a[0],a:a[1],b:a[2]}:{kind:"Call",name:String(e.value||""),args:a}}const t={kind:"SeriesRef",name:String(e.value||"")};{const a=this.cur();if(a==="crossesAbove"||a==="crossesBelow"){const l=this.current;if(this.current=this.tokenizer.next(),t.kind!=="SeriesRef")throw new Uf("`crossesAbove/crossesBelow` left side must be a series name",l.pos);const c=this.parseValue();return{kind:"Cross",dir:l.type==="crossesAbove"?"above":"below",left:t,right:c}}}{const a=this.cur();if(a!=="gt"&&a!=="lt"&&a!=="gte"&&a!=="lte"&&a!=="eq"&&a!=="neq")return{kind:"Comparison",op:">",left:t,right:{kind:"NumberLiteral",value:0}}}const s=this.current;this.current=this.tokenizer.next();let i=">";s.type==="lt"?i="<":s.type==="gte"?i=">=":s.type==="lte"?i="<=":s.type==="eq"&&(i="==");const r=this.parseValue();return s.type==="neq"?{kind:"Logical",op:"or",left:{kind:"Comparison",op:">",left:t,right:r},right:{kind:"Comparison",op:"<",left:t,right:r}}:{kind:"Comparison",op:i,left:t,right:r}}return this.parseAtomCondition()}parseAtomCondition(){const e=this.parseValue();if(this.current.type==="crossesAbove"||this.current.type==="crossesBelow"){const a=this.current;if(this.current=this.tokenizer.next(),e.kind!=="SeriesRef")throw new Uf("`crossesAbove/crossesBelow` left side must be a series name",a.pos);const l=this.parseValue();return{kind:"Cross",dir:a.type==="crossesAbove"?"above":"below",left:e,right:l}}if(this.current.type!=="gt"&&this.current.type!=="lt"&&this.current.type!=="gte"&&this.current.type!=="lte"&&this.current.type!=="eq"&&this.current.type!=="neq")return{kind:"Comparison",op:">",left:e,right:{kind:"NumberLiteral",value:0}};const t=this.current;let s;switch(t.type){case"gt":s=">";break;case"lt":s="<";break;case"gte":s=">=";break;case"lte":s="<=";break;case"eq":s="==";break;case"neq":s="==";break;default:s=">";break}this.current=this.tokenizer.next();const i=this.parseValue(),r={kind:"Comparison",op:s,left:e,right:i};return t.type==="neq"?{kind:"Logical",op:"or",left:{kind:"Comparison",op:">",left:e,right:i},right:{kind:"Comparison",op:"<",left:e,right:i}}:r}parseSeriesRef(){if(this.current.type!=="identifier")throw new Uf("Expected series name",this.current.pos);const e=this.current;return this.current=this.tokenizer.next(),{kind:"SeriesRef",name:e.value||""}}parseValue(){if(this.current.type==="number"){const e=this.current;this.current=this.tokenizer.next();const t=Number(e.value);if(!Number.isFinite(t))throw new Uf("Invalid number literal",e.pos);return{kind:"NumberLiteral",value:t}}if(this.current.type==="identifier"){const e=this.current;if(this.current=this.tokenizer.next(),this.current.type==="lparen"){this.eat("lparen");const t=[];if(this.current.type!=="rparen")for(;t.push(this.parseValue()),!!this.match("comma"););return this.eat("rparen"),{kind:"ValueCall",name:String(e.value||""),args:t}}return{kind:"SeriesRef",name:String(e.value||"")}}throw new Uf(`Expected number or identifier but found ${this.current.type}`,this.current.pos)}}function cm(o){return new BO(new RO(o)).parseCondition()}class sw extends Error{constructor(e){super(e),this.name="ConditionEngineError"}}function OO(o){return o.replace(/\s+/g,"_").toLowerCase()}function ju(o,e){const t=OO(e),s=o[t];if(s)return s;const i=t.replace(/_/g,"");if(i&&o[i])return o[i];if(i){const a=Object.keys(o).find(l=>l.replace(/_/g,"")===i);if(a&&o[a])return o[t]=o[a],o[t]}const r=Object.keys(o).slice(0,24).join(", ");throw new sw(`Series "${e}" not found; available series: ${r}${Object.keys(o).length>24?", ...":""}`)}function VO(o){const e=Object.entries(o);if(!e.length)return 0;const t=e[0][1].length;for(const[,s]of e)if(s.length!==t)throw new sw("All series must have the same length");return t}function Bv(o,e,t){var s,i,r,a,l,c;if(o.kind==="NumberLiteral")return o.value;if(o.kind==="SeriesRef")return ju(t,o.name)[e];if(o.kind==="ValueCall"){const d=String(o.name||"").toLowerCase(),v=o.args;if(d==="lowest"||d==="highest"){const g=v[0],_=v[1],y=ju(t,g.name||String(g)),k=Math.max(1,Math.floor(_.value??Number(_.name)??1)),S=Math.max(0,e-k+1);let M=d==="lowest"?1/0:-1/0;for(let I=S;I<=e;I++){const C=y[I];Number.isFinite(C)&&(d==="lowest"?M=Math.min(M,C):M=Math.max(M,C))}return Number.isFinite(M)?M:NaN}if(d==="lag"||d==="prev"){const g=v[0],_=v[1],y=ju(t,g.name||String(g)),k=Math.max(1,Math.floor((_==null?void 0:_.value)??Number(_==null?void 0:_.name)??1)),S=e-k;return S>=0?y[S]:NaN}if(d==="change"){const g=v[0],_=v[1],y=ju(t,g.name||String(g)),k=Math.max(1,Math.floor((_==null?void 0:_.value)??Number(_==null?void 0:_.name)??1)),S=e-k,M=y[e],I=S>=0?y[S]:NaN;return Number.isFinite(M)&&Number.isFinite(I)?M-I:NaN}if(d==="abs"){const g=Bv(v[0],e,t);return Math.abs(g)}if(d==="add"||d==="sub"||d==="mul"||d==="div"){const g=Bv(v[0],e,t),_=Bv(v[1],e,t);return[g,_].every(Number.isFinite)?d==="add"?g+_:d==="sub"?g-_:d==="mul"?g*_:_===0?NaN:g/_:NaN}if(d==="min"||d==="max"){const g=Bv(v[0],e,t),_=Bv(v[1],e,t);return[g,_].every(Number.isFinite)?d==="min"?Math.min(g,_):Math.max(g,_):NaN}if(d==="sma"){const g=((s=v[0])==null?void 0:s.name)||String(v[0]),_=((i=v[1])==null?void 0:i.value)??Number((r=v[1])==null?void 0:r.name),y=Math.max(1,Math.floor(Number(_)||0)),k=ju(t,g);if(!Number.isFinite(k[e]))return NaN;let S=0,M=0;const I=Math.max(0,e-y+1);for(let C=I;C<=e;C++){const T=k[C];Number.isFinite(T)&&(S+=T,M++)}return M?S/M:NaN}if(d==="ema"){const g=((a=v[0])==null?void 0:a.name)||String(v[0]),_=((l=v[1])==null?void 0:l.value)??Number((c=v[1])==null?void 0:c.name),y=Math.max(1,Math.floor(Number(_)||0)),k=ju(t,g),S=2/(y+1);let M;for(let I=0;I<=e;I++){const C=k[I];Number.isFinite(C)&&(M===void 0?M=C:M=C*S+M*(1-S))}return M??NaN}return NaN}return NaN}function WO(o,e,t){const s=Bv(o.left,e,t),i=Bv(o.right,e,t);if(!Number.isFinite(s)||!Number.isFinite(i))return!1;switch(o.op){case">":return s>i;case"<":return s<i;case">=":return s>=i;case"<=":return s<=i;case"==":return Math.abs(s-i)<1e-9;default:return!1}}function qO(o,e,t){if(e===0)return!1;const s=ju(t,o.left.name);let i,r;if(o.right.kind==="NumberLiteral")i=o.right.value,r=o.right.value;else{const c=ju(t,o.right.name);i=c[e-1],r=c[e]}const a=s[e-1],l=s[e];return!Number.isFinite(a)||!Number.isFinite(i)||!Number.isFinite(l)||!Number.isFinite(r)?!1:o.dir==="above"?a<=i&&l>r:a>=i&&l<r}function HO(o,e,t){return o.op==="and"?Lm(o.left,e,t)&&Lm(o.right,e,t):Lm(o.left,e,t)||Lm(o.right,e,t)}function GO(o,e,t){let s=-1/0;for(let i=e;i<=t;i++){const r=o[i];Number.isFinite(r)&&r>s&&(s=r)}return s}function UO(o,e,t){let s=1/0;for(let i=e;i<=t;i++){const r=o[i];Number.isFinite(r)&&r<s&&(s=r)}return s}function im(o,e=1){if(!o)return e;if(o.kind==="NumberLiteral")return Number(o.value)||e;const t=o.name?String(o.name):"",s=Number(t);return Number.isFinite(s)?s:e}function YO(o,e,t,s){var l,c;const i=o.toLowerCase(),r=d=>Bv(d,t,s),a=d=>{const v=d?r(d):NaN;return Number.isFinite(v)?Math.max(0,v):0};if(i==="higherhigh"){const d=Math.max(1,Math.floor(im(e[0],1))),v=ju(s,"high"),g=Math.max(0,t-d),_=GO(v,g,Math.max(0,t-1));return Number.isFinite(v[t])&&v[t]>_}if(i==="lowerlow"){const d=Math.max(1,Math.floor(im(e[0],1))),v=ju(s,"low"),g=Math.max(0,t-d),_=UO(v,g,Math.max(0,t-1));return Number.isFinite(v[t])&&v[t]<_}if(i==="swinghigh"){const d=Math.max(1,Math.floor(im(e[0],3))),v=ju(s,"high"),g=v[t];if(!Number.isFinite(g))return!1;for(let _=t-d;_<=t+d;_++){if(_===t)continue;const y=v[_];if(Number.isFinite(y)&&y>=g)return!1}return!0}if(i==="swinglow"){const d=Math.max(1,Math.floor(im(e[0],3))),v=ju(s,"low"),g=v[t];if(!Number.isFinite(g))return!1;for(let _=t-d;_<=t+d;_++){if(_===t)continue;const y=v[_];if(Number.isFinite(y)&&y<=g)return!1}return!0}if(i==="volspike"){const d=Math.max(1,im(e[0],1)),v=ju(s,"volume"),_=Math.max(0,t-20+1),y=(()=>{let k=0,S=0;for(let M=_;M<=t;M++){const I=v[M];Number.isFinite(I)&&(k+=I,S++)}return S?k/S:NaN})();return Number.isFinite(v[t])&&Number.isFinite(y)&&v[t]>d*y}if(i==="atrspike"){const d=Math.max(1,im(e[0],1)),v=ju(s,"high"),g=ju(s,"low"),_=ju(s,"close"),y=14,k=z=>{const j=v[z],B=g[z],$=_[z-1];let F=Math.max(0,j-B);return Number.isFinite($)&&(F=Math.max(F,Math.abs(j-$),Math.abs(B-$))),F};let S=NaN,M=0;for(let z=0;z<=t;z++){const j=k(z);M+=j,z===y-1?S=M/y:z>=y&&(S=(S*(y-1)+j)/y)}let I=NaN,C=0,T=0;for(let z=Math.max(0,t-y+1);z<=t;z++){const j=k(z);C+=j,T++}return I=T?C/T:NaN,Number.isFinite(S)&&Number.isFinite(I)&&S>d*I}if(i==="trend"){const d=String(((l=e[0])==null?void 0:l.name)||"").toLowerCase()||"up",v=ju(s,"close"),_=Math.max(0,t-10+1),y=(()=>{let k=0,S=0,M=0,I=0,C=0;for(let z=_;z<=t;z++){const j=z-_,B=v[z];Number.isFinite(B)&&(k+=j,S+=B,M+=j*j,I+=j*B,C++)}const T=C*M-k*k;return T===0||C===0?0:(C*I-k*S)/T})();return d==="up"?y>0:y<0}if(i==="crossover"||i==="crossunder"){const d=e[0],v=e[1],g=a(e[2]),_=ju(s,d.name||String(d));let y,k;if(v.kind==="NumberLiteral")y=v.value,k=v.value;else{const I=ju(s,v.name||String(v));y=I[t-1],k=I[t]}const S=_[t-1],M=_[t];return[S,M,y,k].every(Number.isFinite)?i==="crossover"?S<=y+g&&M>k+g:S>=y-g&&M<k-g:!1}if(i==="rising"||i==="falling"){const d=ju(s,((c=e[0])==null?void 0:c.name)||String(e[0])),v=Math.max(1,Math.floor(im(e[1],3))),g=Math.max(0,t-v+1);let _=0,y=0,k=0,S=0,M=0;for(let T=g;T<=t;T++){const z=T-g,j=d[T];Number.isFinite(j)&&(_+=z,y+=j,k+=z*z,S+=z*j,M++)}const I=M*k-_*_,C=I===0||M===0?0:(M*S-_*y)/I;return i==="rising"?C>0:C<0}if(i==="above"||i==="below"){const d=r(e[0]),v=r(e[1]),g=a(e[2]);return!Number.isFinite(d)||!Number.isFinite(v)?!1:i==="above"?d>v+g:d<v-g}return!1}function Lm(o,e,t){switch(o.kind){case"Comparison":return WO(o,e,t);case"Cross":return qO(o,e,t);case"Logical":return HO(o,e,t);case"Negation":return!Lm(o.expr,e,t);case"Between":{const s=o,i=Bv(s.value,e,t),r=Bv(s.a,e,t),a=Bv(s.b,e,t);if(![i,r,a].every(Number.isFinite))return!1;const l=Math.min(r,a),c=Math.max(r,a);return i>=l&&i<=c}case"Call":{const s=o;return YO(String(s.name||""),s.args||[],e,t)}default:return!1}}function h2(o,e){const t=VO(e),s=new Uint8Array(t);for(let i=0;i<t;i++)s[i]=Lm(o,i,e)?1:0;return s}const _2=["sma","smma","ema","wma","rsi","bbands","bollinger","bollinger_bands","atr","obv","cci","mfi","ao","trix","vwap","vwma","zscore","evwma","roc","macd","supertrend","kc","keltner","donchian","atr_bands","vwap_bands","linreg_channel","sar","stoch","ichimoku","pivot_high","pivot_low","auto_fib","autofib","last_value","prev_value","line_value","security","expr","formula"],y2=["line","histogram","area","dots","stepped","bar","neon_line","bezier_line","glow_points","heatmap","distortion","cloud","aura","candleshadow","supertrend_cloud","fractal_boxes","liquidity_tiles"],b2=["arrowUp","arrowDown","circle","square","triangle_up_filled","triangle_down_filled","box","label","text","emoji","triangle_up_gradient","arrow_up_glow","pill","tag","flag"];function fl(o){return Array.isArray(o)?o:[]}function Ed(o){return typeof o=="string"?o:void 0}function lu(o){return typeof o=="number"&&Number.isFinite(o)?o:void 0}function _1(o){const e=[];if(!o||typeof o!="object")return e.push("Script must be an object"),{ok:!1,errors:e};const t=o,s=!!(t!=null&&t.strategy)||fl(t==null?void 0:t.signals).length>0,i=fl(t.calc),r=fl(t.series),a=fl(t.stateSeries),l=[];if(Array.isArray(t.panes)&&t.panes.length)for(const d of t.panes){const v=d.pane==="sub"?"sub":"main";l.push({pane:v,plots:fl(d.plots),levels:fl(d.levels),labels:fl(d.labels),lines:fl(d.lines),runtimeDrawOps:fl(d.runtimeDrawOps),runtimeLabels:fl(d.runtimeLabels),runtimeLines:fl(d.runtimeLines),runtimeBoxes:fl(d.runtimeBoxes),runtimeTables:fl(d.runtimeTables),overlays:fl(d.overlays),min:lu(d.min),max:lu(d.max),shortName:Ed(d.shortName),fills:fl(d.fills),backgroundZones:fl(d.backgroundZones),height:lu(d.height)})}else if(t.main||t.sub)t.main&&l.push({pane:"main",plots:fl(t.main.plots),levels:fl(t.main.levels),labels:fl(t.main.labels),lines:fl(t.main.lines),runtimeDrawOps:fl(t.main.runtimeDrawOps),runtimeLabels:fl(t.main.runtimeLabels),runtimeLines:fl(t.main.runtimeLines),runtimeBoxes:fl(t.main.runtimeBoxes),runtimeTables:fl(t.main.runtimeTables),overlays:fl(t.main.overlays),min:lu(t.main.min),max:lu(t.main.max),shortName:Ed(t.main.shortName||t.shortName),fills:fl(t.main.fills),backgroundZones:fl(t.main.backgroundZones),height:lu(t.main.height)}),t.sub&&l.push({pane:"sub",plots:fl(t.sub.plots),levels:fl(t.sub.levels),labels:fl(t.sub.labels),lines:fl(t.sub.lines),runtimeDrawOps:fl(t.sub.runtimeDrawOps),runtimeLabels:fl(t.sub.runtimeLabels),runtimeLines:fl(t.sub.runtimeLines),runtimeBoxes:fl(t.sub.runtimeBoxes),runtimeTables:fl(t.sub.runtimeTables),overlays:fl(t.sub.overlays),min:lu(t.sub.min),max:lu(t.sub.max),shortName:Ed(t.sub.shortName||t.shortName),fills:fl(t.sub.fills),backgroundZones:fl(t.sub.backgroundZones),height:lu(t.sub.height)});else if(t.pane||t.plots||t.labels||t.levels||t.lines){const d=t.pane==="sub"?"sub":"main";l.push({pane:d,plots:fl(t.plots),levels:fl(t.levels),labels:fl(t.labels),lines:fl(t.lines),runtimeDrawOps:fl(t.runtimeDrawOps),runtimeLabels:fl(t.runtimeLabels),runtimeLines:fl(t.runtimeLines),runtimeBoxes:fl(t.runtimeBoxes),runtimeTables:fl(t.runtimeTables),overlays:fl(t.overlays),min:lu(t.min),max:lu(t.max),shortName:Ed(t.shortName),fills:[],backgroundZones:[],height:void 0})}l.length||(s?l.push({pane:"main",plots:[],levels:[],labels:[],lines:[],runtimeDrawOps:[],runtimeLabels:[],runtimeLines:[],runtimeBoxes:[],runtimeTables:[],overlays:[],min:lu(t.min),max:lu(t.max),shortName:Ed(t.shortName),fills:[],backgroundZones:[],height:void 0}):e.push("No panes defined"));const c={calc:i.map((d,v)=>({name:Ed(d.name)||Ed(d.type)||`calc_${v}`,type:Ed(d.type)||Ed(d.name),source:Ed(d.source),period:lu(d.period),fast:lu(d.fast),slow:lu(d.slow),signal:lu(d.signal),kPeriod:lu(d.kPeriod),dPeriod:lu(d.dPeriod),left:lu(d.left),right:lu(d.right),tenkan:lu(d.tenkan),kijun:lu(d.kijun),senkouB:lu(d.senkouB),expr:Ed(d.expr),timeframe:Ed(d.timeframe),symbol:Ed(d.symbol),country:Ed(d.country),lookahead:Ed(d.lookahead),gaps:Ed(d.gaps),params:d.params,style:d.style})),series:r.map((d,v)=>({name:Ed(d.name)||`series_${v}`,expr:Ed(d.expr)||""})),stateSeries:a.map((d,v)=>({name:Ed(d.name)||`state_${v}`,initExpr:Ed(d.initExpr),updateExpr:Ed(d.updateExpr)||"",selfMode:d.selfMode||void 0})),panes:l,signals:fl(t.signals).map(d=>{const v=d==null?void 0:d.order,g=Ed(d==null?void 0:d.title),_=Ed(d==null?void 0:d.message),y=Ed(v==null?void 0:v.kind),k=y?y.trim().toLowerCase().replace(/stop\s*limit|stoplimit/g,"stop_limit"):void 0,S=oe=>{if(typeof oe=="number"&&Number.isFinite(oe)||typeof oe=="string")return oe},M=oe=>{if(typeof oe=="number"&&Number.isFinite(oe)||typeof oe=="string")return oe},I=S(v==null?void 0:v.price),C=S((v==null?void 0:v.stopPrice)??(v==null?void 0:v.stop)??(v==null?void 0:v.trigger)),T=S((v==null?void 0:v.limitPrice)??(v==null?void 0:v.limit)??(v==null?void 0:v.lmt)),z=M(v==null?void 0:v.qty),j=M(v==null?void 0:v.cash),B=typeof(v==null?void 0:v.qtyPct)=="number"&&Number.isFinite(v.qtyPct)?v.qtyPct:void 0,$=typeof B=="number"?Math.max(0,Math.min(100,B)):void 0,F=Ed(v==null?void 0:v.oco),V=typeof(v==null?void 0:v.expiresBars)=="number"&&Number.isFinite(v.expiresBars)?v.expiresBars:void 0,K=typeof V=="number"?Math.max(0,Math.floor(V)):void 0,Y=v==null?void 0:v.bracket,Z=(()=>{if(!Y||typeof Y!="object")return;const oe=Y,U=typeof oe.stopLossPct=="number"&&Number.isFinite(oe.stopLossPct)?Math.max(0,oe.stopLossPct):void 0,J=typeof oe.takeProfitPct=="number"&&Number.isFinite(oe.takeProfitPct)?Math.max(0,oe.takeProfitPct):void 0,se=typeof oe.trailingStopPct=="number"&&Number.isFinite(oe.trailingStopPct)?Math.max(0,oe.trailingStopPct):void 0,W=[],le=Array.isArray(oe.takeProfits)?oe.takeProfits:[];for(const ye of le){if(!ye||typeof ye!="object")continue;const Ce=typeof ye.takeProfitPct=="number"?ye.takeProfitPct:Number(ye.takeProfitPct),Re=typeof ye.qtyPct=="number"?ye.qtyPct:Number(ye.qtyPct);!Number.isFinite(Ce)||Ce<=0||!Number.isFinite(Re)||Re<=0||W.push({takeProfitPct:Math.max(0,Ce),qtyPct:Math.max(0,Math.min(100,Re))})}if(W.sort((ye,Ce)=>ye.takeProfitPct-Ce.takeProfitPct),!(U==null&&J==null&&se==null&&W.length===0))return{stopLossPct:U,takeProfitPct:J,trailingStopPct:se,takeProfits:W.length?W:void 0}})(),ne=typeof(d==null?void 0:d.cooldownBars)=="number"&&Number.isFinite(d.cooldownBars)?d.cooldownBars:void 0,te=typeof ne=="number"?Math.max(0,Math.floor(ne)):void 0;return{type:String((d==null?void 0:d.type)||""),when:String((d==null?void 0:d.when)||""),id:Ed(d==null?void 0:d.id),orderId:Ed(d==null?void 0:d.orderId),title:g,message:_,order:k||I!=null||C!=null||T!=null||z!=null||j!=null||$!=null||F!=null||K!=null||Z!=null?{kind:k,price:I,stopPrice:C,limitPrice:T,qty:z,cash:j,qtyPct:$,oco:F,expiresBars:K,bracket:Z}:void 0,cooldownBars:te}}),shortName:Ed(t.shortName),strategy:t.strategy,params:t.params,style:t.style};return c.series.forEach((d,v)=>{d.name||e.push(`series[${v}] missing name`)}),c.stateSeries.forEach((d,v)=>{d.name||e.push(`stateSeries[${v}] missing name`),d.updateExpr||e.push(`stateSeries[${v}] missing updateExpr`)}),c.panes.forEach((d,v)=>{var g,_,y,k;!s&&!((g=d.plots)!=null&&g.length)&&!((_=d.labels)!=null&&_.length)&&!((y=d.levels)!=null&&y.length)&&!((k=d.lines)!=null&&k.length)&&e.push(`pane[${v}] has no plots/labels/levels/lines`)}),{ok:e.length===0,spec:c,errors:e}}function y1(o,e){const t=i=>i.replace(/\$\{([^}]+)\}/g,(r,a)=>{const l=String(a),c=e[l];if(c==null)return r;if(typeof c=="number"&&Number.isFinite(c))return String(c);if(typeof c=="string")return c;try{return JSON.stringify(c)}catch{return String(c)}}),s=i=>{if(i==null)return i;if(typeof i=="string"){const r=i.match(/^\$\{([^}]+)\}$/);if(r){const a=String(r[1]),l=e[a];return l??i}return t(i)}if(Array.isArray(i))return i.map(s);if(typeof i=="object"){const r=Array.isArray(i)?[]:{};return Object.keys(i).forEach(a=>{const l=i[a];r[a]=s(l)}),r}return i};return s(o)}function Eh(o,e,t){if(o.save(),e&&(o.beginPath(),o.rect(e.left,e.top,e.width,e.height),o.clip()),t)try{t()}finally{o.restore()}}function x2(o,e,t,s,i){if(!e.length)return;const r=Math.max(1,s/2);Eh(o,i,()=>{o.save(),o.fillStyle=t;for(let a=0;a<e.length;a++){const{x:l,y:c}=e[a];!Number.isFinite(l)||!Number.isFinite(c)||(o.beginPath(),o.arc(l,c,r,0,Math.PI*2),o.fill())}o.restore()})}function KO(o,e,t,s,i,r,a){e.length&&Eh(o,a,()=>{o.beginPath();let l=!1;for(let v=0;v<e.length;v++){const g=e[v];!Number.isFinite(g.x)||!Number.isFinite(g.y)||(l?o.lineTo(g.x,g.y):(o.moveTo(g.x,g.y),l=!0))}if(!l)return;const c=e[e.length-1],d=e.find(v=>Number.isFinite(v.x)&&Number.isFinite(v.y));o.lineTo(c.x,t),o.lineTo(d.x,t),o.closePath(),o.save(),o.fillStyle=s,o.fill(),o.restore(),i&&r>0})}function ZO(o,e,t,s,i){e.length&&Eh(o,i,()=>{o.beginPath();let r=!1;for(let a=0;a<e.length-1;a++){const l=e[a],c=e[a+1];!Number.isFinite(l.x)||!Number.isFinite(l.y)||!Number.isFinite(c.x)||!Number.isFinite(c.y)||(r||(o.moveTo(l.x,l.y),r=!0),o.lineTo(c.x,l.y),o.lineTo(c.x,c.y))}r&&(o.strokeStyle=t,o.lineWidth=s,o.setLineDash([]),o.stroke())})}function U_(o,e,t,s,i){!e.length||!t.length||Eh(o,i,()=>{var a,l;o.beginPath();let r=0;for(;r<e.length&&!(Number.isFinite((a=e[r])==null?void 0:a.x)&&Number.isFinite((l=e[r])==null?void 0:l.y));)r++;if(!(r>=e.length)){for(o.moveTo(e[r].x,e[r].y);r<e.length;r++){const c=e[r];!Number.isFinite(c==null?void 0:c.x)||!Number.isFinite(c==null?void 0:c.y)||o.lineTo(c.x,c.y)}for(let c=t.length-1;c>=0;c--){const d=t[c];!Number.isFinite(d==null?void 0:d.x)||!Number.isFinite(d==null?void 0:d.y)||o.lineTo(d.x,d.y)}o.closePath(),o.save(),o.fillStyle=s,o.fill(),o.restore()}})}class nw{constructor(e){ve(this,"storage");ve(this,"runtime",null);ve(this,"events",{});ve(this,"state");ve(this,"symbolChangeCallbacks",new Set);ve(this,"currentSymbol",null);this.storage=e||UF,this.state=op({activeSaveId:null,savedLayouts:[],isLoading:!1,lastError:null,initialized:!1}),this.initialize()}async initialize(){try{this.updateState({isLoading:!0});const[e,t]=await Promise.all([this.storage.getActiveSaveId(),this.storage.listSavedLayouts()]);this.updateState({activeSaveId:e,savedLayouts:t,isLoading:!1,lastError:null})}catch(e){console.error("Failed to initialize SaveManager:",e),this.updateState({isLoading:!1,lastError:"Failed to initialize save system"})}}setRuntimeContracts(e){this.runtime=e,this.runtime.onSymbolChange(this.handleSymbolChange.bind(this)),this.currentSymbol=this.runtime.getCurrentSymbol(),this.updateState({initialized:!0}),console.log("✅ SaveManager fully initialized and ready")}setEventHandlers(e){this.events={...this.events,...e}}async handleSymbolChange(e){this.currentSymbol,this.currentSymbol=e;const t=this.getState();if(t.activeSaveId&&this.runtime)try{const s=await this.storage.getSavedLayout(t.activeSaveId);if(s){this.runtime.clearAllDrawings();const i=s.drawingsBySymbol[e]||[];this.runtime.renderDrawings(i)}}catch(s){console.error("Failed to reload drawings for symbol change:",s)}this.symbolChangeCallbacks.forEach(s=>{try{s(e)}catch(i){console.error("Symbol change callback error:",i)}})}onSymbolChange(e){this.symbolChangeCallbacks.add(e)}offSymbolChange(e){this.symbolChangeCallbacks.delete(e)}updateState(e){this.state.update(t=>({...t,...e}))}getState(){let e;return this.state.subscribe(t=>e=t)(),e}validateSaveName(e,t){return!e||e.trim().length===0?{valid:!1,error:"Name is required"}:e.length>100?{valid:!1,error:"Name must be 100 characters or less"}:this.getState().savedLayouts.some(r=>r.name===e&&r.id!==t)?{valid:!1,error:"Name already exists"}:{valid:!0}}async collectCurrentState(){if(!this.runtime)throw new Error("Runtime contracts not set");try{const e=this.runtime.getCurrentSymbol(),t=this.runtime.collectGlobalState(),s=this.runtime.collectDrawings(e);return{global:t,drawings:s,symbol:e}}catch(e){return console.error("Failed to collect chart state:",e),null}}async save(e){var t,s,i,r;try{this.updateState({isLoading:!0,lastError:null});const a=this.validateSaveName(e);if(!a.valid)return this.updateState({isLoading:!1,lastError:a.error}),{success:!1,error:a.error};const l=await this.collectCurrentState();if(!l)return this.updateState({isLoading:!1,lastError:"Failed to collect chart state"}),{success:!1,error:"Failed to collect chart state"};const c={name:e,timezone:l.global.timezone,interval:l.global.interval,chartType:l.global.chartType,theme:l.global.theme,panes:l.global.panes,indicators:l.global.indicators,styles:l.global.styles,options:l.global.options,drawingsBySymbol:{[l.symbol]:l.drawings}},d=await this.storage.createSavedLayout(c);await this.storage.setActiveSaveId(d.id);const v=await this.storage.listSavedLayouts();return this.updateState({activeSaveId:d.id,savedLayouts:v,isLoading:!1}),(s=(t=this.events).onSaved)==null||s.call(t,d),{success:!0,layout:d}}catch(a){console.error("Save failed:",a);const l=a instanceof Error?a.message:"Save failed";return this.updateState({isLoading:!1,lastError:l}),(r=(i=this.events).onError)==null||r.call(i,l),{success:!1,error:l}}}async quickSave(){var t,s,i,r;const e=this.getState();if(!e.activeSaveId)return this.updateState({isLoading:!1,lastError:"No active save to update"}),{success:!1,error:"No active save to update"};try{this.updateState({isLoading:!0,lastError:null});const a=await this.storage.getSavedLayout(e.activeSaveId);if(!a)return this.updateState({isLoading:!1,lastError:"Active save not found"}),{success:!1,error:"Active save not found"};const l=await this.collectCurrentState();if(!l)return this.updateState({isLoading:!1,lastError:"Failed to collect chart state"}),{success:!1,error:"Failed to collect chart state"};const c={timezone:l.global.timezone,interval:l.global.interval,chartType:l.global.chartType,theme:l.global.theme,panes:l.global.panes,indicators:l.global.indicators,styles:l.global.styles,options:l.global.options,drawingsBySymbol:{...a.drawingsBySymbol,[l.symbol]:l.drawings}},d=await this.storage.updateSavedLayout(e.activeSaveId,c),v=await this.storage.listSavedLayouts();return this.updateState({savedLayouts:v,isLoading:!1}),(s=(t=this.events).onSaved)==null||s.call(t,d),{success:!0,layout:d}}catch(a){console.error("Quick save failed:",a);const l=a instanceof Error?a.message:"Quick save failed";return this.updateState({isLoading:!1,lastError:l}),(r=(i=this.events).onError)==null||r.call(i,l),{success:!1,error:l}}}async saveTo(e){var t,s,i,r,a,l;try{this.updateState({isLoading:!0,lastError:null});const c=await this.collectCurrentState();if(!c)return this.updateState({isLoading:!1,lastError:"Failed to collect chart state"}),{success:!1,error:"Failed to collect chart state"};const d=await this.storage.getSavedLayout(e),v={timezone:c.global.timezone,interval:c.global.interval,chartType:c.global.chartType,theme:c.global.theme,panes:c.global.panes,indicators:c.global.indicators,styles:c.global.styles,options:c.global.options,drawingsBySymbol:d?{...d.drawingsBySymbol,[c.symbol]:c.drawings}:{[c.symbol]:c.drawings}};if(!d){console.log("📝 Layout not found locally, creating new layout via API");const y={name:`Layout ${new Date().toLocaleString()}`,...v},k=await this.storage.createSavedLayout(y);await this.storage.setActiveSaveId(k.id);const S=await this.storage.listSavedLayouts();return this.updateState({activeSaveId:k.id,savedLayouts:S,isLoading:!1}),(s=(t=this.events).onSaved)==null||s.call(t,k),{success:!0,layout:k}}const g=await this.storage.updateSavedLayout(e,v);await this.storage.setActiveSaveId(e);const _=await this.storage.listSavedLayouts();return this.updateState({activeSaveId:e,savedLayouts:_,isLoading:!1}),(r=(i=this.events).onSaved)==null||r.call(i,g),{success:!0,layout:g}}catch(c){console.error("Save to existing failed:",c);const d=c instanceof Error?c.message:"Save failed";return this.updateState({isLoading:!1,lastError:d}),(l=(a=this.events).onError)==null||l.call(a,d),{success:!1,error:d}}}async saveAs(e){return this.save(e)}async load(e){var t,s,i,r,a,l,c,d,v,g,_,y;try{this.updateState({isLoading:!0,lastError:null}),console.log("🔄 Loading layout:",e);const k=await this.storage.getSavedLayout(e);if(!k)try{await this.refresh();const I=await this.storage.getSavedLayout(e);if(!I){const j=await this.storage.listSavedLayouts();if(j&&j.length>0){const B=j[0].id,$=await this.storage.getSavedLayout(B);if($){if(!this.runtime)return this.updateState({isLoading:!1,lastError:"Runtime contracts not set"}),{success:!1,error:"Runtime contracts not set"};await this.runtime.applyGlobalState({timezone:$.timezone,interval:$.interval,chartType:$.chartType,theme:$.theme,panes:$.panes,indicators:$.indicators,styles:$.styles,options:$.options});const F=this.runtime.getCurrentSymbol();this.runtime.clearAllDrawings();const V=$.drawingsBySymbol[F]||[];return this.runtime.renderDrawings(V),await this.storage.setActiveSaveId($.id),this.updateState({activeSaveId:$.id,isLoading:!1}),(s=(t=this.events).onLoaded)==null||s.call(t,$),{success:!0}}}return await this.storage.setActiveSaveId(null),this.updateState({isLoading:!1,lastError:"Layout not found"}),{success:!1,error:"Layout not found"}}const C=I;if(!this.runtime)return this.updateState({isLoading:!1,lastError:"Runtime contracts not set"}),{success:!1,error:"Runtime contracts not set"};await this.runtime.applyGlobalState({timezone:C.timezone,interval:C.interval,chartType:C.chartType,theme:C.theme,panes:C.panes,indicators:C.indicators,styles:C.styles,options:C.options});const T=this.runtime.getCurrentSymbol();this.runtime.clearAllDrawings();const z=C.drawingsBySymbol[T]||[];return this.runtime.renderDrawings(z),await this.storage.setActiveSaveId(C.id),this.updateState({activeSaveId:C.id,isLoading:!1}),(r=(i=this.events).onLoaded)==null||r.call(i,C),{success:!0}}catch{return await this.storage.setActiveSaveId(null),this.updateState({isLoading:!1,lastError:"Layout not found"}),{success:!1,error:"Layout not found"}}if(console.log("📊 Layout data loaded:",{name:k.name,indicatorCount:((a=k.indicators)==null?void 0:a.length)||0,indicators:((l=k.indicators)==null?void 0:l.map(I=>I.type))||[]}),!this.runtime)return console.error("❌ Runtime contracts not set"),this.updateState({isLoading:!1,lastError:"Runtime contracts not set"}),{success:!1,error:"Runtime contracts not set"};console.log("🔧 Applying global state with indicators:",((c=k.indicators)==null?void 0:c.length)||0),await this.runtime.applyGlobalState({timezone:k.timezone,interval:k.interval,chartType:k.chartType,theme:k.theme,panes:k.panes,indicators:k.indicators,styles:k.styles,options:k.options});const S=this.runtime.getCurrentSymbol();this.runtime.clearAllDrawings();const M=k.drawingsBySymbol[S]||[];return this.runtime.renderDrawings(M),await this.storage.setActiveSaveId(k.id),this.updateState({activeSaveId:k.id,isLoading:!1}),(v=(d=this.events).onLoaded)==null||v.call(d,k),console.log("✅ Layout loaded successfully:",{layoutId:k.id,name:k.name,indicatorsRestored:((g=k.indicators)==null?void 0:g.length)||0}),{success:!0}}catch(k){console.error("Load failed:",k);const S=k instanceof Error?k.message:"Load failed";return this.updateState({isLoading:!1,lastError:S}),(y=(_=this.events).onError)==null||y.call(_,S),{success:!1,error:S}}}async delete(e){var t,s,i,r;try{this.updateState({isLoading:!0,lastError:null}),await this.storage.deleteSavedLayout(e);const[a,l]=await Promise.all([this.storage.getActiveSaveId(),this.storage.listSavedLayouts()]);return this.updateState({activeSaveId:a,savedLayouts:l,isLoading:!1}),(s=(t=this.events).onDeleted)==null||s.call(t,e),{success:!0}}catch(a){console.error("Delete failed:",a);const l=a instanceof Error?a.message:"Delete failed";return this.updateState({isLoading:!1,lastError:l}),(r=(i=this.events).onError)==null||r.call(i,l),{success:!1,error:l}}}hasActiveSave(){return this.getState().activeSaveId!==null}getActiveSaveId(){return this.getState().activeSaveId}async clearActiveSave(){await this.storage.setActiveSaveId(null),this.updateState({activeSaveId:null})}async refresh(){try{this.updateState({isLoading:!0});const e=await this.storage.listSavedLayouts();this.updateState({savedLayouts:e,isLoading:!1,lastError:null})}catch(e){console.error("Refresh failed:",e),this.updateState({isLoading:!1,lastError:"Failed to refresh layouts"})}}destroy(){this.runtime&&this.symbolChangeCallbacks.clear()}}new nw;const Y_="https://noti.dutyai.app/auth/chart/settings";class XO{constructor(){ve(this,"localStorageProvider");ve(this,"initialized",!1);this.localStorageProvider=new Jx}async initialize(){this.initialized||(await this.localStorageProvider.initialize(),this.initialized=!0)}hasUserId(){return typeof window<"u"&&!!localStorage.getItem("userId")}getUserId(){return typeof window<"u"?localStorage.getItem("userId"):null}async saveToApi(e){const t=this.getUserId();if(!t)throw new Error("User ID not found in localStorage");if(e._source==="api"&&!e._isModified)return console.log("🔄 Skipping API save for unmodified API-loaded data"),{...e,_source:"api"};try{console.log(e,"layoutData");const s=e.id||this.generateApiId(),i={clerkId:t,settings:e,id:s};console.log("🌐 Sending to API:",i);const r=await fetch(Y_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!r.ok){const l=await r.text();throw console.error("API error response:",l),new Error(`API request failed: ${r.status} ${r.statusText} - ${l}`)}const a=await r.json();return console.log("✅ API save successful:",a),{...e,id:a.id||s,createdAt:a.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}catch(s){throw console.error("API save failed:",s),new Error("Failed to save to API")}}generateApiId(){return`api_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async loadFromApi(){var t;const e=this.getUserId();if(!e)throw new Error("User ID not found in localStorage");try{const s=`${Y_}/${e}`;console.log("🌐 API Request:",s);const i=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log("🌐 API Response Status:",i.status,i.statusText),!i.ok)throw new Error(`API request failed: ${i.status} ${i.statusText}`);const r=await i.json();return console.log("🌐 API Response Data:",r),Array.isArray(r)?r.map(a=>{var l;return{id:a.id,name:((l=a.settings)==null?void 0:l.name)||"Untitled Layout",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...a.settings,_source:"api"}}):[{id:r.id,name:((t=r.settings)==null?void 0:t.name)||"Untitled Layout",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...r.settings,_source:"api"}]}catch(s){throw console.error("API load failed:",s),new Error("Failed to load from API")}}async deleteFromApi(e){if(!this.getUserId())throw new Error("User ID not found in localStorage");try{const s=`${Y_}/${e}`;console.log("🌐 API Delete Request:",s);const i=await fetch(s,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(console.log("🌐 API Delete Response Status:",i.status,i.statusText),!i.ok)throw new Error(`API delete request failed: ${i.status} ${i.statusText}`);console.log("✅ Layout deleted successfully from API")}catch(s){throw console.error("API delete failed:",s),new Error("Failed to delete from API")}}async listSavedLayouts(){if(await this.initialize(),this.hasUserId())try{return console.log("🌐 Loading layouts from API (userId found)"),(await this.loadFromApi()).map(t=>({id:t.id,name:t.name||"Untitled Layout",createdAt:t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt||new Date().toISOString()}))}catch(e){console.error("API load failed, falling back to localStorage:",e)}return console.log("💾 Loading layouts from localStorage (no userId or API failed)"),this.localStorageProvider.listSavedLayouts()}async getSavedLayout(e){if(await this.initialize(),this.hasUserId())try{console.log("🌐 Loading specific layout from API");const s=(await this.loadFromApi()).find(i=>i.id===e);if(s)return s;console.log("📖 Layout not found in API response, falling back to localStorage")}catch(t){console.error("API load failed, falling back to localStorage:",t)}return this.localStorageProvider.getSavedLayout(e)}async createSavedLayout(e){if(await this.initialize(),this.hasUserId())try{return console.log("🌐 Saving to API (userId found)"),await this.saveToApi(e)}catch(t){console.error("API save failed, falling back to localStorage:",t)}return console.log("💾 Saving to localStorage (no userId or API failed)"),this.localStorageProvider.createSavedLayout(e)}async updateSavedLayout(e,t){if(await this.initialize(),this.hasUserId())try{console.log("🌐 Updating via API (userId found)");try{const a=(await this.loadFromApi()).find(l=>l.id===e);if(a){console.log("📝 Layout found in API, updating via API");const l={...a,...t,_isModified:!0};return await this.saveToApi(l)}}catch(r){console.log("📖 Layout not found in API, checking localStorage:",r)}const s=await this.localStorageProvider.getSavedLayout(e);if(s){console.log("📝 Layout found in localStorage, updating via API");const r={...s,...t};return await this.saveToApi(r)}console.log("📝 Layout not found, creating new via API");const i={id:e,...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),_isModified:!0};return await this.saveToApi(i)}catch(s){console.error("API update failed, falling back to localStorage:",s)}return console.log("💾 Updating in localStorage"),this.localStorageProvider.updateSavedLayout(e,t)}async deleteSavedLayout(e){if(await this.initialize(),this.hasUserId())try{console.log("🌐 Deleting layout from API"),await this.deleteFromApi(e),console.log("✅ Layout deleted from API successfully");return}catch(t){console.error("API delete failed, falling back to localStorage:",t)}return console.log("💾 Deleting from localStorage"),this.localStorageProvider.deleteSavedLayout(e)}async getActiveSaveId(){return await this.initialize(),this.localStorageProvider.getActiveSaveId()}async setActiveSaveId(e){return await this.initialize(),this.localStorageProvider.setActiveSaveId(e)}async cleanup(){return await this.initialize(),this.localStorageProvider.cleanup()}}function JO(o,e){Mc(e,!1);const t=Au(),s=()=>ua(r,"$save",t),i=()=>ua(a,"$chart",t),r=vc("save");vc("ctx");const a=vc("chart"),l=vc("drawingManager"),c=(()=>{try{return vc("saveRestoring")||null}catch{return null}})(),d=new XO,v=new nw(d);let g=null,_=null;function y(){try{console.log("🧹 Clearing persisted chart cache to prevent showing unsaved changes...");const M=s(),I=M!=null&&M.key&&typeof M.key=="string"?M.key:"chart";if(typeof localStorage<"u"){const C=localStorage.getItem(I);if(C)try{const j=JSON.parse(C),B={key:j.key||I,theme:j.theme||"dark",symbol:j.symbol||"BINANCE:BTCUSDT",period:j.period||{timeframe:"1d",timespan:"day"}};localStorage.setItem(I,JSON.stringify(B)),console.log("✅ Cleared unsaved chart changes, kept basic settings")}catch(j){console.warn("⚠️ Could not parse stored chart, clearing completely:",j),localStorage.removeItem(I)}const T=`${I}_drawings`,z=`${I}_overlays`;localStorage.removeItem(T),localStorage.removeItem(z),localStorage.removeItem("dataSpaceOverlays"),console.log("✅ Persisted chart cache cleared successfully")}try{r.update(C=>{var j,B,$,F;const T=((B=(j=C.styles)==null?void 0:j.candle)==null?void 0:B.type)||"renko_atr",z=((F=($=C.styles)==null?void 0:$.candle)==null?void 0:F.renko)||{method:"ATR",atrLength:14,source:"close",wick:!1};return C.styles={candle:{type:T,renko:z}},C.options={},C.saveInds={},C})}catch(C){console.warn("⚠️ Failed to clear in‑memory save styles/options:",C)}}catch(M){console.error("❌ Error clearing persisted chart cache:",M)}}hp(async()=>{if(i())k(i());else{const M=a.subscribe(I=>{I&&(M(),k(I))})}});async function k(M){var I,C;try{let T=0;const z=20;for(;!l.get()&&T<z;)await new Promise($=>setTimeout($,100)),T+=1;const j=l.get();j?console.log("✅ DrawingManager is available for save system"):console.error("❌ DrawingManager not available after waiting");const B={getCurrentSymbol:()=>qy(s()),collectGlobalState:()=>hT(s(),M),collectDrawings:$=>{if(!j)return console.warn("⚠️ DrawingManager not available, returning empty drawings"),[];const F=j.getDrawingsForSymbol($);return console.log(`📥 Collected ${F.length} drawings for symbol:`,$),F},applyGlobalState:async $=>await _T($,r,M),clearAllDrawings:()=>{var $,F;j?j.hideRenderedDrawings():console.warn("⚠️ DrawingManager not available, cannot clear drawings");try{const V=(($=M==null?void 0:M.getOverlays)==null?void 0:$.call(M,{groupId:"drawing_tools"}))||[];for(const K of V)try{(F=M==null?void 0:M.removeOverlay)==null||F.call(M,{id:K.id})}catch{}console.log("🗑️ Cleared chart overlays for drawing_tools group")}catch{}},renderDrawings:$=>{if(!j){console.warn("⚠️ DrawingManager not available, cannot render drawings");return}const F=qy(s());console.log(`🎨 Rendering ${$.length} drawings for symbol:`,F),j.setCurrentSymbol(F),j.loadDrawingsForSymbol(F,$)},onSymbolChange:$=>{_=Nd(r,V=>$f(V.symbol)).subscribe(V=>{g!==null&&g!==V&&(console.log("🔄 Save system detected symbol change:",g,"->",V),$(V)),g=V})},offSymbolChange:$=>{_&&(_(),_=null)}};v.setRuntimeContracts(B),v.setEventHandlers({onSaved:()=>{try{z_()}catch{}},onLoaded:()=>{try{z_()}catch{}}}),typeof window<"u"&&(window.saveManager=v,window.forceRefreshChart=async()=>{console.log("🔄 Force refresh triggered from WebView parent"),await S()},window.clearChartCache=()=>{var $;console.log("🗑️ Clearing chart cache");try{const F=($=s())!=null&&$.key&&typeof s().key=="string"?s().key:"chart";localStorage.removeItem(F);const V=`${F}_drawings`;localStorage.removeItem(V);const K=`${F}_overlays`;localStorage.removeItem(K),localStorage.removeItem("dataSpaceOverlays"),console.log("✅ Chart cache cleared")}catch(F){console.error("❌ Error clearing cache:",F)}});try{v.getActiveSaveId()&&(c==null||c.set(!0))}catch{}y();try{const $=(I=s())!=null&&I.key&&typeof s().key=="string"?s().key:"chart";(typeof localStorage<"u"?localStorage.getItem(`${$}.lastTimeframe`):null)||typeof localStorage<"u"&&localStorage.setItem(`${$}.lastTimeframe`,"1d")}catch{}await S();try{const $=(C=s())!=null&&C.key&&typeof s().key=="string"?s().key:"chart",F=typeof localStorage<"u"?localStorage.getItem(`${$}.lastTimeframe`):null;if(F&&typeof F=="string"&&F.length>0){const V=F.slice(-1),K=parseInt(F.slice(0,-1))||1,Y=V==="M"?"month":V==="w"?"week":V==="d"?"day":V==="h"?"hour":V==="m"?"minute":V==="s"?"second":"day",Z=Am(F);r.update(ne=>(ne.period={multiplier:K,timespan:Y,timeframe:F,secs:Z},ne))}}catch{}try{z_()}catch{}try{c==null||c.set(!1)}catch{}console.log("✅ Save system initialized successfully")}catch(T){console.error("❌ Failed to initialize save system:",T)}}async function S(){try{console.log("🔍 Starting automatic restoration process (WebView-safe)...");let M=null;try{M=typeof window<"u"?localStorage.getItem("userId"):null}catch{}if(M){console.log("🌐 User logged in, refreshing saved layouts from server...");try{await v.refresh(),console.log("✅ Saved layouts refreshed from server")}catch(z){console.warn("⚠️ Could not refresh saved layouts from server:",z)}}const I=v.getActiveSaveId();if(console.log("🔍 Active save ID found:",I),I){console.log("🔄 Restoring active saved data:",I);const z=await v.load(I);if(z.success){console.log("✅ Active saved data restored successfully:",I);return}else{console.warn("⚠️ Failed to restore active saved data:",z.error);try{await v.clearActiveSave(),console.log("🧹 Cleared stale activeSaveId after failed restore")}catch(j){console.warn("⚠️ Could not clear activeSaveId:",j)}}}let C=[];const T=v.state.subscribe(z=>{C=(z==null?void 0:z.savedLayouts)||[]});if(T&&T(),C&&C.length>0){const z=C[0];if(console.log("🧭 Auto-selecting first saved layout:",z==null?void 0:z.id,z==null?void 0:z.name),z!=null&&z.id){const j=await v.load(z.id);if(j.success){console.log("✅ First saved layout auto-restored and set active:",z.id);return}else console.warn("⚠️ Failed to auto-load chosen layout:",j.error)}}console.log("ℹ️ No saved layouts found, using default chart configuration")}catch(M){console.error("❌ Error restoring active saved data:",M)}}rf(()=>{_&&_(),v.destroy()}),Sp(),Tc()}function QO(o,e){e("cancel")}function eV(o,e){e("confirm")}var tV=re('<div class="ucm-backdrop svelte-16egrl4"><div class="ucm-modal svelte-16egrl4" role="dialog" aria-modal="true" aria-labelledby="ucm-title"><div class="ucm-header svelte-16egrl4"><h2 id="ucm-title" class="svelte-16egrl4"> </h2></div> <div class="ucm-body svelte-16egrl4"><p> </p></div> <div class="ucm-actions svelte-16egrl4"><button class="btn btn-cancel svelte-16egrl4">Cancel</button> <button class="btn btn-confirm svelte-16egrl4">Confirm</button></div></div></div>');function oV(o,e){Mc(e,!1);let t=Qs(e,"show",8,!1),s=Qs(e,"title",8,"Unsaved changes"),i=Qs(e,"message",8,"You have unsaved changes. If you refresh, your changes will be lost.");const r=sp();Sp();var a=So(),l=Rt(a);Te(l,t,c=>{var d=tV(),v=m(d),g=m(v),_=m(g),y=m(_,!0);f(_),f(g);var k=p(g,2),S=m(k),M=m(S,!0);f(S),f(k);var I=p(k,2),C=m(I);C.__click=[QO,r];var T=p(C,2);T.__click=[eV,r],f(I),f(v),f(d),Se(()=>{Ve(y,s()),Ve(M,i())}),O(c,d)}),O(o,a),Tc()}Hd(["click"]);const sV={lookbackPeriod:50,trendWeight:.3,momentumWeight:.25,volatilityWeight:.2,supportResistanceWeight:.15,volumeWeight:.1};function Op(o,e){return o.length<e?o[o.length-1]||0:o.slice(-e).reduce((s,i)=>s+i,0)/e}function K_(o,e){if(o.length===0)return 0;if(o.length<e)return Op(o,o.length);const t=2/(e+1);let s=Op(o.slice(0,e),e);for(let i=e;i<o.length;i++)s=(o[i]-s)*t+s;return s}function iw(o,e=14){if(o.length<e+1)return 50;const t=[];for(let c=1;c<o.length;c++)t.push(o[c]-o[c-1]);let s=0,i=0;for(let c=0;c<e;c++)t[c]>=0?s+=t[c]:i-=t[c];let r=s/e,a=i/e;for(let c=e;c<t.length;c++)t[c]>=0?(r=(r*(e-1)+t[c])/e,a=a*(e-1)/e):(r=r*(e-1)/e,a=(a*(e-1)-t[c])/e);return a===0?100:100-100/(1+r/a)}function nV(o,e=14){if(o.length<2)return 0;const t=[];for(let s=1;s<o.length;s++){const i=o[s].high,r=o[s].low,a=o[s-1].close,l=Math.max(i-r,Math.abs(i-a),Math.abs(r-a));t.push(l)}return Op(t,Math.min(e,t.length))}function iV(o,e=3){if(o.length<10)return{support:[],resistance:[]};const t=o.map(a=>a.high),s=o.map(a=>a.low),i=[],r=[];for(let a=2;a<o.length-2;a++)t[a]>t[a-1]&&t[a]>t[a-2]&&t[a]>t[a+1]&&t[a]>t[a+2]&&i.push(t[a]),s[a]<s[a-1]&&s[a]<s[a-2]&&s[a]<s[a+1]&&s[a]<s[a+2]&&r.push(s[a]);return i.sort((a,l)=>l-a),r.sort((a,l)=>a-l),{resistance:i.slice(0,e),support:r.slice(0,e)}}function rV(o){if(o.length<3)return{pattern:"none",bullish:!0,confidence:.5};const e=o[o.length-1],t=o[o.length-2],s=o[o.length-3],i=Math.abs(e.close-e.open),r=e.high-e.low,a=e.close>e.open,l=Math.abs(t.close-t.open),c=t.close>t.open;if(i>l*1.5){if(a&&!c)return{pattern:"bullish_engulfing",bullish:!0,confidence:.75};if(!a&&c)return{pattern:"bearish_engulfing",bullish:!1,confidence:.75}}if(i<r*.1)return{pattern:"doji",bullish:c,confidence:.4};const d=a?e.open-e.low:e.close-e.low,v=a?e.high-e.close:e.high-e.open;return d>i*2&&v<i*.5?{pattern:"hammer",bullish:!0,confidence:.65}:v>i*2&&d<i*.5?{pattern:"shooting_star",bullish:!1,confidence:.65}:a&&c&&s.close>s.open?{pattern:"three_white_soldiers",bullish:!0,confidence:.7}:!a&&!c&&s.close<s.open?{pattern:"three_black_crows",bullish:!1,confidence:.7}:{pattern:"none",bullish:a,confidence:.5}}function aV(o){if(o.length<30)return{phase:"accumulation",confidence:.5};const e=o.slice(-30),t=e.map(v=>v.close),s=e.map(v=>v.volume||0),i=e.map(v=>v.high-v.low),r=(t[t.length-1]-t[0])/t.length,a=Op(s,s.length),l=Op(s.slice(-5),5),c=Op(i,i.length),d=Op(i.slice(-5),5);return Math.abs(r)<c*.1&&l<a*1.1&&d<c*1.1?{phase:"accumulation",confidence:.7}:r>c*.3&&l>a*1.2?{phase:"markup",confidence:.75}:Math.abs(r)<c*.15&&l>a*1.3&&(t[t.length-10]-t[0])/10>0?{phase:"distribution",confidence:.7}:r<-c*.3&&l>a*1.2?{phase:"markdown",confidence:.75}:{phase:"accumulation",confidence:.5}}function lV(o){if(o.length<20)return{direction:"sideways",strength:.5};const e=o.map($=>$.close),t=o.map($=>$.high),s=o.map($=>$.low),i=K_(e,9),r=K_(e,21),a=K_(e,Math.min(50,e.length)),l=e[e.length-1];let c="sideways",d=0,v=0;i>r?d++:v++,r>a?d++:v++,l>i?d++:v++;const g=t.slice(-5),_=s.slice(-5),y=g[g.length-1]>g[0],k=_[_.length-1]>_[0],S=g[g.length-1]<g[0],M=_[_.length-1]<_[0];y&&k?d+=2:S&&M&&(v+=2);const I=e.slice(-10),C=(I[I.length-1]-I[0])/I.length,T=Op(I,I.length),z=C/T*100;z>.15?d+=2:z<-.15&&(v+=2),d>v+1?c="up":v>d+1&&(c="down");const j=d+v,B=j>0?Math.abs(d-v)/j:.5;return{direction:c,strength:Math.min(B,1)}}function cV(o){if(o.length<20)return{value:0,strength:.5};const e=o.map(c=>c.close),t=iw(e,14),s=(t-50)/50,i=(e[e.length-1]-e[e.length-10])/e[e.length-10],r=s*.6+i*10*.4,a=Math.max(-1,Math.min(1,r)),l=Math.abs(t-50)/50;return{value:a,strength:Math.min(l,1)}}function dV(o){if(o.length<20)return{trend:"stable",relativeCurrent:1};const e=o.map(l=>l.volume||0),t=Op(e,Math.min(20,e.length)),s=Op(e.slice(-5),5),i=e[e.length-1],r=t>0?i/t:1;let a="stable";return s>t*1.2?a="increasing":s<t*.8&&(a="decreasing"),{trend:a,relativeCurrent:r}}function uV(o,e={}){const t={...sV,...e};if(o.length<10)return console.warn("Not enough historical data for prediction"),null;const s=o.slice(-t.lookbackPeriod),i=s[s.length-1];console.log("🔮 Predicting next candle from",s.length,"candles");const r=lV(s);console.log("📈 Trend:",r);const a=cV(s);console.log("⚡ Momentum:",a);const l=nV(s,14),c=Op(s.map(tt=>tt.close),s.length),d=l/c*100;console.log("📊 Volatility (ATR%):",d.toFixed(2));const v=iV(s);console.log("🎯 Support/Resistance:",v);const g=dV(s);console.log("📦 Volume:",g);const _=rV(s);console.log("🎨 Pattern:",_);const y=aV(s);console.log("🔄 Market Cycle:",y);let k=0;const S=(Math.random()-.5)*.8;k+=S;const M=iw(s.map(tt=>tt.close),14),I=M>70,C=M<30,T=r.strength>.7;let z=.15;if(I&&r.direction==="up"&&(z+=.25),C&&r.direction==="down"&&(z+=.25),T&&(z+=.15),Math.random()<z){console.log("🔄 REVERSAL DETECTED - Creating counter-trend candle");const tt=.5+Math.random()*1.5;r.direction==="up"?k-=tt:r.direction==="down"?k+=tt:k+=(Math.random()>.5?1:-1)*tt}else r.direction==="up"?k+=r.strength*t.trendWeight*1.5:r.direction==="down"?k-=r.strength*t.trendWeight*1.5:k+=(Math.random()-.5)*.6,k+=a.value*a.strength*t.momentumWeight*1.8;if(_.pattern!=="none"){const tt=_.confidence*1.2;_.bullish?k+=tt:k-=tt,console.log(`🎯 Pattern impact: ${_.bullish?"+":"-"}${tt.toFixed(2)}%`)}y.phase==="markup"?k+=y.confidence*.5:y.phase==="markdown"?k-=y.confidence*.5:y.phase==="distribution"?k-=y.confidence*.2:y.phase==="accumulation"&&(k+=y.confidence*.2);const B=Math.min(d/2,2)*t.volatilityWeight;let $=0;const F=i.close;for(const tt of v.resistance)F>=tt*.98&&F<=tt*1.02&&($-=.5);for(const tt of v.support)F>=tt*.98&&F<=tt*1.02&&($+=.5);if(k+=$*t.supportResistanceWeight*1.5,g.trend==="increasing"){const tt=t.volumeWeight*.8;(k>0||k<0)&&(k*=1+tt)}else g.trend==="decreasing"&&(k*=.85);const V=(Math.random()-.5)*B*2.5;if(k+=V,Math.random()<.05){const tt=(Math.random()-.5)*3;k+=tt,console.log("📰 Surprise move:",tt.toFixed(2)+"%")}k=Math.max(-6,Math.min(6,k)),console.log("💹 Predicted change:",k.toFixed(2)+"%");const K=F*(k/100),Y=k>0;let Z,ne,te,oe;const U=d>2?.15:.05,se=Math.random()<U?(Math.random()*.5+.2)*(Y?1:-1):0,W=Math.abs(K),le=(Math.random()-.5)*.4,ye=W*(1+le);if(Y){Z=F*(1+se/100),oe=Z+ye;const tt=Math.random();let Ze,ct;tt<.2?(Ze=l*(.05+Math.random()*.15),ct=l*(.05+Math.random()*.15)):tt<.4?(Ze=l*(.4+Math.random()*.5),ct=l*(.1+Math.random()*.2)):tt<.6?(Ze=l*(.05+Math.random()*.15),ct=l*(.4+Math.random()*.6)):(Ze=l*(.15+Math.random()*.35),ct=l*(.15+Math.random()*.35)),ne=oe+Ze,te=Z-ct}else{Z=F*(1+se/100),oe=Z-ye;const tt=Math.random();let Ze,ct;tt<.2?(Ze=l*(.05+Math.random()*.15),ct=l*(.05+Math.random()*.15)):tt<.4?(Ze=l*(.4+Math.random()*.6),ct=l*(.05+Math.random()*.15)):tt<.6?(Ze=l*(.1+Math.random()*.2),ct=l*(.4+Math.random()*.5)):(Ze=l*(.15+Math.random()*.35),ct=l*(.15+Math.random()*.35)),ne=Z+Ze,te=oe-ct}const Ce=r.direction==="sideways"?.15:.05;if(Math.random()<Ce){oe=Z+(Math.random()-.5)*l*.1;const tt=l*(.3+Math.random()*.4);ne=Math.max(Z,oe)+tt,te=Math.min(Z,oe)-tt,console.log("🎲 Created Doji candle (indecision)")}ne=Math.max(Z,oe,ne),te=Math.min(Z,oe,te);const Re=Op(s.map(tt=>tt.volume||0),20);Op(s.slice(-5).map(tt=>tt.volume||0),5);let Ke=Re;const st=Math.min(Math.abs(k)/2,1.5);Ke*=.8+st*.4,g.trend==="increasing"?Ke*=1.1+Math.random()*.3:g.trend==="decreasing"?Ke*=.7+Math.random()*.2:Ke*=.85+Math.random()*.3,_.pattern==="bullish_engulfing"||_.pattern==="bearish_engulfing"?Ke*=1.2+Math.random()*.3:_.pattern==="doji"&&(Ke*=.7+Math.random()*.2),(y.phase==="distribution"||y.phase==="markdown")&&(Ke*=1.1+Math.random()*.2),Ke=Math.max(Re*.3,Math.min(Ke,Re*3));const vt=s.slice(-5).map((tt,Ze,ct)=>Ze>0?tt.timestamp-ct[Ze-1].timestamp:0).filter(tt=>tt>0),Je=vt.length>0?Op(vt,vt.length):6e4,nt={timestamp:i.timestamp+Je,open:Math.round(Z*100)/100,high:Math.round(ne*100)/100,low:Math.round(te*100)/100,close:Math.round(oe*100)/100,volume:Math.round(Ke)};return console.log("🎯 Predicted candle:",nt),nt}function pV(o,e){return Date.now()-o>e*2}function vV(){var o;try{(o=window.predictNextCandle)==null||o.call(window)}catch{}V0(!0)}function fV(o,e){(!(typeof window<"u")||window.confirm("Exit simulator?"))&&(e(),zx())}function mV(o){const e=parseFloat(o.target.value);E1(e)}var gV=re('<button class="fc-btn svelte-u36ajg" type="button">Stop</button>'),hV=re('<button class="fc-btn svelte-u36ajg" type="button">Start</button>'),_V=re('<div class="floating-controls svelte-u36ajg"><div class="fc-content svelte-u36ajg"><div class="fc-header svelte-u36ajg"><div class="fc-title svelte-u36ajg">Simulator</div> <div class="fc-badge svelte-u36ajg"> </div></div> <div class="fc-row svelte-u36ajg"><input type="range" min="0.5" max="10" step="0.5" class="fc-range svelte-u36ajg"></div> <div class="fc-row svelte-u36ajg"><!> <button class="fc-btn fc-danger svelte-u36ajg" type="button">Exit</button></div></div></div>');function yV(o,e){Mc(e,!0);const t=Au(),s=()=>ua(np,"$simulator",t);let i=ee(20),r=ee(80),a=ee(!1),l=0,c=0;function d(S){const M="touches"in S?S.touches[0]:S;l=M.clientX-n(i),c=M.clientY-n(r),x(a,!0),window.addEventListener("mousemove",v),window.addEventListener("mouseup",g),window.addEventListener("touchmove",v,{passive:!0}),window.addEventListener("touchend",g)}function v(S){if(!n(a))return;const M="touches"in S?S.touches[0]:S;x(i,M.clientX-l),x(r,M.clientY-c)}function g(){x(a,!1),window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",g),window.removeEventListener("touchmove",v),window.removeEventListener("touchend",g)}function _(){var S;try{(S=window.stopPrediction)==null||S.call(window)}catch{}V0(!1)}var y=So(),k=Rt(y);Te(k,()=>s().mode==="normal",S=>{var M=_V(),I=m(M),C=m(I);C.__mousedown=d,C.__touchstart=d;var T=p(m(C),2),z=m(T);f(T),f(C);var j=p(C,2),B=m(j);Jt(B),B.__input=[mV],f(j);var $=p(j,2),F=m($);Te(F,()=>s().playing,K=>{var Y=gV();Y.__click=_,O(K,Y)},K=>{var Y=hV();Y.__click=[vV],O(K,Y)});var V=p(F,2);V.__click=[fV,_],f($),f(I),f(M),Se(()=>{Nt(M,"style",`left:${n(i)}px;top:${n(r)}px;`),Ve(z,`${s().speed??""}x`),cu(B,s().speed)}),O(S,M)}),O(o,y),Tc()}Hd(["mousedown","touchstart","input","click"]);function bV(o){let e="",t=null;for(let s=0;s<o.length;s++){const i=o[s],r=o[s+1];if(t){e+=i,i===t&&o[s-1]!=="\\"&&(t=null);continue}if(i==="'"||i==='"'){t=i,e+=i;continue}if(i==="/"&&r==="/")break;e+=i}return e.replace(/\s+$/,"")}function ta(o){const e=o.trim();return e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e}function Xa(o){const e=[];let t="",s=0,i=null;for(let r=0;r<o.length;r++){const a=o[r];if(i){t+=a,a===i&&o[r-1]!=="\\"&&(i=null);continue}if(a==="'"||a==='"'){i=a,t+=a;continue}if(a==="("){s+=1,t+=a;continue}if(a===")"){s=Math.max(0,s-1),t+=a;continue}if(a===","&&s===0){e.push(t.trim()),t="";continue}t+=a}return t.trim()&&e.push(t.trim()),e}function Vc(o){const e={};for(const t of o){const s=t.match(/^([A-Za-z_$][A-Za-z0-9_$]*)\s*=\s*(.+)$/);s&&(e[s[1]]=s[2].trim())}return e}function zm(o){let e=o.trim();return e=e.replace(/\bta\./g,""),e=e.replace(/\bmath\./g,""),e=e.replace(/\b(barstate|timeframe|syminfo|strategy)\.([A-Za-z0-9_]+)/gi,(t,s,i)=>`${String(s).toLowerCase()}_${i}`),e=(()=>{const t=e;let s="",i=null,r=0;const a=c=>/[A-Za-z_$]/.test(c),l=c=>/[A-Za-z0-9_$]/.test(c);for(;r<t.length;){const c=t[r];if(i){s+=c,c===i&&t[r-1]!=="\\"&&(i=null),r+=1;continue}if(c==="'"||c==='"'){i=c,s+=c,r+=1;continue}if(a(c)){let d=r+1;for(;d<t.length&&l(t[d]);)d+=1;const v=t.slice(r,d);let g=d;for(;g<t.length&&/\s/.test(t[g]);)g+=1;if(t[g]==="["){let _=g+1;for(;_<t.length&&/\s/.test(t[_]);)_+=1;let y=1;t[_]==="-"&&(y=-1,_+=1);let k=_;for(;k<t.length&&/[0-9]/.test(t[k]);)k+=1;const S=t.slice(_,k);for(;k<t.length&&/\s/.test(t[k]);)k+=1;if(S&&t[k]==="]"){const M=y*Number(S);if(Number.isFinite(M)&&M>=1){s+=`prev(${v}, ${Math.floor(M)})`,r=k+1;continue}if(Number.isFinite(M)&&M===0){s+=v,r=k+1;continue}}}s+=v,r=d;continue}s+=c,r+=1}return s})(),e}function sv(o){let e=zm(o);return e=e.replace(/\bcrossover\s*\(/gi,"crossover("),e=e.replace(/\bcrossunder\s*\(/gi,"crossunder("),e}function Qc(o){return/^[A-Za-z_$][A-Za-z0-9_$]*\s*=/.test(o.trim())}function rm(o){const e=o.trim().toLowerCase();return e==="true"?!0:e==="false"?!1:null}function Ev(o){const e=o.trim();if(!/^[-+]?\d+(?:\.\d+)?$/.test(e))return null;const t=Number(e);return Number.isFinite(t)?t:null}function Nu(o){const e=ta(String(o||"").trim());if(!e)return;if(e.startsWith("#")||e.startsWith("rgb"))return e;const t=e.toLowerCase();if(t==="color.green"||t==="green")return"#16a34a";if(t==="color.red"||t==="red")return"#ef4444";if(t==="color.orange"||t==="orange")return"#f59e0b";if(t==="color.blue"||t==="blue")return"#3b82f6";if(t==="color.gray"||t==="gray"||t==="grey")return"#64748b";if(t==="color.white"||t==="white")return"#e2e8f0";if(t==="color.black"||t==="black")return"#0b1220"}function xV(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^shape\./,"").replace(/^label\./,"");if(t.includes("triangleup"))return"triangle_up_filled";if(t.includes("triangledown"))return"triangle_down_filled";if(t.includes("arrowup"))return"arrowUp";if(t.includes("arrowdown"))return"arrowDown";if(t.includes("circle"))return"circle";if(t.includes("square"))return"square";if(t.includes("label"))return"label"}function w2(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^label\./,"");return t.includes("up")?"triangle_up_filled":t.includes("down")?"triangle_down_filled":t.includes("circle")?"circle":t.includes("square")?"square":t.includes("none")?"text":"label"}function y0(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^size\./,"");if(t==="tiny")return 10;if(t==="small")return 12;if(t==="normal")return 14;if(t==="large")return 18;if(t==="huge")return 22;const s=Ev(ta(e));if(s!=null)return Math.max(6,Math.min(64,s))}function sh(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^line\./,"");if(t.includes("dashed"))return"dashed";if(t.includes("dotted"))return"dotted";if(t.includes("solid"))return"solid"}function nh(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^extend\./,"");if(t.includes("right"))return"right";if(t.includes("left"))return"left";if(t.includes("both"))return"both";if(t.includes("none"))return"none"}function Pm(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^xloc\./,"");if(t.includes("bar_time")||t.includes("bartime")||t.includes("time"))return"time";if(t.includes("bar_index")||t.includes("barindex"))return"bar_index"}function k2(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^yloc\./,"");if(t.includes("above"))return"abovebar";if(t.includes("below"))return"belowbar";if(t.includes("price"))return"price"}function Gf(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^text\./,"").replace(/^align_/,"");if(t.includes("left"))return"left";if(t.includes("right"))return"right";if(t.includes("center")||t.includes("middle"))return"center"}function Im(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^text\./,"").replace(/^align_/,"");if(t.includes("top"))return"top";if(t.includes("bottom"))return"bottom";if(t.includes("center")||t.includes("middle"))return"middle"}function S2(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^position\./,"");if(t.includes("top_left"))return"top_left";if(t.includes("top_right"))return"top_right";if(t.includes("top_center"))return"top_center";if(t.includes("bottom_left"))return"bottom_left";if(t.includes("bottom_right"))return"bottom_right";if(t.includes("bottom_center"))return"bottom_center";if(t.includes("middle_center")||t.includes("center"))return"middle_center"}function C2(o){const e=String(o||"").trim().toLowerCase();if(e){if(e.includes("on"))return"on";if(e.includes("off"))return"off"}}function P2(o){const t=String(o||"").trim().match(/^(?:request\.)?security\s*\((.*)\)\s*$/i);if(!t)return null;const s=Xa(t[1]||"");if(s.length<2)return null;const i=Vc(s),r=s.filter(S=>!Qc(S)),a=r[0]!=null?String(r[0]).trim():"",l=ta(a),c=l&&l.toLowerCase()==="syminfo.tickerid"?"syminfo.tickerid":!(a.startsWith('"')&&a.endsWith('"')||a.startsWith("'")&&a.endsWith("'"))&&/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(l)&&!/^\d+$/.test(l)?`\${${l}}`:l,d=r[1]!=null?String(r[1]).trim():"",v=ta(d),g=v&&v.toLowerCase()==="timeframe.period"?"__CURRENT__":!(d.startsWith('"')&&d.endsWith('"')||d.startsWith("'")&&d.endsWith("'"))&&/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(v)&&!/^\d+$/.test(v)?`\${${v}}`:v,_=r[2]!=null?zm(String(r[2])):"close",y=C2(String(i.lookahead??""))??(String(i.lookahead??"").toLowerCase().includes("lookahead_on")?"on":String(i.lookahead??"").toLowerCase().includes("lookahead_off")?"off":void 0),k=C2(String(i.gaps??""))??(String(i.gaps??"").toLowerCase().includes("gaps_on")?"on":String(i.gaps??"").toLowerCase().includes("gaps_off")?"off":void 0);return{symbol:c,country:i.country!=null?ta(String(i.country)):void 0,timeframe:g||"__CURRENT__",expr:_||"close",lookahead:y,gaps:k}}function Ih(o){var td,Nc;const e=String(o||"").split(/\r?\n/),t=[],s=[],i=be=>{let We=0;for(let de=0;de<be.length;de++){const De=be[de];if(De===" ")We+=1;else if(De==="	")We+=2;else break}return We},r=be=>{let We=0,de=null;for(let De=0;De<be.length;De++){const Ee=be[De];if(de){Ee===de&&be[De-1]!=="\\"&&(de=null);continue}if(Ee==="'"||Ee==='"'){de=Ee;continue}Ee==="("?We+=1:Ee===")"&&(We-=1)}return We},a=[];let l="",c=1,d=0,v=0;for(let be=0;be<e.length;be++){const We=be+1,de=bV(e[be]||""),De=de.trim();De&&(l||(c=We,v=i(de)),l=l?`${l} ${De}`:De,d+=r(De),d<=0&&(a.push({text:l.trim(),indent:v,lineNo:c,loopSeq:!1}),l="",d=0,v=0))}l.trim()&&a.push({text:l.trim(),indent:v,lineNo:c,loopSeq:!1});const g=[{pane:"main",plots:[],labels:[],levels:[],lines:[],runtimeDrawOps:[],runtimeLabels:[],runtimeLines:[],runtimeBoxes:[],runtimeTables:[],overlays:[],fills:[],backgroundZones:[]}],_=[],y=[],k={},S=[],M=[],I={},C=[],T={};let z=null;const j={},B={},$={},F={};let V=0;const K=(be,We)=>{const de=We.replace(/[^A-Za-z0-9_]+/g,"_").toLowerCase(),De=de?`__sec_${de}`:"__sec";let Ee=De,xe=1;const gt=at=>_.some(jt=>String((jt==null?void 0:jt.name)||"").toLowerCase()===at.toLowerCase())||S.some(jt=>String((jt==null?void 0:jt.name)||"").toLowerCase()===at.toLowerCase());for(;gt(Ee);)xe+=1,Ee=`${De}_${xe}`;return S.push({name:Ee,type:"security",symbol:be.symbol,country:be.country,timeframe:be.timeframe,expr:be.expr,lookahead:be.lookahead,gaps:be.gaps}),Ee},Y=(be,We)=>{const de=String(be||"");let De="",Ee=0,xe=null;const gt=de.toLowerCase();for(;Ee<de.length;){const at=de[Ee];if(xe){De+=at,at===xe&&de[Ee-1]!=="\\"&&(xe=null),Ee+=1;continue}if(at==="'"||at==='"'){xe=at,De+=at,Ee+=1;continue}const jt=gt.slice(Ee),Lt=jt.startsWith("request.security"),Mt=!Lt&&jt.startsWith("security")&&(Ee===0||!/[a-z0-9_$]/i.test(gt[Ee-1]||""));if(Lt||Mt){let Bo=Ee+(Lt?16:8);for(;Bo<de.length&&/\s/.test(de[Bo]);)Bo+=1;if(de[Bo]!=="("){De+=at,Ee+=1;continue}let hs=0,is=Bo,Es=null;for(;is<de.length;is++){const $t=de[is];if(Es){$t===Es&&de[is-1]!=="\\"&&(Es=null);continue}if($t==="'"||$t==='"'){Es=$t;continue}if($t==="(")hs+=1;else if($t===")"&&(hs-=1,hs===0))break}if(is>=de.length){De+=de.slice(Ee);break}const bt=de.slice(Ee,is+1),kt=P2(bt);if(!kt){De+=bt,Ee=is+1;continue}V+=1;const xo=K(kt,`${We}_${V}`);De+=xo,Ee=is+1;continue}De+=at,Ee+=1}return De};if(!/(^\s*\/\/@\s*pine)|(^\s*\/\/@\s*version)|\b(strategy|indicator|study)\s*\(/m.test(o))return{ok:!1,errors:[{message:"Not a Pine-like script",line:1}]};const ne=()=>{g.some(be=>be.pane==="sub")||g.push({pane:"sub",plots:[],labels:[],levels:[],lines:[],runtimeDrawOps:[],runtimeLabels:[],runtimeLines:[],runtimeBoxes:[],runtimeTables:[],overlays:[],fills:[],backgroundZones:[]})},te=be=>(be==="sub"&&ne(),g.find(We=>We.pane===be)||g[0]),oe=be=>{const We=String(be||"").trim();return!We||/[+\-*/%]/.test(We)?!1:!!(/\b(crossover|crossunder|between|above|below)\s*\(/i.test(We)||/\bcrosses(Above|Below)\b/i.test(We)||/[<>]=?|==|!=/.test(We)||/\b(and|or|not)\b/i.test(We)||/^\s*true\s*$|^\s*false\s*$/i.test(We))},U=be=>String(be||"").trim().replace(/\s+/g,"_").toLowerCase(),J=(be,We)=>{let de="",De=null;for(let Ee=0;Ee<be.length;Ee++){const xe=be[Ee];if(De){de+=xe,xe===De&&be[Ee-1]!=="\\"&&(De=null);continue}if(xe==="'"||xe==='"'){De=xe,de+=xe;continue}if(/[A-Za-z_$]/.test(xe)){let gt=Ee+1;for(;gt<be.length&&/[A-Za-z0-9_$]/.test(be[gt]);)gt+=1;const at=be.slice(Ee,gt),jt=We[at];de+=jt??at,Ee=gt-1;continue}de+=xe}return de},se=(be,We)=>{let de=String(be||"");for(let De=0;De<8;De++){let Ee=!1,xe="",gt=0,at=null;for(;gt<de.length;){const jt=de[gt];if(at){xe+=jt,jt===at&&de[gt-1]!=="\\"&&(at=null),gt+=1;continue}if(jt==="'"||jt==='"'){at=jt,xe+=jt,gt+=1;continue}if(/[A-Za-z_$]/.test(jt)){let Lt=gt+1;for(;Lt<de.length&&/[A-Za-z0-9_$]/.test(de[Lt]);)Lt+=1;const Mt=de.slice(gt,Lt);let Io=Lt;for(;Io<de.length&&/\s/.test(de[Io]);)Io+=1;if(de[Io]==="("){const Bo=j[U(Mt)];if(Bo){let hs=0,is=Io,Es=null;for(;is<de.length;is++){const bt=de[is];if(Es){bt===Es&&de[is-1]!=="\\"&&(Es=null);continue}if(bt==="'"||bt==='"'){Es=bt;continue}if(bt==="(")hs+=1;else if(bt===")"&&(hs-=1,hs===0))break}if(is<de.length&&de[is]===")"){const bt=de.slice(Io+1,is),kt=Xa(bt),xo={};for(let _o=0;_o<Bo.args.length;_o++){const go=Bo.args[_o],fs=kt[_o]!=null?String(kt[_o]).trim():"na";xo[go]=zm(Y(fs,`${We}_${Bo.name}`))}const $t=J(Bo.body,xo);xe+=`(${$t})`,gt=is+1,Ee=!0;continue}}}xe+=Mt,gt=Lt;continue}xe+=jt,gt+=1}if(!Ee)return de;de=xe}return s.push({message:`User function expansion reached max depth while processing "${We}".`,line:1}),de},W=be=>String(be||"").replace(/\barray\.size\s*\(\s*([A-Za-z_$][A-Za-z0-9_$]*)\s*\)/gi,(We,de)=>{const De=U(String(de)),Ee=$[De];if(Ee!=null&&Ee.dynamic)return We;const xe=B[De],gt=(Ee==null?void 0:Ee.size)??(xe==null?void 0:xe.length);return Number.isFinite(gt)?String(gt):We}),le=be=>{switch(be.kind){case"NumberLiteral":return be.value;case"Identifier":{const We=U(be.name);if(We==="true")return 1;if(We==="false")return 0;if(We==="na"||We==="nan")return NaN;const de=I[We]??I[be.name],De=typeof de=="number"?de:Number(de);return Number.isFinite(De)?De:null}case"UnaryExpression":{if(be.operator!=="not")return null;const We=le(be.expr);return We==null?null:Number.isFinite(We)&&We!==0?0:1}case"BinaryExpression":{const We=le(be.left),de=le(be.right);if(We==null||de==null)return null;switch(be.operator){case"+":return We+de;case"-":return We-de;case"*":return We*de;case"/":return de===0?NaN:We/de;case"%":return de===0?NaN:We%de;case">":return Number.isFinite(We)&&Number.isFinite(de)&&We>de?1:0;case"<":return Number.isFinite(We)&&Number.isFinite(de)&&We<de?1:0;case">=":return Number.isFinite(We)&&Number.isFinite(de)&&We>=de?1:0;case"<=":return Number.isFinite(We)&&Number.isFinite(de)&&We<=de?1:0;case"==":return Number.isFinite(We)&&Number.isFinite(de)&&Math.abs(We-de)<1e-9?1:0;case"!=":return Number.isFinite(We)&&Number.isFinite(de)&&Math.abs(We-de)>=1e-9?1:0;case"and":return Number.isFinite(We)&&We!==0&&Number.isFinite(de)&&de!==0?1:0;case"or":return Number.isFinite(We)&&We!==0||Number.isFinite(de)&&de!==0?1:0;default:return null}}case"CallExpression":{const We=be.callee.toLowerCase();if(We==="iff"&&be.args.length===3){const xe=le(be.args[0]);return xe==null?null:le(xe!==0?be.args[1]:be.args[2])}const de=be.args.map(xe=>le(xe));if(de.some(xe=>xe==null))return null;const De=de[0],Ee=de[1];switch(We){case"min":return Math.min(De,Ee);case"max":return Math.max(De,Ee);case"abs":return Math.abs(De);case"ceil":return Math.ceil(De);case"floor":return Math.floor(De);case"round":return Math.round(De);case"sqrt":return Math.sqrt(De);case"pow":return Math.pow(De,Ee);default:return null}}default:return null}},ye=be=>{const We=ta(String(be||"").trim());if(!We)return null;const de=Ev(We);if(de!=null)return de;const De=U(We),Ee=I[De]??I[We],xe=typeof Ee=="number"?Ee:Number(Ee);if(Number.isFinite(xe))return xe;const gt=W(zm(We));try{const at=R0(gt),jt=le(at);return Number.isFinite(jt)?jt:null}catch{return null}},Ce=32,Re=1024,Ke=256,st=(be,We)=>`__arr_${be}_${We}`,vt=be=>`__arr_${be}__size`,Je=(be,We)=>{const de=vt(be),De=k[de];if(typeof De=="number")return y[De].initExpr||(y[De].initExpr=String(We)),de;const Ee=y.length;return k[de]=Ee,y.push({name:de,initExpr:String(We),updateExpr:de,selfMode:"current"}),de},ot=(be,We,de,De)=>{const Ee=U(be),xe=Math.max(0,Math.floor(We)),gt=$[Ee],at=De??xe,jt=Math.min(Re,Math.max((gt==null?void 0:gt.capacity)??0,Math.floor(at))),Lt=Je(Ee,Math.max((gt==null?void 0:gt.size)??0,xe)),Mt=gt?gt.elements.slice():[];for(let Io=Mt.length;Io<jt;Io++){const Bo=st(Ee,Io);if(Mt.push(Bo),Bo in k){if(de&&de[Io]!=null){const hs=k[Bo];y[hs].initExpr||(y[hs].initExpr=String(de[Io]))}}else{const hs=y.length;k[Bo]=hs;const is=de&&de[Io]!=null?String(de[Io]):void 0;y.push({name:Bo,initExpr:is,updateExpr:Bo,selfMode:"current"})}}return $[Ee]={size:Math.max((gt==null?void 0:gt.size)??0,xe),capacity:jt,elements:Mt,sizeSeries:Lt,dynamic:(gt==null?void 0:gt.dynamic)??!1},{key:Ee,elements:Mt}},nt=(be,We)=>{const de=U(be),De=$[de];De&&(De.capacity>=We||ot(de,De.size,void 0,We))},tt=(be,We)=>{var xe,gt,at;const de=ye(We);if(de==null)return null;const De=Math.floor(de),Ee=((xe=$[be])==null?void 0:xe.capacity)??((gt=$[be])==null?void 0:gt.size)??((at=B[be])==null?void 0:at.length)??0;return De<0||Ee<=0||De>=Ee?null:De},Ze=(be,We)=>{const de=B[be],De=$[be],Ee=(De==null?void 0:De.capacity)??(De==null?void 0:De.size)??(de==null?void 0:de.length)??0;if(!Ee)return null;ot(be,(De==null?void 0:De.size)??Ee,de,Ee);const xe=De!=null&&De.dynamic?De.sizeSeries:String((De==null?void 0:De.size)??(de==null?void 0:de.length)??Ee);let gt="na";for(let at=Ee-1;at>=0;at--){const jt=xe?`(${xe}) > ${at}`:"1";gt=`iff(((${We}) == ${at}) and (${jt}), ${st(be,at)}, ${gt})`}return gt},ct=(be,We,de,De)=>{const Ee=B[be],xe=$[be],gt=(xe==null?void 0:xe.capacity)??(xe==null?void 0:xe.size)??(Ee==null?void 0:Ee.length)??0;if(!gt)return null;ot(be,(xe==null?void 0:xe.size)??gt,Ee,gt);const at=[];for(let jt=0;jt<gt;jt++){const Lt=De?`(${De}) and `:"";at.push(`iff(${Lt}(${We}) == ${jt}, ${de}, ${st(be,jt)})`)}return at},Ge=be=>String(be||"").replace(/\barray\.size\s*\(\s*([A-Za-z_$][A-Za-z0-9_$]*)\s*\)/gi,(We,de)=>{const De=U(String(de)),Ee=$[De];if(Ee)return Ee.sizeSeries;const xe=B[De];return xe?String(xe.length):We}),pt=(be,We,de)=>{const De=$[de],Ee=B[de],xe=(De==null?void 0:De.capacity)??(De==null?void 0:De.size)??(Ee==null?void 0:Ee.length)??0;if(!xe)return null;const gt=`array.size(${We})`,at=(Mt,Io)=>{const Bo=`array.get(${We}, ${Mt})`,hs=Io?`(${Bo} * ${Bo})`:Bo;return`iff(${gt} > ${Mt}, ${hs}, 0)`};if(be==="sum"||be==="avg"||be==="stdev"){let Mt=at(0,!1);for(let is=1;is<xe;is++)Mt=`(${Mt} + ${at(is,!1)})`;if(be==="sum")return Mt;if(be==="avg")return`iff(${gt} > 0, (${Mt}) / ${gt}, na)`;let Io=at(0,!0);for(let is=1;is<xe;is++)Io=`(${Io} + ${at(is,!0)})`;const Bo=`iff(${gt} > 0, (${Mt}) / ${gt}, na)`;return`sqrt(max(${`iff(${gt} > 0, (${Io}) / ${gt} - (${Bo} * ${Bo}), na)`}, 0))`}const jt=be==="min"?"1000000000000":"-1000000000000";let Lt=`iff(${gt} > 0, array.get(${We}, 0), ${jt})`;for(let Mt=1;Mt<xe;Mt++){const Io=`iff(${gt} > ${Mt}, array.get(${We}, ${Mt}), ${jt})`;Lt=`${be}(${Lt}, ${Io})`}return Lt},ce=be=>{const We=String(be||"");let de="",De=0,Ee=null;const xe=We.toLowerCase(),gt=at=>/[a-z0-9_$]/i.test(at);for(;De<We.length;){const at=We[De];if(Ee){de+=at,at===Ee&&We[De-1]!=="\\"&&(Ee=null),De+=1;continue}if(at==="'"||at==='"'){Ee=at,de+=at,De+=1;continue}const jt=xe.slice(De).match(/^array\.(sum|min|max|avg|stdev)\b/);if(!jt||De>0&&gt(xe[De-1]||"")){de+=at,De+=1;continue}const Lt=String(jt[1]||"").toLowerCase();let Mt=De+jt[0].length;for(;Mt<We.length&&/\s/.test(We[Mt]);)Mt+=1;if(We[Mt]!=="("){de+=at,De+=1;continue}let Io=0,Bo=Mt,hs=null;for(;Bo<We.length;Bo++){const $t=We[Bo];if(hs){$t===hs&&We[Bo-1]!=="\\"&&(hs=null);continue}if($t==="'"||$t==='"'){hs=$t;continue}if($t==="(")Io+=1;else if($t===")"&&(Io-=1,Io===0))break}if(Bo>=We.length){de+=We.slice(De);break}const is=We.slice(Mt+1,Bo),Es=Xa(is),bt=String(Es[0]||"").trim();if(!/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(bt)){de+=We.slice(De,Bo+1),De=Bo+1;continue}const kt=U(bt),xo=pt(Lt,bt,kt);if(!xo){de+=We.slice(De,Bo+1),De=Bo+1;continue}de+=`(${xo})`,De=Bo+1}return de},we=be=>{const We=$[be];We&&(We.dynamic=!0)},ze=(be,We,de,De)=>{const Ee=$[be];if(!Ee)return null;const xe=Ee.sizeSeries,gt=xe,at=Ee.capacity,jt=[],Lt=Mt=>{Mt.forEach((Io,Bo)=>{jt.push({name:st(be,Bo),hasVar:!1,declaredType:"",op:":=",rhs:Io,lineNo:De})})};if(We==="push"){const Mt=Q(String(de.value||"na"),`${be}_push`),Io=`(${gt}) < ${at}`,Bo=ct(be,gt,Mt,Io);return Bo&&Lt(Bo),jt.push({name:xe,hasVar:!1,declaredType:"",op:":=",rhs:`iff(${Io}, min(${xe} + 1, ${at}), ${xe})`,lineNo:De}),jt}if(We==="pop")return jt.push({name:xe,hasVar:!1,declaredType:"",op:":=",rhs:`iff(${xe} > 0, max(${xe} - 1, 0), ${xe})`,lineNo:De}),jt;if(We==="clear")return jt.push({name:xe,hasVar:!1,declaredType:"",op:":=",rhs:"0",lineNo:De}),jt;if(We==="resize"){const Mt=Q(String(de.size||"0"),`${be}_resize`);return jt.push({name:xe,hasVar:!1,declaredType:"",op:":=",rhs:`min(max(0, ${Mt}), ${at})`,lineNo:De}),jt}if(We==="shift"||We==="remove"){const Mt=We==="shift"?"0":Q(String(de.index||"0"),`${be}_remove`),Io=`(${Mt}) >= 0 and (${Mt}) < ${gt}`,Bo=[];for(let hs=0;hs<at;hs++){const is=hs<at-1?`(${Io}) and (${hs} >= (${Mt})) and (${hs} < (${gt} - 1))`:"0",Es=hs<at-1?st(be,hs+1):st(be,hs);Bo.push(`iff(${is}, ${Es}, ${st(be,hs)})`)}return Lt(Bo),jt.push({name:xe,hasVar:!1,declaredType:"",op:":=",rhs:`iff(${Io}, max(${xe} - 1, 0), ${xe})`,lineNo:De}),jt}if(We==="unshift"||We==="insert"){const Mt=We==="unshift"?"0":Q(String(de.index||"0"),`${be}_insert`),Io=Q(String(de.value||"na"),`${be}_insert_val`),Bo=`(${prevSize}) < ${at}`,hs=`(${Mt}) >= 0 and (${Mt}) <= ${gt}`,is=[];for(let Es=0;Es<at;Es++){const bt=`(${Es} == (${Mt}))`,kt=`(${Es} > (${Mt})) and (${Es} <= ${gt})`,xo=Es>0?st(be,Es-1):st(be,Es);is.push(`iff(${Bo} and ${hs} and ${bt}, ${Io}, iff(${Bo} and ${hs} and ${kt}, ${xo}, ${st(be,Es)}))`)}return Lt(is),jt.push({name:xe,hasVar:!1,declaredType:"",op:":=",rhs:`iff(${Bo} and ${hs}, min(${xe} + 1, ${at}), ${xe})`,lineNo:De}),jt}return null},dt=(be,We,de)=>{const De=$[We];if(!De)return null;ot(be,De.size,void 0,De.capacity);const Ee=$[be];if(!Ee)return null;const xe=[];for(let gt=0;gt<Ee.capacity;gt++)xe.push({name:st(be,gt),hasVar:!1,declaredType:"",op:":=",rhs:st(We,gt),lineNo:de});return xe.push({name:Ee.sizeSeries,hasVar:!1,declaredType:"",op:":=",rhs:De.sizeSeries,lineNo:de}),xe},qe=(be,We,de,De)=>{const Ee=$[We],xe=$[de];if(!Ee||!xe)return null;const gt=Math.min(Re,Ee.capacity+xe.capacity);ot(be,Math.min(gt,Ee.size+xe.size),void 0,gt);const at=$[be];if(!at)return null;const jt=[];for(let Lt=0;Lt<at.capacity;Lt++){const Mt=`iff(${Lt} < ${Ee.sizeSeries}, array.get(${We}, ${Lt}), iff(${Lt} < (${Ee.sizeSeries} + ${xe.sizeSeries}), array.get(${de}, ${Lt} - ${Ee.sizeSeries}), na))`;jt.push({name:st(be,Lt),hasVar:!1,declaredType:"",op:":=",rhs:Q(Mt,`${be}_concat_${Lt}`),lineNo:De})}return jt.push({name:at.sizeSeries,hasVar:!1,declaredType:"",op:":=",rhs:`min(${Ee.sizeSeries} + ${xe.sizeSeries}, ${gt})`,lineNo:De}),we(be),jt},me=be=>{const We=String(be||"");let de="",De=0,Ee=null;const xe=We.toLowerCase();for(;De<We.length;){const gt=We[De];if(Ee){de+=gt,gt===Ee&&We[De-1]!=="\\"&&(Ee=null),De+=1;continue}if(gt==="'"||gt==='"'){Ee=gt,de+=gt,De+=1;continue}if(!(xe.startsWith("array.get",De)&&(De===0||!/[a-z0-9_$]/i.test(xe[De-1]||"")))){de+=gt,De+=1;continue}let jt=De+9;for(;jt<We.length&&/\s/.test(We[jt]);)jt+=1;if(We[jt]!=="("){de+=gt,De+=1;continue}let Lt=0,Mt=jt,Io=null;for(;Mt<We.length;Mt++){const Ms=We[Mt];if(Io){Ms===Io&&We[Mt-1]!=="\\"&&(Io=null);continue}if(Ms==="'"||Ms==='"'){Io=Ms;continue}if(Ms==="(")Lt+=1;else if(Ms===")"&&(Lt-=1,Lt===0))break}if(Mt>=We.length){de+=We.slice(De);break}const Bo=We.slice(jt+1,Mt),hs=Xa(Bo),is=String(hs[0]||"").trim(),Es=String(hs[1]||"").trim();if(!/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(is)||!Es){de+=We.slice(De,Mt+1),De=Mt+1;continue}const bt=U(is),kt=B[bt],xo=$[bt];if(!((xo==null?void 0:xo.capacity)??(xo==null?void 0:xo.size)??(kt==null?void 0:kt.length)??0)){de+=We.slice(De,Mt+1),De=Mt+1;continue}const _o=me(Es),go=tt(bt,_o);if(go!=null){if($[bt])de+=st(bt,go);else if(kt){const Ms=kt[go];de+=typeof Ms=="number"&&Number.isFinite(Ms)?String(Ms):"na"}else de+=st(bt,go);De=Mt+1;continue}const fs=Ze(bt,_o);de+=fs??We.slice(De,Mt+1),De=Mt+1}return de},Q=(be,We)=>(()=>{let de=zm(se(Y(be,We),We));return de=ce(de),de=Ge(de),de=me(de),de})(),it=(be,We)=>(()=>{let de=zm(se(Y(be,We),We));return de=W(de),de})(),Vt=(be,We)=>{if(be==null)return{};const de=String(be).trim();return de.startsWith('"')&&de.endsWith('"')||de.startsWith("'")&&de.endsWith("'")?{text:ta(de)}:de?{textExpr:Q(de,We)}:{}},wt=be=>be.when&&sa(sv(Q(String(be.when),"when")))||void 0,Yt=be=>ta(String(be.pane??"main")).toLowerCase()==="sub"?"sub":"main",At=(be,We)=>{if(be.pane!=null)return Yt(be);const de=We?U(String(We)):"";return de&&F[de]||"main"},Gt=(be,We,de)=>{if(!be)return t.push({message:`${We} requires a value`,line:de}),null;const De=Q(String(be),We);return De||(t.push({message:`${We} requires a value`,line:de}),null)},no=be=>{if(!be)return null;const We=ta(String(be||"")).trim();return!We||We.toLowerCase()==="na"?null:U(We)},Do=be=>{if(!be)return;const We=Nu(String(be));if(We)return We;const de=ta(String(be||"").trim());if(de.startsWith("#")||de.startsWith("rgb"))return de},Eo=(be,We)=>{if(!be)return{};const de=Q(String(be),We);if(!de)return{};const De=ye(de);return De!=null?{value:De}:{expr:de}},bs=(be,We)=>{if(be==null)return{};const de=y0(String(be));return de!=null?{value:de}:Eo(be,We)},Is=(be,We)=>{const de=te(be);Array.isArray(de.runtimeDrawOps)||(de.runtimeDrawOps=[]),de.runtimeDrawOps.push(We)},qi=(be,We,de,De)=>{const Ee=Xa(be||""),xe=Vc(Ee),gt=Ee.filter(Es=>!Qc(Es)),at=Gt(gt[0]??xe.x1??xe.x,"line.new x1",We),jt=Gt(gt[1]??xe.y1??xe.y,"line.new y1",We),Lt=Gt(gt[2]??xe.x2,"line.new x2",We),Mt=Gt(gt[3]??xe.y2,"line.new y2",We);if(!at||!jt||!Lt||!Mt)return!0;const Io=Yt(xe),Bo=wt(xe),hs=Eo(xe.width??xe.linewidth,"line.width"),is=de?U(de):void 0;return is&&(F[is]=Io),Is(Io,{kind:"line_new",assign:is,once:De?!0:void 0,x1:at,y1:jt,x2:Lt,y2:Mt,when:Bo,color:Nu(String(xe.color??""))||void 0,width:hs.value,widthExpr:hs.expr,style:sh(String(xe.style??""))||void 0,extend:nh(String(xe.extend??""))||void 0,xloc:Pm(String(xe.xloc??""))||void 0}),!0},Ks=(be,We,de,De)=>{const Ee=Xa(be||""),xe=Vc(Ee),gt=Ee.filter(bt=>!Qc(bt)),at=Gt(gt[0]??xe.x,"label.new x",We);let jt=Gt(gt[1]??xe.y,"label.new y",We);if(!at)return!0;const Lt=gt[2]??xe.text??xe.title??"",Mt=Vt(String(Lt||""),"label_text"),Io=Yt(xe),Bo=wt(xe),hs=k2(String(xe.yloc??""))||void 0;if(hs&&(!jt||String(jt).trim().toLowerCase()==="na")&&(jt=hs==="belowbar"?"low":hs==="abovebar"?"high":jt),!jt)return!0;const is=bs(xe.size,"label.size"),Es=de?U(de):void 0;return Es&&(F[Es]=Io),Is(Io,{kind:"label_new",assign:Es,once:De?!0:void 0,x:at,y:jt,when:Bo,yloc:hs,textAlign:Gf(String(xe.textalign??xe.text_align??xe.textAlign??"")),tooltip:xe.tooltip!=null?ta(String(xe.tooltip)):void 0,text:Mt.text,textExpr:Mt.textExpr,color:Nu(String(xe.color??""))||void 0,textColor:Nu(String(xe.textcolor??xe.textColor??""))||void 0,style:w2(String(xe.style??xe.shape??""))||void 0,size:is.value??y0(String(xe.size??"")),sizeExpr:is.expr,xloc:Pm(String(xe.xloc??""))||void 0}),!0},ws=(be,We,de,De)=>{const Ee=Xa(be||""),xe=Vc(Ee),gt=Ee.filter(fs=>!Qc(fs)),at=Gt(gt[0]??xe.left,"box.new left",We),jt=Gt(gt[1]??xe.top,"box.new top",We),Lt=Gt(gt[2]??xe.right,"box.new right",We),Mt=Gt(gt[3]??xe.bottom,"box.new bottom",We);if(!at||!jt||!Lt||!Mt)return!0;const Io=Yt(xe),Bo=wt(xe),hs=Eo(xe.border_width??xe.borderWidth,"box.border_width"),is=xe.text??"",Es=Vt(String(is||""),"box_text"),bt=bs(xe.text_size??xe.textSize,"box.text_size"),kt=Gf(String(xe.text_halign??xe.textHalign??""))||void 0,xo=Im(String(xe.text_valign??xe.textValign??""))||void 0,$t=xe.text_wrap??xe.textWrap,_o=$t!=null?rm(String($t))??void 0:void 0,go=de?U(de):void 0;return go&&(F[go]=Io),Is(Io,{kind:"box_new",assign:go,once:De?!0:void 0,left:at,top:jt,right:Lt,bottom:Mt,when:Bo,borderColor:Nu(String(xe.border_color??xe.borderColor??""))||void 0,width:hs.value,widthExpr:hs.expr,borderStyle:sh(String(xe.border_style??xe.borderStyle??""))||void 0,bgColor:Nu(String(xe.bgcolor??xe.bgColor??xe.color??""))||void 0,text:Es.text,textExpr:Es.textExpr,textColor:Nu(String(xe.text_color??xe.textColor??""))||void 0,textSize:bt.value,textSizeExpr:bt.expr,textHalign:kt,textValign:xo,textWrap:_o,extend:nh(String(xe.extend??""))||void 0,xloc:Pm(String(xe.xloc??""))||void 0}),!0},vn=(be,We,de,De)=>{const Ee=Xa(be||""),xe=Vc(Ee),gt=Ee.filter(xo=>!Qc(xo)),at=gt[0]??xe.position??xe.pos??"top_right",jt=gt[1]??xe.columns??xe.cols,Lt=gt[2]??xe.rows,Mt=jt!=null?Number(jt):NaN,Io=Lt!=null?Number(Lt):NaN;if(!Number.isFinite(Mt)||!Number.isFinite(Io))return t.push({message:"table.new(position, columns, rows) requires numeric columns/rows",line:We}),!0;const Bo=Yt(xe),hs=wt(xe),is=Eo(xe.border_width??xe.borderWidth,"table.border_width"),Es=Eo(xe.frame_width??xe.frameWidth,"table.frame_width"),bt=bs(xe.text_size??xe.textSize,"table.text_size"),kt=de?U(de):void 0;return kt&&(F[kt]=Bo),Is(Bo,{kind:"table_new",assign:kt,once:De?!0:void 0,when:hs,position:S2(String(at))||ta(String(at)),columns:Math.max(1,Math.floor(Mt)),rows:Math.max(1,Math.floor(Io)),bgcolor:Nu(String(xe.bgcolor??xe.bgColor??""))||void 0,borderColor:Nu(String(xe.border_color??xe.borderColor??""))||void 0,borderWidth:is.value,borderWidthExpr:is.expr,textColor:Nu(String(xe.text_color??xe.textColor??""))||void 0,textSize:bt.value,textSizeExpr:bt.expr,textHalign:Gf(String(xe.text_halign??xe.textHalign??""))||void 0,textValign:Im(String(xe.text_valign??xe.textValign??""))||void 0,frameColor:Nu(String(xe.frame_color??xe.frameColor??""))||void 0,frameWidth:Es.value,frameWidthExpr:Es.expr}),!0},es=(be,We,de="table_cell")=>{const De=Xa(be||""),Ee=Vc(De),xe=De.filter($t=>!Qc($t)),gt=xe[0]??"",at=no(String(gt||""))||"",jt=xe[1]??Ee.column??Ee.col,Lt=xe[2]??Ee.row,Mt=jt!=null?Number(jt):NaN,Io=Lt!=null?Number(Lt):NaN;if(!at||!Number.isFinite(Mt)||!Number.isFinite(Io))return s.push({message:"table.cell(table, column, row, text) requires a table id and numeric column/row",line:We}),!0;const Bo=xe[3]??Ee.text??Ee.title??"",hs=Vt(String(Bo||""),"table_cell_text"),is=bs(Ee.text_size??Ee.textSize,"table.cell_text_size"),Es=Eo(Ee.width,"table.cell_width"),bt=Eo(Ee.height,"table.cell_height"),kt=At(Ee,at),xo={kind:de,target:at,when:wt(Ee),column:Math.floor(Mt),row:Math.floor(Io),text:hs.text,textExpr:hs.textExpr,textColor:Nu(String(Ee.text_color??Ee.textColor??""))||void 0,textSize:is.value,textSizeExpr:is.expr,textHalign:Gf(String(Ee.text_halign??Ee.textHalign??""))||void 0,textValign:Im(String(Ee.text_valign??Ee.textValign??""))||void 0,bgcolor:Nu(String(Ee.bgcolor??Ee.bgColor??""))||void 0,width:Es.value,widthExpr:Es.expr,height:bt.value,heightExpr:bt.expr,tooltip:Ee.tooltip!=null?ta(String(Ee.tooltip)):void 0};return Is(kt,xo),!0},Li=(be,We,de)=>{const De=Xa(We||""),Ee=Vc(De),xe=De.filter(Mt=>!Qc(Mt)),gt=no(xe[0]);if(!gt)return!0;const at=String(be||"").toLowerCase().replace(/_/g,""),jt=At(Ee,gt),Lt={kind:"line_set",target:gt,when:wt(Ee)};if(at==="x1")Lt.x1=Gt(xe[1],"line.set_x1",de);else if(at==="y1")Lt.y1=Gt(xe[1],"line.set_y1",de);else if(at==="x2")Lt.x2=Gt(xe[1],"line.set_x2",de);else if(at==="y2")Lt.y2=Gt(xe[1],"line.set_y2",de);else if(at==="xy1")Lt.x1=Gt(xe[1],"line.set_xy1 x",de),Lt.y1=Gt(xe[2],"line.set_xy1 y",de);else if(at==="xy2")Lt.x2=Gt(xe[1],"line.set_xy2 x",de),Lt.y2=Gt(xe[2],"line.set_xy2 y",de);else if(at==="xy")Lt.x1=Gt(xe[1],"line.set_xy x1",de),Lt.y1=Gt(xe[2],"line.set_xy y1",de),Lt.x2=Gt(xe[3],"line.set_xy x2",de),Lt.y2=Gt(xe[4],"line.set_xy y2",de);else if(at==="color")Lt.color=Do(xe[1]??Ee.color);else if(at==="width"||at==="linewidth"){const Mt=Eo(xe[1]??Ee.width,"line.set_width");Lt.width=Mt.value,Lt.widthExpr=Mt.expr}else if(at==="style")Lt.style=sh(String(xe[1]??Ee.style??""))||void 0;else if(at==="extend")Lt.extend=nh(String(xe[1]??Ee.extend??""))||void 0;else if(at==="xloc")Lt.xloc=Pm(String(xe[1]??Ee.xloc??""))||void 0;else return s.push({message:`Unsupported line.set_${be}()`,line:de}),!0;return Is(jt,Lt),!0},ci=(be,We)=>{const de=Xa(be||""),De=Vc(de),Ee=de.filter(at=>!Qc(at)),xe=no(Ee[0]);if(!xe)return!0;const gt=At(De,xe);return Is(gt,{kind:"line_delete",target:xe,when:wt(De)}),!0},oa=(be,We,de,De)=>{const Ee=Xa(be||""),xe=Vc(Ee),gt=Ee.filter(Bo=>!Qc(Bo)),at=no(gt[0]??xe.line1??xe.line_1??xe.l1),jt=no(gt[1]??xe.line2??xe.line_2??xe.l2);if(!at||!jt)return s.push({message:"linefill.new(line1, line2) requires two line ids",line:We}),!0;const Lt=At(xe,at||jt),Mt=wt(xe),Io=de?U(de):void 0;return Io&&(F[Io]=Lt),Is(Lt,{kind:"linefill_new",assign:Io,once:De?!0:void 0,when:Mt,line1:at,line2:jt,color:Do(gt[2]??xe.color??xe.fillcolor)}),!0},ol=(be,We,de)=>{const De=Xa(We||""),Ee=Vc(De),xe=De.filter(Mt=>!Qc(Mt)),gt=no(xe[0]);if(!gt)return!0;const at=String(be||"").toLowerCase().replace(/_/g,""),jt=At(Ee,gt),Lt={kind:"linefill_set",target:gt,when:wt(Ee)};if(at==="color")Lt.color=Do(xe[1]??Ee.color??Ee.fillcolor);else if(at==="line1")Lt.line1=no(xe[1]??Ee.line1??Ee.line_1??Ee.l1)||void 0;else if(at==="line2")Lt.line2=no(xe[1]??Ee.line2??Ee.line_2??Ee.l2)||void 0;else return s.push({message:`Unsupported linefill.set_${be}()`,line:de}),!0;return Is(jt,Lt),!0},Xi=(be,We)=>{const de=Xa(be||""),De=Vc(de),Ee=de.filter(at=>!Qc(at)),xe=no(Ee[0]);if(!xe)return!0;const gt=At(De,xe);return Is(gt,{kind:"linefill_delete",target:xe,when:wt(De)}),!0},fc=(be,We,de)=>{const De=Xa(We||""),Ee=Vc(De),xe=De.filter(Mt=>!Qc(Mt)),gt=no(xe[0]);if(!gt)return!0;const at=String(be||"").toLowerCase().replace(/_/g,""),jt=At(Ee,gt),Lt={kind:"label_set",target:gt,when:wt(Ee)};if(at==="x")Lt.x=Gt(xe[1],"label.set_x",de);else if(at==="y")Lt.y=Gt(xe[1],"label.set_y",de);else if(at==="xy")Lt.x=Gt(xe[1],"label.set_xy x",de),Lt.y=Gt(xe[2],"label.set_xy y",de);else if(at==="text"){const Mt=Vt(String(xe[1]??Ee.text??""),"label_set_text");Lt.text=Mt.text,Lt.textExpr=Mt.textExpr}else if(at==="color")Lt.color=Do(xe[1]??Ee.color);else if(at==="textcolor")Lt.textColor=Do(xe[1]??Ee.textcolor??Ee.textColor);else if(at==="style")Lt.style=w2(String(xe[1]??Ee.style??""))||void 0;else if(at==="size"){const Mt=bs(xe[1]??Ee.size,"label.set_size");Lt.size=Mt.value??y0(String(xe[1]??Ee.size??"")),Lt.sizeExpr=Mt.expr}else if(at==="yloc")Lt.yloc=k2(String(xe[1]??Ee.yloc??""))||void 0;else if(at==="textalign")Lt.textAlign=Gf(String(xe[1]??Ee.textalign??Ee.textAlign??""))||void 0;else if(at==="tooltip")Lt.tooltip=xe[1]!=null?ta(String(xe[1])):void 0;else if(at==="xloc")Lt.xloc=Pm(String(xe[1]??Ee.xloc??""))||void 0;else return s.push({message:`Unsupported label.set_${be}()`,line:de}),!0;return Is(jt,Lt),!0},rd=(be,We)=>{const de=Xa(be||""),De=Vc(de),Ee=de.filter(at=>!Qc(at)),xe=no(Ee[0]);if(!xe)return!0;const gt=At(De,xe);return Is(gt,{kind:"label_delete",target:xe,when:wt(De)}),!0},ml=(be,We,de)=>{const De=Xa(We||""),Ee=Vc(De),xe=De.filter(Mt=>!Qc(Mt)),gt=no(xe[0]);if(!gt)return!0;const at=String(be||"").toLowerCase().replace(/_/g,""),jt=At(Ee,gt),Lt={kind:"box_set",target:gt,when:wt(Ee)};if(at==="left")Lt.left=Gt(xe[1],"box.set_left",de);else if(at==="right")Lt.right=Gt(xe[1],"box.set_right",de);else if(at==="top")Lt.top=Gt(xe[1],"box.set_top",de);else if(at==="bottom")Lt.bottom=Gt(xe[1],"box.set_bottom",de);else if(at==="bgcolor")Lt.bgColor=Do(xe[1]??Ee.bgcolor??Ee.bgColor);else if(at==="bordercolor")Lt.borderColor=Do(xe[1]??Ee.border_color??Ee.borderColor);else if(at==="borderwidth"){const Mt=Eo(xe[1]??Ee.border_width??Ee.borderWidth,"box.set_border_width");Lt.width=Mt.value,Lt.widthExpr=Mt.expr}else if(at==="borderstyle")Lt.borderStyle=sh(String(xe[1]??Ee.border_style??Ee.borderStyle??""))||void 0;else if(at==="text"){const Mt=Vt(String(xe[1]??Ee.text??""),"box_set_text");Lt.text=Mt.text,Lt.textExpr=Mt.textExpr}else if(at==="textcolor")Lt.textColor=Do(xe[1]??Ee.text_color??Ee.textColor);else if(at==="textsize"){const Mt=bs(xe[1]??Ee.text_size??Ee.textSize,"box.set_text_size");Lt.textSize=Mt.value,Lt.textSizeExpr=Mt.expr}else if(at==="texthalign")Lt.textHalign=Gf(String(xe[1]??Ee.text_halign??Ee.textHalign??""))||void 0;else if(at==="textvalign")Lt.textValign=Im(String(xe[1]??Ee.text_valign??Ee.textValign??""))||void 0;else if(at==="textwrap"){const Mt=xe[1]??Ee.text_wrap??Ee.textWrap;Mt!=null&&(Lt.textWrap=rm(String(Mt))??void 0)}else if(at==="extend")Lt.extend=nh(String(xe[1]??Ee.extend??""))||void 0;else if(at==="xloc")Lt.xloc=Pm(String(xe[1]??Ee.xloc??""))||void 0;else return s.push({message:`Unsupported box.set_${be}()`,line:de}),!0;return Is(jt,Lt),!0},Jl=(be,We)=>{const de=Xa(be||""),De=Vc(de),Ee=de.filter(at=>!Qc(at)),xe=no(Ee[0]);if(!xe)return!0;const gt=At(De,xe);return Is(gt,{kind:"box_delete",target:xe,when:wt(De)}),!0},Wl=(be,We,de)=>{const De=Xa(We||""),Ee=Vc(De),xe=De.filter(Mt=>!Qc(Mt)),gt=no(xe[0]);if(!gt)return!0;const at=String(be||"").toLowerCase().replace(/_/g,""),jt=At(Ee,gt),Lt={kind:"table_set",target:gt,when:wt(Ee)};if(at==="position")Lt.position=S2(String(xe[1]??Ee.position??""))||ta(String(xe[1]??Ee.position??""));else if(at==="bgcolor")Lt.bgcolor=Do(xe[1]??Ee.bgcolor??Ee.bgColor);else if(at==="bordercolor")Lt.borderColor=Do(xe[1]??Ee.border_color??Ee.borderColor);else if(at==="borderwidth"){const Mt=Eo(xe[1]??Ee.border_width??Ee.borderWidth,"table.set_border_width");Lt.borderWidth=Mt.value,Lt.borderWidthExpr=Mt.expr}else if(at==="textcolor")Lt.textColor=Do(xe[1]??Ee.text_color??Ee.textColor);else if(at==="textsize"){const Mt=bs(xe[1]??Ee.text_size??Ee.textSize,"table.set_text_size");Lt.textSize=Mt.value,Lt.textSizeExpr=Mt.expr}else if(at==="texthalign")Lt.textHalign=Gf(String(xe[1]??Ee.text_halign??Ee.textHalign??""))||void 0;else if(at==="textvalign")Lt.textValign=Im(String(xe[1]??Ee.text_valign??Ee.textValign??""))||void 0;else if(at==="framecolor")Lt.frameColor=Do(xe[1]??Ee.frame_color??Ee.frameColor);else if(at==="framewidth"){const Mt=Eo(xe[1]??Ee.frame_width??Ee.frameWidth,"table.set_frame_width");Lt.frameWidth=Mt.value,Lt.frameWidthExpr=Mt.expr}else return s.push({message:`Unsupported table.set_${be}()`,line:de}),!0;return Is(jt,Lt),!0},sl=(be,We)=>{const de=Xa(be||""),De=Vc(de),Ee=de.filter(at=>!Qc(at)),xe=no(Ee[0]);if(!xe)return!0;const gt=At(De,xe);return Is(gt,{kind:"table_delete",target:xe,when:wt(De)}),!0},Uc=(be,We)=>{const de=Xa(be||""),De=Vc(de),Ee=de.filter(Lt=>!Qc(Lt)),xe=no(Ee[0]);if(!xe)return!0;const gt=At(De,xe),at=(Lt,Mt)=>{if(!(Lt==null||String(Lt).trim()===""))return Gt(String(Lt),Mt,We)||void 0},jt={kind:"table_clear",target:xe,when:wt(De)};return jt.startColumn=at(Ee[1]??De.start_column??De.start_col,"table.clear start_column"),jt.startRow=at(Ee[2]??De.start_row,"table.clear start_row"),jt.endColumn=at(Ee[3]??De.end_column??De.end_col,"table.clear end_column"),jt.endRow=at(Ee[4]??De.end_row,"table.clear end_row"),Is(gt,jt),!0},Nl=(be,We)=>{const de=Xa(be||""),De=Vc(de),Ee=de.filter(Bo=>!Qc(Bo)),xe=no(Ee[0]);if(!xe)return!0;const gt=Ee[1]??De.left,at=Ee[2]??De.top,jt=Ee[3]??De.right,Lt=Ee[4]??De.bottom;if(gt==null||at==null||jt==null||Lt==null)return s.push({message:"table.merge(table, left, top, right, bottom) requires 4 numeric args",line:We}),!0;const Mt=At(De,xe),Io={kind:"table_merge",target:xe,when:wt(De)};return Io.left=Gt(String(gt),"table.merge left",We)||void 0,Io.top=Gt(String(at),"table.merge top",We)||void 0,Io.right=Gt(String(jt),"table.merge right",We)||void 0,Io.bottom=Gt(String(Lt),"table.merge bottom",We)||void 0,Is(Mt,Io),!0},Yc=(be,We,de)=>{const De=Xa(We||""),Ee=Vc(De),xe=De.filter(Es=>!Qc(Es)),gt=xe[0]??"",at=no(String(gt||""))||"",jt=xe[1]??Ee.column??Ee.col,Lt=xe[2]??Ee.row,Mt=jt!=null?Number(jt):NaN,Io=Lt!=null?Number(Lt):NaN;if(!at||!Number.isFinite(Mt)||!Number.isFinite(Io))return s.push({message:"table.cell_set_* requires a table id and numeric column/row",line:de}),!0;const Bo=String(be||"").toLowerCase().replace(/_/g,""),hs=At(Ee,at),is={kind:"table_cell_set",target:at,when:wt(Ee),column:Math.floor(Mt),row:Math.floor(Io)};if(Bo==="text"){const Es=Vt(String(xe[3]??Ee.text??""),"table_cell_set_text");is.text=Es.text,is.textExpr=Es.textExpr}else if(Bo==="textcolor")is.textColor=Do(xe[3]??Ee.text_color??Ee.textColor);else if(Bo==="bgcolor")is.bgcolor=Do(xe[3]??Ee.bgcolor??Ee.bgColor);else if(Bo==="textsize"){const Es=bs(xe[3]??Ee.text_size??Ee.textSize,"table.cell_set_text_size");is.textSize=Es.value,is.textSizeExpr=Es.expr}else if(Bo==="texthalign")is.textHalign=Gf(String(xe[3]??Ee.text_halign??Ee.textHalign??""))||void 0;else if(Bo==="textvalign")is.textValign=Im(String(xe[3]??Ee.text_valign??Ee.textValign??""))||void 0;else if(Bo==="width"){const Es=Eo(xe[3]??Ee.width,"table.cell_set_width");is.width=Es.value,is.widthExpr=Es.expr}else if(Bo==="height"){const Es=Eo(xe[3]??Ee.height,"table.cell_set_height");is.height=Es.value,is.heightExpr=Es.expr}else if(Bo==="tooltip")is.tooltip=xe[3]!=null?ta(String(xe[3])):void 0;else return s.push({message:`Unsupported table.cell_set_${be}()`,line:de}),!0;return Is(hs,is),!0};for(let be=0;be<a.length;be++){const We=a[be],de=We.text.match(/^([A-Za-z_$][A-Za-z0-9_$]*)\s*\((.*)\)\s*=>\s*(.*)$/);if(!de)continue;const De=de[1],Ee=de[2]||"";let xe=String(de[3]||"").trim();if(!xe){const jt=We.indent,Lt=[];let Mt=be+1;for(;Mt<a.length&&a[Mt].indent>jt;)a[Mt].text.startsWith("//@pine_fn")||Lt.push(a[Mt]),Mt+=1;const Io=Lt.map(is=>String(is.text||"").trim()).filter(Boolean);if(!Io.length){t.push({message:`Function "${De}" requires a body expression`,line:We.lineNo});continue}const Bo=Io[Io.length-1];xe=Bo.replace(/^return\s+/i,"").trim()||Bo,Io.length>1&&s.push({message:`Function "${De}" uses only the final expression; earlier lines are ignored.`,line:We.lineNo});for(let is=be+1;is<Mt;is++)a[is]={...a[is],text:"//@pine_fn"};be=Mt-1}const gt=Xa(Ee).map(jt=>String(jt||"").trim()).filter(Boolean).map(jt=>{const Lt=jt.match(/^(?:(?:varip|var)\s+)?(?:float|int|bool|string)\s+([A-Za-z_$][A-Za-z0-9_$]*)$/i);return(Lt?Lt[1]:jt).trim()}),at=U(De);j[at]&&s.push({message:`Duplicate function definition "${De}" (later definition overrides).`,line:We.lineNo}),j[at]={name:De,args:gt,body:xe,lineNo:We.lineNo},a[be]={...We,text:"//@pine_fn"}}const Ec=be=>{const We=String(be||"").trim(),de=U(We),De=T[de];return De||We},Ja=be=>{const We=/\b[A-Za-z_$][A-Za-z0-9_$]*\b/g,de=new Map,De=new Set,Ee=gt=>{const at=U(gt);if(de.has(at))return de.get(at);const jt=T[at];if(!jt)return gt;if(De.has(at))return jt;De.add(at);const Lt=String(jt).replace(We,Mt=>{const Io=U(Mt);return T[Io]?`(${Ee(Io)})`:Mt});return De.delete(at),de.set(at,Lt),Lt},xe=Ec(be);return String(xe).replace(We,gt=>{const at=U(gt);return T[at]?`(${Ee(at)})`:gt})},sa=be=>{const We=/\b[A-Za-z_$][A-Za-z0-9_$]*\b/g,de=new Map,De=new Set,Ee=Io=>{const Bo=U(Io);if(de.has(Bo))return de.get(Bo);const hs=T[Bo];if(!hs)return Io;if(De.has(Bo))return hs;De.add(Bo);const is=String(hs).replace(We,Es=>{const bt=U(Es);return T[bt]?`(${Ee(bt)})`:Es});return De.delete(Bo),de.set(Bo,is),is},xe=Ec(be),gt=String(xe).replace(We,Io=>{const Bo=U(Io);return T[Bo]?`(${Ee(Bo)})`:Io}),at=new Set(_.map(Io=>U(String((Io==null?void 0:Io.name)||""))).filter(Boolean)),jt=new Set(Object.keys(I||{}).map(Io=>U(Io)).filter(Boolean)),Lt=new Set(["open","high","low","close","volume","time","and","or","not","true","false","crossesabove","crossesbelow"]);return gt.replace(We,(Io,Bo)=>{const hs=U(Io);if(!hs||Lt.has(hs))return Io;const is=gt.slice(Bo+Io.length);return/^\s*\(/.test(is)||!jt.has(hs)||at.has(hs)?Io:`\${${Io}}`})},jl=(be,We)=>{const de=String(be||"").trim(),De=Q(de,We),Ee=De.match(/^[A-Za-z_$][A-Za-z0-9_$]*$/);if(Ee)return Ee[0];const xe=Ev(De);if(xe!=null){const Lt=`__const_${String(xe).replace(/[^\d]/g,"_")}`;return _.some(Mt=>Mt.name.toLowerCase()===Lt.toLowerCase())||_.push({name:Lt,expr:String(xe)}),Lt}const gt=We.replace(/[^A-Za-z0-9_]+/g,"_").toLowerCase();let at=`__${gt||"expr"}`,jt=1;for(;_.some(Lt=>Lt.name.toLowerCase()===at.toLowerCase());)jt+=1,at=`__${gt||"expr"}_${jt}`;return _.push({name:at,expr:De}),at},Td=(be,We,de)=>{const De=We.match(/^input\.(int|float|bool|string)\s*\((.*)\)\s*$/i);if(!De)return!1;const Ee=De[1].toLowerCase(),xe=Xa(De[2]||""),gt=Vc(xe),at=xe.filter(kt=>!Qc(kt)),jt=gt.defval??at[0]??"",Lt=gt.title??at[1]??"",Mt=Lt?ta(String(Lt)):void 0,Io=kt=>{t.push({message:kt,line:de})},Bo=kt=>{const xo=typeof kt=="number"?kt:Number(kt);return Number.isFinite(xo)?xo:void 0},hs=Bo(gt.minval),is=Bo(gt.maxval),Es=Bo(gt.step);let bt=null;if(Ee==="bool"){const kt=rm(String(jt));if(kt==null)return Io(`input.bool() requires defval true/false for "${be}"`),!0;bt=kt}else if(Ee==="string")bt=ta(String(jt||""));else{const kt=Bo(jt);if(kt==null)return Io(`input.${Ee}() requires numeric defval for "${be}"`),!0;bt=Ee==="int"?Math.floor(kt):kt}return I[be]=bt,C.push({name:be,type:Ee,title:Mt,defval:bt,minval:hs,maxval:is,step:Es}),!0},_d=be=>{const We=be.qty_percent??be.qtyPct??be.qtyPctVal??be.qtyPercent,de=We!=null?Number(We):void 0,De=be.qty??be.quantity,Ee=be.cash??be.cashQty??be.cash_qty,xe=be.oco??be.oca_name??be.ocaName??be.oca,gt=xe?ta(String(xe)):void 0,at=be.expiresBars!=null?Number(be.expiresBars):void 0,jt=be.stop??be.stopPrice,Lt=be.limit??be.limitPrice,Mt=be.price,Io=(xo,$t)=>{if(xo==null)return null;const _o=Q(String(xo),$t);if(!_o)return null;const go=_o.match(/^[A-Za-z_$][A-Za-z0-9_$]*$/);if(go)return go[0];const fs=Ev(ta(_o));return fs!=null?String(fs):jl(_o,$t)},Bo=Io(jt,"order_stop"),hs=Io(Lt,"order_limit"),is=Io(Mt,"order_price"),Es=Io(De,"order_qty"),bt=Io(Ee,"order_cash"),kt={};return typeof de=="number"&&Number.isFinite(de)&&(kt.qtyPct=de),Es&&(kt.qty=Es),bt&&(kt.cash=bt),gt&&(kt.oco=gt),typeof at=="number"&&Number.isFinite(at)&&(kt.expiresBars=at),Bo&&hs?(kt.kind="stop_limit",kt.stopPrice=Bo,kt.limitPrice=hs,kt):hs?(kt.kind="limit",kt.price=hs,kt):Bo?(kt.kind="stop",kt.price=Bo,kt):is?(kt.kind="market",kt):Object.keys(kt).length?{kind:"market",...kt}:null};for(let be=0;be<a.length;be++){const We=a[be],de=We.lineNo;let De=We.text;if(!De||De.startsWith("//@pine_fn"))continue;const Ee=De.match(/^for\s+([A-Za-z_$][A-Za-z0-9_$]*)\s*=\s*(.+?)\s+to\s+(.+?)(?:\s+by\s+(.+))?$/i);if(Ee){const ue=Ee[1],Fe=String(Ee[2]??"").trim(),ut=String(Ee[3]??"").trim(),Xe=String(Ee[4]??"1").trim(),ht=it(Fe,"for_start"),ao=it(ut,"for_end"),It=it(Xe,"for_step"),eo=ye(ht),Mo=ye(ao),ho=ye(It);if(ho===0){t.push({message:"for-loop step must not be 0",line:de});continue}const to=[],ds=We.indent;let js=be+1;for(;js<a.length&&a[js].indent>ds;)a[js].text.startsWith("//@pine_fn")||to.push(a[js]),js+=1;if(!to.length){t.push({message:"for-loop requires an indented body",line:de});continue}const Si=(Zs,gn)=>{let Wn=Zs;return typeof gn=="number"&&(Wn=Wn.replace(/\barray\.get\s*\(\s*([A-Za-z_$][A-Za-z0-9_$]*)\s*,\s*([A-Za-z_$][A-Za-z0-9_$]*|[-+]?\d+(?:\.\d+)?)\s*\)/gi,(Tn,Ko,Qt)=>{const H=U(String(Ko));if($[H])return Tn;const Me=B[H];if(!Me)return Tn;const Ue=U(String(Qt))===U(ue)?Math.floor(gn):Ev(String(Qt))!=null?Math.floor(Ev(String(Qt))):NaN;if(!Number.isFinite(Ue))return Tn;const yt=Me[Ue];return typeof yt=="number"&&Number.isFinite(yt)?String(yt):"na"})),J(Wn,{[ue]:String(gn)})};if(eo!=null&&Mo!=null&&ho!=null&&ho!==0){const Zs=[];if(ho>0)for(let Wn=eo;Wn<=Mo+1e-12;Wn+=ho)for(const Tn of to)Zs.push({...Tn,text:Si(Tn.text,Wn),indent:ds,loopSeq:!0});else for(let Wn=eo;Wn>=Mo-1e-12;Wn+=ho)for(const Tn of to)Zs.push({...Tn,text:Si(Tn.text,Wn),indent:ds,loopSeq:!0});a.splice(be,js-be,...Zs),be-=1;continue}const $r=Q(Fe,`for_start_${ue}`),pa=Q(ut,`for_end_${ue}`),En=Q(Xe,`for_step_${ue}`);if(ye(En)===0){t.push({message:"for-loop step must not be 0",line:de});continue}s.push({message:`Runtime for-loop expanded to ${Ke} iterations`,line:de});const Rs=[];for(let Zs=0;Zs<Ke;Zs++){const gn=`(${$r}) + (${En}) * ${Zs}`,Wn=`(${En}) != 0 and (((${En}) > 0 and (${gn}) <= (${pa})) or (((${En}) < 0) and (${gn}) >= (${pa})))`;Rs.push({text:`if (${Wn})`,indent:ds,lineNo:de,loopSeq:!0});for(const Tn of to)Rs.push({...Tn,text:Si(Tn.text,`(${gn})`),loopSeq:!0})}a.splice(be,js-be,...Rs),be-=1;continue}const xe=De.match(/^while\s*(?:\((.*)\)|(.*))$/i);if(xe){const ue=String(xe[1]??xe[2]??"").trim();if(!ue){t.push({message:"while statement missing condition",line:de});continue}const Fe=We.indent,ut=[];let Xe=be+1;for(;Xe<a.length&&a[Xe].indent>Fe;)a[Xe].text.startsWith("//@pine_fn")||ut.push(a[Xe]),Xe+=1;if(!ut.length){t.push({message:"while-loop requires an indented body",line:de});continue}s.push({message:`Runtime while-loop expanded to ${Ke} iterations`,line:de});const ht=[];for(let ao=0;ao<Ke;ao++){ht.push({text:`if (${ue})`,indent:Fe,lineNo:de,loopSeq:!0});for(const It of ut)ht.push({...It,loopSeq:!0})}a.splice(be,Xe-be,...ht),be-=1;continue}const gt=De.match(/^if\s*(?:\((.*)\)|(.*))$/i);if(gt){const ue=String(gt[1]??gt[2]??"").trim();if(!ue){t.push({message:"if statement missing condition",line:de});continue}const Fe=We.indent,ut=Ko=>{const Qt=[];let H=Ko;for(;H<a.length&&a[H].indent>Fe;)a[H].text.startsWith("//@pine_fn")||Qt.push(a[H]),H+=1;return{body:Qt,nextIdx:H}},Xe=[],ht=ut(be+1);if(!ht.body.length){t.push({message:"if statement requires an indented body",line:de});continue}Xe.push({condRaw:ue,body:ht.body,lineNo:de});let ao=ht.nextIdx;for(;ao<a.length&&a[ao].indent===Fe;){const Ko=a[ao].text.trim(),Qt=Ko.match(/^else\s+if\s*(?:\((.*)\)|(.*))$/i);if(Qt){const Me=String(Qt[1]??Qt[2]??"").trim();if(!Me){t.push({message:"else if missing condition",line:a[ao].lineNo});break}const Ue=ut(ao+1);if(!Ue.body.length){t.push({message:"else if requires an indented body",line:a[ao].lineNo});break}Xe.push({condRaw:Me,body:Ue.body,lineNo:a[ao].lineNo}),ao=Ue.nextIdx;continue}if(Ko.match(/^else$/i)){const Me=ut(ao+1);if(!Me.body.length){t.push({message:"else requires an indented body",line:a[ao].lineNo});break}Xe.push({condRaw:void 0,body:Me.body,lineNo:a[ao].lineNo}),ao=Me.nextIdx;break}break}const It=[],eo=[];Xe.forEach((Ko,Qt)=>{if(!Ko.condRaw){It.push(null),eo.push(null);return}const H=Q(Ko.condRaw,`if_${Qt+1}`);It.push(Ja(H)),eo.push(sa(sv(H)))});const Mo=(Ko,Qt)=>{const H=Ko.slice(0,Qt).filter(Boolean);return H.length?H.map(Me=>`(${Me})`).join(" or "):""},ho=Ko=>{const Qt=It[Ko],H=Mo(It,Ko);return Qt?H?`((${Qt}) and not (${H}))`:`(${Qt})`:H?`not (${H})`:"1"},to=Ko=>{const Qt=eo[Ko],H=Mo(eo,Ko);return Qt?H?`((${Qt}) and not (${H}))`:`(${Qt})`:H?`not (${H})`:"1"},ds=(Ko,Qt)=>{var he,ke;const H=Ko.match(/^array\.set\s*\((.*)\)\s*$/i);if(H){const Ne=Xa(H[1]||""),ie=String(Ne[0]||"").trim(),Ct=String(Ne[1]||"").trim(),Kt=String(Ne[2]||"").trim();if(!ie||!Ct||!Kt)return t.push({message:"array.set(name, index, value) requires 3 args",line:Qt}),null;const fo=U(ie),mo=B[fo],Go=$[fo];if(!mo&&!Go)return t.push({message:`array.set unknown array "${ie}"`,line:Qt}),null;const Fo=tt(fo,Ct);if(Fo!=null){const gi=(Go==null?void 0:Go.size)??(mo==null?void 0:mo.length)??Fo+1;ot(fo,gi,mo);const kn=Q(Kt,`${fo}_${Fo}`),_r=ye(kn);return mo&&_r!=null&&(mo[Fo]=_r),[{name:st(fo,Fo),hasVar:!1,declaredType:"",op:":=",rhs:kn,lineNo:Qt}]}const Wo=Q(Ct,`${fo}_idx`),us=Q(Kt,`${fo}_set`),Un=(he=$[fo])==null?void 0:he.sizeSeries,or=Un!=null?`(${Wo}) >= 0 and (${Wo}) < ${Un}`:void 0,$s=ct(fo,Wo,us,or);return $s?$s.map((gi,kn)=>({name:st(fo,kn),hasVar:!1,declaredType:"",op:":=",rhs:gi,lineNo:Qt})):(t.push({message:"array.set index must be within array size",line:Qt}),null)}const Me=Ko.match(/^array\.(push|pop|shift|unshift|insert|remove|clear|resize)\s*\((.*)\)\s*$/i);if(Me){const Ne=String(Me[1]||"").toLowerCase(),ie=Xa(Me[2]||""),Ct=String(ie[0]||"").trim(),Kt=U(Ct);if(!Ct)return t.push({message:`array.${Ne} requires array name`,line:Qt}),null;if(!$[Kt]&&!B[Kt])return t.push({message:`array.${Ne} unknown array "${Ct}"`,line:Qt}),null;!$[Kt]&&B[Kt]&&ot(Kt,B[Kt].length,B[Kt]);const fo=$[Kt];if(!fo)return null;if(Ne==="push"||Ne==="unshift"||Ne==="insert"){const Fo=Math.min(Re,Math.max(fo.capacity,fo.size+Ce));nt(Kt,Fo)}if(Ne==="resize"){const Fo=String(ie[1]||"0"),Wo=ye(Fo);if(Wo!=null){const us=Math.min(Re,Math.max(fo.capacity,Math.floor(Wo)));nt(Kt,us)}}we(Kt);const mo={};Ne==="push"||Ne==="unshift"?mo.value=ie[1]:Ne==="insert"?(mo.index=ie[1],mo.value=ie[2]):Ne==="remove"?mo.index=ie[1]:Ne==="resize"&&(mo.size=ie[1]);const Go=ze(Kt,Ne,mo,Qt);return Go||null}const Ue=Ko.match(/^(varip\s+|var\s+)?(?:(float|int|bool|string|line|label|box|table|linefill)\s+)?([A-Za-z_$][A-Za-z0-9_$]*)\s*(:=|=)\s*(.+)$/i);if(!Ue)return null;const yt=String(Ue[5]||"").trim();if(/^(line|label|box|table|linefill)\.new\s*\(/i.test(yt)||/^table\.cell\s*\(/i.test(yt))return null;const St=yt.match(/^array\.(pop|shift|remove)\s*\((.*)\)\s*$/i);if(St){const Ne=String(St[1]||"").toLowerCase(),ie=Xa(St[2]||""),Ct=String(ie[0]||"").trim(),Kt=U(Ct);if(!Ct)return t.push({message:`array.${Ne} requires array name`,line:Qt}),null;if(!$[Kt]&&!B[Kt])return t.push({message:`array.${Ne} unknown array "${Ct}"`,line:Qt}),null;if(!$[Kt]&&B[Kt]&&ot(Kt,B[Kt].length,B[Kt]),!$[Kt])return null;we(Kt);const mo=Ne==="pop"?`array.size(${Ct}) - 1`:Ne==="shift"?"0":String(ie[1]||"0"),Go=Q(`array.get(${Ct}, ${mo})`,Ue[3]||"array_pop"),Fo=ze(Kt,Ne==="pop"?"pop":Ne==="shift"?"shift":"remove",{index:ie[1]},Qt);return Fo?[{name:Ue[3],hasVar:!!Ue[1],declaredType:Ue[2]?String(Ue[2]).toLowerCase():"",op:Ue[4],rhs:Go,lineNo:Qt},...Fo]:null}const lo=yt.match(/^array\.(copy|concat)\s*\((.*)\)\s*$/i);if(lo){const Ne=String(lo[1]||"").toLowerCase(),ie=Xa(lo[2]||""),Ct=U(Ue[3]);if(Ne==="copy"){const Wo=String(ie[0]||"").trim(),us=U(Wo);if(!Wo)return t.push({message:"array.copy requires source array name",line:Qt}),null;if(!$[us]&&!B[us])return t.push({message:`array.copy unknown array "${Wo}"`,line:Qt}),null;!$[us]&&B[us]&&ot(us,B[us].length,B[us]);const Un=dt(Ct,us,Qt);return Un?((ke=$[us])!=null&&ke.dynamic&&$[Ct]&&($[Ct].dynamic=!0),Un):null}const Kt=String(ie[0]||"").trim(),fo=String(ie[1]||"").trim(),mo=U(Kt),Go=U(fo);if(!Kt||!fo)return t.push({message:"array.concat requires two arrays",line:Qt}),null;if(!$[mo]&&!B[mo])return t.push({message:`array.concat unknown array "${Kt}"`,line:Qt}),null;if(!$[Go]&&!B[Go])return t.push({message:`array.concat unknown array "${fo}"`,line:Qt}),null;!$[mo]&&B[mo]&&ot(mo,B[mo].length,B[mo]),!$[Go]&&B[Go]&&ot(Go,B[Go].length,B[Go]);const Fo=qe(Ct,mo,Go,Qt);return Fo||null}return[{name:Ue[3],hasVar:!!Ue[1],declaredType:Ue[2]?String(Ue[2]).toLowerCase():"",op:Ue[4],rhs:Q(yt,Ue[3]),lineNo:Qt}]},js={},Si=[],$r=(Ko,Qt)=>{for(const H of Ko){const Me=ds(H.text,H.lineNo);if(Me){for(const Ue of Me){const yt=U(Ue.name),St=js[yt]||(js[yt]={base:void 0,branches:new Array(Xe.length).fill(null)});St.base||(St.base=Ue),St.branches[Qt]=Ue}continue}Si.push({text:H.text,lineNo:H.lineNo,branchIndex:Qt})}};Xe.forEach((Ko,Qt)=>$r(Ko.body,Qt));const pa=(Ko,Qt)=>{let H=!1;const Me=Ko.map(Ue=>H||Qc(Ue)?Ue:(H=!0,Qt));return H||Me.unshift(Qt),Me},En=(Ko,Qt,H)=>{const Me=Qt.match(new RegExp(`^${Ko}\\s*\\((.*)\\)\\s*$`,"i"));if(!Me)return null;const Ue=Xa(Me[1]||""),yt=ho(H),St=to(H);if(Ko==="plot"){const ke=Ue.find(ie=>!Qc(ie))||"",Ne=`iff(${yt}, ${ke||"na"}, na)`;return`${Ko}(${pa(Ue,Ne).join(", ")})`}const lo=Ue.find(ke=>!Qc(ke))||"",he=lo?`${St} and (${lo})`:St;return`${Ko}(${pa(Ue,he).join(", ")})`},za=(Ko,Qt)=>{const H=Ko.match(/^signal\s+([A-Za-z_$][A-Za-z0-9_$]*)\s+when\s+(.+)$/i);if(!H)return null;const Me=H[1],Ue=String(H[2]||"").trim(),yt=to(Qt),St=Ue?`${yt} and (${Ue})`:yt;return`signal ${Me} when ${St}`},Rs=(Ko,Qt)=>{const H=Ko.match(/^(strategy\.(entry|exit|close|close_all|order|cancel|cancel_all))\s*\((.*)\)\s*$/i);if(!H)return null;const Me=H[1],Ue=Xa(H[3]||""),yt=to(Qt);let St=!1;const lo=Ue.map(he=>/^\s*when\s*=/.test(he)?(St=!0,`when=${yt} and (${he.replace(/^\s*when\s*=\s*/i,"")})`):he);return St||lo.push(`when=${yt}`),`${Me}(${lo.join(", ")})`},Zs=(Ko,Qt,H)=>{const Me=Qt.match(new RegExp(`^(?:varip\\s+|var\\s+)?(?:(?:float|int|bool|string|line|label|box|table|linefill)\\s+)?[A-Za-z_$][A-Za-z0-9_$]*\\s*(?::=|=)\\s*${Ko}\\s*\\((.*)\\)\\s*$`,"i")),Ue=Qt.match(new RegExp(`^${Ko}\\s*\\((.*)\\)\\s*$`,"i"));if(!Me&&!Ue)return null;const yt=Xa(((Me==null?void 0:Me[1])||(Ue==null?void 0:Ue[1]))??""),St=to(H);let lo=!1;const he=yt.map(ke=>/^\s*when\s*=/.test(ke)?(lo=!0,`when=${St} and (${ke.replace(/^\s*when\s*=\s*/i,"")})`):ke);return lo||he.push(`when=${St}`),`${Ko}(${he.join(", ")})`},gn=(Ko,Qt)=>{const H=Ko.match(/^(line|label|box|table|linefill)\.([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(!H)return null;const Me=`${String(H[1]).toLowerCase()}.${String(H[2]).toLowerCase()}`,Ue=Xa(H[3]||""),yt=to(Qt);let St=!1;const lo=Ue.map(he=>/^\s*when\s*=/.test(he)?(St=!0,`when=${yt} and (${he.replace(/^\s*when\s*=\s*/i,"")})`):he);return St||lo.push(`when=${yt}`),`${Me}(${lo.join(", ")})`},Wn=[],Tn=(Ko,Qt)=>Wn.push({text:Ko,indent:Fe,lineNo:Qt,loopSeq:!!We.loopSeq});Object.values(js).forEach(Ko=>{var ke,Ne;const Qt=Ko.base;if(!Qt)return;const H=!!Ko.branches.some(ie=>ie==null?void 0:ie.hasVar),Me=((ke=Ko.branches.find(ie=>ie==null?void 0:ie.declaredType))==null?void 0:ke.declaredType)||"",Ue=((Ne=Ko.branches.find(ie=>ie==null?void 0:ie.op))==null?void 0:Ne.op)||"=",yt=Ue===":="?Qt.name:"na",St=ie=>{for(let Ct=ie;Ct<Xe.length;Ct++){const Kt=Ko.branches[Ct];if(!Kt)continue;const fo=It[Ct],mo=St(Ct+1);return fo?`iff(${fo}, ${Kt.rhs}, ${mo})`:Kt.rhs}return yt},lo=St(0),he=`${H?"var ":""}${Me?`${Me} `:""}`;Tn(`${he}${Qt.name} ${Ue} ${lo}`,Qt.lineNo)});for(const Ko of Si){const Qt=En("plot",Ko.text,Ko.branchIndex)||En("plotshape",Ko.text,Ko.branchIndex)||En("plotchar",Ko.text,Ko.branchIndex)||Zs("line.new",Ko.text,Ko.branchIndex)||Zs("linefill.new",Ko.text,Ko.branchIndex)||Zs("label.new",Ko.text,Ko.branchIndex)||Zs("box.new",Ko.text,Ko.branchIndex)||Zs("table.cell",Ko.text,Ko.branchIndex)||gn(Ko.text,Ko.branchIndex)||za(Ko.text,Ko.branchIndex)||Rs(Ko.text,Ko.branchIndex);if(Qt){Tn(Qt,Ko.lineNo);continue}s.push({message:`Ignored Pine statement inside if: ${Ko.text}`,line:Ko.lineNo})}Wn.length||s.push({message:"if statement produced no output",line:de}),a.splice(be,ao-be,...Wn),be-=1;continue}const at=De.match(/^(?:(?:varip|var)\s+)?(?:(?:float|int|bool|string)\s+)?([A-Za-z_$][A-Za-z0-9_$]*)\s*(?::=|=)\s*array\.from\s*\((.*)\)\s*$/i);if(at){const ue=U(at[1]),Fe=Xa(at[2]||""),ut=[];let Xe=!0;for(const ht of Fe){const ao=Q(String(ht||""),`array_from_${ue}`),It=ye(ao);if(It==null){Xe=!1;break}ut.push(It)}if(!Xe||!ut.length){t.push({message:"array.from(...) currently supports only numeric literals (compile-time)",line:de});continue}ot(ue,ut.length,ut),B[ue]=ut;continue}const jt=De.match(/^(?:(?:varip|var)\s+)?(?:(?:float|int|bool|string)\s+)?([A-Za-z_$][A-Za-z0-9_$]*)\s*(?::=|=)\s*array\.new_(float|int|bool|string)\s*\((.*)\)\s*$/i);if(jt){const ue=U(jt[1]);if(String(jt[2]||"").toLowerCase()==="string"){t.push({message:"array.new_string is not supported (numeric arrays only)",line:de});continue}const ut=Xa(jt[3]||""),Xe=ut[0]??"0",ht=ut[1]??"0",ao=ye(Xe);if(ao==null||ao<0){t.push({message:"array.new_* size must be a numeric constant or param",line:de});continue}let It=ye(ht);if(It==null){const Mo=rm(String(ht));Mo!=null&&(It=Mo?1:0)}It==null&&(It=0);const eo=new Array(Math.floor(ao));for(let Mo=0;Mo<eo.length;Mo++)eo[Mo]=It;ot(ue,eo.length,eo);continue}const Lt=De.match(/^array\.(push|pop|shift|unshift|insert|remove|clear|resize)\s*\((.*)\)\s*$/i);if(Lt){const ue=String(Lt[1]||"").toLowerCase(),Fe=Xa(Lt[2]||""),ut=String(Fe[0]||"").trim(),Xe=U(ut);if(!ut){t.push({message:`array.${ue} requires array name`,line:de});continue}if(!$[Xe]&&!B[Xe]){t.push({message:`array.${ue} unknown array "${ut}"`,line:de});continue}!$[Xe]&&B[Xe]&&ot(Xe,B[Xe].length,B[Xe]);const ht=$[Xe];if(!ht)continue;if(ue==="push"||ue==="unshift"||ue==="insert"){const Mo=Math.min(Re,Math.max(ht.capacity,ht.size+Ce));nt(Xe,Mo)}if(ue==="resize"){const Mo=String(Fe[1]||"0"),ho=ye(Mo);if(ho!=null){const to=Math.min(Re,Math.max(ht.capacity,Math.floor(ho)));nt(Xe,to)}}we(Xe);const ao={};ue==="push"||ue==="unshift"?ao.value=Fe[1]:ue==="insert"?(ao.index=Fe[1],ao.value=Fe[2]):ue==="remove"?ao.index=Fe[1]:ue==="resize"&&(ao.size=Fe[1]);const It=ze(Xe,ue,ao,de);if(!It)continue;const eo=It.map(Mo=>({text:`${Mo.name} ${Mo.op} ${Mo.rhs}`,indent:We.indent,lineNo:de,loopSeq:We.loopSeq}));a.splice(be,1,...eo),be-=1;continue}const Mt=De.match(/^array\.set\s*\((.*)\)\s*$/i);if(Mt){const ue=Xa(Mt[1]||""),Fe=String(ue[0]||"").trim(),ut=String(ue[1]||"").trim(),Xe=String(ue[2]||"").trim();if(!Fe||!ut||!Xe){t.push({message:"array.set(name, index, value) requires 3 args",line:de});continue}const ht=U(Fe),ao=B[ht],It=$[ht];if(!ao&&!It){t.push({message:`array.set unknown array "${Fe}"`,line:de});continue}const eo=tt(ht,ut);if(eo!=null){const Mo=(It==null?void 0:It.size)??(ao==null?void 0:ao.length)??eo+1;ot(ht,Mo,ao);const ho=Q(Xe,`${ht}_${eo}`),to=ye(ho);ao&&to!=null&&(ao[eo]=to),De=`${st(ht,eo)} := ${ho}`}else{const Mo=Q(ut,`${ht}_idx`),ho=Q(Xe,`${ht}_set`),to=(td=$[ht])==null?void 0:td.sizeSeries,ds=to!=null?`(${Mo}) >= 0 and (${Mo}) < ${to}`:void 0,js=ct(ht,Mo,ho,ds);if(!js){t.push({message:"array.set index must be within array size",line:de});continue}const Si=js.map(($r,pa)=>({text:`${st(ht,pa)} := ${$r}`,indent:We.indent,lineNo:de,loopSeq:We.loopSeq}));a.splice(be,1,...Si),be-=1;continue}}const Io=De.match(/^(varip\s+|var\s+)?(?:(float|int|bool|string|line|label|box|table|linefill)\s+)?([A-Za-z_$][A-Za-z0-9_$]*)\s*(:=|=)\s*(.+)$/i);if(Io){const ue=!!Io[1],Fe=Io[2]?String(Io[2]).toLowerCase():"",ut=Io[3],Xe=Io[4],ht=String(Io[5]||"").trim(),ao=ht.match(/^(line|label|box|table|linefill)\.new\s*\((.*)\)\s*$/i);if(ao){const En=String(ao[1]||"").toLowerCase();if(En==="line"){qi(ao[2]||"",de,ut,ue);continue}if(En==="linefill"){oa(ao[2]||"",de,ut,ue);continue}if(En==="label"){Ks(ao[2]||"",de,ut,ue);continue}if(En==="box"){ws(ao[2]||"",de,ut,ue);continue}if(En==="table"){vn(ao[2]||"",de,ut,ue);continue}}const It=ht.match(/^table\.cell\s*\((.*)\)\s*$/i);if(It){es(It[1]||"",de);continue}const eo=ht.match(/^array\.(pop|shift|remove)\s*\((.*)\)\s*$/i);if(eo){const En=String(eo[1]||"").toLowerCase(),za=Xa(eo[2]||""),Rs=String(za[0]||"").trim(),Zs=U(Rs);if(!Rs){t.push({message:`array.${En} requires array name`,line:de});continue}if(!$[Zs]&&!B[Zs]){t.push({message:`array.${En} unknown array "${Rs}"`,line:de});continue}if(!$[Zs]&&B[Zs]&&ot(Zs,B[Zs].length,B[Zs]),!$[Zs])continue;we(Zs);const Wn=En==="pop"?`array.size(${Rs}) - 1`:En==="shift"?"0":String(za[1]||"0"),Tn=Q(`array.get(${Rs}, ${Wn})`,ut),Ko=ze(Zs,En==="pop"?"pop":En==="shift"?"shift":"remove",{index:za[1]},de);if(!Ko)continue;const H=[{text:`${`${ue?"var ":""}${Fe?`${Fe} `:""}`}${ut} ${Xe} ${Tn}`,indent:We.indent,lineNo:de,loopSeq:We.loopSeq},...Ko.map(Me=>({text:`${Me.name} ${Me.op} ${Me.rhs}`,indent:We.indent,lineNo:de,loopSeq:We.loopSeq}))];a.splice(be,1,...H),be-=1;continue}const Mo=ht.match(/^array\.(copy|concat)\s*\((.*)\)\s*$/i);if(Mo){const En=String(Mo[1]||"").toLowerCase(),za=Xa(Mo[2]||""),Rs=U(ut);if(En==="copy"){const H=String(za[0]||"").trim(),Me=U(H);if(!H){t.push({message:"array.copy requires source array name",line:de});continue}if(!$[Me]&&!B[Me]){t.push({message:`array.copy unknown array "${H}"`,line:de});continue}!$[Me]&&B[Me]&&ot(Me,B[Me].length,B[Me]);const Ue=dt(Rs,Me,de);if(!Ue)continue;(Nc=$[Me])!=null&&Nc.dynamic&&$[Rs]&&($[Rs].dynamic=!0);const yt=Ue.map(St=>({text:`${St.name} ${St.op} ${St.rhs}`,indent:We.indent,lineNo:de,loopSeq:We.loopSeq}));a.splice(be,1,...yt),be-=1;continue}const Zs=String(za[0]||"").trim(),gn=String(za[1]||"").trim(),Wn=U(Zs),Tn=U(gn);if(!Zs||!gn){t.push({message:"array.concat requires two arrays",line:de});continue}if(!$[Wn]&&!B[Wn]){t.push({message:`array.concat unknown array "${Zs}"`,line:de});continue}if(!$[Tn]&&!B[Tn]){t.push({message:`array.concat unknown array "${gn}"`,line:de});continue}!$[Wn]&&B[Wn]&&ot(Wn,B[Wn].length,B[Wn]),!$[Tn]&&B[Tn]&&ot(Tn,B[Tn].length,B[Tn]);const Ko=qe(Rs,Wn,Tn,de);if(!Ko)continue;const Qt=Ko.map(H=>({text:`${H.name} ${H.op} ${H.rhs}`,indent:We.indent,lineNo:de,loopSeq:We.loopSeq}));a.splice(be,1,...Qt),be-=1;continue}if(Xe===":="){const En=U(ut);En in I||ut in I||!!T[En]||_.some(Rs=>U(String((Rs==null?void 0:Rs.name)||""))===En)||y.some(Rs=>U(String((Rs==null?void 0:Rs.name)||""))===En)||S.some(Rs=>U(String((Rs==null?void 0:Rs.name)||""))===En)||s.push({message:`":=" used before "${ut}" is defined (use "=" for first assignment)`,line:de})}const ho=P2(ht);if(ho){S.push({name:ut,type:"security",symbol:ho.symbol,country:ho.country,timeframe:ho.timeframe,expr:ho.expr,lookahead:ho.lookahead,gaps:ho.gaps});continue}const to=Q(ht,ut);if(!ut.startsWith("__arr_")&&Td(ut,to,de))continue;if(oe(to)&&(T[ut.replace(/\s+/g,"_").toLowerCase()]=sv(to)),(ue||Xe===":=")&&Fe!=="bool"&&Fe!=="string"){const En=U(ut),za=En.startsWith("__arr_"),Zs=(()=>{const Wn=k[En];if(typeof Wn=="number")return Wn;const Tn=y.length;return k[En]=Tn,y.push({name:ut,initExpr:void 0,updateExpr:ut,selfMode:za?"current":void 0}),Tn})();if((za||!!We.loopSeq)&&Xe===":="&&typeof k[En]=="number"){y.push({name:ut,initExpr:void 0,updateExpr:to,selfMode:"current"});continue}if(ue&&Xe==="="){y[Zs].initExpr=to;continue}if(ue&&Xe===":="){y[Zs].initExpr=to,y[Zs].updateExpr=to;continue}y[Zs].updateExpr=to;continue}const $r=Ev(to);if($r!=null){I[ut]=$r;continue}const pa=rm(to);if(pa!=null){I[ut]=pa;continue}if(to.startsWith('"')&&to.endsWith('"')||to.startsWith("'")&&to.endsWith("'")){I[ut]=ta(to);continue}_.push({name:ut,expr:to});continue}const Bo=De.match(/^strategy\s*\((.*)\)\s*$/i);if(Bo){const ue=Xa(Bo[1]||""),Fe=Vc(ue),ut=z&&typeof z=="object"?{...z}:null,Xe=(...ho)=>{for(const to of ho){if(Fe[to]==null)continue;const ds=ta(String(Fe[to])),js=Ev(ds);if(js!=null)return js}},ht=(...ho)=>{for(const to of ho){if(Fe[to]==null)continue;const ds=ta(String(Fe[to])),js=Ev(ds);return js??ds}},ao=(...ho)=>{for(const to of ho)if(Fe[to]!=null)return ta(String(Fe[to]))},It=ta(String(Fe.default_qty_type??Fe.default_qty_type??"")).toLowerCase(),eo=Number(Fe.default_qty_value??Fe.default_qty_value??NaN),Mo=It==="cash"?{type:"cash",value:Number.isFinite(eo)?eo:1e4}:It==="qty"?{type:"qty",value:Number.isFinite(eo)?eo:1}:{type:"percent_of_equity",value:Number.isFinite(eo)?eo:100};if(z={initialCapital:Xe("initial_capital","initialCapital")??1e4,from:ht("from","start","startDate","dateFrom","rangeStart"),to:ht("to","end","endDate","dateTo","rangeEnd"),session:ao("session","tradingSession","sessionTime"),orderSize:Mo,commissionPct:Xe("commissionPct","commission")??0,slippagePct:Xe("slippagePct","slippage")??0,spreadPct:Xe("spreadPct","spread_pct","spread")??(Xe("spreadBps","spread_bps")!=null?Xe("spreadBps","spread_bps")/100:void 0),leverage:Xe("leverage","lev","marginLeverage","margin_leverage")??void 0,maintenanceMarginPct:Xe("maintenanceMarginPct","maintenance_margin_pct","maintMarginPct")??void 0,liquidationFeePct:Xe("liquidationFeePct","liquidation_fee_pct","liqFeePct")??void 0,borrowPctPerYear:Xe("borrowPctPerYear","borrow_pct_per_year","shortBorrowPctPerYear")??void 0,fundingPctPerDay:Xe("fundingPctPerDay","funding_pct_per_day","funding")??void 0,positionMode:(()=>{const ho=ta(String(Fe.positionMode??Fe.position_mode??"")).toLowerCase();if(ho)return ho.includes("hedge")?"hedging":"netting"})()??void 0,closeMethod:(()=>{const ho=ta(String(Fe.closeMethod??Fe.close_method??Fe.costBasis??Fe.cost_basis??"")).toLowerCase();if(ho)return ho.includes("lifo")?"lifo":ho.includes("avg")||ho.includes("average")?"avg":"fifo"})()??void 0,priceTick:Xe("priceTick","price_tick","tickSize","tick_size","tick","minTick","min_tick")??void 0,qtyStep:Xe("qtyStep","qty_step","quantityStep","quantity_step","lotStep","lot_step")??void 0,minQty:Xe("minQty","min_qty","minimumQty","minimum_qty")??void 0,pyramiding:Xe("pyramiding")??1,execution:ta(String(Fe.execution??"intrabar_ohlc")),intrabarTieBreak:ta(String(Fe.intrabarTieBreak??"worst_case")),ohlcPath:ta(String(Fe.ohlcPath??"open_high_low_close")),allowShort:rm(String(Fe.allowShort??""))??void 0,allowLong:rm(String(Fe.allowLong??""))??void 0},ut){const ho=["maxDrawdownPct","maxDrawdownCash","maxPositionPct","maxPositionCash","maxPositionQty","maxIntradayFilledOrders","maxIntradayLossPct","maxIntradayLossCash"];for(const to of ho)ut[to]!=null&&(z[to]=ut[to])}continue}const hs=De.match(/^strategy\.risk\.([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(hs){const ue=String(hs[1]||"").trim().toLowerCase(),Fe=Xa(hs[2]||""),ut=Vc(Fe),Xe=Fe.filter(js=>!Qc(js)),ht=ut.value??ut.max??ut.size??Xe[0],ao=ut.type??ut.qty_type??ut.qtyType??ut.position_type??Xe[1],It=ht!=null?Ev(ta(String(ht))):null;if(It==null||!Number.isFinite(It)){t.push({message:`strategy.risk.${ue}(...) requires numeric value`,line:de});continue}const eo=ao!=null?ta(String(ao)).toLowerCase():"",Mo=eo.includes("percent")||eo.includes("equity"),ho=eo.includes("cash")||eo.includes("currency")||eo.includes("fixed"),to=eo.includes("qty")||eo.includes("contract"),ds=Mo?"percent":ho?"cash":to?"qty":"percent";if((!z||typeof z!="object")&&(z={enabled:!0}),ue==="max_drawdown"||ue==="max_drawdown_percent"){ds==="cash"?z.maxDrawdownCash=It:z.maxDrawdownPct=It;continue}if(ue==="max_position_size"||ue==="max_position"||ue==="max_position_size_contracts"){ds==="cash"?z.maxPositionCash=It:ds==="qty"?z.maxPositionQty=It:z.maxPositionPct=It;continue}if(ue==="max_intraday_filled_orders"||ue==="max_intraday_orders"){z.maxIntradayFilledOrders=Math.max(0,Math.floor(It));continue}if(ue==="max_intraday_loss"||ue==="max_daily_loss"){ds==="cash"?z.maxIntradayLossCash=It:z.maxIntradayLossPct=It;continue}s.push({message:`Ignored strategy.risk method: ${ue}`,line:de});continue}if(De.match(/^(indicator|study)\s*\((.*)\)\s*$/i))continue;const Es=De.match(/^line\.new\s*\((.*)\)\s*$/i);if(Es){qi(Es[1]||"",de);continue}const bt=De.match(/^linefill\.new\s*\((.*)\)\s*$/i);if(bt){oa(bt[1]||"",de);continue}const kt=De.match(/^label\.new\s*\((.*)\)\s*$/i);if(kt){Ks(kt[1]||"",de);continue}const xo=De.match(/^box\.new\s*\((.*)\)\s*$/i);if(xo){ws(xo[1]||"",de);continue}const $t=De.match(/^table\.new\s*\((.*)\)\s*$/i);if($t){vn($t[1]||"",de);continue}const _o=De.match(/^table\.clear\s*\((.*)\)\s*$/i);if(_o){Uc(_o[1]||"",de);continue}const go=De.match(/^table\.merge(?:_cells)?\s*\((.*)\)\s*$/i);if(go){Nl(go[1]||"",de);continue}const fs=De.match(/^table\.cell\s*\((.*)\)\s*$/i);if(fs){es(fs[1]||"",de);continue}const Ms=De.match(/^line\.set_([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(Ms){Li(Ms[1]||"",Ms[2]||"",de);continue}const zn=De.match(/^line\.delete\s*\((.*)\)\s*$/i);if(zn){ci(zn[1]||"");continue}const qs=De.match(/^linefill\.set_([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(qs){ol(qs[1]||"",qs[2]||"",de);continue}const Vn=De.match(/^linefill\.delete\s*\((.*)\)\s*$/i);if(Vn){Xi(Vn[1]||"");continue}const Ss=De.match(/^label\.set_([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(Ss){fc(Ss[1]||"",Ss[2]||"",de);continue}const di=De.match(/^label\.delete\s*\((.*)\)\s*$/i);if(di){rd(di[1]||"");continue}const Mn=De.match(/^box\.set_([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(Mn){ml(Mn[1]||"",Mn[2]||"",de);continue}const La=De.match(/^box\.delete\s*\((.*)\)\s*$/i);if(La){Jl(La[1]||"");continue}const nn=De.match(/^table\.set_([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(nn){Wl(nn[1]||"",nn[2]||"",de);continue}const tr=De.match(/^table\.delete\s*\((.*)\)\s*$/i);if(tr){sl(tr[1]||"");continue}const Ur=De.match(/^table\.cell_set_([A-Za-z0-9_]+)\s*\((.*)\)\s*$/i);if(Ur){Yc(Ur[1]||"",Ur[2]||"",de);continue}const cl=De.match(/^plot\s*\((.*)\)\s*$/i);if(cl){const ue=Xa(cl[1]||"");if(!ue.length){t.push({message:"plot() requires at least 1 argument",line:de});continue}const Fe=ue[0],ut=ue[1]&&!ue[1].includes("=")?ue[1]:null,Xe=Vc(ue),ht=ta(String(Xe.pane??"main")).toLowerCase()==="sub"?"sub":"main",ao=te(ht),It=jl(Fe,ta(String(Xe.title??Xe.name??ut??Fe??"plot")));ao.plots.push({name:ta(String(Xe.title??Xe.name??ut??It)),source:It.replace(/\s+/g,"_").toLowerCase(),type:ta(String(Xe.type??"line")),color:Nu(String(Xe.color??""))||void 0,width:Xe.width!=null?Number(Xe.width):Xe.linewidth!=null?Number(Xe.linewidth):void 0,style:Xe.style!=null?ta(String(Xe.style)):void 0});continue}const ui=De.match(/^plotshape\s*\((.*)\)\s*$/i);if(ui){const ue=Xa(ui[1]||"");if(!ue.length){t.push({message:"plotshape() requires at least 1 argument",line:de});continue}const Fe=Vc(ue),ut=ue.filter(En=>!Qc(En)),Xe=ut[0]?sa(sv(Q(ut[0],"when"))):null;if(!Xe){t.push({message:"plotshape() missing condition",line:de});continue}const ht=ta(String(Fe.pane??"main")).toLowerCase()==="sub"?"sub":"main",ao=te(ht),It=String(Fe.location??"").toLowerCase(),eo=It.includes("below")||It.includes("bottom")||It.includes("low"),Mo=eo?"below":"above",ho=Fe.price??Fe.y??Fe.source??Fe.series,to=ho!=null?jl(String(ho),"shape_price").replace(/\s+/g,"_").toLowerCase():eo?"low":"high",ds=xV(String(Fe.style??Fe.shape??""))||(eo?"triangle_up_filled":"triangle_down_filled"),js=ta(String(Fe.text??Fe.title??""))||(eo?"BUY":"SELL"),Si=Nu(String(Fe.color??""))||(eo?"#16a34a":"#ef4444"),$r=Nu(String(Fe.textcolor??Fe.textColor??""))||void 0,pa=y0(String(Fe.size??""))||void 0;ao.labels.push({when:Xe,text:js,color:Si,textColor:$r,position:Mo,source:to,shape:ds,size:pa});continue}const Yr=De.match(/^plotchar\s*\((.*)\)\s*$/i);if(Yr){const ue=Xa(Yr[1]||"");if(!ue.length){t.push({message:"plotchar() requires at least 1 argument",line:de});continue}const Fe=Vc(ue),ut=ue.filter(pa=>!Qc(pa)),Xe=ut[0]?sa(sv(Q(ut[0],"when"))):null;if(!Xe){t.push({message:"plotchar() missing condition",line:de});continue}const ht=ta(String(Fe.pane??"main")).toLowerCase()==="sub"?"sub":"main",ao=te(ht),It=String(Fe.location??"").toLowerCase(),eo=It.includes("below")||It.includes("bottom")||It.includes("low"),Mo=eo?"below":"above",ho=Fe.price??Fe.y??Fe.source??Fe.series,to=ho!=null?jl(String(ho),"char_price").replace(/\s+/g,"_").toLowerCase():eo?"low":"high",ds=ta(String(Fe.char??""))||ta(String(Fe.text??""))||"•",js=Nu(String(Fe.color??""))||(eo?"#16a34a":"#ef4444"),Si=Nu(String(Fe.textcolor??Fe.textColor??""))||void 0,$r=y0(String(Fe.size??""))||14;ao.labels.push({when:Xe,text:ds,color:js,textColor:Si,position:Mo,source:to,shape:"text",size:$r});continue}const Ra=De.match(/^alertcondition\s*\((.*)\)\s*$/i);if(Ra){const ue=Xa(Ra[1]||"");if(!ue.length){t.push({message:"alertcondition() requires a condition",line:de});continue}const Fe=Vc(ue),ut=ue.filter(eo=>!Qc(eo)),Xe=ut[0]!=null?String(ut[0]):"",ht=Xe?sa(sv(Q(Xe,"when"))):null;if(!ht){t.push({message:"alertcondition() missing condition",line:de});continue}const ao=ta(String(Fe.title??"")),It=ta(String(Fe.message??""));M.push({id:ao?`${ao}`:`alert_${de}`,type:"alert",when:ht,title:ao||void 0,message:It||void 0});continue}const ga=De.match(/^hline\s*\((.*)\)\s*$/i);if(ga){const ue=Xa(ga[1]||"");if(!ue.length){t.push({message:"hline() requires value",line:de});continue}const Fe=Vc(ue),ut=ue.filter(It=>!Qc(It)),Xe=Ev(ta(ut[0]??""));if(Xe==null){t.push({message:"hline() value must be a number",line:de});continue}const ht=ta(String(Fe.pane??"main")).toLowerCase()==="sub"?"sub":"main";te(ht).levels.push({name:ta(String(Fe.title??Fe.name??String(Xe))),value:Xe,color:Nu(String(Fe.color??""))||void 0,style:ta(String(Fe.linestyle??Fe.style??"dashed")),width:Fe.width!=null?Number(Fe.width):void 0});continue}const na=De.match(/^fill\s*\((.*)\)\s*$/i);if(na){const ue=Xa(na[1]||""),Fe=Vc(ue),ut=ue.filter(eo=>!Qc(eo));if(ut.length<2){t.push({message:"fill() requires 2 plot series",line:de});continue}const Xe=ta(String(Fe.pane??"main")).toLowerCase()==="sub"?"sub":"main",ht=te(Xe),ao=jl(ut[0],"fill_a"),It=jl(ut[1],"fill_b");ht.fills=Array.isArray(ht.fills)?ht.fills:[],ht.fills.push({between:[ao,It],color:Nu(String(Fe.color??""))||ta(String(Fe.color??""))||"rgba(34,197,94,0.10)"});continue}const nl=De.match(/^signal\s+(entry_long|exit_long|entry_short|exit_short)\s+when\s+(.+)$/i);if(nl){M.push({type:nl[1].toLowerCase(),when:sa(sv(Q(nl[2],"when")))});continue}const mi=De.match(/^strategy\.entry\s*\((.*)\)\s*$/i);if(mi){const ue=Xa(mi[1]||""),Fe=Vc(ue),Xe=ue.filter(Mo=>!Qc(Mo))[0]||"",ht=ue.find(Mo=>/strategy\.(long|short)/i.test(Mo))||"",ao=/short/i.test(ht)?"short":"long",It=Fe.when?sa(sv(Q(Fe.when,"when"))):null;if(!It){t.push({message:"strategy.entry(...) requires when=...",line:de});continue}const eo=_d(Fe);M.push({id:Xe?ta(String(Xe)):void 0,type:ao==="long"?"entry_long":"entry_short",when:It,order:eo||void 0});continue}const Ha=De.match(/^strategy\.order\s*\((.*)\)\s*$/i);if(Ha){const ue=Xa(Ha[1]||""),Fe=Vc(ue),ut=ue.filter(ho=>!Qc(ho)),Xe=ut[0]||"",ht=Xe?ta(String(Xe)):"";if(!ht){t.push({message:"strategy.order(...) requires id",line:de});continue}const ao=ue.find(ho=>/strategy\.(long|short)/i.test(ho))||ut[1]||"",It=/short/i.test(ao)?"short":/long/i.test(ao)?"long":"";if(!It){t.push({message:"strategy.order(...) requires strategy.long/strategy.short",line:de});continue}Fe.qty==null&&ut[2]!=null&&(Fe.qty=String(ut[2]));const eo=Fe.when?sa(sv(Q(Fe.when,"when"))):null;if(!eo){t.push({message:"strategy.order(...) requires when=...",line:de});continue}const Mo=_d(Fe);M.push({id:ht,orderId:ht,type:It==="long"?"entry_long":"entry_short",when:eo,order:Mo||void 0});continue}const lr=De.match(/^strategy\.(close|exit)\s*\((.*)\)\s*$/i);if(lr){const ue=Xa(lr[2]||""),Fe=Vc(ue),Xe=ue.filter(pa=>!Qc(pa))[0]||"",ht=Fe.when?sa(sv(Q(Fe.when,"when"))):null,ao=Fe.side&&/short/i.test(String(Fe.side))?"short":"long",It=_d(Fe),eo=Fe.stop??Fe.stopPrice,Mo=Fe.limit??Fe.limitPrice,ho=Fe.qty_percent??Fe.qtyPct??Fe.qtyPctVal??Fe.qtyPercent,to=ho!=null?Number(ho):void 0,ds=eo!=null?jl(String(eo),"exit_stop"):null,js=Mo!=null?jl(String(Mo),"exit_limit"):null,Si=Xe?`${ta(String(Xe))}__bracket`:`exit__bracket_${de}`;let $r=!1;if(eo!=null&&(M.push({id:`${Xe?ta(String(Xe)):de}_STOP`,type:ao==="long"?"exit_long":"exit_short",when:`between(${ds||"close"}, low, high)`,order:{kind:"stop",price:(ds||"close").replace(/\s+/g,"_").toLowerCase(),qtyPct:typeof to=="number"&&Number.isFinite(to)?to:void 0,oco:Si}}),$r=!0),Mo!=null&&(M.push({id:`${Xe?ta(String(Xe)):de}_LIMIT`,type:ao==="long"?"exit_long":"exit_short",when:`between(${js||"close"}, low, high)`,order:{kind:"limit",price:(js||"close").replace(/\s+/g,"_").toLowerCase(),qtyPct:typeof to=="number"&&Number.isFinite(to)?to:void 0,oco:Si}}),$r=!0),ht&&(M.push({id:Xe?ta(String(Xe)):void 0,type:ao==="long"?"exit_long":"exit_short",when:ht,order:eo!=null||Mo!=null?typeof to=="number"&&Number.isFinite(to)?{kind:"market",qtyPct:to}:void 0:It||(typeof to=="number"&&Number.isFinite(to)?{kind:"market",qtyPct:to}:void 0)}),$r=!0),!$r){t.push({message:"strategy.exit/close(...) needs when=... or stop=/limit=...",line:de});continue}continue}const zi=De.match(/^strategy\.cancel\s*\((.*)\)\s*$/i);if(zi){const ue=Xa(zi[1]||""),Fe=Vc(ue),Xe=ue.filter(It=>!Qc(It))[0]||"",ht=Xe?ta(String(Xe)):"";if(!ht){t.push({message:"strategy.cancel(...) requires id",line:de});continue}const ao=Fe.when?sa(sv(Q(Fe.when,"when"))):"close >= close";M.push({id:`cancel_${ht}_${de}`,type:"cancel",when:ao,orderId:ht});continue}const hr=De.match(/^strategy\.cancel_all\s*\((.*)\)\s*$/i);if(hr){const ue=Xa(hr[1]||""),Fe=Vc(ue),ut=Fe.when?sa(sv(Q(Fe.when,"when"))):"close >= close";M.push({id:`cancel_all_${de}`,type:"cancel_all",when:ut});continue}const xa=De.match(/^strategy\.close_all\s*\((.*)\)\s*$/i);if(xa){const ue=Xa(xa[1]||""),Fe=Vc(ue),ut=Fe.when?sa(sv(Q(Fe.when,"when"))):null;if(!ut){t.push({message:"strategy.close_all(...) requires when=...",line:de});continue}M.push({type:"exit_long",when:ut,id:`close_all_long_${de}`,order:{kind:"market",qtyPct:100}}),M.push({type:"exit_short",when:ut,id:`close_all_short_${de}`,order:{kind:"market",qtyPct:100}});continue}const Qa=De.match(/^draw\.fib\.auto\s*\((.*)\)\s*$/i);if(Qa){const ue=Xa(Qa[1]||""),Fe=Vc(ue),ut=ta(String(Fe.name??"fibo"));S.push({name:ut,type:"auto_fib",method:ta(String(Fe.method??"pivots")),pivotLeft:Number(Fe.left??Fe.pivotLeft??3),pivotRight:Number(Fe.right??Fe.pivotRight??3),lookback:Number(Fe.lookback??400),direction:ta(String(Fe.direction??"up")),draw:!0});continue}De.startsWith("//@")||s.push({message:`Ignored Pine statement: ${De}`,line:de})}if(!g.some(be=>Array.isArray(be.plots)&&be.plots.length||Array.isArray(be.labels)&&be.labels.length||Array.isArray(be.levels)&&be.levels.length||Array.isArray(be.lines)&&be.lines.length||Array.isArray(be.runtimeDrawOps)&&be.runtimeDrawOps.length||Array.isArray(be.runtimeLabels)&&be.runtimeLabels.length||Array.isArray(be.runtimeLines)&&be.runtimeLines.length||Array.isArray(be.runtimeBoxes)&&be.runtimeBoxes.length||Array.isArray(be.runtimeTables)&&be.runtimeTables.length)){const be=_.length?_[_.length-1].name:y.length?y[y.length-1].name:null,We=be||"close";te("main").plots.push({name:be?ta(String(be)):"Close",source:We.replace(/\s+/g,"_").toLowerCase(),type:"line",color:"#60a5fa",width:2}),s.push({message:be?`No plot() found; auto-plotted "${be}". Add plot(...) to control output.`:'No plot() found; auto-plotted "close". Add plot(...) to control output.',line:1})}if(t.length)return{ok:!1,errors:t,warnings:s.length?s:void 0};try{const be=g.find(We=>We.pane==="sub");if(be&&typeof be.min!="number"&&typeof be.max!="number"){const de=(Array.isArray(be.levels)?be.levels:[]).map(De=>Number(De==null?void 0:De.value)).filter(De=>Number.isFinite(De));if(de.length){const De=Math.min(...de),Ee=Math.max(...de),xe=de.some(at=>at<=30),gt=de.some(at=>at>=70);de.length>=2&&De>=0&&Ee<=100&&xe&&gt&&(be.min=0,be.max=100)}}}catch{}return{ok:!0,spec:{panes:g,calc:S,series:_,stateSeries:y,signals:M,strategy:z,params:I},inputDefs:C,warnings:s.length?s:void 0}}function I2(o,e,t,s,i,r){e("run",{code:t(),params:n(s),lang:n(i),backtest:n(r)})}function wV(o,e){e("reset")}function kV(o,e,t){e("save",{code:t()})}function SV(o,e,t){n(e)&&(x(e,!1),t("fullpage",{enabled:!1})),t("close")}function CV(o,e){e("guide")}function PV(o,e,t){x(e,!n(e)),t("labels",{enabled:n(e)})}function M2(o,e){x(e,!1)}function IV(o,e,t,s,i){if(!n(e))return;const r=n(t).trim()||`Run ${n(s).length+1}`,a=`cmp_${Date.now()}_${n(s).length}`,l=n(i)&&typeof n(i)=="object"?{...n(i)}:null;x(s,D([...n(s),{id:a,label:r,summary:n(e),params:l,ts:Date.now()}])),x(t,"")}function MV(o,e,t,s){x(e,D([])),x(t,null),x(s,D({}))}function TV(o,e,t,s){x(e,""),x(t,""),x(s,"")}function AV(o,e,t,s,i,r,a,l,c,d,v,g,_,y,k,S,M,I,C,T,z,j,B){var Y;if(!n(e).length)return;if(x(t,""),!n(s)){x(t,"Select Param A");return}if(n(i)&&n(i)===n(s)){x(t,"Param B must differ from Param A");return}const $=r(n(s),n(a),n(l),n(c));if(!$.length){x(t,"Invalid range for Param A");return}const F=n(i)?r(n(i),n(d),n(v),n(g)):[null],V=$.length*(F.length||1);if(V>200){x(t,`Too many combos (${V}). Reduce ranges or steps.`);return}const K=[];for(const Z of $)for(const ne of F){const te={...n(_)};te[n(s)]=Z,n(i)&&ne!=null&&(te[n(i)]=ne),K.push({params:te})}x(y,D(K)),x(k,D([])),x(S,0),x(M,!0),x(I,!1),x(C,"train"),x(T,null),x(z,D(Number(((Y=j())==null?void 0:Y._updatedAt)??0))),B(0)}function LV(o,e,t,s,i){x(e,!1),x(t,!1),x(s,D([])),x(i,0)}function zV(o,e,t,s,i,r,a,l,c){x(e,D([])),x(t,null),x(s,""),x(i,0),x(r,D([])),x(a,!1),x(l,!1),x(c,0)}function FV(o,e,t){x(e,!n(e)),t("fullpage",{enabled:n(e)})}function T2(o,e){x(e,!1)}function A2(o,e,t,s,i,r,a,l,c,d){const v=[e(["side","entryIndex","entryTime","entryPrice","exitIndex","exitTime","exitPrice","qty","barsHeld","netPnl","pnlPct","fees","grossPnl","maePct","mfePct","entrySignalId","exitSignalId","exitReason","cumNetPnl"])];for(const g of n(t))v.push(e([s(g.side),g.entryIndex,g.entryTimeLabel,i(g.entryPrice),g.exitIndex,g.exitTimeLabel,i(g.exitPrice),r(g.qty),a(g.barsHeld,0),l(g.netPnl),c(g.pnlPct),l(g.fees),l(g.pnl),g.maePct==null?"-":c(g.maePct),g.mfePct==null?"-":c(g.mfePct),g.entrySignalId,g.exitSignalId,g.exitReason,l(g.cumNet)]));d("backtest_trades.csv",v.join(`
`),"text/csv;charset=utf-8")}function L2(o,e,t,s,i,r,a,l){const c=[e(["id","status","action","side","kind","createdIndex","createdTime","activeFromIndex","expiresAtIndex","qtyPct","qty","cash","price","stopPrice","limitPrice","filledIndex","filledTime","fillQty","fillPrice","fees","signalId","ocoGroup","note"])];for(const d of n(t))c.push(e([d.id,d.statusLabel,d.actionLabel,d.sideLabel,d.kindLabel,d.createdIndex,d.createdTimeLabel,d.activeFromIndex,d.expiresAtIndex,`${s(d.qtyPct,2)}%`,d.qty==null?"-":i(d.qty),d.cash==null?"-":r(d.cash),d.price==null?"-":a(d.price),d.stopPrice==null?"-":a(d.stopPrice),d.limitPrice==null?"-":a(d.limitPrice),d.filledIndex,d.filledTimeLabel,d.fillQty==null?"-":i(d.fillQty),d.fillPrice==null?"-":a(d.fillPrice),d.fees==null?"-":r(d.fees),d.signalId,d.ocoGroup,d.note]));l("backtest_orders.csv",c.join(`
`),"text/csv;charset=utf-8")}function $V(o,e,t,s,i,r,a,l,c,d,v){const g=[e(["side","entryIndex","entryTime","entryPrice","exitIndex","exitTime","exitPrice","qty","barsHeld","netPnl","pnlPct","fees","grossPnl","maePct","mfePct","entrySignalId","exitSignalId","exitReason","cumNetPnl"])];for(const y of n(t))g.push(e([s(y.side),y.entryIndex,y.entryTimeLabel,i(y.entryPrice),y.exitIndex,y.exitTimeLabel,i(y.exitPrice),r(y.qty),a(y.barsHeld,0),l(y.netPnl),c(y.pnlPct),l(y.fees),l(y.pnl),y.maePct==null?"-":c(y.maePct),y.mfePct==null?"-":c(y.mfePct),y.entrySignalId,y.exitSignalId,y.exitReason,l(y.cumNet)]));const _=n(d).type==="all"?"all":`${n(d).type}_${String(n(d).key).replace(/[^a-zA-Z0-9_-]+/g,"_")}`;v(`backtest_trades_${_}.csv`,g.join(`
`),"text/csv;charset=utf-8")}function DV(o,e,t,s){const i=[e(["index","timestamp","equity"])];for(const r of n(t))i.push(e([r.index,r.timestamp,r.equity]));s("backtest_equity.csv",i.join(`
`),"text/csv;charset=utf-8")}var EV=o=>o.stopPropagation(),NV=(o,e)=>{o.stopPropagation(),x(e,"editor")},jV=(o,e)=>{o.stopPropagation(),x(e,"errors")},RV=re("<span> </span>"),BV=(o,e)=>{o.stopPropagation(),x(e,"results")},OV=o=>o.stopPropagation(),VV=(o,e)=>e("main"),WV=(o,e)=>e("sub"),qV=re('<div class="pane-toggle svelte-63z95z" aria-label="Target pane"><button type="button" class="svelte-63z95z">Main</button> <button type="button" class="svelte-63z95z">Sub pane</button></div>'),HV=re('<button class="icon svelte-63z95z" type="button" aria-label="Full page view" title="Full page view"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 9V4h5M20 9V4h-5M4 15v5h5M20 15v5h-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg></button>'),GV=re('<button class="icon svelte-63z95z" type="button" aria-label="Exit full page view" title="Exit full page view (Esc)"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 4H4v5M15 4h5v5M9 20H4v-5M15 20h5v-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg></button>'),UV=re('<div class="gutter-line svelte-63z95z"></div>'),YV=re('<div class="pine-warn-row svelte-63z95z"> </div>'),KV=re('<div class="pine-warn svelte-63z95z"></div>'),ZV=(o,e,t)=>e(n(t).name,o.currentTarget.checked),XV=re('<label class="toggle svelte-63z95z"><input type="checkbox" class="svelte-63z95z"> <span class="toggle-track svelte-63z95z"></span></label>'),JV=(o,e,t)=>e(n(t).name,o.currentTarget.value),QV=re('<input class="input svelte-63z95z" type="text">'),eW=(o,e,t)=>{const s=o.currentTarget.value,i=Number(s);Number.isFinite(i)&&e(n(t).name,n(t).type==="int"?Math.floor(i):i)},tW=re('<input class="input svelte-63z95z" type="number">'),oW=re('<div class="input-row svelte-63z95z"><div class="input-label svelte-63z95z"><div class="input-name svelte-63z95z"> </div> <div class="input-key mono svelte-63z95z"> </div></div> <div class="input-control svelte-63z95z"><!></div></div>'),sW=re('<div class="editor-side svelte-63z95z"><div class="side-card svelte-63z95z"><div class="side-title svelte-63z95z">Inputs</div> <div class="side-sub svelte-63z95z">TradingView‑style parameters (Pine)</div> <!> <div class="inputs-list svelte-63z95z"></div> <div class="side-hint svelte-63z95z">Change inputs → press <b>Run</b> to re‑calculate.</div></div></div>'),nW=re('<div class="editor-area svelte-63z95z"><div class="editor-shell svelte-63z95z"><div class="editor-main svelte-63z95z"><div class="editor-toolbar svelte-63z95z"><div class="editor-file svelte-63z95z"><span class="file-dot svelte-63z95z"></span> <span class="file-name svelte-63z95z"> </span> <span class="file-meta svelte-63z95z"> </span></div> <div class="editor-hints svelte-63z95z"><span class="hint svelte-63z95z">1. Write or paste script</span> <span class="hint svelte-63z95z">2. Press Run ▶</span></div></div> <div class="editor-scroll svelte-63z95z"><div class="editor-gutter svelte-63z95z"></div> <div class="code-shell svelte-63z95z"><pre class="code-overlay svelte-63z95z" aria-hidden="true"><code class="svelte-63z95z"><!></code><mark class="err svelte-63z95z" style="display:none" aria-hidden="true"></mark><mark class="err-warning svelte-63z95z" style="display:none" aria-hidden="true"></mark></pre> <textarea class="code-input svelte-63z95z" spellcheck="false" placeholder="Write or paste your script here, then press Run to see it on the chart"></textarea></div></div></div> <!></div></div>'),iW=re('<div class="no-errors svelte-63z95z">No errors • All good</div>'),rW=re('<span class="diag-loc svelte-63z95z"> <!> —</span>'),aW=re('<span class="diag-hint svelte-63z95z"> </span>'),lW=re('<div><span class="diag-dot svelte-63z95z"></span> <span class="diag-msg svelte-63z95z"><!> </span> <!></div>'),cW=re('<div class="errors-header svelte-63z95z"><div class="errors-title svelte-63z95z"> </div> <div class="errors-sub svelte-63z95z">Newest errors appear here as you type.</div></div> <div class="errors-list svelte-63z95z" aria-live="polite"></div>',1),dW=re('<div class="errors-area svelte-63z95z"><!></div>'),uW=o=>{var e;try{(e=o==null?void 0:o.stopPropagation)==null||e.call(o)}catch{}},pW=(o,e)=>x(e,"trades"),vW=(o,e)=>x(e,"orders"),fW=(o,e)=>x(e,D(o.currentTarget.value)),mW=(o,e)=>e({type:"all"}),gW=re('<button class="btn btn-xs btn-outline" type="button">Clear filter</button>'),hW=(o,e)=>e("side"),_W=(o,e)=>e("entryIndex"),yW=(o,e)=>e("exitIndex"),bW=(o,e)=>e("qty"),xW=(o,e)=>e("barsHeld"),wW=(o,e)=>e("netPnl"),kW=(o,e)=>e("pnlPct"),SW=(o,e)=>e("fees"),CW=(o,e)=>e("pnl"),PW=(o,e)=>e("maePct"),IW=(o,e)=>e("mfePct"),MW=(o,e)=>e("cumNet"),TW=(o,e,t)=>e(n(t)),AW=(o,e,t)=>{o.key==="Enter"&&e(n(t))},LW=(o,e,t)=>{var s;try{(s=o==null?void 0:o.stopPropagation)==null||s.call(o)}catch{}e(n(t))},zW=re('<tr tabindex="0" class="svelte-63z95z"><td class="svelte-63z95z"><button class="btn btn-xs btn-ghost" type="button" title="Focus this trade on chart">Focus</button></td><td class="svelte-63z95z"><span class="tt-pill tt-pill-side svelte-63z95z"> </span></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Idx</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Time</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Price</span><span class="mono svelte-63z95z"> </span></div></div></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Idx</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Time</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Price</span><span class="mono svelte-63z95z"> </span></div></div></td><td class="right mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Entry</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Exit</span><span class="mono svelte-63z95z"> </span></div></div></td><td class="mono svelte-63z95z"> </td><td class="right mono svelte-63z95z"> </td></tr>'),FW=re('<div class="tt-scroll svelte-63z95z"><table class="tt-table tt-table-trades svelte-63z95z"><thead class="svelte-63z95z"><tr><th class="svelte-63z95z">Focus</th><th class="svelte-63z95z"><button class="th-btn svelte-63z95z" type="button"> </button></th><th class="svelte-63z95z"><button class="th-btn svelte-63z95z" type="button"> </button></th><th class="svelte-63z95z"><button class="th-btn svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th><th class="svelte-63z95z">Signals</th><th class="svelte-63z95z">Reason</th><th class="right svelte-63z95z"><button class="th-btn right svelte-63z95z" type="button"> </button></th></tr></thead><tbody class="svelte-63z95z"></tbody></table></div>'),$W=re('<div class="no-errors svelte-63z95z">No trades to show.</div>'),DW=re('<div class="tt-toolbar svelte-63z95z"><div class="tt-toolbar-left svelte-63z95z"><div class="tt-title svelte-63z95z">Trades Table <span class="tt-sub mono svelte-63z95z"> </span></div> <div class="tt-note-inline svelte-63z95z">Entry/Exit show index, time, price. Bars = holding duration.</div></div> <div class="tt-toolbar-right"><input class="input input-sm svelte-63z95z" type="text" placeholder="Search trades..."> <!> <button class="btn btn-xs btn-outline" type="button">Download CSV</button></div></div> <!>',1),EW=re('<div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Qty</span><span class="mono svelte-63z95z"> </span></div>'),NW=re('<div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Cash</span><span class="mono svelte-63z95z"> </span></div>'),jW=re('<div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Price</span><span class="mono svelte-63z95z"> </span></div>'),RW=re('<div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Stop</span><span class="mono svelte-63z95z"> </span></div>'),BW=re('<div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Limit</span><span class="mono svelte-63z95z"> </span></div>'),OW=re('<tr class="svelte-63z95z"><td class="mono svelte-63z95z"> </td><td class="svelte-63z95z"><span> </span></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Action</span> <span class="tt-pill tt-pill-action svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Side</span> <span class="tt-pill tt-pill-side svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Kind</span> <span class="tt-pill tt-pill-kind svelte-63z95z"> </span></div></div></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Idx</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Time</span><span class="mono svelte-63z95z"> </span></div></div></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Active</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Expire</span><span class="mono svelte-63z95z"> </span></div></div></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Qty%</span><span class="mono svelte-63z95z"> </span></div> <!> <!> <!> <!> <!></div></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Idx</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Time</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Qty</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Price</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Fees</span><span class="mono svelte-63z95z"> </span></div></div></td><td class="svelte-63z95z"><div class="tt-cell-stack svelte-63z95z"><div class="svelte-63z95z"><span class="tt-label svelte-63z95z">Signal</span><span class="mono svelte-63z95z"> </span></div> <div class="svelte-63z95z"><span class="tt-label svelte-63z95z">OCO</span><span class="mono svelte-63z95z"> </span></div></div></td><td class="mono svelte-63z95z"> </td></tr>'),VW=re('<div class="tt-scroll svelte-63z95z"><table class="tt-table tt-table-orders svelte-63z95z"><thead class="svelte-63z95z"><tr><th class="svelte-63z95z">ID</th><th class="svelte-63z95z">Status</th><th class="svelte-63z95z">Type</th><th class="svelte-63z95z">Created</th><th class="svelte-63z95z">Active / Expire</th><th class="svelte-63z95z">Request</th><th class="svelte-63z95z">Fill</th><th class="svelte-63z95z">Signal / OCO</th><th class="svelte-63z95z">Note</th></tr></thead><tbody class="svelte-63z95z"></tbody></table></div>'),WW=re('<div class="no-errors svelte-63z95z">No orders to show.</div>'),qW=re('<div class="tt-title-row svelte-63z95z"><div class="tt-title-group svelte-63z95z"><div class="tt-title svelte-63z95z">Orders</div> <div class="tt-sub mono svelte-63z95z"> <!></div> <div class="tt-note-inline svelte-63z95z">Request shows desired qty/price; Fill shows executed values.</div></div> <button class="btn btn-xs btn-outline" type="button">Download CSV</button></div> <!>',1),HW=re('<div class="tables-modal-backdrop svelte-63z95z" role="presentation"><div class="tables-modal svelte-63z95z" role="dialog" aria-modal="true" aria-label="Trades and Orders"><div class="tables-modal-head svelte-63z95z"><div class="tables-modal-title svelte-63z95z">Trades & Orders</div> <div class="tables-modal-actions svelte-63z95z"><div class="tables-modal-tabs svelte-63z95z" role="tablist" aria-label="Tables"><button type="button" role="tab" class="svelte-63z95z">Trades</button> <button type="button" role="tab" class="svelte-63z95z">Orders</button></div> <button class="btn btn-xs btn-outline" type="button">Close</button></div></div> <div class="tables-modal-body svelte-63z95z"><!></div></div></div>'),GW=re("Backtest requires <code>strategy(...)</code> — add it, then press <b>Run</b>.",1),UW=re('Backtest requires <code>"strategy"</code> — add it, then press <b>Run</b>.',1),YW=re('<div class="no-errors svelte-63z95z"><!></div>'),KW=re("No backtest results yet — add <code>strategy.entry/strategy.exit</code>, then press <b>Run</b>.",1),ZW=re('No backtest results yet — add <code>"signals"</code>, then press <b>Run</b>.',1),XW=re('<div class="no-errors svelte-63z95z"><!></div>'),JW=re("Ready — press <b>Run</b> to calculate results.",1),QW=re('<div class="mono svelte-63z95z" style="margin-top:6px; opacity:0.8"> </div>'),eq=re('<div class="no-errors svelte-63z95z"><!> <!></div>'),tq=re('<div class="meta-chip svelte-63z95z">Last signal <span class="mono svelte-63z95z"> </span></div>'),oq=re('<div class="meta-chip svelte-63z95z">Filter <span class="mono svelte-63z95z"> </span></div>'),sq=(o,e)=>e("setup"),nq=(o,e)=>x(e,D(o.currentTarget.value)),iq=(o,e)=>x(e,D(o.currentTarget.value)),rq=(o,e)=>x(e,D(o.currentTarget.value)),aq=re('<button class="btn btn-xs btn-outline" type="button">Clear</button>'),lq=re('<div class="bt-active mono svelte-63z95z"> </div>'),cq=(o,e)=>x(e,D(o.currentTarget.value)),dq=re('<button class="btn btn-xs btn-outline" type="button">Clear</button>'),uq=(o,e,t)=>e(n(t).id),pq=(o,e,t)=>e(n(t).id),vq=re('<div class="compare-metric svelte-63z95z"><span class="cd-key svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span></div>'),fq=re('<div class="compare-metric svelte-63z95z"><span class="cd-key svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span></div>'),mq=re('<div class="compare-params svelte-63z95z"></div>'),gq=re('<div class="cd-empty svelte-63z95z">No params</div>'),hq=(o,e,t)=>e(n(t).id),_q=re('<pre class="compare-raw mono svelte-63z95z"> </pre>'),yq=re('<div class="compare-details svelte-63z95z"><div class="compare-detail svelte-63z95z"><div class="cd-title svelte-63z95z">Summary</div> <div class="compare-metrics svelte-63z95z"></div></div> <div class="compare-detail svelte-63z95z"><div class="cd-title svelte-63z95z">Params</div> <!></div> <div class="compare-detail svelte-63z95z"><div class="cd-title svelte-63z95z">Raw (optional)</div> <button class="btn btn-xs btn-outline" type="button"> </button> <!></div></div>'),bq=re('<div class="compare-row svelte-63z95z"><div class="mono svelte-63z95z"> </div> <div> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div class="mono svelte-63z95z"> </div> <div class="compare-actions svelte-63z95z"><button class="btn btn-xs btn-outline" type="button"> </button> <button class="btn btn-xs btn-outline" type="button">Remove</button></div></div> <!>',1),xq=re('<div class="compare-table svelte-63z95z"><div class="compare-head svelte-63z95z"><div>Run</div> <div class="right svelte-63z95z">Net</div> <div class="right svelte-63z95z">Ret%</div> <div class="right svelte-63z95z">DD%</div> <div class="right svelte-63z95z">Sharpe</div> <div class="right svelte-63z95z">Win%</div> <div class="right svelte-63z95z">Trades</div> <div>Params</div> <div>Actions</div></div> <!></div>'),wq=re('<div class="bt-empty svelte-63z95z">Pin runs to compare net PnL, drawdown, Sharpe, and params.</div>'),kq=(o,e)=>e("performance"),Sq=re("No signals matched. Check <code>when</code> conditions and series names; try a simpler condition first.",1),Cq=re('Signals matched but no orders filled. Common causes: limit/stop price never touches • stop‑limit expires • try <code>"order": &#123; "kind": "market" &#125;</code> first, then add limit/stop.',1),Pq=re('<div class="bt-hint svelte-63z95z"><div class="bt-hint-title svelte-63z95z">No trades yet</div> <div class="bt-hint-body svelte-63z95z"><!></div></div>'),Iq=(o,e)=>e("behavior"),Mq=re('<div class="sig-row svelte-63z95z"><div class="mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div> </div> <div class="right mono svelte-63z95z"> </div></div>'),Tq=re('<div class="signal-table svelte-63z95z"><div class="sig-head svelte-63z95z"><div>Signal</div> <div class="right svelte-63z95z">Trades</div> <div class="right svelte-63z95z">Win%</div> <div class="right svelte-63z95z">Net</div> <div class="right svelte-63z95z">PF</div></div> <!></div>'),Aq=re('<div class="no-errors svelte-63z95z">No signal stats yet.</div>'),Lq=(o,e)=>e("optimization"),zq=(o,e)=>e(o.currentTarget.value),Fq=re("<option> </option>"),$q=(o,e)=>x(e,D(Number(o.currentTarget.value))),Dq=(o,e)=>x(e,D(Number(o.currentTarget.value))),Eq=(o,e)=>x(e,D(Number(o.currentTarget.value))),Nq=(o,e)=>e(o.currentTarget.value),jq=re("<option> </option>"),Rq=(o,e)=>x(e,D(Number(o.currentTarget.value))),Bq=(o,e)=>x(e,D(Number(o.currentTarget.value))),Oq=(o,e)=>x(e,D(Number(o.currentTarget.value))),Vq=re('<div class="opt-range-grid svelte-63z95z"><label class="opt-field svelte-63z95z"><span class="bt-label svelte-63z95z">From</span> <input class="input input-sm svelte-63z95z" type="number"></label> <label class="opt-field svelte-63z95z"><span class="bt-label svelte-63z95z">To</span> <input class="input input-sm svelte-63z95z" type="number"></label> <label class="opt-field svelte-63z95z"><span class="bt-label svelte-63z95z">Step</span> <input class="input input-sm svelte-63z95z" type="number"></label></div>'),Wq=(o,e)=>x(e,D(o.currentTarget.value)),qq=(o,e)=>x(e,D(o.currentTarget.checked)),Hq=(o,e)=>x(e,D(Math.max(10,Math.min(90,Number(o.currentTarget.value)||70)))),Gq=re('<div class="opt-row svelte-63z95z"><div class="opt-label svelte-63z95z">Train %</div> <div class="opt-control svelte-63z95z"><input class="input input-sm svelte-63z95z" type="number" min="10" max="90"></div></div>'),Uq=re('<button class="btn btn-xs btn-outline" type="button">Stop</button>'),Yq=re('<button class="btn btn-xs btn-outline" type="button">Clear</button>'),Kq=re('<div class="opt-warning svelte-63z95z"> </div>'),Zq=re('<div class="opt-progress svelte-63z95z"><span class="svelte-63z95z"></span></div>'),Xq=re('<div class="opt-row svelte-63z95z"><div class="opt-label svelte-63z95z">Param A</div> <div class="opt-control svelte-63z95z"><select class="input input-sm svelte-63z95z"></select></div></div> <div class="opt-range-grid svelte-63z95z"><label class="opt-field svelte-63z95z"><span class="bt-label svelte-63z95z">From</span> <input class="input input-sm svelte-63z95z" type="number"></label> <label class="opt-field svelte-63z95z"><span class="bt-label svelte-63z95z">To</span> <input class="input input-sm svelte-63z95z" type="number"></label> <label class="opt-field svelte-63z95z"><span class="bt-label svelte-63z95z">Step</span> <input class="input input-sm svelte-63z95z" type="number"></label></div> <div class="opt-row svelte-63z95z"><div class="opt-label svelte-63z95z">Param B</div> <div class="opt-control svelte-63z95z"><select class="input input-sm svelte-63z95z"><option>None</option><!></select></div></div> <!> <div class="opt-row svelte-63z95z"><div class="opt-label svelte-63z95z">Metric</div> <div class="opt-control svelte-63z95z"><select class="input input-sm svelte-63z95z"><option>Net PnL</option><option>Profit Factor</option><option>Sharpe</option><option>Win Rate</option><option>Max Drawdown (lower better)</option></select></div></div> <div class="opt-row svelte-63z95z"><div class="opt-label svelte-63z95z">Walk-forward</div> <div class="opt-control opt-toggle svelte-63z95z"><label class="toggle svelte-63z95z"><input type="checkbox" class="svelte-63z95z"> <span class="toggle-track svelte-63z95z"></span></label></div></div> <!> <div class="opt-actions svelte-63z95z"><button class="btn btn-xs btn-primary" type="button">Run grid</button> <!> <span class="opt-note svelte-63z95z">Up to 200 combos per run.</span></div> <!> <!>',1),Jq=re('<div class="bt-empty svelte-63z95z">No numeric inputs found. Add <code>input.int</code> or <code>input.float</code> to optimize.</div>'),Qq=re('<div><div class="mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div></div>'),eH=re('<div class="opt-test svelte-63z95z"> </div>'),tH=re('<div class="opt-results-meta svelte-63z95z"> </div> <div class="opt-results svelte-63z95z"><div class="opt-results-head svelte-63z95z"><div>Params</div> <div class="right svelte-63z95z">Metric</div> <div class="right svelte-63z95z">Net</div> <div class="right svelte-63z95z">Ret%</div> <div class="right svelte-63z95z">DD%</div> <div class="right svelte-63z95z">Win%</div> <div class="right svelte-63z95z">Trades</div></div> <!></div> <!>',1),oH=re('<div class="bt-empty svelte-63z95z">Run a grid search to see ranked results.</div>'),sH=(o,e)=>e("charts"),nH=(o,e)=>{x(e,"1w")},iH=(o,e)=>{x(e,"1m")},rH=(o,e)=>{x(e,"3m")},aH=(o,e)=>{x(e,"6m")},lH=(o,e)=>{x(e,"1y")},cH=(o,e)=>{x(e,"5y")},dH=(o,e)=>{x(e,"all")},uH=Bi('<path fill="none" stroke="var(--report-benchmark-stroke)" stroke-width="1.25" vector-effect="non-scaling-stroke" stroke-linejoin="round" stroke-linecap="round"></path>'),pH=re('<svg class="report-svg svelte-63z95z" viewBox="0 0 100 100" preserveAspectRatio="none" aria-label="Equity curve"><path fill="var(--report-equity-fill)"></path><path fill="none" stroke="var(--report-equity-stroke)" stroke-width="1.5" vector-effect="non-scaling-stroke" stroke-linejoin="round" stroke-linecap="round"></path><!><line x1="0" y1="25" x2="100" y2="25" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="50" x2="100" y2="50" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="75" x2="100" y2="75" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg> <div class="chart-axis top mono svelte-63z95z"> </div> <div class="chart-axis bottom mono svelte-63z95z"> </div>',1),vH=re('<div class="report-empty svelte-63z95z">No data</div>'),fH=re('<div class="crosshair v svelte-63z95z"></div> <div class="crosshair h svelte-63z95z"></div> <div class="chart-tooltip svelte-63z95z"><div class="tt-title mono svelte-63z95z"> </div> <div class="tt-val svelte-63z95z">Equity: <span class="mono svelte-63z95z"> </span></div></div>',1),mH=re('<div class="report-legend svelte-63z95z"><div class="legend-item svelte-63z95z"><span class="legend-dot equity svelte-63z95z"></span>Equity</div> <div class="legend-item svelte-63z95z"><span class="legend-dot bench svelte-63z95z"></span>Buy &amp; Hold</div></div>'),gH=re('<svg class="report-svg svelte-63z95z" viewBox="0 0 100 100" preserveAspectRatio="none" aria-label="Drawdown"><path fill="var(--report-dd-fill)"></path><path fill="none" stroke="var(--report-dd-stroke)" stroke-width="1.5" vector-effect="non-scaling-stroke" stroke-linejoin="round" stroke-linecap="round"></path><line x1="0" y1="25" x2="100" y2="25" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="50" x2="100" y2="50" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="75" x2="100" y2="75" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg> <div class="chart-axis top mono svelte-63z95z"> </div> <div class="chart-axis bottom mono svelte-63z95z"> </div>',1),hH=re('<div class="report-empty svelte-63z95z">No data</div>'),_H=re('<div class="crosshair v svelte-63z95z"></div> <div class="crosshair h svelte-63z95z"></div> <div class="chart-tooltip svelte-63z95z"><div class="tt-title mono svelte-63z95z"> </div> <div class="tt-val svelte-63z95z">DD: <span class="mono svelte-63z95z"> </span></div></div>',1),yH=(o,e)=>e("returns"),bH=(o,e)=>e("trades"),xH=(o,e,t,s,i)=>{e({type:"month",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i("trades")},wH=(o,e,t,s,i)=>{o.key==="Enter"&&(e({type:"month",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i("trades"))},kH=re('<div role="button" tabindex="0"><div class="mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div></div>'),SH=re('<div class="returns-table svelte-63z95z"><div class="rt-head svelte-63z95z"><div>Month</div><div class="right svelte-63z95z">Return</div></div> <!></div>'),CH=re('<div class="no-errors svelte-63z95z">No monthly returns yet.</div>'),PH=(o,e)=>e("trades"),IH=(o,e,t,s,i)=>{e({type:"week",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i("trades")},MH=(o,e,t,s,i)=>{o.key==="Enter"&&(e({type:"week",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i("trades"))},TH=re('<div role="button" tabindex="0"><div class="mono svelte-63z95z"> </div> <div class="right mono svelte-63z95z"> </div></div>'),AH=re('<div class="returns-table svelte-63z95z"><div class="rt-head svelte-63z95z"><div>Week</div><div class="right svelte-63z95z">Return</div></div> <!></div>'),LH=re('<div class="no-errors svelte-63z95z">No weekly returns yet.</div>'),zH=(o,e)=>e("distributions"),FH=re('<div class="hist-row svelte-63z95z"><div class="hist-label mono svelte-63z95z"> </div> <div class="hist-bar svelte-63z95z"><span class="svelte-63z95z"></span></div> <div class="hist-count mono svelte-63z95z"> </div></div>'),$H=re('<div class="hist svelte-63z95z"></div>'),DH=re('<div class="no-errors svelte-63z95z">No trades yet.</div>'),EH=re('<div class="hist-row svelte-63z95z"><div class="hist-label mono svelte-63z95z"> </div> <div class="hist-bar svelte-63z95z"><span class="svelte-63z95z"></span></div> <div class="hist-count mono svelte-63z95z"> </div></div>'),NH=re('<div class="hist svelte-63z95z"></div>'),jH=re('<div class="no-errors svelte-63z95z">No MAE data.</div>'),RH=re('<div class="hist-row svelte-63z95z"><div class="hist-label mono svelte-63z95z"> </div> <div class="hist-bar svelte-63z95z"><span class="svelte-63z95z"></span></div> <div class="hist-count mono svelte-63z95z"> </div></div>'),BH=re('<div class="hist svelte-63z95z"></div>'),OH=re('<div class="no-errors svelte-63z95z">No MFE data.</div>'),VH=re('<div class="hist-row svelte-63z95z"><div class="hist-label mono svelte-63z95z"> </div> <div class="hist-bar svelte-63z95z"><span class="svelte-63z95z"></span></div> <div class="hist-count mono svelte-63z95z"> </div></div>'),WH=re('<div class="hist svelte-63z95z"></div>'),qH=re('<div class="no-errors svelte-63z95z">No duration data.</div>'),HH=(o,e)=>e("exports"),GH=(o,e)=>e("trades"),UH=(o,e)=>e("orders"),YH=re('<button class="btn btn-sm btn-outline" type="button">Download Filtered Trades CSV</button>'),KH=re('<div class="results-shell svelte-63z95z"><div class="results-hero svelte-63z95z"><div class="results-title-group svelte-63z95z"><div class="results-title svelte-63z95z">Strategy Results</div> <div class="results-sub svelte-63z95z">Latest run summary. Update inputs or filters, then press Run.</div></div> <div class="results-kpis svelte-63z95z"><div class="kpi svelte-63z95z"><div class="kpi-label svelte-63z95z">Final equity</div> <div class="kpi-value mono svelte-63z95z"> </div></div> <div class="kpi svelte-63z95z"><div class="kpi-label svelte-63z95z">Net PnL</div> <div> </div></div> <div class="kpi svelte-63z95z"><div class="kpi-label svelte-63z95z">Max drawdown</div> <div class="kpi-value mono svelte-63z95z"> </div></div></div></div> <div class="results-meta svelte-63z95z"><div class="meta-chip svelte-63z95z">Signals <span class="mono svelte-63z95z"> </span> <span class="meta-sub mono svelte-63z95z"> </span></div> <!> <!></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Setup</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Setup info">i</button></div> <div class="section-sub svelte-63z95z">Limit the backtest window or pin runs for comparison.</div></div></div> <div class="bt-tools svelte-63z95z"><div class="bt-tool-card svelte-63z95z"><div class="rc-title svelte-63z95z">Backtest Filters</div> <div class="bt-field-grid svelte-63z95z"><label class="bt-field svelte-63z95z"><span class="bt-label svelte-63z95z">From</span> <input class="input input-sm svelte-63z95z" type="date"></label> <label class="bt-field svelte-63z95z"><span class="bt-label svelte-63z95z">To</span> <input class="input input-sm svelte-63z95z" type="date"></label> <label class="bt-field svelte-63z95z"><span class="bt-label svelte-63z95z">Session</span> <input class="input input-sm svelte-63z95z" type="text" placeholder="0930-1600"></label></div> <div class="bt-actions svelte-63z95z"><button class="btn btn-xs btn-primary" type="button">Re-run</button> <!> <!> <div class="bt-note svelte-63z95z">Dates use UTC • Session HHMM‑HHMM</div></div></div> <div class="bt-tool-card svelte-63z95z"><div class="rc-title svelte-63z95z">Compare Runs</div> <div class="bt-compare-toolbar svelte-63z95z"><input class="input input-sm svelte-63z95z" type="text" placeholder="Label (optional)"> <button class="btn btn-xs btn-primary" type="button">Pin current</button> <!></div> <!></div></div></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Performance Snapshot</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Performance snapshot info">i</button></div> <div class="section-sub svelte-63z95z">Core stats for this run at a glance.</div></div></div> <div class="results-grid svelte-63z95z"><div class="result-card svelte-63z95z"><div class="rc-title svelte-63z95z">Trades</div> <div class="rc-value svelte-63z95z"> </div> <div class="rc-sub svelte-63z95z"> <!></div></div> <div class="result-card svelte-63z95z"><div class="rc-title svelte-63z95z">Win rate</div> <div class="rc-value svelte-63z95z"> </div> <div class="rc-sub svelte-63z95z"> </div></div> <div class="result-card svelte-63z95z"><div class="rc-title svelte-63z95z">Net PnL</div> <div class="rc-value svelte-63z95z"> </div> <div class="rc-sub svelte-63z95z"> </div></div> <div class="result-card svelte-63z95z"><div class="rc-title svelte-63z95z">Expectancy</div> <div class="rc-value svelte-63z95z"> </div> <div class="rc-sub svelte-63z95z"> </div></div> <div class="result-card svelte-63z95z"><div class="rc-title svelte-63z95z">Risk</div> <div class="rc-value svelte-63z95z"> </div> <div class="rc-sub svelte-63z95z"> </div></div> <div class="result-card svelte-63z95z"><div class="rc-title svelte-63z95z">Exposure</div> <div class="rc-value svelte-63z95z"> </div> <div class="rc-sub svelte-63z95z"> </div></div></div> <!></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Trade Behavior</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Trade behavior info">i</button></div> <div class="section-sub svelte-63z95z">Breakdowns by side and signal.</div></div></div> <div class="breakdown-grid svelte-63z95z"><div class="breakdown-card svelte-63z95z"><div class="rc-title svelte-63z95z">Long vs Short</div> <div class="breakdown-row svelte-63z95z"><span class="mono svelte-63z95z">Long</span> <span class="mono svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span></div> <div class="breakdown-row svelte-63z95z"><span class="mono svelte-63z95z">Short</span> <span class="mono svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span> <span class="mono svelte-63z95z"> </span></div></div> <div class="breakdown-card svelte-63z95z"><div class="rc-title svelte-63z95z">Per‑Signal Stats</div> <!></div></div></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Optimization</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Optimization info">i</button></div> <div class="section-sub svelte-63z95z">Search numeric inputs and rank by the chosen metric.</div></div> <div class="section-meta mono svelte-63z95z"> <!></div></div> <div class="opt-grid svelte-63z95z"><div class="opt-card svelte-63z95z"><div class="rc-title svelte-63z95z">Params</div> <!></div> <div class="opt-card svelte-63z95z"><div class="rc-title svelte-63z95z">Results</div> <!></div></div></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Charts</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Charts info">i</button></div> <div class="section-sub svelte-63z95z">Equity and drawdown for the selected range.</div></div> <div class="section-meta svelte-63z95z"><div class="range-toggle svelte-63z95z" role="group" aria-label="Report range"><button type="button" class="svelte-63z95z">1W</button> <button type="button" class="svelte-63z95z">1M</button> <button type="button" class="svelte-63z95z">3M</button> <button type="button" class="svelte-63z95z">6M</button> <button type="button" class="svelte-63z95z">1Y</button> <button type="button" class="svelte-63z95z">5Y</button> <button type="button" class="svelte-63z95z">All</button></div></div></div> <div class="reports-grid svelte-63z95z"><div class="report-card svelte-63z95z"><div class="report-head svelte-63z95z"><div class="rc-title svelte-63z95z">Equity Curve</div> <div class="report-sub mono svelte-63z95z"><!></div></div> <div class="report-canvas svelte-63z95z"><!> <!></div> <!></div> <div class="report-card svelte-63z95z"><div class="report-head svelte-63z95z"><div class="rc-title svelte-63z95z">Drawdown (%)</div> <div class="report-sub mono svelte-63z95z"> </div></div> <div class="report-canvas svelte-63z95z"><!> <!></div></div></div></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Returns</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Returns info">i</button></div> <div class="section-sub svelte-63z95z">Monthly and weekly performance snapshots.</div></div></div> <div class="returns-grid svelte-63z95z"><div class="return-card svelte-63z95z"><div class="rc-title-row svelte-63z95z"><div class="rc-title svelte-63z95z">Monthly Returns</div> <button class="btn btn-xs btn-outline" type="button">Open Trades Table</button></div> <div class="rc-subhint svelte-63z95z">Click a row to filter trades by that period.</div> <!></div> <div class="return-card svelte-63z95z"><div class="rc-title-row svelte-63z95z"><div class="rc-title svelte-63z95z">Weekly Returns</div> <button class="btn btn-xs btn-outline" type="button">Open Trades Table</button></div> <div class="rc-subhint svelte-63z95z">Click a row to filter trades by that period.</div> <!></div></div></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Distributions</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Distributions info">i</button></div> <div class="section-sub svelte-63z95z">See how trades are distributed across outcomes.</div></div></div> <div class="dist-grid svelte-63z95z"><div class="dist-card svelte-63z95z"><div class="rc-title svelte-63z95z">PnL% Distribution</div> <!></div> <div class="dist-card svelte-63z95z"><div class="rc-title svelte-63z95z">MAE% Distribution</div> <!></div> <div class="dist-card svelte-63z95z"><div class="rc-title svelte-63z95z">MFE% Distribution</div> <!></div> <div class="dist-card svelte-63z95z"><div class="rc-title svelte-63z95z">Trade Duration (bars)</div> <!></div></div></div> <div class="results-section svelte-63z95z"><div class="section-head svelte-63z95z"><div><div class="section-title-row svelte-63z95z"><div class="section-title svelte-63z95z">Exports & Totals</div> <button class="info-btn svelte-63z95z" type="button" aria-label="Exports info">i</button></div> <div class="section-sub svelte-63z95z">Download data or review totals for this run.</div></div></div> <div class="export-row svelte-63z95z"><button class="btn btn-sm btn-primary" type="button">Open Trades Table</button> <button class="btn btn-sm btn-primary" type="button">Open Orders Table</button> <button class="btn btn-sm btn-outline" type="button">Download Trades CSV</button> <!> <button class="btn btn-sm btn-outline" type="button">Download Orders CSV</button> <button class="btn btn-sm btn-outline" type="button">Download Equity CSV</button></div> <div class="pnl-strip svelte-63z95z"><div class="pnl-item pos svelte-63z95z"> </div> <div class="pnl-item neg svelte-63z95z"> </div> <div> </div></div> <div class="pnl-strip pnl-strip-2 svelte-63z95z"><div class="pnl-item svelte-63z95z"> </div> <div class="pnl-item svelte-63z95z"> </div> <div class="pnl-item svelte-63z95z"> </div></div></div></div>'),ZH=re('<div class="errors-area svelte-63z95z"><!> <!></div>'),XH=o=>{var e;try{(e=o==null?void 0:o.stopPropagation)==null||e.call(o)}catch{}},JH=(o,e)=>x(e,"en"),QH=(o,e)=>x(e,"bn"),eG=re("<li> </li>"),tG=re("<li> </li>"),oG=re('<ul class="info-list svelte-63z95z"></ul> <div class="info-example svelte-63z95z"><div class="info-example-title svelte-63z95z">Example</div> <ul class="svelte-63z95z"></ul></div>',1),sG=re('<div class="info-modal-backdrop svelte-63z95z" role="presentation"><div class="info-modal svelte-63z95z" role="dialog" aria-modal="true" aria-label="Section info"><div class="info-modal-head svelte-63z95z"><div class="info-modal-title svelte-63z95z"> </div> <div class="info-modal-actions svelte-63z95z"><div class="info-lang-toggle svelte-63z95z" role="group" aria-label="Info language"><button type="button" class="svelte-63z95z">EN</button> <button type="button" class="svelte-63z95z">BN</button></div> <button class="btn btn-xs btn-outline" type="button">Close</button></div></div> <div class="info-modal-body svelte-63z95z"><!></div></div></div>'),nG=re('<div class="script-studio svelte-63z95z"><div class="studio-header svelte-63z95z"><div class="studio-title svelte-63z95z"><div class="title-dot svelte-63z95z"></div> <div class="title-text-group svelte-63z95z"><div class="title-text svelte-63z95z">Script Studio</div> <div class="title-sub svelte-63z95z">Inline editor · draft → chart</div></div></div> <div class="studio-meta svelte-63z95z"><div class="view-toggle svelte-63z95z"><button type="button" class="svelte-63z95z">Editor</button> <button type="button" class="svelte-63z95z"><span> </span> <!></button> <button type="button" class="svelte-63z95z">Results</button></div> <div class="lang-toggle svelte-63z95z" aria-label="Script mode"><span class="lang-label svelte-63z95z">Mode</span> <select class="lang-select svelte-63z95z"><option>Auto</option><option>JSON</option><option>Pine</option><option>DSL</option></select></div></div> <div class="studio-actions svelte-63z95z"><!> <button class="ghost svelte-63z95z" type="button" title="Toggle chart labels"><span class="btn-icon svelte-63z95z"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true"><path d="M2 3.5h8M2 6h8M2 8.5h5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path></svg></span> <span> </span></button> <button class="ghost ghost-secondary svelte-63z95z" type="button"><span>Documentation</span></button> <button class="ghost svelte-63z95z" type="button"><span class="btn-icon svelte-63z95z"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true"><path d="M3 2.5h6v7H3z" stroke="currentColor" stroke-width="1.2"></path><path d="M4 1h4v2H4z" fill="currentColor"></path><path d="M5 7h2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path></svg></span> <span>Save</span></button> <button class="ghost svelte-63z95z" type="button"><span class="btn-icon svelte-63z95z"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true"><path d="M6 2a4 4 0 1 1-3.5 2.06" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path><path d="M2.5 2.5v3h3" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path></svg></span> <span>Reset</span></button> <button class="primary svelte-63z95z" type="button"><span class="btn-icon svelte-63z95z"><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" aria-hidden="true"><path d="M4 3.2v5.6L9 6 4 3.2Z"></path></svg></span> <span> </span></button> <!> <button class="icon svelte-63z95z" type="button" aria-label="Collapse script dock">&times;</button></div></div> <!> <!> <div class="studio-footer svelte-63z95z"><div class="footer-left svelte-63z95z"><span></span> <span class="footer-text svelte-63z95z"> </span></div> <div class="footer-right svelte-63z95z"><span class="footer-hint svelte-63z95z">Ctrl/Cmd + S to save</span> <span class="footer-divider svelte-63z95z">•</span> <span class="footer-hint svelte-63z95z">Ctrl/Cmd + Enter to run</span></div></div></div>');function iG(o,e){Mc(e,!0);let t=Qs(e,"code",15,""),s=Qs(e,"status",3,null),i=Qs(e,"error",3,null),r=Qs(e,"backtest",3,null),a=Qs(e,"signalEvents",19,()=>[]),l=Qs(e,"isRunning",3,!1),c=Qs(e,"isOpen",3,!0),d=Qs(e,"paneTarget",7,"main"),v=Qs(e,"labelsEnabled",3,!0);const g=sp();function _(pe){d()!==pe&&(d(pe),g("pane",{target:pe}))}const y=pe=>{if(!pe)return 0;let Pe=2166136261;for(let vo=0;vo<pe.length;(vo+=1)-1)Pe^=pe.charCodeAt(vo),Pe=Math.imul(Pe,16777619);const Ht=Pe>>>0;return Ht===0?1:Ht},k=pe=>{const Pe=String(pe||"");let Ht="",vo=0;for(;vo<Pe.length;){const as=Pe[vo];if(as==='"'||as==="'"){const po=as;vo+=1;let Bs="",xs=!1;for(;vo<Pe.length;){const en=Pe[vo];if(xs){Bs+=en,xs=!1,vo+=1;continue}if(en==="\\"){xs=!0,vo+=1;continue}if(en===po){vo+=1;break}Bs+=en,vo+=1}Ht+=String(y(Bs));continue}Ht+=as,vo+=1}return Ht},S=pe=>{let Pe=String(pe||"").trim();return Pe=Pe.replace(/\/\/.*$/,"").replace(/#.*$/,""),Pe=Pe.split(";")[0],Pe=Pe.replace(/,\s*$/,""),Pe=Pe.replace(/\b(and|or)\b\s*$/i,""),Pe=Pe.replace(/\bta\./gi,""),Pe=Pe.replace(/\bmath\./gi,""),Pe=Pe.replace(/\b(barstate|timeframe|syminfo|strategy)\.([A-Za-z0-9_]+)/gi,(Ht,vo,as)=>`${String(vo).toLowerCase()}_${as}`),Pe=k(Pe),Pe=Pe.replace(/\bcrosses\s+above\b/gi,"crossesAbove"),Pe=Pe.replace(/\bcrosses\s+below\b/gi,"crossesBelow"),Pe.trim()};let M=ee("editor"),I=ee("auto"),C=ee(D(!!v())),T=ee(!1),z=ee("trades"),j=ee(!1);const B={setup:{en:{title:"Setup",desc:["Backtest Filters define the time window for the run (date range + session).","Filters do not change results until you press Run again.","Session uses HHMM-HHMM (leave blank for full day).","Compare Runs saves a snapshot (results + inputs) when you press Pin current.","Use Compare to see how parameter changes affect results side-by-side."],examples:["From 2025-01-01 to 2025-03-31 + Session 0930-1600 -> Run shows only those hours.","Pin Run A -> change fast=10 -> Run -> Pin Run B to compare."]},bn:{title:"সেটআপ",desc:["Backtest Filters মানে কোন সময়ের ডেটা নিয়ে টেস্ট করবেন (তারিখ + সেশন)।","ফিল্টার বদলালেই ফল বদলায় না—আবার Run দিলেই নতুন ফল আসবে।","Session ফরম্যাট HHMM-HHMM; ফাঁকা রাখলে পুরো দিন ধরা হয়।","Pin current দিলে ওই মুহূর্তের ফল + ইনপুট সেভ হয়।","Compare দিয়ে ছোট পরিবর্তনের ফল পাশাপাশিই দেখা যায়।"],examples:["From 2025-01-01, To 2025-03-31 + Session 0930-1600 দিলে শুধু ওই সময়ের ফল।","Run A Pin -> fast=10 দিন -> Run -> Pin -> দুইটা রানের ফল তুলনা।"]}},performance:{en:{title:"Performance Snapshot",desc:["Trades means a complete position: entry -> exit. For long it is buy->sell; for short it is sell->buy.","Net PnL is your real profit after fees; Return (%) compares that to your starting capital.","Max Drawdown is the biggest fall from a previous peak; smaller is safer.","Profit Factor > 1 means total wins are larger than total losses; Expectancy is avg profit per trade.","Sharpe/Sortino show risk-adjusted return; Exposure shows how long you were in the market."],examples:["A 60% win rate with negative Net PnL means losses are larger than wins.","A smooth, slowly rising equity curve usually means lower risk."]},bn:{title:"পারফরম্যান্স স্ন্যাপশট",desc:["Trades মানে সম্পূর্ণ একটি পজিশন: entry থেকে exit। Long হলে buy->sell, short হলে sell->buy।","Net PnL হলো আসল লাভ/ক্ষতি: মোট লাভ থেকে ফি/চার্জ বাদ।","Return (%) দেখায় শুরু করা টাকার তুলনায় কত শতাংশ লাভ/ক্ষতি হলো।","Max Drawdown মানে আগের সর্বোচ্চ লেভেল থেকে সবচেয়ে বড় পতন—এটা যত কম, তত নিরাপদ।","Profit Factor > 1 হলে লাভ ক্ষতির চেয়ে বেশি; Expectancy হলো প্রতি ট্রেডে গড় লাভ/ক্ষতি।","Sharpe/Sortino বলে একই লাভ করতে কত ঝুঁকি নিয়েছেন; Exposure দেখায় কত সময় ট্রেডে ছিলেন।"],examples:["Win rate বেশি হলেও Net negative হলে loss-গুলো বড় হয়েছে।","কম Drawdown + ধীরে ওপরে ওঠা curve মানে স্টেবল ট্রেডিং।"]}},behavior:{en:{title:"Trade Behavior",desc:["Long vs Short splits performance by direction.","Per-Signal Stats groups trades by signal ID so you can see what works.","Signals with low Net/PF are usually the ones to fix or remove.","Use this section to debug entries/exits, not just profitability."],examples:["Short trades = 0 means a long-only strategy.","If EXIT_FULL is net negative, your exit logic may be hurting results."]},bn:{title:"ট্রেড বিহেভিয়ার",desc:["Long বনাম Short আলাদা করে দেখায় কোন দিক বেশি কাজ করেছে।","Per-Signal Stats দেখায় কোন signal ID লাভ/ক্ষতি দিচ্ছে।","যে signal বারবার ক্ষতি করে, সেটি পরিবর্তন বা বন্ধ করতে পারবেন।","Trades/Net/PF দেখে বোঝা যায় কোনটা শক্তিশালী।"],examples:["Short ট্রেড 0 হলে long-only।","EXIT_FULL যদি net negative হয়, exit logic ঠিক করুন।"]}},optimization:{en:{title:"Optimization",desc:["Optimization only works if your script defines input.int or input.float.","Param A/B choose which inputs to sweep.","From/To/Step sets the grid values for each parameter.","Total runs = count(A) x count(B); too many combos triggers a warning.","Metric controls ranking (Max DD: lower is better).","Walk-forward splits Train/Test so results are more realistic."],examples:["Fast 5->20 step 5 gives 4 values; Slow 20->60 step 10 gives 5 values -> 20 runs.","Top row is best by the chosen metric."]},bn:{title:"অপ্টিমাইজেশন",desc:["Optimization কাজ করবে শুধু input.int বা input.float থাকলে।","Param A/B মানে কোন ইনপুটের মান ঘুরিয়ে দেখা হবে।","From/To/Step দিয়ে রেঞ্জ সেট হয়।","মোট রান = A-র মান x B-র মান (খুব বেশি হলে warning আসবে)।","Metric অনুযায়ী র‍্যাংক হয় (Max DD হলে কম মান ভালো)।","Walk-forward দিলে Train/Test আলাদা হয়ে বাস্তবসম্মত ফল পাওয়া যায়।"],examples:["Fast 5->20 step 5 = 4 মান; Slow 20->60 step 10 = 5 মান -> মোট 20 রান।","Top row মানে সেরা ফল।"]}},charts:{en:{title:"Charts",desc:["Equity curve (area + line) shows how your balance moved over time.","Buy & Hold line is the benchmark: what if you just held.","Drawdown chart shows the depth of pullbacks from peaks.","Range buttons only change the chart window, not the backtest itself."],examples:["Equity above Buy & Hold means the strategy outperformed holding.","Hover to see the exact date and equity value."]},bn:{title:"চার্টস",desc:["Equity curve (area + line) দেখায় আপনার ব্যালেন্স সময়ের সাথে কেমন বদলেছে।","Buy & Hold line হলো তুলনা—শুধু ধরে রাখলে কী হতো।","Drawdown chart দেখায় সবচেয়ে বড় পতন কত % ছিল।","1M/3M/6M/All শুধু চার্ট রেঞ্জ বদলায়, ট্রেড রেজাল্ট নয়।"],examples:["Equity line যদি Buy & Hold-এর উপরে থাকে, স্ট্র্যাটেজি ভালো।","Hover করলে নির্দিষ্ট দিনের equity দেখা যায়।"]}},returns:{en:{title:"Returns",desc:["Monthly/Weekly returns show which periods were good or bad.","Click a row to filter trades for that period.","Great for spotting seasonality or outlier months.","Empty means there were no trades in that period."],examples:["2025-02 +3.2% means that month was profitable.","Click a week row, then open Trades table to see those trades."]},bn:{title:"রিটার্নস",desc:["Monthly/Weekly রিটার্নস দেখায় কোন সময় ভালো বা খারাপ গেছে।","Row ক্লিক করলে ওই সময়ের ট্রেড ফিল্টার হয়।","Seasonality ধরতে কাজে লাগে।","ডেটা না থাকলে ওই সময় ট্রেড হয়নি।"],examples:["2025-02 মাসে +3.2% মানে লাভ।","Week row ক্লিক করলে Trades টেবিলে ফিল্টার হয়।"]}},distributions:{en:{title:"Distributions",desc:["PnL% histogram shows how trade outcomes are spread.","MAE% = worst adverse move; MFE% = best favorable move.","Duration shows how long trades usually last (in bars).","Use these to tune stops, targets, and holding time."],examples:["If most PnL% bins are small, results are consistent but modest.","High MAE suggests trades go deep negative before exit."]},bn:{title:"ডিস্ট্রিবিউশন",desc:["PnL% histogram দেখায় ফলাফল কোন রেঞ্জে বেশি হচ্ছে।","MAE% = সবচেয়ে খারাপ adverse move; MFE% = সবচেয়ে ভালো move।","Duration দিয়ে ট্রেড কত বার ধরে থাকে বোঝা যায়।","এগুলো দেখে stop-loss/TP টিউন করা যায়।"],examples:["PnL% ছোট রেঞ্জে বেশি মানে consistent ছোট লাভ।","MAE বেশি হলে ট্রেড আগে অনেক নিচে যায়।"]}},exports:{en:{title:"Exports & Totals",desc:["Open Trades/Orders tables to inspect each trade and order.","CSV exports are for Excel/Sheets or external analysis.","Totals summarize gross profit, gross loss, net, initial/final equity.","Filtered trades CSV respects the current month/week filter."],examples:["Use Trades CSV to build custom reports.","Total = Gross Profit - Gross Loss (fees shown separately)."]},bn:{title:"এক্সপোর্টস ও টোটালস",desc:["Trades/Orders টেবিলে প্রতিটি ট্রেডের Net PnL/fees/price দেখা যায়।","CSV ডাউনলোড করে Excel/Sheets-এ বিশ্লেষণ করা যায়।","Totals-এ gross profit, gross loss, net, initial/final equity দেখা যায়।","Filtered trades CSV বর্তমান ফিল্টার মেনে চলে।"],examples:["Trades CSV দিয়ে custom রিপোর্ট বানান।","Total = Gross Profit - Gross Loss (fees আলাদা)।"]}}};let $=ee(!1),F=ee("setup"),V=ee("bn");function K(pe){x(F,D(pe)),x($,!0)}let Y=ee(D([])),Z=ee("");function ne(pe){x(Y,D(n(Y).filter(vo=>vo.id!==pe))),n(At)===pe&&x(At,null);const{[pe]:Pe,...Ht}=n(Gt);x(Gt,D(Ht))}let te=ee(""),oe=ee(""),U=ee("");const J=Qe(()=>{const pe={},Pe=n(te).trim(),Ht=n(oe).trim(),vo=n(U).trim();return Pe&&(pe.from=Pe),Ht&&(pe.to=Ht),vo&&(pe.session=vo),Object.keys(pe).length?pe:null}),se=Qe(()=>!!n(J)),W=Qe(()=>{const pe=[];return(n(te)||n(oe))&&pe.push(`${n(te)||"…"} → ${n(oe)||"…"}`),n(U)&&pe.push(`Session ${n(U)}`),pe.join(" • ")}),le=Qe(()=>n(Fl).filter(pe=>pe.type==="int"||pe.type==="float"));let ye=ee(!1),Ce=ee(""),Re=ee(""),Ke=ee(0),st=ee(0),vt=ee(1),Je=ee(0),ot=ee(0),nt=ee(1),tt=ee("netPnl"),Ze=ee(!1),ct=ee(D([])),Ge=ee(0),pt=ee(!1),ce=ee(D([])),we=ee(""),ze=ee(!1),dt=ee(70),qe=ee("train"),me=ee(null),Q=ee(0);const it=Qe(()=>n(ct).length),Vt=Qe(()=>n(it)>0?Math.min(100,Math.round(n(Ge)/n(it)*100)):0),wt=Qe(()=>[...n(ce)].sort((pe,Pe)=>Li(Pe.summary)-Li(pe.summary))),Yt=Qe(()=>n(tt)==="profitFactor"?"Profit Factor":n(tt)==="sharpe"?"Sharpe":n(tt)==="winRate"?"Win Rate":n(tt)==="maxDrawdownPct"?"Max DD (lower is better)":"Net PnL");let At=ee(null),Gt=ee(D({}));function no(pe){x(At,D(n(At)===pe?null:pe))}function Do(pe){x(Gt,D({...n(Gt),[pe]:!n(Gt)[pe]}))}function Eo(pe,Pe=40){if(pe==null)return"—";let Ht="";if(typeof pe=="number"||typeof pe=="boolean")Ht=String(pe);else if(typeof pe=="string")Ht=pe;else try{Ht=JSON.stringify(pe)}catch{Ht=String(pe)}return Pe>0&&Ht.length>Pe?`${Ht.slice(0,Pe-1)}…`:Ht}function bs(pe){return pe?Object.entries(pe).slice(0,6).map(([Pe,Ht])=>`${Pe}=${Eo(Ht,18)}`).join(", "):"-"}const Is=pe=>[{label:"Final",value:Qt(pe.finalEquity,2)},{label:"Net",value:`${pe.netPnl>=0?"+":""}${Qt(pe.netPnl,2)} (${ie(pe.netPnlPct??0)})`},{label:"DD",value:ie(pe.maxDrawdownPct??0)},{label:"PF",value:Ct(pe.profitFactor??0)},{label:"Win",value:ie(pe.winRate??0)},{label:"Trades",value:String(pe.trades??0)},{label:"Sharpe",value:Ct(pe.sharpe??0)},{label:"Sortino",value:Ct(pe.sortino??0)},{label:"Exposure",value:ie(pe.exposurePct??0)},{label:"Bars/Trade",value:Qt(pe.avgBarsInTrade??0,1)}];function qi(pe){try{return JSON.stringify({label:pe.label,ts:pe.ts,params:pe.params,summary:pe.summary},null,2)}catch{return String(pe.summary)}}function Ks(pe){const Pe=n(le).find(Bs=>Bs.name===pe),Ht=typeof(Pe==null?void 0:Pe.defval)=="number"?Pe.defval:0,vo=typeof(Pe==null?void 0:Pe.minval)=="number"?Pe.minval:Ht,as=typeof(Pe==null?void 0:Pe.maxval)=="number"?Pe.maxval:Ht,po=typeof(Pe==null?void 0:Pe.step)=="number"?Pe.step:(Pe==null?void 0:Pe.type)==="int"?1:.1;return{from:vo,to:as,step:po}}function ws(pe){x(Ce,D(pe));const Pe=Ks(pe);x(Ke,D(Pe.from)),x(st,D(Pe.to)),x(vt,D(Pe.step))}function vn(pe){if(x(Re,D(pe)),!pe)return;const Pe=Ks(pe);x(Je,D(Pe.from)),x(ot,D(Pe.to)),x(nt,D(Pe.step))}zr(()=>{n(ye)||n(le).length&&(ws(n(le)[0].name),n(le).length>1&&vn(n(le)[1].name),x(ye,!0))});function es(pe,Pe,Ht,vo){const as=n(le).find(Zt=>Zt.name===pe),po=(as==null?void 0:as.type)==="int",Bs=Math.abs(vo||1);if(!Number.isFinite(Pe)||!Number.isFinite(Ht)||!Number.isFinite(Bs)||Bs<=0)return[];const xs=[],en=Pe<=Ht?1:-1;let Sn=Pe,lt=0;for(;en>0&&Sn<=Ht+1e-9||en<0&&Sn>=Ht-1e-9;){const Zt=po?Math.round(Sn):Number(Sn.toFixed(6));if(xs.push(Zt),Sn+=Bs*en,lt+=1,lt>2e3)break}return Array.from(new Set(xs))}function Li(pe){return pe?n(tt)==="profitFactor"?pe.profitFactor??0:n(tt)==="sharpe"?pe.sharpe??0:n(tt)==="winRate"?pe.winRate??0:n(tt)==="maxDrawdownPct"?-(pe.maxDrawdownPct??0):pe.netPnl??0:-1/0}function ci(pe){return pe?n(tt)==="profitFactor"?pe.profitFactor??0:n(tt)==="sharpe"?pe.sharpe??0:n(tt)==="winRate"?pe.winRate??0:n(tt)==="maxDrawdownPct"?pe.maxDrawdownPct??0:pe.netPnl??0:0}function oa(pe){const Pe=ci(pe);return n(tt)==="winRate"||n(tt)==="maxDrawdownPct"?ie(Pe):Qt(Pe,2)}function ol(pe){const Pe=n(J)&&typeof n(J)=="object"?{...n(J)}:null;return!Pe&&!pe?null:{...Pe||{},...pe||{}}}function Xi(pe){if(!n(ct).length)return;const Pe=n(ct)[pe];if(!Pe)return;const Ht=n(ze)?fc(n(qe)):null,vo=ol(Ht);x(pt,!0),g("run",{code:t(),params:Pe.params,lang:n(I),backtest:vo})}function fc(pe){var po,Bs;if(!n(Mn).length)return null;const Pe=Number((po=n(Mn)[0])==null?void 0:po.timestamp),Ht=Number((Bs=n(Mn)[n(Mn).length-1])==null?void 0:Bs.timestamp);if(!Number.isFinite(Pe)||!Number.isFinite(Ht)||Ht<=Pe)return null;const vo=Math.max(10,Math.min(90,Number(n(dt))||70))/100,as=Math.round(Pe+(Ht-Pe)*vo);return pe==="train"?{from:Pe,to:as}:{from:as,to:Ht}}zr(()=>{var po;if(!n(Ze)||!n(pt)||l())return;const pe=tf(r()),Pe=Number((pe==null?void 0:pe._updatedAt)??0),Ht=Number(tf(n(Q)));if(!pe||!Pe||Pe===Ht)return;x(Q,D(Pe)),x(pt,!1);const vo=((po=n(ct)[n(Ge)])==null?void 0:po.params)||{},as=pe.summary;if(as&&(x(ce,D([...n(ce),{params:vo,summary:as}])),n(ze)&&n(qe)==="test"&&x(me,D({params:vo,summary:as}))),x(Ge,n(Ge)+1),n(Ge)<n(ct).length)Xi(n(Ge));else if(n(ze)&&n(qe)==="train"){const Bs=[...n(ce)].sort((xs,en)=>Li(en.summary)-Li(xs.summary))[0];Bs?(x(ct,D([{params:Bs.params}])),x(Ge,0),x(qe,"test"),Xi(0)):x(Ze,!1)}else x(Ze,!1)});const rd=Qe(()=>n(I)==="auto"?"auto":n(I)),ml=pe=>{const Pe=String(pe||"").trim();return Pe.startsWith("{")||Pe.startsWith("[")},Jl=pe=>{const Pe=String(pe||"").split(/\r?\n/),Ht=Math.min(8,Pe.length);for(let vo=0;vo<Ht;(vo+=1)-1){const po=(Pe[vo]||"").match(/^\s*(?:\/\/|#)\s*@?(?:lang|language)\s*(?::|=)?\s*([A-Za-z]+)\s*$/i);if(!po)continue;const Bs=String(po[1]||"").toLowerCase();if(Bs==="auto"||Bs==="json"||Bs==="pine"||Bs==="dsl")return Bs}return null},Wl=Qe(()=>{if(n(I)!=="auto")return n(I);const pe=Jl(t());return pe||(ml(t())?"json":"auto")});zr(()=>{x(C,D(!!v()))});const sl=Qe(()=>n(M)==="results");function Uc(){x(j,!1),g("fullpage",{enabled:!1})}hp(()=>{const pe=Pe=>{n(j)&&Pe.key==="Escape"&&(Pe.preventDefault(),Uc())};return window.addEventListener("keydown",pe),()=>window.removeEventListener("keydown",pe)}),rf(()=>{try{n(j)&&g("fullpage",{enabled:!1})}catch{}});const Nl=Qe(()=>{try{const pe=JSON.parse(String(t()||"").trim());return!!(pe!=null&&pe.strategy)}catch{return!1}}),Yc=Qe(()=>{try{const pe=JSON.parse(String(t()||"").trim());return Array.isArray(pe==null?void 0:pe.signals)&&pe.signals.length>0}catch{return!1}}),Ec=Qe(()=>{try{return Ih(String(t()||""))}catch{return null}}),Ja=Qe(()=>{const pe=n(Ec);return!!(pe&&pe.ok&&pe.spec&&pe.spec.strategy)}),sa=Qe(()=>{const pe=n(Ec),Pe=pe&&pe.ok&&pe.spec?pe.spec.signals:null;return Array.isArray(Pe)&&Pe.length>0}),jl=Qe(()=>!!(n(Nl)||n(Ja))),Td=Qe(()=>!!(n(Yc)||n(sa))),_d=Qe(()=>{const pe=n(Ec);return!pe||!pe.ok?[]:Array.isArray(pe.warnings)?pe.warnings:[]}),Fl=Qe(()=>{const pe=n(Ec);return!pe||!pe.ok?[]:Array.isArray(pe.inputDefs)?pe.inputDefs:[]});let qa=ee(null);zr(()=>{if(!n(Fl).length){x(qa,null);return}n(qa)==null&&x(qa,D({}))});const td=Qe(()=>{const pe={};for(const Pe of n(Fl))pe[Pe.name]=n(qa)&&Pe.name in n(qa)?n(qa)[Pe.name]:Pe.defval;return pe}),Nc=(pe,Pe)=>{x(qa,D({...n(qa)||{},[pe]:Pe}))},be=Qe(()=>{var pe;return((pe=r())==null?void 0:pe.summary)||null}),We=Qe(()=>{if(!n(sl))return{total:0,entryLong:0,exitLong:0,entryShort:0,exitShort:0,lastTs:null};const pe=Array.isArray(a())?a():[],Pe={total:pe.length,entryLong:0,exitLong:0,entryShort:0,exitShort:0};let Ht=null;for(const vo of pe){if(!vo)continue;vo.type==="entry_long"?Pe.entryLong+=1:vo.type==="exit_long"?Pe.exitLong+=1:vo.type==="entry_short"?Pe.entryShort+=1:vo.type==="exit_short"&&(Pe.exitShort+=1);const as=Number(vo.timestamp);Number.isFinite(as)&&(Ht=Ht==null?as:Math.max(Ht,as))}return{...Pe,lastTs:Ht}}),de=Qe(()=>{var pe;return n(sl)&&Array.isArray((pe=r())==null?void 0:pe.trades)?r().trades:[]}),De=Qe(()=>{var pe;return n(sl)&&Array.isArray((pe=r())==null?void 0:pe.orders)?r().orders:[]}),Ee=pe=>{const Pe=typeof pe=="number"?pe:Number(pe);return!Number.isFinite(Pe)||Pe<=0?null:Pe<1e12?Pe*1e3:Pe},xe=pe=>{const Pe=Ee(pe);if(Pe==null)return"-";try{const vo=new Date(Pe).toISOString();return`${vo.slice(0,10)} ${vo.slice(11,16)}`}catch{return"-"}},gt=pe=>{const Pe=typeof pe=="number"?pe:Number(pe);return Number.isFinite(Pe)?Pe:null},at=Qe(()=>{var as;const pe=n(sl)&&Array.isArray((as=r())==null?void 0:as.roundTrips)?r().roundTrips:[],Pe=n(de).length===0&&pe.length>0,Ht=(Pe?pe:n(de)).filter(po=>po&&Number.isFinite(Number(po.entryIndex))&&Number.isFinite(Number(po.exitIndex))).slice().sort((po,Bs)=>Number(po.exitIndex)-Number(Bs.exitIndex)||Number(po.entryIndex)-Number(Bs.entryIndex));let vo=0;return Ht.map((po,Bs)=>{const xs=gt(po.pnl??po.grossPnl??po.profit),en=gt(po.fees??po.fee??po.commission),Sn=Pe&&Number.isFinite(Number(po.netPnl))?Number(po.netPnl):(xs??0)-(en??0);vo+=Sn;const lt=Ee(po.entryTimestamp),Zt=Ee(po.exitTimestamp),qt=xe(lt),Lo=xe(Zt),ks=[po.side||"",po.entryIndex,po.exitIndex,lt??0,Zt??0,po.entryOrderId??"",po.exitOrderId??"",Bs].join(":"),yr=gt(Pe?po.avgEntryPrice??po.entryPrice??po.entry:po.entryPrice??po.entry_price??po.entry),N=gt(Pe?po.avgExitPrice??po.exitPrice??po.exit:po.exitPrice??po.exit_price??po.exit);return{id:ks,side:String(po.side||""),qty:gt(po.qty??po.size??po.qtyEntered)??0,entryIndex:Number(po.entryIndex)||0,exitIndex:Number(po.exitIndex)||0,entryTimestamp:lt,exitTimestamp:Zt,entryTimeLabel:qt,exitTimeLabel:Lo,entryPrice:yr??0,exitPrice:N??0,entrySignalId:po.entrySignalId!=null?String(po.entrySignalId):"",exitSignalId:po.exitSignalId!=null?String(po.exitSignalId):"",pnl:xs??0,pnlPct:gt(po.pnlPct??po.pnl_pct??po.returnPct)??0,fees:en??0,netPnl:Sn,cumNet:vo,exitReason:String(po.exitReason||""),maePct:Number.isFinite(Number(po.maePct))?Number(po.maePct):null,mfePct:Number.isFinite(Number(po.mfePct))?Number(po.mfePct):null,barsHeld:Math.max(0,(Number(po.exitIndex)||0)-(Number(po.entryIndex)||0)+1)}})}),jt=Qe(()=>n(De).filter(Pe=>Pe&&Number.isFinite(Number(Pe.createdIndex))).slice().sort((Pe,Ht)=>Number(Pe.createdIndex)-Number(Ht.createdIndex)||String(Pe.id||"").localeCompare(String(Ht.id||""))).map((Pe,Ht)=>{const vo=Ee(Pe.createdTimestamp),as=Ee(Pe.filledTimestamp),po=String(Pe.kind||"").toLowerCase(),Bs=String(Pe.action||""),xs=String(Pe.side||""),en=String(Pe.status||""),Sn=gt(Pe.qty??Pe.quantity),lt=gt(Pe.cash),Zt=gt(Pe.price),qt=gt(Pe.stopPrice),Lo=gt(Pe.limitPrice),ks=String(en||"").toLowerCase().replace(/[^a-z0-9]+/g,"-");return{id:String(Pe.id||Ht),action:Bs,actionLabel:Kt(Bs),side:xs,sideLabel:Kt(xs),kind:String(Pe.kind||""),kindLabel:fo(Pe.kind),originalKind:String(Pe.originalKind||""),status:en,statusLabel:Kt(en),statusKey:ks,signalId:Pe.signalId!=null?String(Pe.signalId):"",ocoGroup:Pe.ocoGroup!=null?String(Pe.ocoGroup):"",createdIndex:Number(Pe.createdIndex)||0,createdTimestamp:vo,createdTimeLabel:xe(vo),activeFromIndex:Number(Pe.activeFromIndex)||0,expiresAtIndex:Number.isFinite(Number(Pe.expiresAtIndex))?Number(Pe.expiresAtIndex):null,qtyPct:Number(Pe.qtyPct)||0,qty:Sn,cash:lt,price:Zt,stopPrice:qt??(po==="stop"?Zt:null),limitPrice:Lo??(po==="limit"?Zt:null),filledIndex:Number.isFinite(Number(Pe.filledIndex))?Number(Pe.filledIndex):null,filledTimestamp:as,filledTimeLabel:xe(as),fillPrice:gt(Pe.fillPrice),fillQty:gt(Pe.fillQty),fees:gt(Pe.fees),note:Pe.note!=null?String(Pe.note):""}})),Lt=Qe(()=>n(jt).length>500?n(jt).slice(n(jt).length-500):n(jt));let Mt=ee(D({type:"all"})),Io=ee(""),Bo=ee(D({key:"exitIndex",dir:"desc"}));function hs(pe){n(Bo).key===pe?x(Bo,D({key:pe,dir:n(Bo).dir==="asc"?"desc":"asc"})):x(Bo,D({key:pe,dir:"desc"}))}function is(pe){return n(Bo).key!==pe?"":n(Bo).dir==="asc"?"↑":"↓"}const Es=Qe(()=>{const pe=n(at),Pe=xs=>{const en=Number(xs==null?void 0:xs.exitTimestamp);return!Number.isFinite(en)||en<=0?!1:n(Mt).type==="month"?zi(en)===n(Mt).key:n(Mt).type==="week"?hr(en)===n(Mt).key:!0},Ht=n(Io).trim().toLowerCase(),vo=n(Mt).type==="all"?pe:pe.filter(Pe),as=Ht?vo.filter(xs=>[xs.side,xs.exitReason,xs.entrySignalId,xs.exitSignalId,String(xs.entryIndex),String(xs.exitIndex)].filter(Boolean).map(Sn=>String(Sn).toLowerCase()).some(Sn=>Sn.includes(Ht))):vo,po=n(Bo).dir==="asc"?1:-1,Bs=n(Bo).key;return as.slice().sort((xs,en)=>{const Sn=xs==null?void 0:xs[Bs],lt=en==null?void 0:en[Bs];if(Bs==="side")return String(Sn).localeCompare(String(lt))*po;const Zt=typeof Sn=="number"?Sn:Number(Sn),qt=typeof lt=="number"?lt:Number(lt);return!Number.isFinite(Zt)&&!Number.isFinite(qt)?0:Number.isFinite(Zt)?Number.isFinite(qt)?(Zt-qt)*po:-1:1})}),bt=pe=>{const Pe=pe.length;let Ht=0,vo=0,as=0,po=0,Bs=0,xs=0,en=0,Sn=0,lt=0;for(const N of pe){const X=Number(N==null?void 0:N.netPnl)||0,fe=Number(N==null?void 0:N.fees)||0,Ae=Number(N==null?void 0:N.pnl)||0;as+=X,po+=fe,Bs+=Ae,Ae>0?xs+=Ae:Ae<0&&(en+=Math.abs(Ae)),X>0?(Ht+=1,Sn+=X):X<0&&(vo+=1,lt+=X)}const Zt=Pe?Ht/Pe*100:0,qt=Ht?Sn/Ht:0,Lo=vo?lt/vo:0,ks=en>0?xs/en:xs>0?1/0:0,yr=Pe?Ht/Pe*qt+vo/Pe*Lo:0;return{trades:Pe,wins:Ht,losses:vo,winRate:Zt,net:as,fees:po,gross:Bs,grossProfit:xs,grossLoss:en,profitFactor:ks,avgWin:qt,avgLoss:Lo,expectancy:yr}},kt=Qe(()=>{const pe=n(at).filter(Ht=>String(Ht.side)==="long"),Pe=n(at).filter(Ht=>String(Ht.side)==="short");return{long:bt(pe),short:bt(Pe)}}),xo=Qe(()=>{const pe=n(at),Pe=new Map;for(const vo of pe){const as=String(vo.entrySignalId||vo.exitSignalId||"unknown"),po=Pe.get(as)||[];po.push(vo),Pe.set(as,po)}const Ht=Array.from(Pe.entries()).map(([vo,as])=>({id:vo,...bt(as)}));return Ht.sort((vo,as)=>(as.net||0)-(vo.net||0)),Ht}),$t=Qe(()=>{const pe=n(at).map(Pe=>Number(Pe==null?void 0:Pe.pnlPct)).filter(Pe=>Number.isFinite(Pe));return na(pe,12)}),_o=Qe(()=>{const pe=n(at).map(Pe=>Number(Pe==null?void 0:Pe.maePct)).filter(Pe=>Number.isFinite(Pe));return na(pe,10)}),go=Qe(()=>{const pe=n(at).map(Pe=>Number(Pe==null?void 0:Pe.mfePct)).filter(Pe=>Number.isFinite(Pe));return na(pe,10)}),fs=Qe(()=>{const pe=n(at).map(Pe=>Number(Pe==null?void 0:Pe.barsHeld)).filter(Pe=>Number.isFinite(Pe));return na(pe,10)}),Ms=Qe(()=>n(Es).length>500?n(Es).slice(n(Es).length-500):n(Es)),zn=Qe(()=>n(at).reduce((pe,Pe)=>pe+(Number(Pe.netPnl)||0),0));let qs=ee(null);function Vn(pe){x(qs,D((pe==null?void 0:pe.id)||null)),g("selectTrade",{trade:pe||null})}function Ss(pe){x(Mt,D(pe)),n(qs)&&(n(Es).some(Ht=>Ht.id===n(qs))||x(qs,null))}function di(pe){x(z,D(pe)),x(T,!0)}const Mn=Qe(()=>{var pe;return n(sl)&&Array.isArray((pe=r())==null?void 0:pe.equity)?r().equity:[]}),La=Qe(()=>{var pe;return n(sl)&&Array.isArray((pe=r())==null?void 0:pe.benchmark)?r().benchmark:[]});let nn=ee("6m");function tr(pe,Pe){var po;if(!Array.isArray(pe)||pe.length===0)return[];if(Pe==="all")return pe;const Ht=Number((po=pe[pe.length-1])==null?void 0:po.timestamp);if(!Number.isFinite(Ht)||Ht<=0)return pe;const vo=Pe==="1w"?7:Pe==="1m"?30:Pe==="3m"?90:Pe==="6m"?180:Pe==="1y"?365:365*5,as=Ht-vo*864e5;return pe.filter(Bs=>Number(Bs==null?void 0:Bs.timestamp)>=as)}const Ur=Qe(()=>tr(n(Mn),n(nn))),cl=Qe(()=>tr(n(La),n(nn))),ui=Qe(()=>n(Ur).map(pe=>({index:Number(pe.index),ts:Number(pe.timestamp),equity:Number(pe.equity)})).filter(pe=>Number.isFinite(pe.index)&&Number.isFinite(pe.ts)&&Number.isFinite(pe.equity))),Yr=Qe(()=>n(cl).map(pe=>({index:Number(pe.index),ts:Number(pe.timestamp),equity:Number(pe.equity)})).filter(pe=>Number.isFinite(pe.index)&&Number.isFinite(pe.ts)&&Number.isFinite(pe.equity))),Ra=Qe(()=>{if(!n(ui).length)return[];let pe=-1/0;return n(ui).map(Pe=>{pe=Math.max(pe,Pe.equity);const Ht=pe>0?(Pe.equity-pe)/pe*100:0;return{index:Pe.index,ts:Pe.ts,ddPct:Ht}})});function ga(pe,Pe){const Ht=pe.filter(Lo=>Number.isFinite(Lo));if(!Ht.length)return null;const vo=typeof Pe=="number"&&Number.isFinite(Pe)?Pe:Math.min(...Ht);let as=Math.min(...Ht,vo),po=Math.max(...Ht,vo);if(!Number.isFinite(as)||!Number.isFinite(po))return null;as===po&&(as-=1,po+=1);const Bs=Ht.length,xs=Lo=>Bs<=1?0:Lo/(Bs-1)*100,en=Lo=>(1-(Lo-as)/(po-as))*100,Sn=en(vo),lt=Ht.map((Lo,ks)=>({x:xs(ks),y:en(Lo)})),Zt=lt.map((Lo,ks)=>`${ks===0?"M":"L"} ${Lo.x.toFixed(3)} ${Lo.y.toFixed(3)}`).join(" "),qt=[`M ${lt[0].x.toFixed(3)} ${Sn.toFixed(3)}`,...lt.map(Lo=>`L ${Lo.x.toFixed(3)} ${Lo.y.toFixed(3)}`),`L ${lt[lt.length-1].x.toFixed(3)} ${Sn.toFixed(3)}`,"Z"].join(" ");return{line:Zt,area:qt,minY:as,maxY:po,baselineY:Sn}}function na(pe,Pe){const Ht=pe.filter(xs=>Number.isFinite(xs));if(!Ht.length||Pe<=0)return[];let vo=Math.min(...Ht),as=Math.max(...Ht);if(vo===as)return[{label:`${Qt(vo,2)}`,count:Ht.length,min:vo,max:as}];const po=(as-vo)/Pe,Bs=[];for(let xs=0;xs<Pe;(xs+=1)-1){const en=vo+po*xs,Sn=xs===Pe-1?as:vo+po*(xs+1);Bs.push({label:`${Qt(en,2)}–${Qt(Sn,2)}`,count:0,min:en,max:Sn})}for(const xs of Ht){const en=Math.min(Bs.length-1,Math.floor((xs-vo)/po));Bs[en].count+=1}return Bs}function nl(pe){let Pe=0;for(const Ht of pe)Ht.count>Pe&&(Pe=Ht.count);return Pe||1}const mi=Qe(()=>ga(n(ui).map(pe=>pe.equity))),Ha=Qe(()=>ga(n(Yr).map(pe=>pe.equity))),lr=Qe(()=>ga(n(Ra).map(pe=>pe.ddPct),0));function zi(pe){const Pe=new Date(pe),Ht=Pe.getUTCFullYear(),vo=String(Pe.getUTCMonth()+1).padStart(2,"0");return`${Ht}-${vo}`}function hr(pe){const Pe=new Date(pe),Ht=new Date(Date.UTC(Pe.getUTCFullYear(),Pe.getUTCMonth(),Pe.getUTCDate())),vo=Ht.getUTCDay()||7;Ht.setUTCDate(Ht.getUTCDate()+4-vo);const as=new Date(Date.UTC(Ht.getUTCFullYear(),0,1)),po=Math.ceil(((Ht-as)/864e5+1)/7);return`${Ht.getUTCFullYear()}-W${String(po).padStart(2,"0")}`}function xa(pe,Pe){if(!(pe!=null&&pe.length))return[];const Ht=Pe==="month"?zi:hr,vo=new Map;for(const xs of pe){const en=Number(xs==null?void 0:xs.timestamp),Sn=Number(xs==null?void 0:xs.equity),lt=Number(xs==null?void 0:xs.index);if(!Number.isFinite(en)||!Number.isFinite(Sn)||!Number.isFinite(lt))continue;const Zt=Ht(en),qt=vo.get(Zt);qt?qt.last={ts:en,eq:Sn,idx:lt}:vo.set(Zt,{first:{ts:en,eq:Sn,idx:lt},last:{ts:en,eq:Sn,idx:lt}})}const as=Array.from(vo.keys()).sort(),po=[];let Bs=null;for(const xs of as){const en=vo.get(xs),Sn=Number(en.last.eq);if(!Number.isFinite(Sn))continue;if(Bs==null){Bs=Sn;continue}const lt=Bs!==0?(Sn-Bs)/Bs*100:0;po.push({key:xs,retPct:lt,from:Bs,to:Sn,toIndex:Number(en.last.idx),toTs:Number(en.last.ts)}),Bs=Sn}return po}const Qa=Qe(()=>xa(n(Mn),"month")),ue=Qe(()=>xa(n(Mn),"week")),Fe=Qe(()=>{const pe=new Map;for(const Pe of n(at)){const Ht=Number(Pe==null?void 0:Pe.exitTimestamp);if(!Number.isFinite(Ht)||Ht<=0)continue;const vo=zi(Ht),as=pe.get(vo)||{trades:0,wins:0,losses:0,net:0,fees:0},po=Number(Pe==null?void 0:Pe.netPnl)||0;as.trades+=1,as.net+=po,as.fees+=Number(Pe==null?void 0:Pe.fees)||0,po>0?as.wins+=1:po<0&&(as.losses+=1),pe.set(vo,as)}return pe}),ut=Qe(()=>{const pe=new Map;for(const Pe of n(at)){const Ht=Number(Pe==null?void 0:Pe.exitTimestamp);if(!Number.isFinite(Ht)||Ht<=0)continue;const vo=hr(Ht),as=pe.get(vo)||{trades:0,wins:0,losses:0,net:0,fees:0},po=Number(Pe==null?void 0:Pe.netPnl)||0;as.trades+=1,as.net+=po,as.fees+=Number(Pe==null?void 0:Pe.fees)||0,po>0?as.wins+=1:po<0&&(as.losses+=1),pe.set(vo,as)}return pe});function Xe(pe){const Pe=Ht=>{const vo=Ht==null?"":String(Ht);return/[",\n]/.test(vo)?`"${vo.replace(/"/g,'""')}"`:vo};return pe.map(Pe).join(",")}function ht(pe,Pe,Ht){try{const vo=new Blob([Pe],{type:Ht}),as=URL.createObjectURL(vo),po=document.createElement("a");po.href=as,po.download=pe,document.body.appendChild(po),po.click(),po.remove(),setTimeout(()=>URL.revokeObjectURL(as),2500)}catch{}}const ao=190,It=58,eo=10;let Mo=ee(null),ho=ee(null);const to=Qe(()=>{try{const pe=JSON.parse(String(t()||"").trim());return!!(pe!=null&&pe.pane||pe!=null&&pe.panes||pe!=null&&pe.main||pe!=null&&pe.sub)}catch{return!1}});zr(()=>{n(ui),n(Ra),n(M),n(M)});function ds(pe){if(!n(ui).length)return;const Ht=pe.currentTarget.getBoundingClientRect(),vo=Math.max(0,Math.min(ao,Ht.width-eo*2)),as=Math.max(0,Math.min(It,Ht.height-eo*2)),po=Math.max(0,Math.min(Ht.width,pe.clientX-Ht.left)),Bs=Math.max(0,Math.min(Ht.height,pe.clientY-Ht.top)),xs=Math.round(po/Math.max(1,Ht.width)*(n(ui).length-1)),en=n(ui)[xs];if(!en)return;let Sn=po+12;Sn+vo+eo>Ht.width&&(Sn=po-12-vo),Sn=Math.max(eo,Math.min(Sn,Ht.width-vo-eo));let lt=Bs-12-as;lt<eo&&(lt=Bs+12),lt=Math.max(eo,Math.min(lt,Ht.height-as-eo)),x(Mo,D({x:po,y:Bs,left:Sn,top:lt,ts:en.ts,equity:en.equity}))}function js(pe){if(!n(Ra).length)return;const Ht=pe.currentTarget.getBoundingClientRect(),vo=Math.max(0,Math.min(ao,Ht.width-eo*2)),as=Math.max(0,Math.min(It,Ht.height-eo*2)),po=Math.max(0,Math.min(Ht.width,pe.clientX-Ht.left)),Bs=Math.max(0,Math.min(Ht.height,pe.clientY-Ht.top)),xs=Math.round(po/Math.max(1,Ht.width)*(n(Ra).length-1)),en=n(Ra)[xs];if(!en)return;let Sn=po+12;Sn+vo+eo>Ht.width&&(Sn=po-12-vo),Sn=Math.max(eo,Math.min(Sn,Ht.width-vo-eo));let lt=Bs-12-as;lt<eo&&(lt=Bs+12),lt=Math.max(eo,Math.min(lt,Ht.height-as-eo)),x(ho,D({x:po,y:Bs,left:Sn,top:lt,ts:en.ts,ddPct:en.ddPct}))}const Si=Qe(()=>String(t()||"").split(`
`)),$r=Qe(()=>n(Si).length||1);function pa(pe,Pe){let Ht=1,vo=1;for(let as=0;as<Pe&&as<pe.length;as+=1)pe[as]===`
`?(Ht+=1,vo=1):vo+=1;return{line:Ht,col:vo}}function En(pe){try{return{ok:!0,value:JSON.parse(pe)}}catch(Pe){const Ht=String((Pe==null?void 0:Pe.message)||"Invalid JSON"),vo=Ht.match(/position\s+(\d+)/i),as=vo?Number(vo[1]):null,po=typeof as=="number"&&Number.isFinite(as)?pa(pe,as):void 0;return{ok:!1,error:{level:"error",message:Ht,hint:"Fix JSON syntax (quotes/commas/braces).",line:po==null?void 0:po.line,col:po==null?void 0:po.col}}}}function za(){const pe=[],Pe=String(t()||"").trim();if(!Pe)return pe;const Ht=/^\s*\/\/@\s*(?:pine|version)\b/m.test(Pe)||/\b(strategy|indicator|plot)\s*\(/m.test(Pe),vo=n(Wl);if(vo==="pine"||vo==="auto"&&Ht){try{const po=Ih(Pe);po&&po.ok===!1&&Array.isArray(po.errors)&&po.errors.length&&po.errors.slice(0,12).forEach(Bs=>{pe.push({level:"error",message:String((Bs==null?void 0:Bs.message)||"Pine error"),hint:"Fix the Pine line or use the Guide examples.",line:typeof(Bs==null?void 0:Bs.line)=="number"?Bs.line:void 0,col:1})})}catch{}return pe}if(vo==="dsl"||vo==="auto"&&!ml(Pe))return pe;const as=En(Pe);if(!as.ok)return pe.push(as.error),pe;try{const po=as.value;if(po&&(po.plots||po.calc||po.panes||po.main||po.sub)){const Bs=po&&typeof po=="object"?po.params||{}:{},xs=y1(po,Bs),en=_1(xs);en.ok||(en.errors||[]).forEach(fe=>pe.push({level:"error",message:fe,hint:or(fe)}));const Sn=xs.pane||xs.plots||xs.labels||xs.levels||xs.lines?{pane:xs.pane||"main",plots:xs.plots||[],labels:xs.labels||[],levels:xs.levels||[],lines:xs.lines||[],min:xs.min,max:xs.max}:null,lt=[].concat(Sn?[Sn]:[]).concat(xs.panes||[]).concat(xs.main?[xs.main]:[]).concat(xs.sub?[xs.sub]:[]),Zt=Array.isArray(xs.calc)?xs.calc:[],qt=Array.isArray(xs.series)?xs.series:[],Lo=new Set(["open","high","low","close","volume"]);qt.forEach(fe=>{const Ae=String((fe==null?void 0:fe.name)||"").replace(/\s+/g,"_").toLowerCase();Ae&&Lo.add(Ae)}),Zt.forEach(fe=>{const Ae=String((fe==null?void 0:fe.type)||(fe==null?void 0:fe.name)||"").toLowerCase(),Le=String((fe==null?void 0:fe.name)||(fe==null?void 0:fe.type)||"").replace(/\s+/g,"_").toLowerCase();if(_2.includes(Ae)||Ae&&pe.push({level:"error",message:`Unsupported calc type "${fe==null?void 0:fe.type}"`,hint:`Use one of: ${Array.from(_2).join(", ")}`}),Ae==="ema"){const ft=fe==null?void 0:fe.period;(typeof ft!="number"||!(ft>0))&&pe.push({level:"error",message:"EMA requires numeric period > 0",hint:'Add "period": e.g., 20'})}if(Ae==="macd"){const ft=Bt=>typeof Bt=="number"&&Bt>0;(!ft(fe==null?void 0:fe.fast)||!ft(fe==null?void 0:fe.slow)||!ft(fe==null?void 0:fe.signal))&&pe.push({level:"error",message:"MACD requires numeric fast/slow/signal",hint:'Add "fast":12, "slow":26, "signal":9'})}if(Ae==="stoch"){const ft=Bt=>typeof Bt=="number"&&Bt>0;(!ft(fe==null?void 0:fe.kPeriod)||!ft(fe==null?void 0:fe.dPeriod))&&pe.push({level:"error",message:"Stochastic requires kPeriod and dPeriod",hint:'Add "kPeriod":14, "dPeriod":3'})}Le&&(Ae==="bbands"||Ae==="bollinger"||Ae==="bollinger_bands"||Ae==="kc"||Ae==="keltner"||Ae==="donchian"||Ae==="linreg_channel"?(Lo.add(`${Le}_mid`),Lo.add(`${Le}_upper`),Lo.add(`${Le}_lower`)):Ae==="atr_bands"?(Lo.add(`${Le}_upper`),Lo.add(`${Le}_lower`)):Ae==="macd"?(Lo.add("macd_line"),Lo.add("macd_signal"),Lo.add("macd_hist")):Ae==="stoch"?(Lo.add(`${Le}_k`),Lo.add(`${Le}_d`)):Ae==="ichimoku"?["tenkan","kijun","spana","spanb","chikou"].forEach(ft=>Lo.add(ft)):Lo.add(Le))}),lt.forEach((fe,Ae)=>{(fe.plots||[]).forEach((Le,ft)=>{const Bt=String((Le==null?void 0:Le.type)||"line").toLowerCase();y2.includes(Bt)||pe.push({level:"warning",message:`Pane[${Ae}] plot[${ft}] unsupported type "${Le==null?void 0:Le.type}"`,hint:`Supported: ${Array.from(y2).join(", ")}`});const Ft=String((Le==null?void 0:Le.source)||"").replace(/\s+/g,"_").toLowerCase();Ft&&!Lo.has(Ft)&&pe.push({level:"error",message:`Pane[${Ae}] plot[${ft}] source "${Le==null?void 0:Le.source}" not defined`,hint:"Define it in calc/series or use a valid alias."})}),(fe.labels||[]).forEach((Le,ft)=>{const Bt=String((Le==null?void 0:Le.shape)||"label");Bt&&!b2.includes(Bt)&&pe.push({level:"warning",message:`Pane[${Ae}] label[${ft}] unsupported shape "${Bt}"`,hint:`Supported: ${Array.from(b2).join(", ")}`}),Le!=null&&Le.shape||pe.push({level:"warning",message:`Pane[${Ae}] label[${ft}] no shape set (default: label)`,hint:'Set "shape": triangle_up_filled, triangle_down_filled, label, pill, tag, flag'});const Ft=String((Le==null?void 0:Le.source)||"").replace(/\s+/g,"_").toLowerCase();Ft&&!["open","high","low","close","volume"].includes(Ft)&&!Lo.has(Ft)&&pe.push({level:"error",message:`Pane[${Ae}] label[${ft}] source "${Le==null?void 0:Le.source}" not defined`,hint:"Use high/low/open/close or a defined series"}),String((fe==null?void 0:fe.pane)||"main").toLowerCase()==="sub"&&(Ft==="high"||Ft==="low")&&pe.push({level:"warning",message:`Pane[${Ae}] label[${ft}] anchors to price in sub pane`,hint:"Move label to main pane for price anchors"});const zt=String((Le==null?void 0:Le.when)||"");if(zt.trim())try{const io=cm(S(zt)),Wt=[],zo=Et=>{!Et||typeof Et!="object"||(Et.kind==="SeriesRef"&&Wt.push(String(Et.name||"")),Object.values(Et).forEach(zo))};zo(io),Wt.forEach(Et=>{const Ut=Et.replace(/\s+/g,"_").toLowerCase();!Lo.has(Ut)&&!["open","high","low","close","volume"].includes(Ut)&&pe.push({level:"warning",message:`Label[${Ae}:${ft}] references unknown series "${Et}"`,hint:"Define via calc/series or use a base series (open/high/low/close/volume)."})})}catch(io){const Wt=(io==null?void 0:io.position)!=null?` at ${io.position}`:"",zo=io instanceof Uf?io.message:String(io),Et=typeof(io==null?void 0:io.position)=="number"?pa(Pe,io.position):void 0;pe.push({level:"error",message:`Label[${Ae}:${ft}] condition parse failed${Wt}: ${zo}`,hint:"Use crossover(a,b), crossunder(a,b), between(x,a,b). Ensure series names exist.",line:Et==null?void 0:Et.line,col:Et==null?void 0:Et.col})}})});const ks=new Set;lt.forEach(fe=>{(fe.plots||[]).forEach(Ae=>{const Le=String((Ae==null?void 0:Ae.source)||"").replace(/\s+/g,"_").toLowerCase();Le&&ks.add(Le)}),(fe.labels||[]).forEach(Ae=>{const Le=String((Ae==null?void 0:Ae.source)||"").replace(/\s+/g,"_").toLowerCase();Le&&ks.add(Le);const ft=String((Ae==null?void 0:Ae.when)||"");try{const Bt=cm(S(ft)),Ft=[],zt=io=>{!io||typeof io!="object"||(io.kind==="SeriesRef"&&Ft.push(String(io.name||"")),Object.values(io).forEach(zt))};zt(Bt),Ft.forEach(io=>ks.add(io.replace(/\s+/g,"_").toLowerCase()))}catch{}}),(fe.lines||[]).forEach(Ae=>{const Le=String((Ae==null?void 0:Ae.segmentsFrom)||"").replace(/\s+/g,"_").toLowerCase();Le&&ks.add(Le);const ft=String((Ae==null?void 0:Ae.start)||"").replace(/\s+/g,"_").toLowerCase();ft&&ks.add(ft);const Bt=String((Ae==null?void 0:Ae.end)||"").replace(/\s+/g,"_").toLowerCase();Bt&&ks.add(Bt)})}),(Array.isArray(po.signals)?po.signals:[]).forEach(fe=>{const Ae=String((fe==null?void 0:fe.when)||"");try{const Le=cm(S(Ae)),ft=[],Bt=Ft=>{!Ft||typeof Ft!="object"||(Ft.kind==="SeriesRef"&&ft.push(String(Ft.name||"")),Object.values(Ft).forEach(Bt))};Bt(Le),ft.forEach(Ft=>ks.add(Ft.replace(/\s+/g,"_").toLowerCase()))}catch{}});const N=qt.map(fe=>String((fe==null?void 0:fe.expr)||"")).join(" ").replace(/\s+/g," ").toLowerCase(),X=(fe,Ae)=>{const Le=fe.toLowerCase(),ft=Ae;return Le==="bbands"||Le==="bollinger"||Le==="bollinger_bands"||Le==="kc"||Le==="keltner"||Le==="donchian"||Le==="linreg_channel"?[`${ft}_mid`,`${ft}_upper`,`${ft}_lower`]:Le==="atr_bands"?[`${ft}_upper`,`${ft}_lower`]:Le==="stoch"?[`${ft}_k`,`${ft}_d`]:Le==="macd"?["macd_line","macd_signal","macd_hist"]:Le==="ichimoku"?["tenkan","kijun","spana","spanb","chikou"]:[ft]};return Zt.forEach(fe=>{const Ae=String((fe==null?void 0:fe.name)||(fe==null?void 0:fe.type)||"").replace(/\s+/g,"_").toLowerCase();if(Ae&&!ks.has(Ae)){const Le=String((fe==null?void 0:fe.type)||""),ft=X(Le,Ae);if(!ft.some(Ft=>ks.has(Ft))){const Ft=N&&new RegExp(`\\b${Ae.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")}\\b`,"i").test(N),zt=N&&ft.some(io=>new RegExp(`\\b${io.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")}\\b`,"i").test(N));if(Ft||zt)return;pe.push({level:"warning",message:`Calc "${Le}" (${Ae}) is defined but not used`,hint:"Reference it in plots or label conditions"})}}}),pe}}catch{pe.push({level:"warning",message:"Non‑JSON script detected",hint:"Use JSON spec or the DSL examples from Guide. If JSON, ensure valid commas/quotes/braces.",line:1,col:1})}return pe}const Rs=Qe(za),Zs=Qe(()=>n(Rs).filter(pe=>pe.level==="error").length),gn=Qe(()=>n(Rs).filter(pe=>pe.level==="warning").length),Wn=Qe(()=>n(Rs).length),Tn=Qe(()=>n(Zs)>0?"Errors":n(gn)>0?"Warnings":"Issues"),Ko=Qe(()=>i()?`Error: ${i()}`:l()?"Running…":s()?s():"Ready"),Qt=(pe,Pe=2)=>Number.isFinite(pe)?pe.toFixed(Pe):"—",H=(pe,Pe=2,Ht=8)=>{if(!Number.isFinite(pe))return"—";const vo=Math.abs(pe);if(vo===0||vo>=1)return pe.toFixed(Pe);const as=Math.ceil(-Math.log10(vo)),po=Math.max(Pe,Math.min(Ht,Pe+as));return pe.toFixed(po)},Me=pe=>H(pe,2,6),Ue=pe=>H(pe,2,10),yt=pe=>H(pe,6,10),St=(pe,Pe=2)=>{const Ht=typeof pe=="number"?pe:Number(pe);return Number.isFinite(Ht)?Qt(Ht,Pe):"—"},lo=pe=>{const Pe=typeof pe=="number"?pe:Number(pe);return Number.isFinite(Pe)?Me(Pe):"—"},he=pe=>{const Pe=typeof pe=="number"?pe:Number(pe);return Number.isFinite(Pe)?Ue(Pe):"—"},ke=pe=>{const Pe=typeof pe=="number"?pe:Number(pe);return Number.isFinite(Pe)?yt(Pe):"—"},Ne=pe=>{const Pe=typeof pe=="number"?pe:Number(pe);return Number.isFinite(Pe)?ie(Pe):"—"},ie=pe=>`${Qt(pe,2)}%`,Ct=pe=>pe===1/0?"∞":Qt(pe,2),Kt=pe=>{const Pe=String(pe||"").replace(/_/g," ").trim();return Pe?Pe.charAt(0).toUpperCase()+Pe.slice(1):"—"},fo=pe=>{const Pe=String(pe||"").toLowerCase();return Pe?Pe==="stop_limit"?"Stop-limit":Pe==="market"?"Market":Pe==="limit"?"Limit":Pe==="stop"?"Stop":Kt(Pe):"—"},mo=Qe(()=>n(Rs).filter(pe=>typeof pe.line=="number").map(pe=>({line:pe.line,col:pe.col,level:pe.level}))),Go=Qe(()=>{const pe=String(t()||"").split(`
`),Pe=new Map;n(mo).forEach(vo=>{Pe.has(vo.line)||Pe.set(vo.line,[]),Pe.get(vo.line).push({col:vo.col,level:vo.level})});const Ht=vo=>vo.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return pe.map((vo,as)=>{const po=as+1,Bs=Pe.get(po)||[],xs=Bs.some(qt=>!qt.col),en=Ht(vo||" ");if(xs)return`<div class="code-line"><mark class="err err-${Bs[0].level}">${en}</mark></div>`;if(!Bs.length)return`<div class="code-line"><span>${en}</span></div>`;const Sn=Bs.filter(qt=>typeof qt.col=="number"&&qt.col>0).sort((qt,Lo)=>qt.col-Lo.col);let lt="",Zt=0;return Sn.forEach((qt,Lo)=>{const ks=Math.max(0,qt.col-1);ks>Zt&&(lt+=Ht(vo.slice(Zt,ks))),lt+=`<mark class="err err-${qt.level}">${Ht(vo.slice(ks))||"&nbsp;"}</mark>`,Zt=vo.length}),Zt<vo.length&&(lt+=Ht(vo.slice(Zt))),`<div class="code-line"><span>${lt||"&nbsp;"}</span></div>`}).join("")});let Fo=ee(void 0),Wo=ee(void 0),us=ee(void 0);function Un(){var Ht,vo;const pe=((Ht=n(Fo))==null?void 0:Ht.scrollTop)??0,Pe=((vo=n(Fo))==null?void 0:vo.scrollLeft)??0;n(Wo)&&(n(Wo).scrollTop=pe,n(Wo).scrollLeft=Pe),n(us)&&(n(us).scrollTop=pe)}function or(pe){const Pe=pe.toLowerCase();return Pe.includes("no panes defined")?'Add pane:"main" or {main:{...}} with plots/labels.':Pe.includes("has no plots/labels/levels/lines")?"Add at least one plot or label in the pane.":Pe.includes("series")?"Check series names and expressions; use normalized aliases like macd_line.":"Review field names/types; see Guide examples."}B0();var $s=nG(),gi=m($s);gi.__pointerdown=[EV];var kn=p(m(gi),2),_r=m(kn),Kr=m(_r);Kr.__click=[NV,M];var Ul=p(Kr,2);Ul.__click=[jV,M];var wa=m(Ul),wl=m(wa,!0);f(wa);var Cl=p(wa,2);Te(Cl,()=>n(Wn),pe=>{var Pe=RV(),Ht=m(Pe,!0);f(Pe),Se(()=>{Gn(Pe,`err-badge ${(n(Zs)===0&&n(gn)>0?"warn":"")??""} svelte-63z95z`),Ve(Ht,n(Wn))}),O(pe,Pe)}),f(Ul);var dl=p(Ul,2);dl.__click=[BV,M],f(_r);var cr=p(_r,2),Br=p(m(cr),2);Br.__click=[OV];var Fi=m(Br);Fi.value=(Fi.__value="auto")==null?"":"auto";var fr=p(Fi);fr.value=(fr.__value="json")==null?"":"json";var gl=p(fr);gl.value=(gl.__value="pine")==null?"":"pine";var Gs=p(gl);Gs.value=(Gs.__value="dsl")==null?"":"dsl",f(Br),f(cr),f(kn);var Ql=p(kn,2),ia=m(Ql);Te(ia,()=>!n(to),pe=>{var Pe=qV(),Ht=m(Pe);Ht.__click=[VV,_];var vo=p(Ht,2);vo.__click=[WV,_],f(Pe),Se(()=>{ii(Ht,"active",d()==="main"),ii(vo,"active",d()==="sub")}),O(pe,Pe)});var jd=p(ia,2);jd.__click=[PV,C,g];var xu=p(m(jd),2),ip=m(xu);f(xu),f(jd);var $p=p(jd,2);$p.__click=[CV,g];var Wp=p($p,2);Wp.__click=[kV,g,t];var Yu=p(Wp,2);Yu.__click=[wV,g];var Lu=p(Yu,2);Lu.__click=[I2,g,t,qa,I,J];var Cp=p(m(Lu),2),Sv=m(Cp,!0);f(Cp),f(Lu);var rp=p(Lu,2);Te(rp,()=>!n(j),pe=>{var Pe=HV();Pe.__click=[FV,j,g],O(pe,Pe)},pe=>{var Pe=GV();Pe.__click=Uc,O(pe,Pe)});var jf=p(rp,2);jf.__click=[SV,j,g],f(Ql),f(gi);var Ws=p(gi,2);Te(Ws,()=>n(M)==="editor",pe=>{var Pe=nW(),Ht=m(Pe),vo=m(Ht),as=m(vo),po=m(as),Bs=p(m(po),2),xs=m(Bs);f(Bs);var en=p(Bs,2),Sn=m(en);f(en),f(po),pn(2),f(as);var lt=p(as,2),Zt=m(lt);Vs(Zt,21,()=>n(Si),_n,(fe,Ae,Le)=>{var ft=UV();ft.textContent=Le+1,O(fe,ft)}),f(Zt),du(Zt,fe=>x(us,fe),()=>n(us));var qt=p(Zt,2),Lo=m(qt),ks=m(Lo),yr=m(ks);b5(yr,()=>n(Go)),f(ks),pn(2),f(Lo),du(Lo,fe=>x(Wo,fe),()=>n(Wo));var N=p(Lo,2);Yw(N),N.__input=Un,du(N,fe=>x(Fo,fe),()=>n(Fo)),f(qt),f(lt),f(vo);var X=p(vo,2);Te(X,()=>n(Fl).length,fe=>{var Ae=sW(),Le=m(Ae),ft=p(m(Le),4);Te(ft,()=>n(_d).length,Ft=>{var zt=KV();Vs(zt,21,()=>n(_d).slice(0,3),io=>io.message,(io,Wt)=>{var zo=YV(),Et=m(zo);f(zo),Se(()=>Ve(Et,`Line ${n(Wt).line??""}: ${n(Wt).message??""}`)),O(io,zo)}),f(zt),O(Ft,zt)});var Bt=p(ft,2);Vs(Bt,21,()=>n(Fl),Ft=>Ft.name,(Ft,zt)=>{var io=oW(),Wt=m(io),zo=m(Wt),Et=m(zo,!0);f(zo);var Ut=p(zo,2),wo=m(Ut,!0);f(Ut),f(Wt);var xt=p(Wt,2),Ot=m(xt);Te(Ot,()=>n(zt).type==="bool",No=>{var ts=XV(),Oo=m(ts);Jt(Oo),Se(()=>wv(Oo,!!n(td)[n(zt).name])),Oo.__change=[ZV,Nc,zt],pn(2),f(ts),O(No,ts)},No=>{var ts=So(),Oo=Rt(ts);Te(Oo,()=>n(zt).type==="string",Cn=>{var Cs=QV();Jt(Cs),Se(()=>cu(Cs,String(n(td)[n(zt).name]??""))),Cs.__input=[JV,Nc,zt],O(Cn,Cs)},Cn=>{var Cs=tW();Jt(Cs),Se(()=>cu(Cs,Number(n(td)[n(zt).name]??n(zt).defval))),Cs.__input=[eW,Nc,zt],Se(()=>{Nt(Cs,"step",n(zt).step??(n(zt).type==="int"?1:.01)),Nt(Cs,"min",n(zt).minval),Nt(Cs,"max",n(zt).maxval)}),O(Cn,Cs)},!0),O(No,ts)}),f(xt),f(io),Se(()=>{Ve(Et,n(zt).title||n(zt).name),Ve(wo,n(zt).name)}),O(Ft,io)}),f(Bt),pn(2),f(Le),f(Ae),O(fe,Ae)}),f(Ht),f(Pe),Se(()=>{Ve(xs,`inline-script.${n(rd)??""}`),Ve(Sn,`Lines: ${n($r)??""}`)}),id("scroll",N,Un),Ho(N,t),O(pe,Pe)},pe=>{var Pe=So(),Ht=Rt(Pe);Te(Ht,()=>n(M)==="errors",vo=>{var as=dW(),po=m(as);Te(po,()=>n(Rs).length===0,Bs=>{var xs=iW();O(Bs,xs)},Bs=>{var xs=cW(),en=Rt(xs),Sn=m(en),lt=m(Sn);f(Sn),pn(2),f(en);var Zt=p(en,2);Vs(Zt,21,()=>n(Rs),_n,(qt,Lo)=>{var ks=lW(),yr=p(m(ks),2),N=m(yr);Te(N,()=>n(Lo).line,Ae=>{var Le=rW(),ft=m(Le),Bt=p(ft);Te(Bt,()=>n(Lo).col,Ft=>{var zt=Yf();Se(()=>Ve(zt,`· Col ${n(Lo).col??""}`)),O(Ft,zt)}),pn(),f(Le),Se(()=>Ve(ft,`Line ${n(Lo).line??""}`)),O(Ae,Le)});var X=p(N);f(yr);var fe=p(yr,2);Te(fe,()=>n(Lo).hint,Ae=>{var Le=aW(),ft=m(Le);f(Le),Se(()=>Ve(ft,`— ${n(Lo).hint??""}`)),O(Ae,Le)}),f(ks),Se(()=>{Gn(ks,`${`diag-item ${n(Lo).level}`??""} svelte-63z95z`),Ve(X,` ${n(Lo).message??""}`)}),O(qt,ks)}),f(Zt),Se(()=>Ve(lt,`Errors (${(n(Zs)||0)??""})`)),O(Bs,xs)}),f(as),O(vo,as)},vo=>{var as=ZH(),po=m(as);Te(po,()=>n(T),xs=>{var en=HW();en.__click=[T2,T];var Sn=m(en);Sn.__click=[uW];var lt=m(Sn),Zt=p(m(lt),2),qt=m(Zt),Lo=m(qt);Lo.__click=[pW,z];var ks=p(Lo,2);ks.__click=[vW,z],f(qt);var yr=p(qt,2);yr.__click=[T2,T],f(Zt),f(lt);var N=p(lt,2),X=m(N);Te(X,()=>n(z)==="trades",fe=>{var Ae=DW(),Le=Rt(Ae),ft=m(Le),Bt=m(ft),Ft=p(m(Bt)),zt=m(Ft);f(Ft),f(Bt),pn(2),f(ft);var io=p(ft,2),Wt=m(io);Jt(Wt),Wt.__input=[fW,Io];var zo=p(Wt,2);Te(zo,()=>n(Mt).type!=="all",wo=>{var xt=gW();xt.__click=[mW,Ss],O(wo,xt)});var Et=p(zo,2);Et.__click=[A2,Xe,at,Kt,he,ke,St,lo,Ne,ht],f(io),f(Le);var Ut=p(Le,2);Te(Ut,()=>n(Ms).length,wo=>{var xt=FW(),Ot=m(xt),No=m(Ot),ts=m(No),Oo=p(m(ts)),Cn=m(Oo);Cn.__click=[hW,hs];var Cs=m(Cn);Se(()=>Ve(Cs,`Side ${is("side")??""}`)),f(Cn),f(Oo);var rn=p(Oo),ko=m(rn);ko.__click=[_W,hs];var Xo=m(ko);Se(()=>Ve(Xo,`Entry ${is("entryIndex")??""}`)),f(ko),f(rn);var Ro=p(rn),To=m(Ro);To.__click=[yW,hs];var Co=m(To);Se(()=>Ve(Co,`Exit ${is("exitIndex")??""}`)),f(To),f(Ro);var Hs=p(Ro),jo=m(Hs);jo.__click=[bW,hs];var ls=m(jo);Se(()=>Ve(ls,`Qty ${is("qty")??""}`)),f(jo),f(Hs);var Rn=p(Hs),Os=m(Rn);Os.__click=[xW,hs];var Pn=m(Os);Se(()=>Ve(Pn,`Bars ${is("barsHeld")??""}`)),f(Os),f(Rn);var Oi=p(Rn),pi=m(Oi);pi.__click=[wW,hs];var an=m(pi);Se(()=>Ve(an,`Net PnL ${is("netPnl")??""}`)),f(pi),f(Oi);var tn=p(Oi),Hi=m(tn);Hi.__click=[kW,hs];var ps=m(Hi);Se(()=>Ve(ps,`PnL% ${is("pnlPct")??""}`)),f(Hi),f(tn);var _s=p(tn),fn=m(_s);fn.__click=[SW,hs];var Ci=m(fn);Se(()=>Ve(Ci,`Fees ${is("fees")??""}`)),f(fn),f(_s);var dr=p(_s),vi=m(dr);vi.__click=[CW,hs];var Fa=m(vi);Se(()=>Ve(Fa,`Gross ${is("pnl")??""}`)),f(vi),f(dr);var ri=p(dr),ka=m(ri);ka.__click=[PW,hs];var va=m(ka);Se(()=>Ve(va,`MAE% ${is("maePct")??""}`)),f(ka),f(ri);var wc=p(ri),$i=m(wc);$i.__click=[IW,hs];var mr=m($i);Se(()=>Ve(mr,`MFE% ${is("mfePct")??""}`)),f($i),f(wc);var ad=p(wc,3),Gd=m(ad);Gd.__click=[MW,hs];var Kc=m(Gd);Se(()=>Ve(Kc,`Cum Net ${is("cumNet")??""}`)),f(Gd),f(ad),f(ts),f(No);var vd=p(No);Vs(vd,21,()=>n(Ms),$l=>$l.id,($l,ha)=>{var et=zW();et.__click=[TW,Vn,ha],et.__keydown=[AW,Vn,ha];var As=m(et),yn=m(As);yn.__click=[LW,Vn,ha],f(As);var ae=p(As),Ns=m(ae),ra=m(Ns,!0);Se(()=>Ve(ra,Kt(n(ha).side))),f(Ns),f(ae);var ki=p(ae),Ls=m(ki),Rl=m(Ls),mc=p(m(Rl)),Jd=m(mc);f(mc),f(Rl);var Wc=p(Rl,2),nc=p(m(Wc)),Ao=m(nc,!0);f(nc),f(Wc);var ln=p(Wc,2),ul=p(m(ln)),ql=m(ul,!0);Se(()=>Ve(ql,he(n(ha).entryPrice))),f(ul),f(ln),f(Ls),f(ki);var Pl=p(ki),kl=m(Pl),od=m(kl),ic=p(m(od)),Il=m(ic);f(ic),f(od);var kc=p(od,2),lc=p(m(kc)),iu=m(lc,!0);f(lc),f(kc);var Rd=p(kc,2),fd=p(m(Rd)),wu=m(fd,!0);Se(()=>Ve(wu,he(n(ha).exitPrice))),f(fd),f(Rd),f(kl),f(Pl);var Cd=p(Pl),jc=m(Cd,!0);Se(()=>Ve(jc,ke(n(ha).qty))),f(Cd);var Yl=p(Cd),Ac=m(Yl,!0);Se(()=>Ve(Ac,St(n(ha).barsHeld,0))),f(Yl);var Ie=p(Yl);const ss=Qe(()=>(Number(n(ha).netPnl)>=0?"+":"")??""),sr=Qe(()=>lo(n(ha).netPnl)??"");var Sa=m(Ie);Se(()=>Ve(Sa,`${n(ss)}${n(sr)}`)),f(Ie);var Ml=p(Ie),Zc=m(Ml,!0);Se(()=>Ve(Zc,Ne(n(ha).pnlPct))),f(Ml);var ec=p(Ml),Ku=m(ec,!0);Se(()=>Ve(Ku,lo(n(ha).fees))),f(ec);var Bd=p(ec);const Od=Qe(()=>(Number(n(ha).pnl)>=0?"+":"")??""),sd=Qe(()=>lo(n(ha).pnl)??"");var Ca=m(Bd);Se(()=>Ve(Ca,`${n(Od)}${n(sd)}`)),f(Bd);var Ad=p(Bd),uu=m(Ad,!0);Se(()=>Ve(uu,n(ha).maePct==null?"-":Ne(n(ha).maePct))),f(Ad);var ru=p(Ad),Zr=m(ru,!0);Se(()=>Ve(Zr,n(ha).mfePct==null?"-":Ne(n(ha).mfePct))),f(ru);var Ud=p(ru),hl=m(Ud),hu=m(hl),md=p(m(hu)),ap=m(md,!0);f(md),f(hu);var Nn=p(hu,2),on=p(m(Nn)),Pi=m(on,!0);f(on),f(Nn),f(hl),f(Ud);var cs=p(Ud),ur=m(cs,!0);f(cs);var Or=p(cs);const Jo=Qe(()=>(Number(n(ha).cumNet)>=0?"+":"")??""),zs=Qe(()=>lo(n(ha).cumNet)??"");var Zo=m(Or);Se(()=>Ve(Zo,`${n(Jo)}${n(zs)}`)),f(Or),f(et),Se(()=>{ii(et,"selected",n(qs)===n(ha).id),ii(et,"pos",n(ha).netPnl>=0),ii(et,"neg",n(ha).netPnl<0),Ve(Jd,`#${n(ha).entryIndex??""}`),Ve(Ao,n(ha).entryTimeLabel),Ve(Il,`#${n(ha).exitIndex??""}`),Ve(iu,n(ha).exitTimeLabel),Ve(ap,n(ha).entrySignalId||"-"),Ve(Pi,n(ha).exitSignalId||"-"),Ve(ur,n(ha).exitReason||"-")}),O($l,et)}),f(vd),f(Ot),f(xt),O(wo,xt)},wo=>{var xt=$W();O(wo,xt)}),Se(()=>{Ve(zt,`(${n(Es).length??""}/${n(at).length??""})`),cu(Wt,n(Io))}),O(fe,Ae)},fe=>{var Ae=qW(),Le=Rt(Ae),ft=m(Le),Bt=p(m(ft),2),Ft=m(Bt),zt=p(Ft);Te(zt,()=>n(jt).length>500,zo=>{var Et=Yf("• Showing last 500");O(zo,Et)}),f(Bt),pn(2),f(ft);var io=p(ft,2);io.__click=[L2,Xe,jt,St,ke,lo,he,ht],f(Le);var Wt=p(Le,2);Te(Wt,()=>n(jt).length,zo=>{var Et=VW(),Ut=m(Et),wo=p(m(Ut));Vs(wo,21,()=>n(Lt),xt=>xt.id,(xt,Ot)=>{var No=OW(),ts=m(No),Oo=m(ts,!0);f(ts);var Cn=p(ts),Cs=m(Cn),rn=m(Cs,!0);f(Cs),f(Cn);var ko=p(Cn),Xo=m(ko),Ro=m(Xo),To=p(m(Ro),2),Co=m(To,!0);f(To),f(Ro);var Hs=p(Ro,2),jo=p(m(Hs),2),ls=m(jo,!0);f(jo),f(Hs);var Rn=p(Hs,2),Os=p(m(Rn),2),Pn=m(Os,!0);f(Os),f(Rn),f(Xo),f(ko);var Oi=p(ko),pi=m(Oi),an=m(pi),tn=p(m(an)),Hi=m(tn);f(tn),f(an);var ps=p(an,2),_s=p(m(ps)),fn=m(_s,!0);f(_s),f(ps),f(pi),f(Oi);var Ci=p(Oi),dr=m(Ci),vi=m(dr),Fa=p(m(vi)),ri=m(Fa);f(Fa),f(vi);var ka=p(vi,2),va=p(m(ka)),wc=m(va,!0);f(va),f(ka),f(dr),f(Ci);var $i=p(Ci),mr=m($i),ad=m(mr),Gd=p(m(ad)),Kc=m(Gd);Se(()=>Ve(Kc,`${St(n(Ot).qtyPct,2)??""}%`)),f(Gd),f(ad);var vd=p(ad,2);Te(vd,()=>n(Ot).qty!=null,jc=>{var Yl=EW(),Ac=p(m(Yl)),Ie=m(Ac,!0);Se(()=>Ve(Ie,ke(n(Ot).qty))),f(Ac),f(Yl),O(jc,Yl)});var $l=p(vd,2);Te($l,()=>n(Ot).cash!=null,jc=>{var Yl=NW(),Ac=p(m(Yl)),Ie=m(Ac,!0);Se(()=>Ve(Ie,lo(n(Ot).cash))),f(Ac),f(Yl),O(jc,Yl)});var ha=p($l,2);Te(ha,()=>n(Ot).price!=null,jc=>{var Yl=jW(),Ac=p(m(Yl)),Ie=m(Ac,!0);Se(()=>Ve(Ie,he(n(Ot).price))),f(Ac),f(Yl),O(jc,Yl)});var et=p(ha,2);Te(et,()=>n(Ot).stopPrice!=null,jc=>{var Yl=RW(),Ac=p(m(Yl)),Ie=m(Ac,!0);Se(()=>Ve(Ie,he(n(Ot).stopPrice))),f(Ac),f(Yl),O(jc,Yl)});var As=p(et,2);Te(As,()=>n(Ot).limitPrice!=null,jc=>{var Yl=BW(),Ac=p(m(Yl)),Ie=m(Ac,!0);Se(()=>Ve(Ie,he(n(Ot).limitPrice))),f(Ac),f(Yl),O(jc,Yl)}),f(mr),f($i);var yn=p($i),ae=m(yn),Ns=m(ae),ra=p(m(Ns)),ki=m(ra,!0);f(ra),f(Ns);var Ls=p(Ns,2),Rl=p(m(Ls)),mc=m(Rl,!0);f(Rl),f(Ls);var Jd=p(Ls,2),Wc=p(m(Jd)),nc=m(Wc,!0);Se(()=>Ve(nc,n(Ot).fillQty==null?"-":ke(n(Ot).fillQty))),f(Wc),f(Jd);var Ao=p(Jd,2),ln=p(m(Ao)),ul=m(ln,!0);Se(()=>Ve(ul,n(Ot).fillPrice==null?"-":he(n(Ot).fillPrice))),f(ln),f(Ao);var ql=p(Ao,2),Pl=p(m(ql)),kl=m(Pl,!0);Se(()=>Ve(kl,n(Ot).fees==null?"-":lo(n(Ot).fees))),f(Pl),f(ql),f(ae),f(yn);var od=p(yn),ic=m(od),Il=m(ic),kc=p(m(Il)),lc=m(kc,!0);f(kc),f(Il);var iu=p(Il,2),Rd=p(m(iu)),fd=m(Rd,!0);f(Rd),f(iu),f(ic),f(od);var wu=p(od),Cd=m(wu,!0);f(wu),f(No),Se(()=>{Ve(Oo,n(Ot).id),Gn(Cs,`${`tt-pill status status-${n(Ot).statusKey}`??""} svelte-63z95z`),Ve(rn,n(Ot).statusLabel),Ve(Co,n(Ot).actionLabel),Ve(ls,n(Ot).sideLabel),Ve(Pn,n(Ot).kindLabel),Ve(Hi,`#${n(Ot).createdIndex??""}`),Ve(fn,n(Ot).createdTimeLabel),Ve(ri,`#${n(Ot).activeFromIndex??""}`),Ve(wc,n(Ot).expiresAtIndex==null?"-":`#${n(Ot).expiresAtIndex}`),Ve(ki,n(Ot).filledIndex==null?"-":`#${n(Ot).filledIndex}`),Ve(mc,n(Ot).filledIndex==null?"-":n(Ot).filledTimeLabel),Ve(lc,n(Ot).signalId||"-"),Ve(fd,n(Ot).ocoGroup||"-"),Ve(Cd,n(Ot).note||"-")}),O(xt,No)}),f(wo),f(Ut),f(Et),O(zo,Et)},zo=>{var Et=WW();O(zo,Et)}),Se(()=>Ve(Ft,`Rows ${n(jt).length??""}`)),O(fe,Ae)}),f(N),f(Sn),f(en),Se(()=>{ii(Lo,"active",n(z)==="trades"),ii(ks,"active",n(z)==="orders")}),O(xs,en)});var Bs=p(po,2);Te(Bs,()=>!n(be),xs=>{var en=So(),Sn=Rt(en);Te(Sn,()=>!n(jl),lt=>{var Zt=YW(),qt=m(Zt);Te(qt,()=>n(Ja)||n(sa),Lo=>{var ks=GW();pn(4),O(Lo,ks)},Lo=>{var ks=UW();pn(4),O(Lo,ks)}),f(Zt),O(lt,Zt)},lt=>{var Zt=So(),qt=Rt(Zt);Te(qt,()=>!n(Td),Lo=>{var ks=XW(),yr=m(ks);Te(yr,()=>n(Ja)||n(sa),N=>{var X=KW();pn(4),O(N,X)},N=>{var X=ZW();pn(4),O(N,X)}),f(ks),O(Lo,ks)},Lo=>{var ks=eq(),yr=m(ks);Te(yr,l,X=>{var fe=Yf("Running… please wait.");O(X,fe)},X=>{var fe=JW();pn(2),O(X,fe)});var N=p(yr,2);Te(N,()=>n(Ja)||n(sa),X=>{var fe=QW(),Ae=m(fe);f(fe),Se(()=>Ve(Ae,`Pine parsed: strategy ${(n(Ja)?"yes":"no")??""} • signals ${(n(sa)?"yes":"no")??""}`)),O(X,fe)}),f(ks),O(Lo,ks)},!0),O(lt,Zt)}),O(xs,en)},xs=>{var en=KH(),Sn=m(en),lt=p(m(Sn),2),Zt=m(lt),qt=p(m(Zt),2),Lo=m(qt,!0);Se(()=>Ve(Lo,Qt(n(be).finalEquity,2))),f(qt),f(Zt);var ks=p(Zt,2),yr=p(m(ks),2),N=m(yr);Se(()=>Ve(N,`${(n(be).netPnl>=0?"+":"")??""}${Qt(n(be).netPnl,2)??""}`)),f(yr),f(ks);var X=p(ks,2),fe=p(m(X),2),Ae=m(fe,!0);Se(()=>Ve(Ae,ie(n(be).maxDrawdownPct))),f(fe),f(X),f(lt),f(Sn);var Le=p(Sn,2),ft=m(Le),Bt=p(m(ft)),Ft=m(Bt,!0);f(Bt);var zt=p(Bt,2),io=m(zt);f(zt),f(ft);var Wt=p(ft,2);Te(Wt,()=>n(We).lastTs,Yn=>{var vs=tq(),_a=p(m(vs)),Vr=m(_a,!0);Se(()=>Ve(Vr,new Date(n(We).lastTs).toISOString().slice(0,10))),f(_a),f(vs),O(Yn,vs)});var zo=p(Wt,2);Te(zo,()=>n(W),Yn=>{var vs=oq(),_a=p(m(vs)),Vr=m(_a,!0);f(_a),f(vs),Se(()=>Ve(Vr,n(W))),O(Yn,vs)}),f(Le);var Et=p(Le,2),Ut=m(Et),wo=m(Ut),xt=m(wo),Ot=p(m(xt),2);Ot.__click=[sq,K],f(xt),pn(2),f(wo),f(Ut);var No=p(Ut,2),ts=m(No),Oo=p(m(ts),2),Cn=m(Oo),Cs=p(m(Cn),2);Jt(Cs),Cs.__input=[nq,te],f(Cn);var rn=p(Cn,2),ko=p(m(rn),2);Jt(ko),ko.__input=[iq,oe],f(rn);var Xo=p(rn,2),Ro=p(m(Xo),2);Jt(Ro),Ro.__input=[rq,U],f(Xo),f(Oo);var To=p(Oo,2),Co=m(To);Co.__click=[I2,g,t,qa,I,J];var Hs=p(Co,2);Te(Hs,()=>n(se),Yn=>{var vs=aq();vs.__click=[TV,te,oe,U],O(Yn,vs)});var jo=p(Hs,2);Te(jo,()=>n(W),Yn=>{var vs=lq(),_a=m(vs,!0);f(vs),Se(()=>Ve(_a,n(W))),O(Yn,vs)}),pn(2),f(To),f(ts);var ls=p(ts,2),Rn=p(m(ls),2),Os=m(Rn);Jt(Os),Os.__input=[cq,Z];var Pn=p(Os,2);Pn.__click=[IV,be,Z,Y,qa];var Oi=p(Pn,2);Te(Oi,()=>n(Y).length,Yn=>{var vs=dq();vs.__click=[MV,Y,At,Gt],O(Yn,vs)}),f(Rn);var pi=p(Rn,2);Te(pi,()=>n(Y).length,Yn=>{var vs=xq(),_a=p(m(vs),2);Vs(_a,17,()=>n(Y),Vr=>Vr.id,(Vr,Ps)=>{var hi=bq(),Dl=Rt(hi),Ua=m(Dl),rt=m(Ua,!0);f(Ua);var He=p(Ua,2),Ye=m(He);Se(()=>Ve(Ye,`${(n(Ps).summary.netPnl>=0?"+":"")??""}${Qt(n(Ps).summary.netPnl,2)??""}`)),f(He);var Tt=p(He,2),Pt=m(Tt,!0);Se(()=>Ve(Pt,ie(n(Ps).summary.netPnlPct??0))),f(Tt);var Xt=p(Tt,2),yo=m(Xt,!0);Se(()=>Ve(yo,ie(n(Ps).summary.maxDrawdownPct??0))),f(Xt);var Qo=p(Xt,2),Vi=m(Qo,!0);Se(()=>Ve(Vi,Ct(n(Ps).summary.sharpe??0))),f(Qo);var fi=p(Qo,2),oo=m(fi,!0);Se(()=>Ve(oo,ie(n(Ps).summary.winRate??0))),f(fi);var Po=p(fi,2),Ds=m(Po,!0);f(Po);var Wi=p(Po,2),Bn=m(Wi,!0);Se(()=>Ve(Bn,bs(n(Ps).params))),f(Wi);var Qn=p(Wi,2),In=m(Qn);In.__click=[uq,no,Ps];var ma=m(In,!0);f(In);var Bl=p(In,2);Bl.__click=[pq,ne,Ps],f(Qn),f(Dl);var xn=p(Dl,2);Te(xn,()=>n(At)===n(Ps).id,Ii=>{var ya=yq(),ei=m(ya),Zl=p(m(ei),2);Vs(Zl,21,()=>Is(n(Ps).summary),_n,(Rc,Kn)=>{var li=vq(),bo=m(li),$e=m(bo,!0);f(bo);var Vo=p(bo,2),ro=m(Vo,!0);f(Vo),f(li),Se(()=>{Ve($e,n(Kn).label),Ve(ro,n(Kn).value)}),O(Rc,li)}),f(Zl),f(ei);var Jc=p(ei,2),Zn=p(m(Jc),2);Te(Zn,()=>n(Ps).params&&Object.keys(n(Ps).params).length,Rc=>{var Kn=mq();Vs(Kn,21,()=>Object.entries(n(Ps).params),_n,(li,bo)=>{let $e=()=>n(bo)[0],Vo=()=>n(bo)[1];var ro=fq(),hn=m(ro),qn=m(hn,!0);f(hn);var Fn=p(hn,2),Qi=m(Fn,!0);Se(()=>Ve(Qi,Eo(Vo(),0))),f(Fn),f(ro),Se(()=>Ve(qn,$e())),O(li,ro)}),f(Kn),O(Rc,Kn)},Rc=>{var Kn=gq();O(Rc,Kn)}),f(Jc);var bd=p(Jc,2),rc=p(m(bd),2);rc.__click=[hq,Do,Ps];var Hc=m(rc,!0);f(rc);var Tl=p(rc,2);Te(Tl,()=>n(Gt)[n(Ps).id],Rc=>{var Kn=_q(),li=m(Kn,!0);Se(()=>Ve(li,qi(n(Ps)))),f(Kn),O(Rc,Kn)}),f(bd),f(ya),Se(()=>Ve(Hc,n(Gt)[n(Ps).id]?"Hide raw":"Show raw")),O(Ii,ya)}),Se(()=>{Ve(rt,n(Ps).label),Gn(He,`${`right mono ${n(Ps).summary.netPnl>=0?"pos":"neg"}`??""} svelte-63z95z`),Ve(Ds,n(Ps).summary.trades??0),Nt(In,"aria-expanded",n(At)===n(Ps).id),Ve(ma,n(At)===n(Ps).id?"Hide":"Details")}),O(Vr,hi)}),f(vs),O(Yn,vs)},Yn=>{var vs=wq();O(Yn,vs)}),f(ls),f(No),f(Et);var an=p(Et,2),tn=m(an),Hi=m(tn),ps=m(Hi),_s=p(m(ps),2);_s.__click=[kq,K],f(ps),pn(2),f(Hi),f(tn);var fn=p(tn,2),Ci=m(fn),dr=p(m(Ci),2),vi=m(dr,!0);f(dr);var Fa=p(dr,2),ri=m(Fa),ka=p(ri);Te(ka,()=>n(be).roundTrips!=null,Yn=>{var vs=Yf();Se(()=>Ve(vs,`• Positions ${n(be).roundTrips??""}`)),O(Yn,vs)}),f(Fa),f(Ci);var va=p(Ci,2),wc=p(m(va),2),$i=m(wc,!0);Se(()=>Ve($i,ie(n(be).winRate))),f(wc);var mr=p(wc,2),ad=m(mr);Se(()=>Ve(ad,`Max DD ${ie(n(be).maxDrawdownPct)??""}`)),f(mr),f(va);var Gd=p(va,2),Kc=p(m(Gd),2),vd=m(Kc);Se(()=>Ve(vd,`${(n(be).netPnl>=0?"+":"")??""}${Qt(n(be).netPnl,2)??""}`)),f(Kc);var $l=p(Kc,2);const ha=Qe(()=>ie(n(be).netPnlPct)??""),et=Qe(()=>Qt(n(be).feesPaid,2)??""),As=Qe(()=>Ct(n(be).profitFactor)??"");var yn=m($l);Se(()=>Ve(yn,`${n(ha)} • Fees ${n(et)} • PF ${n(As)}`)),f($l),f(Gd);var ae=p(Gd,2),Ns=p(m(ae),2),ra=m(Ns);Se(()=>Ve(ra,`${(n(be).expectancy>=0?"+":"")??""}${Qt(n(be).expectancy??0,2)??""}`)),f(Ns);var ki=p(Ns,2);const Ls=Qe(()=>Qt(n(be).avgTrade??0,2)??""),Rl=Qe(()=>Ct(n(be).payoffRatio??0)??""),mc=Qe(()=>n(be).maxConsecWins??0??""),Jd=Qe(()=>n(be).maxConsecLosses??0??"");var Wc=m(ki);Se(()=>Ve(Wc,`Avg ${n(Ls)} • Payoff ${n(Rl)} • Streak W ${n(mc)}/L ${n(Jd)}`)),f(ki),f(ae);var nc=p(ae,2),Ao=p(m(nc),2),ln=m(Ao);Se(()=>Ve(ln,`Sharpe ${Ct(n(be).sharpe??0)??""}`)),f(Ao);var ul=p(Ao,2);const ql=Qe(()=>Ct(n(be).sortino??0)??""),Pl=Qe(()=>ie(n(be).volatilityPct??0)??"");var kl=m(ul);Se(()=>Ve(kl,`Sortino ${n(ql)} • Vol ${n(Pl)}`)),f(ul),f(nc);var od=p(nc,2),ic=p(m(od),2),Il=m(ic,!0);Se(()=>Ve(Il,ie(n(be).exposurePct??0))),f(ic);var kc=p(ic,2);const lc=Qe(()=>ie(n(be).maxRunupPct??0)??""),iu=Qe(()=>Qt(n(be).avgBarsInTrade??0,1)??""),Rd=Qe(()=>Ct(n(be).calmar??0)??"");var fd=m(kc);Se(()=>Ve(fd,`Run-up ${n(lc)} • Bars/trade ${n(iu)} • Calmar ${n(Rd)}`)),f(kc),f(od),f(fn);var wu=p(fn,2);Te(wu,()=>n(be).trades===0,Yn=>{var vs=Pq(),_a=p(m(vs),2),Vr=m(_a);Te(Vr,()=>n(We).total===0,Ps=>{var hi=Sq();pn(2),O(Ps,hi)},Ps=>{var hi=Cq();pn(2),O(Ps,hi)}),f(_a),f(vs),O(Yn,vs)}),f(an);var Cd=p(an,2),jc=m(Cd),Yl=m(jc),Ac=m(Yl),Ie=p(m(Ac),2);Ie.__click=[Iq,K],f(Ac),pn(2),f(Yl),f(jc);var ss=p(jc,2),sr=m(ss),Sa=p(m(sr),2),Ml=p(m(Sa),2),Zc=m(Ml);f(Ml);var ec=p(Ml,2),Ku=m(ec);Se(()=>Ve(Ku,`Win ${ie(n(kt).long.winRate)??""}`)),f(ec);var Bd=p(ec,2),Od=m(Bd);Se(()=>Ve(Od,`Net ${(n(kt).long.net>=0?"+":"")??""}${Qt(n(kt).long.net,2)??""}`)),f(Bd);var sd=p(Bd,2),Ca=m(sd);Se(()=>Ve(Ca,`PF ${Ct(n(kt).long.profitFactor)??""}`)),f(sd),f(Sa);var Ad=p(Sa,2),uu=p(m(Ad),2),ru=m(uu);f(uu);var Zr=p(uu,2),Ud=m(Zr);Se(()=>Ve(Ud,`Win ${ie(n(kt).short.winRate)??""}`)),f(Zr);var hl=p(Zr,2),hu=m(hl);Se(()=>Ve(hu,`Net ${(n(kt).short.net>=0?"+":"")??""}${Qt(n(kt).short.net,2)??""}`)),f(hl);var md=p(hl,2),ap=m(md);Se(()=>Ve(ap,`PF ${Ct(n(kt).short.profitFactor)??""}`)),f(md),f(Ad),f(sr);var Nn=p(sr,2),on=p(m(Nn),2);Te(on,()=>n(xo).length,Yn=>{var vs=Tq(),_a=p(m(vs),2);Vs(_a,17,()=>n(xo).slice(0,12),_n,(Vr,Ps)=>{var hi=Mq(),Dl=m(hi),Ua=m(Dl,!0);f(Dl);var rt=p(Dl,2),He=m(rt,!0);f(rt);var Ye=p(rt,2),Tt=m(Ye,!0);Se(()=>Ve(Tt,ie(n(Ps).winRate))),f(Ye);var Pt=p(Ye,2),Xt=m(Pt);Se(()=>Ve(Xt,`${(n(Ps).net>=0?"+":"")??""}${Qt(n(Ps).net,2)??""}`)),f(Pt);var yo=p(Pt,2),Qo=m(yo,!0);Se(()=>Ve(Qo,Ct(n(Ps).profitFactor))),f(yo),f(hi),Se(()=>{Ve(Ua,n(Ps).id),Ve(He,n(Ps).trades),Gn(Pt,`${`right mono ${n(Ps).net>=0?"pos":"neg"}`??""} svelte-63z95z`)}),O(Vr,hi)}),f(vs),O(Yn,vs)},Yn=>{var vs=Aq();O(Yn,vs)}),f(Nn),f(ss),f(Cd);var Pi=p(Cd,2),cs=m(Pi),ur=m(cs),Or=m(ur),Jo=p(m(Or),2);Jo.__click=[Lq,K],f(Or),pn(2),f(ur);var zs=p(ur,2),Zo=m(zs,!0),br=p(Zo);Te(br,()=>n(Ze),Yn=>{var vs=Yf();Se(()=>Ve(vs,`• Running ${n(Ge)??""}/${n(it)??""} (${n(Vt)??""}%) • ${n(qe)??""}`)),O(Yn,vs)}),f(zs),f(cs);var cc=p(cs,2),Xs=m(cc),Xr=p(m(Xs),2);Te(Xr,()=>n(le).length,Yn=>{var vs=Xq(),_a=Rt(vs),Vr=p(m(_a),2),Ps=m(Vr);dm(Ps,()=>n(Ce));var hi;Ps.__change=[zq,ws],Vs(Ps,21,()=>n(le),Kn=>Kn.name,(Kn,li)=>{var bo=Fq(),$e={},Vo=m(bo,!0);f(bo),Se(()=>{$e!==($e=n(li).name)&&(bo.value=(bo.__value=n(li).name)==null?"":n(li).name),Ve(Vo,n(li).title||n(li).name)}),O(Kn,bo)}),f(Ps),f(Vr),f(_a);var Dl=p(_a,2),Ua=m(Dl),rt=p(m(Ua),2);Jt(rt),rt.__input=[$q,Ke],f(Ua);var He=p(Ua,2),Ye=p(m(He),2);Jt(Ye),Ye.__input=[Dq,st],f(He);var Tt=p(He,2),Pt=p(m(Tt),2);Jt(Pt),Pt.__input=[Eq,vt],f(Tt),f(Dl);var Xt=p(Dl,2),yo=p(m(Xt),2),Qo=m(yo);dm(Qo,()=>n(Re));var Vi;Qo.__change=[Nq,vn];var fi=m(Qo);fi.value=((fi.__value="")==null,"");var oo=p(fi);Vs(oo,17,()=>n(le),Kn=>Kn.name,(Kn,li)=>{var bo=jq(),$e={},Vo=m(bo,!0);f(bo),Se(()=>{$e!==($e=n(li).name)&&(bo.value=(bo.__value=n(li).name)==null?"":n(li).name),Ve(Vo,n(li).title||n(li).name)}),O(Kn,bo)}),f(Qo),f(yo),f(Xt);var Po=p(Xt,2);Te(Po,()=>n(Re),Kn=>{var li=Vq(),bo=m(li),$e=p(m(bo),2);Jt($e),$e.__input=[Rq,Je],f(bo);var Vo=p(bo,2),ro=p(m(Vo),2);Jt(ro),ro.__input=[Bq,ot],f(Vo);var hn=p(Vo,2),qn=p(m(hn),2);Jt(qn),qn.__input=[Oq,nt],f(hn),f(li),Se(()=>{cu($e,n(Je)),cu(ro,n(ot)),cu(qn,n(nt))}),O(Kn,li)});var Ds=p(Po,2),Wi=p(m(Ds),2),Bn=m(Wi);dm(Bn,()=>n(tt));var Qn;Bn.__change=[Wq,tt];var In=m(Bn);In.value=(In.__value="netPnl")==null?"":"netPnl";var ma=p(In);ma.value=(ma.__value="profitFactor")==null?"":"profitFactor";var Bl=p(ma);Bl.value=(Bl.__value="sharpe")==null?"":"sharpe";var xn=p(Bl);xn.value=(xn.__value="winRate")==null?"":"winRate";var Ii=p(xn);Ii.value=(Ii.__value="maxDrawdownPct")==null?"":"maxDrawdownPct",f(Bn),f(Wi),f(Ds);var ya=p(Ds,2),ei=p(m(ya),2),Zl=m(ei),Jc=m(Zl);Jt(Jc),Jc.__change=[qq,ze],pn(2),f(Zl),f(ei),f(ya);var Zn=p(ya,2);Te(Zn,()=>n(ze),Kn=>{var li=Gq(),bo=p(m(li),2),$e=m(bo);Jt($e),$e.__input=[Hq,dt],f(bo),f(li),Se(()=>cu($e,n(dt))),O(Kn,li)});var bd=p(Zn,2),rc=m(bd);rc.__click=[AV,le,we,Ce,Re,es,Ke,st,vt,Je,ot,nt,td,ct,ce,Ge,Ze,pt,qe,me,Q,r,Xi];var Hc=p(rc,2);Te(Hc,()=>n(Ze),Kn=>{var li=Uq();li.__click=[LV,Ze,pt,ct,Q],O(Kn,li)},Kn=>{var li=So(),bo=Rt(li);Te(bo,()=>n(ce).length,$e=>{var Vo=Yq();Vo.__click=[zV,ce,me,we,Ge,ct,Ze,pt,Q],O($e,Vo)},null,!0),O(Kn,li)}),pn(2),f(bd);var Tl=p(bd,2);Te(Tl,()=>n(we),Kn=>{var li=Kq(),bo=m(li,!0);f(li),Se(()=>Ve(bo,n(we))),O(Kn,li)});var Rc=p(Tl,2);Te(Rc,()=>n(Ze),Kn=>{var li=Zq(),bo=m(li);f(li),Se(()=>Nt(bo,"style",`width:${n(Vt)}%`)),O(Kn,li)}),Se(()=>{hi!==(hi=n(Ce))&&(Ps.value=(Ps.__value=n(Ce))==null?"":n(Ce),zf(Ps,n(Ce))),cu(rt,n(Ke)),cu(Ye,n(st)),cu(Pt,n(vt)),Vi!==(Vi=n(Re))&&(Qo.value=(Qo.__value=n(Re))==null?"":n(Re),zf(Qo,n(Re))),Qn!==(Qn=n(tt))&&(Bn.value=(Bn.__value=n(tt))==null?"":n(tt),zf(Bn,n(tt))),wv(Jc,n(ze)),rc.disabled=n(Ze)}),O(Yn,vs)},Yn=>{var vs=Jq();O(Yn,vs)}),f(Xs);var Ji=p(Xs,2),Gi=p(m(Ji),2);Te(Gi,()=>n(wt).length,Yn=>{var vs=tH(),_a=Rt(vs),Vr=m(_a);f(_a);var Ps=p(_a,2),hi=p(m(Ps),2);Vs(hi,19,()=>n(wt),(Ua,rt)=>bs(Ua.params)+rt,(Ua,rt,He)=>{var Ye=Qq(),Tt=m(Ye),Pt=m(Tt,!0);Se(()=>Ve(Pt,bs(n(rt).params))),f(Tt);var Xt=p(Tt,2),yo=m(Xt,!0);Se(()=>Ve(yo,oa(n(rt).summary))),f(Xt);var Qo=p(Xt,2),Vi=m(Qo);Se(()=>Ve(Vi,`${(n(rt).summary.netPnl>=0?"+":"")??""}${Qt(n(rt).summary.netPnl,2)??""}`)),f(Qo);var fi=p(Qo,2),oo=m(fi,!0);Se(()=>Ve(oo,ie(n(rt).summary.netPnlPct??0))),f(fi);var Po=p(fi,2),Ds=m(Po,!0);Se(()=>Ve(Ds,ie(n(rt).summary.maxDrawdownPct??0))),f(Po);var Wi=p(Po,2),Bn=m(Wi,!0);Se(()=>Ve(Bn,ie(n(rt).summary.winRate??0))),f(Wi);var Qn=p(Wi,2),In=m(Qn,!0);f(Qn),f(Ye),Se(()=>{Gn(Ye,`${`opt-results-row ${n(He)===0?"best":""}`??""} svelte-63z95z`),Gn(Qo,`${`right mono ${n(rt).summary.netPnl>=0?"pos":"neg"}`??""} svelte-63z95z`),Ve(In,n(rt).summary.trades??0)}),O(Ua,Ye)}),f(Ps);var Dl=p(Ps,2);Te(Dl,()=>n(ze)&&n(me),Ua=>{var rt=eH();const He=Qe(()=>bs(n(me).params)??""),Ye=Qe(()=>(n(me).summary.netPnl>=0?"+":"")??""),Tt=Qe(()=>Qt(n(me).summary.netPnl,2)??""),Pt=Qe(()=>ie(n(me).summary.maxDrawdownPct??0)??""),Xt=Qe(()=>ie(n(me).summary.winRate??0)??"");var yo=m(rt);Se(()=>Ve(yo,`Test run: ${n(He)} • Net ${n(Ye)}${n(Tt)} •
                    DD ${n(Pt)} • Win ${n(Xt)}`)),f(rt),O(Ua,rt)}),Se(()=>Ve(Vr,`Showing ${n(wt).length??""} runs`)),O(Yn,vs)},Yn=>{var vs=oH();O(Yn,vs)}),f(Ji),f(cc),f(Pi);var jn=p(Pi,2),Ga=m(jn),fa=m(Ga),Ba=m(fa),bn=p(m(Ba),2);bn.__click=[sH,K],f(Ba),pn(2),f(fa);var yd=p(fa,2),qo=m(yd),_l=m(qo);_l.__click=[nH,nn];var Kl=p(_l,2);Kl.__click=[iH,nn];var Sl=p(Kl,2);Sl.__click=[rH,nn];var Pa=p(Sl,2);Pa.__click=[aH,nn];var Sc=p(Pa,2);Sc.__click=[lH,nn];var ai=p(Sc,2);ai.__click=[cH,nn];var Ir=p(ai,2);Ir.__click=[dH,nn],f(qo),f(yd),f(Ga);var nr=p(Ga,2),il=m(nr),Dr=m(il),qc=p(m(Dr),2),ld=m(qc);Te(ld,()=>n(ui).length,Yn=>{var vs=Yf();const _a=Qe(()=>Qt(n(ui)[0].equity,2)??""),Vr=Qe(()=>Qt(n(ui)[n(ui).length-1].equity,2)??"");Se(()=>Ve(vs,`${n(_a)} → ${n(Vr)}`)),O(Yn,vs)}),f(qc),f(Dr);var pu=p(Dr,2);pu.__pointermove=ds;var Vd=m(pu);Te(Vd,()=>n(mi),Yn=>{var vs=pH(),_a=Rt(vs),Vr=m(_a),Ps=p(Vr),hi=p(Ps);Te(hi,()=>n(Ha),Ye=>{var Tt=uH();Se(()=>Nt(Tt,"d",n(Ha).line)),O(Ye,Tt)}),pn(3),f(_a);var Dl=p(_a,2),Ua=m(Dl,!0);Se(()=>Ve(Ua,Qt(n(mi).maxY,2))),f(Dl);var rt=p(Dl,2),He=m(rt,!0);Se(()=>Ve(He,Qt(n(mi).minY,2))),f(rt),Se(()=>{Nt(Vr,"d",n(mi).area),Nt(Ps,"d",n(mi).line)}),O(Yn,vs)},Yn=>{var vs=vH();O(Yn,vs)});var ku=p(Vd,2);Te(ku,()=>n(Mo),Yn=>{var vs=fH(),_a=Rt(vs),Vr=p(_a,2),Ps=p(Vr,2),hi=m(Ps),Dl=m(hi,!0);Se(()=>Ve(Dl,new Date(n(Mo).ts).toISOString().slice(0,10))),f(hi);var Ua=p(hi,2),rt=p(m(Ua)),He=m(rt,!0);Se(()=>Ve(He,Qt(n(Mo).equity,2))),f(rt),f(Ua),f(Ps),Se(()=>{Nt(_a,"style",`left:${n(Mo).x}px;`),Nt(Vr,"style",`top:${n(Mo).y}px;`),Nt(Ps,"style",`left:${n(Mo).left}px; top:${n(Mo).top}px;`)}),O(Yn,vs)}),f(pu);var Ou=p(pu,2);Te(Ou,()=>n(Ha),Yn=>{var vs=mH();O(Yn,vs)}),f(il);var zu=p(il,2),Xc=m(zu),lv=p(m(Xc),2),qp=m(lv);Se(()=>Ve(qp,`Max ${ie(n(be).maxDrawdownPct)??""}`)),f(lv),f(Xc);var Zu=p(Xc,2);Zu.__pointermove=js;var Fu=m(Zu);Te(Fu,()=>n(lr),Yn=>{var vs=gH(),_a=Rt(vs),Vr=m(_a),Ps=p(Vr);pn(3),f(_a);var hi=p(_a,2),Dl=m(hi);Se(()=>Ve(Dl,`${Qt(n(lr).maxY,2)??""}%`)),f(hi);var Ua=p(hi,2),rt=m(Ua);Se(()=>Ve(rt,`${Qt(n(lr).minY,2)??""}%`)),f(Ua),Se(()=>{Nt(Vr,"d",n(lr).area),Nt(Ps,"d",n(lr).line)}),O(Yn,vs)},Yn=>{var vs=hH();O(Yn,vs)});var Hp=p(Fu,2);Te(Hp,()=>n(ho),Yn=>{var vs=_H(),_a=Rt(vs),Vr=p(_a,2),Ps=p(Vr,2),hi=m(Ps),Dl=m(hi,!0);Se(()=>Ve(Dl,new Date(n(ho).ts).toISOString().slice(0,10))),f(hi);var Ua=p(hi,2),rt=p(m(Ua)),He=m(rt,!0);Se(()=>Ve(He,ie(n(ho).ddPct))),f(rt),f(Ua),f(Ps),Se(()=>{Nt(_a,"style",`left:${n(ho).x}px;`),Nt(Vr,"style",`top:${n(ho).y}px;`),Nt(Ps,"style",`left:${n(ho).left}px; top:${n(ho).top}px;`)}),O(Yn,vs)}),f(Zu),f(zu),f(nr),f(jn);var Gp=p(jn,2),cv=m(Gp),Vv=m(cv),_p=m(Vv),Dp=p(m(_p),2);Dp.__click=[yH,K],f(_p),pn(2),f(Vv),f(cv);var yc=p(cv,2),Ep=m(yc),lp=m(Ep),Wv=p(m(lp),2);Wv.__click=[bH,di],f(lp);var cf=p(lp,4);Te(cf,()=>n(Qa).length,Yn=>{var vs=SH(),_a=p(m(vs),2);Vs(_a,17,()=>n(Qa),_n,(Vr,Ps)=>{var hi=kH();Se(()=>Nt(hi,"title",(()=>{const Ye=n(Fe).get(n(Ps).key)||null;if(!Ye)return"Click to filter trades by this month";const Tt=Ye.trades?Ye.wins/Ye.trades*100:0,Pt=Ye.net>=0?`+${Qt(Ye.net,2)}`:`${Qt(Ye.net,2)}`;return`Trades ${Ye.trades} • Win ${ie(Tt)} • Net ${Pt} • Fees ${Qt(Ye.fees,2)} • Click to filter`})())),hi.__click=[xH,Ss,Ps,g,di],hi.__keydown=[wH,Ss,Ps,g,di];var Dl=m(hi),Ua=m(Dl,!0);f(Dl);var rt=p(Dl,2),He=m(rt);Se(()=>Ve(He,`${(n(Ps).retPct>=0?"+":"")??""}${ie(n(Ps).retPct)??""}`)),f(rt),f(hi),Se(()=>{Gn(hi,`${`rt-row ${n(Ps).retPct>=0?"pos":"neg"} ${n(Mt).type==="month"&&n(Mt).key===n(Ps).key?"active":""}`??""} svelte-63z95z`),Ve(Ua,n(Ps).key)}),O(Vr,hi)}),f(vs),O(Yn,vs)},Yn=>{var vs=CH();O(Yn,vs)}),f(Ep);var Er=p(Ep,2),$u=m(Er),Pv=p(m($u),2);Pv.__click=[PH,di],f($u);var Up=p($u,4);Te(Up,()=>n(ue).length,Yn=>{var vs=AH(),_a=p(m(vs),2);Vs(_a,17,()=>n(ue),_n,(Vr,Ps)=>{var hi=TH();Se(()=>Nt(hi,"title",(()=>{const Ye=n(ut).get(n(Ps).key)||null;if(!Ye)return"Click to filter trades by this week";const Tt=Ye.trades?Ye.wins/Ye.trades*100:0,Pt=Ye.net>=0?`+${Qt(Ye.net,2)}`:`${Qt(Ye.net,2)}`;return`Trades ${Ye.trades} • Win ${ie(Tt)} • Net ${Pt} • Fees ${Qt(Ye.fees,2)} • Click to filter`})())),hi.__click=[IH,Ss,Ps,g,di],hi.__keydown=[MH,Ss,Ps,g,di];var Dl=m(hi),Ua=m(Dl,!0);f(Dl);var rt=p(Dl,2),He=m(rt);Se(()=>Ve(He,`${(n(Ps).retPct>=0?"+":"")??""}${ie(n(Ps).retPct)??""}`)),f(rt),f(hi),Se(()=>{Gn(hi,`${`rt-row ${n(Ps).retPct>=0?"pos":"neg"} ${n(Mt).type==="week"&&n(Mt).key===n(Ps).key?"active":""}`??""} svelte-63z95z`),Ve(Ua,n(Ps).key)}),O(Vr,hi)}),f(vs),O(Yn,vs)},Yn=>{var vs=LH();O(Yn,vs)}),f(Er),f(yc),f(Gp);var dv=p(Gp,2),Iv=m(dv),qv=m(Iv),vu=m(qv),df=p(m(vu),2);df.__click=[zH,K],f(vu),pn(2),f(qv),f(Iv);var Np=p(Iv,2),jp=m(Np),uf=p(m(jp),2);Te(uf,()=>n($t).length,Yn=>{var vs=$H();Vs(vs,21,()=>n($t),_n,(_a,Vr)=>{var Ps=FH(),hi=m(Ps),Dl=m(hi,!0);f(hi);var Ua=p(hi,2),rt=m(Ua);const He=Qe(()=>`width:${n(Vr).count/nl(n($t))*100}%`);f(Ua);var Ye=p(Ua,2),Tt=m(Ye,!0);f(Ye),f(Ps),Se(()=>{Ve(Dl,n(Vr).label),Nt(rt,"style",n(He)),Ve(Tt,n(Vr).count)}),O(_a,Ps)}),f(vs),O(Yn,vs)},Yn=>{var vs=DH();O(Yn,vs)}),f(jp);var Mv=p(jp,2),Su=p(m(Mv),2);Te(Su,()=>n(_o).length,Yn=>{var vs=NH();Vs(vs,21,()=>n(_o),_n,(_a,Vr)=>{var Ps=EH(),hi=m(Ps),Dl=m(hi,!0);f(hi);var Ua=p(hi,2),rt=m(Ua);const He=Qe(()=>`width:${n(Vr).count/nl(n(_o))*100}%`);f(Ua);var Ye=p(Ua,2),Tt=m(Ye,!0);f(Ye),f(Ps),Se(()=>{Ve(Dl,n(Vr).label),Nt(rt,"style",n(He)),Ve(Tt,n(Vr).count)}),O(_a,Ps)}),f(vs),O(Yn,vs)},Yn=>{var vs=jH();O(Yn,vs)}),f(Mv);var cp=p(Mv,2),Hv=p(m(cp),2);Te(Hv,()=>n(go).length,Yn=>{var vs=BH();Vs(vs,21,()=>n(go),_n,(_a,Vr)=>{var Ps=RH(),hi=m(Ps),Dl=m(hi,!0);f(hi);var Ua=p(hi,2),rt=m(Ua);const He=Qe(()=>`width:${n(Vr).count/nl(n(go))*100}%`);f(Ua);var Ye=p(Ua,2),Tt=m(Ye,!0);f(Ye),f(Ps),Se(()=>{Ve(Dl,n(Vr).label),Nt(rt,"style",n(He)),Ve(Tt,n(Vr).count)}),O(_a,Ps)}),f(vs),O(Yn,vs)},Yn=>{var vs=OH();O(Yn,vs)}),f(cp);var Gv=p(cp,2),Tv=p(m(Gv),2);Te(Tv,()=>n(fs).length,Yn=>{var vs=WH();Vs(vs,21,()=>n(fs),_n,(_a,Vr)=>{var Ps=VH(),hi=m(Ps),Dl=m(hi,!0);f(hi);var Ua=p(hi,2),rt=m(Ua);const He=Qe(()=>`width:${n(Vr).count/nl(n(fs))*100}%`);f(Ua);var Ye=p(Ua,2),Tt=m(Ye,!0);f(Ye),f(Ps),Se(()=>{Ve(Dl,n(Vr).label),Nt(rt,"style",n(He)),Ve(Tt,n(Vr).count)}),O(_a,Ps)}),f(vs),O(Yn,vs)},Yn=>{var vs=qH();O(Yn,vs)}),f(Gv),f(Np),f(dv);var Uv=p(dv,2),uv=m(Uv),pf=m(uv),Yv=m(pf),vf=p(m(Yv),2);vf.__click=[HH,K],f(Yv),pn(2),f(pf),f(uv);var yp=p(uv,2),Bf=m(yp);Bf.__click=[GH,di];var Mp=p(Bf,2);Mp.__click=[UH,di];var ff=p(Mp,2);ff.__click=[A2,Xe,at,Kt,he,ke,St,lo,Ne,ht];var mf=p(ff,2);Te(mf,()=>n(Mt).type!=="all",Yn=>{var vs=YH();vs.__click=[$V,Xe,Es,Kt,he,ke,St,lo,Ne,Mt,ht],O(Yn,vs)});var Kv=p(mf,2);Kv.__click=[L2,Xe,jt,St,ke,lo,he,ht];var Qf=p(Kv,2);Qf.__click=[DV,Xe,Mn,ht],f(yp);var Yp=p(yp,2),Kp=m(Yp),pv=m(Kp);Se(()=>Ve(pv,`Gross Profit: +${Qt(n(be).grossProfit,2)??""}`)),f(Kp);var Rp=p(Kp,2),Av=m(Rp);Se(()=>Ve(Av,`Gross Loss: -${Qt(n(be).grossLoss,2)??""}`)),f(Rp);var Lv=p(Rp,2),gf=m(Lv);Se(()=>Ve(gf,`Total: ${(n(be).netPnl>=0?"+":"")??""}${Qt(n(be).netPnl,2)??""}`)),f(Lv),f(Yp);var _u=p(Yp,2),Vu=m(_u),Of=m(Vu);Se(()=>Ve(Of,`Net (from trades): ${(n(zn)>=0?"+":"")??""}${Me(n(zn))??""}`)),f(Vu);var vv=p(Vu,2),zv=m(vv);Se(()=>Ve(zv,`Initial: ${Qt(n(be).initialCapital,2)??""}`)),f(vv);var bp=p(vv,2),hf=m(bp);Se(()=>Ve(hf,`Final: ${Qt(n(be).finalEquity,2)??""}`)),f(bp),f(_u),f(Uv),f(en),Se(()=>{Gn(yr,`${`kpi-value mono ${n(be).netPnl>=0?"pos":"neg"}`??""} svelte-63z95z`),Ve(Ft,n(We).total),Ve(io,`L ${n(We).entryLong??""}/${n(We).exitLong??""} • S ${n(We).entryShort??""}/${n(We).exitShort??""}`),cu(Cs,n(te)),cu(ko,n(oe)),cu(Ro,n(U)),Co.disabled=l(),cu(Os,n(Z)),Pn.disabled=!n(be),Ve(vi,n(be).trades),Ve(ri,`Wins ${n(be).wins??""} • Loss ${n(be).losses??""} `),Ve(Zc,`Trades ${n(kt).long.trades??""}`),Ve(ru,`Trades ${n(kt).short.trades??""}`),Ve(Zo,n(Yt)),ii(_l,"active",n(nn)==="1w"),ii(Kl,"active",n(nn)==="1m"),ii(Sl,"active",n(nn)==="3m"),ii(Pa,"active",n(nn)==="6m"),ii(Sc,"active",n(nn)==="1y"),ii(ai,"active",n(nn)==="5y"),ii(Ir,"active",n(nn)==="all"),Gn(Lv,`${`pnl-item ${n(be).netPnl>=0?"pos":"neg"}`??""} svelte-63z95z`)}),id("pointerleave",pu,()=>{x(Mo,null)}),id("pointerleave",Zu,()=>{x(ho,null)}),O(xs,en)}),f(as),O(vo,as)},!0),O(pe,Pe)});var Cv=p(Ws,2);Te(Cv,()=>n($),pe=>{var Pe=sG();Pe.__click=[M2,$];var Ht=m(Pe);Ht.__click=[XH];var vo=m(Ht),as=m(vo),po=m(as,!0);f(as);var Bs=p(as,2),xs=m(Bs),en=m(xs);en.__click=[JH,V];var Sn=p(en,2);Sn.__click=[QH,V],f(xs);var lt=p(xs,2);lt.__click=[M2,$],f(Bs),f(vo);var Zt=p(vo,2),qt=m(Zt);Te(qt,()=>B[n(F)],Lo=>{var ks=oG(),yr=Rt(ks);Vs(yr,21,()=>B[n(F)][n(V)].desc,_n,(fe,Ae)=>{var Le=eG(),ft=m(Le,!0);f(Le),Se(()=>Ve(ft,n(Ae))),O(fe,Le)}),f(yr);var N=p(yr,2),X=p(m(N),2);Vs(X,21,()=>B[n(F)][n(V)].examples,_n,(fe,Ae)=>{var Le=tG(),ft=m(Le,!0);f(Le),Se(()=>Ve(ft,n(Ae))),O(fe,Le)}),f(X),f(N),O(Lo,ks)}),f(Zt),f(Ht),f(Pe),Se(()=>{var Lo,ks;Ve(po,(ks=(Lo=B[n(F)])==null?void 0:Lo[n(V)])==null?void 0:ks.title),ii(en,"active",n(V)==="en"),ii(Sn,"active",n(V)==="bn")}),O(pe,Pe)});var af=p(Cv,2),Pp=m(af),Ip=m(Pp),Rf=p(Ip,2),lf=m(Rf,!0);f(Rf),f(Pp),pn(2),f(af),f($s),Se(()=>{Nt($s,"aria-hidden",!c()),ii($s,"fullpage",n(j)),ii(Kr,"selected",n(M)==="editor"),ii(Ul,"selected",n(M)==="errors"),ii(Ul,"has-errors",n(Zs)>0),ii(Ul,"has-warnings",n(Zs)===0&&n(gn)>0),Ve(wl,n(Tn)),ii(dl,"selected",n(M)==="results"),Nt(jd,"aria-pressed",n(C)),Ve(ip,`Labels ${(n(C)?"On":"Off")??""}`),Lu.disabled=l(),Ve(Sv,l()?"Running...":"Run"),Gn(Ip,`footer-dot ${(i()?"error":l()?"running":"ok")??""} svelte-63z95z`),Ve(lf,n(Ko))}),rs(Br,()=>n(I),pe=>x(I,pe)),O(o,$s),Tc()}Hd(["pointerdown","click","input","change","keydown","pointermove"]);var rG=(o,e)=>{o.target===o.currentTarget&&e()},aG=(o,e)=>x(e,"details"),lG=(o,e)=>x(e,"examples"),cG=(o,e)=>x(e,"bn"),dG=(o,e)=>x(e,"en"),uG=re('<p class="ss-guide-intro svelte-50qv65">Script Studio দুইভাবে কাজ করে: DSL (সহজ টেক্সট) এবং JSON। নিচে পেশাদার স্টাইলের স্টেপ‑বাই‑স্টেপ ডকুমেন্টেশন দেওয়া হলো।</p> <h3 class="ss-section-title svelte-50qv65">কুইক স্টার্ট</h3> <ul class="ss-list svelte-50qv65"><li>প্যান নির্বাচন করুন: <code>pane</code> = <code>main</code> বা <code>sub</code></li> <li>ক্যালকুলেশন যোগ করুন: <code>calc</code> এ EMA/RSI/MACD ইত্যাদি</li> <li>প্লট আঁকুন: <code>plots</code> এ সিরিজকে line/neon_line/dots</li> <li>সিগন্যাল/লেবেল দিন: <code>labels</code> ও <code>signals</code> এ শর্ত</li> <li>স্ট্র্যাটেজি ব্যাকটেস্ট চাইলে: <code>strategy</code> যোগ করুন এবং <code>Results</code> ট্যাব দেখুন</li> <li>Run চাপুন এবং চার্টে ফলাফল দেখুন</li></ul> <h3 class="ss-section-title svelte-50qv65">স্ক্রিপ্ট টাইপ</h3> <ul class="ss-list svelte-50qv65"><li>DSL: ছোট, দ্রুত টেক্সট ভিত্তিক সিনট্যাক্স</li> <li>JSON: স্ট্রাকচারড, বিস্তারিত কনফিগ</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">DSL উদাহরণ</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON উদাহরণ</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">স্কিমা চিটশিট</h3> <ul class="ss-list svelte-50qv65"><li><code>calc</code>: ইনডিকেটর সিরিজ ডিফাইন (উদা: EMA/RSI/MACD)</li> <li><code>plots</code>: সিরিজ কিভাবে আঁকবেন (color/width/style)</li> <li><code>labels</code>: শর্ত পূরণে শেপ/টেক্সট দেখায়</li> <li><code>signals</code>: ট্রেড ইভেন্ট (entry/exit)</li> <li><code>strategy</code>: ব্যাকটেস্ট সেটিংস (capital/fees/slippage/size/SL/TP)</li> <li><code>overlays</code>: ড্রয়িং টুলস (Fibo, trendline, wave, text, horizontal line)</li> <li><code>levels</code>: সাব‑প্যানে লেভেল লাইন</li> <li><code>lines</code>: পিভট থেকে ট্রেন্ডলাইন সেগমেন্ট</li> <li><code>fills</code>: দুই সিরিজের মধ্যে ফিল কালার</li></ul> <h3 class="ss-section-title svelte-50qv65">ড্রয়িং (Overlays) — Script দিয়ে Fib/Line/Text</h3> <ul class="ss-list svelte-50qv65"><li><code>overlays</code> এ <code>name</code> দিন (যেমন: <code>fibonacciSegment</code>, <code>horizontalRayLine</code>, <code>note</code>, <code>threeWaves</code>)</li> <li>পয়েন্ট দিন: <code></code> (নেগেটিভ index = শেষ থেকে গণনা)</li> <li><code>extendData</code> দিয়ে fib levels বা note text কাস্টমাইজ করা যায়</li></ul> <h3 class="ss-section-title svelte-50qv65">স্ট্র্যাটেজি (Backtest) — প্রফেশনাল মোড</h3> <ul class="ss-list svelte-50qv65"><li>ডাটা যদি OHLC হয় (tick না থাকে), তাহলে আমরা <code>intrabar_ohlc</code> মোডে <code>high/low</code> touch দেখে SL/TP হিট ধরতে পারি</li> <li>একই ক্যান্ডেলে SL+TP দুটো touch হলে ডিফল্ট <code>intrabarTieBreak</code> = <code>worst_case</code> (সেফ/কনজারভেটিভ)</li> <li>Risk fields: <code>stopLossPct</code>, <code>takeProfitPct</code>, <code>trailingStopPct</code></li> <li>Broker realism: <code>priceTick</code> / <code>qtyStep</code> / <code>minQty</code> দিলে price/qty broker নিয়মে রাউন্ড হবে (ম্যাচ না করলে order <code>rejected</code> হবে — Orders টেবিলে note দেখবেন)</li> <li>Orders: <code>signals[i].order</code> দিয়ে <code>market/limit/stop/stop_limit</code> entry/exit করা যায় (price হিসেবে number বা সিরিজ নাম)</li> <li>Stop‑limit: <code></code> (ঐচ্ছিক <code>expiresBars</code> দিলে অটো‑ক্যান্সেল)</li> <li>OCO: <code>order.oco</code> একই গ্রুপের অন্য pending order ক্যান্সেল করে</li> <li>Bracket (entry‑তে): <code>order.bracket</code> দিয়ে ওই entry‑র জন্য আলাদা SL/TP/Trailing/Partial TP সেট করা যায় (strategy‑level risk override)</li> <li>Cooldown: <code>signals[i].cooldownBars</code> দিলে একই সিগন্যাল বারবার ফায়ার হবে না</li> <li>Partial: <code>order.qtyPct</code> দিয়ে partial entry/exit করা যায় (উদা: TP তে 50% exit)</li></ul> <h3 class="ss-section-title svelte-50qv65">Broker realism v2 (Spread/Margin/Netting)</h3> <ul class="ss-list svelte-50qv65"><li><code>spreadPct</code>: bid/ask spread % (উদা: <code>0.05</code> মানে <code>0.05%</code>)</li> <li><code>leverage</code>: leverage (>=1) — % equity order size হলে এক্সপোজার বাড়ে</li> <li><code>maintenanceMarginPct</code> + <code>liquidationFeePct</code>: margin কমে গেলে <b>AUTO liquidation</b></li> <li><code>borrowPctPerYear</code> + <code>fundingPctPerDay</code>: short borrow/funding fee equity থেকে কেটে নেয়</li> <li><code>positionMode</code>: <code>netting</code> (ডিফল্ট) বা <code>hedging</code></li> <li><code>closeMethod</code>: <code>fifo</code> (ডিফল্ট) / <code>lifo</code> / <code>avg</code> (average‑cost)</li></ul> <h3 class="ss-section-title svelte-50qv65">স্টেপ‑বাই‑স্টেপ: EMA ক্রস স্ক্রিপ্ট</h3> <ul class="ss-list svelte-50qv65"><li>Step 1 — <code>pane</code>: <code>main</code></li> <li>Step 2 — <code>calc</code>: <code>ema_fast</code> ও <code>ema_slow</code></li> <li>Step 3 — <code>plots</code>: দুই EMA লাইন</li> <li>Step 4 — <code>labels</code>: ক্রস হলে BUY/SELL ট্যাগ</li> <li>Step 5 — Run করে চার্ট দেখুন</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON · EMA ক্রস</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">কন্ডিশন রেফারেন্স</h3> <ul class="ss-list svelte-50qv65"><li>কম্পারিজন: <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code></li> <li>লজিক: <code>and</code>, <code>or</code>, <code>not</code></li> <li>ক্রস: <code>crossesAbove</code>, <code>crossesBelow</code></li> <li>ট্রেন্ড: <code>trend(up)</code>, <code>trend(down)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">ডাইনামিক প্যারাম</h3> <ul class="ss-list svelte-50qv65"><li><code>params</code> এ ভ্যালু দিন, তারপর যেকোনো স্ট্রিং/নাম্বার ফিল্ডে <code></code> লিখুন (উদাহরণ: <code></code>)</li> <li>উদাহরণ: <code></code> হলে <code>when</code>‑এ লিখুন <code></code></li> <li>Series expressions এ প্যারাম সরাসরি আইডেন্টিফায়ার হিসেবেও চলে: <code>highest(close, WIN)</code> (যদি <code>params.WIN</code> থাকে)</li></ul> <h3 class="ss-section-title svelte-50qv65">এক্সটেন্ডেড ফাংশন</h3> <ul class="ss-list svelte-50qv65"><li>ক্রস/কম্পেয়ার: <code>crossover</code>, <code>crossunder</code>, <code>above</code>, <code>below</code>, <code>between</code></li> <li>ডিরেকশন: <code>rising(series[, n])</code>, <code>falling(series[, n])</code></li> <li>উইন্ডো/ল্যাগ: <code>lowest</code>, <code>highest</code>, <code>lag</code>, <code>prev</code>, <code>change</code>, <code>abs</code></li> <li>অ্যারিথমেটিক: <code>add</code>, <code>sub</code>, <code>mul</code>, <code>div</code>, <code>min</code>, <code>max</code></li> <li>মুভিং এভারেজ: <code>sma(series, period)</code>, <code>ema(series, period)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">সাপোর্টেড ফিচার</h3> <ul class="ss-list svelte-50qv65"><li>Pane: <code>main</code>, <code>sub</code></li> <li>Indicators (calc): <code>sma</code>, <code>smma</code>, <code>ema</code>, <code>wma</code>, <code>rsi</code>, <code>macd</code>, <code>bbands</code>, <code>atr</code>, <code>supertrend</code>, <code>kc</code>, <code>donchian</code>, <code>ichimoku</code>, <code>stoch</code>, <code>sar</code>, <code>zscore</code>, <code>vwap</code>, <code>vwma</code>, <code>atr_bands</code>, <code>vwap_bands</code>, <code>linreg_channel</code>, <code>pivot_high</code>, <code>pivot_low</code>, <code>auto_fib</code>, <code>last_value</code>, <code>prev_value</code></li> <li>Plots: <code>line</code>, <code>neon_line</code>, <code>bezier_line</code>, <code>histogram</code>, <code>area</code>, <code>dots</code>, <code>bar</code>, <code>cloud</code>, <code>aura</code>, <code>candleshadow</code>, <code>supertrend_cloud</code></li> <li>Label shapes: <code>arrowUp</code>, <code>arrowDown</code>, <code>circle</code>, <code>square</code>, <code>triangle_up_filled</code>, <code>triangle_down_filled</code>, <code>box</code>, <code>label</code>, <code>text</code>, <code>emoji</code>, <code>triangle_up_gradient</code>, <code>arrow_up_glow</code>, <code>pill</code>, <code>tag</code>, <code>flag</code></li> <li>Signals: <code>entry_long</code>, <code>exit_long</code>, <code>entry_short</code>, <code>exit_short</code>, <code>cancel</code>, <code>cancel_all</code></li> <li>Backtest: add <code>strategy</code> and check <code>Results</code> tab</li></ul> <h3 class="ss-section-title svelte-50qv65">সীমাবদ্ধতা</h3> <ul class="ss-list svelte-50qv65"><li>JSON স্ক্রিপ্টে কমেন্ট/ব্যাকটিক/সিঙ্গেল কোট সাপোর্ট না — ডাবল কোট ও বৈধ কমা ব্যবহার করুন</li> <li>DSL পেস্ট করলে এডিটর <code>Non‑JSON script</code> দেখাতে পারে — তবুও Run করলে কাজ করবে</li> <li><code>when</code>‑এ ইচ্ছেমতো জাভাস্ক্রিপ্ট নয় — সমর্থিত ফাংশন/কম্পারিজন ব্যবহার করুন</li> <li><code>request.security</code> (MTF/HTF) এখন <b>same symbol + multi‑symbol</b> কাজ করে — অন্য symbol দিতে চাইলে টিকার দিন (উদা: <code>"AAPL"</code> বা <code>"AAPL@US"</code>)</li> <li>HTF মানে Higher Timeframe (উচ্চ টাইমফ্রেম) — উদাহরণ: চার্ট 15m কিন্তু <code>request.security(..., "240", ...)</code> = 4H ডেটা</li> <li>Lower‑timeframe security (যেমন চার্ট 1H কিন্তু security 15m) এখনও সাপোর্টেড না, কারণ lower‑TF candle সার্ভার থেকে লাগবে</li> <li>HTF ইন্ডিকেটর ঠিকমতো দেখতে হলে যথেষ্ট history লোড করুন (বামে scroll করলে পুরোনো candles লোড হয়)</li> <li><code>request.security</code> চালালে Script Studio প্রয়োজন হলে ঐ timeframe‑এর অতিরিক্ত historical candles background‑এ লোড করতে পারে</li></ul> <h3 class="ss-section-title svelte-50qv65">এরর ডায়াগনস্টিক্স</h3> <ul class="ss-list svelte-50qv65"><li>পার্স ফেল হলে: <code>Label[i:j] parse failed at &lt;pos&gt;</code> — ঠিক কোথায় সমস্যা</li> <li>অজানা সিরিজ: <code>Label[i:j] unknown series: …</code> — এলিয়াস ঠিক করে নিন</li> <li>প্যান কন্টেন্ট: <code>Pane has no plots</code> — অন্তত একটি প্লট যোগ করুন</li></ul> <h3 class="ss-section-title svelte-50qv65">সাব‑প্যানে অ্যাঙ্করিং</h3> <ul class="ss-list svelte-50qv65"><li>সাব‑প্যানে লেবেল/সিগন্যালের <code>source</code> হিসেবে ইনডিকেটর সিরিজ ব্যবহার করুন</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">RSI সাব‑প্যান</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">ট্রেন্ডলাইন ও ফিল</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">অটো ট্রেন্ডলাইন</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">বোলিঞ্জার ফিল</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">মাল্টি‑প্যান টেমপ্লেট</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Main + Sub</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">কমন ভুল ও ফিক্স</h3> <ul class="ss-list svelte-50qv65"><li><code>when</code> স্ট্রিং‑এ ট্রেইলিং কমা/সেমিকোলন থাকলে স্বয়ংক্রিয়ভাবে পরিষ্কার হয় (কিন্তু JSON অবশ্যই ভ্যালিড হতে হবে)</li> <li>ঝুলে থাকা <code>and</code>/<code>or</code> থাকলে শর্ত ট্রিম হয়</li> <li>কমেন্ট লিখলে পার্সের আগে বাদ দেওয়া হয়</li></ul>',1),pG=re('<p class="ss-guide-intro svelte-50qv65">Script Studio supports DSL and JSON. Below is a professional, step‑by‑step guide.</p> <h3 class="ss-section-title svelte-50qv65">Quick Start</h3> <ul class="ss-list svelte-50qv65"><li>Select <code>pane</code>: <code>main</code> or <code>sub</code></li> <li>Add indicators in <code>calc</code> (EMA/RSI/MACD)</li> <li>Draw with <code>plots</code> (line/neon_line/dots)</li> <li>Configure <code>labels</code> and <code>signals</code></li> <li>For backtest: add <code>strategy</code> and open <code>Results</code></li> <li>Press Run and review on chart</li></ul> <h3 class="ss-section-title svelte-50qv65">Script Types</h3> <ul class="ss-list svelte-50qv65"><li>DSL: concise text syntax</li> <li>JSON: structured configuration</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">DSL example</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON example</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Schema Cheatsheet</h3> <ul class="ss-list svelte-50qv65"><li><code>calc</code>: define indicator series</li> <li><code>plots</code>: render series with styles</li> <li><code>labels</code>: draw shapes/text on conditions</li> <li><code>signals</code>: trading events</li> <li><code>strategy</code>: backtest settings (capital/fees/slippage/size/SL/TP)</li> <li><code>overlays</code>: drawing tools (Fibo, trendline, wave, text, horizontal line)</li> <li><code>levels</code>: horizontal levels in sub pane</li> <li><code>lines</code>: trendline segments from pivots</li> <li><code>fills</code>: fill between two series</li></ul> <h3 class="ss-section-title svelte-50qv65">Drawings (Overlays) — Scripted Fib/Lines/Text</h3> <ul class="ss-list svelte-50qv65"><li>Add <code>overlays</code> with a registered overlay <code>name</code> (example: <code>fibonacciSegment</code>, <code>horizontalRayLine</code>, <code>note</code>)</li> <li>Points support <code>index</code> (negative = from end) and <code>source</code> (<code>open/high/low/close</code>)</li> <li>Use <code>extendData</code> to customize fib levels and note text/colors</li></ul> <h3 class="ss-section-title svelte-50qv65">Strategy Backtest — Pro Mode</h3> <ul class="ss-list svelte-50qv65"><li>If you have OHLC history (no tick), use <code>execution: intrabar_ohlc</code> to treat SL/TP as “touched” by <code>high/low</code></li> <li>If SL and TP are both touched in the same candle, default <code>intrabarTieBreak</code> is <code>worst_case</code> (conservative)</li> <li>Risk fields: <code>stopLossPct</code>, <code>takeProfitPct</code>, <code>trailingStopPct</code></li> <li>Broker realism: set <code>priceTick</code> / <code>qtyStep</code> / <code>minQty</code> to enforce tick size + lot size (mismatches can create <code>rejected</code> orders — see Orders table notes)</li> <li>Orders: use <code>signals[i].order</code> to place <code>market/limit/stop/stop_limit</code> entries/exits (price can be a number or a series name)</li> <li>Stop‑limit: <code></code> (use <code>expiresBars</code> to auto-cancel)</li> <li>OCO: add <code>order.oco</code> to cancel other pending orders in the same group when one fills</li> <li>Bracket (per-entry): attach <code>order.bracket</code> on an entry to override SL/TP/trailing/partial take-profits for that entry lot</li> <li>Cooldown: add <code>signals[i].cooldownBars</code> to prevent repeated signals (useful for one-time entries)</li> <li>Partial: use <code>order.qtyPct</code> for partial entry/exit (example: take 50% profit at TP)</li> <li>Advanced: <code>pyramiding</code> (max stacked entries), <code>takeProfits</code> (partial TP levels)</li> <li>Reports: equity curve + drawdown + monthly/weekly returns + CSV export in <code>Results</code> tab</li> <li>Too many labels? Use the <b>Labels On/Off</b> toggle, or set <code>style.labelLimit</code></li></ul> <h3 class="ss-section-title svelte-50qv65">Step‑by‑Step: EMA Cross</h3> <ul class="ss-list svelte-50qv65"><li>Step 1 — <code>pane</code>: <code>main</code></li> <li>Step 2 — <code>calc</code>: <code>ema_fast</code> and <code>ema_slow</code></li> <li>Step 3 — <code>plots</code>: draw both EMAs</li> <li>Step 4 — <code>labels</code>: show BUY/SELL on cross</li> <li>Step 5 — Run and verify</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON · EMA cross</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Condition Reference</h3> <ul class="ss-list svelte-50qv65"><li>Comparisons: <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code></li> <li>Logic: <code>and</code>, <code>or</code>, <code>not</code></li> <li>Crosses: <code>crossesAbove</code>, <code>crossesBelow</code></li> <li>Trend: <code>trend(up)</code>, <code>trend(down)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">Dynamic Params</h3> <ul class="ss-list svelte-50qv65"><li>Put values in <code>params</code>, then reference them as <code></code> (example: <code></code>) anywhere in the script.</li> <li>Example: <code></code> then <code></code></li> <li>In series expressions, numeric params can also be used as bare identifiers: <code>highest(close, WIN)</code> (if <code>params.WIN</code> exists)</li></ul> <h3 class="ss-section-title svelte-50qv65">Extended Functions</h3> <ul class="ss-list svelte-50qv65"><li>Cross/compare: <code>crossover</code>, <code>crossunder</code>, <code>above</code>, <code>below</code>, <code>between</code></li> <li>Direction: <code>rising(series[, n])</code>, <code>falling(series[, n])</code></li> <li>Window/lag: <code>lowest</code>, <code>highest</code>, <code>lag</code>, <code>prev</code>, <code>change</code>, <code>abs</code></li> <li>Arithmetic: <code>add</code>, <code>sub</code>, <code>mul</code>, <code>div</code>, <code>min</code>, <code>max</code></li> <li>Moving average: <code>sma(series, period)</code>, <code>ema(series, period)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">Supported Features</h3> <ul class="ss-list svelte-50qv65"><li>Pane: <code>main</code>, <code>sub</code></li> <li>Indicators (calc): <code>sma</code>, <code>smma</code>, <code>ema</code>, <code>wma</code>, <code>rsi</code>, <code>macd</code>, <code>bbands</code>, <code>atr</code>, <code>supertrend</code>, <code>kc</code>, <code>donchian</code>, <code>ichimoku</code>, <code>stoch</code>, <code>sar</code>, <code>zscore</code>, <code>vwap</code>, <code>vwma</code>, <code>atr_bands</code>, <code>vwap_bands</code>, <code>linreg_channel</code>, <code>pivot_high</code>, <code>pivot_low</code>, <code>auto_fib</code>, <code>last_value</code>, <code>prev_value</code></li> <li>Plots: <code>line</code>, <code>neon_line</code>, <code>bezier_line</code>, <code>histogram</code>, <code>area</code>, <code>dots</code>, <code>bar</code>, <code>cloud</code>, <code>aura</code>, <code>candleshadow</code>, <code>supertrend_cloud</code></li> <li>Label shapes: <code>arrowUp</code>, <code>arrowDown</code>, <code>circle</code>, <code>square</code>, <code>triangle_up_filled</code>, <code>triangle_down_filled</code>, <code>box</code>, <code>label</code>, <code>text</code>, <code>emoji</code>, <code>triangle_up_gradient</code>, <code>arrow_up_glow</code>, <code>pill</code>, <code>tag</code>, <code>flag</code></li> <li>Signals: <code>entry_long</code>, <code>exit_long</code>, <code>entry_short</code>, <code>exit_short</code>, <code>cancel</code>, <code>cancel_all</code></li> <li>Backtest: add <code>strategy</code> and open <code>Results</code> in Script Studio</li></ul> <h3 class="ss-section-title svelte-50qv65">Strategy Engine v2</h3> <ul class="ss-list svelte-50qv65"><li>Spread: set <code>spreadPct</code> to simulate bid/ask; market/stop fills use bid/ask, limits use the limit price</li> <li>Leverage/Margin: set <code>leverage</code> + <code>maintenanceMarginPct</code>; breaches trigger <b>AUTO liquidation</b> (optional <code>liquidationFeePct</code>)</li> <li>Carry costs: <code>borrowPctPerYear</code> (short) and <code>fundingPctPerDay</code> (both sides) reduce equity over time</li> <li>Position mode: <code>positionMode="netting"</code> (one direction) or <code>"hedging"</code> (long+short simultaneously)</li> <li>Cost basis: <code>closeMethod="fifo"</code>, <code>"lifo"</code>, or <code>"avg"</code> (average-cost)</li></ul> <h3 class="ss-section-title svelte-50qv65">Limitations</h3> <ul class="ss-list svelte-50qv65"><li>JSON: no comments/backticks/single quotes — use double quotes and valid commas</li> <li>DSL may show <code>Non‑JSON script</code> in editor — press Run, it still works</li> <li><code>when</code>: no arbitrary JavaScript — use supported functions/comparisons</li> <li><code>request.security</code> (MTF/HTF) supports <b>same symbol + multi‑symbol</b> — pass a ticker like <code>"AAPL"</code> (optional <code>"AAPL@US"</code>)</li> <li>HTF = Higher Timeframe — example: chart is 15m but <code>request.security(..., "240", ...)</code> uses 4H candles</li> <li>Lower‑timeframe security (e.g. chart 1H but security 15m) is not supported yet because it requires true lower‑TF candles from server</li> <li>Load enough history (scroll left) so HTF indicators have enough candles to calculate</li> <li>When using <code>request.security</code>, Script Studio may background-fetch extra candles for that timeframe if needed</li></ul> <h3 class="ss-section-title svelte-50qv65">Error Diagnostics</h3> <ul class="ss-list svelte-50qv65"><li>Parse fail: <code>Label[i:j] parse failed at &lt;pos&gt;</code> shows exact position</li> <li>Unknown series: <code>Label[i:j] unknown series: …</code> fix alias</li> <li>Pane content: <code>Pane has no plots</code> add at least one plot</li></ul> <h3 class="ss-section-title svelte-50qv65">Sub‑Pane Anchoring</h3> <ul class="ss-list svelte-50qv65"><li>Sub pane labels should use a sub‑pane series as <code>source</code> (example: <code>stoch_k</code>, <code>rsi14</code>)</li> <li>If you use <code>high/low/close</code> inside a fixed <code>min/max</code> sub pane, the label will clamp to the top/bottom and look “un‑anchored” when you resize</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">RSI sub pane</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Trendlines & Fills</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Auto trendlines</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Bollinger fill</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Multi‑Pane Template</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Main + Sub</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Common Mistakes</h3> <ul class="ss-list svelte-50qv65"><li>In <code>when</code>, trailing commas/semicolons are ignored (JSON itself must still be valid)</li> <li>Dangling <code>and</code>/<code>or</code> are trimmed</li> <li>Inline comments are stripped before parsing</li></ul>',1),vG=re('<section class="ss-section svelte-50qv65" role="tabpanel" id="ss-tabpanel-details" aria-labelledby="ss-tab-details"><div class="ss-details-head svelte-50qv65"><div class="ss-details-title svelte-50qv65">Documentation</div> <div class="ss-lang-toggle svelte-50qv65" aria-label="Language toggle"><button type="button">বাংলা</button> <button type="button">English</button></div></div> <!></section>'),fG=(o,e,t)=>e(n(t).code),mG=(o,e,t)=>e(n(t).code),gG=re('<div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65"> </div> <div class="ss-example-actions svelte-50qv65"><button type="button" class="ss-copy svelte-50qv65">Copy</button><button type="button" class="ss-use svelte-50qv65">Use in editor</button></div></div> <pre class="ss-code svelte-50qv65"><code> </code></pre></div>'),hG=re('<section class="ss-section svelte-50qv65" role="tabpanel" id="ss-tabpanel-examples" aria-labelledby="ss-tab-examples"><h3 class="ss-section-title svelte-50qv65">উদাহরণ স্ক্রিপ্ট</h3> <!></section>'),_G=re('<div class="ss-guide-backdrop svelte-50qv65" role="dialog" aria-modal="true" aria-labelledby="ss-guide-title"><div class="ss-guide-modal svelte-50qv65"><div class="ss-guide-header svelte-50qv65"><h2 id="ss-guide-title" class="svelte-50qv65">Script Studio – Documentation</h2> <button class="ss-guide-close svelte-50qv65" type="button" aria-label="Close guide">&times;</button></div> <div class="ss-guide-body svelte-50qv65"><div class="ss-tabs svelte-50qv65" role="tablist" aria-label="Guide sections"><button id="ss-tab-details" role="tab" aria-controls="ss-tabpanel-details">Documentation</button> <button id="ss-tab-examples" role="tab" aria-controls="ss-tabpanel-examples">Examples</button></div> <!></div></div></div>');function yG(o,e){Mc(e,!1);let t=Qs(e,"show",8,!1),s=nd("details"),i=nd("bn");const r=sp();function a(){r("close")}function l(K){return String(K||"").replace(/\\r\\n/g,`
`).replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\"/g,'"')}function c(K){r("insert",{code:l(K)})}function d(K){try{navigator.clipboard.writeText(l(K))}catch{}}const v=[{title:"DSL · Fractal tops/bots",code:`WIN = 5
HIWIN = highest(close, WIN)
LOWIN = lowest(close, WIN)
signal top when (close == HIWIN)
signal bot when (close == LOWIN)
label at top text:"▲ fractal" color:#f97316
label at bot text:"▼ fractal" color:#3b82f6`},{title:"Strategy (JSON) · Engine v2 smoke test (partials + trailing + orders table)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 25 },
    "commissionPct": 0.06,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 2,
    "stopLossPct": 1.2,
    "trailingStopPct": 0.8,
    "takeProfits": [
      { "takeProfitPct": 1.0, "qtyPct": 50 },
      { "takeProfitPct": 2.0, "qtyPct": 50 }
    ],
    "allowShort": false
  },
  "calc": [
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 },
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "EMA 50", "source": "ema50", "color": "#22c55e", "width": 2 },
    { "name": "RSI", "source": "rsi14", "color": "#f59e0b", "width": 2, "pane": "sub" }
  ],
  "levels": [
    { "name": "RSI 70", "value": 70, "color": "#ef4444", "style": "dashed", "pane": "sub" },
    { "name": "RSI 50", "value": 50, "color": "#64748b", "style": "dotted", "pane": "sub" },
    { "name": "RSI 30", "value": 30, "color": "#22c55e", "style": "dashed", "pane": "sub" }
  ],
  "labels": [
    { "when": "rsi14 crossesAbove 50", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "rsi14 crossesBelow 50", "text": "EXIT", "shape": "triangle_down_filled", "color": "#f59e0b", "position": "above", "source": "high" }
  ],
  "signals": [
    { "id": "L", "type": "entry_long", "when": "rsi14 crossesAbove 50", "order": { "kind": "market", "qtyPct": 100 } },
    { "id": "X", "type": "exit_long",  "when": "rsi14 crossesBelow 50", "order": { "kind": "market", "qtyPct": 100 } }
  ]
}`},{title:"Pine (pro) · Periodic entries (mod20) + plotshape",code:`//@pine
//@version=5
strategy(initial_capital=10000, execution="bar_close", allowShort=false)

plot(close, title="Close", color="#60a5fa")

mod20 = bar_index % 20
enter = mod20 == 1
exit  = mod20 == 10

plotshape(enter, text="BUY", color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(exit,  text="EXIT", color=color.red,   location=location.abovebar, style=shape.triangledown)

strategy.entry("L", strategy.long, when=enter)
strategy.exit("X", side="long", when=exit, qty_percent=100)`},{title:"Pine (pro) · var/ := state (counter + history)",code:`//@pine
//@version=5
indicator("State demo", overlay=true)

// var = initialize once; := = update per bar
var float bars = 0
bars := bars + 1

// history access: x[1]
var float delta = na
delta := close - close[1]

plot(bars, title="Bars since start", color="#22c55e", width=2)
plot(delta, title="Close change", color="#3b82f6", width=1)

plotshape(delta > 0, text="UP", color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(delta < 0, text="DN", color=color.red,   location=location.abovebar, style=shape.triangledown)`},{title:"Pine (pro) · if/else + ternary + array (demo)",code:`//@pine
//@version=5
indicator("If/Else + Ternary + Array demo", overlay=true)

ema_len = input.int(20, title="EMA Len", minval=1)
atr_len = input.int(14, title="ATR Len", minval=1)

ema_base = ema(close, ema_len)
atr_val  = atr(high, low, close, atr_len)

trend_up = close > ema_base
trend_dn = close < ema_base

// ternary operator
bias = trend_up ? 1 : -1

// if/else-if series update
var float sig = na
if trend_up
    sig := ema_base + atr_val
else if trend_dn
    sig := ema_base - atr_val
else
    sig := ema_base

plot(ema_base, title="EMA Base", color="#22c55e", width=2)
plot(sig, title="IF/ELSE band", color="#f59e0b", width=2)

// array + for loop (compile-time) to draw multiple bands
levels = array.new_float(3, 0)
array.set(levels, 0, 0.5)
array.set(levels, 1, 1.0)
array.set(levels, 2, 1.5)

for i = 0 to 2
    plot(ema_base + atr_val * array.get(levels, i), title="Band i", color="#94a3b8", width=1, style="dotted")

plotchar(bias > 0, char="U", color=color.green, location=location.belowbar)
plotchar(bias < 0, char="D", color=color.red, location=location.abovebar)`},{title:"Pine (pro) · Runtime array.set + for loop (per-bar)",code:`//@pine
//@version=5
indicator("Runtime array demo", overlay=true)

ema_len = input.int(20, title="EMA Len", minval=1)
atr_len = input.int(14, title="ATR Len", minval=1)

ema_base = ema(close, ema_len)
atr_val  = atr(high, low, close, atr_len)

// runtime array: values update every bar via array.set
bands = array.new_float(3, 0)
array.set(bands, 0, ema_base - atr_val)
array.set(bands, 1, ema_base)
array.set(bands, 2, ema_base + atr_val)

plot(ema_base, title="EMA Base", color="#22c55e", width=2)

// loop unrolled at compile-time; array values are runtime
for i = 0 to 2
    plot(array.get(bands, i), title="Band", color="#94a3b8", width=1, style="dotted")`},{title:"Pine (pro) · Multiline function + barssince + math",code:`//@pine
//@version=5
indicator("Functions v2 demo", overlay=true)

len = input.int(20, title="Len", minval=2)
src = close

zscore(src, p) =>
    (src - sma(src, p)) / stdev(src, p)

z = zscore(src, len)
trend_up = z > 0
bars_up = ta.barssince(trend_up)

plot(z, title="Z-score", color="#60a5fa", width=2, pane="sub")
plot(bars_up, title="Bars since up", color="#f59e0b", width=2, pane="sub")

mag = math.pow(math.abs(z), 2)
plot(mag, title="Z^2", color="#22c55e", width=1, pane="sub")`},{title:"Pine (pro) · Built-ins (barstate/timeframe/syminfo/strategy)",code:`//@pine
//@version=5
strategy(initial_capital=10000, execution="bar_close", allowShort=false)

fast = ema(close, 20)
slow = ema(close, 50)

plot(fast, title="EMA 20", color="#22c55e", width=2)
plot(slow, title="EMA 50", color="#3b82f6", width=2, style="dashed")

long_cond = crossover(fast, slow)
exit_cond = crossunder(fast, slow)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)

plotshape(barstate.islast, text="LAST", color=color.blue, location=location.abovebar, style=shape.labeldown)
plotchar(timeframe.isintraday, char="I", color=color.orange, location=location.belowbar)
plotchar(timeframe.period == "60", char="60", color=color.orange, location=location.belowbar)

// Replace "AAMRANET" with your chart symbol to see T marker.
plotchar(syminfo.ticker == "AAMRANET", char="T", color=color.green, location=location.abovebar)

plot(strategy.position_size, title="Pos", color="#60a5fa", width=2, pane="sub")
plot(strategy.opentrades, title="Open", color="#f59e0b", width=2, pane="sub")
plot(strategy.closedtrades, title="Closed", color="#22c55e", width=2, pane="sub")
plot(strategy.equity, title="Equity", color="#eab308", width=2, pane="sub")`},{title:"Pine (pro) · strategy.order + cancel + risk",code:`//@pine
//@version=5
strategy(initial_capital=10000, execution="bar_close", allowShort=false)

// Risk caps (percent of equity)
strategy.risk.max_drawdown(12)
strategy.risk.max_position_size(50, strategy.percent_of_equity)
strategy.risk.max_intraday_filled_orders(3)
strategy.risk.max_intraday_loss(2, strategy.percent_of_equity)

fast = ema(close, 10)
slow = ema(close, 21)

plot(fast, title="EMA Fast", color="#22c55e", width=2)
plot(slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond = crossover(fast, slow)
exit_cond = crossunder(fast, slow)

limit_px = low * 0.995
strategy.order("L", strategy.long, qty_percent=100, limit=limit_px, when=long_cond)
strategy.cancel("L", when=exit_cond)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · Backtest date/session filter",code:`//@pine
//@version=5
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, from="2023-01-01", to="2023-06-30", session="0930-1600", execution="bar_close", allowShort=false)

fast_len = input.int(20, title="EMA Fast", minval=1)
slow_len = input.int(50, title="EMA Slow", minval=2)

ema_fast = ema(close, fast_len)
ema_slow = ema(close, slow_len)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond = crossover(ema_fast, ema_slow)
exit_cond = crossunder(ema_fast, ema_slow)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · Optimization grid (fast/slow)",code:`//@pine
//@version=5
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, execution="bar_close", allowShort=false)

fast_len = input.int(10, title="Fast", minval=5, maxval=30, step=5)
slow_len = input.int(40, title="Slow", minval=20, maxval=80, step=10)

ema_fast = ema(close, fast_len)
ema_slow = ema(close, slow_len)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond = crossover(ema_fast, ema_slow)
exit_cond = crossunder(ema_fast, ema_slow)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · Dynamic draw (line/label/box/table)",code:`//@pine
//@version=5
indicator("Dynamic draw demo", overlay=true)

fast = ema(close, 20)
slow = ema(close, 50)

plot(fast, title="EMA 20", color="#22c55e", width=2)
plot(slow, title="EMA 50", color="#3b82f6", width=2, style="dashed")

// label.new on cross
if crossover(fast, slow)
    label.new(bar_index, low, "BUY", color=color.green, textcolor=color.white, style=label.style_label_up)

// line.new + box.new on last bar only
if barstate.islast
    line.new(bar_index - 20, fast[20], bar_index, fast, color="#f59e0b", width=2, style=line.style_dashed, extend=extend.right)
    box.new(bar_index - 10, high, bar_index, low, bgcolor="#1e293b", border_color="#3b82f6")

// table.new + table.cell on last bar
var table t = table.new(position.top_right, 2, 3)
if barstate.islast
    table.cell(t, 0, 0, "Fast")
    table.cell(t, 1, 0, fast)
    table.cell(t, 0, 1, "Slow")
    table.cell(t, 1, 1, slow)
    table.cell(t, 0, 2, "Trend")
    table.cell(t, 1, 2, fast > slow ? 1 : -1)`},{title:"Pine (pro) · linefill + table merge/clear + tooltips",code:`//@pine
//@version=5
indicator("Linefill + table merge", overlay=true)

fast = ema(close, 20)
slow = ema(close, 50)

plot(fast, title="EMA 20", color="#22c55e", width=2)
plot(slow, title="EMA 50", color="#3b82f6", width=2, style="dashed")

// Two dynamic lines to fill between
var line l1 = line.new(bar_index - 20, fast[20], bar_index, fast, color="#22c55e", width=1, style=line.style_dotted, extend=extend.right)
var line l2 = line.new(bar_index - 20, slow[20], bar_index, slow, color="#3b82f6", width=1, style=line.style_dotted, extend=extend.right)
line.set_xy1(l1, bar_index - 20, fast[20])
line.set_xy2(l1, bar_index, fast)
line.set_xy1(l2, bar_index - 20, slow[20])
line.set_xy2(l2, bar_index, slow)
var linefill f = linefill.new(l1, l2, color="rgba(59,130,246,0.18)")

// Table with merged header + tooltip
var table t = table.new(position.top_right, 3, 3, frame_color="#334155", border_color="#475569", text_color="#e2e8f0")
if barstate.islast
    table.clear(t, 0, 0, 2, 2)
    table.merge_cells(t, 0, 0, 2, 0)
    table.cell(t, 0, 0, "EMA Dashboard", text_halign=text.align_center, bgcolor="rgba(15,23,42,0.8)")
    table.cell(t, 0, 1, "Fast", tooltip="EMA 20 value")
    table.cell(t, 1, 1, fast)
    table.cell(t, 0, 2, "Slow", tooltip="EMA 50 value")
    table.cell(t, 1, 2, slow)`},{title:"Pine (pro) · Draw update/delete (set + delete)",code:`//@pine
//@version=5
indicator("Draw update/delete demo", overlay=true)

fast = ema(close, 20)
slow = ema(close, 50)

plot(fast, title="EMA 20", color="#22c55e", width=2)
plot(slow, title="EMA 50", color="#3b82f6", width=2, style="dashed")

// Update a single trend line every bar
var line trend = line.new(bar_index - 20, fast[20], bar_index, fast, color=color.orange, width=2, style=line.style_dashed)
line.set_xy1(trend, bar_index - 20, fast[20])
line.set_xy2(trend, bar_index, fast)
if fast > slow
    line.set_color(trend, color.green)
else
    line.set_color(trend, color.red)

// Update a rolling 10-bar box
hh = highest(high, 10)
ll = lowest(low, 10)
var box zone = box.new(bar_index - 10, hh, bar_index, ll, bgcolor="rgba(59,130,246,0.12)", border_color="#3b82f6")
box.set_left(zone, bar_index - 10)
box.set_right(zone, bar_index)
box.set_top(zone, hh)
box.set_bottom(zone, ll)

// Delete previous label, then create a new one (keeps only 1 label)
var label last = label.new(bar_index, low, "LAST", color=color.blue, textcolor=color.white, style=label.style_label_up)
label.delete(last)
last := label.new(bar_index, low, "LAST", color=color.blue, textcolor=color.white, style=label.style_label_up)
if fast > slow
    label.set_text(last, "UP")
else
    label.set_text(last, "DOWN")

// Update a small table on the last bar
var table t = table.new(position.top_right, 2, 2)
if barstate.islast
    table.cell(t, 0, 0, "Fast")
    table.cell(t, 1, 0, fast)
    table.cell(t, 0, 1, "Slow")
    table.cell(t, 1, 1, slow)`},{title:"Pine (pro) · Draw text align + yloc + table sizing",code:`//@pine
//@version=5
indicator("Draw extras", overlay=true)

fast = ema(close, 20)
slow = ema(close, 50)

plot(fast, title="EMA 20", color="#22c55e", width=2)
plot(slow, title="EMA 50", color="#3b82f6", width=2, style="dashed")

// yloc + textalign demo (single bar)
if barstate.islast
    label.new(bar_index, na, "ABOVE", yloc=yloc.abovebar, textalign=text.align_left, color=color.green, textcolor=color.white, style=label.style_label_up)
    label.new(bar_index, na, "BELOW", yloc=yloc.belowbar, textalign=text.align_right, color=color.red, textcolor=color.white, style=label.style_label_down)

// box text + border style
hh = highest(high, 8)
ll = lowest(low, 8)
var box zone = box.new(bar_index - 8, hh, bar_index, ll, bgcolor="rgba(59,130,246,0.12)", border_color="#3b82f6", border_style=line.style_dotted, text="ZONE", text_color="#e2e8f0", text_size=size.small, text_halign=text.align_center, text_valign=text.align_middle, text_wrap=true)
box.set_left(zone, bar_index - 8)
box.set_right(zone, bar_index)
box.set_top(zone, hh)
box.set_bottom(zone, ll)

// table sizing + align
var table t = table.new(position.top_right, 2, 2, frame_color="#334155", border_color="#475569", text_color="#e2e8f0", text_size=size.small, text_halign=text.align_left, text_valign=text.align_middle)
if barstate.islast
    table.cell(t, 0, 0, "Fast", text_halign=text.align_left, width=90)
    table.cell(t, 1, 0, fast, text_halign=text.align_right, width=70)
    table.cell(t, 0, 1, "Slow", text_halign=text.align_left, width=90)
    table.cell(t, 1, 1, slow, text_halign=text.align_right, width=70)`},{title:"Pine (pro) · Broker realism (tick/step/minQty) + SL/TP bracket",code:`//@pine
//@version=5
// Broker realism fields (optional):
// - priceTick: minimum price increment (e.g. 0.01)
// - qtyStep: quantity step (e.g. 1 for stocks)
// - minQty: minimum tradable quantity
// Edit these to match your market.
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="intrabar_ohlc", intrabarTieBreak="worst_case", allowShort=false, priceTick=0.01, qtyStep=1, minQty=1)

ema_fast_len = input.int(20, title="EMA Fast", minval=1)
ema_slow_len = input.int(50, title="EMA Slow", minval=2)
sl_pct = input.float(1.2, title="Stop %", minval=0.1, step=0.1)
tp_pct = input.float(2.4, title="TP %",   minval=0.1, step=0.1)

ema_fast = ema(close, ema_fast_len)
ema_slow = ema(close, ema_slow_len)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond = crossover(ema_fast, ema_slow)
exit_cond = crossunder(ema_fast, ema_slow)

plotshape(long_cond, text="BUY",  color=color.green,  location=location.belowbar, style=shape.triangleup)
plotshape(exit_cond, text="EXIT", color=color.orange, location=location.abovebar, style=shape.triangledown)

entry_px = close
sl_px = entry_px * (1 - sl_pct/100)
tp_px = entry_px * (1 + tp_pct/100)

plot(sl_px, title="SL", color="rgba(239,68,68,0.55)", width=1, style="dotted")
plot(tp_px, title="TP", color="rgba(34,197,94,0.55)", width=1, style="dotted")

strategy.entry("L", strategy.long, when=long_cond)
// This expands into stop + limit exits with OCO.
strategy.exit("BRKT", side="long", when=exit_cond, stop=sl_px, limit=tp_px, qty_percent=100)`},{title:"Pine (pro) · Broker realism v2 (spread/leverage/liquidation + FIFO/LIFO/AVG)",code:`//@pine
//@version=5
// Broker realism v2 fields (optional):
// - spreadPct: bid/ask spread in percent (0.05 = 0.05%)
// - leverage: position leverage (>= 1)
// - maintenanceMarginPct: liquidation if equity <= notional * maintenance%
// - liquidationFeePct: extra fee charged on liquidation exits
// - borrowPctPerYear: short borrow cost (annual %)
// - fundingPctPerDay: funding/interest cost (daily %)
// - positionMode: "netting" (default) or "hedging"
// - closeMethod: "fifo" (default), "lifo", or "avg" (average-cost)
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, spreadPct=0.05, leverage=5, maintenanceMarginPct=1.0, liquidationFeePct=0.2, borrowPctPerYear=6, fundingPctPerDay=0.01, positionMode="netting", closeMethod="fifo", pyramiding=1, execution="intrabar_ohlc", intrabarTieBreak="worst_case", allowShort=true)

fast_len = input.int(20, title="EMA Fast", minval=1)
slow_len = input.int(50, title="EMA Slow", minval=2)
atr_len  = input.int(14, title="ATR", minval=2)
sl_atr   = input.float(2.0, title="SL = ATR x",  minval=0.1, step=0.1)
tp_atr   = input.float(3.0, title="TP = ATR x",  minval=0.1, step=0.1)

ema_fast = ema(close, fast_len)
ema_slow = ema(close, slow_len)
atr_val  = atr(high, low, close, atr_len)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond  = crossover(ema_fast, ema_slow)
short_cond = crossunder(ema_fast, ema_slow)

plotshape(long_cond,  text="BUY",  color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(short_cond, text="SELL", color=color.red,   location=location.abovebar, style=shape.triangledown)

sl_long = close - (atr_val * sl_atr)
tp_long = close + (atr_val * tp_atr)
sl_short = close + (atr_val * sl_atr)
tp_short = close - (atr_val * tp_atr)

strategy.entry("L", strategy.long,  when=long_cond)
strategy.entry("S", strategy.short, when=short_cond)

// Intrabar exits (gap + best/worst case controlled by intrabarTieBreak)
strategy.exit("XL", side="long",  stop=sl_long,  limit=tp_long,  qty_percent=100)
strategy.exit("XS", side="short", stop=sl_short, limit=tp_short, qty_percent=100)`},{title:"Pine (pro) · request.security (HTF EMA filter) + BUY/SELL",code:`//@pine
//@version=5
// Shows both BUY (long) and SELL (short) entries.
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="bar_close", allowShort=true)

fast_len = input.int(20, title="EMA Fast", minval=1)
slow_len = input.int(50, title="EMA Slow", minval=2)
htf_tf   = input.string("240", title="HTF (minutes)")

ema_fast = ema(close, fast_len)
ema_slow = ema(close, slow_len)

// Higher-timeframe EMA (same symbol). lookahead_off = updates only after HTF bar closes.
ema_htf = request.security(syminfo.tickerid, htf_tf, ema(close, 50), lookahead=barmerge.lookahead_off, gaps=barmerge.gaps_off)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")
plot(ema_htf,  title="HTF EMA 50", color="#a78bfa", width=2)

long_cond  = crossover(ema_fast, ema_slow) and (close > ema_htf)
short_cond = crossunder(ema_fast, ema_slow) and (close < ema_htf)

exit_long  = crossunder(ema_fast, ema_slow)
exit_short = crossover(ema_fast, ema_slow)

plotshape(long_cond,  text="BUY",  color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(short_cond, text="SELL", color=color.red,   location=location.abovebar, style=shape.triangledown)

strategy.entry("L", strategy.long,  when=long_cond)
strategy.entry("S", strategy.short, when=short_cond)

strategy.exit("XL", side="long",  when=exit_long,  qty_percent=100)
strategy.exit("XS", side="short", when=exit_short, qty_percent=100)`},{title:"Pine (pro) · request.security (multi-symbol spread) · Z-score (more trades)",code:`//@pine
//@version=5
// Multi-symbol request.security demo.
// IMPORTANT: chart symbol (A) and sym_b (B) should be DIFFERENT.
// If A == B, spread ~ 0 and trades can be 0.
// Optional country: "TICKER@US" or country="US".
// Tip: if sub pane looks blank, reduce lookbk (e.g. 10).

strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="bar_close", allowShort=false)

sym_b   = input.string("AAMRANET", title="Symbol B (ticker OR name)")
htf_tf  = input.string("240", title="HTF (minutes)")
lookbk  = input.int(20, title="Z lookback", minval=5)

close_a = request.security(syminfo.tickerid, htf_tf, close, lookahead=barmerge.lookahead_off)
close_b = request.security(sym_b,            htf_tf, close, lookahead=barmerge.lookahead_off)

// Debug marker: shows "B" only when symbol B has valid data (needs Labels ON)
b_ok = close_b > 0
plotchar(b_ok, char="B", color="#a78bfa", location=location.abovebar, price=close, size=size.small)

spread = close_a - close_b
mu = sma(spread, lookbk)
sd = stdev(spread, lookbk)

// Z-score normalizes spread (so DSEX vs AAMRANET still works visually)
z = (spread - mu) / sd

// Put plots in sub pane so you can see them clearly
plot(z, title="Z-score (A-B)", color="#60a5fa", width=2, pane="sub")
hline(0, title="Zero", color="#64748b", pane="sub")

long_cond = crossover(z, 0)
exit_cond = crossunder(z, 0)

plotshape(long_cond, text="BUY",  color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(exit_cond, text="SELL", color=color.red,   location=location.abovebar, style=shape.triangledown)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · Trend+RSI filter + ATR bracket (partial TP + SL)",code:`//@pine
//@version=5
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="intrabar_ohlc", intrabarTieBreak="worst_case", allowShort=false)

ema_fast_len  = input.int(21,  title="EMA Fast",  minval=1)
ema_slow_len  = input.int(55,  title="EMA Slow",  minval=2)
ema_trend_len = input.int(200, title="EMA Trend", minval=10)

rsi_len = input.int(14,  title="RSI Length", minval=2)
rsi_min = input.float(52, title="RSI Min", minval=1, maxval=99, step=0.5)

atr_len  = input.int(14,  title="ATR Length", minval=2)
sl_atr   = input.float(2.0, title="SL = ATR x",  minval=0.1, step=0.1)
tp1_atr  = input.float(1.5, title="TP1 = ATR x", minval=0.1, step=0.1)
tp2_atr  = input.float(3.0, title="TP2 = ATR x", minval=0.1, step=0.1)

ema_fast  = ema(close, ema_fast_len)
ema_slow  = ema(close, ema_slow_len)
ema_trend = ema(close, ema_trend_len)

rsi_val = rsi(close, rsi_len)
atr_val = atr(high, low, close, atr_len)

plot(ema_fast,  title="EMA Fast",  color="#22c55e", width=2)
plot(ema_slow,  title="EMA Slow",  color="#3b82f6", width=2, style="dashed")
plot(ema_trend, title="EMA Trend", color="#94a3b8", width=2)

plot(rsi_val, title="RSI", color="#f59e0b", width=2, pane="sub")
hline(70, title="OB",  color="#ef4444", pane="sub")
hline(50, title="MID", color="#64748b", pane="sub")
hline(30, title="OS",  color="#22c55e", pane="sub")

long_cond = (close > ema_trend) and crossover(ema_fast, ema_slow) and (rsi_val > rsi_min)
exit_cond = crossunder(ema_fast, ema_slow)

plotshape(long_cond, text="BUY",  color=color.green,  location=location.belowbar, style=shape.triangleup)
plotshape(exit_cond, text="EXIT", color=color.orange, location=location.abovebar, style=shape.triangledown)

entry_px = close
sl_px  = entry_px - (atr_val * sl_atr)
tp1_px = entry_px + (atr_val * tp1_atr)
tp2_px = entry_px + (atr_val * tp2_atr)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("TP1", side="long", limit=tp1_px, qty_percent=50)
strategy.exit("BRKT", side="long", stop=sl_px, limit=tp2_px, qty_percent=100)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · plotchar + close_all (sub pane anchored)",code:`//@pine
//@version=5
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="bar_close", allowShort=false)

len = input.int(14, title="RSI Length", minval=2)
rsi_val = rsi(close, len)

plot(rsi_val, title="RSI", color="#f59e0b", width=2, pane="sub")
hline(70, title="OB", color="#ef4444", pane="sub")
hline(50, title="MID", color="#64748b", pane="sub")
hline(30, title="OS", color="#22c55e", pane="sub")

go_long = crossover(rsi_val, 50)
close_all = crossunder(rsi_val, 50)

// price=rsi_val anchors labels to RSI series (so sub pane never looks blank)
plotchar(go_long,   char="L", color="#22c55e", location=location.belowbar, pane="sub", price=rsi_val, size=size.large)
plotchar(close_all, char="X", color="#f59e0b", location=location.abovebar, pane="sub", price=rsi_val, size=size.large)

strategy.entry("L", strategy.long, when=go_long)
strategy.close_all(when=close_all)`},{title:"Simple · EMA 20 (main)",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#3b82f6", "width": 2 }
  ]
}`},{title:"Simple · Stochastic (sub)",code:`{
  "pane": "sub",
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "stoch", "type": "stoch", "kPeriod": 14, "dPeriod": 3 }
  ],
  "plots": [
    { "name": "%K", "source": "stoch_k", "color": "#1E90FF", "width": 2 },
    { "name": "%D", "source": "stoch_d", "color": "#FF1493", "width": 2, "style": "dashed" }
  ]
}`},{title:"EMA 20/50 cross labels",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema50", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema20 crossesAbove ema50", "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "ema20 crossesBelow ema50", "text": "SELL", "color": "#ef4444", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ]
}`},{title:"Drawing · Fibonacci + trendline (script)",code:`{
  "pane": "main",
  "overlays": [
    {
      "name": "fibonacciSegment",
      "points": [
        { "index": -120, "source": "low" },
        { "index": -20,  "source": "high" }
      ],
      "extendData": {
        "fibonacciLevels": [
          { "value": 0,     "color": "#64748b", "label": "0" },
          { "value": 0.382, "color": "#60a5fa", "label": "0.382" },
          { "value": 0.5,   "color": "#22c55e", "label": "0.5" },
          { "value": 0.618, "color": "#f59e0b", "label": "0.618" },
          { "value": 1,     "color": "#64748b", "label": "1" }
        ]
      }
    },
    {
      "name": "horizontalRayLine",
      "points": [
        { "index": -20, "source": "close" }
      ]
    },
    {
      "name": "note",
      "points": [
        { "index": -20, "source": "close" }
      ],
      "extendData": {
        "in_text": "SCRIPT NOTE",
        "in_color": "#22c55e",
        "line_color": "#22c55e"
      }
    }
  ]
}`},{title:"Strategy · Orders (market entry + partial exits)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 2,
    "allowShort": false
  },
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 },
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema50", "color": "#60a5fa", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema20 crossesAbove ema50", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "rsi14 crossesAbove 70",    "text": "TP 50%", "shape": "pill",               "color": "#16a34a", "position": "above", "source": "high" },
    { "when": "ema20 crossesBelow ema50", "text": "EXIT", "shape": "triangle_down_filled", "color": "#f59e0b", "position": "above", "source": "high" }
  ],
  "signals": [
    {
      "id": "ENTRY",
      "type": "entry_long",
      "when": "ema20 crossesAbove ema50",
      "order": { "kind": "market", "qtyPct": 100 }
    },
    {
      "id": "TP_PART",
      "type": "exit_long",
      "when": "rsi14 crossesAbove 70",
      "order": { "kind": "market", "qtyPct": 50 }
    },
    {
      "id": "EXIT_FULL",
      "type": "exit_long",
      "when": "(ema20 crossesBelow ema50) or (rsi14 crossesBelow 50)",
      "order": { "kind": "market", "qtyPct": 100 }
    }
  ]
}`},{title:"Strategy · Stop‑Limit entry (expiresBars)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "allowShort": false
  },
  "calc": [
    { "name": "dc",    "type": "donchian", "period": 20 },
    { "name": "atr14", "type": "atr", "period": 14 }
  ],
  "series": [
    { "name": "entry_stop",  "expr": "dc_upper" },
    { "name": "entry_limit", "expr": "add(dc_upper, mul(atr14, 0.05))" }
  ],
  "plots": [
    { "name": "DC Upper", "source": "dc_upper", "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "DC Lower", "source": "dc_lower", "color": "#ef4444", "width": 1, "style": "dashed" }
  ],
  "signals": [
    {
      "id": "BRK",
      "type": "entry_long",
      "when": "close crossesAbove dc_upper",
      "order": {
        "kind": "stop_limit",
        "stopPrice": "entry_stop",
        "limitPrice": "entry_limit",
        "expiresBars": 20
      }
    }
  ]
}`},{title:"Strategy · Smoke test (guaranteed trades)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "bar_close",
    "pyramiding": 1,
    "allowShort": false
  },
  "signals": [
    {
      "id": "ONE",
      "type": "entry_long",
      "when": "close > 0",
      "cooldownBars": 999999,
      "order": { "kind": "market", "qtyPct": 100 }
    }
  ]
}`},{title:"Strategy · Auto Fibonacci (pivot swing) 50% → 100%",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "allowShort": false
  },
  "calc": [
    {
      "name": "fibo",
      "type": "auto_fib",
      "method": "pivots",
      "pivotLeft": 3,
      "pivotRight": 3,
      "lookback": 400,
      "direction": "up",
      "draw": true
    }
  ],
  "plots": [
    { "name": "Fibo 50",  "source": "fibo_50",  "color": "rgba(34,197,94,0.9)", "width": 1, "style": "dotted" },
    { "name": "Fibo 100", "source": "fibo_100", "color": "rgba(148,163,184,0.9)", "width": 1, "style": "dashed" }
  ],
  "labels": [
    { "when": "between(fibo_50, low, high)",  "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "between(fibo_100, low, high)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "between(fibo_50, low, high)" },
    { "type": "exit_long",  "when": "between(fibo_100, low, high)" }
  ]
}`},{title:"Strategy · EMA cross backtest (SL/TP)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "stopLossPct": 1.5,
    "takeProfitPct": 3,
    "trailingStopPct": 1,
    "allowShort": false
  },
  "calc": [
    { "name": "ema_fast", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema_slow", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema_fast", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema_slow", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema_fast crossesAbove ema_slow", "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "ema_fast crossesBelow ema_slow", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "ema_fast crossesAbove ema_slow" },
    { "type": "exit_long",  "when": "ema_fast crossesBelow ema_slow" }
  ]
}`},{title:"RSI signals + backtest (sub)",code:`{
  "pane": "sub",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02
  },
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "RSI", "source": "rsi14", "color": "#60a5fa", "width": 2 }
  ],
  "levels": [
    { "name": "30", "value": 30, "color": "#64748b", "style": "dotted" },
    { "name": "50", "value": 50, "color": "#94a3b8" },
    { "name": "70", "value": 70, "color": "#64748b", "style": "dotted" }
  ],
  "labels": [
    { "when": "rsi14 crossesAbove 50", "text": "BUY",  "color": "#16a34a", "position": "above", "source": "rsi14", "shape": "pill", "textPadding": 10 },
    { "when": "rsi14 crossesBelow 50", "text": "SELL", "color": "#ef4444", "position": "below", "source": "rsi14", "shape": "pill", "textPadding": 10 }
  ],
  "signals": [
    { "type": "entry_long",  "when": "rsi14 crossesAbove 50" },
    { "type": "entry_short", "when": "rsi14 crossesBelow 50" }
  ]
}`},{title:"Bollinger basis glow",code:`{
  "pane": "main",
  "calc": [
    { "name": "bb", "type": "bbands", "source": "close", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "BB Glow", "source": "bb_mid", "type": "neon_line", "color": "rgba(0,255,255,0.35)", "width": 8 },
    { "name": "BB Core", "source": "bb_mid", "type": "line", "color": "#00ffff", "width": 2 }
  ]
}`},{title:"Full Bollinger with fill",code:`{
  "pane": "main",
  "calc": [
    { "name": "bb", "type": "bbands", "source": "close", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "Upper", "source": "bb_upper", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Lower", "source": "bb_lower", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Mid Glow", "source": "bb_mid", "type": "neon_line", "color": "rgba(0,255,255,0.30)", "width": 8 },
    { "name": "Mid", "source": "bb_mid", "type": "line", "color": "#00ffff", "width": 2 }
  ],
  "fills": [
    { "between": ["bb_upper", "bb_lower"], "color": "rgba(0,255,255,0.10)" }
  ]
}`},{title:"Shape · tags at swing",code:`{
  "pane": "main",
  "calc": [
    { "name": "ph", "type": "pivot_high", "left": 3, "right": 3 },
    { "name": "pl", "type": "pivot_low",  "left": 3, "right": 3 }
  ],
  "labels": [
    { "when": "swinghigh(3)", "text": "▲ HH", "color": "#ef4444", "position": "above", "source": "ph", "shape": "tag" },
    { "when": "swinglow(3)",  "text": "▼ LL", "color": "#22c55e", "position": "below", "source": "pl", "shape": "tag" }
  ]
}`},{title:"Box shape · engulfing",code:`{
  "pane": "main",
  "series": [
    { "name": "prevOpen",  "expr": "lag(open, 1)" },
    { "name": "prevClose", "expr": "lag(close, 1)" }
  ],
  "labels": [
    { "when": "(close>open) and (prevClose<prevOpen) and (close>=prevOpen) and (open<=prevClose)", "shape": "box", "boxMode": "wick", "bgColor": "rgba(59,130,246,0.25)", "borderColor": "#3b82f6", "text": "Bullish Engulfing", "position": "below", "source": "low",  "size": 2, "offsetY": 12 },
    { "when": "(close<open) and (prevClose>prevOpen) and (close<=prevOpen) and (open>=prevClose)", "shape": "box", "boxMode": "wick", "bgColor": "rgba(59,130,246,0.25)", "borderColor": "#3b82f6", "text": "Bearish Engulfing", "position": "above", "source": "high", "size": 2, "offsetY": 12 }
  ]
}`},{title:"Trendlines · auto",code:`{
  "pane": "main",
  "calc": [
    { "name": "ph", "type": "pivot_high", "left": 3, "right": 3 },
    { "name": "pl", "type": "pivot_low",  "left": 3, "right": 3 },
    { "name": "ph_prev", "type": "prev_value", "source": "ph" },
    { "name": "pl_prev", "type": "prev_value", "source": "pl" }
  ],
  "plots": [
    { "name": "PH", "source": "ph", "type": "dots", "color": "#ef4444", "width": 2 },
    { "name": "PL", "source": "pl", "type": "dots", "color": "#22c55e", "width": 2 }
  ],
  "lines": [
    { "name": "Down TL", "segmentsFrom": "ph", "color": "#64748b", "width": 1, "style": "dotted", "extend": "right", "maxSegments": 50 },
    { "name": "Up TL",   "segmentsFrom": "pl", "color": "#64748b", "width": 1, "style": "dotted", "extend": "right", "maxSegments": 50 }
  ],
  "labels": [
    { "when": "swinghigh(3)", "text": "▲ HH", "color": "#ef4444", "position": "above", "source": "ph", "shape": "tag" },
    { "when": "swinglow(3)",  "text": "▼ LL", "color": "#22c55e", "position": "below", "source": "pl", "shape": "tag" }
  ]
}`},{title:"Advanced · EMA200 pullback (backtest)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "trailingStopPct": 1.2,
    "allowShort": false
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "ema20",  "type": "ema", "source": "close", "period": 20 },
    { "name": "rsi14",  "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "EMA 20",  "source": "ema20",  "color": "#22c55e", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (rsi14 crossesAbove 35)", "text": "LONG", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" },
    { "when": "(rsi14 crossesAbove 55) or (close crossesBelow ema20)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "(close > ema200) and (rsi14 crossesAbove 35)" },
    { "type": "exit_long",  "when": "(rsi14 crossesAbove 55) or (close crossesBelow ema20)" }
  ]
}`},{title:"Advanced · Donchian breakout (backtest)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "stopLossPct": 2.2,
    "takeProfitPct": 4.5,
    "trailingStopPct": 1.4,
    "allowShort": false
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "dc", "type": "donchian", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "DC Upper", "source": "dc_upper", "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "DC Mid",   "source": "dc_mid",   "color": "#64748b", "width": 1, "style": "dotted" },
    { "name": "DC Lower", "source": "dc_lower", "color": "#ef4444", "width": 1, "style": "dashed" },
    { "name": "EMA 50",   "source": "ema50",   "color": "#60a5fa", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (close crossesAbove dc_upper)", "text": "BREAK", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" },
    { "when": "(close crossesBelow dc_mid) or (close crossesBelow ema50)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "(close > ema200) and (close crossesAbove dc_upper)" },
    { "type": "exit_long",  "when": "(close crossesBelow dc_mid) or (close crossesBelow ema50)" }
  ]
}`},{title:"Keltner channels + mid",code:`{
  "pane": "main",
  "calc": [
    { "name": "kc", "type": "keltner", "period": 20, "mult": 2 }
  ],
  "plots": [
    { "name": "KC Mid", "source": "kc_mid",    "color": "#22c55e", "width": 2 },
    { "name": "KC Up",  "source": "kc_upper",  "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "KC Low", "source": "kc_lower",  "color": "#22c55e", "width": 1, "style": "dashed" }
  ]
}`},{title:"ATR bands",code:`{
  "pane": "main",
  "calc": [
    { "name": "atrb", "type": "atr_bands", "period": 14, "mult": 2 }
  ],
  "plots": [
    { "name": "ATR Up",  "source": "atrb_upper", "color": "#94a3b8", "width": 1 },
    { "name": "ATR Low", "source": "atrb_lower", "color": "#94a3b8", "width": 1 }
  ]
}`},{title:"VWAP bands",code:`{
  "pane": "main",
  "calc": [
    { "name": "vb", "type": "vwap_bands", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "VWAP Mid", "source": "vb_mid",   "color": "#22c55e", "width": 2 },
    { "name": "VWAP Up",  "source": "vb_upper", "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "VWAP Low", "source": "vb_lower", "color": "#22c55e", "width": 1, "style": "dashed" }
  ]
}`},{title:"Stochastic cross + backtest (sub)",code:`{
  "pane": "sub",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02
  },
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "stoch", "type": "stoch", "kPeriod": 14, "dPeriod": 3 }
  ],
  "plots": [
    { "name": "%K", "source": "stoch_k", "color": "#1E90FF", "width": 2 },
    { "name": "%D", "source": "stoch_d", "color": "#FF1493", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "stoch_k crossesAbove stoch_d", "text": "K>D", "color": "#16a34a", "position": "above", "source": "stoch_k", "shape": "pill" },
    { "when": "stoch_k crossesBelow stoch_d", "text": "K<D", "color": "#ef4444", "position": "below", "source": "stoch_k", "shape": "pill" }
  ],
  "signals": [
    { "type": "entry_long",  "when": "stoch_k crossesAbove stoch_d" },
    { "type": "entry_short", "when": "stoch_k crossesBelow stoch_d" }
  ]
}`},{title:"Ichimoku cloud (core)",code:`{
  "pane": "main",
  "calc": [
    { "name": "ichimoku", "type": "ichimoku", "tenkan": 9, "kijun": 26, "senkouB": 52 }
  ],
  "plots": [
    { "name": "Tenkan", "source": "tenkan", "color": "#22c55e", "width": 1 },
    { "name": "Kijun",  "source": "kijun",  "color": "#ef4444", "width": 1 }
  ]
}`},{title:"Complex combo signals",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "ema50",  "type": "ema", "source": "close", "period": 50 },
    { "name": "ema20",  "type": "ema", "source": "close", "period": 20 },
    { "name": "macd",   "type": "macd", "source": "close", "fast": 12, "slow": 26, "signal": 9 },
    { "name": "rsi14",  "type": "rsi",  "source": "close", "period": 14 },
    { "name": "sar",    "type": "sar",  "step": 0.02, "max": 0.2 }
  ],
  "labels": [
    { "when": "(close>ema200) and (ema20>ema50) and (macd_line>macd_signal) and (rsi14>55) and (sar<close)", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "(close<ema200) and (ema20<ema50) and (macd_line<macd_signal) and (rsi14<45) and (sar>close)", "text": "SELL", "shape": "triangle_down_filled", "color": "#ef4444", "position": "above", "source": "high" }
  ]
}`},{title:"EMA cross filtered",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema_fast", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema_slow", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema_fast", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema_slow", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema_fast crossesAbove ema_slow and trend(up)",  "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "ema_fast crossesBelow ema_slow and trend(down)", "text": "SELL", "color": "#ef4444", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ]
}`}];try{const K=v.findIndex(Y=>String((Y==null?void 0:Y.title)||"").toLowerCase().includes("multi-symbol spread"));if(K>=0){const Y=v[K];let Z=String(Y.code||"");Z=Z.replace(/lookbk\s*=\s*input\.int\(\s*20\s*,/,"lookbk  = input.int(10,"),Z=Z.replace(/z\s*=\s*\(spread\s*-\s*mu\)\s*\/\s*sd/g,"z = (spread - mu) / nz(sd, 0.000001)"),v[K]={...Y,code:Z}}}catch{}const g=`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "allowShort": false
  },
  "calc": [
    { "name": "dc",    "type": "donchian", "period": 20 },
    { "name": "atr14", "type": "atr", "period": 14 }
  ],
  "series": [
    { "name": "dc_upper_prev", "expr": "lag(dc_upper, 1)" },
    { "name": "entry_stop",  "expr": "dc_upper_prev" },
    { "name": "entry_limit", "expr": "add(dc_upper_prev, mul(atr14, 0.05))" }
  ],
  "plots": [
    { "name": "DC Upper",      "source": "dc_upper",      "color": "#94a3b8", "width": 1, "style": "dashed" },
    { "name": "DC Upper prev", "source": "dc_upper_prev", "color": "#22c55e", "width": 2 },
    { "name": "DC Lower",      "source": "dc_lower",      "color": "#ef4444", "width": 1, "style": "dashed" }
  ],
  "signals": [
    {
      "id": "BRK",
      "type": "entry_long",
      "when": "high crossesAbove entry_stop",
      "order": {
        "kind": "stop_limit",
        "stopPrice": "entry_stop",
        "limitPrice": "entry_limit",
        "expiresBars": 20
      }
    }
  ]
}`,_=`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "stopLossPct": 2.2,
    "takeProfitPct": 4.5,
    "trailingStopPct": 1.4,
    "allowShort": false
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "dc", "type": "donchian", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "series": [
    { "name": "dc_upper_prev", "expr": "lag(dc_upper, 1)" },
    { "name": "dc_mid_prev",   "expr": "lag(dc_mid, 1)" }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "DC Upper", "source": "dc_upper", "color": "#60a5fa", "width": 1, "style": "dashed" },
    { "name": "DC Mid",   "source": "dc_mid",   "color": "#64748b", "width": 1, "style": "dotted" },
    { "name": "DC Lower", "source": "dc_lower", "color": "#ef4444", "width": 1, "style": "dashed" },
    { "name": "EMA 50",   "source": "ema50",   "color": "#22c55e", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (high crossesAbove dc_upper_prev)", "text": "BREAK", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" },
    { "when": "(close crossesBelow dc_mid_prev) or (close crossesBelow ema50)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "(close > ema200) and (high crossesAbove dc_upper_prev)" },
    { "type": "exit_long",  "when": "(close crossesBelow dc_mid_prev) or (close crossesBelow ema50)" }
  ]
}`,M=v.map(K=>K.title==="Strategy · Stop‑Limit entry (expiresBars)"?{...K,code:g}:K.title==="Advanced · Donchian breakout (backtest)"?{...K,code:_}:K).concat([{title:"Strategy · Bracket entry (SL/TP + partials)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "allowShort": false
  },
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema50", "color": "#60a5fa", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema20 crossesAbove ema50", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "ema20 crossesBelow ema50", "text": "EXIT", "shape": "triangle_down_filled", "color": "#f59e0b", "position": "above", "source": "high" }
  ],
  "signals": [
    {
      "id": "L",
      "type": "entry_long",
      "when": "ema20 crossesAbove ema50",
      "order": {
        "kind": "market",
        "qtyPct": 100,
        "bracket": {
          "stopLossPct": 1.2,
          "trailingStopPct": 0.9,
          "takeProfits": [
            { "takeProfitPct": 1.0, "qtyPct": 50 },
            { "takeProfitPct": 2.0, "qtyPct": 50 }
          ]
        }
      }
    },
    {
      "id": "X",
      "type": "exit_long",
      "when": "ema20 crossesBelow ema50",
      "order": { "kind": "market", "qtyPct": 100 }
    }
  ]
}`},{title:"Strategy · Intrabar pending entry (same‑bar exits)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "ohlc",
    "ohlcPath": "open_high_low_close",
    "pyramiding": 1,
    "allowShort": false
  },
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#60a5fa", "width": 2 }
  ],
  "labels": [
    { "when": "close > 0", "text": "STOP BUY (pending)", "shape": "tag", "color": "#64748b", "position": "above", "source": "high", "offsetY": -14 }
  ],
  "signals": [
    {
      "id": "PENDING_STOP",
      "type": "entry_long",
      "when": "close > 0",
      "cooldownBars": 999999,
      "order": {
        "kind": "stop",
        "price": "low",
        "bracket": {
          "stopLossPct": 0.25,
          "takeProfitPct": 0.35
        }
      }
    }
  ]
}`},{title:"Strategy · Donchian stop entry (lag + bracket)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "allowShort": false,
    "closeOnEnd": true
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "dc", "type": "donchian", "period": 20 }
  ],
  "series": [
    { "name": "dc_upper_prev", "expr": "lag(dc_upper, 1)" }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "DC Upper",      "source": "dc_upper",      "color": "#60a5fa", "width": 1, "style": "dashed" },
    { "name": "DC Upper prev", "source": "dc_upper_prev", "color": "#22c55e", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (high crossesAbove dc_upper_prev)", "text": "BREAK", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" }
  ],
  "signals": [
    {
      "id": "BRK_STOP",
      "type": "entry_long",
      "when": "(close > ema200) and (high crossesAbove dc_upper_prev)",
      "order": {
        "kind": "stop",
        "price": "dc_upper_prev",
        "qtyPct": 100,
        "bracket": {
          "stopLossPct": 1.2,
          "takeProfitPct": 2.4,
          "takeProfits": [{ "takeProfitPct": 1.2, "qtyPct": 50 }]
        }
      }
    }
  ]
}`},{title:"Pine (pro) · Functions + for loop + array.from (compile‑time)",code:`//@pine
//@version=5
// New Pine core (v1):
// - single-line functions: f(x)=>...
// - for-loops (compile-time unroll; body must be indented)
// - array.from + array.get (compile-time only)

upper(src, p, m) => sma(src, p) + (stdev(src, p) * m)
lower(src, p, m) => sma(src, p) - (stdev(src, p) * m)

p = input.int(20, title="Period")
m = input.float(2.0, title="Std", step=0.1)

basis = sma(close, p)
u = upper(close, p, m)
l = lower(close, p, m)

plot(basis, title="Basis", color="#94a3b8", width=2)
plot(u,     title="Upper", color="#22c55e", width=2)
plot(l,     title="Lower", color="#ef4444", width=2)

levels = array.from(30, 50, 70)
for i = 0 to 2
  hline(array.get(levels, i), title="RSI level", color="#64748b", style="dotted", pane="sub")

r = rsi(close, 14)
plot(r, title="RSI", color="#f59e0b", width=2, pane="sub")`}]),I=`WIN = 5
HIWIN = highest(close, WIN)
LOWIN = lowest(close, WIN)
signal top when (close == HIWIN)
signal bot when (close == LOWIN)
label at top text:"▲ fractal" color:#f97316
label at bot text:"▼ fractal" color:#3b82f6`,C=`{
  "pane": "main",
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#3b82f6", "width": 2, "style": "solid" }
  ]
}`,T=`{
  "pane": "main",
  "calc": [
    { "name": "ema_fast", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema_slow", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema_fast", "color": "#22c55e", "width": 2, "style": "solid" },
    { "name": "EMA 50", "source": "ema_slow", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ]
}`,z=`{
  "pane": "sub",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02
  },
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "RSI 14", "source": "rsi14", "color": "#60a5fa", "width": 2 }
  ],
  "levels": [
    { "name": "30", "value": 30, "color": "#64748b", "style": "dotted" },
    { "name": "50", "value": 50, "color": "#94a3b8" },
    { "name": "70", "value": 70, "color": "#64748b", "style": "dotted" }
  ],
  "labels": [
    { "when": "rsi14 crossesAbove 50", "text": "BUY",  "color": "#16a34a", "position": "above", "source": "rsi14", "shape": "pill", "textPadding": 10 },
    { "when": "rsi14 crossesBelow 50", "text": "SELL", "color": "#ef4444", "position": "below", "source": "rsi14", "shape": "pill", "textPadding": 10 }
  ],
  "signals": [
    { "type": "entry_long",  "when": "rsi14 crossesAbove 50" },
    { "type": "entry_short", "when": "rsi14 crossesBelow 50" }
  ]
}`,j=`{
  "pane": "main",
  "calc": [
    { "name": "bb", "type": "bbands", "source": "close", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "Upper", "source": "bb_upper", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Lower", "source": "bb_lower", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Mid Glow", "source": "bb_mid", "type": "neon_line", "color": "rgba(0,255,255,0.30)", "width": 8 },
    { "name": "Mid", "source": "bb_mid", "type": "line", "color": "#00ffff", "width": 2 }
  ],
  "fills": [
    { "between": ["bb_upper", "bb_lower"], "color": "rgba(0,255,255,0.10)" }
  ]
}`,B=`{
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "stoch", "type": "stoch", "kPeriod": 14, "dPeriod": 3 }
  ],
  "main": {
    "plots": [
      { "name": "EMA 20", "source": "ema20", "color": "#3b82f6", "width": 2, "style": "solid" }
    ]
  },
  "sub": {
    "min": 0,
    "max": 100,
    "plots": [
      { "name": "%K", "source": "stoch_k", "color": "#1E90FF", "width": 2, "style": "solid" },
      { "name": "%D", "source": "stoch_d", "color": "#FF1493", "width": 2, "style": "dashed" }
    ],
    "levels": [
      { "name": "OB", "value": 80, "color": "#f97316", "width": 1, "style": "dashed" },
      { "name": "OS", "value": 20, "color": "#22c55e", "width": 1, "style": "dashed" }
    ]
  }
}`,$=`{
  "pane": "main",
  "calc": [
    { "name": "ph_s", "type": "pivot_high", "left": 2, "right": 2 },
    { "name": "pl_s", "type": "pivot_low",  "left": 2, "right": 2 },
    { "name": "ph_m", "type": "pivot_high", "left": 5, "right": 5 },
    { "name": "pl_m", "type": "pivot_low",  "left": 5, "right": 5 },
    { "name": "ph_l", "type": "pivot_high", "left": 10, "right": 10 },
    { "name": "pl_l", "type": "pivot_low",  "left": 10, "right": 10 }
  ],
  "lines": [
    { "name": "Minor Down", "segmentsFrom": "ph_s", "color": "#fb7185", "width": 1,   "style": "dotted", "extend": "right", "maxSegments": 150 },
    { "name": "Minor Up",   "segmentsFrom": "pl_s", "color": "#86efac", "width": 1,   "style": "dotted", "extend": "right", "maxSegments": 150 },
    { "name": "Mid Down",   "segmentsFrom": "ph_m", "color": "#f97316", "width": 1.5, "style": "dashed", "extend": "right", "maxSegments": 100 },
    { "name": "Mid Up",     "segmentsFrom": "pl_m", "color": "#22d3ee", "width": 1.5, "style": "dashed", "extend": "right", "maxSegments": 100 },
    { "name": "Major Down", "segmentsFrom": "ph_l", "color": "#ef4444", "width": 2,   "style": "solid",  "extend": "both",  "maxSegments": 60 },
    { "name": "Major Up",   "segmentsFrom": "pl_l", "color": "#22c55e", "width": 2,   "style": "solid",  "extend": "both",  "maxSegments": 60 }
  ]
}`;Sp();var F=So(),V=Rt(F);Te(V,t,K=>{var Y=_G();Y.__click=[rG,a];var Z=m(Y),ne=m(Z),te=p(m(ne),2);te.__click=a,f(ne);var oe=p(ne,2),U=m(oe),J=m(U);J.__click=[aG,s];var se=p(J,2);se.__click=[lG,s],f(U);var W=p(U,2);Te(W,()=>n(s)==="details",le=>{var ye=vG(),Ce=m(ye),Re=p(m(Ce),2),Ke=m(Re);Ke.__click=[cG,i];var st=p(Ke,2);st.__click=[dG,i],f(Re),f(Ce);var vt=p(Ce,2);Te(vt,()=>n(i)==="bn",Je=>{var ot=uG(),nt=p(Rt(ot),10),tt=p(m(nt),2),Ze=m(tt);Ze.textContent=I,f(tt),f(nt);var ct=p(nt,2),Ge=p(m(ct),2),pt=m(Ge);pt.textContent=C,f(Ge),f(ct);var ce=p(ct,8),we=p(m(ce),2),ze=p(m(we));ze.textContent='{ index: -20, source: "high" }',pn(),f(we),pn(2),f(ce);var dt=p(ce,4),qe=p(m(dt),10),me=p(m(qe));me.textContent='{ "kind":"stop_limit", "stopPrice":"series", "limitPrice":"series" }',pn(3),f(qe),pn(8),f(dt);var Q=p(dt,10),it=p(m(Q),2),Vt=m(it);Vt.textContent=T,f(it),f(Q);var wt=p(Q,8),Yt=m(wt),At=p(m(Yt),2);At.textContent="${KEY}";var Gt=p(At,2);Gt.textContent="${TOL}",pn(),f(Yt);var no=p(Yt,2),Do=p(m(no));Do.textContent='"params": { "TOL": 0.0003 }';var Eo=p(Do,4);Eo.textContent="crossover(close, bb_mid, ${TOL})",f(no),pn(2),f(wt);var bs=p(wt,22),Is=p(m(bs),2),qi=m(Is);qi.textContent=z,f(Is),f(bs);var Ks=p(bs,4),ws=p(m(Ks),2),vn=m(ws);vn.textContent=$,f(ws),f(Ks);var es=p(Ks,2),Li=p(m(es),2),ci=m(Li);ci.textContent=j,f(Li),f(es);var oa=p(es,4),ol=p(m(oa),2),Xi=m(ol);Xi.textContent=B,f(ol),f(oa),pn(4),O(Je,ot)},Je=>{var ot=pG(),nt=p(Rt(ot),10),tt=p(m(nt),2),Ze=m(tt);Ze.textContent=I,f(tt),f(nt);var ct=p(nt,2),Ge=p(m(ct),2),pt=m(Ge);pt.textContent=C,f(Ge),f(ct);var ce=p(ct,12),we=p(m(ce),10),ze=p(m(we));ze.textContent='{ "kind":"stop_limit", "stopPrice":"series", "limitPrice":"series" }',pn(3),f(we),pn(14),f(ce);var dt=p(ce,6),qe=p(m(dt),2),me=m(qe);me.textContent=T,f(qe),f(dt);var Q=p(dt,8),it=m(Q),Vt=p(m(it),3);Vt.textContent="${KEY}";var wt=p(Vt,2);wt.textContent="${TOL}",pn(),f(it);var Yt=p(it,2),At=p(m(Yt));At.textContent='"params": { "TOL": 0.0003 }';var Gt=p(At,2);Gt.textContent="when: crossover(close, bb_mid, ${TOL})",f(Yt),pn(2),f(Q);var no=p(Q,26),Do=p(m(no),2),Eo=m(Do);Eo.textContent=z,f(Do),f(no);var bs=p(no,4),Is=p(m(bs),2),qi=m(Is);qi.textContent=$,f(Is),f(bs);var Ks=p(bs,2),ws=p(m(Ks),2),vn=m(ws);vn.textContent=j,f(ws),f(Ks);var es=p(Ks,4),Li=p(m(es),2),ci=m(Li);ci.textContent=B,f(Li),f(es),pn(4),O(Je,ot)}),f(ye),Se(()=>{Gn(Ke,`ss-lang-btn ${(n(i)==="bn"?"active":"")??""} svelte-50qv65`),Gn(st,`ss-lang-btn ${(n(i)==="en"?"active":"")??""} svelte-50qv65`)}),O(le,ye)},le=>{var ye=hG(),Ce=p(m(ye),2);Vs(Ce,1,()=>M,_n,(Re,Ke)=>{var st=gG(),vt=m(st),Je=m(vt),ot=m(Je,!0);f(Je);var nt=p(Je,2),tt=m(nt);tt.__click=[fG,d,Ke];var Ze=p(tt);Ze.__click=[mG,c,Ke],f(nt),f(vt);var ct=p(vt,2),Ge=m(ct),pt=m(Ge,!0);f(Ge),f(ct),f(st),Se(()=>{Ve(ot,n(Ke).title),Ve(pt,n(Ke).code)}),O(Re,st)}),f(ye),O(le,ye)}),f(oe),f(Z),f(Y),Se(()=>{Gn(J,`ss-tab ${(n(s)==="details"?"active":"")??""} svelte-50qv65`),Nt(J,"aria-selected",n(s)==="details"),Gn(se,`ss-tab ${(n(s)==="examples"?"active":"")??""} svelte-50qv65`),Nt(se,"aria-selected",n(s)==="examples")}),O(K,Y)}),O(o,F),Tc()}Hd(["click"]);const rw="scriptStudio.scripts";function bG(){try{const o=localStorage.getItem(rw);if(!o)return[];const e=JSON.parse(o);return Array.isArray(e)?e:[]}catch{return[]}}function xG(o){try{localStorage.setItem(rw,JSON.stringify(o))}catch{}}function wG(o,e,t){const s=bG(),i=Date.now(),a={id:`${i}`,name:o,code:e,tags:[],createdAt:i,updatedAt:i};return s.push(a),xG(s),a}const kG={signals:new Set,label:new Set};function z2(o,e){kG[o].forEach(t=>{try{t(e)}catch{}})}const q0=op({});function SG(o,e){q0.update(t=>({...t,[o]:e}))}function CG(o){return fp(q0)[o]||[]}const PG=q0;function IG(o){q0.update(e=>{const{[o]:t,...s}=e;return s})}function MG(){q0.set({})}const Nh=op({}),TG=Nh;function AG(o,e){const t={...e,_updatedAt:Date.now()};Nh.update(s=>({...s,[o]:t}))}function F2(o){Nh.update(e=>{const{[o]:t,...s}=e;return s})}function LG(){Nh.set({})}function Iu(o,e){const t=typeof o=="number"?o:Number(o);return Number.isFinite(t)?t:e}function $2(o,e="start"){if(o==null)return null;if(typeof o=="number"&&Number.isFinite(o))return o>1e12?Math.floor(o):Math.floor(o*1e3);const t=String(o).trim();if(!t)return null;if(/^\d+$/.test(t)){const r=Number(t);if(Number.isFinite(r))return r>1e12?Math.floor(r):Math.floor(r*1e3)}const s=t.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(s){const r=Number(s[1]),a=Number(s[2])-1,l=Number(s[3]);if([r,a,l].every(c=>Number.isFinite(c))){const c=Date.UTC(r,a,l);return Number.isFinite(c)?e==="end"?c+86399999:c:null}}const i=Date.parse(t);return Number.isFinite(i)?i:null}function zG(o){if(!o)return null;const e=String(o).trim();if(!e)return null;const t=e.match(/^(\d{2})(?::?(\d{2}))?\s*-\s*(\d{2})(?::?(\d{2}))?$/);if(!t)return null;const s=Number(t[1]),i=Number(t[2]||"0"),r=Number(t[3]),a=Number(t[4]||"0");return![s,i,r,a].every(l=>Number.isFinite(l))||s<0||s>23||r<0||r>23||i<0||i>59||a<0||a>59?null:{startMin:s*60+i,endMin:r*60+a}}function FG(o){if(o===!0)return{enabled:!0,execution:"intrabar_ohlc",intrabarTieBreak:"worst_case",ohlcPath:"open_high_low_close",initialCapital:1e4,fromTs:null,toTs:null,session:null,orderSize:{type:"percent_of_equity",value:100},commissionPct:0,slippagePct:0,priceTick:null,qtyStep:null,minQty:null,spreadPct:null,leverage:1,maintenanceMarginPct:null,liquidationFeePct:null,borrowPctPerYear:null,fundingPctPerDay:null,positionMode:"netting",closeMethod:"fifo",pyramiding:1,stopLossPct:null,takeProfitPct:null,takeProfits:[],trailingStopPct:null,maxDrawdownPct:null,maxDrawdownCash:null,maxPositionPct:null,maxPositionCash:null,maxPositionQty:null,maxIntradayFilledOrders:null,maxIntradayLossPct:null,maxIntradayLossCash:null,allowLong:!0,allowShort:!0,closeOnEnd:!0};if(!o||typeof o!="object")return null;const e=o;if(e.enabled===!1)return null;const t=String(e.execution||e.exec||e.mode||"").trim().toLowerCase()||"intrabar_ohlc",s=t==="bar_close"||t==="barclose"||t==="close"?"bar_close":"intrabar_ohlc",i=String(e.intrabarTieBreak||e.tieBreak||"").trim().toLowerCase(),r=i==="best_case"||i==="best"||i==="tp"?"best_case":i==="ohlc"||i==="path"?"ohlc":"worst_case",a=String(e.ohlcPath||e.path||"").trim().toLowerCase(),l=a==="open_low_high_close"||a==="olhc"?"open_low_high_close":"open_high_low_close",c=Math.max(0,Iu(e.initialCapital,1e4)),d=Math.max(0,Iu(e.commissionPct,0)),v=Math.max(0,Iu(e.slippagePct,0)),g=e.priceTick??e.price_tick??e.tickSize??e.tick_size??e.tick??e.minTick??e.min_tick??null,_=e.qtyStep??e.qty_step??e.quantityStep??e.quantity_step??e.lotStep??e.lot_step??null,y=e.minQty??e.min_qty??e.minimumQty??e.minimum_qty??null,k=g==null?null:Math.max(0,Iu(g,0)),S=_==null?null:Math.max(0,Iu(_,0)),M=y==null?null:Math.max(0,Iu(y,0)),I=e.spreadPct??e.spread_pct??e.spread??e.spreadBps??e.spread_bps??null,C=(()=>{if(I==null)return null;const At=Iu(I,0);return!Number.isFinite(At)||At<=0?null:"spreadBps"in e||"spread_bps"in e?At/100:At})(),T=e.leverage??e.lev??e.marginLeverage??e.margin_leverage??1,z=Math.max(1,Iu(T,1)),j=e.maintenanceMarginPct??e.maintenance_margin_pct??e.maintMarginPct??null,B=e.liquidationFeePct??e.liquidation_fee_pct??e.liqFeePct??null,$=e.borrowPctPerYear??e.borrow_pct_per_year??e.shortBorrowPctPerYear??null,F=e.fundingPctPerDay??e.funding_pct_per_day??e.funding??null,V=j==null?null:Math.max(0,Iu(j,0)),K=B==null?null:Math.max(0,Iu(B,0)),Y=$==null?null:Math.max(0,Iu($,0)),Z=F==null?null:Math.max(0,Iu(F,0)),ne=String(e.positionMode??e.position_mode??"").trim().toLowerCase(),te=ne==="hedge"||ne==="hedging"?"hedging":"netting",oe=String(e.closeMethod??e.close_method??e.costBasis??e.cost_basis??"").trim().toLowerCase(),U=oe==="lifo"?"lifo":oe==="avg"||oe==="average"?"avg":"fifo",J=Math.max(1,Math.min(50,Math.floor(Iu(e.pyramiding??e.maxEntries??e.max_positions??e.maxPositions??1,1)))),se=e.stopLossPct??e.slPct??e.sl??e.stopLoss??e.stop_loss??null,W=e.takeProfitPct??e.tpPct??e.tp??e.takeProfit??e.take_profit??null,le=e.trailingStopPct??e.trailPct??e.trailing??e.trailingStop??null,ye=se==null?null:Math.max(0,Iu(se,0)),Ce=W==null?null:Math.max(0,Iu(W,0)),Re=le==null?null:Math.max(0,Iu(le,0)),Ke=typeof e.allowLong=="boolean"?e.allowLong:e.allowLong!==!1,st=typeof e.allowShort=="boolean"?e.allowShort:e.allowShort!==!1,vt=typeof e.closeOnEnd=="boolean"?e.closeOnEnd:e.closeOnEnd!==!1,Je=$2(e.from??e.start??e.startDate??e.dateFrom??e.fromDate??e.rangeStart,"start")??null,ot=$2(e.to??e.end??e.endDate??e.dateTo??e.toDate??e.rangeEnd,"end")??null,nt=zG(e.session??e.tradingSession??e.sessionTime),tt=e.takeProfits??e.tpLevels??e.takeProfitLevels??[],Ze=[];if(Array.isArray(tt))for(const At of tt){if(!At||typeof At!="object")continue;const Gt=Iu(At.takeProfitPct??At.tpPct??At.pct,NaN),no=Iu(At.qtyPct??At.qty??At.percent,NaN);!Number.isFinite(Gt)||Gt<=0||!Number.isFinite(no)||no<=0||Ze.push({takeProfitPct:Gt,qtyPct:Math.max(0,Math.min(100,no))})}Ze.sort((At,Gt)=>At.takeProfitPct-Gt.takeProfitPct);const ct=e.risk&&typeof e.risk=="object"?e.risk:{},Ge=At=>{if(At==null)return null;const Gt=Iu(At,NaN);return Number.isFinite(Gt)?Gt:null},pt=Ge(e.maxDrawdownPct??e.max_drawdown_pct??ct.maxDrawdownPct??ct.max_drawdown_pct??ct.max_drawdown)??null,ce=Ge(e.maxDrawdownCash??e.max_drawdown_cash??ct.maxDrawdownCash??ct.max_drawdown_cash)??null,we=Ge(e.maxPositionPct??e.max_position_pct??ct.maxPositionPct??ct.max_position_pct??ct.max_position_size)??null,ze=Ge(e.maxPositionCash??e.max_position_cash??ct.maxPositionCash??ct.max_position_cash)??null,dt=Ge(e.maxPositionQty??e.max_position_qty??ct.maxPositionQty??ct.max_position_qty??ct.max_contracts)??null,qe=Ge(e.maxIntradayFilledOrders??e.max_intraday_filled_orders??ct.maxIntradayFilledOrders??ct.max_intraday_filled_orders)??null,me=Ge(e.maxIntradayLossPct??e.max_intraday_loss_pct??ct.maxIntradayLossPct??ct.max_intraday_loss_pct??ct.max_intraday_loss)??null,Q=Ge(e.maxIntradayLossCash??e.max_intraday_loss_cash??ct.maxIntradayLossCash??ct.max_intraday_loss_cash)??null;let it=0;const Vt=[];for(const At of Ze){if(it>=100)break;const Gt=100-it,no=Math.min(Gt,At.qtyPct);no<=0||(Vt.push({takeProfitPct:At.takeProfitPct,qtyPct:no}),it+=no)}const wt=e.orderSize??e.positionSize??e.order??null;let Yt={type:"percent_of_equity",value:100};if(wt&&typeof wt=="object"){const At=String(wt.type||"").trim().toLowerCase(),Gt=Iu(wt.value,100);At==="cash"?Yt={type:"cash",value:Math.max(0,Gt)}:At==="qty"?Yt={type:"qty",value:Math.max(0,Gt)}:At?Yt={type:"percent_of_equity",value:Math.max(0,Math.min(100,Gt))}:Yt={type:"percent_of_equity",value:Math.max(0,Math.min(100,Gt))}}else if(wt!=null){const At=Iu(wt,100);Yt={type:"percent_of_equity",value:Math.max(0,Math.min(100,At))}}return{enabled:!0,execution:s,intrabarTieBreak:r,ohlcPath:l,initialCapital:c,fromTs:Je,toTs:ot,session:nt,orderSize:Yt,commissionPct:d,slippagePct:v,priceTick:k&&k>0?k:null,qtyStep:S&&S>0?S:null,minQty:M&&M>0?M:null,spreadPct:C&&C>0?C:null,leverage:z,maintenanceMarginPct:V&&V>0?V:null,liquidationFeePct:K&&K>0?K:null,borrowPctPerYear:Y&&Y>0?Y:null,fundingPctPerDay:Z&&Z>0?Z:null,positionMode:te,closeMethod:U,pyramiding:J,stopLossPct:ye!=null&&ye>0?ye:null,takeProfitPct:Ce!=null&&Ce>0?Ce:null,takeProfits:Vt,trailingStopPct:Re!=null&&Re>0?Re:null,maxDrawdownPct:pt!=null&&pt>0?pt:null,maxDrawdownCash:ce!=null&&ce>0?ce:null,maxPositionPct:we!=null&&we>0?we:null,maxPositionCash:ze!=null&&ze>0?ze:null,maxPositionQty:dt!=null&&dt>0?dt:null,maxIntradayFilledOrders:qe!=null&&qe>0?Math.floor(qe):null,maxIntradayLossPct:me!=null&&me>0?me:null,maxIntradayLossCash:Q!=null&&Q>0?Q:null,allowLong:Ke,allowShort:st,closeOnEnd:vt}}function D2(o){return o==="cancel"||o==="cancel_all"?0:o==="exit_long"?1:o==="exit_short"?2:o==="entry_long"?3:o==="entry_short"?4:9}function gh(o){const e=o==null?void 0:o.close;return typeof e=="number"&&Number.isFinite(e)?e:null}function Z_(o){return typeof o=="number"&&Number.isFinite(o)?o:null}function $G(o){const e=gh(o);if(e==null)return null;const t=Z_(o==null?void 0:o.open)??e,s=Z_(o==null?void 0:o.high)??Math.max(t,e),i=Z_(o==null?void 0:o.low)??Math.min(t,e);return{o:t,h:s,l:i,c:e}}function DG(o,e,t){var gn,Wn,Tn,Ko,Qt;const s=t.initialCapital,i=t.commissionPct/100,r=t.slippagePct/100,a=t.priceTick&&t.priceTick>0?t.priceTick:null,l=t.qtyStep&&t.qtyStep>0?t.qtyStep:null,c=t.minQty&&t.minQty>0?t.minQty:null,d=t.spreadPct&&t.spreadPct>0?t.spreadPct/100:0,v=d>0?d/2:0,g=Math.max(1,Number(t.leverage)||1),_=t.maintenanceMarginPct&&t.maintenanceMarginPct>0?t.maintenanceMarginPct/100:null,y=t.liquidationFeePct&&t.liquidationFeePct>0?t.liquidationFeePct/100:null,k=t.borrowPctPerYear&&t.borrowPctPerYear>0?t.borrowPctPerYear/100:null,S=t.fundingPctPerDay&&t.fundingPctPerDay>0?t.fundingPctPerDay/100:null,M=t.maxDrawdownPct&&t.maxDrawdownPct>0?t.maxDrawdownPct/100:null,I=t.maxDrawdownCash&&t.maxDrawdownCash>0?t.maxDrawdownCash:null,C=t.maxPositionPct&&t.maxPositionPct>0?t.maxPositionPct/100:null,T=t.maxPositionCash&&t.maxPositionCash>0?t.maxPositionCash:null,z=t.maxPositionQty&&t.maxPositionQty>0?t.maxPositionQty:null,j=t.maxIntradayFilledOrders&&t.maxIntradayFilledOrders>0?Math.floor(t.maxIntradayFilledOrders):null,B=t.maxIntradayLossPct&&t.maxIntradayLossPct>0?t.maxIntradayLossPct/100:null,$=t.maxIntradayLossCash&&t.maxIntradayLossCash>0?t.maxIntradayLossCash:null,F=H=>{if(!Number.isFinite(H)||H<=0)return 0;const Me=String(H),Ue=Me.match(/e-(\d+)$/i);if(Ue)return Math.max(0,Math.min(12,Number(Ue[1])||0));const yt=Me.indexOf(".");return yt>=0?Math.max(0,Math.min(12,Me.length-yt-1)):0},V=(H,Me,Ue)=>{if(!Number.isFinite(H))return NaN;if(!Number.isFinite(Me)||Me<=0)return H;const yt=F(Me),St=Math.pow(10,yt),lo=Math.round(Me*St);if(!Number.isFinite(lo)||lo<=0)return H;const he=H*St;return(Ue==="ceil"?Math.ceil(he/lo-1e-12):Ue==="round"?Math.round(he/lo):Math.floor(he/lo+1e-12))*lo/St},K=(H,Me)=>l?V(H,l,Me):H,Y=(H,Me)=>H==="entry"?Me==="long":Me==="short",Z=(H,Me)=>v?Y(H,Me)?1+v:1-v:1,ne=(H,Me,Ue)=>{const yt=Z(Me,Ue);return yt===1?H:{o:H.o*yt,h:H.h*yt,l:H.l*yt,c:H.c*yt}},te=(H,Me,Ue,yt)=>{if(!a)return yt;const St=Y(H,Me);return V(yt,a,Ue==="limit"?St?"floor":"ceil":St?"ceil":"floor")},oe=(H,Me,Ue)=>{if(!a)return Ue;const St=Y(H,Me)?"ceil":"floor";return V(Ue,a,St)};let U=0,J=0;const se={long:[],short:[]},W=H=>se[H],le=H=>W(H).some(Me=>Me.qty>1e-12),ye=()=>le("long")||le("short"),Ce=H=>W(H).filter(Me=>Me.qty>1e-12).length,Re=H=>H==="long"?"short":"long",Ke=[],st=[],vt=[],Je=new Map;let ot=1;const nt=[],tt=()=>`o${ot++}`,Ze=H=>{var Ue;const Me=Number((Ue=o[H])==null?void 0:Ue.timestamp);return Number.isFinite(Me)&&Me>0?Me:Date.now()},ct=H=>{const Me=tt(),Ue={id:Me,...H};return vt.push(Ue),Je.set(Me,Ue),Ue},Ge=(H,Me)=>{if(!H)return;const Ue=Je.get(H);Ue&&Object.assign(Ue,Me)},pt=o.length,ce={initialCapital:s,finalEquity:s,netPnl:0,netPnlPct:0,grossProfit:0,grossLoss:0,profitFactor:0,trades:0,roundTrips:0,wins:0,losses:0,winRate:0,maxDrawdownPct:0,feesPaid:0,avgTrade:0,avgWin:0,avgLoss:0,payoffRatio:0,expectancy:0,maxConsecWins:0,maxConsecLosses:0,exposurePct:0,maxRunupPct:0,avgBarsInTrade:0,volatilityPct:0,sharpe:0,sortino:0,calmar:0};if(!pt)return{summary:ce,trades:[],roundTrips:[],orders:[],equity:[],benchmark:[]};const we=new Array(pt).fill(0),ze=new Array(pt).fill(0),dt=new Array(pt).fill(0),qe=new Array(pt).fill(0),me=new Array(pt).fill(0),Q=new Array(pt).fill(0),it=new Array(pt).fill(0),Vt=new Array(pt).fill(0),wt=new Array(pt).fill(0),Yt=new Array(pt).fill(0),At=new Array(pt).fill(0),Gt=new Array(pt).fill(0),no=new Array(pt).fill(s),Do=new Array(pt).fill(0);let Eo=0,bs=0,Is=0,qi=0,Ks=0,ws=0,vn="",es=s,Li=!1;const ci=t.fromTs!=null&&Number.isFinite(t.fromTs)?t.fromTs:null,oa=t.toTs!=null&&Number.isFinite(t.toTs)?t.toTs:null;let ol=0,Xi=pt-1;if(ci!=null){const H=o.findIndex(Me=>Number(Me==null?void 0:Me.timestamp)>=ci);if(H>=0)ol=H;else return{summary:ce,trades:[],roundTrips:[],orders:[],equity:[],benchmark:[]}}if(oa!=null){for(let H=pt-1;H>=0;H--){const Me=Number((gn=o[H])==null?void 0:gn.timestamp);if(Number.isFinite(Me)&&Me<=oa){Xi=H;break}}if(Xi<ol)return{summary:ce,trades:[],roundTrips:[],orders:[],equity:[],benchmark:[]}}const fc=t.session,rd=H=>{var he;if(!fc)return!0;const Me=Number((he=o[H])==null?void 0:he.timestamp);if(!Number.isFinite(Me)||Me<=0)return!0;const Ue=new Date(Me),yt=Ue.getUTCHours()*60+Ue.getUTCMinutes(),{startMin:St,endMin:lo}=fc;return St<=lo?yt>=St&&yt<=lo:yt>=St||yt<=lo},ml=(Array.isArray(e)?e:[]).filter(H=>typeof(H==null?void 0:H.index)=="number"&&H.index>=0).filter(H=>H.index>=ol&&H.index<=Xi).filter(H=>rd(H.index)).slice().sort((H,Me)=>H.index-Me.index||D2(H.type)-D2(Me.type));let Jl=0,Wl=s,sl=0,Uc=1;const Nl={long:null,short:null},Yc=(H,Me)=>{const Ue=Nl[H];if(Ue)return Ue;const yt={id:`t${Uc++}`,side:H,entryIndex:Me,entryTimestamp:Ze(Me),exitIndex:Me,exitTimestamp:Ze(Me),qtyEntered:0,entryNotional:0,qtyExited:0,exitNotional:0,grossPnl:0,fees:0,entries:0,exits:0};return Nl[H]=yt,yt},Ec=(H,Me)=>{if(le(H))return;const Ue=Nl[H];if(!Ue)return;const yt=Ue.qtyEntered,St=yt>0?Ue.entryNotional/yt:0,lo=Ue.qtyExited>0?Ue.exitNotional/Ue.qtyExited:0,he=Ue.entryNotional>0?Ue.grossPnl/Ue.entryNotional*100:0;st.push({id:Ue.id,side:Ue.side,entryIndex:Ue.entryIndex,entryTimestamp:Ue.entryTimestamp,exitIndex:Ue.exitIndex,exitTimestamp:Ue.exitTimestamp,qty:yt,avgEntryPrice:St,avgExitPrice:lo,grossPnl:Ue.grossPnl,fees:Ue.fees,netPnl:Ue.grossPnl-Ue.fees,pnlPct:he,entries:Ue.entries,exits:Ue.exits,maePct:typeof Ue.maeMin=="number"&&Number.isFinite(Ue.maeMin)?Ue.maeMin:void 0,mfePct:typeof Ue.mfeMax=="number"&&Number.isFinite(Ue.mfeMax)?Ue.mfeMax:void 0}),Nl[H]=null},Ja=(H,Me)=>{let Ue=0;for(const yt of W("long"))yt.qty<=0||(Ue+=(Me-yt.entryPrice)*yt.qty);for(const yt of W("short"))yt.qty<=0||(Ue+=(yt.entryPrice-Me)*yt.qty);return s+U+Ue-J},sa=H=>{let Me=0;for(const Ue of W("long"))Ue.qty<=0||(Me+=(H-Ue.entryPrice)*Ue.qty);for(const Ue of W("short"))Ue.qty<=0||(Me+=(Ue.entryPrice-H)*Ue.qty);return Number.isFinite(Me)?Me:0},jl=()=>{let H=0,Me=0,Ue=0,yt=0;for(const lo of W("long"))lo.qty<=0||(H+=lo.qty,Me+=lo.entryPrice*lo.qty);for(const lo of W("short"))lo.qty<=0||(Ue+=lo.qty,yt+=lo.entryPrice*lo.qty);const St=H-Ue;return St>0&&H>0?Me/H:St<0&&Ue>0?yt/Ue:0},Td=(H,Me)=>{if(t.orderSize.type==="cash")return Math.max(0,t.orderSize.value)*g;if(t.orderSize.type==="qty")return Math.max(0,t.orderSize.value*Me);const Ue=Math.max(0,Math.min(100,t.orderSize.value));return H*Ue/100*g},_d=()=>{let H=0;for(const Me of W("long"))H+=Me.qty>0?Me.entryNotional:0;for(const Me of W("short"))H+=Me.qty>0?Me.entryNotional:0;return H},Fl=()=>g>0?_d()/g:0,qa=H=>{const Me=Number(H);if(!Number.isFinite(Me)||Me<=0)return{long:0,short:0,total:0};let Ue=0,yt=0;for(const St of W("long"))Ue+=St.qty>0?St.qty*Me:0;for(const St of W("short"))yt+=St.qty>0?St.qty*Me:0;return{long:Ue,short:yt,total:Ue+yt}},td=(H,Me,Ue)=>{var fo,mo;if(!ye()||!k&&!S||H<=Ue)return;const yt=Number((fo=o[H-1])==null?void 0:fo.timestamp),St=Number((mo=o[H])==null?void 0:mo.timestamp);if(!Number.isFinite(yt)||!Number.isFinite(St)||St<=yt)return;const lo=St-yt,he=lo/864e5,ke=lo/(365*864e5);if(!Number.isFinite(he)||he<=0)return;const Ne=qa(Me);let ie=0,Ct=0;S&&(ie=Math.max(0,Ne.total*S*he)),k&&(Ct=Math.max(0,Ne.short*k*ke));const Kt=ie+Ct;if(!(!Number.isFinite(Kt)||Kt<=0)){if(J+=Kt,ie>0&&Ne.total>0){const Go=ie*Ne.long/Ne.total,Fo=ie-Go;Nl.long&&(Nl.long.fees+=Go),Nl.short&&(Nl.short.fees+=Fo)}Ct>0&&Nl.short&&(Nl.short.fees+=Ct)}},Nc=(H,Me,Ue)=>{if(!ye())return!1;const yt=Ze(H);let St=!1;for(const lo of["long","short"]){if(!le(lo))continue;const he=ct({action:"exit",side:lo,kind:"market",originalKind:"market",status:"pending",createdIndex:H,createdTimestamp:yt,activeFromIndex:H,qtyPct:100,price:Me,note:Ue}),ke=at(lo,H,Me,"liquidation","market",{orderId:he.id},y??void 0);ke?(Ge(he.id,{status:"filled",filledIndex:H,filledTimestamp:yt,fillPrice:ke.execPrice,fillQty:ke.qtyClosed,fees:ke.exitFees}),St=!0):Ge(he.id,{status:"rejected",note:`${Ue} (no fill)`})}if(St&&Mt.length){for(const lo of Mt)Ge(lo.orderId,{status:"canceled",note:"Canceled on liquidation"});Mt.length=0}return St},be=(H,Me)=>{if(!_||!ye())return!1;const Ue=Ne=>{const ie=Ja(H,Ne),Kt=qa(Ne).total*_;return{px:Ne,equityNow:ie,req:Kt,gap:ie-Kt}},yt=Ue(Me.l),St=Ue(Me.h),lo=Number.isFinite(yt.gap)&&yt.gap<=1e-9,he=Number.isFinite(St.gap)&&St.gap<=1e-9;if(!lo&&!he)return!1;const ke=lo&&he?yt.gap<=St.gap?yt:St:lo?yt:St;return Nc(H,ke.px,"AUTO liquidation")},We=(H,Me,Ue)=>{if(Ue==="limit")return oe("entry",H,Me);const yt=Me*Z("entry",H),St=H==="long"?yt*(1+r):yt*(1-r);return oe("entry",H,St)},de=(H,Me,Ue)=>{if(Ue==="limit")return oe("exit",H,Me);const yt=Me*Z("exit",H),St=H==="long"?yt*(1-r):yt*(1+r);return oe("exit",H,St)},De=H=>{if(!H||typeof H!="object")return;const Me=ie=>{const Ct=typeof ie=="number"?ie:Number(ie);return Number.isFinite(Ct)?Ct:void 0},Ue=Me(H.stopLossPct),yt=Me(H.takeProfitPct),St=Me(H.trailingStopPct),lo=H.takeProfits,he=[];if(Array.isArray(lo))for(const ie of lo){if(!ie||typeof ie!="object")continue;const Ct=Me(ie.takeProfitPct),Kt=Me(ie.qtyPct);Ct==null||Ct<=0||Kt==null||Kt<=0||he.push({takeProfitPct:Math.max(0,Ct),qtyPct:Math.max(0,Math.min(100,Kt))})}he.sort((ie,Ct)=>ie.takeProfitPct-Ct.takeProfitPct);let ke=0;const Ne=[];for(const ie of he){if(ke>=100)break;const Ct=100-ke,Kt=Math.min(Ct,ie.qtyPct);Kt<=0||(Ne.push({takeProfitPct:ie.takeProfitPct,qtyPct:Kt}),ke+=Kt)}if(!(Ue==null&&yt==null&&St==null&&Ne.length===0))return{stopLossPct:Ue,takeProfitPct:yt,trailingStopPct:St,takeProfits:Ne.length?Ne:void 0}},Ee=(H,Me,Ue,yt=100,St="market",lo,he,ke)=>{var dl,cr,Br;if(t.positionMode==="netting"&&le(Re(H)))return{ok:!1,reject:"Netting mode: opposite position open"};if(Li)return{ok:!1,reject:"Risk limit reached"};if(j!=null&&ws>=j)return{ok:!1,reject:"Max intraday filled orders reached"};if(Ce(H)>=t.pyramiding)return{ok:!1,reject:`Pyramiding limit reached (${t.pyramiding})`};const Ne=Ja(Me,Ue),ie=We(H,Ue,St);if(!Number.isFinite(ie)||ie<=0)return{ok:!1,reject:"Invalid fill price"};const Ct=ke&&typeof ke.qty=="number"&&Number.isFinite(ke.qty)?Math.abs(ke.qty):null,Kt=ke&&typeof ke.cash=="number"&&Number.isFinite(ke.cash)?Math.abs(ke.cash):null;let fo=0;if(Ct!=null)fo=Ct;else if(Kt!=null)fo=Kt*g/ie;else{const Fi=Number.isFinite(yt)?Math.max(0,Math.min(100,yt)):100;if(Fi<=0)return{ok:!1,reject:"qtyPct <= 0"};const fr=Td(Ne,ie)*Fi/100;if(!Number.isFinite(fr)||fr<=0)return{ok:!1,reject:"Notional <= 0"};fo=fr/ie}if(!Number.isFinite(fo)||fo<=0)return{ok:!1,reject:"Qty <= 0"};const mo=K(fo,"floor");if(!Number.isFinite(mo)||mo<=0)return l?{ok:!1,reject:`Qty rounded to 0 (qtyStep=${l})`}:{ok:!1,reject:"Qty <= 0"};if(c!=null&&mo<c)return{ok:!1,reject:`Qty ${mo} < minQty ${c}`};if(z!=null&&jt(H)+mo>z)return{ok:!1,reject:"Max position qty exceeded"};if(T!=null&&qa(ie)[H]+mo*ie>T)return{ok:!1,reject:"Max position cash exceeded"};if(C!=null&&C>0){const fr=qa(ie)[H]+mo*ie,gl=Ne*C;if(gl>0&&fr>gl)return{ok:!1,reject:"Max position percent exceeded"}}const Go=ie*mo,Fo=g>0?Go/g:Go,Wo=Fl();if(Fo>0&&Wo+Fo>Ne+1e-9)return{ok:!1,reject:"Insufficient margin"};const us=Go*i;J+=us;{const Fi=Yc(H,Me);Fi.qtyEntered+=mo,Fi.entryNotional+=Go,Fi.fees+=us,Fi.entries+=1}const Un=t.closeMethod==="avg"?void 0:De(lo),or=(Un==null?void 0:Un.stopLossPct)!=null?Un.stopLossPct:t.stopLossPct,$s=(Un==null?void 0:Un.takeProfitPct)!=null?Un.takeProfitPct:t.takeProfitPct,gi=(Un==null?void 0:Un.trailingStopPct)!=null?Un.trailingStopPct:t.trailingStopPct,kn=or&&or>0?H==="long"?ie*(1-or/100):ie*(1+or/100):null,_r=$s&&$s>0?H==="long"?ie*(1+$s/100):ie*(1-$s/100):null,Kr=kn!=null&&Number.isFinite(kn)?te("exit",H,"stop",kn):null,Ul=_r!=null&&Number.isFinite(_r)?te("exit",H,"limit",_r):null,wa={side:H,qty:mo,entryIndex:Me,entryTimestamp:((dl=o[Me])==null?void 0:dl.timestamp)??Date.now(),entryPrice:ie,entrySignalId:he==null?void 0:he.signalId,entryOrderId:he==null?void 0:he.orderId,entryNotional:Go,entryFee:us,entryFeeRemaining:us,stopPrice:Kr&&Number.isFinite(Kr)?Kr:null,takePrice:Ul&&Number.isFinite(Ul)?Ul:null,trailingPct:gi,trailingStop:gi&&gi>0?H==="long"?te("exit",H,"stop",ie*(1-gi/100)):te("exit",H,"stop",ie*(1+gi/100)):null,takeProfitOrders:[],maxFav:ie,maxAdv:ie},wl=(cr=Un==null?void 0:Un.takeProfits)!=null&&cr.length?Un.takeProfits:t.takeProfits;if(wl!=null&&wl.length){const Fi=[];let fr=0;for(const gl of wl){if(fr>=mo)break;const Gs=Math.max(0,Math.min(mo-fr,mo*gl.qtyPct/100)),Ql=K(Gs,"floor");if(!Number.isFinite(Ql)||Ql<=0||c!=null&&Ql<c&&Ql<mo-fr-1e-12)continue;const ia=H==="long"?ie*(1+gl.takeProfitPct/100):ie*(1-gl.takeProfitPct/100),jd=te("exit",H,"limit",ia);!Number.isFinite(jd)||jd<=0||(Fi.push({price:jd,qty:Ql,pct:gl.takeProfitPct}),fr+=Ql)}wa.takeProfitOrders=Fi.sort((gl,Gs)=>H==="long"?gl.price-Gs.price:Gs.price-gl.price)}ws+=1;const Cl=W(H);if(t.closeMethod==="avg"&&Cl.length){const Fi=Cl[0],fr=Fi.qty+wa.qty,gl=Fi.entryNotional+wa.entryNotional,Gs=fr>0?gl/fr:Fi.entryPrice;Fi.qty=fr,Fi.entryNotional=gl,Fi.entryPrice=Gs,Fi.entryFee+=wa.entryFee,Fi.entryFeeRemaining+=wa.entryFeeRemaining;const Ql=t.stopLossPct,ia=t.takeProfitPct,jd=t.trailingStopPct,xu=Ql&&Ql>0?H==="long"?Gs*(1-Ql/100):Gs*(1+Ql/100):null,ip=ia&&ia>0?H==="long"?Gs*(1+ia/100):Gs*(1-ia/100):null;if(Fi.stopPrice=xu!=null&&Number.isFinite(xu)?te("exit",H,"stop",xu):null,Fi.takePrice=ip!=null&&Number.isFinite(ip)?te("exit",H,"limit",ip):null,Fi.trailingPct=jd,Fi.trailingStop=jd&&jd>0?H==="long"?te("exit",H,"stop",Gs*(1-jd/100)):te("exit",H,"stop",Gs*(1+jd/100)):null,Fi.takeProfitOrders=[],(Br=t.takeProfits)!=null&&Br.length){const $p=[];let Wp=0;for(const Yu of t.takeProfits){if(Wp>=Fi.qty)break;const Lu=Math.max(0,Math.min(Fi.qty-Wp,Fi.qty*Yu.qtyPct/100)),Cp=K(Lu,"floor");if(!Number.isFinite(Cp)||Cp<=0)continue;const Sv=H==="long"?Gs*(1+Yu.takeProfitPct/100):Gs*(1-Yu.takeProfitPct/100),rp=te("exit",H,"limit",Sv);!Number.isFinite(rp)||rp<=0||($p.push({price:rp,qty:Cp,pct:Yu.takeProfitPct}),Wp+=Cp)}Fi.takeProfitOrders=$p.sort((Yu,Lu)=>H==="long"?Yu.price-Lu.price:Lu.price-Yu.price)}return Fi.maxFav=Fi.maxFav==null?Gs:Fi.maxFav,Fi.maxAdv=Fi.maxAdv==null?Gs:Fi.maxAdv,{ok:!0,lot:Fi}}return Cl.push(wa),{ok:!0,lot:wa}},xe=(H,Me,Ue,yt,St)=>{const lo=jt(H);if(!Number.isFinite(lo)||lo<=0)return 0;if(yt!=null&&Number.isFinite(yt)){const ke=Math.abs(yt);return ke>0?Math.min(lo,ke):0}if(St!=null&&Number.isFinite(St)){const ke=Math.abs(St);if(ke<=0||!Number.isFinite(Me)||Me<=0)return 0;const ie=(g>0?ke*g:ke)/Me;return Number.isFinite(ie)&&ie>0?Math.min(lo,ie):0}const he=Number.isFinite(Ue)?Math.max(0,Math.min(100,Ue)):100;return he<=0?0:lo*he/100},gt=(H,Me,Ue,yt="signal",St,lo="market",he,ke)=>{var gi;const Ne=H.side;l&&(H.qty=K(H.qty,"round"));const ie=de(Ne,Ue,lo);if(!Number.isFinite(ie)||ie<=0)return null;const Ct=H.qty,Kt=St==null?Ct:Math.max(0,Math.min(Ct,St)),fo=St==null?l?K(Kt,"round"):Kt:l?K(Kt,"floor"):Kt;if(!Number.isFinite(fo)||fo<=0||c!=null&&St!=null&&fo<c&&fo<Ct-1e-12)return null;const mo=Ct>0&&Number.isFinite(H.entryFeeRemaining)?H.entryFeeRemaining*fo/Ct:0,Go=ie*fo,Fo=Go*i,Wo=ke&&ke>0?Go*ke:0;J+=Fo,J+=Wo;const us=Ne==="long"?(ie-H.entryPrice)*fo:(H.entryPrice-ie)*fo;U+=us;{const kn=Yc(Ne,H.entryIndex);kn.qtyExited+=fo,kn.exitNotional+=Go,kn.grossPnl+=us,kn.fees+=mo+Fo+Wo,kn.exits+=1,kn.exitIndex=Me,kn.exitTimestamp=Ze(Me)}const Un=Number.isFinite(H.entryPrice)&&H.entryPrice>0?H.entryPrice*fo:NaN,or=(()=>{if(!(H.entryPrice<=0)&&!(H.maxAdv==null||!Number.isFinite(H.maxAdv)))return H.side==="long"?(H.maxAdv-H.entryPrice)/H.entryPrice*100:(H.entryPrice-H.maxAdv)/H.entryPrice*100})(),$s=(()=>{if(!(H.entryPrice<=0)&&!(H.maxFav==null||!Number.isFinite(H.maxFav)))return H.side==="long"?(H.maxFav-H.entryPrice)/H.entryPrice*100:(H.entryPrice-H.maxFav)/H.entryPrice*100})();Ke.push({side:Ne,qty:fo,entryIndex:H.entryIndex,entryTimestamp:H.entryTimestamp,entryPrice:H.entryPrice,entrySignalId:H.entrySignalId,entryOrderId:H.entryOrderId,exitIndex:Me,exitTimestamp:((gi=o[Me])==null?void 0:gi.timestamp)??Date.now(),exitPrice:ie,exitSignalId:he==null?void 0:he.signalId,exitOrderId:he==null?void 0:he.orderId,exitReason:yt,pnl:us,pnlPct:Number.isFinite(Un)&&Un>0?us/Un*100:0,fees:mo+Fo+Wo,maePct:typeof or=="number"&&Number.isFinite(or)?or:void 0,mfePct:typeof $s=="number"&&Number.isFinite($s)?$s:void 0}),Eo+=mo+Fo+Wo,us>0?(bs+=us,qi+=1):us<0&&(Is+=Math.abs(us),Ks+=1);try{const kn=Nl[Ne];typeof or=="number"&&Number.isFinite(or)&&kn&&(kn.maeMin=kn.maeMin==null?or:Math.min(kn.maeMin,or)),typeof $s=="number"&&Number.isFinite($s)&&kn&&(kn.mfeMax=kn.mfeMax==null?$s:Math.max(kn.mfeMax,$s))}catch{}return H.qty-=fo,l&&(H.qty=K(H.qty,"round")),H.entryFeeRemaining=Math.max(0,H.entryFeeRemaining-mo),H.qty<=1e-12&&(H.entryFeeRemaining=0),{qtyClosed:fo,fees:mo+Fo+Wo,exitFee:Fo+Wo,execPrice:ie}},at=(H,Me,Ue,yt="signal",St="market",lo,he)=>{const ke=W(H);if(!ke.length)return null;const Ne=ke.slice();let ie=0,Ct=0,Kt=0,fo=0;for(const mo of Ne)if(mo.qty>0){const Go=gt(mo,Me,Ue,yt,mo.qty,St,lo,he);Go&&(ie+=Go.qtyClosed,Ct+=Go.fees,Kt+=Go.exitFee,fo+=Go.execPrice*Go.qtyClosed)}return se[H]=W(H).filter(mo=>mo.qty>1e-12),Ec(H),ie<=0?null:{qtyClosed:ie,fees:Ct,exitFees:Kt,execPrice:fo/ie}},jt=H=>{const Me=W(H);return Me.length?Me.reduce((Ue,yt)=>Ue+(yt.qty>0?yt.qty:0),0):0},Lt=(H,Me,Ue,yt,St="signal",lo="market",he,ke)=>{const Ne=W(H);if(!Ne.length)return null;let ie=Math.max(0,yt),Ct=0,Kt=0,fo=0,mo=0;const Go=t.closeMethod==="lifo"?Ne.slice().reverse():Ne;for(const Fo of Go){if(ie<=0)break;if(Fo.qty<=0)continue;const Wo=Math.min(Fo.qty,ie),us=gt(Fo,Me,Ue,St,Wo,lo,he,ke);us&&(Ct+=us.qtyClosed,Kt+=us.fees,fo+=us.exitFee,mo+=us.execPrice*us.qtyClosed),ie-=Wo}return se[H]=W(H).filter(Fo=>Fo.qty>1e-12),Ec(H),Ct<=0?null:{qtyClosed:Ct,fees:Kt,exitFees:fo,execPrice:mo/Ct}},Mt=[],Io=(H,Me)=>{for(let Ue=Mt.length-1;Ue>=0;Ue--){const yt=Mt[Ue];H(yt)&&(Ge(yt.orderId,{status:"canceled",note:Me}),Mt.splice(Ue,1))}},Bo=(H,Me)=>{if(!H)return;const Ue=String(H).trim();Ue&&Io(yt=>String(yt.signalId||"")===Ue||String(yt.orderId||"")===Ue,Me)},hs=H=>{Io(()=>!0,H)},is=H=>(H==null?void 0:H.order)||{},Es=H=>{const Me=typeof H=="number"?H:Number(H);return!Number.isFinite(Me)||Me<=0?100:Math.max(0,Math.min(100,Me))},bt=H=>{const Me=String(H||"market").trim().toLowerCase();return Me==="limit"?"limit":Me==="stop"?"stop":"market"},kt=(H,Me,Ue,yt,St)=>Number.isFinite(St)?H==="entry"?Me==="long"?Ue==="limit"?yt.l<=St:yt.h>=St:Ue==="limit"?yt.h>=St:yt.l<=St:Me==="long"?Ue==="limit"?yt.h>=St:yt.l<=St:Ue==="limit"?yt.l<=St:yt.h>=St:!1,xo=(H,Me,Ue)=>{for(const yt of Ue)H.side==="long"?yt==="high"?H.maxFav=H.maxFav==null?Me.h:Math.max(H.maxFav,Me.h):H.maxAdv=H.maxAdv==null?Me.l:Math.min(H.maxAdv,Me.l):yt==="low"?H.maxFav=H.maxFav==null?Me.l:Math.min(H.maxFav,Me.l):H.maxAdv=H.maxAdv==null?Me.h:Math.max(H.maxAdv,Me.h)},$t=H=>t.intrabarTieBreak==="ohlc"?t.ohlcPath==="open_high_low_close"?["high","low"]:["low","high"]:t.intrabarTieBreak==="best_case"?H==="long"?["high","low"]:["low","high"]:H==="long"?["low","high"]:["high","low"],_o=H=>{const{lot:Me,i:Ue,triggerPx:yt,reason:St,qty:lo,fillKind:he,note:ke}=H;if(!Number.isFinite(yt)||yt<=0||!Number.isFinite(lo)||lo<=0)return!1;const Ne=he==="limit"?"limit":"stop",ie=Ze(Ue),Ct=ct({action:"exit",side:Me.side,kind:Ne,originalKind:Ne,status:"pending",createdIndex:Ue,createdTimestamp:ie,activeFromIndex:Ue,qtyPct:100,price:yt,note:ke}),Kt=gt(Me,Ue,yt,St,lo,he,{orderId:Ct.id});return Kt?(Ge(Ct.id,{status:"filled",filledIndex:Ue,filledTimestamp:ie,fillPrice:Kt.execPrice,fillQty:Kt.qtyClosed,fees:Kt.exitFee,note:ke}),!0):(Ge(Ct.id,{status:"rejected",note:`${ke} (no fill)`}),!1)},go=(H,Me,Ue,yt)=>{if(!le(H)||t.execution!=="intrabar_ohlc")return!1;let St=!1;const lo=he=>{var ke,Ne;for(const ie of W(H)){if(ie.qty<=0)continue;const Ct=ne(Ue,"exit",ie.side);if(ie.trailingPct&&ie.trailingPct>0){const Kt=ie.trailingPct/100;if(ie.side==="long"&&he==="high"){const fo=Ue.h*(1-Kt);ie.trailingStop=ie.trailingStop==null?fo:Math.max(ie.trailingStop,fo)}if(ie.side==="short"&&he==="low"){const fo=Ue.l*(1+Kt);ie.trailingStop=ie.trailingStop==null?fo:Math.min(ie.trailingStop,fo)}}if(ie.side==="long"&&he==="high"){if((ke=ie.takeProfitOrders)!=null&&ke.length){const Kt=[];for(const fo of ie.takeProfitOrders){if(ie.qty<=0)break;Ct.h>=fo.price?St=_o({lot:ie,i:Me,triggerPx:fo.price,reason:"take_profit",qty:fo.qty,fillKind:"limit",note:`AUTO take_profit (${fo.pct}%)`})||St:Kt.push(fo)}ie.takeProfitOrders=Kt}ie.takePrice!=null&&Ct.h>=ie.takePrice&&ie.qty>0&&(St=_o({lot:ie,i:Me,triggerPx:ie.takePrice,reason:"take_profit",qty:ie.qty,fillKind:"limit",note:"AUTO take_profit"})||St)}if(ie.side==="short"&&he==="low"){if((Ne=ie.takeProfitOrders)!=null&&Ne.length){const Kt=[];for(const fo of ie.takeProfitOrders){if(ie.qty<=0)break;Ct.l<=fo.price?St=_o({lot:ie,i:Me,triggerPx:fo.price,reason:"take_profit",qty:fo.qty,fillKind:"limit",note:`AUTO take_profit (${fo.pct}%)`})||St:Kt.push(fo)}ie.takeProfitOrders=Kt}ie.takePrice!=null&&Ct.l<=ie.takePrice&&ie.qty>0&&(St=_o({lot:ie,i:Me,triggerPx:ie.takePrice,reason:"take_profit",qty:ie.qty,fillKind:"limit",note:"AUTO take_profit"})||St)}if(ie.side==="long"&&he==="low"){if(ie.stopPrice!=null&&Ct.l<=ie.stopPrice){St=_o({lot:ie,i:Me,triggerPx:ie.stopPrice,reason:"stop_loss",qty:ie.qty,fillKind:"stop",note:"AUTO stop_loss"})||St;continue}ie.trailingStop!=null&&Ct.l<=ie.trailingStop&&(St=_o({lot:ie,i:Me,triggerPx:ie.trailingStop,reason:"trailing_stop",qty:ie.qty,fillKind:"stop",note:"AUTO trailing_stop"})||St)}if(ie.side==="short"&&he==="high"){if(ie.stopPrice!=null&&Ct.h>=ie.stopPrice){St=_o({lot:ie,i:Me,triggerPx:ie.stopPrice,reason:"stop_loss",qty:ie.qty,fillKind:"stop",note:"AUTO stop_loss"})||St;continue}ie.trailingStop!=null&&Ct.h>=ie.trailingStop&&(St=_o({lot:ie,i:Me,triggerPx:ie.trailingStop,reason:"trailing_stop",qty:ie.qty,fillKind:"stop",note:"AUTO trailing_stop"})||St)}}se[H]=W(H).filter(ie=>ie.qty>1e-12),Ec(H)};for(const he of yt){if(!le(H))break;lo(he)}return St},fs=(H,Me)=>{if(H)for(let Ue=Mt.length-1;Ue>=0;Ue--){const yt=Mt[Ue];(yt==null?void 0:yt.ocoGroup)===H&&(Me&&yt.orderId===Me||(Ge(yt.orderId,{status:"canceled",note:"OCO canceled"}),Mt.splice(Ue,1)))}},Ms=(H,Me,Ue)=>H==="entry"?Me==="long"?Ue==="limit"?"low":"high":Ue==="limit"?"high":"low":Me==="long"?Ue==="limit"?"high":"low":Ue==="limit"?"low":"high",zn=(H,Me,Ue,yt,St)=>{const lo=St.o;if(!Number.isFinite(lo)||!Number.isFinite(yt))return{px:yt,fillsAtOpen:!1};const he=lo*Z(H,Me);return Ue==="limit"?H==="entry"&&Me==="long"&&lo<=yt||H==="entry"&&Me==="short"&&lo>=yt||H==="exit"&&Me==="long"&&lo>=yt||H==="exit"&&Me==="short"&&lo<=yt?{px:he,fillsAtOpen:!0}:{px:yt,fillsAtOpen:!1}:H==="entry"&&Me==="long"&&lo>=yt||H==="entry"&&Me==="short"&&lo<=yt||H==="exit"&&Me==="long"&&lo<=yt||H==="exit"&&Me==="short"&&lo>=yt?{px:lo,fillsAtOpen:!0}:{px:yt,fillsAtOpen:!1}},qs=(H,Me,Ue)=>{var he,ke;if(!le(H)||t.execution!=="intrabar_ohlc")return!1;const yt=Ue.o;if(!Number.isFinite(yt)||yt<=0)return!1;const St=yt*Z("exit",H);let lo=!1;for(const Ne of W(H).slice())if(!(Ne.qty<=0))if(Ne.side==="long"){if(Ne.stopPrice!=null&&St<=Ne.stopPrice){lo=_o({lot:Ne,i:Me,triggerPx:yt,reason:"stop_loss",qty:Ne.qty,fillKind:"stop",note:"AUTO stop_loss (gap)"})||lo;continue}if(Ne.trailingStop!=null&&St<=Ne.trailingStop){lo=_o({lot:Ne,i:Me,triggerPx:yt,reason:"trailing_stop",qty:Ne.qty,fillKind:"stop",note:"AUTO trailing_stop (gap)"})||lo;continue}if((he=Ne.takeProfitOrders)!=null&&he.length){const ie=[];for(const Ct of Ne.takeProfitOrders){if(Ne.qty<=0)break;St>=Ct.price?lo=_o({lot:Ne,i:Me,triggerPx:St,reason:"take_profit",qty:Ct.qty,fillKind:"limit",note:`AUTO take_profit (${Ct.pct}%) (gap)`})||lo:ie.push(Ct)}Ne.takeProfitOrders=ie}Ne.takePrice!=null&&St>=Ne.takePrice&&Ne.qty>0&&(lo=_o({lot:Ne,i:Me,triggerPx:St,reason:"take_profit",qty:Ne.qty,fillKind:"limit",note:"AUTO take_profit (gap)"})||lo)}else{if(Ne.stopPrice!=null&&St>=Ne.stopPrice){lo=_o({lot:Ne,i:Me,triggerPx:yt,reason:"stop_loss",qty:Ne.qty,fillKind:"stop",note:"AUTO stop_loss (gap)"})||lo;continue}if(Ne.trailingStop!=null&&St>=Ne.trailingStop){lo=_o({lot:Ne,i:Me,triggerPx:yt,reason:"trailing_stop",qty:Ne.qty,fillKind:"stop",note:"AUTO trailing_stop (gap)"})||lo;continue}if((ke=Ne.takeProfitOrders)!=null&&ke.length){const ie=[];for(const Ct of Ne.takeProfitOrders){if(Ne.qty<=0)break;St<=Ct.price?lo=_o({lot:Ne,i:Me,triggerPx:St,reason:"take_profit",qty:Ct.qty,fillKind:"limit",note:`AUTO take_profit (${Ct.pct}%) (gap)`})||lo:ie.push(Ct)}Ne.takeProfitOrders=ie}Ne.takePrice!=null&&St<=Ne.takePrice&&Ne.qty>0&&(lo=_o({lot:Ne,i:Me,triggerPx:St,reason:"take_profit",qty:Ne.qty,fillKind:"limit",note:"AUTO take_profit (gap)"})||lo)}return se[H]=W(H).filter(Ne=>Ne.qty>1e-12),Ec(H),lo},Vn=(H,Me)=>{if(!Mt.length)return;if(Li){hs("Canceled by risk limit");return}j!=null&&ws>=j&&Io(ke=>ke.action==="entry","Max intraday filled orders reached");for(let ke=Mt.length-1;ke>=0;ke--){const Ne=Mt[ke];if(!(H<Ne.activeFromIndex)){if(Ne.expiresAtIndex!=null&&H>Ne.expiresAtIndex){Ge(Ne.orderId,{status:"expired",note:"Expired"}),Mt.splice(ke,1);continue}if(Ne.action==="exit"&&!le(Ne.side)){Ge(Ne.orderId,{status:"canceled",note:"No position"}),Mt.splice(ke,1);continue}}}const Ue=[];for(let ke=0;ke<Mt.length;ke++){const Ne=Mt[ke];if(H<Ne.activeFromIndex||Ne.expiresAtIndex!=null&&H>Ne.expiresAtIndex)continue;const ie=ne(Me,Ne.action,Ne.side);if(Ne.action==="exit"){if(!le(Ne.side))continue}else if(Ce(Ne.side)>=t.pyramiding)continue;const Ct=Ne.ocoGroup||`__solo__${Ne.orderId||ke}`,Kt=Ne.action==="exit"?0:1,fo=$t(Ne.side);if(Ne.kind==="stop_limit"){const gi=Ne.stopPrice??Ne.price,kn=Ne.limitPrice??Ne.price;if(!Number.isFinite(gi)||!Number.isFinite(kn)||!kt(Ne.action,Ne.side,"stop",ie,gi))continue;const Kr=Ms(Ne.action,Ne.side,"stop"),Ul=fo.indexOf(Kr),wa=zn(Ne.action,Ne.side,"stop",gi,Me),wl=wa.fillsAtOpen?0:Ul>=0?Ul+1:99,Cl=Kr==="high"?gi:-gi;Ue.push({groupKey:Ct,orderId:Ne.orderId,pi:ke,action:Ne.action,side:Ne.side,kind:"stop_limit",triggerExt:Kr,phase:wl,actionRank:Kt,priceRank:Cl,sp:gi,lp:kn,stopAtOpen:wa.fillsAtOpen,limitAtOpen:zn(Ne.action,Ne.side,"limit",kn,Me).fillsAtOpen});continue}const mo=Ne.price;if(mo==null||!Number.isFinite(mo)||!(Ne.kind==="limit"?kt(Ne.action,Ne.side,"limit",ie,mo):kt(Ne.action,Ne.side,"stop",ie,mo)))continue;const Fo=Ne.kind,Wo=Ms(Ne.action,Ne.side,Fo),us=fo.indexOf(Wo),or=zn(Ne.action,Ne.side,Fo,mo,Me).fillsAtOpen?0:us>=0?us+1:99,$s=Wo==="high"?mo:-mo;Ue.push({groupKey:Ct,orderId:Ne.orderId,pi:ke,action:Ne.action,side:Ne.side,kind:Fo,triggerExt:Wo,phase:or,actionRank:Kt,priceRank:$s,px:mo})}if(!Ue.length)return;const yt=new Map,St=(ke,Ne)=>ke.phase!==Ne.phase?ke.phase<Ne.phase?ke:Ne:ke.actionRank!==Ne.actionRank?ke.actionRank<Ne.actionRank?ke:Ne:ke.priceRank!==Ne.priceRank?ke.priceRank<Ne.priceRank?ke:Ne:ke.pi<Ne.pi?ke:Ne;for(const ke of Ue){const Ne=yt.get(ke.groupKey);yt.set(ke.groupKey,Ne?St(Ne,ke):ke)}const lo=Array.from(yt.values()).sort((ke,Ne)=>ke.phase!==Ne.phase?ke.phase-Ne.phase:ke.actionRank!==Ne.actionRank?ke.actionRank-Ne.actionRank:ke.priceRank!==Ne.priceRank?ke.priceRank-Ne.priceRank:ke.pi-Ne.pi),he=(ke,Ne)=>{if(ke){const ie=Mt.findIndex(Ct=>Ct.orderId===ke);if(ie>=0)return ie}return typeof Ne=="number"?Ne:-1};for(const ke of lo){const Ne=he(ke.orderId,ke.pi);if(Ne<0||Ne>=Mt.length)continue;const ie=Mt[Ne];if(H<ie.activeFromIndex||ie.expiresAtIndex!=null&&H>ie.expiresAtIndex)continue;const Ct=ne(Me,ie.action,ie.side);if(ie.action==="exit"){if(!le(ie.side)){Ge(ie.orderId,{status:"canceled",note:"No position"}),Mt.splice(Ne,1);continue}}else if(Ce(ie.side)>=t.pyramiding)continue;if(ie.kind==="stop_limit"){const $s=ie.stopPrice??ie.price,gi=ie.limitPrice??ie.price;if(!Number.isFinite($s)||!Number.isFinite(gi)||!kt(ie.action,ie.side,"stop",Ct,$s))continue;const _r=kt(ie.action,ie.side,"limit",Ct,gi),Kr=Ms(ie.action,ie.side,"stop"),Ul=Ms(ie.action,ie.side,"limit"),wa=$t(ie.side),wl=wa.indexOf(Kr),Cl=wa.indexOf(Ul);if(_r&&wl>=0&&Cl>=0&&wl<Cl){const Br=zn(ie.action,ie.side,"limit",gi,Me).px;if(ie.action==="entry"){const gl=Ee(ie.side,H,Br,ie.qtyPct,"limit",ie.bracket,{orderId:ie.orderId,signalId:ie.signalId},{qty:ie.qty,cash:ie.cash});if(gl.ok){const Gs=gl.lot;Ge(ie.orderId,{status:"filled",filledIndex:H,filledTimestamp:Ze(H),fillPrice:Gs.entryPrice,fillQty:Gs.qty,fees:Gs.entryFee})}else Ge(ie.orderId,{status:"rejected",note:gl.reject||"Entry not filled"});if(gl.ok&&t.execution==="intrabar_ohlc"){const Gs=gl.lot,Ql=Kr,ia=$t(ie.side),jd=ia.indexOf(Ql),xu=jd>=0?ia.slice(jd+1):ia;xo(Gs,Me,xu),go(ie.side,H,Me,xu)}}else{const gl=jt(ie.side),Gs=xe(ie.side,Br,ie.qtyPct,ie.qty,ie.cash),Ql=K(Gs,"floor");if(c!=null&&Ql>0&&Ql<c&&Ql<gl-1e-12)Ge(ie.orderId,{status:"rejected",note:`Qty ${Ql} < minQty ${c}`});else{const ia=Ql>=gl-1e-12?at(ie.side,H,Br,"signal","limit",{orderId:ie.orderId,signalId:ie.signalId}):Lt(ie.side,H,Br,Ql,"signal","limit",{orderId:ie.orderId,signalId:ie.signalId});Ge(ie.orderId,{status:ia?"filled":"rejected",filledIndex:ia?H:void 0,filledTimestamp:ia?Ze(H):void 0,fillPrice:(ia==null?void 0:ia.execPrice)??Br,fillQty:(ia==null?void 0:ia.qtyClosed)??0,fees:(ia==null?void 0:ia.exitFees)??0,note:ia?void 0:"Exit not filled"})}}const Fi=ie.ocoGroup,fr=ie.orderId;Mt.splice(Ne,1),fs(Fi,fr);continue}Ge(ie.orderId,{kind:"limit",note:"Stop triggered → limit active next bar"}),ie.kind="limit",ie.price=gi,ie.activeFromIndex=H+1,fs(ie.ocoGroup,ie.orderId);continue}const Kt=ie.price;if(Kt==null||!Number.isFinite(Kt)||!(ie.kind==="limit"?kt(ie.action,ie.side,"limit",Ct,Kt):kt(ie.action,ie.side,"stop",Ct,Kt)))continue;const mo=ie.kind,Go=bt(mo),Wo=zn(ie.action,ie.side,mo,Kt,Me).px,us=Ms(ie.action,ie.side,mo);if(ie.action==="entry"){if(t.positionMode==="netting"){const gi=Re(ie.side);if(le(gi)){const kn=Ze(H),_r=ct({action:"exit",side:gi,kind:Go==="limit"?"limit":"market",originalKind:"market",status:"pending",createdIndex:H,createdTimestamp:kn,activeFromIndex:H,qtyPct:100,price:Wo,note:"AUTO netting close (reverse)"}),Kr=at(gi,H,Wo,"signal",Go,{orderId:_r.id,signalId:ie.signalId});Ge(_r.id,{status:Kr?"filled":"rejected",filledIndex:Kr?H:void 0,filledTimestamp:Kr?kn:void 0,fillPrice:Kr==null?void 0:Kr.execPrice,fillQty:(Kr==null?void 0:Kr.qtyClosed)??0,fees:(Kr==null?void 0:Kr.exitFees)??0,note:Kr?"AUTO netting close (reverse)":"AUTO netting close failed"})}}const $s=Ee(ie.side,H,Wo,ie.qtyPct,Go,ie.bracket,{orderId:ie.orderId,signalId:ie.signalId},{qty:ie.qty,cash:ie.cash});if($s.ok){const gi=$s.lot;Ge(ie.orderId,{status:"filled",filledIndex:H,filledTimestamp:Ze(H),fillPrice:gi.entryPrice,fillQty:gi.qty,fees:gi.entryFee})}else Ge(ie.orderId,{status:"rejected",note:$s.reject||"Entry not filled"});if($s.ok&&t.execution==="intrabar_ohlc"){const gi=$s.lot,kn=$t(ie.side),_r=kn.indexOf(us),Kr=_r>=0?kn.slice(_r+1):kn;xo(gi,Me,Kr),go(ie.side,H,Me,Kr)}}else{const $s=jt(ie.side),gi=xe(ie.side,Wo,ie.qtyPct,ie.qty,ie.cash),kn=K(gi,"floor");if(c!=null&&kn>0&&kn<c&&kn<$s-1e-12)Ge(ie.orderId,{status:"rejected",note:`Qty ${kn} < minQty ${c}`});else{const _r=kn>=$s-1e-12?at(ie.side,H,Wo,"signal",Go,{orderId:ie.orderId,signalId:ie.signalId}):Lt(ie.side,H,Wo,kn,"signal",Go,{orderId:ie.orderId,signalId:ie.signalId});Ge(ie.orderId,{status:_r?"filled":"rejected",filledIndex:_r?H:void 0,filledTimestamp:_r?Ze(H):void 0,fillPrice:(_r==null?void 0:_r.execPrice)??Wo,fillQty:(_r==null?void 0:_r.qtyClosed)??0,fees:(_r==null?void 0:_r.exitFees)??0,note:_r?void 0:"Exit not filled"})}}const Un=ie.ocoGroup,or=ie.orderId;Mt.splice(Ne,1),fs(Un,or)}},Ss=(H,Me)=>{if(!ye()||t.execution!=="intrabar_ohlc")return!1;const Ue=qs("long",H,Me),yt=qs("short",H,Me),St=go("long",H,Me,$t("long")),lo=go("short",H,Me,$t("short"));return Ue||yt||St||lo};let di=0,Mn=0;for(let H=ol;H<=Xi;H++){const Me=$G(o[H]);if(!Me)continue;const Ue=Me.c;td(H,Ue,ol);const yt=Number((Wn=o[H])==null?void 0:Wn.timestamp);if(Number.isFinite(yt)&&yt>0){const he=new Date(yt).toISOString().slice(0,10);he&&he!==vn&&(vn=he,es=Ja(H,Ue),ws=0)}for(const he of W("long"))he.qty<=0||(he.maxFav=he.maxFav==null?Me.h:Math.max(he.maxFav,Me.h),he.maxAdv=he.maxAdv==null?Me.l:Math.min(he.maxAdv,Me.l));for(const he of W("short"))he.qty<=0||(he.maxFav=he.maxFav==null?Me.l:Math.min(he.maxFav,Me.l),he.maxAdv=he.maxAdv==null?Me.h:Math.max(he.maxAdv,Me.h));for(ye()&&Ss(H,Me),Vn(H,Me),be(H,Me);Jl<ml.length&&ml[Jl].index===H;){const he=ml[Jl];if(he.type==="cancel"){Bo(he.orderId??he.signalId,"Canceled by strategy.cancel"),Jl+=1;continue}if(he.type==="cancel_all"){hs("Canceled by strategy.cancel_all"),Jl+=1;continue}const ke=is(he),ie=String((ke==null?void 0:ke.kind)||"market").trim().toLowerCase().replace(/stop\s*limit|stoplimit/g,"stop_limit"),Ct=Es(ke==null?void 0:ke.qtyPct),Kt=ke==null?void 0:ke.qty,fo=ke==null?void 0:ke.cash,mo=typeof Kt=="number"&&Number.isFinite(Kt)?Kt:Number(Kt),Go=typeof fo=="number"&&Number.isFinite(fo)?fo:Number(fo),Fo=Number.isFinite(mo)?mo:void 0,Wo=Number.isFinite(Go)?Go:void 0,us=typeof(ke==null?void 0:ke.oco)=="string"&&String(ke.oco).trim()?String(ke.oco).trim():void 0,Un=ke==null?void 0:ke.expiresBars,or=typeof Un=="number"&&Number.isFinite(Un)&&Un>0?Math.floor(Un):null,$s=or?H+or:void 0,gi=De(ke==null?void 0:ke.bracket),kn=Li?"Risk limit reached":j!=null&&ws>=j?"Max intraday filled orders reached":null,_r=(ie==="limit"||ie==="stop")&&typeof(ke==null?void 0:ke.price)=="number"?ke.price:Ue,Kr=typeof(ke==null?void 0:ke.stopPrice)=="number"?ke.stopPrice:typeof(ke==null?void 0:ke.price)=="number"?ke.price:Ue,Ul=typeof(ke==null?void 0:ke.limitPrice)=="number"?ke.limitPrice:typeof(ke==null?void 0:ke.price)=="number"?ke.price:Ue,wa=ie==="limit"||ie==="stop"?te(he.type.startsWith("entry")?"entry":"exit",he.type.endsWith("long")?"long":"short",ie==="limit"?"limit":"stop",_r):_r,wl=ie==="stop_limit"?te(he.type.startsWith("entry")?"entry":"exit",he.type.endsWith("long")?"long":"short","stop",Kr):Kr,Cl=ie==="stop_limit"?te(he.type.startsWith("entry")?"entry":"exit",he.type.endsWith("long")?"long":"short","limit",Ul):Ul,dl=Ze(H),cr=ie==="limit"||ie==="stop"||ie==="stop_limit"?ie:"market";if(he.type==="exit_long"&&le("long"))if(cr==="stop_limit"){if(Number.isFinite(wl)&&wl>0&&Number.isFinite(Cl)&&Cl>0){const Br=ct({action:"exit",side:"long",kind:"stop_limit",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,stopPrice:wl,limitPrice:Cl});Mt.push({action:"exit",side:"long",kind:"stop_limit",signalId:he.signalId,stopPrice:wl,limitPrice:Cl,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,orderId:Br.id})}}else if(cr==="limit"||cr==="stop"){if(Number.isFinite(wa)&&wa>0){const Br=ct({action:"exit",side:"long",kind:cr,originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,price:wa});Mt.push({action:"exit",side:"long",kind:cr,signalId:he.signalId,price:wa,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,orderId:Br.id})}}else{const Br=jt("long"),Fi=xe("long",Ue,Ct,Fo,Wo),fr=K(Fi,"floor"),gl=ct({action:"exit",side:"long",kind:"market",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H,expiresAtIndex:$s,qtyPct:Ct});if(c!=null&&fr>0&&fr<c&&fr<Br-1e-12)Ge(gl.id,{status:"rejected",note:`Qty ${fr} < minQty ${c}`});else{const Gs=fr>=Br-1e-12?at("long",H,Ue,"signal","market",{signalId:he.signalId,orderId:gl.id}):Lt("long",H,Ue,fr,"signal","market",{signalId:he.signalId,orderId:gl.id});Ge(gl.id,{status:Gs?"filled":"rejected",filledIndex:Gs?H:void 0,filledTimestamp:Gs?dl:void 0,fillPrice:(Gs==null?void 0:Gs.execPrice)??de("long",Ue,"market"),fillQty:(Gs==null?void 0:Gs.qtyClosed)??0,fees:(Gs==null?void 0:Gs.exitFees)??0,note:Gs?void 0:"Exit not filled"})}}else if(he.type==="exit_short"&&le("short"))if(cr==="stop_limit"){if(Number.isFinite(wl)&&wl>0&&Number.isFinite(Cl)&&Cl>0){const Br=ct({action:"exit",side:"short",kind:"stop_limit",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,stopPrice:wl,limitPrice:Cl});Mt.push({action:"exit",side:"short",kind:"stop_limit",signalId:he.signalId,stopPrice:wl,limitPrice:Cl,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,orderId:Br.id})}}else if(cr==="limit"||cr==="stop"){if(Number.isFinite(wa)&&wa>0){const Br=ct({action:"exit",side:"short",kind:cr,originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,price:wa});Mt.push({action:"exit",side:"short",kind:cr,signalId:he.signalId,price:wa,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,orderId:Br.id})}}else{const Br=jt("short"),Fi=xe("short",Ue,Ct,Fo,Wo),fr=K(Fi,"floor"),gl=ct({action:"exit",side:"short",kind:"market",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H,expiresAtIndex:$s,qtyPct:Ct});if(c!=null&&fr>0&&fr<c&&fr<Br-1e-12)Ge(gl.id,{status:"rejected",note:`Qty ${fr} < minQty ${c}`});else{const Gs=fr>=Br-1e-12?at("short",H,Ue,"signal","market",{signalId:he.signalId,orderId:gl.id}):Lt("short",H,Ue,fr,"signal","market",{signalId:he.signalId,orderId:gl.id});Ge(gl.id,{status:Gs?"filled":"rejected",filledIndex:Gs?H:void 0,filledTimestamp:Gs?dl:void 0,fillPrice:(Gs==null?void 0:Gs.execPrice)??de("short",Ue,"market"),fillQty:(Gs==null?void 0:Gs.qtyClosed)??0,fees:(Gs==null?void 0:Gs.exitFees)??0,note:Gs?void 0:"Exit not filled"})}}else if(he.type==="entry_long"&&t.allowLong)if(cr==="stop_limit"){if(Number.isFinite(wl)&&wl>0&&Number.isFinite(Cl)&&Cl>0){const Br=ct({action:"entry",side:"long",kind:"stop_limit",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,stopPrice:wl,limitPrice:Cl});kn?Ge(Br.id,{status:"rejected",note:kn}):Mt.push({action:"entry",side:"long",kind:"stop_limit",signalId:he.signalId,stopPrice:wl,limitPrice:Cl,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,bracket:gi,orderId:Br.id})}}else if(cr==="limit"||cr==="stop"){if(Number.isFinite(wa)&&wa>0){const Br=ct({action:"entry",side:"long",kind:cr,originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,price:wa});kn?Ge(Br.id,{status:"rejected",note:kn}):Mt.push({action:"entry",side:"long",kind:cr,signalId:he.signalId,price:wa,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,bracket:gi,orderId:Br.id})}}else{const Br=ct({action:"entry",side:"long",kind:"market",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H,expiresAtIndex:$s,qtyPct:Ct});if(kn){Ge(Br.id,{status:"rejected",note:kn}),Jl+=1;continue}if(t.positionMode==="netting"){const fr="short";if(le(fr)){const gl=ct({action:"exit",side:fr,kind:"market",originalKind:"market",status:"pending",createdIndex:H,createdTimestamp:dl,activeFromIndex:H,qtyPct:100,price:Ue,note:"AUTO netting close (reverse)"}),Gs=at(fr,H,Ue,"signal","market",{signalId:he.signalId,orderId:gl.id});Ge(gl.id,{status:Gs?"filled":"rejected",filledIndex:Gs?H:void 0,filledTimestamp:Gs?dl:void 0,fillPrice:(Gs==null?void 0:Gs.execPrice)??de(fr,Ue,"market"),fillQty:(Gs==null?void 0:Gs.qtyClosed)??0,fees:(Gs==null?void 0:Gs.exitFees)??0})}}const Fi=Ee("long",H,Ue,Ct,"market",gi,{signalId:he.signalId,orderId:Br.id},{qty:Fo,cash:Wo});if(Fi.ok){const fr=Fi.lot;Ge(Br.id,{status:"filled",filledIndex:H,filledTimestamp:dl,fillPrice:fr.entryPrice,fillQty:fr.qty,fees:fr.entryFee})}else Ge(Br.id,{status:"rejected",note:Fi.reject||"Entry blocked"})}else if(he.type==="entry_short"&&t.allowShort)if(cr==="stop_limit"){if(Number.isFinite(wl)&&wl>0&&Number.isFinite(Cl)&&Cl>0){const Br=ct({action:"entry",side:"short",kind:"stop_limit",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,stopPrice:wl,limitPrice:Cl});kn?Ge(Br.id,{status:"rejected",note:kn}):Mt.push({action:"entry",side:"short",kind:"stop_limit",signalId:he.signalId,stopPrice:wl,limitPrice:Cl,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,bracket:gi,orderId:Br.id})}}else if(cr==="limit"||cr==="stop"){if(Number.isFinite(wa)&&wa>0){const Br=ct({action:"entry",side:"short",kind:cr,originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H+1,expiresAtIndex:$s,qtyPct:Ct,price:wa});kn?Ge(Br.id,{status:"rejected",note:kn}):Mt.push({action:"entry",side:"short",kind:cr,signalId:he.signalId,price:wa,qtyPct:Ct,qty:Fo,cash:Wo,activeFromIndex:H+1,expiresAtIndex:$s,ocoGroup:us,bracket:gi,orderId:Br.id})}}else{const Br=ct({action:"entry",side:"short",kind:"market",originalKind:cr,status:"pending",signalId:he.signalId,ocoGroup:us,createdIndex:H,createdTimestamp:dl,activeFromIndex:H,expiresAtIndex:$s,qtyPct:Ct});if(kn){Ge(Br.id,{status:"rejected",note:kn}),Jl+=1;continue}if(t.positionMode==="netting"){const fr="long";if(le(fr)){const gl=ct({action:"exit",side:fr,kind:"market",originalKind:"market",status:"pending",createdIndex:H,createdTimestamp:dl,activeFromIndex:H,qtyPct:100,price:Ue,note:"AUTO netting close (reverse)"}),Gs=at(fr,H,Ue,"signal","market",{signalId:he.signalId,orderId:gl.id});Ge(gl.id,{status:Gs?"filled":"rejected",filledIndex:Gs?H:void 0,filledTimestamp:Gs?dl:void 0,fillPrice:(Gs==null?void 0:Gs.execPrice)??de(fr,Ue,"market"),fillQty:(Gs==null?void 0:Gs.qtyClosed)??0,fees:(Gs==null?void 0:Gs.exitFees)??0})}}const Fi=Ee("short",H,Ue,Ct,"market",gi,{signalId:he.signalId,orderId:Br.id},{qty:Fo,cash:Wo});if(Fi.ok){const fr=Fi.lot;Ge(Br.id,{status:"filled",filledIndex:H,filledTimestamp:dl,fillPrice:fr.entryPrice,fillQty:fr.qty,fees:fr.entryFee})}else Ge(Br.id,{status:"rejected",note:Fi.reject||"Entry blocked"})}Jl+=1}let St=Ja(H,Ue);if(!Li){const he=es-St,ke=$??(B!=null?es*B:null),Ne=Wl>0?(Wl-St)/Wl:0,ie=Wl-St,Ct=M!=null&&Ne>=M||I!=null&&ie>=I,Kt=ke!=null&&Number.isFinite(he)&&he>=ke;(Ct||Kt)&&(Li=!0,hs("Canceled by risk limit"),le("long")&&at("long",H,Ue,"signal","market"),le("short")&&at("short",H,Ue,"signal","market"),St=Ja(H,Ue))}{const he=(Tn=o==null?void 0:o[H])==null?void 0:Tn.timestamp,ke=Number(he);nt.push({index:H,timestamp:Number.isFinite(ke)&&ke>0?ke:Date.now(),equity:St})}if(St>Wl&&(Wl=St),Wl>0){const he=(Wl-St)/Wl;he>sl&&(sl=he)}di+=1,ye()&&(Mn+=1);const lo=jt("long")-jt("short");we[H]=lo,ze[H]=jl(),dt[H]=Ce("long")+Ce("short"),qe[H]=Ke.length,me[H]=sa(Ue),Q[H]=U-Eo,it[H]=bs,Vt[H]=Is,wt[H]=qi,Yt[H]=Ks,At[H]=Ke.length>0?qi/Ke.length*100:0,Gt[H]=sl*100,no[H]=St,Do[H]=St-s}if(t.closeOnEnd&&ye()&&o.length){const H=Xi,Me=gh(o[H]);if(Me!=null){le("long")&&at("long",H,Me,"end","market"),le("short")&&at("short",H,Me,"end","market");const Ue=Ja(H,Me);{const St=(Ko=o==null?void 0:o[H])==null?void 0:Ko.timestamp,lo=Number(St);nt.push({index:H,timestamp:Number.isFinite(lo)&&lo>0?lo:Date.now(),equity:Ue})}if(Ue>Wl&&(Wl=Ue),Wl>0){const St=(Wl-Ue)/Wl;St>sl&&(sl=St)}const yt=jt("long")-jt("short");we[H]=yt,ze[H]=jl(),dt[H]=Ce("long")+Ce("short"),qe[H]=Ke.length,me[H]=sa(Me),Q[H]=U-Eo,it[H]=bs,Vt[H]=Is,wt[H]=qi,Yt[H]=Ks,At[H]=Ke.length>0?qi/Ke.length*100:0,Gt[H]=sl*100,no[H]=Ue,Do[H]=Ue-s}if(Mt.length){for(const Ue of Mt)Ge(Ue.orderId,{status:"canceled",note:"Canceled on end"});Mt.length=0}}const La=nt.length?nt[nt.length-1].equity:s,nn=La-s,tr=Ke.reduce((H,Me)=>H+(Me.pnl>0?Me.pnl:0),0),Ur=Ke.reduce((H,Me)=>H+(Me.pnl<0?Math.abs(Me.pnl):0),0),cl=Ke.filter(H=>H.pnl>0).length,ui=Ke.filter(H=>H.pnl<0).length,Yr=Ke.length,Ra=Yr?cl/Yr*100:0,ga=Yr?nn/Yr:0,na=cl?tr/cl:0,nl=ui?-(Ur/ui):0,mi=nl!==0?Math.abs(na/nl):na>0?1/0:0,Ha=Yr>0?Ke.reduce((H,Me)=>H+Math.max(0,Me.exitIndex-Me.entryIndex+1),0)/Yr:0;let lr=0;if(nt.length){let H=nt[0].equity;for(const Me of nt){const Ue=Me.equity;if(Number.isFinite(Ue)){if(!Number.isFinite(H)||Ue<H){H=Ue;continue}if(H>0){const yt=(Ue-H)/H;yt>lr&&(lr=yt)}}}}const zi=di>0?Mn/di*100:0,hr=[];{let H="",Me=NaN,Ue=0;for(const yt of nt){const St=Number(yt.timestamp);if(!Number.isFinite(St)||St<=0)continue;const lo=new Date(St).toISOString().slice(0,10);H&&lo!==H&&Number.isFinite(Me)&&hr.push({ts:Ue,eq:Me}),H=lo,Me=yt.equity,Ue=St}H&&Number.isFinite(Me)&&hr.push({ts:Ue,eq:Me})}const xa=[];for(let H=1;H<hr.length;H++){const Me=hr[H-1].eq,Ue=hr[H].eq;Number.isFinite(Me)&&Me!==0&&Number.isFinite(Ue)&&xa.push((Ue-Me)/Me)}const Qa=xa.length?xa.reduce((H,Me)=>H+Me,0)/xa.length:0,ue=xa.length>1?xa.reduce((H,Me)=>H+(Me-Qa)**2,0)/(xa.length-1):0,Fe=ue>0?Math.sqrt(ue):0,ut=xa.filter(H=>H<0),Xe=ut.length?ut.reduce((H,Me)=>H+Me,0)/ut.length:0,ht=ut.length>1?ut.reduce((H,Me)=>H+(Me-Xe)**2,0)/(ut.length-1):0,ao=ht>0?Math.sqrt(ht):0,It=Fe>0?Qa/Fe*Math.sqrt(252):0,eo=ao>0?Qa/ao*Math.sqrt(252):0,Mo=Fe>0?Fe*Math.sqrt(252)*100:0,ho=nt.length?nt[0].equity:s,to=nt.length?Number(nt[0].timestamp):NaN,ds=nt.length?Number(nt[nt.length-1].timestamp):NaN,js=Number.isFinite(to)&&Number.isFinite(ds)&&ds>to?(ds-to)/(365*864e5):0,Si=ho>0?La/ho:1,$r=js>0?Math.pow(Si,1/js)-1:Si-1,pa=sl>0?$r/sl:$r>0?1/0:0,En=[];if(nt.length){const H=nt[0].index,Me=gh(o[H])??NaN;if(Number.isFinite(Me)&&Me>0){const Ue=s/Me;for(let yt=ol;yt<=Xi;yt++){const St=gh(o[yt]);if(St==null||!Number.isFinite(St))continue;const lo=(Qt=o==null?void 0:o[yt])==null?void 0:Qt.timestamp,he=Number(lo);En.push({index:yt,timestamp:Number.isFinite(he)&&he>0?he:Date.now(),equity:Ue*St})}}}const za=Yr?cl/Yr*na+ui/Yr*nl:0;let Rs=0,Zs=0;{let H=0,Me=0;for(const Ue of Ke)Ue.pnl>0?(H+=1,Me=0,H>Rs&&(Rs=H)):Ue.pnl<0&&(Me+=1,H=0,Me>Zs&&(Zs=Me))}return{summary:{initialCapital:s,finalEquity:La,netPnl:nn,netPnlPct:s>0?nn/s*100:0,grossProfit:tr,grossLoss:Ur,profitFactor:Ur>0?tr/Ur:tr>0?1/0:0,trades:Yr,roundTrips:st.length,wins:cl,losses:ui,winRate:Ra,maxDrawdownPct:sl*100,feesPaid:J,avgTrade:ga,avgWin:na,avgLoss:nl,payoffRatio:mi,expectancy:za,maxConsecWins:Rs,maxConsecLosses:Zs,exposurePct:zi,maxRunupPct:lr*100,avgBarsInTrade:Ha,volatilityPct:Mo,sharpe:It,sortino:eo,calmar:pa},trades:Ke,roundTrips:st,orders:vt,equity:nt,benchmark:En,series:{positionSize:we,positionAvgPrice:ze,openTrades:dt,closedTrades:qe,openProfit:me,closedProfit:Q,grossProfit:it,grossLoss:Vt,winTrades:wt,lossTrades:Yt,winRate:At,maxDrawdownPct:Gt,equity:no,netProfit:Do}}}function Fm(o){return!Number.isFinite(o)||o<=0?0:o<1e12?o*1e3:o}function aw(o){const e=new Date(o);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),0,0,0,0)}function EG(o){const s=(new Date(o).getUTCDay()+6)%7;return aw(o)-s*24*60*60*1e3}function NG(o){const e=new Date(o);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0)}function jG(o){const e=String(o||"").trim(),t=e.toUpperCase();if(!t)return null;if(t==="D"||t==="1D")return{kind:"calendar",unit:"D"};if(t==="W"||t==="1W")return{kind:"calendar",unit:"W"};if(e==="M"||e==="1M")return{kind:"calendar",unit:"M"};if(/^\d+$/.test(t))return{kind:"fixed",ms:Math.max(1,Number(t))*60*1e3};const s=t.match(/^(\d+)\s*([A-Z]+)$/);if(s){const i=Math.max(1,Number(s[1])),r=s[2];if(r==="H"||r==="HR"||r==="HRS")return{kind:"fixed",ms:i*60*60*1e3};if(r==="MIN"||r==="MINS")return{kind:"fixed",ms:i*60*1e3};if(r==="M"&&e.toLowerCase().endsWith("m"))return{kind:"fixed",ms:i*60*1e3};if(r==="D"||r==="DAY"||r==="DAYS")return{kind:"fixed",ms:i*24*60*60*1e3};if(r==="W"||r==="WK"||r==="WEEK"||r==="WEEKS")return{kind:"fixed",ms:i*7*24*60*60*1e3}}return null}function RG(o,e){return e?e.kind==="fixed"?Math.floor(o/e.ms)*e.ms:e.unit==="D"?aw(o):e.unit==="W"?EG(o):NG(o):o}function E2(o){const e=[];let t=null;for(let s=0;s<o.length;s++){const i=Fm(o[s]??0);if(i){if(t!=null){const r=i-t;r>0&&Number.isFinite(r)&&e.push(r)}if(t=i,e.length>=200)break}}return e.length<3?null:(e.sort((s,i)=>s-i),e[Math.floor(e.length/2)]??null)}function BG(o,e){let t=0,s=o.length;for(;t<s;){const i=t+s>>>1;o[i]>e?s=i:t=i+1}return t}function OG(o){const e=o.length,t=new Float32Array(e),s=new Float32Array(e),i=new Float32Array(e),r=new Float32Array(e),a=new Float32Array(e),l=new Float32Array(e);for(let c=0;c<e;c++){const d=o[c],v=Fm((d==null?void 0:d.timestamp)??(d==null?void 0:d.time)??(d==null?void 0:d.t)??0),g=Number(d==null?void 0:d.close),_=Number(d==null?void 0:d.open),y=Number(d==null?void 0:d.high),k=Number(d==null?void 0:d.low);t[c]=Number.isFinite(_)?_:Number.isFinite(g)?g:NaN,r[c]=Number.isFinite(g)?g:NaN,s[c]=Number.isFinite(y)?y:Number.isFinite(g)?g:t[c],i[c]=Number.isFinite(k)?k:Number.isFinite(g)?g:t[c];const S=Number(d==null?void 0:d.volume);a[c]=Number.isFinite(S)?S:0,l[c]=v||0}return{open:t,high:s,low:i,close:r,volume:a,time:l}}function VG(o){var j,B,$;const e=o.timestamps.length,t=o.lookahead||"off";o.gaps;const s=String(o.timeframe||"").trim();if(!s||s.toLowerCase()==="current"||s==="__CURRENT__"){const F={open:new Float32Array(e),high:new Float32Array(e),low:new Float32Array(e),close:new Float32Array(e),volume:new Float32Array(e),time:new Float32Array(e)};for(let Z=0;Z<e;Z++)F.open[Z]=o.open[Z]??NaN,F.high[Z]=o.high[Z]??NaN,F.low[Z]=o.low[Z]??NaN,F.close[Z]=o.close[Z]??NaN,F.volume[Z]=((j=o.volume)==null?void 0:j[Z])??0,F.time[Z]=Fm(o.timestamps[Z]??0);const K=pm([{name:"__out",expr:String(o.expr||"close")}],F,o.scalars).__out||new Float32Array(e),Y=new Array(e);for(let Z=0;Z<e;Z++){const ne=K[Z];Y[Z]=Number.isFinite(ne)?ne:void 0}return Y}const i=jG(s);if(!i)return new Array(e);if(o.sourceCandles&&o.sourceCandles.length>1){const F=o.sourceCandles,V=F.length,K=OG(F),Z=pm([{name:"__out",expr:String(o.expr||"close")}],K,o.scalars).__out||new Float32Array(V),ne=K.time,te=E2(o.timestamps),oe=new Array(e);for(let se=0;se<e;se++){const W=Fm(o.timestamps[se]??0);if(!W){oe[se]=-1;continue}let le=W;if(se+1<e){const Ce=Fm(o.timestamps[se+1]??0);Ce&&Ce>W&&(le=Ce-1)}else te!=null&&te>0&&(le=W+te-1);const ye=BG(ne,le);oe[se]=ye-1}const U=new Array(e);for(let se=0;se<e;se++){const W=oe[se],le=se+1<e?oe[se+1]:W;U[se]=W>=0&&se+1<e&&W!==le}const J=new Array(e);for(let se=0;se<e;se++){const W=oe[se];if(W<0||W>=V){J[se]=void 0;continue}const le=t==="on"||U[se]?Z[W]:W>0?Z[W-1]:NaN;J[se]=Number.isFinite(le)?le:void 0}return J}const r=E2(o.timestamps);if(i.kind==="fixed"&&r!=null&&i.ms<r)throw new Error(`request.security: lower timeframe "${s}" is not available from current chart data (base ~${Math.round(r/6e4)}m). Switch chart timeframe lower or provide lower-TF datafeed.`);const a=new Array(e),l=new Array(e),c=[],d=[],v=[],g=[],_=[],y=[];let k=NaN,S=-1;for(let F=0;F<e;F++){const V=Fm(o.timestamps[F]??0);if(!V){a[F]=-1;continue}const K=RG(V,i);if(!Number.isFinite(k)||K!==k){k=K,S+=1,y[S]=K,c[S]=o.open[F]??o.close[F]??NaN;const Y=o.close[F]??NaN;d[S]=o.high[F]??Y,v[S]=o.low[F]??Y,g[S]=o.close[F]??NaN,_[S]=((B=o.volume)==null?void 0:B[F])??0}else{const Y=o.high[F],Z=o.low[F],ne=o.close[F];Y!=null&&Number.isFinite(Y)&&(d[S]=Math.max(d[S],Y)),Z!=null&&Number.isFinite(Z)&&(v[S]=Math.min(v[S],Z)),ne!=null&&Number.isFinite(ne)&&(g[S]=ne);const te=($=o.volume)==null?void 0:$[F];te!=null&&Number.isFinite(te)&&(_[S]+=te)}a[F]=S}for(let F=0;F<e;F++){const V=a[F],K=F+1<e?a[F+1]:V;l[F]=V>=0&&F+1<e&&V!==K}const M=S+1;if(M<=0)return new Array(e);const I={open:new Float32Array(M),high:new Float32Array(M),low:new Float32Array(M),close:new Float32Array(M),volume:new Float32Array(M),time:new Float32Array(M)};for(let F=0;F<M;F++)I.open[F]=c[F]??NaN,I.high[F]=d[F]??NaN,I.low[F]=v[F]??NaN,I.close[F]=g[F]??NaN,I.volume[F]=_[F]??0,I.time[F]=y[F]??0;const T=pm([{name:"__out",expr:String(o.expr||"close")}],I,o.scalars).__out||new Float32Array(M),z=new Array(e);for(let F=0;F<e;F++){const V=a[F];if(V<0){z[F]=void 0;continue}const K=t==="on"||l[F]?T[V]:V>0?T[V-1]:NaN,Y=Number.isFinite(K)?K:void 0;z[F]=Y}return z}function ih(o){return o.replace(/^"|"$/g,"").replace(/^'|'$/g,"")}function WG(o){const e={},t=/([A-Za-z_$][A-Za-z0-9_$]*)\s*:\s*("([^"\\]|\\.)*"|'([^'\\]|\\.)*'|[^\s]+)/g;let s;for(;s=t.exec(o);){const i=String(s[1]||"").toLowerCase(),r=String(s[2]||"");e[i]=r}return e}function N2(o){const e=String(o||"").split(/\n+/),t={},s=[],i=[],r=[],a=[],l={};for(const d of e){const v=d.replace(/#.*$/,"").replace(/\/\/.*$/,"").trim();if(!v)continue;let g;if(g=v.match(/^([A-Za-z_$][A-Za-z0-9_$]*)\s*=\s*(.+)$/),g){const _=g[1],y=g[2].trim(),k=Number(y);Number.isFinite(k)&&/^[-+]?\d+(?:\.\d+)?$/.test(y)?t[_]=k:y.startsWith('"')&&y.endsWith('"')||y.startsWith("'")&&y.endsWith("'")?t[_]=ih(y):s.push({name:_,expr:y});continue}if(g=v.match(/^signal\s+([A-Za-z_$][A-Za-z0-9_$]*)\s+when\s*\((.+)\)\s*$/i),g||(g=v.match(/^signal\s+([A-Za-z_$][A-Za-z0-9_$]*)\s+when\s+(.+)\s*$/i)),g){const _=g[1],y=g[2].trim();l[_.toLowerCase()]=y;const k=_.toLowerCase()==="top"?"entry_long":_.toLowerCase()==="bot"?"entry_short":_.toLowerCase();i.push({type:k,when:y});continue}if(g=v.match(/^label\s+at\s+(top|bot)(?:\s+when\s*\((.+?)\))?\s+(.+)$/i),g){const _=g[1].toLowerCase(),y=(g[2]||"").trim(),k=g[3]||"",S=WG(k),M=S.text?ih(S.text):_==="top"?"▲":"▼",I=S.color||(_==="top"?"#f97316":"#3b82f6"),C=_==="top"?"above":"below",T=S.source?ih(S.source):_==="top"?"high":"low",z=S.shape?ih(S.shape):void 0,j=K=>s.some(Y=>Y.name.replace(/\s+/g,"_").toLowerCase()===K.replace(/\s+/g,"_").toLowerCase()),B=typeof t.WIN=="number"||typeof t.WIN=="string"&&Number.isFinite(Number(t.WIN)),$=_==="top"?j("hiwin")?"close == HIWIN":B?"close == highest(close, WIN)":"close < -1e20":j("lowin")?"close == LOWIN":B?"close == lowest(close, WIN)":"close < -1e20",V={when:y||l[_]||$,text:M,color:I,position:C,source:T,shape:z};T==="high"||T==="low"?r.push(V):a.push(V);continue}}const c=[];return(r.length||i.length)&&c.push({pane:"main",plots:[],labels:r,levels:[],lines:[]}),a.length&&c.push({pane:"sub",plots:[],labels:a,levels:[],lines:[],min:0,max:100}),{params:t,series:s,signals:i,panes:c}}function qG(o,e){var t;(o.key==="Delete"||o.key==="Backspace")&&(o.preventDefault(),(t=n(e))==null||t.clickRemove())}function HG(o,e,t,s,i){n(e)&&t(),n(s)&&i()}var GG=(o,e,t)=>Wa(t(),ys(e).clickChart+=1,ys(e)),UG=re('<div class="kline-loading-overlay svelte-10y1ir0"><div class="loader-content svelte-10y1ir0"><div class="ai-minimal svelte-10y1ir0"><div class="brand-text svelte-10y1ir0">Duty AI</div> <span class="brand-shine svelte-10y1ir0"></span> <div class="orbit svelte-10y1ir0"><span class="o-dot o1 svelte-10y1ir0"></span><span class="o-dot o2 svelte-10y1ir0"></span></div> <div class="progress-line svelte-10y1ir0"><span class="dot svelte-10y1ir0"></span></div> <div class="tagline svelte-10y1ir0">Preparing data</div></div></div></div>'),YG=o=>o.stopPropagation(),KG=re('<div class="historical-loading-indicator svelte-10y1ir0"><div class="loading-spinner svelte-10y1ir0"></div> <span class="svelte-10y1ir0">Loading historical data...</span></div>'),ZG=re('<div class="reset-menu svelte-10y1ir0"><button class="action-btn copy-btn svelte-10y1ir0"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" class="svelte-10y1ir0"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2" class="svelte-10y1ir0"></rect><path d="M5 15H4C2.9 15 2 14.1 2 13V4C2 2.9 2.9 2 4 2H13C14.1 2 15 2.9 15 4V5" stroke="currentColor" stroke-width="2" class="svelte-10y1ir0"></path></svg> <span class="svelte-10y1ir0"> </span></button> <button class="action-btn reset-btn svelte-10y1ir0"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" class="svelte-10y1ir0"><path d="M3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12C21 16.97 16.97 21 12 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" class="svelte-10y1ir0"></path><path d="M3 12L7 8M3 12L7 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" class="svelte-10y1ir0"></path></svg> <span class="svelte-10y1ir0">Reset View</span></button></div>'),XG=re('<div class="kline-main svelte-10y1ir0"><div class="alerts-container svelte-10y1ir0"></div> <!> <div class="chart-container svelte-10y1ir0"><div class="chart-shell svelte-10y1ir0"><div class="kline-content svelte-10y1ir0"><div class="drawbar-host svelte-10y1ir0" style="width: var(--drawing-bar-width); overflow: hidden;"><!></div> <!> <div class="kline-widget svelte-10y1ir0" role="application" tabindex="0"><canvas class="script-overlay svelte-10y1ir0"></canvas> <canvas class="tool-overlay svelte-10y1ir0"></canvas></div> <!></div> <div><div class="dock-resize-handle svelte-10y1ir0" aria-label="Resize script dock"><div class="handle-bar svelte-10y1ir0"></div></div> <div class="dock-body svelte-10y1ir0"><!></div></div></div> <!></div> <!> <!> <!> <!> <!> <!> <!></div>');function JG(o,e){var qt,Lo,ks,yr;Mc(e,!0);const t=Au(),s=()=>ua(I(),"$save",t),i=()=>ua(Re,"$chart",t),r=()=>ua(M(),"$ctx",t),a=()=>ua(B2,"$page",t),l=()=>ua(np,"$simulator",t),c=()=>ua(Nf,"$userPreferences",t),d=()=>ua(st,"$alerts",t),v=()=>ua(Bo,"$saveRestoring",t),g=()=>ua(TG,"$scriptBacktests",t),_=()=>ua(PG,"$scriptSignals",t);console.log("%c🤖 Welcome to Duty AI Chart %c v1.0.0 ","background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; font-size: 16px; font-weight: bold; padding: 10px 15px; border-radius: 8px 0 0 8px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);","background: #1a1a2e; color: #00d4ff; font-size: 14px; font-weight: bold; padding: 10px 15px; border-radius: 0 8px 8px 0;"),console.log("%c⚡ Everything Powered by Duty AI %c All Rights Reserved © 2025","background: #0f0f23; color: #00ff88; font-size: 12px; padding: 6px 12px; border-left: 3px solid #00ff88;","background: #0f0f23; color: #888; font-size: 11px; padding: 6px 12px;"),console.log("%c🧠 AI-Driven Trading Intelligence | Real-Time Market Analysis","color: #a855f7; font-size: 11px; font-style: italic; padding: 4px 0;"),My("UTC");function y(N){const fe=`${N??""}`.replace(/0[\{\(](\d+)[\}\)]/g,(Le,ft)=>{const Bt=Number(ft);return!Number.isFinite(Bt)||Bt<=0?"0":"0".repeat(Math.min(50,Math.trunc(Bt)))}),Ae=(Le,ft)=>{if(!Number.isFinite(Le)||Le===0)return`${Le}`;const Bt=Le<0?"-":"",Ft=Math.abs(Le),zt=Math.floor(Math.log10(Ft))+1;let io=Ft/Math.pow(10,zt),Wt=zt;const zo=Number(io.toFixed(ft));return zo>=1?(io=zo/10,Wt=zt+1):io=zo,`${Bt}${io.toFixed(ft)}e${Wt}`};try{const Le=/^(-?)([\d,]+)(?:\.(\d+))?$/.exec(fe.trim());if(Le){const ft=Le[1]||"",Bt=Le[2]||"0",Ft=Le[3]||"";if(Bt.replace(/,/g,"").length>=5&&Ft.length>2)return`${ft}${Bt}.${Ft.slice(0,2).padEnd(2,"0")}`}}catch{}try{const Le=Xg(s().symbol);if(Le==="stock"||Le==="crypto"){const ft=Number(fe.replace(/,/g,"").trim());if(Number.isFinite(ft)){const Bt=Math.abs(ft);if(Bt>0&&Bt<1e-4)return Ae(ft,5)}}}catch{}return fe}const k=new SI;let S=null;fP.forEach(N=>ib(N)),wP.forEach(N=>m3(N)),bI.forEach(N=>{N.extendData=="datafeed"&&(N.extendData=k),x_(N)});let M=Qs(e,"ctx",19,()=>op(new Yb)),I=Qs(e,"save",19,()=>A1("chart",new dh)),C=Qs(e,"customLoad",3,!1);const T=5e3,z=`{
  "pane": "sub",
  "min": -2,
  "max": 2,
  "shortName": "Debug Area",
  "plots": [
    {
      "name": "AreaTest",
      "source": "close",
      "type": "area",
      "color": "rgba(129,140,248,0.4)",
      "width": 1
    }
  ]
}`;try{const N=sessionStorage.getItem("chart.tabId");N?Wa(I(),ys(s).key=`chart:${N}`,ys(s)):s().key||Wa(I(),ys(s).key="chart",ys(s))}catch{s().key||Wa(I(),ys(s).key="chart",ys(s))}try{const N=s()&&s().symbol&&typeof s().symbol=="object",X=s()&&s().period&&typeof s().period=="object";(!N||!X)&&I().set(new dh)}catch{I().set(new dh)}I().update(N=>{if(!(N.allExgs instanceof Set)){const X=Array.isArray(N.allExgs)?N.allExgs:[];N.allExgs=new Set(X)}return N});let j,B,$,F=null,V=null,K=[],Y=null,Z=[];const ne=new Set;let te=null,oe=ee(!1),U=ee(!1),J=ee(null),se=ee(!1),W=ee(void 0),le=ee(void 0),ye=ee(void 0),Ce=ee(void 0);const Re=op(null),Ke=500,st=_5();let vt=ee(!1),Je=ee(!1),ot=ee(!1),nt=ee(.35);const tt=.2,Ze=.6;let ct=ee(!1),Ge=0,pt=0,ce=ee(z),we=ee("Ready"),ze=ee(null),dt=ee(!1),qe=0,me="",Q=null,it=ee(!0);const Vt="SCRIPT_STUDIO";let wt=[],Yt=[],At=ee(null),Gt=ee("main"),no=new Set;const Do="script-trade-focus",Eo=(N,X)=>{const fe=typeof N=="number"?N:Number(N);if(!Number.isFinite(fe))return"-";try{return y(fe.toFixed(Math.max(0,Math.min(10,X))))}catch{return`${fe}`}};function bs(){const N=i();if(N)try{N.removeOverlay({groupId:Do})}catch{}}function Is(N){var Ae;const X=i();if(!X||!N)return;const fe=Le=>{const ft=typeof Le=="number"?Le:Number(Le);return!Number.isFinite(ft)||ft<=0?null:ft<1e12?ft*1e3:ft};try{const Le=((Ae=X.getDataList)==null?void 0:Ae.call(X))||[],ft=Math.max(0,Math.floor(Number(N.entryIndex)||0)),Bt=Math.max(0,Math.floor(Number(N.exitIndex)||0)),Ft=Le[ft]||null,zt=Le[Bt]||null,io=fe(N.entryTimestamp)??fe((Ft==null?void 0:Ft.timestamp)??(Ft==null?void 0:Ft.time))??null,Wt=fe(N.exitTimestamp)??fe((zt==null?void 0:zt.timestamp)??(zt==null?void 0:zt.time))??null,zo=Number(N.entryPrice),Et=Number(N.exitPrice);if(!Number.isFinite(zo)||!Number.isFinite(Et)||io==null||Wt==null)return;bs();const Ut=Number(N.netPnl)>=0,wo=Ut?"#22c55e":"#ef4444",xt=Ut?"#16a34a":"#ef4444",Ot=Ut?"#16a34a":"#f59e0b",No=Number(N.netPnl)||0,ts=Number(N.fees)||0,Oo=String(N.exitReason||"").replace(/_/g," ");X.createOverlay({name:"trade",paneId:"candle_pane",groupId:Do,lock:!0,visible:!0,points:[{timestamp:io,value:zo},{timestamp:Wt,value:Et},{timestamp:Wt,value:Et}],extendData:{line_color:wo,in_color:xt,out_color:Ot,in_text:`ENTRY ${String(N.side||"").toUpperCase()} @ ${Eo(zo,6)}`,out_text:`EXIT @ ${Eo(Et,6)} • ${Oo||"signal"} • Net ${No>=0?"+":""}${Eo(No,2)} • Fees ${Eo(ts,2)}`,selected:!0,active:!0,distance:18}});try{X.createOverlay({name:"note",paneId:"candle_pane",groupId:Do,lock:!0,visible:!0,points:[{timestamp:io,value:zo},{timestamp:io,value:zo}],extendData:{line_color:"transparent",in_color:xt,in_text:"ENTRY",out_color:xt,out_text:"",distance:22}}),X.createOverlay({name:"note",paneId:"candle_pane",groupId:Do,lock:!0,visible:!0,points:[{timestamp:Wt,value:Et},{timestamp:Wt,value:Et}],extendData:{line_color:"transparent",in_color:Ot,in_text:`EXIT • ${Oo||"signal"}`,out_color:Ot,out_text:"",distance:22}})}catch{}try{X.scrollToDataIndex(Bt,0)}catch{try{X.scrollToTimestamp(Wt,0)}catch{}}}catch(Le){console.error("[ScriptStudio] focus trade failed",Le)}}function qi(N){const X=i();if(!X)return!1;const fe=Math.max(0,Math.floor(Number(N)||0));try{return X.scrollToDataIndex(fe,0),!0}catch(Ae){return console.error("[ScriptStudio] focus index failed",Ae),!1}}function Ks(N){const X=i();if(!X)return!1;const fe=Math.floor(Number(N)||0);if(!Number.isFinite(fe)||fe<=0)return!1;try{return X.scrollToTimestamp(fe,0),!0}catch(Ae){return console.error("[ScriptStudio] focus timestamp failed",Ae),!1}}let ws=new Map;const vn=new Set;let es=null,Li=null;const ci={solid:Oe.Solid,dashed:Oe.Dashed,dotted:Oe.Dashed};let oa={};const ol=new Map,Xi=N=>{if(!N)return 0;let X=2166136261;for(let Ae=0;Ae<N.length;(Ae+=1)-1)X^=N.charCodeAt(Ae),X=Math.imul(X,16777619);const fe=X>>>0;return fe===0?1:fe},fc=N=>{const X=String(N||"");let fe="",Ae=0;for(;Ae<X.length;){const Le=X[Ae];if(Le==='"'||Le==="'"){const ft=Le;Ae+=1;let Bt="",Ft=!1;for(;Ae<X.length;){const zt=X[Ae];if(Ft){Bt+=zt,Ft=!1,Ae+=1;continue}if(zt==="\\"){Ft=!0,Ae+=1;continue}if(zt===ft){Ae+=1;break}Bt+=zt,Ae+=1}fe+=String(Xi(Bt));continue}fe+=Le,Ae+=1}return fe};function rd(N){let X=String(N||"").trim();return X=X.replace(/\$\{([^}]+)\}/g,(fe,Ae)=>{const Le=oa[String(Ae)];if(Le==null)return fe;if(typeof Le=="number"&&Number.isFinite(Le)||typeof Le=="string")return String(Le);try{return JSON.stringify(Le)}catch{return String(Le)}}),X=X.replace(/\/\/.*$/,"").replace(/#.*$/,""),X=X.split(";")[0],X=X.replace(/,\s*$/,""),X=X.replace(/\b(and|or)\b\s*$/i,""),X=X.replace(/\bta\./gi,""),X=X.replace(/\bmath\./gi,""),X=X.replace(/\b(barstate|timeframe|syminfo|strategy)\.([A-Za-z0-9_]+)/gi,(fe,Ae,Le)=>`${String(Ae).toLowerCase()}_${Le}`),X=fc(X),X=X.replace(/\bcrosses\s+above\b/gi,"crossesAbove"),X=X.replace(/\bcrosses\s+below\b/gi,"crossesBelow"),X.trim()}function ml(N){const X=String(N||"");let fe="",Ae=null,Le=0;const ft=Ft=>/[A-Za-z_$]/.test(Ft),Bt=Ft=>/[A-Za-z0-9_$]/.test(Ft);for(;Le<X.length;){const Ft=X[Le];if(Ae){fe+=Ft,Ft===Ae&&X[Le-1]!=="\\"&&(Ae=null),Le+=1;continue}if(Ft==="'"||Ft==='"'){Ae=Ft,fe+=Ft,Le+=1;continue}if(ft(Ft)){let zt=Le+1;for(;zt<X.length&&Bt(X[zt]);)zt+=1;const io=X.slice(Le,zt);let Wt=zt;for(;Wt<X.length&&/\s/.test(X[Wt]);)Wt+=1;if(X[Wt]==="["){let zo=Wt+1;for(;zo<X.length&&/\s/.test(X[zo]);)zo+=1;let Et=1;X[zo]==="-"&&(Et=-1,zo+=1);let Ut=zo;for(;Ut<X.length&&/[0-9]/.test(X[Ut]);)Ut+=1;const wo=X.slice(zo,Ut);for(;Ut<X.length&&/\s/.test(X[Ut]);)Ut+=1;if(wo&&X[Ut]==="]"){const xt=Et*Number(wo);if(Number.isFinite(xt)&&xt>=1){fe+=`prev(${io}, ${Math.floor(xt)})`,Le=Ut+1;continue}if(Number.isFinite(xt)&&xt===0){fe+=io,Le=Ut+1;continue}}}fe+=io,Le=zt;continue}fe+=Ft,Le+=1}return fe}function Jl(N){let X=String(N||"").replace(/\bta\./g,"").replace(/\bmath\./g,"").replace(/\b(barstate|timeframe|syminfo|strategy)\.([A-Za-z0-9_]+)/gi,(fe,Ae,Le)=>`${String(Ae).toLowerCase()}_${Le}`);return X=fc(X),ml(X)}function Wl(N){const X=rd(N);try{return cm(X)}catch{let Ae=X.replace(/[^A-Za-z0-9_().<>=!,\s]/g,"");Ae=Ae.replace(/[,;]+\s*$/,"").replace(/\b(and|or)\b\s*$/i,"").trim(),Ae=Ae.replace(/\bcrosses\s+above\b/gi,"crossesAbove").replace(/\bcrosses\s+below\b/gi,"crossesBelow");try{return cm(Ae)}catch{const ft=Ae.match(/([A-Za-z_$][A-Za-z0-9_$]*)/),Bt=Ae.match(/([-+]?\d+(?:\.\d+)?)/),Ft=/crossesBelow|\bbelow\b/i.test(Ae),zt=ft?ft[1]:"close",io=Bt?Bt[1]:"0",Wt=`${zt} ${Ft?"<":">"} ${io}`;return cm(Wt)}}}function sl(N,X){var fe,Ae,Le;try{const ft=Wl(N);return h2(ft,X)}catch{const Ft=rd(N).match(/^(\w+)\s*(crossesAbove|crossesBelow)\s*(\w+|[-+]?\d+(?:\.\d+)?)$/i),zt=((fe=Object.values(X)[0])==null?void 0:fe.length)||0,io=new Uint8Array(zt);if(Ft&&zt){const Wt=Ft[1],zo=Ft[2],Et=Ft[3],Ut=X[((Ae=Wt==null?void 0:Wt.toLowerCase)==null?void 0:Ae.call(Wt).replace(/\s+/g,"_"))||Wt],wo=/^[-+]?\d+(?:\.\d+)?$/.test(Et),xt=wo?null:X[((Le=Et==null?void 0:Et.toLowerCase)==null?void 0:Le.call(Et).replace(/\s+/g,"_"))||Et],Ot=wo?Number(Et):NaN;if(Ut&&(xt||wo))for(let No=1;No<zt;(No+=1)-1){const ts=Ut[No-1],Oo=Ut[No],Cn=wo?Ot:xt[No-1],Cs=wo?Ot:xt[No];if(![ts,Oo,Cn,Cs].every(Number.isFinite)){io[No]=0;continue}io[No]=zo.toLowerCase()==="crossesabove"?ts<=Cn&&Oo>Cs?1:0:ts>=Cn&&Oo<Cs?1:0}}return io}}let Uc=!1,Nl=ee(!1),Yc=ee(null),Ec=!0,Ja=null,sa=!1,jl=0,Td=null,_d=ee(!1),Fl=null,qa=0;function td(){return qa+=1,qa}let Nc=null,be=null,We=null,de=null,De=null,Ee=null,xe=null,gt=null;const at=()=>{i()&&(Nc&&(clearTimeout(Nc),Nc=null),be&&(cancelAnimationFrame(be),be=null),be=requestAnimationFrame(()=>{be=null,Lt.request(()=>{if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const N=Sd(s().theme);uo.merge(N,tf(s().styles)),i().setStyles(Dc(N)),mi(),Es(),_o()})}),Nc=setTimeout(()=>{Nc=null,Lt.request(()=>{var fe,Ae;if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const N=Sd(s().theme);uo.merge(N,tf(s().styles)),i().setStyles(Dc(N)),mi(),Es(),_o();const X=(Ae=(fe=i()).getVisibleRange)==null?void 0:Ae.call(fe);X&&typeof X.to=="number"&&setTimeout(()=>{i()&&(i().scrollToDataIndex(X.to,0),console.log("🔄 Forced canvas redraw after window resize to prevent blur"))},30)})},160))},jt=j1(),Lt=Dh(),Mt=new R1("global-chart",Re,s().theme||"dark");let Io=null;const Bo=op(!1);Sf("ctx",M()),Sf("save",I()),Sf("chart",Re),Sf("alerts",st),Sf("datafeed",k),Sf("renderIntegration",jt),Sf("globalThemeManager",Mt),Sf("drawingManager",{get:()=>Io}),Sf("saveRestoring",Bo);function hs(N){const X=N.match(/WIN\s*=\s*(\d+)/i),fe=Math.max(2,Math.min(500,X&&parseInt(X[1],10)||5)),Ae=N.match(/label\s+at\s+top\s+text:\s*\"?([^\"\n]+)\"?/i),Le=N.match(/label\s+at\s+bot\s+text:\s*\"?([^\"\n]+)\"?/i),ft=N.match(/label\s+at\s+top.*color:\s*([#a-zA-Z0-9]+)/i),Bt=N.match(/label\s+at\s+bot.*color:\s*([#a-zA-Z0-9]+)/i),Ft=((Ae==null?void 0:Ae[1])||"▲").trim(),zt=((Le==null?void 0:Le[1])||"▼").trim(),io=((ft==null?void 0:ft[1])||"#f97316").trim(),Wt=((Bt==null?void 0:Bt[1])||"#3b82f6").trim();if(!Ft||!zt)throw new Error("Script is missing label text for top/bot.");return{window:fe,topText:Ft,botText:zt,topColor:io,botColor:Wt}}function is(N,X){return{name:X,shortName:"Script",precision:4,zLevel:10,calcParams:[N.window],figures:[{key:"hi",title:`HI(${N.window})`,type:"line"},{key:"lo",title:`LO(${N.window})`,type:"line"}],styles:{lines:[{color:"rgba(0,0,0,0)",size:1e-4,style:Oe.Solid},{color:"rgba(0,0,0,0)",size:1e-4,style:Oe.Solid}]},shouldOhlc:!0,calc:(fe,Ae)=>{var Ft;const Le=Math.max(2,Math.min(500,((Ft=Ae.calcParams)==null?void 0:Ft[0])||N.window||5)),ft=Math.max(2,Math.floor(Le/2)),Bt=[];for(let zt=0;zt<fe.length;(zt+=1)-1){const io=fe[zt].high??fe[zt].close,Wt=fe[zt].low??fe[zt].close;let zo,Et,Ut=!1,wo=!1;if(zt>=ft&&zt<=fe.length-ft-1){const xt=zt-ft,Ot=zt+ft;let No=-1/0,ts=1/0;for(let rn=xt;rn<=Ot;(rn+=1)-1){const ko=fe[rn].high??fe[rn].close,Xo=fe[rn].low??fe[rn].close;ko>No&&(No=ko),Xo<ts&&(ts=Xo)}zo=No,Et=ts;const Oo=Math.max(1e-8,Math.abs(io||Wt||1)*1e-4);let Cn=-1,Cs=-1;for(let rn=xt;rn<=Ot;(rn+=1)-1){const ko=fe[rn].high??fe[rn].close,Xo=fe[rn].low??fe[rn].close;if(Cn===-1&&Math.abs(ko-No)<=Oo&&(Cn=rn),Cs===-1&&Math.abs(Xo-ts)<=Oo&&(Cs=rn),Cn!==-1&&Cs!==-1)break}Ut=Math.abs(io-No)<=Oo&&zt===Cn,wo=Math.abs(Wt-ts)<=Oo&&zt===Cs}Bt.push({hi:zo,lo:Et,high:io,low:Wt,topSignal:Ut,botSignal:wo})}return Bt},draw:({ctx:fe,indicator:Ae,xAxis:Le,yAxis:ft,bounding:Bt})=>{if(!fe||!Le||!ft)return!1;const Ft=(Ae==null?void 0:Ae.result)||[];fe.save(),Bt&&(fe.beginPath(),fe.rect(0,0,Bt.width,Bt.height),fe.clip()),fe.textAlign="center",fe.textBaseline="middle",fe.font='12px "Inter", "SF Pro", system-ui, -apple-system, sans-serif';for(let zt=0;zt<Ft.length;(zt+=1)-1){const io=Ft[zt];if(!io)continue;const Wt=Le.convertToPixel(zt);if(io.topSignal&&io.hi!==void 0){const zo=ft.convertToPixel(io.hi);if(Number.isFinite(zo)){const Et=zo-8;fe.fillStyle=N.topColor,fe.strokeStyle="rgba(0,0,0,0.35)",fe.lineWidth=1,fe.textBaseline="middle",fe.fillText(N.topText,Wt,Et),fe.strokeText(N.topText,Wt,Et),fe.beginPath(),fe.arc(Wt,Et-8,3.5,0,Math.PI*2),fe.fill(),fe.stroke()}}if(io.botSignal&&io.lo!==void 0){const zo=ft.convertToPixel(io.lo);if(Number.isFinite(zo)){const Et=zo+8;fe.fillStyle=N.botColor,fe.strokeStyle="rgba(0,0,0,0.35)",fe.lineWidth=1,fe.textBaseline="middle",fe.fillText(N.botText,Wt,Et),fe.strokeText(N.botText,Wt,Et),fe.beginPath(),fe.arc(Wt,Et+8,3.5,0,Math.PI*2),fe.fill(),fe.stroke()}}}return fe.restore(),!0}}}function Es(){if(!j)return;const N=j.getBoundingClientRect(),X=typeof window<"u"?Math.max(1,window.devicePixelRatio||1):1,fe=Ae=>{if(!Ae)return;Ae.style.width=`${N.width}px`,Ae.style.height=`${N.height}px`,Ae.width=Math.floor(N.width*X),Ae.height=Math.floor(N.height*X);const Le=Ae.getContext("2d");Le&&Le.setTransform(X,0,0,X,0,0)};fe(B),fe($),F=B==null?void 0:B.getContext("2d"),V=$==null?void 0:$.getContext("2d")}function bt(){const N={},X=j==null?void 0:j.getBoundingClientRect(),fe=(X==null?void 0:X.width)??((B==null?void 0:B.width)||0),Ae=(X==null?void 0:X.height)??((B==null?void 0:B.height)||0),Le=new DOMRect(0,0,fe,Ae);return((j==null?void 0:j.querySelectorAll('[class*="klinecharts-pane"]'))||[]).forEach((Bt,Ft)=>{const io=Bt.getAttribute("data-pane-id")||Bt.getAttribute("data-id")||""||(Ft===0?"candle_pane":`pane_index_${Ft}`);if(!io)return;const Wt=Bt.getBoundingClientRect();if(X){const zo=Wt.left-X.left,Et=Wt.top-X.top;N[io]=new DOMRect(zo,Et,Wt.width,Wt.height)}else N[io]=Le}),N.candle_pane||(N.candle_pane=Le),N}function kt(N){var ft,Bt,Ft,zt,io,Wt;if(!i())return null;const X=i(),fe=((ft=X.getDrawPaneById)==null?void 0:ft.call(X,N))??((Bt=X._drawPanes)==null?void 0:Bt.find(zo=>{var Et;return((Et=zo==null?void 0:zo.getId)==null?void 0:Et.call(zo))===N}));if(!(fe!=null&&fe.getAxisComponent))return null;const Ae=fe.getAxisComponent(),Le=((io=(zt=(Ft=fe.getMainWidget)==null?void 0:Ft.call(fe))==null?void 0:zt.getBounding)==null?void 0:io.call(zt))??((Wt=fe.getBounding)==null?void 0:Wt.call(fe));return Ae?{axis:Ae,bounding:Le}:null}function xo(N){var zt,io;const X=ws.get(N);if(!X)return;const fe=kt(N);if(!fe)return;const{axis:Ae}=fe,Le=Math.min(X.min,X.max),ft=Math.max(X.min,X.max),Bt=Math.max(1e-9,ft-Le),Ft={from:Le,to:ft,range:Bt,realFrom:Le,realTo:ft,realRange:Bt,displayFrom:Le,displayTo:ft,displayRange:Bt};(zt=Ae.setRange)==null||zt.call(Ae,Ft),(io=Ae.buildTicks)==null||io.call(Ae,!0)}function $t(N){ws.has(N)&&(vn.has(N)||(vn.add(N),Lt.request(()=>{vn.delete(N),xo(N)})))}function _o(){var Le,ft,Bt;if(!F||!i())return;const N=F;N.clearRect(0,0,B.width,B.height),N.save(),N.font='12px "Inter", system-ui, -apple-system, sans-serif',N.textAlign="center",N.textBaseline="middle";const X=bt(),fe=((ft=(Le=i()).getDataList)==null?void 0:ft.call(Le))||[],Ae=[];for(const Ft of Z){const{def:zt,paneId:io}=Ft,Wt=zt==null?void 0:zt.__lastResult,zo=Array.isArray(Wt)?Wt:Array.isArray(Wt==null?void 0:Wt.__rows)?Wt.__rows:[];if(!Array.isArray(zo)||zo.length===0||!Wt)continue;const Et=X[io]||X.candle_pane,Ut={left:Et.left,top:Et.top,width:Et.width,height:Et.height},wo=Wt.__labelItems;if(Array.isArray(wo)){const No=Wt.__tsIndex||{},ts={},Oo={};for(const Cn of wo){const Cs=Cn==null?void 0:Cn.meta;if(!Cs)continue;const rn=Cs==null?void 0:Cs.value;if(typeof rn!="number"||!Number.isFinite(rn))continue;const ko=Cn==null?void 0:Cn.ts,Xo=Cn==null?void 0:Cn.tsMs,Ro=(()=>{if(typeof(Cn==null?void 0:Cn.index)=="number")return Cn.index;if(typeof ko=="number"&&Number.isFinite(ko)){const Os=No[String(ko)];if(typeof Os=="number")return Os}if(typeof Xo=="number"&&Number.isFinite(Xo)){const Os=No[`${Math.floor(Xo)}_ms`]??No[`${Math.floor(Xo/1e3)}_s`];if(typeof Os=="number")return Os}})();if(typeof Ro!="number"||!Number.isFinite(Ro))continue;const To=(Cs.position||"above")==="above",Co=typeof Cs.size=="number"&&Cs.size>0?Cs.size:12,Hs=typeof Cs.offsetY=="number"?Cs.offsetY:10,jo=To?ts[Ro]||0:Oo[Ro]||0,ls=Hs+jo*Math.max(6,Co/3);To?ts[Ro]=jo+1:Oo[Ro]=jo+1;const Rn=(Cs==null?void 0:Cs.tooltip)!=null?String(Cs.tooltip):"";Rn&&Ae.push({kind:"label",paneId:io,ts:typeof ko=="number"?ko:void 0,index:Ro,value:rn,tooltip:Rn,size:Co,isAbove:To,offsetPx:ls})}}const xt=Wt.__runtimeTables;if(Array.isArray(xt))for(const No of xt)(Array.isArray(No==null?void 0:No.cells)?No.cells:[]).some(Cn=>Cn==null?void 0:Cn.tooltip)&&Ae.push({kind:"table",paneId:io,table:No});const Ot=CG(zt.name);if(Array.isArray(Ot)&&Ot.length)for(const No of Ot){const ts=No.index,Oo=fe[ts],Cn=(Oo==null?void 0:Oo.timestamp)??(Oo==null?void 0:Oo.time);if(!Number.isFinite(Cn))continue;let Cs,rn="",ko="",Xo=!0,Ro="";No.type==="entry_long"?(Cs=(Oo==null?void 0:Oo.low)??(Oo==null?void 0:Oo.close),rn="triangle_up_filled",ko="#16a34a",Xo=!0,Ro="BUY"):No.type==="exit_long"?(Cs=(Oo==null?void 0:Oo.high)??(Oo==null?void 0:Oo.close),rn="triangle_down_filled",ko="#f59e0b",Xo=!1,Ro="EXIT"):No.type==="entry_short"?(Cs=(Oo==null?void 0:Oo.high)??(Oo==null?void 0:Oo.close),rn="triangle_down_filled",ko="#ef4444",Xo=!1,Ro="SELL"):No.type==="exit_short"&&(Cs=(Oo==null?void 0:Oo.low)??(Oo==null?void 0:Oo.close),rn="triangle_up_filled",ko="#f59e0b",Xo=!0,Ro="EXIT");const To=Array.isArray(zt==null?void 0:zt.figures)&&((Bt=zt.figures[0])!=null&&Bt.key)?String(zt.figures[0].key):"",Co=io!=="candle_pane";let Hs=Cs;if(Co&&To){const fn=(zo[ts]||{})[To];fn!=null&&Number.isFinite(fn)&&(Hs=fn)}if(!Number.isFinite(Hs))continue;const jo=Sh({id:ts,t:Cn,p:Hs},{chart:i(),paneId:io});if(!jo)continue;let ls=jo.y;const Rn=10;ls=Xo?ls-Rn:ls+Rn;const Os=Ut.top+6,Pn=Ut.top+Ut.height-6;ls=Math.max(Os,Math.min(Pn,ls));const Oi=rn==="triangle_up_filled"?"triangleUpFilled":rn==="triangle_down_filled"?"triangleDownFilled":rn==="arrow_up"?"arrowUp":rn==="arrow_down"?"arrowDown":"label",pi=16,an=pi/2,tn="rgba(15,23,42,0.95)",Hi="rgba(0,0,0,0.65)",ps=ko;if(N.lineWidth=1,N.strokeStyle=Hi,N.fillStyle=ko||tn,Oi==="triangleUpFilled")N.beginPath(),N.moveTo(jo.x,ls-an),N.lineTo(jo.x-an,ls+an),N.lineTo(jo.x+an,ls+an),N.closePath(),N.fill(),N.stroke();else if(Oi==="triangleDownFilled")N.beginPath(),N.moveTo(jo.x,ls+an),N.lineTo(jo.x-an,ls-an),N.lineTo(jo.x+an,ls-an),N.closePath(),N.fill(),N.stroke();else if(Oi==="arrowUp")N.beginPath(),N.moveTo(jo.x,ls-an),N.lineTo(jo.x-an,ls+an),N.lineTo(jo.x+an,ls+an),N.closePath(),N.fill(),N.stroke();else if(Oi==="arrowDown")N.beginPath(),N.moveTo(jo.x,ls+an),N.lineTo(jo.x-an,ls-an),N.lineTo(jo.x+an,ls-an),N.closePath(),N.fill(),N.stroke();else{const _s=Math.max(10,N.measureText(Ro).width+12),fn=Math.max(12,pi+6),Ci=Math.max(3,Math.floor(fn/3)),dr=jo.x-Math.floor(_s/2),vi=ls-Math.floor(fn/2);N.beginPath();const Fa=Ci;N.moveTo(dr+Fa,vi),N.lineTo(dr+_s-Fa,vi),N.quadraticCurveTo(dr+_s,vi,dr+_s,vi+Fa),N.lineTo(dr+_s,vi+fn-Fa),N.quadraticCurveTo(dr+_s,vi+fn,dr+_s-Fa,vi+fn),N.lineTo(dr+Fa,vi+fn),N.quadraticCurveTo(dr,vi+fn,dr,vi+fn-Fa),N.lineTo(dr,vi+Fa),N.quadraticCurveTo(dr,vi,dr+Fa,vi),N.closePath(),N.fill(),N.stroke()}Ro&&(N.fillStyle=ps,N.strokeStyle="rgba(0,0,0,0.45)",N.fillText(Ro,jo.x,ls),N.strokeText(Ro,jo.x,ls))}}K=Ae,fs(),F==null||F.restore()}function go(){!V||!$||V.clearRect(0,0,$.width,$.height)}function fs(){Y!=null&&cancelAnimationFrame(Y),Y=requestAnimationFrame(()=>{Y=null,qs()})}function Ms(N,X,fe){const Ae=String(X||"").split(/\r?\n/),Le=[];for(const ft of Ae){const Bt=ft.split(/\s+/).filter(Boolean);if(!Bt.length){Le.push("");continue}let Ft="";const zt=()=>{Ft&&(Le.push(Ft),Ft="")},io=Wt=>{if(!Wt)return;if(N.measureText(Wt).width>fe&&fe>4){zt();let Ut="";for(const wo of Wt){const xt=Ut+wo;N.measureText(xt).width>fe&&Ut?(Le.push(Ut),Ut=wo):Ut=xt}Ut&&Le.push(Ut);return}const Et=Ft?`${Ft} ${Wt}`:Wt;N.measureText(Et).width>fe&&Ft?(zt(),Ft=Wt):Ft=Et};for(const Wt of Bt)io(Wt);zt()}return Le.length?Le:[X]}function zn(N,X,fe,Ae,Le,ft){if(!X)return;const Bt=260,Ft=10,zt=8,io=16;N.save(),N.font='12px "Inter", system-ui, -apple-system, sans-serif';const Wt=Ms(N,X,Bt-Ft*2);let zo=0;for(const Oo of Wt)zo=Math.max(zo,N.measureText(Oo).width);const Et=Math.min(Bt,Math.max(60,zo+Ft*2)),Ut=Math.max(io+zt*2,Wt.length*io+zt*2);let wo=fe+12,xt=Ae+12;wo+Et>Le-8&&(wo=fe-Et-12),xt+Ut>ft-8&&(xt=Ae-Ut-12),wo=Math.max(8,Math.min(Le-Et-8,wo)),xt=Math.max(8,Math.min(ft-Ut-8,xt));const Ot=8;N.fillStyle="rgba(15,23,42,0.92)",N.strokeStyle="rgba(148,163,184,0.35)",N.lineWidth=1,N.beginPath(),N.moveTo(wo+Ot,xt),N.lineTo(wo+Et-Ot,xt),N.quadraticCurveTo(wo+Et,xt,wo+Et,xt+Ot),N.lineTo(wo+Et,xt+Ut-Ot),N.quadraticCurveTo(wo+Et,xt+Ut,wo+Et-Ot,xt+Ut),N.lineTo(wo+Ot,xt+Ut),N.quadraticCurveTo(wo,xt+Ut,wo,xt+Ut-Ot),N.lineTo(wo,xt+Ot),N.quadraticCurveTo(wo,xt,wo+Ot,xt),N.closePath(),N.fill(),N.stroke(),N.fillStyle="#e2e8f0",N.textAlign="left",N.textBaseline="top";let No=xt+zt;const ts=wo+Ft;for(const Oo of Wt)N.fillText(Oo,ts,No),No+=io;N.restore()}function qs(){var io,Wt,zo,Et;if(!V||!$||!j)return;if(V.clearRect(0,0,$.width,$.height),!K.length){try{_o()}catch{}if(!K.length)return}const N=i();if(!N)return;const X=j.getBoundingClientRect(),fe=bt();let Ae=n(Wn),Le=n(Tn);const ft=(zo=(io=N.getChartStore)==null?void 0:(Wt=io.call(N)).getCrosshair)==null?void 0:zo.call(Wt);if(ft&&(Number.isFinite(ft.realX)||Number.isFinite(ft.x))){const Ut=ft.paneId||"candle_pane",wo=fe[Ut]||fe.candle_pane,xt=typeof ft.realX=="number"?ft.realX:ft.x;if(typeof xt=="number"&&Number.isFinite(xt)&&(Ae=xt),typeof ft.y=="number"&&Number.isFinite(ft.y)){const Ot=(wo==null?void 0:wo.top)??0;Le=ft.y+Ot}}if(Ae==null||Le==null||Ae<0||Le<0||Ae>X.width||Le>X.height)return;const Bt=((Et=N.getDataList)==null?void 0:Et.call(N))||[];let Ft=null;for(const Ut of K){if(Ut.kind!=="table")continue;const wo=fe[Ut.paneId]||fe.candle_pane;if(!wo)continue;const xt=Ae-wo.left,Ot=Le-wo.top,No=Ut.table;if(!No||xt<0||Ot<0)continue;const ts=Math.max(1,Math.floor(Number(No.columns??1))),Oo=Math.max(1,Math.floor(Number(No.rows??1))),Cn=typeof No.textSize=="number"&&No.textSize>0?No.textSize:12,Cs=8,rn=new Array(ts).fill(0),ko=new Array(Oo).fill(Math.max(20,Cn+8)),Xo=Array.isArray(No.cells)?No.cells:[],Ro=new Map;for(const tn of Xo){const Hi=Math.max(0,Math.min(ts-1,tn.column)),ps=Math.max(0,Math.min(Oo-1,tn.row));Ro.set(`${Hi}:${ps}`,tn)}const To=Array.isArray(No.merges)?No.merges:[],Co=new Map,Hs=new Map;for(const tn of To){if(!tn)continue;let Hi=Math.max(0,Math.min(ts-1,Math.floor(Number(tn.left)))),ps=Math.max(0,Math.min(ts-1,Math.floor(Number(tn.right)))),_s=Math.max(0,Math.min(Oo-1,Math.floor(Number(tn.top)))),fn=Math.max(0,Math.min(Oo-1,Math.floor(Number(tn.bottom))));if(!Number.isFinite(Hi)||!Number.isFinite(ps)||!Number.isFinite(_s)||!Number.isFinite(fn))continue;Hi>ps&&([Hi,ps]=[ps,Hi]),_s>fn&&([_s,fn]=[fn,_s]);const Ci=`${Hi}:${_s}:${ps}:${fn}`;Hs.has(Ci)||Hs.set(Ci,{left:Hi,top:_s,right:ps,bottom:fn,minW:0,minH:0});for(let dr=Hi;dr<=ps;(dr+=1)-1)for(let vi=_s;vi<=fn;(vi+=1)-1)Co.set(`${dr}:${vi}`,{left:Hi,top:_s,right:ps,bottom:fn})}for(const tn of Xo){const Hi=Math.max(0,Math.min(ts-1,tn.column)),ps=Math.max(0,Math.min(Oo-1,tn.row)),_s=Co.get(`${Hi}:${ps}`);if(_s&&(_s.left!==Hi||_s.top!==ps))continue;const fn=tn.text||"",Ci=typeof tn.textSize=="number"&&tn.textSize>0?tn.textSize:Cn;V.font=`${Ci}px "Inter", system-ui, -apple-system, sans-serif`;const dr=V.measureText(fn).width+Cs*2,vi=typeof tn.width=="number"&&tn.width>0?tn.width:0,Fa=typeof tn.height=="number"&&tn.height>0?tn.height:Math.max(20,Ci+8);if(_s){const ri=`${_s.left}:${_s.top}:${_s.right}:${_s.bottom}`,ka=Hs.get(ri);ka&&(ka.minW=Math.max(ka.minW,dr,vi),ka.minH=Math.max(ka.minH,Fa))}else rn[Hi]=Math.max(rn[Hi],dr,vi),ko[ps]=Math.max(ko[ps],Fa)}for(let tn=0;tn<ts;(tn+=1)-1)rn[tn]<60&&(rn[tn]=60);for(const tn of Hs.values()){let Hi=0;for(let _s=tn.left;_s<=tn.right;(_s+=1)-1)Hi+=rn[_s]||0;Hi<tn.minW&&(rn[tn.right]=(rn[tn.right]||0)+(tn.minW-Hi));let ps=0;for(let _s=tn.top;_s<=tn.bottom;(_s+=1)-1)ps+=ko[_s]||0;ps<tn.minH&&(ko[tn.bottom]=(ko[tn.bottom]||0)+(tn.minH-ps))}const jo=rn.reduce((tn,Hi)=>tn+Hi,0),ls=ko.reduce((tn,Hi)=>tn+Hi,0),Rn=String(No.position||"top_right").toLowerCase();let Os=Cs,Pn=Cs;const Oi=wo.width,pi=wo.height;if(Rn.includes("top_right")?(Os=Oi-jo-Cs,Pn=Cs):Rn.includes("bottom_left")?(Os=Cs,Pn=pi-ls-Cs):Rn.includes("bottom_right")?(Os=Oi-jo-Cs,Pn=pi-ls-Cs):Rn.includes("top_center")?(Os=(Oi-jo)/2,Pn=Cs):Rn.includes("bottom_center")?(Os=(Oi-jo)/2,Pn=pi-ls-Cs):(Rn.includes("middle_center")||Rn.includes("center"))&&(Os=(Oi-jo)/2,Pn=(pi-ls)/2),xt<Os||Ot<Pn||xt>Os+jo||Ot>Pn+ls)continue;let an=Os;for(let tn=0;tn<ts;(tn+=1)-1){let Hi=Pn;for(let ps=0;ps<Oo;(ps+=1)-1){const _s=rn[tn],fn=ko[ps],Ci=Co.get(`${tn}:${ps}`);if(Ci&&(Ci.left!==tn||Ci.top!==ps)){Hi+=fn;continue}const dr=Ci?(()=>{let ri=0;for(let ka=Ci.left;ka<=Ci.right;(ka+=1)-1)ri+=rn[ka]||0;return ri})():_s,vi=Ci?(()=>{let ri=0;for(let ka=Ci.top;ka<=Ci.bottom;(ka+=1)-1)ri+=ko[ka]||0;return ri})():fn,Fa=Ro.get(`${tn}:${ps}`);if(Fa!=null&&Fa.tooltip&&xt>=an&&xt<=an+dr&&Ot>=Hi&&Ot<=Hi+vi){Ft={text:String(Fa.tooltip),x:wo.left+an+dr/2,y:wo.top+Hi+vi/2};break}Hi+=fn}if(Ft)break;an+=rn[tn]}if(Ft)break}if(Ft){zn(V,Ft.text,Ft.x,Ft.y,X.width,X.height);return}let zt=null;for(const Ut of K){if(Ut.kind!=="label")continue;const wo=typeof Ut.ts=="number"?Ut.ts:typeof Ut.index=="number"?(()=>{const To=Bt[Ut.index];return(To==null?void 0:To.timestamp)??(To==null?void 0:To.time)??(To==null?void 0:To.t)})():void 0;if(typeof wo!="number"||!Number.isFinite(wo))continue;const xt=wo<1e12?wo*1e3:wo,Ot=Sh({t:xt,p:Ut.value},{chart:N,paneId:Ut.paneId});if(!Ot)continue;let No=Ot.y;const ts=typeof Ut.offsetPx=="number"?Ut.offsetPx:10;Ut.isAbove!==!1?No-=ts:No+=ts;const Cn=fe[Ut.paneId]||fe.candle_pane,Cs=typeof Ut.size=="number"&&Ut.size>0?Ut.size/2:6;if(Cn){const To=Cn.top+Cs+2,Co=Cn.top+Cn.height-Cs-2;No=Math.max(To,Math.min(Co,No))}const rn=Ae-Ot.x,ko=Le-No,Xo=Math.hypot(rn,ko),Ro=Math.max(14,Cs+10);Xo<=Ro&&(!zt||Xo<zt.dist)&&(zt={text:Ut.tooltip,x:Ot.x,y:No,dist:Xo})}zt&&zn(V,zt.text,zt.x,zt.y,X.width,X.height)}function Vn(N,X){let fe=N.replace(/\s+/g,"_").toLowerCase().replace(/[^a-z0-9_]+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"")||"plot",Ae=1;for(;X.has(fe);)fe=`${fe}_${Ae}`,Ae+=1;return X.add(fe),fe}function Ss(N){if(N){try{Yt.forEach(X=>{IG(X),F2(X)})}catch{}wt.forEach(X=>{try{N.removeIndicator({id:X})}catch{}}),wt=[],Yt.forEach(X=>{try{N.removeIndicator({paneId:"candle_pane",name:X})}catch{}try{N.removeIndicator({paneId:"pane_script",name:X})}catch{}try{N.removeIndicator({paneId:"script_pane",name:X})}catch{}}),Yt=[],Z=[],ws.forEach((X,fe)=>{var Le,ft,Bt;const Ae=kt(fe);(Le=Ae==null?void 0:Ae.axis)!=null&&Le.setAutoCalcTickFlag&&(Ae.axis.setAutoCalcTickFlag(!0),(Bt=(ft=Ae.axis).buildTicks)==null||Bt.call(ft,!0))}),ws.clear(),vn.clear(),x(At,null)}}async function di(N){var _s,fn,Ci,dr,vi,Fa,ri,ka,va,wc,$i,mr,ad,Gd,Kc,vd,$l,ha;const X=i();if(!X)throw new Error("Chart not ready yet. Please try again in a moment.");const fe=Array.isArray(N.calc)?N.calc:[],Ae=Array.isArray(N.series)?N.series:[],Le=Array.isArray(N.stateSeries)?N.stateSeries:[],ft=et=>{const As=[],yn=[];return et.forEach(ae=>{const Ns=String((ae==null?void 0:ae.expr)??"");/\b__arr_/i.test(Ns)?yn.push(ae):As.push(ae)}),{primary:As,arrayDependent:yn}},{primary:Bt,arrayDependent:Ft}=ft(Ae),zt=[],io=Array.isArray(N.signals)?N.signals:[];if(Array.isArray(N.panes))for(const et of N.panes){const As=et.pane==="sub"?"sub":"main";zt.push({pane:As,plots:Array.isArray(et.plots)?et.plots:[],levels:Array.isArray(et.levels)?et.levels:[],labels:Array.isArray(et.labels)?et.labels:[],lines:Array.isArray(et.lines)?et.lines:[],runtimeDrawOps:Array.isArray(et.runtimeDrawOps)?et.runtimeDrawOps:[],runtimeLabels:Array.isArray(et.runtimeLabels)?et.runtimeLabels:[],runtimeLines:Array.isArray(et.runtimeLines)?et.runtimeLines:[],runtimeBoxes:Array.isArray(et.runtimeBoxes)?et.runtimeBoxes:[],runtimeTables:Array.isArray(et.runtimeTables)?et.runtimeTables:[],overlays:Array.isArray(et.overlays)?et.overlays:[],fills:Array.isArray(et.fills)?et.fills:[],backgroundZones:Array.isArray(et.backgroundZones)?et.backgroundZones:[],min:et.min,max:et.max,shortName:et.shortName||N.shortName,height:et.height})}else if(N.main||N.sub)N.main&&zt.push({pane:"main",plots:Array.isArray(N.main.plots)?N.main.plots:[],levels:Array.isArray(N.main.levels)?N.main.levels:[],labels:Array.isArray(N.main.labels)?N.main.labels:[],lines:Array.isArray(N.main.lines)?N.main.lines:[],runtimeDrawOps:Array.isArray(N.main.runtimeDrawOps)?N.main.runtimeDrawOps:[],runtimeLabels:Array.isArray(N.main.runtimeLabels)?N.main.runtimeLabels:[],runtimeLines:Array.isArray(N.main.runtimeLines)?N.main.runtimeLines:[],runtimeBoxes:Array.isArray(N.main.runtimeBoxes)?N.main.runtimeBoxes:[],runtimeTables:Array.isArray(N.main.runtimeTables)?N.main.runtimeTables:[],overlays:Array.isArray(N.main.overlays)?N.main.overlays:Array.isArray(N.overlays)?N.overlays:[],fills:Array.isArray(N.main.fills)?N.main.fills:[],backgroundZones:Array.isArray(N.main.backgroundZones)?N.main.backgroundZones:[],min:N.main.min,max:N.main.max,shortName:N.main.shortName||N.shortName,height:N.main.height}),N.sub&&zt.push({pane:"sub",plots:Array.isArray(N.sub.plots)?N.sub.plots:[],levels:Array.isArray(N.sub.levels)?N.sub.levels:[],labels:Array.isArray(N.sub.labels)?N.sub.labels:[],lines:Array.isArray(N.sub.lines)?N.sub.lines:[],runtimeDrawOps:Array.isArray(N.sub.runtimeDrawOps)?N.sub.runtimeDrawOps:[],runtimeLabels:Array.isArray(N.sub.runtimeLabels)?N.sub.runtimeLabels:[],runtimeLines:Array.isArray(N.sub.runtimeLines)?N.sub.runtimeLines:[],runtimeBoxes:Array.isArray(N.sub.runtimeBoxes)?N.sub.runtimeBoxes:[],runtimeTables:Array.isArray(N.sub.runtimeTables)?N.sub.runtimeTables:[],overlays:Array.isArray(N.sub.overlays)?N.sub.overlays:[],fills:Array.isArray(N.sub.fills)?N.sub.fills:[],backgroundZones:Array.isArray(N.sub.backgroundZones)?N.sub.backgroundZones:[],min:N.sub.min,max:N.sub.max,shortName:N.sub.shortName||N.shortName,height:N.sub.height});else{const As=N.pane==="sub"?"sub":N.pane==="main"?"main":n(Gt);zt.push({pane:As,plots:Array.isArray(N.plots)?N.plots:[],levels:Array.isArray(N.levels)?N.levels:[],labels:Array.isArray(N.labels)?N.labels:[],lines:Array.isArray(N.lines)?N.lines:[],runtimeDrawOps:Array.isArray(N.runtimeDrawOps)?N.runtimeDrawOps:[],runtimeLabels:Array.isArray(N.runtimeLabels)?N.runtimeLabels:[],runtimeLines:Array.isArray(N.runtimeLines)?N.runtimeLines:[],runtimeBoxes:Array.isArray(N.runtimeBoxes)?N.runtimeBoxes:[],runtimeTables:Array.isArray(N.runtimeTables)?N.runtimeTables:[],overlays:Array.isArray(N.overlays)?N.overlays:[],fills:Array.isArray(N.fills)?N.fills:[],backgroundZones:Array.isArray(N.backgroundZones)?N.backgroundZones:[],min:N.min,max:N.max,shortName:N.shortName,height:N.height}),x(Gt,D(As))}if(!zt.length)throw new Error("No panes defined in script.");const Wt=(()=>{const et=zt.findIndex(As=>As.pane==="main");return et>=0?et:0})(),zo=zt.some(et=>et.plots&&et.plots.length||et.labels&&et.labels.length||et.levels&&et.levels.length||et.lines&&et.lines.length||et.runtimeDrawOps&&et.runtimeDrawOps.length||et.runtimeLabels&&et.runtimeLabels.length||et.runtimeLines&&et.runtimeLines.length||et.runtimeBoxes&&et.runtimeBoxes.length||et.runtimeTables&&et.runtimeTables.length),Et=!!(N!=null&&N.strategy)||io.length>0;if(!zo&&!Et)throw new Error("No plots or labels defined in script.");!zo&&Et&&(zt[0]||zt.push({pane:"main",plots:[],levels:[],labels:[],lines:[],overlays:[]}),zt[0].plots=Array.isArray(zt[0].plots)?zt[0].plots:[],zt[0].plots.push({name:"__hidden__",source:"close",type:"line",color:"rgba(0,0,0,0)",width:1e-4,style:"solid",layer:"background"})),Ss(X);try{X.removeOverlay({groupId:"runtime"})}catch{}const Ut=`${Vt}_${Date.now()}`;let wo=0,xt=!1;const Ot=new Map,No=et=>{const As=String(et||"").trim(),yn=As.lastIndexOf("@");if(yn>0&&yn<As.length-1){const ae=As.slice(0,yn).trim(),Ns=As.slice(yn+1).trim();if(ae&&Ns)return{ticker:ae,country:Ns}}return{ticker:As}},ts=et=>String(et||"").trim().toLowerCase().replace(/\s+/g,""),Oo=Array.isArray((_s=s())==null?void 0:_s.allSymbols)?s().allSymbols:[],Cn=new Map,Cs=new Map,rn=new Map;for(const et of Oo){const As=ts(String((et==null?void 0:et.ticker)||""));As&&Cn.set(As,et);const yn=ts(String((et==null?void 0:et.shortName)||""));yn&&!Cs.has(yn)&&Cs.set(yn,et);const ae=ts(String((et==null?void 0:et.name)||""));ae&&!rn.has(ae)&&rn.set(ae,et)}const ko=(et,As)=>{let yn=String(et??"").trim();if(!yn)return"__CURRENT__";try{yn=yn.replace(/\$\{([^}]+)\}/g,(ki,Ls)=>{var mc;const Rl=(As==null?void 0:As[Ls])??(As==null?void 0:As[(mc=Ls==null?void 0:Ls.toLowerCase)==null?void 0:mc.call(Ls)]);return Rl==null?ki:String(Rl)})}catch{}const ae=yn.trim();if(/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(ae)){const ki=(As==null?void 0:As[ae])??(As==null?void 0:As[ae.toLowerCase()]);typeof ki=="string"&&ki.trim()&&(yn=ki.trim())}const Ns=String(yn).trim(),ra=Ns.toLowerCase();return ra==="syminfo.tickerid"||ra==="syminfo.ticker"||ra==="syminfo.root"||ra==="__current__"||ra==="__current_symbol__"?"__CURRENT__":Ns},Xo=(et,As,yn)=>{const ae=ko(et,yn);if(ae==="__CURRENT__")return To;const Ns=No(ae),ra=String(Ns.ticker||"").trim(),ki=ts(ra),Ls=ki&&Cn.get(ki)||ki&&Cs.get(ki)||ki&&rn.get(ki)||null,Rl=String(As||Ns.country||(Ls==null?void 0:Ls.country)||To.country||"BD").trim()||"BD";return Ls&&String(Ls.ticker||"").trim()?{...Ls,country:Rl}:{...To,ticker:ra,country:Rl}},Ro=N!=null&&N.params&&typeof N.params=="object"?N.params:{},To=((fn=s())==null?void 0:fn.symbol)||{ticker:"UNKNOWN"},Co=((Ci=X.getDataList)==null?void 0:Ci.call(X))||[],Hs=typeof((dr=Co==null?void 0:Co[0])==null?void 0:dr.timestamp)=="number"?Co[0].timestamp:typeof((vi=Co==null?void 0:Co[0])==null?void 0:vi.time)=="number"?Co[0].time:0,jo=typeof((Fa=Co==null?void 0:Co[Co.length-1])==null?void 0:Fa.timestamp)=="number"?Co[Co.length-1].timestamp:typeof((ri=Co==null?void 0:Co[Co.length-1])==null?void 0:ri.time)=="number"?Co[Co.length-1].time:0,ls=et=>{const As=String(et??"").trim();if(!As)return"__CURRENT__";const yn=As.toUpperCase();if(yn==="CURRENT"||yn==="__CURRENT__"||yn==="TIMEFRAME.PERIOD")return"__CURRENT__";if(yn==="D"||yn==="1D")return"1d";if(yn==="W"||yn==="1W")return"1w";if(yn==="M"||yn==="1M")return"1M";const ae=yn.match(/^(\d+)\s*H$/);return ae?`${ae[1]}h`:As},Rn=et=>{const As=String(et||"").trim();if(!As)return"__CURRENT__";const yn=As.toLowerCase();if(yn.endsWith("m")){const ae=Number(yn.slice(0,-1));if(Number.isFinite(ae)&&ae>0)return String(Math.floor(ae))}if(yn.endsWith("h")){const ae=Number(yn.slice(0,-1));if(Number.isFinite(ae)&&ae>0)return String(Math.floor(ae*60))}return yn.endsWith("d")?"D":yn.endsWith("w")?"W":As==="1M"||As==="M"?"M":(/^\d+$/.test(As),As)},Os=et=>{let As=String(et??"__CURRENT__");try{As=As.replace(/\$\{([^}]+)\}/g,(ae,Ns)=>{var ki;const ra=(Ro==null?void 0:Ro[Ns])??(Ro==null?void 0:Ro[(ki=Ns==null?void 0:Ns.toLowerCase)==null?void 0:ki.call(Ns)]);return ra==null?ae:String(ra)});const yn=As.trim();if(/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(yn)){const ae=(Ro==null?void 0:Ro[yn])??(Ro==null?void 0:Ro[yn.toLowerCase()]);ae!=null&&(As=String(ae))}}catch{}return As},Pn=new Map;let Oi=[];try{const et=(fe||[]).filter(As=>String((As==null?void 0:As.type)||"").toLowerCase()==="security");if(et.length&&(To!=null&&To.ticker)){if(no.size)for(const ae of no){const[Ns]=String(ae).split("@");if(Ns&&Ns!==To.ticker)try{k.stopSymbolPipelines(Ns)}catch{}}const As=new Set,yn=new Map;for(const ae of et){const Ns=String((ae==null?void 0:ae.name)||"security").replace(/\s+/g,"_").toLowerCase();if(!Ns)continue;const ra=Xo(ae==null?void 0:ae.symbol,ae==null?void 0:ae.country,Ro),ki=String((ra==null?void 0:ra.ticker)||"").trim(),Ls=String((ra==null?void 0:ra.country)||"BD");if(!ki)continue;As.add(`${ki}@${Ls}`);const Rl=Os((ae==null?void 0:ae.timeframe)||(ae==null?void 0:ae.tf)||"__CURRENT__"),mc=Rl==="__CURRENT__"?((va=(ka=s())==null?void 0:ka.period)==null?void 0:va.timeframe)||"1m":ls(Rl),Jd=Rl==="__CURRENT__"?Rn((($i=(wc=s())==null?void 0:wc.period)==null?void 0:$i.timeframe)||"1m"):String(Rl||"__CURRENT__");Pn.set(Ns,{ticker:ki,country:Ls,pipelineTf:mc,computeTf:Jd});const Wc=`${ki}@${Ls}|${mc}`;mc&&mc!=="__CURRENT__"&&yn.set(Wc,{sym:ra,tf:mc})}if(Oi=Array.from(yn.values()),no=As,yn.size&&Hs>0&&jo>0)await Promise.all(Array.from(yn.values()).map(({sym:ae,tf:Ns})=>k.ensureHistoryCovers(ae,Ns,Hs,jo,3e3).catch(()=>null)));else if(yn.size)for(const{sym:ae,tf:Ns}of yn.values())try{k.startBackgroundPrefetch(ae,{timeframe:Ns})}catch{}}}catch(et){console.warn("[ScriptStudio] request.security prefetch skipped",et)}try{te&&(clearInterval(te),te=null)}catch{}if(Oi.length){const et=Date.now(),As=25e3;te=setInterval(()=>{var Ns;const yn=i();if(!yn)return;if(Date.now()-et>As){try{clearInterval(te)}catch{}te=null;return}let ae=0;for(const{sym:ra,tf:ki}of Oi){const Ls=k.getHistorySnapshot(ra,ki);if(Ls!=null&&Ls.error)continue;const Rl=(((Ns=Ls==null?void 0:Ls.candles)==null?void 0:Ns.length)||0)>=2,mc=Hs>0&&jo>0&&((Ls==null?void 0:Ls.oldestTimestampLoaded)??1/0)<=Hs&&((Ls==null?void 0:Ls.newestTimestampLoaded)??0)>=jo;!(Ls!=null&&Ls.isComplete)&&(!Rl||!mc)&&(ae+=1)}if(ae<=0){try{clearInterval(te)}catch{}te=null;return}Lt.request(()=>{try{yn.resize()}catch{}try{_o()}catch{}})},350)}const pi=(et,As)=>{const yn=new Set,ae=[],Ns=et.plots||[],ra=et.runtimeDrawOps||[],ki=et.runtimeLabels||[],Ls=et.runtimeLines||[],Rl=et.runtimeBoxes||[],mc=et.runtimeTables||[],Jd=Ns.some(Ie=>String((Ie==null?void 0:Ie.type)||"").toLowerCase()==="histogram"),Wc=Jd,nc=typeof et.min=="number"||typeof et.max=="number",Ao=et.pane==="sub"&&!Wc&&!nc;et.pane==="sub"&&Jd&&Ns.push({name:"__zero__",source:"__zero__",type:"line",color:"rgba(0,0,0,0)",width:0});const ln=et.levels||[],ul=et.labels||[],ql=et.lines||[],Pl={},kl=Ns.map(Ie=>{const ss=Vn(Ie.name||Ie.source||"plot",yn);ae.push(ss);const sr=(Ie.source||Ie.name||"").replace(/\s+/g,"_").toLowerCase();sr&&(Pl[sr]=ss);const Sa=(Ie.type||Ie.style||"").toLowerCase();return Sa==="histogram"?{key:ss,title:Ie.name||ss,type:"bar",baseValue:0}:Sa==="bar"?{key:ss,title:Ie.name||ss,type:"bar",baseValue:0}:{key:ss,title:Ie.name||ss,type:"line"}}),od=`${Ut}_${et.pane}_${As}`,ic=`${Ut}__strategy`,Il={};let kc="",lc=!1,iu=-1;const Rd=As===Wt;let fd=!1,wu="",Cd=null;const jc=2e4,Yl=Ie=>new Promise((ss,sr)=>{const Sa=new Worker(new URL(""+new URL("../workers/runtime.worker-BfEKEV3u.js",import.meta.url).href,import.meta.url),{type:"module"}),Ml=setTimeout(()=>{try{Sa.terminate()}catch{}sr(new Error("Runtime worker timed out"))},jc);Sa.onerror=()=>{try{clearTimeout(Ml)}catch{}try{Sa.terminate()}catch{}sr(new Error("Runtime worker error"))},Sa.onmessage=Zc=>{const ec=Zc.data;if(!(!ec||ec.id!==Ie.id)){try{clearTimeout(Ml)}catch{}try{Sa.terminate()}catch{}if(ec.error){sr(new Error(String(ec.error)));return}ss({seriesMap:ec.seriesMap||{},lastPrevSource:ec.lastPrevSource||void 0})}},Sa.postMessage(Ie)}),Ac={name:od,shortName:et.shortName||"Script",precision:4,calcParams:[],figures:kl,shouldOhlc:!1,minValue:(()=>{const Ie=et.pane==="sub",ss=Ns.some(sr=>String((sr==null?void 0:sr.type)||"").toLowerCase()==="histogram");if(typeof et.min=="number")return et.min;if(Ie&&ss)return-5})(),maxValue:(()=>{const Ie=et.pane==="sub",ss=Ns.some(sr=>String((sr==null?void 0:sr.type)||"").toLowerCase()==="histogram");if(typeof et.max=="number")return et.max;if(Ie&&ss)return 5})(),styles:{lines:Ns.map((Ie,ss)=>{var Zc;const sr=(Ie.source||Ie.name||"").replace(/\s+/g,"_").toLowerCase();let Sa="#22d3ee";return/ema\d+/i.test(sr)?Sa=(Zc=/ema(\d+)/i.exec(sr))!=null&&Zc[1]&&Number(RegExp.$1)<=20?"#22c55e":"#ef4444":/signal|sig/i.test(sr)?Sa="#f59e0b":/hist|bar/i.test(Ie.type||Ie.style||"")&&(Sa="#64748b"),(Ie.type||Ie.style||"").toLowerCase()==="histogram"?{color:"rgba(0,0,0,0)",size:1e-4,style:Oe.Solid}:{color:Ie.color||Sa,size:Ie.width??2,style:ci[(Ie.style||"solid").toLowerCase()]??Oe.Solid}})},calc:async Ie=>{var uf,Mv,Su,cp,Hv,Gv,Tv,Uv,uv,pf,Yv,vf,yp,Bf,Mp,ff,mf,Kv,Qf,Yp,Kp,pv,Rp,Av,Lv,gf,_u,Vu,Of,vv,zv,bp,hf,Yn,vs,_a,Vr,Ps,hi,Dl,Ua;const ss=Ie.length,sr=ss?Ie[ss-1]:null,Sa=(sr==null?void 0:sr.timestamp)??(sr==null?void 0:sr.time)??(sr==null?void 0:sr.t)??0,Ml=typeof Sa=="number"?Sa:Number(Sa),Zc=ss?Ie[0]:null,ec=(Zc==null?void 0:Zc.timestamp)??(Zc==null?void 0:Zc.time)??(Zc==null?void 0:Zc.t)??0,Ku=typeof ec=="number"?ec:Number(ec);let Bd=0,Od=0,sd=0,Ca=0;if(Oi.length)for(const{sym:rt,tf:He}of Oi){const Ye=k.getHistorySnapshot(rt,He),Tt=Number((Ye==null?void 0:Ye.lastUpdatedAt)??0);Number.isFinite(Tt)&&(Bd=Math.max(Bd,Tt));const Pt=((uf=Ye==null?void 0:Ye.candles)==null?void 0:uf.length)??0;Od+=Number.isFinite(Pt)?Pt:0,Ye!=null&&Ye.error&&(sd+=1),!(Ye!=null&&Ye.error)&&!(Ye!=null&&Ye.isComplete)&&(((Mv=Ye==null?void 0:Ye.candles)==null?void 0:Mv.length)??0)<2&&(Ca+=1)}const Ad=`${ss}:${Number.isFinite(Ku)?Ku:0}:${Number.isFinite(Ml)?Ml:0}:${n(it)?1:0}:${Bd}:${Od}:${sd}:${Ca}:${qe}:${me}:${wo}`;if(Ad===wu&&Cd)return Cd;const uu={},ru={},Zr={};let Ud=!1;const hl=(N==null?void 0:N.params)||{};oa=hl;const hu=(rt,He,Ye)=>{if(typeof rt=="number"&&Number.isFinite(rt))return rt;if(typeof rt=="string"){const Tt=Number(rt);if(Number.isFinite(Tt))return Tt;const Pt=rt.match(/^\$\{([^}]+)\}$/),Xt=Pt?Pt[1]:rt,yo=hl[Xt],Qo=typeof yo=="number"?yo:Number(yo);if(Number.isFinite(Qo))return Qo}if(He&&hl[He]!=null){const Tt=hl[He],Pt=typeof Tt=="number"?Tt:Number(Tt);if(Number.isFinite(Pt))return Pt}return Ye??0},md=rt=>{const He=typeof rt=="number"?rt:Number(rt);return Number.isFinite(He)?He:void 0},ap=new Array(ss),Nn=new Array(ss),on=new Array(ss),Pi=new Array(ss),cs=new Array(ss),ur=new Array(ss),Or=new Array(ss);for(let rt=0;rt<ss;(rt+=1)-1){const He=Ie[rt],Ye=md((He==null?void 0:He.close)??(He==null?void 0:He.c)??(He==null?void 0:He.price)??(He==null?void 0:He.value)),Tt=md((He==null?void 0:He.open)??(He==null?void 0:He.o))??Ye,Pt=md((He==null?void 0:He.high)??(He==null?void 0:He.h))??Ye??Tt,Xt=md((He==null?void 0:He.low)??(He==null?void 0:He.l))??Ye??Tt,yo=md((He==null?void 0:He.volume)??(He==null?void 0:He.vol))??0,Qo=md((He==null?void 0:He.timestamp)??(He==null?void 0:He.time)??(He==null?void 0:He.t))??0;Pi[rt]=Ye,ap[rt]=Tt,Nn[rt]=Pt,on[rt]=Xt,cs[rt]=yo,ur[rt]=Qo,Or[rt]=rt}Zr.open=ap,Zr.close=Pi,Zr.high=Nn,Zr.low=on,Zr.volume=cs,Zr.time=ur,Zr.bar_index=Or;const Jo=rt=>{const He=new Array(ss);for(let Ye=0;Ye<ss;(Ye+=1)-1)He[Ye]=rt;return He},zs={},Zo=ol.get(ic),br=rt=>Array.isArray(rt)&&rt.length===ss?rt:null;zs.strategy_position_size=br(Zo==null?void 0:Zo.positionSize)??Jo(0),zs.strategy_position_avg_price=br(Zo==null?void 0:Zo.positionAvgPrice)??Jo(0),zs.strategy_opentrades=br(Zo==null?void 0:Zo.openTrades)??Jo(0),zs.strategy_closedtrades=br(Zo==null?void 0:Zo.closedTrades)??Jo(0),zs.strategy_openprofit=br(Zo==null?void 0:Zo.openProfit)??Jo(0),zs.strategy_closedprofit=br(Zo==null?void 0:Zo.closedProfit)??Jo(0),zs.strategy_grossprofit=br(Zo==null?void 0:Zo.grossProfit)??Jo(0),zs.strategy_grossloss=br(Zo==null?void 0:Zo.grossLoss)??Jo(0),zs.strategy_wintrades=br(Zo==null?void 0:Zo.winTrades)??Jo(0),zs.strategy_losstrades=br(Zo==null?void 0:Zo.lossTrades)??Jo(0),zs.strategy_winrate=br(Zo==null?void 0:Zo.winRate)??Jo(0),zs.strategy_max_drawdown=br(Zo==null?void 0:Zo.maxDrawdownPct)??Jo(0),zs.strategy_equity=br(Zo==null?void 0:Zo.equity)??Jo(0),zs.strategy_netprofit=br(Zo==null?void 0:Zo.netProfit)??Jo(0);const cc=Zo==null?void 0:Zo.initialCapital;zs.strategy_initial_capital=Jo(typeof cc=="number"&&Number.isFinite(cc)?cc:0);const Xs=String(((cp=(Su=s())==null?void 0:Su.period)==null?void 0:cp.timeframe)||"1m").trim(),Xr=Xs.match(/^(\d+)\s*([a-zA-Z])$/);let Ji=0,Gi="";Xr?(Ji=Number(Xr[1]),Gi=Xr[2]||""):/^\d+$/.test(Xs)&&(Ji=Number(Xs),Gi="m");const jn=Gi==="M"?"M":Gi.toLowerCase();let Ga=0;if(Ji>0&&jn)try{Ga=Am(`${Ji}${jn}`)}catch{}const fa=jn==="s",Ba=jn==="m",bn=jn==="h",yd=jn==="d",qo=jn==="w",_l=jn==="M",Kl=jn==="y",Sl=fa||Ba||bn;let Pa="";Ji>0&&jn&&(jn==="m"?Pa=String(Ji):jn==="h"?Pa=String(Ji*60):jn==="s"?Pa=`${Ji}S`:jn==="d"?Pa=Ji===1?"D":`${Ji}D`:jn==="w"?Pa=Ji===1?"W":`${Ji}W`:jn==="M"?Pa=Ji===1?"M":`${Ji}M`:jn==="y"&&(Pa=Ji===1?"Y":`${Ji}Y`)),zs.timeframe_multiplier=Jo(Ji||0),zs.timeframe_seconds=Jo(Ga||0),zs.timeframe_isseconds=Jo(fa?1:0),zs.timeframe_isminutes=Jo(Ba?1:0),zs.timeframe_ishours=Jo(bn?1:0),zs.timeframe_isdaily=Jo(yd?1:0),zs.timeframe_isweekly=Jo(qo?1:0),zs.timeframe_ismonthly=Jo(_l?1:0),zs.timeframe_isyearly=Jo(Kl?1:0),zs.timeframe_isintraday=Jo(Sl?1:0),zs.timeframe_period=Jo(Xi(Pa));const Sc=To==null?void 0:To.pricePrecision,ai=typeof Sc=="number"?Sc:Number(Sc),Ir=Number.isFinite(ai)?Math.max(0,Math.floor(ai)):2,nr=1/Math.pow(10,Ir);zs.syminfo_mintick=Jo(nr),zs.syminfo_pointvalue=Jo(1);const il=String((To==null?void 0:To.ticker)||""),Dr=String((To==null?void 0:To.country)||""),qc=Dr?`${il}@${Dr}`:il,ld=il.split(/[:.]/).pop()||il,pu=String((To==null?void 0:To.exchange)||(To==null?void 0:To.market)||""),Vd=String((To==null?void 0:To.name)||(To==null?void 0:To.shortName)||""),ku=String((To==null?void 0:To.type)||""),Ou=String((To==null?void 0:To.priceCurrency)||""),zu=String(((Hv=s())==null?void 0:Hv.timezone)||"UTC"),Xc=String((To==null?void 0:To.session)||"");zs.syminfo_tickerid=Jo(Xi(qc)),zs.syminfo_ticker=Jo(Xi(il)),zs.syminfo_root=Jo(Xi(ld)),zs.syminfo_prefix=Jo(Xi(pu)),zs.syminfo_exchange=Jo(Xi(pu)),zs.syminfo_description=Jo(Xi(Vd)),zs.syminfo_type=Jo(Xi(ku)),zs.syminfo_currency=Jo(Xi(Ou)),zs.syminfo_timezone=Jo(Xi(zu)),zs.syminfo_session=Jo(Xi(Xc)),zs.syminfo_isdelayed=Jo(0);const lv=Jo(0),qp=Jo(0);ss>0&&(lv[0]=1,qp[ss-1]=1),zs.barstate_isfirst=lv,zs.barstate_islast=qp,zs.barstate_islastconfirmedhistory=qp,zs.barstate_isconfirmed=Jo(ss>0?1:0),zs.barstate_isrealtime=Jo(0),zs.barstate_ishistory=Jo(ss>0?1:0),zs.barstate_isnew=Jo(ss>0?1:0),Object.entries(zs).forEach(([rt,He])=>{Zr[rt]=He});const Zu=Ns.some(rt=>String((rt==null?void 0:rt.source)||"").toLowerCase()==="__zero__");let Fu=null;if(Zu){Fu=new Array(ss);for(let rt=0;rt<ss;(rt+=1)-1)Fu[rt]=0}const Hp=[];try{const rt=(fe||[]).filter(He=>String((He==null?void 0:He.type)||"").toLowerCase()==="security");if(rt.length&&ss>0)for(const He of rt){const Ye=String((He==null?void 0:He.name)||"security").replace(/\s+/g,"_").toLowerCase();if(!Ye)continue;const Tt=Xo(He==null?void 0:He.symbol,He==null?void 0:He.country,hl);let Pt=String((He==null?void 0:He.timeframe)||(He==null?void 0:He.tf)||"__CURRENT__");try{Pt=Pt.replace(/\$\{([^}]+)\}/g,(Hc,Tl)=>{var Kn;const Rc=(hl==null?void 0:hl[Tl])??(hl==null?void 0:hl[(Kn=Tl==null?void 0:Tl.toLowerCase)==null?void 0:Kn.call(Tl)]);return Rc==null?Hc:String(Rc)});const rc=Pt.trim();if(/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(rc)){const Hc=(hl==null?void 0:hl[rc])??(hl==null?void 0:hl[rc.toLowerCase()]);Hc!=null&&(Pt=String(Hc))}}catch{}const Xt=String(Pt||"__CURRENT__"),yo=Xt==="__CURRENT__"?((Tv=(Gv=s())==null?void 0:Gv.period)==null?void 0:Tv.timeframe)||"1m":ls(Xt),Qo=Pn.get(Ye),Vi=(Qo==null?void 0:Qo.pipelineTf)||yo,fi=(Qo==null?void 0:Qo.computeTf)||(Xt==="__CURRENT__"?Rn(((uv=(Uv=s())==null?void 0:Uv.period)==null?void 0:uv.timeframe)||"1m"):Xt),oo=Vi&&Vi!=="__CURRENT__"?k.getHistorySnapshot(Tt,Vi):null,Po=oo?oo.candles:null,Ds=Number(ur[0]??0),Wi=Number(ur[ss-1]??0);if(Vi&&Vi!=="__CURRENT__"){const rc=hn=>{const qn=typeof hn=="number"?hn:Number(hn);return!Number.isFinite(qn)||qn<=0?0:qn<1e12?qn*1e3:qn},Hc=rc(Ds),Tl=rc(Wi),Rc=Po&&Po.length>=2,Kn=Po&&Po.length?Number(((pf=Po[0])==null?void 0:pf.timestamp)??((Yv=Po[0])==null?void 0:Yv.time)??((vf=Po[0])==null?void 0:vf.t)??0):0,li=Po&&Po.length?Number(((yp=Po[Po.length-1])==null?void 0:yp.timestamp)??((Bf=Po[Po.length-1])==null?void 0:Bf.time)??((Mp=Po[Po.length-1])==null?void 0:Mp.t)??0):0,bo=rc((oo==null?void 0:oo.oldestTimestampLoaded)??Kn),$e=rc((oo==null?void 0:oo.newestTimestampLoaded)??li),Vo=Rc&&Hc>0&&Tl>0&&bo>0&&$e>0&&bo<=Tl&&$e>=Hc,ro=Vo&&bo<=Hc&&$e>=Tl;if(!Rc||!Vo){const hn=String((Tt==null?void 0:Tt.ticker)||""),qn=String((Tt==null?void 0:Tt.country)||"");if(oo!=null&&oo.error)n(ze)||x(ze,`request.security: ${hn}${qn?`@${qn}`:""} (${Vi}) error: ${oo.error}`);else if(oo!=null&&oo.isComplete){if(!n(ze)){const Fn=!Rc||!(Po&&Po.length);x(ze,D(Fn?`request.security: no data for ${hn}${qn?`@${qn}`:""} (${Vi})`:`request.security: no overlap for ${hn}${qn?`@${qn}`:""} (${Vi})`))}}else if(n(we)==="Running..."||n(we)==="Plotted from Pine"||n(we)==="Plotted from DSL"){const Fn=oo!=null&&oo.oldestTimestampLoaded?new Date(oo.oldestTimestampLoaded).toISOString().slice(0,10):"?",Qi=oo!=null&&oo.newestTimestampLoaded?new Date(oo.newestTimestampLoaded).toISOString().slice(0,10):"?";x(we,`Loading request.security: ${hn}${qn?`@${qn}`:""} (${Vi})… loaded ${Fn}→${Qi}`)}Zr[Ye]=new Array(ss),Hp.push(Ye);continue}if(!ro&&!(oo!=null&&oo.error)&&!(oo!=null&&oo.isComplete)&&(n(we)==="Running..."||n(we)==="Plotted from Pine"||n(we)==="Plotted from DSL")){const hn=String((Tt==null?void 0:Tt.ticker)||""),qn=String((Tt==null?void 0:Tt.country)||""),Fn=oo!=null&&oo.oldestTimestampLoaded?new Date(oo.oldestTimestampLoaded).toISOString().slice(0,10):"?",Qi=oo!=null&&oo.newestTimestampLoaded?new Date(oo.newestTimestampLoaded).toISOString().slice(0,10):"?";x(we,`Loading request.security (partial): ${hn}${qn?`@${qn}`:""} (${Vi})… loaded ${Fn}→${Qi}`)}}const Bn=String((He==null?void 0:He.expr)||"close"),Qn=String((He==null?void 0:He.lookahead)||"off").toLowerCase(),In=Qn==="on"||Qn.includes("on")&&!Qn.includes("off")?"on":"off",ma=String((He==null?void 0:He.gaps)||"off").toLowerCase(),Bl=ma==="on"||ma.includes("on")&&!ma.includes("off")?"on":"off",xn=`${ap[ss-1]??""}|${Nn[ss-1]??""}|${on[ss-1]??""}|${Pi[ss-1]??""}|${cs[ss-1]??""}`,Ii=Po&&Po.length?Number(((ff=Po[0])==null?void 0:ff.timestamp)??((mf=Po[0])==null?void 0:mf.time)??0):0,ya=Po&&Po.length?Number(((Kv=Po[Po.length-1])==null?void 0:Kv.timestamp)??((Qf=Po[Po.length-1])==null?void 0:Qf.time)??0):0,ei=String((Tt==null?void 0:Tt.ticker)||"").trim(),Zl=String((Tt==null?void 0:Tt.country)||"").trim(),Jc=`sym=${ei}${Zl?`@${Zl}`:""}|tf=${fi}|srcTf=${Vi}|srcLen=${Po?Po.length:0}|src0=${Ii}|srcN=${ya}|la=${In}|gaps=${Bl}|expr=${Bn}|len=${ss}|t0=${Ds}|tN=${Wi}|tail=${xn}`,Zn=Ot.get(Jc),bd=Zn&&Zn.len===ss&&Zn.firstTime===Ds&&Zn.lastTime===Wi&&Zn.tailSig===xn?Zn.out:(()=>{const rc=VG({timestamps:ur,open:ap,high:Nn,low:on,close:Pi,volume:cs,sourceCandles:Po||void 0,timeframe:fi,expr:Bn,lookahead:In,gaps:Bl,scalars:hl});return Ot.set(Jc,{out:rc,len:ss,firstTime:Ds,lastTime:Wi,tailSig:xn}),rc})();try{let rc=!1;const Hc=Math.max(0,ss-250);for(let Tl=ss-1;Tl>=Hc;(Tl-=1)+1){const Rc=bd[Tl];if(Rc!=null&&Number.isFinite(Rc)){rc=!0;break}}if(!rc&&!n(ze)){const Tl=String((Tt==null?void 0:Tt.ticker)||""),Rc=String((Tt==null?void 0:Tt.country)||"");x(we,`request.security: no overlap for ${Tl}${Rc?`@${Rc}`:""} (${Vi}) — try a more recent chart range or switch chart timeframe`)}}catch{}Zr[Ye]=bd,Hp.push(Ye)}}catch(rt){const He=(rt==null?void 0:rt.message)!=null?String(rt.message):String(rt);console.error("[ScriptStudio] request.security error",rt),n(ze)||x(ze,`request.security error: ${He}`)}const Gp=()=>{if(Bt.length&&ss>0)try{const rt={open:new Float32Array(ss),high:new Float32Array(ss),low:new Float32Array(ss),close:new Float32Array(ss),volume:new Float32Array(ss),time:new Float32Array(ss),bar_index:new Float32Array(ss)};for(let Ye=0;Ye<ss;(Ye+=1)-1)rt.open[Ye]=ap[Ye]??NaN,rt.high[Ye]=Nn[Ye]??NaN,rt.low[Ye]=on[Ye]??NaN,rt.close[Ye]=Pi[Ye]??NaN,rt.volume[Ye]=cs[Ye]??0,rt.time[Ye]=ur[Ye]??0,rt.bar_index[Ye]=Or[Ye]??Ye;for(const Ye of Hp){const Tt=Zr[Ye];if(!Tt)continue;const Pt=new Float32Array(ss);for(let Xt=0;Xt<ss;(Xt+=1)-1)Pt[Xt]=Tt[Xt]??NaN;rt[Ye]=Pt}Object.entries(zs).forEach(([Ye,Tt])=>{if(!Tt)return;const Pt=new Float32Array(ss);for(let Xt=0;Xt<ss;(Xt+=1)-1)Pt[Xt]=Tt[Xt]??NaN;rt[Ye]=Pt});const He=pm(Bt.map((Ye,Tt)=>({name:String(Ye.name||`series_${Tt}`),expr:Jl(String(Ye.expr||"").replace(/\$\{([^}]+)\}/g,(Pt,Xt)=>String(hl[Xt]??Pt)))})),rt,hl);Object.entries(He).forEach(([Ye,Tt])=>{const Pt=Ye.replace(/\s+/g,"_").toLowerCase(),Xt=new Array(ss);for(let yo=0;yo<ss;(yo+=1)-1)Xt[yo]=Tt[yo];Zr[Pt]=Xt})}catch(rt){const He=(rt==null?void 0:rt.message)!=null?String(rt.message):String(rt);console.error("[ScriptStudio] expression engine error",rt),n(ze)||x(ze,`Expression error: ${He}`),n(we)||x(we,"Expression error")}jO({seriesMap:Zr,calcDefs:fe,len:ss,params:hl,lastPrevSource:Il,resolveNum:hu,onError:(rt,He)=>{He&&console.error("[ScriptStudio] expr eval error",He),n(ze)||x(ze,D(rt)),n(we)||x(we,"Expression error")}})};if(ss>0&&(Ae.length||fe.length||Le.length)){const rt={...zs};Hp.length&&Hp.forEach(He=>{const Ye=Zr[He];Ye&&(rt[He]=Ye)}),Fu&&(rt.__zero__=Fu);try{const He=`${od}_rt_${ss}_${Number.isFinite(Ml)?Ml:0}`,Ye=Ao?"calc_only":"full",Tt=await Yl({id:He,base:{open:ap,high:Nn,low:on,close:Pi,volume:cs,time:ur},calc:fe,series:Ae,stateSeries:Le,params:hl,extraSeries:rt,stage:Ye}),Pt=Tt.seriesMap||{};Object.keys(Zr).forEach(Xt=>delete Zr[Xt]),Object.entries(Pt).forEach(([Xt,yo])=>{Zr[Xt]=yo}),Tt.lastPrevSource&&Object.assign(Il,Tt.lastPrevSource),Ud=Ye==="full"}catch(He){console.warn("[ScriptStudio] runtime worker fallback",He),Gp()}}else Gp();if(Zu){if(!Fu){Fu=new Array(ss);for(let rt=0;rt<ss;(rt+=1)-1)Fu[rt]=0}Zr.__zero__=Fu}if(et.pane==="sub"){const rt=new Set,He=new Set;Ns.forEach(Tt=>{const Pt=(Tt.source||Tt.name||"").replace(/\s+/g,"_").toLowerCase();Pt&&rt.add(Pt),String(Tt.type||"").toLowerCase()==="histogram"&&Pt&&He.add(Pt)}),(et.labels||[]).forEach(Tt=>{const Pt=((Tt==null?void 0:Tt.source)||(Tt==null?void 0:Tt.name)||"").replace(/\s+/g,"_").toLowerCase();Pt&&rt.add(Pt)}),(Yp=et.fills)==null||Yp.forEach(Tt=>{(Array.isArray(Tt==null?void 0:Tt.between)?Tt.between:[]).forEach(Xt=>{const yo=String(Xt||"").replace(/\s+/g,"_").toLowerCase();yo&&rt.add(yo)})});const Ye=(Tt,Pt)=>{let Xt=1/0,yo=-1/0;for(let oo=0;oo<Tt.length;(oo+=1)-1){const Po=Tt[oo];Po==null||Number.isNaN(Po)||(Po<Xt&&(Xt=Po),Po>yo&&(yo=Po))}const Qo=yo-Xt;if(!(yo>200||Xt<-50||Qo>200))return Tt;const fi=new Array(Tt.length);if(Qo>1e-8){for(let oo=0;oo<Tt.length;(oo+=1)-1){const Po=Tt[oo];fi[oo]=Po==null?void 0:(Po-Xt)/Qo*100}return fi}if(Pt){for(let oo=0;oo<Tt.length;(oo+=1)-1){const Po=Tt[oo],Ds=Pt[oo];fi[oo]=Po==null||Ds===void 0||Ds===null||Ds===0?void 0:Po/Ds*50+50}return fi}return Tt};!Wc&&!nc&&rt.forEach(Tt=>{Zr[Tt]&&!He.has(Tt)&&!/hist|macd|signal/i.test(Tt)&&(Zr[Tt]=Ye(Zr[Tt],Zr.close))})}if(!Ud&&Bt.length&&ss>0)try{const rt=new Set(Bt.map((Tt,Pt)=>String((Tt==null?void 0:Tt.name)||`series_${Pt}`).replace(/\s+/g,"_").toLowerCase()).filter(Boolean)),He={};Object.entries(Zr).forEach(([Tt,Pt])=>{const Xt=String(Tt||"").replace(/\s+/g,"_").toLowerCase();if(rt.has(Xt))return;const yo=new Float32Array(ss);for(let Qo=0;Qo<ss;(Qo+=1)-1)yo[Qo]=Pt[Qo]??NaN;He[Xt]=yo});const Ye=pm(Bt.map((Tt,Pt)=>({name:String(Tt.name||`series_${Pt}`),expr:Jl(String(Tt.expr||"").replace(/\$\{([^}]+)\}/g,(Xt,yo)=>String(hl[yo]??Xt)))})),He,hl);Object.entries(Ye).forEach(([Tt,Pt])=>{const Xt=Tt.replace(/\s+/g,"_").toLowerCase(),yo=new Array(ss);for(let Qo=0;Qo<ss;(Qo+=1)-1)yo[Qo]=Pt[Qo];Zr[Xt]=yo})}catch(rt){const He=(rt==null?void 0:rt.message)!=null?String(rt.message):String(rt);console.error("[ScriptStudio] expression engine error (2nd pass)",rt),n(ze)||x(ze,`Expression error: ${He}`),n(we)||x(we,"Expression error")}const cv=Le.filter(rt=>/^__arr_/i.test(String((rt==null?void 0:rt.name)||""))),Vv=Le.filter(rt=>!/^__arr_/i.test(String((rt==null?void 0:rt.name)||"")));if(!Ud&&cv.length&&ss>0)try{const rt={};Object.entries(Zr).forEach(([Ye,Tt])=>{const Pt=String(Ye||"").replace(/\s+/g,"_").toLowerCase(),Xt=new Float32Array(ss);for(let yo=0;yo<ss;(yo+=1)-1)Xt[yo]=Tt[yo]??NaN;rt[Pt]=Xt});const He=c2(cv.map((Ye,Tt)=>({name:String((Ye==null?void 0:Ye.name)||`state_${Tt}`),initExpr:(Ye==null?void 0:Ye.initExpr)!=null?Jl(String(Ye.initExpr).replace(/\$\{([^}]+)\}/g,(Pt,Xt)=>String(hl[Xt]??Pt))):void 0,updateExpr:Jl(String((Ye==null?void 0:Ye.updateExpr)??(Ye==null?void 0:Ye.expr)??"").replace(/\$\{([^}]+)\}/g,(Pt,Xt)=>String(hl[Xt]??Pt))),selfMode:Ye==null?void 0:Ye.selfMode})),rt,hl);Object.entries(He).forEach(([Ye,Tt])=>{const Pt=Ye.replace(/\s+/g,"_").toLowerCase(),Xt=new Array(ss);for(let yo=0;yo<ss;(yo+=1)-1)Xt[yo]=Tt[yo];Zr[Pt]=Xt})}catch(rt){const He=(rt==null?void 0:rt.message)!=null?String(rt.message):String(rt);console.error("[ScriptStudio] state series error",rt),n(ze)||x(ze,`Expression error: ${He}`),n(we)||x(we,"Expression error")}if(!Ud&&Ft.length&&ss>0)try{const rt=new Set(Ft.map((Tt,Pt)=>String((Tt==null?void 0:Tt.name)||`series_${Pt}`).replace(/\s+/g,"_").toLowerCase()).filter(Boolean)),He={};Object.entries(Zr).forEach(([Tt,Pt])=>{const Xt=String(Tt||"").replace(/\s+/g,"_").toLowerCase();if(rt.has(Xt))return;const yo=new Float32Array(ss);for(let Qo=0;Qo<ss;(Qo+=1)-1)yo[Qo]=Pt[Qo]??NaN;He[Xt]=yo});const Ye=pm(Ft.map((Tt,Pt)=>({name:String(Tt.name||`series_${Pt}`),expr:Jl(String(Tt.expr||"").replace(/\$\{([^}]+)\}/g,(Xt,yo)=>String(hl[yo]??Xt)))})),He,hl);Object.entries(Ye).forEach(([Tt,Pt])=>{const Xt=Tt.replace(/\s+/g,"_").toLowerCase(),yo=new Array(ss);for(let Qo=0;Qo<ss;(Qo+=1)-1)yo[Qo]=Pt[Qo];Zr[Xt]=yo})}catch(rt){const He=(rt==null?void 0:rt.message)!=null?String(rt.message):String(rt);console.error("[ScriptStudio] expression engine error (array pass)",rt),n(ze)||x(ze,`Expression error: ${He}`),n(we)||x(we,"Expression error")}if(!Ud&&Vv.length&&ss>0)try{const rt={};Object.entries(Zr).forEach(([Ye,Tt])=>{const Pt=String(Ye||"").replace(/\s+/g,"_").toLowerCase(),Xt=new Float32Array(ss);for(let yo=0;yo<ss;(yo+=1)-1)Xt[yo]=Tt[yo]??NaN;rt[Pt]=Xt});const He=c2(Vv.map((Ye,Tt)=>({name:String((Ye==null?void 0:Ye.name)||`state_${Tt}`),initExpr:(Ye==null?void 0:Ye.initExpr)!=null?Jl(String(Ye.initExpr).replace(/\$\{([^}]+)\}/g,(Pt,Xt)=>String(hl[Xt]??Pt))):void 0,updateExpr:Jl(String((Ye==null?void 0:Ye.updateExpr)??(Ye==null?void 0:Ye.expr)??"").replace(/\$\{([^}]+)\}/g,(Pt,Xt)=>String(hl[Xt]??Pt))),selfMode:Ye==null?void 0:Ye.selfMode})),rt,hl);Object.entries(He).forEach(([Ye,Tt])=>{const Pt=Ye.replace(/\s+/g,"_").toLowerCase(),Xt=new Array(ss);for(let yo=0;yo<ss;(yo+=1)-1)Xt[yo]=Tt[yo];Zr[Pt]=Xt})}catch(rt){const He=(rt==null?void 0:rt.message)!=null?String(rt.message):String(rt);console.error("[ScriptStudio] state series error",rt),n(ze)||x(ze,`Expression error: ${He}`),n(we)||x(we,"Expression error")}const _p={};kl.forEach(rt=>{_p[rt.key]=new Array(ss)});const Dp=new Array(ss);for(let rt=0;rt<ss;(rt+=1)-1){const He={};Ns.forEach((Tt,Pt)=>{const Xt=ae[Pt]||kl[Pt].key,yo=(Tt.source||Tt.name||"").replace(/\s+/g,"_").toLowerCase(),Vi=(Zr[yo]||Zr[Xt]||Zr.close)[rt];He[Xt]=Vi,_p[Xt][rt]=Vi}),He.__open=Zr.open[rt],He.__close=Zr.close[rt],He.__high=Zr.high[rt],He.__low=Zr.low[rt],Dp[rt]=He;const Ye=((Kp=Ie[rt])==null?void 0:Kp.timestamp)??((pv=Ie[rt])==null?void 0:pv.time)??((Rp=Ie[rt])==null?void 0:Rp.t);if(typeof Ye=="number"){const Tt=String(Ye);uu[Tt]=He,ru[Tt]=rt;const Pt=Ye<1e12?Math.floor(Ye*1e3):Math.floor(Ye);ru[`${Pt}_ms`]=rt,ru[`${Math.floor(Pt/1e3)}_s`]=rt}}const yc={},Ep=rt=>{const He=new Float32Array(ss);for(let Ye=0;Ye<ss;(Ye+=1)-1){const Tt=rt[Ye];He[Ye]=Tt??NaN}return He};Object.entries(Zr).forEach(([rt,He])=>{yc[rt.replace(/\s+/g,"_").toLowerCase()]=Ep(He)}),Object.entries(_p).forEach(([rt,He])=>{yc[rt]=Ep(He)});try{Object.entries(Pl).forEach(([rt,He])=>{const Ye=String(rt||"").replace(/\s+/g,"_").toLowerCase(),Tt=String(He||"");!Ye||!Tt||yc[Ye]||yc[Tt]&&(yc[Ye]=yc[Tt])})}catch{}{const rt=Object.keys(yc);for(const He of rt){if(!He.includes("_"))continue;const Ye=He.replace(/_/g,"");!Ye||Ye===He||yc[Ye]||(yc[Ye]=yc[He])}}if(Rd&&!fd&&Ae.length){try{const He=Ae.map(Ye=>String((Ye==null?void 0:Ye.name)||"")).map(Ye=>Ye.replace(/\s+/g,"_").toLowerCase()).filter(Boolean).filter(Ye=>!(Ye in Zr));if(He.length){const Ye=`Missing series: ${He.slice(0,6).join(", ")}${He.length>6?", ...":""}`;x(ze,D(n(ze)?`${n(ze)} • ${Ye}`:Ye))}}catch{}fd=!0}const lp=[];if(n(it)&&Array.isArray(ul)&&ul.length){const rt=((Av=N==null?void 0:N.style)==null?void 0:Av.labelLimit)??((Lv=et==null?void 0:et.style)==null?void 0:Lv.labelLimit)??(et==null?void 0:et.labelLimit),He=(()=>{const Pt=typeof rt=="number"?rt:Number(rt);return Number.isFinite(Pt)?Math.max(0,Math.floor(Pt)):600})();let Ye=0,Tt=!1;for(const Pt of ul){if(Tt)break;if(!Pt||!Pt.when)continue;const Xt=String(Pt.shape||"").toLowerCase()==="text"&&String(Pt.text||"").trim().length<=1;let yo;try{const Bn=Wl(String(Pt.when));try{yo=h2(Bn,yc)}catch{yo=sl(String(Pt.when),yc)}}catch{yo=sl(String(Pt.when),yc)}const Qo=(Pt.source||Pt.name||"").replace(/\s+/g,"_").toLowerCase(),Vi=Qo==="open"||Qo==="high"||Qo==="low"||Qo==="close"||Qo==="volume"||Qo==="time",fi=Pl[Qo],oo=fi||((gf=kl[0])==null?void 0:gf.key);if(!Xt&&(He===0||Ye>=He)){Tt=!0;break}const Po=[];for(let Bn=0;Bn<ss;(Bn+=1)-1)yo[Bn]&&Po.push(Bn);if(!Po.length)continue;const Ds=Xt?Po.length:Math.max(0,He-Ye);if(Ds<=0){Xt||(Tt=!0);break}const Wi=Po.length<=Ds?Po:(()=>{const Bn=Math.max(1,Math.ceil(Po.length/Ds)),Qn=[];for(let In=Po.length-1;In>=0&&Qn.length<Ds;In-=Bn)Qn.push(Po[In]);return Qn.sort((In,ma)=>In-ma),Qn})();for(const Bn of Wi){if(!Xt&&Ye>=He){Tt=!0;break}const Qn=Dp[Bn]||(Dp[Bn]={});let In=(Qo&&Zr[Qo]?Zr[Qo][Bn]:void 0)??(fi?Qn[fi]:void 0)??(oo?Qn[oo]:void 0);if(et.pane==="sub"&&Vi&&oo&&Qn[oo]!==void 0&&Qn[oo]!==null&&Number.isFinite(Qn[oo])&&(In=Qn[oo]),et.pane==="sub"&&typeof et.min=="number"&&typeof et.max=="number"&&Vi&&typeof In=="number"&&Number.isFinite(In)&&(In<et.min-5||In>et.max+5)&&(In=oo?Qn[oo]:In),In==null||Number.isNaN(In)){const ya=Pl.__zero__||"__zero__",ei=Qn[ya];In=ei??0}const ma=Vi&&Qo||oo,Bl=`__label_${ma}_${Pt.position||"above"}`;Qn[Bl]={text:Pt.text||"",color:Pt.color||"#f97316",yKey:ma,position:Pt.position||"above",value:In,shape:Pt.shape,bgColor:Pt.bgColor,borderColor:Pt.borderColor,textColor:Pt.textColor,size:Pt.size,offsetY:Pt.offsetY};const xn=((_u=Ie[Bn])==null?void 0:_u.timestamp)??((Vu=Ie[Bn])==null?void 0:Vu.time)??((Of=Ie[Bn])==null?void 0:Of.t),Ii=typeof xn=="number"&&Number.isFinite(xn)?xn<1e12?Math.floor(xn*1e3):Math.floor(xn):void 0;lp.push({index:Bn,ts:xn,tsMs:Ii,meta:Qn[Bl]}),Xt||(Ye+=1);try{z2("label",{pane:et.pane,index:Bn,meta:Qn[Bl]})}catch{}}}}const Wv=new Map,cf=rt=>Jl(String(rt||"").replace(/\$\{([^}]+)\}/g,(He,Ye)=>String(hl[Ye]??He))),Er=(rt,He)=>{const Ye=cf(rt);if(!Ye)return null;const Tt=Wv.get(Ye);if(Tt)return Tt;try{const Pt=xO(Ye,yc,hl);return Wv.set(Ye,Pt),Pt}catch(Pt){const Xt=(Pt==null?void 0:Pt.message)!=null?String(Pt.message):String(Pt);return n(ze)||x(ze,`Expression error: ${Xt}`),n(we)||x(we,"Expression error"),null}},$u=(rt,He)=>{if(!Number.isFinite(rt))return null;if(He==="time"){const Ye=rt<1e12?Math.floor(rt*1e3):Math.floor(rt),Tt=ru[String(rt)]??ru[`${Ye}_ms`]??ru[`${Math.floor(Ye/1e3)}_s`];return typeof Tt=="number"&&Number.isFinite(Tt)?Tt:null}return Math.round(rt)},Pv=(rt,He)=>{const Ye=[];if(rt)for(let Xt=0;Xt<ss;(Xt+=1)-1)rt[Xt]&&Ye.push(Xt);else for(let Xt=0;Xt<ss;(Xt+=1)-1)Ye.push(Xt);if(Ye.length<=He)return Ye;const Tt=Math.max(1,Math.ceil(Ye.length/He)),Pt=[];for(let Xt=Ye.length-1;Xt>=0&&Pt.length<He;Xt-=Tt)Pt.push(Ye[Xt]);return Pt.sort((Xt,yo)=>Xt-yo),Pt},Up=[],dv=[],Iv=[],qv=[];if(ra.length){const rt=new Map,He=bo=>{const $e=String(bo||"").trim();return $e?$e.replace(/\s+/g,"_").toLowerCase():null},Ye=(bo,$e)=>{const Vo=He(bo);return Vo?$e.get(Vo)||Vo:null},Tt=(bo,$e)=>{const Vo=String(bo||"").trim();if(!Vo)return!0;let ro=rt.get(Vo);if(!ro){try{ro=sl(Vo,yc)}catch{ro=null}rt.set(Vo,ro)}return ro?!!ro[$e]:!1},Pt=(bo,$e,Vo)=>{if(!bo)return;const ro=Er(String(bo));if(!ro)return;const hn=ro[Vo];return Number.isFinite(hn)?hn:void 0},Xt=(bo,$e,Vo,ro)=>{if(bo!=null)return String(bo);if(!$e)return"";const hn=Pt($e,Vo,ro);return Number.isFinite(hn)?String(hn.toFixed(2)):""},yo=(bo,$e,Vo)=>{for(;bo.length>Vo;){const ro=bo.shift();ro&&$e.delete(ro)}},Qo=new Map,Vi=new Map,fi=new Map,oo=new Map,Po=new Map,Ds=new Map,Wi=new Map,Bn=new Map,Qn=new Map,In=new Map,ma=[],Bl=[],xn=[],Ii=[],ya=[];let ei=0,Zl=0,Jc=0,Zn=0,bd=0;const rc=240,Hc=300,Tl=180,Rc=20,Kn=120;for(let bo=0;bo<ss;(bo+=1)-1)for(const $e of ra)if(!(!$e||!Tt($e.when,bo))){if($e.kind==="line_new"){const Vo=He($e.assign);if($e.once&&Vo&&Qo.has(Vo))continue;const ro=Pt($e.x1,"line.x1",bo),hn=Pt($e.y1,"line.y1",bo),qn=Pt($e.x2,"line.x2",bo),Fn=Pt($e.y2,"line.y2",bo);if(ro==null||hn==null||qn==null||Fn==null)continue;const Qi=`line_${ei+=1}`,Di=$e.width??Pt($e.widthExpr,"line.width",bo)??void 0;Ds.set(Qi,{x1:ro,y1:hn,x2:qn,y2:Fn,color:$e.color,width:Di,style:$e.style,extend:$e.extend,xloc:$e.xloc}),ma.push(Qi),yo(ma,Ds,rc),Vo&&Qo.set(Vo,Qi);continue}if($e.kind==="line_set"){const Vo=Ye($e.target,Qo);if(!Vo)continue;const ro=Ds.get(Vo);if(!ro)continue;const hn=Pt($e.x1,"line.set_x1",bo),qn=Pt($e.y1,"line.set_y1",bo),Fn=Pt($e.x2,"line.set_x2",bo),Qi=Pt($e.y2,"line.set_y2",bo);if(hn!=null&&(ro.x1=hn),qn!=null&&(ro.y1=qn),Fn!=null&&(ro.x2=Fn),Qi!=null&&(ro.y2=Qi),$e.color&&(ro.color=$e.color),$e.width!=null||$e.widthExpr){const Di=$e.width??Pt($e.widthExpr,"line.set_width",bo);Di!=null&&(ro.width=Di)}$e.style&&(ro.style=$e.style),$e.extend&&(ro.extend=$e.extend),$e.xloc&&(ro.xloc=$e.xloc);continue}if($e.kind==="line_delete"){const Vo=Ye($e.target,Qo);if(!Vo)continue;Ds.delete(Vo);const ro=ma.indexOf(Vo);ro>=0&&ma.splice(ro,1);continue}if($e.kind==="linefill_new"){const Vo=He($e.assign);if($e.once&&Vo&&Vi.has(Vo))continue;const ro=Ye($e.line1,Qo),hn=Ye($e.line2,Qo);if(!ro||!hn)continue;const qn=`linefill_${Zl+=1}`;Wi.set(qn,{line1:ro,line2:hn,color:$e.color}),Bl.push(qn),yo(Bl,Wi,Kn),Vo&&Vi.set(Vo,qn);continue}if($e.kind==="linefill_set"){const Vo=Ye($e.target,Vi);if(!Vo)continue;const ro=Wi.get(Vo);if(!ro)continue;if($e.color&&(ro.color=$e.color),$e.line1){const hn=Ye($e.line1,Qo);hn&&(ro.line1=hn)}if($e.line2){const hn=Ye($e.line2,Qo);hn&&(ro.line2=hn)}continue}if($e.kind==="linefill_delete"){const Vo=Ye($e.target,Vi);if(!Vo)continue;Wi.delete(Vo);const ro=Bl.indexOf(Vo);ro>=0&&Bl.splice(ro,1);continue}if($e.kind==="label_new"){const Vo=He($e.assign);if($e.once&&Vo&&fi.has(Vo))continue;const ro=Pt($e.x,"label.x",bo),hn=Pt($e.y,"label.y",bo);if(ro==null||hn==null)continue;const qn=`label_${Jc+=1}`,Fn=$e.size??Pt($e.sizeExpr,"label.size",bo)??void 0;Bn.set(qn,{x:ro,y:hn,text:Xt($e.text,$e.textExpr,"label.text",bo),color:$e.color,textColor:$e.textColor,shape:$e.style,size:Fn,xloc:$e.xloc,yloc:$e.yloc,textAlign:$e.textAlign,tooltip:$e.tooltip}),xn.push(qn),yo(xn,Bn,Hc),Vo&&fi.set(Vo,qn);continue}if($e.kind==="label_set"){const Vo=Ye($e.target,fi);if(!Vo)continue;const ro=Bn.get(Vo);if(!ro)continue;const hn=Pt($e.x,"label.set_x",bo),qn=Pt($e.y,"label.set_y",bo);if(hn!=null&&(ro.x=hn),qn!=null&&(ro.y=qn),($e.text!=null||$e.textExpr)&&(ro.text=Xt($e.text,$e.textExpr,"label.set_text",bo)),$e.color&&(ro.color=$e.color),$e.textColor&&(ro.textColor=$e.textColor),$e.style&&(ro.shape=$e.style),$e.size!=null||$e.sizeExpr){const Fn=$e.size??Pt($e.sizeExpr,"label.set_size",bo);Fn!=null&&(ro.size=Fn)}$e.yloc&&(ro.yloc=$e.yloc),$e.textAlign&&(ro.textAlign=$e.textAlign),$e.tooltip&&(ro.tooltip=$e.tooltip),$e.xloc&&(ro.xloc=$e.xloc);continue}if($e.kind==="label_delete"){const Vo=Ye($e.target,fi);if(!Vo)continue;Bn.delete(Vo);const ro=xn.indexOf(Vo);ro>=0&&xn.splice(ro,1);continue}if($e.kind==="box_new"){const Vo=He($e.assign);if($e.once&&Vo&&oo.has(Vo))continue;const ro=Pt($e.left,"box.left",bo),hn=Pt($e.right,"box.right",bo),qn=Pt($e.top,"box.top",bo),Fn=Pt($e.bottom,"box.bottom",bo);if(ro==null||hn==null||qn==null||Fn==null)continue;const Qi=`box_${Zn+=1}`,Di=$e.width??Pt($e.widthExpr,"box.border_width",bo)??void 0,Oa=$e.textSize??Pt($e.textSizeExpr,"box.text_size",bo)??void 0;Qn.set(Qi,{left:ro,right:hn,top:qn,bottom:Fn,borderColor:$e.borderColor,bgColor:$e.bgColor,borderWidth:Di,borderStyle:$e.borderStyle,text:Xt($e.text,$e.textExpr,"box.text",bo),textColor:$e.textColor,textSize:Oa,textHalign:$e.textHalign,textValign:$e.textValign,textWrap:$e.textWrap,extend:$e.extend,xloc:$e.xloc}),Ii.push(Qi),yo(Ii,Qn,Tl),Vo&&oo.set(Vo,Qi);continue}if($e.kind==="box_set"){const Vo=Ye($e.target,oo);if(!Vo)continue;const ro=Qn.get(Vo);if(!ro)continue;const hn=Pt($e.left,"box.set_left",bo),qn=Pt($e.right,"box.set_right",bo),Fn=Pt($e.top,"box.set_top",bo),Qi=Pt($e.bottom,"box.set_bottom",bo);if(hn!=null&&(ro.left=hn),qn!=null&&(ro.right=qn),Fn!=null&&(ro.top=Fn),Qi!=null&&(ro.bottom=Qi),$e.borderColor&&(ro.borderColor=$e.borderColor),$e.bgColor&&(ro.bgColor=$e.bgColor),$e.width!=null||$e.widthExpr){const Di=$e.width??Pt($e.widthExpr,"box.set_border_width",bo);Di!=null&&(ro.borderWidth=Di)}if($e.borderStyle&&(ro.borderStyle=$e.borderStyle),($e.text!=null||$e.textExpr)&&(ro.text=Xt($e.text,$e.textExpr,"box.set_text",bo)),$e.textColor&&(ro.textColor=$e.textColor),$e.textSize!=null||$e.textSizeExpr){const Di=$e.textSize??Pt($e.textSizeExpr,"box.set_text_size",bo);Di!=null&&(ro.textSize=Di)}$e.textHalign&&(ro.textHalign=$e.textHalign),$e.textValign&&(ro.textValign=$e.textValign),typeof $e.textWrap=="boolean"&&(ro.textWrap=$e.textWrap),$e.extend&&(ro.extend=$e.extend),$e.xloc&&(ro.xloc=$e.xloc);continue}if($e.kind==="box_delete"){const Vo=Ye($e.target,oo);if(!Vo)continue;Qn.delete(Vo);const ro=Ii.indexOf(Vo);ro>=0&&Ii.splice(ro,1);continue}if($e.kind==="table_new"){const Vo=He($e.assign);if($e.once&&Vo&&Po.has(Vo))continue;const ro=Math.max(1,Math.floor(Number($e.columns??0))),hn=Math.max(1,Math.floor(Number($e.rows??0)));if(!ro||!hn)continue;const qn=`table_${bd+=1}`;In.set(qn,{id:qn,position:$e.position||"top_right",columns:ro,rows:hn,bgcolor:$e.bgcolor,borderColor:$e.borderColor,borderWidth:$e.borderWidth??Pt($e.borderWidthExpr,"table.border_width",bo)??void 0,textColor:$e.textColor,textSize:$e.textSize??Pt($e.textSizeExpr,"table.text_size",bo)??void 0,textHalign:$e.textHalign,textValign:$e.textValign,frameColor:$e.frameColor,frameWidth:$e.frameWidth??Pt($e.frameWidthExpr,"table.frame_width",bo)??void 0,cells:new Map,merges:[]}),ya.push(qn),yo(ya,In,Rc),Vo&&Po.set(Vo,qn);continue}if($e.kind==="table_set"){const Vo=Ye($e.target,Po);if(!Vo)continue;const ro=In.get(Vo);if(!ro)continue;if($e.position&&(ro.position=$e.position),$e.bgcolor&&(ro.bgcolor=$e.bgcolor),$e.borderColor&&(ro.borderColor=$e.borderColor),$e.borderWidth!=null||$e.borderWidthExpr){const hn=$e.borderWidth??Pt($e.borderWidthExpr,"table.set_border_width",bo);hn!=null&&(ro.borderWidth=hn)}if($e.textColor&&(ro.textColor=$e.textColor),$e.textSize!=null||$e.textSizeExpr){const hn=$e.textSize??Pt($e.textSizeExpr,"table.set_text_size",bo);hn!=null&&(ro.textSize=hn)}if($e.textHalign&&(ro.textHalign=$e.textHalign),$e.textValign&&(ro.textValign=$e.textValign),$e.frameColor&&(ro.frameColor=$e.frameColor),$e.frameWidth!=null||$e.frameWidthExpr){const hn=$e.frameWidth??Pt($e.frameWidthExpr,"table.set_frame_width",bo);hn!=null&&(ro.frameWidth=hn)}continue}if($e.kind==="table_delete"){const Vo=Ye($e.target,Po);if(!Vo)continue;In.delete(Vo);const ro=ya.indexOf(Vo);ro>=0&&ya.splice(ro,1);continue}if($e.kind==="table_clear"){const Vo=Ye($e.target,Po);if(!Vo)continue;const ro=In.get(Vo);if(!ro)continue;if(!($e.startColumn!=null||$e.startRow!=null||$e.endColumn!=null||$e.endRow!=null)){(zv=(vv=ro.cells)==null?void 0:vv.clear)==null||zv.call(vv),ro.merges=[];continue}const qn=Pt($e.startColumn,"table.clear_start_col",bo),Fn=Pt($e.startRow,"table.clear_start_row",bo),Qi=Pt($e.endColumn,"table.clear_end_col",bo),Di=Pt($e.endRow,"table.clear_end_row",bo);if(qn==null||Fn==null||Qi==null||Di==null){(hf=(bp=ro.cells)==null?void 0:bp.clear)==null||hf.call(bp),ro.merges=[];continue}const Oa=Math.min(Math.floor(qn),Math.floor(Qi)),Lc=Math.max(Math.floor(qn),Math.floor(Qi)),au=Math.min(Math.floor(Fn),Math.floor(Di)),yu=Math.max(Math.floor(Fn),Math.floor(Di)),xp=ro.cells||new Map;for(const Wu of Array.from(xp.keys())){const[Xu,Vf]=String(Wu).split(":"),Zv=Number(Xu),Wf=Number(Vf);Zv>=Oa&&Zv<=Lc&&Wf>=au&&Wf<=yu&&xp.delete(Wu)}ro.cells=xp,Array.isArray(ro.merges)&&ro.merges.length&&(ro.merges=ro.merges.filter(Wu=>{if(!Wu)return!1;const Xu=Math.min(Wu.left,Wu.right),Vf=Math.max(Wu.left,Wu.right),Zv=Math.min(Wu.top,Wu.bottom),Wf=Math.max(Wu.top,Wu.bottom);return!(Xu<=Lc&&Vf>=Oa&&Zv<=yu&&Wf>=au)}));continue}if($e.kind==="table_merge"){const Vo=Ye($e.target,Po);if(!Vo)continue;const ro=In.get(Vo);if(!ro)continue;const hn=Pt($e.left,"table.merge_left",bo),qn=Pt($e.top,"table.merge_top",bo),Fn=Pt($e.right,"table.merge_right",bo),Qi=Pt($e.bottom,"table.merge_bottom",bo);if(hn==null||qn==null||Fn==null||Qi==null)continue;const Di=Math.min(Math.floor(hn),Math.floor(Fn)),Oa=Math.max(Math.floor(hn),Math.floor(Fn)),Lc=Math.min(Math.floor(qn),Math.floor(Qi)),au=Math.max(Math.floor(qn),Math.floor(Qi));ro.columns=Math.max(ro.columns||1,Oa+1),ro.rows=Math.max(ro.rows||1,au+1),Array.isArray(ro.merges)||(ro.merges=[]);const yu=`${Di}:${Lc}:${Oa}:${au}`;ro.merges.some(xp=>`${xp.left}:${xp.top}:${xp.right}:${xp.bottom}`===yu)||ro.merges.push({left:Di,top:Lc,right:Oa,bottom:au});continue}if($e.kind==="table_cell"||$e.kind==="table_cell_set"){const Vo=Ye($e.target,Po);if(!Vo)continue;let ro=In.get(Vo);ro||(ro={id:Vo,position:"top_right",columns:Math.max(1,Math.floor(Number($e.column??0)+1)),rows:Math.max(1,Math.floor(Number($e.row??0)+1)),cells:new Map,merges:[]},In.set(Vo,ro),ya.push(Vo),yo(ya,In,Rc)),ro.columns=Math.max(ro.columns||1,Math.floor(Number($e.column??0)+1)),ro.rows=Math.max(ro.rows||1,Math.floor(Number($e.row??0)+1));const hn=`${$e.column??0}:${$e.row??0}`,qn=ro.cells.get(hn)||{column:Math.floor(Number($e.column??0)),row:Math.floor(Number($e.row??0))};if(($e.text!=null||$e.textExpr)&&(qn.text=Xt($e.text,$e.textExpr,"table.cell_text",bo)),$e.textColor&&(qn.textColor=$e.textColor),$e.bgcolor&&(qn.bgcolor=$e.bgcolor),$e.textSize!=null||$e.textSizeExpr){const Fn=$e.textSize??Pt($e.textSizeExpr,"table.cell_text_size",bo);Fn!=null&&(qn.textSize=Fn)}if($e.textHalign&&(qn.textHalign=$e.textHalign),$e.textValign&&(qn.textValign=$e.textValign),$e.width!=null||$e.widthExpr){const Fn=$e.width??Pt($e.widthExpr,"table.cell_width",bo);Fn!=null&&(qn.width=Fn)}if($e.height!=null||$e.heightExpr){const Fn=$e.height??Pt($e.heightExpr,"table.cell_height",bo);Fn!=null&&(qn.height=Fn)}$e.tooltip&&(qn.tooltip=$e.tooltip),ro.cells.set(hn,qn);continue}}if(n(it)){let bo=0;for(const $e of Bn.values()){if(bo>=Hc)break;const Vo=$u($e.x,$e.xloc);if(Vo==null||Vo<0||Vo>=ss)continue;const ro=$e.yloc;let hn=$e.y;if(ro==="abovebar"||ro==="belowbar"){const Oa=Ie[Vo],Lc=(Oa==null?void 0:Oa.high)??(Oa==null?void 0:Oa.h),au=(Oa==null?void 0:Oa.low)??(Oa==null?void 0:Oa.l);ro==="abovebar"&&Number.isFinite(Lc)&&(hn=Lc),ro==="belowbar"&&Number.isFinite(au)&&(hn=au)}if(!Number.isFinite(hn))continue;const qn=Dp[Vo]||(Dp[Vo]={}),Fn=`__label_rt_${Vo}_${lp.length}`;qn[Fn]={text:$e.text||"",color:$e.color||"#f97316",yKey:"__rt__",position:ro==="belowbar"?"below":"above",value:hn,shape:$e.shape,textColor:$e.textColor,textAlign:$e.textAlign,tooltip:$e.tooltip,size:$e.size,offsetY:0};const Qi=((Yn=Ie[Vo])==null?void 0:Yn.timestamp)??((vs=Ie[Vo])==null?void 0:vs.time)??((_a=Ie[Vo])==null?void 0:_a.t),Di=typeof Qi=="number"&&Number.isFinite(Qi)?Qi<1e12?Math.floor(Qi*1e3):Math.floor(Qi):void 0;lp.push({index:Vo,ts:Qi,tsMs:Di,meta:qn[Fn]}),bo+=1}}const li=new Map;for(const[bo,$e]of Ds.entries()){const Vo=$u($e.x1,$e.xloc),ro=$u($e.x2,$e.xloc);if(Vo==null||ro==null||!Number.isFinite($e.y1)||!Number.isFinite($e.y2))continue;const hn=ro!==Vo?($e.y2-$e.y1)/(ro-Vo):void 0,qn=hn!=null?$e.y1-hn*Vo:void 0,Fn={id:bo,startIndex:Vo,endIndex:ro,startValue:$e.y1,endValue:$e.y2,slope:hn,intercept:qn,color:$e.color,width:$e.width,style:$e.style,extend:$e.extend};li.set(bo,Fn),Up.push(Fn)}for(const bo of Wi.values()){if(!bo)continue;const $e=li.get(bo.line1),Vo=li.get(bo.line2);!$e||!Vo||dv.push({line1:$e,line2:Vo,color:bo.color})}for(const bo of Qn.values()){const $e=$u(bo.left,bo.xloc),Vo=$u(bo.right,bo.xloc);$e==null||Vo==null||!Number.isFinite(bo.top)||!Number.isFinite(bo.bottom)||Iv.push({leftIndex:$e,rightIndex:Vo,topValue:bo.top,bottomValue:bo.bottom,borderColor:bo.borderColor,bgColor:bo.bgColor,borderWidth:bo.borderWidth,borderStyle:bo.borderStyle,text:bo.text,textColor:bo.textColor,textSize:bo.textSize,textHalign:bo.textHalign,textValign:bo.textValign,textWrap:bo.textWrap,extend:bo.extend})}for(const bo of In.values()){const $e=[];(bo.cells||new Map).forEach(ro=>{$e.push({column:Math.floor(Number(ro.column??0)),row:Math.floor(Number(ro.row??0)),text:ro.text||"",textColor:ro.textColor,bgcolor:ro.bgcolor,textSize:ro.textSize,textHalign:ro.textHalign,textValign:ro.textValign,width:ro.width,height:ro.height,tooltip:ro.tooltip})}),qv.push({id:bo.id,position:bo.position,columns:Math.max(1,Math.floor(Number(bo.columns??1))),rows:Math.max(1,Math.floor(Number(bo.rows??1))),bgcolor:bo.bgcolor,borderColor:bo.borderColor,textColor:bo.textColor,frameColor:bo.frameColor,borderWidth:bo.borderWidth,frameWidth:bo.frameWidth,textSize:bo.textSize,textHalign:bo.textHalign,textValign:bo.textValign,cells:$e,merges:Array.isArray(bo.merges)?bo.merges:[]})}}if(n(it)&&ki.length)for(const He of ki){if(!He||!He.x||!He.y)continue;const Ye=String(He.when||"").trim();let Tt=null;if(Ye)try{Tt=sl(Ye,yc)}catch{Tt=null}const Pt=Er(String(He.x)),Xt=Er(String(He.y));if(!Pt||!Xt)continue;const yo=Pv(Tt,300),Qo=He.textExpr?String(He.textExpr):"",Vi=Qo?Er(Qo):null;for(const fi of yo){const oo=Pt[fi],Po=$u(oo,He.xloc);if(Po==null||Po<0||Po>=ss)continue;let Wi=Xt[fi];if(He.yloc==="abovebar"||He.yloc==="belowbar"){const xn=Ie[Po],Ii=(xn==null?void 0:xn.high)??(xn==null?void 0:xn.h),ya=(xn==null?void 0:xn.low)??(xn==null?void 0:xn.l);He.yloc==="abovebar"&&Number.isFinite(Ii)&&(Wi=Ii),He.yloc==="belowbar"&&Number.isFinite(ya)&&(Wi=ya)}if(!Number.isFinite(Wi))continue;const Bn=He.text!=null?String(He.text):Vi&&Number.isFinite(Vi[fi])?String(Vi[fi].toFixed(2)):"",Qn=Dp[Po]||(Dp[Po]={}),In=`__label_rt_${Po}_${lp.length}`;Qn[In]={text:Bn,color:He.color||"#f97316",yKey:"__rt__",position:He.yloc==="belowbar"?"below":"above",value:Wi,shape:He.shape,textColor:He.textColor,textAlign:He.textAlign,tooltip:He.tooltip,size:He.size,offsetY:0};const ma=((Vr=Ie[Po])==null?void 0:Vr.timestamp)??((Ps=Ie[Po])==null?void 0:Ps.time)??((hi=Ie[Po])==null?void 0:hi.t),Bl=typeof ma=="number"&&Number.isFinite(ma)?ma<1e12?Math.floor(ma*1e3):Math.floor(ma):void 0;lp.push({index:Po,ts:ma,tsMs:Bl,meta:Qn[In]})}}uu.__labelItems=lp,uu.__tsIndex=ru;const vu=[];if(Ls.length)for(const He of Ls){if(!He)continue;const Ye=String(He.when||"").trim();let Tt=null;if(Ye)try{Tt=sl(Ye,yc)}catch{Tt=null}const Pt=Er(String(He.x1)),Xt=Er(String(He.y1)),yo=Er(String(He.x2)),Qo=Er(String(He.y2));if(!Pt||!Xt||!yo||!Qo)continue;const Vi=Pv(Tt,240);for(const fi of Vi){const oo=$u(Pt[fi],He.xloc),Po=$u(yo[fi],He.xloc);if(oo==null||Po==null)continue;const Ds=Xt[fi],Wi=Qo[fi];if(!Number.isFinite(Ds)||!Number.isFinite(Wi))continue;const Bn=Po!==oo?(Wi-Ds)/(Po-oo):void 0,Qn=Bn!=null?Ds-Bn*oo:void 0;vu.push({startIndex:oo,endIndex:Po,startValue:Ds,endValue:Wi,slope:Bn,intercept:Qn,color:He.color,width:He.width,style:He.style,extend:He.extend})}}const df=[];if(Rl.length)for(const He of Rl){if(!He)continue;const Ye=String(He.when||"").trim();let Tt=null;if(Ye)try{Tt=sl(Ye,yc)}catch{Tt=null}const Pt=Er(String(He.left)),Xt=Er(String(He.right)),yo=Er(String(He.top)),Qo=Er(String(He.bottom)),Vi=He.textExpr?String(He.textExpr):"",fi=Vi?Er(Vi):null;if(!Pt||!Xt||!yo||!Qo)continue;const oo=Pv(Tt,180);for(const Po of oo){const Ds=$u(Pt[Po],He.xloc),Wi=$u(Xt[Po],He.xloc);if(Ds==null||Wi==null)continue;const Bn=yo[Po],Qn=Qo[Po];if(!Number.isFinite(Bn)||!Number.isFinite(Qn))continue;const In=He.text!=null?String(He.text):fi&&Number.isFinite(fi[Po])?String(fi[Po].toFixed(2)):"";df.push({leftIndex:Ds,rightIndex:Wi,topValue:Bn,bottomValue:Qn,borderColor:He.borderColor,bgColor:He.bgColor,borderWidth:He.borderWidth,borderStyle:He.borderStyle,text:In,textColor:He.textColor,textSize:He.textSize,textHalign:He.textHalign,textValign:He.textValign,textWrap:He.textWrap,extend:He.extend})}}const Np=[];if(mc.length){const rt=Math.max(0,ss-1);for(const He of mc){if(!He)continue;const Ye=Math.max(1,Math.floor(Number(He.columns??1))),Tt=Math.max(1,Math.floor(Number(He.rows??1))),Pt=[],Xt=Array.isArray(He.cells)?He.cells:[];for(const yo of Xt){if(!yo)continue;const Qo=String(yo.when||"").trim();if(Qo)try{if(!sl(Qo,yc)[rt])continue}catch{}let Vi="";if(yo.text!=null)Vi=String(yo.text);else if(yo.textExpr){const fi=Er(String(yo.textExpr)),oo=fi?fi[rt]:NaN;Vi=Number.isFinite(oo)?String(oo.toFixed(2)):""}Pt.push({column:Math.floor(Number(yo.column??0)),row:Math.floor(Number(yo.row??0)),text:Vi,textColor:yo.textColor,bgcolor:yo.bgcolor,textSize:yo.textSize,textHalign:yo.textHalign,textValign:yo.textValign,width:yo.width,height:yo.height,tooltip:yo.tooltip})}Np.push({id:He.id,position:He.position,columns:Ye,rows:Tt,bgcolor:He.bgcolor,borderColor:He.borderColor,textColor:He.textColor,frameColor:He.frameColor,borderWidth:He.borderWidth,frameWidth:He.frameWidth,textSize:He.textSize,textHalign:He.textHalign,textValign:He.textValign,cells:Pt,merges:Array.isArray(He.merges)?He.merges:[]})}}if(uu.__runtimeLineDefs=vu.length||Up.length?vu.concat(Up):[],uu.__runtimeLineFills=dv.length?dv:[],uu.__runtimeBoxDefs=df.length||Iv.length?df.concat(Iv):[],uu.__runtimeTables=Np.length||qv.length?Np.concat(qv):[],Array.isArray(ql)&&ql.length){let rt=[];const He=Ye=>{const Tt=[];for(let Pt=ss-1;Pt>=0&&Tt.length<2;(Pt-=1)+1){const Xt=Ye[Pt];Xt!=null&&Number.isFinite(Xt)&&Tt.push(Pt)}return Tt.reverse()};if(ql.forEach(Ye=>{const Tt=String(Ye.start||"").replace(/\s+/g,"_").toLowerCase(),Pt=String(Ye.end||"").replace(/\s+/g,"_").toLowerCase();let yo=Il[Tt]||Il[Pt]||"";yo||(/low/i.test(Tt)||/low/i.test(Pt)?yo="pl":(/high/i.test(Tt)||/high/i.test(Pt))&&(yo="ph"));const Vi=(Ye.segmentsFrom?String(Ye.segmentsFrom):"").replace(/\s+/g,"_").toLowerCase(),fi=Zr[yo],oo=Vi&&Zr[Vi]||void 0,Po=oo||fi||Zr.ph||Zr.pl;if(Po)if(oo){const Ds=[];for(let In=0;In<ss;(In+=1)-1){const ma=oo[In];ma!=null&&Number.isFinite(ma)&&Ds.push(In)}const Wi=Math.max(1,Number(Ye.maxSegments)||Ds.length-1),Bn=Math.min(Wi,24);let Qn=0;for(let In=Ds.length-2;In>=0&&!(Qn>=Bn);(In-=1)+1){const ma=Ds[In],Bl=Ds[In+1],xn=oo[ma],Ii=oo[Bl];if(!Number.isFinite(xn)||!Number.isFinite(Ii)||Bl===ma)continue;const ya=(Ii-xn)/(Bl-ma),ei=xn-ya*ma;let Zl=!1;const Jc=Math.max(ma,ss-80);let Zn=NaN;for(let bd=Jc;bd<=Math.min(Bl,ss-1);(bd+=1)-1){const rc=ya*bd+ei,Hc=Zr.close[bd];if(!Number.isFinite(rc)||!Number.isFinite(Hc))continue;const Tl=Hc-rc;if(!Number.isNaN(Zn)&&Tl*Zn<0){Zl=!0;break}Zn=Tl}Zl||(rt.push({startIndex:ma,endIndex:Bl,startValue:xn,endValue:Ii,slope:ya,intercept:ei,color:Ye.color||"#64748b",width:Ye.width??1,style:(Ye.style||"dotted").toLowerCase(),extend:Ye.extend||"right",name:Ye.name}),Qn+=1)}}else{const Ds=He(Po);if(Ds.length===2){const Wi=Ds[0],Bn=Ds[1],Qn=Po[Wi],In=Po[Bn];if(Number.isFinite(Qn)&&Number.isFinite(In)){const ma=(In-Qn)/(Bn-Wi),Bl=Qn-ma*Wi;let xn=!1;const Ii=Math.max(Wi,ss-80);let ya=NaN;for(let ei=Ii;ei<=Math.min(Bn,ss-1);(ei+=1)-1){const Zl=ma*ei+Bl,Jc=Zr.close[ei];if(!Number.isFinite(Zl)||!Number.isFinite(Jc))continue;const Zn=Jc-Zl;if(!Number.isNaN(ya)&&Zn*ya<0){xn=!0;break}ya=Zn}if(xn)return;rt.push({startIndex:Wi,endIndex:Bn,startValue:Qn,endValue:In,slope:ma,intercept:Bl,color:Ye.color||"#22c55e",width:Ye.width??2,style:(Ye.style||"solid").toLowerCase(),extend:Ye.extend||"none",name:Ye.name})}}}}),rt.length){const Ye=[],Tt=new Set;for(const Pt of rt){const Xt=Math.round((Pt.slope||0)*1e4),yo=Math.round((Pt.intercept||0)*100),Qo=`${Xt}:${yo}:${Pt.style}:${Pt.color}:${Pt.extend}`;Tt.has(Qo)||(Tt.add(Qo),Ye.push(Pt))}rt=Ye.slice(0,60)}if(!rt.length){const Ye=(Tt,Pt,Xt,yo)=>{const Qo=String(Tt||"").replace(/\s+/g,"_").toLowerCase(),Vi=Zr[Qo];if(!Vi)return;const fi=[];for(let oo=0;oo<ss;(oo+=1)-1){const Po=Vi[oo];Po!=null&&Number.isFinite(Po)&&fi.push(oo)}if(fi.length>=2){const oo=fi[fi.length-2],Po=fi[fi.length-1],Ds=Vi[oo],Wi=Vi[Po];if(Number.isFinite(Ds)&&Number.isFinite(Wi)&&Po!==oo){const Bn=(Wi-Ds)/(Po-oo),Qn=Ds-Bn*oo;rt.push({startIndex:oo,endIndex:Po,startValue:Ds,endValue:Wi,slope:Bn,intercept:Qn,color:Pt,width:yo,style:Xt,extend:"right",name:Qo})}}};Ye("ph","#64748b","dotted",1),Ye("pl","#64748b","dotted",1)}uu.__lineDefs=rt}if(Rd&&(io.length||N!=null&&N.strategy)){const rt=od;try{const He=Ie.map(Xt=>({timestamp:Xt.timestamp??Xt.time??0})),Ye=io.map(Xt=>({...Xt,when:rd(String((Xt==null?void 0:Xt.when)||"")),cooldownBars:typeof(Xt==null?void 0:Xt.cooldownBars)=="number"&&Number.isFinite(Xt.cooldownBars)?Math.max(0,Math.floor(Xt.cooldownBars)):void 0}));Ye.forEach((Xt,yo)=>{!Xt||Xt.id!=null||(Xt.id=String(yo))});const Tt=(Xt,yo)=>{var qn;let Qo=new Array(yo).fill(0),Vi=new Array(yo).fill(0),fi=new Array(yo).fill(0),oo=new Array(yo).fill(0),Po=new Array(yo).fill(0),Ds=new Array(yo).fill(0),Wi=new Array(yo).fill(0),Bn=new Array(yo).fill(0),Qn=new Array(yo).fill(0),In=new Array(yo).fill(0),ma=new Array(yo).fill(0),Bl=new Array(yo).fill(0);const xn=((qn=Xt==null?void 0:Xt.summary)==null?void 0:qn.initialCapital)??0;let Ii=new Array(yo).fill(xn),ya=new Array(yo).fill(0);if(!Xt)return{positionSize:Qo,positionAvgPrice:Vi,openTrades:fi,closedTrades:oo,openProfit:Po,closedProfit:Ds,grossProfit:Wi,grossLoss:Bn,winTrades:Qn,lossTrades:In,winRate:ma,maxDrawdownPct:Bl,equity:Ii,netProfit:ya,initialCapital:xn};const ei=Xt==null?void 0:Xt.series,Zl=Fn=>Array.isArray(Fn)&&Fn.length===yo?Fn:null,Jc=Zl(ei==null?void 0:ei.positionSize),Zn=Zl(ei==null?void 0:ei.positionAvgPrice),bd=Zl(ei==null?void 0:ei.openTrades),rc=Zl(ei==null?void 0:ei.closedTrades),Hc=Zl(ei==null?void 0:ei.openProfit),Tl=Zl(ei==null?void 0:ei.closedProfit),Rc=Zl(ei==null?void 0:ei.grossProfit),Kn=Zl(ei==null?void 0:ei.grossLoss),li=Zl(ei==null?void 0:ei.winTrades),bo=Zl(ei==null?void 0:ei.lossTrades),$e=Zl(ei==null?void 0:ei.winRate),Vo=Zl(ei==null?void 0:ei.maxDrawdownPct),ro=Zl(ei==null?void 0:ei.equity),hn=Zl(ei==null?void 0:ei.netProfit);if(Jc&&(Qo=Jc),Zn&&(Vi=Zn),bd&&(fi=bd),rc&&(oo=rc),Hc&&(Po=Hc),Tl&&(Ds=Tl),Rc&&(Wi=Rc),Kn&&(Bn=Kn),li&&(Qn=li),bo&&(In=bo),$e&&(ma=$e),Vo&&(Bl=Vo),ro&&(Ii=ro),hn&&(ya=hn),!Jc){const Fn=new Array(yo);for(const Di of Xt.orders||[]){if(!Di||Di.status!=="filled")continue;const Oa=Di==null?void 0:Di.filledIndex,Lc=typeof Oa=="number"&&Number.isFinite(Oa)?Math.floor(Oa):-1;if(Lc<0||Lc>=yo)continue;const au=Di==null?void 0:Di.fillQty,yu=typeof au=="number"?au:Number(au);if(!Number.isFinite(yu)||yu===0)continue;const xp=String((Di==null?void 0:Di.side)||"").toLowerCase(),Wu=String((Di==null?void 0:Di.action)||"").toLowerCase();let Xu=0;Wu==="entry"?Xu=xp==="short"?-yu:yu:Wu==="exit"&&(Xu=xp==="short"?yu:-yu),!(!Number.isFinite(Xu)||Xu===0)&&(Fn[Lc]||(Fn[Lc]=[]),Fn[Lc].push(Xu))}let Qi=0;for(let Di=0;Di<yo;(Di+=1)-1){const Oa=Fn[Di];if(Oa)for(const Lc of Oa)Qi+=Lc;Qo[Di]=Qi}}if(!bd||!rc){const Fn=new Int32Array(yo+1),Qi=new Int32Array(yo+1);for(const Lc of Xt.roundTrips||[]){const au=typeof Lc.entryIndex=="number"&&Number.isFinite(Lc.entryIndex)?Math.max(0,Math.floor(Lc.entryIndex)):-1,yu=typeof Lc.exitIndex=="number"&&Number.isFinite(Lc.exitIndex)?Math.max(0,Math.floor(Lc.exitIndex)):-1;au>=0&&au<yo&&(Fn[au]+=1),yu>=0&&yu<yo&&(Fn[yu]-=1,Qi[yu]+=1)}let Di=0,Oa=0;for(let Lc=0;Lc<yo;(Lc+=1)-1){Di+=Fn[Lc],Oa+=Qi[Lc];const au=Qo[Lc]!==0;bd||(fi[Lc]=Di>0?Di:au?1:0),rc||(oo[Lc]=Oa)}}if(!ro&&Array.isArray(Xt.equity)&&Xt.equity.length){for(const Qi of Xt.equity){const Di=Number(Qi==null?void 0:Qi.index),Oa=Number(Qi==null?void 0:Qi.equity);!Number.isFinite(Di)||Di<0||Di>=yo||Number.isFinite(Oa)&&(Ii[Math.floor(Di)]=Oa)}let Fn=Ii[0];for(let Qi=0;Qi<yo;(Qi+=1)-1){const Di=Ii[Qi];if(!Number.isFinite(Di)){Ii[Qi]=Fn;continue}Fn=Di}}if(!hn)for(let Fn=0;Fn<yo;(Fn+=1)-1){const Qi=Ii[Fn];ya[Fn]=Number.isFinite(Qi)?Qi-xn:NaN}if(!$e)for(let Fn=0;Fn<yo;(Fn+=1)-1){const Qi=oo[Fn]??0,Di=Qn[Fn]??0;ma[Fn]=Qi>0?Di/Qi*100:0}if(!Vo){let Fn=xn;for(let Qi=0;Qi<yo;(Qi+=1)-1){const Di=Ii[Qi];if(Number.isFinite(Di)&&(Di>Fn&&(Fn=Di),Fn>0)){const Oa=(Fn-Di)/Fn;Bl[Qi]=Math.max(Bl[Qi],Oa*100)}}}return{positionSize:Qo,positionAvgPrice:Vi,openTrades:fi,closedTrades:oo,openProfit:Po,closedProfit:Ds,grossProfit:Wi,grossLoss:Bn,winTrades:Qn,lossTrades:In,winRate:ma,maxDrawdownPct:Bl,equity:Ii,netProfit:ya,initialCapital:xn}},Pt=Xt=>{if(!Xt)return;if(Array.isArray(Xt==null?void 0:Xt.errors)&&Xt.errors.length){const oo=Xt.errors.slice(0,4).map(Po=>String(Po)).join(" • ");x(ze,D(n(ze)?`${n(ze)} • ${oo}`:oo)),(!n(we)||n(we)==="Plotted from Pine"||n(we)==="Plotted from DSL")&&x(we,"Signals error")}const yo=new Map;Ye.forEach((oo,Po)=>{yo.set(String((oo==null?void 0:oo.id)??Po),oo)});const Qo=(oo,Po,Ds)=>{if(typeof oo=="number"&&Number.isFinite(oo))return oo;if(typeof oo=="string"){const Wi=oo.replace(/\s+/g,"_").toLowerCase(),Bn=yc==null?void 0:yc[Wi],Qn=Bn?Bn[Po]:NaN;if(Number.isFinite(Qn))return Qn;const In=Number(oo);if(Number.isFinite(In))return In}return Ds},Vi=(oo,Po)=>{if(typeof oo=="number"&&Number.isFinite(oo))return oo;if(typeof oo=="string"){const Ds=oo.replace(/\s+/g,"_").toLowerCase(),Wi=yc==null?void 0:yc[Ds],Bn=Wi?Wi[Po]:NaN;if(Number.isFinite(Bn))return Bn;const Qn=Number(oo);if(Number.isFinite(Qn))return Qn}},fi=(Xt.signals||[]).map(oo=>{const Po=yo.get(String((oo==null?void 0:oo.signalId)??""))||null,Ds=(Po==null?void 0:Po.order)||null;if(!Ds)return{...oo,orderId:(Po==null?void 0:Po.orderId)??(oo==null?void 0:oo.orderId)};const Wi=String(Ds.kind||"market").trim().toLowerCase().replace(/stop\s*limit|stoplimit/g,"stop_limit"),Bn=yc==null?void 0:yc.close,Qn=Bn?Bn[oo.index]:NaN,In=Number.isFinite(Qn)?Qn:0,ma=Kn=>{const li=typeof Kn=="string"?Kn.trim():"";return li||void 0},Bl=Kn=>{const li=typeof Kn=="number"?Kn:Number(Kn);if(!(!Number.isFinite(li)||li<=0))return Math.floor(li)},xn=(Kn,li,bo)=>{if(typeof Kn=="number"&&Number.isFinite(Kn))return Kn;if(typeof Kn=="string")return Qo(Kn,li,bo)},Ii=Wi==="limit"||Wi==="stop"?Qo(Ds.price,oo.index,In):void 0,ya=Ds.stopPrice??Ds.stop??Ds.trigger,ei=Ds.limitPrice??Ds.limit??Ds.lmt,Zl=Ds.qty??Ds.quantity,Jc=Ds.cash,Zn=Vi(Zl,oo.index),bd=Vi(Jc,oo.index),rc=Wi==="stop_limit"?xn(ya??Ds.price,oo.index,In):void 0,Hc=Wi==="stop_limit"?xn(ei??Ds.price,oo.index,In):void 0,Tl=Ds==null?void 0:Ds.bracket,Rc=Tl&&typeof Tl=="object"?{stopLossPct:typeof Tl.stopLossPct=="number"?Tl.stopLossPct:Number(Tl.stopLossPct),takeProfitPct:typeof Tl.takeProfitPct=="number"?Tl.takeProfitPct:Number(Tl.takeProfitPct),trailingStopPct:typeof Tl.trailingStopPct=="number"?Tl.trailingStopPct:Number(Tl.trailingStopPct),takeProfits:Array.isArray(Tl.takeProfits)?Tl.takeProfits.map(Kn=>({takeProfitPct:typeof(Kn==null?void 0:Kn.takeProfitPct)=="number"?Kn.takeProfitPct:Number(Kn==null?void 0:Kn.takeProfitPct),qtyPct:typeof(Kn==null?void 0:Kn.qtyPct)=="number"?Kn.qtyPct:Number(Kn==null?void 0:Kn.qtyPct)})).filter(Kn=>Number.isFinite(Kn.takeProfitPct)&&Kn.takeProfitPct>0&&Number.isFinite(Kn.qtyPct)&&Kn.qtyPct>0):void 0}:void 0;return{...oo,orderId:(Po==null?void 0:Po.orderId)??(oo==null?void 0:oo.orderId),order:{kind:Wi,price:Ii,stopPrice:rc,limitPrice:Hc,qty:Zn,cash:bd,qtyPct:Ds.qtyPct==null?void 0:Math.max(0,Math.min(100,Number(Ds.qtyPct)||0)),oco:ma(Ds.oco),expiresBars:Bl(Ds.expiresBars),bracket:Rc}}});SG(rt,fi);try{const oo=(N==null?void 0:N.strategy)??null,Po=oo===!0?{enabled:!0}:oo,Ds=Po&&typeof Po=="object"?{...Po}:Po,Wi=Q&&typeof Q=="object"?Ds&&typeof Ds=="object"?{...Ds,...Q}:{...Q}:Ds,Bn=FG(Wi);if(Bn){const Qn=Ii=>{const ya=typeof Ii=="number"?Ii:Number(Ii);return Number.isFinite(ya)?ya:void 0},In=Ie.map((Ii,ya)=>{const ei=(Ii==null?void 0:Ii.timestamp)??(Ii==null?void 0:Ii.time)??0,Zl=typeof ei=="number"?ei:Number(ei),Jc=Qn(Ii==null?void 0:Ii.close);return{index:ya,timestamp:Number.isFinite(Zl)?Zl:0,open:Qn(Ii==null?void 0:Ii.open),high:Qn(Ii==null?void 0:Ii.high),low:Qn(Ii==null?void 0:Ii.low),close:Jc??NaN}}),ma=fi.filter(Ii=>{const ya=String((Ii==null?void 0:Ii.type)||"");return ya==="entry_long"||ya==="exit_long"||ya==="entry_short"||ya==="exit_short"||ya==="cancel"||ya==="cancel_all"}),Bl=DG(In,ma,Bn);AG(rt,Bl);const xn=Tt(Bl,In.length);ol.set(ic,{positionSize:xn.positionSize,positionAvgPrice:xn.positionAvgPrice,openTrades:xn.openTrades,closedTrades:xn.closedTrades,openProfit:xn.openProfit,closedProfit:xn.closedProfit,grossProfit:xn.grossProfit,grossLoss:xn.grossLoss,winTrades:xn.winTrades,lossTrades:xn.lossTrades,winRate:xn.winRate,maxDrawdownPct:xn.maxDrawdownPct,equity:xn.equity,netProfit:xn.netProfit,initialCapital:xn.initialCapital}),wo+=1,xt||(xt=!0,Lt.request(()=>{var Ii,ya;try{const ei=((Ii=X.getDataList)==null?void 0:Ii.call(X))||[];(ya=X.applyNewData)==null||ya.call(X,ei,!1)}catch{}}))}else F2(rt),ol.delete(ic)}catch(oo){console.error("[ScriptStudio] backtest error",oo)}try{z2("signals",{id:Xt.id,signals:Xt.signals})}catch{}};if(!Ye.length)Pt({id:rt,signals:[]});else{const Xt=`${He.length}:${((Dl=He[He.length-1])==null?void 0:Dl.timestamp)??0}:${Ye.map(Qo=>`${String((Qo==null?void 0:Qo.type)||"")}:${String((Qo==null?void 0:Qo.when)||"")}`).join("|")}`;let yo=!1;if(qe!==iu){try{const Qo=[],Vi=He.length;for(let fi=0;fi<Ye.length;(fi+=1)-1){const oo=Ye[fi],Po=String((oo==null?void 0:oo.type)||"");if(Po!=="entry_long"&&Po!=="exit_long"&&Po!=="entry_short"&&Po!=="exit_short"&&Po!=="alert"&&Po!=="cancel"&&Po!=="cancel_all")continue;const Ds=String((oo==null?void 0:oo.id)??fi),Wi=(oo==null?void 0:oo.orderId)!=null&&String(oo.orderId).trim()?String(oo.orderId).trim():void 0,Bn=String((oo==null?void 0:oo.when)||"").trim();if(!Bn)continue;const Qn=sl(Bn,yc),In=oo==null?void 0:oo.cooldownBars,ma=typeof In=="number"&&Number.isFinite(In)?Math.max(0,Math.floor(In)):0;let Bl=0;for(let xn=0;xn<Vi;(xn+=1)-1){if(ma>0&&xn<Bl||!Qn[xn])continue;const Ii=((Ua=He[xn])==null?void 0:Ua.timestamp)??Date.now();Qo.push({type:Po,index:xn,timestamp:Ii,signalId:Ds,orderId:Wi}),ma>0&&(Bl=xn+ma)}}Pt({id:rt,signals:Qo})}catch(Qo){console.error("[ScriptStudio] local signals/backtest error",Qo)}iu=qe,yo=!0}if(yo&&(kc=Xt),!(lc||Xt===kc)){lc=!0,kc=Xt;const Qo=new Worker(new URL(""+new URL("../workers/signals.worker-F2CpkREA.js",import.meta.url).href,import.meta.url),{type:"module"}),Vi={id:rt,condSeries:yc,bars:He,signals:Ye};Qo.onerror=()=>{lc=!1;try{Qo.terminate()}catch{}},Qo.onmessage=fi=>{const oo=fi.data;if(!(!oo||oo.id!==Vi.id)){Pt(oo);try{Qo.terminate()}catch{}lc=!1}},Qo.postMessage(Vi)}}}catch(He){lc=!1,console.error("[ScriptStudio] signals worker error",He)}}const jp=uu;jp.__rows=Dp,jp.__len=ss,wu=Ad,Cd=jp,Ac.__lastResult=Cd;try{Lt.request(()=>{try{_o()}catch{}})}catch{}return Cd},draw:({ctx:Ie,indicator:ss,bounding:sr,xAxis:Sa,yAxis:Ml})=>{if(!Ie||!Sa||!Ml)return!1;const Zc=(ss==null?void 0:ss.result)||{},ec=Array.isArray(Zc)?Zc:Array.isArray(Zc.__rows)?Zc.__rows:[],Ku=typeof Sa.getRange=="function"?Sa.getRange():{from:0,to:ec.length?ec.length-1:0},Bd=ec.length?ec.length-1:-1,Od=Bd>=0?Math.max(0,Math.floor(((Ku==null?void 0:Ku.from)??0)-2)):0,sd=Bd>=0?Math.min(Bd,Math.ceil(((Ku==null?void 0:Ku.to)??Bd)+2)):-1,Ca=sr?{left:0,top:0,width:sr.width,height:sr.height}:void 0;Ie.save(),Ca&&(Ie.beginPath(),Ie.rect(0,0,Ca.width,Ca.height),Ie.clip()),Ns.forEach((Nn,on)=>{var ur,Or,Jo,zs,Zo,br,cc;const Pi=ae[on]||kl[on].key,cs=(Nn.type||"").toLowerCase();if(cs==="dots"){const Xs=Nn.color||"#22d3ee",Xr=Nn.width||4,Ji=[];for(let Gi=Od;Gi<=sd;(Gi+=1)-1){const jn=(ur=ec[Gi])==null?void 0:ur[Pi];if(jn==null){Ji.push({x:NaN,y:NaN});continue}const Ga=Sa.convertToPixel(Gi),fa=Ml.convertToPixel(jn);Ji.push({x:Ga,y:fa})}x2(Ie,Ji,Xs,Xr,Ca)}if(cs==="stepped"||cs==="step"){const Xs=Nn.color||"#22c55e",Xr=Nn.width||2,Ji=[];for(let Gi=Od;Gi<=sd;(Gi+=1)-1){const jn=(Or=ec[Gi])==null?void 0:Or[Pi];if(jn==null){Ji.push({x:NaN,y:NaN});continue}Ji.push({x:Sa.convertToPixel(Gi),y:Ml.convertToPixel(jn)})}ZO(Ie,Ji,Xs,Xr,Ca)}if(cs==="area"){const Xs=Nn.color||"rgba(56,189,248,0.3)",Xr=[];for(let Ga=Od;Ga<=sd;(Ga+=1)-1){const fa=(Jo=ec[Ga])==null?void 0:Jo[Pi];if(fa==null){Xr.push({x:NaN,y:NaN});continue}const Ba=Sa.convertToPixel(Ga),bn=Ml.convertToPixel(fa);Xr.push({x:Ba,y:bn})}const Ji=Ml.convertToPixel(0),jn=String(Nn.baseline||"").toLowerCase()==="zero"?Ji:Ca?Ca.height:sr.top+sr.height;KO(Ie,Xr,jn,Xs,null,0,Ca)}if(cs==="glow_points"){const Xs=Nn.color||"#22d3ee",Xr=(Nn.width||4)+2,Ji=[];for(let Gi=Od;Gi<=sd;(Gi+=1)-1){const jn=(zs=ec[Gi])==null?void 0:zs[Pi];if(jn==null){Ji.push({x:NaN,y:NaN});continue}Ji.push({x:Sa.convertToPixel(Gi),y:Ml.convertToPixel(jn)})}Ie.save(),Ie.shadowColor=Xs,Ie.shadowBlur=12,x2(Ie,Ji,Xs,Xr,Ca),Ie.restore()}if(cs==="neon_line"){const Xs=Nn.color||"#22d3ee",Xr=Nn.width||2;Ie.save(),Ie.shadowColor=Xs,Ie.shadowBlur=14,Ie.beginPath();let Ji=!1;for(let Gi=Od;Gi<=sd;(Gi+=1)-1){const jn=(Zo=ec[Gi])==null?void 0:Zo[Pi];if(jn==null)continue;const Ga=Sa.convertToPixel(Gi),fa=Ml.convertToPixel(jn);Ji?Ie.lineTo(Ga,fa):(Ie.moveTo(Ga,fa),Ji=!0)}Ie.strokeStyle=Xs,Ie.lineWidth=Xr,Ie.stroke(),Ie.restore()}if(cs==="bezier_line"){const Xs=Nn.color||"#34d399",Xr=Nn.width||2;Ie.save(),Ie.beginPath();let Ji=NaN,Gi=NaN,jn=!1;for(let Ga=Od;Ga<=sd;(Ga+=1)-1){const fa=(br=ec[Ga])==null?void 0:br[Pi];if(fa==null)continue;const Ba=Sa.convertToPixel(Ga),bn=Ml.convertToPixel(fa);if(!jn)Ie.moveTo(Ba,bn),jn=!0;else{const yd=(Ji+Ba)/2,qo=(Gi+bn)/2;Ie.quadraticCurveTo(Ji,Gi,yd,qo)}Ji=Ba,Gi=bn}Ie.strokeStyle=Xs,Ie.lineWidth=Xr,Ie.stroke(),Ie.restore()}if(cs==="cloud"||cs==="supertrend_cloud"){const Xs=Nn.color||"rgba(14,165,233,0.12)";Ie.save();const Xr=[],Ji=[];for(let Gi=Od;Gi<=sd;(Gi+=1)-1){const jn=ec[Gi]||{},Ga=Sa.convertToPixel(Gi),fa=Ml.convertToPixel(jn[Pi]),Ba=Ml.convertToPixel(jn[ae[0]]);Xr.push({x:Ga,y:fa}),Ji.push({x:Ga,y:Ba})}U_(Ie,Xr,Ji,Xs,Ca),Ie.restore()}if(cs==="aura"||cs==="candleshadow"){const Xs=Nn.color||"#a78bfa",Xr=Nn.width||2;Ie.save(),Ie.shadowColor=Xs,Ie.shadowBlur=18,Ie.beginPath();let Ji=!1;for(let Gi=Od;Gi<=sd;(Gi+=1)-1){const jn=(cc=ec[Gi])==null?void 0:cc[Pi];if(jn==null)continue;const Ga=Sa.convertToPixel(Gi),fa=Ml.convertToPixel(jn);Ji?Ie.lineTo(Ga,fa):(Ie.moveTo(Ga,fa),Ji=!0)}Ie.strokeStyle=Xs,Ie.lineWidth=Xr,Ie.stroke(),Ie.restore()}});const Ad=et.fills||[];if(Array.isArray(Ad)&&Ad.length)for(const Nn of Ad){const on=Array.isArray(Nn==null?void 0:Nn.between)?Nn.between:[];if(!on||on.length!==2)continue;const Pi=(on[0]||"").replace(/\s+/g,"_").toLowerCase(),cs=(on[1]||"").replace(/\s+/g,"_").toLowerCase(),ur=Pl[Pi],Or=Pl[cs];if(!ur||!Or)continue;const Jo=[],zs=[];for(let Zo=Od;Zo<=sd;(Zo+=1)-1){const br=ec[Zo]||{},cc=Sa.convertToPixel(Zo),Xs=Ml.convertToPixel(br[ur]),Xr=Ml.convertToPixel(br[Or]);Jo.push({x:cc,y:Xs}),zs.push({x:cc,y:Xr})}U_(Ie,Jo,zs,Nn.color||"rgba(0,0,0,0.12)",Ca)}ln.forEach(Nn=>{const on=Ml.convertToPixel(Nn.value);if(!Number.isFinite(on))return;Ie.beginPath(),Ie.moveTo(0,on),Ie.lineTo(((Ca==null?void 0:Ca.width)??sr.width)||0,on),Ie.strokeStyle=Nn.color||"#64748b",Ie.lineWidth=Nn.width??1;const Pi=(Nn.style||"dashed").toLowerCase();Pi==="dashed"||Pi==="dotted"?Ie.setLineDash(Pi==="dashed"?[4,4]:[2,2]):Ie.setLineDash([]),Ie.stroke(),Ie.setLineDash([])});const uu=et.backgroundZones||[];if(Array.isArray(uu)&&uu.length)for(const Nn of uu){const on=Number.isFinite(Nn.from)?Ml.convertToPixel(Nn.from):0,Pi=Number.isFinite(Nn.to)?Ml.convertToPixel(Nn.to):(Ca==null?void 0:Ca.height)??sr.height,cs=Math.min(on,Pi),ur=Math.abs(Pi-on);Ie.beginPath(),Ie.rect(0,cs,((Ca==null?void 0:Ca.width)??sr.width)||0,ur),Ie.fillStyle=Nn.color||"rgba(34,197,94,0.08)",Ie.fill()}const ru=Zc.__runtimeBoxDefs||[];if(ru.length){const Nn=ec.length;for(const on of ru){let Pi=on.leftIndex,cs=on.rightIndex;on.extend==="both"?(Pi=0,cs=Math.max(0,Nn-1)):on.extend==="left"?Pi=0:on.extend==="right"&&(cs=Math.max(0,Nn-1));const ur=Sa.convertToPixel(Pi),Or=Sa.convertToPixel(cs),Jo=Ml.convertToPixel(on.topValue),zs=Ml.convertToPixel(on.bottomValue);if(!Number.isFinite(ur)||!Number.isFinite(Or)||!Number.isFinite(Jo)||!Number.isFinite(zs))continue;const Zo=Math.min(ur,Or),br=Math.min(Jo,zs),cc=Math.abs(Or-ur),Xs=Math.abs(zs-Jo);if(on.bgColor&&(Ie.fillStyle=on.bgColor,Ie.fillRect(Zo,br,cc,Xs)),on.borderColor||on.borderWidth){Ie.strokeStyle=on.borderColor||"#64748b",Ie.lineWidth=on.borderWidth??1;const Xr=String(on.borderStyle||"solid").toLowerCase();Xr==="dashed"?Ie.setLineDash([6,4]):Xr==="dotted"?Ie.setLineDash([2,2]):Ie.setLineDash([]),Ie.strokeRect(Zo,br,cc,Xs),Ie.setLineDash([])}if(on.text){const Xr=String(on.text||"");if(Xr){const Ji=typeof on.textSize=="number"&&on.textSize>0?on.textSize:12,Gi=6,jn=Math.max(0,cc-Gi*2);Ie.save(),Ie.font=`${Ji}px "Inter", system-ui, -apple-system, sans-serif`,Ie.fillStyle=on.textColor||on.borderColor||"#e2e8f0";const Ga=on.textHalign==="left"||on.textHalign==="right"?on.textHalign:"center";Ie.textAlign=Ga,Ie.textBaseline="top";const fa=on.textWrap===!0,Ba=Xr.split(/\n/),bn=[];if(fa&&jn>0)for(const Pa of Ba){const Sc=Pa.split(/\s+/).filter(Boolean);let ai="";const Ir=()=>{ai&&(bn.push(ai),ai="")},nr=il=>{if(!il)return;if(Ie.measureText(il).width>jn&&jn>4){Ir();let ld="";for(const pu of il){const Vd=ld+pu;Ie.measureText(Vd).width>jn&&ld?(bn.push(ld),ld=pu):ld=Vd}ld&&bn.push(ld);return}const qc=ai?`${ai} ${il}`:il;Ie.measureText(qc).width>jn&&ai?(Ir(),ai=il):ai=qc};for(const il of Sc)nr(il);Ir()}else for(const Pa of Ba)bn.push(Pa);const yd=Math.max(12,Ji+2),qo=Math.max(1,Math.floor(Math.max(0,Xs-Gi*2)/yd));if(bn.length>qo){bn.length=qo;const Pa="...";let Sc=bn[qo-1]||"";if(jn>0)for(;Sc&&Ie.measureText(`${Sc}${Pa}`).width>jn;)Sc=Sc.slice(0,-1);bn[qo-1]=Sc?`${Sc}${Pa}`:Pa}const _l=bn.length*yd;let Kl=br+Gi;on.textValign==="middle"||on.textValign==="center"?Kl=br+(Xs-_l)/2:on.textValign==="bottom"&&(Kl=br+Xs-Gi-_l);let Sl=Zo+cc/2;Ga==="left"&&(Sl=Zo+Gi),Ga==="right"&&(Sl=Zo+cc-Gi);for(let Pa=0;Pa<bn.length;(Pa+=1)-1)Ie.fillText(bn[Pa],Sl,Kl+Pa*yd);Ie.restore()}}}}const Zr=Zc.__lineDefs||[];if(Zr.length)for(const Nn of Zr){const on=ec.length;let Pi=Nn.startIndex,cs=Nn.endIndex;Nn.extend==="both"?(Pi=0,cs=Math.max(0,on-1)):Nn.extend==="left"?Pi=0:Nn.extend==="right"&&(cs=Math.max(0,on-1));const ur=Number.isFinite(Nn.slope)&&Number.isFinite(Nn.intercept)?Nn.slope*Pi+Nn.intercept:Nn.startValue,Or=Number.isFinite(Nn.slope)&&Number.isFinite(Nn.intercept)?Nn.slope*cs+Nn.intercept:Nn.endValue,Jo=Sa.convertToPixel(Pi),zs=Ml.convertToPixel(ur),Zo=Sa.convertToPixel(cs),br=Ml.convertToPixel(Or);if(!Number.isFinite(Jo)||!Number.isFinite(zs)||!Number.isFinite(Zo)||!Number.isFinite(br))continue;Ie.beginPath(),Ie.moveTo(Jo,zs),Ie.lineTo(Zo,br),Ie.strokeStyle=Nn.color||"#22c55e",Ie.lineWidth=Nn.width??2;const cc=(Nn.style||"solid").toLowerCase();cc==="dashed"?Ie.setLineDash([6,4]):cc==="dotted"?Ie.setLineDash([2,2]):Ie.setLineDash([]),Ie.stroke(),Ie.setLineDash([])}const Ud=Zc.__runtimeLineFills||[];if(Ud.length){const Nn=ec.length,on=cs=>{let ur=Number(cs==null?void 0:cs.startIndex),Or=Number(cs==null?void 0:cs.endIndex);if(!Number.isFinite(ur)||!Number.isFinite(Or))return null;if(ur>Or){const zs=ur;ur=Or,Or=zs}const Jo=String((cs==null?void 0:cs.extend)||"").toLowerCase();return Jo==="both"?(ur=0,Or=Math.max(0,Nn-1)):Jo==="left"?ur=0:Jo==="right"&&(Or=Math.max(0,Nn-1)),{a:ur,b:Or}},Pi=(cs,ur)=>Number.isFinite(cs==null?void 0:cs.slope)&&Number.isFinite(cs==null?void 0:cs.intercept)?cs.slope*ur+cs.intercept:Number.isFinite(cs==null?void 0:cs.startValue)?cs.startValue:Number.NaN;for(const cs of Ud){const ur=cs==null?void 0:cs.line1,Or=cs==null?void 0:cs.line2;if(!ur||!Or)continue;const Jo=on(ur),zs=on(Or);if(!Jo||!zs)continue;const Zo=Math.max(Od,Jo.a,zs.a),br=Math.min(sd,Jo.b,zs.b);if(Zo>br)continue;const cc=[],Xs=[];for(let Xr=Zo;Xr<=br;(Xr+=1)-1){const Ji=Pi(ur,Xr),Gi=Pi(Or,Xr);if(!Number.isFinite(Ji)||!Number.isFinite(Gi))continue;const jn=Sa.convertToPixel(Xr),Ga=Ml.convertToPixel(Ji),fa=Ml.convertToPixel(Gi);cc.push({x:jn,y:Ga}),Xs.push({x:jn,y:fa})}cc.length>1&&Xs.length>1&&U_(Ie,cc,Xs,cs.color||"rgba(59,130,246,0.15)",Ca)}}const hl=Zc.__runtimeLineDefs||[];if(hl.length){const Nn=ec.length;for(const on of hl){let Pi=on.startIndex,cs=on.endIndex;on.extend==="both"?(Pi=0,cs=Math.max(0,Nn-1)):on.extend==="left"?Pi=0:on.extend==="right"&&(cs=Math.max(0,Nn-1));const ur=Number.isFinite(on.slope)&&Number.isFinite(on.intercept)?on.slope*Pi+on.intercept:on.startValue,Or=Number.isFinite(on.slope)&&Number.isFinite(on.intercept)?on.slope*cs+on.intercept:on.endValue,Jo=Sa.convertToPixel(Pi),zs=Ml.convertToPixel(ur),Zo=Sa.convertToPixel(cs),br=Ml.convertToPixel(Or);if(!Number.isFinite(Jo)||!Number.isFinite(zs)||!Number.isFinite(Zo)||!Number.isFinite(br))continue;Ie.beginPath(),Ie.moveTo(Jo,zs),Ie.lineTo(Zo,br),Ie.strokeStyle=on.color||"#22c55e",Ie.lineWidth=on.width??2;const cc=(on.style||"solid").toLowerCase();cc==="dashed"?Ie.setLineDash([6,4]):cc==="dotted"?Ie.setLineDash([2,2]):Ie.setLineDash([]),Ie.stroke(),Ie.setLineDash([])}}const hu=Zc.__labelItems||[],md=Zc.__tsIndex||{};if(n(it)&&Array.isArray(hu)&&hu.length){Ie.font='12px "Inter", system-ui, -apple-system, sans-serif';const Nn={},on={};for(const Pi of hu){const cs=Pi==null?void 0:Pi.ts,ur=Pi==null?void 0:Pi.tsMs,Or=(()=>{let ai;return typeof cs=="number"&&Number.isFinite(cs)&&(ai=md[String(cs)]),ai==null&&typeof ur=="number"&&Number.isFinite(ur)&&(ai=md[`${Math.floor(ur)}_ms`]??md[`${Math.floor(ur/1e3)}_s`]),typeof ai=="number"&&Number.isFinite(ai)?ai:Pi==null?void 0:Pi.index})();if(typeof Or!="number"||!Number.isFinite(Or)||sd>=0&&(Or<Od||Or>sd))continue;const Jo=Sa.convertToPixel(Or);if(!Number.isFinite(Jo))continue;const zs=ec[Or]||{},Zo=Pi==null?void 0:Pi.meta;if(!Zo)continue;const br=Zo.textAlign==="left"||Zo.textAlign==="right"?Zo.textAlign:"center";Ie.textAlign=br;const cc=Zo==null?void 0:Zo.value;if(cc==null)continue;let Xs=Ml.convertToPixel(cc);if(!Number.isFinite(Xs))continue;const Xr=typeof Zo.offsetY=="number"?Zo.offsetY:10,Ji=(Zo.position||"above")==="above",Gi=Ji?Nn[Or]||0:on[Or]||0,jn=Xr+Gi*Math.max(6,(Zo.size||12)/3);Ji?(Xs-=jn,Ie.textBaseline="bottom",Nn[Or]=Gi+1):(Xs+=jn,Ie.textBaseline="top",on[Or]=Gi+1);const Ga=typeof Zo.size=="number"&&Zo.size>0?Zo.size:12,fa=Ga/2;if(Ca||sr){const ai=0+fa+2,Ir=((Ca==null?void 0:Ca.height)??sr.height)-fa-2;Xs=Math.max(ai,Math.min(Ir,Xs))}const Ba=Zo.shape||"",bn=Ba==="arrow_up"?"arrowUp":Ba==="arrow_down"?"arrowDown":Ba==="triangle_up_filled"?"triangleUpFilled":Ba==="triangle_down_filled"?"triangleDownFilled":Ba==="arrow_up_glow"?"arrowUpGlow":Ba==="arrow_down_glow"?"arrowDownGlow":Ba==="triangle_up_gradient"?"triangleUpGradient":Ba==="triangle_down_gradient"?"triangleDownGradient":Ba==="circle_pulse"?"circlePulse":Ba==="tag"?"tag":Ba==="flag"?"flag":Ba==="pill"?"pill":Ba==="box_gradient"?"boxGradient":Ba==="bubble"?"bubble":Ba==="spark"?"spark":Ba==="star"?"star":Ba==="label"?"label":Ba==="text"||Ba==="emoji"?"text":Ba,yd=typeof Zo.size=="number"&&Zo.size>0?Zo.size:12,qo=yd/2,_l=Zo.bgColor||"rgba(15,23,42,0.95)",Kl=Zo.borderColor||"rgba(0,0,0,0.65)",Sl=Zo.textColor||Zo.color||"#f97316",Pa=String(Zo.text||"");Ie.lineWidth=typeof Zo.borderWidth=="number"?Zo.borderWidth:1;const Sc=Ie.globalAlpha;if(Ie.globalAlpha=typeof Zo.opacity=="number"?Math.max(0,Math.min(1,Zo.opacity)):1,bn==="circle"||bn==="square"||bn==="arrowUp"||bn==="arrowDown"||bn==="box"||bn==="triangleUpFilled"||bn==="triangleDownFilled"||bn==="label"||bn==="arrowUpGlow"||bn==="arrowDownGlow"||bn==="triangleUpGradient"||bn==="triangleDownGradient"||bn==="circlePulse"||bn==="tag"||bn==="flag"||bn==="pill"||bn==="boxGradient"||bn==="bubble"||bn==="spark"||bn==="star"||bn==="text"){if(Ie.save(),Ie.strokeStyle=Kl,Ie.fillStyle=Zo.color||_l,bn==="circle")Ie.beginPath(),Ie.arc(Jo,Xs,qo,0,Math.PI*2),Ie.fill(),Ie.stroke();else if(bn==="square")Ie.beginPath(),Ie.rect(Jo-qo,Xs-qo,yd,yd),Ie.fill(),Ie.stroke();else if(bn==="arrowUp"||bn==="arrowUpGlow")Ie.beginPath(),Ie.moveTo(Jo,Xs-qo),Ie.lineTo(Jo-qo,Xs+qo),Ie.lineTo(Jo+qo,Xs+qo),Ie.closePath(),(bn==="arrowUpGlow"||Zo.shadow)&&(Ie.shadowColor=Zo.color||_l,Ie.shadowBlur=12),Ie.fill(),Ie.stroke();else if(bn==="arrowDown"||bn==="arrowDownGlow")Ie.beginPath(),Ie.moveTo(Jo,Xs+qo),Ie.lineTo(Jo-qo,Xs-qo),Ie.lineTo(Jo+qo,Xs-qo),Ie.closePath(),(bn==="arrowDownGlow"||Zo.shadow)&&(Ie.shadowColor=Zo.color||_l,Ie.shadowBlur=12),Ie.fill(),Ie.stroke();else if(bn==="triangleUpFilled")Ie.beginPath(),Ie.moveTo(Jo,Xs-qo),Ie.lineTo(Jo-qo,Xs+qo),Ie.lineTo(Jo+qo,Xs+qo),Ie.closePath(),Ie.fill(),Ie.stroke();else if(bn==="triangleDownFilled")Ie.beginPath(),Ie.moveTo(Jo,Xs+qo),Ie.lineTo(Jo-qo,Xs-qo),Ie.lineTo(Jo+qo,Xs-qo),Ie.closePath(),Ie.fill(),Ie.stroke();else if(bn==="triangleUpGradient"||bn==="triangleDownGradient"){const ai=Ie.createLinearGradient(Jo-qo,Xs-qo,Jo+qo,Xs+qo);ai.addColorStop(0,Zo.bgColor||"rgba(59,130,246,0.6)"),ai.addColorStop(1,Zo.color||"rgba(34,197,94,0.6)"),Ie.fillStyle=ai,Ie.beginPath(),bn==="triangleUpGradient"?(Ie.moveTo(Jo,Xs-qo),Ie.lineTo(Jo-qo,Xs+qo),Ie.lineTo(Jo+qo,Xs+qo)):(Ie.moveTo(Jo,Xs+qo),Ie.lineTo(Jo-qo,Xs-qo),Ie.lineTo(Jo+qo,Xs-qo)),Ie.closePath(),Ie.fill(),Ie.stroke()}else if(bn==="circlePulse")Ie.beginPath(),Ie.arc(Jo,Xs,qo,0,Math.PI*2),Ie.fill(),Ie.stroke(),Ie.globalAlpha=.4,Ie.beginPath(),Ie.arc(Jo,Xs,qo*1.6,0,Math.PI*2),Ie.stroke(),Ie.globalAlpha=1;else if(bn==="pill"){const ai=Math.max(10,Ie.measureText(Pa||"").width+16),Ir=Math.max(12,yd),nr=Jo-Math.floor(ai/2),il=Xs-Math.floor(Ir/2),Dr=Ir/2;Ie.beginPath(),Ie.moveTo(nr+Dr,il),Ie.lineTo(nr+ai-Dr,il),Ie.arc(nr+ai-Dr,il+Dr,Dr,-Math.PI/2,Math.PI/2),Ie.lineTo(nr+Dr,il+Ir),Ie.arc(nr+Dr,il+Dr,Dr,Math.PI/2,-Math.PI/2),Ie.closePath(),Ie.fill(),Ie.stroke()}else if(bn==="tag"||bn==="flag"){const ai=Math.max(10,Ie.measureText(Pa||"").width+20),Ir=Math.max(12,yd+4),nr=Jo-Math.floor(ai/2),il=Xs-Math.floor(Ir/2);Ie.beginPath(),Ie.rect(nr,il,ai,Ir),Ie.fill(),Ie.stroke(),bn==="flag"&&(Ie.beginPath(),Ie.moveTo(nr,il),Ie.lineTo(nr-Ir/2,il+Ir/2),Ie.lineTo(nr,il+Ir),Ie.closePath(),Ie.fill(),Ie.stroke())}else if(bn==="boxGradient"){const ai=Math.max(10,Ie.measureText(Pa||"").width+12),Ir=Math.max(12,yd+6),nr=Jo-Math.floor(ai/2),il=Xs-Math.floor(Ir/2),Dr=Ie.createLinearGradient(nr,il,nr+ai,il+Ir);Dr.addColorStop(0,Zo.bgColor||"rgba(15,23,42,0.5)"),Dr.addColorStop(1,Zo.color||"rgba(59,130,246,0.35)"),Ie.fillStyle=Dr,Ie.beginPath(),Ie.rect(nr,il,ai,Ir),Ie.fill(),Ie.stroke()}else if(bn==="bubble")Ie.beginPath(),Ie.arc(Jo,Xs,qo,0,Math.PI*2),Ie.fill(),Ie.stroke(),Ie.beginPath(),Ie.moveTo(Jo,Xs+qo),Ie.lineTo(Jo+qo,Xs+qo+6),Ie.stroke();else if(bn==="spark")Ie.beginPath(),Ie.moveTo(Jo,Xs-qo),Ie.lineTo(Jo,Xs+qo),Ie.moveTo(Jo-qo,Xs),Ie.lineTo(Jo+qo,Xs),Ie.stroke();else if(bn==="star"){Ie.beginPath();for(let ai=0;ai<5;(ai+=1)-1){const Ir=Math.PI*2*ai/5,nr=Jo+Math.cos(Ir)*qo,il=Xs+Math.sin(Ir)*qo,Dr=Ir+Math.PI/5,qc=Jo+Math.cos(Dr)*(qo/2),ld=Xs+Math.sin(Dr)*(qo/2);ai===0?Ie.moveTo(nr,il):Ie.lineTo(nr,il),Ie.lineTo(qc,ld)}Ie.closePath(),Ie.fill(),Ie.stroke()}else if(bn==="box"){const ai=zs.__open,Ir=zs.__close,nr=zs.__high,il=zs.__low;if(ai!=null&&Ir!=null&&nr!=null&&il!=null){const Dr=Zo.boxMode||"body",qc=Dr==="wick"?nr:Math.max(ai,Ir),ld=Dr==="wick"?il:Math.min(ai,Ir),pu=Ml.convertToPixel(qc),Vd=Ml.convertToPixel(ld);if(Number.isFinite(pu)&&Number.isFinite(Vd)){const ku=Sa.convertToPixel(Or),Ou=Or>0?Sa.convertToPixel(Or-1):ku-Math.abs(Sa.convertToPixel(1)-Sa.convertToPixel(0)),zu=Or<ec.length-1?Sa.convertToPixel(Or+1):ku+Math.abs(Sa.convertToPixel(1)-Sa.convertToPixel(0)),Xc=0,lv=((Ca==null?void 0:Ca.width)??sr.width)||0,qp=Math.min(ku,Math.max(Xc,Math.floor((Ou+ku)/2))),Zu=Math.max(ku,Math.min(lv,Math.ceil((ku+zu)/2))),Fu=Math.min(pu,Vd),Hp=Math.max(1,Math.abs(Vd-pu)),Gp=Math.max(2,Zu-qp);Ie.beginPath(),Ie.rect(qp,Fu,Gp,Hp),Ie.fill(),Ie.strokeStyle=Kl,Ie.lineWidth=yd,Ie.stroke()}}}else if(bn==="label"){const ai=Ie.measureText(Pa||""),Ir=Math.max(10,ai.width+12),nr=Math.max(12,yd+6),il=Math.max(3,Math.floor(nr/3)),Dr=Jo-Math.floor(Ir/2),qc=Xs-Math.floor(nr/2);Ie.beginPath();const ld=il;Ie.moveTo(Dr+ld,qc),Ie.lineTo(Dr+Ir-ld,qc),Ie.quadraticCurveTo(Dr+Ir,qc,Dr+Ir,qc+ld),Ie.lineTo(Dr+Ir,qc+nr-ld),Ie.quadraticCurveTo(Dr+Ir,qc+nr,Dr+Ir-ld,qc+nr),Ie.lineTo(Dr+ld,qc+nr),Ie.quadraticCurveTo(Dr,qc+nr,Dr,qc+nr-ld),Ie.lineTo(Dr,qc+ld),Ie.quadraticCurveTo(Dr,qc,Dr+ld,qc),Ie.closePath(),Ie.fill(),Ie.stroke()}else if(bn==="text"){Ie.fillStyle=Sl,Ie.textAlign=br;const ai=typeof Zo.size=="number"&&Zo.size>0?Zo.size:14;Ie.font=`${ai}px sans-serif`;const Ir=Ji?Xs-(ai/2+4):Xs+(ai/2+4);Ie.fillText(Pa||"",Jo,Ir)}if(Pa&&bn!=="text"){const Ir=(typeof Zo.size=="number"&&Zo.size>0?Zo.size:12)/2,nr=typeof Zo.textPadding=="number"?Math.max(0,Zo.textPadding):Ir+6,il=Ji?Xs-nr:Xs+nr;Ie.fillStyle=Sl,Ie.strokeStyle="rgba(0,0,0,0.45)",Ie.textAlign=br,Ie.fillText(Pa,Jo,il),Ie.strokeText(Pa,Jo,il)}Ie.restore(),Ie.globalAlpha=Sc}else if(Pa)Ie.fillStyle=Sl,Ie.strokeStyle="rgba(0,0,0,0.45)",Ie.lineWidth=1,Ie.fillText(Pa,Jo,Xs),Ie.strokeText(Pa,Jo,Xs);else{const ai=String(Ba||"");if(!ne.has(ai)){ne.add(ai);try{console.warn("[ScriptStudio] Unknown label shape:",ai)}catch{}}Ie.beginPath(),Ie.arc(Jo,Xs,Math.max(3,Ga/3),0,Math.PI*2),Ie.fillStyle=Zo.color||"#22d3ee",Ie.fill()}}}const ap=Zc.__runtimeTables||[];if(ap.length){const on=((Ca==null?void 0:Ca.width)??sr.width)||0,Pi=((Ca==null?void 0:Ca.height)??sr.height)||0;for(const cs of ap){if(!cs||!cs.columns||!cs.rows)continue;const ur=Math.max(1,Math.floor(cs.columns)),Or=Math.max(1,Math.floor(cs.rows)),Jo=typeof cs.textSize=="number"&&cs.textSize>0?cs.textSize:12,zs=new Array(ur).fill(0),Zo=new Array(Or).fill(Math.max(20,Jo+8)),br=Array.isArray(cs.cells)?cs.cells:[],cc=new Map;for(const qo of br){const _l=Math.max(0,Math.min(ur-1,qo.column)),Kl=Math.max(0,Math.min(Or-1,qo.row));cc.set(`${_l}:${Kl}`,qo)}const Xs=Array.isArray(cs.merges)?cs.merges:[],Xr=new Map,Ji=new Map;for(const qo of Xs){if(!qo)continue;let _l=Math.max(0,Math.min(ur-1,Math.floor(Number(qo.left)))),Kl=Math.max(0,Math.min(ur-1,Math.floor(Number(qo.right)))),Sl=Math.max(0,Math.min(Or-1,Math.floor(Number(qo.top)))),Pa=Math.max(0,Math.min(Or-1,Math.floor(Number(qo.bottom))));if(!Number.isFinite(_l)||!Number.isFinite(Kl)||!Number.isFinite(Sl)||!Number.isFinite(Pa))continue;_l>Kl&&([_l,Kl]=[Kl,_l]),Sl>Pa&&([Sl,Pa]=[Pa,Sl]);const Sc=`${_l}:${Sl}:${Kl}:${Pa}`;Ji.has(Sc)||Ji.set(Sc,{left:_l,top:Sl,right:Kl,bottom:Pa,minW:0,minH:0});for(let ai=_l;ai<=Kl;(ai+=1)-1)for(let Ir=Sl;Ir<=Pa;(Ir+=1)-1)Xr.set(`${ai}:${Ir}`,{left:_l,top:Sl,right:Kl,bottom:Pa})}for(const qo of br){const _l=Math.max(0,Math.min(ur-1,qo.column)),Kl=Math.max(0,Math.min(Or-1,qo.row)),Sl=Xr.get(`${_l}:${Kl}`);if(Sl&&(Sl.left!==_l||Sl.top!==Kl))continue;const Pa=qo.text||"",Sc=typeof qo.textSize=="number"&&qo.textSize>0?qo.textSize:Jo;Ie.font=`${Sc}px "Inter", system-ui, -apple-system, sans-serif`;const ai=Ie.measureText(Pa).width+8*2,Ir=typeof qo.width=="number"&&qo.width>0?qo.width:0,nr=typeof qo.height=="number"&&qo.height>0?qo.height:Math.max(20,Sc+8);if(Sl){const il=`${Sl.left}:${Sl.top}:${Sl.right}:${Sl.bottom}`,Dr=Ji.get(il);Dr&&(Dr.minW=Math.max(Dr.minW,ai,Ir),Dr.minH=Math.max(Dr.minH,nr))}else zs[_l]=Math.max(zs[_l],ai,Ir),Zo[Kl]=Math.max(Zo[Kl],nr)}for(let qo=0;qo<ur;(qo+=1)-1)zs[qo]<60&&(zs[qo]=60);for(const qo of Ji.values()){let _l=0;for(let Sl=qo.left;Sl<=qo.right;(Sl+=1)-1)_l+=zs[Sl]||0;_l<qo.minW&&(zs[qo.right]=(zs[qo.right]||0)+(qo.minW-_l));let Kl=0;for(let Sl=qo.top;Sl<=qo.bottom;(Sl+=1)-1)Kl+=Zo[Sl]||0;Kl<qo.minH&&(Zo[qo.bottom]=(Zo[qo.bottom]||0)+(qo.minH-Kl))}const Gi=zs.reduce((qo,_l)=>qo+_l,0),jn=Zo.reduce((qo,_l)=>qo+_l,0),Ga=String(cs.position||"top_right").toLowerCase();let fa=8,Ba=8;Ga.includes("top_right")?(fa=on-Gi-8,Ba=8):Ga.includes("bottom_left")?(fa=8,Ba=Pi-jn-8):Ga.includes("bottom_right")?(fa=on-Gi-8,Ba=Pi-jn-8):Ga.includes("top_center")?(fa=(on-Gi)/2,Ba=8):Ga.includes("bottom_center")?(fa=(on-Gi)/2,Ba=Pi-jn-8):(Ga.includes("middle_center")||Ga.includes("center"))&&(fa=(on-Gi)/2,Ba=(Pi-jn)/2),Ie.save(),cs.bgcolor&&(Ie.fillStyle=cs.bgcolor,Ie.fillRect(fa,Ba,Gi,jn));const bn=cs.frameColor||cs.borderColor;bn&&(Ie.strokeStyle=bn,Ie.lineWidth=typeof cs.frameWidth=="number"&&cs.frameWidth>0?cs.frameWidth:typeof cs.borderWidth=="number"&&cs.borderWidth>0?cs.borderWidth:1,Ie.strokeRect(fa,Ba,Gi,jn));let yd=fa;for(let qo=0;qo<ur;(qo+=1)-1){let _l=Ba;for(let Kl=0;Kl<Or;(Kl+=1)-1){const Sl=zs[qo],Pa=Zo[Kl],Sc=Xr.get(`${qo}:${Kl}`);if(Sc&&(Sc.left!==qo||Sc.top!==Kl)){_l+=Pa;continue}const ai=Sc?(()=>{let ku=0;for(let Ou=Sc.left;Ou<=Sc.right;(Ou+=1)-1)ku+=zs[Ou]||0;return ku})():Sl,Ir=Sc?(()=>{let ku=0;for(let Ou=Sc.top;Ou<=Sc.bottom;(Ou+=1)-1)ku+=Zo[Ou]||0;return ku})():Pa,nr=cc.get(`${qo}:${Kl}`);nr!=null&&nr.bgcolor&&(Ie.fillStyle=nr.bgcolor,Ie.fillRect(yd,_l,ai,Ir)),Ie.strokeStyle=cs.borderColor||"rgba(148,163,184,0.5)",Ie.lineWidth=typeof cs.borderWidth=="number"&&cs.borderWidth>0?cs.borderWidth:1,Ie.strokeRect(yd,_l,ai,Ir);const il=(nr==null?void 0:nr.text)||"",Dr=typeof(nr==null?void 0:nr.textSize)=="number"&&nr.textSize>0?nr.textSize:Jo;Ie.font=`${Dr}px "Inter", system-ui, -apple-system, sans-serif`;const qc=(nr==null?void 0:nr.textHalign)||cs.textHalign||"left",ld=(nr==null?void 0:nr.textValign)||cs.textValign||"middle";Ie.textAlign=qc==="center"||qc==="right"?qc:"left",Ie.textBaseline=ld==="top"?"top":ld==="bottom"?"bottom":"middle";let pu=yd+8;Ie.textAlign==="center"&&(pu=yd+ai/2),Ie.textAlign==="right"&&(pu=yd+ai-8);let Vd=_l+Ir/2;Ie.textBaseline==="top"&&(Vd=_l+8),Ie.textBaseline==="bottom"&&(Vd=_l+Ir-8),Ie.fillStyle=(nr==null?void 0:nr.textColor)||cs.textColor||"#e2e8f0",Ie.fillText(il,pu,Vd),_l+=Pa}yd+=zs[qo]}Ie.restore()}}return Ie.restore(),!1}};return Ac},an=[],tn=[];zt.forEach((et,As)=>{var Wc,nc,Ao,ln,ul,ql,Pl;const yn=pi(et,As);try{x_(yn)}catch(kl){console.debug("Script indicator register error",kl)}const ae=et.pane==="main"?"candle_pane":`pane_script_${As}`;tn[As]=ae;const Ns=et.pane==="main",ra=typeof et.min=="number"&&typeof et.max=="number",ki=et.pane==="sub"?{gap:ra?{top:0,bottom:0}:{top:2,bottom:2}}:void 0;let Ls=X.createIndicator(yn.name,Ns,{id:ae,height:typeof et.height=="number"&&Number.isFinite(et.height)?et.height:et.pane==="sub"?((Wc=N==null?void 0:N.sub)==null?void 0:Wc.height)??(N==null?void 0:N.height)??200:((nc=N==null?void 0:N.main)==null?void 0:nc.height)??(N==null?void 0:N.height)??void 0,axis:ki});if(Ls||(Ls=X.createIndicator(yn,Ns,{id:ae,height:typeof et.height=="number"&&Number.isFinite(et.height)?et.height:et.pane==="sub"?((Ao=N==null?void 0:N.sub)==null?void 0:Ao.height)??(N==null?void 0:N.height)??200:((ln=N==null?void 0:N.main)==null?void 0:ln.height)??(N==null?void 0:N.height)??void 0,axis:ki})),!Ls)throw new Error("Unable to render script indicator.");wt.push(Ls),Yt.push(yn.name),Z.push({def:yn,paneId:ae}),ra?(ws.set(ae,{min:et.min,max:et.max}),xo(ae),$t(ae)):ws.delete(ae);try{X.createOverlay({name:"script-layer",visible:!0,lock:!0,groupId:"runtime"})}catch{}const Rl=(Pl=yn.calc)==null?void 0:Pl.call(yn,((ql=(ul=i())==null?void 0:ul.getDataList)==null?void 0:ql.call(ul))||[],{calcParams:[]}),mc=Array.isArray(Rl)?Rl:Array.isArray(Rl==null?void 0:Rl.__rows)?Rl.__rows:[],Jd=n(it)?mc.reduce((kl,od)=>kl+Object.keys(od||{}).filter(ic=>ic.startsWith("__label_")).length,0):0;an.push(Jd)});try{const et=Z.find(As=>As.paneId==="candle_pane");x(At,D(((mr=et==null?void 0:et.def)==null?void 0:mr.name)||((Gd=(ad=Z[0])==null?void 0:ad.def)==null?void 0:Gd.name)||null))}catch{x(At,null)}try{const et=((Kc=X.getDataList)==null?void 0:Kc.call(X))||[],As=Ao=>{const ln=typeof Ao=="number"?Ao:Number(Ao);return Number.isFinite(ln)?ln:void 0},yn=et.map(Ao=>{const ln=As((Ao==null?void 0:Ao.close)??(Ao==null?void 0:Ao.c)??(Ao==null?void 0:Ao.price));return As((Ao==null?void 0:Ao.high)??(Ao==null?void 0:Ao.h))??ln}),ae=et.map(Ao=>{const ln=As((Ao==null?void 0:Ao.close)??(Ao==null?void 0:Ao.c)??(Ao==null?void 0:Ao.price));return As((Ao==null?void 0:Ao.low)??(Ao==null?void 0:Ao.l))??ln}),Ns=et.map(Ao=>As((Ao==null?void 0:Ao.close)??(Ao==null?void 0:Ao.c)??(Ao==null?void 0:Ao.price))),ra=(Ao,ln)=>{const ul=Ao[ln];return typeof ul=="number"&&Number.isFinite(ul)?ul:null},ki=(Ao,ln)=>{const ul=et.length;if(ul<=0)return null;const ql=Math.max(1,Math.floor(ln.left)),Pl=Math.max(1,Math.floor(ln.right)),kl=Math.max(2,Math.floor(ln.lookback)),od=ul-1,ic=Math.max(0,od-kl+1),Il=Math.max(0,od-Pl);if(Il<ic)return null;const kc=Ao==="high"?yn:ae,lc=[];for(let fd=ic+ql;fd<=Il;(fd+=1)-1){const wu=ra(kc,fd);if(wu==null)continue;let Cd=!0;for(let jc=fd-ql;jc<=fd+Pl;(jc+=1)-1){if(jc===fd)continue;const Yl=ra(kc,jc);if(Yl==null){Cd=!1;break}if(Ao==="high"){if(Yl>=wu){Cd=!1;break}}else if(Yl<=wu){Cd=!1;break}}Cd&&lc.push(fd)}if(!lc.length)return null;const iu=Math.trunc(ln.which);if(iu===0)return lc[lc.length-1];if(iu<0){const fd=lc.length+iu;return fd>=0?lc[fd]:null}const Rd=iu-1;return Rd>=0&&Rd<lc.length?lc[Rd]:null},Ls=(Ao,ln)=>{const ul=et.length;if(ul<=0)return null;const ql=Math.max(2,Math.floor(ln.lookback)),Pl=ul-1,kl=Math.max(0,Pl-ql+1),od=Ao==="high"?yn:ae;let ic=null,Il=Ao==="high"?-1/0:1/0;for(let kc=kl;kc<=Pl;(kc+=1)-1){const lc=ra(od,kc);lc!=null&&(Ao==="high"?lc>Il&&(Il=lc,ic=kc):lc<Il&&(Il=lc,ic=kc))}return ic},Rl=Ao=>{const ln=typeof Ao=="number"?Ao:Number(Ao);if(!Number.isFinite(ln))return null;const ul=et.length,ql=ln<0?ul+Math.trunc(ln):Math.trunc(ln);return ql<0||ql>=ul?null:ql},mc=Ao=>{var kl,od;if(!Ao||typeof Ao!="object")return null;if(Ao.pivot){const ic=String(Ao.pivot).toLowerCase()==="low"?"low":"high",Il=ki(ic,{left:Number(Ao.left??Ao.pivotLeft??3),right:Number(Ao.right??Ao.pivotRight??3),lookback:Number(Ao.lookback??400),which:Number(Ao.which??-1)});Il!=null&&(Ao={index:Il,source:ic})}else if(Ao.extreme){const ic=String(Ao.extreme).toLowerCase()==="low"?"low":"high",Il=Ls(ic,{lookback:Number(Ao.lookback??400)});Il!=null&&(Ao={index:Il,source:ic})}const ln=Rl(Ao.index),ul=typeof Ao.timestamp=="number"&&Number.isFinite(Ao.timestamp)?Ao.timestamp:ln!=null?((kl=et[ln])==null?void 0:kl.timestamp)??((od=et[ln])==null?void 0:od.time)??null:null;let ql=typeof Ao.value=="number"&&Number.isFinite(Ao.value)?Ao.value:null;if(ql==null&&ln!=null&&Ao.source){const ic=String(Ao.source||"").replace(/\s+/g,"_").toLowerCase(),Il=et[ln],kc=ic==="open"?Il==null?void 0:Il.open:ic==="high"?Il==null?void 0:Il.high:ic==="low"?Il==null?void 0:Il.low:ic==="close"?Il==null?void 0:Il.close:ic==="volume"?Il==null?void 0:Il.volume:null;typeof kc=="number"&&Number.isFinite(kc)&&(ql=kc)}const Pl={};return ul!=null&&(Pl.timestamp=ul),ql!=null&&(Pl.value=ql),ln!=null&&(Pl.__index=ln),Object.keys(Pl).length?Pl:null},Jd=[];zt.forEach((Ao,ln)=>{(Array.isArray(Ao.overlays)?Ao.overlays:[]).forEach(ql=>Jd.push({paneId:tn[ln]||(Ao.pane==="main"?"candle_pane":"pane_script"),overlay:ql}))});let Wc=0;const nc=[];Jd.forEach(({paneId:Ao,overlay:ln})=>{try{const ul=String((ln==null?void 0:ln.name)||"").trim();if(!ul)return;const Pl=(Array.isArray(ln==null?void 0:ln.points)?ln.points:[]).map(mc).filter(Boolean),kl={name:ul,paneId:(ln==null?void 0:ln.pane)==="main"?"candle_pane":((ln==null?void 0:ln.pane)==="sub",Ao),groupId:"runtime",lock:(ln==null?void 0:ln.lock)===!0,visible:(ln==null?void 0:ln.visible)!==!1,points:Pl};ln!=null&&ln.styles&&(kl.styles=ln.styles),ln!=null&&ln.extendData&&(kl.extendData=ln.extendData),X.createOverlay(kl),Wc+=1}catch(ul){nc.push(String((ul==null?void 0:ul.message)||ul))}});try{const Ao=Array.isArray(fe)?fe:[];for(const ln of Ao){const ul=String((ln==null?void 0:ln.type)||"").trim().toLowerCase();if(ul!=="auto_fib"&&ul!=="autofib"||!(ln.draw===!0||ln.autoDraw===!0)||et.length<2)continue;const Pl=Math.max(2,Math.floor(Number(ln.lookback)||200)),od=String(ln.direction||"up").trim().toLowerCase()==="down"?"down":"up",ic=String(ln.method||ln.mode||"extremes").trim().toLowerCase(),Il=ic==="pivots"||ic==="pivot"||ic==="swing"?"pivots":"extremes",kc=Math.max(1,Math.floor(Number(ln.pivotLeft??ln.left??3))),lc=Math.max(1,Math.floor(Number(ln.pivotRight??ln.right??3))),iu=tw(yn,ae,Ns,et.length-1,{lookback:Pl,direction:od,method:Il,pivotLeft:kc,pivotRight:lc});if(!iu)continue;const Rd=et[iu.fromIndex],fd=et[iu.toIndex],wu=(Rd==null?void 0:Rd.timestamp)??(Rd==null?void 0:Rd.time)??null,Cd=(fd==null?void 0:fd.timestamp)??(fd==null?void 0:fd.time)??null;if(wu==null||Cd==null)continue;const jc=ln.levels,Yl=Array.isArray(jc)&&jc.length?jc.map(Ac=>{if(typeof Ac=="number")return{value:Ac,color:"#64748b",label:String(Ac)};if(Ac&&typeof Ac=="object"){const Ie=typeof Ac.value=="number"?Ac.value:Number(Ac.value);return Number.isFinite(Ie)?{value:Ie,color:String(Ac.color||"#64748b"),label:String(Ac.label??Ie)}:null}return null}).filter(Boolean):[{value:0,color:"#64748b",label:"0"},{value:.382,color:"#60a5fa",label:"0.382"},{value:.5,color:"#22c55e",label:"0.5"},{value:.618,color:"#f59e0b",label:"0.618"},{value:1,color:"#64748b",label:"1"}];X.createOverlay({name:"fibonacciSegment",paneId:"candle_pane",groupId:"runtime",lock:!1,visible:!0,points:[{timestamp:wu,value:iu.fromValue},{timestamp:Cd,value:iu.toValue}],extendData:{fibonacciLevels:Yl}}),Wc+=1}}catch(Ao){nc.push(String((Ao==null?void 0:Ao.message)||Ao))}Wc&&x(we,`${n(we)||"Plotted"} • overlays: ${Wc}`),nc.length&&x(ze,`Overlay error: ${nc.slice(0,2).join(" • ")}`)}catch(et){console.error("[ScriptStudio] overlay create error",et)}try{const et=Z.find(As=>As.paneId==="candle_pane");x(At,D(((vd=et==null?void 0:et.def)==null?void 0:vd.name)||((ha=($l=Z[0])==null?void 0:$l.def)==null?void 0:ha.name)||null))}catch{x(At,null)}const Hi=zt.map(et=>et.pane).join("+"),ps=an.reduce((et,As)=>et+As,0);if(x(we,`Plotted (${Hi}) • labels: ${n(it)?ps:"off"}`),ps===0)try{const et=zt.reduce((Ns,ra)=>Ns+(ra.plots||[]).length,0),As=[];et===0&&As.push("Pane has no plots");const yn=new Set(["open","high","low","close","volume","barstate_isfirst","barstate_islast","barstate_islastconfirmedhistory","barstate_isconfirmed","barstate_isrealtime","barstate_ishistory","barstate_isnew","timeframe_multiplier","timeframe_seconds","timeframe_isseconds","timeframe_isminutes","timeframe_ishours","timeframe_isdaily","timeframe_isweekly","timeframe_ismonthly","timeframe_isyearly","timeframe_isintraday","timeframe_period","syminfo_mintick","syminfo_pointvalue","syminfo_tickerid","syminfo_ticker","syminfo_root","syminfo_prefix","syminfo_exchange","syminfo_description","syminfo_type","syminfo_currency","syminfo_timezone","syminfo_session","syminfo_isdelayed","strategy_position_size","strategy_position_avg_price","strategy_opentrades","strategy_closedtrades","strategy_openprofit","strategy_closedprofit","strategy_grossprofit","strategy_grossloss","strategy_wintrades","strategy_losstrades","strategy_winrate","strategy_max_drawdown","strategy_equity","strategy_netprofit","strategy_initial_capital"]),ae=(Ns,ra)=>{const ki=(Ns||"").toLowerCase(),Ls=ra.replace(/\s+/g,"_").toLowerCase();return ki==="bbands"||ki==="bollinger"||ki==="bollinger_bands"||ki==="kc"||ki==="keltner"||ki==="donchian"||ki==="linreg_channel"?[`${Ls}_mid`,`${Ls}_upper`,`${Ls}_lower`]:ki==="atr_bands"?[`${Ls}_upper`,`${Ls}_lower`]:ki==="stoch"?[`${Ls}_k`,`${Ls}_d`]:ki==="macd"?["macd_line","macd_signal","macd_hist"]:ki==="ichimoku"?["tenkan","kijun","spana","spanb","chikou"]:[Ls]};if(fe.forEach(Ns=>{const ra=String((Ns==null?void 0:Ns.name)||(Ns==null?void 0:Ns.type)||"").replace(/\s+/g,"_").toLowerCase();ae(String((Ns==null?void 0:Ns.type)||""),ra).forEach(ki=>yn.add(ki))}),Ae.forEach(Ns=>{const ra=String((Ns==null?void 0:Ns.name)||"").replace(/\s+/g,"_").toLowerCase();ra&&yn.add(ra)}),zt.forEach((Ns,ra)=>{(Ns.labels||[]).forEach((ki,Ls)=>{const Rl=String((ki==null?void 0:ki.when)||"").trim();if(!Rl){As.push(`Label[${ra}:${Ls}] has empty condition`);return}try{const mc=N!=null&&N.params&&typeof N.params=="object"?N.params:{},Jd=Rl.replace(/\$\{([^}]+)\}/g,(ql,Pl)=>{const kl=mc[Pl],od=typeof kl=="number"?kl:Number(kl);return Number.isFinite(od)?String(od):"0"}),Wc=rd(Jd),nc=cm(Wc),Ao=[],ln=ql=>{!ql||typeof ql!="object"||(ql.kind==="SeriesRef"&&Ao.push(String(ql.name||"")),Object.values(ql).forEach(ln))};ln(nc);const ul=Ao.filter(ql=>!yn.has(ql.replace(/\s+/g,"_").toLowerCase())&&!["open","high","low","close","volume"].includes(ql.replace(/\s+/g,"_").toLowerCase()));ul.length&&As.push(`Label[${ra}:${Ls}] unknown series: ${ul.join(", ")}`)}catch(mc){const Jd=(mc==null?void 0:mc.position)!=null?` at ${mc.position}`:"",Wc=mc!=null&&mc.message?String(mc.message):String(mc);As.push(`Label[${ra}:${Ls}] parse failed${Jd}: ${Wc}`)}})}),As.length){const Ns=As.join(" • ");x(ze,D(n(ze)?`${n(ze)} • ${Ns}`:Ns))}else x(we,"No label signals matched")}catch{}Es();try{te&&(clearInterval(te),te=null)}catch{}_o()}function Mn(N){const X=String(N||"").split(/\r?\n/),fe=Math.min(8,X.length);for(let Ae=0;Ae<fe;(Ae+=1)-1){const ft=(X[Ae]||"").match(/^\s*(?:\/\/|#)\s*@?(?:lang|language)\s*(?::|=)?\s*([A-Za-z]+)\s*$/i);if(!ft)continue;const Bt=String(ft[1]||"").toLowerCase();if(Bt==="auto"||Bt==="json"||Bt==="pine"||Bt==="dsl")return Bt}return null}function La(N,X){return X&&X!=="auto"?X:Mn(N)||"auto"}async function nn(N,X,fe,Ae){var Le,ft,Bt;x(ze,null),x(we,"Running..."),x(dt,!0),qe+=1,Q=Ae&&typeof Ae=="object"?{...Ae}:null,me=(()=>{if(!Q)return"";const Ft=Q,zt=Ft.from??"",io=Ft.to??"",Wt=Ft.session??"";return`${zt}|${io}|${Wt}`})();try{let Ft=null;const zt=String(N||""),io=zt.trim(),Wt=La(zt,fe),zo=io.startsWith("{")||io.startsWith("["),Et=xt=>{try{return JSON.parse(xt)}catch{return null}},Ut=xt=>xt&&typeof xt=="object"&&(xt.plots||xt.calc||xt.series||xt.signals||xt.strategy||xt.labels||xt.levels||xt.lines||xt.overlays||xt.panes||xt.main||xt.sub);if(Wt==="json"){const xt=Et(io);if(!xt){x(ze,"Invalid JSON: expected a script spec object"),x(we,"Validation failed");return}if(!Ut(xt)){x(ze,"JSON mode expects a script spec object"),x(we,"Validation failed");return}try{const Ot=xt&&typeof xt=="object"?xt.params||{}:{},No=y1(xt,Ot),ts=_1(No);if(ts.ok&&ts.spec)Ae&&typeof Ae=="object"&&(No.strategy={...No.strategy||{},...Ae}),await di(No),x(we,"Plotted from JSON");else{const Oo=(ts.errors||[]).join("; ");x(ze,D(Oo?`Schema validation failed: ${Oo}`:"Schema validation failed")),x(we,"Validation failed");return}}catch(Ot){const No=Ot instanceof Error?Ot.message:String(Ot);x(ze,`Schema validation error: ${No}`),x(we,"Validation failed");return}return}if(Wt==="pine"){const xt=Ih(N);if(xt.ok){try{const Ot=xt.spec&&typeof xt.spec=="object"?xt.spec.params||{}:{},No=X&&typeof X=="object"?{...Ot,...X}:Ot;xt.spec.params=No}catch{}Ae&&typeof Ae=="object"&&(xt.spec.strategy={...xt.spec.strategy||{},...Ae}),await di(xt.spec),x(we,"Plotted from Pine")}else x(ze,D((xt.errors||[]).slice(0,6).map(Ot=>`Line ${Ot.line}: ${Ot.message}`).join(" • "))),x(we,"Validation failed");return}if(Wt==="dsl"){const xt=N2(N),Ot={calc:[],series:xt.series,panes:xt.panes,signals:xt.signals,params:X&&typeof X=="object"?{...xt.params,...X}:xt.params};Ae&&typeof Ae=="object"&&(Ot.strategy={...Ot.strategy||{},...Ae}),await di(Ot),x(we,"Plotted from DSL");return}if(zo)try{Ft=JSON.parse(io)}catch(xt){const Ot=String((xt==null?void 0:xt.message)||"Invalid JSON");x(ze,`Invalid JSON: ${Ot}`),x(we,"Validation failed");return}else try{Ft=JSON.parse(io)}catch{}if(Ut(Ft))try{const xt=Ft&&typeof Ft=="object"?Ft.params||{}:{},Ot=y1(Ft,xt),No=_1(Ot);if(No.ok&&No.spec)Ae&&typeof Ae=="object"&&(Ot.strategy={...Ot.strategy||{},...Ae}),await di(Ot);else{const ts=(No.errors||[]).join("; ");x(ze,D(ts?`Schema validation failed: ${ts}`:"Schema validation failed")),x(we,"Validation failed");return}}catch(xt){const Ot=xt instanceof Error?xt.message:String(xt);x(ze,`Schema validation error: ${Ot}`),x(we,"Validation failed");return}else try{const xt=Ih(N);if(xt.ok){try{const ts=xt.spec&&typeof xt.spec=="object"?xt.spec.params||{}:{},Oo=X&&typeof X=="object"?{...ts,...X}:ts;xt.spec.params=Oo}catch{}Ae&&typeof Ae=="object"&&(xt.spec.strategy={...xt.spec.strategy||{},...Ae}),await di(xt.spec),x(we,"Plotted from Pine");return}else{const ts=(xt.errors||[]).filter(Oo=>String((Oo==null?void 0:Oo.message)||"")!=="Not a Pine-like script");if(ts.length){x(ze,D(ts.slice(0,6).map(Oo=>`Line ${Oo.line}: ${Oo.message}`).join(" • "))),x(we,"Validation failed");return}}const Ot=N2(N),No={calc:[],series:Ot.series,panes:Ot.panes,signals:Ot.signals,params:X&&typeof X=="object"?{...Ot.params,...X}:Ot.params};Ae&&typeof Ae=="object"&&(No.strategy={...No.strategy||{},...Ae}),await di(No),x(we,"Plotted from DSL")}catch{const Ot=hs(N),No=i();if(!No)throw new Error("Chart not ready yet. Please try again in a moment.");Ss(No);const ts=`${Vt}_${Date.now()}`,Oo=is(Ot,ts);try{x_(Oo)}catch(To){console.debug("Script indicator register error",To)}const Cn=n(Gt)==="main"?"candle_pane":"pane_script",Cs=n(Gt)==="main";let rn=No.createIndicator(Oo.name,Cs,{id:Cn,axis:n(Gt)==="sub"?{gap:{top:2,bottom:2}}:void 0});if(rn||(rn=No.createIndicator(Oo,Cs,{id:Cn,axis:n(Gt)==="sub"?{gap:{top:2,bottom:2}}:void 0})),!rn)throw new Error("Unable to render script indicator.");wt.push(rn),Yt.push(Oo.name),x(At,D(Oo.name));const ko=((Bt=Oo.calc)==null?void 0:Bt.call(Oo,((ft=(Le=i())==null?void 0:Le.getDataList)==null?void 0:ft.call(Le))||[],{calcParams:[Ot.window]}))||[],Xo=ko.filter(To=>To==null?void 0:To.topSignal).length,Ro=ko.filter(To=>To==null?void 0:To.botSignal).length;x(we,`Plotted (WIN=${Ot.window}) • ▲ ${Xo} / ▼ ${Ro}`)}}catch(Ft){x(ze,D(Ft instanceof Error?Ft.message:"Script failed to run.")),x(we,null),console.error("[ScriptStudio] run failed",Ft)}finally{x(dt,!1)}F==null||F.restore()}function tr(){const N=i();try{Ss(N)}catch{}try{N==null||N.removeOverlay({groupId:"runtime"})}catch{}try{N==null||N.removeOverlay({name:"script-layer"})}catch{}Z=[];try{te&&(clearInterval(te),te=null)}catch{}try{F&&B&&F.clearRect(0,0,B.width,B.height)}catch{}try{MG()}catch{}try{LG()}catch{}x(we,"Reset"),x(ze,null),x(dt,!1),x(At,null),Q=null,me=""}function Ur(){typeof requestAnimationFrame>"u"||requestAnimationFrame(()=>{Lt.request(()=>{var fe,Ae;if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const N=Sd(s().theme);uo.merge(N,tf(s().styles)),i().setStyles(Dc(N)),mi();const X=(Ae=(fe=i()).getVisibleRange)==null?void 0:Ae.call(fe);X&&typeof X.to=="number"&&setTimeout(()=>{i()&&i().scrollToDataIndex(X.to,0)},30)})})}function cl(){x(vt,!1),x(Je,!1),Ur()}const ui=()=>{window.removeEventListener("mousemove",Ra),window.removeEventListener("touchmove",Ra),window.removeEventListener("mouseup",ga),window.removeEventListener("touchend",ga)};function Yr(N){if(!n(vt))return;const X="touches"in N?N.touches[0]:N,{clientY:fe}=X;Ge=fe,pt=n(nt),x(ct,!0),window.addEventListener("mousemove",Ra),window.addEventListener("touchmove",Ra,{passive:!1}),window.addEventListener("mouseup",ga),window.addEventListener("touchend",ga),N.preventDefault()}function Ra(N){var Bt;if(!n(ct))return;const X="touches"in N?N.touches[0]:N,fe=(Bt=n(ye))==null?void 0:Bt.getBoundingClientRect();if(!fe)return;const Ae=Ge-X.clientY,Le=pt*fe.height+Ae,ft=Math.min(Ze,Math.max(tt,Le/fe.height));x(nt,D(ft)),Ur(),N.preventDefault()}function ga(){n(ct)&&(x(ct,!1),ui(),Ur(),setTimeout(()=>{Lt.request(()=>{var fe,Ae;if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const N=Sd(s().theme);uo.merge(N,tf(s().styles)),i().setStyles(Dc(N)),mi();const X=(Ae=(fe=i()).getVisibleRange)==null?void 0:Ae.call(fe);X&&typeof X.to=="number"&&setTimeout(()=>{i()&&i().scrollToDataIndex(X.to,0)},30)})},140))}function na(N){x(ze,null);const X="Inline Script";try{const fe=wG(X,N);x(we,`Saved • ${fe.name}`)}catch{x(we,"Saved locally")}}rf(()=>{if(ui(),te){try{clearInterval(te)}catch{}te=null}});function nl(N){if(!N)return"";if(Array.isArray(N.colors)&&N.colors.length>0){const X=N.angle||N.direction||0,fe=N.colors.map(Ae=>`${Ae.color} ${Ae.position}%`).join(", ");return`linear-gradient(${X}deg, ${fe})`}if(Array.isArray(N.stops)&&N.stops.length>0){const X=N.type==="radial"?"radial":"linear",fe=N.direction??N.angle??0,Le=[...N.stops].sort((ft,Bt)=>(ft.position??0)-(Bt.position??0)).map(ft=>{const Bt=(ft.color||"").trim(),Ft=ft.position??0,zt=(ft.opacity??100)/100;if(Bt.startsWith("#")){const io=parseInt(Bt.slice(1,3),16),Wt=parseInt(Bt.slice(3,5),16),zo=parseInt(Bt.slice(5,7),16);return`rgba(${io}, ${Wt}, ${zo}, ${zt}) ${Ft}%`}if(Bt.startsWith("rgb(")||Bt.startsWith("rgba(")){const io=Bt.match(/rgba?\(([^)]+)\)/i);if(io){const Wt=io[1].split(",").map(wo=>wo.trim()),[zo,Et,Ut]=Wt;return`rgba(${zo}, ${Et}, ${Ut}, ${zt}) ${Ft}%`}}return`${Bt} ${Ft}%`});return X==="radial"?`radial-gradient(circle, ${Le.join(", ")})`:`linear-gradient(${fe}deg, ${Le.join(", ")})`}return""}function mi(){var N,X,fe,Ae,Le,ft,Bt,Ft,zt,io,Wt,zo;if(!sa){zi=!0;try{const Et=s().styles;if(!Et)return;const Ut=Sd(s().theme),wo=uo.get(Ut,"pane.backgroundColor")||(s().theme==="dark"?"#070211":"#ffffff"),xt=s().theme==="dark"?"#ffffff":"#070211",Ot=Et.backgroundType||"solid",No=document.querySelector(".kline-main"),ts=document.querySelector(".kline-widget");let Oo="";const Cn=Ot==="gradient"&&!!Et.backgroundGradient;if(!window.__forceApplyThemeDefaults&&!window.__forceApplySavedCanvasColors&&!Cn){const Xo=Ro=>{if(!Ro)return"";const To=Ro,Hs=(window.getComputedStyle(To).getPropertyValue("--chart-background-color")||"").trim(),jo=(To.style.background||To.style.backgroundColor||"").trim();return Hs||jo||""};Oo=Xo(No)||Xo(ts)}if(!window.__forceApplyThemeDefaults&&!window.__forceApplySavedCanvasColors&&!Cn&&Oo)[No,ts].forEach(Xo=>{Xo&&(Xo.style.background=Oo,Xo.style.backgroundColor=Oo,Xo.style.setProperty("--chart-background-color",Oo))}),console.log("🎨 Preserved live preview background:",Oo);else if(Ot==="solid"){let Xo=Et.backgroundColor||wo;const Ro=(Et.backgroundOpacity??100)/100,To=typeof Et.backgroundColor=="string"&&Et.backgroundColor.trim().toLowerCase()===xt.toLowerCase(),Co=!!Et.backgroundType||!!Et.backgroundGradient||typeof Et.backgroundOpacity=="number";To&&!Co&&(Xo=wo);let Hs=Xo;if(Ro!==1&&Xo.startsWith("#")){const jo=parseInt(Xo.slice(1,3),16),ls=parseInt(Xo.slice(3,5),16),Rn=parseInt(Xo.slice(5,7),16);Hs=`rgba(${jo}, ${ls}, ${Rn}, ${Ro})`}[No,ts].forEach(jo=>{jo&&(jo.style.background=Hs,jo.style.backgroundColor=Hs,jo.style.setProperty("--chart-background-color",Hs))}),console.log("🎨 Applied saved background color:",Hs)}else if(Ot==="gradient"&&Et.backgroundGradient){const Xo=Et.backgroundGradient,Ro=Xo.css||nl(Xo);[No,ts].forEach(To=>{To&&(To.style.background=Ro,To.style.backgroundColor=Ro,To.style.setProperty("--chart-background-color",Ro))}),console.log("🎨 Applied saved gradient background:",Ro)}const Cs=Et.gridType||"solid",rn=uo.get(Ut,"grid.horizontal.color")||(s().theme==="dark"?"#081115":"#F3F3F3"),ko=s().theme==="dark"?"#F3F3F3":"#081115";if(i()&&Cs==="solid"){const Xo=((X=(N=i()).getStyles)==null?void 0:X.call(N))??{},Ro=window.__forceApplyThemeDefaults||window.__forceApplySavedCanvasColors?void 0:uo.get(Xo,"grid.horizontal.color")||uo.get(Xo,"grid.vertical.color"),To=((Ae=(fe=Et.grid)==null?void 0:fe.horizontal)==null?void 0:Ae.color)||((ft=(Le=Et.grid)==null?void 0:Le.vertical)==null?void 0:ft.color),Co=typeof Et.gridOpacity=="number"?Et.gridOpacity:100,Hs=Math.max(0,Math.min(100,Co))/100;let jo=Ro||To||rn;const ls=!Ro&&typeof To=="string"&&To.trim().toLowerCase()===ko.toLowerCase(),Rn=!!Et.gridType||!!Et.gridGradient||typeof Et.gridOpacity=="number";if(ls&&!Rn&&(jo=rn),!Ro&&typeof jo=="string"&&jo.startsWith("#")&&Hs!==1){const Pn=parseInt(jo.slice(1,3),16),Oi=parseInt(jo.slice(3,5),16),pi=parseInt(jo.slice(5,7),16);jo=`rgba(${Pn}, ${Oi}, ${pi}, ${Hs})`}const Os=uo.cloneDeep(Xo);uo.set(Os,"grid.horizontal.color",jo),uo.set(Os,"grid.vertical.color",jo),(Ft=(Bt=s().styles)==null?void 0:Bt.candle)!=null&&Ft.type&&uo.set(Os,"candle.type",s().styles.candle.type),lr?lr(Dc(Os)):i().setStyles(Dc(Os)),console.log("🎨 Applied grid color (preserving preview when available):",jo)}else if(i()&&Cs==="gradient"&&Et.gridGradient){const Xo=((io=(zt=i()).getStyles)==null?void 0:io.call(zt))??{},Ro=window.__forceApplyThemeDefaults||window.__forceApplySavedCanvasColors?void 0:uo.get(Xo,"grid.horizontal.color")||uo.get(Xo,"grid.vertical.color"),To=Et.gridGradient,Co=To.css||nl(To),Hs=Ro||Co,jo=uo.cloneDeep(Xo);uo.set(jo,"grid.horizontal.color",Hs),uo.set(jo,"grid.vertical.color",Hs),(zo=(Wt=s().styles)==null?void 0:Wt.candle)!=null&&zo.type&&uo.set(jo,"candle.type",s().styles.candle.type),lr?lr(Dc(jo)):i().setStyles(Dc(jo)),console.log("🎨 Applied gradient grid (preserving preview when available):",Hs)}}catch(Et){console.error("Error applying canvas colors:",Et)}finally{zi=!1,window.__forceApplyThemeDefaults&&(window.__forceApplyThemeDefaults=!1),window.__forceApplySavedCanvasColors&&(window.__forceApplySavedCanvasColors=!1)}}}Wa(M(),ys(r).applyCanvasColors=mi,ys(r)),jt.setApplyCanvasColorsFunction(mi),Mt.setApplyCanvasColorsFunction(mi);let Ha=null,lr=null,zi=!1,hr=null;zr(()=>{var N;if(i()&&i()!==Ha){Ha=i(),lr=i().setStyles.bind(i());const X=i().resize.bind(i());hr=((N=i().createIndicator)==null?void 0:N.bind(i()))??null,Wa(Re,ys(i).setStyles=function(fe){const Ae=lr(fe);return zi||Lt.request(()=>mi()),Ae},ys(i)),Wa(Re,ys(i).resize=function(){const fe=X();return Lt.request(()=>mi()),fe},ys(i)),hr&&Wa(Re,ys(i).createIndicator=function(fe,Ae,Le){var io,Wt,zo;const ft=this;let Bt=[];try{const Et=(io=ft.getPaneOptions)==null?void 0:io.call(ft);Array.isArray(Et)&&(Bt=Et)}catch{}const Ft=hr(fe,Ae,Le);let zt=[];try{const Et=(Wt=ft.getPaneOptions)==null?void 0:Wt.call(ft);Array.isArray(Et)&&(zt=Et)}catch{return Ft}try{const Et=new Set(Bt.map(Ut=>Ut==null?void 0:Ut.id).filter(Boolean));for(const Ut of zt){const wo=Ut==null?void 0:Ut.id;if(wo&&!(wo==="candle_pane"||wo==="x_axis_pane")&&!Et.has(wo)&&!cr()){const xt=typeof Ut.height=="number"&&Ut.height>0?Ut.height:void 0;if(xt!==void 0){const Ot=xt+100;try{(zo=ft.setPaneOptions)==null||zo.call(ft,{id:wo,height:Ot}),console.log("📏 Increased new sub‑pane height by 100px (desktop only)",{paneId:wo,baseHeight:xt,newHeight:Ot})}catch{}}}}}catch{}return Ft},ys(i)),console.log("🔧 Chart methods wrapped to preserve canvas colors")}});let xa=`${((qt=s().period)==null?void 0:qt.timespan)||""}_${((Lo=s().period)==null?void 0:Lo.multiplier)||""}`;zr(()=>{const N=s().period;if(!i()||!N||!N.timespan)return;const fe={s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month"}[N.timespan]??"day",Ae=Number(N.multiplier)||1,Le=`${fe}_${Ae}`;if(Le!==xa){xa=Le;try{i().setPeriod({type:fe,span:Ae});const ft=Sd(s().theme);uo.merge(ft,tf(s().styles)),i().setStyles(Dc(ft))}catch{}}}),console.log("📊 About to define onMount function"),console.log("📊 Browser environment:",t1),console.log("🚀 Attempting to call loadSymbols immediately"),ue().then(()=>{console.log("✅ loadSymbols completed successfully"),console.log("📊 allSymbols length:",s().allSymbols.length)}).catch(N=>{console.error("❌ loadSymbols failed:",N)}),hp(async()=>{var Ft,zt,io,Wt,zo,Et,Ut,wo,xt,Ot,No,ts,Oo,Cn,Cs,rn;if(console.log("🚀 onMount started - browser:",t1),console.log("📊 chartRef:",j),!j){console.error("❌ chartRef is not available");return}try{let ko=!1;typeof window<"u"&&(ko=!!localStorage.getItem("chart.activeSaveId")),ko&&Bo.set(!0)}catch{}(zt=(Ft=s().styles)==null?void 0:Ft.candle)!=null&&zt.type||I().update(ko=>(ko.styles=ko.styles||{},ko.styles.candle=ko.styles.candle||{},ko.styles.candle.type="renko_atr",ko.styles.candle.renko||(ko.styles.candle.renko={method:"ATR",atrLength:14,source:"close",wick:!1}),ko));const N=Sd(s().theme),X=uo.merge({},N,s().styles);if(console.log("🎨 onMount - Theme styles:",JSON.stringify(N,null,2)),console.log("💾 onMount - Saved styles:",JSON.stringify(s().styles,null,2)),console.log("🔄 onMount - Merged styles:",JSON.stringify(X,null,2)),R2(Re,D(ik(j,{styles:(()=>{var ko,Xo,Ro,To,Co,Hs,jo,ls,Rn,Os,Pn,Oi,pi,an,tn,Hi,ps,_s,fn,Ci,dr,vi,Fa,ri;try{if((Xo=(ko=X==null?void 0:X.candle)==null?void 0:ko.tooltip)!=null&&Xo.legend){const ka=X.candle.tooltip.legend.color;X.candle.tooltip.legend.template=({current:va})=>{const wc="#32CD32",$i="#FF0000",mr=((va==null?void 0:va.close)??0)>((va==null?void 0:va.open)??0),ad=((va==null?void 0:va.close)??0)<((va==null?void 0:va.open)??0),Gd=mr?wc:ad?$i:ka,Kc=$l=>({text:$l,color:Gd});return typeof window<"u"&&window.innerWidth<=768?[{title:"O",value:Kc("{open}")},{title:"H",value:Kc("{high}")},{title:"L",value:Kc("{low}")},{title:"C",value:Kc("{close}")},{title:"V",value:Kc("{volume}")}]:[{title:"O",value:Kc("{open}")},{title:"H",value:Kc("{high}")},{title:"L",value:Kc("{low}")},{title:"C",value:Kc("{close}")},{title:"V",value:Kc("{volume}")}]}}}catch{}try{const ka=(Co=(To=(Ro=N==null?void 0:N.xAxis)==null?void 0:Ro.tickText)==null?void 0:To.style)==null?void 0:Co.color,va=(ls=(jo=(Hs=N==null?void 0:N.yAxis)==null?void 0:Hs.tickText)==null?void 0:jo.style)==null?void 0:ls.color;if(ka&&((Os=(Rn=X==null?void 0:X.xAxis)==null?void 0:Rn.tickText)!=null&&Os.style)&&(X.xAxis.tickText.style.color=ka,(Pn=X==null?void 0:X.xAxis)!=null&&Pn.tickText)){delete X.xAxis.tickText.color,delete X.xAxis.tickText.opacity,X.xAxis.tickText.color=ka;try{I().update(mr=>(mr.styles||(mr.styles={}),uo.unset(mr.styles,"xAxis.tickText.color"),uo.unset(mr.styles,"xAxis.tickText.opacity"),uo.set(mr.styles,"xAxis.tickText.style.color",ka),mr))}catch{}}if(va&&((pi=(Oi=X==null?void 0:X.yAxis)==null?void 0:Oi.tickText)!=null&&pi.style)&&(X.yAxis.tickText.style.color=va,(an=X==null?void 0:X.yAxis)!=null&&an.tickText)){delete X.yAxis.tickText.color,delete X.yAxis.tickText.opacity,X.yAxis.tickText.color=va;try{I().update(mr=>(mr.styles||(mr.styles={}),uo.unset(mr.styles,"yAxis.tickText.color"),uo.unset(mr.styles,"yAxis.tickText.opacity"),uo.set(mr.styles,"yAxis.tickText.style.color",va),mr))}catch{}}const wc=(ps=(Hi=(tn=N==null?void 0:N.candle)==null?void 0:tn.tooltip)==null?void 0:Hi.legend)==null?void 0:ps.color,$i=(Ci=(fn=(_s=N==null?void 0:N.indicator)==null?void 0:_s.tooltip)==null?void 0:fn.legend)==null?void 0:Ci.color;if(wc&&((vi=(dr=X==null?void 0:X.candle)==null?void 0:dr.tooltip)!=null&&vi.legend)){X.candle.tooltip.legend.color=wc;try{I().update(mr=>(mr.styles||(mr.styles={}),uo.set(mr.styles,"candle.tooltip.legend.color",wc),mr))}catch{}}if($i&&((ri=(Fa=X==null?void 0:X.indicator)==null?void 0:Fa.tooltip)!=null&&ri.legend)){X.indicator.tooltip.legend.color=$i;try{I().update(mr=>(mr.styles||(mr.styles={}),uo.set(mr.styles,"indicator.tooltip.legend.color",$i),mr))}catch{}}}catch{}try{const ka=X.crosshair??{},va=ka.vertical??{},wc=va.text??{};X.crosshair={...ka,show:ka.show??!0},X.crosshair.vertical={...va,show:va.show??!0},X.crosshair.vertical.text={...wc,show:!0}}catch{}return Dc(X)})(),decimalFold:{threshold:999,format:y},formatter:{formatDate:({timestamp:ko,template:Xo,type:Ro})=>Iy(s().period.timespan)(ko,Xo,Ro)}}))),i()){const ko=To=>(To||"").toUpperCase(),Xo=To=>{var jo,ls;const Co=(ls=(jo=s().allSymbols)==null?void 0:jo.find)==null?void 0:ls.call(jo,Rn=>ko(Rn.ticker)===ko(To));return Co!=null&&Co.name?Co.name:{GP:"Grameen Phone",DSEBD:"DSE Board Index",DSEX:"Dhaka Stock Exchange"}[ko(To)]||""},Ro={...s().symbol,ticker:s().symbol.ticker,name:s().symbol.name||Xo(s().symbol.ticker)||s().symbol.ticker,pricePrecision:Jg(s().symbol),volumePrecision:s().symbol.volumePrecision};i().setSymbol(Ro);try{const To=s().period;if(To!=null&&To.timespan&&(To!=null&&To.multiplier)){const Hs={second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month",year:"year",s:"second",m:"minute",h:"hour",d:"day",w:"week"}[To.timespan]??"day",jo=Number(To.multiplier)||1;i().setPeriod({type:Hs,span:jo})}}catch{}}if(Es(),i()){const ko=Xo=>{var ls,Rn,Os,Pn;const Ro=typeof Xo=="object"&&Xo&&"paneId"in Xo?Xo.paneId:void 0;if(!Ro)return;const To=Ro.startsWith("pane_script")||Z.some(Oi=>Oi.paneId===Ro),Co=To?kt(Ro):null,Hs=(Rn=(ls=Co==null?void 0:Co.axis)==null?void 0:ls.getRange)==null?void 0:Rn.call(ls),jo=(Pn=(Os=Co==null?void 0:Co.axis)==null?void 0:Os.getAutoCalcTickFlag)==null?void 0:Pn.call(Os);ws.has(Ro)&&$t(Ro),To&&requestAnimationFrame(()=>{var Oi,pi,an,tn,Hi,ps;Co!=null&&Co.axis&&Hs&&To&&((pi=(Oi=Co.axis).setRange)==null||pi.call(Oi,Hs),(tn=(an=Co.axis).buildTicks)==null||tn.call(an,!0),jo&&((ps=(Hi=Co.axis).setAutoCalcTickFlag)==null||ps.call(Hi,!0)))})};(Wt=(io=i()).subscribeAction)==null||Wt.call(io,Nv.OnPaneDrag,ko),es=()=>{var Xo,Ro;return(Ro=(Xo=i())==null?void 0:Xo.unsubscribeAction)==null?void 0:Ro.call(Xo,Nv.OnPaneDrag,ko)}}try{const ko=(Et=(zo=s().styles)==null?void 0:zo.candle)==null?void 0:Et.type;i()&&(ko==="renko_atr"||ko==="point_and_figure"||ko==="heikin_ashi")&&jt.switchChartType({chart:i(),newType:ko,reloadDataFn:async()=>{await ht()}})}catch{}if(i()){const ko=new KB(i()),Xo=new XB(i()),Ro=new JB(i()),To=Zx(i()),Co=nO(To);Xo.setProjectionManager(ko),Xo.setCreationManager(Ro),Xo.initialize(),console.log("Enhanced overlay system initialized with templates:",Object.keys(Co)),Io=bT({chart:i(),persistenceKey:s().key+"_drawings",onDrawingCreated:jo=>{console.log("✅ Drawing created:",jo.id,"for symbol:",jo.symbolKey)},onDrawingRemoved:(jo,ls)=>{console.log("🗑️ Drawing removed:",jo,"from symbol:",ls)},onSymbolChanged:(jo,ls)=>{console.log("🔄 Symbol changed in DrawingManager:",jo,"→",ls)}});const Hs=$f(s().symbol);Io.setCurrentSymbol(Hs),Ro.setCurrentSymbolKey(Hs),typeof window<"u"&&(window.overlayCreationManager=Ro),console.log("✅ DrawingManager initialized for symbol:",Hs)}Wa(M(),ys(r).cloudIndLoaded+=1,ys(r)),Ry.set(s().symbol),f1.set(s().period),console.log("🚀 About to call loadSymbols from onMount"),await ue(),console.log("✅ loadSymbols completed from onMount");try{window.__datafeed=k,window.__pipelineMetrics=()=>{var ko;return(ko=k.getPipelineMetrics)==null?void 0:ko.call(k)}}catch{}window.addEventListener("resize",at);let fe=i();try{gt=new ResizeObserver(()=>{at()}),j&&gt.observe(j),n(ye)&&gt.observe(n(ye)),n(le)&&gt.observe(n(le))}catch{}const Ae=()=>{},Le=()=>{},ft=ko=>{var jo,ls;const Xo=!ko||ko&&ko.x==null&&ko.y==null;if(!Xo&&ko&&typeof ko.x=="number"&&typeof ko.y=="number"&&(x(Wn,D(ko.x)),x(Tn,D(ko.y)),K.length&&fs()),!Xo||!j)return;const Ro=j.getBoundingClientRect();if(!(n(Ko)>=Ro.left&&n(Ko)<=Ro.right&&n(Qt)>=Ro.top&&n(Qt)<=Ro.bottom))return;const Co=n(Ko)-Ro.left,Hs=n(Qt)-Ro.top;try{(ls=(jo=i())==null?void 0:jo.getChartStore)==null||ls.call(jo).setCrosshair({x:Co,y:Hs,paneId:"candle_pane"},{forceInvalidate:!0})}catch{}};if(i()&&((wo=(Ut=i()).subscribeAction)==null||wo.call(Ut,Nv.OnZoom,Ae),(Ot=(xt=i()).subscribeAction)==null||Ot.call(xt,Nv.OnScroll,Le),(ts=(No=i()).subscribeAction)==null||ts.call(No,Nv.OnCrosshairChange,ft),De=()=>{var ko,Xo;return(Xo=(ko=i())==null?void 0:ko.unsubscribeAction)==null?void 0:Xo.call(ko,Nv.OnZoom,Ae)},Ee=()=>{var ko,Xo;return(Xo=(ko=i())==null?void 0:ko.unsubscribeAction)==null?void 0:Xo.call(ko,Nv.OnScroll,Le)},xe=()=>{var ko,Xo;return(Xo=(ko=i())==null?void 0:ko.unsubscribeAction)==null?void 0:Xo.call(ko,Nv.OnCrosshairChange,ft)}),setTimeout(()=>{var ko,Xo;if(fe)try{const Ro=((ko=fe.getDataList)==null?void 0:ko.call(fe))??[];Array.isArray(Ro)&&Ro.length>0&&x(oe,!0);const To=(Xo=fe.getVisibleRange)==null?void 0:Xo.call(fe);(Array.isArray(Ro)&&Ro.length>0&&To&&typeof To.to=="number"?To.to>=Ro.length-2:!1)&&fe.scrollToRealTime()}catch{}},100),Fl){try{Fl()}catch{}Fl=null}Fl=Qa(fe);const Bt=Sd(s().theme);uo.merge(Bt,tf(s().styles)),(Oo=i())==null||Oo.setStyles(Dc(Bt)),mi();try{const ko=()=>{var ls,Rn,Os,Pn,Oi,pi,an,tn,Hi,ps,_s,fn,Ci;if(!i())return;const Co=i();let Hs=[];try{Hs=((ls=Co.getIndicators)==null?void 0:ls.call(Co))??[]}catch{Hs=[]}const jo=Object.entries(s().saveInds||{});for(const[,dr]of jo){const vi=dr==null?void 0:dr.name;if(!vi)continue;const Fa=(dr==null?void 0:dr.pane_id)||"";if(Hs.some($i=>$i.name===vi&&(!Fa||$i.paneId===Fa)))continue;let ka;if(Array.isArray(dr.styles)&&dr.styles.length>0){const $i=mr=>mr==="dashed"||mr==="dotted"?{style:Oe.Dashed,dashedValue:mr==="dotted"?[2,2]:[4,4]}:{style:Oe.Solid,dashedValue:[2,2]};ka={lines:dr.styles.map(mr=>{const ad=$i(mr==null?void 0:mr.lineStyle);return{color:mr==null?void 0:mr.color,size:(mr==null?void 0:mr.thickness)??1,style:ad.style,dashedValue:ad.dashedValue}})}}let va;if(vi==="SMARTTREND"){const $i=dr.superTrendGroup;if(va=$i?{showLabels:!!$i.showLabels,uptrendColor:((Os=(Rn=$i.styles)==null?void 0:Rn.uptrend)==null?void 0:Os.color)??"#00FF00",downtrendColor:((Oi=(Pn=$i.styles)==null?void 0:Pn.downtrend)==null?void 0:Oi.color)??"#FF0000",uptrendThickness:((an=(pi=$i.styles)==null?void 0:pi.uptrend)==null?void 0:an.thickness)??1,downtrendThickness:((Hi=(tn=$i.styles)==null?void 0:tn.downtrend)==null?void 0:Hi.thickness)??1,uptrendLineStyle:((_s=(ps=$i.styles)==null?void 0:ps.uptrend)==null?void 0:_s.lineStyle)??"dashed",downtrendLineStyle:((Ci=(fn=$i.styles)==null?void 0:fn.downtrend)==null?void 0:Ci.lineStyle)??"dashed"}:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"},!ka){const mr=va.uptrendLineStyle==="dotted"||va.uptrendLineStyle==="dashed";ka={lines:[{color:va.uptrendColor,size:va.uptrendThickness,style:mr?Oe.Dashed:Oe.Solid,dashedValue:va.uptrendLineStyle==="dotted"?[2,2]:[4,4]}]}}}const wc=Fa==="candle_pane";try{Co.createIndicator({name:vi,calcParams:dr==null?void 0:dr.params,styles:ka,...va?{extendData:va}:{}},wc,Fa?{id:Fa}:void 0)}catch($i){console.warn("⚠️ Failed to restore indicator:",vi,$i)}}};let Xo=null;try{Xo=typeof window<"u"?localStorage.getItem("chart.activeSaveId"):null}catch{}console.log(Xo?"ℹ️ Active layout detected, SaveSystem will restore indicators.":"ℹ️ No active layout, will add default indicators if needed.");const Ro=Co=>{try{if(!i())return;const Hs=i();console.log("🎨 Adding default indicators...");const jo="candle_pane";try{Hs.createIndicator({name:"SMARTTREND",calcParams:[10,3],styles:{lines:[{color:"#00FF00",size:1,style:Oe.Dashed,dashedValue:[4,4]}]},extendData:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"}},!0,{id:jo})&&I().update(Rn=>(Rn.saveInds[`${jo}_SMARTTREND`]={name:"SMARTTREND",pane_id:jo,params:[10,3]},Rn))}catch{}try{const ls="candle_pane";Hs.createIndicator({name:"VOL",calcParams:[20],styles:{lines:[]}},!0,{id:ls})&&I().update(Os=>(Os.saveInds[`${ls}_VOL`]={name:"VOL",pane_id:ls,params:[20]},Os))}catch{}console.log("✅ Default indicators applied",{force:Co})}catch(Hs){console.warn("⚠️ Failed to add default indicators:",Hs)}};let To=!1;try{const Co=(Cn=performance.getEntriesByType)==null?void 0:Cn.call(performance,"navigation");Co&&Co.length>0?To=Co[0].type==="reload":performance.navigation&&(To=performance.navigation.type===1)}catch{}I().update(Co=>(Co.saveInds={},Co)),Xo?(console.log("✅ Active saved layout will be restored by SaveSystem"),setTimeout(()=>{var Co,Hs;try{const jo=typeof window<"u"?localStorage.getItem("chart.activeSaveId"):null,ls=((Hs=(Co=i())==null?void 0:Co.getIndicators)==null?void 0:Hs.call(Co))??[];!jo&&(!ls||ls.length===0)&&(console.log("🛟 No active layout after restore attempt; applying default indicators"),Ro(!0))}catch{}},500)):(console.log("🎨 No saved layout found, adding default indicators"),setTimeout(()=>{try{(typeof window<"u"?localStorage.getItem("chart.activeSaveId"):null)?console.log("ℹ️ activeSaveId appeared; skipping default indicators"):Ro(!0)}catch{Ro(!0)}},250))}catch(ko){console.warn("⚠️ Indicator restore failed:",ko)}if(((rn=(Cs=s().styles)==null?void 0:Cs.candle)==null?void 0:rn.type)==="point_and_figure"&&i())try{i().createIndicator("PNF",!1,{id:"candle_pane"}),console.log("📊 Added PNF indicator for initial Point & Figure chart")}catch(ko){console.warn("Failed to add initial PNF indicator:",ko)}Wa(M(),ys(r).initDone+=1,ys(r)),C()||setTimeout(()=>{i()&&!r().loadingKLine&&(console.log("🔄 Loading initial chart data after initialization"),ht())},100),ue(),setTimeout(()=>{console.log("🔍 Current allSymbols:",s().allSymbols),console.log("🔍 allSymbols length:",s().allSymbols.length)},3e3),j==null||j.focus();try{typeof window<"u"&&(window.drawBarRef=n(W),window.sidebarHostRef=n(Ce),window.predictNextCandle=()=>jd(),window.getAutoPlayState=()=>n(fo),window.getPlaybackSpeed=()=>n(Go),window.setPlaybackSpeed=ko=>Gs(ko),window.stopPrediction=()=>ia())}catch{}We=ko=>{if(!F_())return;(ko.key==="F5"||(ko.metaKey||ko.ctrlKey)&&(ko.key==="r"||ko.key==="R"))&&(ko.preventDefault(),ko.stopPropagation(),x(_d,!0))},window.addEventListener("keydown",We,{capture:!0}),de=ko=>{var Xo,Ro;if(F_()){try{const To=(((Xo=s())==null?void 0:Xo.key)||"chart")+"_drawings";localStorage.removeItem(To)}catch{}try{const To=(((Ro=s())==null?void 0:Ro.key)||"chart")+"_overlays";localStorage.removeItem(To)}catch{}try{localStorage.removeItem("dataSpaceOverlays")}catch{}ko.preventDefault(),ko.returnValue=""}},window.addEventListener("beforeunload",de),setTimeout(()=>{const ko=j==null?void 0:j.querySelectorAll(".klinecharts-pane-separator");ko==null||ko.forEach(Xo=>{const Ro=Xo;Ro.style.transition="background-color 0.2s ease, transform 0.1s ease",Ro.addEventListener("mouseenter",()=>{Ro.style.cursor="row-resize",Ro.style.transform="scaleY(1.2)"}),Ro.addEventListener("mouseleave",()=>{Ro.style.transform="scaleY(1)"}),Ro.addEventListener("mousedown",()=>{Ro.classList.add("dragging"),document.body.style.cursor="row-resize"});const To=()=>{Ro.classList.remove("dragging"),document.body.style.cursor=""};document.addEventListener("mouseup",To),Ro.addEventListener("touchstart",Co=>{Co.preventDefault(),Ro.classList.add("dragging"),"vibrate"in navigator&&navigator.vibrate(10)}),Ro.addEventListener("touchend",()=>{Ro.classList.remove("dragging")})})},500)}),rf(()=>{ia(),Nc&&(clearTimeout(Nc),Nc=null),be&&(cancelAnimationFrame(be),be=null),We&&window.removeEventListener("keydown",We,{capture:!0}),de&&window.removeEventListener("beforeunload",de);try{const N=Li}catch{}try{window.removeEventListener("resize",at)}catch{}if(De){try{De()}catch{}De=null}if(Ee){try{Ee()}catch{}Ee=null}if(xe){try{xe()}catch{}xe=null}if(es){try{es()}catch{}es=null}if(gt){try{gt.disconnect()}catch{}gt=null}if(Fl){try{Fl()}catch{}Fl=null}i()&&Ss(i())});function Qa(N){let X=null,fe=!1,Ae=0;const Le=800;let ft=0;const Bt=5;let Ft=null,zt=!1;const io=()=>{try{if(zt)return;const Et=N.getVisibleRange();if(!Et||fe)return;const Ut=N.getDataList();if(Ut.length===0)return;const wo=Ut.length-1;Ec=Et.to>=wo-1;const Ot=Et.to-Et.from;Ft=Ot;const No=Math.max(3,Math.min(15,Math.floor(Ot*.15))),ts=X&&Et.from<X.from,Oo=Et.from<=No,Cn=!X||Math.abs(Et.from-X.from)>1,Cs=Date.now(),rn=ft>=Bt?Le*3:Le,ko=Cs-Ae>rn;if(Et.from<=Math.max(1,Math.floor(No/2))&&ko||Oo&&ko){const Co=Ut[0];console.log(`🚀 Infinite scroll triggered: from=${Et.from}, threshold=${No}, dataLength=${Ut.length}, consecutive=${ft}`),Wt(Co.timestamp),Ae=Cs,ft+=1,setTimeout(()=>{ft=Math.max(0,ft-1)},Le*1.5)}X={...Et}}catch(Et){console.error("❌ Error checking scroll position:",Et)}},Wt=async Et=>{var Ut,wo,xt,Ot,No,ts,Oo,Cn,Cs,rn,ko,Xo;if(fe||r().loadingKLine||n(Nl)){console.log("⏳ Already loading data, skipping request...");return}fe=!0,x(Nl,!0),x(Yc,null),console.log("🔄 Loading more historical data...");try{const To=((wo=(Ut=s().styles)==null?void 0:Ut.candle)==null?void 0:wo.type)==="renko_atr"?Ja??Et:Et,Co=await k.loadMoreHistoricalData(s().symbol,s().period,To);if(Co.data.length>0){let Hs=Co.data;if(((Ot=(xt=s().styles)==null?void 0:xt.candle)==null?void 0:Ot.type)==="heikin_ashi")Hs=Oy(Hs);else if(((ts=(No=s().styles)==null?void 0:No.candle)==null?void 0:ts.type)==="renko_atr"){const Os=((Cn=(Oo=s().styles)==null?void 0:Oo.candle)==null?void 0:Cn.renko)||{method:"ATR",atrLength:14,source:"close",wick:!1};Hs=Vy(Hs,Os);try{const Pn=Xe(Co.data);Pn!=null&&(!Ja||Pn<Ja)&&(Ja=Pn)}catch{}}else if(((rn=(Cs=s().styles)==null?void 0:Cs.candle)==null?void 0:rn.type)==="point_and_figure"){const Os=((Xo=(ko=s().styles)==null?void 0:ko.candle)==null?void 0:Xo.pnf)||{boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"};Hs=Wy(Hs,Os)}const jo=N.getDataList();Hs.sort((Os,Pn)=>Os.timestamp-Pn.timestamp);const ls=new Set(jo.map(Os=>Os.timestamp)),Rn=Hs.filter(Os=>!ls.has(Os.timestamp));if(Rn.length>0){const Os=N.getVisibleRange(),Pn=(Os==null?void 0:Os.to)??null,Oi=!Os||!jo.length?!1:Os.to>=jo.length-2,pi=Pn!==null&&jo[Pn]?jo[Pn].timestamp:null,an=[...Rn,...jo].sort((tn,Hi)=>tn.timestamp-Hi.timestamp);N.applyNewData(an,{backward:!0,forward:!0});try{Cl()}catch{}try{an.length>0&&x(oe,!0)}catch{}console.log(`✅ Successfully loaded and merged ${Rn.length} more historical bars`),x(Yc,null),Os&&requestAnimationFrame(()=>{var tn;try{if(Oi){N.scrollToDataIndex(an.length-1),console.log("🎯 Scroll anchored to right edge (pinned)");return}if(pi){N.scrollToTimestamp(pi),console.log(`🎯 Scroll anchored to timestamp ${pi} (stable)`);return}const Hi=(Pn??0)+Rn.length;N.scrollToDataIndex(Hi),console.log(`🎯 Scroll anchored to index ${Hi} (fallback)`)}catch(Hi){const ps=pi??((tn=an[Rn.length])==null?void 0:tn.timestamp);if(ps)try{N.scrollToTimestamp(ps)}catch{}console.warn("Could not maintain scroll position:",Hi)}})}else console.log("📭 No new unique historical data to add");Co.lays&&Co.lays.length>0&&n(W)&&Co.lays.forEach(Os=>{n(W).addOverlay(Os)})}else console.log("📭 No historical chunk available from cache at the moment"),zt=!k.hasMoreServerHistory(s().symbol,s().period)}catch(Ro){console.error("❌ Error loading more historical data:",Ro),x(Yc,D(Ro instanceof Error?Ro.message:"Failed to load historical data")),st.addAlert("error",`Failed to load historical data: ${n(Yc)}`)}finally{fe=!1,x(Nl,!1)}},zo=setInterval(io,100);return()=>{clearInterval(zo),console.log("🧹 Infinite scrolling cleanup completed")}}async function ue(){s().allSymbols||Wa(I(),ys(s).allSymbols=[],ys(s)),console.log("🚀 loadSymbols function called. loadingPairs:",r().loadingPairs,"allSymbols length:",s().allSymbols.length),Wa(M(),ys(r).loadingPairs=!0,ys(r)),console.log("🔄 Loading symbols..."),console.log("🔄 loadSymbols proceeding");const N=await k.getSymbols();console.log("📊 Symbols loaded:",N),console.log("📊 Symbols loaded count:",N.length),Wa(I(),ys(s).allSymbols=N,ys(s));const X=new Set;N.forEach(fe=>{fe.exchange&&X.add(fe.exchange)}),I().update(fe=>(X.forEach(Ae=>{fe.allExgs.add(Ae)}),fe)),Wa(M(),ys(r).loadingPairs=!1,ys(r))}async function Fe(N,X,fe,Ae,Le=!0,ft=qa){var Ot,No,ts,Oo,Cn,Cs,rn,ko,Xo,Ro,To;const Bt=i();if(!Bt)return;ft===qa&&Wa(M(),ys(r).loadingKLine=!0,ys(r));const Ft=a().url.searchParams.get("strategy");console.log("loadKlineRange",{symbol:N,period:X,start_ms:fe,stop_ms:Ae,strategy:Ft});const zt=await k.getHistoryKLineData({symbol:N,period:X,from:fe,to:Ae,strategy:Ft});let Wt=(zt.data||[]).slice(Math.max(0,(zt.data||[]).length-600));if(!Wt||Wt.length===0){ft===qa&&Wa(M(),ys(r).loadingKLine=!1,ys(r));return}const zo=((No=(Ot=s().styles)==null?void 0:Ot.candle)==null?void 0:No.type)||mT((Oo=(ts=i())==null?void 0:ts.getStyles)==null?void 0:Oo.call(ts),s().styles),Et=Xg(N),Ut=zo;if(Ut==="heikin_ashi")Wt=Oy(Wt);else if(Ut==="renko_atr"){try{const Hs=Xe(zt.data);Hs!=null&&(!Ja||Hs<Ja)&&(Ja=Hs)}catch{}const Co=((Cs=(Cn=s().styles)==null?void 0:Cn.candle)==null?void 0:Cs.renko)||{method:"ATR",atrLength:14,source:"close",wick:!1};Wt=Vy(Wt,Co)}else if(Ut==="point_and_figure"){const Co=((ko=(rn=s().styles)==null?void 0:rn.candle)==null?void 0:ko.pnf)||{boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"};Wt=Wy(Wt,Co)}if(Wt=Wt.map((Co,Hs)=>((!Co.timestamp||isNaN(Co.timestamp)||Co.timestamp<=0)&&(console.warn(`Invalid timestamp in klines at index ${Hs}:`,Co.timestamp),Co.timestamp=Date.now()-(Wt.length-Hs)*6e4),Co)),ft!==qa){console.log("⏭️ Ignoring stale load result");return}try{let Co=Jg(N,zt.data);try{const ls=Array.isArray(zt.data)?zt.data[zt.data.length-1]:null,Rn=ls&&typeof ls=="object"?Number(ls.close):Array.isArray(ls)?Number(ls[4]):NaN;(Number.isFinite(Rn)&&Math.abs(Rn)>=1e4||Et==="crypto"&&Number.isFinite(Rn)&&Math.abs(Rn)>=1e3)&&(Co=2)}catch{}((Ro=(Xo=Bt==null?void 0:Bt.getSymbol)==null?void 0:Xo.call(Bt))==null?void 0:Ro.pricePrecision)!==Co&&(Bt==null||Bt.setSymbol({pricePrecision:Co}));const jo=N==null?void 0:N.pricePrecision;(!Number.isFinite(jo)||jo!==Co)&&I().update(ls=>(ls.symbol&&ls.symbol.ticker===N.ticker&&(ls.symbol.pricePrecision=Co),ls))}catch{}const wo=Ut==="renko_atr",xt=!wo&&Le&&Wt.length>0;Bt.applyNewData(Wt,!!xt);try{Cl()}catch{}try{(Wt??[]).length>0&&x(oe,!0)}catch{}try{k.startBackgroundPrefetch(N,{timeframe:X.timeframe})}catch{}if(zt.lays&&zt.lays.length>0&&n(W)&&zt.lays.forEach(Co=>{n(W).addOverlay(Co)}),ft===qa&&Wa(M(),ys(r).loadingKLine=!1,ys(r)),Wa(M(),ys(r).klineLoaded+=1,ys(r)),Wt.length){const Co=Am(X.timeframe)*1e3,Hs=new Date().getTime(),jo=Wt[Wt.length-1].timestamp+Co;!wo&&jo+Co>Hs&&(((To=s().options)==null?void 0:To.enableRealtime)===!0||l().playing===!0?k.subscribe(N,Rn=>{const Os=Rn;if(!(N.exchange==="DSEBD"?(()=>{var mr,ad,Gd;const Fa=new Date,ri=new Intl.DateTimeFormat("en-GB",{timeZone:"Asia/Dhaka",hour12:!1,weekday:"short",hour:"2-digit",minute:"2-digit"}).formatToParts(Fa),ka=((mr=ri.find(Kc=>Kc.type==="weekday"))==null?void 0:mr.value)??"",va=Number(((ad=ri.find(Kc=>Kc.type==="hour"))==null?void 0:ad.value)??"0"),wc=Number(((Gd=ri.find(Kc=>Kc.type==="minute"))==null?void 0:Gd.value)??"0"),$i=va*60+wc;return["Sun","Mon","Tue","Wed","Thu"].includes(ka)&&$i>=600&&$i<=870})():!0))return;const Oi=Bt.getDataList(),pi=Oi[Oi.length-1],an=pi&&pi.timestamp?[pi.timestamp,pi.open,pi.high,pi.low,pi.close,pi.volume??0]:null,tn=fT(Os.bars,Os.secs*1e3,Co,an),Hi=Bt.getChartStore(),ps=Bt.getVisibleRange(),_s=Bt.getDataList(),fn=ps&&_s[ps.from]?_s[ps.from].timestamp:null,Ci=_s.length-1,dr=ps?ps.to>=Ci-1:!0,vi=tn.map(([Fa,ri,ka,va,wc,$i])=>({timestamp:Fa,open:ri,high:ka,low:va,close:wc,volume:$i}));Hi.addData(vi,"backward",{forward:dr,backward:!1});try{const Fa=Bt.getDataList();Array.isArray(Fa)&&Fa.length>0&&x(oe,!0)}catch{}!dr&&ps&&fn&&requestAnimationFrame(()=>{try{const ri=Bt.getDataList().findIndex(ka=>ka.timestamp===fn);ri!==-1?Bt.scrollToDataIndex(ri):Bt.scrollToDataIndex(ps.from)}catch{}})}):console.log("⏹️ Realtime updates disabled"))}}async function ut(){x(oe,!1);const N=Cy(s().dateStart);let X=Cy(s().dateEnd);if(!N||!X){st.addAlert("error","invalid time, please use: 202301011200");return}const fe=Am(s().period.timeframe)*1e3;(X-N)/fe>T&&(X=N+fe*T),await Fe(s().symbol,s().period,N,X,!1)}const Xe=N=>{if(!Array.isArray(N)||N.length===0)return null;let X=1/0;for(const fe of N){const Ae=fe==null?void 0:fe.timestamp,Le=typeof Ae=="number"?Ae:Number(Ae);Number.isFinite(Le)&&Le<X&&(X=Le)}return Number.isFinite(X)?X:null};async function ht(N){console.log("🔄 loadSymbolPeriod called"),x(oe,!1);const X=s().symbol,fe=s().period;console.log("🔄 Loading symbol:",X.ticker,"period:",fe.timeframe);const Ae=new Date().getTime(),[Le,ft]=_k(fe,Ae,Ke),Bt=N??qa,Ft=X.ticker,zt=fe.timeframe;console.log("🔄 Time range:",new Date(Le),"to",new Date(Ae));try{await Fe(X,fe,Le,Ae,!C(),Bt)}catch(io){console.warn("⚠️ loadSymbolPeriod failed:",io)}try{setTimeout(()=>{var io;try{if(Bt!==qa||Ft!==s().symbol.ticker||zt!==s().period.timeframe)return;const Wt=i(),zo=((io=Wt==null?void 0:Wt.getDataList)==null?void 0:io.call(Wt))??[];if(!Array.isArray(zo)||zo.length===0){const Et=Bt;console.log("🔁 Retrying loadSymbolPeriod due to empty data after TF change"),Fe(X,fe,Le,Ae,!C(),Et)}}catch{}},250)}catch{}}Nd(I(),N=>N.period.timeframe).subscribe(async N=>{var fe,Ae,Le,ft,Bt,Ft,zt,io,Wt,zo,Et;const X=((Ae=(fe=s().styles)==null?void 0:fe.candle)==null?void 0:Ae.type)==="renko_atr";try{if(!X){const Ut=`${s().period.timespan}`;if(Td!==Ut){const wo=Iy(s().period.timespan),xt=new Map,Ot=800,No=({timestamp:Cn,template:Cs,type:rn})=>{const ko=`${rn}|${Cs}|${Cn}`,Xo=xt.get(ko);if(Xo)return Xo;const Ro=wo(Cn,Cs,rn);return xt.size>=Ot&&xt.clear(),xt.set(ko,Ro),Ro},ts=i(),Oo=(Le=ts==null?void 0:ts.getChartStore)==null?void 0:Le.call(ts);Oo!=null&&Oo.setFormatter&&(Oo.setFormatter({formatDate:No}),Td=Ut)}}}catch{}f1.set(s().period);try{const Ut=s().period,xt={s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month"}[Ut.timespan]??"day",Ot=Number(Ut.multiplier)||1;((Bt=(ft=s().styles)==null?void 0:ft.candle)==null?void 0:Bt.type)!=="renko_atr"&&((Ft=i())==null||Ft.setPeriod({type:xt,span:Ot}))}catch{}if(Ja=null,!(C()||!i())){try{k.unsubscribe()}catch{}if(!X&&sa&&(sa=!1),X){jl+=1;const Ut=jl,wo=td();sa=!0;try{try{(zt=i())==null||zt.setScrollEnabled(!1),(io=i())==null||io.setZoomEnabled(!1)}catch{}try{x(oe,!1)}catch{}try{(Wt=i())==null||Wt.applyNewData([],!1)}catch{}try{const xt=k;typeof xt.stopSymbolPipelines=="function"&&xt.stopSymbolPipelines(s().symbol.ticker)}catch{}await ht(wo),qa===wo&&jl===Ut&&(sa=!1,Lt.request(()=>{var xt;try{(xt=i())==null||xt.resize()}catch{}mi()}))}catch(xt){console.warn("⚠️ Renko timeframe refresh failed:",xt)}finally{try{(zo=i())==null||zo.setScrollEnabled(!0),(Et=i())==null||Et.setZoomEnabled(!0)}catch{}jl===Ut&&(sa=!1)}}else jt.changeTimeframe({chart:i(),period:s().period,loadDataFn:async()=>{const Ut=td();try{x(oe,!1)}catch{}await ht(Ut)}});if(Fl){try{Fl()}catch{}Fl=null}i()&&(Fl=Qa(i()))}}),Nd(I(),N=>N.symbol.ticker).subscribe(N=>{var Le;console.log("📊 Symbol subscription triggered:",N),console.log("📊 Current symbol:",s().symbol),console.log("📊 Loading state:",r().loadingKLine,"Custom load:",C()),Ry.set(s().symbol);const X={...s().symbol,ticker:s().symbol.ticker,pricePrecision:Jg(s().symbol),volumePrecision:s().symbol.volumePrecision};try{xb({logo:s().symbol.logo,logo2:s().symbol.logo2})}catch{}if((Le=i())==null||Le.setSymbol(X),Ja=null,Io){const ft=$f(s().symbol);Io.setCurrentSymbol(ft),console.log("🔄 DrawingManager updated to symbol:",ft),Io.renderCurrentSymbolDrawings()}try{const ft=window.overlayCreationManager;ft&&ft.setCurrentSymbolKey($f(s().symbol))}catch{}if(C())return;console.log("📊 Proceeding with symbol change - unsubscribing and loading new data");const fe=S;S=s().symbol,fe&&fe.ticker!==s().symbol.ticker?k.unsubscribe(fe):k.unsubscribe();try{x(oe,!1)}catch{}if(Fl){try{Fl()}catch{}Fl=null}i()&&(Fl=Qa(i()));const Ae=td();ht(Ae)});const eo=["SMART_MONEY","TRAP_HUNTER","VOLCANIC","VOLCANIC_SIG"];function Mo(){var Ae,Le;if(!i())return;const N=(Ae=c())==null?void 0:Ae.data;if(N&&(N.isPremium===!0||N.isTrial===!0))return;console.log("🔒 User does not have premium access. Removing AI indicators...");const fe=i();try{const ft=((Le=fe.getIndicators)==null?void 0:Le.call(fe))??[];let Bt=0;for(const Ft of ft)if(Ft.name&&eo.includes(Ft.name))try{fe.removeIndicator({paneId:Ft.paneId||"candle_pane",name:Ft.name}),Bt+=1,console.log(`✅ Removed AI indicator: ${Ft.name} from pane: ${Ft.paneId}`)}catch(zt){console.warn(`⚠️ Failed to remove indicator ${Ft.name}:`,zt)}I().update(Ft=>{if(!Ft.saveInds)return Ft;const zt=[];return Object.keys(Ft.saveInds).forEach(io=>{const Wt=Ft.saveInds[io];Wt&&Wt.name&&eo.includes(Wt.name)&&zt.push(io)}),zt.forEach(io=>{delete Ft.saveInds[io],console.log(`🧹 Removed AI indicator from saveInds: ${io}`)}),Ft}),Bt>0&&(xv(),console.log(`✅ Removed ${Bt} AI indicator(s) due to lack of premium access`))}catch(ft){console.error("❌ Error removing AI indicators:",ft)}}let ho=ee(null),to=ee(!1);zr(()=>{var Ae;if(!i())return;const N=(Ae=c())==null?void 0:Ae.data;if(N===void 0)return;const X=N&&(N.isPremium===!0||N.isTrial===!0);(!n(to)||n(ho)===!0&&X===!1)&&!X&&setTimeout(()=>{Mo()},1e3),x(ho,D(X)),x(to,!0)});const ds=Nd(I(),N=>N.theme);let js=s().theme;ds.subscribe(N=>{var Bt,Ft,zt,io,Wt,zo,Et,Ut,wo,xt,Ot,No,ts,Oo,Cn,Cs,rn,ko,Xo,Ro,To,Co,Hs,jo,ls,Rn,Os,Pn,Oi,pi,an,tn,Hi,ps,_s,fn,Ci,dr,vi,Fa,ri,ka,va,wc,$i,mr,ad,Gd,Kc;if(console.log("🎨 THEME SUBSCRIPTION TRIGGERED:",N,"Previous:",js),N===js){console.log("⏸️ Theme value unchanged, skipping subscription");return}if(console.log("🎨 THEME ACTUALLY CHANGED:",js,"->",N),js=N,Uc){console.log("⏸️ Skipping theme subscription - manual styles being applied");return}if(r().isApplyingManualStyles){console.log("⏸️ SKIPPING theme application - manual styles are being applied via context");return}N=="light"?(Wa(I(),ys(s).colorLong="green",ys(s)),Wa(I(),ys(s).colorShort="red",ys(s))):(Wa(I(),ys(s).colorLong="green",ys(s)),Wa(I(),ys(s).colorShort="rgb(255,135,8)",ys(s)));const X=Sd(s().theme);console.log("🎨 Theme styles from getThemeStyles:",JSON.stringify(X,null,2)),console.log("💾 Current save.styles:",JSON.stringify(s().styles,null,2));const fe=tf(s().styles),Ae=(Bt=fe==null?void 0:fe.candle)==null?void 0:Bt.type;Ae&&console.log("🔒 Preserving chart type during theme change:",Ae);const Le=uo.merge({},X,fe);console.log("🎨 theme axis colors:",(io=(zt=(Ft=X==null?void 0:X.xAxis)==null?void 0:Ft.tickText)==null?void 0:zt.style)==null?void 0:io.color,(Et=(zo=(Wt=X==null?void 0:X.yAxis)==null?void 0:Wt.tickText)==null?void 0:zo.style)==null?void 0:Et.color),console.log("💾 saved axis colors:",uo.get(fe,"xAxis.tickText.style.color"),uo.get(fe,"yAxis.tickText.style.color")),Ae&&Le.candle&&(Le.candle.type=Ae);try{const vd=(xt=(wo=(Ut=X==null?void 0:X.candle)==null?void 0:Ut.tooltip)==null?void 0:wo.title)==null?void 0:xt.color;if(vd&&((No=(Ot=Le==null?void 0:Le.candle)==null?void 0:Ot.tooltip)!=null&&No.title)){Le.candle.tooltip.title.color=vd;try{I().update($l=>($l.styles||($l.styles={}),uo.set($l.styles,"candle.tooltip.title.color",vd),$l))}catch{}}}catch{}try{const vd=(Cn=(Oo=(ts=X==null?void 0:X.candle)==null?void 0:ts.tooltip)==null?void 0:Oo.legend)==null?void 0:Cn.color,$l=(ko=(rn=(Cs=X==null?void 0:X.indicator)==null?void 0:Cs.tooltip)==null?void 0:rn.legend)==null?void 0:ko.color;if(vd&&((Ro=(Xo=Le==null?void 0:Le.candle)==null?void 0:Xo.tooltip)!=null&&Ro.legend)){Le.candle.tooltip.legend.color=vd;try{I().update(ha=>(ha.styles||(ha.styles={}),uo.set(ha.styles,"candle.tooltip.legend.color",vd),ha))}catch{}}if($l&&((Co=(To=Le==null?void 0:Le.indicator)==null?void 0:To.tooltip)!=null&&Co.legend)){Le.indicator.tooltip.legend.color=$l;try{I().update(ha=>(ha.styles||(ha.styles={}),uo.set(ha.styles,"indicator.tooltip.legend.color",$l),ha))}catch{}}}catch{}try{const vd=(ls=(jo=(Hs=X==null?void 0:X.xAxis)==null?void 0:Hs.tickText)==null?void 0:jo.style)==null?void 0:ls.color,$l=(Pn=(Os=(Rn=X==null?void 0:X.yAxis)==null?void 0:Rn.tickText)==null?void 0:Os.style)==null?void 0:Pn.color;vd&&((pi=(Oi=Le==null?void 0:Le.xAxis)==null?void 0:Oi.tickText)!=null&&pi.style)&&(Le.xAxis.tickText.style.color=vd,(an=Le==null?void 0:Le.xAxis)!=null&&an.tickText&&(delete Le.xAxis.tickText.color,delete Le.xAxis.tickText.opacity,Le.xAxis.tickText.color=vd)),$l&&((Hi=(tn=Le==null?void 0:Le.yAxis)==null?void 0:tn.tickText)!=null&&Hi.style)&&(Le.yAxis.tickText.style.color=$l,(ps=Le==null?void 0:Le.yAxis)!=null&&ps.tickText&&(delete Le.yAxis.tickText.color,delete Le.yAxis.tickText.opacity,Le.yAxis.tickText.color=$l))}catch{}try{if((fn=(_s=Le==null?void 0:Le.candle)==null?void 0:_s.tooltip)!=null&&fn.legend){const vd=Le.candle.tooltip.legend.color;Le.candle.tooltip.legend.template=({current:$l})=>{const ha="#32CD32",et="#FF0000",As=(($l==null?void 0:$l.close)??0)>(($l==null?void 0:$l.open)??0),yn=(($l==null?void 0:$l.close)??0)<(($l==null?void 0:$l.open)??0),ae=As?ha:yn?et:vd,Ns=ki=>({text:ki,color:ae});return typeof window<"u"&&window.innerWidth<=768?[{title:"O",value:Ns("{open}")},{title:"H",value:Ns("{high}")},{title:"L",value:Ns("{low}")},{title:"C",value:Ns("{close}")},{title:"V",value:Ns("{volume}")}]:[{title:"O",value:Ns("{open}")},{title:"H",value:Ns("{high}")},{title:"L",value:Ns("{low}")},{title:"C",value:Ns("{close}")},{title:"V",value:Ns("{volume}")}]}}}catch{}console.log("🔄 Merged styles (theme + saved):",JSON.stringify(Le,null,2)),console.log("🔄 merged axis colors before process:",(vi=(dr=(Ci=Le==null?void 0:Le.xAxis)==null?void 0:Ci.tickText)==null?void 0:dr.style)==null?void 0:vi.color,(ka=(ri=(Fa=Le==null?void 0:Le.yAxis)==null?void 0:Fa.tickText)==null?void 0:ri.style)==null?void 0:ka.color);const ft=Dc(Le);console.log("✨ Final processed styles:",JSON.stringify(ft,null,2)),console.log("✨ processed axis colors:",($i=(wc=(va=ft==null?void 0:ft.xAxis)==null?void 0:va.tickText)==null?void 0:wc.style)==null?void 0:$i.color,(Gd=(ad=(mr=ft==null?void 0:ft.yAxis)==null?void 0:mr.tickText)==null?void 0:ad.style)==null?void 0:Gd.color),(Kc=i())==null||Kc.setStyles(ft),console.log("✅ Styles applied to chart via theme subscription"),console.log("🎨 APPLYING SAVED CANVAS COLORS AFTER THEME CHANGE"),setTimeout(()=>{mi(),console.log("✅ Canvas colors reapplied after theme change")},100),setTimeout(()=>{var $l,ha,et;console.log("🔍 CHART STATE CHECK after theme subscription:");const vd=($l=i())==null?void 0:$l.getStyles();console.log("  - Current chart styles:",JSON.stringify(vd,null,2)),console.log("  - Saved chart type in $save.styles:",(et=(ha=s().styles)==null?void 0:ha.candle)==null?void 0:et.type)},200)}),Nd(I(),N=>N.timezone).subscribe(N=>{var X;(X=i())==null||X.setTimezone(N),My(N)});const $r=Nd(I(),N=>{var X,fe;return(fe=(X=N.styles)==null?void 0:X.candle)==null?void 0:fe.type});let pa=((yr=(ks=s().styles)==null?void 0:ks.candle)==null?void 0:yr.type)||null;$r.subscribe(N=>{if(r().loadingKLine||C())return;const X=i();if(!X)return;Ja=null;const fe=pa==="point_and_figure",Ae=N==="point_and_figure";if(Ae&&!fe)try{X.createIndicator("PNF",!1,{id:"candle_pane"}),console.log("📊 Added PNF indicator for Point & Figure chart")}catch(Le){console.warn("Failed to add PNF indicator:",Le)}else if(!Ae&&fe)try{X.removeIndicator({paneId:"candle_pane",name:"PNF"}),console.log("📊 Removed PNF indicator (switched from P&F)");const Le=Sd(s().theme),ft=uo.merge({},Le,tf(s().styles)),Bt=Dc(ft);X.setStyles(Bt),console.log("🎨 Refreshed styles after P&F exit - candle colors restored")}catch(Le){console.warn("Failed to cleanup after P&F:",Le)}pa=N||null,(N==="heikin_ashi"||N==="renko_atr"||N==="point_and_figure"||N!=="heikin_ashi"&&N!=="renko_atr"&&N!=="point_and_figure"&&X.getDataList().length>0)&&jt.switchChartType({chart:X,newType:N||"candle_solid",reloadDataFn:async()=>{await ht()}})}),Nd(I(),N=>{var fe,Ae;const X=((Ae=(fe=N.styles)==null?void 0:fe.candle)==null?void 0:Ae.renko)||{};return JSON.stringify(X)}).subscribe(N=>{var fe,Ae;if(r().loadingKLine||C()||((Ae=(fe=s().styles)==null?void 0:fe.candle)==null?void 0:Ae.type)!=="renko_atr")return;const X=i();X&&jt.switchChartType({chart:X,newType:"renko_atr",reloadDataFn:async()=>{await ht()}})}),Nd(I(),N=>{var fe,Ae;const X=((Ae=(fe=N.styles)==null?void 0:fe.candle)==null?void 0:Ae.pnf)||{};return JSON.stringify(X)}).subscribe(N=>{var fe,Ae;if(r().loadingKLine||C()||((Ae=(fe=s().styles)==null?void 0:fe.candle)==null?void 0:Ae.type)!=="point_and_figure")return;const X=i();X&&jt.switchChartType({chart:X,newType:"point_and_figure",reloadDataFn:async()=>{await ht()}})}),Nd(M(),N=>N.fireOhlcv).subscribe(async N=>{r().timeStart&&r().timeEnd?(await Fe(s().symbol,s().period,r().timeStart,r().timeEnd),Wa(M(),ys(r).timeStart=0,ys(r)),Wa(M(),ys(r).timeEnd=0,ys(r))):await ut()});function Zs(){return i()}function gn(N){Uc=N}let Wn=ee(0),Tn=ee(0),Ko=ee(0),Qt=ee(0),H=ee(!1),Me=ee(0),Ue=ee(0),yt=ee(""),St,lo=ee(!1),he=ee(""),ke=0,Ne=0,ie=null,Ct=ee(D([])),Kt=ee(0),fo=ee(!1),mo=null,Go=ee(1);function Fo(N){var X,fe;if(i())try{const Ae=i(),Le=((X=Ae.getPaneOptions)==null?void 0:X.call(Ae,N))||null,ft=(Le==null?void 0:Le.state)||"normal",Bt=ft==="maximize"?"normal":"maximize";(fe=Ae.setPaneOptions)==null||fe.call(Ae,{id:N,state:Bt}),console.log("🖱️ Pane double-click toggle",{paneId:N,from:ft,to:Bt})}catch(Ae){console.warn("⚠️ Failed to toggle pane state",N,Ae)}}function Wo(N){var Bt;if(!i()||!j)return;const X=i();try{if(!(((Bt=X.getIndicators)==null?void 0:Bt.call(X))??[]).some(io=>io.paneId&&io.paneId!=="candle_pane"))return}catch{return}const fe=X._drawPanes;if(!Array.isArray(fe)||fe.length===0){Fo("candle_pane");return}const Ae=j.getBoundingClientRect(),Le=N.clientY-Ae.top;let ft=null;for(const Ft of fe){if(!Ft||typeof Ft.getId!="function"||typeof Ft.getBounding!="function")continue;const zt=Ft.getId();if(zt==="x_axis_pane")continue;const io=Ft.getBounding();if(!io||typeof io.height!="number")continue;const Wt=typeof io.top=="number"?io.top:0,zo=io.height;if(Le>=Wt&&Le<=Wt+zo){ft=zt;break}}ft||(ft="candle_pane"),Fo(ft)}function us(N){const X=j==null?void 0:j.getBoundingClientRect();X&&(x(Wn,N.clientX-X.left),x(Tn,N.clientY-X.top)),x(Ko,D(N.clientX)),x(Qt,D(N.clientY)),K.length&&fs()}function Un(){x(Wn,-1),x(Tn,-1),x(Ko,-1),x(Qt,-1),go()}function or(N){if(N.preventDefault(),cr())return;const X=j==null?void 0:j.getBoundingClientRect();if(X){const fe=N.clientX-X.left,Ae=N.clientY-X.top;x(Me,fe),x(Ue,Ae),x(yt,D(xu())),wa(fe,Ae)}}function $s(N){if(N.touches.length===1){const X=N.touches[0],fe=j==null?void 0:j.getBoundingClientRect();fe&&(x(Wn,X.clientX-fe.left),x(Tn,X.clientY-fe.top)),x(Ko,D(X.clientX)),x(Qt,D(X.clientY));const Ae=N.target;if(n(H)&&Ae&&(Ae.closest(".modal-content")||Ae.closest(".action-btn")))return;const Le=Date.now(),ft=Le-ke;if(ft<300&&ft>0){if(Ne+=1,Ne===2){if(N.preventDefault(),fe){const Bt=X.clientX-fe.left,Ft=X.clientY-fe.top;gi(Bt,Ft)}Ne=0;return}}else if(Ne=1,n(H)){N.preventDefault(),kn(),Ne=0;return}ke=Le,ie&&clearTimeout(ie),ie=setTimeout(()=>{Ne=0},300)}}function gi(N,X){x(Me,D(N)),x(Ue,D(X)),x(yt,D(xu())),x(H,!0)}function kn(){x(H,!1)}let _r=ee(!1),Kr=ee(0),Ul=ee(0);function wa(N,X){x(Kr,D(N)),x(Ul,D(X)),x(_r,!0)}function wl(){x(_r,!1)}function Cl(){var N;try{if(n(U))return;const X=i();if(!X)return;const fe=X.getVisibleRange(),Ae=((N=X.getDataList)==null?void 0:N.call(X))??[];if(!fe||!Array.isArray(Ae)||Ae.length===0)return;const Le=fe.to-fe.from+1;x(J,Le),x(se,fe.to>=Ae.length-2),x(U,!0)}catch{}}function dl(){var X,fe,Ae;const N=i();if(N)try{Cl();const Le=j==null?void 0:j.getBoundingClientRect(),ft=Le?Le.width:((X=N.getSize())==null?void 0:X.width)??0,Bt=N.getDataList(),Ft=Math.min(180,Array.isArray(Bt)?Bt.length:180),zt=Math.max(1,n(J)??Ft),io=N.getChartStore(),Wt=ft>0?Math.floor(ft/zt):io.getBarSpace().bar,zo=Math.max(1,Math.min(50,Wt));io.setBarSpace(zo);const Et=((fe=io.getInitialOffsetRightDistance)==null?void 0:fe.call(io))??io.getOffsetRightDistance();io.setOffsetRightDistance(Et,!0),N.scrollToRealTime(),(Ae=N._drawPanes)==null||Ae.forEach(wo=>{var Ot,No,ts;const xt=(Ot=wo==null?void 0:wo.getAxisComponent)==null?void 0:Ot.call(wo);(No=xt==null?void 0:xt.setAutoCalcTickFlag)==null||No.call(xt,!0),(ts=xt==null?void 0:xt.buildTicks)==null||ts.call(xt,!0)})}finally{wl()}}function cr(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window||navigator.maxTouchPoints>0}async function Br(N){try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(N),console.log("✅ Copied using modern clipboard API"),!0}catch(X){console.warn("Modern clipboard API failed:",X)}try{const X=document.createElement("textarea");X.value=N,X.style.position="fixed",X.style.left="-999999px",X.style.top="-999999px",X.style.opacity="0",X.style.pointerEvents="none",X.setAttribute("readonly",""),document.body.appendChild(X),X.focus(),X.select(),X.setSelectionRange(0,N.length);const fe=document.execCommand("copy");if(document.body.removeChild(X),fe)return console.log("✅ Copied using fallback method"),!0}catch(X){console.error("Fallback copy method failed:",X)}try{const X=window.getSelection();if(X){const fe=document.createRange(),Ae=document.createElement("span");Ae.textContent=N,Ae.style.position="fixed",Ae.style.left="-999999px",Ae.style.opacity="0",document.body.appendChild(Ae),fe.selectNode(Ae),X.removeAllRanges(),X.addRange(fe);const Le=document.execCommand("copy");if(document.body.removeChild(Ae),X.removeAllRanges(),Le)return console.log("✅ Copied using selection API fallback"),!0}}catch(X){console.error("Selection API fallback failed:",X)}return console.error("❌ All copy methods failed"),!1}function Fi(){const N=i();if(!N)return console.error("Chart not initialized"),!1;try{const X=N.getDataList();if(X.length<10)return console.warn("⚠️ Need more historical data for prediction"),!1;const fe=X[X.length-1],Le=Am(s().period.timeframe)*1e3;if(!pV(fe.timestamp,Le)&&n(Kt)===0){const wo=Date.now()-fe.timestamp,xt=Math.floor(wo/6e4);console.info(`ℹ️ Market appears to be open (last candle ${xt}m ago). Prediction is most useful when market is closed.`)}const Bt=X,Ft=uV(Bt);if(!Ft)return console.error("❌ Failed to generate prediction"),!1;x(Ct,D([...n(Ct),Ft])),m5(Kt);const zt=[...Bt,Ft],io=N.getVisibleRange(),Wt=io?io.to>=Bt.length-2:!0;N.applyNewData(zt,!1);try{(zt??[]).length>0&&x(oe,!0)}catch{}Wt&&setTimeout(()=>{N.scrollToRealTime()},50);const zo=Bt[Bt.length-1].close,Et=(Ft.close-zo)/zo*100,Ut=Et>0?"📈":"📉";return console.log(`${Ut} Prediction #${n(Kt)}: ${Et>0?"+":""}${Et.toFixed(2)}% (Close: ${Ft.close.toFixed(2)})`),console.log("✅ Prediction added:",Ft),console.log("📊 Total predictions so far:",n(Kt)),!0}catch(X){return console.error("❌ Prediction error:",X),!1}}function fr(){return Math.round(2e3/n(Go))}function gl(){if(!n(fo))return;mo&&(clearInterval(mo),mo=null);const N=fr();mo=setInterval(()=>{n(fo)&&Fi()},N),console.log(`⚡ Speed changed: ${n(Go)}x (${N}ms interval)`)}function Gs(N){x(Go,D(N)),gl()}function Ql(){if(n(fo))return;x(fo,!0),console.log("▶️ Auto-play started"),Fi();const N=fr();mo=setInterval(()=>{n(fo)&&Fi()},N)}function ia(){x(fo,!1),mo&&(clearInterval(mo),mo=null),console.log("⏸️ Auto-play stopped")}function jd(){n(fo)?ia():Ql()}function xu(){const N=i();if(!N||n(Wn)===null||n(Tn)===null)return"";try{const X=(Ut,wo)=>{if(!Number.isFinite(Ut)||Ut===0)return`${Ut}`;const xt=Ut<0?"-":"",Ot=Math.abs(Ut),No=Math.floor(Math.log10(Ot))+1;let ts=Ot/Math.pow(10,No),Oo=No;const Cn=Number(ts.toFixed(wo));return Cn>=1?(ts=Cn/10,Oo=No+1):ts=Cn,`${xt}${ts.toFixed(wo)}e${Oo}`},fe=Ut=>{var No,ts;const wo=Number((ts=(No=N==null?void 0:N.getSymbol)==null?void 0:No.call(N))==null?void 0:ts.pricePrecision);let xt=Number.isFinite(wo)?Math.max(0,Math.min(12,Math.trunc(wo))):Jg(s().symbol);const Ot=Xg(s().symbol);if(Number.isFinite(Ut)&&Math.abs(Ut)>=1e4)xt=2;else if(Ot==="crypto"&&Number.isFinite(Ut)){const Oo=Math.abs(Ut);Oo>=1e3?xt=2:Oo>=1?xt=Math.min(Math.max(xt,2),4):Oo>=.01?xt=Math.min(Math.max(xt,4),8):xt=Math.min(Math.max(xt,6),12)}return Math.max(0,Math.min(12,Math.trunc(xt)))},Ae=Ut=>{try{const wo=Xg(s().symbol);if((wo==="stock"||wo==="crypto")&&Number.isFinite(Ut)){const xt=Math.abs(Ut);if(xt>0&&xt<1e-4)return X(Ut,5)}}catch{}return Ut.toFixed(fe(Ut))},Le=j==null?void 0:j.getBoundingClientRect();if(!Le)return"";if(N&&typeof N.convertFromPixel=="function")try{const Ut=N.convertFromPixel([{x:n(Wn),y:n(Tn)}],{paneId:"candle_pane"});if(Ut&&Array.isArray(Ut)&&Ut[0]&&typeof Ut[0].value=="number")return Ae(Ut[0].value)}catch{}const ft=N.getVisibleRange(),Bt=N.getDataList();if(!Bt||Bt.length===0||!ft)return"";const Ft=Bt.slice(ft.from,ft.to+1);if(Ft.length===0)return"";let zt=1/0,io=-1/0;Ft.forEach(Ut=>{zt=Math.min(zt,Ut.low),io=Math.max(io,Ut.high)});const Wt=io-zt;if(Wt<=0)return"";const zo=n(Tn)/Le.height,Et=io-zo*Wt;return Ae(Et)}catch{return""}}console.log("📊 Chart script execution completed");var ip=XG();ip.__click=[GG,r,M];var $p=m(ip);Vs($p,5,d,N=>N.id,(N,X)=>{h5(N,{get type(){return n(X).type},get text(){return n(X).text}})}),f($p);var Wp=p($p,2);GB(Wp,{get customLoad(){return C()},get mainContainer(){return n(le)},set mainContainer(N){x(le,D(N))},get sidebarHost(){return n(Ce)},set sidebarHost(N){x(Ce,D(N))},onToggleScriptStudio:()=>{x(vt,!n(vt)),n(vt)||x(Je,!1),Ur()}});var Yu=p(Wp,2),Lu=m(Yu),Cp=m(Lu),Sv=m(Cp),rp=m(Sv);du(EA(rp,{}),N=>x(W,D(N)),()=>n(W)),f(Sv);var jf=p(Sv,2);Te(jf,()=>!n(oe),N=>{var X=UG();O(N,X)});var Ws=p(jf,2);Ws.__keydown=[qG,W],Ws.__contextmenu=or,Ws.__mousemove=us,Ws.__dblclick=Wo,Ws.__touchstart=$s,Ws.__click=[HG,H,kn,_r,wl];var Cv=m(Ws);du(Cv,N=>B=N,()=>B);var af=p(Cv,2);du(af,N=>$=N,()=>$),f(Ws),du(Ws,N=>j=N,()=>j);var Pp=p(Ws,2);yV(Pp,{}),f(Cp);var Ip=p(Cp,2);const Rf=Qe(()=>`height: ${n(vt)?`${Math.round(n(nt)*100)}%`:"0px"};`);var lf=m(Ip);lf.__mousedown=Yr,lf.__touchstart=Yr;var pe=p(lf,2);pe.__touchmove=[YG];var Pe=m(pe),Ht=Qe(()=>n(At)?g()[n(At)]:null),vo=Qe(()=>n(At)?_()[n(At)]||[]:[]);iG(Pe,{get code(){return n(ce)},set code(N){x(ce,D(N))},get status(){return n(we)},get error(){return n(ze)},get backtest(){return n(Ht)},get signalEvents(){return n(vo)},get isRunning(){return n(dt)},get isOpen(){return n(vt)},get paneTarget(){return n(Gt)},get labelsEnabled(){return n(it)},$$events:{fullpage:N=>{var X;x(Je,D(!!((X=N==null?void 0:N.detail)!=null&&X.enabled)))},run:N=>{var X,fe,Ae;return nn(N.detail.code,((X=N==null?void 0:N.detail)==null?void 0:X.params)||null,(fe=N==null?void 0:N.detail)==null?void 0:fe.lang,((Ae=N==null?void 0:N.detail)==null?void 0:Ae.backtest)||null)},reset:tr,save:N=>na(N.detail.code),close:cl,pane:N=>x(Gt,D(N.detail.target)),labels:N=>x(it,D(N.detail.enabled)),selectTrade:N=>{var fe;const X=(fe=N==null?void 0:N.detail)==null?void 0:fe.trade;X?Is(X):bs()},focusIndex:N=>{var Le,ft;const X=(Le=N==null?void 0:N.detail)==null?void 0:Le.index,fe=(ft=N==null?void 0:N.detail)==null?void 0:ft.timestamp;let Ae=!1;typeof X=="number"&&Number.isFinite(X)&&(Ae=qi(X)),!Ae&&typeof fe=="number"&&Number.isFinite(fe)&&Ks(fe)},guide:()=>x(ot,!0)}}),f(pe),f(Ip),f(Lu),du(Lu,N=>x(ye,N),()=>n(ye));var as=p(Lu,2);du(Sz(as,{}),N=>x(Ce,D(N)),()=>n(Ce)),f(Yu);var po=p(Yu,2);Te(po,()=>n(Nl),N=>{var X=KG();O(N,X)});var Bs=p(po,2);yG(Bs,{get show(){return n(ot)},$$events:{close:()=>x(ot,!1),insert:N=>{x(ce,D(N.detail.code)),x(vt,!0)}}});var xs=p(Bs,2);YB(xs,{get isOpen(){return n(H)},set isOpen(N){x(H,D(N))},get x(){return n(Me)},get y(){return n(Ue)},get currentPrice(){return n(yt)},$$events:{copy:async N=>{N.detail.price&&(await Br(N.detail.price)?(x(he,`Price ${N.detail.price} copied!`),St==null||St.showToast(),kn()):(x(he,"Failed to copy price"),St==null||St.showToast()))},reset:dl,close:kn}});var en=p(xs,2);Te(en,()=>n(_r),N=>{var X=ZG(),fe=m(X);fe.__click=async()=>{await Br(n(yt))?x(he,`Price ${n(yt)} copied!`):x(he,"Failed to copy price"),St==null||St.showToast(),wl()};var Ae=p(m(fe),2),Le=m(Ae);f(Ae),f(fe);var ft=p(fe,2);ft.__click=dl,f(X),Se(()=>{Nt(X,"style",`left: ${n(Kr)??""}px; top: ${n(Ul)??""}px;`),Ve(Le,`Copy Price ${(n(yt)?`(${n(yt)})`:"")??""}`)}),O(N,X)});var Sn=p(en,2);du(ew(Sn,{get visible(){return n(lo)},set visible(N){x(lo,D(N))},get message(){return n(he)},duration:2e3}),N=>St=N,()=>St);var lt=p(Sn,2);oV(lt,{get show(){return n(_d)},title:"Unsaved changes",message:"You made changes but did not save. Refresh will discard them.",$$events:{cancel:()=>{x(_d,!1)},confirm:()=>{var N;x(_d,!1);try{if(Io&&F_()){Io.clearPersistedStorage();try{const X=(((N=s())==null?void 0:N.key)||"chart")+"_overlays";localStorage.removeItem(X)}catch{}try{localStorage.removeItem("dataSpaceOverlays")}catch{}}}catch{}location.reload()}}});var Zt=p(lt,2);return JO(Zt,{}),f(ip),du(ip,N=>x(le,N),()=>n(le)),Se(()=>{Nt(ip,"data-theme",s().theme),ii(Lu,"restoring",v()),Gn(Ip,`${`script-dock ${n(vt)?"open":""} ${n(Je)?"fullpage":""}`??""} svelte-10y1ir0`),Nt(Ip,"style",n(Rf)),Nt(Ip,"aria-hidden",!n(vt)),Nt(pe,"style",`opacity:${n(vt)?1:0}; pointer-events:${n(vt)?"auto":"none"}; transform: ${n(vt)?"none":"translateY(6px)"};`)}),id("mouseleave",Ws,Un),id("wheel",pe,N=>N.stopPropagation()),O(o,ip),Tc({getChart:Zs,setManualStylesFlag:gn})}Hd(["click","keydown","contextmenu","mousemove","dblclick","touchstart","mousedown","touchmove"]);function rU(o,e){Mc(e,!1);const t=Au(),s=()=>ua(B2,"$page",t),i=()=>ua(l,"$save",t);console.log("📄 +page.svelte loaded");const r=op(new Yb);let a;try{const S=sessionStorage.getItem("chart.tabId");S?a=S:(a=`${Date.now()}-${Math.random().toString(36).slice(2)}`,sessionStorage.setItem("chart.tabId",a))}catch{a=`${Date.now()}-${Math.random().toString(36).slice(2)}`}const l=A1(`chart:${a}`,new dh);let c=nd(!1),d="light";function v(S){d=S,document.documentElement.classList.toggle("dark",S==="dark"),document.documentElement.setAttribute("data-theme",S),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:S}})),console.log("🖌️ Applied theme to document:",S)}function g(){window.location.href="https://dutyai.app/chart"}let _=null;hp(()=>((async()=>{var $,F,V,K;let S=null;const M=s().url.searchParams.get("userId");if(M){console.log("👤 User ID parameter found in URL:",M);try{localStorage.setItem("userId",M),console.log("✅ User ID saved to localStorage:",M);const Y=new URL(window.location.href);Y.searchParams.delete("userId"),window.history.replaceState({},"",Y.toString()),console.log("🔗 User ID parameter removed from URL"),S=M}catch(Y){console.error("❌ Failed to save user ID to localStorage:",Y)}}else try{S=localStorage.getItem("userId"),S&&console.log("👤 User ID found in localStorage:",S)}catch(Y){console.error("❌ Failed to read userId from localStorage:",Y)}if(!S){console.warn("⚠️ No userId found in URL or localStorage. Redirecting..."),g();return}aT(!0);try{console.log("📡 Fetching user preferences for userId:",S);const Y=s().url.searchParams.get("isFree")==="true",Z=await sT(S,Y);console.log("✅ User preferences fetched successfully:",Z),rT(Z)}catch(Y){console.error("❌ Failed to fetch user preferences:",Y);{lT(Y instanceof Error?Y.message:"Unknown error"),console.warn("⚠️ User preferences fetch failed. Redirecting..."),g();return}}const I=s().url.searchParams.get("theme"),C=(V=(F=($=fp(Nf))==null?void 0:$.data)==null?void 0:F.theme)==null?void 0:V.toLowerCase(),T=(K=fp(l))==null?void 0:K.theme,z=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,j=I==="dark"||I==="light"?I:C==="dark"||C==="light"?C==="dark"?"dark":"light":T==="dark"||T==="light"?T:z?"dark":"light";l.update(Y=>(Y.theme=j,Y)),v(j),_=l.subscribe(Y=>{const Z=Y.theme==="dark"||Y.theme==="light"?Y.theme:z?"dark":"light";Z!==d&&v(Z)});const B=s().url.searchParams.get("symbol");if(B){console.log("🔗 Symbol parameter found in URL:",B);let Y=0;const Z=50,ne=()=>{Y+=1;const te=i();if(te.allSymbols&&te.allSymbols.length>0){const oe=te.allSymbols.find(U=>U.ticker.toLowerCase()===B.toLowerCase());if(oe)console.log("✅ Found symbol from URL parameter:",oe),l.update(U=>(U.symbol=oe,U));else{console.warn("⚠️ Symbol not found in available symbols:",B),console.log("📊 Available symbols:",te.allSymbols.map(J=>J.ticker).join(", "));const U=te.allSymbols.slice(0,10).map(J=>J.ticker).join(", ");console.log(`💡 Try one of these symbols: ${U}${te.allSymbols.length>10?"...":""}`)}}else Y<Z?(console.log(`⏳ Waiting for symbols to load... (attempt ${Y}/${Z})`),setTimeout(ne,100)):console.error("❌ Timeout waiting for symbols to load. Symbol parameter will be ignored.")};ne()}x(c,!0)})(),()=>{_&&_()})),Sp();var y=So(),k=Rt(y);Te(k,()=>n(c),S=>{JG(S,{ctx:r,save:l})}),O(o,y),Tc()}export{rU as component};
