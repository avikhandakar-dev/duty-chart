var kw=Object.defineProperty;var Sw=Object.getPrototypeOf;var Cw=Reflect.get;var A1=o=>{throw TypeError(o)};var Pw=(o,e,t)=>e in o?kw(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var re=(o,e,t)=>Pw(o,typeof e!="symbol"?e+"":e,t),L1=(o,e,t)=>e.has(o)||A1("Cannot "+t);var Yc=(o,e,t)=>(L1(o,e,"read from private field"),t?t.call(o):e.get(o)),l0=(o,e,t)=>e.has(o)?A1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,t);var im=(o,e,t)=>(L1(o,e,"access private method"),t);var F1=(o,e,t)=>Cw(Sw(o),t,e);import{r as $_,v as Iw,w as D1,x as Mw,y as Ym,e as Xt,a as O,z as qn,b as Ye,l as hc,t as de,s as Zc,c as ir,A as Fl,B as Ir,n as h2,C as e_,D as _2,f as Np,E as Tw,p as y2}from"../chunks/stores.zPnmjEgI.js";import{v as Aw,E as Lw,w as Fw,F as b2,J as Ju,K as zm,H as x2,Q as x0,aB as Dw,aS as Ew,aR as $w,O as j_,at as w2,as as k2,L as S2,al as jw,P as E1,C as z_,aY as C2,I as zw,G as Bw,l as Um,e as Uo,aZ as Nw,a_ as Rw,a$ as Ow,a6 as Vw,q as B_,aC as Pv,b0 as Ww,b1 as qw,aK as $1,Z as j1,av as Hw,ac as Gw,m as n1,aL as P2,B as Yw,A as b,aJ as Id,c as g,f as _t,b2 as un,r as f,t as we,p as Ka,ag as nu,ah as Av,i as n,s as u,a as Za,ai as kl,j as Gd,aj as zd,ab as oe,k as We,b3 as z1,a2 as Yd,aI as Fa,b as Wi,b4 as Cc,b5 as rm,aa as Uw,b6 as Ep,y as Qv,b7 as Kw,aH as $p,a5 as Zw}from"../chunks/entry.CmsQlVpZ.js";import{b as I2,l as Lo,p as Ss,i as Se,a as j,c as Kc,s as gd}from"../chunks/runtime.DV10HuG6.js";import{i as Ud}from"../chunks/lifecycle.CEXcTIqH.js";import{s as St,t as Sn,e as Ns,i as dn,r as Vt,h as Pn,j as Vu,k as w0,f as Xw,l as $0,b as ad,m as B1,n as tp,o as N_,A as Jw,p as Qw}from"../chunks/alert.D1Hyq50u.js";import{c as Md,a as yp,b as Ec,_ as N1,o as Rd}from"../chunks/preload-helper.Br5UfABT.js";const e3=[];function iv(o,e=!1){return Im(o,new Map,"",e3)}function Im(o,e,t,s,i=null){if(typeof o=="object"&&o!==null){const a=e.get(o);if(a!==void 0)return a;if(o instanceof Map)return new Map(o);if(o instanceof Set)return new Set(o);if(Aw(o)){const l=[];e.set(o,l),i!==null&&e.set(i,l);for(let d=0;d<o.length;d+=1)l.push(Im(o[d],e,t,s));return l}if(Lw(o)===Fw){const l={};e.set(o,l),i!==null&&e.set(i,l);for(var r in o)l[r]=Im(o[r],e,t,s);return l}if(o instanceof Date)return structuredClone(o);if(typeof o.toJSON=="function")return Im(o.toJSON(),e,t,s,o)}if(o instanceof EventTarget)return o;try{return structuredClone(o)}catch{return o}}function t3(o,e,t,s,i){var r=o,a="",l;b2(()=>{if(a===(a=e()??"")){Ju&&zm();return}l!==void 0&&(k2(l),l=void 0),a!==""&&(l=x2(()=>{if(Ju){x0.data;for(var d=zm(),v=d;d!==null&&(d.nodeType!==8||d.data!=="");)v=d,d=Dw(d);if(d===null)throw Ew(),$w;$_(x0,v),r=j_(d);return}var p=a+"",_=Iw(p);$_(w2(_),_.lastChild),r.before(_)}))})}function o3(o,e,t,s,i,r){let a=Ju;Ju&&zm();var l,d,v=null;Ju&&x0.nodeType===1&&(v=x0,zm());var p=Ju?x0:o,_;b2(()=>{const y=e()||null;var w=C2;y!==l&&(_&&(y===null?zw(_,()=>{_=null,d=null}):y===d?Bw(_):(k2(_),D1(!1))),y&&y!==d&&(_=x2(()=>{if(v=Ju?v:document.createElementNS(w,y),$_(v,v),s){var k=Ju?w2(v):v.appendChild(jw());Ju&&(k===null?E1(!1):j_(k)),s(v,k)}z_.nodes_end=v,p.before(v)})),l=y,l&&(d=l),D1(!0))},S2),a&&(E1(!0),j_(p))}function R1(o,e,t){Um(()=>{var s=Uo(()=>e(o,t==null?void 0:t())||{});if(s!=null&&s.destroy)return()=>s.destroy()})}const s3=()=>performance.now(),lv={tick:o=>requestAnimationFrame(o),now:()=>s3(),tasks:new Set};function M2(o){lv.tasks.forEach(e=>{e.c(o)||(lv.tasks.delete(e),e.f())}),lv.tasks.size!==0&&lv.tick(M2)}function n3(o){let e;return lv.tasks.size===0&&lv.tick(M2),{promise:new Promise(t=>{lv.tasks.add(e={c:o,f:t})}),abort(){lv.tasks.delete(e)}}}function am(o,e){o.dispatchEvent(new CustomEvent(e))}function i3(o){if(o==="float")return"cssFloat";if(o==="offset")return"cssOffset";if(o.startsWith("--"))return o;const e=o.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function O1(o){const e={},t=o.split(";");for(const s of t){const[i,r]=s.split(":");if(!i||r===void 0)break;const a=i3(i.trim());e[a]=r.trim()}return e}const r3=o=>o;function Vp(o,e,t,s){var i=(o&Ow)!==0,r=(o&Ww)!==0,a=i&&r,l=(o&qw)!==0,d=a?"both":i?"in":"out",v,p=e.inert,_,y;function w(){var P=Hw,A=z_;$1(null),j1(null);try{return v??(v=t()(e,(s==null?void 0:s())??{},{direction:d}))}finally{$1(P),j1(A)}}var k={is_global:l,in(){var P;if(e.inert=p,!i){y==null||y.abort(),(P=y==null?void 0:y.reset)==null||P.call(y);return}r||_==null||_.abort(),am(e,"introstart"),_=R_(e,w(),y,1,()=>{am(e,"introend"),_==null||_.abort(),_=v=void 0})},out(P){if(!r){P==null||P(),v=void 0;return}e.inert=!0,am(e,"outrostart"),y=R_(e,w(),_,0,()=>{am(e,"outroend"),P==null||P()})},stop:()=>{_==null||_.abort(),y==null||y.abort()}},S=z_;if((S.transitions??(S.transitions=[])).push(k),i&&Mw){var L=l;if(!L){for(var T=S.parent;T&&T.f&S2;)for(;(T=T.parent)&&!(T.f&Nw););L=!T||(T.f&Rw)!==0}L&&Um(()=>{Uo(()=>k.in())})}}function R_(o,e,t,s,i){var r=s===1;if(Vw(e)){var a,l=!1;return B_(()=>{if(!l){var L=e({direction:r?"in":"out"});a=R_(o,L,t,s,i)}}),{abort:()=>{l=!0,a==null||a.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return i(),{abort:Pv,deactivate:Pv,reset:Pv,t:()=>s};const{delay:d=0,css:v,tick:p,easing:_=r3}=e;var y=[];if(r&&t===void 0&&(p&&p(0,1),v)){var w=O1(v(0,1));y.push(w,w)}var k=()=>1-s,S=o.animate(y,{duration:d});return S.onfinish=()=>{var L=(t==null?void 0:t.t())??1-s;t==null||t.abort();var T=s-L,P=e.duration*Math.abs(T),A=[];if(P>0){if(v)for(var F=Math.ceil(P/16.666666666666668),B=0;B<=F;B+=1){var R=L+T*_(B/F),N=v(R,1-R);A.push(O1(N))}k=()=>{var $=S.currentTime;return L+T*_($/P)},p&&n3(()=>{if(S.playState!=="running")return!1;var $=k();return p($,1-$),!0})}S=o.animate(A,{duration:P,fill:"forwards"}),S.onfinish=()=>{k=()=>s,p==null||p(s,1-s),i()}},{abort:()=>{S&&(S.cancel(),S.effect=null,S.onfinish=Pv)},deactivate:()=>{i=Pv},reset:()=>{s===0&&(p==null||p(1,0))},t:()=>k()}}function go(o,e,t=e){var s=Gw();Ym(o,"input",()=>{var i=o_(o)?s_(o.value):o.value;t(i),s&&i!==(i=e())&&(o.value=i??"")}),n1(()=>{var i=e();if(Ju&&o.defaultValue!==o.value){t(o_(o)?s_(o.value):o.value);return}o_(o)&&i===s_(o.value)||o.type==="date"&&!i&&!o.value||i!==o.value&&(o.value=i??"")})}const t_=new Set;function a3(o,e,t,s,i=s){var r=t.getAttribute("type")==="checkbox",a=o;let l=!1;if(e!==null)for(var d of e)a=a[d]??(a[d]=[]);a.push(t),Ym(t,"change",()=>{var v=t.__value;r&&(v=V1(a,v,t.checked)),i(v)},()=>i(r?[]:null)),n1(()=>{var v=s();if(Ju&&t.defaultChecked!==t.checked){l=!0;return}r?(v=v||[],t.checked=v.includes(t.__value)):t.checked=I2(t.__value,v)}),P2(()=>{var v=a.indexOf(t);v!==-1&&a.splice(v,1)}),t_.has(a)||(t_.add(a),B_(()=>{a.sort((v,p)=>v.compareDocumentPosition(p)===4?-1:1),t_.delete(a)})),B_(()=>{if(l){var v;if(r)v=V1(a,v,t.checked);else{var p=a.find(_=>_.checked);v=p==null?void 0:p.__value}i(v)}})}function Bu(o,e,t=e){Ym(o,"change",()=>{var s=o.checked;t(s)}),e()==null&&t(!1),n1(()=>{var s=e();o.checked=!!s})}function V1(o,e,t){for(var s=new Set,i=0;i<o.length;i+=1)o[i].checked&&s.add(o[i].__value);return t||s.delete(e),Array.from(s)}function o_(o){var e=o.type;return e==="number"||e==="range"}function s_(o){return o===""?null:+o}function W1(o,e,t){var s=Yw(o,e);s&&s.set&&(o[e]=t,P2(()=>{o[e]=null}))}function pf(o,e,t){if(o.multiple)return l3(o,e);for(var s of o.options){var i=k0(s);if(I2(i,e)){s.selected=!0;return}}(!t||e!==void 0)&&(o.selectedIndex=-1)}function Km(o,e){let t=!0;Um(()=>{e&&pf(o,Uo(e),t),t=!1;var s=new MutationObserver(()=>{var i=o.__value;pf(o,i)});return s.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{s.disconnect()}})}function Bo(o,e,t=e){var s=!0;Ym(o,"change",()=>{var i;if(o.multiple)i=[].map.call(o.querySelectorAll(":checked"),k0);else{var r=o.querySelector(":checked");i=r&&k0(r)}t(i)}),Um(()=>{var i=e();if(pf(o,i,s),s&&i===void 0){var r=o.querySelector(":checked");r!==null&&(i=k0(r),t(i))}o.__value=i,s=!1}),Km(o)}function l3(o,e){for(var t of o.options)t.selected=~e.indexOf(k0(t))}function k0(o){return"__value"in o?o.__value:o.value}function c0(o){b(o,o.v+1)}function rd(o,e){if(!(!Cu(o)&&!Cu(e))){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const s=o[t],i=e[t];Cu(i)&&Cu(s)?rd(s,i):mo(e[t])&&(o[t]=vf(e[t]))}}}function vf(o){if(!Cu(o))return o;let e=null;op(o)?e=[]:e={};for(const t in o)if(Object.prototype.hasOwnProperty.call(o,t)){const s=o[t];Cu(s)?e[t]=vf(s):e[t]=s}return e}function op(o){return Object.prototype.toString.call(o)==="[object Array]"}function du(o){return typeof o=="function"}function Cu(o){return typeof o=="object"&&mo(o)}function xr(o){return typeof o=="number"&&Number.isFinite(o)}function mo(o){return o!=null}function A0(o){return typeof o=="boolean"}function Dl(o){return typeof o=="string"}const c3=/\\(\\)?/g,d3=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function fd(o,e,t){if(mo(o)){const s=[];e.replace(d3,(l,...d)=>{let v=l;return mo(d[1])?v=d[2].replace(c3,"$1"):mo(d[0])&&(v=d[0].trim()),s.push(v),""});let i=o,r=0;const a=s.length;for(;mo(i)&&r<a;)i=i==null?void 0:i[s[r++]];return mo(i)?i:t??"--"}return t??"--"}function u3(o,e){const t={};return o.formatToParts(new Date(e)).forEach(({type:s,value:i})=>{switch(s){case"year":{t.YYYY=i;break}case"month":{t.MM=i;break}case"day":{t.DD=i;break}case"hour":{t.HH=i==="24"?"00":i;break}case"minute":{t.mm=i;break}case"second":{t.ss=i;break}}}),t}function T2(o,e,t){const s=u3(o,e);return t.replace(/YYYY|MM|DD|HH|mm|ss/g,i=>s[i])}function jd(o,e){const t=+o;return xr(t)?t.toFixed(e??2):`${o}`}function A2(o){const e=+o;if(xr(e)){if(e>1e9)return`${+(e/1e9).toFixed(3)}B`;if(e>1e6)return`${+(e/1e6).toFixed(3)}M`;if(e>1e3)return`${+(e/1e3).toFixed(3)}K`}return`${o}`}function L2(o,e){const t=`${o}`;if(e.length===0)return t;if(t.includes(".")){const s=t.split(".");return`${s[0].replace(/(\d)(?=(\d{3})+$)/g,i=>`${i}${e}`)}.${s[1]}`}return t.replace(/(\d)(?=(\d{3})+$)/g,s=>`${s}${e}`)}function F2(o,e){const t=`${o}`;if(new RegExp("\\.0{"+e+",}[1-9][0-9]*$").test(t)){const i=t.split("."),r=i.length-1,a=i[r],l=/0*/.exec(a);if(mo(l)){const d=l[0].length;return i[r]=a.replace(/0*/,`0{${d}}`),i.join(".")}}return t}function q1(o,e){return o.replace(/\{(\w+)\}/g,(t,s)=>{const i=e[s];return mo(i)?i:`{${s}}`})}let d0=null;function cv(o){var e;return((e=o.ownerDocument.defaultView)==null?void 0:e.devicePixelRatio)??1}function qp(o,e,t){return`${e??"normal"} ${o??12}px ${t??"Helvetica Neue"}`}function Bd(o,e,t,s){if(!mo(d0)){const i=document.createElement("canvas"),r=cv(i);d0=i.getContext("2d"),d0.scale(r,r)}return d0.font=qp(e,t,s),Math.round(d0.measureText(o).width)}function Bm(o){const e={width:0,height:0,left:0,right:0,top:0,bottom:0};return mo(o)&&rd(e,o),e}var Ol=(o=>(o[o.Main=0]="Main",o[o.Overlay=1]="Overlay",o[o.Separator=2]="Separator",o[o.Drawer=3]="Drawer",o[o.All=4]="All",o))(Ol||{});const n_=-1;function Wp(o){return du(window.requestAnimationFrame)?window.requestAnimationFrame(o):window.setTimeout(o,20)}function H1(o){du(window.cancelAnimationFrame)?window.cancelAnimationFrame(o):window.clearTimeout(o)}class O_{constructor(e){re(this,"_options",{duration:500,iterationCount:1});re(this,"_doFrameCallback");re(this,"_currentIterationCount",0);re(this,"_running",!1);re(this,"_time",0);rd(this._options,e)}_loop(){this._running=!0;const e=()=>{var t;if(this._running){const s=new Date().getTime()-this._time;s<this._options.duration?((t=this._doFrameCallback)==null||t.call(this,s),Wp(e)):(this.stop(),this._currentIterationCount++,this._currentIterationCount<this._options.iterationCount&&this.start())}};Wp(e)}doFrame(e){return this._doFrameCallback=e,this}setDuration(e){return this._options.duration=e,this}setIterationCount(e){return this._options.iterationCount=e,this}start(){this._running||(this._time=new Date().getTime(),this._loop())}stop(){var e;this._running&&((e=this._doFrameCallback)==null||e.call(this,this._options.duration)),this._running=!1}}let i_=1,G1=new Date().getTime();function m0(o){const e=new Date().getTime();return e===G1?++i_:i_=1,G1=e,`${o??""}${e}_${i_}`}function Gp(o,e){const t=document.createElement(o),s=e??{};for(const i in s)t.style[i]=s[i]??"";return t}function V_(o,e,t){let s=0,i=0;for(i=o.length-1;s!==i;){const r=Math.floor((i+s)/2),a=i-s,l=o[r][e];if(t===o[s][e])return s;if(t===o[i][e])return i;if(t===l)return r;if(t>l?s=r:i=r,a<=2)break}return s}function Y1(o){const e=Math.floor(zp(o)),t=Iv(e),s=o/t;let i=0;return s<1.5?i=1:s<2.5?i=2:s<3.5?i=3:s<4.5?i=4:s<5.5?i=5:s<6.5?i=6:i=8,o=i*t,+o.toFixed(Math.abs(e))}function U1(o,e){e=Math.max(0,e??0);const t=Math.pow(10,e);return Math.round(o*t)/t}function p3(o){const e=o.toString(),t=e.indexOf("e");if(t>0){const i=+e.slice(t+1);return i<0?-i:0}const s=e.indexOf(".");return s<0?0:e.length-1-s}function D2(o,e,t){const s=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],i=o.length;let r=0;for(;r<i;){const a=o[r];s[0]=Math.max(a[e]??Number.MIN_SAFE_INTEGER,s[0]),s[1]=Math.min(a[t]??Number.MAX_SAFE_INTEGER,s[1]),++r}return s}function zp(o){return o===0?0:Math.log10(o)}function Iv(o){return Math.pow(10,o)}function K1(){return{from:0,to:0,realFrom:0,realTo:0}}function Z1(...o){return o.join("_")}const v3=5;class f3{constructor(e){re(this,"_limit");re(this,"_running",0);re(this,"_queue",[]);re(this,"_taskMap",new Map);this._limit=e??v3}async add(e){return await new Promise((t,s)=>{const{id:i,handler:r}=e,a=()=>{this._running++,r().then(d=>{t(d)}).catch(()=>{s("failed")}).finally(()=>{this._running--,this._taskMap.delete(i),this._next()})},l=this._taskMap.get(i);if(mo(l)){l.reject("canceled");const d=this._queue.indexOf(l.run);d>-1&&this._queue.splice(d,1)}this._taskMap.set(i,{run:a,reject:s}),this._queue.push(a),this._next()})}_next(){for(;this._running<this._limit&&this._queue.length>0;){const e=this._queue.shift();e==null||e()}}remove(e){const t=this._taskMap.get(e);if(mo(t)){this._taskMap.delete(e);const s=this._queue.indexOf(t.run);s>-1&&this._queue.splice(s,1),t.reject("canceled")}}clear(){for(const[,{reject:e}]of this._taskMap)e("canceled");this._taskMap.clear(),this._queue=[]}}const Nd={PRICE:2,VOLUME:0};class g3{constructor(){re(this,"_callbacks",[])}subscribe(e){this._callbacks.indexOf(e)<0&&this._callbacks.push(e)}unsubscribe(e){if(du(e)){const t=this._callbacks.indexOf(e);t>-1&&this._callbacks.splice(t,1)}else this._callbacks=[]}execute(e){this._callbacks.forEach(t=>{t(e)})}isEmpty(){return this._callbacks.length===0}}function ff(o){return o==="transparent"||o==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(o)||/^[hH][Ss][Ll][Aa]\(([\s]*(360｜3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(o)}function dv(o,e){const t=o.replace(/^#/,""),s=parseInt(t,16),i=s>>16&255,r=s>>8&255,a=s&255;return`rgba(${i}, ${r}, ${a}, ${e??1})`}const $r={RED:"#F92855",GREEN:"#2DC08E",WHITE:"#FFFFFF",GREY:"#76808F",BLUE:"#1677FF"};function m3(){return{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:"dashed",dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:"dashed",dashedValue:[2,2]}}}function h3(){const o={show:!0,color:$r.GREY,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"};return{type:"candle_solid",bar:{compareRule:"current_open",upColor:$r.GREEN,downColor:$r.RED,noChangeColor:$r.GREY,upBorderColor:$r.GREEN,downBorderColor:$r.RED,noChangeBorderColor:$r.GREY,upWickColor:$r.GREEN,downWickColor:$r.RED,noChangeWickColor:$r.GREY},area:{lineSize:2,lineColor:$r.BLUE,smooth:!1,value:"close",backgroundColor:[{offset:0,color:dv($r.BLUE,.01)},{offset:1,color:dv($r.BLUE,.2)}],point:{show:!0,color:$r.BLUE,radius:4,rippleColor:dv($r.BLUE,.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:{...o},low:{...o},last:{show:!0,compareRule:"current_open",upColor:$r.GREEN,downColor:$r.RED,noChangeColor:$r.GREY,line:{show:!0,style:"dashed",dashedValue:[4,4],size:1},text:{show:!0,style:"fill",size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:"solid",borderSize:0,borderDashedValue:[2,2],color:$r.WHITE,family:"Helvetica Neue",weight:"normal",borderRadius:2},extendTexts:[]}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:"always",showType:"standard",rect:{position:"fixed",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},title:{show:!0,size:14,family:"Helvetica Neue",weight:"normal",color:$r.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,template:"{ticker} · {period}"},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:$r.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a",template:[{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}]},features:[]}}}function _3(){const o=dv($r.GREEN,.7),e=dv($r.RED,.7);return{ohlc:{compareRule:"current_open",upColor:o,downColor:e,noChangeColor:$r.GREY},bars:[{style:"fill",borderStyle:"solid",borderSize:1,borderDashedValue:[2,2],upColor:o,downColor:e,noChangeColor:$r.GREY}],lines:["#FF9600","#935EBD",$r.BLUE,"#E11D74","#01C5C4"].map(t=>({style:"solid",smooth:!1,size:1,dashedValue:[2,2],color:t})),circles:[{style:"fill",borderStyle:"solid",borderSize:1,borderDashedValue:[2,2],upColor:o,downColor:e,noChangeColor:$r.GREY}],lastValueMark:{show:!1,text:{show:!1,style:"fill",color:$r.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:"always",showType:"standard",title:{show:!0,showName:!0,showParams:!0,size:12,family:"Helvetica Neue",weight:"normal",color:$r.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:$r.GREY,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a"},features:[]}}}function X1(){return{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:$r.GREY,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}}}function y3(){return{show:!0,horizontal:{show:!0,line:{show:!0,style:"dashed",dashedValue:[4,2],size:1,color:$r.GREY},text:{show:!0,style:"fill",color:$r.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderColor:$r.GREY,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:$r.GREY},features:[]},vertical:{show:!0,line:{show:!0,style:"dashed",dashedValue:[4,2],size:1,color:$r.GREY},text:{show:!0,style:"fill",color:$r.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderColor:$r.GREY,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:$r.GREY}}}}function b3(){const o=dv($r.BLUE,.35),e=dv($r.BLUE,.25);function t(){return{style:"fill",color:$r.WHITE,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:"solid",borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:$r.BLUE,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:$r.BLUE}}return{point:{color:$r.BLUE,borderColor:o,borderSize:1,radius:5,activeColor:$r.BLUE,activeBorderColor:o,activeBorderSize:3,activeRadius:5},line:{style:"solid",smooth:!1,color:$r.BLUE,size:1,dashedValue:[2,2]},rect:{style:"fill",color:e,borderColor:$r.BLUE,borderSize:1,borderRadius:0,borderStyle:"solid",borderDashedValue:[2,2]},polygon:{style:"fill",color:$r.BLUE,borderColor:$r.BLUE,borderSize:1,borderStyle:"solid",borderDashedValue:[2,2]},circle:{style:"fill",color:e,borderColor:$r.BLUE,borderSize:1,borderStyle:"solid",borderDashedValue:[2,2]},arc:{style:"solid",color:$r.BLUE,size:1,dashedValue:[2,2]},text:t()}}function x3(){return{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:dv($r.BLUE,.08)}}function w3(){return{grid:m3(),candle:h3(),indicator:_3(),xAxis:X1(),yAxis:X1(),separator:x3(),crosshair:y3(),overlay:b3()}}function i1(o,e,t,s){const i=o.result,r=o.figures,a=o.styles,l=fd(a,"circles",t.circles),d=l.length,v=fd(a,"bars",t.bars),p=v.length,_=fd(a,"lines",t.lines),y=_.length;let w=0,k=0,S=0,L,T=0;r.forEach(P=>{var A;switch(P.type){case"circle":{T=w;const F=l[w%d];L={...F,color:F.noChangeColor},w++;break}case"bar":{T=k;const F=v[k%p];L={...F,color:F.noChangeColor},k++;break}case"line":{T=S,L=_[S%y],S++;break}}if(mo(P.type)){const F=(A=P.styles)==null?void 0:A.call(P,{data:{prev:i[e.prev??""],current:i[e.current??""],next:i[e.next??""]},indicator:o,defaultStyles:t});s(P,{...L,...F},T)}})}class Zm{constructor(e){re(this,"id");re(this,"paneId");re(this,"name");re(this,"shortName");re(this,"precision",4);re(this,"calcParams",[]);re(this,"shouldOhlc",!1);re(this,"shouldFormatBigNumber",!1);re(this,"visible",!0);re(this,"zLevel",0);re(this,"extendData");re(this,"series","normal");re(this,"figures",[]);re(this,"minValue",null);re(this,"maxValue",null);re(this,"styles",null);re(this,"shouldUpdate",(e,t)=>{const s=JSON.stringify(e.calcParams)!==JSON.stringify(t.calcParams)||e.figures!==t.figures||e.calc!==t.calc,i=s||e.shortName!==t.shortName||e.series!==t.series||e.minValue!==t.minValue||e.maxValue!==t.maxValue||e.precision!==t.precision||e.shouldOhlc!==t.shouldOhlc||e.shouldFormatBigNumber!==t.shouldFormatBigNumber||e.visible!==t.visible||e.zLevel!==t.zLevel||e.extendData!==t.extendData||e.regenerateFigures!==t.regenerateFigures||e.createTooltipDataSource!==t.createTooltipDataSource||e.draw!==t.draw;return{calc:s,draw:i}});re(this,"calc",()=>({}));re(this,"regenerateFigures",null);re(this,"createTooltipDataSource",null);re(this,"draw",null);re(this,"onDataStateChange",null);re(this,"result",{});re(this,"_prevIndicator");re(this,"_lockSeriesPrecision",!1);this.override(e),this._lockSeriesPrecision=!1}override(e){const{result:t,...s}=this;this._prevIndicator={...vf(s),result:t};const{id:i,name:r,shortName:a,precision:l,styles:d,figures:v,calcParams:p,..._}=e;!Dl(this.id)&&Dl(i)&&(this.id=i),Dl(this.name)||(this.name=r??""),this.shortName=a??this.shortName??this.name,xr(l)&&(this.precision=l,this._lockSeriesPrecision=!0),mo(d)&&(this.styles??(this.styles={}),rd(this.styles,d)),rd(this,_),mo(p)&&(this.calcParams=p,du(this.regenerateFigures)&&(this.figures=this.regenerateFigures(this.calcParams))),this.figures=v??this.figures}setSeriesPrecision(e){this._lockSeriesPrecision||(this.precision=e)}shouldUpdateImp(){const e=this._prevIndicator.zLevel!==this.zLevel,t=this.shouldUpdate(this._prevIndicator,this);return A0(t)?{calc:t,draw:t,sort:e}:{...t,sort:e}}async calcImp(e){try{const t=await this.calc(e,this);return this.result=t,!0}catch{return!1}}static extend(e){class t extends Zm{constructor(){super(e)}}return t}}const k3={name:"AVP",shortName:"AVP",series:"price",precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:o=>{let e=0,t=0;return o.reduce((s,i)=>{const r={},a=i.turnover??0,l=i.volume??0;return e+=a,t+=l,t!==0&&(r.avp=e/t),s[i.timestamp]=r,s},{})}},S3={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:({data:o,indicator:e,defaultStyles:t})=>{const{prev:s,current:i}=o,r=(s==null?void 0:s.ao)??Number.MIN_SAFE_INTEGER,a=(i==null?void 0:i.ao)??Number.MIN_SAFE_INTEGER;let l="";a>r?l=fd(e.styles,"bars[0].upColor",t.bars[0].upColor):l=fd(e.styles,"bars[0].downColor",t.bars[0].downColor);const d=a>r?"stroke":"fill";return{color:l,style:d,borderColor:l}}}],calc:(o,e)=>{const t=e.calcParams,s=Math.max(t[0],t[1]);let i=0,r=0,a=0,l=0;return o.reduce((d,v,p)=>{const _={},y=(v.low+v.high)/2;if(i+=y,r+=y,p>=t[0]-1){a=i/t[0];const w=o[p-(t[0]-1)];i-=(w.low+w.high)/2}if(p>=t[1]-1){l=r/t[1];const w=o[p-(t[1]-1)];r-=(w.low+w.high)/2}return p>=s-1&&(_.ao=a-l),d[v.timestamp]=_,d},{})}},C3={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`bias${t+1}`,title:`BIAS${e}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[];return o.reduce((r,a,l)=>{const d={},v=a.close;return t.forEach((p,_)=>{if(i[_]=(i[_]??0)+v,l>=p-1){const y=i[_]/t[_];d[s[_].key]=(v-y)/y*100,i[_]-=o[l-(p-1)].close}}),r[a.timestamp]=d,r},{})}};function P3(o,e){const t=o.length;let s=0;return o.forEach(i=>{const r=i.close-e;s+=r*r}),s=Math.abs(s),Math.sqrt(s/t)}const I3={name:"BOLL",shortName:"BOLL",series:"price",calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=t[0]-1;let i=0;return o.reduce((r,a,l)=>{const d=a.close,v={};if(i+=d,l>=s){v.mid=i/t[0];const p=P3(o.slice(l-s,l+1),v.mid);v.up=v.mid+t[1]*p,v.dn=v.mid-t[1]*p,i-=o[l-s].close}return r[a.timestamp]=v,r},{})}},M3={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0;return o.reduce((l,d,v)=>{const p={},_=d.high,y=d.low,w=d.open,k=(o[v-1]??d).close;if(r+=_-w,a+=w-y,s+=_-k,i+=k-y,v>=t[0]-1){a!==0?p.ar=r/a*100:p.ar=0,i!==0?p.br=s/i*100:p.br=0;const S=o[v-(t[0]-1)],L=S.high,T=S.low,P=S.open,A=(o[v-t[0]]??o[v-(t[0]-1)]).close;s-=L-A,i-=A-T,r-=L-P,a-=P-T}return l[d.timestamp]=p,l},{})}},T3={name:"BBI",shortName:"BBI",series:"price",precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=Math.max(...t),i=[],r=[];return o.reduce((a,l,d)=>{const v={},p=l.close;if(t.forEach((_,y)=>{i[y]=(i[y]??0)+p,d>=_-1&&(r[y]=i[y]/_,i[y]-=o[d-(_-1)].close)}),d>=s-1){let _=0;r.forEach(y=>{_+=y}),v.bbi=_/4}return a[l.timestamp]=v,a},{})}},A3={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=t[0]-1;let i=0;const r=[];return o.reduce((a,l,d)=>{const v={},p=(l.high+l.low+l.close)/3;if(i+=p,r.push(p),d>=s){const _=i/t[0],y=r.slice(d-s,d+1);let w=0;y.forEach(L=>{w+=Math.abs(L-_)});const k=w/t[0];v.cci=k!==0?(p-_)/k/.015:0;const S=(o[d-s].high+o[d-s].low+o[d-s].close)/3;i-=S}return a[l.timestamp]=v,a},{})}},L3={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=Math.ceil(t[1]/2.5+1),i=Math.ceil(t[2]/2.5+1),r=Math.ceil(t[3]/2.5+1),a=Math.ceil(t[4]/2.5+1);let l=0;const d=[];let v=0;const p=[];let _=0;const y=[];let w=0;const k=[],S=[],L={};return o.forEach((T,P)=>{const A={},F=o[P-1]??T,B=(F.high+F.close+F.low+F.open)/4,R=Math.max(0,T.high-B),N=Math.max(0,B-T.low);P>=t[0]-1&&(N!==0?A.cr=R/N*100:A.cr=0,l+=A.cr,v+=A.cr,_+=A.cr,w+=A.cr,P>=t[0]+t[1]-2&&(d.push(l/t[1]),P>=t[0]+t[1]+s-3&&(A.ma1=d[d.length-1-s]),l-=S[P-(t[1]-1)].cr??0),P>=t[0]+t[2]-2&&(p.push(v/t[2]),P>=t[0]+t[2]+i-3&&(A.ma2=p[p.length-1-i]),v-=S[P-(t[2]-1)].cr??0),P>=t[0]+t[3]-2&&(y.push(_/t[3]),P>=t[0]+t[3]+r-3&&(A.ma3=y[y.length-1-r]),_-=S[P-(t[3]-1)].cr??0),P>=t[0]+t[4]-2&&(k.push(w/t[4]),P>=t[0]+t[4]+a-3&&(A.ma4=k[k.length-1-a]),w-=S[P-(t[4]-1)].cr??0)),S.push(A),L[T.timestamp]=A}),L}},F3={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=Math.max(t[0],t[1]);let i=0,r=0,a=0;const l=[],d={};return o.forEach((v,p)=>{const _={},y=v.close;i+=y,r+=y;let w=0,k=0;if(p>=t[0]-1&&(w=i/t[0],i-=o[p-(t[0]-1)].close),p>=t[1]-1&&(k=r/t[1],r-=o[p-(t[1]-1)].close),p>=s-1){const S=w-k;_.dma=S,a+=S,p>=s+t[2]-2&&(_.ama=a/t[2],a-=l[p-(t[2]-1)].dma??0)}l.push(_),d[v.timestamp]=_}),d}},D3={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0,l=0,d=0,v=0,p=0;const _=[],y={};return o.forEach((w,k)=>{const S={},L=o[k-1]??w,T=L.close,P=w.high,A=w.low,F=P-A,B=Math.abs(P-T),R=Math.abs(T-A),N=P-L.high,$=L.low-A,V=Math.max(Math.max(F,B),R),U=N>0&&N>$?N:0,G=$>0&&$>N?$:0;if(s+=V,i+=U,r+=G,k>=t[0]-1){k>t[0]-1?(a=a-a/t[0]+V,l=l-l/t[0]+U,d=d-d/t[0]+G):(a=s,l=i,d=r);let Z=0,le=0;a!==0&&(Z=l*100/a,le=d*100/a),S.pdi=Z,S.mdi=le;let se=0;le+Z!==0&&(se=Math.abs(le-Z)/(le+Z)*100),v+=se,k>=t[0]*2-2&&(k>t[0]*2-2?p=(p*(t[0]-1)+se)/t[0]:p=v/t[0],S.adx=p,k>=t[0]*2+t[1]-3&&(S.adxr=((_[k-(t[1]-1)].adx??0)+p)/2))}_.push(S),y[w.timestamp]=S}),y}},E3={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0;const i=[];return o.reduce((r,a,l)=>{const d={};if(l>0){const v=o[l-1],p=a.high,_=a.low,y=a.volume??0,w=(p+_)/2-(v.high+v.low)/2;if(y===0||p-_===0)d.emv=0;else{const k=y/1e8/(p-_);d.emv=w/k}s+=d.emv,i.push(d.emv),l>=t[0]&&(d.maEmv=s/t[0],s-=i[l-t[0]])}return r[a.timestamp]=d,r},{})}},$3={name:"EMA",shortName:"EMA",series:"price",calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`ema${t+1}`,title:`EMA${e}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e;let i=0;const r=[];return o.reduce((a,l,d)=>{const v={},p=l.close;return i+=p,t.forEach((_,y)=>{d>=_-1&&(d>_-1?r[y]=(2*p+(_-1)*r[y])/(_+1):r[y]=i/_,v[s[y].key]=r[y])}),a[l.timestamp]=v,a},{})}},j3={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0;const i=[],r={};return o.forEach((a,l)=>{const d={};if(l>=t[0]){const v=a.close,p=o[l-t[0]].close;d.mtm=v-p,s+=d.mtm,l>=t[0]+t[1]-1&&(d.maMtm=s/t[1],s-=i[l-(t[1]-1)].mtm??0)}i.push(d),r[a.timestamp]=d}),r}},z3={name:"MA",shortName:"MA",series:"price",calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA30: ",type:"line"},{key:"ma4",title:"MA60: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`ma${t+1}`,title:`MA${e}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[];return o.reduce((r,a,l)=>{const d={},v=a.close;return t.forEach((p,_)=>{i[_]=(i[_]??0)+v,l>=p-1&&(d[s[_].key]=i[_]/p,i[_]-=o[l-(p-1)].close)}),r[a.timestamp]=d,r},{})}},B3={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:({data:o,indicator:e,defaultStyles:t})=>{const{prev:s,current:i}=o,r=(s==null?void 0:s.macd)??Number.MIN_SAFE_INTEGER,a=(i==null?void 0:i.macd)??Number.MIN_SAFE_INTEGER;let l="";return a>0?l=fd(e.styles,"bars[0].upColor",t.bars[0].upColor):a<0?l=fd(e.styles,"bars[0].downColor",t.bars[0].downColor):l=fd(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor),{style:r<a?"stroke":"fill",color:l,borderColor:l}}}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0,l=0,d=0;const v=Math.max(t[0],t[1]);return o.reduce((p,_,y)=>{const w={},k=_.close;return s+=k,y>=t[0]-1&&(y>t[0]-1?i=(2*k+(t[0]-1)*i)/(t[0]+1):i=s/t[0]),y>=t[1]-1&&(y>t[1]-1?r=(2*k+(t[1]-1)*r)/(t[1]+1):r=s/t[1]),y>=v-1&&(a=i-r,w.dif=a,l+=a,y>=v+t[2]-2&&(y>v+t[2]-2?d=(a*2+d*(t[2]-1))/(t[2]+1):d=l/t[2],w.macd=(a-d)*2,w.dea=d)),p[_.timestamp]=w,p},{})}},N3={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0;const r=[],a={};return o.forEach((l,d)=>{const v=o[d-1]??l;l.close<v.close?i-=l.volume??0:l.close>v.close&&(i+=l.volume??0);const p={obv:i};s+=i,d>=t[0]-1&&(p.maObv=s/t[0],s-=r[d-(t[0]-1)].obv??0),r.push(p),a[l.timestamp]=p}),a}},R3={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:o=>{let e=0;return o.reduce((t,s,i)=>{const r={},a=s.close,l=s.volume??1,d=(o[i-1]??s).close;let v=0;const p=d*l;return p!==0&&(v=(a-d)/p),e+=v,r.pvt=e,t[s.timestamp]=r,t},{})}},O3={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0;const r=[],a=[],l={};return o.forEach((d,v)=>{const p={},_=(o[v-1]??d).close,y=d.close-_>0?1:0;r.push(y),s+=y,v>=t[0]-1&&(p.psy=s/t[0]*100,i+=p.psy,v>=t[0]+t[1]-2&&(p.maPsy=i/t[1],i-=a[v-(t[1]-1)].psy??0),s-=r[v-(t[0]-1)]),a.push(p),l[d.timestamp]=p}),l}},V3={name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=[],i={};let r=0;return o.forEach((a,l)=>{const d={};if(l>=t[0]-1){const v=a.close,p=(o[l-t[0]]??o[l-(t[0]-1)]).close;p!==0?d.roc=(v-p)/p*100:d.roc=0,r+=d.roc,l>=t[0]-1+t[1]-1&&(d.maRoc=r/t[1],r-=s[l-(t[1]-1)].roc??0)}s.push(d),i[a.timestamp]=d}),i}},W3={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>{const s=t+1;return{key:`rsi${s}`,title:`RSI${s}: `,type:"line"}}),calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[],r=[];return o.reduce((a,l,d)=>{const v={},p=(o[d-1]??l).close,_=l.close-p;return t.forEach((y,w)=>{if(_>0?i[w]=(i[w]??0)+_:r[w]=(r[w]??0)+Math.abs(_),d>=y-1){r[w]!==0?v[s[w].key]=100-100/(1+i[w]/r[w]):v[s[w].key]=0;const k=o[d-(y-1)],S=o[d-y]??k,L=k.close-S.close;L>0?i[w]-=L:r[w]-=Math.abs(L)}}),a[l.timestamp]=v,a},{})}},q3={name:"SMA",shortName:"SMA",series:"price",calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:(o,e)=>{const t=e.calcParams;let s=0,i=0;return o.reduce((r,a,l)=>{const d={},v=a.close;return s+=v,l>=t[0]-1&&(l>t[0]-1?i=(v*t[1]+i*(t[0]-t[1]+1))/(t[0]+1):i=s/t[0],d.sma=i),r[a.timestamp]=d,r},{})}},H3={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams,s=[],i={};return o.forEach((r,a)=>{var v,p;const l={},d=r.close;if(a>=t[0]-1){const _=D2(o.slice(a-(t[0]-1),a+1),"high","low"),y=_[0],w=_[1],k=y-w,S=(d-w)/(k===0?1:k)*100;l.k=((t[1]-1)*(((v=s[a-1])==null?void 0:v.k)??50)+S)/t[1],l.d=((t[2]-1)*(((p=s[a-1])==null?void 0:p.d)??50)+l.k)/t[2],l.j=3*l.k-2*l.d}s.push(l),i[r.timestamp]=l}),i}},G3={name:"SAR",shortName:"SAR",series:"price",calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:({data:o,indicator:e,defaultStyles:t})=>{const{current:s}=o,i=(s==null?void 0:s.sar)??Number.MIN_SAFE_INTEGER,r=(((s==null?void 0:s.high)??0)+((s==null?void 0:s.low)??0))/2;return{color:i<r?fd(e.styles,"circles[0].upColor",t.circles[0].upColor):fd(e.styles,"circles[0].downColor",t.circles[0].downColor)}}}],calc:(o,e)=>{const t=e.calcParams,s=t[0]/100,i=t[1]/100,r=t[2]/100;let a=s,l=-100,d=!1,v=0;return o.reduce((p,_,y)=>{const w=v,k=_.high,S=_.low;if(d){(l===-100||l<k)&&(l=k,a=Math.min(a+i,r)),v=w+a*(l-w);const L=Math.min(o[Math.max(1,y)-1].low,S);v>_.low?(v=l,a=s,l=-100,d=!d):v>L&&(v=L)}else{(l===-100||l>S)&&(l=S,a=Math.min(a+i,r)),v=w+a*(l-w);const L=Math.max(o[Math.max(1,y)-1].high,k);v<_.high?(v=l,a=0,l=-100,d=!d):v<L&&(v=L)}return p[_.timestamp]={high:k,low:S,sar:v},p},{})}},Y3={name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0,l=0,d=0,v=0;const p=[],_={};return o.forEach((y,w)=>{const k={},S=y.close;if(s+=S,w>=t[0]-1&&(w>t[0]-1?i=(2*S+(t[0]-1)*i)/(t[0]+1):i=s/t[0],l+=i,w>=t[0]*2-2&&(w>t[0]*2-2?r=(2*i+(t[0]-1)*r)/(t[0]+1):r=l/t[0],d+=r,w>=t[0]*3-3))){let L=0,T=0;w>t[0]*3-3?(L=(2*r+(t[0]-1)*a)/(t[0]+1),T=(L-a)/a*100):L=d/t[0],a=L,k.trix=T,v+=T,w>=t[0]*3+t[1]-4&&(k.maTrix=v/t[1],v-=p[w-(t[1]-1)].trix??0)}p.push(k),_[y.timestamp]=k}),_}};function J1(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:({data:o,indicator:e,defaultStyles:t})=>{const s=o.current;let i=fd(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor);return mo(s)&&(s.close>s.open?i=fd(e.styles,"bars[0].upColor",t.bars[0].upColor):s.close<s.open&&(i=fd(e.styles,"bars[0].downColor",t.bars[0].downColor))),{color:i}}}}const U3={name:"VOL",shortName:"VOL",series:"volume",calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},J1()],regenerateFigures:o=>{const e=o.map((t,s)=>({key:`ma${s+1}`,title:`MA${t}: `,type:"line"}));return e.push(J1()),e},calc:(o,e)=>{const{calcParams:t,figures:s}=e,i=[];return o.reduce((r,a,l)=>{const d=a.volume??0,v={volume:d,open:a.open,close:a.close};return t.forEach((p,_)=>{i[_]=(i[_]??0)+d,l>=p-1&&(v[s[_].key]=i[_]/p,i[_]-=o[l-(p-1)].volume??0)}),r[a.timestamp]=v,r},{})}},K3={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:(o,e)=>{const t=e.calcParams;let s=0,i=0,r=0,a=0;const l=[],d={};return o.forEach((v,p)=>{const _={},y=v.close,w=(o[p-1]??v).close,k=v.volume??0;if(y>w?s+=k:y<w?i+=k:r+=k,p>=t[0]-1){const S=r/2;i+S===0?_.vr=0:_.vr=(s+S)/(i+S)*100,a+=_.vr,p>=t[0]+t[1]-2&&(_.maVr=a/t[1],a-=l[p-(t[1]-1)].vr??0);const L=o[p-(t[0]-1)],T=o[p-t[0]]??L,P=L.close,A=L.volume??0;P>T.close?s-=A:P<T.close?i-=A:r-=A}l.push(_),d[v.timestamp]=_}),d}},Z3={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:o=>o.map((e,t)=>({key:`wr${t+1}`,title:`WR${t+1}: `,type:"line"})),calc:(o,e)=>{const{calcParams:t,figures:s}=e;return o.reduce((i,r,a)=>{const l={},d=r.close;return t.forEach((v,p)=>{const _=v-1;if(a>=_){const y=D2(o.slice(a-_,a+1),"high","low"),w=y[0],k=y[1],S=w-k;l[s[p].key]=S===0?0:(d-w)/S*100}}),i[r.timestamp]=l,i},{})}},r1={},X3=[k3,S3,C3,I3,M3,T3,A3,L3,F3,D3,E3,$3,j3,z3,B3,N3,R3,O3,V3,W3,q3,H3,G3,Y3,U3,K3,Z3];X3.forEach(o=>{r1[o.name]=Zm.extend(o)});function r_(o){r1[o.name]=Zm.extend(o)}function E2(o){return r1[o]??null}function Ku(o,e){const t=(e==null?void 0:e.ignoreEvent)??!1;return A0(t)?!t:!t.includes(o)}const Q1=1,u0=-1,J3="overlay_",ef="overlay_figure_";class Xm{constructor(e){re(this,"id");re(this,"groupId","");re(this,"paneId");re(this,"name");re(this,"totalStep",1);re(this,"currentStep",Q1);re(this,"lock",!1);re(this,"visible",!0);re(this,"zLevel",0);re(this,"needDefaultPointFigure",!1);re(this,"needDefaultXAxisFigure",!1);re(this,"needDefaultYAxisFigure",!1);re(this,"mode","normal");re(this,"modeSensitivity",8);re(this,"points",[]);re(this,"extendData");re(this,"styles",null);re(this,"createPointFigures",null);re(this,"createXAxisFigures",null);re(this,"createYAxisFigures",null);re(this,"performEventPressedMove",null);re(this,"performEventMoveForDrawing",null);re(this,"onDrawStart",null);re(this,"onDrawing",null);re(this,"onDrawEnd",null);re(this,"onClick",null);re(this,"onDoubleClick",null);re(this,"onRightClick",null);re(this,"onPressedMoveStart",null);re(this,"onPressedMoving",null);re(this,"onPressedMoveEnd",null);re(this,"onMouseMove",null);re(this,"onMouseEnter",null);re(this,"onMouseLeave",null);re(this,"onRemoved",null);re(this,"onSelected",null);re(this,"onDeselected",null);re(this,"_prevZLevel",0);re(this,"_prevOverlay");re(this,"_prevPressedPoint",null);re(this,"_prevPressedPoints",[]);this.override(e)}override(e){var d;this._prevOverlay=vf(this);const{id:t,name:s,currentStep:i,points:r,styles:a,...l}=e;if(rd(this,l),Dl(this.name)||(this.name=s??""),!Dl(this.id)&&Dl(t)&&(this.id=t),mo(a)&&(this.styles??(this.styles={}),rd(this.styles,a)),op(r)&&r.length>0){let v=0;if(this.points=[...r],r.length>=this.totalStep-1?(this.currentStep=u0,v=this.totalStep-1):(this.currentStep=r.length+1,v=r.length),du(this.performEventMoveForDrawing))for(let p=0;p<v;p++)this.performEventMoveForDrawing({currentStep:p+2,mode:this.mode,points:this.points,performPointIndex:p,performPoint:this.points[p]});this.currentStep===u0&&((d=this.performEventPressedMove)==null||d.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}))}}getPrevZLevel(){return this._prevZLevel}setPrevZLevel(e){this._prevZLevel=e}shouldUpdate(){const e=this._prevOverlay.zLevel!==this.zLevel,t=e||JSON.stringify(this._prevOverlay.points)!==JSON.stringify(this.points)||this._prevOverlay.visible!==this.visible||this._prevOverlay.extendData!==this.extendData||this._prevOverlay.styles!==this.styles;return{sort:e,draw:t}}nextStep(){this.currentStep===this.totalStep-1?this.currentStep=u0:this.currentStep++}forceComplete(){this.currentStep=u0}isDrawing(){return this.currentStep!==u0}isStart(){return this.currentStep===Q1}eventMoveForDrawing(e){var i;const t=this.currentStep-1,s={};xr(e.timestamp)&&(s.timestamp=e.timestamp),xr(e.dataIndex)&&(s.dataIndex=e.dataIndex),xr(e.value)&&(s.value=e.value),this.points[t]=s,(i=this.performEventMoveForDrawing)==null||i.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:t,performPoint:s})}eventPressedPointMove(e,t){var s;this.points[t].timestamp=e.timestamp,xr(e.value)&&(this.points[t].value=e.value),(s=this.performEventPressedMove)==null||s.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:t,performPoint:this.points[t]})}startPressedMove(e){this._prevPressedPoint={...e},this._prevPressedPoints=vf(this.points)}eventPressedOtherMove(e,t){if(this._prevPressedPoint!==null){let s=null;xr(e.dataIndex)&&xr(this._prevPressedPoint.dataIndex)&&(s=e.dataIndex-this._prevPressedPoint.dataIndex);let i=null;xr(e.value)&&xr(this._prevPressedPoint.value)&&(i=e.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(r=>{xr(r.timestamp)&&(r.dataIndex=t.timestampToDataIndex(r.timestamp));const a={...r};return xr(s)&&xr(r.dataIndex)&&(a.dataIndex=r.dataIndex+s,a.timestamp=t.dataIndexToTimestamp(a.dataIndex)??void 0),xr(i)&&xr(r.value)&&(a.value=r.value+i),a})}}static extend(e){class t extends Xm{constructor(){super(e)}}return t}}const Q3={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({chart:o,coordinates:e,bounding:t,overlay:s,yAxis:i})=>{var a;const r=s.points;if(e.length>0){let l=0;(i==null?void 0:i.isInCandle())??!0?l=((a=o.getSymbol())==null?void 0:a.pricePrecision)??Nd.PRICE:o.getIndicators({paneId:s.paneId}).forEach(w=>{l=Math.max(l,w.precision)});const d=[],v=[],p=0,_=t.width;if(e.length>1&&xr(r[0].value)&&xr(r[1].value)){const y=[1,.786,.618,.5,.382,.236,0],w=e[0].y-e[1].y,k=r[0].value-r[1].value;y.forEach(S=>{const L=e[1].y+w*S,T=o.getDecimalFold().format(o.getThousandsSeparator().format(((r[1].value??0)+k*S).toFixed(l)));d.push({coordinates:[{x:p,y:L},{x:_,y:L}]}),v.push({x:p,y:L,text:`${T} (${(S*100).toFixed(1)}%)`,baseline:"bottom"})})}return[{type:"line",attrs:d},{type:"text",isCheckEvent:!1,attrs:v}]}return[]}},e5={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>{const t={x:0,y:o[0].y};return mo(o[1])&&o[0].x<o[1].x&&(t.x=e.width),[{type:"line",attrs:{coordinates:[o[0],t]}}]},performEventPressedMove:({points:o,performPoint:e})=>{o[0].value=e.value,o[1].value=e.value},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].value=t.value)}},t5={name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=[];return o.length===2&&e.push({coordinates:o}),[{type:"line",attrs:e}]},performEventPressedMove:({points:o,performPoint:e})=>{o[0].value=e.value,o[1].value=e.value},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].value=t.value)}},o5={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:{coordinates:[{x:0,y:o[0].y},{x:e.width,y:o[0].y}]}}]};class a1{constructor(){re(this,"_children",[]);re(this,"_callbacks",new Map)}registerEvent(e,t){return this._callbacks.set(e,t),this}onEvent(e,t){const s=this._callbacks.get(e);return mo(s)&&this.checkEventOn(t)?s(t):!1}dispatchEventToChildren(e,t){const s=this._children.length-1;if(s>-1){for(let i=s;i>-1;i--)if(this._children[i].dispatchEvent(e,t))return!0}return!1}dispatchEvent(e,t){return this.dispatchEventToChildren(e,t)?!0:this.onEvent(e,t)}addChild(e){return this._children.push(e),this}clear(){this._children=[]}}const Pd=2;class Jm extends a1{constructor(t){super();re(this,"attrs");re(this,"styles");this.attrs=t.attrs,this.styles=t.styles}checkEventOn(t){return this.checkEventOnImp(t,this.attrs,this.styles)}setAttrs(t){return this.attrs=t,this}setStyles(t){return this.styles=t,this}draw(t){this.drawImp(t,this.attrs,this.styles)}static extend(t){class s extends Jm{checkEventOnImp(r,a,l){return t.checkEventOn(r,a,l)}drawImp(r,a,l){t.draw(r,a,l)}}return s}}function $2(o,e){let t=[];t=t.concat(e);for(const s of t){const{coordinates:i}=s;if(i.length>1)for(let r=1;r<i.length;r++){const a=i[r-1],l=i[r];if(a.x===l.x){if(Math.abs(a.y-o.y)+Math.abs(l.y-o.y)-Math.abs(a.y-l.y)<Pd+Pd&&Math.abs(o.x-a.x)<Pd)return!0}else{const d=Qm(a,l),v=l1(d,o),p=Math.abs(v-o.y);if(Math.abs(a.x-o.x)+Math.abs(l.x-o.x)-Math.abs(a.x-l.x)<Pd+Pd&&p*p/(d[0]*d[0]+1)<Pd*Pd)return!0}}}return!1}function l1(o,e){return o!==null?e.x*o[0]+o[1]:e.y}function L0(o,e,t){const s=Qm(o,e);return l1(s,t)}function Qm(o,e){const t=o.x-e.x;if(t!==0){const s=(o.y-e.y)/t,i=o.y-s*o.x;return[s,i]}return null}function j2(o,e,t){const s=e.length,i=xr(t)?t>0&&t<1?t:0:t?.5:0;if(i>0&&s>2){let r=e[0].x,a=e[0].y;for(let d=1;d<s-1;d++){const v=e[d-1],p=e[d],_=e[d+1],y=p.x-v.x,w=p.y-v.y,k=_.x-p.x,S=_.y-p.y;let L=_.x-v.x,T=_.y-v.y;const P=Math.sqrt(y*y+w*w),A=Math.sqrt(k*k+S*S),F=A/(A+P);let B=p.x+L*i*F,R=p.y+T*i*F;B=Math.min(B,Math.max(_.x,p.x)),R=Math.min(R,Math.max(_.y,p.y)),B=Math.max(B,Math.min(_.x,p.x)),R=Math.max(R,Math.min(_.y,p.y)),L=B-p.x,T=R-p.y;let N=p.x-L*P/A,$=p.y-T*P/A;N=Math.min(N,Math.max(v.x,p.x)),$=Math.min($,Math.max(v.y,p.y)),N=Math.max(N,Math.min(v.x,p.x)),$=Math.max($,Math.min(v.y,p.y)),L=p.x-N,T=p.y-$,B=p.x+L*A/P,R=p.y+T*A/P,o.bezierCurveTo(r,a,N,$,p.x,p.y),r=B,a=R}const l=e[s-1];o.bezierCurveTo(r,a,l.x,l.y,l.x,l.y)}else for(let r=1;r<s;r++)o.lineTo(e[r].x,e[r].y)}function s5(o,e,t){let s=[];s=s.concat(e);const{style:i="solid",smooth:r=!1,size:a=1,color:l="currentColor",dashedValue:d=[2,2]}=t;o.lineWidth=a,o.strokeStyle=l,i==="dashed"?o.setLineDash(d):o.setLineDash([]);const v=a%2===1?.5:0;s.forEach(({coordinates:p})=>{p.length>1&&(p.length===2&&(p[0].x===p[1].x||p[0].y===p[1].y)?(o.beginPath(),p[0].x===p[1].x?(o.moveTo(p[0].x+v,p[0].y),o.lineTo(p[1].x+v,p[1].y)):(o.moveTo(p[0].x,p[0].y+v),o.lineTo(p[1].x,p[1].y+v)),o.stroke(),o.closePath()):(o.save(),a%2===1&&o.translate(.5,.5),o.beginPath(),o.moveTo(p[0].x,p[0].y),j2(o,p,r),o.stroke(),o.closePath(),o.restore()))})}const n5={name:"line",checkEventOn:$2,draw:(o,e,t)=>{s5(o,e,t)}};function z2(o,e,t){const s=t??0,i=[];if(o.length>1)if(o[0].x===o[1].x){const a=e.height;if(i.push({coordinates:[{x:o[0].x,y:0},{x:o[0].x,y:a}]}),o.length>2){i.push({coordinates:[{x:o[2].x,y:0},{x:o[2].x,y:a}]});const l=o[0].x-o[2].x;for(let d=0;d<s;d++){const v=l*(d+1);i.push({coordinates:[{x:o[0].x+v,y:0},{x:o[0].x+v,y:a}]})}}}else{const a=e.width,l=Qm(o[0],o[1]),d=l[0],v=l[1];if(i.push({coordinates:[{x:0,y:0*d+v},{x:a,y:a*d+v}]}),o.length>2){const p=o[2].y-d*o[2].x;i.push({coordinates:[{x:0,y:0*d+p},{x:a,y:a*d+p}]});const _=v-p;for(let y=0;y<s;y++){const w=v+_*(y+1);i.push({coordinates:[{x:0,y:0*d+w},{x:a,y:a*d+w}]})}}}return i}const i5={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:z2(o,e)}]},r5={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:z2(o,e,1)}]},a5={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({chart:o,coordinates:e,bounding:t,overlay:s,yAxis:i})=>{var l;let r=0;(i==null?void 0:i.isInCandle())??!0?r=((l=o.getSymbol())==null?void 0:l.pricePrecision)??Nd.PRICE:o.getIndicators({paneId:s.paneId}).forEach(v=>{r=Math.max(r,v.precision)});const{value:a=0}=s.points[0];return[{type:"line",attrs:{coordinates:[e[0],{x:t.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:o.getDecimalFold().format(o.getThousandsSeparator().format(a.toFixed(r))),baseline:"bottom"}}]}};function l5(o,e){if(o.length>1){let t={x:0,y:0};return o[0].x===o[1].x&&o[0].y!==o[1].y?o[0].y<o[1].y?t={x:o[0].x,y:e.height}:t={x:o[0].x,y:0}:o[0].x>o[1].x?t={x:0,y:L0(o[0],o[1],{x:0,y:o[0].y})}:t={x:e.width,y:L0(o[0],o[1],{x:e.width,y:o[0].y})},{coordinates:[o[0],t]}}return[]}const c5={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:l5(o,e)}]},d5={name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>o.length===2?[{type:"line",attrs:{coordinates:o}}]:[]},u5={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>o.length===2?o[0].x===o[1].x?[{type:"line",attrs:{coordinates:[{x:o[0].x,y:0},{x:o[0].x,y:e.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:L0(o[0],o[1],{x:0,y:o[0].y})},{x:e.width,y:L0(o[0],o[1],{x:e.width,y:o[0].y})}]}}]:[]},p5={name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>{if(o.length===2){const t={x:o[0].x,y:0};return o[0].y<o[1].y&&(t.y=e.height),[{type:"line",attrs:{coordinates:[o[0],t]}}]}return[]},performEventPressedMove:({points:o,performPoint:e})=>{o[0].timestamp=e.timestamp,o[0].dataIndex=e.dataIndex,o[1].timestamp=e.timestamp,o[1].dataIndex=e.dataIndex},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},v5={name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>o.length===2?[{type:"line",attrs:{coordinates:o}}]:[],performEventPressedMove:({points:o,performPoint:e})=>{o[0].timestamp=e.timestamp,o[0].dataIndex=e.dataIndex,o[1].timestamp=e.timestamp,o[1].dataIndex=e.dataIndex},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},f5={name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>[{type:"line",attrs:{coordinates:[{x:o[0].x,y:0},{x:o[0].x,y:e.height}]}}]},g5={name:"simpleAnnotation",totalStep:2,styles:{line:{style:"dashed"}},createPointFigures:({overlay:o,coordinates:e})=>{let t="";mo(o.extendData)&&(du(o.extendData)?t=o.extendData(o):t=o.extendData??"");const s=e[0].x,i=e[0].y-6,r=i-50,a=r-5;return[{type:"line",attrs:{coordinates:[{x:s,y:i},{x:s,y:r}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:s,y:r},{x:s-4,y:a},{x:s+4,y:a}]},ignoreEvent:!0},{type:"text",attrs:{x:s,y:a,text:t,align:"center",baseline:"bottom"},ignoreEvent:!0}]}},m5={name:"simpleTag",totalStep:2,styles:{line:{style:"dashed"}},createPointFigures:({bounding:o,coordinates:e})=>({type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:o.width,y:e[0].y}]},ignoreEvent:!0}),createYAxisFigures:({chart:o,overlay:e,coordinates:t,bounding:s,yAxis:i})=>{var v;const r=(i==null?void 0:i.isFromZero())??!1;let a="left",l=0;r?(a="left",l=0):(a="right",l=s.width);let d="";return mo(e.extendData)&&(du(e.extendData)?d=e.extendData(e):d=e.extendData??""),!mo(d)&&xr(e.points[0].value)&&(d=jd(e.points[0].value,((v=o.getSymbol())==null?void 0:v.pricePrecision)??Nd.PRICE)),{type:"text",attrs:{x:l,y:t[0].y,text:d,align:a,baseline:"middle"}}}},c1={},h5=[Q3,e5,t5,o5,i5,r5,a5,c5,d5,u5,p5,v5,f5,g5,m5];h5.forEach(o=>{c1[o.name]=Xm.extend(o)});function B2(o){c1[o.name]=Xm.extend(o)}function _5(o){return c1[o]??null}const y5={grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},title:{color:"#76808F"},legend:{color:"#76808F"}}},indicator:{tooltip:{title:{color:"#76808F"},legend:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},b5={grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},title:{color:"#929AA5"},legend:{color:"#929AA5"}}},indicator:{tooltip:{title:{color:"#929AA5"},legend:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}},x5={light:y5,dark:b5};function w5(o){return x5[o]??null}const Mm=30,N2=100,La={CANDLE:"candle_pane",INDICATOR:"indicator_pane_",X_AXIS:"x_axis_pane"},ey={MIN:1,MAX:500},k5=10,S5=80,C5=.2,W_=10,Sc=24*60*60*1e3;function a_(o){if(o.length===0)return 0;const e=o.slice().sort((t,s)=>t-s);return e[Math.floor(e.length/2)]}function l_(o,e){if(o.length===0)return 0;const t=Math.max(0,Math.min(1,e)),s=Math.floor(t*(o.length-1));return o[s]}function P5(o){if(o.length===0)return 0;let e=0,t=0;for(const r of o){const a=2*Math.PI*(r/Sc);e+=Math.sin(a),t+=Math.cos(a)}const s=Math.atan2(e/o.length,t/o.length);return(s<0?s+2*Math.PI:s)/(2*Math.PI)*Sc}function Tv(o,e){return Math.floor((o-e)/Sc)*Sc+e}function gf(o){return new Date(o).getUTCDay()}function R2(o,e,t){if(e<=0)return 0;const s=t.reduce((l,d)=>l+(d?1:0),0);if(s<=0)return 0;let r=Math.floor(e/7)*s;const a=e%7;for(let l=0;l<a;l++){const d=(o+1+l)%7;t[d]&&r++}return r}function I5(o,e,t){if(e<=0)return 0;const s=t.reduce((l,d)=>l+(d?1:0),0);if(s<=0)return 0;let r=Math.floor(e/7)*s;const a=e%7;for(let l=0;l<a;l++){const d=(o+7-(1+l)%7)%7;t[d]&&r++}return r}function M5(o){try{if(!Array.isArray(o)||o.length<20)return null;const e=o.slice(Math.max(0,o.length-2500)),t=[];for(const F of e){const B=F==null?void 0:F.timestamp;typeof B=="number"&&isFinite(B)&&t.push(B)}if(t.length<20)return null;t.sort((F,B)=>F-B);const s=[];for(let F=1;F<t.length;F++){const B=t[F]-t[F-1];B>0&&isFinite(B)&&s.push(B)}if(s.length<10)return null;s.sort((F,B)=>F-B);const i=l_(s,.1)||s[0];if(!i||!isFinite(i)||i<=0)return null;const r=Math.max(i*6,i*3+6e4),a=[];for(let F=1;F<t.length;F++)if(t[F]-t[F-1]>r){const N=((t[F]+t[F-1])/2%Sc+Sc)%Sc;a.push(N)}const l=a.length>=4?P5(a):0,d=new Map;for(const F of t){const B=Tv(F,l),R=d.get(B);R?(R.count++,F<R.minTs&&(R.minTs=F),F>R.maxTs&&(R.maxTs=F)):d.set(B,{minTs:F,maxTs:F,count:1})}const v=Array.from(d.keys()).sort((F,B)=>F-B),p=v.slice(Math.max(0,v.length-40)),_=[],y=[],w=new Array(7).fill(!1),k=[];for(const F of p){const B=d.get(F);B!=null&&B.count&&k.push(B.count)}const S=a_(k.filter(F=>F>0)),L=Math.max(2,Math.floor(S*.6));for(const F of p){const B=d.get(F);if(!B)continue;const R=gf(F);w[R]=!0;const N=B.minTs-F,$=B.maxTs-F+i;B.count>=L&&isFinite(N)&&isFinite($)&&N>=0&&$>=0&&N<Sc&&$<=Sc&&$>N&&(_.push(N),y.push($))}let T=0,P=Sc;if(_.length>=5&&y.length>=5)T=a_(_),P=a_(y);else{const F=[];for(const N of t){const $=((N-l)%Sc+Sc)%Sc;F.push($)}F.sort((N,$)=>N-$);const B=l_(F,.05),R=l_(F,.95);T=B,P=Math.min(Sc,R+i)}if(T>=0&&P>T&&P<=Sc||(T=0,P=Sc),P-T>Sc*.92&&(T=0,P=Sc),!w.some(Boolean))for(let F=0;F<7;F++)w[F]=!0;return{boundaryOffsetMs:l,openMs:T,closeMs:P,activeWeekdays:w}}catch{return null}}function c_(o,e,t){if(o===e)return 0;let s=1,i=o,r=e;i>r&&(s=-1,i=e,r=o);const{boundaryOffsetMs:a,openMs:l,closeMs:d,activeWeekdays:v}=t,p=Math.max(0,d-l);if(p<=0)return 0;const _=Tv(i,a),y=Tv(r,a),w=i-_,k=r-y,S=gf(_),L=gf(y);if(_===y){if(!v[S])return 0;const F=Math.max(w,l),B=Math.min(k,d);return s*Math.max(0,B-F)}let T=0;v[S]&&(T+=Math.max(0,d-Math.max(w,l))),v[L]&&(T+=Math.max(0,Math.min(k,d)-l));const P=Math.max(0,Math.round((y-_)/Sc)),A=Math.max(0,P-1);if(A>0){const F=R2(S,A,v);T+=F*p}return s*T}function S0(o,e,t){let s=o,i=e;for(let r=0;r<14;r++)if(s+=Sc,i=(i+1)%7,t[i])return{dayStart:s,weekday:i};return{dayStart:o+Sc,weekday:(e+1)%7}}function C0(o,e,t){let s=o,i=e;for(let r=0;r<14;r++)if(s-=Sc,i=(i+6)%7,t[i])return{dayStart:s,weekday:i};return{dayStart:o-Sc,weekday:(e+6)%7}}function d_(o,e,t){if(e===0||!Number.isFinite(e))return o;const{boundaryOffsetMs:s,openMs:i,closeMs:r,activeWeekdays:a}=t;if(Math.max(0,r-i)<=0)return o;let d=o,v=e;const p=v>0;for(v=Math.abs(v);v>0;){let _=Tv(d,s),y=gf(_),w=d-_;if(!a[y]){const k=p?S0(_,y,a):C0(_,y,a);_=k.dayStart,y=k.weekday,w=p?i:r,d=_+w}if(p){if(w<i)w=i,d=_+w;else if(w>=r){const L=S0(_,y,a);_=L.dayStart,y=L.weekday,w=i,d=_+w}const k=Math.max(0,r-w);if(v<k)return d+v;v-=k,d=S0(_,y,a).dayStart+i}else{if(w>r)w=r,d=_+w;else if(w<=i){const L=C0(_,y,a);_=L.dayStart,y=L.weekday,w=r,d=_+w}const k=Math.max(0,w-i);if(v<k)return d-v;v-=k,d=C0(_,y,a).dayStart+r}}return d}function T5(o,e,t){if(o===e)return 0;const{boundaryOffsetMs:s,activeWeekdays:i}=t,r=Tv(o,s),a=Tv(e,s);if(r===a)return 0;const l=gf(r),d=Math.round((a-r)/Sc);return d>0?R2(l,d,i):-I5(l,Math.abs(d),i)}function A5(o,e,t){if(e===0||!Number.isFinite(e))return o;const{boundaryOffsetMs:s,activeWeekdays:i}=t,r=i.reduce((y,w)=>y+(w?1:0),0);if(r<=0)return o;let a=Tv(o,s),l=gf(a),d=o-a;if(!i[l])if(e>0){const y=S0(a,l,i);a=y.dayStart,l=y.weekday}else{const y=C0(a,l,i);a=y.dayStart,l=y.weekday}let v=Math.abs(e);const p=e>0,_=Math.floor(v/r);for(_>0&&(a+=(p?1:-1)*_*7*Sc,v-=_*r);v>0;){const y=p?S0(a,l,i):C0(a,l,i);a=y.dayStart,l=y.weekday,v--}return d=Math.max(0,Math.min(Sc-1,d)),a+d}class L5{constructor(e,t){re(this,"_chart");re(this,"_styles",w3());re(this,"_formatter",{formatDate:({dateTimeFormat:e,timestamp:t,template:s})=>T2(e,t,s),formatBigNumber:A2,formatExtendText:e=>""});re(this,"_innerFormatter",{formatDate:(e,t,s)=>this._formatter.formatDate({dateTimeFormat:this._dateTimeFormat,timestamp:e,template:t,type:s}),formatBigNumber:e=>this._formatter.formatBigNumber(e),formatExtendText:e=>this._formatter.formatExtendText(e)});re(this,"_locale","en-US");re(this,"_thousandsSeparator",{sign:",",format:e=>L2(e,this._thousandsSeparator.sign)});re(this,"_decimalFold",{threshold:3,format:e=>F2(e,this._decimalFold.threshold)});re(this,"_symbol",null);re(this,"_period",null);re(this,"_sessionCacheKey",null);re(this,"_sessionCache",null);re(this,"_sessionBySymbol",new Map);re(this,"_dataList",[]);re(this,"_dataLoader",null);re(this,"_loading",!1);re(this,"_dataLoadMore",{forward:!1,backward:!1});re(this,"_dateTimeFormat");re(this,"_zoomEnabled",!0);re(this,"_scrollEnabled",!0);re(this,"_totalBarSpace",0);re(this,"_barSpace",k5);re(this,"_gapBarSpace",0);re(this,"_offsetRightDistance",S5);re(this,"_lastBarRightSideDiffBarCount");re(this,"_startLastBarRightSideDiffBarCount",0);re(this,"_scrollLimitRole","bar_count");re(this,"_minVisibleBarCount",{left:2,right:2});re(this,"_maxOffsetDistance",{left:50,right:50});re(this,"_visibleRange",K1());re(this,"_visibleRangeDataList",[]);re(this,"_visibleRangeHighLowPrice",[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}]);re(this,"_crosshair",{});re(this,"_actions",new Map);re(this,"_indicators",new Map);re(this,"_taskScheduler",new f3);re(this,"_overlays",new Map);re(this,"_progressOverlayInfo",null);re(this,"_lastPriceMarkExtendTextUpdateTimers",[]);re(this,"_pressedOverlayInfo",{paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null});re(this,"_hoverOverlayInfo",{paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null});re(this,"_clickOverlayInfo",{paneId:"",overlay:null,figureType:"none",figureIndex:-1,figure:null});re(this,"_layoutRafId",null);re(this,"_pendingLayoutOptions",{measureWidth:!1,update:!1,buildYAxisTick:!1,cacheYAxisWidth:!1});re(this,"_overlayRafId",null);re(this,"_perfScrollCalls",0);re(this,"_perfZoomCalls",0);re(this,"_perfLayoutSchedules",0);re(this,"_perfLastWindowTs",typeof performance<"u"?performance.now():Date.now());this._chart=e,this._calcOptimalBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace;const{styles:s,locale:i,timezone:r,formatter:a,thousandsSeparator:l,decimalFold:d}=t??{};mo(s)&&this.setStyles(s),Dl(i)&&this.setLocale(i),this.setTimezone(r??""),mo(a)&&this.setFormatter(a),mo(l)&&this.setThousandsSeparator(l),mo(d)&&this.setDecimalFold(d)}setStyles(e){var s,i,r,a,l,d;let t=null;if(Dl(e)?t=w5(e):t=e,rd(this._styles,t),op((r=(i=(s=t==null?void 0:t.candle)==null?void 0:s.tooltip)==null?void 0:i.legend)==null?void 0:r.template)&&(this._styles.candle.tooltip.legend.template=t.candle.tooltip.legend.template),mo((d=(l=(a=t==null?void 0:t.candle)==null?void 0:a.priceMark)==null?void 0:l.last)==null?void 0:d.extendTexts)){this._clearLastPriceMarkExtendTextUpdateTimer();const v=[];this._styles.candle.priceMark.last.extendTexts.forEach(p=>{const _=p.updateInterval;if(p.show&&_>0&&!v.includes(_)){v.push(_);const y=setInterval(()=>{this._chart.updatePane(Ol.Main,La.CANDLE)},_);this._lastPriceMarkExtendTextUpdateTimers.push(y)}})}}getStyles(){return this._styles}setFormatter(e){rd(this._formatter,e)}getFormatter(){return this._formatter}getInnerFormatter(){return this._innerFormatter}setLocale(e){this._locale=e}getLocale(){return this._locale}setTimezone(e){if(!mo(this._dateTimeFormat)||this.getTimezone()!==e){const t={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};e.length>0&&(t.timeZone=e);let s=null;try{s=new Intl.DateTimeFormat("en",t)}catch{}s!==null&&(this._dateTimeFormat=s)}}getTimezone(){return this._dateTimeFormat.resolvedOptions().timeZone}getDateTimeFormat(){return this._dateTimeFormat}setThousandsSeparator(e){rd(this._thousandsSeparator,e)}getThousandsSeparator(){return this._thousandsSeparator}setDecimalFold(e){rd(this._decimalFold,e)}getDecimalFold(){return this._decimalFold}setSymbol(e){this.resetData(()=>{this._symbol={pricePrecision:Nd.PRICE,volumePrecision:Nd.VOLUME,...this._symbol,...e},this._synchronizeIndicatorSeriesPrecision()})}getSymbol(){return this._symbol}setPeriod(e){this.resetData(()=>{this._period=e})}getPeriod(){return this._period}_getSessionSymbolKey(){var s,i;const e=(s=this._symbol)==null?void 0:s.ticker;if(!e||typeof e!="string")return"";const t=(i=this._symbol)==null?void 0:i.exchange;return`${typeof t=="string"?t:""}:${e}`}_getInferredSession(){var e,t;try{const s=this._getSessionSymbolKey(),i=this._dataList.length,r=i>0?(e=this._dataList[0])==null?void 0:e.timestamp:0,a=i>0?(t=this._dataList[i-1])==null?void 0:t.timestamp:0,l=`${s}|${i}|${r}|${a}`;if(this._sessionCacheKey===l)return this._sessionCache;let d=M5(this._dataList);return d&&s?this._sessionBySymbol.set(s,d):!d&&s&&(d=this._sessionBySymbol.get(s)??null),this._sessionCacheKey=l,this._sessionCache=d,d}catch{return null}}_refineDataIndexByTimestamp(e,t,s){const i=Math.max(0,Math.min(50,Math.floor(s)));let r=t,a=Number.POSITIVE_INFINITY;for(let l=t-i;l<=t+i;l++){const d=this.dataIndexToTimestamp(l);if(!xr(d))continue;const v=Math.abs(d-e);v<a&&(a=v,r=l)}return r}_inferPeriodFromData(){const e=this._dataList.length;if(e<2)return null;const t=this._dataList[e-2].timestamp,s=this._dataList[e-1].timestamp,i=Math.max(1,s-t),r=1e3,a=60*r,l=60*a,d=24*l,v=7*d,p=30*d,_=365*d,y=[{type:"second",unit:r},{type:"minute",unit:a},{type:"hour",unit:l},{type:"day",unit:d},{type:"week",unit:v},{type:"month",unit:p},{type:"year",unit:_}];let w=null,k=Number.MAX_VALUE;for(const S of y){const L=Math.max(1,Math.round(i/S.unit)),T=L*S.unit,P=Math.abs(T-i);P<k&&(k=P,w={type:S.type,span:L})}return w}getDataList(){return this._dataList}getVisibleRangeDataList(){return this._visibleRangeDataList}getVisibleRangeHighLowPrice(){return this._visibleRangeHighLowPrice}_addData(e,t,s){let i=!1,r=!1,a=0;if(op(e)){const l={backward:!1,forward:!1};switch(A0(s)?(l.backward=s,l.forward=s):(l.backward=(s==null?void 0:s.backward)??!1,l.forward=(s==null?void 0:s.forward)??!1),a=e.length,t){case"init":{this._clearData(),this._dataList=e,this._dataLoadMore.backward=l.backward,this._dataLoadMore.forward=l.forward,this.setOffsetRightDistance(this._offsetRightDistance),r=!0;break}case"backward":{this._dataList=this._dataList.concat(e),this._dataLoadMore.backward=l.backward,this._lastBarRightSideDiffBarCount-=a,r=a>0;break}case"forward":{this._dataList=e.concat(this._dataList),this._dataLoadMore.forward=l.forward,r=a>0;break}}i=!0}else{const l=this._dataList.length,d=e.timestamp,v=fd(this._dataList[l-1],"timestamp",0);if(d>v){this._dataList.push(e);let p=this.getLastBarRightSideDiffBarCount();p<0&&this.setLastBarRightSideDiffBarCount(--p),a=1,i=!0,r=!0}else d===v&&(this._dataList[l-1]=e,i=!0,r=!0)}i&&r&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this.getIndicatorsByFilter({}).forEach(d=>{this._addIndicatorCalcTask(d,t)}),this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:t!=="init"}))}setDataLoader(e){this.resetData(()=>{this._dataLoader=e})}_calcOptimalBarSpace(){const t=1-C5*Math.atan(Math.max(4,this._barSpace)-4)/(Math.PI*.5);let s=Math.min(Math.floor(this._barSpace*t),Math.floor(this._barSpace));s%2===0&&s+2>=this._barSpace&&--s,this._gapBarSpace=Math.max(1,s)}_adjustVisibleRange(){const e=this._dataList.length,t=this._totalBarSpace/this._barSpace;let s=0,i=0;this._scrollLimitRole==="distance"?(s=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,i=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(s=this._minVisibleBarCount.left,i=this._minVisibleBarCount.right),s=Math.max(0,s),i=Math.max(0,i);const r=t-Math.min(s,e);this._lastBarRightSideDiffBarCount>r&&(this._lastBarRightSideDiffBarCount=r);const a=-e+Math.min(i,e);this._lastBarRightSideDiffBarCount<a&&(this._lastBarRightSideDiffBarCount=a);let l=Math.round(this._lastBarRightSideDiffBarCount+e+.5);const d=l;l>e&&(l=e);let v=Math.round(l-t)-1;v<0&&(v=0);const p=this._lastBarRightSideDiffBarCount>0?Math.round(e+this._lastBarRightSideDiffBarCount-t)-1:v;this._visibleRange={from:v,to:l,realFrom:p,realTo:d},this.executeAction("onVisibleRangeChange",this._visibleRange),this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}];for(let _=p;_<d;_++){const y=this._dataList[_],w=this.dataIndexToCoordinate(_);this._visibleRangeDataList.push({dataIndex:_,x:w,data:{prev:this._dataList[_-1]??y,current:y,next:this._dataList[_+1]??y}}),mo(y)&&(this._visibleRangeHighLowPrice[0].price<y.high&&(this._visibleRangeHighLowPrice[0].price=y.high,this._visibleRangeHighLowPrice[0].x=w),this._visibleRangeHighLowPrice[1].price>y.low&&(this._visibleRangeHighLowPrice[1].price=y.low,this._visibleRangeHighLowPrice[1].x=w))}v===0?this._dataLoadMore.forward&&this._processDataLoad("forward"):l===e&&this._dataLoadMore.backward&&this._processDataLoad("backward")}_processDataLoad(e){var t,s;if(!this._loading&&mo(this._dataLoader)&&mo(this._symbol)&&mo(this._period)){this._loading=!0,console.warn("ℹ️ klinecharts: data load triggered",{type:e});const i={type:e,symbol:this._symbol,period:this._period,timestamp:null,callback:(r,a)=>{var d,v;this._loading=!1,!(op(r)&&r.length>0)&&(e==="forward"?this._dataLoadMore.forward=!1:e==="backward"&&(this._dataLoadMore.backward=!1)),this._addData(r,e,a),e==="init"&&((v=(d=this._dataLoader)==null?void 0:d.subscribeBar)==null||v.call(d,{symbol:this._symbol,period:this._period,callback:p=>{this._addData(p,"update")}}))}};switch(e){case"backward":{i.timestamp=((t=this._dataList[this._dataList.length-1])==null?void 0:t.timestamp)??null;break}case"forward":{i.timestamp=((s=this._dataList[0])==null?void 0:s.timestamp)??null;break}}try{this._dataLoader.getBars(i)}catch(r){this._loading=!1,console.warn("⚠️ klinecharts: getBars threw",r)}}}_processDataUnsubscribe(){var e,t;mo(this._dataLoader)&&mo(this._symbol)&&mo(this._period)&&((t=(e=this._dataLoader).unsubscribeBar)==null||t.call(e,{symbol:this._symbol,period:this._period}))}resetData(e){this._processDataUnsubscribe(),e==null||e(),this._loading=!1,this._processDataLoad("init")}getBarSpace(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}}setBarSpace(e,t){e<ey.MIN||e>ey.MAX||this._barSpace===e||(this._barSpace=e,this._calcOptimalBarSpace(),t==null||t(),this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0}))}setTotalBarSpace(e){this._totalBarSpace!==e&&(this._totalBarSpace=e,this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0}))}setOffsetRightDistance(e,t){return this._offsetRightDistance=this._scrollLimitRole==="distance"?Math.min(this._maxOffsetDistance.right,e):e,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,(t??!1)&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0})),this}getInitialOffsetRightDistance(){return this._offsetRightDistance}getOffsetRightDistance(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)}getLastBarRightSideDiffBarCount(){return this._lastBarRightSideDiffBarCount}setLastBarRightSideDiffBarCount(e){this._lastBarRightSideDiffBarCount=e}setMaxOffsetLeftDistance(e){this._scrollLimitRole="distance",this._maxOffsetDistance.left=e}setMaxOffsetRightDistance(e){this._scrollLimitRole="distance",this._maxOffsetDistance.right=e}setLeftMinVisibleBarCount(e){this._scrollLimitRole="bar_count",this._minVisibleBarCount.left=e}setRightMinVisibleBarCount(e){this._scrollLimitRole="bar_count",this._minVisibleBarCount.right=e}getVisibleRange(){return this._visibleRange}startScroll(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount}scroll(e){if(!this._scrollEnabled)return;const t=typeof performance<"u"?performance.now():Date.now();t-this._perfLastWindowTs>500&&(this._perfScrollCalls=0,this._perfZoomCalls=0,this._perfLayoutSchedules=0,this._perfLastWindowTs=t),this._perfScrollCalls++,this._perfScrollCalls>80&&console.warn("⚠️ klinecharts: High-frequency scroll detected");const s=e/this._barSpace,i=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-s;const r=Math.round(i-this._lastBarRightSideDiffBarCount*this._barSpace);r!==0&&(this._adjustVisibleRange(),this.setCrosshair(this._crosshair,{notInvalidate:!0}),this._scheduleLayout({update:!0,buildYAxisTick:!0,cacheYAxisWidth:!0}),this.executeAction("onScroll",{distance:r}))}getDataByDataIndex(e){return this._dataList[e]??null}coordinateToFloatIndex(e){const t=this._dataList.length,s=(this._totalBarSpace-e)/this._barSpace,i=t+this._lastBarRightSideDiffBarCount-s;return Math.round(i*1e6)/1e6}dataIndexToTimestamp(e){const t=this._dataList.length;if(t===0)return null;const s=this.getDataByDataIndex(e);if(mo(s))return s.timestamp;if(mo(this._period)||this._dataList.length>0){const i=t-1;let r=null,a=0;if(e>i?(r=this._dataList[i].timestamp,a=e-i):e<0&&(r=this._dataList[0].timestamp,a=e),xr(r)){const l=this._period??this._inferPeriodFromData();if(mo(l)){const{type:d,span:v}=l;switch(d){case"second":{const p=this._getInferredSession();return p?d_(r,v*1e3*a,p):r+v*1e3*a}case"minute":{const p=this._getInferredSession();return p?d_(r,v*60*1e3*a,p):r+v*60*1e3*a}case"hour":{const p=this._getInferredSession();return p?d_(r,v*60*60*1e3*a,p):r+v*60*60*1e3*a}case"day":{const p=this._getInferredSession();return p?A5(r,v*a,p):r+v*24*60*60*1e3*a}case"week":return r+v*7*24*60*60*1e3*a;case"month":{const p=new Date(r),_=p.getDate();p.setDate(1),p.setMonth(p.getMonth()+v*a);const y=new Date(p.getFullYear(),p.getMonth()+1,0).getDate();return p.setDate(Math.min(_,y)),p.getTime()}case"year":{const p=new Date(r);return p.setFullYear(p.getFullYear()+v*a),p.getTime()}}}}}return null}timestampToDataIndex(e){const t=this._dataList.length;if(t===0)return 0;if(mo(this._period)||this._dataList.length>0){let s=null,i=0;const r=t-1,a=this._dataList[r].timestamp;e>a&&(s=a,i=r);const l=this._dataList[0].timestamp;if(e<l&&(s=l,i=0),xr(s)){const d=this._period??this._inferPeriodFromData();if(mo(d)){const{type:v,span:p}=d;switch(v){case"second":{const _=this._getInferredSession();if(_){const y=c_(s,e,_),w=p*1e3,k=i+y/w;return Math.round(k*1e6)/1e6}return i+(e-s)/(p*1e3)}case"minute":{const _=this._getInferredSession();if(_){const y=c_(s,e,_),w=p*60*1e3,k=i+y/w;return Math.round(k*1e6)/1e6}return i+(e-s)/(p*60*1e3)}case"hour":{const _=this._getInferredSession();if(_){const y=c_(s,e,_),w=p*60*60*1e3,k=i+y/w;return Math.round(k*1e6)/1e6}return i+(e-s)/(p*60*60*1e3)}case"day":{const _=this._getInferredSession();if(_){const y=T5(s,e,_),w=i+Math.floor(y/p);return this._refineDataIndexByTimestamp(e,w,6)}return i+Math.floor((e-s)/(p*24*60*60*1e3))}case"week":return i+Math.floor((e-s)/(p*7*24*60*60*1e3));case"month":{const _=new Date(s),y=new Date(e),w=_.getFullYear(),k=y.getFullYear(),S=_.getMonth(),L=y.getMonth();return i+Math.floor(((k-w)*12+(L-S))/p)}case"year":{const _=new Date(s).getFullYear(),y=new Date(e).getFullYear();return i+Math.floor((y-_)/p)}}}}}return V_(this._dataList,"timestamp",e)}dataIndexToCoordinate(e){const s=this._dataList.length+this._lastBarRightSideDiffBarCount-e;return Math.floor(this._totalBarSpace-(s-.5)*this._barSpace+.5)}coordinateToDataIndex(e){return Math.ceil(this.coordinateToFloatIndex(e))-1}zoom(e,t){if(!this._zoomEnabled)return;const s=typeof performance<"u"?performance.now():Date.now();s-this._perfLastWindowTs>500&&(this._perfScrollCalls=0,this._perfZoomCalls=0,this._perfLayoutSchedules=0,this._perfLastWindowTs=s),this._perfZoomCalls++,this._perfZoomCalls>60&&console.warn("⚠️ klinecharts: High-frequency zoom detected");let i=t??null;xr(i==null?void 0:i.x)||(i={x:this._crosshair.x??this._totalBarSpace/2});const r=i.x,a=this.coordinateToFloatIndex(r),l=this._barSpace,d=this._barSpace+e*(this._barSpace/W_);this.setBarSpace(d,()=>{this._lastBarRightSideDiffBarCount+=a-this.coordinateToFloatIndex(r)});const v=this._barSpace/l;v!==1&&this.executeAction("onZoom",{scale:v})}setZoomEnabled(e){this._zoomEnabled=e}isZoomEnabled(){return this._zoomEnabled}setScrollEnabled(e){this._scrollEnabled=e}isScrollEnabled(){return this._scrollEnabled}setCrosshair(e,t){const{notInvalidate:s,notExecuteAction:i,forceInvalidate:r}=t??{},a=e??{};let l=0,d=0;xr(a.x)?(l=this.coordinateToDataIndex(a.x),l<0?d=0:l>this._dataList.length-1?d=this._dataList.length-1:d=l):(l=this._dataList.length-1,d=l);const v=this._dataList[d],p=this.dataIndexToCoordinate(l),_={x:this._crosshair.x,y:this._crosshair.y,paneId:this._crosshair.paneId};this._crosshair={...a,realX:p,kLineData:v,realDataIndex:l,dataIndex:d,timestamp:this.dataIndexToTimestamp(l)??void 0},(_.x!==a.x||_.y!==a.y||_.paneId!==a.paneId||(r??!1))&&(mo(v)&&!(i??!1)&&this.hasAction("onCrosshairChange")&&Dl(this._crosshair.paneId)&&this.executeAction("onCrosshairChange",e),(s??!1)||this._scheduleOverlayUpdate())}getCrosshair(){return this._crosshair}executeAction(e,t){var s;(s=this._actions.get(e))==null||s.execute(t)}subscribeAction(e,t){var s;this._actions.has(e)||this._actions.set(e,new g3),(s=this._actions.get(e))==null||s.subscribe(t)}unsubscribeAction(e,t){const s=this._actions.get(e);mo(s)&&(s.unsubscribe(t),s.isEmpty()&&this._actions.delete(e))}hasAction(e){const t=this._actions.get(e);return mo(t)&&!t.isEmpty()}_sortIndicators(e){var t;Dl(e)?(t=this._indicators.get(e))==null||t.sort((s,i)=>s.zLevel-i.zLevel):this._indicators.forEach(s=>{s.sort((i,r)=>i.zLevel-r.zLevel)})}_addIndicatorCalcTask(e,t){var s;(s=e.onDataStateChange)==null||s.call(e,{state:"loading",type:t,indicator:e}),this._taskScheduler.add({id:Z1(e.id),handler:async()=>{const i=typeof performance<"u"?performance.now():Date.now(),r=await e.calcImp(this._dataList).then(d=>d),l=(typeof performance<"u"?performance.now():Date.now())-i;return l>50&&console.warn("⚠️ klinecharts: indicator calc slow",{name:e.name,durationMs:Math.round(l)}),r}}).then(i=>{var r;i&&(this._scheduleLayout({measureWidth:!0,update:!0,buildYAxisTick:!0,cacheYAxisWidth:t!=="init"}),(r=e.onDataStateChange)==null||r.call(e,{state:"ready",type:t,indicator:e}))}).catch(i=>{var r;i!=="canceled"&&((r=e.onDataStateChange)==null||r.call(e,{state:"error",type:t,indicator:e}))})}addIndicator(e,t,s){const{name:i}=e;if(this.getIndicatorsByFilter(e).length>0)return!1;let a=this.getIndicatorsByPaneId(t);const l=E2(i),d=new l;return this._synchronizeIndicatorSeriesPrecision(d),d.paneId=t,d.override(e),s||(this.removeIndicator({paneId:t}),a=[]),a.push(d),this._indicators.set(t,a),this._sortIndicators(t),this._addIndicatorCalcTask(d,"init"),!0}getIndicatorsByPaneId(e){return this._indicators.get(e)??[]}getIndicatorsByFilter(e){const{paneId:t,name:s,id:i}=e,r=mo(s)?s.split("(")[0].trim():void 0,a=d=>mo(i)?d.id===i:mo(r)?d.name===r||d.shortName===r:!0;let l=[];return mo(t)?l=l.concat(this.getIndicatorsByPaneId(t).filter(a)):this._indicators.forEach(d=>{l=l.concat(d.filter(a))}),l}removeIndicator(e){let t=!1;return this.getIndicatorsByFilter(e??{}).forEach(i=>{const r=this.getIndicatorsByPaneId(i.paneId),a=r.findIndex(l=>l.id===i.id);a>-1&&(this._taskScheduler.remove(Z1(i.id)),r.splice(a,1),t=!0),r.length===0&&this._indicators.delete(i.paneId)}),t}hasIndicators(e){return this._indicators.has(e)}_synchronizeIndicatorSeriesPrecision(e){if(mo(this._symbol)){const{pricePrecision:t=Nd.PRICE,volumePrecision:s=Nd.VOLUME}=this._symbol,i=r=>{switch(r.series){case"price":{r.setSeriesPrecision(t);break}case"volume":{r.setSeriesPrecision(s);break}}};mo(e)?i(e):this._indicators.forEach(r=>{r.forEach(a=>{i(a)})})}}overrideIndicator(e){let t=!1,s=!1;return this.getIndicatorsByFilter(e).forEach(r=>{r.override(e);const{calc:a,draw:l,sort:d}=r.shouldUpdateImp();d&&(s=!0),a?this._addIndicatorCalcTask(r,"update"):l&&(t=!0)}),s&&this._sortIndicators(),t?(this._scheduleLayout({update:!0}),!0):!1}_scheduleLayout(e){this._pendingLayoutOptions.measureWidth=this._pendingLayoutOptions.measureWidth||(e.measureWidth??!1),this._pendingLayoutOptions.update=this._pendingLayoutOptions.update||(e.update??!1),this._pendingLayoutOptions.buildYAxisTick=this._pendingLayoutOptions.buildYAxisTick||(e.buildYAxisTick??!1),this._pendingLayoutOptions.cacheYAxisWidth=this._pendingLayoutOptions.cacheYAxisWidth||(e.cacheYAxisWidth??!1);const t=typeof performance<"u"?performance.now():Date.now();t-this._perfLastWindowTs>500&&(this._perfScrollCalls=0,this._perfZoomCalls=0,this._perfLayoutSchedules=0,this._perfLastWindowTs=t),this._perfLayoutSchedules++,this._perfLayoutSchedules>40&&console.warn("⚠️ klinecharts: Frequent layout scheduling detected"),this._layoutRafId===null&&(this._layoutRafId=Wp(()=>{const s={...this._pendingLayoutOptions};this._pendingLayoutOptions={measureWidth:!1,update:!1,buildYAxisTick:!1,cacheYAxisWidth:!1},this._layoutRafId=null,this._chart.layout(s)}))}_scheduleOverlayUpdate(){this._overlayRafId===null&&(this._overlayRafId=Wp(()=>{this._overlayRafId=null,this._chart.updatePane(Ol.Overlay)}))}getOverlaysByFilter(e){var v;const{id:t,groupId:s,paneId:i,name:r}=e,a=p=>mo(t)?p.id===t:mo(s)?p.groupId===s&&(!mo(r)||p.name===r):!mo(r)||p.name===r;let l=[];mo(i)?l=l.concat(this.getOverlaysByPaneId(i).filter(a)):this._overlays.forEach(p=>{l=l.concat(p.filter(a))});const d=(v=this._progressOverlayInfo)==null?void 0:v.overlay;return mo(d)&&a(d)&&l.push(d),l}getOverlaysByPaneId(e){if(!Dl(e)){let t=[];return this._overlays.forEach(s=>{t=t.concat(s)}),t}return this._overlays.get(e)??[]}_sortOverlays(e){var t;Dl(e)?(t=this._overlays.get(e))==null||t.sort((s,i)=>s.zLevel-i.zLevel):this._overlays.forEach(s=>{s.sort((i,r)=>i.zLevel-r.zLevel)})}addOverlays(e,t){const s=[],i=e.map((r,a)=>{var d,v;if(mo(r.id)){let p=null;for(const _ of this._overlays){const w=_[1].find(k=>k.id===r.id);if(mo(w)){p=w;break}}if(mo(p))return r.id}const l=_5(r.name);if(mo(l)){const p=r.id??m0(J3),_=new l,y=r.paneId??La.CANDLE;r.id=p,r.groupId??(r.groupId=p);const w=this.getOverlaysByPaneId(y).length;return r.zLevel??(r.zLevel=w),_.override(r),s.includes(y)||s.push(y),_.isDrawing()?this._progressOverlayInfo={paneId:y,overlay:_,appointPaneFlag:t[a]}:(this._overlays.has(y)||this._overlays.set(y,[]),(d=this._overlays.get(y))==null||d.push(_)),_.isStart()&&((v=_.onDrawStart)==null||v.call(_,{overlay:_,chart:this._chart})),p}return null});return s.length>0&&(this._sortOverlays(),s.forEach(r=>{this._chart.updatePane(Ol.Overlay,r)}),this._chart.updatePane(Ol.Overlay,La.X_AXIS)),i}getProgressOverlayInfo(){return this._progressOverlayInfo}progressOverlayComplete(){var e;if(this._progressOverlayInfo!==null){const{overlay:t,paneId:s}=this._progressOverlayInfo;t.isDrawing()||(this._overlays.has(s)||this._overlays.set(s,[]),(e=this._overlays.get(s))==null||e.push(t),this._sortOverlays(s),this._progressOverlayInfo=null)}}updateProgressOverlayInfo(e,t){this._progressOverlayInfo!==null&&(A0(t)&&t&&(this._progressOverlayInfo.appointPaneFlag=t),this._progressOverlayInfo.paneId=e,this._progressOverlayInfo.overlay.override({paneId:e}))}overrideOverlay(e){let t=!1;const s=[];return this.getOverlaysByFilter(e).forEach(r=>{r.override(e);const{sort:a,draw:l}=r.shouldUpdate();a&&(t=!0),(a||l)&&(s.includes(r.paneId)||s.push(r.paneId))}),t&&this._sortOverlays(),s.length>0?(s.forEach(r=>{this._chart.updatePane(Ol.Overlay,r)}),this._chart.updatePane(Ol.Overlay,La.X_AXIS),!0):!1}removeOverlay(e){const t=[];return this.getOverlaysByFilter(e??{}).forEach(i=>{var l;const r=i.paneId,a=this.getOverlaysByPaneId(i.paneId);if((l=i.onRemoved)==null||l.call(i,{overlay:i,chart:this._chart}),t.includes(r)||t.push(r),i.isDrawing())this._progressOverlayInfo=null;else{const d=a.findIndex(v=>v.id===i.id);d>-1&&a.splice(d,1)}a.length===0&&this._overlays.delete(r)}),t.length>0?(t.forEach(i=>{this._chart.updatePane(Ol.Overlay,i)}),this._chart.updatePane(Ol.Overlay,La.X_AXIS),!0):!1}setPressedOverlayInfo(e){this._pressedOverlayInfo=e}getPressedOverlayInfo(){return this._pressedOverlayInfo}setHoverOverlayInfo(e,t,s){const{overlay:i,figureType:r,figureIndex:a,figure:l}=this._hoverOverlayInfo,d=e.overlay;if(((i==null?void 0:i.id)!==(d==null?void 0:d.id)||r!==e.figureType||a!==e.figureIndex)&&(this._hoverOverlayInfo=e,(i==null?void 0:i.id)!==(d==null?void 0:d.id))){let v=!1,p=!1;i!==null&&(i.override({zLevel:i.getPrevZLevel()}),p=!0,s(i,l)&&(v=!0)),d!==null&&(d.setPrevZLevel(d.zLevel),d.override({zLevel:Number.MAX_SAFE_INTEGER}),p=!0,t(d,e.figure)&&(v=!0)),p&&this._sortOverlays(),v||this._chart.updatePane(Ol.Overlay)}}getHoverOverlayInfo(){return this._hoverOverlayInfo}setClickOverlayInfo(e,t,s){const{paneId:i,overlay:r,figureType:a,figure:l,figureIndex:d}=this._clickOverlayInfo,v=e.overlay;((r==null?void 0:r.id)!==(v==null?void 0:v.id)||a!==e.figureType||d!==e.figureIndex)&&(this._clickOverlayInfo=e,(r==null?void 0:r.id)!==(v==null?void 0:v.id)&&(mo(r)&&s(r,l),mo(v)&&t(v,e.figure),this._chart.updatePane(Ol.Overlay,e.paneId),i!==e.paneId&&this._chart.updatePane(Ol.Overlay,i),this._chart.updatePane(Ol.Overlay,La.X_AXIS)))}getClickOverlayInfo(){return this._clickOverlayInfo}isOverlayEmpty(){return this._overlays.size===0&&this._progressOverlayInfo===null}isOverlayDrawing(){var e;return((e=this._progressOverlayInfo)==null?void 0:e.overlay.isDrawing())??!1}_clearLastPriceMarkExtendTextUpdateTimer(){this._lastPriceMarkExtendTextUpdateTimers.forEach(e=>{clearInterval(e)}),this._lastPriceMarkExtendTextUpdateTimers=[]}_clearData(){this._dataLoadMore.backward=!1,this._dataLoadMore.forward=!1,this._loading=!1,this._dataList=[],this._visibleRangeDataList=[],this._visibleRangeHighLowPrice=[{x:0,price:Number.MIN_SAFE_INTEGER},{x:0,price:Number.MAX_SAFE_INTEGER}],this._visibleRange=K1(),this._crosshair={}}getChart(){return this._chart}destroy(){this._clearData(),this._clearLastPriceMarkExtendTextUpdateTimer(),this._taskScheduler.clear(),this._overlays.clear(),this._indicators.clear(),this._actions.clear()}applyNewData(e,t){this._addData(e,"init",t)}addData(e,t,s){this._addData(e,t,s)}}const Ra={MAIN:"main",X_AXIS:"xAxis",Y_AXIS:"yAxis",SEPARATOR:"separator"},P0=7;async function F5(){return await new Promise(o=>{const e=new ResizeObserver(t=>{o(t.every(s=>"devicePixelContentBoxSize"in s)),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(()=>!1)}class ty{constructor(e,t){re(this,"_element");re(this,"_resizeObserver");re(this,"_mediaQueryList");re(this,"_ctx");re(this,"_listener");re(this,"_supportedDevicePixelContentBox",!1);re(this,"_width",0);re(this,"_height",0);re(this,"_pixelWidth",0);re(this,"_pixelHeight",0);re(this,"_nextPixelWidth",0);re(this,"_nextPixelHeight",0);re(this,"_requestAnimationId",n_);re(this,"_mediaQueryListener",()=>{const e=cv(this._element);this._nextPixelWidth=Math.round(this._element.clientWidth*e),this._nextPixelHeight=Math.round(this._element.clientHeight*e),this._resetPixelRatio()});this._listener=t,this._element=Gp("canvas",e),this._ctx=this._element.getContext("2d"),F5().then(s=>{this._supportedDevicePixelContentBox=s,s?(this._resizeObserver=new ResizeObserver(i=>{const r=i.find(l=>l.target===this._element),a=r==null?void 0:r.devicePixelContentBoxSize[0];mo(a)&&(this._nextPixelWidth=a.inlineSize,this._nextPixelHeight=a.blockSize,(this._pixelWidth!==this._nextPixelWidth||this._pixelHeight!==this._nextPixelHeight)&&this._resetPixelRatio())}),this._resizeObserver.observe(this._element,{box:"device-pixel-content-box"})):(this._mediaQueryList=window.matchMedia(`(resolution: ${cv(this._element)}dppx)`),this._mediaQueryList.addListener(this._mediaQueryListener))}).catch(s=>!1)}_resetPixelRatio(){this._executeListener(()=>{const e=this._element.clientWidth,t=this._element.clientHeight;this._width=e,this._height=t,this._pixelWidth=this._nextPixelWidth,this._pixelHeight=this._nextPixelHeight,this._element.width=this._nextPixelWidth,this._element.height=this._nextPixelHeight;const s=this._nextPixelWidth/e,i=this._nextPixelHeight/t;this._ctx.scale(s,i)})}_executeListener(e){this._requestAnimationId===n_&&(this._requestAnimationId=Wp(()=>{this._ctx.clearRect(0,0,this._width,this._height),e==null||e(),this._listener(),this._requestAnimationId=n_}))}update(e,t){if(this._width!==e||this._height!==t){if(this._element.style.width=`${e}px`,this._element.style.height=`${t}px`,!this._supportedDevicePixelContentBox){const s=cv(this._element);this._nextPixelWidth=Math.round(e*s),this._nextPixelHeight=Math.round(t*s),this._resetPixelRatio()}}else this._executeListener()}getElement(){return this._element}getContext(){return this._ctx}destroy(){mo(this._resizeObserver)&&this._resizeObserver.unobserve(this._element),mo(this._mediaQueryList)&&this._mediaQueryList.removeListener(this._mediaQueryListener)}}class O2 extends a1{constructor(t,s){super();re(this,"_rootContainer");re(this,"_pane");re(this,"_container");re(this,"_bounding",Bm());re(this,"_cursor","crosshair");re(this,"_forceCursor",null);this._pane=s,this._rootContainer=t,this._container=this.createContainer(),t.appendChild(this._container)}setBounding(t){return rd(this._bounding,t),this}getContainer(){return this._container}getBounding(){return this._bounding}getPane(){return this._pane}checkEventOn(t){return!0}setCursor(t){Dl(this._forceCursor)||t!==this._cursor&&(this._cursor=t,this._container.style.cursor=this._cursor)}setForceCursor(t){t!==this._forceCursor&&(this._forceCursor=t,this._container.style.cursor=this._forceCursor??this._cursor)}getForceCursor(){return this._forceCursor}update(t){this.updateImp(this._container,this._bounding,t??Ol.Drawer)}destroy(){this._rootContainer.removeChild(this._container)}}class d1 extends O2{constructor(t,s){super(t,s);re(this,"_mainCanvas");re(this,"_overlayCanvas");this._mainCanvas=new ty({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},()=>{this.updateMain(this._mainCanvas.getContext())}),this._overlayCanvas=new ty({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},()=>{this.updateOverlay(this._overlayCanvas.getContext())});const i=this.getContainer();i.appendChild(this._mainCanvas.getElement()),i.appendChild(this._overlayCanvas.getElement())}createContainer(){return Gp("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})}updateImp(t,s,i){const{width:r,height:a,left:l}=s;t.style.left=`${l}px`;let d=i;const v=t.clientWidth,p=t.clientHeight;switch((r!==v||a!==p)&&(t.style.width=`${r}px`,t.style.height=`${a}px`,d=Ol.Drawer),d){case Ol.Main:{this._mainCanvas.update(r,a);break}case Ol.Overlay:{this._overlayCanvas.update(r,a);break}case Ol.Drawer:case Ol.All:{this._mainCanvas.update(r,a),this._overlayCanvas.update(r,a);break}}}destroy(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()}getImage(t){const{width:s,height:i}=this.getBounding(),r=Gp("canvas",{width:`${s}px`,height:`${i}px`,boxSizing:"border-box"}),a=r.getContext("2d"),l=cv(r);return r.width=s*l,r.height=i*l,a.scale(l,l),a.drawImage(this._mainCanvas.getElement(),0,0,s,i),t&&a.drawImage(this._overlayCanvas.getElement(),0,0,s,i),r}}function V2(o,e){let t=[];t=t.concat(e);for(const s of t){const{x:i,y:r,r:a}=s,l=o.x-i,d=o.y-r;if(!(l*l+d*d>a*a))return!0}return!1}function D5(o,e,t){let s=[];s=s.concat(e);const{style:i="fill",color:r="currentColor",borderSize:a=1,borderColor:l="currentColor",borderStyle:d="solid",borderDashedValue:v=[2,2]}=t,p=(i==="fill"||t.style==="stroke_fill")&&(!Dl(r)||!ff(r));p&&(o.fillStyle=r,s.forEach(({x:_,y,r:w})=>{o.beginPath(),o.arc(_,y,w,0,Math.PI*2),o.closePath(),o.fill()})),(i==="stroke"||t.style==="stroke_fill")&&a>0&&!ff(l)&&(o.strokeStyle=l,o.lineWidth=a,d==="dashed"?o.setLineDash(v):o.setLineDash([]),s.forEach(({x:_,y,r:w})=>{(!p||w>a)&&(o.beginPath(),o.arc(_,y,w,0,Math.PI*2),o.closePath(),o.stroke())}))}const E5={name:"circle",checkEventOn:V2,draw:(o,e,t)=>{D5(o,e,t)}};function W2(o,e){let t=[];t=t.concat(e);for(const s of t){let i=!1;const{coordinates:r}=s;for(let a=0,l=r.length-1;a<r.length;l=a++)r[a].y>o.y!=r[l].y>o.y&&o.x<(r[l].x-r[a].x)*(o.y-r[a].y)/(r[l].y-r[a].y)+r[a].x&&(i=!i);if(i)return!0}return!1}function $5(o,e,t){let s=[];s=s.concat(e);const{style:i="fill",color:r="currentColor",borderSize:a=1,borderColor:l="currentColor",borderStyle:d="solid",borderDashedValue:v=[2,2]}=t;(i==="fill"||t.style==="stroke_fill")&&(!Dl(r)||!ff(r))&&(o.fillStyle=r,s.forEach(({coordinates:p})=>{o.beginPath(),o.moveTo(p[0].x,p[0].y);for(let _=1;_<p.length;_++)o.lineTo(p[_].x,p[_].y);o.closePath(),o.fill()})),(i==="stroke"||t.style==="stroke_fill")&&a>0&&!ff(l)&&(o.strokeStyle=l,o.lineWidth=a,d==="dashed"?o.setLineDash(v):o.setLineDash([]),s.forEach(({coordinates:p})=>{o.beginPath(),o.moveTo(p[0].x,p[0].y);for(let _=1;_<p.length;_++)o.lineTo(p[_].x,p[_].y);o.closePath(),o.stroke()}))}const j5={name:"polygon",checkEventOn:W2,draw:(o,e,t)=>{$5(o,e,t)}};function u1(o,e){let t=[];t=t.concat(e);for(const s of t){let i=s.x,r=s.width;r<Pd*2&&(i-=Pd,r=Pd*2);let a=s.y,l=s.height;if(l<Pd*2&&(a-=Pd,l=Pd*2),o.x>=i&&o.x<=i+r&&o.y>=a&&o.y<=a+l)return!0}return!1}function q2(o,e,t){let s=[];s=s.concat(e);const{style:i="fill",color:r="transparent",borderSize:a=1,borderColor:l="transparent",borderStyle:d="solid",borderRadius:v=0,borderDashedValue:p=[2,2]}=t,_=o.roundRect??o.rect,y=(i==="fill"||t.style==="stroke_fill")&&(!Dl(r)||!ff(r));if(y&&(o.fillStyle=r,s.forEach(({x:w,y:k,width:S,height:L})=>{o.beginPath(),_.call(o,w,k,S,L,v),o.closePath(),o.fill()})),(i==="stroke"||t.style==="stroke_fill")&&a>0&&!ff(l)){o.strokeStyle=l,o.fillStyle=l,o.lineWidth=a,d==="dashed"?o.setLineDash(p):o.setLineDash([]);const w=a%2===1?.5:0,k=Math.round(w*2);s.forEach(({x:S,y:L,width:T,height:P})=>{T>a*2&&P>a*2?(o.beginPath(),_.call(o,S+w,L+w,T-k,P-k,v),o.closePath(),o.stroke()):y||o.fillRect(S,L,T,P)})}}const z5={name:"rect",checkEventOn:u1,draw:(o,e,t)=>{q2(o,e,t)}};function H2(o,e){const{size:t=12,paddingLeft:s=0,paddingTop:i=0,paddingRight:r=0,paddingBottom:a=0,weight:l="normal",family:d}=e,{x:v,y:p,text:_,align:y="left",baseline:w="top",width:k,height:S}=o,L=k??s+Bd(_,t,l,d)+r,T=S??i+t+a;let P=0;switch(y){case"left":case"start":{P=v;break}case"right":case"end":{P=v-L;break}default:{P=v-L/2;break}}let A=0;switch(w){case"top":case"hanging":{A=p;break}case"bottom":case"ideographic":case"alphabetic":{A=p-T;break}default:{A=p-T/2;break}}return{x:P,y:A,width:L,height:T}}function G2(o,e,t){let s=[];s=s.concat(e);for(const i of s){const{x:r,y:a,width:l,height:d}=H2(i,t);if(o.x>=r&&o.x<=r+l&&o.y>=a&&o.y<=a+d)return!0}return!1}function B5(o,e,t){let s=[];s=s.concat(e);const{color:i="currentColor",size:r=12,family:a,weight:l,paddingLeft:d=0,paddingTop:v=0,paddingRight:p=0}=t,_=s.map(y=>H2(y,t));q2(o,_,{...t,color:t.backgroundColor}),o.textAlign="left",o.textBaseline="top",o.font=qp(r,l,a),o.fillStyle=i,s.forEach((y,w)=>{const k=_[w];o.fillText(y.text,k.x+d,k.y+v,k.width-d-p)})}const N5={name:"text",checkEventOn:G2,draw:(o,e,t)=>{B5(o,e,t)}};function R5(o,e){const t=o.x-e.x,s=o.y-e.y;return Math.sqrt(t*t+s*s)}function Y2(o,e){let t=[];t=t.concat(e);for(const s of t)if(Math.abs(R5(o,s)-s.r)<Pd){const{r:i,startAngle:r,endAngle:a}=s,l=i*Math.cos(r)+s.x,d=i*Math.sin(r)+s.y,v=i*Math.cos(a)+s.x,p=i*Math.sin(a)+s.y;if(o.x<=Math.max(l,v)+Pd&&o.x>=Math.min(l,v)-Pd&&o.y<=Math.max(d,p)+Pd&&o.y>=Math.min(d,p)-Pd)return!0}return!1}function O5(o,e,t){let s=[];s=s.concat(e);const{style:i="solid",size:r=1,color:a="currentColor",dashedValue:l=[2,2]}=t;o.lineWidth=r,o.strokeStyle=a,i==="dashed"?o.setLineDash(l):o.setLineDash([]),s.forEach(({x:d,y:v,r:p,startAngle:_,endAngle:y})=>{o.beginPath(),o.arc(d,v,p,_,y),o.stroke(),o.closePath()})}const V5={name:"arc",checkEventOn:Y2,draw:(o,e,t)=>{O5(o,e,t)}};function oy(o,e,t,s,i,r,a){const[l,d,v,p,_,y,w]=s,k=a?e+y:y+i,S=a?t+w:w+r;W5(e,t,l,d,v,p,_,k,S).forEach(T=>{o.bezierCurveTo(T[0],T[1],T[2],T[3],T[4],T[5])})}function W5(o,e,t,s,i,r,a,l,d){const{cx:v,cy:p,startAngle:_,deltaAngle:y}=q5(o,e,t,s,i,r,a,l,d),w=[],k=Math.ceil(Math.abs(y)/(Math.PI/2));for(let S=0;S<k;S++){const L=_+S*y/k,T=_+(S+1)*y/k,P=H5(v,p,t,s,i,L,T);w.push(P)}return w}function q5(o,e,t,s,i,r,a,l,d){const v=i*Math.PI/180,p=(o-l)/2,_=(e-d)/2,y=Math.cos(v)*p+Math.sin(v)*_,w=-Math.sin(v)*p+Math.cos(v)*_,k=y**2/t**2+w**2/s**2;k>1&&(t*=Math.sqrt(k),s*=Math.sqrt(k));const S=r===a?-1:1,L=t**2*s**2-t**2*w**2-s**2*y**2,T=t**2*w**2+s**2*y**2,P=S*Math.sqrt(Math.abs(L/T))*(t*w/s),A=S*Math.sqrt(Math.abs(L/T))*(-s*y/t),F=Math.cos(v)*P-Math.sin(v)*A+(o+l)/2,B=Math.sin(v)*P+Math.cos(v)*A+(e+d)/2,R=Math.atan2((w-A)/s,(y-P)/t);let N=Math.atan2((-w-A)/s,(-y-P)/t)-R;return N<0&&a===1?N+=2*Math.PI:N>0&&a===0&&(N-=2*Math.PI),{cx:F,cy:B,startAngle:R,deltaAngle:N}}function H5(o,e,t,s,i,r,a){const l=Math.sin(a-r)*(Math.sqrt(4+3*Math.tan((a-r)/2)**2)-1)/3,d=Math.cos(i),v=Math.sin(i),p=o+t*Math.cos(r)*d-s*Math.sin(r)*v,_=e+t*Math.cos(r)*v+s*Math.sin(r)*d,y=o+t*Math.cos(a)*d-s*Math.sin(a)*v,w=e+t*Math.cos(a)*v+s*Math.sin(a)*d,k=p+l*(-t*Math.sin(r)*d-s*Math.cos(r)*v),S=_+l*(-t*Math.sin(r)*v+s*Math.cos(r)*d),L=y-l*(-t*Math.sin(a)*d-s*Math.cos(a)*v),T=w-l*(-t*Math.sin(a)*v+s*Math.cos(a)*d);return[k,S,L,T,y,w]}function G5(o,e,t){let s=[];s=s.concat(e);const{lineWidth:i=1,color:r="currentColor"}=t;o.lineWidth=i,o.strokeStyle=r,o.setLineDash([]),s.forEach(({x:a,y:l,path:d})=>{const v=d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/gi);if(mo(v)){const p=a,_=l;o.beginPath(),v.forEach(y=>{let w=0,k=0,S=0,L=0;const T=y[0],P=y.slice(1).trim().split(/[\s,]+/).map(Number);switch(T){case"M":w=P[0]+p,k=P[1]+_,o.moveTo(w,k),S=w,L=k;break;case"m":w+=P[0],k+=P[1],o.moveTo(w,k),S=w,L=k;break;case"L":w=P[0]+p,k=P[1]+_,o.lineTo(w,k);break;case"l":w+=P[0],k+=P[1],o.lineTo(w,k);break;case"H":w=P[0]+p,o.lineTo(w,k);break;case"h":w+=P[0],o.lineTo(w,k);break;case"V":k=P[0]+_,o.lineTo(w,k);break;case"v":k+=P[0],o.lineTo(w,k);break;case"C":o.bezierCurveTo(P[0]+p,P[1]+_,P[2]+p,P[3]+_,P[4]+p,P[5]+_),w=P[4]+p,k=P[5]+_;break;case"c":o.bezierCurveTo(w+P[0],k+P[1],w+P[2],k+P[3],w+P[4],k+P[5]),w+=P[4],k+=P[5];break;case"S":o.bezierCurveTo(w,k,P[0]+p,P[1]+_,P[2]+p,P[3]+_),w=P[2]+p,k=P[3]+_;break;case"s":o.bezierCurveTo(w,k,w+P[0],k+P[1],w+P[2],k+P[3]),w+=P[2],k+=P[3];break;case"Q":o.quadraticCurveTo(P[0]+p,P[1]+_,P[2]+p,P[3]+_),w=P[2]+p,k=P[3]+_;break;case"q":o.quadraticCurveTo(w+P[0],k+P[1],w+P[2],k+P[3]),w+=P[2],k+=P[3];break;case"T":o.quadraticCurveTo(w,k,P[0]+p,P[1]+_),w=P[0]+p,k=P[1]+_;break;case"t":o.quadraticCurveTo(w,k,w+P[0],k+P[1]),w+=P[0],k+=P[1];break;case"A":oy(o,w,k,P,p,_,!1),w=P[5]+p,k=P[6]+_;break;case"a":oy(o,w,k,P,p,_,!0),w+=P[5],k+=P[6];break;case"Z":case"z":o.closePath(),w=S,k=L;break}}),t.style==="fill"?o.fill():o.stroke()}})}const Y5={name:"path",checkEventOn:u1,draw:(o,e,t)=>{G5(o,e,t)}},U5={name:"image",draw:(o,e)=>{const{x:t,y:s,width:i,height:r,image:a,borderRadius:l=0}=e;if(!(!a||!a.complete||a.naturalWidth===0))if(l&&l>0){o.save();const d=Math.min(l,Math.floor(Math.min(i,r)/2));o.beginPath(),o.moveTo(t+d,s),o.arcTo(t+i,s,t+i,s+r,d),o.arcTo(t+i,s+r,t,s+r,d),o.arcTo(t,s+r,t,s,d),o.arcTo(t,s,t+i,s,d),o.closePath(),o.clip(),o.drawImage(a,t,s,i,r),o.restore()}else o.drawImage(a,t,s,i,r)},checkEventOn:(o,e)=>!1},p1={},K5=[E5,n5,j5,z5,N5,V5,Y5,U5];K5.forEach(o=>{p1[o.name]=Jm.extend(o)});function Z5(o){p1[o.name]=Jm.extend(o)}function X5(o){return p1[o]??null}class Wu extends a1{constructor(t){super();re(this,"_widget");this._widget=t}getWidget(){return this._widget}createFigure(t,s){const i=X5(t.name);if(i!==null){const r=new i(t);if(mo(s)){for(const a in s)s.hasOwnProperty(a)&&r.registerEvent(a,s[a]);this.addChild(r)}return r}return null}draw(t,...s){this.clear(),this.drawImp(t,s)}checkEventOn(t){return!0}}class J5 extends Wu{drawImp(e){var d,v;const t=this.getWidget(),s=this.getWidget().getPane(),i=s.getChart(),r=t.getBounding(),a=i.getStyles().grid;if(a.show){e.save(),e.globalCompositeOperation="destination-over";const p=a.horizontal;if(p.show){const S=s.getAxisComponent().getTicks().map(L=>({coordinates:[{x:0,y:L.coord},{x:r.width,y:L.coord}]}));(d=this.createFigure({name:"line",attrs:S,styles:p}))==null||d.draw(e)}const y=a.vertical;if(y.show){const S=i.getXAxisPane().getAxisComponent().getTicks(),L=S.map(T=>({coordinates:[{x:T.coord,y:0},{x:T.coord,y:r.height}]}));if(S.length>=2){const T=S[S.length-1].coord,P=S[S.length-2].coord,A=T-P;if(A>0){let F=T+A;for(;F<=r.width;)L.push({coordinates:[{x:F,y:0},{x:F,y:r.height}]}),F+=A}}(v=this.createFigure({name:"line",attrs:L,styles:y}))==null||v.draw(e)}e.restore()}}}class U2 extends Wu{eachChildren(e){const s=this.getWidget().getPane().getChart().getChartStore(),i=s.getVisibleRangeDataList(),r=s.getBarSpace(),a=i.length;let l=0;for(;l<a;)e(i[l],r,l),++l}}class K2 extends U2{constructor(){super(...arguments);re(this,"_boundCandleBarClickEvent",t=>()=>(this.getWidget().getPane().getChart().getChartStore().executeAction("onCandleBarClick",t),!1))}drawImp(t){const s=this.getWidget().getPane(),i=s.getId()===La.CANDLE,r=s.getChart().getChartStore(),a=this.getCandleBarOptions();if(a!==null){const{type:l,styles:d}=a;let v=0,p=0;if(a.type==="ohlc"){const{gapBar:y}=r.getBarSpace();v=Math.min(Math.max(Math.round(y*.2),1),8),v>2&&v%2===1&&v--,p=Math.floor(v/2)}const _=s.getAxisComponent();this.eachChildren((y,w)=>{const{x:k,data:{current:S,prev:L}}=y;if(mo(S)){const{open:T,high:P,low:A,close:F}=S,B=d.compareRule==="current_open"?T:(L==null?void 0:L.close)??F,R=[];F>B?(R[0]=d.upColor,R[1]=d.upBorderColor,R[2]=d.upWickColor):F<B?(R[0]=d.downColor,R[1]=d.downBorderColor,R[2]=d.downWickColor):(R[0]=d.noChangeColor,R[1]=d.noChangeBorderColor,R[2]=d.noChangeWickColor);const N=_.convertToPixel(T),$=_.convertToPixel(F),V=[N,$,_.convertToPixel(P),_.convertToPixel(A)];V.sort((Z,le)=>Z-le);const U=w.gapBar%2===0?1:0;let G=[];switch(l){case"candle_solid":{G=this._createSolidBar(k,V,w,R,U);break}case"candle_stroke":{G=this._createStrokeBar(k,V,w,R,U);break}case"candle_up_stroke":{F>T?G=this._createStrokeBar(k,V,w,R,U):G=this._createSolidBar(k,V,w,R,U);break}case"candle_down_stroke":{T>F?G=this._createStrokeBar(k,V,w,R,U):G=this._createSolidBar(k,V,w,R,U);break}case"ohlc":{G=[{name:"rect",attrs:[{x:k-p,y:V[0],width:v,height:V[3]-V[0]},{x:k-w.halfGapBar,y:N+v>V[3]?V[3]-v:N,width:w.halfGapBar-p,height:v},{x:k+p,y:$+v>V[3]?V[3]-v:$,width:w.halfGapBar-p,height:v}],styles:{color:R[0]}}];break}}G.forEach(Z=>{var se;let le=null;i&&(le={mouseClickEvent:this._boundCandleBarClickEvent(y)}),(se=this.createFigure(Z,le??void 0))==null||se.draw(t)})}})}}getCandleBarOptions(){const t=this.getWidget().getPane().getChart().getStyles().candle;return{type:t.type,styles:t.bar}}_createSolidBar(t,s,i,r,a){return[{name:"rect",attrs:{x:t,y:s[0],width:1,height:s[3]-s[0]},styles:{color:r[2]}},{name:"rect",attrs:{x:t-i.halfGapBar,y:s[1],width:i.gapBar+a,height:Math.max(1,s[2]-s[1])},styles:{style:"stroke_fill",color:r[0],borderColor:r[1]}}]}_createStrokeBar(t,s,i,r,a){return[{name:"rect",attrs:[{x:t,y:s[0],width:1,height:s[1]-s[0]},{x:t,y:s[2],width:1,height:s[3]-s[2]}],styles:{color:r[2]}},{name:"rect",attrs:{x:t-i.halfGapBar,y:s[1],width:i.gapBar+a,height:Math.max(1,s[2]-s[1])},styles:{style:"stroke",borderColor:r[1]}}]}}class Q5 extends K2{getCandleBarOptions(){const e=this.getWidget().getPane();if(!e.getAxisComponent().isInCandle()){const s=e.getChart().getChartStore(),i=s.getIndicatorsByPaneId(e.getId());for(const r of i)if(r.shouldOhlc&&r.visible){const a=r.styles,l=s.getStyles().indicator,d=fd(a,"ohlc.compareRule",l.ohlc.compareRule),v=fd(a,"ohlc.upColor",l.ohlc.upColor),p=fd(a,"ohlc.downColor",l.ohlc.downColor),_=fd(a,"ohlc.noChangeColor",l.ohlc.noChangeColor);return{type:"ohlc",styles:{compareRule:d,upColor:v,downColor:p,noChangeColor:_,upBorderColor:v,downBorderColor:p,noChangeBorderColor:_,upWickColor:v,downWickColor:p,noChangeWickColor:_}}}}return null}drawImp(e){super.drawImp(e);const t=this.getWidget(),s=t.getPane(),i=s.getChart(),r=t.getBounding(),a=i.getXAxisPane().getAxisComponent(),l=s.getAxisComponent(),d=i.getChartStore(),v=d.getIndicatorsByPaneId(s.getId()),p=d.getStyles().indicator;e.save(),v.forEach(_=>{if(_.visible){_.zLevel<0?e.globalCompositeOperation="destination-over":e.globalCompositeOperation="source-over";let y=!1;if(_.draw!==null&&(e.save(),y=_.draw({ctx:e,chart:i,indicator:_,bounding:r,xAxis:a,yAxis:l}),e.restore()),!y){const w=_.result,k=[];this.eachChildren((S,L)=>{var le,se,ie,Y,K,Q;const{halfGapBar:T}=L,{dataIndex:P,x:A,data:F}=S,B=a.convertToPixel(P-1),R=a.convertToPixel(P+1),N=w[((le=F.prev)==null?void 0:le.timestamp)??""]??{},$=w[((se=F.current)==null?void 0:se.timestamp)??""]??{},V=w[((ie=F.next)==null?void 0:ie.timestamp)??""]??{},U={x:B},G={x:A},Z={x:R};_.figures.forEach(({key:q})=>{const ce=N[q];xr(ce)&&(U[q]=l.convertToPixel(ce));const _e=$[q];xr(_e)&&(G[q]=l.convertToPixel(_e));const me=V[q];xr(me)&&(Z[q]=l.convertToPixel(me))}),i1(_,{prev:((Y=F.prev)==null?void 0:Y.timestamp)??null,current:((K=F.current)==null?void 0:K.timestamp)??null,next:((Q=F.next)==null?void 0:Q.timestamp)??null},p,(q,ce,_e)=>{var me,Pe;if(mo($[q.key])){const ze=G[q.key];let he=(me=q.attrs)==null?void 0:me.call(q,{data:{prev:N,current:$,next:V},coordinate:{prev:U,current:G,next:Z},bounding:r,barSpace:L,xAxis:a,yAxis:l});if(!mo(he))switch(q.type){case"circle":{he={x:A,y:ze,r:Math.max(1,T)};break}case"rect":case"bar":{const ge=q.baseValue??l.getRange().from,be=l.convertToPixel(ge);let $e=Math.abs(be-ze);ge!==$[q.key]&&($e=Math.max(1,$e));let Ve=0;ze>be?Ve=be:Ve=ze,he={x:A-T,y:Ve,width:Math.max(1,T*2),height:$e};break}case"line":{mo(k[_e])||(k[_e]=[]),xr(G[q.key])&&xr(Z[q.key])&&k[_e].push({coordinates:[{x:G.x,y:G[q.key]},{x:Z.x,y:Z[q.key]}],styles:ce});break}}const De=q.type;mo(he)&&De!=="line"&&((Pe=this.createFigure({name:De==="bar"?"rect":De,attrs:he,styles:ce}))==null||Pe.draw(e))}})}),k.forEach(S=>{var L,T,P,A;if(S.length>1){const F=[{coordinates:[S[0].coordinates[0],S[0].coordinates[1]],styles:S[0].styles}];for(let B=1;B<S.length;B++){const R=F[F.length-1],N=S[B],$=R.coordinates[R.coordinates.length-1];$.x===N.coordinates[0].x&&$.y===N.coordinates[0].y&&R.styles.style===N.styles.style&&R.styles.color===N.styles.color&&R.styles.size===N.styles.size&&R.styles.smooth===N.styles.smooth&&((L=R.styles.dashedValue)==null?void 0:L[0])===((T=N.styles.dashedValue)==null?void 0:T[0])&&((P=R.styles.dashedValue)==null?void 0:P[1])===((A=N.styles.dashedValue)==null?void 0:A[1])?R.coordinates.push(N.coordinates[1]):F.push({coordinates:[N.coordinates[0],N.coordinates[1]],styles:N.styles})}F.forEach(({coordinates:B,styles:R})=>{var N;(N=this.createFigure({name:"line",attrs:{coordinates:B},styles:R}))==null||N.draw(e)})}})}}}),e.restore()}}class e6 extends Wu{drawImp(e){const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=t.getPane().getChart().getChartStore(),a=r.getCrosshair(),l=r.getStyles().crosshair;if(Dl(a.paneId)&&l.show){if(a.paneId===s.getId()){const v=a.y;this._drawLine(e,[{x:0,y:v},{x:i.width,y:v}],l.horizontal)}const d=a.realX;this._drawLine(e,[{x:d,y:0},{x:d,y:i.height}],l.vertical)}}_drawLine(e,t,s){var i;if(s.show){const r=s.line;r.show&&((i=this.createFigure({name:"line",attrs:{coordinates:t},styles:r}))==null||i.draw(e))}}}class Z2 extends Wu{constructor(t){super(t);re(this,"_activeFeatureInfo",null);re(this,"_featureClickEvent",(t,s)=>()=>(this.getWidget().getPane().getChart().getChartStore().executeAction(t,s),!0));re(this,"_featureMouseMoveEvent",t=>()=>(this._activeFeatureInfo=t,!0));this.registerEvent("mouseMoveEvent",s=>(this._activeFeatureInfo=null,!1))}drawImp(t){const s=this.getWidget(),r=s.getPane().getChart().getChartStore(),a=r.getCrosshair();if(mo(a.kLineData)){const l=s.getBounding(),{offsetLeft:d,offsetTop:v,offsetRight:p}=r.getStyles().indicator.tooltip;this.drawIndicatorTooltip(t,d,v,l.width-p)}}drawIndicatorTooltip(t,s,i,r){const a=this.getWidget().getPane(),l=a.getChart().getChartStore(),v=l.getStyles().indicator.tooltip;if(this.isDrawTooltip(l.getCrosshair(),v)){const p=l.getIndicatorsByPaneId(a.getId()),_=v.title,y=v.legend;p.forEach(w=>{let k=0;const S={x:s,y:i},{name:L,calcParamsText:T,legends:P,features:A}=this.getIndicatorTooltipData(w),F=L.length>0,B=P.length>0;if(F||B){const R=this.classifyTooltipFeatures(A);if(k=this.drawStandardTooltipFeatures(t,R[0],S,w,s,k,r),F){let N=L;T.length>0&&(N=`${N}${T}`);const $=_.color;k=this.drawStandardTooltipLegends(t,[{title:{text:"",color:$},value:{text:N,color:$}}],S,s,k,r,_)}k=this.drawStandardTooltipFeatures(t,R[1],S,w,s,k,r),B&&(k=this.drawStandardTooltipLegends(t,P,S,s,k,r,y)),k=this.drawStandardTooltipFeatures(t,R[2],S,w,s,k,r),i=S.y+k}})}return i}drawStandardTooltipFeatures(t,s,i,r,a,l,d){if(s.length>0){let v=0,p=0;s.forEach(w=>{const{marginLeft:k=0,marginTop:S=0,marginRight:L=0,marginBottom:T=0,paddingLeft:P=0,paddingTop:A=0,paddingRight:F=0,paddingBottom:B=0,size:R=0,type:N,content:$}=w;let V=0;if(N==="icon_font"){const U=$;t.font=qp(R,"normal",U.family),V=t.measureText(U.code).width}else V=R;v+=k+P+V+F+L,p=Math.max(p,S+A+R+B+T)}),i.x+v>d?(i.x=a,i.y+=l,l=p):l=Math.max(l,p);const y=this.getWidget().getPane().getId();s.forEach(w=>{var q,ce,_e,me,Pe;const{marginLeft:k=0,marginTop:S=0,marginRight:L=0,paddingLeft:T=0,paddingTop:P=0,paddingRight:A=0,paddingBottom:F=0,backgroundColor:B,activeBackgroundColor:R,borderRadius:N,size:$=0,color:V,activeColor:U,type:G,content:Z}=w;let le=V,se=B;((q=this._activeFeatureInfo)==null?void 0:q.paneId)===y&&((ce=this._activeFeatureInfo.indicator)==null?void 0:ce.id)===(r==null?void 0:r.id)&&this._activeFeatureInfo.feature.id===w.id&&(le=U??V,se=R??B);let ie="onCandleTooltipFeatureClick";const Y={paneId:y,feature:w};mo(r)&&(ie="onIndicatorTooltipFeatureClick",Y.indicator=r);const K={mouseClickEvent:this._featureClickEvent(ie,Y),mouseMoveEvent:this._featureMouseMoveEvent(Y)};let Q=0;if(G==="icon_font"){const ze=Z;(_e=this.createFigure({name:"text",attrs:{text:ze.code,x:i.x+k,y:i.y+S},styles:{paddingLeft:T,paddingTop:P,paddingRight:A,paddingBottom:F,borderRadius:N,size:$,family:ze.family,color:le,backgroundColor:se}},K))==null||_e.draw(t),Q=t.measureText(ze.code).width}else{(me=this.createFigure({name:"rect",attrs:{x:i.x+k,y:i.y+S,width:$,height:$},styles:{paddingLeft:T,paddingTop:P,paddingRight:A,paddingBottom:F,color:se}},K))==null||me.draw(t);const ze=Z;(Pe=this.createFigure({name:"path",attrs:{path:ze.path,x:i.x+k+T,y:i.y+S+P,width:$,height:$},styles:{style:ze.style,lineWidth:ze.lineWidth,color:le}}))==null||Pe.draw(t),Q=$}i.x+=k+T+Q+A+L})}return l}drawStandardTooltipLegends(t,s,i,r,a,l,d){if(s.length>0){const{marginLeft:v,marginTop:p,marginRight:_,marginBottom:y,size:w,family:k,weight:S}=d;t.font=qp(w,S,k),s.forEach(L=>{var $,V;const T=L.title,P=L.value,A=t.measureText(T.text).width,F=t.measureText(P.text).width,B=T.text.length>0&&P.text.length>0?2:0,R=A+B+F,N=p+w+y;i.x+v+R+_>l?(i.x=r,i.y+=a,a=N):a=Math.max(a,N),T.text.length>0&&(($=this.createFigure({name:"text",attrs:{x:i.x+v,y:i.y+p,text:T.text},styles:{color:T.color,size:w,family:k,weight:S}}))==null||$.draw(t)),(V=this.createFigure({name:"text",attrs:{x:i.x+v+A+B,y:i.y+p,text:P.text},styles:{color:P.color,size:w,family:k,weight:S}}))==null||V.draw(t),i.x+=v+R+_})}return a}isDrawTooltip(t,s){const i=s.showRule;return i==="always"||i==="follow_cross"&&Dl(t.paneId)}getIndicatorTooltipData(t){var L;const s=this.getWidget().getPane().getChart().getChartStore(),i=s.getStyles().indicator,r=i.tooltip,a=r.title;let l="",d="";if(a.show&&(a.showName&&(l=t.shortName),a.showParams)){const T=t.calcParams;T.length>0&&(d=`(${T.join(",")})`)}const v={name:l,calcParamsText:d,legends:[],features:r.features},p=s.getCrosshair().dataIndex,_=t.result,y=s.getInnerFormatter(),w=s.getDecimalFold(),k=s.getThousandsSeparator(),S=[];if(t.visible){const T=s.getDataList(),P=T[p]??{},A=T[p-1]??{};let F=_[P.timestamp];!mo(F)&&p===T.length-1&&(F=_[A.timestamp]);const B=r.legend.defaultValue;i1(t,{prev:A.timestamp,current:P.timestamp,next:(L=T[p])==null?void 0:L.timestamp},i,(R,N)=>{if(Dl(R.title)){const $=N.color;let V=F==null?void 0:F[R.key];xr(V)&&(V=jd(V,t.precision),t.shouldFormatBigNumber&&(V=y.formatBigNumber(V)),V=w.format(k.format(V))),S.push({title:{text:R.title,color:$},value:{text:V??B,color:$}})}}),v.legends=S}if(du(t.createTooltipDataSource)){const T=this.getWidget(),P=T.getPane(),A=P.getChart(),{name:F,calcParamsText:B,legends:R,features:N}=t.createTooltipDataSource({chart:A,indicator:t,crosshair:s.getCrosshair(),bounding:T.getBounding(),xAxis:P.getChart().getXAxisPane().getAxisComponent(),yAxis:P.getAxisComponent()});if(a.show&&(Dl(F)&&a.showName&&(v.name=F),Dl(B)&&a.showParams&&(v.calcParamsText=B)),mo(N)&&(v.features=N),mo(R)&&t.visible){const $=[],V=i.tooltip.legend.color;R.forEach(U=>{let G={text:"",color:V};Cu(U.title)?G=U.title:G.text=U.title;let Z={text:"",color:V};Cu(U.value)?Z=U.value:Z.text=U.value,xr(Number(Z.text))&&(Z.text=w.format(k.format(Z.text))),$.push({title:G,value:Z})}),v.legends=$}}return v}classifyTooltipFeatures(t){const s=[],i=[],r=[];return t.forEach(a=>{switch(a.position){case"left":{s.push(a);break}case"middle":{i.push(a);break}case"right":{r.push(a);break}}}),[s,i,r]}}class X2 extends Wu{constructor(e){super(e),this._initEvent()}_initEvent(){const e=this.getWidget(),t=e.getPane(),s=t.getId(),i=t.getChart(),r=i.getChartStore();this.registerEvent("mouseMoveEvent",a=>{var d;const l=r.getProgressOverlayInfo();if(l!==null){const v=l.overlay;let p=l.paneId;v.isStart()&&(r.updateProgressOverlayInfo(s),p=s);const _=v.points.length-1;if(v.isDrawing()&&p===s){const y=this._coordinateToPoint(v,a);v.eventMoveForDrawing(y),(d=v.onDrawing)==null||d.call(v,{chart:i,overlay:v,...a})}return this._figureMouseMoveEvent(v,"point",_,{key:`${ef}point_${_}`,type:"circle",attrs:{}})(a)}return r.setHoverOverlayInfo({paneId:s,overlay:null,figureType:"none",figureIndex:-1,figure:null},(v,p)=>this._processOverlayMouseEnterEvent(v,p,a),(v,p)=>this._processOverlayMouseLeaveEvent(v,p,a)),e.setForceCursor(null),!1}).registerEvent("mouseClickEvent",a=>{var d,v;const l=r.getProgressOverlayInfo();if(l!==null){const p=l.overlay;let _=l.paneId;p.isStart()&&(r.updateProgressOverlayInfo(s,!0),_=s);const y=p.points.length-1;if(p.isDrawing()&&_===s){const w=this._coordinateToPoint(p,a);p.eventMoveForDrawing(w),(d=p.onDrawing)==null||d.call(p,{chart:i,overlay:p,...a}),p.nextStep(),p.isDrawing()||(r.progressOverlayComplete(),(v=p.onDrawEnd)==null||v.call(p,{chart:i,overlay:p,...a}))}return this._figureMouseClickEvent(p,"point",y,{key:`${ef}point_${y}`,type:"circle",attrs:{}})(a)}return r.setClickOverlayInfo({paneId:s,overlay:null,figureType:"none",figureIndex:-1,figure:null},(p,_)=>this._processOverlaySelectedEvent(p,_,a),(p,_)=>this._processOverlayDeselectedEvent(p,_,a)),!1}).registerEvent("mouseDoubleClickEvent",a=>{var d;const l=r.getProgressOverlayInfo();if(l!==null){const v=l.overlay,p=l.paneId;v.isDrawing()&&p===s&&(v.forceComplete(),v.isDrawing()||(r.progressOverlayComplete(),(d=v.onDrawEnd)==null||d.call(v,{chart:i,overlay:v,...a})));const _=v.points.length-1;return this._figureMouseClickEvent(v,"point",_,{key:`${ef}point_${_}`,type:"circle",attrs:{}})(a)}return!1}).registerEvent("mouseRightClickEvent",a=>{const l=r.getProgressOverlayInfo();if(l!==null){const d=l.overlay;if(d.isDrawing()){const v=d.points.length-1;return this._figureMouseRightClickEvent(d,"point",v,{key:`${ef}point_${v}`,type:"circle",attrs:{}})(a)}}return!1}).registerEvent("mouseUpEvent",a=>{var v;const{overlay:l,figure:d}=r.getPressedOverlayInfo();return l!==null&&Ku("onPressedMoveEnd",d)&&((v=l.onPressedMoveEnd)==null||v.call(l,{chart:i,overlay:l,figure:d??void 0,...a})),r.setPressedOverlayInfo({paneId:s,overlay:null,figureType:"none",figureIndex:-1,figure:null}),!1}).registerEvent("pressedMouseMoveEvent",a=>{var _;const{overlay:l,figureType:d,figureIndex:v,figure:p}=r.getPressedOverlayInfo();if(l!==null&&Ku("onPressedMoving",p)){if(!l.lock){const y=this._coordinateToPoint(l,a);d==="point"?l.eventPressedPointMove(y,v):l.eventPressedOtherMove(y,this.getWidget().getPane().getChart().getChartStore());let w=!1;(_=l.onPressedMoving)==null||_.call(l,{chart:i,overlay:l,figure:p??void 0,...a,preventDefault:()=>{w=!0}}),w?this.getWidget().setForceCursor(null):this.getWidget().setForceCursor("pointer")}return!0}return this.getWidget().setForceCursor(null),!1})}_createFigureEvents(e,t,s,i){return e.isDrawing()?null:{mouseMoveEvent:this._figureMouseMoveEvent(e,t,s,i),mouseDownEvent:this._figureMouseDownEvent(e,t,s,i),mouseClickEvent:this._figureMouseClickEvent(e,t,s,i),mouseRightClickEvent:this._figureMouseRightClickEvent(e,t,s,i),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(e,t,s,i)}}_processOverlayMouseEnterEvent(e,t,s){return du(e.onMouseEnter)&&Ku("onMouseEnter",t)?(e.onMouseEnter({chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_processOverlayMouseLeaveEvent(e,t,s){return du(e.onMouseLeave)&&Ku("onMouseLeave",t)?(e.onMouseLeave({chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_processOverlaySelectedEvent(e,t,s){var i;return Ku("onSelected",t)?((i=e.onSelected)==null||i.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_processOverlayDeselectedEvent(e,t,s){var i;return Ku("onDeselected",t)?((i=e.onDeselected)==null||i.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:t??void 0,...s}),!0):!1}_figureMouseMoveEvent(e,t,s,i){return r=>{var d;const a=this.getWidget().getPane(),l=!e.isDrawing()&&Ku("onMouseMove",i);if(l){let v=!1;(d=e.onMouseMove)==null||d.call(e,{chart:a.getChart(),overlay:e,figure:i,...r,preventDefault:()=>{v=!0}}),v?this.getWidget().setForceCursor(null):this.getWidget().setForceCursor("pointer")}return a.getChart().getChartStore().setHoverOverlayInfo({paneId:a.getId(),overlay:e,figureType:t,figure:i,figureIndex:s},(v,p)=>this._processOverlayMouseEnterEvent(v,p,r),(v,p)=>this._processOverlayMouseLeaveEvent(v,p,r)),l}}_figureMouseDownEvent(e,t,s,i){return r=>{var d;const a=this.getWidget().getPane(),l=a.getId();return e.startPressedMove(this._coordinateToPoint(e,r)),Ku("onPressedMoveStart",i)?((d=e.onPressedMoveStart)==null||d.call(e,{chart:a.getChart(),overlay:e,figure:i,...r}),a.getChart().getChartStore().setPressedOverlayInfo({paneId:l,overlay:e,figureType:t,figureIndex:s,figure:i}),!e.isDrawing()):!1}}_figureMouseClickEvent(e,t,s,i){return r=>{var v;const a=this.getWidget().getPane(),l=a.getId(),d=!e.isDrawing()&&Ku("onClick",i);return d&&((v=e.onClick)==null||v.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:i,...r})),a.getChart().getChartStore().setClickOverlayInfo({paneId:l,overlay:e,figureType:t,figureIndex:s,figure:i},(p,_)=>this._processOverlaySelectedEvent(p,_,r),(p,_)=>this._processOverlayDeselectedEvent(p,_,r)),d}}_figureMouseDoubleClickEvent(e,t,s,i){return r=>{var a;return Ku("onDoubleClick",i)?((a=e.onDoubleClick)==null||a.call(e,{...r,chart:this.getWidget().getPane().getChart(),figure:i,overlay:e}),!e.isDrawing()):!1}}_figureMouseRightClickEvent(e,t,s,i){return r=>{var a;if(Ku("onRightClick",i)){let l=!1;return(a=e.onRightClick)==null||a.call(e,{chart:this.getWidget().getPane().getChart(),overlay:e,figure:i,...r,preventDefault:()=>{l=!0}}),l||this.getWidget().getPane().getChart().getChartStore().removeOverlay(e),!e.isDrawing()}return!1}}_coordinateToPoint(e,t){const s={},i=this.getWidget().getPane(),r=i.getChart(),a=i.getId(),l=r.getChartStore();if(this.coordinateToPointTimestampDataIndexFlag()){const v=r.getXAxisPane().getAxisComponent().convertFromPixel(t.x),p=l.dataIndexToTimestamp(v)??void 0;s.timestamp=p,s.dataIndex=v}if(this.coordinateToPointValueFlag()){const d=i.getAxisComponent();let v=d.convertFromPixel(t.y);if(e.mode!=="normal"&&a===La.CANDLE&&xr(s.dataIndex)){const p=l.getDataByDataIndex(s.dataIndex);if(p!==null){const _=e.modeSensitivity;if(v>p.high)if(e.mode==="weak_magnet"){const y=d.convertToPixel(p.high),w=d.convertFromPixel(y-_);v<w&&(v=p.high)}else v=p.high;else if(v<p.low)if(e.mode==="weak_magnet"){const y=d.convertToPixel(p.low),w=d.convertFromPixel(y-_);v>w&&(v=p.low)}else v=p.low;else{const y=Math.max(p.open,p.close),w=Math.min(p.open,p.close);v>y?v-y<p.high-v?v=y:v=p.high:v<w?v-p.low<w-v?v=p.low:v=w:y-v<v-w?v=y:v=w}}}s.value=v}return s}coordinateToPointValueFlag(){return!0}coordinateToPointTimestampDataIndexFlag(){return!0}dispatchEvent(e,t){return this.getWidget().getPane().getChart().getChartStore().isOverlayDrawing()?this.onEvent(e,t):super.dispatchEvent(e,t)}drawImp(e){this.getCompleteOverlays().forEach(i=>{i.visible&&this._drawOverlay(e,i)});const s=this.getProgressOverlay();mo(s)&&s.visible&&this._drawOverlay(e,s)}_drawOverlay(e,t){const{points:s}=t,i=this.getWidget().getPane(),r=i.getChart(),a=r.getChartStore(),l=i.getAxisComponent(),d=r.getXAxisPane().getAxisComponent(),p=a.getDataList().length,_=p-1,y=s.map((w,k)=>{let S=null;xr(w.timestamp)?S=a.timestampToDataIndex(w.timestamp):xr(w.dataIndex)?S=w.dataIndex:p>0&&(S=_);const L={x:0,y:0};return xr(S)&&(L.x=d.convertToPixel(S)),xr(w.value)&&(L.y=(l==null?void 0:l.convertToPixel(w.value))??0),L});if(y.length>0){const w=[].concat(this.getFigures(t,y));this.drawFigures(e,t,w)}this.drawDefaultFigures(e,t,y)}drawFigures(e,t,s){const i=this.getWidget().getPane().getChart().getStyles().overlay;s.forEach((r,a)=>{const{type:l,styles:d,attrs:v}=r;[].concat(v).forEach(_=>{var k,S;const y=this._createFigureEvents(t,"other",a,r),w={...i[l],...(k=t.styles)==null?void 0:k[l],...d};(S=this.createFigure({name:l,attrs:_,styles:w},y??void 0))==null||S.draw(e)})})}getCompleteOverlays(){const e=this.getWidget().getPane();return e.getChart().getChartStore().getOverlaysByPaneId(e.getId())}getProgressOverlay(){const e=this.getWidget().getPane(),t=e.getChart().getChartStore().getProgressOverlayInfo();return mo(t)&&t.paneId===e.getId()?t.overlay:null}getFigures(e,t){var v;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),a=i.getAxisComponent(),l=r.getXAxisPane().getAxisComponent(),d=s.getBounding();return((v=e.createPointFigures)==null?void 0:v.call(e,{chart:r,overlay:e,coordinates:t,bounding:d,xAxis:l,yAxis:a}))??[]}drawDefaultFigures(e,t,s){var i,r;if(t.needDefaultPointFigure){const a=this.getWidget().getPane().getChart().getChartStore(),l=a.getHoverOverlayInfo(),d=a.getClickOverlayInfo();if(((i=l.overlay)==null?void 0:i.id)===t.id&&l.figureType!=="none"||((r=d.overlay)==null?void 0:r.id)===t.id&&d.figureType!=="none"){const v=a.getStyles().overlay,p=t.styles,_={...v.point,...p==null?void 0:p.point};s.forEach(({x:y,y:w},k)=>{var A,F,B,R;let S=_.radius,L=_.color,T=_.borderColor,P=_.borderSize;((A=l.overlay)==null?void 0:A.id)===t.id&&l.figureType==="point"&&((F=l.figure)==null?void 0:F.key)===`${ef}point_${k}`&&(S=_.activeRadius,L=_.activeColor,T=_.activeBorderColor,P=_.activeBorderSize),(B=this.createFigure({name:"circle",attrs:{x:y,y:w,r:S+P},styles:{color:T}},this._createFigureEvents(t,"point",k,{key:`${ef}point_${k}`,type:"circle",attrs:{x:y,y:w,r:S+P},styles:{color:T}})??void 0))==null||B.draw(e),(R=this.createFigure({name:"circle",attrs:{x:y,y:w,r:S},styles:{color:L}}))==null||R.draw(e)})}}}}class J2 extends d1{constructor(t,s){super(t,s);re(this,"_gridView",new J5(this));re(this,"_indicatorView",new Q5(this));re(this,"_crosshairLineView",new e6(this));re(this,"_tooltipView",this.createTooltipView());re(this,"_overlayView",new X2(this));this.addChild(this._tooltipView),this.addChild(this._overlayView)}getName(){return Ra.MAIN}updateMain(t){this.getPane().getOptions().state!=="minimize"&&(this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t))}createTooltipView(){return new Z2(this)}updateMainContent(t){}updateOverlayContent(t){}updateOverlay(t){this.getPane().getOptions().state!=="minimize"&&(this._overlayView.draw(t),this._crosshairLineView.draw(t),this.updateOverlayContent(t)),this._tooltipView.draw(t)}}class t6 extends U2{constructor(){super(...arguments);re(this,"_ripplePoint",this.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}));re(this,"_animationFrameTime",0);re(this,"_animation",new O_({iterationCount:1/0}).doFrame(t=>{this._animationFrameTime=t;const s=this.getWidget().getPane();s.getChart().updatePane(Ol.Main,s.getId())}))}drawImp(t){var L,T,P;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),l=r.getDataList().length-1,d=s.getBounding(),v=i.getAxisComponent(),p=r.getStyles().candle.area,_=[];let y=Number.MAX_SAFE_INTEGER,w=Number.MIN_SAFE_INTEGER,k=null;if(this.eachChildren(A=>{const F=A.x,{current:B}=A.data,R=B==null?void 0:B[p.value];if(xr(R)){const N=v.convertToPixel(R);w===Number.MIN_SAFE_INTEGER&&(w=F),_.push({x:F,y:N}),y=Math.min(y,N),A.dataIndex===l&&(k={x:F,y:N})}}),_.length>0){(L=this.createFigure({name:"line",attrs:{coordinates:_},styles:{color:p.lineColor,size:p.lineSize,smooth:p.smooth}}))==null||L.draw(t);const A=p.backgroundColor;let F="";if(op(A)){const B=t.createLinearGradient(0,d.height,0,y);try{A.forEach(({offset:R,color:N})=>{B.addColorStop(R,N)})}catch{}F=B}else F=A;t.fillStyle=F,t.beginPath(),t.moveTo(w,d.height),t.lineTo(_[0].x,_[0].y),j2(t,_,p.smooth),t.lineTo(_[_.length-1].x,d.height),t.closePath(),t.fill()}const S=p.point;if(S.show&&mo(k)){(T=this.createFigure({name:"circle",attrs:{x:k.x,y:k.y,r:S.radius},styles:{style:"fill",color:S.color}}))==null||T.draw(t);let A=S.rippleRadius;S.animation&&(A=S.radius+this._animationFrameTime/S.animationDuration*(S.rippleRadius-S.radius),this._animation.setDuration(S.animationDuration).start()),(P=this._ripplePoint)==null||P.setAttrs({x:k.x,y:k.y,r:A}).setStyles({style:"fill",color:S.rippleColor}).draw(t)}else this.stopAnimation()}stopAnimation(){this._animation.stop()}}class o6 extends Wu{drawImp(e){var d;const s=this.getWidget().getPane(),i=s.getChart().getChartStore(),r=i.getStyles().candle.priceMark,a=r.high,l=r.low;if(r.show&&(a.show||l.show)){const v=i.getVisibleRangeHighLowPrice(),p=((d=i.getSymbol())==null?void 0:d.pricePrecision)??Nd.PRICE,_=s.getAxisComponent(),{price:y,x:w}=v[0],{price:k,x:S}=v[1],L=_.convertToPixel(y),T=_.convertToPixel(k),P=i.getDecimalFold(),A=i.getThousandsSeparator();a.show&&y!==Number.MIN_SAFE_INTEGER&&this._drawMark(e,P.format(A.format(jd(y,p))),{x:w,y:L},L<T?[-2,-5]:[2,5],a),l.show&&k!==Number.MAX_SAFE_INTEGER&&this._drawMark(e,P.format(A.format(jd(k,p))),{x:S,y:T},L<T?[2,5]:[-2,-5],l)}}_drawMark(e,t,s,i,r){var w,k,S;const a=s.x,l=s.y+i[0];(w=this.createFigure({name:"line",attrs:{coordinates:[{x:a-2,y:l+i[0]},{x:a,y:l},{x:a+2,y:l+i[0]}]},styles:{color:r.color}}))==null||w.draw(e);let d=0,v=0,p="left";const{width:_}=this.getWidget().getBounding();a>_/2?(d=a-5,v=d-r.textOffset,p="right"):(d=a+5,p="left",v=d+r.textOffset);const y=l+i[1];(k=this.createFigure({name:"line",attrs:{coordinates:[{x:a,y:l},{x:a,y},{x:d,y}]},styles:{color:r.color}}))==null||k.draw(e),(S=this.createFigure({name:"text",attrs:{x:v,y,text:t,align:p,baseline:"middle"},styles:{color:r.color,size:r.textSize,family:r.textFamily,weight:r.textWeight}}))==null||S.draw(e)}}class s6 extends Wu{drawImp(e){var v,p;const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=s.getChart().getChartStore(),a=r.getStyles().candle.priceMark,l=a.last,d=l.line;if(a.show&&l.show&&d.show){const _=s.getAxisComponent(),y=r.getDataList(),w=y[y.length-1];if(mo(w)){const{close:k,open:S}=w,L=l.compareRule==="current_open"?S:((v=y[y.length-2])==null?void 0:v.close)??k,T=_.convertToPixel(k);let P="";k>L?P=l.upColor:k<L?P=l.downColor:P=l.noChangeColor,(p=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:T},{x:i.width,y:T}]},styles:{style:d.style,color:P,size:d.size,dashedValue:d.dashedValue}}))==null||p.draw(e)}}}}const n6={second:"HH:mm:ss",minute:"HH:mm",hour:"MM-DD HH:mm",day:"YYYY-MM-DD",week:"YYYY-MM-DD",month:"YYYY-MM",year:"YYYY"},Q2={second:"HH:mm:ss",minute:"YYYY-MM-DD HH:mm",hour:"YYYY-MM-DD HH:mm",day:"YYYY-MM-DD",week:"YYYY-MM-DD",month:"YYYY-MM",year:"YYYY"},i6={time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量：",turnover:"成交额：",change:"涨幅：",second:"秒",minute:"",hour:"小时",day:"天",week:"周",month:"月",year:"年"},r6={time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: ",second:"S",minute:"",hour:"H",day:"D",week:"W",month:"M",year:"Y"},a6={"zh-CN":i6,"en-US":r6};function l6(o,e){return a6[e][o]??o}const af={},lm={},Tm={},Am={};function c6(o){if(o)return af[o]}function d6(o){const e=Am[o];!e||e.size===0||e.forEach(t=>{try{t()}catch{}})}async function u6(o,e=2){if(af[o])return af[o];if(lm[o])return lm[o];Tm[o]="loading";const t=new Promise((s,i)=>{let r=0;const a=()=>{const l=new Image;l.crossOrigin="anonymous";try{l.referrerPolicy="no-referrer"}catch{}const d=async()=>{var p;try{await((p=l.decode)==null?void 0:p.call(l))}catch{}af[o]=l,Tm[o]="loaded",d6(o),s(l)},v=()=>{if(r+=1,r<=e){const p=Math.min(500*r,1500);setTimeout(a,p)}else Tm[o]="error",i(new Error("load error"))};l.onload=d,l.onerror=v,l.src=o};a()});lm[o]=t;try{return await t}finally{delete lm[o]}}function q_(o){if(o&&!(af[o]||Tm[o]==="loading"))try{u6(o)}catch{}}function p6(o,e){if(Am[o]||(Am[o]=new Set),Am[o].add(e),af[o])try{e()}catch{}}function eb(o){o&&(q_(o.logo),q_(o.logo2))}class v6 extends Z2{constructor(){super(...arguments);re(this,"_logoCache",{});re(this,"_logoSubscribed",{})}drawImp(t){const s=this.getWidget(),i=s.getPane().getChart().getChartStore(),r=i.getCrosshair();if(mo(r.kLineData)){const a=s.getBounding(),l=i.getStyles(),d=l.candle,v=l.indicator;if(d.tooltip.showType==="rect"&&v.tooltip.showType==="rect"){const p=this.isDrawTooltip(r,d.tooltip),_=this.isDrawTooltip(r,v.tooltip);this._drawRectTooltip(t,p,_,d.tooltip.offsetTop)}else if(d.tooltip.showType==="standard"&&v.tooltip.showType==="standard"){const{offsetLeft:p,offsetTop:_,offsetRight:y}=d.tooltip,w=a.width-y,k=this._drawCandleStandardTooltip(t,p,_,w);this.drawIndicatorTooltip(t,p,k,w)}else if(d.tooltip.showType==="rect"&&v.tooltip.showType==="standard"){const{offsetLeft:p,offsetTop:_,offsetRight:y}=d.tooltip,w=a.width-y,k=this.drawIndicatorTooltip(t,p,_,w),S=this.isDrawTooltip(r,d.tooltip);this._drawRectTooltip(t,S,!1,k)}else{const{offsetLeft:p,offsetTop:_,offsetRight:y}=d.tooltip,w=a.width-y,k=this._drawCandleStandardTooltip(t,p,_,w),S=this.isDrawTooltip(r,v.tooltip);this._drawRectTooltip(t,!1,S,k)}}}_drawCandleStandardTooltip(t,s,i,r){var w;const a=this.getWidget().getPane().getChart().getChartStore(),d=a.getStyles().candle.tooltip,v=d.legend;let p=0;const _={x:s,y:i},y=a.getCrosshair();if(this.isDrawTooltip(y,d)){const k=d.title;if(k.show){const{type:T="",span:P=""}=a.getPeriod()??{},A=a.getSymbol(),F=((A==null?void 0:A.type)||"").toLowerCase(),B=((A==null?void 0:A.exchange)||"").toUpperCase();let R=F;(R==="forex"||R==="crypto")&&(R="");const N={second:"s",minute:"m",hour:"h",day:"d",week:"w",month:"mo",year:"y"},$=(P?`${P}`:"")+(N[T]??"");let V=k.template;!R&&typeof V=="string"&&(V=V.replace(/(?:\s*[·\.]\s*)\{segment\}/i,""));let U=q1(V,{...A,period:$,exchange:B,segment:R});try{if(typeof window<"u"&&window.innerWidth<=768){const ie=(A==null?void 0:A.name)||(A==null?void 0:A.ticker)||"",Y=k.marginLeft??0,K=k.marginRight??0,Q=20,ce=!!(A!=null&&A.logo2)?Q*2-6+6:Q+6,_e=Math.max(0,r-ce-Y-K),me=k.size??14,Pe=k.family,ze=k.weight,he="...",De=Bd(he,me,ze,Pe);let ge=ie;if(Bd(ge,me,ze,Pe)>_e&&_e>De){let $e=0,Ve=ge.length;for(;$e<Ve;){const Je=Math.floor(($e+Ve)/2),ye=ge.slice(0,Je)+he;Bd(ye,me,ze,Pe)<=_e?$e=Je+1:Ve=Je}const Ce=Math.max(1,$e-1);ge=ge.slice(0,Ce)+he}U=ge}}catch{}const G=k.color;let Z={...k};try{const se=(A==null?void 0:A.logo)||"",ie=(A==null?void 0:A.logo2)||"",Y=20,K=Math.floor(_.x+(Z.marginLeft??0)),Q=Math.floor(_.y+(Z.marginTop??0)+Math.max(0,Math.floor(((Z.size??12)-Y)/2))),q=[se].filter(Boolean);ie&&q.push(ie);const ce=a.getStyles(),_e=((w=ce==null?void 0:ce.pane)==null?void 0:w.backgroundColor)||"#ffffff";let me=255,Pe=255,ze=255;if(_e.startsWith("#")){const Ve=_e.replace(/^#/,""),Ce=parseInt(Ve.length===3?Ve.split("").map(Je=>Je+Je).join(""):Ve,16);me=Ce>>16&255,Pe=Ce>>8&255,ze=Ce&255}else if(/rgba?\(/i.test(_e)){const Ve=_e.match(/rgba?\(([^)]+)\)/i);if(Ve){const Ce=Ve[1].split(",").map(Je=>parseFloat(Je.trim()));me=Ce[0]??me,Pe=Ce[1]??Pe,ze=Ce[2]??ze}}const he=.299*me+.587*Pe+.114*ze,De=he>186?"#CBD5E1":"#4B5563",ge=he>186?"rgba(255,255,255,0.7)":"rgba(17,24,39,0.6)",be=Ve=>{var He,Ie;const Je=((A==null?void 0:A.shortName)||(A==null?void 0:A.ticker)||(A==null?void 0:A.name)||""||"").toString().trim().charAt(0).toUpperCase(),ye=2,Ae=Math.max(8,Y-ye*2),ee=Bd(Je,Ae,Z.weight,Z.family),xe=Math.max(0,Math.floor((Y-ye*2-ee)/2)),ke=ye;(He=this.createFigure({name:"rect",attrs:{x:Ve,y:Q,width:Y,height:Y},styles:{style:"stroke_fill",color:ge,borderColor:De,borderSize:1,borderRadius:Y/2}}))==null||He.draw(t),(Ie=this.createFigure({name:"text",attrs:{x:Ve+ye,y:Q+ye,text:Je,width:Y-ye*2,height:Y-ye*2},styles:{backgroundColor:ge,borderRadius:(Y-ye*2)/2,size:Ae,family:Z.family,weight:Z.weight,color:De,paddingLeft:xe,paddingTop:ke,paddingRight:0,paddingBottom:0}}))==null||Ie.draw(t)};let $e=Y;q.forEach((Ve,Ce)=>{var ye,Ae;const Je=Math.floor(K+(Ce===0?0:Y-8));if(Ve){if(!this._logoSubscribed[Ve]){this._logoSubscribed[Ve]=!0;try{p6(Ve,()=>{try{this.getWidget().getPane().getChart().updatePane(Ol.Overlay,La.CANDLE)}catch{}})}catch{}}q_(Ve);let ee=c6(Ve)||this._logoCache[Ve];ee.complete&&ee.naturalWidth>0?((ye=this.createFigure({name:"rect",attrs:{x:Je,y:Q,width:Y,height:Y},styles:{style:"stroke_fill",color:ge,borderColor:De,borderSize:1,borderRadius:Y/2}}))==null||ye.draw(t),(Ae=this.createFigure({name:"image",attrs:{x:Je+2,y:Q+2,width:Y-4,height:Y-4,image:ee,borderRadius:(Y-4)/2},styles:{}}))==null||Ae.draw(t)):be(Je)}else be(Je)}),$e=q.length===2?Y*2-8:Y,Z.marginLeft=(Z.marginLeft??0)+$e+6}catch{}const le=this.drawStandardTooltipLegends(t,[{title:{text:"",color:G},value:{text:U,color:G}}],_,s,0,typeof window<"u"&&window.innerWidth<=768?r-(A!=null&&A.logo2?20*2-6:20):r,Z);p=Math.max(p,le)}const S=this._getCandleTooltipLegends(),L=this.classifyTooltipFeatures(d.features);p=this.drawStandardTooltipFeatures(t,L[0],_,null,s,p,r),p=this.drawStandardTooltipFeatures(t,L[1],_,null,s,p,r);try{typeof window<"u"&&window.innerWidth<=768&&(_.x=s,_.y+=p,p=0)}catch{}if(S.length>0){let T={...v};try{if(typeof window<"u"&&window.innerWidth<=768){let F=T.size;const B=T.family,R=T.weight;let N=T.marginLeft??0,$=T.marginRight??0;for(N=Math.min(N,4),$=Math.min($,4),T.marginLeft=N,T.marginRight=$;F>8;){t.font=qp(F,R,B);let V=0;if(S.forEach(U=>{const G=U.title,Z=U.value,le=G.text.length>0?t.measureText(G.text).width:0,se=t.measureText(Z.text).width,ie=G.text.length>0&&Z.text.length>0?2:0;V+=N+le+ie+se+$}),_.x+V<=r)break;F-=1}T.size=F}}catch{}const P={...T,marginTop:Math.max(T.marginTop??0,Math.floor((p-T.size)/2))};p=this.drawStandardTooltipLegends(t,S,_,s,p,r,P)}p=this.drawStandardTooltipFeatures(t,L[2],_,null,s,p,r)}return _.y+p}_drawRectTooltip(t,s,i,r){var k;const a=this.getWidget(),l=a.getPane(),d=l.getChart().getChartStore(),v=d.getStyles(),p=v.candle,_=v.indicator,y=p.tooltip,w=_.tooltip;if(s||i){const S=this._getCandleTooltipLegends(),{offsetLeft:L,offsetTop:T,offsetRight:P,offsetBottom:A}=y,{marginLeft:F,marginRight:B,marginTop:R,marginBottom:N,size:$,weight:V,family:U}=y.legend,{position:G,paddingLeft:Z,paddingRight:le,paddingTop:se,paddingBottom:ie,offsetLeft:Y,offsetRight:K,offsetTop:Q,offsetBottom:q,borderSize:ce,borderRadius:_e,borderColor:me,color:Pe}=y.rect;let ze=0,he=0,De=0;s&&(t.font=qp($,V,U),S.forEach(ee=>{const xe=ee.title,ke=ee.value,He=`${xe.text}${ke.text}`,Ie=t.measureText(He).width+F+B;ze=Math.max(ze,Ie)}),De+=(N+R+$)*S.length);const{marginLeft:ge,marginRight:be,marginTop:$e,marginBottom:Ve,size:Ce,weight:Je,family:ye}=w.legend,Ae=[];if(i){const ee=d.getIndicatorsByPaneId(l.getId());t.font=qp(Ce,Je,ye),ee.forEach(xe=>{const ke=this.getIndicatorTooltipData(xe).legends;Ae.push(ke),ke.forEach(He=>{const Ie=He.title,ne=He.value,J=`${Ie.text}${ne.text}`,qe=t.measureText(J).width+ge+be;ze=Math.max(ze,qe),De+=$e+Ve+Ce})})}if(he+=ze,he!==0&&De!==0){const ee=d.getCrosshair(),xe=a.getBounding(),ke=l.getYAxisWidget().getBounding();he+=ce*2+Z+le,De+=ce*2+se+ie;const He=xe.width/2,Ie=G==="pointer"&&ee.paneId===La.CANDLE,ne=(ee.realX??0)>He;let J=0;if(Ie){const Oe=ee.realX;ne?J=Oe-K-he:J=Oe+Y}else{const Oe=this.getWidget().getPane().getAxisComponent();ne?(J=Y+L,Oe.inside&&Oe.position==="left"&&(J+=ke.width)):(J=xe.width-K-he-P,Oe.inside&&Oe.position==="right"&&(J-=ke.width))}let qe=r+Q;Ie&&(qe=ee.y-De/2,qe+De>xe.height-q-A&&(qe=xe.height-q-De-A),qe<r+Q&&(qe=r+Q+T)),(k=this.createFigure({name:"rect",attrs:{x:J,y:qe,width:he,height:De},styles:{style:"stroke_fill",color:Pe,borderColor:me,borderSize:ce,borderRadius:_e}}))==null||k.draw(t);const ft=J+ce+Z+F;let Qe=qe+ce+se;if(s&&S.forEach(Oe=>{var It,zt;Qe+=R;const ct=Oe.title;(It=this.createFigure({name:"text",attrs:{x:ft,y:Qe,text:ct.text},styles:{color:ct.color,size:$,family:U,weight:V}}))==null||It.draw(t);const Lt=Oe.value;(zt=this.createFigure({name:"text",attrs:{x:J+he-ce-B-le,y:Qe,text:Lt.text,align:"right"},styles:{color:Lt.color,size:$,family:U,weight:V}}))==null||zt.draw(t),Qe+=$+N}),i){const Oe=J+ce+Z+ge;Ae.forEach(ct=>{ct.forEach(Lt=>{var pt,Mo;Qe+=$e;const It=Lt.title,zt=Lt.value;(pt=this.createFigure({name:"text",attrs:{x:Oe,y:Qe,text:It.text},styles:{color:It.color,size:Ce,family:ye,weight:Je}}))==null||pt.draw(t),(Mo=this.createFigure({name:"text",attrs:{x:J+he-ce-be-le,y:Qe,text:zt.text,align:"right"},styles:{color:zt.color,size:Ce,family:ye,weight:Je}}))==null||Mo.draw(t),Qe+=Ce+Ve})})}}}}_getCandleTooltipLegends(){const t=this.getWidget().getPane().getChart().getChartStore(),s=t.getStyles().candle,i=t.getDataList(),r=t.getInnerFormatter(),a=t.getDecimalFold(),l=t.getThousandsSeparator(),d=t.getLocale(),{pricePrecision:v=Nd.PRICE,volumePrecision:p=Nd.VOLUME}=t.getSymbol()??{},_=t.getPeriod(),y=t.getCrosshair().dataIndex??0,w=t.getSymbol(),S=((w==null?void 0:w.type)||"").toLowerCase()==="stock",T=s.tooltip.legend,{color:P,defaultValue:A}=T,F=T.template,B=i[y-1]??null,R=i[y],N=(B==null?void 0:B.close)??R.close,$=R.close-N,V={...R,time:r.formatDate(R.timestamp,Q2[(_==null?void 0:_.type)??"day"],"tooltip"),open:a.format(l.format(jd(R.open,v))),high:a.format(l.format(jd(R.high,v))),low:a.format(l.format(jd(R.low,v))),close:a.format(l.format(jd(R.close,v))),volume:a.format(l.format(r.formatBigNumber(jd(R.volume??A,p)))),turnover:a.format(l.format(jd(R.turnover??A,v))),change:N===0?A:`${l.format(jd($/N*100))}%`},U=du(F)?F({prev:B,current:R,next:i[y+1]??null},s):F;return(S?U:U.filter(Z=>{const le=Cu(Z.title)?Z.title.text:Z.title,se=Cu(Z.value)?Z.value.text:Z.value,ie=(le||"").toString().trim().toLowerCase(),Y=(se||"").toString();return!(ie==="volume"||/\{volume\}/i.test(Y))})).map(Z=>{const{title:le,value:se}=Z;let ie={text:"",color:P};Cu(le)?ie=le:ie.text=le,ie.text=l6(ie.text,d);let Y={text:A,color:P};return Cu(se)?Y=se:Y.text=se,mo(/{change}/.exec(Y.text))&&(Y.color=$===0?s.priceMark.last.noChangeColor:$>0?s.priceMark.last.upColor:s.priceMark.last.downColor),Y.text=q1(Y.text,V),{title:ie,value:Y}})}}class f6 extends Wu{constructor(t){super(t);re(this,"_activeFeatureInfo",null);re(this,"_featureClickEvent",t=>()=>(this.getWidget().getPane().getChart().getChartStore().executeAction("onCrosshairFeatureClick",t),!0));re(this,"_featureMouseMoveEvent",t=>()=>(this._activeFeatureInfo=t,this.getWidget().setForceCursor("pointer"),!0));this.registerEvent("mouseMoveEvent",s=>(this._activeFeatureInfo=null,this.getWidget().setForceCursor(null),!1))}drawImp(t){var v;const s=this.getWidget(),i=s.getPane(),r=s.getPane().getChart().getChartStore(),a=r.getCrosshair(),l=this.getWidget(),d=l.getPane().getAxisComponent();if(Dl(a.paneId)&&a.paneId===i.getId()&&d.isInCandle()){const p=r.getStyles().crosshair,_=p.horizontal.features;if(p.show&&p.horizontal.show&&_.length>0){const y=d.position==="right",w=l.getBounding();let k=0;const S=p.horizontal.text;if(d.inside&&S.show){const P=d.convertFromPixel(a.y),A=d.getRange();let F=d.displayValueToText(d.realValueToDisplayValue(d.valueToRealValue(P,{range:A}),{range:A}),((v=r.getSymbol())==null?void 0:v.pricePrecision)??Nd.PRICE);F=r.getDecimalFold().format(r.getThousandsSeparator().format(F)),k=S.paddingLeft+Bd(F,S.size,S.weight,S.family)+S.paddingRight}let L=k;y&&(L=w.width-k);const T=a.y;_.forEach(P=>{var me,Pe,ze,he;const{marginLeft:A=0,marginTop:F=0,marginRight:B=0,paddingLeft:R=0,paddingTop:N=0,paddingRight:$=0,paddingBottom:V=0,color:U,activeColor:G,backgroundColor:Z,activeBackgroundColor:le,borderRadius:se,size:ie=0,type:Y,content:K}=P;let Q=ie;if(Y==="icon_font"){const De=K;Q=R+Bd(De.code,ie,"normal",De.family)+$}y?L-=Q+B:L+=A;let q=U,ce=Z;((me=this._activeFeatureInfo)==null?void 0:me.feature.id)===P.id&&(q=G??U,ce=le??Z);const _e={mouseClickEvent:this._featureClickEvent({crosshair:a,feature:P}),mouseMoveEvent:this._featureMouseMoveEvent({crosshair:a,feature:P})};if(Y==="icon_font"){const De=K;(Pe=this.createFigure({name:"text",attrs:{text:De.code,x:L,y:T+F,baseline:"middle"},styles:{paddingLeft:R,paddingTop:N,paddingRight:$,paddingBottom:V,borderRadius:se,size:ie,family:De.family,color:q,backgroundColor:ce}},_e))==null||Pe.draw(t)}else{(ze=this.createFigure({name:"rect",attrs:{x:L,y:T+F-ie/2,width:ie,height:ie},styles:{paddingLeft:R,paddingTop:N,paddingRight:$,paddingBottom:V,color:ce}},_e))==null||ze.draw(t);const De=K;(he=this.createFigure({name:"path",attrs:{path:De.path,x:L,y:T+F+N-ie/2,width:ie,height:ie},styles:{style:De.style,lineWidth:De.lineWidth,color:q}}))==null||he.draw(t)}y?L-=A:L+=Q+B})}}}}class g6 extends J2{constructor(t,s){super(t,s);re(this,"_candleBarView",new K2(this));re(this,"_candleAreaView",new t6(this));re(this,"_candleHighLowPriceView",new o6(this));re(this,"_candleLastPriceLineView",new s6(this));re(this,"_crosshairFeatureView",new f6(this));this.addChild(this._candleBarView),this.addChild(this._crosshairFeatureView)}updateMainContent(t){this.getPane().getChart().getStyles().candle.type!=="area"?(this._candleBarView.draw(t),this._candleHighLowPriceView.draw(t),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(t),this._candleLastPriceLineView.draw(t)}updateOverlayContent(t){this._crosshairFeatureView.draw(t)}createTooltipView(){return new v6(this)}}class tb extends Wu{drawImp(e,t){var d,v;const s=this.getWidget(),i=s.getPane(),r=s.getBounding(),a=i.getAxisComponent(),l=this.getAxisStyles(i.getChart().getStyles());if(l.show&&(l.axisLine.show&&((d=this.createFigure({name:"line",attrs:this.createAxisLine(r,l),styles:l.axisLine}))==null||d.draw(e)),!t[0])){const p=a.getTicks();if(l.tickLine.show&&this.createTickLines(p,r,l).forEach(y=>{var w;(w=this.createFigure({name:"line",attrs:y,styles:l.tickLine}))==null||w.draw(e)}),l.tickText.show){const _=this.createTickTexts(p,r,l);(v=this.createFigure({name:"text",attrs:_,styles:l.tickText}))==null||v.draw(e)}}}}class m6 extends tb{getAxisStyles(e){return e.yAxis}createAxisLine(e,t){const s=this.getWidget().getPane().getAxisComponent(),i=t.axisLine.size;let r=0;return s.isFromZero()?r=0:r=e.width-i,{coordinates:[{x:r,y:0},{x:r,y:e.height}]}}createTickLines(e,t,s){const i=this.getWidget().getPane().getAxisComponent(),r=s.axisLine,a=s.tickLine;let l=0,d=0;return i.isFromZero()?(l=0,r.show&&(l+=r.size),d=l+a.length):(l=t.width,r.show&&(l-=r.size),d=l-a.length),e.map(v=>({coordinates:[{x:l,y:v.coord},{x:d,y:v.coord}]}))}createTickTexts(e,t,s){const i=this.getWidget().getPane().getAxisComponent(),r=s.axisLine,a=s.tickLine,l=s.tickText;let d=0;i.isFromZero()?(d=l.marginStart,r.show&&(d+=r.size),a.show&&(d+=a.length)):(d=t.width-l.marginEnd,r.show&&(d-=r.size),a.show&&(d-=a.length));const v=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return e.map(p=>({x:d,y:p.coord,text:p.text,align:v,baseline:"middle"}))}}class h6 extends Wu{drawImp(e){var v,p,_,y,w,k;const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=s.getChart().getChartStore(),a=r.getStyles().candle.priceMark,l=a.last,d=l.text;if(a.show&&l.show&&d.show){const S=r.getStyles().yAxis,L=S.axisLine.show?S.axisLine.size:0,T=S.tickLine.show?S.tickLine.length:0,P=S.tickText.marginStart,A=S.tickText.marginEnd,F=1,B=((v=r.getSymbol())==null?void 0:v.pricePrecision)??Nd.PRICE,R=s.getAxisComponent(),N=r.getVisibleRangeDataList(),$=R.position==="right"?N.length-1:0,V=r.getDataList(),U=V[V.length-1];if(mo(U)){const{close:G,open:Z}=U,le=l.compareRule==="current_open"?Z:((p=V[V.length-2])==null?void 0:p.close)??G,se=R.convertToPixel(G);let ie="";G>le?ie=l.upColor:G<le?ie=l.downColor:ie=l.noChangeColor;let Y=0,K="left";const Q={...d};if(R.isFromZero())Y=L+F,K="left",Q.paddingLeft=T+P-F;else{Y=i.width-L-F,K="right";const xe=i.width-L-F,ke=i.width-(S.axisLine.show?S.axisLine.size:0)-(S.tickLine.show?S.tickLine.length:0)-A;Q.paddingRight=xe-ke}const q=[],ce=R.getRange();let _e=R.displayValueToText(R.realValueToDisplayValue(R.valueToRealValue(G,{range:ce}),{range:ce}),B);_e=r.getDecimalFold().format(r.getThousandsSeparator().format(_e));const{paddingLeft:me,paddingRight:Pe,paddingTop:ze,paddingBottom:he,size:De,family:ge,weight:be}=Q;let $e=me+Bd(_e,De,be,ge)+Pe;const Ve=ze+De+he;q.push({name:"text",attrs:{x:Y,y:se,width:$e,height:Ve,text:_e,align:K,baseline:"middle"},styles:{...Q,backgroundColor:ie}});const Ce=r.getInnerFormatter().formatExtendText,Je=De/2;let ye=se-Je-ze,Ae=se+Je+he;l.extendTexts.forEach((xe,ke)=>{const He=Ce({type:"last_price",data:U,index:ke});if(He.length>0&&xe.show){const Ie=xe.size/2;let ne=0;xe.position==="above_price"?(ye-=xe.paddingBottom+Ie,ne=ye,ye-=Ie+xe.paddingTop):(Ae+=xe.paddingTop+Ie,ne=Ae,Ae+=Ie+xe.paddingBottom),$e=Math.max($e,xe.paddingLeft+Bd(He,xe.size,xe.weight,xe.family)+xe.paddingRight),q.push({name:"text",attrs:{x:Y,y:ne,width:$e,height:xe.paddingTop+xe.size+xe.paddingBottom,text:He,align:K,baseline:"middle"},styles:{...xe,backgroundColor:ie}})}});const ee=(_=N[$])==null?void 0:_.data.current;if(mo(ee)&&ee.timestamp!==U.timestamp){const{close:xe,open:ke}=ee,He=R.position==="right"?(y=N[$-1])==null?void 0:y.data.current:(w=N[$+1])==null?void 0:w.data.current,Ie=l.compareRule==="current_open"?ke:(He==null?void 0:He.close)??((k=V[V.length-2])==null?void 0:k.close)??xe,ne=R.convertToPixel(xe);let J="";xe>Ie?J=l.upColor:xe<Ie?J=l.downColor:J=l.noChangeColor;let qe=R.displayValueToText(R.realValueToDisplayValue(R.valueToRealValue(xe,{range:ce}),{range:ce}),B);qe=r.getDecimalFold().format(r.getThousandsSeparator().format(qe));let ft=me+Bd(qe,De,be,ge)+Pe;const Qe=ze+De+he;q.push({name:"text",attrs:{x:Y,y:ne,width:ft,height:Qe,text:qe,align:K,baseline:"middle"},styles:{...Q,backgroundColor:J}});const Oe=De/2;let ct=ne-Oe-ze,Lt=ne+Oe+he;l.extendTexts.forEach((It,zt)=>{const pt=Ce({type:"last_price",data:ee,index:zt});if(pt.length>0&&It.show){const Mo=It.size/2;let Xo=0;It.position==="above_price"?(ct-=It.paddingBottom+Mo,Xo=ct,ct-=Mo+It.paddingTop):(Lt+=It.paddingTop+Mo,Xo=Lt,Lt+=Mo+It.paddingBottom),ft=Math.max(ft,It.paddingLeft+Bd(pt,It.size,It.weight,It.family)+It.paddingRight),q.push({name:"text",attrs:{x:Y,y:Xo,width:ft,height:It.paddingTop+It.size+It.paddingBottom,text:pt,align:K,baseline:"middle"},styles:{...It,backgroundColor:J}})}})}q.forEach(xe=>{var ke;(ke=this.createFigure(xe))==null||ke.draw(e)})}}}}class _6 extends Wu{drawImp(e){var v,p;const t=this.getWidget(),s=t.getPane(),i=t.getBounding(),r=s.getChart().getChartStore(),a=r.getStyles().indicator,l=a.lastValueMark,d=l.text;if(l.show){const _=r.getStyles().yAxis,y=_.axisLine.show?_.axisLine.size:0,w=_.tickLine.show?_.tickLine.length:0,k=_.tickText.marginStart,S=_.tickText.marginEnd,L=1,T=s.getAxisComponent(),P=T.getRange(),A=r.getVisibleRangeDataList(),F=T.position==="right"?A.length-1:0,B=r.getDataList(),R=((v=A[F])==null?void 0:v.data.current)??B[B.length-1]??{},N=((p=A[F-(T.position==="right"?1:-1)])==null?void 0:p.data.current)??B[B.length-2]??{},$=r.getIndicatorsByPaneId(s.getId()),V=r.getInnerFormatter(),U=r.getDecimalFold(),G=r.getThousandsSeparator();$.forEach(Z=>{const le=Z.result,se=le[R.timestamp]??le[N.timestamp]??{};if(mo(se)&&Z.visible){const ie=Z.precision;i1(Z,{prev:N.timestamp,current:R.timestamp,next:null},a,(Y,K)=>{var q;const Q=se[Y.key];if(xr(Q)){const ce=T.convertToPixel(Q);let _e=T.displayValueToText(T.realValueToDisplayValue(T.valueToRealValue(Q,{range:P}),{range:P}),ie);Z.shouldFormatBigNumber&&(_e=V.formatBigNumber(_e)),_e=U.format(G.format(_e));let me=0,Pe="left";const ze={...d};if(T.isFromZero())me=y+L,Pe="left",ze.paddingLeft=w+k-L;else{me=i.width-y-L,Pe="right";const he=i.width-y-L,De=i.width-(_.axisLine.show?_.axisLine.size:0)-(_.tickLine.show?_.tickLine.length:0)-S;ze.paddingRight=he-De}(q=this.createFigure({name:"text",attrs:{x:me,y:ce,text:_e,align:Pe,baseline:"middle"},styles:{...ze,backgroundColor:K.color}}))==null||q.draw(e)}})}})}}}class ob extends X2{coordinateToPointTimestampDataIndexFlag(){return!1}drawDefaultFigures(e,t,s){this.drawFigures(e,t,this.getDefaultFigures(t,s))}getDefaultFigures(e,t){var d;const s=this.getWidget(),i=s.getPane(),r=i.getChart().getChartStore(),a=r.getClickOverlayInfo(),l=[];if(e.needDefaultYAxisFigure&&e.id===((d=a.overlay)==null?void 0:d.id)&&a.paneId===i.getId()){const v=i.getAxisComponent(),p=s.getBounding();let _=Number.MAX_SAFE_INTEGER,y=Number.MIN_SAFE_INTEGER;const w=v.isFromZero();let k="left",S=0;w?(k="left",S=0):(k="right",S=p.width);const L=r.getDecimalFold(),T=r.getThousandsSeparator();t.forEach((P,A)=>{var B;const F=e.points[A];if(xr(F.value)){_=Math.min(_,P.y),y=Math.max(y,P.y);const R=L.format(T.format(jd(F.value,((B=r.getSymbol())==null?void 0:B.pricePrecision)??Nd.PRICE)));l.push({type:"text",attrs:{x:S,y:P.y,text:R,align:k,baseline:"middle"},ignoreEvent:!0})}}),t.length>1&&l.unshift({type:"rect",attrs:{x:0,y:_,width:p.width,height:y-_},ignoreEvent:!0})}return l}getFigures(e,t){var v;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),a=i.getAxisComponent(),l=r.getXAxisPane().getAxisComponent(),d=s.getBounding();return((v=e.createYAxisFigures)==null?void 0:v.call(e,{chart:r,overlay:e,coordinates:t,bounding:d,xAxis:l,yAxis:a}))??[]}}class sb extends Wu{drawImp(e){var a;const t=this.getWidget(),s=t.getPane(),i=t.getPane().getChart().getChartStore(),r=i.getCrosshair();if(Dl(r.paneId)&&this.compare(r,s.getId())){const l=i.getStyles().crosshair;if(l.show){const d=this.getDirectionStyles(l),v=d.text;if(d.show&&v.show){const p=t.getBounding(),_=s.getAxisComponent(),y=this.getText(r,i,_),w=i.getStyles().yAxis,k=w.axisLine.show?w.axisLine.size:0,S=w.tickLine.show?w.tickLine.length:0,L=w.tickText.marginStart,T=w.tickText.marginEnd,P=1,A=_,F={...v};if(A.isFromZero())F.paddingLeft=S+L-P;else{const B=p.width-k-P,R=p.width-(w.axisLine.show?w.axisLine.size:0)-(w.tickLine.show?w.tickLine.length:0)-T;F.paddingRight=B-R}e.font=qp(F.size,F.weight,F.family),(a=this.createFigure({name:"text",attrs:this.getTextAttrs(y,e.measureText(y).width,r,p,_,F),styles:F}))==null||a.draw(e)}}}}compare(e,t){return e.paneId===t}getDirectionStyles(e){return e.horizontal}getText(e,t,s){var p;const i=s,r=s.convertFromPixel(e.y);let a=0,l=!1;i.isInCandle()?a=((p=t.getSymbol())==null?void 0:p.pricePrecision)??Nd.PRICE:t.getIndicatorsByPaneId(e.paneId).forEach(y=>{a=Math.max(y.precision,a),l||(l=y.shouldFormatBigNumber)});const d=i.getRange();let v=i.displayValueToText(i.realValueToDisplayValue(i.valueToRealValue(r,{range:d}),{range:d}),a);return l&&(v=t.getInnerFormatter().formatBigNumber(v)),t.getDecimalFold().format(t.getThousandsSeparator().format(v))}getTextAttrs(e,t,s,i,r,a){const l=r,d=this.getWidget().getPane().getChart().getStyles(),v=d.yAxis.axisLine.show?d.yAxis.axisLine.size:0,p=1;let _=0,y="left";return l.isFromZero()?(_=v+p,y="left"):(_=i.width-v-p,y="right"),{x:_,y:s.y,text:e,align:y,baseline:"middle"}}}class y6 extends d1{constructor(t,s){super(t,s);re(this,"_yAxisView",new m6(this));re(this,"_candleLastPriceLabelView",new h6(this));re(this,"_indicatorLastValueView",new _6(this));re(this,"_overlayYAxisView",new ob(this));re(this,"_crosshairHorizontalLabelView",new sb(this));this.setCursor("ns-resize"),this.addChild(this._overlayYAxisView)}getName(){return Ra.Y_AXIS}updateMain(t){const s=this.getPane().getOptions().state==="minimize";this._yAxisView.draw(t,s),s||(this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t))}updateOverlay(t){this.getPane().getOptions().state!=="minimize"&&(this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t))}}function sy(){return{from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0,displayFrom:0,displayTo:0,displayRange:0}}class nb{constructor(e){re(this,"name");re(this,"scrollZoomEnabled",!0);re(this,"createTicks");re(this,"_parent");re(this,"_range",sy());re(this,"_prevRange",sy());re(this,"_ticks",[]);re(this,"_autoCalcTickFlag",!0);this._parent=e}getParent(){return this._parent}buildTicks(e){if(this._autoCalcTickFlag&&(this._range=this.createRangeImp()),this._prevRange.from!==this._range.from||this._prevRange.to!==this._range.to||e){this._prevRange=this._range;const t=typeof performance<"u"?performance.now():Date.now();this._ticks=this.createTicksImp();const i=(typeof performance<"u"?performance.now():Date.now())-t;return i>20&&console.warn("⚠️ klinecharts: axis createTicks slow",{name:this.name,durationMs:Math.round(i)}),!0}return!1}getTicks(){return this._ticks}setRange(e){this._autoCalcTickFlag=!1,this._range=e}getRange(){return this._range}setAutoCalcTickFlag(e){this._autoCalcTickFlag=e}getAutoCalcTickFlag(){return this._autoCalcTickFlag}}const u_=8;class lf extends nb{constructor(t,s){super(t);re(this,"reverse",!1);re(this,"inside",!1);re(this,"position","right");re(this,"gap",{top:.2,bottom:.1});re(this,"createRange",t=>t.defaultRange);re(this,"minSpan",t=>Iv(-t));re(this,"valueToRealValue",t=>t);re(this,"realValueToDisplayValue",t=>t);re(this,"displayValueToRealValue",t=>t);re(this,"realValueToValue",t=>t);re(this,"displayValueToText",(t,s)=>jd(t,s));this.override(s)}override(t){const{name:s,gap:i,...r}=t;Dl(this.name)||(this.name=s),rd(this.gap,i),rd(this,r)}createRangeImp(){var ce;const t=this.getParent(),s=t.getChart(),i=s.getChartStore(),r=t.getId();let a=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,d=!1,v=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,_=Number.MAX_SAFE_INTEGER;const y=i.getIndicatorsByPaneId(r);y.forEach(_e=>{d||(d=_e.shouldOhlc),_=Math.min(_,_e.precision),xr(_e.minValue)&&(v=Math.min(v,_e.minValue)),xr(_e.maxValue)&&(p=Math.max(p,_e.maxValue))});let w=4;const k=this.isInCandle();if(k){const _e=((ce=i.getSymbol())==null?void 0:ce.pricePrecision)??Nd.PRICE;_!==Number.MAX_SAFE_INTEGER?w=Math.min(_,_e):w=_e}else _!==Number.MAX_SAFE_INTEGER&&(w=_);const S=i.getVisibleRangeDataList(),L=s.getStyles().candle,T=L.type==="area",P=L.area.value,A=k&&!T||!k&&d;S.forEach(_e=>{const me=_e.data.current;if(mo(me)){if(A&&(a=Math.min(a,me.low),l=Math.max(l,me.high)),k&&T){const Pe=me[P];xr(Pe)&&(a=Math.min(a,Pe),l=Math.max(l,Pe))}y.forEach(({result:Pe,figures:ze})=>{const he=Pe[me.timestamp]??{};ze.forEach(De=>{const ge=he[De.key];xr(ge)&&(a=Math.min(a,ge),l=Math.max(l,ge))})})}}),a!==Number.MAX_SAFE_INTEGER&&l!==Number.MIN_SAFE_INTEGER?(a=Math.min(v,a),l=Math.max(p,l)):(a=0,l=10);const F=l-a,B={from:a,to:l,range:F,realFrom:a,realTo:l,realRange:F,displayFrom:a,displayTo:l,displayRange:F},R=this.createRange({chart:s,paneId:r,defaultRange:B});let N=R.realFrom,$=R.realTo,V=R.realRange;const U=this.minSpan(w);if(N===$||V<U){const _e=v===N,me=p===$,Pe=u_/2;N=_e?N:me?N-u_*U:N-Pe*U,$=me?$:_e?$+u_*U:$+Pe*U}const G=this.getBounding().height,{top:Z,bottom:le}=this.gap;let se=Z;se>=1&&(se=se/G);let ie=le;ie>=1&&(ie=ie/G),V=$-N,N=N-V*ie,$=$+V*se;const Y=this.realValueToValue(N,{range:R}),K=this.realValueToValue($,{range:R}),Q=this.realValueToDisplayValue(N,{range:R}),q=this.realValueToDisplayValue($,{range:R});return{from:Y,to:K,range:K-Y,realFrom:N,realTo:$,realRange:$-N,displayFrom:Q,displayTo:q,displayRange:q-Q}}isInCandle(){return this.getParent().getId()===La.CANDLE}isFromZero(){return this.position==="left"&&this.inside||this.position==="right"&&!this.inside}createTicksImp(){var se,ie;const t=this.getRange(),{displayFrom:s,displayTo:i}=t,r=this.getParent(),a=((se=r.getYAxisWidget())==null?void 0:se.getBounding().height)??0,l=40,d=80,v=60,p=a/Math.max(1e-12,t.realRange),_=v/Math.max(1e-12,p),y=[1,2,5];let w=_,k=Number.MAX_VALUE,S=0;for(let Y=-12;Y<=12;Y++){const K=Math.pow(10,Y);for(const Q of y){const q=Q*K,ce=q*p,_e=ce>=l&&ce<=d,me=Math.abs(ce-v);_e&&me<k&&(k=me,w=q,S=ce),!_e&&me<k&&w===_&&(k=me,w=q,S=ce)}}let L=w;S<l?L=Y1(l/Math.max(1e-12,p)):S>d&&(L=Y1(d/Math.max(1e-12,p)));const T=p3(L),P=[];if(L>0){let Y=U1(Math.ceil(s/L)*L,T);const K=U1(Math.floor(i/L)*L,T),Q=Math.ceil(a/l)+2;let q=0;for(;Y<=K&&q<Q;){const ce=Y.toFixed(T);P.push({text:ce,coord:0,value:ce}),Y+=L,q+=1}}const A=r.getChart().getChartStore(),F=[],B=A.getIndicatorsByPaneId(r.getId()),R=A.getStyles();let N=0,$=!1;this.isInCandle()?N=((ie=A.getSymbol())==null?void 0:ie.pricePrecision)??Nd.PRICE:B.forEach(Y=>{N=Math.max(N,Y.precision),$||($=Y.shouldFormatBigNumber)});const V=A.getInnerFormatter(),U=A.getThousandsSeparator(),G=A.getDecimalFold(),Z=R.xAxis.tickText.size;let le=NaN;return P.forEach(({value:Y})=>{let K=this.displayValueToText(+Y,N);const Q=this.convertToPixel(this.realValueToValue(this.displayValueToRealValue(+Y,{range:t}),{range:t}));$&&(K=V.formatBigNumber(Y)),K=G.format(U.format(K));const q=xr(le);Q>Z&&Q<a-Z&&(q&&Math.abs(le-Q)>Z*2||!q)&&(F.push({text:K,coord:Q,value:Y}),le=Q)}),du(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:F}):F}getAutoSize(){var S;const t=this.getParent(),i=t.getChart().getChartStore(),r=i.getStyles(),a=r.yAxis,l=a.size;if(l!=="auto")return l;let d=0;if(a.show&&(a.axisLine.show&&(d+=a.axisLine.size),a.tickLine.show&&(d+=a.tickLine.length),a.tickText.show)){let L=0;this.getTicks().forEach(T=>{L=Math.max(L,Bd(T.text,a.tickText.size,a.tickText.weight,a.tickText.family))}),d+=a.tickText.marginStart+a.tickText.marginEnd+L}const v=r.candle.priceMark,p=v.show&&v.last.show&&v.last.text.show;let _=0;const y=r.crosshair,w=y.show&&y.horizontal.show&&y.horizontal.text.show;let k=0;if(p||w){const L=((S=i.getSymbol())==null?void 0:S.pricePrecision)??Nd.PRICE,T=this.getRange().displayTo;if(p){const P=i.getDataList(),A=P[P.length-1];if(mo(A)){const{paddingLeft:F,paddingRight:B,size:R,family:N,weight:$}=v.last.text;_=F+Bd(jd(A.close,L),R,$,N)+B;const V=i.getInnerFormatter().formatExtendText;v.last.extendTexts.forEach((U,G)=>{const Z=V({type:"last_price",data:A,index:G});Z.length>0&&U.show&&(_=Math.max(_,U.paddingLeft+Bd(Z,U.size,U.weight,U.family)+U.paddingRight))})}}if(w){const P=i.getIndicatorsByPaneId(t.getId());let A=0,F=!1;P.forEach(N=>{A=Math.max(N.precision,A),F||(F=N.shouldFormatBigNumber)});let B=2;if(this.isInCandle()){const N=r.indicator.lastValueMark;N.show&&N.text.show?B=Math.max(A,L):B=L}else B=A;let R=jd(T,B);F&&(R=i.getInnerFormatter().formatBigNumber(R)),R=i.getDecimalFold().format(R),k+=y.horizontal.text.paddingLeft+y.horizontal.text.paddingRight+y.horizontal.text.borderSize*2+Bd(R,y.horizontal.text.size,y.horizontal.text.weight,y.horizontal.text.family)}}return Math.max(d,_,k)}getBounding(){return this.getParent().getYAxisWidget().getBounding()}convertFromPixel(t){const s=this.getBounding().height,i=this.getRange(),{realFrom:r,realRange:a}=i,d=(this.reverse?t/s:1-t/s)*a+r;return this.realValueToValue(d,{range:i})}convertToPixel(t){var v;const s=this.getRange(),i=this.valueToRealValue(t,{range:s}),r=((v=this.getParent().getYAxisWidget())==null?void 0:v.getBounding().height)??0,{realFrom:a,realRange:l}=s,d=(i-a)/l;return this.reverse?Math.round(d*r):Math.round((1-d)*r)}convertToNicePixel(t){var r;const s=((r=this.getParent().getYAxisWidget())==null?void 0:r.getBounding().height)??0,i=this.convertToPixel(t);return Math.round(Math.max(s*.05,Math.min(i,s*.98)))}static extend(t){class s extends lf{constructor(r){super(r,t)}}return s}}const b6={name:"normal"},x6={name:"percentage",minSpan:()=>Math.pow(10,-2),displayValueToText:o=>`${jd(o,2)}%`,valueToRealValue:(o,{range:e})=>(o-e.from)/e.range*e.realRange+e.realFrom,realValueToValue:(o,{range:e})=>(o-e.realFrom)/e.realRange*e.range+e.from,createRange:({chart:o,defaultRange:e})=>{const t=o.getDataList(),s=o.getVisibleRange(),i=t[s.from];if(mo(i)){const{from:r,to:a,range:l}=e,d=(e.from-i.close)/i.close*100,v=(e.to-i.close)/i.close*100,p=v-d;return{from:r,to:a,range:l,realFrom:d,realTo:v,realRange:p,displayFrom:d,displayTo:v,displayRange:p}}return e}},w6={name:"logarithm",minSpan:o=>.05*Iv(-o),valueToRealValue:o=>o<0?-zp(Math.abs(o)):zp(o),realValueToDisplayValue:o=>o<0?-Iv(Math.abs(o)):Iv(o),displayValueToRealValue:o=>o<0?-zp(Math.abs(o)):zp(o),realValueToValue:o=>o<0?-Iv(Math.abs(o)):Iv(o),createRange:({defaultRange:o})=>{const{from:e,to:t,range:s}=o,i=e<0?-zp(Math.abs(e)):zp(e),r=t<0?-zp(Math.abs(t)):zp(t);return{from:e,to:t,range:s,realFrom:i,realTo:r,realRange:r-i,displayFrom:e,displayTo:t,displayRange:s}}},ny={normal:lf.extend(b6),percentage:lf.extend(x6),logarithm:lf.extend(w6)};function k6(o){return ny[o]??ny.normal}class ib{constructor(e,t){re(this,"_container");re(this,"_id");re(this,"_chart");re(this,"_bounding",Bm());re(this,"_originalBounding",Bm());re(this,"_visible",!0);this._chart=e,this._id=t,this._container=Gp("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"})}getContainer(){return this._container}setVisible(e){this._visible!==e&&(this._container.style.display=e?"block":"none",this._visible=e)}getVisible(){return this._visible}getId(){return this._id}getChart(){return this._chart}getBounding(){return this._bounding}setOriginalBounding(e){rd(this._originalBounding,e)}getOriginalBounding(){return this._originalBounding}update(e){this._bounding.height!==this._container.clientHeight&&(this._container.style.height=`${this._bounding.height}px`),this.updateImp(e??Ol.Drawer,this._container,this._bounding)}}class rb extends ib{constructor(t,s,i){super(t,s);re(this,"_mainWidget");re(this,"_yAxisWidget",null);re(this,"_axis");re(this,"_options",{id:"",minHeight:Mm,dragEnabled:!0,order:0,height:N2,state:"normal",axis:{name:"normal",scrollZoomEnabled:!0}});const r=this.getContainer();this._mainWidget=this.createMainWidget(r),this._yAxisWidget=this.createYAxisWidget(r),this.setOptions(i)}setOptions(t){var a,l,d;const s=this.getId();if(s===La.CANDLE||s===La.X_AXIS){const v=(a=t.axis)==null?void 0:a.name;(!mo(this._axis)||mo(v)&&this._options.axis.name!==v)&&(this._axis=this.createAxisComponent(v??"normal"))}else mo(this._axis)||(this._axis=this.createAxisComponent("normal"));this._axis instanceof lf&&this._axis.setAutoCalcTickFlag(!0),rd(this._options,t),this._axis.override({...this._options.axis,name:((l=t.axis)==null?void 0:l.name)??"normal"});let i=null,r="default";return this.getId()===La.X_AXIS?(i=this.getMainWidget().getContainer(),r="ew-resize"):(i=this.getYAxisWidget().getContainer(),r="ns-resize"),((d=t.axis)==null?void 0:d.scrollZoomEnabled)??!0?i.style.cursor=r:i.style.cursor="default",this}getOptions(){return this._options}getAxisComponent(){return this._axis}setBounding(t,s,i,r){rd(this.getBounding(),t);const a={};mo(t.height)&&(a.height=t.height),mo(t.top)&&(a.top=t.top),this._mainWidget.setBounding(a);const l=mo(s);return l&&this._mainWidget.setBounding(s),mo(this._yAxisWidget)&&(this._yAxisWidget.setBounding(a),this._axis.position==="left"?mo(i)&&this._yAxisWidget.setBounding({...i,left:0}):mo(r)&&(this._yAxisWidget.setBounding(r),l&&this._yAxisWidget.setBounding({left:(s.left??0)+(s.width??0)+(s.right??0)-(r.width??0)}))),this}getMainWidget(){return this._mainWidget}getYAxisWidget(){return this._yAxisWidget}updateImp(t){var s;this._mainWidget.update(t),(s=this._yAxisWidget)==null||s.update(t)}destroy(){var t;this._mainWidget.destroy(),(t=this._yAxisWidget)==null||t.destroy()}getImage(t){const{width:s,height:i}=this.getBounding(),r=Gp("canvas",{width:`${s}px`,height:`${i}px`,boxSizing:"border-box"}),a=r.getContext("2d"),l=cv(r);r.width=s*l,r.height=i*l,a.scale(l,l);const d=this._mainWidget.getBounding();if(a.drawImage(this._mainWidget.getImage(t),d.left,0,d.width,d.height),this._yAxisWidget!==null){const v=this._yAxisWidget.getBounding();a.drawImage(this._yAxisWidget.getImage(t),v.left,0,v.width,v.height)}return r}createYAxisWidget(t){return null}}class ab extends rb{createAxisComponent(e){const t=k6(e??"default");return new t(this)}createMainWidget(e){return new J2(e,this)}createYAxisWidget(e){return new y6(e,this)}}class S6 extends ab{createMainWidget(e){return new g6(e,this)}}class C6 extends tb{getAxisStyles(e){return e.xAxis}createAxisLine(e){return{coordinates:[{x:0,y:0},{x:e.width,y:0}]}}createTickLines(e,t,s){const i=s.tickLine,r=s.axisLine.size;return e.map(a=>({coordinates:[{x:a.coord,y:0},{x:a.coord,y:r+i.length}]}))}createTickTexts(e,t,s){const i=s.tickText,r=s.axisLine.size,a=s.tickLine.length;return e.map(l=>({x:l.coord,y:r+a+i.marginStart,text:l.text,align:"center",baseline:"top"}))}}class P6 extends ob{coordinateToPointTimestampDataIndexFlag(){return!0}coordinateToPointValueFlag(){return!1}getCompleteOverlays(){return this.getWidget().getPane().getChart().getChartStore().getOverlaysByPaneId()}getProgressOverlay(){var e;return((e=this.getWidget().getPane().getChart().getChartStore().getProgressOverlayInfo())==null?void 0:e.overlay)??null}getDefaultFigures(e,t){var d;const s=[],i=this.getWidget(),a=i.getPane().getChart().getChartStore(),l=a.getClickOverlayInfo();if(e.needDefaultXAxisFigure&&e.id===((d=l.overlay)==null?void 0:d.id)){let v=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;t.forEach((_,y)=>{v=Math.min(v,_.x),p=Math.max(p,_.x);const w=e.points[y];if(xr(w.timestamp)){const k=a.getInnerFormatter().formatDate(w.timestamp,"YYYY-MM-DD HH:mm","crosshair");s.push({type:"text",attrs:{x:_.x,y:0,text:k,align:"center"},ignoreEvent:!0})}}),t.length>1&&s.unshift({type:"rect",attrs:{x:v,y:0,width:p-v,height:i.getBounding().height},ignoreEvent:!0})}return s}getFigures(e,t){var v;const s=this.getWidget(),i=s.getPane(),r=i.getChart(),a=i.getAxisComponent(),l=r.getXAxisPane().getAxisComponent(),d=s.getBounding();return((v=e.createXAxisFigures)==null?void 0:v.call(e,{chart:r,overlay:e,coordinates:t,bounding:d,xAxis:l,yAxis:a}))??[]}}class I6 extends sb{drawImp(e){var a;const t=this.getWidget(),s=t.getPane().getChart().getChartStore(),i=s.getCrosshair(),r=s.getStyles().crosshair;if(r.show){const l=this.getDirectionStyles(r),d=l.text;if(l.show&&d.show&&this.compare(i)){const v=t.getBounding(),p=t.getPane().getAxisComponent(),_=this.getText(i,s),y=s.getStyles().xAxis.tickText,w={...d,size:y.size,family:y.family,weight:y.weight};e.font=qp(w.size,w.weight,w.family),(a=this.createFigure({name:"text",attrs:this.getTextAttrs(_,e.measureText(_).width,i,v,p,w),styles:w}))==null||a.draw(e)}}}compare(e){return mo(e.timestamp)}getDirectionStyles(e){return e.vertical}getText(e,t){var i;const s=e.timestamp;return t.getInnerFormatter().formatDate(s,Q2[((i=t.getPeriod())==null?void 0:i.type)??"day"],"crosshair")}getTextAttrs(e,t,s,i,r,a){const d=this.getWidget().getPane().getChart().getStyles().xAxis,v=d.axisLine.size,p=d.tickLine.length,_=v+p+d.tickText.marginStart-(a.paddingTop??0),y=s.realX;let w=0,k="center";return y-t/2-a.paddingLeft<0?(w=0,k="left"):y+t/2+a.paddingRight>i.width?(w=i.width,k="right"):w=y,{x:w,y:_,text:e,align:k,baseline:"top"}}}class M6 extends d1{constructor(t,s){super(t,s);re(this,"_xAxisView",new C6(this));re(this,"_overlayXAxisView",new P6(this));re(this,"_crosshairVerticalLabelView",new I6(this));this.setCursor("ew-resize"),this.addChild(this._overlayXAxisView)}getName(){return Ra.X_AXIS}updateMain(t){this._xAxisView.draw(t)}updateOverlay(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)}}class v1 extends nb{constructor(e,t){super(e),this.override(t)}override(e){const{name:t,scrollZoomEnabled:s,createTicks:i}=e;Dl(this.name)||(this.name=t),this.scrollZoomEnabled=s??this.scrollZoomEnabled,this.createTicks=i??this.createTicks}createRangeImp(){const t=this.getParent().getChart().getChartStore().getVisibleRange(),{realFrom:s,realTo:i}=t,r=s,a=i,l=i-s+1;return{from:r,to:a,range:l,realFrom:r,realTo:a,realRange:l,displayFrom:r,displayTo:a,displayRange:l}}createTicksImp(){const{realFrom:e,realTo:t,from:s}=this.getRange(),i=this.getParent().getChart().getChartStore(),r=i.getInnerFormatter().formatDate,a=i.getPeriod(),l=[],d=i.getBarSpace().bar,v=i.getStyles().xAxis.tickText,p=60,_=120,y=90,w=[1,2,3,5,10,15,20,30,45,60,90,120],k=Math.max(1,Math.round(y/Math.max(1,d)));let S=w.reduce((A,F)=>{const B=A*d,R=F*d,N=B>=p&&B<=_,$=R>=p&&R<=_;if(N&&$)return Math.abs(R-y)<Math.abs(B-y)?F:A;if($&&!N)return F;if(!N&&!$){const V=Math.abs(B-y);return Math.abs(R-y)<V?F:A}return A},k);S=Math.max(1,S);const L=Math.max(0,Math.floor(e/S)*S),T=n6[(a==null?void 0:a.type)??"day"];Bd(T,v.size,v.weight,v.family);const P=this.getBounding().width;for(let A=L;;A+=S){const F=this.convertToPixel(A);if(F>P)break;if(A>=s){const B=i.dataIndexToTimestamp(A);if(xr(B)){const R=r(B,T,"xAxis");l.push({coord:F,value:B,text:R})}}}return du(this.createTicks)?this.createTicks({range:this.getRange(),bounding:this.getBounding(),defaultTicks:l}):l}getAutoSize(){const e=this.getParent().getChart().getStyles(),t=e.xAxis,s=t.size;if(s!=="auto")return s;const i=e.crosshair;let r=0;t.show&&(t.axisLine.show&&(r+=t.axisLine.size),t.tickLine.show&&(r+=t.tickLine.length),t.tickText.show&&(r+=t.tickText.marginStart+t.tickText.marginEnd+t.tickText.size));let a=0;return i.show&&i.vertical.show&&i.vertical.text.show&&(a+=i.vertical.text.paddingTop+i.vertical.text.paddingBottom+i.vertical.text.borderSize*2+i.vertical.text.size),Math.max(r,a)}getBounding(){return this.getParent().getMainWidget().getBounding()}convertTimestampFromPixel(e){const t=this.getParent().getChart().getChartStore(),s=t.coordinateToDataIndex(e);return t.dataIndexToTimestamp(s)}convertTimestampToPixel(e){const t=this.getParent().getChart().getChartStore(),s=t.timestampToDataIndex(e);return t.dataIndexToCoordinate(s)}convertFromPixel(e){return this.getParent().getChart().getChartStore().coordinateToDataIndex(e)}convertToPixel(e){return this.getParent().getChart().getChartStore().dataIndexToCoordinate(e)}static extend(e){class t extends v1{constructor(i){super(i,e)}}return t}}const T6={name:"normal"},iy={normal:v1.extend(T6)};function A6(o){return iy[o]??iy.normal}class L6 extends rb{createAxisComponent(e){const t=A6(e);return new t(this)}createMainWidget(e){return new M6(e,this)}}function F6(o,e){let t=0;return function(){const s=Date.now();s-t>e&&(o.apply(this,arguments),t=s)}}class D6 extends O2{constructor(t,s){super(t,s);re(this,"_dragFlag",!1);re(this,"_dragStartY",0);re(this,"_topPaneHeight",0);re(this,"_bottomPaneHeight",0);re(this,"_topPane",null);re(this,"_bottomPane",null);re(this,"_pressedMouseMoveEvent",F6(this._pressedTouchMouseMoveEvent,20));this.registerEvent("touchStartEvent",this._mouseDownEvent.bind(this)).registerEvent("touchMoveEvent",this._pressedMouseMoveEvent.bind(this)).registerEvent("touchEndEvent",this._mouseUpEvent.bind(this)).registerEvent("mouseDownEvent",this._mouseDownEvent.bind(this)).registerEvent("mouseUpEvent",this._mouseUpEvent.bind(this)).registerEvent("pressedMouseMoveEvent",this._pressedMouseMoveEvent.bind(this)).registerEvent("mouseEnterEvent",this._mouseEnterEvent.bind(this)).registerEvent("mouseLeaveEvent",this._mouseLeaveEvent.bind(this))}getName(){return Ra.SEPARATOR}_mouseDownEvent(t){this._dragFlag=!0,this._dragStartY=t.pageY;const s=this.getPane(),i=s.getChart();this._topPane=s.getTopPane(),this._bottomPane=s.getBottomPane();const r=i.getDrawPanes();if(this._topPane.getOptions().state==="minimize"){const a=r.findIndex(l=>{var d;return l.getId()===((d=this._topPane)==null?void 0:d.getId())});for(let l=a-1;l>-1;l--){const d=r[l];if(d.getOptions().state!=="minimize"){this._topPane=d;break}}}if(this._bottomPane.getOptions().state==="minimize"){const a=r.findIndex(l=>{var d;return l.getId()===((d=this._bottomPane)==null?void 0:d.getId())});for(let l=a+1;l<r.length;l++){const d=r[l];if(d.getOptions().state!=="minimize"){this._bottomPane=d;break}}}return this._topPaneHeight=this._topPane.getBounding().height,this._bottomPaneHeight=this._bottomPane.getBounding().height,!0}_mouseUpEvent(){return this._dragFlag=!1,this._topPane=null,this._bottomPane=null,this._topPaneHeight=0,this._bottomPaneHeight=0,this._mouseLeaveEvent()}_pressedTouchMouseMoveEvent(t){const s=t.pageY-this._dragStartY,i=s<0;if(mo(this._topPane)&&mo(this._bottomPane)){const r=this._bottomPane.getOptions();if(this._topPane.getOptions().state!=="minimize"&&r.state!=="minimize"&&r.dragEnabled){let a=null,l=null,d=0,v=0;i?(a=this._topPane,l=this._bottomPane,d=this._topPaneHeight,v=this._bottomPaneHeight):(a=this._bottomPane,l=this._topPane,d=this._bottomPaneHeight,v=this._topPaneHeight);const p=a.getOptions().minHeight;if(d>p){const _=Math.max(d-Math.abs(s),p),y=d-_;a.setBounding({height:_}),l.setBounding({height:v+y});const w=this.getPane(),k=w.getChart();k.getChartStore().executeAction("onPaneDrag",{paneId:w.getId()}),k.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}}}return!0}_mouseEnterEvent(){const t=this.getPane();if(t.getBottomPane().getOptions().dragEnabled){const r=t.getChart().getStyles().separator;return this.getContainer().style.background=r.activeBackgroundColor,!0}return!1}_mouseLeaveEvent(){return this._dragFlag?!1:(this.getContainer().style.background="transparent",!0)}createContainer(){return Gp("div",{width:"100%",height:`${P0}px`,margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})}updateImp(t,s,i){if(i===Ol.All||i===Ol.Separator){const r=this.getPane().getChart().getStyles().separator;t.style.top=`${-Math.floor((P0-r.size)/2)}px`,t.style.height=`${P0}px`}}}class E6 extends ib{constructor(t,s,i,r){super(t,s);re(this,"_topPane");re(this,"_bottomPane");re(this,"_separatorWidget");this.getContainer().style.overflow="",this._topPane=i,this._bottomPane=r,this._separatorWidget=new D6(this.getContainer(),this)}setBounding(t){return rd(this.getBounding(),t),this}getTopPane(){return this._topPane}setTopPane(t){return this._topPane=t,this}getBottomPane(){return this._bottomPane}setBottomPane(t){return this._bottomPane=t,this}getWidget(){return this._separatorWidget}getImage(t){const{width:s,height:i}=this.getBounding(),r=this.getChart().getStyles().separator,a=Gp("canvas",{width:`${s}px`,height:`${i}px`,boxSizing:"border-box"}),l=a.getContext("2d"),d=cv(a);return a.width=s*d,a.height=i*d,l.scale(d,d),l.fillStyle=r.color,l.fillRect(0,0,s,i),a}updateImp(t,s,i){if(t===Ol.All||t===Ol.Separator){const r=this.getChart().getStyles().separator;s.style.backgroundColor=r.color,s.style.height=`${i.height}px`,s.style.marginLeft=`${i.left}px`,s.style.width=`${i.width}px`,this._separatorWidget.update(t)}}}function ry(){return typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes("firefox")}function p_(){return typeof window>"u"?!1:/iPhone|iPad|iPod|iOS/.test(window.navigator.userAgent)}const cm={ResetClick:500,LongTap:500,PreventFiresTouchEvents:500},tf={CancelClick:5,CancelTap:5,DoubleClick:5,DoubleTap:30},p0={Left:0,Middle:1,Right:2},$6=10;class j6{constructor(e,t,s){re(this,"_target");re(this,"_handler");re(this,"_options");re(this,"_clickCount",0);re(this,"_clickTimeoutId",null);re(this,"_clickCoordinate",{x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY});re(this,"_tapCount",0);re(this,"_tapTimeoutId",null);re(this,"_tapCoordinate",{x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY});re(this,"_longTapTimeoutId",null);re(this,"_longTapActive",!1);re(this,"_mouseMoveStartCoordinate",null);re(this,"_touchMoveStartCoordinate",null);re(this,"_touchMoveExceededManhattanDistance",!1);re(this,"_cancelClick",!1);re(this,"_cancelTap",!1);re(this,"_unsubscribeOutsideMouseEvents",null);re(this,"_unsubscribeOutsideTouchEvents",null);re(this,"_unsubscribeMobileSafariEvents",null);re(this,"_unsubscribeMousemove",null);re(this,"_unsubscribeMouseWheel",null);re(this,"_unsubscribeContextMenu",null);re(this,"_unsubscribeRootMouseEvents",null);re(this,"_unsubscribeRootTouchEvents",null);re(this,"_startPinchMiddleCoordinate",null);re(this,"_startPinchDistance",0);re(this,"_pinchPrevented",!1);re(this,"_preventTouchDragProcess",!1);re(this,"_mousePressed",!1);re(this,"_lastTouchEventTimeStamp",0);re(this,"_activeTouchId",null);re(this,"_acceptMouseLeave",!p_());re(this,"_onFirefoxOutsideMouseUp",e=>{this._mouseUpHandler(e)});re(this,"_onMobileSafariDoubleClick",e=>{if(this._firesTouchEvents(e)){if(++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){const{manhattanDistance:t}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate);t<tf.DoubleTap&&!this._cancelTap&&this._processEvent(this._makeCompatEvent(e),this._handler.doubleTapEvent),this._resetTapTimeout()}}else if(++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){const{manhattanDistance:t}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._clickCoordinate);t<tf.DoubleClick&&!this._cancelClick&&this._processEvent(this._makeCompatEvent(e),this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}});this._target=e,this._handler=t,this._options=s,this._init()}destroy(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()}_mouseEnterHandler(e){var r,a,l;(r=this._unsubscribeMousemove)==null||r.call(this),(a=this._unsubscribeMouseWheel)==null||a.call(this),(l=this._unsubscribeContextMenu)==null||l.call(this);const t=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=()=>{this._target.removeEventListener("mousemove",t)},this._target.addEventListener("mousemove",t);const s=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=()=>{this._target.removeEventListener("wheel",s)},this._target.addEventListener("wheel",s,{passive:!1});const i=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=()=>{this._target.removeEventListener("contextmenu",i)},this._target.addEventListener("contextmenu",i,{passive:!1}),!this._firesTouchEvents(e)&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)}_resetClickTimeout(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_resetTapTimeout(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_mouseMoveHandler(e){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)}_mouseWheelHandler(e){if(Math.abs(e.deltaX)>Math.abs(e.deltaY)){if(!mo(this._handler.mouseWheelHortEvent)||(this._preventDefault(e),Math.abs(e.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(e),-e.deltaX)}else{if(!mo(this._handler.mouseWheelVertEvent))return;let t=-(e.deltaY/100);if(t===0)return;switch(this._preventDefault(e),e.deltaMode){case e.DOM_DELTA_PAGE:{t*=120;break}case e.DOM_DELTA_LINE:{t*=32;break}}if(t!==0){const s=Math.sign(t)*Math.min(1,Math.abs(t));this._handler.mouseWheelVertEvent(this._makeCompatEvent(e),s)}}}_contextMenuHandler(e){this._preventDefault(e)}_touchMoveHandler(e){const t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t===null||(this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._startPinchMiddleCoordinate!==null)||this._preventTouchDragProcess)return;this._pinchPrevented=!0;const s=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._touchMoveStartCoordinate),{xOffset:i,yOffset:r,manhattanDistance:a}=s;if(!(!this._touchMoveExceededManhattanDistance&&a<tf.CancelTap)){if(!this._touchMoveExceededManhattanDistance){const l=i*.5,d=r>=l&&!this._options.treatVertDragAsPageScroll(),v=l>r&&!this._options.treatHorzDragAsPageScroll();!d&&!v&&(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(e,t),this._handler.touchMoveEvent)}}_mouseMoveWithDownHandler(e){if(e.button!==p0.Left)return;const t=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._mouseMoveStartCoordinate),{manhattanDistance:s}=t;s>=tf.CancelClick&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(e),this._handler.pressedMouseMoveEvent)}_mouseTouchMoveWithDownInfo(e,t){const s=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y),r=s+i;return{xOffset:s,yOffset:i,manhattanDistance:r}}_touchEndHandler(e){let t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t===null&&e.touches.length===0&&(t=e.changedTouches[0]),t===null)return;this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);const s=this._makeCompatEvent(e,t);if(this._processEvent(s,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){const{manhattanDistance:i}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._tapCoordinate);i<tf.DoubleTap&&!this._cancelTap&&this._processEvent(s,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processEvent(s,this._handler.tapEvent),mo(this._handler.tapEvent)&&this._preventDefault(e));this._tapCount===0&&this._preventDefault(e),e.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(e))}_mouseUpHandler(e){if(e.button!==p0.Left)return;const t=this._makeCompatEvent(e);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),ry()&&this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp),!this._firesTouchEvents(e))if(this._processEvent(t,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){const{manhattanDistance:s}=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._clickCoordinate);s<tf.DoubleClick&&!this._cancelClick&&this._processEvent(t,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processEvent(t,this._handler.mouseClickEvent)}_clearLongTapTimeout(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}_touchStartHandler(e){if(this._activeTouchId!==null)return;const t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(e);const s=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{const i=this._touchMoveHandler.bind(this),r=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=()=>{s.removeEventListener("touchmove",i),s.removeEventListener("touchend",r)},s.addEventListener("touchmove",i,{passive:!1}),s.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),cm.LongTap)}this._processEvent(this._makeCompatEvent(e,t),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),cm.ResetClick),this._tapCoordinate=this._getCoordinate(t))}_mouseDownHandler(e){if(e.button===p0.Right){this._preventDefault(e),this._processEvent(this._makeCompatEvent(e),this._handler.mouseRightClickEvent);return}if(e.button!==p0.Left)return;const t=this._target.ownerDocument.documentElement;ry()&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{const s=this._mouseMoveWithDownHandler.bind(this),i=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=()=>{t.removeEventListener("mousemove",s),t.removeEventListener("mouseup",i)},t.addEventListener("mousemove",s),t.addEventListener("mouseup",i)}this._mousePressed=!0,!this._firesTouchEvents(e)&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),cm.ResetClick),this._clickCoordinate=this._getCoordinate(e)))}_init(){this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{const e=this._target.ownerDocument,t=s=>{this._handler.mouseDownOutsideEvent!=null&&(s.composed&&this._target.contains(s.composedPath()[0])||s.target!==null&&this._target.contains(s.target)||this._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=()=>{e.removeEventListener("touchstart",t)},this._unsubscribeOutsideMouseEvents=()=>{e.removeEventListener("mousedown",t)},e.addEventListener("mousedown",t),e.addEventListener("touchstart",t,{passive:!0})}p_()&&(this._unsubscribeMobileSafariEvents=()=>{this._target.removeEventListener("dblclick",this._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",e=>{if(e.button===p0.Middle)return e.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",()=>{},{passive:!1})}_initPinch(){!mo(this._handler.pinchStartEvent)&&!mo(this._handler.pinchEvent)&&!mo(this._handler.pinchEndEvent)||(this._target.addEventListener("touchstart",e=>{this._checkPinchState(e.touches)},{passive:!0}),this._target.addEventListener("touchmove",e=>{if(!(e.touches.length!==2||this._startPinchMiddleCoordinate===null)&&mo(this._handler.pinchEvent)){const s=this._getTouchDistance(e.touches[0],e.touches[1])/this._startPinchDistance;this._handler.pinchEvent({...this._startPinchMiddleCoordinate,pageX:0,pageY:0},s),this._preventDefault(e)}},{passive:!1}),this._target.addEventListener("touchend",e=>{this._checkPinchState(e.touches)}))}_checkPinchState(e){e.length===1&&(this._pinchPrevented=!1),e.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)}_startPinch(e){const t=this._target.getBoundingClientRect();this._startPinchMiddleCoordinate={x:(e[0].clientX-t.left+(e[1].clientX-t.left))/2,y:(e[0].clientY-t.top+(e[1].clientY-t.top))/2},this._startPinchDistance=this._getTouchDistance(e[0],e[1]),mo(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()}_stopPinch(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,mo(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))}_mouseLeaveHandler(e){var t,s,i;(t=this._unsubscribeMousemove)==null||t.call(this),(s=this._unsubscribeMouseWheel)==null||s.call(this),(i=this._unsubscribeContextMenu)==null||i.call(this),!this._firesTouchEvents(e)&&this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!p_())}_longTapHandler(e){const t=this._touchWithId(e.touches,this._activeTouchId);t!==null&&(this._processEvent(this._makeCompatEvent(e,t),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)}_firesTouchEvents(e){var t;return mo((t=e.sourceCapabilities)==null?void 0:t.firesTouchEvents)?e.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(e)<this._lastTouchEventTimeStamp+cm.PreventFiresTouchEvents}_processEvent(e,t){t==null||t.call(this._handler,e)}_makeCompatEvent(e,t){const s=t??e,i=this._target.getBoundingClientRect();return{x:s.clientX-i.left,y:s.clientY-i.top,pageX:s.pageX,pageY:s.pageY,isTouch:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click"&&e.type!=="wheel",preventDefault:()=>{e.type!=="touchstart"&&this._preventDefault(e)}}}_getTouchDistance(e,t){const s=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(s*s+i*i)}_preventDefault(e){e.cancelable&&e.preventDefault()}_getCoordinate(e){return{x:e.pageX,y:e.pageY}}_eventTimeStamp(e){return e.timeStamp??performance.now()}_touchWithId(e,t){for(let s=0;s<e.length;++s)if(e[s].identifier===t)return e[s];return null}}class z6{constructor(e,t){re(this,"_container");re(this,"_chart");re(this,"_event");re(this,"_flingStartTime",new Date().getTime());re(this,"_flingScrollRequestId",null);re(this,"_startScrollCoordinate",null);re(this,"_touchCoordinate",null);re(this,"_touchCancelCrosshair",!1);re(this,"_touchZoomed",!1);re(this,"_pinchScale",1);re(this,"_mouseDownWidget",null);re(this,"_prevYAxisRange",null);re(this,"_xAxisStartScaleCoordinate",null);re(this,"_xAxisStartScaleDistance",0);re(this,"_xAxisScale",1);re(this,"_yAxisStartScaleDistance",0);re(this,"_mouseMoveTriggerWidgetInfo",{pane:null,widget:null});re(this,"_wheelScrollAccum",0);re(this,"_wheelScrollRafId",null);re(this,"_wheelZoomAccum",0);re(this,"_wheelZoomRafId",null);re(this,"_wheelZoomLastCoord",null);re(this,"_overlayUpdateRafId",null);re(this,"_yAxisScaleRafId",null);re(this,"_boundKeyBoardDownEvent",e=>{if(e.shiftKey)switch(e.code){case"Equal":{this._chart.getChartStore().zoom(.5);break}case"Minus":{this._chart.getChartStore().zoom(-.5);break}case"ArrowLeft":{const t=this._chart.getChartStore();t.startScroll(),t.scroll(-3*t.getBarSpace().bar);break}case"ArrowRight":{const t=this._chart.getChartStore();t.startScroll(),t.scroll(3*t.getBarSpace().bar);break}}});this._container=e,this._chart=t,this._event=new j6(e,this,{treatVertDragAsPageScroll:()=>!1,treatHorzDragAsPageScroll:()=>!1}),e.addEventListener("keydown",this._boundKeyBoardDownEvent)}pinchStartEvent(){return this._touchZoomed=!0,this._pinchScale=1,!0}pinchEvent(e,t){const{pane:s,widget:i}=this._findWidgetByEvent(e);if((s==null?void 0:s.getId())!==La.X_AXIS&&(i==null?void 0:i.getName())===Ra.MAIN){const r=this._makeWidgetEvent(e,i),a=(t-this._pinchScale)*5;return this._pinchScale=t,this._chart.getChartStore().zoom(a,{x:r.x,y:r.y}),!0}return!1}mouseWheelHortEvent(e,t){if(this._wheelScrollAccum+=t,this._wheelScrollRafId===null){const s=this._chart.getChartStore();this._wheelScrollRafId=Wp(()=>{const i=this._wheelScrollAccum;this._wheelScrollAccum=0,this._wheelScrollRafId=null,s.startScroll(),s.scroll(i)})}return!0}mouseWheelVertEvent(e,t){const{widget:s}=this._findWidgetByEvent(e),i=this._makeWidgetEvent(e,s);return(s==null?void 0:s.getName())===Ra.MAIN?(this._wheelZoomAccum+=t,this._wheelZoomLastCoord={x:i.x,y:i.y},this._wheelZoomRafId===null&&(this._wheelZoomRafId=Wp(()=>{const a=this._wheelZoomAccum,l=this._wheelZoomLastCoord??{x:i.x,y:i.y};this._wheelZoomAccum=0,this._wheelZoomLastCoord=null,this._wheelZoomRafId=null,this._chart.getChartStore().zoom(a,l)})),!0):!1}mouseDownEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);if(this._mouseDownWidget=s,s!==null){const i=this._makeWidgetEvent(e,s);switch(s.getName()){case Ra.SEPARATOR:return s.dispatchEvent("mouseDownEvent",i);case Ra.MAIN:{const a=t.getAxisComponent();if(!a.getAutoCalcTickFlag()){const l=a.getRange();this._prevYAxisRange={...l}}return this._startScrollCoordinate={x:i.x,y:i.y},this._chart.getChartStore().startScroll(),s.dispatchEvent("mouseDownEvent",i)}case Ra.X_AXIS:return this._processXAxisScrollStartEvent(s,i);case Ra.Y_AXIS:return this._processYAxisScaleStartEvent(s,i)}}return!1}mouseMoveEvent(e){var r,a,l;const{pane:t,widget:s}=this._findWidgetByEvent(e),i=this._makeWidgetEvent(e,s);if((((r=this._mouseMoveTriggerWidgetInfo.pane)==null?void 0:r.getId())!==(t==null?void 0:t.getId())||((a=this._mouseMoveTriggerWidgetInfo.widget)==null?void 0:a.getName())!==(s==null?void 0:s.getName()))&&(s==null||s.dispatchEvent("mouseEnterEvent",i),(l=this._mouseMoveTriggerWidgetInfo.widget)==null||l.dispatchEvent("mouseLeaveEvent",i),this._mouseMoveTriggerWidgetInfo={pane:t,widget:s}),s!==null){const d=s.getName();switch(d){case Ra.MAIN:{const v=s.dispatchEvent("mouseMoveEvent",i);let p={x:i.x,y:i.y,paneId:t==null?void 0:t.getId()};return v?(s.getForceCursor()!=="pointer"&&(p=void 0),s.setCursor("pointer")):s.setCursor("crosshair"),this._chart.getChartStore().setCrosshair(p),v}case Ra.SEPARATOR:case Ra.X_AXIS:case Ra.Y_AXIS:{const v=s.dispatchEvent("mouseMoveEvent",i);return d===Ra.X_AXIS?this._chart.getChartStore().setCrosshair({x:i.x,paneId:t==null?void 0:t.getId()}):this._chart.getChartStore().setCrosshair(),v}}}return!1}pressedMouseMoveEvent(e){var i,r;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===Ra.SEPARATOR)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",e);const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null&&((i=this._mouseDownWidget)==null?void 0:i.getPane().getId())===(t==null?void 0:t.getId())&&((r=this._mouseDownWidget)==null?void 0:r.getName())===s.getName()){const a=this._makeWidgetEvent(e,s);switch(s.getName()){case Ra.MAIN:{let d;const v=s.dispatchEvent("pressedMouseMoveEvent",a);return v||this._processMainScrollingEvent(s,a),(!v||s.getForceCursor()==="pointer")&&(d={x:a.x,y:a.y,paneId:t==null?void 0:t.getId()}),this._chart.getChartStore().setCrosshair(d,{forceInvalidate:!0}),v}case Ra.X_AXIS:return this._processXAxisScrollingEvent(s,a);case Ra.Y_AXIS:return this._processYAxisScalingEvent(s,a)}}return!1}mouseUpEvent(e){const{widget:t}=this._findWidgetByEvent(e);let s=!1;if(t!==null){const i=this._makeWidgetEvent(e,t);switch(t.getName()){case Ra.MAIN:case Ra.SEPARATOR:case Ra.X_AXIS:case Ra.Y_AXIS:{s=t.dispatchEvent("mouseUpEvent",i);break}}s&&this._scheduleOverlayUpdate()}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._yAxisScaleRafId=null,s}mouseClickEvent(e){const{widget:t}=this._findWidgetByEvent(e);if(t!==null){const s=this._makeWidgetEvent(e,t);return t.dispatchEvent("mouseClickEvent",s)}return!1}mouseRightClickEvent(e){const{widget:t}=this._findWidgetByEvent(e);let s=!1;if(t!==null){const i=this._makeWidgetEvent(e,t);switch(t.getName()){case Ra.MAIN:case Ra.X_AXIS:case Ra.Y_AXIS:{s=t.dispatchEvent("mouseRightClickEvent",i);break}}s&&this._scheduleOverlayUpdate()}return!1}mouseDoubleClickEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null)switch(s.getName()){case Ra.MAIN:{const r=this._makeWidgetEvent(e,s);return s.dispatchEvent("mouseDoubleClickEvent",r)}case Ra.Y_AXIS:{const r=t.getAxisComponent();if(!r.getAutoCalcTickFlag())return r.setAutoCalcTickFlag(!0),this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0}),!0;break}}return!1}mouseLeaveEvent(){return this._chart.getChartStore().setCrosshair(),!0}touchStartEvent(e){var i;const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null){const r=this._makeWidgetEvent(e,s);switch((i=r.preventDefault)==null||i.call(r),s.getName()){case Ra.MAIN:{const l=this._chart.getChartStore();if(s.dispatchEvent("mouseDownEvent",r))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(Ol.Overlay),!0;this._flingScrollRequestId!==null&&(H1(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime();const d=t.getAxisComponent();if(!d.getAutoCalcTickFlag()){const v=d.getRange();this._prevYAxisRange={...v}}if(this._startScrollCoordinate={x:r.x,y:r.y},l.startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){const v=r.x-this._touchCoordinate.x,p=r.y-this._touchCoordinate.y;Math.sqrt(v*v+p*p)<$6?(this._touchCoordinate={x:r.x,y:r.y},l.setCrosshair({x:r.x,y:r.y,paneId:t==null?void 0:t.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,l.setCrosshair())}return!0}case Ra.X_AXIS:return this._processXAxisScrollStartEvent(s,r);case Ra.Y_AXIS:return this._processYAxisScaleStartEvent(s,r)}}return!1}touchMoveEvent(e){var i;const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null){const r=this._makeWidgetEvent(e,s);(i=r.preventDefault)==null||i.call(r);const a=s.getName(),l=this._chart.getChartStore();switch(a){case Ra.MAIN:return s.dispatchEvent("pressedMouseMoveEvent",r)?(l.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(Ol.Overlay),!0):(this._touchCoordinate!==null?l.setCrosshair({x:r.x,y:r.y,paneId:t==null?void 0:t.getId()}):this._processMainScrollingEvent(s,r),!0);case Ra.X_AXIS:return this._processXAxisScrollingEvent(s,r);case Ra.Y_AXIS:return this._processYAxisScalingEvent(s,r)}}return!1}touchEndEvent(e){const{widget:t}=this._findWidgetByEvent(e);if(t!==null){const s=this._makeWidgetEvent(e,t);switch(t.getName()){case Ra.MAIN:{if(t.dispatchEvent("mouseUpEvent",s),this._startScrollCoordinate!==null){const r=new Date().getTime()-this._flingStartTime;let l=(s.x-this._startScrollCoordinate.x)/(r>0?r:1)*20;if(r<200&&Math.abs(l)>0){const d=this._chart.getChartStore(),v=()=>{this._flingScrollRequestId=Wp(()=>{d.startScroll(),d.scroll(l),l=l*(1-.025),Math.abs(l)<1?this._flingScrollRequestId!==null&&(H1(this._flingScrollRequestId),this._flingScrollRequestId=null):v()})};v()}}return!0}case Ra.X_AXIS:case Ra.Y_AXIS:t.dispatchEvent("mouseUpEvent",s)&&this._chart.updatePane(Ol.Overlay)}this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._yAxisScaleRafId=null}return!1}tapEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);let i=!1;if(s!==null){const r=this._makeWidgetEvent(e,s),a=s.dispatchEvent("mouseClickEvent",r);if(s.getName()===Ra.MAIN){const l=this._makeWidgetEvent(e,s),d=this._chart.getChartStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,d.setCrosshair(void 0,{notInvalidate:!0}),i=!0):(!this._touchCancelCrosshair&&!this._touchZoomed&&(this._touchCoordinate={x:l.x,y:l.y},d.setCrosshair({x:l.x,y:l.y,paneId:t==null?void 0:t.getId()},{notInvalidate:!0}),i=!0),this._touchCancelCrosshair=!1)}(i||a)&&this._scheduleOverlayUpdate()}return i}doubleTapEvent(e){return this.mouseDoubleClickEvent(e)}longTapEvent(e){const{pane:t,widget:s}=this._findWidgetByEvent(e);if(s!==null&&s.getName()===Ra.MAIN){const i=this._makeWidgetEvent(e,s);return this._touchCoordinate={x:i.x,y:i.y},this._chart.getChartStore().setCrosshair({x:i.x,y:i.y,paneId:t==null?void 0:t.getId()}),!0}return!1}_processMainScrollingEvent(e,t){if(this._startScrollCoordinate!==null){const s=e.getPane().getAxisComponent();if(this._prevYAxisRange!==null&&!s.getAutoCalcTickFlag()&&s.scrollZoomEnabled){const{from:r,to:a,range:l}=this._prevYAxisRange;let d=0;s.reverse?d=this._startScrollCoordinate.y-t.y:d=t.y-this._startScrollCoordinate.y;const v=e.getBounding(),p=d/v.height,_=l*p,y=r+_,w=a+_,k=s.valueToRealValue(y,{range:this._prevYAxisRange}),S=s.valueToRealValue(w,{range:this._prevYAxisRange}),L=s.realValueToDisplayValue(k,{range:this._prevYAxisRange}),T=s.realValueToDisplayValue(S,{range:this._prevYAxisRange});s.setRange({from:y,to:w,range:w-y,realFrom:k,realTo:S,realRange:S-k,displayFrom:L,displayTo:T,displayRange:T-L})}const i=t.x-this._startScrollCoordinate.x;this._chart.getChartStore().scroll(i)}}_processXAxisScrollStartEvent(e,t){const s=e.dispatchEvent("mouseDownEvent",t);return s&&this._scheduleOverlayUpdate(),this._xAxisStartScaleCoordinate={x:t.x,y:t.y},this._xAxisStartScaleDistance=t.pageX,s}_processXAxisScrollingEvent(e,t){const s=e.dispatchEvent("pressedMouseMoveEvent",t);if(s)this._scheduleOverlayUpdate();else if(e.getPane().getAxisComponent().scrollZoomEnabled&&this._xAxisStartScaleDistance!==0){const r=this._xAxisStartScaleDistance/t.pageX;if(Number.isFinite(r)){const a=(r-this._xAxisScale)*10;this._xAxisScale=r,this._chart.getChartStore().zoom(a,this._xAxisStartScaleCoordinate??void 0)}}return s}_processYAxisScaleStartEvent(e,t){const s=e.dispatchEvent("mouseDownEvent",t);s&&this._scheduleOverlayUpdate();const i=e.getPane().getAxisComponent().getRange();return this._prevYAxisRange={...i},this._yAxisStartScaleDistance=t.pageY,s}_processYAxisScalingEvent(e,t){const s=e.dispatchEvent("pressedMouseMoveEvent",t);if(s)this._chart.updatePane(Ol.Overlay);else{const i=e.getPane().getAxisComponent();if(this._prevYAxisRange!==null&&i.scrollZoomEnabled&&this._yAxisStartScaleDistance!==0){const{from:r,to:a,range:l}=this._prevYAxisRange,d=t.pageY/this._yAxisStartScaleDistance,v=Number.isFinite(d)?Math.min(5,Math.max(.2,d)):1,p=l*v,_=(p-l)/2,y=r-_,w=a+_,k=i.valueToRealValue(y,{range:this._prevYAxisRange}),S=i.valueToRealValue(w,{range:this._prevYAxisRange}),L=i.realValueToDisplayValue(k,{range:this._prevYAxisRange}),T=i.realValueToDisplayValue(S,{range:this._prevYAxisRange});i.setRange({from:y,to:w,range:p,realFrom:k,realTo:S,realRange:S-k,displayFrom:L,displayTo:T,displayRange:T-L}),this._yAxisScaleRafId===null&&(this._yAxisScaleRafId=Wp(()=>{this._yAxisScaleRafId=null,this._chart.layout({measureWidth:!0,update:!0,buildYAxisTick:!0})}))}}return s}_findWidgetByEvent(e){const{x:t,y:s}=e,i=this._chart.getSeparatorPanes(),r=this._chart.getStyles().separator.size;for(const v of i){const p=v[1],_=p.getBounding(),y=_.top-Math.round((P0-r)/2);if(t>=_.left&&t<=_.left+_.width&&s>=y&&s<=y+P0)return{pane:p,widget:p.getWidget()}}const a=this._chart.getDrawPanes();let l=null;for(const v of a){const p=v.getBounding();if(t>=p.left&&t<=p.left+p.width&&s>=p.top&&s<=p.top+p.height){l=v;break}}let d=null;if(l!==null){if(!mo(d)){const v=l.getMainWidget(),p=v.getBounding();t>=p.left&&t<=p.left+p.width&&s>=p.top&&s<=p.top+p.height&&(d=v)}if(!mo(d)){const v=l.getYAxisWidget();if(v!==null){const p=v.getBounding();t>=p.left&&t<=p.left+p.width&&s>=p.top&&s<=p.top+p.height&&(d=v)}}}return{pane:l,widget:d}}_makeWidgetEvent(e,t){const s=(t==null?void 0:t.getBounding())??null;return{...e,x:e.x-((s==null?void 0:s.left)??0),y:e.y-((s==null?void 0:s.top)??0)}}destroy(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()}}class B6{constructor(e,t){re(this,"id");re(this,"_container");re(this,"_chartContainer");re(this,"_chartBounding",Bm());re(this,"_chartEvent");re(this,"_chartStore");re(this,"_drawPanes",[]);re(this,"_candlePane");re(this,"_xAxisPane");re(this,"_separatorPanes",new Map);re(this,"_layoutOptions",{sort:!0,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!1,cacheYAxisWidth:!1,forceBuildYAxisTick:!1});re(this,"_layoutPending",!1);re(this,"_cacheYAxisWidth",{left:0,right:0});this.id=m0("chart"),this._initContainer(e),this._chartEvent=new z6(this._chartContainer,this),this._chartStore=new L5(this,t),this._initPanes(t),this._layout()}_initContainer(e){this._container=e,this._chartContainer=Gp("div",{position:"relative",width:"100%",height:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",overflow:"hidden",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,e.appendChild(this._chartContainer),this._cacheChartBounding()}_cacheChartBounding(){this._chartBounding.width=Math.floor(this._chartContainer.clientWidth),this._chartBounding.height=Math.floor(this._chartContainer.clientHeight)}_initPanes(e){const t=(e==null?void 0:e.layout)??[{type:"candle"}],s=r=>{if(!mo(this._candlePane)){const a=r.options??{};rd(a,{id:La.CANDLE}),this._candlePane=this._createPane(S6,La.CANDLE,a),(r.content??[]).forEach(d=>{this.createIndicator(d,!0,a)})}},i=r=>{if(!mo(this._xAxisPane)){const a=this._createPane(L6,La.X_AXIS,r??{});this._xAxisPane=a}};t.forEach(r=>{var a;switch(r.type){case"candle":{s(r);break}case"indicator":{const l=r.content??[];if(l.length>0){let d=((a=r.options)==null?void 0:a.id)??null;mo(d)&&(d=m0(La.INDICATOR));const v={...r.options,id:d};l.forEach(p=>{this.createIndicator(p,!0,v)})}break}case"xAxis":{i(r.options);break}}}),s({type:"candle"}),i({order:Number.MAX_SAFE_INTEGER})}_createPane(e,t,s){const i=new e(this,t,s??{});return this._drawPanes.push(i),i}_recalculatePaneHeight(e,t,s){if(s===0)return!1;const i=this._drawPanes.filter(a=>{const l=a.getId();return a.getOptions().state==="normal"&&l!==e.getId()&&l!==La.X_AXIS}),r=i.length;if(r===0)return!1;if(e.getId()!==La.CANDLE&&mo(this._candlePane)&&this._candlePane.getOptions().state==="normal"){const a=this._candlePane.getBounding().height;if(a>0){const l=this._candlePane.getOptions().minHeight;let d=a+s;d<l&&(d=l,t-=a+s-d),this._candlePane.setBounding({height:d})}}else{let a=s;const l=Math.floor(s/r);i.forEach((d,v)=>{const p=d.getBounding().height;let _=0;v===r-1?_=p+a:_=p+l,_<d.getOptions().minHeight&&(_=d.getOptions().minHeight),d.setBounding({height:_}),a-=_-p}),Math.abs(a)>0&&(t-=a)}return e.setBounding({height:t}),!0}getDrawPaneById(e){return e===La.CANDLE?this._candlePane:e===La.X_AXIS?this._xAxisPane:this._drawPanes.find(s=>s.getId()===e)??null}getContainer(){return this._container}getChartStore(){return this._chartStore}getXAxisPane(){return this._xAxisPane}getDrawPanes(){return this._drawPanes}getSeparatorPanes(){return this._separatorPanes}layout(e){(e.sort??!1)&&(this._layoutOptions.sort=e.sort),(e.measureHeight??!1)&&(this._layoutOptions.measureHeight=e.measureHeight),(e.measureWidth??!1)&&(this._layoutOptions.measureWidth=e.measureWidth),(e.update??!1)&&(this._layoutOptions.update=e.update),(e.buildYAxisTick??!1)&&(this._layoutOptions.buildYAxisTick=e.buildYAxisTick),(e.cacheYAxisWidth??!1)&&(this._layoutOptions.cacheYAxisWidth=e.cacheYAxisWidth),(e.buildYAxisTick??!1)&&(this._layoutOptions.forceBuildYAxisTick=e.forceBuildYAxisTick),this._layoutPending||(this._layoutPending=!0,Promise.resolve().then(t=>{this._layout(),this._layoutPending=!1}).catch(t=>{}))}_layout(){const{sort:e,measureHeight:t,measureWidth:s,update:i,buildYAxisTick:r,cacheYAxisWidth:a,forceBuildYAxisTick:l}=this._layoutOptions,d=typeof performance<"u"?performance.now():Date.now();if(e){for(;mo(this._chartContainer.firstChild);)this._chartContainer.removeChild(this._chartContainer.firstChild);this._separatorPanes.clear(),this._drawPanes.sort((w,k)=>w.getOptions().order-k.getOptions().order);let y=null;this._drawPanes.forEach(w=>{if(w.getId()!==La.X_AXIS){if(mo(y)){const k=new E6(this,"",y,w);this._chartContainer.appendChild(k.getContainer()),this._separatorPanes.set(w,k)}y=w}this._chartContainer.appendChild(w.getContainer())})}if(t){const y=this._chartBounding.height,w=this.getStyles().separator.size,k=this._xAxisPane.getAxisComponent().getAutoSize();let S=y-k;S<0&&(S=0),this._drawPanes.forEach(T=>{const P=T.getId();if(mo(this._separatorPanes.get(T))&&(S-=w),P!==La.X_AXIS&&P!==La.CANDLE&&T.getVisible()){let A=T.getBounding().height;A>S?(A=S,S=0):S-=A,T.setBounding({height:A})}}),this._candlePane.setBounding({height:Math.max(S,0)}),this._xAxisPane.setBounding({height:k});let L=0;this._drawPanes.forEach(T=>{const P=this._separatorPanes.get(T);mo(P)&&(P.setBounding({height:w,top:L}),L+=w),T.setBounding({top:L}),L+=T.getBounding().height})}let v=s;if((r||l)&&this._drawPanes.forEach(y=>{const w=y.getAxisComponent().buildTicks(l);v||(v=w)}),v){const y=this._chartBounding.width,w=this.getStyles();let k=0,S=!0,L=0,T=!0;this._drawPanes.forEach(G=>{if(G.getId()!==La.X_AXIS){const Z=G.getAxisComponent(),le=Z.inside,se=Z.getAutoSize();Z.position==="left"?(k=Math.max(k,se),le&&(S=!1)):(L=Math.max(L,se),le&&(T=!1))}}),a&&(k=Math.max(this._cacheYAxisWidth.left,k),L=Math.max(this._cacheYAxisWidth.right,L)),this._cacheYAxisWidth.left=k,this._cacheYAxisWidth.right=L;let P=y,A=0,F=0;S&&(P-=k,A=k),T&&(P-=L,F=L),this._chartStore.setTotalBarSpace(P);const B={width:y},R={width:P,left:A,right:F},N={width:k},$={width:L},V=w.separator.fill;let U={};V?U=B:U=R,this._drawPanes.forEach(G=>{var Z;(Z=this._separatorPanes.get(G))==null||Z.setBounding(U),G.setBounding(B,R,N,$)})}i&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(Ol.All)),this._layoutOptions={sort:!1,measureHeight:!1,measureWidth:!1,update:!1,buildYAxisTick:!1,cacheYAxisWidth:!1,forceBuildYAxisTick:!1};const _=(typeof performance<"u"?performance.now():Date.now())-d;if(_>50){const y=this._chartStore.getDataList().length,w=this._chartStore.getBarSpace().bar,k=this._chartStore.getVisibleRange();console.warn("⚠️ klinecharts: layout slow",{durationMs:Math.round(_),dataLen:y,barSpace:w,visibleFrom:k.from,visibleTo:k.to,update:i})}}updatePane(e,t){if(mo(t)){const s=this.getDrawPaneById(t);s==null||s.update(e)}else this._drawPanes.forEach(s=>{var i;s.update(e),(i=this._separatorPanes.get(s))==null||i.update(e)})}getDom(e,t){var s;if(mo(e)){const i=this.getDrawPaneById(e);if(mo(i))switch(t??"root"){case"root":return i.getContainer();case"main":return i.getMainWidget().getContainer();case"yAxis":return((s=i.getYAxisWidget())==null?void 0:s.getContainer())??null}}else return this._chartContainer;return null}getSize(e,t){var s;if(mo(e)){const i=this.getDrawPaneById(e);if(mo(i))switch(t??"root"){case"root":return i.getBounding();case"main":return i.getMainWidget().getBounding();case"yAxis":return((s=i.getYAxisWidget())==null?void 0:s.getBounding())??null}}else return this._chartBounding;return null}_resetYAxisAutoCalcTickFlag(){this._drawPanes.forEach(e=>{e.getAxisComponent().setAutoCalcTickFlag(!0)})}setSymbol(e){e!==this.getSymbol()&&(this._resetYAxisAutoCalcTickFlag(),this._chartStore.setSymbol(e))}getSymbol(){return this._chartStore.getSymbol()}setPeriod(e){e!==this.getPeriod()&&(this._resetYAxisAutoCalcTickFlag(),this._chartStore.setPeriod(e))}getPeriod(){return this._chartStore.getPeriod()}setStyles(e){this._setOptions(()=>{this._chartStore.setStyles(e)})}getStyles(){return this._chartStore.getStyles()}setFormatter(e){this._setOptions(()=>{this._chartStore.setFormatter(e)})}getFormatter(){return this._chartStore.getFormatter()}setLocale(e){this._setOptions(()=>{this._chartStore.setLocale(e)})}getLocale(){return this._chartStore.getLocale()}setTimezone(e){this._setOptions(()=>{this._chartStore.setTimezone(e)})}getTimezone(){return this._chartStore.getTimezone()}setThousandsSeparator(e){this._setOptions(()=>{this._chartStore.setThousandsSeparator(e)})}getThousandsSeparator(){return this._chartStore.getThousandsSeparator()}setDecimalFold(e){this._setOptions(()=>{this._chartStore.setDecimalFold(e)})}getDecimalFold(){return this._chartStore.getDecimalFold()}_setOptions(e){e(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}setOffsetRightDistance(e){this._chartStore.setOffsetRightDistance(e,!0)}getOffsetRightDistance(){return this._chartStore.getOffsetRightDistance()}setMaxOffsetLeftDistance(e){e<0||this._chartStore.setMaxOffsetLeftDistance(e)}setMaxOffsetRightDistance(e){e<0||this._chartStore.setMaxOffsetRightDistance(e)}setLeftMinVisibleBarCount(e){e<0||this._chartStore.setLeftMinVisibleBarCount(Math.ceil(e))}setRightMinVisibleBarCount(e){e<0||this._chartStore.setRightMinVisibleBarCount(Math.ceil(e))}setBarSpace(e){this._chartStore.setBarSpace(e)}getBarSpace(){return this._chartStore.getBarSpace()}getVisibleRange(){return this._chartStore.getVisibleRange()}resetData(){this._chartStore.resetData()}applyNewData(e,t){this._chartStore.applyNewData(e,t)}addData(e,t,s){this._chartStore.addData(e,t,s)}getDataList(){return this._chartStore.getDataList()}setDataLoader(e){this._resetYAxisAutoCalcTickFlag(),this._chartStore.setDataLoader(e)}createIndicator(e,t,s){const i=Dl(e)?{name:e}:e;if(E2(i.name)===null)return null;const r=s??{};if(Dl(r.id)||(r.id=m0(La.INDICATOR)),Dl(i.id)||(i.id=m0(i.name)),this._chartStore.addIndicator(i,r.id,t??!1)){let l=!1;return mo(this.getDrawPaneById(r.id))||(this._createPane(ab,r.id,r),r.height??(r.height=N2),l=!0),this.setPaneOptions(r),this.layout({sort:l,measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0}),i.id}return null}overrideIndicator(e){return this._chartStore.overrideIndicator(e)}getIndicators(e){return this._chartStore.getIndicatorsByFilter(e??{})}removeIndicator(e){let t=this._chartStore.removeIndicator(e??{});if(!t&&e){const{name:s,id:i}=e,r=typeof s=="string"?s.split("(")[0].trim():void 0;if(i||r){const a={};i&&(a.id=i),r&&(a.name=r),t=this._chartStore.removeIndicator(a),!t&&r&&(t=this._chartStore.removeIndicator({name:r}))}}if(t){let s=!1;const i=[];this._drawPanes.forEach(r=>{const a=r.getId();a!==La.CANDLE&&a!==La.X_AXIS&&i.push(a)}),i.forEach(r=>{if(!this._chartStore.hasIndicators(r)){const a=this._drawPanes.findIndex(d=>d.getId()===r),l=this._drawPanes[a];mo(l)&&(s=!0,this._recalculatePaneHeight(l,0,l.getBounding().height),this._drawPanes.splice(a,1),l.destroy())}}),this._drawPanes.length===2&&(this._candlePane.setVisible(!0),this._candlePane.setBounding({height:this._chartBounding.height-this._xAxisPane.getBounding().height})),this.layout({sort:s,measureHeight:s,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}return t}createOverlay(e){const t=[],s=[],i=a=>{!mo(a.paneId)||this.getDrawPaneById(a.paneId)===null?(a.paneId=La.CANDLE,s.push(!1)):s.push(!0),t.push(a)};Dl(e)?i({name:e}):op(e)?e.forEach(a=>{let l=null;Dl(a)?l={name:a}:l=a,i(l)}):i(e);const r=this._chartStore.addOverlays(t,s);return op(e)?r:r[0]}getOverlays(e){return this._chartStore.getOverlaysByFilter(e??{})}overrideOverlay(e){return this._chartStore.overrideOverlay(e)}removeOverlay(e){return this._chartStore.removeOverlay(e??{})}setPaneOptions(e){let t=!1,s=!1;const i=mo(e.id);for(const r of this._drawPanes){const a=r.getId();if(i&&e.id===a||!i){if(a!==La.X_AXIS){if(xr(e.height)&&e.height>0){const d=Math.max(e.minHeight??r.getOptions().minHeight,0),v=Math.max(d,e.height);s=!0,t=!0,r.setOriginalBounding({height:v}),this._recalculatePaneHeight(r,v,-v)}if(mo(e.state)&&r.getOptions().state!==e.state){t=!0,s=!0;const d=e.state;switch(d){case"maximize":{const v=this._drawPanes.find(p=>{const _=p.getId();return p.getOptions().state==="maximize"&&_!==La.X_AXIS});if(!mo(v)){r.getOptions().state==="normal"&&r.setOriginalBounding({height:r.getBounding().height}),r.setOptions({state:d});const p=this._chartBounding.height;r.setBounding({height:p-this._xAxisPane.getBounding().height}),this._drawPanes.forEach(_=>{var y;_.getId()!==La.X_AXIS&&_.getId()!==a&&(_.setBounding({height:_.getOriginalBounding().height}),_.setVisible(!1),(y=this._separatorPanes.get(_))==null||y.setVisible(!1))})}break}case"minimize":{const v=r.getBounding().height,p=r.getOptions().state;let _=v-Mm;p==="maximize"&&(_=r.getOriginalBounding().height-Mm),this._recalculatePaneHeight(r,Mm,_)&&(p==="normal"&&r.setOriginalBounding({height:v}),r.setOptions({state:d})),this._drawPanes.forEach(y=>{var w;y.getId()!==La.X_AXIS&&(y.setVisible(!0),(w=this._separatorPanes.get(y))==null||w.setVisible(!0))});break}default:{const v=r.getOriginalBounding().height;this._recalculatePaneHeight(r,v,r.getBounding().height-v)&&r.setOptions({state:d}),this._drawPanes.forEach(p=>{var _;p.getId()!==La.X_AXIS&&(p.setVisible(!0),(_=this._separatorPanes.get(p))==null||_.setVisible(!0))});break}}}}mo(e.axis)&&(s=!0);const l={...e};if(delete l.state,r.setOptions(l),a===e.id)break}}s&&this.layout({measureHeight:t,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}getPaneOptions(e){if(mo(e)){const t=this.getDrawPaneById(e);return(t==null?void 0:t.getOptions())??null}return this._drawPanes.map(t=>t.getOptions())}setZoomEnabled(e){this._chartStore.setZoomEnabled(e)}isZoomEnabled(){return this._chartStore.isZoomEnabled()}setScrollEnabled(e){this._chartStore.setScrollEnabled(e)}isScrollEnabled(){return this._chartStore.isScrollEnabled()}scrollByDistance(e,t){const s=xr(t)&&t>0?t:0;if(this._chartStore.startScroll(),s>0){const i=new O_({duration:s});i.doFrame(r=>{const a=e*(r/s);this._chartStore.scroll(a)}),i.start()}else this._chartStore.scroll(e)}scrollToRealTime(e){const{bar:t}=this._chartStore.getBarSpace(),i=(this._chartStore.getLastBarRightSideDiffBarCount()-this._chartStore.getInitialOffsetRightDistance()/t)*t;this.scrollByDistance(i,e)}scrollToDataIndex(e,t){const s=(this._chartStore.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-e))*this._chartStore.getBarSpace().bar;this.scrollByDistance(s,t)}scrollToTimestamp(e,t){const s=V_(this.getDataList(),"timestamp",e);this.scrollToDataIndex(s,t)}zoomAtCoordinate(e,t,s){const i=xr(s)&&s>0?s:0,{bar:r}=this._chartStore.getBarSpace(),l=r*e-r;if(i>0){let d=0;const v=new O_({duration:i});v.doFrame(p=>{const _=l*(p/i),y=(_-d)/this._chartStore.getBarSpace().bar*W_;this._chartStore.zoom(y,t),d=_}),v.start()}else this._chartStore.zoom(l/r*W_,t)}zoomAtDataIndex(e,t,s){const i=this._chartStore.dataIndexToCoordinate(t);this.zoomAtCoordinate(e,{x:i,y:0},s)}zoomAtTimestamp(e,t,s){const i=V_(this.getDataList(),"timestamp",t);this.zoomAtDataIndex(e,i,s)}convertToPixel(e,t){const{paneId:s=La.CANDLE,absolute:i=!1}=t??{};let r=[];if(s!==La.X_AXIS){const a=this.getDrawPaneById(s);if(a!==null){const l=a.getBounding(),d=[].concat(e),v=this._xAxisPane.getAxisComponent(),p=a.getAxisComponent();r=d.map(_=>{const y={};let w=_.dataIndex;if(xr(_.timestamp)&&(w=this._chartStore.timestampToDataIndex(_.timestamp)),xr(w)&&(y.x=v.convertToPixel(w)),xr(_.value)){const k=p.convertToPixel(_.value);y.y=i?l.top+k:k}return y})}}return op(e)?r:r[0]??{}}convertFromPixel(e,t){const{paneId:s=La.CANDLE,absolute:i=!1}=t??{};let r=[];if(s!==La.X_AXIS){const a=this.getDrawPaneById(s);if(a!==null){const l=a.getBounding(),d=[].concat(e),v=this._xAxisPane.getAxisComponent(),p=a.getAxisComponent();r=d.map(_=>{const y={};if(xr(_.x)){const w=v.convertFromPixel(_.x);y.dataIndex=w,y.timestamp=this._chartStore.dataIndexToTimestamp(w)??void 0}if(xr(_.y)){const w=i?_.y-l.top:_.y;y.value=p.convertFromPixel(w)}return y})}}return op(e)?r:r[0]??{}}executeAction(e,t){switch(e){case"onCrosshairChange":{const s={...t};s.paneId??(s.paneId=La.CANDLE),this._chartStore.setCrosshair(s,{notExecuteAction:!0});break}}}subscribeAction(e,t){this._chartStore.subscribeAction(e,t)}unsubscribeAction(e,t){this._chartStore.unsubscribeAction(e,t)}getConvertPictureUrl(e,t,s){const{width:i,height:r}=this._chartBounding,a=Gp("canvas",{width:`${i}px`,height:`${r}px`,boxSizing:"border-box"}),l=a.getContext("2d"),d=cv(a);a.width=i*d,a.height=r*d,l.scale(d,d),l.fillStyle=s??"#FFFFFF",l.fillRect(0,0,i,r);const v=e??!1;return this._drawPanes.forEach(p=>{const _=this._separatorPanes.get(p);if(mo(_)){const w=_.getBounding();l.drawImage(_.getImage(v),w.left,w.top,w.width,w.height)}const y=p.getBounding();l.drawImage(p.getImage(v),0,y.top,i,y.height)}),a.toDataURL(`image/${t??"jpeg"}`)}resize(){this._cacheChartBounding(),this.layout({measureHeight:!0,measureWidth:!0,update:!0,buildYAxisTick:!0,forceBuildYAxisTick:!0})}destroy(){this._chartEvent.destroy(),this._drawPanes.forEach(e=>{e.destroy()}),this._drawPanes=[],this._separatorPanes.clear(),this._chartStore.destroy(),this._container.removeChild(this._chartContainer)}}const ay=new Map;let N6=1;function R6(o,e){let t=null;if(Dl(o)?t=document.getElementById(o):t=o,t===null)return null;let s=ay.get(t.id);if(mo(s))return s;const i=`k_line_chart_${N6++}`;return s=new B6(t,e),s.id=i,t.setAttribute("k-line-chart-id",i),ay.set(i,s),s}const Yp={clone:vf,merge:rd,isString:Dl,isNumber:xr,isValid:mo,isObject:Cu,isArray:op,isFunction:du,isBoolean:A0,formatValue:fd,formatPrecision:jd,formatBigNumber:A2,formatDate:T2,formatThousands:L2,formatFoldDecimal:F2,calcTextWidth:Bd,getLinearSlopeIntercept:Qm,getLinearYFromSlopeIntercept:l1,getLinearYFromCoordinates:L0,checkCoordinateOnArc:Y2,checkCoordinateOnCircle:V2,checkCoordinateOnLine:$2,checkCoordinateOnPolygon:W2,checkCoordinateOnRect:u1,checkCoordinateOnText:G2},Ee={Solid:"solid",Dashed:"dashed"},of={Fill:"fill",Stroke:"stroke",StrokeFill:"stroke_fill"},Xu={OnZoom:"onZoom",OnScroll:"onScroll",OnVisibleRangeChange:"onVisibleRangeChange",OnCandleTooltipFeatureClick:"onCandleTooltipFeatureClick",OnIndicatorTooltipFeatureClick:"onIndicatorTooltipFeatureClick",OnCrosshairFeatureClick:"onCrosshairFeatureClick",OnCrosshairChange:"onCrosshairChange",OnCandleBarClick:"onCandleBarClick",OnPaneDrag:"onPaneDrag"},O6={Normal:"normal",WeakMagnet:"weak_magnet",StrongMagnet:"strong_magnet"},V6={Left:"left",Middle:"middle",Right:"right"},ly={Always:"always",FollowCross:"follow_cross",None:"none"},W6={CandleSolid:"candle_solid",CandleStroke:"candle_stroke",CandleUpStroke:"candle_up_stroke",CandleDownStroke:"candle_down_stroke",Ohlc:"ohlc",Area:"area"},q6={Tooltip:"tooltip",Crosshair:"crosshair",XAxis:"xAxis"};var v_={local:{},session:{}};function H6(o){return o==="local"?localStorage:sessionStorage}function f1(o,e,t){var s,i,r,a,l,d,v,p;const _=(s=void 0)!=null?s:JSON,y=(i=void 0)!=null?i:"local",w=(r=void 0)!=null?r:!0,k=(l=(a=void 0)!=null?a:void 0)!=null?l:R=>console.error(`Error when writing value from persisted store "${o}" to ${y}`,R),S=(d=void 0)!=null?d:(R,N)=>console.error(`Error when parsing ${R?'"'+R+'"':"value"} from persisted store "${o}"`,N),L=(v=void 0)!=null?v:R=>R,T=(p=void 0)!=null?p:R=>R,P=typeof window<"u"&&typeof document<"u",A=P?H6(y):null;function F(R,N){const $=T(N);try{A==null||A.setItem(R,_.stringify($))}catch(V){k(V)}}function B(){function R(U){try{return _.parse(U)}catch(G){S(U,G)}}const N=A==null?void 0:A.getItem(o);if(N==null)return e;const $=R(N);return $==null?e:L($)}if(!v_[y][o]){const R=B(),N=Id(R,U=>{if(P&&y=="local"&&w){const G=Z=>{if(Z.key===o&&Z.newValue){let le;try{le=_.parse(Z.newValue)}catch(ie){S(Z.newValue,ie);return}const se=L(le);U(se)}};return window.addEventListener("storage",G),()=>window.removeEventListener("storage",G)}}),{subscribe:$,set:V}=N;v_[y][o]={set(U){V(U),F(o,U)},update(U){return N.update(G=>{const Z=U(G);return F(o,Z),Z})},reset(){this.set(e)},subscribe:$}}return v_[y][o]}var Op=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function j0(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var lb={exports:{}};(function(o,e){(function(t,s){o.exports=s()})(Op,function(){var t=1e3,s=6e4,i=36e5,r="millisecond",a="second",l="minute",d="hour",v="day",p="week",_="month",y="quarter",w="year",k="date",S="Invalid Date",L=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,T=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,P={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(se){var ie=["th","st","nd","rd"],Y=se%100;return"["+se+(ie[(Y-20)%10]||ie[Y]||ie[0])+"]"}},A=function(se,ie,Y){var K=String(se);return!K||K.length>=ie?se:""+Array(ie+1-K.length).join(Y)+se},F={s:A,z:function(se){var ie=-se.utcOffset(),Y=Math.abs(ie),K=Math.floor(Y/60),Q=Y%60;return(ie<=0?"+":"-")+A(K,2,"0")+":"+A(Q,2,"0")},m:function se(ie,Y){if(ie.date()<Y.date())return-se(Y,ie);var K=12*(Y.year()-ie.year())+(Y.month()-ie.month()),Q=ie.clone().add(K,_),q=Y-Q<0,ce=ie.clone().add(K+(q?-1:1),_);return+(-(K+(Y-Q)/(q?Q-ce:ce-Q))||0)},a:function(se){return se<0?Math.ceil(se)||0:Math.floor(se)},p:function(se){return{M:_,y:w,w:p,d:v,D:k,h:d,m:l,s:a,ms:r,Q:y}[se]||String(se||"").toLowerCase().replace(/s$/,"")},u:function(se){return se===void 0}},B="en",R={};R[B]=P;var N="$isDayjsObject",$=function(se){return se instanceof Z||!(!se||!se[N])},V=function se(ie,Y,K){var Q;if(!ie)return B;if(typeof ie=="string"){var q=ie.toLowerCase();R[q]&&(Q=q),Y&&(R[q]=Y,Q=q);var ce=ie.split("-");if(!Q&&ce.length>1)return se(ce[0])}else{var _e=ie.name;R[_e]=ie,Q=_e}return!K&&Q&&(B=Q),Q||!K&&B},U=function(se,ie){if($(se))return se.clone();var Y=typeof ie=="object"?ie:{};return Y.date=se,Y.args=arguments,new Z(Y)},G=F;G.l=V,G.i=$,G.w=function(se,ie){return U(se,{locale:ie.$L,utc:ie.$u,x:ie.$x,$offset:ie.$offset})};var Z=function(){function se(Y){this.$L=V(Y.locale,null,!0),this.parse(Y),this.$x=this.$x||Y.x||{},this[N]=!0}var ie=se.prototype;return ie.parse=function(Y){this.$d=function(K){var Q=K.date,q=K.utc;if(Q===null)return new Date(NaN);if(G.u(Q))return new Date;if(Q instanceof Date)return new Date(Q);if(typeof Q=="string"&&!/Z$/i.test(Q)){var ce=Q.match(L);if(ce){var _e=ce[2]-1||0,me=(ce[7]||"0").substring(0,3);return q?new Date(Date.UTC(ce[1],_e,ce[3]||1,ce[4]||0,ce[5]||0,ce[6]||0,me)):new Date(ce[1],_e,ce[3]||1,ce[4]||0,ce[5]||0,ce[6]||0,me)}}return new Date(Q)}(Y),this.init()},ie.init=function(){var Y=this.$d;this.$y=Y.getFullYear(),this.$M=Y.getMonth(),this.$D=Y.getDate(),this.$W=Y.getDay(),this.$H=Y.getHours(),this.$m=Y.getMinutes(),this.$s=Y.getSeconds(),this.$ms=Y.getMilliseconds()},ie.$utils=function(){return G},ie.isValid=function(){return this.$d.toString()!==S},ie.isSame=function(Y,K){var Q=U(Y);return this.startOf(K)<=Q&&Q<=this.endOf(K)},ie.isAfter=function(Y,K){return U(Y)<this.startOf(K)},ie.isBefore=function(Y,K){return this.endOf(K)<U(Y)},ie.$g=function(Y,K,Q){return G.u(Y)?this[K]:this.set(Q,Y)},ie.unix=function(){return Math.floor(this.valueOf()/1e3)},ie.valueOf=function(){return this.$d.getTime()},ie.startOf=function(Y,K){var Q=this,q=!!G.u(K)||K,ce=G.p(Y),_e=function($e,Ve){var Ce=G.w(Q.$u?Date.UTC(Q.$y,Ve,$e):new Date(Q.$y,Ve,$e),Q);return q?Ce:Ce.endOf(v)},me=function($e,Ve){return G.w(Q.toDate()[$e].apply(Q.toDate("s"),(q?[0,0,0,0]:[23,59,59,999]).slice(Ve)),Q)},Pe=this.$W,ze=this.$M,he=this.$D,De="set"+(this.$u?"UTC":"");switch(ce){case w:return q?_e(1,0):_e(31,11);case _:return q?_e(1,ze):_e(0,ze+1);case p:var ge=this.$locale().weekStart||0,be=(Pe<ge?Pe+7:Pe)-ge;return _e(q?he-be:he+(6-be),ze);case v:case k:return me(De+"Hours",0);case d:return me(De+"Minutes",1);case l:return me(De+"Seconds",2);case a:return me(De+"Milliseconds",3);default:return this.clone()}},ie.endOf=function(Y){return this.startOf(Y,!1)},ie.$set=function(Y,K){var Q,q=G.p(Y),ce="set"+(this.$u?"UTC":""),_e=(Q={},Q[v]=ce+"Date",Q[k]=ce+"Date",Q[_]=ce+"Month",Q[w]=ce+"FullYear",Q[d]=ce+"Hours",Q[l]=ce+"Minutes",Q[a]=ce+"Seconds",Q[r]=ce+"Milliseconds",Q)[q],me=q===v?this.$D+(K-this.$W):K;if(q===_||q===w){var Pe=this.clone().set(k,1);Pe.$d[_e](me),Pe.init(),this.$d=Pe.set(k,Math.min(this.$D,Pe.daysInMonth())).$d}else _e&&this.$d[_e](me);return this.init(),this},ie.set=function(Y,K){return this.clone().$set(Y,K)},ie.get=function(Y){return this[G.p(Y)]()},ie.add=function(Y,K){var Q,q=this;Y=Number(Y);var ce=G.p(K),_e=function(ze){var he=U(q);return G.w(he.date(he.date()+Math.round(ze*Y)),q)};if(ce===_)return this.set(_,this.$M+Y);if(ce===w)return this.set(w,this.$y+Y);if(ce===v)return _e(1);if(ce===p)return _e(7);var me=(Q={},Q[l]=s,Q[d]=i,Q[a]=t,Q)[ce]||1,Pe=this.$d.getTime()+Y*me;return G.w(Pe,this)},ie.subtract=function(Y,K){return this.add(-1*Y,K)},ie.format=function(Y){var K=this,Q=this.$locale();if(!this.isValid())return Q.invalidDate||S;var q=Y||"YYYY-MM-DDTHH:mm:ssZ",ce=G.z(this),_e=this.$H,me=this.$m,Pe=this.$M,ze=Q.weekdays,he=Q.months,De=Q.meridiem,ge=function(Ve,Ce,Je,ye){return Ve&&(Ve[Ce]||Ve(K,q))||Je[Ce].slice(0,ye)},be=function(Ve){return G.s(_e%12||12,Ve,"0")},$e=De||function(Ve,Ce,Je){var ye=Ve<12?"AM":"PM";return Je?ye.toLowerCase():ye};return q.replace(T,function(Ve,Ce){return Ce||function(Je){switch(Je){case"YY":return String(K.$y).slice(-2);case"YYYY":return G.s(K.$y,4,"0");case"M":return Pe+1;case"MM":return G.s(Pe+1,2,"0");case"MMM":return ge(Q.monthsShort,Pe,he,3);case"MMMM":return ge(he,Pe);case"D":return K.$D;case"DD":return G.s(K.$D,2,"0");case"d":return String(K.$W);case"dd":return ge(Q.weekdaysMin,K.$W,ze,2);case"ddd":return ge(Q.weekdaysShort,K.$W,ze,3);case"dddd":return ze[K.$W];case"H":return String(_e);case"HH":return G.s(_e,2,"0");case"h":return be(1);case"hh":return be(2);case"a":return $e(_e,me,!0);case"A":return $e(_e,me,!1);case"m":return String(me);case"mm":return G.s(me,2,"0");case"s":return String(K.$s);case"ss":return G.s(K.$s,2,"0");case"SSS":return G.s(K.$ms,3,"0");case"Z":return ce}return null}(Ve)||ce.replace(":","")})},ie.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},ie.diff=function(Y,K,Q){var q,ce=this,_e=G.p(K),me=U(Y),Pe=(me.utcOffset()-this.utcOffset())*s,ze=this-me,he=function(){return G.m(ce,me)};switch(_e){case w:q=he()/12;break;case _:q=he();break;case y:q=he()/3;break;case p:q=(ze-Pe)/6048e5;break;case v:q=(ze-Pe)/864e5;break;case d:q=ze/i;break;case l:q=ze/s;break;case a:q=ze/t;break;default:q=ze}return Q?q:G.a(q)},ie.daysInMonth=function(){return this.endOf(_).$D},ie.$locale=function(){return R[this.$L]},ie.locale=function(Y,K){if(!Y)return this.$L;var Q=this.clone(),q=V(Y,K,!0);return q&&(Q.$L=q),Q},ie.clone=function(){return G.w(this.$d,this)},ie.toDate=function(){return new Date(this.valueOf())},ie.toJSON=function(){return this.isValid()?this.toISOString():null},ie.toISOString=function(){return this.$d.toISOString()},ie.toString=function(){return this.$d.toUTCString()},se}(),le=Z.prototype;return U.prototype=le,[["$ms",r],["$s",a],["$m",l],["$H",d],["$W",v],["$M",_],["$y",w],["$D",k]].forEach(function(se){le[se[1]]=function(ie){return this.$g(ie,se[0],se[1])}}),U.extend=function(se,ie){return se.$i||(se(ie,Z,U),se.$i=!0),U},U.locale=V,U.isDayjs=$,U.unix=function(se){return U(1e3*se)},U.en=R[B],U.Ls=R,U.p={},U})})(lb);var G6=lb.exports;const su=j0(G6);var cb={exports:{}};(function(o,e){(function(t,s){o.exports=s()})(Op,function(){var t={year:0,month:1,day:2,hour:3,minute:4,second:5},s={};return function(i,r,a){var l,d=function(y,w,k){k===void 0&&(k={});var S=new Date(y),L=function(T,P){P===void 0&&(P={});var A=P.timeZoneName||"short",F=T+"|"+A,B=s[F];return B||(B=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:T,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:A}),s[F]=B),B}(w,k);return L.formatToParts(S)},v=function(y,w){for(var k=d(y,w),S=[],L=0;L<k.length;L+=1){var T=k[L],P=T.type,A=T.value,F=t[P];F>=0&&(S[F]=parseInt(A,10))}var B=S[3],R=B===24?0:B,N=S[0]+"-"+S[1]+"-"+S[2]+" "+R+":"+S[4]+":"+S[5]+":000",$=+y;return(a.utc(N).valueOf()-($-=$%1e3))/6e4},p=r.prototype;p.tz=function(y,w){y===void 0&&(y=l);var k,S=this.utcOffset(),L=this.toDate(),T=L.toLocaleString("en-US",{timeZone:y}),P=Math.round((L-new Date(T))/1e3/60),A=15*-Math.round(L.getTimezoneOffset()/15)-P;if(!Number(A))k=this.utcOffset(0,w);else if(k=a(T,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(A,!0),w){var F=k.utcOffset();k=k.add(S-F,"minute")}return k.$x.$timezone=y,k},p.offsetName=function(y){var w=this.$x.$timezone||a.tz.guess(),k=d(this.valueOf(),w,{timeZoneName:y}).find(function(S){return S.type.toLowerCase()==="timezonename"});return k&&k.value};var _=p.startOf;p.startOf=function(y,w){if(!this.$x||!this.$x.$timezone)return _.call(this,y,w);var k=a(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return _.call(k,y,w).tz(this.$x.$timezone,!0)},a.tz=function(y,w,k){var S=k&&w,L=k||w||l,T=v(+a(),L);if(typeof y!="string")return a(y).tz(L);var P=function(R,N,$){var V=R-60*N*1e3,U=v(V,$);if(N===U)return[V,N];var G=v(V-=60*(U-N)*1e3,$);return U===G?[V,U]:[R-60*Math.min(U,G)*1e3,Math.max(U,G)]}(a.utc(y,S).valueOf(),T,L),A=P[0],F=P[1],B=a(A).utcOffset(F);return B.$x.$timezone=L,B},a.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},a.tz.setDefault=function(y){l=y}}})})(cb);var Y6=cb.exports;const U6=j0(Y6);var db={exports:{}};(function(o,e){(function(t,s){o.exports=s()})(Op,function(){var t="minute",s=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(r,a,l){var d=a.prototype;l.utc=function(S){var L={date:S,utc:!0,args:arguments};return new a(L)},d.utc=function(S){var L=l(this.toDate(),{locale:this.$L,utc:!0});return S?L.add(this.utcOffset(),t):L},d.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var v=d.parse;d.parse=function(S){S.utc&&(this.$u=!0),this.$utils().u(S.$offset)||(this.$offset=S.$offset),v.call(this,S)};var p=d.init;d.init=function(){if(this.$u){var S=this.$d;this.$y=S.getUTCFullYear(),this.$M=S.getUTCMonth(),this.$D=S.getUTCDate(),this.$W=S.getUTCDay(),this.$H=S.getUTCHours(),this.$m=S.getUTCMinutes(),this.$s=S.getUTCSeconds(),this.$ms=S.getUTCMilliseconds()}else p.call(this)};var _=d.utcOffset;d.utcOffset=function(S,L){var T=this.$utils().u;if(T(S))return this.$u?0:T(this.$offset)?_.call(this):this.$offset;if(typeof S=="string"&&(S=function(B){B===void 0&&(B="");var R=B.match(s);if(!R)return null;var N=(""+R[0]).match(i)||["-",0,0],$=N[0],V=60*+N[1]+ +N[2];return V===0?0:$==="+"?V:-V}(S),S===null))return this;var P=Math.abs(S)<=16?60*S:S,A=this;if(L)return A.$offset=P,A.$u=S===0,A;if(S!==0){var F=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(A=this.local().add(P+F,t)).$offset=P,A.$x.$localOffset=F}else A=this.utc();return A};var y=d.format;d.format=function(S){var L=S||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return y.call(this,L)},d.valueOf=function(){var S=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*S},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var w=d.toDate;d.toDate=function(S){return S==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():w.call(this)};var k=d.diff;d.diff=function(S,L,T){if(S&&this.$u===S.$u)return k.call(this,S,L,T);var P=this.local(),A=l(S).local();return k.call(P,A,L,T)}}})})(db);var K6=db.exports;const Z6=j0(K6),v0=q6,$u=Yp.formatDate;let g1=!0,m1="UTC";su.extend(U6);su.extend(Z6);su.tz.setDefault("UTC");const H_=60,G_=H_*60,F0=G_*24,cy=F0*7,dy=F0*30,uy=F0*365,X6={"Africa/Abidjan":"utc","Pacific/Honolulu":"honolulu","America/Juneau":"juneau","America/Los_Angeles":"los_angeles","America/Chicago":"chicago","America/Toronto":"toronto","America/Sao_Paulo":"sao_paulo","Europe/London":"london","Europe/Berlin":"berlin","Asia/Bahrain":"bahrain","Asia/Dubai":"dubai","Asia/Ashkhabad":"ashkhabad","Asia/Almaty":"almaty","Asia/Bangkok":"bangkok","Asia/Shanghai":"shanghai","Asia/Tokyo":"tokyo","Australia/Sydney":"sydney","Pacific/Guadalcanal":"guadalcanal","Pacific/Auckland":"auckland"};function J6(){return su().valueOf()}function py(o){if(!o)return 0;o=o.trim();const e=/^\d+$/.test(o);let t=null;if(e){const s=o.length;if(s==4){const i=new Date().getFullYear();t=su(`${i}${o}`,"YYYYMMDD")}else if(s==6){const i=parseInt(o.substring(0,2)),r=i>50?1900+i:2e3+i,a=o.substring(2);t=su(`${r}${a}`,"YYYYMMDD")}else if(s==8)t=su(o,"YYYYMMDD");else if(s==10)t=su.unix(parseInt(o));else if(s==12)t=su(o,"YYYYMMDDHHmm");else if(s==13)t=su(parseInt(o));else if(s==14)t=su(o,"YYYYMMDDHHmmss");else return console.error("invalid date format:",o),0}else t=su(o,["YYYY/MM/DD","YYYY/MM/DD HH:mm","YYYY/MM/DD HH:mm:ss","YYYY-MM-DD","YYYY-MM-DD HH:mm","YYYY-MM-DD HH:mm:ss"],!0);return!t||!t.isValid()?(console.error("Invalid date format or value:",o),0):(g1||console.error("local timezone not applied"),t=t.tz(m1,!0),t.valueOf())}function vy(o,e="YYYY-MM-DD HH:mm:ss",t=void 0){if(!o)return"--";let s=null;return o>1e12?s=su(o):s=su.unix(o),s=s.tz(t||m1,!0),g1||console.error("local timezone not applied"),s.format(e)}function Q6(o,e,t){let s=e,i=s;switch(o.timespan){case"minute":{s=s-s%(60*1e3),i=s-t*o.multiplier*60*1e3;break}case"hour":{s=s-s%(60*60*1e3),i=s-t*o.multiplier*60*60*1e3;break}case"day":{s=s-s%(60*60*1e3),i=s-t*o.multiplier*24*60*60*1e3;break}case"week":{const a=new Date(s).getDay(),l=a===0?6:a-1;s=s-l*60*60*24;const d=new Date(s);s=new Date(`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`).getTime(),i=t*o.multiplier*7*24*60*60*1e3;break}case"month":{const r=new Date(s),a=r.getFullYear(),l=r.getMonth()+1;s=new Date(`${a}-${l}-01`).getTime(),i=t*o.multiplier*30*24*60*60*1e3;const d=new Date(i);i=new Date(`${d.getFullYear()}-${d.getMonth()+1}-01`).getTime();break}}return[i,s]}function I0(o){if(!o)return 0;const e=o.substring(o.length-1),t=parseInt(o.substring(0,o.length-1));let s=0;if(e=="y")s=31536e3;else if(e=="M")s=2592e3;else if(e=="w")s=604800;else if(e=="d")s=86400;else if(e=="h")s=3600;else if(e=="m")s=60;else if(e=="s")s=1;else throw Error(`unsupport timeframe: ${o}`);return s*t}function ek(o){return o>uy?`${Math.floor(o/uy)}y`:o>dy?`${Math.floor(o/dy)}M`:o>cy?`${Math.floor(o/cy)}w`:o>F0?`${Math.floor(o/F0)}d`:o>G_?`${Math.floor(o/G_)}h`:o>H_?`${Math.floor(o/H_)}m`:`${Math.floor(o)}s`}function tk(o){const e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};let t=null;try{t=new Intl.DateTimeFormat("en",e)}catch{console.error("","","Timezone is error!!!")}return t}const ju=tk();function fy(o){function e(t,s,i){if(!t||isNaN(t)||t<=0)return new Date().toISOString().slice(0,19).replace("T"," ");switch(o){case"second":return i===v0.XAxis?$u(ju,t,"HH:mm:ss"):$u(ju,t,"YYYY-MM-DD HH:mm:ss");case"minute":return i===v0.XAxis?$u(ju,t,"HH:mm"):$u(ju,t,"YYYY-MM-DD HH:mm");case"hour":return i===v0.XAxis?$u(ju,t,"MM-DD HH:mm"):$u(ju,t,"YYYY-MM-DD HH:mm");case"day":case"week":return $u(ju,t,"YYYY-MM-DD");case"month":return i===v0.XAxis?$u(ju,t,"YYYY-MM"):$u(ju,t,"YYYY-MM-DD");case"year":return i===v0.XAxis?$u(ju,t,"YYYY"):$u(ju,t,"YYYY-MM-DD")}return $u(ju,t,"YYYY-MM-DD HH:mm")}return e}async function gy(o){o&&(o=="Africa/Abidjan"||o.toLowerCase().indexOf("utc")>=0)&&(o="UTC"),su.tz.setDefault(o),m1=o,g1=!0}function ok(){return Object.entries(X6).map(([o,e])=>({key:o,text:e}))}const sk=()=>"Time",nk=()=>"时间",ik=(o={},e={})=>({en:sk,"zh-CN":nk})[e.languageTag??Lo()](),rk=()=>"O",ak=()=>"开",lk=(o={},e={})=>({en:rk,"zh-CN":ak})[e.languageTag??Lo()](),ck=()=>"H",dk=()=>"高",uk=(o={},e={})=>({en:ck,"zh-CN":dk})[e.languageTag??Lo()](),pk=()=>"L",vk=()=>"低",fk=(o={},e={})=>({en:pk,"zh-CN":vk})[e.languageTag??Lo()](),gk=()=>"C",mk=()=>"收",hk=(o={},e={})=>({en:gk,"zh-CN":mk})[e.languageTag??Lo()](),_k=()=>"vol",yk=()=>"量",bk=(o={},e={})=>({en:_k,"zh-CN":yk})[e.languageTag??Lo()](),xk=()=>"Chg",wk=()=>"涨跌",kk=(o={},e={})=>({en:xk,"zh-CN":wk})[e.languageTag??Lo()](),Sk=()=>"Timeframe",Ck=()=>"周期",ub=(o={},e={})=>({en:Sk,"zh-CN":Ck})[e.languageTag??Lo()](),Pk=()=>"No Data",Ik=()=>"数据为空",Mk=(o={},e={})=>({en:Pk,"zh-CN":Ik})[e.languageTag??Lo()](),Tk=()=>"Indicator",Ak=()=>"指标",h1=(o={},e={})=>({en:Tk,"zh-CN":Ak})[e.languageTag??Lo()](),Lk=()=>"Timezone",Fk=()=>"时区",pb=(o={},e={})=>({en:Lk,"zh-CN":Fk})[e.languageTag??Lo()](),Dk=()=>"Setting",Ek=()=>"设置",$k=(o={},e={})=>({en:Dk,"zh-CN":Ek})[e.languageTag??Lo()](),jk=()=>"Confirm",zk=()=>"确认",Bk=(o={},e={})=>({en:jk,"zh-CN":zk})[e.languageTag??Lo()](),Nk=()=>"Cancel",Rk=()=>"取消",Ok=(o={},e={})=>({en:Nk,"zh-CN":Rk})[e.languageTag??Lo()](),Vk=()=>"Search Symbol",Wk=()=>"搜索品种",vb=(o={},e={})=>({en:Vk,"zh-CN":Wk})[e.languageTag??Lo()](),qk=()=>"This indicator has no parameters",Hk=()=>"该指标没有参数",fb=(o={},e={})=>({en:qk,"zh-CN":Hk})[e.languageTag??Lo()](),Gk=()=>"Search",Yk=()=>"搜索",gb=(o={},e={})=>({en:Gk,"zh-CN":Yk})[e.languageTag??Lo()](),Uk=()=>"Settings",Kk=()=>"设置",mb=(o={},e={})=>({en:Uk,"zh-CN":Kk})[e.languageTag??Lo()](),Zk=()=>"Screenshot",Xk=()=>"截图",Jk=(o={},e={})=>({en:Zk,"zh-CN":Xk})[e.languageTag??Lo()](),Qk=()=>"Grid Show",e8=()=>"显示网格",t8=(o={},e={})=>({en:Qk,"zh-CN":e8})[e.languageTag??Lo()](),o8=()=>"Restore",s8=()=>"恢复",n8=(o={},e={})=>({en:o8,"zh-CN":s8})[e.languageTag??Lo()](),i8=()=>"Reset",r8=()=>"重置",a8=(o={},e={})=>({en:i8,"zh-CN":r8})[e.languageTag??Lo()](),l8=()=>"Candlestick Type",c8=()=>"蜡烛图类型",d8=(o={},e={})=>({en:l8,"zh-CN":c8})[e.languageTag??Lo()](),u8=()=>"Candlestick",p8=()=>"全实心",v8=(o={},e={})=>({en:u8,"zh-CN":p8})[e.languageTag??Lo()](),f8=()=>"Hollow",g8=()=>"全空心",m8=(o={},e={})=>({en:f8,"zh-CN":g8})[e.languageTag??Lo()](),h8=()=>"Up Hollow",_8=()=>"涨空心",y8=(o={},e={})=>({en:h8,"zh-CN":_8})[e.languageTag??Lo()](),b8=()=>"Down Hollow",x8=()=>"跌空心",w8=(o={},e={})=>({en:b8,"zh-CN":x8})[e.languageTag??Lo()](),k8=()=>"OHLC",S8=()=>"OHLC",C8=(o={},e={})=>({en:k8,"zh-CN":S8})[e.languageTag??Lo()](),P8=()=>"Area",I8=()=>"面积图",M8=(o={},e={})=>({en:P8,"zh-CN":I8})[e.languageTag??Lo()](),T8=()=>"Price Axis Type",A8=()=>"价格轴类型",L8=(o={},e={})=>({en:T8,"zh-CN":A8})[e.languageTag??Lo()](),F8=()=>"Reverse Coordinate",D8=()=>"反转坐标",E8=(o={},e={})=>({en:F8,"zh-CN":D8})[e.languageTag??Lo()](),$8=()=>"Show Last Price",j8=()=>"显示最新价",z8=(o={},e={})=>({en:$8,"zh-CN":j8})[e.languageTag??Lo()](),B8=()=>"Show High Price",N8=()=>"显示最高价",R8=(o={},e={})=>({en:B8,"zh-CN":N8})[e.languageTag??Lo()](),O8=()=>"Show Low Price",V8=()=>"显示最低价",W8=(o={},e={})=>({en:O8,"zh-CN":V8})[e.languageTag??Lo()](),q8=()=>"Show Indicator Last Value",H8=()=>"显示指标最新值",G8=(o={},e={})=>({en:q8,"zh-CN":H8})[e.languageTag??Lo()](),Y8=()=>"Param ",U8=()=>"参数",hb=(o={},e={})=>({en:Y8,"zh-CN":U8})[e.languageTag??Lo()](),K8=()=>"Period",Z8=()=>"周期",Y_=(o={},e={})=>({en:K8,"zh-CN":Z8})[e.languageTag??Lo()](),X8=()=>"StdDev",J8=()=>"标准差",_b=(o={},e={})=>({en:X8,"zh-CN":J8})[e.languageTag??Lo()](),Q8=()=>"Normal",e4=()=>"正常",t4=(o={},e={})=>({en:Q8,"zh-CN":e4})[e.languageTag??Lo()](),o4=()=>"Percentage",s4=()=>"百分比",n4=(o={},e={})=>({en:o4,"zh-CN":s4})[e.languageTag??Lo()](),i4=()=>"Log",r4=()=>"对数",a4=(o={},e={})=>({en:i4,"zh-CN":r4})[e.languageTag??Lo()](),l4=()=>" Bars",c4=()=>"根",yb=(o={},e={})=>({en:l4,"zh-CN":c4})[e.languageTag??Lo()](),d4=()=>"days",u4=()=>"天",bb=(o={},e={})=>({en:d4,"zh-CN":u4})[e.languageTag??Lo()](),p4=()=>"hours",v4=()=>"时",xb=(o={},e={})=>({en:p4,"zh-CN":v4})[e.languageTag??Lo()](),f4=()=>"mins",g4=()=>"分",U_=(o={},e={})=>({en:f4,"zh-CN":g4})[e.languageTag??Lo()](),m4=()=>"Minutes",h4=()=>"分钟",wb=(o={},e={})=>({en:m4,"zh-CN":h4})[e.languageTag??Lo()](),_4=()=>"Hours",y4=()=>"小时",kb=(o={},e={})=>({en:_4,"zh-CN":y4})[e.languageTag??Lo()](),b4=()=>"Days",x4=()=>"日",Sb=(o={},e={})=>({en:b4,"zh-CN":x4})[e.languageTag??Lo()](),w4=()=>"Weeks",k4=()=>"周",Cb=(o={},e={})=>({en:w4,"zh-CN":k4})[e.languageTag??Lo()](),S4=()=>"Months",C4=()=>"月",Pb=(o={},e={})=>({en:S4,"zh-CN":C4})[e.languageTag??Lo()](),P4=()=>"Horizontal Straight Line",I4=()=>"水平直线",M4=(o={},e={})=>({en:P4,"zh-CN":I4})[e.languageTag??Lo()](),T4=()=>"Horizontal Ray Line",A4=()=>"水平射线",L4=(o={},e={})=>({en:T4,"zh-CN":A4})[e.languageTag??Lo()](),F4=()=>"Horizontal Segment",D4=()=>"水平线段",E4=(o={},e={})=>({en:F4,"zh-CN":D4})[e.languageTag??Lo()](),$4=()=>"Vertical Straight Line",j4=()=>"垂直直线",z4=(o={},e={})=>({en:$4,"zh-CN":j4})[e.languageTag??Lo()](),B4=()=>"Vertical Ray Line",N4=()=>"垂直射线",R4=(o={},e={})=>({en:B4,"zh-CN":N4})[e.languageTag??Lo()](),O4=()=>"Vertical Segment",V4=()=>"垂直线段",W4=(o={},e={})=>({en:O4,"zh-CN":V4})[e.languageTag??Lo()](),q4=()=>"Straight Line",H4=()=>"直线",G4=(o={},e={})=>({en:q4,"zh-CN":H4})[e.languageTag??Lo()](),Y4=()=>"Ray Line",U4=()=>"射线",K4=(o={},e={})=>({en:Y4,"zh-CN":U4})[e.languageTag??Lo()](),Z4=()=>"Segment",X4=()=>"线段",J4=(o={},e={})=>({en:Z4,"zh-CN":X4})[e.languageTag??Lo()](),Q4=()=>"Arrow",e9=()=>"箭头",t9=(o={},e={})=>({en:Q4,"zh-CN":e9})[e.languageTag??Lo()](),o9=()=>"Price Line",s9=()=>"价格线",n9=(o={},e={})=>({en:o9,"zh-CN":s9})[e.languageTag??Lo()](),i9=()=>"Price Channel Line",r9=()=>"价格通道线",a9=(o={},e={})=>({en:i9,"zh-CN":r9})[e.languageTag??Lo()](),l9=()=>"Parallel Straight Line",c9=()=>"平行直线",d9=(o={},e={})=>({en:l9,"zh-CN":c9})[e.languageTag??Lo()](),u9=()=>"Fibonacci Retracement Segment",p9=()=>"斐波那契回调线段",v9=(o={},e={})=>({en:u9,"zh-CN":p9})[e.languageTag??Lo()](),f9=()=>"Fibonacci Circle",g9=()=>"斐波那契圆环",m9=(o={},e={})=>({en:f9,"zh-CN":g9})[e.languageTag??Lo()](),h9=()=>"Fibonacci Spiral",_9=()=>"斐波那契螺旋",y9=(o={},e={})=>({en:h9,"zh-CN":_9})[e.languageTag??Lo()](),b9=()=>"Fibonacci Speed Resistance Fan",x9=()=>"斐波那契速度阻力扇",w9=(o={},e={})=>({en:b9,"zh-CN":x9})[e.languageTag??Lo()](),k9=()=>"Fibonacci Extension",S9=()=>"斐波那契趋势扩展",C9=(o={},e={})=>({en:k9,"zh-CN":S9})[e.languageTag??Lo()](),P9=()=>"Gann Box",I9=()=>"江恩箱",M9=(o={},e={})=>({en:P9,"zh-CN":I9})[e.languageTag??Lo()](),T9=()=>"Rectangle",A9=()=>"矩形",L9=(o={},e={})=>({en:T9,"zh-CN":A9})[e.languageTag??Lo()](),F9=()=>"Parallelogram",D9=()=>"平行四边形",E9=(o={},e={})=>({en:F9,"zh-CN":D9})[e.languageTag??Lo()](),$9=()=>"Circle",j9=()=>"圆",z9=(o={},e={})=>({en:$9,"zh-CN":j9})[e.languageTag??Lo()](),B9=()=>"Triangle",N9=()=>"三角形",R9=(o={},e={})=>({en:B9,"zh-CN":N9})[e.languageTag??Lo()](),O9=()=>"Three Waves",V9=()=>"三浪",W9=(o={},e={})=>({en:O9,"zh-CN":V9})[e.languageTag??Lo()](),q9=()=>"Five Waves",H9=()=>"五浪",G9=(o={},e={})=>({en:q9,"zh-CN":H9})[e.languageTag??Lo()](),Y9=()=>"Eight Waves",U9=()=>"八浪",K9=(o={},e={})=>({en:Y9,"zh-CN":U9})[e.languageTag??Lo()](),Z9=()=>"Any Waves",X9=()=>"任意浪",J9=(o={},e={})=>({en:Z9,"zh-CN":X9})[e.languageTag??Lo()](),Q9=()=>"ABCD Pattern",eS=()=>"ABCD形态",tS=(o={},e={})=>({en:Q9,"zh-CN":eS})[e.languageTag??Lo()](),oS=()=>"XABCD Pattern",sS=()=>"XABCD形态",nS=(o={},e={})=>({en:oS,"zh-CN":sS})[e.languageTag??Lo()](),iS=()=>"Weak Magnet Mode",rS=()=>"弱磁模式",aS=(o={},e={})=>({en:iS,"zh-CN":rS})[e.languageTag??Lo()](),lS=()=>"Strong Magnet Mode",cS=()=>"强磁模式",dS=(o={},e={})=>({en:lS,"zh-CN":cS})[e.languageTag??Lo()](),uS=()=>"Moving Average",pS=()=>"移动平均",vS=(o={},e={})=>({en:uS,"zh-CN":pS})[e.languageTag??Lo()](),fS=()=>"Exponential Moving Average",gS=()=>"指数移动平均",mS=(o={},e={})=>({en:fS,"zh-CN":gS})[e.languageTag??Lo()](),hS=()=>"Simple Moving Average",_S=()=>"简单移动平均",yS=(o={},e={})=>({en:hS,"zh-CN":_S})[e.languageTag??Lo()](),bS=()=>"Bollinger Bands",xS=()=>"布林线",wS=(o={},e={})=>({en:bS,"zh-CN":xS})[e.languageTag??Lo()](),kS=()=>"Parabolic SAR",SS=()=>"抛物线转向",CS=(o={},e={})=>({en:kS,"zh-CN":SS})[e.languageTag??Lo()](),PS=()=>"Bull and Bear Index",IS=()=>"多空指标",MS=(o={},e={})=>({en:PS,"zh-CN":IS})[e.languageTag??Lo()](),TS=()=>"Volume",AS=()=>"成交量",LS=(o={},e={})=>({en:TS,"zh-CN":AS})[e.languageTag??Lo()](),FS=()=>"Moving Average Convergence Divergence",DS=()=>"平滑异同移动平均线",ES=(o={},e={})=>({en:FS,"zh-CN":DS})[e.languageTag??Lo()](),$S=()=>"KDJ Index",jS=()=>"随机指标",zS=(o={},e={})=>({en:$S,"zh-CN":jS})[e.languageTag??Lo()](),BS=()=>"Relative Strength Index",NS=()=>"相对强弱指数",RS=(o={},e={})=>({en:BS,"zh-CN":NS})[e.languageTag??Lo()](),OS=()=>"Bias",VS=()=>"乖离率",WS=(o={},e={})=>({en:OS,"zh-CN":VS})[e.languageTag??Lo()](),qS=()=>"Bull and Bear Ratio",HS=()=>"人气意愿指标",GS=(o={},e={})=>({en:qS,"zh-CN":HS})[e.languageTag??Lo()](),YS=()=>"Commodity Channel Index",US=()=>"顺势指标",KS=(o={},e={})=>({en:YS,"zh-CN":US})[e.languageTag??Lo()](),ZS=()=>"Energy",XS=()=>"能量指标",JS=(o={},e={})=>({en:ZS,"zh-CN":XS})[e.languageTag??Lo()](),QS=()=>"Psychological Line",eC=()=>"心理线",tC=(o={},e={})=>({en:QS,"zh-CN":eC})[e.languageTag??Lo()](),oC=()=>"Parallel Line Difference",sC=()=>"平行线差指标",nC=(o={},e={})=>({en:oC,"zh-CN":sC})[e.languageTag??Lo()](),iC=()=>"Triple Exponential Moving Average",rC=()=>"三重指数平滑移动平均线",aC=(o={},e={})=>({en:iC,"zh-CN":rC})[e.languageTag??Lo()](),lC=()=>"On Balance Volume",cC=()=>"能量潮",dC=(o={},e={})=>({en:lC,"zh-CN":cC})[e.languageTag??Lo()](),uC=()=>"Volume Variation Rate",pC=()=>"成交量变异率",vC=(o={},e={})=>({en:uC,"zh-CN":pC})[e.languageTag??Lo()](),fC=()=>"Williams Percentage Range",gC=()=>"威廉指标",mC=(o={},e={})=>({en:fC,"zh-CN":gC})[e.languageTag??Lo()](),hC=()=>"Momentum",_C=()=>"动量指标",yC=(o={},e={})=>({en:hC,"zh-CN":_C})[e.languageTag??Lo()](),bC=()=>"Ease of Movement",xC=()=>"简易波动指标",wC=(o={},e={})=>({en:bC,"zh-CN":xC})[e.languageTag??Lo()](),kC=()=>"Rate of Change",SC=()=>"变动率指标",CC=(o={},e={})=>({en:kC,"zh-CN":SC})[e.languageTag??Lo()](),PC=()=>"Price Volume Trend",IC=()=>"量价趋势",MC=(o={},e={})=>({en:PC,"zh-CN":IC})[e.languageTag??Lo()](),TC=()=>"Awesome Oscillator",AC=()=>"震荡指标",LC=(o={},e={})=>({en:TC,"zh-CN":AC})[e.languageTag??Lo()](),FC=()=>"Directional Movement Index",DC=()=>"趋向指标",EC=(o={},e={})=>({en:FC,"zh-CN":DC})[e.languageTag??Lo()](),$C=()=>"Coordinated Universal Time (UTC)",jC=()=>"世界统一时间",zC=(o={},e={})=>({en:$C,"zh-CN":jC})[e.languageTag??Lo()](),BC=()=>"(UTC-10) Honolulu",NC=()=>"(UTC-10) 檀香山",RC=(o={},e={})=>({en:BC,"zh-CN":NC})[e.languageTag??Lo()](),OC=()=>"(UTC-8) Juneau",VC=()=>"(UTC-8) 朱诺",WC=(o={},e={})=>({en:OC,"zh-CN":VC})[e.languageTag??Lo()](),qC=()=>"(UTC-7) Los Angeles",HC=()=>"(UTC-7) 洛杉矶",GC=(o={},e={})=>({en:qC,"zh-CN":HC})[e.languageTag??Lo()](),YC=()=>"(UTC-5) Chicago",UC=()=>"(UTC-5) 芝加哥",KC=(o={},e={})=>({en:YC,"zh-CN":UC})[e.languageTag??Lo()](),ZC=()=>"(UTC-4) Toronto",XC=()=>"(UTC-4) 多伦多",JC=(o={},e={})=>({en:ZC,"zh-CN":XC})[e.languageTag??Lo()](),QC=()=>"(UTC-3) São Paulo",e7=()=>"(UTC-3) 圣保罗",t7=(o={},e={})=>({en:QC,"zh-CN":e7})[e.languageTag??Lo()](),o7=()=>"(UTC+1) London",s7=()=>"(UTC+1) 伦敦",n7=(o={},e={})=>({en:o7,"zh-CN":s7})[e.languageTag??Lo()](),i7=()=>"(UTC+2) Berlin",r7=()=>"(UTC+2) 柏林",a7=(o={},e={})=>({en:i7,"zh-CN":r7})[e.languageTag??Lo()](),l7=()=>"(UTC+3) Bahrain",c7=()=>"(UTC+3) 巴林",d7=(o={},e={})=>({en:l7,"zh-CN":c7})[e.languageTag??Lo()](),u7=()=>"(UTC+4) Dubai",p7=()=>"(UTC+4) 迪拜",v7=(o={},e={})=>({en:u7,"zh-CN":p7})[e.languageTag??Lo()](),f7=()=>"(UTC+5) Ashkhabad",g7=()=>"(UTC+5) 阿什哈巴德",m7=(o={},e={})=>({en:f7,"zh-CN":g7})[e.languageTag??Lo()](),h7=()=>"(UTC+6) Almaty",_7=()=>"(UTC+6) 阿拉木图",y7=(o={},e={})=>({en:h7,"zh-CN":_7})[e.languageTag??Lo()](),b7=()=>"(UTC+7) Bangkok",x7=()=>"(UTC+7) 曼谷",w7=(o={},e={})=>({en:b7,"zh-CN":x7})[e.languageTag??Lo()](),k7=()=>"(UTC+8) Shanghai",S7=()=>"(UTC+8) 上海",C7=(o={},e={})=>({en:k7,"zh-CN":S7})[e.languageTag??Lo()](),P7=()=>"(UTC+9) Tokyo",I7=()=>"(UTC+9) 东京",M7=(o={},e={})=>({en:P7,"zh-CN":I7})[e.languageTag??Lo()](),T7=()=>"(UTC+10) Sydney",A7=()=>"(UTC+10) 悉尼",L7=(o={},e={})=>({en:T7,"zh-CN":A7})[e.languageTag??Lo()](),F7=()=>"(UTC+11) Solomon Islands",D7=()=>"(UTC+11) 所罗门群岛",E7=(o={},e={})=>({en:F7,"zh-CN":D7})[e.languageTag??Lo()](),$7=()=>"(UTC+12) Auckland",j7=()=>"(UTC+12) 奥克兰",z7=(o={},e={})=>({en:$7,"zh-CN":j7})[e.languageTag??Lo()](),Nu=Object.freeze(Object.defineProperty({__proto__:null,AO:LC,BBI:MS,BIAS:WS,BOLL:wS,BRAR:GS,CCI:KS,CR:JS,DMA:nC,DMI:EC,EMA:mS,EMV:wC,KDJ:zS,MA:vS,MACD:ES,MTM:yC,OBV:dC,PSY:tC,PVT:MC,ROC:CC,RSI:RS,SAR:CS,SMA:yS,TRIX:aC,VOL:LS,VR:vC,WR:mC,abcd:tS,almaty:y7,any_waves:J9,area:M8,arrow:t9,ashkhabad:m7,auckland:z7,bahrain:d7,bangkok:w7,berlin:a7,cancel:Ok,candle_down_stroke:w8,candle_solid:v8,candle_stroke:m8,candle_type:d8,candle_up_stroke:y8,change_:kk,chicago:KC,circle:z9,close_:hk,confirm:Bk,day:Sb,days:bb,dubai:v7,eight_waves:K9,fibonacci_circle:m9,fibonacci_extension:C9,fibonacci_segment:v9,fibonacci_speed_resistance_fan:w9,fibonacci_spiral:y9,five_waves:G9,gann_box:M9,grid_show:t8,guadalcanal:E7,high_:uk,high_price_show:R8,honolulu:RC,horizontal_ray_line:L4,horizontal_segment:E4,horizontal_straight_line:M4,hour:kb,hours:xb,indicator:h1,indicator_last_value_show:G8,juneau:WC,last_price_show:z8,log:a4,london:n7,los_angeles:GC,low_:fk,low_price_show:W8,mins:U_,minute:wb,month:Pb,no_data:Mk,no_ind_params:fb,normal:t4,num_bar:yb,ohlc:C8,open_:lk,parallel_straight_line:d9,parallelogram:E9,param:hb,percentage:n4,period:Y_,price_axis_type:L8,price_channel_line:a9,price_line:n9,ray_line:K4,rect:L9,reset:a8,restore:n8,reverse_coordinate:E8,sao_paulo:t7,screenshot:Jk,search:gb,segment:J4,setting:$k,settings:mb,shanghai:C7,standard_deviation:_b,straight_line:G4,strongMagnet:dS,sydney:L7,symbol_search:vb,three_waves:W9,time_:ik,timeframe:ub,timezone:pb,tokyo:M7,toronto:JC,triangle:R9,utc:zC,vertical_ray_line:R4,vertical_segment:W4,vertical_straight_line:z4,volume_:bk,weakMagnet:aS,week:Cb,xabcd:nS},Symbol.toStringTag,{value:"Module"})),B7=["MA","EMA","SMA","BOLL","SAR","BBI"],N7=["VOL","MACD","KDJ","RSI","BIAS","BRAR","CCI","DMI","CR","PSY","TRIX","OBV","VR","WR","MTM","EMV","ROC","PVT","AO"];class Ib{constructor(){re(this,"editPaneId");re(this,"editIndName");re(this,"modalIndCfg");re(this,"fireOhlcv");re(this,"klineLoaded");re(this,"cloudIndLoaded");re(this,"initDone");re(this,"clickChart");re(this,"loadingKLine");re(this,"loadingPairs");re(this,"timeStart");re(this,"timeEnd");re(this,"allInds");re(this,"isApplyingManualStyles");re(this,"applyCanvasColors");re(this,"clearCciGroups");re(this,"clearEmvGroups");re(this,"clearMtmGroups");re(this,"clearObvGroups");re(this,"clearPsyGroups");re(this,"clearPvtGroups");re(this,"clearRocGroups");re(this,"clearVolGroups");re(this,"clearWrGroups");this.editPaneId="",this.editIndName="",this.modalIndCfg=!1,this.fireOhlcv=0,this.klineLoaded=0,this.cloudIndLoaded=0,this.initDone=0,this.clickChart=0,this.loadingKLine=!1,this.loadingPairs=!1,this.timeStart=0,this.timeEnd=0,this.allInds=[],this.isApplyingManualStyles=!1,this.clearCciGroups=0,this.clearEmvGroups=0,this.clearMtmGroups=0,this.clearObvGroups=0,this.clearPsyGroups=0,this.clearPvtGroups=0,this.clearRocGroups=0,this.clearVolGroups=0,this.clearWrGroups=0;for(let e of B7){const t=`${e} (${Nu[e]()})`;this.allInds.push({name:e,title:t,cloud:!1,is_main:!0})}for(let e of N7){const t=`${e} (${Nu[e]()})`;this.allInds.push({name:e,title:t,cloud:!1,is_main:!1})}}}class Lm{constructor(){re(this,"showDrawBar");re(this,"showSidebar");re(this,"period");re(this,"symbol");re(this,"dateStart");re(this,"dateEnd");re(this,"timezone");re(this,"curSymbols");re(this,"allSymbols");re(this,"allExgs");re(this,"colorLong");re(this,"colorShort");re(this,"saveInds");re(this,"key");re(this,"theme");re(this,"styles");re(this,"options");this.showDrawBar=!0,this.showSidebar=!0,this.symbol={name:"Grameen Phone Limited",ticker:"GP",market:"stock",exchange:"DSEBD",type:"stock",priceCurrency:"BDT"},this.period={multiplier:1,timespan:"day",timeframe:"1d",secs:86400};const e=J6();this.dateEnd=vy(e,"YYYYMMDD");const t=e-this.period.secs*1e3*500;this.dateStart=vy(t,"YYYYMMDD"),this.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone,this.curSymbols=[],this.allSymbols=[],this.allExgs=new Set,this.colorLong="#0000FF",this.colorShort="#FF0000",this.saveInds={},this.key="",this.theme="dark",this.styles={pane:{backgroundColor:"#070211"},candle:{pane:{backgroundColor:"#070211"},type:"renko_atr",renko:{method:"ATR",atrLength:14,source:"close",wick:!1},pnf:{boxSizeMode:"absolute",boxSize:1,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"}},grid:{horizontal:{color:"#081115"},vertical:{color:"#081115"}}},this.options={enableRealtime:!1}}}function K_(o,e){const t=e.x>o.x?0:1,s=Yp.getLinearSlopeIntercept(o,e);let i;s?i=Math.atan(s[0])+Math.PI*t:e.y>o.y?i=Math.PI/2:i=Math.PI/2*3;const r=M0({x:e.x-8,y:e.y+4},e,i),a=M0({x:e.x-8,y:e.y-4},e,i);return[{type:"line",attrs:{coordinates:[o,e]}},{type:"line",ignoreEvent:!0,attrs:{coordinates:[r,e,a]}}]}function M0(o,e,t){const s=(o.x-e.x)*Math.cos(t)-(o.y-e.y)*Math.sin(t)+e.x,i=(o.x-e.x)*Math.sin(t)+(o.y-e.y)*Math.cos(t)+e.y;return{x:s,y:i}}function Z_(o,e){if(o.length>1){let t;const s=o[0],i=o[1];return s.x===i.x&&s.y!==i.y?s.y<i.y?t={x:s.x,y:e.height}:t={x:s.x,y:0}:s.x>i.x?t={x:0,y:Yp.getLinearYFromCoordinates(s,i,{x:0,y:s.y})}:t={x:e.width,y:Yp.getLinearYFromCoordinates(s,i,{x:e.width,y:s.y})},{coordinates:[s,t]}}return[]}function Mb(o,e){const t=Math.abs(o.x-e.x),s=Math.abs(o.y-e.y);return Math.sqrt(t*t+s*s)}function _1(o,e,t){let s=2;try{(t==null?void 0:t.isInCandle())??!0?s=2:s=4}catch{s=2}return s}const Tb={name:"arrow",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>o.length>1?K_(o[0],o[1]):[]},Ab={name:"circle",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{circle:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>{if(o.length>1){const e=Mb(o[0],o[1]),t=[];return t.push({type:"circle",attrs:{...o[0],r:e+30},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),t.push({type:"circle",attrs:{...o[0],r:e},styles:{style:"stroke_fill"}}),t}return[]}},Lb={name:"rect",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>{if(o.length>1){const e=[],s=[{x:o[0].x-30,y:o[0].y-30},{x:o[1].x+30,y:o[0].y-30},{x:o[1].x+30,y:o[1].y+30},{x:o[0].x-30,y:o[1].y+30}];return e.push({type:"polygon",attrs:{coordinates:s},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),e.push({type:"polygon",attrs:{coordinates:[o[0],{x:o[1].x,y:o[0].y},o[1],{x:o[0].x,y:o[1].y}]},styles:{style:"stroke_fill"}}),e}return[]}},Fb={name:"parallelogram",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>{if(o.length===2)return[{type:"line",ignoreEvent:!0,attrs:{coordinates:o}}];if(o.length===3){const e={x:o[0].x+(o[2].x-o[1].x),y:o[2].y};return[{type:"polygon",attrs:{coordinates:[o[0],o[1],o[2],e]},styles:{style:"stroke_fill"}}]}return[]},performEventPressedMove:({points:o,performPointIndex:e,performPoint:t})=>{e<2&&(o[0].price=t.price,o[1].price=t.price)},performEventMoveForDrawing:({currentStep:o,points:e,performPoint:t})=>{o===2&&(e[0].price=t.price)}},Db={name:"triangle",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o})=>[{type:"polygon",attrs:{coordinates:o},styles:{style:"stroke_fill"}}]},Eb={name:"fibonacciCircle",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,overlay:e})=>{var t,s,i,r;if(o.length>1){const a=Math.abs(o[0].x-o[1].x),l=Math.abs(o[0].y-o[1].y),d=Math.sqrt(a*a+l*l),v=[.236,.382,.5,.618,.786,1],p=[],_=[];return v.forEach(y=>{const w=d*y;p.push({...o[0],r:w}),_.push({x:o[0].x,y:o[0].y+w+6,text:`${(y*100).toFixed(1)}%`})}),[{type:"circle",attrs:p,styles:{style:"stroke",borderSize:((s=(t=e.styles)==null?void 0:t.line)==null?void 0:s.size)??2}},{type:"text",ignoreEvent:!0,attrs:_,styles:{color:((r=(i=e.styles)==null?void 0:i.line)==null?void 0:r.color)??"#666666",backgroundColor:"transparent",backgroundOpacity:0,borderSize:0,borderColor:"transparent"}}]}return[]}},R7=[{value:0,color:"#FF6B6B",visible:!0},{value:.236,color:"#4ECDC4",visible:!0},{value:.382,color:"#45B7D1",visible:!0},{value:.5,color:"#96CEB4",visible:!0},{value:.618,color:"#FFEAA7",visible:!0},{value:1,color:"#98D8C8",visible:!0},{value:1.618,color:"#85C1E9",visible:!0}],$b={name:"fibonacciSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{line:{size:1,color:"#1e88e5"},polygon:{color:"rgba(30, 136, 229, 0.1)"}},createPointFigures:({chart:o,coordinates:e,overlay:t,yAxis:s})=>{var a,l,d,v,p,_,y,w,k,S,L,T,P;const i=_1(o,t,s),r=[];if(e.length>1){const A=t.points,F=(a=A[0])==null?void 0:a.value,B=(l=A[1])==null?void 0:l.value;if(F===void 0||B===void 0)return r;const R=B-F,N=e[0].y,$=e[1].y,V=$-N,G=(((d=t.extendData)==null?void 0:d.fibonacciLevels)||t.fibonacciLevels||R7).filter(se=>se.visible);for(let se=0;se<G.length-1;se++){const ie=G[se],Y=G[se+1],K=$-V*ie.value,Q=$-V*Y.value;r.push({type:"polygon",attrs:{coordinates:[{x:e[0].x,y:K},{x:e[1].x,y:K},{x:e[1].x,y:Q},{x:e[0].x,y:Q}]},styles:{style:"fill",color:ie.color+"40"}})}const Z=[],le=[];G.forEach(se=>{const ie=$-V*se.value,Y=(B-R*se.value).toFixed(i);Z.push({coordinates:[{x:e[0].x,y:ie},{x:e[1].x,y:ie}]}),le.push({x:e[0].x-8,y:ie,text:`${(se.value*100).toFixed(1)}% (${Y})`,baseline:"middle",align:"right"})}),r.push({type:"line",attrs:Z,styles:{size:((p=(v=t.styles)==null?void 0:v.line)==null?void 0:p.size)||1,color:((y=(_=t.styles)==null?void 0:_.line)==null?void 0:y.color)||"#1e88e5"}}),r.push({type:"text",ignoreEvent:!0,attrs:le,styles:{color:((k=(w=t.styles)==null?void 0:w.text)==null?void 0:k.color)||"#666666",backgroundColor:"transparent"}}),r.push({type:"line",attrs:{coordinates:[e[0],e[1]]},styles:{style:"dashed",size:((L=(S=t.styles)==null?void 0:S.line)==null?void 0:L.size)||1,color:((P=(T=t.styles)==null?void 0:T.line)==null?void 0:P.color)||"#1e88e5"}})}return r}},jb={name:"fibonacciSpiral",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e})=>{if(o.length>1){const t=Mb(o[0],o[1])/Math.sqrt(24),s=o[1].x>o[0].x?0:1,i=Yp.getLinearSlopeIntercept(o[0],o[1]);let r;i?r=Math.atan(i[0])+Math.PI*s:o[1].y>o[0].y?r=Math.PI/2:r=Math.PI/2*3;const a=M0({x:o[0].x-t,y:o[0].y},o[0],r),l=M0({x:o[0].x-t,y:o[0].y-t},o[0],r),d=[{...a,r:t,startAngle:r,endAngle:r+Math.PI/2},{...l,r:t*2,startAngle:r+Math.PI/2,endAngle:r+Math.PI}];let v=o[0].x-t,p=o[0].y-t;for(let _=2;_<9;_++){const y=d[_-2].r+d[_-1].r;let w=0;switch(_%4){case 0:{w=r,v-=d[_-2].r;break}case 1:{w=r+Math.PI/2,p-=d[_-2].r;break}case 2:{w=r+Math.PI,v+=d[_-2].r;break}case 3:{w=r+Math.PI/2*3,p+=d[_-2].r;break}}const k=w+Math.PI/2,S=M0({x:v,y:p},o[0],r);d.push({...S,r:y,startAngle:w,endAngle:k})}return[{type:"arc",attrs:d,styles:{size:2}},{type:"line",attrs:Z_(o,e),styles:{size:2}}]}return[]}},zb={name:"fibonacciSpeedResistanceFan",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,bounding:e,overlay:t})=>{var a,l,d,v,p,_;const s=[];let i=[];const r=[];if(o.length>1){const y=o[1].x>o[0].x?-38:4,w=o[1].y>o[0].y?-2:20,k=o[1].x-o[0].x,S=o[1].y-o[0].y;[1,.75,.618,.5,.382,.25,0].forEach(T=>{const P=o[1].x-k*T,A=o[1].y-S*T;s.push({coordinates:[{x:P,y:o[0].y},{x:P,y:o[1].y}]}),s.push({coordinates:[{x:o[0].x,y:A},{x:o[1].x,y:A}]}),i=i.concat(Z_([o[0],{x:P,y:o[1].y}],e)),i=i.concat(Z_([o[0],{x:o[1].x,y:A}],e)),r.unshift({x:o[0].x+y,y:A+10,text:`${T.toFixed(3)}`}),r.unshift({x:P-18,y:o[0].y+w,text:`${T.toFixed(3)}`})})}return[{type:"line",attrs:s,styles:{size:((l=(a=t.styles)==null?void 0:a.line)==null?void 0:l.size)??2}},{type:"line",attrs:i,styles:{size:((v=(d=t.styles)==null?void 0:d.line)==null?void 0:v.size)??2}},{type:"text",ignoreEvent:!0,attrs:r,styles:{color:((_=(p=t.styles)==null?void 0:p.line)==null?void 0:_.color)??"#666666",backgroundColor:"transparent",backgroundOpacity:0,borderSize:0,borderColor:"transparent"}}]}},Bb={name:"fibonacciExtension",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({chart:o,coordinates:e,overlay:t,yAxis:s})=>{var l,d,v,p,_,y;const i=_1(o,t,s),r=[],a=[];if(e.length>2){const w=t.points,k=w[1].value-w[0].value,S=e[1].y-e[0].y,L=[0,.236,.382,.5,.618,.786,1,1.618,2.618],P=Math.min(e[1].x,e[2].x)-16;L.forEach(A=>{const F=e[2].y+S*A,B=(w[2].value+k*A).toFixed(i);r.push({coordinates:[{x:e[1].x,y:F},{x:e[2].x,y:F}]}),a.push({x:P,y:F,text:`${B} (${(A*100).toFixed(1)}%)`,baseline:"middle",align:"right"})})}return[{type:"line",attrs:{coordinates:e},styles:{style:"dashed",size:((d=(l=t.styles)==null?void 0:l.line)==null?void 0:d.size)??2}},{type:"line",attrs:r,styles:{size:((p=(v=t.styles)==null?void 0:v.line)==null?void 0:p.size)??2}},{type:"text",ignoreEvent:!0,attrs:a,styles:{color:((y=(_=t.styles)==null?void 0:_.line)==null?void 0:y.color)??"#666666",backgroundColor:"transparent",backgroundOpacity:0,borderSize:0,borderColor:"transparent"}}]}},Nb={name:"gannBox",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o,overlay:e})=>{var t,s,i,r;if(o.length>1){const a=(o[1].y-o[0].y)/4,l=o[1].x-o[0].x,d=[{coordinates:[o[0],{x:o[1].x,y:o[1].y-a}]},{coordinates:[o[0],{x:o[1].x,y:o[1].y-a*2}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[1].x,y:o[0].y+a}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[1].x,y:o[0].y+a*2}]},{coordinates:[{...o[0]},{x:o[0].x+l*.236,y:o[1].y}]},{coordinates:[{...o[0]},{x:o[0].x+l*.5,y:o[1].y}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[0].x+l*.236,y:o[0].y}]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[0].x+l*.5,y:o[0].y}]}],v=[{coordinates:[o[0],o[1]]},{coordinates:[{x:o[0].x,y:o[1].y},{x:o[1].x,y:o[0].y}]}];return[{type:"line",attrs:[{coordinates:[o[0],{x:o[1].x,y:o[0].y}]},{coordinates:[{x:o[1].x,y:o[0].y},o[1]]},{coordinates:[o[1],{x:o[0].x,y:o[1].y}]},{coordinates:[{x:o[0].x,y:o[1].y},o[0]]}]},{type:"polygon",ignoreEvent:!0,attrs:{coordinates:[o[0],{x:o[1].x,y:o[0].y},o[1],{x:o[0].x,y:o[1].y}]},styles:{style:"fill"}},{type:"line",attrs:d,styles:{style:"dashed",size:((s=(t=e.styles)==null?void 0:t.line)==null?void 0:s.size)??1}},{type:"line",attrs:v,styles:{size:((r=(i=e.styles)==null?void 0:i.line)==null?void 0:r.size)??1}}]}return[]}},Rb={name:"threeWaves",totalStep:5,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},Ob={name:"fiveWaves",totalStep:7,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},Vb={name:"eightWaves",totalStep:10,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},Wb={name:"anyWaves",totalStep:Number.MAX_SAFE_INTEGER,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{const e=o.map((t,s)=>({...t,text:`(${s})`,baseline:"bottom"}));return[{type:"line",attrs:{coordinates:o}},{type:"text",ignoreEvent:!0,attrs:e}]}},qb={name:"abcd",totalStep:5,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o})=>{let e=[],t=[];const s=["A","B","C","D"],i=o.map((r,a)=>({...r,baseline:"bottom",text:`(${s[a]})`}));return o.length>2&&(e=[o[0],o[2]],o.length>3&&(t=[o[1],o[3]])),[{type:"line",attrs:{coordinates:o}},{type:"line",attrs:[{coordinates:e},{coordinates:t}],styles:{style:"dashed"}},{type:"text",ignoreEvent:!0,attrs:i}]}},Hb={name:"xabcd",totalStep:6,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},createPointFigures:({coordinates:o,overlay:e})=>{const t=[],s=[],i=["X","A","B","C","D"],r=o.map((a,l)=>({...a,baseline:"bottom",text:`(${i[l]})`}));return o.length>2&&(t.push({coordinates:[o[0],o[2]]}),s.push({coordinates:[o[0],o[1],o[2]]}),o.length>3&&(t.push({coordinates:[o[1],o[3]]}),o.length>4&&(t.push({coordinates:[o[2],o[4]]}),s.push({coordinates:[o[2],o[3],o[4]]})))),[{type:"line",attrs:{coordinates:o}},{type:"line",attrs:t,styles:{style:"dashed"}},{type:"polygon",ignoreEvent:!0,attrs:s},{type:"text",ignoreEvent:!0,attrs:r}]}};function O7(o,e,t,s){const i=e==="bottom"?1:-1,r=o.x,a=r+200,l=o.y+3*i,d=l+50*i,v=d+5*i,p=s?{color:s}:{},_=s?{backgroundColor:s,borderColor:s}:{};return[{type:"line",attrs:{coordinates:[{x:r,y:l},{x:r,y:d}]},ignoreEvent:!0},{type:"line",attrs:{coordinates:[{x:r,y:o.y},{x:a,y:o.y}]},ignoreEvent:!0,styles:{...p}},{type:"polygon",attrs:{coordinates:[{x:r,y:d},{x:r-4,y:v},{x:r+4,y:v}]},ignoreEvent:!0,styles:p},{type:"rectText",attrs:{x:r,y:v,text:t??"",align:"center",baseline:"bottom"},ignoreEvent:!0,styles:_}]}const Gb={name:"barSignal",totalStep:2,createPointFigures:({overlay:o,coordinates:e})=>{let{postion:t,text:s,bgColor:i}=o.extendData,r=[];return e.forEach(a=>{r.push(...O7(a,t,s,i))}),r}};function V7(o){let i=[];if(o>86400){const r=Math.floor(o/86400);i.push(r.toString(),bb()),o=o%86400}if(o>3600){const r=Math.floor(o/3600);i.push(r.toString(),xb()),o=o%3600}if(o>60){const r=Math.floor(o/60);i.push(r.toString(),U_()),o=o%60}return o>0&&i.push("1",U_()),i.join("")}const Yb={name:"ruler",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,styles:{polygon:{color:"rgba(22, 119, 255, 0.15)"}},onDeselected:o=>{var e;return(e=o.chart)==null||e.removeOverlay({id:o.overlay.id}),!0},createPointFigures:({chart:o,coordinates:e,overlay:t,yAxis:s})=>{const i=_1(o,t,s);if(e.length>1){const r=e[0],a=e[1],l=(r.x+a.x)/2,d=(r.y+a.y)/2,v=K_({x:l,y:r.y},{x:l,y:a.y}),p=K_({x:r.x,y:d},{x:a.x,y:d}),_=r.y>a.y?"#F7525F":"#2962FF",y={color:"#ffffff",backgroundColor:_,borderColor:_,paddingLeft:6,paddingTop:6,paddingRight:6,paddingBottom:6},w=t.points,k=w[0].value-w[1].value,S=k.toFixed(i),L=(k/w[0].value*100).toFixed(2),T=w[1].dataIndex-w[0].dataIndex,P=(w[1].timestamp-w[0].timestamp)/1e3,A=`${S} (${L}%)
${T}${yb()}, ${V7(P)}`;let F=a.y+10,B="top";r.y>a.y&&(F=a.y-10,B="bottom");const R=[],N=30,$=[{x:r.x-N,y:r.y-N},{x:a.x+N,y:r.y-N},{x:a.x+N,y:a.y+N},{x:r.x-N,y:a.y+N}];return R.push({type:"polygon",attrs:{coordinates:$},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),R.push({type:"polygon",attrs:{coordinates:[r,{x:a.x,y:r.y},a,{x:r.x,y:a.y}]},styles:{style:"stroke_fill"}}),R.push({type:"textBox",attrs:{x:l,y:F,text:A,align:"center",baseline:B},ignoreEvent:!0,styles:y}),R.push(...v),R.push(...p),R}return[]}},my={color:"#ffffff",paddingLeft:6,paddingTop:6,paddingRight:6,paddingBottom:6},Ub={name:"trade",lock:!0,totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,overlay:e})=>{if(o.length<=1)return[];const t=e.extendData,s=o[0],i=o[1],r={size:.5};t&&t.line_color&&(r.color=t.line_color);const a=[],l={type:"line",attrs:{coordinates:[s,i]},styles:{color:"transparent",size:40},ignoreEvent:!1};a.push(l);const d={type:"line",attrs:{coordinates:[s,i]},styles:r};if(a.push(d),!t.active&&!t.selected)return a;const v=t.distance??15;let p="bottom",_=s.y-v,y="top",w=i.y+v;s.y>i.y&&(p="top",_=s.y+v,y="bottom",w=i.y-v);const k={type:"textBox",attrs:{x:s.x,y:_,text:t.in_text,align:"center",baseline:p},ignoreEvent:!0,styles:{...my,backgroundColor:t.in_color,borderColor:t.in_color}},S={type:"textBox",attrs:{x:i.x,y:w,text:t.out_text,align:"center",baseline:y},ignoreEvent:!0,styles:{...my,backgroundColor:t.out_color,borderColor:t.out_color}},L={type:"line",attrs:{coordinates:[s,{x:s.x,y:_}]},ignoreEvent:!0,styles:r},T={type:"line",attrs:{coordinates:[i,{x:i.x,y:w}]},ignoreEvent:!0,styles:r};return[l,d,k,S,L,T]},onSelected:o=>{const e=o.overlay.extendData;return e.selected=!0,!1},onDeselected:o=>{const e=o.overlay.extendData;return e.selected=!1,!1},onMouseEnter:o=>{const e=o.overlay.extendData;return e.active=!0,!1},onMouseLeave:o=>{const e=o.overlay.extendData;return e.active=!1,!1}},W7={color:"#ffffff",paddingLeft:6,paddingTop:6,paddingRight:6,paddingBottom:6},Kb={name:"note",lock:!0,totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:({coordinates:o,overlay:e})=>{if(o.length==0)return[];const t=e.extendData,s=o[0],i={size:.5};t&&t.line_color&&(i.color=t.line_color);const r=t.distance??15;let a="bottom",l=s.y-r;const d={type:"textBox",attrs:{x:s.x,y:l,text:t.in_text,align:"center",baseline:a},ignoreEvent:!0,styles:{...W7,backgroundColor:t.in_color,borderColor:t.in_color}},v={type:"line",attrs:{coordinates:[s,{x:s.x,y:l}]},ignoreEvent:!0,styles:i};return[d,v]}},Zb={name:"emoji",totalStep:2,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,styles:{box:{enabled:!1,stroke:"#3b82f6",width:1,fill:"transparent"},handles:{size:6,fill:"#3b82f6",stroke:"#3b82f6"}},createPointFigures:({coordinates:o,overlay:e})=>{if(o.length===0)return[];const t=e.extendData;if(!t||!t.emoji)return[];const s=o[0],i=t.size||24;t.rotation;const r=t.selected||!1;t.active;const a=[],l=e.styles||{box:{enabled:!1,stroke:"#3b82f6",width:1,fill:"transparent"},handles:{size:6,fill:"#3b82f6",stroke:"#3b82f6"}},d={type:"text",attrs:{x:s.x,y:s.y,text:t.emoji,align:"center",baseline:"middle"},styles:{size:i,family:"Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",weight:"normal",backgroundColor:"transparent"}};if(a.push(d),r){const v=i/2,p=4,_={type:"rect",attrs:{x:s.x-v-p,y:s.y-v-p,width:i+p*2,height:i+p*2},styles:{stroke:l.box.stroke,strokeWidth:l.box.width,fill:"transparent",backgroundColor:"transparent"}};a.push(_);const y=l.handles.size,w=v+p;[{x:s.x-w-y/2,y:s.y-w-y/2},{x:s.x+w-y/2,y:s.y-w-y/2},{x:s.x-w-y/2,y:s.y+w-y/2},{x:s.x+w-y/2,y:s.y+w-y/2}].forEach(S=>{const L={type:"rect",attrs:{x:S.x,y:S.y,width:y,height:y},styles:{fill:l.handles.fill,stroke:l.handles.stroke,strokeWidth:1,backgroundColor:"transparent"}};a.push(L)})}return a},onDrawStart:o=>!0,onDrawing:o=>!0,onDrawEnd:o=>!0,onPressedMoveStart:o=>!0,onPressedMoving:o=>!0,onPressedMoveEnd:o=>!0,onSelected:o=>{const e=o.overlay.extendData;return e&&(e.selected=!0),!1},onDeselected:o=>{const e=o.overlay.extendData;return e&&(e.selected=!1),!1},onMouseEnter:o=>{const e=o.overlay.extendData;return e&&(e.active=!0),!1},onMouseLeave:o=>{const e=o.overlay.extendData;return e&&(e.active=!1),!1}},wv="Add text";class q7{constructor(){re(this,"editor",null);re(this,"chart",null);re(this,"overlay",null);re(this,"pos",{x:0,y:0});re(this,"raf",null);re(this,"lastCommitted","");re(this,"boundPointerHandler",null);re(this,"boundKeydownShield",null);re(this,"placeholderCssInjected",!1)}startEditing(e,t){var s;this.chart=e,this.overlay=t,this.lastCommitted=((s=t.extendData)==null?void 0:s.text)??"",this.ensureEditor(),this.updateOverlayEditing(!0),this.syncPosition(),this.addOutsideListeners(),this.addKeydownShield(),setTimeout(()=>{var a,l;(a=this.editor)==null||a.focus();const i=((l=t.extendData)==null?void 0:l.text)??"",r=!i||i===wv;this.editor&&(this.editor.innerText=r?"":i,this.editor.setAttribute("data-placeholder",wv),this.editor.classList.add("kc-inline-text-editor"),this.injectPlaceholderCss());try{const d=window.getSelection();if(d&&this.editor){const v=this.editor.innerText.length;this.editor.firstChild&&d.collapse(this.editor.firstChild,Math.min(v,(this.editor.firstChild.textContent||"").length))}}catch{}},0),this.loop()}reEdit(e,t){this.startEditing(e,t)}updateEditorStyle(e){e&&(this.overlay=e),this.applyStylesFromOverlay()}ensureEditor(){if(this.editor)return;const e=document.createElement("div");e.contentEditable="true",e.style.position="fixed",e.style.zIndex="10000",e.style.outline="none",e.style.padding="8px",e.style.whiteSpace="pre-wrap",e.style.wordBreak="break-word",e.style.userSelect="text",e.style.transform="translate(0, -50%)",e.style.boxSizing="border-box",e.addEventListener("keydown",t=>this.onKeyDown(t)),e.addEventListener("input",()=>this.onInput()),e.addEventListener("blur",()=>this.commit()),document.body.appendChild(e),this.editor=e,this.applyStylesFromOverlay()}applyStylesFromOverlay(){var d;if(!this.editor||!this.overlay)return;const e=this.overlay.extendData||{},t=((d=this.overlay.styles)==null?void 0:d.text)||{},s=e.fontSize??t.size??32,i=e.fontWeight??t.weight??"bold",r=e.textColor??t.color??"#FFFFFF",a=e.backgroundColor??t.backgroundColor??"#00000033",l=e.fontFamily??t.family??'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif';this.editor.style.fontSize=`${s}px`,this.editor.style.lineHeight=`${Math.round(s*1.4)}px`,this.editor.style.fontWeight=i,this.editor.style.color=r,this.editor.style.background=a,this.editor.style.border="none",this.editor.style.fontFamily=l,this.editor.style.minWidth="0px",this.editor.style.minHeight=`${Math.round(s*1.4)}px`}loop(){this.raf&&cancelAnimationFrame(this.raf);const e=()=>{this.syncPosition(),this.raf=requestAnimationFrame(e)};this.raf=requestAnimationFrame(e)}syncPosition(){var s;if(!this.chart||!this.overlay||!((s=this.overlay.points)!=null&&s.length))return;const e=this.overlay.paneId||"candle_pane",t=this.chart.convertToPixel(this.overlay.points[0],{paneId:e});t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.pos={x:t.x,y:t.y},this.editor&&(this.editor.style.left=`${this.pos.x}px`,this.editor.style.top=`${this.pos.y}px`))}addOutsideListeners(){if(this.boundPointerHandler)return;const e=t=>{const s=t.target;if(!this.editor||s&&this.editor.contains(s))return;const i=s;i&&(i.closest(".context-menu-container")||i.closest(".premium-submenu"))||this.finishFromOutside()};this.boundPointerHandler=e,document.addEventListener("pointerdown",e,{capture:!0}),document.addEventListener("touchstart",e,{capture:!0}),document.addEventListener("mousedown",e,{capture:!0})}removeOutsideListeners(){this.boundPointerHandler&&(document.removeEventListener("pointerdown",this.boundPointerHandler,{capture:!0}),document.removeEventListener("touchstart",this.boundPointerHandler,{capture:!0}),document.removeEventListener("mousedown",this.boundPointerHandler,{capture:!0}),this.boundPointerHandler=null)}addKeydownShield(){if(this.boundKeydownShield)return;const e=t=>{if(!this.editor)return;const s=t.target;s&&(s===this.editor||this.editor.contains(s))&&t.stopPropagation()};this.boundKeydownShield=e,document.addEventListener("keydown",e,{capture:!0})}removeKeydownShield(){this.boundKeydownShield&&(document.removeEventListener("keydown",this.boundKeydownShield,{capture:!0}),this.boundKeydownShield=null)}finishFromOutside(){if(!this.editor)return;const e=this.editor.innerText||"";try{this.editor.blur()}catch{}!e||e===wv?this.deleteOverlay():this.commit()}onKeyDown(e){var t;if(e.stopPropagation(),e.key==="Escape"){e.preventDefault();const s=(((t=this.editor)==null?void 0:t.innerText)||"").trim();!s||s===wv?this.deleteOverlay():this.revert()}e.key==="Backspace"||e.key==="Delete"||e.key}onInput(){if(!this.editor||!this.chart||!this.overlay)return;this.editor.innerText.length>0?this.editor.setAttribute("data-placeholder",wv):this.editor.setAttribute("data-placeholder",wv);const e=Math.max(12,this.editor.scrollWidth),t=Math.max(this.editor.scrollHeight,Math.round(parseInt(this.editor.style.lineHeight)||32)),s=getComputedStyle(this.editor),i=parseFloat(s.paddingLeft||"0")+parseFloat(s.paddingRight||"0"),r=parseFloat(s.paddingTop||"0")+parseFloat(s.paddingBottom||"0"),a=Math.max(0,e-i),l=Math.max(0,t-r),d={...this.overlay.extendData||{},text:this.editor.innerText,boxWidth:e,boxHeight:t,contentWidth:a,contentHeight:l};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:d})}catch{}}updateOverlayEditing(e){if(!this.chart||!this.overlay)return;const t={...this.overlay.extendData||{},editing:e};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:t})}catch{}}commit(){var d;if(!this.chart||!this.overlay){this.cleanup();return}const e=((d=this.editor)==null?void 0:d.innerText)||"";if(!e||e===wv){this.deleteOverlay();return}this.lastCommitted=e;const t=this.editor?Math.max(12,this.editor.scrollWidth):void 0,s=this.editor?Math.max(this.editor.scrollHeight,Math.round(parseInt(this.editor.style.lineHeight)||32)):void 0,i=this.editor?getComputedStyle(this.editor):null,r=i?parseFloat(i.paddingLeft||"0")+parseFloat(i.paddingRight||"0"):0,a=i?parseFloat(i.paddingTop||"0")+parseFloat(i.paddingBottom||"0"):0,l={...this.overlay.extendData||{},text:e,editing:!1,...t?{boxWidth:t}:{},...s?{boxHeight:s}:{},...t?{contentWidth:Math.max(0,t-r)}:{},...s?{contentHeight:Math.max(0,s-a)}:{}};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:l})}catch{}this.cleanup()}revert(){if(!this.chart||!this.overlay){this.cleanup();return}const e={...this.overlay.extendData||{},text:this.lastCommitted,editing:!1};try{this.chart.overrideOverlay({id:this.overlay.id,extendData:e})}catch{}this.cleanup()}deleteOverlay(){var e;if(!this.chart||!this.overlay){this.cleanup();return}try{(e=this.editor)==null||e.blur()}catch{}try{this.chart.removeOverlay({id:this.overlay.id})}catch{}this.cleanup()}cleanup(){if(this.raf&&cancelAnimationFrame(this.raf),this.raf=null,this.overlay=null,this.removeOutsideListeners(),this.removeKeydownShield(),this.editor)try{this.editor.remove()}catch{}this.editor=null}getEditorRect(){try{return this.editor?this.editor.getBoundingClientRect():null}catch{return null}}injectPlaceholderCss(){if(!this.placeholderCssInjected)try{const e="kc-inline-text-editor-placeholder-style";if(document.getElementById(e)){this.placeholderCssInjected=!0;return}const t=document.createElement("style");t.id=e,t.textContent=`
        .kc-inline-text-editor:empty::before {
          content: attr(data-placeholder);
          color: rgba(255,255,255,0.6);
        }
      `,document.head.appendChild(t),this.placeholderCssInjected=!0}catch{}}}const sf=new q7,hy="system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif",Xb={name:"text",totalStep:2,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,zLevel:100,styles:{text:{color:"#FFFFFF",backgroundColor:"#00000033",borderColor:"#1677FF",size:32,weight:"bold",family:hy,paddingLeft:8,paddingRight:8,paddingTop:8,paddingBottom:8,borderSize:1},box:{stroke:"#1677FF",width:1,fill:"transparent"},handles:{size:6,fill:"#1677FF",stroke:"#1677FF"}},createPointFigures:({coordinates:o,overlay:e})=>{var ie,Y,K,Q,q,ce,_e,me,Pe,ze,he,De,ge,be,$e,Ve,Ce,Je;if(o.length===0)return[];const t=o[0],s=e.extendData||{},i=!!s.editing,r=s.text??"",a=s.fontSize??((Y=(ie=e.styles)==null?void 0:ie.text)==null?void 0:Y.size)??32,l=s.fontWeight??((Q=(K=e.styles)==null?void 0:K.text)==null?void 0:Q.weight)??"bold",d=s.fontFamily??((ce=(q=e.styles)==null?void 0:q.text)==null?void 0:ce.family)??hy,v=s.textColor??((me=(_e=e.styles)==null?void 0:_e.text)==null?void 0:me.color)??"#FFFFFF",p=s.backgroundColor??((ze=(Pe=e.styles)==null?void 0:Pe.text)==null?void 0:ze.backgroundColor)??"#00000033",_=((De=(he=e.styles)==null?void 0:he.text)==null?void 0:De.paddingLeft)??8,y=((be=(ge=e.styles)==null?void 0:ge.text)==null?void 0:be.paddingRight)??8,w=((Ve=($e=e.styles)==null?void 0:$e.text)==null?void 0:Ve.paddingTop)??4,k=((Je=(Ce=e.styles)==null?void 0:Ce.text)==null?void 0:Je.paddingBottom)??4;if(i)return[];if(!(r&&r.length>0&&r!=="Add text"))return[];const L=Math.round(a*1.4),T=String(r).split(/\r?\n/),P=T.map(ye=>Yp.calcTextWidth(ye,a,l,d)),F=P.length?Math.max(...P):Yp.calcTextWidth(r,a,l,d),B=(T.length||1)*L,R=F+_+y,N=B+w+k,$=R,V=N,U=t.x,G=t.y-Math.round(V/2),Z=[];Z.push({type:"rect",attrs:{x:U,y:G,width:$,height:V},styles:{style:of.Fill,color:p,borderColor:"transparent",borderSize:0}});const le=U+Math.round($/2),se=G+w+Math.round(L/2);return T.forEach((ye,Ae)=>{const ee=se+Ae*L;Z.push({type:"text",attrs:{x:le,y:ee,text:ye,align:"center",baseline:"middle"},styles:{size:a,family:d,weight:l,color:v,backgroundColor:"transparent"}})}),Z},onSelected:o=>{var t;const e=o.overlay.extendData||{};e.selected=!0,(t=o.chart)==null||t.overrideOverlay({id:o.overlay.id,extendData:e});try{typeof navigator<"u"&&(navigator.maxTouchPoints||0)>0&&o.chart&&sf.startEditing(o.chart,o.overlay)}catch{}return!0},onDeselected:o=>{var t;const e=o.overlay.extendData||{};return e.selected=!1,(t=o.chart)==null||t.overrideOverlay({id:o.overlay.id,extendData:e}),!0},onPressedMoveStart:o=>{const e=o.overlay.extendData||{};if(e.editing||o.overlay.lock)return!1;const t=o.overlay.paneId;try{const s=o.chart.convertToPixel(o.overlay.points[0],{paneId:t});s&&typeof o.x=="number"&&typeof o.y=="number"&&(e.__dragOffX=o.x-(s.x||0),e.__dragOffY=o.y-(s.y||0),o.chart.overrideOverlay({id:o.overlay.id,extendData:e}))}catch{}return!0},onPressedMoving:o=>{const e=o.overlay.extendData||{};if(e.editing||o.overlay.lock)return!1;const t=e.__dragOffX||0,s=e.__dragOffY||0,i=o.overlay.paneId;if(typeof o.x!="number"||typeof o.y!="number")return!0;const r=o.x-t,a=o.y-s;try{const l=o.chart.convertFromPixel([{x:r,y:a}],{paneId:i}),d=Array.isArray(l)?l[0]:l;d&&o.chart.overrideOverlay({id:o.overlay.id,points:[{timestamp:d.timestamp,value:d.value}]})}catch{}return!0},onPressedMoveEnd:o=>{const e=o.overlay.extendData||{};if(e.editing||o.overlay.lock)return!1;if("__dragOffX"in e||"__dragOffY"in e){delete e.__dragOffX,delete e.__dragOffY;try{o.chart.overrideOverlay({id:o.overlay.id,extendData:e})}catch{}}return!0}};function H7(o,e){if(o.length>0){const t=o[0].y;return{coordinates:[{x:0,y:t},{x:e.width,y:t}]}}return{coordinates:[]}}function G7(o,e){if(o.length>1){const t=o[0].y,s=o[0],i=o[1];return s.x>i.x?{coordinates:[{x:0,y:t},s]}:{coordinates:[s,{x:e.width,y:t}]}}return{coordinates:[]}}const Jb={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createPointFigures:({coordinates:o,overlay:e,bounding:t})=>{var a,l,d;if(o.length<1)return[];console.log("horizontalStraightLine createPointFigures called",{overlayId:e.id,hasExtendData:!!e.extendData,extendData:e.extendData,selected:e.selected===!0}),!e.extendData||typeof e.extendData!="object"?e.extendData={showDot:!1}:"showDot"in e.extendData||(e.extendData.showDot=!1);const s=e.extendData,i=[],r=H7(o,t);if(r.coordinates.length>0){i.push({type:"line",attrs:r,styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),i.push({type:"line",attrs:r});const v=e.selected===!0;if(s.showDot||v){const p=t.width/2,_=o[0].y,y=((l=(a=e.styles)==null?void 0:a.line)==null?void 0:l.color)||((d=e.styles)==null?void 0:d.color)||"#1677FF";console.log("Drawing dot for horizontalStraightLine:",{x:p,y:_,showDot:s.showDot,selected:v,color:y}),i.push({type:"circle",attrs:{x:p,y:_,r:6},styles:{style:"fill",color:y}}),i.push({type:"circle",attrs:{x:p,y:_,r:7},styles:{style:"stroke",color:"#ffffff",borderSize:2}})}}return i},createYAxisFigures:({chart:o,overlay:e,coordinates:t,yAxis:s,bounding:i})=>{var F,B,R,N,$,V;if(t.length<1||!e.points||e.points.length<1)return[];const r=(F=e.points[0])==null?void 0:F.value;if(r===void 0)return[];const a=o.getStyles(),l=a.yAxis,d=l.axisLine.show?l.axisLine.size:0,v=l.tickLine.show?l.tickLine.length:0,p=l.tickText.marginStart,_=l.tickText.marginEnd,y=1,k={...a.crosshair.horizontal.text};let S=0,L="left";if((B=s==null?void 0:s.isFromZero)!=null&&B.call(s))S=d+y,L="left",k.paddingLeft=v+p-y;else{S=((i==null?void 0:i.width)??0)-d-y,L="right";const U=((i==null?void 0:i.width)??0)-d-y,G=((i==null?void 0:i.width)??0)-(l.axisLine.show?l.axisLine.size:0)-(l.tickLine.show?l.tickLine.length:0)-_;k.paddingRight=U-G}const T=s.getRange();let P=s.displayValueToText(s.realValueToDisplayValue(s.valueToRealValue(r,{range:T}),{range:T}),((R=o.getSymbol())==null?void 0:R.pricePrecision)??2);P=o.getDecimalFold().format(o.getThousandsSeparator().format(P));const A=(($=(N=e.styles)==null?void 0:N.line)==null?void 0:$.color)||((V=e.styles)==null?void 0:V.color)||"#1677FF";return[{type:"text",attrs:{x:S,y:t[0].y,text:P,align:L,baseline:"middle"},styles:{...k,backgroundColor:A},ignoreEvent:!0}]},onClick:o=>{console.log("🟢 horizontalStraightLine onClick called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!e.showDot,console.log("✅ Toggled showDot to:",e.showDot,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onSelected:o=>{console.log("🟢 horizontalStraightLine onSelected called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!0,console.log("✅ Set showDot to true:",e,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onDeselected:o=>{console.log("🔴 horizontalStraightLine onDeselected called"),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!1,o.chart&&o.chart.overrideOverlay({id:o.overlay.id,extendData:e}),!0}},Qb={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createPointFigures:({coordinates:o,overlay:e,bounding:t})=>{var a,l,d;if(o.length<2)return[];console.log("horizontalRayLine createPointFigures called",{overlayId:e.id,hasExtendData:!!e.extendData,extendData:e.extendData,selected:e.selected===!0}),!e.extendData||typeof e.extendData!="object"?e.extendData={showDot:!1}:"showDot"in e.extendData||(e.extendData.showDot=!1);const s=e.extendData,i=[],r=G7(o,t);if(r.coordinates.length>0){i.push({type:"line",attrs:r,styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),i.push({type:"line",attrs:r});const v=e.selected===!0;if(s.showDot||v){const p=o[0].x,_=o[0].y,y=((l=(a=e.styles)==null?void 0:a.line)==null?void 0:l.color)||((d=e.styles)==null?void 0:d.color)||"#1677FF";console.log("Drawing dot for horizontalRayLine:",{x:p,y:_,showDot:s.showDot,selected:v,color:y}),i.push({type:"circle",attrs:{x:p,y:_,r:6},styles:{style:"fill",color:y}}),i.push({type:"circle",attrs:{x:p,y:_,r:7},styles:{style:"stroke",color:"#ffffff",borderSize:2}})}}return i},createYAxisFigures:({chart:o,overlay:e,coordinates:t,yAxis:s,bounding:i})=>{var F,B,R,N,$,V;if(t.length<1||!e.points||e.points.length<1)return[];const r=(F=e.points[0])==null?void 0:F.value;if(r===void 0)return[];const a=o.getStyles(),l=a.yAxis,d=l.axisLine.show?l.axisLine.size:0,v=l.tickLine.show?l.tickLine.length:0,p=l.tickText.marginStart,_=l.tickText.marginEnd,y=1,k={...a.crosshair.horizontal.text};let S=0,L="left";if((B=s==null?void 0:s.isFromZero)!=null&&B.call(s))S=d+y,L="left",k.paddingLeft=v+p-y;else{S=((i==null?void 0:i.width)??0)-d-y,L="right";const U=((i==null?void 0:i.width)??0)-d-y,G=((i==null?void 0:i.width)??0)-(l.axisLine.show?l.axisLine.size:0)-(l.tickLine.show?l.tickLine.length:0)-_;k.paddingRight=U-G}const T=s.getRange();let P=s.displayValueToText(s.realValueToDisplayValue(s.valueToRealValue(r,{range:T}),{range:T}),((R=o.getSymbol())==null?void 0:R.pricePrecision)??2);P=o.getDecimalFold().format(o.getThousandsSeparator().format(P));const A=(($=(N=e.styles)==null?void 0:N.line)==null?void 0:$.color)||((V=e.styles)==null?void 0:V.color)||"#1677FF";return[{type:"text",attrs:{x:S,y:t[0].y,text:P,align:L,baseline:"middle"},styles:{...k,backgroundColor:A},ignoreEvent:!0}]},onClick:o=>{console.log("🟢 horizontalRayLine onClick called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!e.showDot,console.log("✅ Toggled showDot to:",e.showDot,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onSelected:o=>{console.log("🟢 horizontalRayLine onSelected called",{overlayId:o.overlay.id,overlayName:o.overlay.name,hasExtendData:!!o.overlay.extendData,extendData:o.overlay.extendData}),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!0,console.log("✅ Set showDot to true:",e,"overlay:",o.overlay),o.chart&&(console.log("Attempting to override overlay to force redraw..."),o.chart.overrideOverlay({id:o.overlay.id,extendData:e})),!0},onDeselected:o=>{console.log("🔴 horizontalRayLine onDeselected called"),!o.overlay.extendData||typeof o.overlay.extendData!="object"?o.overlay.extendData={showDot:!1}:"showDot"in o.overlay.extendData||(o.overlay.extendData.showDot=!1);const e=o.overlay.extendData;return e.showDot=!1,o.chart&&o.chart.overrideOverlay({id:o.overlay.id,extendData:e}),!0}};function Y7(o,e,t,s,i,r,a){const l=s*.4,d=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.lineJoin="round",o.beginPath(),o.moveTo(e-l,t-d),o.lineTo(e+l,t+d),o.moveTo(e+l,t-d),o.lineTo(e-l,t+d),o.stroke(),o.restore()}function U7(o,e,t,s,i,r,a){const l=s*.4,d=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.beginPath(),o.ellipse(e,t,l,d,0,0,Math.PI*2),o.stroke(),o.restore()}const ex={name:"pointAndFigure",totalStep:0,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createPointFigures:()=>[],draw:o=>{var T,P,A;const{ctx:e,chart:t,bounding:s,xAxis:i,yAxis:r,overlay:a}=o;if(!t||!e||!(i!=null&&i.convertToPixel)||!(r!=null&&r.convertToPixel))return[];const l=(T=t.getVisibleRange)==null?void 0:T.call(t);if(!l)return[];const d=((P=t.getDataList)==null?void 0:P.call(t))||[];if(d.length===0)return[];const v=i.convertToPixel(0),p=i.convertToPixel(1),_=Math.max(1,Math.abs(p-v));let y=_;for(let F=l.from;F<=l.to&&F<d.length;F++){const B=(A=d[F])==null?void 0:A._pnf;if(B!=null&&B.boxes&&B.boxes.length>=2){const R=r.convertToPixel(B.boxes[0].price),N=r.convertToPixel(B.boxes[1].price);if(R!==void 0&&N!==void 0&&!isNaN(R)&&!isNaN(N)){const $=Math.abs(R-N);if($>0){y=$;break}}}}const w=_*.85,k=y*.85,S=(w+k)/2,L=Math.max(.8,S*.08);for(let F=l.from;F<=l.to&&F<d.length;F++){const B=d[F];if(!B)continue;const R=B==null?void 0:B._pnf;if(!R||!R.boxes)continue;const{direction:N,boxes:$,upColor:V="#00E6D8",downColor:U="#FF4D4D"}=R,G=i.convertToPixel(F);if(!(G==null||isNaN(G)))for(const Z of $){const le=r.convertToPixel(Z.price);le==null||isNaN(le)||(N==="up"?Y7(e,G,le,w,k,V,L):U7(e,G,le,w,k,U,L))}}return[]}},tx={name:"script-layer",totalStep:0,needDefaultPointFigure:!1,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,styles:{},createPointFigures:()=>[]},K7=[Tb,Ab,Lb,Db,Fb,Eb,$b,jb,zb,Bb,Nb,Rb,Ob,Vb,Wb,qb,Hb,Gb,Yb,Ub,Kb,Zb,Xb,Jb,Qb,ex,tx],Z7={arrow:Tb,circle:Ab,rect:Lb,triangle:Db,parallelogram:Fb,fibonacciCircle:Eb,fibonacciSegment:$b,fibonacciSpiral:jb,fibonacciSpeedResistanceFan:zb,fibonacciExtension:Bb,gannBox:Nb,threeWaves:Rb,fiveWaves:Ob,eightWaves:Vb,anyWaves:Wb,abcd:qb,xabcd:Hb,barSignal:Gb,ruler:Yb,trade:Ub,note:Kb,emoji:Zb,text:Xb,horizontalStraightLine:Jb,horizontalRayLine:Qb,pointAndFigure:ex,scriptLayer:tx};function ox(o,e,t){const{size:s=12,paddingLeft:i=0,paddingTop:r=0,paddingRight:a=0,paddingBottom:l=0}=e,{x:d,y:v,text:p,align:_="left",baseline:y="top"}=o;t=t??s*p.length;let w;switch(_){case"left":case"start":{w=d;break}case"right":case"end":{w=d-a-t-i;break}default:{w=d-t/2-i;break}}return w}function sx(o,e,t,s,i){const{size:r=12,paddingLeft:a=0,paddingTop:l=0,paddingRight:d=0,paddingBottom:v=0}=e,{x:p,y:_,text:y,align:w="left",baseline:k="top"}=o,S=y.length;t=t??r*S,s=s??1,i=i??1.5;const L=r*s*i-(i-1)*r,T=ox(o,e,t);let P;switch(k){case"top":case"hanging":{P=_;break}case"bottom":case"ideographic":case"alphabetic":{P=_-L-l-v;break}default:{P=_-L/2-l;break}}return{x:T,y:P,width:a+t+d,height:l+L+v}}const nx=Yp.calcTextWidth;function X7(o,e,t){return`${e??"normal"} ${o??12}px ${t??"Helvetica Neue"}`}function J7(o){return typeof o=="string"}function _y(o){return o==="transparent"||o==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(o)||/^[hH][Ss][Ll][Aa]\(([\s]*(360｜3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(o)}function Q7(o,e,t){let s=[];s=s.concat(e);const{style:i=of.Fill,color:r="transparent",borderSize:a=1,borderColor:l="transparent",borderStyle:d=Ee.Solid,borderRadius:v=0,borderDashedValue:p=[2,2]}=t,_=o.roundRect??o.rect,y=(i===of.Fill||t.style===of.StrokeFill)&&(!J7(r)||!_y(r));if(y&&(o.fillStyle=r,s.forEach(({x:w,y:k,width:S,height:L})=>{o.beginPath(),_.call(o,w,k,S,L,v),o.closePath(),o.fill()})),(i===of.Stroke||t.style===of.StrokeFill)&&a>0&&!_y(l)){o.strokeStyle=l,o.fillStyle=l,o.lineWidth=a,d===Ee.Dashed?o.setLineDash(p):o.setLineDash([]);const w=a%2===1?.5:0,k=Math.round(w*2);s.forEach(({x:S,y:L,width:T,height:P})=>{T>a*2&&P>a*2?(o.beginPath(),_.call(o,S+w,L+w,T-k,P-k,v),o.closePath(),o.stroke()):y||o.fillRect(S,L,T,P)})}}function eP(o,e,t){const{text:s}=e,{size:i=12,family:r,weight:a,paddingLeft:l=0,paddingTop:d=0,paddingRight:v=0}=t,p=s.split(`
`),_=p.map(T=>nx(T,i,a,r)),y=1.5,w=i*y,k=Math.max(..._),S=sx(e,t,k,p.length,y);Q7(o,S,{...t,color:t.backgroundColor});let L=S.y+d;p.forEach((T,P)=>{const A=ox(e,t,_[P])+l;o.textAlign="left",o.textBaseline="top",o.font=X7(i,a,r),o.fillStyle=t.color||"currentColor",o.fillText(T,A,L,S.width-l-v),L+=w})}function tP(o,e,t){const{size:s=12,family:i,weight:r,paddingLeft:a=0,paddingTop:l=0}=t,d=e.text.split(`
`),v=d.map(L=>nx(L,s,r,i)),p=1.5,_=Math.max(...v),{x:y,y:w,width:k,height:S}=sx(e,t,_,d.length,p);return o.x>=y&&o.x<=y+k&&o.y>=w&&o.y<=w+S}const oP={name:"textBox",checkEventOn:(o,e,t)=>tP(o,e,t),draw:(o,e,t)=>{eP(o,e,t)}},sP=[oP],nP={name:"BIAS",shortName:"BIAS",precision:2,calcParams:[6],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"bias",title:"BIAS: ",type:"line"}],styles:{lines:[{color:"#2196F3",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||6;return o.reduce((s,i,r)=>{if(r>=t-1){let a=0;for(let d=r-t+1;d<=r;d++)a+=o[d].close;const l=a/t;s[i.timestamp]={bias:(i.close-l)/l*100}}else s[i.timestamp]={};return s},{})}},iP={name:"CCI",shortName:"CCI",precision:2,calcParams:[20],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"cci",title:"CCI: ",type:"line"}],minValue:void 0,maxValue:void 0,styles:{lines:[{color:"#2563eb",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s]=t;return o.reduce((i,r,a)=>(i[r.timestamp]={cci:rP(o,a,s)},i),{})}};function rP(o,e,t){if(e<t-1)return null;const s=[];for(let v=e-t+1;v<=e;v++){const p=o[v],_=(p.high+p.low+p.close)/3;s.push(_)}const i=s.reduce((v,p)=>v+p,0)/t,r=s.reduce((v,p)=>v+Math.abs(p-i),0)/t;if(r===0)return 0;const a=o[e];return((a.high+a.low+a.close)/3-i)/(.015*r)}const aP={name:"ICHIMOKU",shortName:"ICHIMOKU",precision:4,calcParams:[9,26,52],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"tenkan",title:"Tenkan: ",type:"line"},{key:"kijun",title:"Kijun: ",type:"line"},{key:"senkouA",title:"Senkou A: ",type:"line"},{key:"senkouB",title:"Senkou B: ",type:"line"},{key:"chikou",title:"Chikou: ",type:"line"}],styles:{lines:[{color:"#FF6B6B",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#4ECDC4",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#45B7D1",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#FFA07A",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#9B59B6",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||9,s=e.calcParams[1]||26,i=e.calcParams[2]||52,r=s,a=[],l=(v,p)=>{let _=-1/0,y=1/0;for(let w=v;w<v+p&&w<o.length;w++)o[w].high>_&&(_=o[w].high),o[w].low<y&&(y=o[w].low);return{high:_,low:y}};for(let v=0;v<o.length;v++){const p={};if(v>=t-1){const{high:_,low:y}=l(v-t+1,t);p.tenkan=(_+y)/2}if(v>=s-1){const{high:_,low:y}=l(v-s+1,s);p.kijun=(_+y)/2}if(v>=s-1){const _=v,y=v;if(_>=t-1&&y>=s-1){const{high:w,low:k}=l(_-t+1,t),{high:S,low:L}=l(y-s+1,s),T=(w+k)/2,P=(S+L)/2;p.senkouA=(T+P)/2}}if(v>=i-1){const{high:_,low:y}=l(v-i+1,i);p.senkouB=(_+y)/2}p.chikou=o[v].close,a.push(p)}const d=a.map((v,p)=>{var y,w,k;const _={...v};return p>=r?(_.senkouA=(y=a[p-r])==null?void 0:y.senkouA,_.senkouB=(w=a[p-r])==null?void 0:w.senkouB):(_.senkouA=void 0,_.senkouB=void 0),p+r<a.length?_.chikou=(k=o[p+r])==null?void 0:k.close:_.chikou=void 0,_});return o.reduce((v,p,_)=>(v[p.timestamp]=d[_],v),{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var y;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:d,to:v}=l,p=t.result;o.save();const _=[];for(let w=d;w<v;w++){const k=(y=a[w])==null?void 0:y.timestamp,S=p[k];if(S&&S.senkouA!==void 0&&S.senkouB!==void 0){const L=i.convertToPixel(w),T=r.convertToPixel(S.senkouA),P=r.convertToPixel(S.senkouB);_.push({x:L,yA:T,yB:P})}}if(_.length>1){o.globalAlpha=.2;const w=_[0].yA<_[0].yB;o.fillStyle=w?"#4CAF50":"#F44336",o.beginPath(),o.moveTo(_[0].x,Math.min(_[0].yA,_[0].yB));for(let k=1;k<_.length;k++)o.lineTo(_[k].x,Math.min(_[k].yA,_[k].yB));for(let k=_.length-1;k>=0;k--)o.lineTo(_[k].x,Math.max(_[k].yA,_[k].yB));o.closePath(),o.fill()}return o.restore(),!1}},lP={name:"PVT",shortName:"PVT",precision:2,calcParams:[],shouldOhlc:!1,shouldFormatBigNumber:!0,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"pvt",title:"PVT: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t={};if(o.length===0)return t;let s=0;for(let i=0;i<o.length;i++){const r=o[i];if(i===0){t[r.timestamp]={pvt:0};continue}const a=o[i-1];if(r.close==null||a.close==null||r.volume==null||r.close<=0||a.close<=0){t[r.timestamp]={};continue}const l=(r.close-a.close)/a.close,d=s+(r.volume||0)*l;t[r.timestamp]={pvt:d},s=d}return t}},$d=new Map,Fm=o=>({id:o,period:14,lineColor:"#8B5CF6",lineThickness:2,lineStyle:"solid",overboughtLevel:70,oversoldLevel:30,middleLevel:50,overboughtColor:"#EF4444",overboughtThickness:1,overboughtLineStyle:"dashed",oversoldColor:"#22C55E",oversoldThickness:1,oversoldLineStyle:"dashed",overboughtFillColor:"#EF4444",oversoldFillColor:"#22C55E",middleLineColor:"#6B7280",middleLineThickness:1,middleLineStyle:"dashed",fillOpacity:.15,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:70,color:"#EF4444",lineStyle:"dashed",thickness:1,label:"70",visible:!0},{id:"middle",value:50,color:"#6B7280",lineStyle:"dashed",thickness:1,label:"50",visible:!0},{id:"oversold",value:30,color:"#22C55E",lineStyle:"dashed",thickness:1,label:"30",visible:!0}]}),cP=(o,e)=>{const t=[];if(o.length<e+1)return o.map(()=>NaN);let s=[],i=[];for(let v=1;v<=e;v++){const p=o[v].close-o[v-1].close;s.push(p>0?p:0),i.push(p<0?Math.abs(p):0)}let r=s.reduce((v,p)=>v+p,0)/e,a=i.reduce((v,p)=>v+p,0)/e;for(let v=0;v<e;v++)t.push(NaN);let l=r/(a||1e-4),d=100-100/(1+l);t.push(d);for(let v=e+1;v<o.length;v++){const p=o[v].close-o[v-1].close,_=p>0?p:0,y=p<0?Math.abs(p):0;r=(r*(e-1)+_)/e,a=(a*(e-1)+y)/e,l=r/(a||1e-4),d=100-100/(1+l),t.push(d)}return t};function dP(o){if(!o)return null;const e=o.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i);if(e)return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)};const t=o.match(/^#?([a-f\d])([a-f\d])([a-f\d])$/i);if(t)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16)};const s=o.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*[\d.]+\s*)?\)/i);return s?{r:parseInt(s[1],10),g:parseInt(s[2],10),b:parseInt(s[3],10)}:null}function dm(o,e,t,s,i){if(e<=i&&s>=i||e>=i&&s<=i){if(e===s)return null;const r=(i-e)/(s-e);return{x:o+r*(t-o),y:i}}return null}const ix={name:"RSI",shortName:"RSI",precision:2,calcParams:[14],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:0,maxValue:100,figures:[{key:"rsi",title:"RSI: ",type:"line"}],styles:{lines:[{color:"#8B5CF6",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||14,s=cP(o,t);return o.reduce((i,r,a)=>{const l=s[a];return i[r.timestamp]={rsi:isNaN(l)?null:l},i},{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var k,S,L,T;const a=t.paneId||"default";let l=$d.get(a);l||(l=Fm(a),$d.set(a,l));const{left:d,width:v}=s,p=e.getVisibleRange(),_=e.getDataList();o.save();const y=r.convertToPixel(l.overboughtLevel),w=r.convertToPixel(l.oversoldLevel);if(l.showFill){const P=[],A=[];let F=!1,B=!1;for(let R=p.from;R<=p.to;R++){const N=(k=_[R])==null?void 0:k.timestamp,$=t.result[N];if(!$||$.rsi===null||$.rsi===void 0)continue;const V=i.convertToPixel(R),U=r.convertToPixel($.rsi);if(V===null||U===null)continue;const G=(S=_[R-1])==null?void 0:S.timestamp,Z=R>0?t.result[G]:null,le=Z==null?void 0:Z.rsi,se=R>0?i.convertToPixel(R-1):null,ie=le!=null?r.convertToPixel(le):null;if($.rsi>l.overboughtLevel){if(!F&&(F=!0,se!==null&&ie!==null&&le!==null&&le!==void 0&&le<=l.overboughtLevel)){const Y=dm(se,ie,V,U,y);Y&&(P.push({x:Y.x,y}),Y.x)}P.push({x:V,y:U})}else if(F){if(se!==null&&ie!==null&&le!==null&&le!==void 0){const Y=dm(se,ie,V,U,y);Y&&P.push({x:Y.x,y})}P.length>=2&&um(o,P,y,l.overboughtFillColor,l.fillOpacity,"above"),P.length=0,F=!1}if($.rsi<l.oversoldLevel){if(!B&&(B=!0,se!==null&&ie!==null&&le!==null&&le!==void 0&&le>=l.oversoldLevel)){const Y=dm(se,ie,V,U,w);Y&&(A.push({x:Y.x,y:w}),Y.x)}A.push({x:V,y:U})}else if(B){if(se!==null&&ie!==null&&le!==null&&le!==void 0){const Y=dm(se,ie,V,U,w);Y&&A.push({x:Y.x,y:w})}A.length>=2&&um(o,A,w,l.oversoldFillColor,l.fillOpacity,"below"),A.length=0,B=!1}}F&&P.length>=2&&um(o,P,y,l.overboughtFillColor,l.fillOpacity,"above"),B&&A.length>=2&&um(o,A,w,l.oversoldFillColor,l.fillOpacity,"below")}l.showLevels&&l.levels.forEach(P=>{if(!P.visible)return;const A=r.convertToPixel(P.value);if(A===null)return;o.save(),o.strokeStyle=P.color;let F=1,B="dashed";P.id==="overbought"?(F=l.overboughtThickness??1,B=l.overboughtLineStyle??"dashed"):P.id==="oversold"?(F=l.oversoldThickness??1,B=l.oversoldLineStyle??"dashed"):P.id==="middle"&&(F=l.middleLineThickness??1,B=l.middleLineStyle??"dashed"),F=Math.max(1,Math.round(F)),o.lineWidth=F;const R=F%2===1?Math.floor(A)+.5:Math.round(A);B==="dashed"?o.setLineDash([6*F,4*F]):B==="dotted"?o.setLineDash([F,F*2]):o.setLineDash([]),o.beginPath(),o.moveTo(Math.floor(d),R),o.lineTo(Math.floor(d+v),R),o.stroke(),o.restore()}),o.lineCap="round",o.lineJoin="round";for(let P=p.from;P<p.to;P++){const A=(L=_[P])==null?void 0:L.timestamp,F=(T=_[P+1])==null?void 0:T.timestamp,B=t.result[A],R=t.result[F];if(!B||!R||B.rsi===null||B.rsi===void 0||R.rsi===null||R.rsi===void 0)continue;const N=i.convertToPixel(P),$=i.convertToPixel(P+1),V=r.convertToPixel(B.rsi),U=r.convertToPixel(R.rsi);if(N===null||$===null||V===null||U===null)continue;let G=l.lineColor;B.rsi>l.overboughtLevel?G=l.overboughtColor:B.rsi<l.oversoldLevel&&(G=l.oversoldColor),o.strokeStyle=G,o.lineWidth=l.lineThickness,l.lineStyle==="dashed"?o.setLineDash([6,4]):l.lineStyle==="dotted"?o.setLineDash([2,2]):o.setLineDash([]),o.beginPath(),o.moveTo(N,V),o.lineTo($,U),o.stroke()}return o.restore(),!0}};function um(o,e,t,s,i,r){if(e.length<2)return;o.save();let a=dP(s);a||(a=r==="above"?{r:239,g:68,b:68}:{r:34,g:197,b:94});const l=Math.min(...e.map(p=>p.y)),d=Math.max(...e.map(p=>p.y));let v;r==="above"?(v=o.createLinearGradient(0,t,0,l),v.addColorStop(0,`rgba(${a.r}, ${a.g}, ${a.b}, 0.02)`),v.addColorStop(.5,`rgba(${a.r}, ${a.g}, ${a.b}, ${i*.5})`),v.addColorStop(1,`rgba(${a.r}, ${a.g}, ${a.b}, ${i})`)):(v=o.createLinearGradient(0,t,0,d),v.addColorStop(0,`rgba(${a.r}, ${a.g}, ${a.b}, 0.02)`),v.addColorStop(.5,`rgba(${a.r}, ${a.g}, ${a.b}, ${i*.5})`),v.addColorStop(1,`rgba(${a.r}, ${a.g}, ${a.b}, ${i})`)),o.fillStyle=v,o.beginPath(),o.moveTo(e[0].x,e[0].y);for(let p=1;p<e.length;p++)o.lineTo(e[p].x,e[p].y);o.lineTo(e[e.length-1].x,t),o.lineTo(e[0].x,t),o.closePath(),o.fill(),o.restore()}const mp={createInstance:(o,e)=>{const t=Fm(o);return e&&(e.levels&&(t.levels=e.levels),Object.keys(e).forEach(s=>{s!=="levels"&&e[s]!==void 0&&(t[s]=e[s])})),$d.set(o,t),t},getInstance:o=>$d.get(o),getInstanceConfig:o=>$d.get(o)||null,updateInstance:(o,e)=>{const t=$d.get(o);if(!t){const s=Fm(o);return Object.assign(s,e),$d.set(o,s),!0}return e.levels&&(t.levels=e.levels),Object.keys(e).forEach(s=>{s!=="levels"&&e[s]!==void 0&&(t[s]=e[s])}),$d.set(o,t),!0},deleteInstance:o=>$d.delete(o),getAllInstances:()=>new Map($d),clearAllInstances:()=>{$d.clear()},resetInstance:o=>{const e=Fm(o);$d.set(o,e)},exportInstanceConfig:o=>$d.get(o)||null,importInstanceConfig:o=>{try{if(!o||!o.id)return!1;const e={id:o.id,period:o.period??14,lineColor:o.lineColor??"#8B5CF6",lineThickness:o.lineThickness??2,lineStyle:o.lineStyle??"solid",overboughtLevel:o.overboughtLevel??70,oversoldLevel:o.oversoldLevel??30,middleLevel:o.middleLevel??50,overboughtColor:o.overboughtColor??"#EF4444",overboughtThickness:o.overboughtThickness??1,overboughtLineStyle:o.overboughtLineStyle??"dashed",oversoldColor:o.oversoldColor??"#22C55E",oversoldThickness:o.oversoldThickness??1,oversoldLineStyle:o.oversoldLineStyle??"dashed",overboughtFillColor:o.overboughtFillColor??o.overboughtColor??"#EF4444",oversoldFillColor:o.oversoldFillColor??o.oversoldColor??"#22C55E",middleLineColor:o.middleLineColor??"#6B7280",middleLineThickness:o.middleLineThickness??1,middleLineStyle:o.middleLineStyle??"dashed",fillOpacity:o.fillOpacity??.15,showLevels:o.showLevels??!0,showFill:o.showFill??!0,levels:o.levels??[{id:"overbought",value:o.overboughtLevel??70,color:o.overboughtColor??"#EF4444",lineStyle:o.overboughtLineStyle??"dashed",thickness:o.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:o.middleLevel??50,color:o.middleLineColor??"#6B7280",lineStyle:o.middleLineStyle??"dashed",thickness:o.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:o.oversoldLevel??30,color:o.oversoldColor??"#22C55E",lineStyle:o.oversoldLineStyle??"dashed",thickness:o.oversoldThickness??1,label:"30",visible:!0}]};return $d.set(o.id,e),!0}catch(e){return console.error("Failed to import RSI instance config:",e),!1}},updateLevel:(o,e,t)=>{const s=$d.get(o);if(!s)return!1;const i=s.levels.find(r=>r.id===e);return i?(Object.assign(i,t),e==="overbought"&&t.value!==void 0?s.overboughtLevel=t.value:e==="oversold"&&t.value!==void 0?s.oversoldLevel=t.value:e==="middle"&&t.value!==void 0&&(s.middleLevel=t.value),!0):!1},addLevel:(o,e)=>{const t=$d.get(o);if(!t)throw new Error(`RSI instance ${o} not found`);const s=`level_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={...e,id:s,value:Math.max(0,Math.min(100,e.value))};return t.levels.push(i),s},removeLevel:(o,e)=>{const t=$d.get(o);if(!t)return!1;const s=t.levels.findIndex(i=>i.id===e);return s===-1?!1:(t.levels.splice(s,1),!0)}},yy=Object.freeze(Object.defineProperty({__proto__:null,RSIManager:mp,rsi:ix},Symbol.toStringTag,{value:"Module"})),uP={name:"SAR",shortName:"SAR",precision:4,calcParams:[.02,.02,.2],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"sar",title:"SAR: ",type:"line"}],styles:{lines:[{color:"#2563eb",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||.02,s=e.calcParams[1]||.02,i=e.calcParams[2]||.2,r={};if(o.length<2)return o.map(()=>({}));let a=!0,l=t,d=o[0].high,v=o[0].low;r[o[0].timestamp]={sar:v};for(let p=1;p<o.length;p++){const _=o[p],y=o[p-1];a?(v=v+l*(d-v),v=Math.min(v,_.low,y.low),_.low<=v?(a=!1,v=d,d=_.low,l=t):_.high>d&&(d=_.high,l=Math.min(l+s,i))):(v=v-l*(v-d),v=Math.max(v,_.high,y.high),_.high>=v?(a=!0,v=d,d=_.high,l=t):_.low<d&&(d=_.low,l=Math.min(l+s,i))),r[o[p].timestamp]={sar:v}}return r},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var y,w,k;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:d,to:v}=l;o.save();const p=((w=(y=t.styles)==null?void 0:y.lines)==null?void 0:w[0])||{color:"#2563eb",size:1},_=p.size||1;for(let S=d;S<=v;S++){const L=(k=a[S])==null?void 0:k.timestamp,T=t.result[L];if(!T||typeof T.sar!="number")continue;const P=i.convertToPixel(S),A=r.convertToPixel(T.sar);P>=s.left&&P<=s.left+s.width&&A>=s.top&&A<=s.top+s.height&&(o.beginPath(),o.arc(P,A,_,0,2*Math.PI),o.fillStyle=p.color,o.fill(),o.strokeStyle=p.color,o.lineWidth=1,o.stroke())}return o.restore(),!0}},vd=new Map,X_=o=>({id:o,period:14,lineColor:"#2563eb",lineThickness:1,lineStyle:"solid",showLevels:!0,showZones:!0,yAxisSync:!0,enableDynamicColoring:!0,overboughtColor:"#EF4444",oversoldColor:"#10B981",overboughtThreshold:-20,oversoldThreshold:-80,levels:[{id:"overbought",value:-20,color:"#EF4444",lineStyle:"solid",thickness:1,label:"Overbought",visible:!0},{id:"middle",value:-50,color:"#6B7280",lineStyle:"dashed",thickness:1,label:"Middle",visible:!0},{id:"oversold",value:-80,color:"#10B981",lineStyle:"solid",thickness:1,label:"Oversold",visible:!0}],zones:[{id:"overbought_zone",topLevel:0,bottomLevel:-20,fillColor:"#EF4444",fillOpacity:.1,visible:!0,type:"overbought"},{id:"oversold_zone",topLevel:-80,bottomLevel:-100,fillColor:"#10B981",fillOpacity:.1,visible:!0,type:"oversold"}]}),pP=(o,e)=>{const t=[];if(o.length<e)return o.map(()=>NaN);for(let s=0;s<o.length;s++){if(s<e-1){t.push(NaN);continue}let i=o[s-e+1].high,r=o[s-e+1].low;for(let d=s-e+2;d<=s;d++)o[d].high>i&&(i=o[d].high),o[d].low<r&&(r=o[d].low);const a=o[s].close,l=(i-a)/(i-r)*-100;t.push(isNaN(l)?0:l)}return t},vP={name:"WR",shortName:"WR",precision:2,calcParams:[14],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:-100,maxValue:0,figures:[{key:"wr",title:"WR: ",type:"line"}],styles:{lines:[{color:"#2563eb",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||14,s=pP(o,t);return o.reduce((i,r,a)=>{const l=s[a];return i[r.timestamp]={wr:isNaN(l)?null:l},i},{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var w,k;const a=t.paneId||"default";let l=vd.get(a);l||(l=X_(a),vd.set(a,l));const{left:d,top:v,width:p,height:_}=s,y=e.getVisibleRange();if(o.save(),l.showZones&&l.zones.forEach(S=>{if(!S.visible)return;const L=r.convertToPixel(S.topLevel),T=r.convertToPixel(S.bottomLevel);if(L!==null&&T!==null){o.save();const P=Math.abs(L-T),A=Math.min(L,T),F=o.createLinearGradient(d,A,d,A+P),R=S.fillColor.match(/\w\w/g);if(R){const N=parseInt(R[0],16),$=parseInt(R[1],16),V=parseInt(R[2],16);F.addColorStop(0,`rgba(${N}, ${$}, ${V}, ${S.fillOpacity*.8})`),F.addColorStop(.3,`rgba(${N}, ${$}, ${V}, ${S.fillOpacity*.6})`),F.addColorStop(.7,`rgba(${N}, ${$}, ${V}, ${S.fillOpacity*.3})`),F.addColorStop(1,`rgba(${N}, ${$}, ${V}, ${S.fillOpacity*.1})`)}else F.addColorStop(0,S.fillColor+Math.floor(S.fillOpacity*255).toString(16).padStart(2,"0")),F.addColorStop(.5,S.fillColor+Math.floor(S.fillOpacity*128).toString(16).padStart(2,"0")),F.addColorStop(1,S.fillColor+Math.floor(S.fillOpacity*32).toString(16).padStart(2,"0"));o.fillStyle=F,o.fillRect(d,A,p,P),o.strokeStyle=S.fillColor+"40",o.lineWidth=.5,o.strokeRect(d,A,p,P),o.restore()}}),l.showLevels&&l.levels.forEach(S=>{if(!S.visible)return;const L=r.convertToPixel(S.value);L!==null&&(o.save(),o.strokeStyle=S.color,o.lineWidth=S.thickness,S.lineStyle==="dashed"?o.setLineDash([4,4]):S.lineStyle==="dotted"?o.setLineDash([2,2]):o.setLineDash([]),o.beginPath(),o.moveTo(d,L),o.lineTo(d+p,L),o.stroke(),l.yAxisSync&&(o.font="11px Arial",o.textAlign="left",o.fillStyle=S.color,o.fillText(`WR ${S.value}`,d+p+5,L+4)),o.restore())}),l.enableDynamicColoring&&t.result){const{from:S,to:L}=y,T=e.getDataList();for(let P=S;P<L;P++){const A=(w=T[P])==null?void 0:w.timestamp,F=(k=t.result[A])==null?void 0:k.wr;if(F!=null){const B=i.convertToPixel(P),R=r.convertToPixel(F);if(B!==null&&R!==null){o.save();let N=l.lineColor;F>l.overboughtThreshold?N=l.overboughtColor:F<l.oversoldThreshold&&(N=l.oversoldColor),o.fillStyle=N,o.beginPath(),o.arc(B,R,1,0,2*Math.PI),o.fill(),o.restore()}}}}return o.restore(),!1}},f_={createInstance:(o,e)=>{const t=X_(o);return e&&Object.assign(t,e),vd.set(o,t),t},getInstance:o=>vd.get(o),updateInstance:(o,e)=>{const t=vd.get(o);return t?(Object.assign(t,e),vd.set(o,t),!0):!1},deleteInstance:o=>vd.delete(o),addLevel:(o,e)=>{const t=vd.get(o);if(!t)throw new Error(`WR instance ${o} not found`);const s=`level_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={...e,id:s,value:Math.max(-100,Math.min(0,e.value))};return t.levels.push(i),s},removeLevel:(o,e)=>{const t=vd.get(o);if(!t)return!1;const s=t.levels.findIndex(i=>i.id===e);return s===-1?!1:(t.levels.splice(s,1),!0)},updateLevel:(o,e,t)=>{const s=vd.get(o);if(!s)return!1;const i=s.levels.find(r=>r.id===e);return i?(t.value!==void 0&&(t.value=Math.max(-100,Math.min(0,t.value))),t.thickness!==void 0&&(t.thickness=Math.max(1,Math.min(5,t.thickness))),Object.assign(i,t),!0):!1},addZone:(o,e)=>{const t=vd.get(o);if(!t)throw new Error(`WR instance ${o} not found`);const s=Math.max(-100,Math.min(0,Math.max(e.topLevel,e.bottomLevel))),i=Math.max(-100,Math.min(0,Math.min(e.topLevel,e.bottomLevel))),r=`zone_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,a={...e,id:r,topLevel:s,bottomLevel:i,fillOpacity:Math.max(0,Math.min(1,e.fillOpacity||.15))};return t.zones.push(a),r},removeZone:(o,e)=>{const t=vd.get(o);if(!t)return!1;const s=t.zones.findIndex(i=>i.id===e);return s===-1?!1:(t.zones.splice(s,1),!0)},updateZone:(o,e,t)=>{const s=vd.get(o);if(!s)return!1;const i=s.zones.find(r=>r.id===e);if(!i)return!1;if(t.topLevel!==void 0&&(t.topLevel=Math.max(-100,Math.min(0,t.topLevel))),t.bottomLevel!==void 0&&(t.bottomLevel=Math.max(-100,Math.min(0,t.bottomLevel))),t.fillOpacity!==void 0&&(t.fillOpacity=Math.max(0,Math.min(1,t.fillOpacity))),Object.assign(i,t),i.topLevel<i.bottomLevel){const r=i.topLevel;i.topLevel=i.bottomLevel,i.bottomLevel=r}return!0},getInstanceConfig:o=>vd.get(o)||null,resetInstance:o=>{const e=X_(o);vd.set(o,e)},exportInstanceConfig:o=>{const e=vd.get(o);return e?{id:o,period:e.period,lineColor:e.lineColor,lineThickness:e.lineThickness,lineStyle:e.lineStyle,showLevels:e.showLevels,showZones:e.showZones,yAxisSync:e.yAxisSync,levels:e.levels.map(t=>({...t})),zones:e.zones.map(t=>({...t}))}:null},importInstanceConfig:o=>{try{const e={id:o.id,period:o.period||14,lineColor:o.lineColor||"#FF6B35",lineThickness:o.lineThickness||2,lineStyle:o.lineStyle||"solid",showLevels:o.showLevels??!0,showZones:o.showZones??!0,yAxisSync:o.yAxisSync??!0,enableDynamicColoring:o.enableDynamicColoring??!0,overboughtColor:o.overboughtColor||"#EF4444",oversoldColor:o.oversoldColor||"#10B981",overboughtThreshold:o.overboughtThreshold||-20,oversoldThreshold:o.oversoldThreshold||-80,levels:o.levels||[],zones:o.zones||[]};return vd.set(o.id,e),!0}catch(e){return console.error("Failed to import WR instance config:",e),!1}},getAllInstances:()=>new Map(vd),clearAllInstances:()=>{vd.clear()}},fP={name:"VR",shortName:"VR",precision:2,calcParams:[26,6,12],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:100-1e-9,maxValue:100+1e-9,figures:[{key:"vr",title:"VR: ",type:"line"},{key:"vrShort",title:"VR Short: ",type:"line"},{key:"vrLong",title:"VR Long: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#2196F3",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#4CAF50",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||26,s=e.calcParams[1]||6,i=e.calcParams[2]||12,r={};if(o.length<Math.max(t,s,i)+1)return o.reduce((l,d)=>(l[d.timestamp]={},l),{});const a=(l,d)=>{if(l<d)return 100;let v=0,p=0,_=0;for(let k=l-d+1;k<=l;k++){if(k===0)continue;const S=o[k],L=o[k-1];S.close>L.close?v+=S.volume||0:S.close<L.close?p+=S.volume||0:_+=S.volume||0}const y=v+_/2,w=p+_/2;return w===0?100:y/w*100};for(let l=0;l<o.length;l++){const d=a(l,t),v=a(l,s),p=a(l,i);r[o[l].timestamp]={vr:d,vrShort:v,vrLong:p}}return r},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{e.getVisibleRange(),o.save(),o.lineWidth=1,o.setLineDash([2,2]),o.strokeStyle="rgba(107, 114, 128, 0.6)",o.beginPath();const a=r.convertToPixel(100);o.moveTo(s.left,a),o.lineTo(s.left+s.width,a),o.stroke(),o.strokeStyle="rgba(239, 68, 68, 0.6)",o.beginPath();const l=r.convertToPixel(150);o.moveTo(s.left,l),o.lineTo(s.left+s.width,l),o.stroke(),o.strokeStyle="rgba(34, 197, 94, 0.6)",o.beginPath();const d=r.convertToPixel(70);return o.moveTo(s.left,d),o.lineTo(s.left+s.width,d),o.stroke(),o.restore(),!1}},gP={name:"ROC",shortName:"ROC",precision:2,calcParams:[14],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"roc",title:"ROC: ",type:"line"}],minValue:void 0,maxValue:void 0,styles:{lines:[{color:"#FF6B6B",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s]=t;return o.reduce((i,r,a)=>(i[r.timestamp]={roc:mP(o,a,s)},i),{})}};function mP(o,e,t){if(e<t)return null;const s=o[e].close,i=o[e-t].close;return i===0?null:(s-i)/i*100}const hP={name:"PSY",shortName:"PSY",precision:2,calcParams:[12,6],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"mapsy",title:"MAPSY: ",type:"line"}],minValue:0,maxValue:100,styles:{lines:[{color:"#2563eb",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#dc2626",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s,i]=t;return o.reduce((r,a,l)=>(r[a.timestamp]={psy:rx(o,l,s),mapsy:_P(o,l,s,i)},r),{})}};function rx(o,e,t){if(e<t)return null;let s=0;for(let i=e-t+1;i<=e;i++)i>0&&o[i].close>o[i-1].close&&s++;return s/t*100}function _P(o,e,t,s){if(e<t+s-1)return null;let i=0,r=0;for(let a=e-s+1;a<=e;a++){const l=rx(o,a,t);l!==null&&(i+=l,r++)}return r>0?i/r:null}const yP={name:"OBV",shortName:"OBV",precision:0,calcParams:[30,10],shouldOhlc:!1,shouldFormatBigNumber:!0,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maobv",title:"MAOBV: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#2196F3",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[1]||10,s={};if(o.length===0)return s;let i=0;const r=[];for(let a=0;a<o.length;a++){const l=o[a];if(a===0)i=0;else{const v=o[a-1],p=l.volume||0;l.close>v.close?i+=p:l.close<v.close&&(i-=p)}r.push(i);let d;if(a>=t-1){let v=0;for(let p=a-t+1;p<=a;p++)v+=r[p];d=v/t}s[l.timestamp]={obv:i,maobv:d}}return s}},bP={name:"ZIGZAG",shortName:"ZIGZAG",precision:2,calcParams:[5,5],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:1,extendData:void 0,figures:[],styles:{lines:[{color:"#2962FF",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}],circles:[{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888"}]},calc:(o,e)=>{const t=(e.calcParams[0]||5)/100,s=e.calcParams[1]||5,i=[];if(o.length<s*2)return o.map(()=>({}));let r=0,a=o[0].high,l="high",d=!1;for(let v=0;v<o.length;v++)i.push({});i[0]={zigzag:o[0].close};for(let v=s;v<o.length;v++){const p=o[v].high,_=o[v].low,y=Math.abs(p-a)/a,w=Math.abs(_-a)/a;if(y>=t){r=v,a=p,l="high",d=!1,i[v]={zigzag:p,isHigh:!0};break}else if(w>=t){r=v,a=_,l="low",d=!0,i[v]={zigzag:_,isLow:!0};break}}for(let v=r+s;v<o.length;v++){const p=o[v].high,_=o[v].low;d?(p-a)/a>=t?(r=v,a=p,l="high",d=!1,i[v]={zigzag:p,isHigh:!0}):l==="low"&&_<a&&(i[r]={},r=v,a=_,i[v]={zigzag:_,isLow:!0}):(a-_)/a>=t?(r=v,a=_,l="low",d=!0,i[v]={zigzag:_,isLow:!0}):l==="high"&&p>a&&(i[r]={},r=v,a=p,i[v]={zigzag:p,isHigh:!0})}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var w,k,S,L;if(!t.result||t.result.length===0)return!1;const a=e.getVisibleRange(),{from:l,to:d}=a,v=t.result;o.save();const p=((k=(w=t.styles)==null?void 0:w.lines)==null?void 0:k[0])||{color:"#2962FF",size:2,style:Ee.Solid,dashedValue:[2,2]},_=((L=(S=t.styles)==null?void 0:S.circles)==null?void 0:L[0])||{upColor:"#26A69A",downColor:"#EF5350"},y=[];for(let T=Math.max(0,l-50);T<Math.min(d+1,v.length);T++){const P=v[T];P&&typeof P.zigzag=="number"&&y.push({index:T,price:P.zigzag,isHigh:P.isHigh||!1,isLow:P.isLow||!1})}if(o.strokeStyle=p.color||"#2962FF",o.lineWidth=p.size||2,p.style===Ee.Dashed){const T=Array.isArray(p.dashedValue)?p.dashedValue:[4,4];o.setLineDash(T)}else o.setLineDash([]);for(let T=0;T<y.length-1;T++){const P=y[T],A=y[T+1],F=i.convertToPixel(P.index),B=r.convertToPixel(P.price),R=i.convertToPixel(A.index),N=r.convertToPixel(A.price);o.beginPath(),o.moveTo(F,B),o.lineTo(R,N),o.stroke()}return y.forEach(T=>{if(T.index<l||T.index>=d)return;const P=i.convertToPixel(T.index),A=r.convertToPixel(T.price);P>=s.left&&P<=s.left+s.width&&A>=s.top&&A<=s.top+s.height&&(o.beginPath(),o.arc(P,A,4,0,2*Math.PI),T.isHigh?o.fillStyle=_.downColor:T.isLow?o.fillStyle=_.upColor:o.fillStyle=p.color,o.fill(),o.strokeStyle="#FFFFFF",o.lineWidth=1.5,o.stroke())}),o.restore(),!0}},xP={name:"Custom Momentum",shortName:"CM",calcParams:[12,26],shouldOhlc:!1,shouldFormatBigNumber:!1,precision:5,styles:{lines:[{color:"#26a69a",size:2,style:"solid"}],bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575",size:3,borderColor:"#26a69a",borderSize:0,borderStyle:"solid"}]},figures:[{key:"momentum",title:"Momentum: ",type:"line",baseValue:0},{key:"histogram",title:"Histogram: ",type:"bar",baseValue:0,styles:{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575"}}],calc:(o,e)=>{const t=e.calcParams[0]||12,s=e.calcParams[1]||26,i=[];for(let r=0;r<o.length;r++){const l=o[r].close;if(r>=s-1){let d=0;if(r===s-1){let y=0;for(let w=r-t+1;w<=r;w++)y+=o[w].close;d=y/t}else{const y=2/(t+1);d=l*y+(i[r-1].momentum||0)*(1-y)}let v=0;if(r===s-1){let y=0;for(let w=r-s+1;w<=r;w++)y+=o[w].close;v=y/s}else{const y=2/(s+1);v=l*y+(i[r-1].momentum||0)*(1-y)}const p=d-v,_=p;i.push({momentum:p,histogram:_})}else i.push({})}return i}},wP={name:"Custom AO",shortName:"CAO",calcParams:[5,34],shouldOhlc:!1,shouldFormatBigNumber:!1,precision:5,styles:{bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575",size:3,borderColor:"#26a69a",borderSize:0,borderStyle:"solid",fillColor:"#26a69a",strokeColor:"#26a69a"}]},figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#757575"}}],calc:(o,e)=>{const t=e.calcParams[0]||5,s=e.calcParams[1]||34,i=[];for(let r=0;r<o.length;r++)if(r>=s-1){const a=[],l=[];for(let _=r-t+1;_<=r;_++){const y=(o[_].high+o[_].low)/2;a.push(y)}for(let _=r-s+1;_<=r;_++){const y=(o[_].high+o[_].low)/2;l.push(y)}const d=a.reduce((_,y)=>_+y,0)/t,v=l.reduce((_,y)=>_+y,0)/s,p=d-v;i.push({ao:p})}else i.push({});return i},draw:(o,e,t,s,i)=>{t.calcParams[0];const r=t.calcParams[1]||34;o.save();for(let a=r-1;a<e.length;a++){const d=e[a].ao;if(d!==void 0){const v=s.convertToPixel(a),p=i.convertToPixel(0),_=i.convertToPixel(d);let y="#757575";d>0?y="#26a69a":d<0&&(y="#ef5350"),o.fillStyle=y,o.strokeStyle=y,o.lineWidth=1;const w=Math.max(2,s.getPixelDistance(1)*.8),k=Math.abs(p-_),S=v-w/2,L=Math.min(p,_);o.fillRect(S,L,w,k),o.strokeRect(S,L,w,k)}}o.restore()}},kP={name:"BOLL",shortName:"BOLL",precision:2,calcParams:[20,2],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"upper",title:"Upper: ",type:"line"},{key:"middle",title:"Middle: ",type:"line"},{key:"lower",title:"Lower: ",type:"line"}],styles:{lines:[{color:"#f23645",size:1,style:Ee.Solid,smooth:!1,dashedValue:[0,0]},{color:"#2962ff",size:1,style:Ee.Solid,smooth:!1,dashedValue:[0,0]},{color:"#089981",size:1,style:Ee.Solid,smooth:!1,dashedValue:[0,0]}],fill:{color:"#2196F3",opacity:.05}},calc:(o,e)=>{const t=e.calcParams[0]||20,s=e.calcParams[1]||2,i={};for(let r=0;r<o.length;r++){const a=o[r].timestamp;if(r<t-1){i[a]={};continue}let l=0;for(let w=r-t+1;w<=r;w++)l+=o[w].close;const d=l/t;let v=0;for(let w=r-t+1;w<=r;w++)v+=Math.pow(o[w].close-d,2);const p=Math.sqrt(v/t),_=d+s*p,y=d-s*p;i[a]={upper:_,middle:d,lower:y}}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var S,L,T,P,A,F,B,R,N,$,V,U,G,Z,le,se,ie,Y,K,Q,q,ce,_e,me,Pe,ze,he,De,ge,be,$e,Ve,Ce,Je,ye,Ae;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),d=Math.max(l.from,0),v=Math.min(l.to,a.length-1);o.save();const p={color:((T=(L=(S=t.styles)==null?void 0:S.lines)==null?void 0:L[0])==null?void 0:T.color)||"#2196F3",size:((F=(A=(P=t.styles)==null?void 0:P.lines)==null?void 0:A[0])==null?void 0:F.size)||1,style:((N=(R=(B=t.styles)==null?void 0:B.lines)==null?void 0:R[0])==null?void 0:N.style)||Ee.Solid},_={color:((U=(V=($=t.styles)==null?void 0:$.lines)==null?void 0:V[1])==null?void 0:U.color)||"#FF9800",size:((le=(Z=(G=t.styles)==null?void 0:G.lines)==null?void 0:Z[1])==null?void 0:le.size)||1,style:((Y=(ie=(se=t.styles)==null?void 0:se.lines)==null?void 0:ie[1])==null?void 0:Y.style)||Ee.Solid},y={color:((q=(Q=(K=t.styles)==null?void 0:K.lines)==null?void 0:Q[2])==null?void 0:q.color)||"#2196F3",size:((me=(_e=(ce=t.styles)==null?void 0:ce.lines)==null?void 0:_e[2])==null?void 0:me.size)||1,style:((he=(ze=(Pe=t.styles)==null?void 0:Pe.lines)==null?void 0:ze[2])==null?void 0:he.style)||Ee.Solid},w={color:((ge=(De=t.styles)==null?void 0:De.fill)==null?void 0:ge.color)||"rgba(33, 150, 243, 0.1)",opacity:(($e=(be=t.styles)==null?void 0:be.fill)==null?void 0:$e.opacity)||.1};o.beginPath();let k=!0;for(let ee=d;ee<=v;ee++){const xe=(Ve=a[ee])==null?void 0:Ve.timestamp,ke=t.result[xe];if(!ke||typeof ke.upper!="number")continue;const He=i.convertToPixel(ee),Ie=r.convertToPixel(ke.upper);k?(o.moveTo(He,Ie),k=!1):o.lineTo(He,Ie)}for(let ee=v;ee>=d;ee--){const xe=(Ce=a[ee])==null?void 0:Ce.timestamp,ke=t.result[xe];if(!ke||typeof ke.lower!="number")continue;const He=i.convertToPixel(ee),Ie=r.convertToPixel(ke.lower);o.lineTo(He,Ie)}o.closePath(),o.globalAlpha=w.opacity,o.fillStyle=w.color,o.fill(),o.globalAlpha=1,o.beginPath(),k=!0;for(let ee=d;ee<=v;ee++){const xe=(Je=a[ee])==null?void 0:Je.timestamp,ke=t.result[xe];if(!ke||typeof ke.upper!="number")continue;const He=i.convertToPixel(ee),Ie=r.convertToPixel(ke.upper);k?(o.moveTo(He,Ie),k=!1):o.lineTo(He,Ie)}o.strokeStyle=p.color,o.lineWidth=p.size,o.setLineDash(p.style===Ee.Dashed?[4,4]:[]),o.stroke(),o.beginPath(),k=!0;for(let ee=d;ee<=v;ee++){const xe=(ye=a[ee])==null?void 0:ye.timestamp,ke=t.result[xe];if(!ke||typeof ke.lower!="number")continue;const He=i.convertToPixel(ee),Ie=r.convertToPixel(ke.lower);k?(o.moveTo(He,Ie),k=!1):o.lineTo(He,Ie)}o.strokeStyle=y.color,o.lineWidth=y.size,o.setLineDash(y.style===Ee.Dashed?[4,4]:[]),o.stroke(),o.beginPath(),k=!0;for(let ee=d;ee<=v;ee++){const xe=(Ae=a[ee])==null?void 0:Ae.timestamp,ke=t.result[xe];if(!ke||typeof ke.middle!="number")continue;const He=i.convertToPixel(ee),Ie=r.convertToPixel(ke.middle);k?(o.moveTo(He,Ie),k=!1):o.lineTo(He,Ie)}return o.strokeStyle=_.color,o.lineWidth=_.size,o.setLineDash(_.style===Ee.Dashed?[4,4]:[]),o.stroke(),o.restore(),!0}};function SP(o,e){const t=e.calcParams||[26,10,20,40,60],[s,i,r,a,l]=t,d={};if(o.length<s+1)return o.reduce((p,_,y)=>(p[_.timestamp]={},p),{});const v=[];for(let p=1;p<o.length;p++){o[p];const _=o[p-1];(_.high+_.low+_.close)/3;let y=0,w=0;const k=Math.max(0,p-s+1);for(let F=k;F<=p;F++){const B=o[F],R=F>0?o[F-1]:B,N=(R.high+R.low+R.close)/3,$=B.high-N,V=N-B.low;$>0&&(y+=$),V>0&&(w+=V)}const S=w!==0?y/w*100:100;v.push(S);const L=pm(v,i),T=pm(v,r),P=pm(v,a),A=pm(v,l);d[o[p].timestamp]={cr:S,ma1:L!==null?L:void 0,ma2:T!==null?T:void 0,ma3:P!==null?P:void 0,ma4:A!==null?A:void 0}}return d}function pm(o,e){return o.length<e?null:o.slice(-e).reduce((s,i)=>s+i,0)/e}const CP={name:"CR",shortName:"CR",precision:2,calcParams:[26,10,20,40,60],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:SP,regenerateFigures:o=>{const[,e,t,s,i]=o;return[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:`MA${e}: `,type:"line"},{key:"ma2",title:`MA${t}: `,type:"line"},{key:"ma3",title:`MA${s}: `,type:"line"},{key:"ma4",title:`MA${i}: `,type:"line"}]},styles:{lines:[{color:"#FF6B35",size:2,style:Ee.Solid},{color:"#2196F3",size:1,style:Ee.Solid},{color:"#4CAF50",size:1,style:Ee.Solid},{color:"#FF9800",size:1,style:Ee.Solid},{color:"#9C27B0",size:1,style:Ee.Solid}]}},PP={name:"EMV",shortName:"EMV",precision:4,calcParams:[14,9],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#2196F3",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{e.calcParams[0];const t=e.calcParams[1]||9,s={};if(o.length<2)return o.reduce((r,a)=>(r[a.timestamp]={},r),{});const i=[];for(let r=0;r<o.length;r++){const a=o[r];if(r===0){s[a.timestamp]={};continue}const l=o[r-1],d=(a.high+a.low)/2,v=(l.high+l.low)/2,p=d-v,_=a.high-a.low,y=a.volume||0;let w=0;if(_>0&&y>0){const S=y/_;w=p/S}i.push(w);let k;if(i.length>=t){let S=0;for(let L=i.length-t;L<i.length;L++)S+=i[L];k=S/t}s[a.timestamp]={emv:w,maEmv:k}}return s},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{e.getVisibleRange(),o.save(),o.lineWidth=1,o.setLineDash([2,2]),o.strokeStyle="rgba(107, 114, 128, 0.6)",o.beginPath();const a=r.convertToPixel(0);return o.moveTo(s.left,a),o.lineTo(s.left+s.width,a),o.stroke(),o.restore(),!1}},IP={name:"MTM",shortName:"MTM",precision:4,calcParams:[12],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"mtm",title:"MTM: ",type:"line"}],styles:{lines:[{color:"#FF6B35",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||12;return o.reduce((s,i,r)=>{if(r>=t){const a=i.close,l=o[r-t].close;s[i.timestamp]={mtm:a-l}}else s[i.timestamp]={};return s},{})}},MP={name:"TRIX",shortName:"TRIX",precision:4,calcParams:[14,9],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"signal",title:"Signal: ",type:"line"}],minValue:void 0,maxValue:void 0,styles:{lines:[{color:"#2563eb",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]},{color:"#dc2626",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const{calcParams:t}=e,[s,i]=t,r=TP(o,s),a=Dm(r,i);return o.reduce((l,d,v)=>(l[d.timestamp]={trix:r[v],signal:a[v]},l),{})}};function TP(o,e){const t=o.map(l=>l.close),s=Dm(t,e),i=Dm(s,e),r=Dm(i,e),a=[];for(let l=0;l<r.length;l++)if(l===0||r[l]===null||r[l-1]===null||r[l-1]===0)a.push(null);else{const d=(r[l]-r[l-1])/r[l-1]*1e4;a.push(d)}return a}function Dm(o,e){const t=[],s=2/(e+1);let i=null;for(let r=0;r<o.length;r++){if(o[r]===null){t.push(null);continue}if(i===null){if(r>=e-1){let a=0,l=0;for(let d=r-e+1;d<=r;d++)o[d]!==null&&(a+=o[d],l++);i=l>0?a/l:null}}else i=o[r]*s+i*(1-s);t.push(i)}return t}const AP={name:"VOL",shortName:"VOL",precision:0,calcParams:[20],shouldOhlc:!1,shouldFormatBigNumber:!0,visible:!0,zLevel:-1,extendData:void 0,figures:[],styles:{bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#26a69a"}],lines:[{color:"#8B5CF6",size:1,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{var r,a;const s=e.calcParams[0]||20,i={};for(let l=0;l<o.length;l++){const d=o[l],v=d.volume||0;let p=0;if(l===0)p=v;else{const _=2/(s+1),y=(r=o[l-1])==null?void 0:r.timestamp,w=(y!=null?(a=i[y])==null?void 0:a.ema:void 0)??v;p=v*_+w*(1-_)}i[d.timestamp]={volume:v,ema:p}}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i})=>{var F,B,R,N,$,V,U,G,Z,le,se,ie,Y,K,Q,q,ce,_e,me,Pe,ze,he,De,ge,be,$e,Ve,Ce,Je,ye;if(!t.result||Object.keys(t.result).length===0)return!1;const r=e.getVisibleRange();if(!r)return!1;const{from:a,to:l}=r,d=e.getDataList();if(!d||d.length===0)return!1;const v=((R=(B=(F=t.styles)==null?void 0:F.bars)==null?void 0:B[0])==null?void 0:R.upColor)||"#26a69a",p=((V=($=(N=t.styles)==null?void 0:N.bars)==null?void 0:$[0])==null?void 0:V.downColor)||"#ef5350",_=((Z=(G=(U=t.styles)==null?void 0:U.bars)==null?void 0:G[0])==null?void 0:Z.noChangeColor)||"#26a69a",y=((ie=(se=(le=t.styles)==null?void 0:le.lines)==null?void 0:se[0])==null?void 0:ie.color)||"#8B5CF6";o.save();let w=0;for(let Ae=a;Ae<=l&&Ae<d.length;Ae++){const ee=(Y=d[Ae])==null?void 0:Y.timestamp,xe=ee!=null?t.result[ee]:void 0;xe&&(xe.volume!=null&&xe.volume>w&&(w=xe.volume),xe.ema!=null&&xe.ema>w&&(w=Math.max(w,xe.ema)))}if(w<=0)return o.restore(),!0;const S=Math.max(10,Math.floor(s.height*.22)),L=s.top+s.height-1,P=Math.max(1,Math.floor(S*.56));for(let Ae=a;Ae<=l&&Ae<d.length;Ae++){const ee=(K=d[Ae])==null?void 0:K.timestamp,xe=ee!=null?t.result[ee]:void 0;if(!xe||xe.volume==null)continue;const ke=d[Ae],He=Ae>0&&Ae-1<d.length?d[Ae-1]:null;let Ie=_;He&&ke&&typeof ke.close=="number"&&typeof He.close=="number"&&(ke.close>He.close?Ie=v:ke.close<He.close&&(Ie=p));const ne=i.convertToPixel(Ae),J=Math.min(1,xe.volume/w),qe=Math.max(1,Math.floor(J*P)),ft=L-qe,Qe=Math.max(1,(i.convertToPixel(1)-i.convertToPixel(0))*.8),Oe=(ce=(q=(Q=t==null?void 0:t.styles)==null?void 0:Q.bars)==null?void 0:q[0])==null?void 0:ce.opacity;let ct=typeof Oe=="number"?Oe:void 0;if(ct==null){const Lt=(Ie||"").toString().match(/^rgba?\(\s*\d+\s*,\s*\d+\s*,\s*\d+(?:\s*,\s*([0-9]*\.?[0-9]+))?\s*\)$/i);if(Lt){const It=Lt[1]!=null?parseFloat(Lt[1]):1;ct=isNaN(It)?.7:It}else ct=.7}o.globalAlpha=Math.max(0,Math.min(1,ct)),o.fillStyle=Ie,o.fillRect(ne-Qe/2,ft,Qe,qe)}if(o.globalAlpha=1,((Pe=(me=(_e=t==null?void 0:t.styles)==null?void 0:_e.lines)==null?void 0:me[0])==null?void 0:Pe.visible)===!0){const Ae=((De=(he=(ze=t.styles)==null?void 0:ze.lines)==null?void 0:he[0])==null?void 0:De.style)||Ee.Solid,ee=(($e=(be=(ge=t.styles)==null?void 0:ge.lines)==null?void 0:be[0])==null?void 0:$e.size)||1,xe=((Je=(Ce=(Ve=t.styles)==null?void 0:Ve.lines)==null?void 0:Ce[0])==null?void 0:Je.dashedValue)||[2,2];o.lineWidth=ee,o.strokeStyle=y,Ae===Ee.Dashed?o.setLineDash(xe):o.setLineDash([]);const ke=[];for(let He=a;He<=l&&He<d.length;He++){const Ie=(ye=d[He])==null?void 0:ye.timestamp,ne=Ie!=null?t.result[Ie]:void 0;if(!ne||ne.ema==null)continue;const J=i.convertToPixel(He),qe=Math.min(1,ne.ema/w),ft=L-Math.floor(qe*P);ke.push({x:J,y:ft})}if(ke.length>1){o.save(),o.beginPath(),o.moveTo(ke[0].x,L);for(const He of ke)o.lineTo(He.x,He.y);o.lineTo(ke[ke.length-1].x,L),o.closePath(),o.globalAlpha=.25,o.fillStyle=y,o.fill(),o.globalAlpha=1,o.restore(),o.beginPath(),o.moveTo(ke[0].x,ke[0].y);for(let He=1;He<ke.length;He++)o.lineTo(ke[He].x,ke[He].y);o.stroke()}}return o.restore(),!0}},LP={name:"SMA",shortName:"SMA",precision:2,calcParams:[20],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,figures:[{key:"sma",title:"SMA: ",type:"line"}],styles:{lines:[{color:"#FF6C37",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams[0]||20,s={};for(let i=0;i<o.length;i++){const r=o[i].timestamp;if(i<t-1){s[r]={};continue}let a=0;for(let d=i-t+1;d<=i;d++)a+=o[d].close;const l=a/t;s[r]={sma:l}}return s},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var y,w,k,S,L,T,P,A,F,B;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:d,to:v}=l;o.save();const p={color:((k=(w=(y=t.styles)==null?void 0:y.lines)==null?void 0:w[0])==null?void 0:k.color)??"#FF6C37",size:((T=(L=(S=t.styles)==null?void 0:S.lines)==null?void 0:L[0])==null?void 0:T.size)??2,style:((F=(A=(P=t.styles)==null?void 0:P.lines)==null?void 0:A[0])==null?void 0:F.style)??Ee.Solid};o.beginPath();let _=!0;for(let R=d;R<=v;R++){const N=(B=a[R])==null?void 0:B.timestamp,$=t.result[N];if(!$||typeof $.sma!="number")continue;const V=i.convertToPixel(R),U=r.convertToPixel($.sma);_?(o.moveTo(V,U),_=!1):o.lineTo(V,U)}return o.strokeStyle=p.color,o.lineWidth=p.size,p.style===Ee.Dashed?o.setLineDash([8,4]):o.setLineDash([]),o.stroke(),o.restore(),!0}},Cd=new Map,h0=o=>({id:o,kPeriod:14,dPeriod:3,kLineColor:"#1E90FF",kLineThickness:2,kLineStyle:"solid",dLineColor:"#FF1493",dLineThickness:2,dLineStyle:"dashed",showLevels:!0,showZones:!0,overboughtLevel:80,oversoldLevel:20,midlineLevel:50,showOverbought:!0,showOversold:!0,showMidline:!1,levels:[{id:"overbought",value:80,color:"#EF4444",lineStyle:"dashed",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:20,color:"#10B981",lineStyle:"dashed",thickness:1,label:"Oversold",visible:!0},{id:"midline",value:50,color:"#6B7280",lineStyle:"dotted",thickness:1,label:"Midline",visible:!1}],zones:[{id:"overbought_zone",topLevel:100,bottomLevel:80,fillColor:"#EF4444",fillOpacity:.1,visible:!0,type:"overbought"},{id:"oversold_zone",topLevel:20,bottomLevel:0,fillColor:"#10B981",fillOpacity:.1,visible:!0,type:"oversold"}]}),FP=(o,e,t)=>{const s=[],i=[];if(o.length<e)return{k:o.map(()=>NaN),d:o.map(()=>NaN)};for(let r=0;r<o.length;r++){if(r<e-1){s.push(NaN);continue}let a=o[r-e+1].high,l=o[r-e+1].low;for(let p=r-e+2;p<=r;p++)o[p].high>a&&(a=o[p].high),o[p].low<l&&(l=o[p].low);const d=o[r].close,v=a-l;if(v===0)s.push(50);else{const p=100*((d-l)/v);s.push(p)}}for(let r=0;r<s.length;r++){if(r<e-1+t-1){i.push(NaN);continue}let a=0,l=0;for(let d=r-t+1;d<=r;d++)isNaN(s[d])||(a+=s[d],l++);l===0?i.push(NaN):i.push(a/l)}return{k:s,d:i}},DP={name:"STOCH",shortName:"Stoch",precision:2,calcParams:[14,3],shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:void 0,minValue:0,maxValue:100,figures:[{key:"k",title:"%K: ",type:"line"},{key:"d",title:"%D: ",type:"line"}],styles:{lines:[{color:"#1E90FF",size:2,style:Ee.Solid,smooth:!1,dashedValue:[0,0]},{color:"#FF1493",size:2,style:Ee.Dashed,smooth:!1,dashedValue:[4,4]}]},calc:(o,e)=>{const t=e.calcParams[0]||14,s=e.calcParams[1]||3,{k:i,d:r}=FP(o,t,s);return o.reduce((a,l,d)=>{const v=i[d],p=r[d];return a[l.timestamp]={k:isNaN(v)?null:v,d:isNaN(p)?null:p},a},{})},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{const a=t.paneId||"default";let l=Cd.get(a);l||(l=h0(a),Cd.set(a,l));const{left:d,top:v,width:p,height:_}=s;return e.getVisibleRange(),o.save(),l.showZones&&l.zones.forEach(y=>{if(!y.visible)return;const w=r.convertToPixel(y.topLevel),k=r.convertToPixel(y.bottomLevel);if(w!==null&&k!==null&&isFinite(w)&&isFinite(k)&&isFinite(d)&&isFinite(p)){o.save();const S=Math.abs(w-k),L=Math.min(w,k);if(!isFinite(S)||!isFinite(L)||S===0){o.restore();return}const T=o.createLinearGradient(d,L,d,L+S),A=y.fillColor.match(/\w\w/g);if(A){const F=parseInt(A[0],16),B=parseInt(A[1],16),R=parseInt(A[2],16);T.addColorStop(0,`rgba(${F}, ${B}, ${R}, ${y.fillOpacity*.8})`),T.addColorStop(.3,`rgba(${F}, ${B}, ${R}, ${y.fillOpacity*.6})`),T.addColorStop(.7,`rgba(${F}, ${B}, ${R}, ${y.fillOpacity*.3})`),T.addColorStop(1,`rgba(${F}, ${B}, ${R}, ${y.fillOpacity*.1})`)}else T.addColorStop(0,y.fillColor+Math.floor(y.fillOpacity*255).toString(16).padStart(2,"0")),T.addColorStop(.5,y.fillColor+Math.floor(y.fillOpacity*128).toString(16).padStart(2,"0")),T.addColorStop(1,y.fillColor+Math.floor(y.fillOpacity*32).toString(16).padStart(2,"0"));o.fillStyle=T,o.fillRect(d,L,p,S),o.strokeStyle=y.fillColor+"40",o.lineWidth=.5,o.strokeRect(d,L,p,S),o.restore()}}),l.showLevels&&l.levels.forEach(y=>{if(!y.visible)return;const w=r.convertToPixel(y.value);w!==null&&isFinite(w)&&w>=v&&w<=v+_&&isFinite(d)&&isFinite(p)&&(o.save(),o.strokeStyle=y.color,o.lineWidth=y.thickness,y.lineStyle==="dashed"?o.setLineDash([4,4]):y.lineStyle==="dotted"?o.setLineDash([2,6]):o.setLineDash([]),o.beginPath(),o.moveTo(d,w),o.lineTo(d+p,w),o.stroke(),o.fillStyle=y.color,o.font="10px Arial",o.textAlign="left",o.fillText(`${y.value}`,d+5,w-3),o.restore())}),o.restore(),!1}},vm={createInstance:(o,e)=>{const t={...h0(o),...e};return Cd.set(o,t),t},getInstance:o=>Cd.get(o),updateInstance:(o,e)=>{const t=Cd.get(o);return t?(Object.assign(t,e),!0):!1},deleteInstance:o=>Cd.delete(o),addLevel:(o,e)=>{const t=Cd.get(o);if(t){const s=`level_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:s,...e};return t.levels.push(i),s}throw new Error(`Stochastic instance ${o} not found`)},removeLevel:(o,e)=>{const t=Cd.get(o);if(t){const s=t.levels.findIndex(i=>i.id===e);if(s!==-1)return t.levels.splice(s,1),!0}return!1},updateLevel:(o,e,t)=>{const s=Cd.get(o);if(s){const i=s.levels.find(r=>r.id===e);if(i)return Object.assign(i,t),e==="overbought"?s.overboughtLevel=i.value:e==="oversold"?s.oversoldLevel=i.value:e==="midline"&&(s.midlineLevel=i.value),!0}return!1},addZone:(o,e)=>{const t=Cd.get(o);if(t){const s=`zone_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:s,...e};return t.zones.push(i),s}throw new Error(`Stochastic instance ${o} not found`)},removeZone:(o,e)=>{const t=Cd.get(o);if(t){const s=t.zones.findIndex(i=>i.id===e);if(s!==-1)return t.zones.splice(s,1),!0}return!1},updateZone:(o,e,t)=>{const s=Cd.get(o);if(s){const i=s.zones.find(r=>r.id===e);if(i)return Object.assign(i,t),!0}return!1},getInstanceConfig:o=>Cd.get(o)||null,resetInstance:o=>{const e=h0(o);Cd.set(o,e)},exportInstanceConfig:o=>{const e=Cd.get(o);return e?{id:e.id,kPeriod:e.kPeriod,dPeriod:e.dPeriod,kLineColor:e.kLineColor,kLineThickness:e.kLineThickness,kLineStyle:e.kLineStyle,dLineColor:e.dLineColor,dLineThickness:e.dLineThickness,dLineStyle:e.dLineStyle,showLevels:e.showLevels,showZones:e.showZones,overboughtLevel:e.overboughtLevel,oversoldLevel:e.oversoldLevel,midlineLevel:e.midlineLevel,showOverbought:e.showOverbought,showOversold:e.showOversold,showMidline:e.showMidline,levels:e.levels.map(t=>({...t})),zones:e.zones.map(t=>({...t}))}:null},importInstanceConfig:o=>{try{const e={id:o.id,kPeriod:o.kPeriod||14,dPeriod:o.dPeriod||3,kLineColor:o.kLineColor||"#1E90FF",kLineThickness:o.kLineThickness||2,kLineStyle:o.kLineStyle||"solid",dLineColor:o.dLineColor||"#FF1493",dLineThickness:o.dLineThickness||2,dLineStyle:o.dLineStyle||"dashed",showLevels:o.showLevels!==!1,showZones:o.showZones!==!1,overboughtLevel:o.overboughtLevel||80,oversoldLevel:o.oversoldLevel||20,midlineLevel:o.midlineLevel||50,showOverbought:o.showOverbought!==!1,showOversold:o.showOversold!==!1,showMidline:o.showMidline||!1,levels:o.levels||h0(o.id).levels,zones:o.zones||h0(o.id).zones};return Cd.set(o.id,e),!0}catch(e){return console.error("Failed to import Stochastic instance config:",e),!1}},getAllInstances:()=>new Map(Cd),clearAllInstances:()=>{Cd.clear()}},EP={name:"SMARTTREND",shortName:"Smart Trend",precision:2,calcParams:[10,3],shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,extendData:{showLabels:!0},figures:[{key:"superTrend",title:"Smart Trend: ",type:"line"}],styles:{lines:[{color:"#00FF00",size:2,style:Ee.Solid,smooth:!1,dashedValue:[0,0]}]},calc:(o,e)=>{var k;const t=e.calcParams[0]||10,s=e.calcParams[1]||3,i={},r=(S,L)=>{if(!L)return S.high-S.low;const T=S.high-S.low,P=Math.abs(S.high-L.close),A=Math.abs(S.low-L.close);return Math.max(T,P,A)},a=S=>{if(S<t-1)return 0;let L=0;for(let T=S-t+1;T<=S;T++){const P=o[T],A=T>0?o[T-1]:void 0;L+=r(P,A)}return L/t};let l=1,d=0,v=0,p=-1,_,y=-1,w;for(let S=0;S<o.length;S++){const L=o[S].timestamp;if(S<t-1){i[L]={};continue}const T=o[S],P=S>0?o[S-1]:T,A=a(S),F=(T.high+T.low)/2,B=F+s*A,R=F-s*A;if(S===t-1)d=B,v=R;else{i[S-1];const K=P.close;(B<d||K>d)&&(d=B),(R>v||K<v)&&(v=R)}let N=l,$=0,V,U,G,Z,le,se,ie,Y;if(S>t-1){const K=o[S-1].timestamp;if((k=i[K])!=null&&k.superTrend,l===1&&T.close<=v?N=-1:l===-1&&T.close>=d&&(N=1),N!==l){if(N===1){if(V=v,G=T.close,p=S,_=T.close,w!==void 0&&y>=0){se=T.close,Y=w-se;const Q=o[y].timestamp,q=i[Q];q.sellExit=se,q.sellProfit=Y,w=void 0,y=-1}}else if(U=d,Z=T.close,y=S,w=T.close,_!==void 0&&p>=0){le=T.close,ie=le-_;const Q=o[p].timestamp,q=i[Q];q.buyExit=le,q.buyProfit=ie,_=void 0,p=-1}}}N===1?$=v:$=d,i[L]={superTrend:$,trend:N,buySignal:V,sellSignal:U,buyEntry:G,sellEntry:Z,buyExit:le,sellExit:se,buyProfit:ie,sellProfit:Y},l=N}return i},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var $,V,U,G,Z,le,se;const a=e.getDataList();if(!t.result||a.length===0)return!1;const l=e.getVisibleRange(),{from:d,to:v}=l;o.save();const p=(ie,Y,K,Q,q,ce)=>{const _e=Math.min(ce,Q/2,q/2);ie.beginPath(),ie.moveTo(Y+_e,K),ie.arcTo(Y+Q,K,Y+Q,K+q,_e),ie.arcTo(Y+Q,K+q,Y,K+q,_e),ie.arcTo(Y,K+q,Y,K,_e),ie.arcTo(Y,K,Y+Q,K,_e),ie.closePath()},_=(ie,Y)=>{if(!ie)return`rgba(0,0,0,${Y})`;if(ie.startsWith("rgb"))return ie.startsWith("rgba")?ie.replace(/rgba\(([^)]+)\)/,(_e,me)=>{const Pe=me.split(",").map(ze=>ze.trim());return`rgba(${Pe[0]}, ${Pe[1]}, ${Pe[2]}, ${Y})`}):ie.replace(/rgb\(([^)]+)\)/,(_e,me)=>`rgba(${me}, ${Y})`);const K=ie.replace("#",""),Q=parseInt(K.substring(0,2),16),q=parseInt(K.substring(2,4),16),ce=parseInt(K.substring(4,6),16);return`rgba(${Q}, ${q}, ${ce}, ${Y})`},y=(ie,Y,K,Q)=>{const q="bold 10px Arial";o.font=q;const ce=o.measureText(K),_e=ce.actualBoundingBoxAscent&&ce.actualBoundingBoxDescent?ce.actualBoundingBoxAscent+ce.actualBoundingBoxDescent:10,me=6,Pe=4,ze=Math.ceil(ce.width)+me*2,he=Math.ceil(_e)+Pe*2,De=Math.round(ie-ze/2),ge=Math.round(Y-he/2),be=typeof performance<"u"?performance.now():Date.now(),$e=.35+.25*Math.sin(be/450);o.save(),o.shadowColor=_(Q,Math.max(0,$e)),o.shadowBlur=12,o.fillStyle=_(Q,.14),p(o,De,ge,ze,he,6),o.fill(),o.restore(),o.lineWidth=1,o.strokeStyle=_(Q,.9),p(o,De,ge,ze,he,6),o.stroke(),o.fillStyle=_(Q,.95),o.textAlign="center",o.textBaseline="middle",o.font=q,o.fillText(K,ie,Y+.5)},w=t.extendData,k=(w==null?void 0:w.showLabels)!==!1,S=(w==null?void 0:w.uptrendColor)||"#00FF00",L=(w==null?void 0:w.downtrendColor)||"#FF0000",T=(w==null?void 0:w.uptrendThickness)??2,P=(w==null?void 0:w.downtrendThickness)??2,A=(w==null?void 0:w.uptrendLineStyle)||"solid",F=(w==null?void 0:w.downtrendLineStyle)||"solid";let B=[],R=d,N=((V=t.result[($=a[d])==null?void 0:$.timestamp])==null?void 0:V.trend)||1;for(let ie=d+1;ie<=v;ie++){const Y=(U=a[ie])==null?void 0:U.timestamp,K=t.result[Y],Q=(K==null?void 0:K.trend)??N,q=ie===v;if(Q!==N||q){const ce=q&&Q===N?ie:ie-1;B.push({start:R,end:ce,trend:N}),R=ie,N=Q}}if(B.forEach(ie=>{var _e,me;const Y=ie.trend===1,K=Y?S:L,Q=Y?T:P,q=Y?A:F;o.strokeStyle=K,o.lineWidth=Number(Q)||2,o.lineCap="round",o.lineJoin="round",q==="dashed"?o.setLineDash([4,4]):q==="dotted"?o.setLineDash([2,6]):o.setLineDash([]),o.beginPath();let ce=!0;for(let Pe=ie.start;Pe<=ie.end;Pe++){const ze=(_e=a[Pe])==null?void 0:_e.timestamp,he=t.result[ze];if(he&&typeof he.superTrend=="number"){const De=i.convertToPixel(Pe),ge=r.convertToPixel(he.superTrend);ce?(o.moveTo(De,ge),ce=!1):o.lineTo(De,ge)}}if(o.stroke(),k){const Pe=(me=a[ie.end])==null?void 0:me.timestamp,ze=t.result[Pe];if(ze&&typeof ze.superTrend=="number"){const De=ie===B[B.length-1]?"HOLD":"EXIT",ge=i.convertToPixel(ie.end),be=r.convertToPixel(ze.superTrend);y(ge,be+(Y?22:-22),De,K)}}}),k){let ie=0;try{const K=(G=e==null?void 0:e.getDataList)==null?void 0:G.call(e);if(K&&K.length>0)ie=((Z=K[K.length-1])==null?void 0:Z.close)??0;else{const Q=(le=a[v])==null?void 0:le.timestamp,q=t.result[Q];ie=(q==null?void 0:q.superTrend)??0}}catch{}const Y=(t==null?void 0:t.precision)??2;for(let K=d;K<=v;K++){const Q=(se=a[K])==null?void 0:se.timestamp,q=t.result[Q];if(!q)continue;const ce=i.convertToPixel(K);if(q.buySignal!==void 0){const _e=r.convertToPixel(q.buySignal);o.fillStyle="#00FF00",o.beginPath(),o.arc(ce,_e-10,4,0,2*Math.PI),o.fill();const me=q.buyEntry??q.buySignal,Pe=q.buyExit!==void 0?q.buyExit-me:ie?ie-me:0,ze=`${Pe>=0?"+":""}${Number(Pe).toFixed(Y)}`;y(ce,_e+22,`BUY ${ze}`,"#10B981")}if(q.sellSignal!==void 0){const _e=r.convertToPixel(q.sellSignal);o.fillStyle="#FF0000",o.beginPath(),o.arc(ce,_e+10,4,0,2*Math.PI),o.fill();const me=q.sellEntry??q.sellSignal,Pe=q.sellExit!==void 0?me-q.sellExit:ie?me-ie:0,ze=`${Pe>=0?"+":""}${Number(Pe).toFixed(Y)}`;y(ce,_e-22,`SELL ${ze}`,"#EF4444")}}}return o.restore(),!0}},$P={name:"MACD",shortName:"MACD",calcParams:[12,26,9],shouldOhlc:!1,shouldFormatBigNumber:!1,precision:4,minValue:-1e-9,maxValue:1e-9,styles:{lines:[{color:"#2563eb",size:1,style:Ee.Solid,dashedValue:[2,2]},{color:"#dc2626",size:1,style:Ee.Solid,dashedValue:[2,2]}],bars:[{upColor:"#2563eb",downColor:"#ef4444",noChangeColor:"#2563eb"}]},figures:[{key:"macd",title:"MACD: ",type:"line",baseValue:0},{key:"signal",title:"Signal: ",type:"line",baseValue:0},{key:"hist",title:"Hist: ",type:"bar",baseValue:0}],calc:(o,e)=>{var y,w,k;const t=((y=e.calcParams)==null?void 0:y[0])||12,s=((w=e.calcParams)==null?void 0:w[1])||26,i=((k=e.calcParams)==null?void 0:k[2])||9,r=(S,L)=>{const T=2/(S+1),P=[];let A;for(let F=0;F<L.length;F++){const B=L[F];A===void 0?A=B:A=B*T+A*(1-T),P.push(A)}return P},a=o.map(S=>S.close),l=r(t,a),d=r(s,a),v=a.map((S,L)=>(l[L]??NaN)-(d[L]??NaN)),p=r(i,v.map(S=>Number.isFinite(S)?S:0)),_={};for(let S=0;S<o.length;S++){const L=o[S].timestamp;if(!Number.isFinite(v[S])||!Number.isFinite(p[S])){_[L]={};continue}const T=v[S],P=p[S],A=T-P;_[L]={macd:T,signal:P,hist:A}}return _},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{var S,L,T,P,A,F,B;const r=e.getDataList();if(!t.result||r.length===0)return!1;const a=t.styles||{},l=((L=(S=a==null?void 0:a.bars)==null?void 0:S[0])==null?void 0:L.upColor)||"#2563eb",d=((P=(T=a==null?void 0:a.bars)==null?void 0:T[0])==null?void 0:P.downColor)||"#ef4444",v=((F=(A=a==null?void 0:a.bars)==null?void 0:A[0])==null?void 0:F.noChangeColor)||l,p=(a==null?void 0:a.lines)||[],_=e.getVisibleRange(),y=Math.max(_.from,0),w=Math.min(_.to,r.length-1);o.save();for(let R=y;R<=w;R++){const N=(B=r[R])==null?void 0:B.timestamp,$=t.result[N];if(!$||typeof $.hist!="number")continue;const V=s.convertToPixel(R),U=i.convertToPixel(0),G=i.convertToPixel($.hist),Z=s.convertToPixel(1)-s.convertToPixel(0),le=Math.max(1,Math.floor(Z*.8)),se=Math.min(U,G),ie=Math.abs(U-G);let Y=v;$.hist>0?Y=l:$.hist<0&&(Y=d),o.fillStyle=Y;const K=Math.round(V-le/2),Q=Math.round(se),q=Math.max(1,Math.round(ie));o.fillRect(K,Q,le,q)}o.restore();const k=(R,N)=>{var G;o.save(),o.beginPath(),o.lineWidth=(N==null?void 0:N.size)??1,(N==null?void 0:N.style)===Ee.Dashed?o.setLineDash((N==null?void 0:N.dashedValue)??[4,4]):o.setLineDash([]),o.strokeStyle=(N==null?void 0:N.color)||"#ffffff";const V=o.lineWidth%2?.5:0;o.lineCap="butt",o.lineJoin="miter";let U=!0;for(let Z=y;Z<=w;Z++){const le=(G=r[Z])==null?void 0:G.timestamp,se=t.result[le];if(!se||typeof se[R]!="number")continue;const ie=Math.round(s.convertToPixel(Z))+V,Y=Math.round(i.convertToPixel(se[R]))+V;U?(o.moveTo(ie,Y),U=!1):o.lineTo(ie,Y)}o.stroke(),o.restore()};return k("macd",p[0]),k("signal",p[1]),!0}};function fp(o,e,t){return Math.max(e,Math.min(t,o))}function jP(o,e){const t=new Array(o.length).fill(0);if(e<=1){for(let i=0;i<o.length;i++)t[i]=o[i]??0;return t}let s=0;for(let i=0;i<o.length;i++)s+=o[i]??0,i>=e&&(s-=o[i-e]??0),t[i]=i>=e-1?s/e:0;return t}function zP(o,e,t){const s=Math.max(0,e-t);let i=-1/0;for(let r=s;r<e;r++)o[r]&&o[r].high>i&&(i=o[r].high);return i===-1/0?0:i}function BP(o,e,t){const s=Math.max(0,e-t);let i=1/0;for(let r=s;r<e;r++)o[r]&&o[r].low<i&&(i=o[r].low);return i===1/0?0:i}function fm(o){const e=Math.max(0,(o.high??0)-(o.low??0)),t=Math.abs((o.close??0)-(o.open??0)),s=Math.max(0,(o.high??0)-Math.max(o.open??0,o.close??0)),i=Math.max(0,Math.min(o.open??0,o.close??0)-(o.low??0)),r=e>0?s/e:0,a=e>0?i/e:0;return{range:e,body:t,upperWick:s,lowerWick:i,upperWickRatio:r,lowerWickRatio:a}}const NP={name:"TRAP_HUNTER",shortName:"TRAP",precision:2,shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,figures:[],styles:{texts:[{color:"#ffffff",size:10}]},calc:(o,e)=>{var B,R;const t=e.calcParams||[],s=t[0]??20,i=t[1]??20,r=Math.max(1,t[2]??3),a=Math.max(1,t[3]??5),l=Math.max(1,t[4]??20),d=t[5]??1.3,v=t[6]??7e-4,p=t[7]??.35,_=t[8]??.5,y=(t[9]??1)>0?1:0,w=Math.max(1,t[10]??5),k=o.map(N=>(N==null?void 0:N.volume)??0),S=jP(k,l),L=new Array(o.length).fill(null).map(()=>({}));let T=-1e3,P=-1e3,A=-1e3,F=-1e3;for(let N=0;N<o.length;N++){const $=o[N];if(!$||N===0)continue;const V=zP(o,N,s),U=BP(o,N,i);if(V===0||U===0)continue;const G=S[N]||0,Z=G>0?($.volume??0)/G:0,{range:le,upperWickRatio:se,lowerWickRatio:ie}=fm($),Y=le>0?($.high-$.close)/le<.4:!1,K=le>0?($.close-$.low)/le<.4:!1,Q=($.high??0)>=V*(1+v),q=($.close??0)>($.open??0)||Y,ce=Z>=d;if(Q&&q&&ce){let De=-1;($.close??0)<V&&(De=N);const ge=Math.min(o.length-1,N+r);if(De===-1){for(let be=N+1;be<=ge;be++)if((((B=o[be])==null?void 0:B.close)??0)<V){De=be;break}}if(De!==-1){const be=Math.min(De,N+a);let $e=se,Ve=!1;for(let ke=N;ke<=be;ke++){const He=fm(o[ke]);He.upperWickRatio>$e&&($e=He.upperWickRatio),(o[ke].close??0)<(o[ke].open??0)&&(He.range>0&&He.body/He.range>=.45)&&(Ve=!0)}const Ce=fp(($.high-V)/Math.max(1e-8,V)/(v*3),0,1),Je=fp(Z/(d*2),0,1),ye=fp($e,0,1),Ae=fp(($.high-(o[De].close??0))/Math.max(1e-8,$.high),0,1),ee=fp(.3*Ce+.3*Je+.2*ye+.2*Ae,0,1);($e>=p||Ve)&&ee>=_&&De-T>=2&&(T=De,A=De,L[De]={...L[De],bullTrap:!0,type:"bull",score:ee,breakoutLevel:V,reversalClose:o[De].close,time:o[De].timestamp})}}const _e=v*.85,me=d*.9,Pe=($.low??0)<=U*(1-_e),ze=($.close??0)<($.open??0)||K||ie>=p,he=Z>=me;if(Pe&&ze&&he){const De=Math.min(o.length-1,N+r);let ge=-1;if(($.close??0)>U&&(ge=N),ge===-1){for(let be=N+1;be<=De;be++)if((((R=o[be])==null?void 0:R.close)??0)>U){ge=be;break}}if(ge!==-1){const be=Math.min(ge,N+a);let $e=ie,Ve=!1;for(let ke=N;ke<=be;ke++){const He=fm(o[ke]);He.lowerWickRatio>$e&&($e=He.lowerWickRatio),(o[ke].close??0)>(o[ke].open??0)&&(He.range>0&&He.body/He.range>=.45)&&(Ve=!0)}const Ce=fp((U-$.low)/Math.max(1e-8,U)/(_e*3),0,1),Je=fp(Z/(me*2),0,1),ye=fp($e,0,1),Ae=fp(((o[ge].close??0)-$.low)/Math.max(1e-8,o[ge].close??0),0,1),ee=fp(.3*Ce+.3*Je+.2*ye+.2*Ae,0,1);($e>=p||Ve)&&ee>=_&&ge-P>=2&&(P=ge,A=ge,L[ge]={...L[ge],bearTrap:!0,type:"bear",score:ee,breakoutLevel:U,reversalClose:o[ge].close,time:o[ge].timestamp})}}if(y){const De=S[N]>0?($.volume??0)/S[N]:0,{upperWickRatio:ge,lowerWickRatio:be}=fm($),$e=Math.max(.1,p*.8),Ve=Math.max(1,d*.85),Ce=($.close??0)<=V*(1+v*.5)&&($.close??0)>=U*(1-v*.5),Je=De<=Ve&&ge<=$e&&be<=$e&&Ce,ye=N-A,Ae=N-F,ee=Math.max(8,w);Je&&ye>=w&&Ae>=ee&&(F=N,L[N]={...L[N],normal:!0,time:o[N].timestamp})}}return L},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{const r=t.result;if(!r||r.length===0)return!1;const a=e.getDataList(),l=e.getVisibleRange(),d=Math.max(0,l.from),v=Math.min(r.length-1,l.to);function p(w,k,S,L){o.save(),o.fillStyle=S,o.strokeStyle=S,o.lineWidth=1,L==="normal"?(o.beginPath(),o.arc(w,k,3.5,0,2*Math.PI),o.fill()):(o.beginPath(),L==="bull"?(o.moveTo(w,k-6),o.lineTo(w-5,k+4),o.lineTo(w+5,k+4)):(o.moveTo(w,k+6),o.lineTo(w-5,k-4),o.lineTo(w+5,k-4)),o.closePath(),o.fill()),o.restore()}function _(w,k,S,L){o.save(),o.font="11px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",o.textAlign="center",o.textBaseline="middle",o.fillStyle=L,o.strokeStyle="rgba(0,0,0,0.2)";const T=6,P=o.measureText(S),A=Math.ceil(P.width)+T*2,F=16,B=4,R=w-A/2,N=k-F/2;o.beginPath(),o.moveTo(R+B,N),o.lineTo(R+A-B,N),o.quadraticCurveTo(R+A,N,R+A,N+B),o.lineTo(R+A,N+F-B),o.quadraticCurveTo(R+A,N+F,R+A-B,N+F),o.lineTo(R+B,N+F),o.quadraticCurveTo(R,N+F,R,N+F-B),o.lineTo(R,N+B),o.quadraticCurveTo(R,N,R+B,N),o.closePath(),o.fillStyle="rgba(0,0,0,0.6)",o.fill(),o.fillStyle=L,o.fillText(S,w,k+.5),o.restore()}function y(w,k,S){o.save(),o.strokeStyle=S,o.lineWidth=1,o.setLineDash([4,3]),o.beginPath(),o.moveTo(w-10,k),o.lineTo(w+10,k),o.stroke(),o.setLineDash([]),o.restore()}for(let w=d;w<=v;w++){const k=r[w];if(!k||!k.bullTrap&&!k.bearTrap&&!k.normal)continue;const S=s.convertToPixel(w),L=a[w];if(L){if(k.bullTrap){const T=i.convertToPixel(L.high)-12;p(S,T,"#EF4444","bull");const A=T-16,F=`Bull Trap ${((k.score??0)*100).toFixed(0)}%`;if(_(S,A,F,"#F59E0B"),k.breakoutLevel){const B=i.convertToPixel(k.breakoutLevel);y(S,B,"#F59E0B")}}if(k.bearTrap){const T=i.convertToPixel(L.low)+12;p(S,T,"#10B981","bear");const A=T+16,F=`Bear Trap ${((k.score??0)*100).toFixed(0)}%`;if(_(S,A,F,"#34D399"),k.breakoutLevel){const B=i.convertToPixel(k.breakoutLevel);y(S,B,"#34D399")}}if(k.normal){const T=(L.high+L.low)/2,P=i.convertToPixel(T);p(S,P,"#3B82F6","normal"),_(S,P-16,"Stable","#60A5FA")}}}return!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{var d;const s=(d=e.result)==null?void 0:d[o];if(!s||!s.bullTrap&&!s.bearTrap&&!s.normal)return{values:[]};const i=s.normal?"Stable":s.bullTrap?"Bull Trap":"Bear Trap",r=s.score!==void 0?Number(s.score).toFixed(2):"—",a=s.breakoutLevel!==void 0?Number(s.breakoutLevel).toFixed(e.precision??2):"—",l=s.reversalClose!==void 0?Number(s.reversalClose).toFixed(e.precision??2):"—";return{styles:t,values:[{title:"Trap",value:i},...s.normal?[]:[{title:"Score",value:r},{title:"Level",value:a},{title:"Reversal",value:l}]]}}};function Bp(o,e,t){return Math.max(e,Math.min(t,o))}function ax(o,e){const t=o.length,s=new Array(t).fill(0);if(e<=1){for(let r=0;r<t;r++)s[r]=o[r]??0;return s}let i=0;for(let r=0;r<t;r++)i+=o[r]??0,r>=e&&(i-=o[r-e]??0),s[r]=r>=e-1?i/e:0;return s}function RP(o,e){var i,r,a;const t=o.length,s=new Array(t).fill(0);for(let l=0;l<t;l++){const d=((i=o[l])==null?void 0:i.high)??0,v=((r=o[l])==null?void 0:r.low)??0;if(l===0)s[l]=Math.max(0,d-v);else{const p=((a=o[l-1])==null?void 0:a.close)??0;s[l]=Math.max(d-v,Math.abs(d-p),Math.abs(v-p))}}return ax(s,Math.max(1,e))}function OP(o){var i,r,a;const e=o.length,t=new Array(e).fill(0);let s=0;for(let l=0;l<e;l++){if(l===0)s=0;else{const d=((i=o[l])==null?void 0:i.close)??0,v=((r=o[l-1])==null?void 0:r.close)??0,p=((a=o[l])==null?void 0:a.volume)??0;d>v?s+=p:d<v&&(s-=p)}t[l]=s}return t}function g_(o,e,t){let s=0,i=0;for(let r=e;r<=t;r++)s+=o[r]??0,i++;return i>0?s/i:0}function VP(o,e,t,s){if(t<=e)return 0;const i=(o[t]-o[e])/(t-e),r=s>0?i/(s*5):0;return Bp(r,-1,1)}function WP(o,e,t){var l,d;const s=Math.max(0,e-t),i=Math.max(0,e-1),r=((l=o[s])==null?void 0:l.close)??0,a=((d=o[i])==null?void 0:d.close)??0;return r<=0?0:(a-r)/r}function by(o,e,t,s,i,r,a){var me,Pe,ze,he,De,ge,be,$e,Ve;const l=[],d=[],v=[];for(let Ce=i;Ce<=r;Ce++)l.push(((me=o[Ce])==null?void 0:me.high)??0),d.push(((Pe=o[Ce])==null?void 0:Pe.low)??0),v.push(((ze=o[Ce])==null?void 0:ze.close)??0);const p=Math.max(...l),_=Math.min(...d),y=(p+_)/2,w=p-_;if(y<=0)return null;const k=w/y;if(!isFinite(k)||k<=0||k>a.maxZoneWidthPct)return null;const S=g_(s,i,r);if(!(S>=a.minVolumeFactor))return null;const L=[];for(let Ce=i;Ce<=r;Ce++)L.push((((he=o[Ce])==null?void 0:he.high)??0)-(((De=o[Ce])==null?void 0:De.low)??0));const T=L.length?L.reduce((Ce,Je)=>Ce+Je,0)/L.length:0,P=g_(t,i,r);if(P>0&&T/P>1.8)return null;let A=0;for(let Ce=i;Ce<=r;Ce++){const Je=((ge=o[Ce])==null?void 0:ge.close)??0;(be=o[Ce])==null||be.open;const ye=w>0?Bp((Je-_)/w,0,1):.5;A+=ye}const F=A/Math.max(1,r-i+1)||.5,B=WP(o,i,a.priorTrendLookback),R=B<=-.05,N=B>=.05,$=R?Bp(Math.abs(B)/.15,0,1):0,V=N?Bp(Math.abs(B)/.15,0,1):0,U=g_(o.map(Ce=>(Ce==null?void 0:Ce.volume)??0),i,r),G=VP(e,i,r,U),Z=Bp((F-.5)/.3+.5,0,1),le=Bp((S-a.minVolumeFactor)/Math.max(1e-6,a.minVolumeFactor),0,1),se=.3,ie=.3,Y=.2,K=.2,Q=se*$+ie*Bp((G-a.minOBVTrendStrength)/(1-a.minOBVTrendStrength),0,1)+Y*Z+K*le,q=se*V+ie*Bp((-G-a.minOBVTrendStrength)/(1-a.minOBVTrendStrength),0,1)+Y*(1-Z)+K*le,ce=Bp(Math.max(Q,q),0,1);if(ce<a.minZoneScore)return null;const _e=Q>q?"accumulation":"distribution";return{startIndex:i,endIndex:r,startTime:(($e=o[i])==null?void 0:$e.timestamp)??0,endTime:((Ve=o[r])==null?void 0:Ve.timestamp)??0,low:_,high:p,type:_e,score:ce,priorReturn:B,avgVolumeFactor:S,obvTrendScore:G}}function xy(o,e){if(!e.mergeNearbyZones||o.length<=1)return o.slice(0,e.maxZonesDisplayed);const t=o.slice().sort((l,d)=>l.startIndex-d.startIndex),s=[],i=Math.max(2,Math.floor(e.minZoneBars/2)),r=Math.max(.01,e.maxZoneWidthPct*1.5);function a(l,d){const v=(l.low+l.high)/2,p=(d.low+d.high)/2;return v<=0||p<=0?!1:Math.abs(v-p)/((v+p)/2)<=r}for(const l of t){if(s.length===0){s.push(l);continue}const d=s[s.length-1];if(l.startIndex<=d.endIndex+i&&l.type===d.type&&a(d,l)){const p=Math.min(d.low,l.low),_=Math.max(d.high,l.high);s[s.length-1]={startIndex:Math.min(d.startIndex,l.startIndex),endIndex:Math.max(d.endIndex,l.endIndex),startTime:Math.min(d.startTime,l.startTime),endTime:Math.max(d.endTime,l.endTime),low:p,high:_,type:d.type,score:Math.max(d.score,l.score),priorReturn:Math.abs(l.score)>=Math.abs(d.score)?l.priorReturn:d.priorReturn,avgVolumeFactor:(d.avgVolumeFactor+l.avgVolumeFactor)/2,obvTrendScore:(d.obvTrendScore+l.obvTrendScore)/2}}else s.push(l)}return s.sort((l,d)=>d.score-l.score).slice(0,e.maxZonesDisplayed).sort((l,d)=>l.startIndex-d.startIndex)}const qP={name:"SMART_MONEY",shortName:"SMF",precision:2,shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,figures:[],styles:{},calc:(o,e)=>{const t=e.calcParams||[],s={zoneLookbackBars:Math.max(10,t[0]??40),minZoneBars:Math.max(3,t[1]??5),maxZoneBars:Math.max(5,t[2]??25),atrPeriod:Math.max(1,t[3]??14),volumeMAPeriod:Math.max(1,t[4]??20),minVolumeFactor:t[5]??1.2,maxZoneWidthPct:t[6]??.03,priorTrendLookback:Math.max(1,t[7]??20),minOBVTrendStrength:t[8]??.2,minZoneScore:t[9]??.6,mergeNearbyZones:(t[10]??1)>0,maxZonesDisplayed:Math.max(1,t[11]??20),showLabels:(t[12]??1)>0},i=o.length,r=new Array(i).fill({});if(i===0)return e.zones=[],e.cfg=s,r;const a=RP(o,s.atrPeriod),l=o.map(w=>(w==null?void 0:w.volume)??0),d=ax(l,s.volumeMAPeriod),v=l.map((w,k)=>{const S=d[k]||0;return S>0?w/S:0}),p=OP(o);let _=[];for(let w=0;w<i;w++){const k=w,S=Math.min(s.zoneLookbackBars,k+1),L=[],T=s.minZoneBars,P=Math.min(s.maxZoneBars,S);if(P>=T){const A=Math.floor((T+P)/2);L.push(T),A!==T&&A!==P&&L.push(A),P!==T&&L.push(P)}for(const A of L){const F=k-A+1;if(F<0)continue;const B=by(o,p,a,v,F,k,s);B&&_.push(B)}}let y=xy(_,s);if(y.length===0&&i>=Math.max(60,s.minZoneBars*4)){const w={...s,maxZoneWidthPct:s.maxZoneWidthPct*2,minVolumeFactor:Math.min(s.minVolumeFactor,.9),minOBVTrendStrength:Math.max(.05,s.minOBVTrendStrength*.5),minZoneScore:Math.max(.4,s.minZoneScore-.15)};_=[];for(let k=0;k<i;k++){const S=k,L=Math.min(w.zoneLookbackBars,S+1),T=[],P=w.minZoneBars,A=Math.min(w.maxZoneBars,L);if(A>=P){const F=Math.floor((P+A)/2);T.push(P),F!==P&&F!==A&&T.push(F),A!==P&&T.push(A)}for(const F of T){const B=S-F+1;if(B<0)continue;const R=by(o,p,a,v,B,S,w);R&&_.push(R)}}y=xy(_,w)}return e.zones=y,e.cfg=s,r},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{const r=t.zones||[];if(!r.length)return!1;const a=t.cfg||{},l=e.getVisibleRange(),d=Math.max(0,l.from),v=l.to,p="rgba(16, 185, 129, 0.28)",_="rgba(16, 185, 129, 0.7)",y="rgba(239, 68, 68, 0.28)",w="rgba(239, 68, 68, 0.7)";o.save();for(const k of r){if(k.endIndex<d||k.startIndex>v)continue;const S=s.convertToPixel(k.startIndex),L=s.convertToPixel(k.endIndex),T=i.convertToPixel(k.high),P=i.convertToPixel(k.low);if(!isFinite(S)||!isFinite(L)||T==null||P==null)continue;const A=Math.min(S,L),F=Math.max(1,Math.abs(L-S)),B=Math.min(T,P),R=Math.abs(T-P);o.fillStyle=k.type==="accumulation"?p:y;const N=o.roundRect??o.rect;o.beginPath();try{N.call(o,A,B,F,R,4)}catch{o.rect(A,B,F,R)}if(o.closePath(),o.fill(),o.strokeStyle=k.type==="accumulation"?_:w,o.lineWidth=1.5,o.setLineDash([]),o.stroke(),a.showLabels){const $=`${k.type==="accumulation"?"Accumulation":"Distribution"} (${k.score.toFixed(2)})`,V=A+F+6,U=B+R/2;o.save(),o.font="11px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",o.textAlign="left",o.textBaseline="middle";const G=k.type==="accumulation"?"#10B981":"#EF4444",Z="rgba(0,0,0,0.55)",le=6,se=o.measureText($),ie=Math.ceil(se.width)+le*2,Y=16,K=4,Q=V,q=U-Y/2;o.beginPath(),o.moveTo(Q+K,q),o.lineTo(Q+ie-K,q),o.quadraticCurveTo(Q+ie,q,Q+ie,q+K),o.lineTo(Q+ie,q+Y-K),o.quadraticCurveTo(Q+ie,q+Y,Q+ie-K,q+Y),o.lineTo(Q+K,q+Y),o.quadraticCurveTo(Q,q+Y,Q,q+Y-K),o.lineTo(Q,q+K),o.quadraticCurveTo(Q,q,Q+K,q),o.closePath(),o.fillStyle=Z,o.fill(),o.fillStyle=G,o.fillText($,Q+le,U+.5),o.restore()}}return o.restore(),!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{const i=(e.zones||[]).find(l=>o>=l.startIndex&&o<=l.endIndex);if(!i)return{values:[]};const r=i.type==="accumulation"?"Accumulation":"Distribution",a=i.endIndex-i.startIndex+1;return{styles:t,values:[{title:"Footprint",value:r},{title:"Score",value:i.score.toFixed(2)},{title:"Price",value:`${i.low.toFixed(e.precision??2)}–${i.high.toFixed(e.precision??2)}`},{title:"Duration",value:`${a} bars`},{title:"Prior Trend",value:`${(i.priorReturn*100).toFixed(1)}%`},{title:"Avg Volume x",value:i.avgVolumeFactor.toFixed(2)},{title:"OBV Trend",value:i.obvTrendScore>.05?"Up":i.obvTrendScore<-.05?"Down":"Flat"}]}}},Oa={bbPeriod:16,bbStdDev:2,atrPeriod:14,volMAPeriod:20,lookbackForNorm:60,pressureSMA:2,minPressureForAlert:.55,eruptionConfirmBars:1,minVolExpansion:1,minRangeExpansion:1,minBreakoutBodyPct:.5,breakoutLookback:10,w1:.5,w2:.3,w3:.2,minBarsBetweenEruptions:1,trendEMAPeriod:30,requireTrendAlign:0,breakoutBufferPct:7e-4,requireBBBandBreak:0,retestWindow:1};function Em(o,e,t){return Math.max(e,Math.min(t,o))}function m_(o,e){const t=new Array(o.length).fill(0);if(e<=1){for(let i=0;i<o.length;i++)t[i]=o[i]??0;return t}let s=0;for(let i=0;i<o.length;i++)s+=o[i]??0,i>=e&&(s-=o[i-e]??0),t[i]=i>=e-1?s/e:NaN;return t}function HP(o,e){const t=new Array(o.length).fill(NaN);if(e<=1)return o.map(()=>0);for(let s=0;s<o.length;s++){if(s<e-1)continue;let i=0;for(let l=s-e+1;l<=s;l++)i+=o[l]??0;const r=i/e;let a=0;for(let l=s-e+1;l<=s;l++){const d=(o[l]??0)-r;a+=d*d}t[s]=Math.sqrt(a/e)}return t}function GP(o,e){const t=new Array(o.length).fill(NaN);if(e<=1)return o.slice();const s=2/(e+1);let i=NaN;for(let r=0;r<o.length;r++){const a=o[r]??0;if(Number.isFinite(i))i=a*s+i*(1-s),t[r]=i;else if(r>=e-1){let l=0;for(let d=r-e+1;d<=r;d++)l+=o[d]??0;i=l/e,t[r]=i}}return t}function lx(o,e){if(!o)return 0;const t=o.high??0,s=o.low??0,i=(e==null?void 0:e.close)??o.close??0;return Math.max(t-s,Math.abs(t-i),Math.abs(s-i))}function YP(o,e){const t=o.map((r,a)=>lx(r,a>0?o[a-1]:void 0)),s=new Array(o.length).fill(NaN);if(e<=1)return t;let i=0;for(let r=0;r<t.length;r++)i+=t[r]??0,r===e-1?s[r]=i/e:r>=e&&(s[r]=((s[r-1]??0)*(e-1)+(t[r]??0))/e);return s}function wy(o,e){const t=new Array(o.length).fill(NaN);for(let s=0;s<o.length;s++){const i=Math.max(0,s-e+1);let r=1/0;for(let a=i;a<=s;a++)Number.isFinite(o[a])&&o[a]<r&&(r=o[a]);t[s]=r===1/0?NaN:r}return t}function ky(o,e){const t=new Array(o.length).fill(NaN);for(let s=0;s<o.length;s++){const i=Math.max(0,s-e+1);let r=-1/0;for(let a=i;a<=s;a++)Number.isFinite(o[a])&&o[a]>r&&(r=o[a]);t[s]=r===-1/0?NaN:r}return t}function Sy(o,e,t){return!Number.isFinite(e)||!Number.isFinite(t)||t===e?.5:Em((o-e)/(t-e),0,1)}function UP(o,e,t){const s=Math.max(0,e-t);let i=-1/0;for(let r=s;r<e;r++)o[r]&&(o[r].high??-1/0)>i&&(i=o[r].high);return i===-1/0?NaN:i}function KP(o,e,t){const s=Math.max(0,e-t);let i=1/0;for(let r=s;r<e;r++)o[r]&&(o[r].low??1/0)<i&&(i=o[r].low);return i===1/0?NaN:i}function cx(o,e){const t={...Oa,...e},s=o.length,i=o.map(q=>(q==null?void 0:q.close)??0),r=o.map(q=>(q==null?void 0:q.volume)??0);if(s===0)return{pressure:[],pressureSmoothed:[],eruptions:[]};const a=m_(i,t.bbPeriod),l=HP(i,t.bbPeriod),d=new Array(s).fill(NaN),v=new Array(s).fill(NaN),p=new Array(s).fill(NaN);for(let q=0;q<s;q++)if(Number.isFinite(a[q])&&Number.isFinite(l[q])){d[q]=a[q]+t.bbStdDev*l[q],v[q]=a[q]-t.bbStdDev*l[q];const ce=d[q]-v[q],_e=i[q]||1;p[q]=_e!==0?ce/Math.abs(_e):0}const _=Math.max(2,t.trendEMAPeriod??50),y=GP(i,_),w=YP(o,t.atrPeriod),k=w.map((q,ce)=>{const _e=i[ce]||1;return _e!==0?(q??0)/Math.abs(_e):0}),S=m_(r,t.volMAPeriod),L=r.map((q,ce)=>{const _e=S[ce]??0;return _e>0?q/_e:0}),T=Math.max(10,t.lookbackForNorm),P=wy(p,T),A=ky(p,T),F=wy(k,T),B=ky(k,T),R=new Array(s).fill(0),N=new Array(s).fill(0),$=new Array(s).fill(0);for(let q=0;q<s;q++){const ce=Sy(p[q]??0,P[q],A[q]),_e=Sy(k[q]??0,F[q],B[q]);R[q]=1-ce,N[q]=1-_e;const me=Math.max(L[q]??0,1e-8),Pe=Em(1/me,0,2);$[q]=Em(Pe/2,0,1)}const V=t.w1??.5,U=t.w2??.3,G=t.w3??.2,Z=new Array(s).fill(0);for(let q=0;q<s;q++){const ce=V*R[q]+U*N[q]+G*$[q];Z[q]=Em(ce,0,1)}const le=m_(Z,Math.max(1,t.pressureSMA)).map(q=>Number.isFinite(q)?q:0),se=[],ie=Math.max(1,t.minBarsBetweenEruptions??8);let Y=-1e4,K=!1,Q=-1;for(let q=0;q<s;q++){const ce=le[q]??0;if(ce>=t.minPressureForAlert?K||(K=!0,Q=q):K=!1,!(K||Q>=0&&q-Q<=t.eruptionConfirmBars+2)||q-Y<ie)continue;const me=lx(o[q],q>0?o[q-1]:void 0),Pe=w[q]??me,ze=Pe>0?me/Pe:0;if(ze<t.minRangeExpansion)continue;const he=L[q]??0;if(he<t.minVolExpansion)continue;const De=o[q],ge=Math.max(0,(De.high??0)-(De.low??0)),be=Math.abs((De.close??0)-(De.open??0));if((ge>0?be/ge:0)<t.minBreakoutBodyPct)continue;const Ve=UP(o,q,t.breakoutLookback),Ce=KP(o,q,t.breakoutLookback),Je=Math.max(0,t.breakoutBufferPct??.001),ye=(t.requireBBBandBreak??1)>0,Ae=(t.requireTrendAlign??1)>0,ee=y[q],xe=q>0?y[q-1]:ee,ke=Number.isFinite(ee)&&Number.isFinite(xe)&&(De.close??0)>ee&&ee>=xe,He=Number.isFinite(ee)&&Number.isFinite(xe)&&(De.close??0)<ee&&ee<=xe,Ie=d[q],ne=v[q];let J=Number.isFinite(Ve)&&(De.close??0)>Ve*(1+Je),qe=Number.isFinite(Ce)&&(De.close??0)<Ce*(1-Je);if(ye&&(J=J&&Number.isFinite(Ie)&&(De.close??0)>Ie,qe=qe&&Number.isFinite(ne)&&(De.close??0)<ne),Ae&&(J=J&&ke,qe=qe&&He),!J&&!qe)continue;const ft=q,Qe=Math.min(s-1,ft+Math.max(1,t.eruptionConfirmBars));let Oe=0,ct=!0;const Lt=Math.max(1,t.retestWindow??2);if(J)for(let zt=ft;zt<=Qe;zt++){const pt=o[zt];(pt.close??0)>=(De.high??0)&&Oe++,zt<=ft+Lt&&Number.isFinite(Ve)&&(pt.close??0)<Ve&&(ct=!1)}else if(qe)for(let zt=ft;zt<=Qe;zt++){const pt=o[zt];(pt.close??0)<=(De.low??0)&&Oe++,zt<=ft+Lt&&Number.isFinite(Ce)&&(pt.close??0)>Ce&&(ct=!1)}const It=Math.ceil((Qe-ft+1)/2);if(ct&&Oe>=It){const zt=J?"bullish":"bearish",pt=J?Ve:Ce;se.push({index:ft,time:De.timestamp??0,direction:zt,pressureAtSignal:ce,rangeExpansion:ze,volumeFactor:he,breakoutLevel:pt}),Y=ft}}return{pressure:Z,pressureSmoothed:le,eruptions:se}}const ZP={name:"VOLCANIC",shortName:"VOLC",precision:2,shouldOhlc:!1,shouldFormatBigNumber:!1,visible:!0,zLevel:0,minValue:0,maxValue:1,figures:[{key:"pressure",title:"Pressure: ",type:"line"}],styles:{lines:[{color:"#60A5FA",size:2,style:Ee.Solid,smooth:!1,dashedValue:[2,2]}]},calc:(o,e)=>{const t=e.calcParams,s={bbPeriod:(t==null?void 0:t[0])??Oa.bbPeriod,bbStdDev:(t==null?void 0:t[1])??Oa.bbStdDev,atrPeriod:(t==null?void 0:t[2])??Oa.atrPeriod,volMAPeriod:(t==null?void 0:t[3])??Oa.volMAPeriod,lookbackForNorm:(t==null?void 0:t[4])??Oa.lookbackForNorm,pressureSMA:(t==null?void 0:t[5])??Oa.pressureSMA,minPressureForAlert:(t==null?void 0:t[6])??Oa.minPressureForAlert,eruptionConfirmBars:(t==null?void 0:t[7])??Oa.eruptionConfirmBars,minVolExpansion:(t==null?void 0:t[8])??Oa.minVolExpansion,minRangeExpansion:(t==null?void 0:t[9])??Oa.minRangeExpansion,minBreakoutBodyPct:(t==null?void 0:t[10])??Oa.minBreakoutBodyPct,breakoutLookback:(t==null?void 0:t[11])??Oa.breakoutLookback,minBarsBetweenEruptions:(t==null?void 0:t[12])??Oa.minBarsBetweenEruptions,trendEMAPeriod:(t==null?void 0:t[13])??Oa.trendEMAPeriod??30,requireTrendAlign:(t==null?void 0:t[14])??Oa.requireTrendAlign??0,breakoutBufferPct:(t==null?void 0:t[15])??Oa.breakoutBufferPct??7e-4,requireBBBandBreak:(t==null?void 0:t[16])??Oa.requireBBBandBreak??0,retestWindow:(t==null?void 0:t[17])??Oa.retestWindow??1},{pressureSmoothed:i}=cx(o,s);return i.map(r=>({pressure:Number.isFinite(r)?r:null}))},draw:({ctx:o,chart:e,indicator:t,bounding:s,xAxis:i,yAxis:r})=>{var A,F,B,R,N,$,V;const a=t.result;if(!a||a.length===0)return!1;const l=e.getVisibleRange(),d=Math.max(0,l.from),v=Math.min(a.length-1,l.to),p=t.calcParams,_=(p==null?void 0:p[6])??Oa.minPressureForAlert,y=((B=(F=(A=t.styles)==null?void 0:A.lines)==null?void 0:F[0])==null?void 0:B.color)||"#60A5FA",w="#F59E0B",k=(($=(N=(R=t.styles)==null?void 0:R.lines)==null?void 0:N[0])==null?void 0:$.size)||2;o.save(),o.lineCap="round",o.lineJoin="round";const S=r.convertToPixel(_);S!==null&&(o.strokeStyle="#9CA3AF",o.lineWidth=1,o.setLineDash([4,4]),o.beginPath(),o.moveTo(s.left,S),o.lineTo(s.left+s.width,S),o.stroke(),o.setLineDash([]));let L=null,T=null,P=null;for(let U=d;U<=v;U++){const G=((V=a[U])==null?void 0:V.pressure)??null;if(G==null){L=T=P=null;continue}const Z=i.convertToPixel(U),le=r.convertToPixel(G);if(Z===null||le===null){L=T=P=null;continue}if(L!==null&&T!==null&&P!==null){const se=(P+G)/2;o.strokeStyle=se>=_?w:y,o.lineWidth=k,o.beginPath(),o.moveTo(L,T),o.lineTo(Z,le),o.stroke()}L=Z,T=le,P=G}return o.restore(),!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{const s=e.result[o];if(!s)return{values:[]};const i=e.calcParams,r=(i==null?void 0:i[6])??Oa.minPressureForAlert,a=s.pressure!==null&&s.pressure!==void 0?Number(s.pressure).toFixed(2):"—";return{styles:t,values:[{title:"Pressure",value:a},{title:"Alert ≥",value:Number(r).toFixed(2)}]}}},XP={name:"VOLCANIC_SIG",shortName:"VOLCSIG",precision:2,shouldOhlc:!0,shouldFormatBigNumber:!1,visible:!0,zLevel:0,figures:[],styles:{texts:[{color:"#ffffff",size:10}]},calc:(o,e)=>{const t=e.calcParams,s={bbPeriod:(t==null?void 0:t[0])??Oa.bbPeriod,bbStdDev:(t==null?void 0:t[1])??Oa.bbStdDev,atrPeriod:(t==null?void 0:t[2])??Oa.atrPeriod,volMAPeriod:(t==null?void 0:t[3])??Oa.volMAPeriod,lookbackForNorm:(t==null?void 0:t[4])??Oa.lookbackForNorm,pressureSMA:(t==null?void 0:t[5])??Oa.pressureSMA,minPressureForAlert:(t==null?void 0:t[6])??Oa.minPressureForAlert,eruptionConfirmBars:(t==null?void 0:t[7])??Oa.eruptionConfirmBars,minVolExpansion:(t==null?void 0:t[8])??Oa.minVolExpansion,minRangeExpansion:(t==null?void 0:t[9])??Oa.minRangeExpansion,minBreakoutBodyPct:(t==null?void 0:t[10])??Oa.minBreakoutBodyPct,breakoutLookback:(t==null?void 0:t[11])??Oa.breakoutLookback,minBarsBetweenEruptions:(t==null?void 0:t[12])??Oa.minBarsBetweenEruptions,trendEMAPeriod:(t==null?void 0:t[13])??Oa.trendEMAPeriod??30,requireTrendAlign:(t==null?void 0:t[14])??Oa.requireTrendAlign??0,breakoutBufferPct:(t==null?void 0:t[15])??Oa.breakoutBufferPct??7e-4,requireBBBandBreak:(t==null?void 0:t[16])??Oa.requireBBBandBreak??0,retestWindow:(t==null?void 0:t[17])??Oa.retestWindow??1},{eruptions:i}=cx(o,s),r=new Array(o.length).fill(null).map(()=>({}));return i.forEach(a=>{const l=r[a.index]||{};a.direction==="bullish"&&(l.bull=!0),a.direction==="bearish"&&(l.bear=!0),l.pressure=a.pressureAtSignal,l.rangeExpansion=a.rangeExpansion,l.volumeFactor=a.volumeFactor,l.breakoutLevel=a.breakoutLevel,r[a.index]=l}),r},draw:({ctx:o,chart:e,indicator:t,xAxis:s,yAxis:i})=>{const r=t.result;if(!r||r.length===0)return!1;const a=e.getDataList(),l=e.getVisibleRange(),d=Math.max(0,l.from),v=Math.min(r.length-1,l.to);function p(y,w,k,S){o.save(),o.fillStyle=k,o.beginPath(),S?(o.moveTo(y,w+6),o.lineTo(y-5,w-4),o.lineTo(y+5,w-4)):(o.moveTo(y,w-6),o.lineTo(y-5,w+4),o.lineTo(y+5,w+4)),o.closePath(),o.fill(),o.restore()}function _(y,w,k,S){o.save(),o.font="11px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",o.textAlign="center",o.textBaseline="middle";const L=6,T=16,P=o.measureText(k),A=Math.ceil(P.width)+L*2,F=4,B=y-A/2,R=w-T/2;o.fillStyle="rgba(0,0,0,0.6)",o.beginPath(),o.moveTo(B+F,R),o.lineTo(B+A-F,R),o.quadraticCurveTo(B+A,R,B+A,R+F),o.lineTo(B+A,R+T-F),o.quadraticCurveTo(B+A,R+T,B+A-F,R+T),o.lineTo(B+F,R+T),o.quadraticCurveTo(B,R+T,B,R+T-F),o.lineTo(B,R+F),o.quadraticCurveTo(B,R,B+F,R),o.closePath(),o.fill(),o.fillStyle=S,o.fillText(k,y,w+.5),o.restore()}for(let y=d;y<=v;y++){const w=r[y];if(!w||!w.bull&&!w.bear)continue;const k=s.convertToPixel(y),S=a[y];if(S){if(w.bull){const L=i.convertToPixel(S.low)+12;p(k,L,"#F59E0B",!0),_(k,L+16,"Volcanic Move (Bullish)","#F59E0B")}if(w.bear){const L=i.convertToPixel(S.high)-12;p(k,L,"#EF4444",!1),_(k,L-16,"Volcanic Move (Bearish)","#EF4444")}}}return!0},createTooltipDataSource:({dataIndex:o,indicator:e,defaultStyles:t})=>{var d;const s=(d=e.result)==null?void 0:d[o];if(!s||!s.bull&&!s.bear)return{values:[]};const i=s.bull?"Bullish":"Bearish",r=s.pressure!==void 0?Number(s.pressure).toFixed(2):"—",a=s.rangeExpansion!==void 0?Number(s.rangeExpansion).toFixed(2):"—",l=s.volumeFactor!==void 0?Number(s.volumeFactor).toFixed(2):"—";return{styles:t,values:[{title:"Eruption",value:i},{title:"Pressure",value:r},{title:"Range x",value:a},{title:"Volume x",value:l}]}}};function JP(o,e,t,s,i,r,a){const l=s*.4,d=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.lineJoin="round",o.beginPath(),o.moveTo(e-l,t-d),o.lineTo(e+l,t+d),o.moveTo(e+l,t-d),o.lineTo(e-l,t+d),o.stroke(),o.restore()}function QP(o,e,t,s,i,r,a){const l=s*.4,d=i*.4;o.save(),o.strokeStyle=r,o.lineWidth=a,o.lineCap="round",o.beginPath(),o.ellipse(e,t,l,d,0,0,Math.PI*2),o.stroke(),o.restore()}const eI={name:"PNF",shortName:"P&F",calcParams:[],figures:[],calc:(o,e)=>o.map(t=>{const s=t==null?void 0:t._pnf;return s?{direction:s.direction,boxes:s.boxes,upColor:s.upColor,downColor:s.downColor,boxSize:s.boxSize}:{}}),draw:o=>{var T,P;const{ctx:e,visibleRange:t,indicator:s,xAxis:i,yAxis:r}=o,a=s.result||[];if(!(i!=null&&i.convertToPixel)||!(r!=null&&r.convertToPixel))return!1;const l=i.convertToPixel(0),d=i.convertToPixel(1),v=Math.max(1,Math.abs(d-l));let p=v;for(const A of a)if(A!=null&&A.boxes&&A.boxes.length>=2&&(r!=null&&r.convertToPixel)){const F=A.boxes[0],B=A.boxes[1],R=r.convertToPixel(F.price),N=r.convertToPixel(B.price);if(R!==void 0&&N!==void 0&&!isNaN(R)&&!isNaN(N)){const $=Math.abs(R-N);if($>0){p=$;break}}}if(p===v){const A=a.find(F=>(F==null?void 0:F.boxSize)&&F.boxSize>0);if(A!=null&&A.boxSize){const F=((P=(T=A.boxes)==null?void 0:T[0])==null?void 0:P.price)||100,B=r.convertToPixel(F),R=r.convertToPixel(F+A.boxSize);if(B!==void 0&&R!==void 0&&!isNaN(B)&&!isNaN(R)){const N=Math.abs(B-R);N>0&&(p=N)}}}const _=v*.85,y=p*.85,w=(_+y)/2,k=Math.max(.8,w*.08),S=(t==null?void 0:t.from)||0,L=(t==null?void 0:t.to)||a.length;for(let A=S;A<L;A++){const F=a[A];if(!F||!F.boxes||!Array.isArray(F.boxes))continue;const{direction:B,boxes:R,upColor:N="#00E6D8",downColor:$="#FF4D4D"}=F,V=i.convertToPixel(A);if(!(V===void 0||isNaN(V)))for(const U of R){const G=r.convertToPixel(U.price);G===void 0||isNaN(G)||(B==="up"?JP(e,V,G,_,y,N,k):QP(e,V,G,_,y,$,k))}}return!1}},tI=[nP,iP,aP,lP,ix,uP,vP,fP,gP,hP,yP,bP,xP,wP,kP,CP,PP,IP,MP,AP,LP,DP,EP,$P,NP,qP,ZP,XP,eI];function oI(o,e){e?console.log(o,e):console.log(o)}function f0(){return Date.now()}function gm(o,e){const t=o.country||"__";return`${o.ticker}_${t}_${e}`}function mm(o){return{key:o.key,symbol:o.symbol.ticker,timeframe:o.timeframe,candles:o.candles,oldestTimestampLoaded:o.oldest,newestTimestampLoaded:o.newest,isComplete:o.isComplete,isRunning:o.isRunning,pipelineStarts:o.starts,apiCalls:o.apiCalls,lastUpdatedAt:o.lastUpdatedAt,error:o.error}}function sI(o,e){var i;let t=0,s=o.length;for(;t<s;){const r=t+s>>>1;(((i=o[r])==null?void 0:i.timestamp)??0)>=e?s=r:t=r+1}return t}function Cy(o,e){return o<=0?Promise.resolve():new Promise((t,s)=>{const i=setTimeout(t,o);if(!e)return;const r=()=>{clearTimeout(i),s(new DOMException("Aborted","AbortError"))};if(e.aborted)return r();e.addEventListener("abort",r,{once:!0})})}class nI{constructor(e,t={}){re(this,"entries",new Map);re(this,"fetchPage");re(this,"opt");this.fetchPage=e,this.opt={maxKeys:t.maxKeys??16,ttlMs:t.ttlMs??20*6e4,initialLimit:t.initialLimit??600,pageLimit:t.pageLimit??800,pageDelayMs:t.pageDelayMs??75,maxRetries:t.maxRetries??2,retryBaseDelayMs:t.retryBaseDelayMs??400,log:t.log??oI}}start(e,t){const s=gm(e,t),i=this.getOrCreate(e,t);return this.touch(i),this.ensureRunning(i),{key:s,getSnapshot:()=>this.getSnapshot(e,t),subscribe:r=>this.subscribe(e,t,r)}}getSnapshot(e,t){const s=gm(e,t),i=this.entries.get(s);return i?(this.touch(i),mm(i)):{key:s,symbol:e.ticker,timeframe:t,candles:[],oldestTimestampLoaded:null,newestTimestampLoaded:null,isComplete:!1,isRunning:!1,pipelineStarts:0,apiCalls:0,lastUpdatedAt:0,error:null}}async waitForInitial(e,t){const s=this.getOrCreate(e,t);return this.touch(s),this.ensureRunning(s),await this.ensureInitialLoaded(s,s.generation),mm(s)}requestVisibleRange(e){const t=this.entries.get(gm(e.symbol,e.timeframe));if(!t||t.candles.length===0)return[];this.touch(t);const s=sI(t.candles,e.beforeTimestamp),i=Math.max(0,s-Math.max(1,e.limit));return t.candles.slice(i,s)}stopSymbol(e){for(const t of this.entries.values())t.symbol.ticker===e&&this.stopEntry(t)}stopAll(){for(const e of this.entries.values())this.stopEntry(e)}clear(){this.stopAll(),this.entries.clear()}subscribe(e,t,s){const i=this.getOrCreate(e,t);this.touch(i),i.subs.add(s);try{s(mm(i))}catch{}return()=>{i.subs.delete(s)}}getMetrics(){const e=[];for(const t of this.entries.values())e.push({key:t.key,pipelineStarts:t.starts,apiCalls:t.apiCalls,isRunning:t.isRunning,isComplete:t.isComplete,error:t.error});return e}emit(e){const t=mm(e);for(const s of e.subs)try{s(t)}catch{}}touch(e){e.lastAccessAt=f0(),this.entries.get(e.key)===e&&(this.entries.delete(e.key),this.entries.set(e.key,e)),this.evictIfNeeded()}evictIfNeeded(){const e=f0()-this.opt.ttlMs;for(;;){const t=this.entries.keys().next().value;if(!t)break;const s=this.entries.get(t);if(!s){this.entries.delete(t);continue}if(s.lastAccessAt>=e)break;this.stopEntry(s),this.entries.delete(t)}for(;this.entries.size>this.opt.maxKeys;){const t=this.entries.keys().next().value;if(!t)break;const s=this.entries.get(t);if(!s){this.entries.delete(t);continue}this.stopEntry(s),this.entries.delete(t)}}getOrCreate(e,t){const s=gm(e,t),i=this.entries.get(s);if(i)return i;const r={key:s,symbol:e,timeframe:t,candles:[],ts:new Set,oldest:null,newest:null,isComplete:!1,isRunning:!1,starts:0,apiCalls:0,lastUpdatedAt:0,lastAccessAt:f0(),error:null,nextSkip:0,generation:0,initialPromise:null,runPromise:null,abort:null,subs:new Set};return this.entries.set(s,r),r}ensureRunning(e){if(e.isComplete||e.runPromise)return;e.isRunning=!0,e.error=null,e.generation+=1,e.starts+=1,e.abort||(e.abort=new AbortController);const t=e.generation;this.opt.log("📡 [pipeline:start]",{key:e.key,gen:t});const s=this.runLoop(e,t).finally(()=>{e.runPromise===s&&(e.runPromise=null),e.isRunning=!1,e.abort=null,this.emit(e),this.opt.log("⏹️ [pipeline:stop]",{key:e.key,gen:t,complete:e.isComplete})});e.runPromise=s}stopEntry(e){var t;e.generation+=1,e.isRunning=!1,e.initialPromise=null;try{(t=e.abort)==null||t.abort()}catch{}e.abort=null}async ensureInitialLoaded(e,t){e.candles.length>0||e.isComplete||(e.initialPromise||(e.initialPromise=(async()=>{const s=e.abort??new AbortController;e.abort=s;const i=e.nextSkip,r=this.opt.initialLimit;try{const a=await this.fetchPageWithRetry(e,{skip:i,limit:r,gen:t,signal:s.signal});if(e.generation!==t)return;this.mergePage(e,a),e.nextSkip=i+a.length,this.emit(e)}finally{e.initialPromise=null}})()),await e.initialPromise.catch(()=>{}))}async runLoop(e,t){for(await this.ensureInitialLoaded(e,t);e.isRunning&&!e.isComplete&&e.generation===t;){const s=e.abort??new AbortController;e.abort=s;const i=e.nextSkip,r=this.opt.pageLimit;let a=[];try{a=await this.fetchPageWithRetry(e,{skip:i,limit:r,gen:t,signal:s.signal})}catch(l){if(e.generation!==t||l instanceof DOMException&&l.name==="AbortError")return;e.error=l instanceof Error?l.message:"Fetch failed",this.emit(e);return}if(e.generation!==t)return;if(!a||a.length===0){e.isComplete=!0,this.emit(e);return}this.mergePage(e,a),e.nextSkip=i+a.length,this.emit(e),await Cy(this.opt.pageDelayMs,s.signal).catch(()=>{})}}async fetchPageWithRetry(e,t){let s=0;for(;;)try{e.apiCalls+=1,this.opt.log("🌐 [pipeline:page]",{key:e.key,skip:t.skip,limit:t.limit,calls:e.apiCalls});const i=await this.fetchPage({symbol:e.symbol,timeframe:e.timeframe,skip:t.skip,limit:t.limit,signal:t.signal});return e.lastUpdatedAt=f0(),e.error=null,Array.isArray(i)?i:[]}catch(i){if(i instanceof DOMException&&i.name==="AbortError"||e.generation!==t.gen||s>=this.opt.maxRetries)throw i;const r=this.opt.retryBaseDelayMs*Math.pow(2,s);s+=1,await Cy(r,t.signal)}}mergePage(e,t){if(!Array.isArray(t)||t.length===0)return;const s=[];for(const i of t){const r=i==null?void 0:i.timestamp;typeof r=="number"&&(e.ts.has(r)||(e.ts.add(r),s.push(i),(e.oldest==null||r<e.oldest)&&(e.oldest=r),(e.newest==null||r>e.newest)&&(e.newest=r)))}if(s.length>0){if(s.sort((i,r)=>i.timestamp-r.timestamp),e.candles.length===0)e.candles=s;else{const i=new Array(e.candles.length+s.length);let r=0,a=0,l=0;for(;r<e.candles.length&&a<s.length;)e.candles[r].timestamp<=s[a].timestamp?i[l++]=e.candles[r++]:i[l++]=s[a++];for(;r<e.candles.length;)i[l++]=e.candles[r++];for(;a<s.length;)i[l++]=s[a++];i.length=l,e.candles=i}e.lastUpdatedAt=f0()}}}class iI{constructor(){re(this,"_prevSymbol");re(this,"_ws");re(this,"listens",{});re(this,"polygonApiKey","k2hPDhLy8gIpP4lMCU0gwo92xNRxE2XI");re(this,"currentPriceCache",new Map);re(this,"pipeline");this.pipeline=new nI(this.fetchHistoryPage.bind(this),{initialLimit:800,pageLimit:1e3,pageDelayMs:60,maxKeys:24,ttlMs:25*6e4})}async getHistoryKLineData({symbol:e,period:t,from:s,to:i,strategy:r}){const a=(t==null?void 0:t.timeframe)||"1m",d=(await this.pipeline.waitForInitial(e,a)).candles;if(d.length>0){const v=d[d.length-1].close;this.currentPriceCache.set(e.ticker,v)}return{data:d.slice(),lays:[]}}startBackgroundPrefetch(e,t){this.pipeline.start(e,t.timeframe)}hasMoreServerHistory(e,t){return!this.pipeline.getSnapshot(e,t.timeframe).isComplete}async loadMoreHistoricalData(e,t,s,i=2){return{data:this.pipeline.requestVisibleRange({symbol:e,timeframe:t.timeframe,beforeTimestamp:s,limit:350}),lays:[]}}removeDuplicateData(e){const t=new Set;return e.filter(s=>t.has(s[0])?!1:(t.add(s[0]),!0))}getTimeframeInMs(e){return e.endsWith("m")?parseInt(e.slice(0,-1))*60*1e3:e.endsWith("h")?parseInt(e.slice(0,-1))*60*60*1e3:e.endsWith("d")?parseInt(e.slice(0,-1))*24*60*60*1e3:e.endsWith("w")?parseInt(e.slice(0,-1))*7*24*60*60*1e3:60*1e3}canLoadMoreData(e,t){const s=this.pipeline.getSnapshot(e,t.timeframe);return s.candles.length>0&&!s.isComplete}convertResolutionForStockNow(e){return e==="1d"?"1D":e==="1w"?"1W":e==="1M"?"1M":e.endsWith("m")?e.slice(0,-1):e.endsWith("h")?(parseInt(e.slice(0,-1))*60).toString():e.endsWith("d")?(parseInt(e.slice(0,-1))*24*60).toString():e.endsWith("w")?(parseInt(e.slice(0,-1))*7*24*60).toString():e}async fetchHistoryPage(e){const t=this.convertResolutionForStockNow(e.timeframe),s=encodeURIComponent(e.symbol.ticker),i=e.symbol.country||"BD",l=`https://noti.dutyai.app${`/finance/get/chart/${s}/${t}?skip=${e.skip}&limit=${e.limit}&country=${i}`}`,d=await fetch(l,{signal:e.signal});if(!d.ok)return[];const v=await d.text();if(!v||v.trim()==="")return[];try{const p=JSON.parse(v);return Array.isArray(p)?p:[]}catch{return[]}}async getSymbols(){console.log("🚀 getSymbols() method called");try{console.log("🌐 Fetching symbols from API...");const s=await fetch("https://noti.dutyai.app"+"/finance/get/stock/list/latest");if(!s.ok)return console.warn(`⚠️ API request failed with status: ${s.status}`),[];let i=await s.json();if(!Array.isArray(i))return console.warn("⚠️ API response is not an array, using fallback symbols"),[];i.push({ticker:"DSEX",name:"Dhaka Stock Exchange",shortName:"DSEX",market:"stock",exchange:"DSEBD",priceCurrency:"BDT",type:"stock",logo:"",country:"BD"}),console.log(`📊 Received ${i.length} symbols from API`);const a=i.map(l=>({ticker:l.symbol||l.ticker||"",name:l.description||l.fullName||l.name||l.symbol||l.ticker||"",shortName:l.name||l.symbol||l.ticker||"",market:"stock",country:l.country||"BD",exchange:l.exchange||"UNKNOWN",priceCurrency:l.currency||(l.country==="US"?"USD":"BDT"),type:l.type||"stock",logo:l.logo?l.logo.trim():l.symbol||l.ticker?`https://s3-api.bayah.app/cdn/symbol/logo/${l.symbol||l.ticker}.svg`:"",logo2:l.logo2})).filter(l=>l.ticker&&l.ticker.trim()!=="");return console.log(`✅ Successfully processed ${a.length} valid symbols`),console.log("📋 Sample symbols:",a.slice(0,5)),a.length>0?a:[]}catch(e){return console.error("❌ Error fetching symbols from API:",e),console.log("🔄 Falling back to hardcoded symbols"),[]}}watch(e,t){var s;this._ws&&((s=this._ws)==null||s.send(JSON.stringify({action:"watch",key:e})),this.listens[e]=t)}subscribe(e,t){var i;if(((i=this._prevSymbol)==null?void 0:i.ticker)===e.ticker)return;this._prevSymbol=e,this.unsubscribe(),console.log(`Subscribing to real-time updates for ${e.ticker}`);const s=setInterval(()=>{const r=this.currentPriceCache.get(e.ticker)||Math.random()*100+10,a=(Math.random()-.5)*2,l=r+a;this.currentPriceCache.set(e.ticker,l);const v=[Date.now(),r,Math.max(r,l)+Math.random()*.5,Math.min(r,l)-Math.random()*.5,l,Math.random()*1e3];t({bars:[v],secs:1})},2e3);this.listens[e.ticker]=s}unsubscribe(e){this._ws&&(this._ws.close(),this._ws=void 0),Object.values(this.listens).forEach(s=>{typeof s=="number"&&clearInterval(s)}),this.listens={};const t=e==null?void 0:e.ticker;t&&this.pipeline.stopSymbol(t)}getCurrentPrice(e){return this.currentPriceCache.get(e)||null}clearCache(){this.pipeline.clear(),this.currentPriceCache.clear()}getPipelineMetrics(){return this.pipeline.getMetrics()}stopSymbolPipelines(e){this.pipeline.stopSymbol(e)}stopAllPipelines(){this.pipeline.stopAll()}getHistorySnapshot(e,t){return this.pipeline.getSnapshot(e,t)}async ensureHistoryBefore(e,t,s,i=2500){if(!(e!=null&&e.ticker))return this.pipeline.getSnapshot(e,t);this.pipeline.start(e,t);const r=l=>{const d=l.oldestTimestampLoaded;return typeof s!="number"||!Number.isFinite(s)||s<=0?l.candles.length>0:d!=null&&d<=s},a=this.pipeline.getSnapshot(e,t);return r(a)||a.isComplete?a:await new Promise(l=>{let d=!1,v=null,p=null;const _=y=>{if(!d){d=!0;try{v&&clearTimeout(v)}catch{}try{p==null||p()}catch{}l(y)}};p=this.pipeline.subscribe(e,t,y=>{(r(y)||y.isComplete||y.error)&&_(y)}),v=setTimeout(()=>{_(this.pipeline.getSnapshot(e,t))},Math.max(100,i))})}async ensureHistoryCovers(e,t,s,i,r=3500){if(!(e!=null&&e.ticker))return this.pipeline.getSnapshot(e,t);this.pipeline.start(e,t);const a=d=>{const v=d.oldestTimestampLoaded,p=d.newestTimestampLoaded;return typeof s!="number"||!Number.isFinite(s)||s<=0||typeof i!="number"||!Number.isFinite(i)||i<=0?d.candles.length>0:v!=null&&p!=null&&v<=s&&p>=i},l=this.pipeline.getSnapshot(e,t);return a(l)||l.isComplete?l:await new Promise(d=>{let v=!1,p=null,_=null;const y=w=>{if(!v){v=!0;try{p&&clearTimeout(p)}catch{}try{_==null||_()}catch{}d(w)}};_=this.pipeline.subscribe(e,t,w=>{(a(w)||w.isComplete||w.error)&&y(w)}),p=setTimeout(()=>{y(this.pipeline.getSnapshot(e,t))},Math.max(100,r))})}}var rI=qn('<path d="M12.41465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L12.41465,12C12.20873,12.5826,11.65311,13,11,13C10.34689,13,9.79127,12.5826,9.58535,12L3.5,12C3.223857,12,3,11.77614,3,11.5C3,11.22386,3.223857,11,3.5,11L9.58535,11C9.79127,10.417404,10.34689,10,11,10C11.65311,10,12.20873,10.417404,12.41465,11Z" stroke-opacity="0" stroke="none"></path>'),aI=qn('<g transform="scale(0.7857142857)"><path fill="currentColor" stroke="currentColor" stroke-width="1" d="M2 9.75a1.5 1.5 0 0 0-1.5 1.5v5.5a1.5 1.5 0 0 0 1.5 1.5h24a1.5 1.5 0 0 0 1.5-1.5v-5.5a1.5 1.5 0 0 0-1.5-1.5zm0 1h3v2.5h1v-2.5h3.25v3.9h1v-3.9h3.25v2.5h1v-2.5h3.25v3.9h1v-3.9H22v2.5h1v-2.5h3a.5.5 0 0 1 .5.5v5.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-5.5a.5.5 0 0 1 .5-.5z" transform="rotate(-45 14 14)"></path></g>'),lI=qn('<path d="M21,5.5C21,6.32843,20.3284,7,19.5,7C19.4136,7,19.3289,6.99269,19.2465,6.97866L15.6257,15.5086C15.8587,15.7729,16,16.119999999999997,16,16.5C16,17.328400000000002,15.3284,18,14.5,18C13.8469,18,13.2913,17.5826,13.0854,17L3.91465,17C3.70873,17.5826,3.15311,18,2.5,18C1.671573,18,1,17.328400000000002,1,16.5C1,15.6716,1.671573,15,2.5,15C2.5840199999999998,15,2.66643,15.0069,2.74668,15.0202L6.36934,6.48574C6.13933,6.22213,6,5.87733,6,5.5C6,4.671573,6.67157,4,7.5,4C8.15311,4,8.70873,4.417404,8.91465,5L18.0854,5C18.2913,4.417404,18.8469,4,19.5,4C20.3284,4,21,4.671573,21,5.5ZM18.0854,6L8.91465,6C8.892579999999999,6.06243,8.8665,6.12296,8.83672,6.18128L13.9814,15.0921C14.143,15.0325,14.3177,15,14.5,15C14.584,15,14.6664,15.0069,14.7467,15.0202L18.3693,6.48574C18.2462,6.3446,18.149,6.1802,18.0854,6ZM13.2036,15.745L8.0861,6.8811800000000005C7.90605,6.95768,7.70797,7,7.5,7C7.41359,7,7.32888,6.99269,7.24647,6.97866L3.62571,15.5086C3.7512,15.651,3.8501,15.8174,3.91465,16L13.0854,16C13.1169,15.9108,13.1566,15.8255,13.2036,15.745Z" stroke-opacity="0" stroke="none"></path>'),cI=qn('<path d="M9.474616630859375,7.494615087890625L8.844736630859375,7.494615087890625L8.844736630859375,4.149892087890625L8.000006630859374,4.634915087890625L8.004896630859374,4.005035087890625L9.020516630859376,3.414215087890625L9.474616630859375,3.414215087890625L9.474616630859375,7.494615087890625ZM18.529296630859378,4.8318550878906255Q18.307996630859375,5.028795087890625,18.122396630859377,5.385245087890625Q17.868496630859376,5.019035087890625,17.629196630859376,4.8269750878906255Q17.389996630859375,4.634915087890625,17.168596630859376,4.634915087890625Q16.794296630859375,4.634915087890625,16.522496630859376,4.976715087890625Q16.252296630859377,5.3168850878906255,16.252296630859377,5.7856350878906255Q16.252296630859377,6.218575087890625,16.502896630859375,6.521315087890625Q16.755196630859373,6.822415087890625,17.114896630859377,6.822415087890625Q17.368796630859375,6.822415087890625,17.588596630859374,6.625475087890624Q17.809896630859377,6.428535087890625,17.998696630859374,6.0688350878906245Q18.249396630859373,6.439935087890625,18.488596630859377,6.631985087890625Q18.727896630859377,6.822415087890625,18.952496630859375,6.822415087890625Q19.326796630859373,6.822415087890625,19.596996630859376,6.482245087890625Q19.868796630859375,6.140455087890626,19.868796630859375,5.671705087890626Q19.868796630859375,5.238755087890625,19.618196630859376,4.937655087890625Q19.367496630859375,4.634915087890625,19.006196630859375,4.634915087890625Q18.750696630859377,4.634915087890625,18.529296630859378,4.8318550878906255ZM18.337296630859377,5.674955087890625L18.278696630859375,5.596835087890625Q18.449596630859375,5.272935087890625,18.622096630859374,5.1101750878906245Q18.794596630859374,4.947415087890625,18.967096630859373,4.947415087890625Q19.194996630859375,4.947415087890625,19.346396630859374,5.1345950878906255Q19.497696630859377,5.320135087890625,19.497696630859377,5.598455087890625Q19.497696630859377,5.8914250878906245,19.360996630859376,6.096505087890625Q19.224296630859374,6.301585087890626,19.027396630859375,6.301585087890626Q18.915096630859374,6.301585087890626,18.742496630859375,6.146965087890624Q18.569996630859375,5.992335087890625,18.337296630859377,5.674955087890625ZM17.785496630859377,5.779125087890625L17.842496630859372,5.857245087890625Q17.668296630859373,6.186025087890625,17.495796630859374,6.348785087890625Q17.324896630859374,6.509915087890625,17.153996630859375,6.509915087890625Q16.926096630859377,6.509915087890625,16.774796630859377,6.324375087890624Q16.623396630859375,6.137195087890625,16.623396630859375,5.858875087890625Q16.623396630859375,5.565905087890625,16.761696630859376,5.360825087890625Q16.900096630859373,5.1557550878906255,17.095396630859376,5.1557550878906255Q17.228896630859374,5.1557550878906255,17.365596630859375,5.2778250878906245Q17.502296630859377,5.399895087890625,17.785496630859377,5.779125087890625ZM10.710296630859375,10.634915087890626C10.710296630859375,11.024655087890626,10.561656630859375,11.379685087890625,10.317976630859375,11.646395087890625L12.879196630859376,15.171615087890626C12.985696630859374,15.147615087890625,13.096496630859376,15.134915087890626,13.210296630859375,15.134915087890626C13.306796630859376,15.134915087890626,13.401096630859374,15.144015087890624,13.492596630859374,15.161415087890624L16.819096630859377,11.196955087890625C16.748996630859374,11.023375087890624,16.710296630859375,10.833655087890625,16.710296630859375,10.634915087890626C16.710296630859375,9.806495087890625,17.381896630859373,9.134915087890626,18.210296630859375,9.134915087890626C19.038696630859373,9.134915087890626,19.710296630859375,9.806495087890625,19.710296630859375,10.634915087890626C19.710296630859375,11.463345087890625,19.038696630859373,12.134915087890626,18.210296630859375,12.134915087890626C17.949796630859375,12.134915087890626,17.704796630859377,12.068505087890625,17.491296630859374,11.951675087890624L14.364996630859375,15.677415087890624C14.580596630859375,15.937215087890625,14.710296630859375,16.270915087890625,14.710296630859375,16.634915087890626C14.710296630859375,17.463315087890624,14.038696630859375,18.134915087890626,13.210296630859375,18.134915087890626C12.381866630859374,18.134915087890626,11.710296630859375,17.463315087890624,11.710296630859375,16.634915087890626C11.710296630859375,16.284415087890626,11.830486630859374,15.962015087890626,12.031896630859375,15.706715087890625L9.425686630859374,12.119565087890624C9.355346630859376,12.129685087890625,9.283436630859375,12.134915087890626,9.210296630859375,12.134915087890626C8.872396630859374,12.134915087890626,8.560596630859376,12.023195087890626,8.309816630859375,11.834665087890626L5.215876630859375,15.521915087890624C5.519506630859375,15.796415087890624,5.710296630859375,16.193415087890624,5.710296630859375,16.634915087890626C5.710296630859375,17.463315087890624,5.038726630859375,18.134915087890626,4.210296630859375,18.134915087890626C3.381869630859375,18.134915087890626,2.710296630859375,17.463315087890624,2.710296630859375,16.634915087890626C2.710296630859375,15.806515087890626,3.381869630859375,15.134915087890626,4.210296630859375,15.134915087890626C4.218546630859375,15.134915087890626,4.226776630859375,15.135015087890626,4.234996630859375,15.135115087890625L7.744116630859375,10.953115087890625C7.721966630859375,10.850565087890626,7.710296630859375,10.744105087890624,7.710296630859375,10.634915087890626C7.710296630859375,9.806495087890625,8.381866630859374,9.134915087890626,9.210296630859375,9.134915087890626C10.038726630859376,9.134915087890626,10.710296630859375,9.806495087890625,10.710296630859375,10.634915087890626Z" stroke-opacity="0" stroke="none"></path>'),dI=qn('<path d="M17.0643,7.033864912109375L18,3.585784912109375L14.5078,4.509695912109375L15.3537,5.344934912109375L6.02026,14.560584912109375C5.87635,14.517484912109374,5.72366,14.494284912109375,5.5655,14.494284912109375C4.7009,14.494284912109375,4,15.186384912109375,4,16.040084912109375C4,16.893784912109375,4.7009,17.585784912109375,5.5655,17.585784912109375C6.43011,17.585784912109375,7.13101,16.893784912109375,7.13101,16.040084912109375C7.13101,15.722284912109375,7.03392,15.426984912109376,6.86744,15.181384912109374L16.0917,6.073604912109375L17.0643,7.033864912109375Z" stroke-opacity="0" stroke="none"></path>'),uI=qn('<g transform="scale(0.7857142857)" fill="none"><path stroke="currentColor" d="M16 14a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4.5 14a9.5 9.5 0 0 1 18.7-2.37 2.5 2.5 0 0 0 0 4.74A9.5 9.5 0 0 1 4.5 14Zm19.7 2.5a10.5 10.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"></path><path fill="currentColor" d="M22.5 14a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></g>'),pI=qn('<path d="M18.8532,7.020985087890625Q19.0257,6.734525087890625,19.0257,6.369945087890625Q19.0257,6.020005087890625,18.8499,5.754705087890625Q18.6758,5.489415087890626,18.3649,5.339675087890625Q18.5944,5.209465087890625,18.7214,4.994615087890625Q18.8499,4.779775087890625,18.8499,4.5193550878906255Q18.8499,4.2003480878906245,18.7002,3.951324087890625Q18.5505,3.700673087890625,18.277,3.557444087890625Q18.0052,3.414215087890625,17.6455,3.414215087890625Q17.285800000000002,3.414215087890625,17.0107,3.557444087890625Q16.7357,3.700673087890625,16.5843,3.951324087890625Q16.4346,4.2003480878906245,16.4346,4.5193550878906255Q16.4346,4.779775087890625,16.561500000000002,4.994615087890625Q16.6901,5.209465087890625,16.919600000000003,5.339675087890625Q16.6055,5.489415087890626,16.4297,5.757965087890625Q16.255499999999998,6.024895087890625,16.255499999999998,6.369945087890625Q16.255499999999998,6.734525087890625,16.4297,7.020985087890625Q16.6055,7.305815087890625,16.919600000000003,7.465325087890625Q17.2354,7.624825087890625,17.6455,7.624825087890625Q18.0557,7.624825087890625,18.3682,7.465325087890625Q18.6807,7.305815087890625,18.8532,7.020985087890625ZM8.76432,7.559725087890625L8.13444,7.559725087890625L8.13444,4.214996087890625L7.28971,4.700025087890625L7.2946,4.070139087890625L8.310220000000001,3.479319087890625L8.76432,3.479319087890625L8.76432,7.559725087890625ZM17.1816,4.955555087890625Q17.0042,4.784655087890625,17.0042,4.5095950878906255Q17.0042,4.229645087890625,17.18,4.057119087890625Q17.355800000000002,3.884592087890625,17.6455,3.884592087890625Q17.935200000000002,3.884592087890625,18.1077,4.057119087890625Q18.2803,4.229645087890625,18.2803,4.5095950878906255Q18.2803,4.784655087890625,18.1045,4.955555087890625Q17.930300000000003,5.124825087890625,17.6455,5.124825087890625Q17.3607,5.124825087890625,17.1816,4.955555087890625ZM18.2217,5.7953950878906255Q18.4398,6.005365087890625,18.4398,6.3552950878906245Q18.4398,6.705235087890625,18.2217,6.915195087890625Q18.0052,7.125155087890625,17.6455,7.125155087890625Q17.285800000000002,7.125155087890625,17.067700000000002,6.915195087890625Q16.849600000000002,6.705235087890625,16.849600000000002,6.3552950878906245Q16.849600000000002,6.005365087890625,17.064500000000002,5.7953950878906255Q17.2793,5.585435087890625,17.6455,5.585435087890625Q18.0052,5.585435087890625,18.2217,5.7953950878906255ZM9.60768,11.711495087890626C9.85136,11.444785087890626,10,11.089765087890626,10,10.700025087890625C10,9.871595087890626,9.32843,9.200025087890625,8.5,9.200025087890625C7.67157,9.200025087890625,7,9.871595087890626,7,10.700025087890625C7,10.809205087890625,7.01167,10.915665087890625,7.03382,11.018215087890624L3.5247,15.200215087890625C3.51648,15.200115087890625,3.5082500000000003,15.200015087890625,3.5,15.200015087890625C2.671573,15.200015087890625,2,15.871615087890625,2,16.700015087890627C2,17.528415087890625,2.671573,18.200015087890627,3.5,18.200015087890627C4.32843,18.200015087890627,5,17.528415087890625,5,16.700015087890627C5,16.258515087890625,4.80921,15.861515087890625,4.50558,15.587015087890626L7.59952,11.899765087890625C7.8503,12.088295087890625,8.162099999999999,12.200025087890625,8.5,12.200025087890625C8.57314,12.200025087890625,8.645050000000001,12.194785087890626,8.71539,12.184675087890625L11.3216,15.771815087890625C11.12019,16.027215087890625,11,16.349515087890623,11,16.700015087890627C11,17.528415087890625,11.67157,18.200015087890627,12.5,18.200015087890627C13.3284,18.200015087890627,14,17.528415087890625,14,16.700015087890627C14,16.336015087890623,13.8703,16.002315087890626,13.6547,15.742515087890625L16.781,12.016775087890625C16.994500000000002,12.133605087890626,17.2395,12.200025087890625,17.5,12.200025087890625C18.3284,12.200025087890625,19,11.528445087890624,19,10.700025087890625C19,9.871595087890626,18.3284,9.200025087890625,17.5,9.200025087890625C16.671599999999998,9.200025087890625,16,9.871595087890626,16,10.700025087890625C16,10.898765087890624,16.0387,11.088475087890625,16.108800000000002,11.262055087890625L12.7823,15.226515087890625C12.6908,15.209115087890625,12.5965,15.200015087890625,12.5,15.200015087890625C12.3862,15.200015087890625,12.2754,15.212715087890626,12.1689,15.236715087890625L9.60768,11.711495087890626Z" stroke-opacity="0" stroke="none"></path>'),vI=qn('<ellipse cx="10.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="17.5" cy="11.5" rx="1.5" ry="1.5" stroke-opacity="0" stroke="none"></ellipse><ellipse cx="10.5" cy="11.5" rx="7" ry="7" fill="none" stroke="currentColor" stroke-width="0.5"></ellipse><ellipse cx="10.5" cy="11.5" rx="5" ry="5" fill="none" stroke="currentColor" stroke-width="0.5"></ellipse><ellipse cx="10.5" cy="11.5" rx="3" ry="3" fill="none" stroke="currentColor" stroke-width="0.5"></ellipse>',1),fI=qn('<path d="M17,4.5C17,5.32843,16.328400000000002,6,15.5,6C15.0931,6,14.7241,5.83802,14.4539,5.57503L5.98992,8.32515C5.99658,8.38251,6,8.440850000000001,6,8.5C6,9.15311,5.582599999999999,9.70873,5,9.91465L5,11.08535C5.42621,11.236,5.763999999999999,11.57379,5.91465,12L19.5,12C19.7761,12,20,12.22386,20,12.5C20,12.77614,19.7761,13,19.5,13L5.91465,13C5.70873,13.5826,5.15311,14,4.5,14C3.671573,14,3,13.3284,3,12.5C3,11.84689,3.417404,11.29127,4,11.08535L4,9.91465C3.417404,9.70873,3,9.15311,3,8.5C3,7.67157,3.671573,7,4.5,7C4.90411,7,5.2709,7.15981,5.5406200000000005,7.41967L14.0093,4.66802C14.0032,4.6128599999999995,14,4.5568,14,4.5C14,3.671573,14.6716,3,15.5,3C16.328400000000002,3,17,3.671573,17,4.5ZM4,15.5C4,15.2239,4.22386,15,4.5,15L19.5,15C19.7761,15,20,15.2239,20,15.5C20,15.7761,19.7761,16,19.5,16L4.5,16C4.22386,16,4,15.7761,4,15.5ZM4,18.5C4,18.2239,4.22386,18,4.5,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L4.5,19C4.22386,19,4,18.7761,4,18.5Z" stroke-opacity="0" stroke="none"></path>'),gI=qn('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M21 15H3a1 1 0 0 1 0-2h18a1 1 0 0 1 0 2Zm-2-3a2.99 2.99 0 0 1-2.816-2H3a1 1 0 0 1 0-2h13.184A2.995 2.995 0 1 1 19 12Zm0-4a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm2-3H3a1 1 0 0 1 0-2h18a1 1 0 1 1 0 2ZM5 16a2.99 2.99 0 0 1 2.816 2H21a1 1 0 0 1 0 2H7.816A2.995 2.995 0 1 1 5 16Zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path></g>'),mI=qn('<path d="M4,17.0854L4,3.5C4,3.223858,4.22386,3,4.5,3C4.77614,3,5,3.223858,5,3.5L5,10L7.57584,10L9.8127,4.46359C9.91614,4.20756,10.20756,4.08386,10.46359,4.1873000000000005C10.71963,4.29075,10.84333,4.58216,10.73988,4.8382000000000005L8.65438,10L11.08535,10C11.29127,9.4174,11.84689,9,12.5,9C12.65154,9,12.79784,9.02247,12.93573,9.06427L16.6464,5.35355C16.8417,5.15829,17.1583,5.15829,17.3536,5.35355C17.5488,5.54882,17.5488,5.8654,17.3536,6.06066L13.7475,9.66675C13.907,9.90508,14,10.19168,14,10.5C14,11.15311,13.5826,11.70873,13,11.91465L13,14.3638L18.3714,12.1936C18.6274,12.09015,18.918799999999997,12.21385,19.0222,12.46989C19.1257,12.72592,19.002,13.0173,18.746000000000002,13.1208L13,15.4423L13,18L19.5,18C19.7761,18,20,18.2239,20,18.5C20,18.7761,19.7761,19,19.5,19L5.91465,19C5.70873,19.5826,5.15311,20,4.5,20C3.671573,20,3,19.3284,3,18.5C3,17.846899999999998,3.417404,17.2913,4,17.0854ZM6.3729499999999994,17.0413L12,14.7678L12,11.91465C11.88136,11.87271,11.76956,11.81627,11.66675,11.74746L6.3729499999999994,17.0413ZM12,15.8463L6.6694700000000005,18L12,18L12,15.8463ZM6.38629,15.6137L8.250350000000001,11L11,11L6.38629,15.6137ZM5,11L7.17182,11L5,16.3754L5,11Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),hI=qn('<path d="M3,7.32468C5.90649,3.3893050000000002,11.49833,2.81306,14.6674,6.31944C14.9056,6.1554199999999994,15.192,6.05979,15.5,6.05979C15.845,6.05979,16.1628,6.17974,16.4162,6.381349999999999L18.4509,4.23827L19,4.816615L16.8945,7.03429C16.962600000000002,7.21075,17,7.40319,17,7.60463C17,8.45782,16.328400000000002,9.14947,15.5,9.14947C14.6716,9.14947,14,8.45782,14,7.60463C14,7.36402,14.0534,7.13625,14.1487,6.93322C11.32695,3.748365,6.25159,4.253956,3.612785,7.82695L3,7.32468ZM14.09,15.4717C15.7427,13.78985,16.244500000000002,11.524740000000001,15.5633,9.30134L15.5618,9.30134L16.3012,9.0502C17.072400000000002,11.56646,16.497700000000002,14.158,14.6282,16.0599C12.28737,18.442,8.62386,18.6988,6.41348,16.4501C4.5526,14.5572,4.52076,11.19671,6.36766,9.3177C7.89069,7.76754,10.07544,7.706189999999999,11.56741,9.22363C11.95453,9.61742,12.24817,10.08363,12.43369,10.57677L14.1451,8.77421L14.6942,9.35256L12.64982,11.50582C12.65827,11.59712,12.66295,11.68839,12.66378,11.77936C12.87398,12.04523,13,12.38451,13,12.7541C13,13.60729,12.32843,14.2989,11.5,14.2989C10.67157,14.2989,10,13.60729,10,12.7541C10,11.90091,10.67157,11.20926,11.5,11.20926C11.60387,11.20926,11.70528,11.220130000000001,11.8032,11.240829999999999L11.81763,11.22564C11.69858,10.71874,11.42858,10.21929,11.0284,9.81179C9.844000000000001,8.60765,8.136890000000001,8.65592,6.90822,9.90586C5.37975,11.460930000000001,5.40693,14.288,6.95404,15.8619C8.84598,17.7867,12.03496,17.5626,14.09,15.4717Z" stroke-opacity="0" stroke="none"></path>'),_I=qn('<path d="M8.13444,7.494615087890625L8.76432,7.494615087890625L8.76432,3.414215087890625L8.310220000000001,3.414215087890625L7.2946,4.005035087890625L7.28971,4.634915087890625L8.13444,4.149892087890625L8.13444,7.494615087890625ZM18.832,6.929835087890625Q19.0046,6.635245087890625,19.0046,6.2543850878906255Q19.0046,5.889805087890625,18.8451,5.5952050878906245Q18.6855,5.3006050878906255,18.3975,5.132965087890625Q18.1094,4.9653250878906245,17.7399,4.9653250878906245Q17.435499999999998,4.9653250878906245,17.1556,5.149245087890625L17.2793,3.939931087890625L18.8304,3.939931087890625L18.8304,3.414215087890625L16.7406,3.414215087890625L16.5094,5.665195087890625L17.0156,5.795405087890625Q17.095399999999998,5.655425087890626,17.2516,5.570795087890625Q17.4095,5.484525087890625,17.6357,5.484525087890625Q17.9694,5.484525087890625,18.1842,5.697745087890625Q18.4007,5.909335087890625,18.4007,6.2543850878906255Q18.4007,6.604315087890625,18.1842,6.822415087890625Q17.9694,7.0405150878906255,17.6292,7.0405150878906255Q17.3298,7.0405150878906255,17.119799999999998,6.890775087890625Q16.9098,6.739415087890626,16.825200000000002,6.474115087890625L16.3597,6.749175087890626Q16.470399999999998,7.110505087890624,16.807299999999998,7.335115087890625Q17.144199999999998,7.559725087890625,17.6292,7.559725087890625Q18.0296,7.559725087890625,18.3438,7.392075087890625Q18.6595,7.224435087890625,18.832,6.929835087890625ZM10,10.634915087890626C10,11.024655087890626,9.85136,11.379685087890625,9.60768,11.646395087890625L12.1689,15.171615087890626C12.2754,15.147615087890625,12.3862,15.134915087890626,12.5,15.134915087890626C12.5965,15.134915087890626,12.6908,15.144015087890624,12.7823,15.161415087890624L16.108800000000002,11.196955087890625C16.0387,11.023375087890624,16,10.833655087890625,16,10.634915087890626C16,9.806495087890625,16.671599999999998,9.134915087890626,17.5,9.134915087890626C18.3284,9.134915087890626,19,9.806495087890625,19,10.634915087890626C19,11.463345087890625,18.3284,12.134915087890626,17.5,12.134915087890626C17.2395,12.134915087890626,16.994500000000002,12.068505087890625,16.781,11.951675087890624L13.6547,15.677415087890624C13.8703,15.937215087890625,14,16.270915087890625,14,16.634915087890626C14,17.463315087890624,13.3284,18.134915087890626,12.5,18.134915087890626C11.67157,18.134915087890626,11,17.463315087890624,11,16.634915087890626C11,16.284415087890626,11.12019,15.962015087890626,11.3216,15.706715087890625L8.71539,12.119565087890624C8.645050000000001,12.129685087890625,8.57314,12.134915087890626,8.5,12.134915087890626C8.162099999999999,12.134915087890626,7.8503,12.023195087890626,7.59952,11.834665087890626L4.50558,15.521915087890624C4.80921,15.796415087890624,5,16.193415087890624,5,16.634915087890626C5,17.463315087890624,4.32843,18.134915087890626,3.5,18.134915087890626C2.671573,18.134915087890626,2,17.463315087890624,2,16.634915087890626C2,15.806515087890626,2.671573,15.134915087890626,3.5,15.134915087890626C3.5082500000000003,15.134915087890626,3.51648,15.135015087890626,3.5247,15.135115087890625L7.03382,10.953115087890625C7.01167,10.850565087890626,7,10.744105087890624,7,10.634915087890626C7,9.806495087890625,7.67157,9.134915087890626,8.5,9.134915087890626C9.32843,9.134915087890626,10,9.806495087890625,10,10.634915087890626Z" stroke-opacity="0" stroke="none"></path>'),yI=qn('<path d="M20,3.5C20,4.15311,19.5826,4.70873,19,4.91465L19,18.5C19,18.7761,18.7761,19,18.5,19L4.91465,19C4.70873,19.5826,4.15311,20,3.5,20C2.671573,20,2,19.3284,2,18.5C2,17.846899999999998,2.417404,17.2913,3,17.0854L3,3.5C3,3.22386,3.22386,3,3.5,3L17.0854,3C17.2913,2.417404,17.846899999999998,2,18.5,2C19.3284,2,20,2.671573,20,3.5ZM17.0854,4C17.236,4.42621,17.5738,4.763999999999999,18,4.91465L18,8L14,8L14,4L17.0854,4ZM13,4L13,8L9,8L9,4L13,4ZM13,9L9,9L9,13L13,13L13,9ZM13,14L9,14L9,18L13,18L13,14ZM14,18L14,14L18,14L18,18L14,18ZM18,13L14,13L14,9L18,9L18,13ZM4.91465,18C4.763999999999999,17.5738,4.42621,17.236,4,17.0854L4,14L8,14L8,18L4.91465,18ZM4,8L4,4L8,4L8,8L4,8ZM8,9L8,13L4,13L4,9L8,9Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),bI=qn('<path d="M6.91465,11L11.08535,11C11.29127,10.417404,11.84689,10,12.5,10C13.15311,10,13.70873,10.417404,13.91465,11L18.5,11C18.7761,11,19,11.22386,19,11.5C19,11.77614,18.7761,12,18.5,12L13.91465,12C13.70873,12.5826,13.15311,13,12.5,13C11.84689,13,11.29127,12.5826,11.08535,12L6.91465,12C6.70873,12.5826,6.15311,13,5.5,13C4.671573,13,4,12.32843,4,11.5C4,10.671573,4.671573,10,5.5,10C6.15311,10,6.70873,10.417404,6.91465,11Z" stroke-opacity="0" stroke="none"></path>'),xI=qn('<path d="M6.91465,12.5C6.70873,13.0826,6.15311,13.5,5.5,13.5C4.671573,13.5,4,12.82843,4,12C4,11.171573,4.671573,10.5,5.5,10.5C6.15311,10.5,6.70873,10.917404,6.91465,11.5L16.0853,11.5C16.2913,10.917404,16.846899999999998,10.5,17.5,10.5C18.328400000000002,10.5,19,11.171573,19,12C19,12.82843,18.328400000000002,13.5,17.5,13.5C16.846899999999998,13.5,16.2913,13.0826,16.0853,12.5L6.91465,12.5Z" stroke-opacity="0" stroke="none"></path>'),wI=qn('<path d="M5.80417,14.9887L4.62563,16.167299999999997C4.43037,16.3625,4.43037,16.6791,4.62563,16.8744C4.82089,17.0696,5.13748,17.0696,5.332739999999999,16.8744L6.62638,15.5807C7.75595,16.290100000000002,9.19328,16.7929,11,16.7929C16.165399999999998,16.7929,18.3323,12.64289,18.8866,11.36789C19.0378,10.99289,19.0378,10.59289,18.8866,10.21789C18.5549,9.45486,17.6456,7.66212,15.8617,6.34545L17.3536,4.853553C17.5488,4.658291,17.5488,4.341709,17.3536,4.146447C17.1583,3.9511845,16.8417,3.9511845,16.6464,4.146447L15.0014,5.7915399999999995C13.9314,5.1969,12.61166,4.792893,11,4.792893C5.80945,4.792893,3.667717,8.94289,3.113386,10.21789C2.9622049,10.59289,2.9622049,10.99289,3.113386,11.36789C3.424435,12.08333,4.2353000000000005,13.70399,5.80417,14.9887ZM7.36012,14.847C8.32327,15.4074,9.52286,15.7929,11,15.7929C15.5606,15.7929,17.4756,12.11789,17.9543,10.99289C18.0047,10.86789,18.0047,10.74289,17.9543,10.61789C17.659,9.90846,16.8171,8.23812,15.1447,7.06241L12.96929,9.23782C13.3134,9.66543,13.5197,10.20642,13.5197,10.79289C13.5197,12.16789,12.38583,13.29289,11,13.29289C10.41596,13.29289,9.87667,13.09308,9.44815,12.75896L7.36012,14.847ZM8.794609999999999,11.99829L6.520099999999999,14.2728C5.06905,13.12119,4.32057,11.628250000000001,4.04567,10.96789C3.995275,10.84289,3.995275,10.71789,4.04567,10.59289C4.52441,9.46789,6.43937,5.79289,11,5.79289C12.28868,5.79289,13.3661,6.086320000000001,14.2596,6.53329L12.19759,8.5953C11.84086,8.40257,11.43271,8.29289,11,8.29289C9.61417,8.29289,8.480319999999999,9.41789,8.480319999999999,10.79289C8.480319999999999,11.22918,8.594470000000001,11.64029,8.794609999999999,11.99829ZM10.16528,12.04183C10.404869999999999,12.20032,10.692070000000001,12.29289,11,12.29289C11.8315,12.29289,12.51181,11.61789,12.51181,10.79289C12.51181,10.48318,12.41593,10.194600000000001,12.25216,9.95494L10.16528,12.04183ZM11.43602,9.35687L9.55616,11.236740000000001C9.512,11.09633,9.48819,10.94724,9.48819,10.79289C9.48819,9.96789,10.1685,9.29289,11,9.29289C11.15142,9.29289,11.29782,9.31528,11.43602,9.35687Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),kI=qn('<path d="M11,17C5.80945,17,3.667717,12.85,3.113386,11.575C2.9622047,11.2,2.9622047,10.8,3.113386,10.425C3.667717,9.15,5.80945,5,11,5C16.165399999999998,5,18.3323,9.15,18.8866,10.425C19.0378,10.8,19.0378,11.2,18.8866,11.575C18.3323,12.85,16.165399999999998,17,11,17ZM4.04567,10.8C3.995276,10.925,3.995276,11.05,4.04567,11.175C4.52441,12.325,6.43937,16,11,16C15.5606,16,17.4756,12.325,17.9543,11.2C18.0047,11.075,18.0047,10.95,17.9543,10.825C17.4756,9.675,15.5606,6,11,6C6.43937,6,4.52441,9.675,4.04567,10.8ZM11,13.5C9.61417,13.5,8.480319999999999,12.375,8.480319999999999,11C8.480319999999999,9.625,9.61417,8.5,11,8.5C12.38583,8.5,13.5197,9.625,13.5197,11C13.5197,12.375,12.38583,13.5,11,13.5ZM11,9.5C10.1685,9.5,9.48819,10.175,9.48819,11C9.48819,11.825,10.1685,12.5,11,12.5C11.8315,12.5,12.51181,11.825,12.51181,11C12.51181,10.175,11.8315,9.5,11,9.5Z" fill-opacity="1" stroke="currentColor" stroke-width="1"></path>'),SI=qn('<defs><clipPath id="master_svg0_151_625"><rect x="0" y="0" width="22" height="22" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_151_625)"><path d="M14.5385,9.76923L15.6538,9.76923C16.6538,9.76923,17.4615,10.576920000000001,17.4615,11.576920000000001L17.4615,17.1923C17.4615,18.1923,16.6538,19,15.6538,19L5.80769,19C4.807692,19,4,18.1923,4,17.1923L4,11.576920000000001C4,10.576920000000001,4.807692,9.76923,5.80769,9.76923L7.23077,9.76923L7.23077,7.576919999999999C7.23077,5.61538,8.88462,4,10.88462,4C12.88462,4,14.5385,5.61538,14.5385,7.576919999999999L14.5385,9.76923ZM10.88461,5.15385C9.5,5.15385,8.38461,6.23077,8.38461,7.576919999999999L8.38461,9.76923L13.38462,9.76923L13.38462,7.576919999999999C13.38462,6.23077,12.26923,5.15385,10.88461,5.15385ZM15.6538,17.8462C16,17.8462,16.3077,17.5385,16.3077,17.1923L16.3077,11.576920000000001C16.3077,11.23077,16,10.923079999999999,15.6538,10.923079999999999L5.80769,10.923079999999999C5.46154,10.923079999999999,5.15385,11.23077,5.15385,11.576920000000001L5.15385,17.1923C5.15385,17.5385,5.46154,17.8462,5.80769,17.8462L15.6538,17.8462ZM10.153839999999999,12.65385C10.153839999999999,12.34615,10.42307,12.07692,10.73076,12.07692C11.038450000000001,12.07692,11.307680000000001,12.34615,11.307680000000001,12.65385L11.307680000000001,14.5769C11.307680000000001,14.8846,11.038450000000001,15.1538,10.73076,15.1538C10.42307,15.1538,10.153839999999999,14.8846,10.153839999999999,14.5769L10.153839999999999,12.65385Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></g>',1),CI=qn('<path d="M19.6401,7.99355C20.4028,7.92291,21,7.2811900000000005,21,6.5C21,5.671573,20.3284,5,19.5,5C18.8469,5,18.2913,5.417404,18.0854,6L7.62067,6C7.34453,6,7.12067,6.22386,7.12067,6.5C7.12067,6.5479,7.12741,6.59423,7.13999,6.63809L3.2294099999999997,15.0243C2.530138,15.1517,2,15.764,2,16.5C2,17.328400000000002,2.671573,18,3.5,18C4.15311,18,4.70873,17.5826,4.91465,17L14.5963,17C14.6456,17.076,14.7162,17.1396,14.8044,17.1807C15.0546,17.2974,15.3521,17.1891,15.4688,16.9388L19.6401,7.99355ZM14.7896,16.0293L18.6551,7.739599999999999C18.3942,7.56144,18.1925,7.30307,18.0854,7L8.0746,7L4.25044,15.2009C4.55701,15.3784,4.79493,15.6613,4.91465,16L14.6207,16C14.68,16,14.7368,16.0103,14.7896,16.0293Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),PI=qn('<path d="M3.3367688759765626,12.63173C3.5320318759765623,12.82699,3.8486138759765627,12.82699,4.043876875976562,12.63173L11.822052875976562,4.853553C12.017312875976563,4.658291,12.017312875976563,4.341708,11.822052875976562,4.146446C11.626792875976562,3.9511843,11.310202875976563,3.9511843,11.114942875976563,4.146446L3.3367688759765626,11.92462C3.1415071759765625,12.11988,3.1415071759765625,12.43647,3.3367688759765626,12.63173ZM5.001492875976562,17.0351C4.806232875976562,16.8399,4.806232875976562,16.5233,5.001492875976562,16.328L7.304532875976562,14.025C7.210822875976563,13.82916,7.158352875976563,13.60984,7.158352875976563,13.37827C7.158352875976563,12.54984,7.829922875976562,11.87827,8.658352875976561,11.87827C8.889922875976563,11.87827,9.109232875976563,11.93075,9.305052875976562,12.02446L11.304532875976562,10.02498C11.210822875976563,9.82916,11.158352875976561,9.60984,11.158352875976561,9.37827C11.158352875976561,8.54984,11.829922875976562,7.8782700000000006,12.658352875976563,7.8782700000000006C12.889922875976563,7.8782700000000006,13.109232875976563,7.93075,13.305022875976562,8.024460000000001L15.608122875976562,5.72142C15.803322875976562,5.5261499999999995,16.119922875976563,5.5261499999999995,16.315222875976563,5.72142C16.510422875976563,5.9166799999999995,16.510422875976563,6.23326,16.315222875976563,6.42852L14.012122875976562,8.73156C14.105822875976562,8.92738,14.158322875976562,9.1467,14.158322875976562,9.37827C14.158322875976562,10.2067,13.486822875976562,10.87827,12.658352875976563,10.87827C12.426772875976562,10.87827,12.207452875976562,10.82579,12.011642875976563,10.73209L10.012162875976562,12.73156C10.105872875976562,12.92738,10.158352875976561,13.1467,10.158352875976561,13.37827C10.158352875976561,14.2067,9.486772875976563,14.8783,8.658352875976561,14.8783C8.426772875976562,14.8783,8.207452875976562,14.8258,8.011642875976563,14.7321L5.708602875976562,17.0351C5.513342875976562,17.2304,5.196752875976562,17.2304,5.001492875976562,17.0351ZM10.415712875976563,18.328C10.220452875976562,18.5233,9.903862875976563,18.5233,9.708602875976563,18.328C9.513342875976562,18.1328,9.513342875976562,17.816200000000002,9.708602875976563,17.6209L12.304532875976562,15.025C12.210822875976563,14.8292,12.158352875976563,14.6098,12.158352875976563,14.3783C12.158352875976563,13.54984,12.829922875976562,12.87827,13.658322875976562,12.87827C13.889922875976563,12.87827,14.109222875976563,12.93075,14.305022875976562,13.02446L17.486822875976564,9.84274C17.682022875976564,9.64747,17.99862287597656,9.64747,18.19392287597656,9.84274C18.38912287597656,10.038,18.38912287597656,10.35458,18.19392287597656,10.54984L15.012122875976562,13.73156C15.105822875976562,13.92738,15.158322875976562,14.1467,15.158322875976562,14.3783C15.158322875976562,15.2067,14.486822875976562,15.8783,13.658322875976562,15.8783C13.426822875976562,15.8783,13.207422875976562,15.8258,13.011642875976563,15.7321L10.415712875976563,18.328Z" stroke-opacity="0" stroke="none"></path>'),II=qn('<path d="M3.146447,14.178126025390625C2.9511847,13.982826025390626,2.9511847,13.666226025390625,3.146447,13.470926025390625L7.39146,9.225966025390626C7.35417,9.095106025390624,7.33421,8.956946025390625,7.33421,8.814116025390625C7.33421,7.985696025390625,8.00578,7.314116025390625,8.834209999999999,7.314116025390625C8.97703,7.314116025390625,9.11519,7.334086025390625,9.24605,7.371366025390625L13.753,2.864373025390625C13.9483,2.669110325390625,14.2649,2.669110325390625,14.4602,2.864373025390625C14.6554,3.059635025390625,14.6554,3.376217025390625,14.4602,3.571479025390625L10.06916,7.962476025390625C10.23631,8.204386025390626,10.334209999999999,8.497826025390625,10.334209999999999,8.814116025390625C10.334209999999999,9.642546025390626,9.66264,10.314116025390625,8.834209999999999,10.314116025390625C8.51791,10.314116025390625,8.22448,10.216226025390625,7.98256,10.049076025390626L3.853554,14.178126025390625C3.658291,14.373326025390625,3.341709,14.373326025390625,3.146447,14.178126025390625ZM7.67736,19.188526025390626C7.4821,18.993226025390626,7.4821,18.676626025390625,7.67736,18.481426025390626L9.9804,16.178326025390625C9.88669,15.982526025390625,9.834209999999999,15.763226025390624,9.834209999999999,15.531626025390626C9.834209999999999,14.703226025390626,10.50578,14.031626025390626,11.33421,14.031626025390626C11.56579,14.031626025390626,11.78511,14.084126025390624,11.98093,14.177826025390624L13.9804,12.178356025390626C13.8867,11.982536025390624,13.8342,11.763216025390625,13.8342,11.531636025390625C13.8342,10.703206025390624,14.5058,10.031636025390625,15.3342,10.031636025390625C15.5658,10.031636025390625,15.7851,10.084116025390625,15.9809,10.177826025390626L18.284,7.874796025390625C18.4792,7.679536025390625,18.7958,7.679536025390625,18.9911,7.874796025390625C19.1863,8.070056025390624,19.1863,8.386636025390626,18.9911,8.581906025390625L16.688000000000002,10.884936025390624C16.7817,11.080756025390626,16.8342,11.300066025390626,16.8342,11.531636025390625C16.8342,12.360066025390624,16.162599999999998,13.031626025390626,15.3342,13.031626025390626C15.1026,13.031626025390626,14.8833,12.979126025390626,14.6875,12.885426025390625L12.68803,14.884926025390625C12.78174,15.080726025390625,12.83421,15.300026025390626,12.83421,15.531626025390626C12.83421,16.360026025390624,12.16264,17.031626025390626,11.33421,17.031626025390626C11.10264,17.031626025390626,10.88333,16.979126025390627,10.68751,16.885426025390625L8.38446,19.188526025390626C8.1892,19.383726025390626,7.87262,19.383726025390626,7.67736,19.188526025390626Z" stroke-opacity="0" stroke="none"></path>'),MI=qn('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="m2.285 10.333 8.048-8.048a.977.977 0 1 1 1.381 1.381l-8.048 8.049a.977.977 0 0 1-1.381-1.382Zm10 10 8.048-8.048a.977.977 0 1 1 1.381 1.381l-8.048 8.049a.977.977 0 0 1-1.381-1.382ZM19 8a2.966 2.966 0 0 1-1.308-.312l-10 10c.202.408.307.857.308 1.312a3.03 3.03 0 1 1-1.693-2.689l10-10A2.993 2.993 0 1 1 19 8ZM5 18a1 1 0 1 0 0 2 1 1 0 0 0 0-2ZM19 4a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"></path></g>'),TI=qn('<path d="M6.91465,13.00505L18.5,13.00505C18.7761,13.00505,19,13.228909999999999,19,13.50505C19,13.781189999999999,18.7761,14.00505,18.5,14.00505L6.91465,14.00505C6.70873,14.58765,6.15311,15.00505,5.5,15.00505C4.671573,15.00505,4,14.33348,4,13.50505C4,12.67662,4.671573,12.00505,5.5,12.00505C6.15311,12.00505,6.70873,12.422450000000001,6.91465,13.00505ZM7.81404,11.625L10.48591,11.625L10.48591,10.90625L9.65193,10.90625L9.65193,7.125L8.997630000000001,7.125C8.71443,7.306641,8.415600000000001,7.419922,7.96443,7.498047L7.96443,8.05078L8.77497,8.05078L8.77497,10.90625L7.81404,10.90625L7.81404,11.625ZM11.081620000000001,11.625L14.0562,11.625L14.0562,10.88281L13.09724,10.88281C12.8863,10.88281,12.59333,10.90625,12.36482,10.93555C13.17537,10.11328,13.84724,9.2207,13.84724,8.39062C13.84724,7.541016,13.28865,7,12.4488,7C11.84333,7,11.446850000000001,7.234375,11.03279,7.679688L11.52497,8.16797C11.747630000000001,7.914062,12.0113,7.697266,12.33552,7.697266C12.7613,7.697266,13.00154,7.982422,13.00154,8.43359C13.00154,9.14648,12.29255,10.00781,11.081620000000001,11.11523L11.081620000000001,11.625ZM15.9605,11.75C16.8121,11.75,17.526899999999998,11.2832,17.526899999999998,10.4375C17.526899999999998,9.82031,17.142200000000003,9.43945,16.6441,9.30078L16.6441,9.27148C17.1129,9.08594,17.3824,8.7207,17.3824,8.21289C17.3824,7.421875,16.8004,7,15.9429,7C15.4215,7,14.9957,7.210938,14.6109,7.541016L15.066,8.11133C15.3258,7.849609,15.5836,7.697266,15.9019,7.697266C16.2789,7.697266,16.4957,7.914062,16.4957,8.28125C16.4957,8.70898,16.2301,9,15.4215,9L15.4215,9.63672C16.3804,9.63672,16.6383,9.91992,16.6383,10.38086C16.6383,10.79688,16.3336,11.03125,15.8824,11.03125C15.4742,11.03125,15.1578,10.82227,14.8922,10.55078L14.4781,11.13281C14.7906,11.486329999999999,15.2652,11.75,15.9605,11.75Z" stroke-opacity="0" stroke="none"></path>'),AI=qn('<g transform="scale(0.7857142857)" fill="currentColor" fill-rule="nonzero"><path d="M8.354 20.354l5-5-.707-.707-5 5z"></path><path d="M16.354 12.354l8-8-.707-.707-8 8z"></path><path d="M14.5 15c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM6.5 23c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g>'),LI=qn('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M3 6C3 7.30622 3.83481 8.41746 5 8.82929V15.1707C3.83481 15.5825 3 16.6938 3 18C3 19.6569 4.34315 21 6 21C7.30622 21 8.41746 20.1652 8.82929 19H15.1707C15.5825 20.1652 16.6938 21 18 21C19.6569 21 21 19.6569 21 18C21 16.6938 20.1652 15.5825 19 15.1707V8.82929C20.1652 8.41746 21 7.30622 21 6C21 4.34315 19.6569 3 18 3C16.6938 3 15.5825 3.83481 15.1707 5H8.82929C8.41746 3.83481 7.30622 3 6 3C4.34315 3 3 4.34315 3 6ZM6 7C6.55228 7 7 6.55228 7 6C7 5.44772 6.55228 5 6 5C5.44772 5 5 5.44772 5 6C5 6.55228 5.44772 7 6 7ZM17 15.1707V8.82929C16.1476 8.52801 15.472 7.85242 15.1707 7H8.82929C8.52801 7.85241 7.85241 8.52801 7 8.82929V15.1707C7.85241 15.472 8.52801 16.1476 8.82929 17H15.1707C15.472 16.1476 16.1476 15.472 17 15.1707ZM18 7C18.5523 7 19 6.55228 19 6C19 5.44772 18.5523 5 18 5C17.4477 5 17 5.44772 17 6C17 6.55228 17.4477 7 18 7ZM7 18C7 18.5523 6.55228 19 6 19C5.44772 19 5 18.5523 5 18C5 17.4477 5.44772 17 6 17C6.55228 17 7 17.4477 7 18ZM19 18C19 18.5523 18.5523 19 18 19C17.4477 19 17 18.5523 17 18C17 17.4477 17.4477 17 18 17C18.5523 17 19 17.4477 19 18Z"></path></g>'),FI=qn('<path d="M16.966900000000003,8.67144C16.6669,8.67144,16.4247,8.91558,16.4247,9.21802L16.4247,16.631500000000003C16.4247,17.322,16.007199999999997,17.9068,15.5139,17.9068L13.93072,17.9068L13.93072,9.2162C13.93072,8.91741,13.68675,8.67144,13.38855,8.67144C13.09036,8.67144,12.84639,8.91741,12.84639,9.21802L12.84639,17.9068L10.151810000000001,17.9068L10.151810000000001,9.21802C10.151810000000001,8.91741,9.90783,8.67144,9.609639999999999,8.67144C9.31145,8.67144,9.06747,8.91741,9.06747,9.219850000000001L9.06747,17.9068L7.48614,17.9068C6.99277,17.9068,6.5753,17.322,6.5753,16.631500000000003L6.5753,9.21802C6.5753,8.91558,6.333130000000001,8.67144,6.03313,8.67144C5.73313,8.67144,5.49096,8.91558,5.49096,9.21802L5.49096,16.631500000000003C5.49096,17.9378,6.385540000000001,19,7.48614,19L15.512,19C16.6127,19,17.509,17.9378,17.509,16.631500000000003L17.509,9.21802C17.509,8.91558,17.2669,8.67144,16.966900000000003,8.67144ZM18.4578,6.21183L4.542169,6.21183C4.243976,6.21183,4,6.45779,4,6.75841C4,7.05903,4.243976,7.30499,4.542169,7.30499L18.4578,7.30499C18.756,7.30499,19,7.05903,19,6.75841C19,6.45779,18.756,6.21183,18.4578,6.21183ZM8.68072,5.10045L14.3193,5.10045C14.6175,5.10045,14.8614,4.852666,14.8614,4.550225C14.8614,4.247783,14.6175,4,14.3193,4L8.68072,4C8.38253,4,8.13855,4.247783,8.13855,4.550225C8.13855,4.852666,8.38253,5.10045,8.68072,5.10045Z" fill-opacity="1" stroke="currentColor" stroke-width="1"></path>'),DI=qn('<circle cx="11" cy="11" r="8" fill="none" stroke="currentColor" stroke-width="1.5"></circle><circle cx="8.5" cy="8.5" r="1" fill="currentColor"></circle><circle cx="13.5" cy="8.5" r="1" fill="currentColor"></circle><path d="M7.5 13.5 Q11 16.5 14.5 13.5" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>',1),EI=qn('<g fill="currentColor"><path d="M5 5h12v2h-5v10h-2V7H5z"></path></g>'),$I=qn('<g transform="scale(0.9166666667)"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M19.054 7.988a2.988 2.988 0 0 1-1.31-.312l-10 10a3.027 3.027 0 1 1-1.38-1.381l10-10a2.994 2.994 0 1 1 2.69 1.693Zm-14 10a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm14-14a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"></path></g>'),jI=qn('<path d="M6,4L6,8L4,8L4,16L6,16L6,20L8,20L8,16L10,16L10,8L8,8L8,4L6,4ZM14,2L14,6L12,6L12,14L14,14L14,18L16,18L16,14L18,14L18,6L16,6L16,2L14,2Z" stroke-opacity="0" stroke="none"></path>'),zI=qn('<path d="M3,18L4.5,16.5L8,13L12,17L16,13L19,16L21,14L19,12L16,15L12,11L8,15L4.5,18.5L3,20Z" stroke-opacity="0" stroke="none"></path>'),BI=qn('<path d="M3,18L4.5,16.5L8,13L12,17L16,13L19,16L21,14L21,20L3,20Z" stroke-opacity="0" stroke="none"></path>'),NI=qn('<path d="M6,4L6,8L4,8L4,16L6,16L6,20L8,20L8,16L10,16L10,8L8,8L8,4L6,4ZM14,2L14,6L12,6L12,14L14,14L14,18L16,18L16,14L18,14L18,6L16,6L16,2L14,2Z" stroke-opacity="0" stroke="none" fill="currentColor"></path>'),RI=qn('<path d="M6,4L6,8M6,16L6,20M14,2L14,6M14,14L14,18" stroke="currentColor" stroke-width="0.5" fill="none"></path><rect x="4" y="8" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect><rect x="12" y="6" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect>',1),OI=qn('<path d="M6,4L6,8M6,16L6,20M14,2L14,6M14,14L14,18" stroke="currentColor" stroke-width="0.5" fill="none"></path><rect x="4" y="8" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect><rect x="12" y="6" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="currentColor" fill-opacity="0.3"></rect>',1),VI=qn('<path d="M6,4L6,8M6,16L6,20M14,2L14,6M14,14L14,18" stroke="currentColor" stroke-width="0.5" fill="none"></path><rect x="4" y="8" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="currentColor" fill-opacity="0.3"></rect><rect x="12" y="6" width="4" height="8" stroke="currentColor" stroke-width="0.5" fill="none"></rect>',1),WI=qn('<path d="M6,4L6,20M12,2L12,22M18,3L18,21" stroke="currentColor" stroke-width="0.5"></path><path d="M4,8L6,8M6,16L8,16M10,6L12,6M12,16L14,16M16,7L18,7M18,13L20,13" stroke="currentColor" stroke-width="0.5"></path>',1),qI=qn('<g stroke-width="1.2" fill="none"><g stroke="#00E6D8"><line x1="3" y1="13" x2="6" y2="16"></line><line x1="6" y1="13" x2="3" y2="16"></line><line x1="3" y1="9" x2="6" y2="12"></line><line x1="6" y1="9" x2="3" y2="12"></line><line x1="3" y1="5" x2="6" y2="8"></line><line x1="6" y1="5" x2="3" y2="8"></line></g><g stroke="#FF4D4D"><circle cx="10.5" cy="10.5" r="1.8"></circle><circle cx="10.5" cy="14.5" r="1.8"></circle><circle cx="10.5" cy="18.5" r="1.8"></circle></g><g stroke="#00E6D8"><line x1="15" y1="9" x2="18" y2="12"></line><line x1="18" y1="9" x2="15" y2="12"></line><line x1="15" y1="5" x2="18" y2="8"></line><line x1="18" y1="5" x2="15" y2="8"></line></g></g>'),HI=qn('<path d="M5.146447,15.753C4.9511845,15.9483,4.9511845,16.2649,5.146447,16.4602C5.341709,16.6554,5.658291,16.6554,5.853554,16.4602L8.156600000000001,14.15711C8.352409999999999,14.25082,8.57173,14.3033,8.8033,14.3033C9.631730000000001,14.3033,10.3033,13.63172,10.3033,12.80329C10.3033,12.57172,10.250820000000001,12.352409999999999,10.157119999999999,12.15659L12.156600000000001,10.15711C12.352409999999999,10.250820000000001,12.571729999999999,10.30329,12.8033,10.30329C13.63173,10.30329,14.3033,9.63172,14.3033,8.80329C14.3033,8.57172,14.25082,8.352409999999999,14.15712,8.15659L16.4602,5.853553C16.6554,5.658291,16.6554,5.341709,16.4602,5.146447C16.2649,4.9511843,15.9483,4.9511843,15.753,5.146447L13.45001,7.449479999999999C13.25419,7.35577,13.03487,7.3032900000000005,12.8033,7.3032900000000005C11.97487,7.3032900000000005,11.3033,7.97487,11.3033,8.80329C11.3033,9.03487,11.35578,9.254190000000001,11.44949,9.450009999999999L9.450009999999999,11.449480000000001C9.254190000000001,11.35577,9.03487,11.30329,8.8033,11.30329C7.97487,11.30329,7.3033,11.97487,7.3033,12.80329C7.3033,13.03487,7.35578,13.25419,7.44949,13.45001L5.146447,15.753Z" stroke-opacity="0" stroke="none"></path>'),GI=qn('<defs><clipPath id="master_svg0_151_615"><rect x="0" y="0" width="22" height="22" rx="0"></rect></clipPath></defs><g clip-path="url(#master_svg0_151_615)"><path d="M19.672,3.0673368C19.4417,2.9354008,19.1463,3.00292252,18.9994,3.2210900000000002L17.4588,5.50622L16.743299999999998,3.781253L13.9915,7.4662L13.9618,7.51108C13.8339,7.72862,13.8936,8.005659999999999,14.1004,8.15391L14.1462,8.183430000000001C14.3683,8.308720000000001,14.6511,8.25001,14.8022,8.047229999999999L16.4907,5.78571L17.246299999999998,7.60713L19.8374,3.7635389999999997L19.8651,3.717088C19.9871,3.484615,19.9023,3.199273,19.672,3.0673368ZM4.79974,8.462530000000001L10.117740000000001,3.252975C10.31381,3.0610145,10.63152,3.0610145,10.82759,3.252975L13.4115,5.78453C13.6076,5.976710000000001,13.6076,6.28833,13.4115,6.4805L8.093869999999999,11.69045C7.48847,12.28368,7.51659,13.3308,8.151309999999999,13.9528C8.786439999999999,14.5755,9.85421,14.6027,10.45961,14.0087L15.7768,8.79831C15.9729,8.60609,16.2909,8.60609,16.487099999999998,8.79831L19.0705,11.33026C19.2667,11.52244,19.2667,11.83406,19.0705,12.02623L13.7533,17.2366C11.32572,19.6158,7.30328,19.578,4.85679,17.1807C2.410298,14.7834,2.371331,10.84174,4.79974,8.462530000000001ZM12.3461,6.1325199999999995L10.47246,4.29654L5.51079,9.15889C3.477674,11.15076,3.510214,14.4688,5.56784,16.4847C7.62506,18.500999999999998,11.01117,18.5325,13.0439,16.540599999999998L15.6842,13.9529L14.2908,12.58718L15.0011,11.89161L16.394399999999997,13.2569L18.0056,11.67786L16.1323,9.84188L11.16985,14.7046C10.18764,15.6679,8.540980000000001,15.6494,7.51498,14.7184L7.44107,14.6487C6.4219,13.65,6.37771,11.98096,7.38362,10.994869999999999L10.02485,8.40693L8.624939999999999,7.03516L9.335180000000001,6.33919L10.73512,7.71099L12.3461,6.1325199999999995Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path></g>',1),YI=qn('<path d="M8.134443814697265,7.494615087890625L8.764323814697265,7.494615087890625L8.764323814697265,3.414215087890625L8.310223814697267,3.414215087890625L7.294603814697266,4.005035087890625L7.289713814697266,4.634915087890625L8.134443814697265,4.149892087890625L8.134443814697265,7.494615087890625ZM18.832003814697266,6.933095087890624Q19.004603814697266,6.635245087890625,19.004603814697266,6.2543850878906255Q19.004603814697266,5.884915087890625,18.845103814697264,5.593575087890625Q18.685503814697267,5.3006050878906255,18.399103814697266,5.136225087890625Q18.114303814697266,4.9702050878906245,17.754603814697266,4.9653250878906245L18.820603814697265,3.840647087890625L18.820603814697265,3.414215087890625L16.519203814697264,3.414215087890625L16.519203814697264,3.939931087890625L18.050803814697264,3.939931087890625L16.719403814697266,5.334785087890625L17.074203814697263,5.7205350878906245Q17.254903814697265,5.484525087890625,17.619503814697268,5.484525087890625Q17.980803814697268,5.484525087890625,18.187503814697266,5.689605087890625Q18.394203814697267,5.894685087890625,18.394203814697267,6.2543850878906255Q18.394203814697267,6.604315087890625,18.187503814697266,6.822415087890625Q17.980803814697268,7.0405150878906255,17.640603814697265,7.0405150878906255Q17.334603814697267,7.0405150878906255,17.124703814697266,6.890775087890625Q16.914703814697265,6.739415087890626,16.820303814697265,6.469225087890624L16.354803814697263,6.744295087890626Q16.480103814697266,7.125155087890625,16.821903814697265,7.341625087890625Q17.165403814697264,7.559725087890625,17.640603814697265,7.559725087890625Q18.039403814697266,7.559725087890625,18.348603814697267,7.393705087890625Q18.659503814697267,7.229315087890625,18.832003814697266,6.933095087890624ZM10.000003814697266,10.634915087890626C10.000003814697266,11.024655087890626,9.851363814697265,11.379685087890625,9.607683814697266,11.646395087890625L12.168903814697266,15.171615087890626C12.275403814697265,15.147615087890625,12.386203814697266,15.134915087890626,12.500003814697266,15.134915087890626C12.596503814697266,15.134915087890626,12.690803814697265,15.144015087890624,12.782303814697265,15.161415087890624L16.108803814697268,11.196955087890625C16.038703814697264,11.023375087890624,16.000003814697266,10.833655087890625,16.000003814697266,10.634915087890626C16.000003814697266,9.806495087890625,16.671603814697264,9.134915087890626,17.500003814697266,9.134915087890626C18.328403814697264,9.134915087890626,19.000003814697266,9.806495087890625,19.000003814697266,10.634915087890626C19.000003814697266,11.463345087890625,18.328403814697264,12.134915087890626,17.500003814697266,12.134915087890626C17.239503814697265,12.134915087890626,16.994503814697268,12.068495087890625,16.781003814697264,11.951675087890624L13.654703814697266,15.677415087890624C13.870303814697266,15.937215087890625,14.000003814697266,16.270915087890625,14.000003814697266,16.634915087890626C14.000003814697266,17.463315087890624,13.328403814697266,18.134915087890626,12.500003814697266,18.134915087890626C11.671573814697265,18.134915087890626,11.000003814697266,17.463315087890624,11.000003814697266,16.634915087890626C11.000003814697266,16.284415087890626,11.120193814697265,15.962015087890626,11.321603814697266,15.706715087890625L8.715393814697265,12.119565087890624C8.645053814697267,12.129685087890625,8.573143814697266,12.134915087890626,8.500003814697266,12.134915087890626C8.162103814697264,12.134915087890626,7.8503038146972655,12.023195087890626,7.599523814697266,11.834665087890626L4.505583814697266,15.521915087890624C4.809213814697266,15.796415087890624,5.000003814697266,16.193415087890624,5.000003814697266,16.634915087890626C5.000003814697266,17.463315087890624,4.328433814697266,18.134915087890626,3.5000038146972656,18.134915087890626C2.6715768146972656,18.134915087890626,2.0000038146972656,17.463315087890624,2.0000038146972656,16.634915087890626C2.0000038146972656,15.806515087890626,2.6715768146972656,15.134915087890626,3.5000038146972656,15.134915087890626C3.508253814697266,15.134915087890626,3.5164838146972657,15.135015087890626,3.524703814697266,15.135115087890625L7.033823814697266,10.953115087890625C7.011673814697265,10.850565087890626,7.000003814697266,10.744105087890624,7.000003814697266,10.634915087890626C7.000003814697266,9.806495087890625,7.671573814697266,9.134915087890626,8.500003814697266,9.134915087890626C9.328433814697267,9.134915087890626,10.000003814697266,9.806495087890625,10.000003814697266,10.634915087890626Z" stroke-opacity="0" stroke="none"></path>'),UI=qn('<path d="M11.57625,6.9981C11.55099,6.999359999999999,11.52557,7,11.5,7C11.34,7,11.18584,6.97495,11.04125,6.9285499999999995L5.55401,16.4327C5.713760000000001,16.5905,5.83826,16.7839,5.91465,17L16.0854,17C16.2187,16.622700000000002,16.4987,16.314700000000002,16.8569,16.1445L11.57625,6.9981ZM12.50759,6.611219999999999C12.81005,6.336790000000001,13,5.94058,13,5.5C13,4.671573,12.32843,4,11.5,4C10.67157,4,10,4.671573,10,5.5C10,5.80059,10.08841,6.08052,10.24066,6.31522L4.64514,16.0069C4.59738,16.002299999999998,4.54896,16,4.5,16C3.671573,16,3,16.671599999999998,3,17.5C3,18.328400000000002,3.671573,19,4.5,19C5.15311,19,5.70873,18.5826,5.91465,18L16.0854,18C16.2913,18.5826,16.846899999999998,19,17.5,19C18.328400000000002,19,19,18.328400000000002,19,17.5C19,16.8365,18.5691,16.2735,17.971899999999998,16.075699999999998L12.50759,6.611219999999999Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),KI=qn('<g transform="scale(0.7857142857)"><path fill="currentColor" stroke="currentColor" stroke-width="1" fill-rule="evenodd" d="M14 6a3 3 0 0 0-3 3v3h8.5a2.5 2.5 0 0 1 2.5 2.5v7a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 6 21.5v-7A2.5 2.5 0 0 1 8.5 12H10V9a4 4 0 0 1 8 0h-1a3 3 0 0 0-3-3zm-1 11a1 1 0 1 1 2 0v2a1 1 0 1 1-2 0v-2zm-6-2.5c0-.83.67-1.5 1.5-1.5h11c.83 0 1.5.67 1.5 1.5v7c0 .83-.67 1.5-1.5 1.5h-11A1.5 1.5 0 0 1 7 21.5v-7z"></path></g>'),ZI=qn('<path d="M11.66558837890625,19C10.83716137890625,19,10.16558837890625,18.328400000000002,10.16558837890625,17.5C10.16558837890625,16.846899999999998,10.58298437890625,16.2913,11.16557337890625,16.0854L11.16557337890625,11.91464C10.58298437890625,11.70872,10.16558837890625,11.1531,10.16558837890625,10.5C10.16558837890625,9.8469,10.58298437890625,9.29128,11.16557337890625,9.08536L11.16557337890625,4.5C11.16557337890625,4.223857,11.38942837890625,4,11.66556837890625,4C11.94171837890625,4,12.16556837890625,4.223857,12.16556837890625,4.5L12.16556837890625,9.08535C12.74817837890625,9.291260000000001,13.16558837890625,9.846879999999999,13.16558837890625,10.5C13.16558837890625,11.153120000000001,12.74817837890625,11.708739999999999,12.16556837890625,11.91465L12.16556837890625,16.0854C12.74817837890625,16.2913,13.16558837890625,16.846899999999998,13.16558837890625,17.5C13.16558837890625,18.328400000000002,12.49401837890625,19,11.66558837890625,19Z" stroke-opacity="0" stroke="none"></path>'),XI=qn('<path d="M11.165603637695312,6.91465C11.748203637695312,6.70873,12.165603637695312,6.15311,12.165603637695312,5.5C12.165603637695312,4.671573,11.494033637695313,4,10.665603637695312,4C9.837176637695313,4,9.165603637695312,4.671573,9.165603637695312,5.5C9.165603637695312,6.15311,9.583007637695312,6.70873,10.165603637695312,6.91465L10.165603637695312,16.0854C9.583007637695312,16.2913,9.165603637695312,16.846899999999998,9.165603637695312,17.5C9.165603637695312,18.328400000000002,9.837176637695313,19,10.665603637695312,19C11.494033637695313,19,12.165603637695312,18.328400000000002,12.165603637695312,17.5C12.165603637695312,16.846899999999998,11.748203637695312,16.2913,11.165603637695312,16.0854L11.165603637695312,6.91465Z" stroke-opacity="0" fill-rule="evenodd" fill-opacity="1"></path>'),JI=qn('<path d="M11,12.41465L11,18.5C11,18.7761,11.22386,19,11.5,19C11.77614,19,12,18.7761,12,18.5L12,12.41465C12.5826,12.20873,13,11.65311,13,11C13,10.34689,12.5826,9.79127,12,9.58535L12,3.5C12,3.223857,11.77614,3,11.5,3C11.22386,3,11,3.223857,11,3.5L11,9.58535C10.417404,9.79127,10,10.34689,10,11C10,11.65311,10.417404,12.20873,11,12.41465Z" stroke-opacity="0" stroke="none"></path>'),QI=qn('<path d="M11,17C5.80945,17,3.667717,12.85,3.113386,11.575C2.9622047,11.2,2.9622047,10.8,3.113386,10.425C3.667717,9.15,5.80945,5,11,5C16.165399999999998,5,18.3323,9.15,18.8866,10.425C19.0378,10.8,19.0378,11.2,18.8866,11.575C18.3323,12.85,16.165399999999998,17,11,17ZM4.04567,10.8C3.995276,10.925,3.995276,11.05,4.04567,11.175C4.52441,12.325,6.43937,16,11,16C15.5606,16,17.4756,12.325,17.9543,11.2C18.0047,11.075,18.0047,10.95,17.9543,10.825C17.4756,9.675,15.5606,6,11,6C6.43937,6,4.52441,9.675,4.04567,10.8ZM11,13.5C9.61417,13.5,8.480319999999999,12.375,8.480319999999999,11C8.480319999999999,9.625,9.61417,8.5,11,8.5C12.38583,8.5,13.5197,9.625,13.5197,11C13.5197,12.375,12.38583,13.5,11,13.5ZM11,9.5C10.1685,9.5,9.48819,10.175,9.48819,11C9.48819,11.825,10.1685,12.5,11,12.5C11.8315,12.5,12.51181,11.825,12.51181,11C12.51181,10.175,11.8315,9.5,11,9.5Z" stroke-opacity="0" fill-opacity="1"></path>'),eM=qn('<path d="M4.727219638671875,8.007996215820313L9.973849638671876,2.7629472158203123C10.167279638671875,2.5696791158203123,10.480729638671875,2.5696791158203123,10.674169638671875,2.7629472158203123L13.223329638671874,5.311756215820313C13.416929638671874,5.505236215820313,13.416929638671874,5.8189862158203125,13.223329638671874,6.012466215820313L7.977129638671875,11.257906215820313C7.379859638671875,11.855176215820313,7.407609638671875,12.909396215820312,8.033809638671876,13.535596215820313C8.660409638671876,14.162596215820313,9.713849638671874,14.189996215820312,10.311129638671876,13.591896215820313L15.556929638671875,8.346066215820311C15.750429638671875,8.152526215820313,16.064229638671875,8.152526215820313,16.257629638671872,8.346066215820311L18.806529638671876,10.895266215820312C19.000029638671876,11.088746215820313,19.000029638671876,11.402496215820312,18.806529638671876,11.595976215820313L13.560629638671875,16.841796215820313C11.165619638671876,19.237196215820312,7.197149638671875,19.19919621582031,4.783499638671875,16.785496215820313C2.3698426386718747,14.371896215820312,2.331397638671875,10.403416215820313,4.727219638671875,8.007996215820313ZM12.172299638671875,5.662106215820312L10.323809638671875,3.8136162158203124L5.4287196386718755,8.709096215820313C3.422893638671875,10.714536215820312,3.4549956386718748,14.055196215820313,5.484999638671875,16.08479621582031C7.514609638671875,18.114796215820313,10.855289638671875,18.146496215820314,12.860719638671876,16.141096215820312L15.465629638671874,13.535796215820312L14.090929638671875,12.160756215820312L14.791629638671875,11.460436215820312L16.166229638671876,12.834996215820313L17.755829638671877,11.245226215820313L15.907729638671874,9.396736215820312L11.011839638671875,14.292596215820312C10.042809638671875,15.262396215820312,8.418249638671874,15.243796215820312,7.406019638671875,14.306496215820312L7.333099638671875,14.236296215820312C6.327599638671876,13.230796215820313,6.284009638671876,11.550396215820312,7.276419638671875,10.557586215820312L9.882199638671874,7.952026215820313L8.501079638671875,6.570906215820313L9.201789638671876,5.870186215820313L10.582939638671874,7.251336215820312L12.172299638671875,5.662106215820312Z" fill-rule="evenodd" fill-opacity="1" stroke="currentColor" stroke-width="0.5"></path>'),tM=qn('<g transform="scale(0.7857142857)" fill="currentColor" fill-rule="nonzero" stroke="currentColor" stroke-width="1"><path d="M20.449 8.505l2.103 9.112.974-.225-2.103-9.112zM13.943 14.011l7.631 4.856.537-.844-7.631-4.856zM14.379 11.716l4.812-3.609-.6-.8-4.812 3.609zM10.96 13.828l-4.721 6.744.819.573 4.721-6.744zM6.331 20.67l2.31-13.088-.985-.174-2.31 13.088zM9.041 7.454l1.995 3.492.868-.496-1.995-3.492z"></path><path d="M8.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM12.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM20.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g>'),oM=qn('<path d="m19.45,17.57l-3.78,-9.16a0.92,0.92 0 0 0 -1.71,0l-3.78,9.16a0.92,0.92 0 1 0 1.71,0.71l0.77,-1.86l4.31,0l0.77,1.86a0.92,0.92 0 0 0 0.85,0.57a0.92,0.92 0 0 0 0.85,-1.28l0,0zm-6.03,-3.01l1.39,-3.37l1.39,3.37l-2.79,0zm-2.81,-0.8a0.92,0.92 0 0 0 -0.21,-1.29c-0.01,-0.01 -0.63,-0.47 -1.53,-1.46c1.67,-2.25 2.61,-4.82 2.99,-6.03l1.36,0a0.92,0.92 0 0 0 0,-1.85l-4.87,0l0,-0.84a0.92,0.92 0 0 0 -1.85,0l0,0.84l-4.87,0a0.92,0.92 0 0 0 0,1.85l8.28,0c-0.4,1.13 -1.14,2.92 -2.26,4.55c-1.32,-1.75 -1.81,-2.88 -1.81,-2.89a0.92,0.92 0 0 0 -1.7,0.71c0.02,0.06 0.61,1.44 2.22,3.53c0.04,0.05 0.08,0.1 0.12,0.15c-1.65,1.86 -3.27,3.02 -3.94,3.39a0.92,0.92 0 1 0 0.88,1.62c0.09,-0.05 2.04,-1.13 4.27,-3.59c0.95,1.01 1.6,1.49 1.64,1.52a0.92,0.92 0 0 0 1.29,-0.21l0,0z" id="svg_1"></path>'),sM=qn('<g id="svg_7"><path d="m10.02,1.07c-4.98,0 -9.28,4.05 -9.02,9.02c0.35,6.79 8.26,2.87 8.97,8.2a0.9,0.9 0 0 0 0.99,0.77a9.02,9.02 0 0 0 -0.94,-18zm1.77,16.4a0.51,0.51 0 0 1 -0.62,-0.35a4.51,4.51 0 0 0 -1.61,-2.3c-1.03,-0.78 -2.27,-1.08 -3.46,-1.38c-2.39,-0.59 -3.55,-0.99 -3.67,-3.43c-0.1,-1.87 0.58,-3.67 1.93,-5.08a7.84,7.84 0 0 1 5.66,-2.43a7.59,7.59 0 0 1 1.77,14.97z" id="svg_1"></path><path d="m13.04,14.42m-1.38,0a1.38,1.38 0 1 0 2.77,0a1.38,1.38 0 1 0 -2.77,0z" id="svg_2"></path><path d="m15.28,9.07m-1.13,0a1.13,1.13 0 1 0 2.26,0a1.13,1.13 0 1 0 -2.26,0z" id="svg_3"></path><path d="m14.23,6.93a1.13,1.13 0 1 0 -1.58,-0.19a1.13,1.13 0 0 0 1.58,0.19z" id="svg_4"></path><path d="m10.29,4.73m-0.97,0.58a1.13,1.13 0 1 0 1.93,-1.16a1.13,1.13 0 1 0 -1.93,1.16z" id="svg_5"></path><path d="m6.47,4.66a1.13,1.13 0 1 0 1.49,0.58a1.13,1.13 0 0 0 -1.49,-0.58z" id="svg_6"></path></g>'),nM=qn('<path d="m15.1,6.75c0,-2.31 -1.89,-4.18 -4.21,-4.18c-2.33,0 -4.21,1.87 -4.21,4.18c0,2.31 1.89,4.18 4.21,4.18c2.33,0 4.21,-1.87 4.21,-4.18m5.9,13.26c0.03,0.09 0.05,0.18 0.05,0.28c0,0.54 -0.44,0.98 -0.99,0.98a0.99,0.99 0 0 1 -0.99,-0.98l0,0l-0.03,0c-0.26,-4.12 -3.69,-7.39 -7.9,-7.39c-4.21,0 -7.65,3.27 -7.91,7.39l-0.02,0l0,0c0,0.54 -0.44,0.98 -0.99,0.98a0.99,0.99 0 0 1 -0.99,-0.98c0,-0.09 0.02,-0.18 0.04,-0.27c0.29,-3.74 2.66,-6.9 5.98,-8.3c-1.54,-1.12 -2.55,-2.92 -2.55,-4.97c0,-3.4 2.77,-6.15 6.19,-6.15c3.42,0 6.19,2.75 6.19,6.15a6.12,6.12 0 0 1 -2.39,4.85c3.48,1.33 6,4.56 6.31,8.41" fill="#515151" id="svg_1"></path>'),iM=qn('<g transform="scale(0.047 0.047)"><path d="M387.6 2.6C385.5 4.7 385 6.2 385 10C385 13.8 385.5 15.3 387.6 17.4L390.3 20H410.9H431.5L382.5 69L333.5 118L314.5 99C304.1 88.6 294.2 79.6 292.6 79C291 78.4 288.3 78.2 286.6 78.6C284.2 79 263.1 99.5 192.7 169.8C142.7 219.7 101.2 261.7 100.4 263.2C98.1 267.5 98.7 271.6 101.9 275.2C104.4 278 105.5 278.5 109.4 278.5H114L201.5 191L289 103.5L308.8 123.3L328.6 143H333.5H338.5L392.2 89.3L446 35.5V52.8C446 71.1 446.7 74.7 450.9 77C453.9 78.6 460.3 78.2 462.6 76.2C466.8 72.8 467 71.3 467 39C467 6.7 466.8 5.2 462.6 1.8C460.7 0.199996 457.1 -4.14997e-06 425.4 -4.14997e-06H390.3L387.6 2.6Z" fill="currentColor"></path><path d="M382.8 147.4C373.9 149.8 366 158.1 364.1 167.1C363.3 170.5 363 222 363 332V492H335.5H308L307.8 400.1L307.5 308.2L303.8 302.9C295.9 291.6 290.4 290.1 256.9 290C244 290 230.7 290.5 227.5 291.1C218.2 292.8 211 298.4 207.1 307C205.1 311.4 205 313.1 205 401.7V492H177.5H150V444.7C150 391.6 150 391.7 143 383.7C140.7 381.2 136.8 378.3 133.8 376.9C128.6 374.5 128 374.5 98 374.5H67.5L61.8 377.3C55.4 380.4 51.7 384.3 48.6 391C46.6 395.3 46.5 397.2 46.2 443.8L45.9 492H32.9C18.2 492 15.9 492.8 14 498.6C12.5 502.9 14.1 508.2 17.5 510.4C19.7 511.8 42.4 512 256 512C469.6 512 492.3 511.8 494.5 510.4C497.9 508.2 499.5 502.9 498 498.6C496.1 492.9 493.7 492 479.5 492H467V331.2C467 150.8 467.5 163.8 459.7 155.3C451.9 146.8 450.7 146.5 417 146.3C395.4 146.1 386.3 146.4 382.8 147.4ZM443.4 169.1L446 171.1V331.6V492H415H384V332V171.9L386.5 169.5L388.9 167H414.8C439.5 167 440.9 167.1 443.4 169.1ZM282.8 312.1C284.8 312.8 286.2 314.2 286.9 316.2C287.7 318.3 288 346.8 288 405.6V492H257H226V403.7C226 320.8 226.1 315.2 227.8 313.8C228.7 312.9 230.2 312 231 311.7C233.9 310.7 279.6 311 282.8 312.1ZM127.1 397.9C128.9 400.1 129 402.4 129 446.1V492H98H67L67.1 446.7C67.1 421.9 67.5 400.7 67.9 399.6C69.6 395.4 72.1 395 99.3 395.3C125.2 395.5 125.2 395.5 127.1 397.9Z" fill="currentColor"></path><path d="M69.2 295.5C65.3 298.7 64.4 302.7 66.4 307.4C69.3 314.4 78.6 315.6 83.5 309.8C91.5 300.3 78.6 287.5 69.2 295.5Z" fill="currentColor"></path><circle cx="2" cy="18" r="1" fill="currentColor"></circle></g>'),rM=qn('<g id="svg_4" transform="translate(-0.1 -0.1) scale(1.00914 1.00914) translate(0.1 0.1) scale(1.09 1.09) matrix(0.995 0 0 0.995 0 0)"><path d="m18.54,9.09c-0.21,-2.47 -1.25,-4.77 -2.96,-6.45c-1.73,-1.69 -3.96,-2.64 -6.3,-2.64c-1.25,0 -2.46,0.27 -3.61,0.78c-0.01,0 -0.01,0.02 -0.02,0.02c-0.02,0 -0.02,0.01 -0.03,0.01c-1.09,0.5 -2.06,1.21 -2.91,2.12c-0.86,0.92 -1.52,1.98 -1.99,3.18c-0.47,1.23 -0.72,2.54 -0.72,3.89c0,0.87 0.11,1.72 0.31,2.54c0,0.02 0.01,0.05 0.02,0.07c0.41,1.62 1.18,3.11 2.3,4.35c1.44,1.59 3.3,2.6 5.3,2.91c0.03,0 0.04,0.02 0.06,0.02c0.33,0.05 0.67,0.08 1.01,0.08l0.21,0c0.4,0 1.17,-0.03 1.8,-0.27c0.16,-0.07 0.29,-0.19 0.36,-0.36c0.07,-0.16 0.09,-0.35 0.03,-0.53c-0.1,-0.27 -0.34,-0.46 -0.61,-0.46c-0.07,0 -0.16,0.01 -0.23,0.03c-0.47,0.18 -1.1,0.21 -1.36,0.21l-0.1,0c0.1,-0.32 0.14,-0.67 0.05,-1.04c-0.15,-0.66 -0.64,-1.21 -1.57,-1.75l-0.39,-0.23c-0.62,-0.36 -0.96,-0.54 -1.16,-0.84c-0.2,-0.29 -0.34,-0.74 -0.51,-1.75c-0.13,-0.68 -0.47,-1.21 -1.01,-1.52c-0.37,-0.2 -0.8,-0.31 -1.32,-0.31c-0.36,0 -0.76,0.05 -1.18,0.15c-0.21,0.05 -0.41,0.11 -0.59,0.16c-0.08,-0.48 -0.12,-0.98 -0.12,-1.49c0,-3.04 1.47,-5.7 3.69,-7.24c0.01,0.28 0.07,0.57 0.19,0.84c0.3,0.7 0.92,1.14 1.84,1.33c0.05,0.01 0.08,0.01 0.12,0.01l0.04,0c0.09,0 0.39,0.01 0.71,0.14c0.43,0.19 0.68,0.51 0.76,1c0.2,1.56 0.42,4.38 0.14,5.29c-0.02,0.07 -0.03,0.15 -0.03,0.23c0,0.37 0.29,0.69 0.64,0.69c0.18,0 0.34,-0.08 0.46,-0.2c0.12,-0.13 2.76,-3.01 3.46,-3.97c0.08,-0.11 0.17,-0.21 0.26,-0.32c0.34,-0.43 0.69,-0.86 0.82,-1.51c0.15,-0.69 0,-1.46 -0.46,-2.41c-0.32,-0.68 -0.38,-0.98 -0.4,-1.1c0.02,-0.01 0.04,-0.02 0.06,-0.04c2.02,1.39 3.42,3.73 3.65,6.48c0.04,0.37 0.31,0.63 0.65,0.63l0.06,0c0.35,-0.01 0.61,-0.34 0.58,-0.73zm-15.35,3.47c0.3,0 0.53,0.05 0.71,0.15c0.18,0.12 0.29,0.28 0.34,0.56c0.2,1.07 0.37,1.79 0.76,2.34c0.38,0.53 0.86,0.79 1.58,1.21l0.03,0.01c0.1,0.06 0.23,0.13 0.35,0.2c0.74,0.43 0.9,0.72 0.94,0.86c0.03,0.14 -0.05,0.34 -0.15,0.54c-2.83,-0.58 -5.1,-2.74 -6.01,-5.6c0.42,-0.13 0.97,-0.27 1.45,-0.27zm9.6,-8.04c0.64,1.31 0.36,1.67 -0.21,2.37c-0.09,0.12 -0.19,0.23 -0.28,0.36c-0.35,0.48 -1.28,1.53 -2.09,2.43c0,-0.44 -0.02,-0.94 -0.06,-1.49c-0.08,-1.23 -0.22,-2.28 -0.22,-2.32l0,-0.04c-0.18,-0.99 -0.73,-1.71 -1.61,-2.07c-0.49,-0.2 -0.95,-0.22 -1.13,-0.22c-0.45,-0.11 -0.73,-0.3 -0.85,-0.55c-0.14,-0.3 -0.05,-0.74 0.04,-1.02c0.91,-0.38 1.88,-0.59 2.9,-0.59c1.11,0 2.16,0.24 3.13,0.67c-0.07,0.13 -0.13,0.3 -0.16,0.5c-0.04,0.49 0.12,1.1 0.54,1.97z" id="svg_1"></path><path d="m15.22,9.72c-2.63,0 -4.77,2.3 -4.77,5.14c0,2.84 2.13,5.14 4.77,5.14c2.64,0 4.78,-2.3 4.78,-5.14c0,-2.84 -2.15,-5.14 -4.78,-5.14zm0,8.88c-1.91,0 -3.48,-1.68 -3.48,-3.75c0,-2.07 1.56,-3.75 3.48,-3.75c1.93,0 3.49,1.68 3.49,3.75c0,2.07 -1.57,3.75 -3.49,3.75z" id="svg_2"></path><path d="m15.69,15.05l0,-2.37c0,-0.38 -0.29,-0.7 -0.64,-0.7c-0.36,0 -0.65,0.32 -0.65,0.7l0,2.66c0,0.19 0.07,0.35 0.19,0.49l1.16,1.27c0.12,0.12 0.28,0.2 0.46,0.2c0.17,0 0.33,-0.08 0.46,-0.2c0.11,-0.13 0.18,-0.31 0.18,-0.5c0,-0.19 -0.07,-0.36 -0.18,-0.49l-0.98,-1.06z" id="svg_3"></path></g>'),aM=qn('<path d="M8 5v14l11-7z" fill="currentColor"></path>'),lM=qn('<rect x="6" y="6" width="10" height="10" fill="currentColor"></rect>'),cM=qn('<path d="m21.62,13.73l-1.7,-1.37c0.08,-0.46 0.12,-0.94 0.12,-1.41c0,-0.47 -0.04,-0.94 -0.12,-1.41l1.7,-1.37c0.25,-0.21 0.35,-0.55 0.24,-0.85l-0.03,-0.07c-0.46,-1.24 -1.15,-2.38 -2.06,-3.37l-0.04,-0.05c-0.22,-0.24 -0.58,-0.34 -0.91,-0.23l-2.09,0.71c-0.78,-0.6 -1.64,-1.08 -2.57,-1.41l-0.41,-2.08c-0.07,-0.32 -0.33,-0.57 -0.67,-0.62l-0.08,-0.01c-1.34,-0.23 -2.76,-0.23 -4.1,0l-0.08,0.01c-0.34,0.05 -0.6,0.31 -0.67,0.62l-0.41,2.09c-0.93,0.33 -1.78,0.8 -2.55,1.4l-2.11,-0.71c-0.33,-0.11 -0.69,-0.02 -0.91,0.23l-0.04,0.05c-0.91,1.01 -1.6,2.14 -2.06,3.37l-0.03,0.07c-0.11,0.3 -0.01,0.65 0.24,0.85l1.72,1.38c-0.09,0.46 -0.12,0.93 -0.12,1.4c0,0.47 0.03,0.94 0.12,1.39l-1.72,1.39c-0.25,0.21 -0.35,0.55 -0.24,0.85l0.03,0.07c0.46,1.24 1.15,2.37 2.06,3.37l0.04,0.05c0.22,0.24 0.58,0.34 0.91,0.23l2.11,-0.71c0.77,0.6 1.62,1.07 2.55,1.4l0.41,2.09c0.07,0.32 0.33,0.57 0.67,0.62l0.08,0.01c0.67,0.12 1.36,0.18 2.05,0.18c0.69,0 1.38,-0.05 2.05,-0.18l0.08,-0.01c0.34,-0.05 0.6,-0.31 0.67,-0.62l0.41,-2.08c0.93,-0.33 1.8,-0.81 2.57,-1.41l2.09,0.71c0.33,0.11 0.69,0.01 0.91,-0.23l0.04,-0.05c0.91,-1.01 1.6,-2.14 2.06,-3.37l0.03,-0.07c0.11,-0.3 0.01,-0.64 -0.24,-0.85zm-3.53,-3.91c0.07,0.37 0.1,0.76 0.1,1.13c0,0.38 -0.03,0.77 -0.1,1.13l-0.18,0.99l1.93,1.55c-0.28,0.65 -0.66,1.25 -1.09,1.81l-2.4,-0.81l-0.81,0.64c-0.61,0.48 -1.3,0.85 -2.05,1.12l-0.99,0.35l-0.46,2.38c-0.72,0.08 -1.47,0.08 -2.19,0l-0.47,-2.38l-0.97,-0.36c-0.73,-0.26 -1.41,-0.64 -2.03,-1.12l-0.81,-0.64l-2.42,0.82c-0.44,-0.57 -0.8,-1.17 -1.09,-1.81l1.95,-1.58l-0.16,-0.97c-0.07,-0.36 -0.1,-0.74 -0.1,-1.12c0,-0.37 0.03,-0.74 0.1,-1.11l0.16,-0.97l-1.95,-1.58c0.3,-0.65 0.66,-1.25 1.09,-1.81l2.42,0.81l0.81,-0.62c0.61,-0.48 1.29,-0.85 2.03,-1.12l0.99,-0.35l0.46,-2.38c0.72,-0.09 1.47,-0.09 2.19,0l0.46,2.37l0.99,0.35c0.74,0.26 1.43,0.65 2.05,1.12l0.81,0.64l2.4,-0.81c0.44,0.57 0.81,1.17 1.11,1.81l-1.94,1.55l0.18,0.97zm-7.14,-3.42c-2.51,0 -4.54,1.93 -4.54,4.3c0,2.38 2.04,4.3 4.54,4.3c2.51,0 4.54,-1.93 4.54,-4.3c0,-2.38 -2.04,-4.3 -4.54,-4.3zm2.05,6.24c-0.55,0.51 -1.27,0.8 -2.05,0.8c-0.77,0 -1.5,-0.28 -2.05,-0.8c-0.54,-0.51 -0.84,-1.2 -0.84,-1.94c0,-0.73 0.31,-1.41 0.84,-1.94c0.55,-0.51 1.28,-0.8 2.05,-0.8c0.78,0 1.5,0.28 2.05,0.8c0.55,0.53 0.84,1.2 0.84,1.94c0,0.73 -0.3,1.42 -0.84,1.94z" id="svg_1"></path>'),dM=qn('<path d="m7.13,1l7.64,0c0.16,0 0.31,0.12 0.34,0.28l0.25,1.38c0.12,0.67 0.68,1.15 1.35,1.15l2.45,0c1.51,0 2.74,1.26 2.74,2.81l0,11.27c0,1.55 -1.23,2.81 -2.74,2.81l-16.43,0c-1.51,0 -2.74,-1.26 -2.74,-2.81l0,-11.27c0,-1.55 1.23,-2.81 2.74,-2.81l2.45,0c0.67,0 1.23,-0.48 1.35,-1.15l0.25,-1.38c0.03,-0.16 0.18,-0.28 0.34,-0.28zm9.58,4.23c-1.32,0 -2.45,-0.96 -2.69,-2.3l-0.1,-0.51l-5.93,0l-0.1,0.51c-0.24,1.34 -1.37,2.3 -2.69,2.3l-2.45,0c-0.76,0 -1.37,0.62 -1.37,1.4l0,11.27c0,0.78 0.61,1.4 1.37,1.4l16.43,0c0.76,0 1.37,-0.62 1.37,-1.4l0,-11.27c0,-0.78 -0.61,-1.4 -1.37,-1.4l-2.45,0zm-11.91,2.11l-1.37,0c-0.38,0 -0.69,-0.32 -0.69,-0.71c0,-0.38 0.31,-0.7 0.69,-0.7l1.37,0c0.37,0 0.68,0.32 0.68,0.7c0,0.39 -0.31,0.71 -0.68,0.71zm6.15,-0.71c-3.21,0 -5.81,2.68 -5.81,5.99c0,3.3 2.61,5.98 5.81,5.98c3.21,0 5.81,-2.68 5.81,-5.98c0,-3.31 -2.61,-5.99 -5.81,-5.99zm0,1.41c1.19,0 2.31,0.47 3.14,1.34c0.84,0.87 1.3,2.01 1.3,3.24c0,1.22 -0.46,2.37 -1.3,3.23c-0.83,0.87 -1.95,1.35 -3.14,1.35c-1.19,0 -2.31,-0.48 -3.14,-1.35c-0.84,-0.87 -1.3,-2.01 -1.3,-3.23c0,-1.23 0.46,-2.38 1.3,-3.24c0.83,-0.87 1.95,-1.34 3.14,-1.34zm0,2.46c-1.14,0 -2.05,0.94 -2.05,2.11c0,1.16 0.91,2.11 2.05,2.11c1.14,0 2.06,-0.95 2.06,-2.11c0,-1.17 -0.92,-2.11 -2.06,-2.11zm0,1.4c0.37,0 0.69,0.32 0.69,0.71c0,0.38 -0.32,0.7 -0.69,0.7c-0.37,0 -0.68,-0.32 -0.68,-0.7c0,-0.39 0.31,-0.71 0.68,-0.71z" id="svg_1"></path>'),uM=qn('<path d="m1.08,0l-1.08,1.08l4.19,4.2l-1.64,1.64l4.36,0l0,-4.36l-1.62,1.62l-4.21,-4.18zm14.73,5.28l4.19,-4.2l-1.08,-1.08l-4.21,4.18l-1.62,-1.62l0,4.36l4.36,0l-1.64,-1.64zm-11.64,9.42l-4.09,4.11l1.08,1.19l4.11,-4.2l1.64,1.64l0,-4.36l-4.36,0l1.62,1.62zm13.28,-1.62l-4.36,0l0,4.36l1.64,-1.64l4.11,4.2l1.08,-1.19l-4.09,-4.11l1.62,-1.62z" id="svg_1" transform="scale(1.09 1.09)"></path>'),pM=qn('<path d="m2.93,1.77l4.65,4.64l-1.19,1.19l-4.62,-4.67l-1.77,1.77l0,-4.7l4.7,0l-1.77,1.77zm3.48,10.63l-4.64,4.64l-1.77,-1.76l0,4.7l4.7,0l-1.77,-1.77l4.65,-4.64l-1.17,-1.17zm8.87,-12.4l1.76,1.77l-4.64,4.64l1.19,1.19l4.64,-4.64l1.77,1.76l0,-4.72l-4.72,0zm-1.71,12.4l-1.19,1.19l4.64,4.64l-1.77,1.77l4.73,0l0,-4.72l-1.77,1.76l-4.64,-4.64z" id="svg_1" transform="scale(1.095 1.095)"></path>'),vM=qn('<path d="m12.24,4.81c2.72,0 4.93,2.2 4.93,4.92c0,0.01 0,0.03 0,0.05c-0.01,0.03 -0.01,0.07 -0.01,0.11l-0.02,0.75l0.75,0c1.81,0.01 3.27,1.48 3.27,3.28c0,1.8 -1.46,3.27 -3.26,3.28l-0.16,0l-13.36,0c-2.01,0 -3.65,-1.64 -3.65,-3.64c0,-1.56 0.99,-2.94 2.47,-3.45l0.41,-0.14l0.07,-0.42c0.18,-1.06 1.09,-1.83 2.16,-1.83c0.34,0 0.67,0.08 0.98,0.24l0.67,0.34l0.31,-0.68c0.82,-1.7 2.56,-2.81 4.44,-2.81l0,0.01zm0,-0.73c-2.24,0 -4.19,1.31 -5.1,3.22c-0.39,-0.2 -0.83,-0.31 -1.31,-0.31c-1.44,0 -2.64,1.05 -2.87,2.43c-1.72,0.59 -2.96,2.22 -2.96,4.14c0,2.42 1.96,4.37 4.37,4.37l13.52,0c2.2,-0.01 3.99,-1.8 3.99,-4.01c0,-2.21 -1.79,-4.01 -4,-4.01c0.01,-0.06 0.01,-0.12 0.01,-0.18c0,-3.12 -2.53,-5.65 -5.66,-5.65l0,0z" fill="#000000" id="svg_1"></path>'),fM=qn('<path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z" fill="currentColor"></path>'),gM=qn('<g transform="scale(-1,1) translate(-24,0)"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z" fill="currentColor"></path></g>'),mM=qn('<g transform="scale(0.9166666667)"><path d="M12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M20 13H15.874C15.5122 14.4056 14.4056 15.5122 13 15.874V20C13 20.2652 12.8946 20.5196 12.7071 20.7071C12.5196 20.8946 12.2652 21 12 21C11.7348 21 11.4804 20.8946 11.2929 20.7071C11.1054 20.5196 11 20.2652 11 20V15.874C9.59439 15.5122 8.4878 14.4056 8.12602 13H4C3.73478 13 3.48043 12.8946 3.29289 12.7071C3.10536 12.5196 3 12.2652 3 12C3 11.7348 3.10536 11.4804 3.29289 11.2929C3.48043 11.1054 3.73478 11 4 11H8.12602C8.4878 9.59439 9.59439 8.4878 11 8.12602V4C11 3.73478 11.1054 3.48043 11.2929 3.29289C11.4804 3.10536 11.7348 3 12 3C12.2652 3 12.5196 3.10536 12.7071 3.29289C12.8946 3.48043 13 3.73478 13 4V8.12602C14.4056 8.4878 15.5122 9.59439 15.874 11H20C20.2652 11 20.5196 11.1054 20.7071 11.2929C20.8946 11.4804 21 11.7348 21 12C21 12.2652 20.8946 12.5196 20.7071 12.7071C20.5196 12.8946 20.2652 13 20 13ZM12 10C10.8954 10 10 10.8954 10 12C10 13.1046 10.8954 14 12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10Z"></path></g>'),hM=qn('<rect x="3" y="4" width="16" height="14" rx="1" fill="none" stroke="currentColor" stroke-width="0.5"></rect><rect x="13" y="4" width="6" height="14" rx="1" fill="currentColor" fill-opacity="0.3"></rect><line x1="13" y1="4" x2="13" y2="18" stroke="currentColor" stroke-width="0.5"></line>',1),_M=qn('<div class="icon-fallback"> </div>'),yM=qn('<svg class="icon-overlay fill-current svelte-19kzeyz" viewBox="0 0 22 22"><!></svg>');function Ru(o,e){let t=Ss(e,"name",3,"none"),s=Ss(e,"active",3,!1),i=Ss(e,"size",3,32);var r=yM(),a=g(r);Se(a,()=>t()=="horizontalStraightLine",l=>{var d=rI();O(l,d)},l=>{var d=Xt(),v=_t(d);Se(v,()=>t()=="ruler",p=>{var _=aI();O(p,_)},p=>{var _=Xt(),y=_t(_);Se(y,()=>t()=="abcd",w=>{var k=lI();O(w,k)},w=>{var k=Xt(),S=_t(k);Se(S,()=>t()=="anyWaves",L=>{var T=cI();O(L,T)},L=>{var T=Xt(),P=_t(T);Se(P,()=>t()=="arrow",A=>{var F=dI();O(A,F)},A=>{var F=Xt(),B=_t(F);Se(B,()=>t()=="circle",R=>{var N=uI();O(R,N)},R=>{var N=Xt(),$=_t(N);Se($,()=>t()=="eightWaves",V=>{var U=pI();O(V,U)},V=>{var U=Xt(),G=_t(U);Se(G,()=>t()=="fibonacciCircle",Z=>{var le=vI();un(4),O(Z,le)},Z=>{var le=Xt(),se=_t(le);Se(se,()=>t()=="fibonacciExtension",ie=>{var Y=fI();O(ie,Y)},ie=>{var Y=Xt(),K=_t(Y);Se(K,()=>t()=="fibonacciSegment",Q=>{var q=gI();O(Q,q)},Q=>{var q=Xt(),ce=_t(q);Se(ce,()=>t()=="fibonacciSpeedResistanceFan",_e=>{var me=mI();O(_e,me)},_e=>{var me=Xt(),Pe=_t(me);Se(Pe,()=>t()=="fibonacciSpiral",ze=>{var he=hI();O(ze,he)},ze=>{var he=Xt(),De=_t(he);Se(De,()=>t()=="fiveWaves",ge=>{var be=_I();O(ge,be)},ge=>{var be=Xt(),$e=_t(be);Se($e,()=>t()=="gannBox",Ve=>{var Ce=yI();O(Ve,Ce)},Ve=>{var Ce=Xt(),Je=_t(Ce);Se(Je,()=>t()=="horizontalRayLine",ye=>{var Ae=bI();O(ye,Ae)},ye=>{var Ae=Xt(),ee=_t(Ae);Se(ee,()=>t()=="horizontalSegment",xe=>{var ke=xI();O(xe,ke)},xe=>{var ke=Xt(),He=_t(ke);Se(He,()=>t()=="invisible",Ie=>{var ne=wI();O(Ie,ne)},Ie=>{var ne=Xt(),J=_t(ne);Se(J,()=>t()=="visible",qe=>{var ft=kI();O(qe,ft)},qe=>{var ft=Xt(),Qe=_t(ft);Se(Qe,()=>t()=="lock",Oe=>{var ct=SI();un(),O(Oe,ct)},Oe=>{var ct=Xt(),Lt=_t(ct);Se(Lt,()=>t()=="parallelogram",It=>{var zt=CI();O(It,zt)},It=>{var zt=Xt(),pt=_t(zt);Se(pt,()=>t()=="parallelStraightLine",Mo=>{var Xo=PI();O(Mo,Xo)},Mo=>{var Xo=Xt(),en=_t(Xo);Se(en,()=>t()=="priceChannelLine",Fo=>{var Eo=II();O(Fo,Eo)},Fo=>{var Eo=Xt(),cs=_t(Eo);Se(cs,()=>t()=="priceChannelLineNew",Zt=>{var bs=MI();O(Zt,bs)},Zt=>{var bs=Xt(),es=_t(bs);Se(es,()=>t()=="priceLine",rn=>{var wr=TI();O(rn,wr)},rn=>{var wr=Xt(),rr=_t(wr);Se(rr,()=>t()=="rayLine",ar=>{var jr=AI();O(ar,jr)},ar=>{var jr=Xt(),ii=_t(jr);Se(ii,()=>t()=="rect",Xa=>{var Ja=LI();O(Xa,Ja)},Xa=>{var Ja=Xt(),Va=_t(Ja);Se(Va,()=>t()=="remove",Wa=>{var Qa=FI();O(Wa,Qa)},Wa=>{var Qa=Xt(),qa=_t(Qa);Se(qa,()=>t()=="emoji",Kl=>{var ll=DI();un(3),O(Kl,ll)},Kl=>{var ll=Xt(),Wr=_t(ll);Se(Wr,()=>t()=="text",Ca=>{var vl=EI();O(Ca,vl)},Ca=>{var vl=Xt(),ml=_t(vl);Se(ml,()=>t()=="segment",Sl=>{var el=$I();O(Sl,el)},Sl=>{var el=Xt(),or=_t(el);Se(or,()=>t()=="candle",tc=>{var pe=jI();O(tc,pe)},tc=>{var pe=Xt(),rt=_t(pe);Se(rt,()=>t()=="line",Ft=>{var Qt=zI();O(Ft,Qt)},Ft=>{var Qt=Xt(),xt=_t(Qt);Se(xt,()=>t()=="area",eo=>{var Is=BI();O(eo,Is)},eo=>{var Is=Xt(),Po=_t(Is);Se(Po,()=>t()=="candle_solid",Ze=>{var Ke=NI();O(Ze,Ke)},Ze=>{var Ke=Xt(),ps=_t(Ke);Se(ps,()=>t()=="candle_stroke",pn=>{var Jo=RI();un(2),O(pn,Jo)},pn=>{var Jo=Xt(),ti=_t(Jo);Se(ti,()=>t()=="candle_up_stroke",mr=>{var sa=OI();un(2),O(mr,sa)},mr=>{var sa=Xt(),yt=_t(sa);Se(yt,()=>t()=="candle_down_stroke",wt=>{var to=VI();un(2),O(wt,to)},wt=>{var to=Xt(),mt=_t(to);Se(mt,()=>t()=="ohlc",Wt=>{var vt=WI();un(),O(Wt,vt)},Wt=>{var vt=Xt(),$t=_t(vt);Se($t,()=>t()=="point_and_figure",zo=>{var bo=qI();O(zo,bo)},zo=>{var bo=Xt(),xo=_t(bo);Se(xo,()=>t()=="straightLine",Zo=>{var os=HI();O(Zo,os)},Zo=>{var os=Xt(),ri=_t(os);Se(ri,()=>t()=="strongMagnet",vn=>{var sr=GI();un(),O(vn,sr)},vn=>{var sr=Xt(),Ko=_t(sr);Se(Ko,()=>t()=="threeWaves",Hn=>{var ji=YI();O(Hn,ji)},Hn=>{var ji=Xt(),zn=_t(ji);Se(zn,()=>t()=="triangle",Vs=>{var Bn=UI();O(Vs,Bn)},Vs=>{var Bn=Xt(),tr=_t(Bn);Se(tr,()=>t()=="unlock",lr=>{var Ui=KI();O(lr,Ui)},lr=>{var Ui=Xt(),_a=_t(Ui);Se(_a,()=>t()=="verticalRayLine",qi=>{var ai=ZI();O(qi,ai)},qi=>{var ai=Xt(),cr=_t(ai);Se(cr,()=>t()=="verticalSegment",Dn=>{var kr=XI();O(Dn,kr)},Dn=>{var kr=Xt(),Me=_t(kr);Se(Me,()=>t()=="verticalStraightLine",Xe=>{var X=JI();O(Xe,X)},Xe=>{var X=Xt(),Le=_t(X);Se(Le,()=>t()=="visiable",nt=>{var et=QI();O(nt,et)},nt=>{var et=Xt(),ht=_t(et);Se(ht,()=>t()=="weakMagnet",uo=>{var ut=eM();O(uo,ut)},uo=>{var ut=Xt(),Jt=_t(ut);Se(Jt,()=>t()=="xabcd",fo=>{var lo=tM();O(fo,lo)},fo=>{var lo=Xt(),so=_t(lo);Se(so,()=>t()=="lang",ko=>{var ts=oM();O(ko,ts)},ko=>{var ts=Xt(),Xn=_t(ts);Se(Xn,()=>t()=="theme",ro=>{var Do=sM();O(ro,Do)},ro=>{var Do=Xt(),Ao=_t(Do);Se(Ao,()=>t()=="user",ss=>{var ds=nM();O(ss,ds)},ss=>{var ds=Xt(),Cs=_t(ds);Se(Cs,()=>t()=="indicator",ns=>{var Js=iM();O(ns,Js)},ns=>{var Js=Xt(),Nn=_t(Js);Se(Nn,()=>t()=="timezone",ui=>{var Ms=rM();O(ui,Ms)},ui=>{var Ms=Xt(),Li=_t(Ms);Se(Li,()=>t()=="play",Dr=>{var Xr=aM();O(Dr,Xr)},Dr=>{var Xr=Xt(),Ki=_t(Xr);Se(Ki,()=>t()=="stop",Ge=>{var at=lM();O(Ge,at)},Ge=>{var at=Xt(),So=_t(at);Se(So,()=>t()=="setting",qt=>{var Io=cM();O(qt,Io)},qt=>{var Io=Xt(),us=_t(Io);Se(us,()=>t()=="screenShot",fn=>{var Ts=dM();O(fn,Ts)},fn=>{var Ts=Xt(),js=_t(Ts);Se(js,()=>t()=="exitFullScreen",on=>{var _s=uM();O(on,_s)},on=>{var _s=Xt(),In=_t(_s);Se(In,()=>t()=="fullScreen",Ci=>{var zr=pM();O(Ci,zr)},Ci=>{var zr=Xt(),ca=_t(zr);Se(ca,()=>t()=="cloud",hl=>{var fa=vM();O(hl,fa)},hl=>{var fa=Xt(),za=_t(fa);Se(za,()=>t()=="undo",oc=>{var sc=fM();O(oc,sc)},oc=>{var sc=Xt(),Cl=_t(sc);Se(Cl,()=>t()=="redo",Vl=>{var ul=gM();O(Vl,ul)},Vl=>{var ul=Xt(),nc=_t(ul);Se(nc,()=>t()=="crosshair",vc=>{var Zl=mM();O(vc,Zl)},vc=>{var Zl=Xt(),Ha=_t(Zl);Se(Ha,()=>t()=="sidebar",qc=>{var _c=hM();un(2),O(qc,_c)},qc=>{var _c=_M(),ld=g(_c,!0);f(_c),we(()=>Ye(ld,t())),O(qc,_c)},!0),O(vc,Zl)},!0),O(Vl,ul)},!0),O(oc,sc)},!0),O(hl,fa)},!0),O(Ci,zr)},!0),O(on,_s)},!0),O(fn,Ts)},!0),O(qt,Io)},!0),O(Ge,at)},!0),O(Dr,Xr)},!0),O(ui,Ms)},!0),O(ns,Js)},!0),O(ss,ds)},!0),O(ro,Do)},!0),O(ko,ts)},!0),O(fo,lo)},!0),O(uo,ut)},!0),O(nt,et)},!0),O(Xe,X)},!0),O(Dn,kr)},!0),O(qi,ai)},!0),O(lr,Ui)},!0),O(Vs,Bn)},!0),O(Hn,ji)},!0),O(vn,sr)},!0),O(Zo,os)},!0),O(zo,bo)},!0),O(Wt,vt)},!0),O(wt,to)},!0),O(mr,sa)},!0),O(pn,Jo)},!0),O(Ze,Ke)},!0),O(eo,Is)},!0),O(Ft,Qt)},!0),O(tc,pe)},!0),O(Sl,el)},!0),O(Ca,vl)},!0),O(Kl,ll)},!0),O(Wa,Qa)},!0),O(Xa,Ja)},!0),O(ar,jr)},!0),O(rn,wr)},!0),O(Zt,bs)},!0),O(Fo,Eo)},!0),O(Mo,Xo)},!0),O(It,zt)},!0),O(Oe,ct)},!0),O(qe,ft)},!0),O(Ie,ne)},!0),O(xe,ke)},!0),O(ye,Ae)},!0),O(Ve,Ce)},!0),O(ge,be)},!0),O(ze,he)},!0),O(_e,me)},!0),O(Q,q)},!0),O(ie,Y)},!0),O(Z,le)},!0),O(V,U)},!0),O(R,N)},!0),O(A,F)},!0),O(L,T)},!0),O(w,k)},!0),O(p,_)},!0),O(l,d)}),f(r),we(()=>{St(r,"style",`width: ${i()??""}px; height: ${i()??""}px;`),Sn(r,"active",s())}),O(o,r)}var Nm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Nm.exports;(function(o,e){(function(){var t,s="4.17.21",i=200,r="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",v=500,p="__lodash_placeholder__",_=1,y=2,w=4,k=1,S=2,L=1,T=2,P=4,A=8,F=16,B=32,R=64,N=128,$=256,V=512,U=30,G="...",Z=800,le=16,se=1,ie=2,Y=3,K=1/0,Q=9007199254740991,q=17976931348623157e292,ce=NaN,_e=4294967295,me=_e-1,Pe=_e>>>1,ze=[["ary",N],["bind",L],["bindKey",T],["curry",A],["curryRight",F],["flip",V],["partial",B],["partialRight",R],["rearg",$]],he="[object Arguments]",De="[object Array]",ge="[object AsyncFunction]",be="[object Boolean]",$e="[object Date]",Ve="[object DOMException]",Ce="[object Error]",Je="[object Function]",ye="[object GeneratorFunction]",Ae="[object Map]",ee="[object Number]",xe="[object Null]",ke="[object Object]",He="[object Promise]",Ie="[object Proxy]",ne="[object RegExp]",J="[object Set]",qe="[object String]",ft="[object Symbol]",Qe="[object Undefined]",Oe="[object WeakMap]",ct="[object WeakSet]",Lt="[object ArrayBuffer]",It="[object DataView]",zt="[object Float32Array]",pt="[object Float64Array]",Mo="[object Int8Array]",Xo="[object Int16Array]",en="[object Int32Array]",Fo="[object Uint8Array]",Eo="[object Uint8ClampedArray]",cs="[object Uint16Array]",Zt="[object Uint32Array]",bs=/\b__p \+= '';/g,es=/\b(__p \+=) '' \+/g,rn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wr=/&(?:amp|lt|gt|quot|#39);/g,rr=/[&<>"']/g,ar=RegExp(wr.source),jr=RegExp(rr.source),ii=/<%-([\s\S]+?)%>/g,Xa=/<%([\s\S]+?)%>/g,Ja=/<%=([\s\S]+?)%>/g,Va=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wa=/^\w*$/,Qa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qa=/[\\^$.*+?()[\]{}|]/g,Kl=RegExp(qa.source),ll=/^\s+/,Wr=/\s/,Ca=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,vl=/\{\n\/\* \[wrapped with (.+)\] \*/,ml=/,? & /,Sl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,el=/[()=,{}\[\]\/\s]/,or=/\\(\\)?/g,tc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,rt=/^[-+]0x[0-9a-f]+$/i,Ft=/^0b[01]+$/i,Qt=/^\[object .+?Constructor\]$/,xt=/^0o[0-7]+$/i,eo=/^(?:0|[1-9]\d*)$/,Is=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Po=/($^)/,Ze=/['\n\r\u2028\u2029\\]/g,Ke="\\ud800-\\udfff",ps="\\u0300-\\u036f",pn="\\ufe20-\\ufe2f",Jo="\\u20d0-\\u20ff",ti=ps+pn+Jo,mr="\\u2700-\\u27bf",sa="a-z\\xdf-\\xf6\\xf8-\\xff",yt="\\xac\\xb1\\xd7\\xf7",wt="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",to="\\u2000-\\u206f",mt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Wt="A-Z\\xc0-\\xd6\\xd8-\\xde",vt="\\ufe0e\\ufe0f",$t=yt+wt+to+mt,zo="['’]",bo="["+Ke+"]",xo="["+$t+"]",Zo="["+ti+"]",os="\\d+",ri="["+mr+"]",vn="["+sa+"]",sr="[^"+Ke+$t+os+mr+sa+Wt+"]",Ko="\\ud83c[\\udffb-\\udfff]",Hn="(?:"+Zo+"|"+Ko+")",ji="[^"+Ke+"]",zn="(?:\\ud83c[\\udde6-\\uddff]){2}",Vs="[\\ud800-\\udbff][\\udc00-\\udfff]",Bn="["+Wt+"]",tr="\\u200d",lr="(?:"+vn+"|"+sr+")",Ui="(?:"+Bn+"|"+sr+")",_a="(?:"+zo+"(?:d|ll|m|re|s|t|ve))?",qi="(?:"+zo+"(?:D|LL|M|RE|S|T|VE))?",ai=Hn+"?",cr="["+vt+"]?",Dn="(?:"+tr+"(?:"+[ji,zn,Vs].join("|")+")"+cr+ai+")*",kr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Me="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Xe=cr+ai+Dn,X="(?:"+[ri,zn,Vs].join("|")+")"+Xe,Le="(?:"+[ji+Zo+"?",Zo,zn,Vs,bo].join("|")+")",nt=RegExp(zo,"g"),et=RegExp(Zo,"g"),ht=RegExp(Ko+"(?="+Ko+")|"+Le+Xe,"g"),uo=RegExp([Bn+"?"+vn+"+"+_a+"(?="+[xo,Bn,"$"].join("|")+")",Ui+"+"+qi+"(?="+[xo,Bn+lr,"$"].join("|")+")",Bn+"?"+lr+"+"+_a,Bn+"+"+qi,Me,kr,os,X].join("|"),"g"),ut=RegExp("["+tr+Ke+ti+vt+"]"),Jt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],lo=-1,so={};so[zt]=so[pt]=so[Mo]=so[Xo]=so[en]=so[Fo]=so[Eo]=so[cs]=so[Zt]=!0,so[he]=so[De]=so[Lt]=so[be]=so[It]=so[$e]=so[Ce]=so[Je]=so[Ae]=so[ee]=so[ke]=so[ne]=so[J]=so[qe]=so[Oe]=!1;var ko={};ko[he]=ko[De]=ko[Lt]=ko[It]=ko[be]=ko[$e]=ko[zt]=ko[pt]=ko[Mo]=ko[Xo]=ko[en]=ko[Ae]=ko[ee]=ko[ke]=ko[ne]=ko[J]=ko[qe]=ko[ft]=ko[Fo]=ko[Eo]=ko[cs]=ko[Zt]=!0,ko[Ce]=ko[Je]=ko[Oe]=!1;var ts={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Xn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ro={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Do={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ao=parseFloat,ss=parseInt,ds=typeof Op=="object"&&Op&&Op.Object===Object&&Op,Cs=typeof self=="object"&&self&&self.Object===Object&&self,ns=ds||Cs||Function("return this")(),Js=e&&!e.nodeType&&e,Nn=Js&&!0&&o&&!o.nodeType&&o,ui=Nn&&Nn.exports===Js,Ms=ui&&ds.process,Li=function(){try{var Mt=Nn&&Nn.require&&Nn.require("util").types;return Mt||Ms&&Ms.binding&&Ms.binding("util")}catch{}}(),Dr=Li&&Li.isArrayBuffer,Xr=Li&&Li.isDate,Ki=Li&&Li.isMap,Ge=Li&&Li.isRegExp,at=Li&&Li.isSet,So=Li&&Li.isTypedArray;function qt(Mt,ho,no){switch(no.length){case 0:return Mt.call(ho);case 1:return Mt.call(ho,no[0]);case 2:return Mt.call(ho,no[0],no[1]);case 3:return Mt.call(ho,no[0],no[1],no[2])}return Mt.apply(ho,no)}function Io(Mt,ho,no,gn){for(var dr=-1,z=Mt==null?0:Mt.length;++dr<z;){var te=Mt[dr];ho(gn,te,no(te),Mt)}return gn}function us(Mt,ho){for(var no=-1,gn=Mt==null?0:Mt.length;++no<gn&&ho(Mt[no],no,Mt)!==!1;);return Mt}function fn(Mt,ho){for(var no=Mt==null?0:Mt.length;no--&&ho(Mt[no],no,Mt)!==!1;);return Mt}function Ts(Mt,ho){for(var no=-1,gn=Mt==null?0:Mt.length;++no<gn;)if(!ho(Mt[no],no,Mt))return!1;return!0}function js(Mt,ho){for(var no=-1,gn=Mt==null?0:Mt.length,dr=0,z=[];++no<gn;){var te=Mt[no];ho(te,no,Mt)&&(z[dr++]=te)}return z}function on(Mt,ho){var no=Mt==null?0:Mt.length;return!!no&&Vl(Mt,ho,0)>-1}function _s(Mt,ho,no){for(var gn=-1,dr=Mt==null?0:Mt.length;++gn<dr;)if(no(ho,Mt[gn]))return!0;return!1}function In(Mt,ho){for(var no=-1,gn=Mt==null?0:Mt.length,dr=Array(gn);++no<gn;)dr[no]=ho(Mt[no],no,Mt);return dr}function Ci(Mt,ho){for(var no=-1,gn=ho.length,dr=Mt.length;++no<gn;)Mt[dr+no]=ho[no];return Mt}function zr(Mt,ho,no,gn){var dr=-1,z=Mt==null?0:Mt.length;for(gn&&z&&(no=Mt[++dr]);++dr<z;)no=ho(no,Mt[dr],dr,Mt);return no}function ca(Mt,ho,no,gn){var dr=Mt==null?0:Mt.length;for(gn&&dr&&(no=Mt[--dr]);dr--;)no=ho(no,Mt[dr],dr,Mt);return no}function hl(Mt,ho){for(var no=-1,gn=Mt==null?0:Mt.length;++no<gn;)if(ho(Mt[no],no,Mt))return!0;return!1}var fa=Zl("length");function za(Mt){return Mt.split("")}function oc(Mt){return Mt.match(Sl)||[]}function sc(Mt,ho,no){var gn;return no(Mt,function(dr,z,te){if(ho(dr,z,te))return gn=z,!1}),gn}function Cl(Mt,ho,no,gn){for(var dr=Mt.length,z=no+(gn?1:-1);gn?z--:++z<dr;)if(ho(Mt[z],z,Mt))return z;return-1}function Vl(Mt,ho,no){return ho===ho?pu(Mt,ho,no):Cl(Mt,nc,no)}function ul(Mt,ho,no,gn){for(var dr=no-1,z=Mt.length;++dr<z;)if(gn(Mt[dr],ho))return dr;return-1}function nc(Mt){return Mt!==Mt}function vc(Mt,ho){var no=Mt==null?0:Mt.length;return no?ld(Mt,ho)/no:ce}function Zl(Mt){return function(ho){return ho==null?t:ho[Mt]}}function Ha(Mt){return function(ho){return Mt==null?t:Mt[ho]}}function qc(Mt,ho,no,gn,dr){return dr(Mt,function(z,te,ve){no=gn?(gn=!1,z):ho(no,z,te,ve)}),no}function _c(Mt,ho){var no=Mt.length;for(Mt.sort(ho);no--;)Mt[no]=Mt[no].value;return Mt}function ld(Mt,ho){for(var no,gn=-1,dr=Mt.length;++gn<dr;){var z=ho(Mt[gn]);z!==t&&(no=no===t?z:no+z)}return no}function Od(Mt,ho){for(var no=-1,gn=Array(Mt);++no<Mt;)gn[no]=ho(no);return gn}function Hc(Mt,ho){return In(ho,function(no){return[no,Mt[no]]})}function fl(Mt){return Mt&&Mt.slice(0,kp(Mt)+1).replace(ll,"")}function tl(Mt){return function(ho){return Mt(ho)}}function hd(Mt,ho){return In(ho,function(no){return Mt[no]})}function Rc(Mt,ho){return Mt.has(ho)}function iu(Mt,ho){for(var no=-1,gn=Mt.length;++no<gn&&Vl(ho,Mt[no],0)>-1;);return no}function Iu(Mt,ho){for(var no=Mt.length;no--&&Vl(ho,Mt[no],0)>-1;);return no}function uu(Mt,ho){for(var no=Mt.length,gn=0;no--;)Mt[no]===ho&&++gn;return gn}var Vd=Ha(ts),ru=Ha(Xn);function qu(Mt){return"\\"+Do[Mt]}function Mu(Mt,ho){return Mt==null?t:Mt[ho]}function Ad(Mt){return ut.test(Mt)}function _d(Mt){return Jt.test(Mt)}function Bs(Mt){for(var ho,no=[];!(ho=Mt.next()).done;)no.push(ho.value);return no}function bp(Mt){var ho=-1,no=Array(Mt.size);return Mt.forEach(function(gn,dr){no[++ho]=[dr,gn]}),no}function xp(Mt,ho){return function(no){return Mt(ho(no))}}function Xc(Mt,ho){for(var no=-1,gn=Mt.length,dr=0,z=[];++no<gn;){var te=Mt[no];(te===ho||te===p)&&(Mt[no]=p,z[dr++]=no)}return z}function sp(Mt){var ho=-1,no=Array(Mt.size);return Mt.forEach(function(gn){no[++ho]=gn}),no}function wp(Mt){var ho=-1,no=Array(Mt.size);return Mt.forEach(function(gn){no[++ho]=[gn,gn]}),no}function pu(Mt,ho,no){for(var gn=no-1,dr=Mt.length;++gn<dr;)if(Mt[gn]===ho)return gn;return-1}function Kp(Mt,ho,no){for(var gn=no+1;gn--;)if(Mt[gn]===ho)return gn;return gn}function vu(Mt){return Ad(Mt)?Zp(Mt):fa(Mt)}function yd(Mt){return Ad(Mt)?np(Mt):za(Mt)}function kp(Mt){for(var ho=Mt.length;ho--&&Wr.test(Mt.charAt(ho)););return ho}var Sp=Ha(ro);function Zp(Mt){for(var ho=ht.lastIndex=0;ht.test(Mt);)++ho;return ho}function np(Mt){return Mt.match(ht)||[]}function ip(Mt){return Mt.match(uo)||[]}var Xp=function Mt(ho){ho=ho==null?ns:Kd.defaults(ns.Object(),ho,Kd.pick(ns,fo));var no=ho.Array,gn=ho.Date,dr=ho.Error,z=ho.Function,te=ho.Math,ve=ho.Object,Ne=ho.RegExp,Re=ho.String,je=ho.TypeError,Ue=no.prototype,kt=z.prototype,lt=ve.prototype,bt=ho["__core-js_shared__"],Ct=kt.toString,Kt=lt.hasOwnProperty,Dt=0,jt=function(){var c=/[^.]+$/.exec(bt&&bt.keys&&bt.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Co=lt.toString,Oo=Ct.call(ve),Ho=ns._,Vo=Ne("^"+Ct.call(Kt).replace(qa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Cn=ui?ho.Buffer:t,Qs=ho.Symbol,Gn=ho.Uint8Array,zi=Cn?Cn.allocUnsafe:t,wn=xp(ve.getPrototypeOf,ve),Ro=ve.create,Qo=lt.propertyIsEnumerable,oo=Ue.splice,Yt=Qs?Qs.isConcatSpreadable:t,Ht=Qs?Qs.iterator:t,To=Qs?Qs.toStringTag:t,vo=function(){try{var c=Mp(ve,"defineProperty");return c({},"",{}),c}catch{}}(),Ot=ho.clearTimeout!==ns.clearTimeout&&ho.clearTimeout,Yo=gn&&gn.now!==ns.Date.now&&gn.now,is=ho.setTimeout!==ns.setTimeout&&ho.setTimeout,vs=te.ceil,Rs=te.floor,Ws=ve.getOwnPropertySymbols,li=Cn?Cn.isBuffer:t,an=ho.isFinite,Br=Ue.join,ya=xp(ve.keys,ve),As=te.max,qs=te.min,Jn=gn.now,Pi=ho.parseInt,_l=te.random,ur=Ue.reverse,yl=Mp(ho,"DataView"),kn=Mp(ho,"Map"),Sr=Mp(ho,"Promise"),Ba=Mp(ho,"Set"),Pt=Mp(ho,"WeakMap"),Ut=Mp(ve,"create"),xs=Pt&&new Pt,fs={},rs=Tp(yl),mn=Tp(kn),Ds=Tp(Sr),sn=Tp(Ba),na=Tp(Pt),Wo=Qs?Qs.prototype:t,Pl=Wo?Wo.valueOf:t,El=Wo?Wo.toString:t;function fe(c){if(zs(c)&&!as(c)&&!(c instanceof vi)){if(c instanceof pi)return c;if(Kt.call(c,"__wrapped__"))return yg(c)}return new pi(c)}var No=function(){function c(){}return function(m){if(!jo(m))return{};if(Ro)return Ro(m);c.prototype=m;var C=new c;return c.prototype=t,C}}();function gs(){}function pi(c,m){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!m,this.__index__=0,this.__values__=t}fe.templateSettings={escape:ii,evaluate:Xa,interpolate:Ja,variable:"",imports:{_:fe}},fe.prototype=gs.prototype,fe.prototype.constructor=fe,pi.prototype=No(gs.prototype),pi.prototype.constructor=pi;function vi(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function Na(){var c=new vi(this.__wrapped__);return c.__actions__=Hd(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=Hd(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=Hd(this.__views__),c}function Xl(){if(this.__filtered__){var c=new vi(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function cd(){var c=this.__wrapped__.value(),m=this.__dir__,C=as(c),W=m<0,ae=C?c.length:0,Te=ag(0,ae,this.__views__),ot=Te.start,gt=Te.end,Nt=gt-ot,qo=W?gt:ot-1,Go=this.__iteratees__,ls=Go.length,Fn=0,er=qs(Nt,this.__takeCount__);if(!C||!W&&ae==Nt&&er==Nt)return q0(c,this.__actions__);var Kr=[];e:for(;Nt--&&Fn<er;){qo+=m;for(var ja=-1,Zr=c[qo];++ja<ls;){var il=Go[ja],pl=il.iteratee,bu=il.type,tu=pl(Zr);if(bu==ie)Zr=tu;else if(!tu){if(bu==se)continue e;break e}}Kr[Fn++]=Zr}return Kr}vi.prototype=No(gs.prototype),vi.prototype.constructor=vi;function Be(c){var m=-1,C=c==null?0:c.length;for(this.clear();++m<C;){var W=c[m];this.set(W[0],W[1])}}function Bt(){this.__data__=Ut?Ut(null):{},this.size=0}function Gs(c){var m=this.has(c)&&delete this.__data__[c];return this.size-=m?1:0,m}function Cr(c){var m=this.__data__;if(Ut){var C=m[c];return C===d?t:C}return Kt.call(m,c)?m[c]:t}function Da(c){var m=this.__data__;return Ut?m[c]!==t:Kt.call(m,c)}function ic(c,m){var C=this.__data__;return this.size+=this.has(c)?0:1,C[c]=Ut&&m===t?d:m,this}Be.prototype.clear=Bt,Be.prototype.delete=Gs,Be.prototype.get=Cr,Be.prototype.has=Da,Be.prototype.set=ic;function Jr(c){var m=-1,C=c==null?0:c.length;for(this.clear();++m<C;){var W=c[m];this.set(W[0],W[1])}}function bl(){this.__data__=[],this.size=0}function dd(c){var m=this.__data__,C=xa(m,c);if(C<0)return!1;var W=m.length-1;return C==W?m.pop():oo.call(m,C,1),--this.size,!0}function yc(c){var m=this.__data__,C=xa(m,c);return C<0?t:m[C][1]}function bc(c){return xa(this.__data__,c)>-1}function st(c,m){var C=this.__data__,W=xa(C,c);return W<0?(++this.size,C.push([c,m])):C[W][1]=m,this}Jr.prototype.clear=bl,Jr.prototype.delete=dd,Jr.prototype.get=yc,Jr.prototype.has=bc,Jr.prototype.set=st;function ia(c){var m=-1,C=c==null?0:c.length;for(this.clear();++m<C;){var W=c[m];this.set(W[0],W[1])}}function Oc(){this.size=0,this.__data__={hash:new Be,map:new(kn||Jr),string:new Be}}function Zd(c){var m=qv(this,c).delete(c);return this.size-=m?1:0,m}function fu(c){return qv(this,c).get(c)}function fi(c){return qv(this,c).has(c)}function Il(c,m){var C=qv(this,c),W=C.size;return C.set(c,m),this.size+=C.size==W?0:1,this}ia.prototype.clear=Oc,ia.prototype.delete=Zd,ia.prototype.get=fu,ia.prototype.has=fi,ia.prototype.set=Il;function da(c){var m=-1,C=c==null?0:c.length;for(this.__data__=new ia;++m<C;)this.add(c[m])}function Nr(c){return this.__data__.set(c,d),this}function _i(c){return this.__data__.has(c)}da.prototype.add=da.prototype.push=Nr,da.prototype.has=_i;function Wl(c){var m=this.__data__=new Jr(c);this.size=m.size}function Zi(){this.__data__=new Jr,this.size=0}function ol(c){var m=this.__data__,C=m.delete(c);return this.size=m.size,C}function Ys(c){return this.__data__.get(c)}function Ld(c){return this.__data__.has(c)}function Jc(c,m){var C=this.__data__;if(C instanceof Jr){var W=C.__data__;if(!kn||W.length<i-1)return W.push([c,m]),this.size=++C.size,this;C=this.__data__=new ia(W)}return C.set(c,m),this.size=C.size,this}Wl.prototype.clear=Zi,Wl.prototype.delete=ol,Wl.prototype.get=Ys,Wl.prototype.has=Ld,Wl.prototype.set=Jc;function xl(c,m){var C=as(c),W=!C&&Vi(c),ae=!C&&!W&&ys(c),Te=!C&&!W&&!ae&&Qi(c),ot=C||W||ae||Te,gt=ot?Od(c.length,Re):[],Nt=gt.length;for(var qo in c)(m||Kt.call(c,qo))&&!(ot&&(qo=="length"||ae&&(qo=="offset"||qo=="parent")||Te&&(qo=="buffer"||qo=="byteLength"||qo=="byteOffset")||Gu(qo,Nt)))&&gt.push(qo);return gt}function $l(c){var m=c.length;return m?c[Fv(0,m-1)]:t}function ba(c,m){return _v(Hd(c),Xd(m,0,c.length))}function Qr(c){return _v(Hd(c))}function Fi(c,m,C){(C!==t&&!An(c[m],C)||C===t&&!(m in c))&&ed(c,m,C)}function Hs(c,m,C){var W=c[m];(!(Kt.call(c,m)&&An(W,C))||C===t&&!(m in c))&&ed(c,m,C)}function xa(c,m){for(var C=c.length;C--;)if(An(c[C][0],m))return C;return-1}function gi(c,m,C,W){return Ml(c,function(ae,Te,ot){m(W,ae,C(ae),ot)}),W}function Qc(c,m){return c&&Au(m,ec(m),c)}function Hu(c,m){return c&&Au(m,cl(m),c)}function ed(c,m,C){m=="__proto__"&&vo?vo(c,m,{configurable:!0,enumerable:!0,value:C,writable:!0}):c[m]=C}function td(c,m){for(var C=-1,W=m.length,ae=no(W),Te=c==null;++C<W;)ae[C]=Te?t:Ed(c,m[C]);return ae}function Xd(c,m,C){return c===c&&(C!==t&&(c=c<=C?c:C),m!==t&&(c=c>=m?c:m)),c}function Mr(c,m,C,W,ae,Te){var ot,gt=m&_,Nt=m&y,qo=m&w;if(C&&(ot=ae?C(c,W,ae,Te):C(c)),ot!==t)return ot;if(!jo(c))return c;var Go=as(c);if(Go){if(ot=_h(c),!gt)return Hd(c,ot)}else{var ls=xd(c),Fn=ls==Je||ls==ye;if(ys(c))return dh(c,gt);if(ls==ke||ls==he||Fn&&!ae){if(ot=Nt||Fn?{}:Ef(c),!gt)return Nt?ph(c,Hu(ot,c)):uh(c,Qc(ot,c))}else{if(!ko[ls])return ae?c:{};ot=yh(c,ls,gt)}}Te||(Te=new Wl);var er=Te.get(c);if(er)return er;Te.set(c,ot),ma(c)?c.forEach(function(Zr){ot.add(Mr(Zr,m,C,Zr,c,Te))}):Ti(c)&&c.forEach(function(Zr,il){ot.set(il,Mr(Zr,m,C,il,c,Te))});var Kr=qo?Nt?Wv:Vv:Nt?cl:ec,ja=Go?t:Kr(c);return us(ja||c,function(Zr,il){ja&&(il=Zr,Zr=c[il]),Hs(ot,il,Mr(Zr,m,C,il,c,Te))}),ot}function Pa(c){var m=ec(c);return function(C){return Ma(C,c,m)}}function Ma(c,m,C){var W=C.length;if(c==null)return!W;for(c=ve(c);W--;){var ae=C[W],Te=m[ae],ot=c[ae];if(ot===t&&!(ae in c)||!Te(ot))return!1}return!0}function wl(c,m,C){if(typeof c!="function")throw new je(a);return sv(function(){c.apply(t,C)},m)}function ga(c,m,C,W){var ae=-1,Te=on,ot=!0,gt=c.length,Nt=[],qo=m.length;if(!gt)return Nt;C&&(m=In(m,tl(C))),W?(Te=_s,ot=!1):m.length>=i&&(Te=Rc,ot=!1,m=new da(m));e:for(;++ae<gt;){var Go=c[ae],ls=C==null?Go:C(Go);if(Go=W||Go!==0?Go:0,ot&&ls===ls){for(var Fn=qo;Fn--;)if(m[Fn]===ls)continue e;Nt.push(Go)}else Te(m,ls,W)||Nt.push(Go)}return Nt}var Ml=Z0(At),fc=Z0(io,!0);function rp(c,m){var C=!0;return Ml(c,function(W,ae,Te){return C=!!m(W,ae,Te),C}),C}function au(c,m,C){for(var W=-1,ae=c.length;++W<ae;){var Te=c[W],ot=m(Te);if(ot!=null&&(gt===t?ot===ot&&!ra(ot):C(ot,gt)))var gt=ot,Nt=Te}return Nt}function ud(c,m,C,W){var ae=c.length;for(C=Si(C),C<0&&(C=-C>ae?0:ae+C),W=W===t||W>ae?ae:Si(W),W<0&&(W+=ae),W=C>W?0:kc(W);C<W;)c[C++]=m;return c}function tt(c,m){var C=[];return Ml(c,function(W,ae,Te){m(W,ae,Te)&&C.push(W)}),C}function Gt(c,m,C,W,ae){var Te=-1,ot=c.length;for(C||(C=lg),ae||(ae=[]);++Te<ot;){var gt=c[Te];m>0&&C(gt)?m>1?Gt(gt,m-1,C,W,ae):Ci(ae,gt):W||(ae[ae.length]=gt)}return ae}var dt=X0(),Tt=X0(!0);function At(c,m){return c&&dt(c,m,ec)}function io(c,m){return c&&Tt(c,m,ec)}function co(c,m){return js(m,function(C){return Wn(c[C])})}function wo(c,m){m=Pp(m,c);for(var C=0,W=m.length;c!=null&&C<W;)c=c[mu(m[C++])];return C&&C==W?c:t}function $o(c,m,C){var W=m(c);return as(c)?W:Ci(W,C(c))}function ws(c){return c==null?c===t?Qe:xe:To&&To in ve(c)?rg(c):vg(c)}function _o(c,m){return c>m}function po(c,m){return c!=null&&Kt.call(c,m)}function Es(c,m){return c!=null&&m in ve(c)}function ms(c,m,C){return c>=qs(m,C)&&c<As(m,C)}function Qn(c,m,C){for(var W=C?_s:on,ae=c[0].length,Te=c.length,ot=Te,gt=no(Te),Nt=1/0,qo=[];ot--;){var Go=c[ot];ot&&m&&(Go=In(Go,tl(m))),Nt=qs(Go.length,Nt),gt[ot]=!C&&(m||ae>=120&&Go.length>=120)?new da(ot&&Go):t}Go=c[0];var ls=-1,Fn=gt[0];e:for(;++ls<ae&&qo.length<Nt;){var er=Go[ls],Kr=m?m(er):er;if(er=C||er!==0?er:0,!(Fn?Rc(Fn,Kr):W(qo,Kr,C))){for(ot=Te;--ot;){var ja=gt[ot];if(!(ja?Rc(ja,Kr):W(c[ot],Kr,C)))continue e}Fn&&Fn.push(Kr),qo.push(er)}}return qo}function hn(c,m,C,W){return At(c,function(ae,Te,ot){m(W,C(ae),Te,ot)}),W}function Bi(c,m,C){m=Pp(m,c),c=Bf(c,m);var W=c==null?c:c[mu(Qd(m))];return W==null?t:qt(W,c,C)}function qr(c){return zs(c)&&ws(c)==he}function mi(c){return zs(c)&&ws(c)==Lt}function ql(c){return zs(c)&&ws(c)==$e}function rc(c,m,C,W,ae){return c===m?!0:c==null||m==null||!zs(c)&&!zs(m)?c!==c&&m!==m:pd(c,m,C,W,rc,ae)}function pd(c,m,C,W,ae,Te){var ot=as(c),gt=as(m),Nt=ot?De:xd(c),qo=gt?De:xd(m);Nt=Nt==he?ke:Nt,qo=qo==he?ke:qo;var Go=Nt==ke,ls=qo==ke,Fn=Nt==qo;if(Fn&&ys(c)){if(!ys(m))return!1;ot=!0,Go=!1}if(Fn&&!Go)return Te||(Te=new Wl),ot||Qi(c)?Tf(c,m,C,W,ae,Te):ig(c,m,Nt,C,W,ae,Te);if(!(C&k)){var er=Go&&Kt.call(c,"__wrapped__"),Kr=ls&&Kt.call(m,"__wrapped__");if(er||Kr){var ja=er?c.value():c,Zr=Kr?m.value():m;return Te||(Te=new Wl),ae(ja,Zr,C,W,Te)}}return Fn?(Te||(Te=new Wl),mh(c,m,C,W,ae,Te)):!1}function Fd(c){return zs(c)&&xd(c)==Ae}function jl(c,m,C,W){var ae=C.length,Te=ae,ot=!W;if(c==null)return!Te;for(c=ve(c);ae--;){var gt=C[ae];if(ot&&gt[2]?gt[1]!==c[gt[0]]:!(gt[0]in c))return!1}for(;++ae<Te;){gt=C[ae];var Nt=gt[0],qo=c[Nt],Go=gt[1];if(ot&&gt[2]){if(qo===t&&!(Nt in c))return!1}else{var ls=new Wl;if(W)var Fn=W(qo,Go,Nt,c,m,ls);if(!(Fn===t?rc(Go,qo,k|S,W,ls):Fn))return!1}}return!0}function bd(c){if(!jo(c)||dg(c))return!1;var m=Wn(c)?Vo:Qt;return m.test(Tp(c))}function Vc(c){return zs(c)&&ws(c)==ne}function Pc(c){return zs(c)&&xd(c)==J}function zl(c){return zs(c)&&$s(c.length)&&!!so[ws(c)]}function Hr(c){return typeof c=="function"?c:c==null?lu:typeof c=="object"?as(c)?Tu(c[0],c[1]):Jp(c):M1(c)}function gl(c){if(!ov(c))return ya(c);var m=[];for(var C in ve(c))Kt.call(c,C)&&C!="constructor"&&m.push(C);return m}function ac(c){if(!jo(c))return kh(c);var m=ov(c),C=[];for(var W in c)W=="constructor"&&(m||!Kt.call(c,W))||C.push(W);return C}function Bl(c,m){return c<m}function Lv(c,m){var C=-1,W=Vn(c)?no(c.length):[];return Ml(c,function(ae,Te,ot){W[++C]=m(ae,Te,ot)}),W}function Jp(c){var m=Hv(c);return m.length==1&&m[0][2]?zf(m[0][0],m[0][1]):function(C){return C===c||jl(C,c,m)}}function Tu(c,m){return $f(c)&&ug(m)?zf(mu(c),m):function(C){var W=Ed(C,c);return W===t&&W===m?Du(C,c):rc(m,W,k|S)}}function Cp(c,m,C,W,ae){c!==m&&dt(m,function(Te,ot){if(ae||(ae=new Wl),jo(Te))mf(c,m,ot,C,Cp,W,ae);else{var gt=W?W(Gv(c,ot),Te,ot+"",c,m,ae):t;gt===t&&(gt=Te),Fi(c,ot,gt)}},cl)}function mf(c,m,C,W,ae,Te,ot){var gt=Gv(c,C),Nt=Gv(m,C),qo=ot.get(Nt);if(qo){Fi(c,C,qo);return}var Go=Te?Te(gt,Nt,C+"",c,m,ot):t,ls=Go===t;if(ls){var Fn=as(Nt),er=!Fn&&ys(Nt),Kr=!Fn&&!er&&Qi(Nt);Go=Nt,Fn||er||Kr?as(gt)?Go=gt:Ks(gt)?Go=Hd(gt):er?(ls=!1,Go=dh(Nt,!0)):Kr?(ls=!1,Go=fv(Nt,!0)):Go=[]:Yr(Nt)||Vi(Nt)?(Go=gt,Vi(gt)?Go=Tc(gt):(!jo(gt)||Wn(gt))&&(Go=Ef(Nt))):ls=!1}ls&&(ot.set(Nt,Go),ae(Go,Nt,W,Te,ot),ot.delete(Nt)),Fi(c,C,Go)}function Jd(c,m){var C=c.length;if(C)return m+=m<0?C:0,Gu(m,C)?c[m]:t}function jc(c,m,C){m.length?m=In(m,function(Te){return as(Te)?function(ot){return wo(ot,Te.length===1?Te[0]:Te)}:Te}):m=[lu];var W=-1;m=In(m,tl(Tr()));var ae=Lv(c,function(Te,ot,gt){var Nt=In(m,function(qo){return qo(Te)});return{criteria:Nt,index:++W,value:Te}});return _c(ae,function(Te,ot){return zv(Te,ot,C)})}function ap(c,m){return gu(c,m,function(C,W){return Du(c,W)})}function gu(c,m,C){for(var W=-1,ae=m.length,Te={};++W<ae;){var ot=m[W],gt=wo(c,ot);C(gt,ot)&&pv(Te,Pp(ot,c),gt)}return Te}function nh(c){return function(m){return wo(m,c)}}function hf(c,m,C,W){var ae=W?ul:Vl,Te=-1,ot=m.length,gt=c;for(c===m&&(m=Hd(m)),C&&(gt=In(c,tl(C)));++Te<ot;)for(var Nt=0,qo=m[Te],Go=C?C(qo):qo;(Nt=ae(gt,Go,Nt,W))>-1;)gt!==c&&oo.call(gt,Nt,1),oo.call(c,Nt,1);return c}function uv(c,m){for(var C=c?m.length:0,W=C-1;C--;){var ae=m[C];if(C==W||ae!==Te){var Te=ae;Gu(ae)?oo.call(c,ae,1):wf(c,ae)}}return c}function Fv(c,m){return c+Rs(_l()*(m-c+1))}function _f(c,m,C,W){for(var ae=-1,Te=As(vs((m-c)/(C||1)),0),ot=no(Te);Te--;)ot[W?Te:++ae]=c,c+=C;return ot}function yf(c,m){var C="";if(!c||m<1||m>Q)return C;do m%2&&(C+=c),m=Rs(m/2),m&&(c+=c);while(m);return C}function ua(c,m){return Nf(fg(c,m,lu),c+"")}function bf(c){return $l(vp(c))}function xf(c,m){var C=vp(c);return _v(C,Xd(m,0,C.length))}function pv(c,m,C,W){if(!jo(c))return c;m=Pp(m,c);for(var ae=-1,Te=m.length,ot=Te-1,gt=c;gt!=null&&++ae<Te;){var Nt=mu(m[ae]),qo=C;if(Nt==="__proto__"||Nt==="constructor"||Nt==="prototype")return c;if(ae!=ot){var Go=gt[Nt];qo=W?W(Go,Nt,gt):t,qo===t&&(qo=jo(Go)?Go:Gu(m[ae+1])?[]:{})}Hs(gt,Nt,qo),gt=gt[Nt]}return c}var R0=xs?function(c,m){return xs.set(c,m),c}:lu,ih=vo?function(c,m){return vo(c,"toString",{configurable:!0,enumerable:!1,value:xv(m),writable:!0})}:lu;function rh(c){return _v(vp(c))}function Wd(c,m,C){var W=-1,ae=c.length;m<0&&(m=-m>ae?0:ae+m),C=C>ae?ae:C,C<0&&(C+=ae),ae=m>C?0:C-m>>>0,m>>>=0;for(var Te=no(ae);++W<ae;)Te[W]=c[W+m];return Te}function ah(c,m){var C;return Ml(c,function(W,ae,Te){return C=m(W,ae,Te),!C}),!!C}function vv(c,m,C){var W=0,ae=c==null?W:c.length;if(typeof m=="number"&&m===m&&ae<=Pe){for(;W<ae;){var Te=W+ae>>>1,ot=c[Te];ot!==null&&!ra(ot)&&(C?ot<=m:ot<m)?W=Te+1:ae=Te}return ae}return Dv(c,m,lu,C)}function Dv(c,m,C,W){var ae=0,Te=c==null?0:c.length;if(Te===0)return 0;m=C(m);for(var ot=m!==m,gt=m===null,Nt=ra(m),qo=m===t;ae<Te;){var Go=Rs((ae+Te)/2),ls=C(c[Go]),Fn=ls!==t,er=ls===null,Kr=ls===ls,ja=ra(ls);if(ot)var Zr=W||Kr;else qo?Zr=Kr&&(W||Fn):gt?Zr=Kr&&Fn&&(W||!er):Nt?Zr=Kr&&Fn&&!er&&(W||!ja):er||ja?Zr=!1:Zr=W?ls<=m:ls<m;Zr?ae=Go+1:Te=Go}return qs(Te,me)}function O0(c,m){for(var C=-1,W=c.length,ae=0,Te=[];++C<W;){var ot=c[C],gt=m?m(ot):ot;if(!C||!An(gt,Nt)){var Nt=gt;Te[ae++]=ot===0?0:ot}}return Te}function V0(c){return typeof c=="number"?c:ra(c)?ce:+c}function qd(c){if(typeof c=="string")return c;if(as(c))return In(c,qd)+"";if(ra(c))return El?El.call(c):"";var m=c+"";return m=="0"&&1/c==-K?"-0":m}function lp(c,m,C){var W=-1,ae=on,Te=c.length,ot=!0,gt=[],Nt=gt;if(C)ot=!1,ae=_s;else if(Te>=i){var qo=m?null:og(c);if(qo)return sp(qo);ot=!1,ae=Rc,Nt=new da}else Nt=m?[]:gt;e:for(;++W<Te;){var Go=c[W],ls=m?m(Go):Go;if(Go=C||Go!==0?Go:0,ot&&ls===ls){for(var Fn=Nt.length;Fn--;)if(Nt[Fn]===ls)continue e;m&&Nt.push(ls),gt.push(Go)}else ae(Nt,ls,C)||(Nt!==gt&&Nt.push(ls),gt.push(Go))}return gt}function wf(c,m){return m=Pp(m,c),c=Bf(c,m),c==null||delete c[mu(Qd(m))]}function W0(c,m,C,W){return pv(c,m,C(wo(c,m)),W)}function Ev(c,m,C,W){for(var ae=c.length,Te=W?ae:-1;(W?Te--:++Te<ae)&&m(c[Te],Te,c););return C?Wd(c,W?0:Te,W?Te+1:ae):Wd(c,W?Te+1:0,W?ae:Te)}function q0(c,m){var C=c;return C instanceof vi&&(C=C.value()),zr(m,function(W,ae){return ae.func.apply(ae.thisArg,Ci([W],ae.args))},C)}function kf(c,m,C){var W=c.length;if(W<2)return W?lp(c[0]):[];for(var ae=-1,Te=no(W);++ae<W;)for(var ot=c[ae],gt=-1;++gt<W;)gt!=ae&&(Te[ae]=ga(Te[ae]||ot,c[gt],m,C));return lp(Gt(Te,1),m,C)}function lh(c,m,C){for(var W=-1,ae=c.length,Te=m.length,ot={};++W<ae;){var gt=W<Te?m[W]:t;C(ot,c[W],gt)}return ot}function H0(c){return Ks(c)?c:[]}function G0(c){return typeof c=="function"?c:lu}function Pp(c,m){return as(c)?c:$f(c,m)?[c]:hg(Er(c))}var P1=ua;function Ip(c,m,C){var W=c.length;return C=C===t?W:C,!m&&C>=W?c:Wd(c,m,C)}var ch=Ot||function(c){return ns.clearTimeout(c)};function dh(c,m){if(m)return c.slice();var C=c.length,W=zi?zi(C):new c.constructor(C);return c.copy(W),W}function Y0(c){var m=new c.constructor(c.byteLength);return new Gn(m).set(new Gn(c)),m}function I1(c,m){var C=m?Y0(c.buffer):c.buffer;return new c.constructor(C,c.byteOffset,c.byteLength)}function $v(c){var m=new c.constructor(c.source,pe.exec(c));return m.lastIndex=c.lastIndex,m}function jv(c){return Pl?ve(Pl.call(c)):{}}function fv(c,m){var C=m?Y0(c.buffer):c.buffer;return new c.constructor(C,c.byteOffset,c.length)}function gv(c,m){if(c!==m){var C=c!==t,W=c===null,ae=c===c,Te=ra(c),ot=m!==t,gt=m===null,Nt=m===m,qo=ra(m);if(!gt&&!qo&&!Te&&c>m||Te&&ot&&Nt&&!gt&&!qo||W&&ot&&Nt||!C&&Nt||!ae)return 1;if(!W&&!Te&&!qo&&c<m||qo&&C&&ae&&!W&&!Te||gt&&C&&ae||!ot&&ae||!Nt)return-1}return 0}function zv(c,m,C){for(var W=-1,ae=c.criteria,Te=m.criteria,ot=ae.length,gt=C.length;++W<ot;){var Nt=gv(ae[W],Te[W]);if(Nt){if(W>=gt)return Nt;var qo=C[W];return Nt*(qo=="desc"?-1:1)}}return c.index-m.index}function U0(c,m,C,W){for(var ae=-1,Te=c.length,ot=C.length,gt=-1,Nt=m.length,qo=As(Te-ot,0),Go=no(Nt+qo),ls=!W;++gt<Nt;)Go[gt]=m[gt];for(;++ae<ot;)(ls||ae<Te)&&(Go[C[ae]]=c[ae]);for(;qo--;)Go[gt++]=c[ae++];return Go}function K0(c,m,C,W){for(var ae=-1,Te=c.length,ot=-1,gt=C.length,Nt=-1,qo=m.length,Go=As(Te-gt,0),ls=no(Go+qo),Fn=!W;++ae<Go;)ls[ae]=c[ae];for(var er=ae;++Nt<qo;)ls[er+Nt]=m[Nt];for(;++ot<gt;)(Fn||ae<Te)&&(ls[er+C[ot]]=c[ae++]);return ls}function Hd(c,m){var C=-1,W=c.length;for(m||(m=no(W));++C<W;)m[C]=c[C];return m}function Au(c,m,C,W){var ae=!C;C||(C={});for(var Te=-1,ot=m.length;++Te<ot;){var gt=m[Te],Nt=W?W(C[gt],c[gt],gt,C,c):t;Nt===t&&(Nt=c[gt]),ae?ed(C,gt,Nt):Hs(C,gt,Nt)}return C}function uh(c,m){return Au(c,Lf(c),m)}function ph(c,m){return Au(c,Ff(c),m)}function Bv(c,m){return function(C,W){var ae=as(C)?Io:gi,Te=m?m():{};return ae(C,c,Tr(W,2),Te)}}function Qp(c){return ua(function(m,C){var W=-1,ae=C.length,Te=ae>1?C[ae-1]:t,ot=ae>2?C[2]:t;for(Te=c.length>3&&typeof Te=="function"?(ae--,Te):t,ot&&wd(C[0],C[1],ot)&&(Te=ae<3?t:Te,ae=1),m=ve(m);++W<ae;){var gt=C[W];gt&&c(m,gt,W,Te)}return m})}function Z0(c,m){return function(C,W){if(C==null)return C;if(!Vn(C))return c(C,W);for(var ae=C.length,Te=m?ae:-1,ot=ve(C);(m?Te--:++Te<ae)&&W(ot[Te],Te,ot)!==!1;);return C}}function X0(c){return function(m,C,W){for(var ae=-1,Te=ve(m),ot=W(m),gt=ot.length;gt--;){var Nt=ot[c?gt:++ae];if(C(Te[Nt],Nt,Te)===!1)break}return m}}function vh(c,m,C){var W=m&L,ae=cp(c);function Te(){var ot=this&&this!==ns&&this instanceof Te?ae:c;return ot.apply(W?C:this,arguments)}return Te}function J0(c){return function(m){m=Er(m);var C=Ad(m)?yd(m):t,W=C?C[0]:m.charAt(0),ae=C?Ip(C,1).join(""):m.slice(1);return W[c]()+ae}}function ev(c){return function(m){return zr(Xv(Kf(m).replace(nt,"")),c,"")}}function cp(c){return function(){var m=arguments;switch(m.length){case 0:return new c;case 1:return new c(m[0]);case 2:return new c(m[0],m[1]);case 3:return new c(m[0],m[1],m[2]);case 4:return new c(m[0],m[1],m[2],m[3]);case 5:return new c(m[0],m[1],m[2],m[3],m[4]);case 6:return new c(m[0],m[1],m[2],m[3],m[4],m[5]);case 7:return new c(m[0],m[1],m[2],m[3],m[4],m[5],m[6])}var C=No(c.prototype),W=c.apply(C,m);return jo(W)?W:C}}function dp(c,m,C){var W=cp(c);function ae(){for(var Te=arguments.length,ot=no(Te),gt=Te,Nt=tv(ae);gt--;)ot[gt]=arguments[gt];var qo=Te<3&&ot[0]!==Nt&&ot[Te-1]!==Nt?[]:Xc(ot,Nt);if(Te-=qo.length,Te<C)return Pf(c,m,Nv,ae.placeholder,t,ot,qo,t,t,C-Te);var Go=this&&this!==ns&&this instanceof ae?W:c;return qt(Go,this,ot)}return ae}function Q0(c){return function(m,C,W){var ae=ve(m);if(!Vn(m)){var Te=Tr(C,3);m=ec(m),C=function(gt){return Te(ae[gt],gt,ae)}}var ot=c(m,C,W);return ot>-1?ae[Te?m[ot]:ot]:t}}function eg(c){return Fu(function(m){var C=m.length,W=C,ae=pi.prototype.thru;for(c&&m.reverse();W--;){var Te=m[W];if(typeof Te!="function")throw new je(a);if(ae&&!ot&&hv(Te)=="wrapper")var ot=new pi([],!0)}for(W=ot?W:C;++W<C;){Te=m[W];var gt=hv(Te),Nt=gt=="wrapper"?Af(Te):t;Nt&&jf(Nt[0])&&Nt[1]==(N|A|B|$)&&!Nt[4].length&&Nt[9]==1?ot=ot[hv(Nt[0])].apply(ot,Nt[3]):ot=Te.length==1&&jf(Te)?ot[gt]():ot.thru(Te)}return function(){var qo=arguments,Go=qo[0];if(ot&&qo.length==1&&as(Go))return ot.plant(Go).value();for(var ls=0,Fn=C?m[ls].apply(this,qo):Go;++ls<C;)Fn=m[ls].call(this,Fn);return Fn}})}function Nv(c,m,C,W,ae,Te,ot,gt,Nt,qo){var Go=m&N,ls=m&L,Fn=m&T,er=m&(A|F),Kr=m&V,ja=Fn?t:cp(c);function Zr(){for(var il=arguments.length,pl=no(il),bu=il;bu--;)pl[bu]=arguments[bu];if(er)var tu=tv(Zr),xu=uu(pl,tu);if(W&&(pl=U0(pl,W,ae,er)),Te&&(pl=K0(pl,Te,ot,er)),il-=xu,er&&il<qo){var Gc=Xc(pl,tu);return Pf(c,m,Nv,Zr.placeholder,C,pl,Gc,gt,Nt,qo-il)}var Uu=ls?C:this,Dp=Fn?Uu[c]:c;return il=pl.length,gt?pl=Sh(pl,gt):Kr&&il>1&&pl.reverse(),Go&&Nt<il&&(pl.length=Nt),this&&this!==ns&&this instanceof Zr&&(Dp=ja||cp(Dp)),Dp.apply(Uu,pl)}return Zr}function tg(c,m){return function(C,W){return hn(C,c,m(W),{})}}function Rv(c,m){return function(C,W){var ae;if(C===t&&W===t)return m;if(C!==t&&(ae=C),W!==t){if(ae===t)return W;typeof C=="string"||typeof W=="string"?(C=qd(C),W=qd(W)):(C=V0(C),W=V0(W)),ae=c(C,W)}return ae}}function Sf(c){return Fu(function(m){return m=In(m,tl(Tr())),ua(function(C){var W=this;return c(m,function(ae){return qt(ae,W,C)})})})}function Ov(c,m){m=m===t?" ":qd(m);var C=m.length;if(C<2)return C?yf(m,c):m;var W=yf(m,vs(c/vu(m)));return Ad(m)?Ip(yd(W),0,c).join(""):W.slice(0,c)}function fh(c,m,C,W){var ae=m&L,Te=cp(c);function ot(){for(var gt=-1,Nt=arguments.length,qo=-1,Go=W.length,ls=no(Go+Nt),Fn=this&&this!==ns&&this instanceof ot?Te:c;++qo<Go;)ls[qo]=W[qo];for(;Nt--;)ls[qo++]=arguments[++gt];return qt(Fn,ae?C:this,ls)}return ot}function Cf(c){return function(m,C,W){return W&&typeof W!="number"&&wd(m,C,W)&&(C=W=t),m=Ya(m),C===t?(C=m,m=0):C=Ya(C),W=W===t?m<C?1:-1:Ya(W),_f(m,C,W,c)}}function mv(c){return function(m,C){return typeof m=="string"&&typeof C=="string"||(m=Ua(m),C=Ua(C)),c(m,C)}}function Pf(c,m,C,W,ae,Te,ot,gt,Nt,qo){var Go=m&A,ls=Go?ot:t,Fn=Go?t:ot,er=Go?Te:t,Kr=Go?t:Te;m|=Go?B:R,m&=~(Go?R:B),m&P||(m&=~(L|T));var ja=[c,m,ae,er,ls,Kr,Fn,gt,Nt,qo],Zr=C.apply(t,ja);return jf(c)&&gg(Zr,ja),Zr.placeholder=W,Rf(Zr,c,m)}function If(c){var m=te[c];return function(C,W){if(C=Ua(C),W=W==null?0:qs(Si(W),292),W&&an(C)){var ae=(Er(C)+"e").split("e"),Te=m(ae[0]+"e"+(+ae[1]+W));return ae=(Er(Te)+"e").split("e"),+(ae[0]+"e"+(+ae[1]-W))}return m(C)}}var og=Ba&&1/sp(new Ba([,-0]))[1]==K?function(c){return new Ba(c)}:Xh;function sg(c){return function(m){var C=xd(m);return C==Ae?bp(m):C==J?wp(m):Hc(m,c(m))}}function Lu(c,m,C,W,ae,Te,ot,gt){var Nt=m&T;if(!Nt&&typeof c!="function")throw new je(a);var qo=W?W.length:0;if(qo||(m&=~(B|R),W=ae=t),ot=ot===t?ot:As(Si(ot),0),gt=gt===t?gt:Si(gt),qo-=ae?ae.length:0,m&R){var Go=W,ls=ae;W=ae=t}var Fn=Nt?t:Af(c),er=[c,m,C,W,ae,Go,ls,Te,ot,gt];if(Fn&&pg(er,Fn),c=er[0],m=er[1],C=er[2],W=er[3],ae=er[4],gt=er[9]=er[9]===t?Nt?0:c.length:As(er[9]-qo,0),!gt&&m&(A|F)&&(m&=~(A|F)),!m||m==L)var Kr=vh(c,m,C);else m==A||m==F?Kr=dp(c,m,gt):(m==B||m==(L|B))&&!ae.length?Kr=fh(c,m,C,W):Kr=Nv.apply(t,er);var ja=Fn?R0:gg;return Rf(ja(Kr,er),c,m)}function ng(c,m,C,W){return c===t||An(c,lt[C])&&!Kt.call(W,C)?m:c}function Mf(c,m,C,W,ae,Te){return jo(c)&&jo(m)&&(Te.set(m,c),Cp(c,m,t,Mf,Te),Te.delete(m)),c}function gh(c){return Yr(c)?t:c}function Tf(c,m,C,W,ae,Te){var ot=C&k,gt=c.length,Nt=m.length;if(gt!=Nt&&!(ot&&Nt>gt))return!1;var qo=Te.get(c),Go=Te.get(m);if(qo&&Go)return qo==m&&Go==c;var ls=-1,Fn=!0,er=C&S?new da:t;for(Te.set(c,m),Te.set(m,c);++ls<gt;){var Kr=c[ls],ja=m[ls];if(W)var Zr=ot?W(ja,Kr,ls,m,c,Te):W(Kr,ja,ls,c,m,Te);if(Zr!==t){if(Zr)continue;Fn=!1;break}if(er){if(!hl(m,function(il,pl){if(!Rc(er,pl)&&(Kr===il||ae(Kr,il,C,W,Te)))return er.push(pl)})){Fn=!1;break}}else if(!(Kr===ja||ae(Kr,ja,C,W,Te))){Fn=!1;break}}return Te.delete(c),Te.delete(m),Fn}function ig(c,m,C,W,ae,Te,ot){switch(C){case It:if(c.byteLength!=m.byteLength||c.byteOffset!=m.byteOffset)return!1;c=c.buffer,m=m.buffer;case Lt:return!(c.byteLength!=m.byteLength||!Te(new Gn(c),new Gn(m)));case be:case $e:case ee:return An(+c,+m);case Ce:return c.name==m.name&&c.message==m.message;case ne:case qe:return c==m+"";case Ae:var gt=bp;case J:var Nt=W&k;if(gt||(gt=sp),c.size!=m.size&&!Nt)return!1;var qo=ot.get(c);if(qo)return qo==m;W|=S,ot.set(c,m);var Go=Tf(gt(c),gt(m),W,ae,Te,ot);return ot.delete(c),Go;case ft:if(Pl)return Pl.call(c)==Pl.call(m)}return!1}function mh(c,m,C,W,ae,Te){var ot=C&k,gt=Vv(c),Nt=gt.length,qo=Vv(m),Go=qo.length;if(Nt!=Go&&!ot)return!1;for(var ls=Nt;ls--;){var Fn=gt[ls];if(!(ot?Fn in m:Kt.call(m,Fn)))return!1}var er=Te.get(c),Kr=Te.get(m);if(er&&Kr)return er==m&&Kr==c;var ja=!0;Te.set(c,m),Te.set(m,c);for(var Zr=ot;++ls<Nt;){Fn=gt[ls];var il=c[Fn],pl=m[Fn];if(W)var bu=ot?W(pl,il,Fn,m,c,Te):W(il,pl,Fn,c,m,Te);if(!(bu===t?il===pl||ae(il,pl,C,W,Te):bu)){ja=!1;break}Zr||(Zr=Fn=="constructor")}if(ja&&!Zr){var tu=c.constructor,xu=m.constructor;tu!=xu&&"constructor"in c&&"constructor"in m&&!(typeof tu=="function"&&tu instanceof tu&&typeof xu=="function"&&xu instanceof xu)&&(ja=!1)}return Te.delete(c),Te.delete(m),ja}function Fu(c){return Nf(fg(c,t,Vf),c+"")}function Vv(c){return $o(c,ec,Lf)}function Wv(c){return $o(c,cl,Ff)}var Af=xs?function(c){return xs.get(c)}:Xh;function hv(c){for(var m=c.name+"",C=fs[m],W=Kt.call(fs,m)?C.length:0;W--;){var ae=C[W],Te=ae.func;if(Te==null||Te==c)return ae.name}return m}function tv(c){var m=Kt.call(fe,"placeholder")?fe:c;return m.placeholder}function Tr(){var c=fe.iteratee||Kh;return c=c===Kh?Hr:c,arguments.length?c(arguments[0],arguments[1]):c}function qv(c,m){var C=c.__data__;return cg(m)?C[typeof m=="string"?"string":"hash"]:C.map}function Hv(c){for(var m=ec(c),C=m.length;C--;){var W=m[C],ae=c[W];m[C]=[W,ae,ug(ae)]}return m}function Mp(c,m){var C=Mu(c,m);return bd(C)?C:t}function rg(c){var m=Kt.call(c,To),C=c[To];try{c[To]=t;var W=!0}catch{}var ae=Co.call(c);return W&&(m?c[To]=C:delete c[To]),ae}var Lf=Ws?function(c){return c==null?[]:(c=ve(c),js(Ws(c),function(m){return Qo.call(c,m)}))}:Jh,Ff=Ws?function(c){for(var m=[];c;)Ci(m,Lf(c)),c=wn(c);return m}:Jh,xd=ws;(yl&&xd(new yl(new ArrayBuffer(1)))!=It||kn&&xd(new kn)!=Ae||Sr&&xd(Sr.resolve())!=He||Ba&&xd(new Ba)!=J||Pt&&xd(new Pt)!=Oe)&&(xd=function(c){var m=ws(c),C=m==ke?c.constructor:t,W=C?Tp(C):"";if(W)switch(W){case rs:return It;case mn:return Ae;case Ds:return He;case sn:return J;case na:return Oe}return m});function ag(c,m,C){for(var W=-1,ae=C.length;++W<ae;){var Te=C[W],ot=Te.size;switch(Te.type){case"drop":c+=ot;break;case"dropRight":m-=ot;break;case"take":m=qs(m,c+ot);break;case"takeRight":c=As(c,m-ot);break}}return{start:c,end:m}}function hh(c){var m=c.match(vl);return m?m[1].split(ml):[]}function Df(c,m,C){m=Pp(m,c);for(var W=-1,ae=m.length,Te=!1;++W<ae;){var ot=mu(m[W]);if(!(Te=c!=null&&C(c,ot)))break;c=c[ot]}return Te||++W!=ae?Te:(ae=c==null?0:c.length,!!ae&&$s(ae)&&Gu(ot,ae)&&(as(c)||Vi(c)))}function _h(c){var m=c.length,C=new c.constructor(m);return m&&typeof c[0]=="string"&&Kt.call(c,"index")&&(C.index=c.index,C.input=c.input),C}function Ef(c){return typeof c.constructor=="function"&&!ov(c)?No(wn(c)):{}}function yh(c,m,C){var W=c.constructor;switch(m){case Lt:return Y0(c);case be:case $e:return new W(+c);case It:return I1(c,C);case zt:case pt:case Mo:case Xo:case en:case Fo:case Eo:case cs:case Zt:return fv(c,C);case Ae:return new W;case ee:case qe:return new W(c);case ne:return $v(c);case J:return new W;case ft:return jv(c)}}function bh(c,m){var C=m.length;if(!C)return c;var W=C-1;return m[W]=(C>1?"& ":"")+m[W],m=m.join(C>2?", ":" "),c.replace(Ca,`{
/* [wrapped with `+m+`] */
`)}function lg(c){return as(c)||Vi(c)||!!(Yt&&c&&c[Yt])}function Gu(c,m){var C=typeof c;return m=m??Q,!!m&&(C=="number"||C!="symbol"&&eo.test(c))&&c>-1&&c%1==0&&c<m}function wd(c,m,C){if(!jo(C))return!1;var W=typeof m;return(W=="number"?Vn(C)&&Gu(m,C.length):W=="string"&&m in C)?An(C[m],c):!1}function $f(c,m){if(as(c))return!1;var C=typeof c;return C=="number"||C=="symbol"||C=="boolean"||c==null||ra(c)?!0:Wa.test(c)||!Va.test(c)||m!=null&&c in ve(m)}function cg(c){var m=typeof c;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?c!=="__proto__":c===null}function jf(c){var m=hv(c),C=fe[m];if(typeof C!="function"||!(m in vi.prototype))return!1;if(c===C)return!0;var W=Af(C);return!!W&&c===W[0]}function dg(c){return!!jt&&jt in c}var xh=bt?Wn:Qh;function ov(c){var m=c&&c.constructor,C=typeof m=="function"&&m.prototype||lt;return c===C}function ug(c){return c===c&&!jo(c)}function zf(c,m){return function(C){return C==null?!1:C[c]===m&&(m!==t||c in ve(C))}}function wh(c){var m=xi(c,function(W){return C.size===v&&C.clear(),W}),C=m.cache;return m}function pg(c,m){var C=c[1],W=m[1],ae=C|W,Te=ae<(L|T|N),ot=W==N&&C==A||W==N&&C==$&&c[7].length<=m[8]||W==(N|$)&&m[7].length<=m[8]&&C==A;if(!(Te||ot))return c;W&L&&(c[2]=m[2],ae|=C&L?0:P);var gt=m[3];if(gt){var Nt=c[3];c[3]=Nt?U0(Nt,gt,m[4]):gt,c[4]=Nt?Xc(c[3],p):m[4]}return gt=m[5],gt&&(Nt=c[5],c[5]=Nt?K0(Nt,gt,m[6]):gt,c[6]=Nt?Xc(c[5],p):m[6]),gt=m[7],gt&&(c[7]=gt),W&N&&(c[8]=c[8]==null?m[8]:qs(c[8],m[8])),c[9]==null&&(c[9]=m[9]),c[0]=m[0],c[1]=ae,c}function kh(c){var m=[];if(c!=null)for(var C in ve(c))m.push(C);return m}function vg(c){return Co.call(c)}function fg(c,m,C){return m=As(m===t?c.length-1:m,0),function(){for(var W=arguments,ae=-1,Te=As(W.length-m,0),ot=no(Te);++ae<Te;)ot[ae]=W[m+ae];ae=-1;for(var gt=no(m+1);++ae<m;)gt[ae]=W[ae];return gt[m]=C(ot),qt(c,this,gt)}}function Bf(c,m){return m.length<2?c:wo(c,Wd(m,0,-1))}function Sh(c,m){for(var C=c.length,W=qs(m.length,C),ae=Hd(c);W--;){var Te=m[W];c[W]=Gu(Te,C)?ae[Te]:t}return c}function Gv(c,m){if(!(m==="constructor"&&typeof c[m]=="function")&&m!="__proto__")return c[m]}var gg=mg(R0),sv=is||function(c,m){return ns.setTimeout(c,m)},Nf=mg(ih);function Rf(c,m,C){var W=m+"";return Nf(c,bh(W,_g(hh(W),C)))}function mg(c){var m=0,C=0;return function(){var W=Jn(),ae=le-(W-C);if(C=W,ae>0){if(++m>=Z)return arguments[0]}else m=0;return c.apply(t,arguments)}}function _v(c,m){var C=-1,W=c.length,ae=W-1;for(m=m===t?W:m;++C<m;){var Te=Fv(C,ae),ot=c[Te];c[Te]=c[C],c[C]=ot}return c.length=m,c}var hg=wh(function(c){var m=[];return c.charCodeAt(0)===46&&m.push(""),c.replace(Qa,function(C,W,ae,Te){m.push(ae?Te.replace(or,"$1"):W||C)}),m});function mu(c){if(typeof c=="string"||ra(c))return c;var m=c+"";return m=="0"&&1/c==-K?"-0":m}function Tp(c){if(c!=null){try{return Ct.call(c)}catch{}try{return c+""}catch{}}return""}function _g(c,m){return us(ze,function(C){var W="_."+C[0];m&C[1]&&!on(c,W)&&c.push(W)}),c.sort()}function yg(c){if(c instanceof vi)return c.clone();var m=new pi(c.__wrapped__,c.__chain__);return m.__actions__=Hd(c.__actions__),m.__index__=c.__index__,m.__values__=c.__values__,m}function bg(c,m,C){(C?wd(c,m,C):m===t)?m=1:m=As(Si(m),0);var W=c==null?0:c.length;if(!W||m<1)return[];for(var ae=0,Te=0,ot=no(vs(W/m));ae<W;)ot[Te++]=Wd(c,ae,ae+=m);return ot}function Ch(c){for(var m=-1,C=c==null?0:c.length,W=0,ae=[];++m<C;){var Te=c[m];Te&&(ae[W++]=Te)}return ae}function xg(){var c=arguments.length;if(!c)return[];for(var m=no(c-1),C=arguments[0],W=c;W--;)m[W-1]=arguments[W];return Ci(as(C)?Hd(C):[C],Gt(m,1))}var Ph=ua(function(c,m){return Ks(c)?ga(c,Gt(m,1,Ks,!0)):[]}),wg=ua(function(c,m){var C=Qd(m);return Ks(C)&&(C=t),Ks(c)?ga(c,Gt(m,1,Ks,!0),Tr(C,2)):[]}),Ih=ua(function(c,m){var C=Qd(m);return Ks(C)&&(C=t),Ks(c)?ga(c,Gt(m,1,Ks,!0),t,C):[]});function kg(c,m,C){var W=c==null?0:c.length;return W?(m=C||m===t?1:Si(m),Wd(c,m<0?0:m,W)):[]}function Mh(c,m,C){var W=c==null?0:c.length;return W?(m=C||m===t?1:Si(m),m=W-m,Wd(c,0,m<0?0:m)):[]}function Sg(c,m){return c&&c.length?Ev(c,Tr(m,3),!0,!0):[]}function Th(c,m){return c&&c.length?Ev(c,Tr(m,3),!0):[]}function Cg(c,m,C,W){var ae=c==null?0:c.length;return ae?(C&&typeof C!="number"&&wd(c,m,C)&&(C=0,W=ae),ud(c,m,C,W)):[]}function Pg(c,m,C){var W=c==null?0:c.length;if(!W)return-1;var ae=C==null?0:Si(C);return ae<0&&(ae=As(W+ae,0)),Cl(c,Tr(m,3),ae)}function Of(c,m,C){var W=c==null?0:c.length;if(!W)return-1;var ae=W-1;return C!==t&&(ae=Si(C),ae=C<0?As(W+ae,0):qs(ae,W-1)),Cl(c,Tr(m,3),ae,!0)}function Vf(c){var m=c==null?0:c.length;return m?Gt(c,1):[]}function Ig(c){var m=c==null?0:c.length;return m?Gt(c,K):[]}function Mg(c,m){var C=c==null?0:c.length;return C?(m=m===t?1:Si(m),Gt(c,m)):[]}function Tg(c){for(var m=-1,C=c==null?0:c.length,W={};++m<C;){var ae=c[m];W[ae[0]]=ae[1]}return W}function Ag(c){return c&&c.length?c[0]:t}function Lg(c,m,C){var W=c==null?0:c.length;if(!W)return-1;var ae=C==null?0:Si(C);return ae<0&&(ae=As(W+ae,0)),Vl(c,m,ae)}function Ah(c){var m=c==null?0:c.length;return m?Wd(c,0,-1):[]}var Fg=ua(function(c){var m=In(c,H0);return m.length&&m[0]===c[0]?Qn(m):[]}),Lh=ua(function(c){var m=Qd(c),C=In(c,H0);return m===Qd(C)?m=t:C.pop(),C.length&&C[0]===c[0]?Qn(C,Tr(m,2)):[]}),Dg=ua(function(c){var m=Qd(c),C=In(c,H0);return m=typeof m=="function"?m:t,m&&C.pop(),C.length&&C[0]===c[0]?Qn(C,t,m):[]});function Fh(c,m){return c==null?"":Br.call(c,m)}function Qd(c){var m=c==null?0:c.length;return m?c[m-1]:t}function Dh(c,m,C){var W=c==null?0:c.length;if(!W)return-1;var ae=W;return C!==t&&(ae=Si(C),ae=ae<0?As(W+ae,0):qs(ae,W-1)),m===m?Kp(c,m,ae):Cl(c,nc,ae,!0)}function Eg(c,m){return c&&c.length?Jd(c,Si(m)):t}var Eh=ua(Wf);function Wf(c,m){return c&&c.length&&m&&m.length?hf(c,m):c}function $h(c,m,C){return c&&c.length&&m&&m.length?hf(c,m,Tr(C,2)):c}function $g(c,m,C){return c&&c.length&&m&&m.length?hf(c,m,t,C):c}var jh=Fu(function(c,m){var C=c==null?0:c.length,W=td(c,m);return uv(c,In(m,function(ae){return Gu(ae,C)?+ae:ae}).sort(gv)),W});function jg(c,m){var C=[];if(!(c&&c.length))return C;var W=-1,ae=[],Te=c.length;for(m=Tr(m,3);++W<Te;){var ot=c[W];m(ot,W,c)&&(C.push(ot),ae.push(W))}return uv(c,ae),C}function qf(c){return c==null?c:ur.call(c)}function zg(c,m,C){var W=c==null?0:c.length;return W?(C&&typeof C!="number"&&wd(c,m,C)?(m=0,C=W):(m=m==null?0:Si(m),C=C===t?W:Si(C)),Wd(c,m,C)):[]}function zh(c,m){return vv(c,m)}function Bg(c,m,C){return Dv(c,m,Tr(C,2))}function Bh(c,m){var C=c==null?0:c.length;if(C){var W=vv(c,m);if(W<C&&An(c[W],m))return W}return-1}function Ng(c,m){return vv(c,m,!0)}function Nh(c,m,C){return Dv(c,m,Tr(C,2),!0)}function Rg(c,m){var C=c==null?0:c.length;if(C){var W=vv(c,m,!0)-1;if(An(c[W],m))return W}return-1}function Rh(c){return c&&c.length?O0(c):[]}function Og(c,m){return c&&c.length?O0(c,Tr(m,2)):[]}function Oh(c){var m=c==null?0:c.length;return m?Wd(c,1,m):[]}function Vh(c,m,C){return c&&c.length?(m=C||m===t?1:Si(m),Wd(c,0,m<0?0:m)):[]}function Wh(c,m,C){var W=c==null?0:c.length;return W?(m=C||m===t?1:Si(m),m=W-m,Wd(c,m<0?0:m,W)):[]}function h(c,m){return c&&c.length?Ev(c,Tr(m,3),!1,!0):[]}function x(c,m){return c&&c.length?Ev(c,Tr(m,3)):[]}var M=ua(function(c){return lp(Gt(c,1,Ks,!0))}),I=ua(function(c){var m=Qd(c);return Ks(m)&&(m=t),lp(Gt(c,1,Ks,!0),Tr(m,2))}),D=ua(function(c){var m=Qd(c);return m=typeof m=="function"?m:t,lp(Gt(c,1,Ks,!0),t,m)});function E(c){return c&&c.length?lp(c):[]}function H(c,m){return c&&c.length?lp(c,Tr(m,2)):[]}function ue(c,m){return m=typeof m=="function"?m:t,c&&c.length?lp(c,t,m):[]}function Fe(c){if(!(c&&c.length))return[];var m=0;return c=js(c,function(C){if(Ks(C))return m=As(C.length,m),!0}),Od(m,function(C){return In(c,Zl(C))})}function it(c,m){if(!(c&&c.length))return[];var C=Fe(c);return m==null?C:In(C,function(W){return qt(m,t,W)})}var yo=ua(function(c,m){return Ks(c)?ga(c,m):[]}),ao=ua(function(c){return kf(js(c,Ks))}),Et=ua(function(c){var m=Qd(c);return Ks(m)&&(m=t),kf(js(c,Ks),Tr(m,2))}),Ls=ua(function(c){var m=Qd(c);return m=typeof m=="function"?m:t,kf(js(c,Ks),t,m)}),Mn=ua(Fe);function Ia(c,m){return lh(c||[],m||[],Hs)}function Hl(c,m){return lh(c||[],m||[],pv)}var zc=ua(function(c){var m=c.length,C=m>1?c[m-1]:t;return C=typeof C=="function"?(c.pop(),C):t,it(c,C)});function Ic(c){var m=fe(c);return m.__chain__=!0,m}function Wc(c,m){return m(c),c}function gc(c,m){return m(c)}var xc=Fu(function(c){var m=c.length,C=m?c[0]:0,W=this.__wrapped__,ae=function(Te){return td(Te,c)};return m>1||this.__actions__.length||!(W instanceof vi)||!Gu(C)?this.thru(ae):(W=W.slice(C,+C+(m?1:0)),W.__actions__.push({func:gc,args:[ae],thisArg:t}),new pi(W,this.__chain__).thru(function(Te){return m&&!Te.length&&Te.push(t),Te}))});function Mc(){return Ic(this)}function mc(){return new pi(this.value(),this.__chain__)}function lc(){this.__values__===t&&(this.__values__=dc(this.value()));var c=this.__index__>=this.__values__.length,m=c?t:this.__values__[this.__index__++];return{done:c,value:m}}function wc(){return this}function Ni(c){for(var m,C=this;C instanceof gs;){var W=yg(C);W.__index__=0,W.__values__=t,m?ae.__wrapped__=W:m=W;var ae=W;C=C.__wrapped__}return ae.__wrapped__=c,m}function aa(){var c=this.__wrapped__;if(c instanceof vi){var m=c;return this.__actions__.length&&(m=new vi(this)),m=m.reverse(),m.__actions__.push({func:gc,args:[qf],thisArg:t}),new pi(m,this.__chain__)}return this.thru(qf)}function Jl(){return q0(this.__wrapped__,this.__actions__)}var hr=Bv(function(c,m,C){Kt.call(c,C)?++c[C]:ed(c,C,1)});function ea(c,m,C){var W=as(c)?Ts:rp;return C&&wd(c,m,C)&&(m=t),W(c,Tr(m,3))}function Tl(c,m){var C=as(c)?js:tt;return C(c,Tr(m,3))}var _r=Q0(Pg),sl=Q0(Of);function Ga(c,m){return Gt(pa(c,m),1)}function ei(c,m){return Gt(pa(c,m),K)}function yr(c,m,C){return C=C===t?1:Si(C),Gt(pa(c,m),C)}function Ea(c,m){var C=as(c)?us:Ml;return C(c,Tr(m,3))}function Di(c,m){var C=as(c)?fn:fc;return C(c,Tr(m,3))}var Rr=Bv(function(c,m,C){Kt.call(c,C)?c[C].push(m):ed(c,C,[m])});function wa(c,m,C,W){c=Vn(c)?c:vp(c),C=C&&!W?Si(C):0;var ae=c.length;return C<0&&(C=As(ae+C,0)),la(c)?C<=ae&&c.indexOf(m,C)>-1:!!ae&&Vl(c,m,C)>-1}var yi=ua(function(c,m,C){var W=-1,ae=typeof m=="function",Te=Vn(c)?no(c.length):[];return Ml(c,function(ot){Te[++W]=ae?qt(m,ot,C):Bi(ot,m,C)}),Te}),Or=Bv(function(c,m,C){ed(c,C,m)});function pa(c,m){var C=as(c)?In:Lv;return C(c,Tr(m,3))}function bi(c,m,C,W){return c==null?[]:(as(m)||(m=m==null?[]:[m]),C=W?t:C,as(C)||(C=C==null?[]:[C]),jc(c,m,C))}var pr=Bv(function(c,m,C){c[C?0:1].push(m)},function(){return[[],[]]});function ta(c,m,C){var W=as(c)?zr:qc,ae=arguments.length<3;return W(c,Tr(m,4),C,ae,Ml)}function Ei(c,m,C){var W=as(c)?ca:qc,ae=arguments.length<3;return W(c,Tr(m,4),C,ae,fc)}function Yn(c,m){var C=as(c)?js:tt;return C(c,Rn(Tr(m,3)))}function Vr(c){var m=as(c)?$l:bf;return m(c)}function Hi(c,m,C){(C?wd(c,m,C):m===t)?m=1:m=Si(m);var W=as(c)?ba:xf;return W(c,m)}function Us(c){var m=as(c)?Qr:rh;return m(c)}function Gr(c){if(c==null)return 0;if(Vn(c))return la(c)?vu(c):c.length;var m=xd(c);return m==Ae||m==J?c.size:gl(c).length}function nn(c,m,C){var W=as(c)?hl:ah;return C&&wd(c,m,C)&&(m=t),W(c,Tr(m,3))}var Xi=ua(function(c,m){if(c==null)return[];var C=m.length;return C>1&&wd(c,m[0],m[1])?m=[]:C>2&&wd(m[0],m[1],m[2])&&(m=[m[0]]),jc(c,Gt(m,1),[])}),br=Yo||function(){return ns.Date.now()};function Ri(c,m){if(typeof m!="function")throw new je(a);return c=Si(c),function(){if(--c<1)return m.apply(this,arguments)}}function tn(c,m,C){return m=C?t:m,m=c&&m==null?c.length:m,Lu(c,N,t,t,t,t,m)}function ks(c,m){var C;if(typeof m!="function")throw new je(a);return c=Si(c),function(){return--c>0&&(C=m.apply(this,arguments)),c<=1&&(m=t),C}}var ci=ua(function(c,m,C){var W=L;if(C.length){var ae=Xc(C,tv(ci));W|=B}return Lu(c,W,m,C,ae)}),Ar=ua(function(c,m,C){var W=L|T;if(C.length){var ae=Xc(C,tv(Ar));W|=B}return Lu(m,W,c,C,ae)});function _n(c,m,C){m=C?t:m;var W=Lu(c,A,t,t,t,t,t,m);return W.placeholder=_n.placeholder,W}function oi(c,m,C){m=C?t:m;var W=Lu(c,F,t,t,t,t,t,m);return W.placeholder=oi.placeholder,W}function Oi(c,m,C){var W,ae,Te,ot,gt,Nt,qo=0,Go=!1,ls=!1,Fn=!0;if(typeof c!="function")throw new je(a);m=Ua(m)||0,jo(C)&&(Go=!!C.leading,ls="maxWait"in C,Te=ls?As(Ua(C.maxWait)||0,m):Te,Fn="trailing"in C?!!C.trailing:Fn);function er(Gc){var Uu=W,Dp=ae;return W=ae=t,qo=Gc,ot=c.apply(Dp,Uu),ot}function Kr(Gc){return qo=Gc,gt=sv(il,m),Go?er(Gc):ot}function ja(Gc){var Uu=Gc-Nt,Dp=Gc-qo,T1=m-Uu;return ls?qs(T1,Te-Dp):T1}function Zr(Gc){var Uu=Gc-Nt,Dp=Gc-qo;return Nt===t||Uu>=m||Uu<0||ls&&Dp>=Te}function il(){var Gc=br();if(Zr(Gc))return pl(Gc);gt=sv(il,ja(Gc))}function pl(Gc){return gt=t,Fn&&W?er(Gc):(W=ae=t,ot)}function bu(){gt!==t&&ch(gt),qo=0,W=Nt=ae=gt=t}function tu(){return gt===t?ot:pl(br())}function xu(){var Gc=br(),Uu=Zr(Gc);if(W=arguments,ae=this,Nt=Gc,Uu){if(gt===t)return Kr(Nt);if(ls)return ch(gt),gt=sv(il,m),er(Nt)}return gt===t&&(gt=sv(il,m)),ot}return xu.cancel=bu,xu.flush=tu,xu}var Lr=ua(function(c,m){return wl(c,1,m)}),Tn=ua(function(c,m,C){return wl(c,Ua(m)||0,C)});function Un(c){return Lu(c,V)}function xi(c,m){if(typeof c!="function"||m!=null&&typeof m!="function")throw new je(a);var C=function(){var W=arguments,ae=m?m.apply(this,W):W[0],Te=C.cache;if(Te.has(ae))return Te.get(ae);var ot=c.apply(this,W);return C.cache=Te.set(ae,ot)||Te,ot};return C.cache=new(xi.Cache||ia),C}xi.Cache=ia;function Rn(c){if(typeof c!="function")throw new je(a);return function(){var m=arguments;switch(m.length){case 0:return!c.call(this);case 1:return!c.call(this,m[0]);case 2:return!c.call(this,m[0],m[1]);case 3:return!c.call(this,m[0],m[1],m[2])}return!c.apply(this,m)}}function $i(c){return ks(2,c)}var Gi=P1(function(c,m){m=m.length==1&&as(m[0])?In(m[0],tl(Tr())):In(Gt(m,1),tl(Tr()));var C=m.length;return ua(function(W){for(var ae=-1,Te=qs(W.length,C);++ae<Te;)W[ae]=m[ae].call(this,W[ae]);return qt(c,this,W)})}),Fs=ua(function(c,m){var C=Xc(m,tv(Fs));return Lu(c,B,t,m,C)}),yn=ua(function(c,m){var C=Xc(m,tv(yn));return Lu(c,R,t,m,C)}),En=Fu(function(c,m){return Lu(c,$,t,t,t,m)});function On(c,m){if(typeof c!="function")throw new je(a);return m=m===t?m:Si(m),ua(c,m)}function Kn(c,m){if(typeof c!="function")throw new je(a);return m=m==null?0:As(Si(m),0),ua(function(C){var W=C[m],ae=Ip(C,0,m);return W&&Ci(ae,W),qt(c,this,ae)})}function Ii(c,m,C){var W=!0,ae=!0;if(typeof c!="function")throw new je(a);return jo(C)&&(W="leading"in C?!!C.leading:W,ae="trailing"in C?!!C.trailing:ae),Oi(c,m,{leading:W,maxWait:m,trailing:ae})}function bn(c){return tn(c,1)}function $n(c,m){return Fs(G0(m),c)}function nr(){if(!arguments.length)return[];var c=arguments[0];return as(c)?c:[c]}function si(c){return Mr(c,w)}function ni(c,m){return m=typeof m=="function"?m:t,Mr(c,w,m)}function Zs(c){return Mr(c,_|w)}function hs(c,m){return m=typeof m=="function"?m:t,Mr(c,_|w,m)}function Zn(c,m){return m==null||Ma(c,m,ec(m))}function An(c,m){return c===m||c!==c&&m!==m}var xn=mv(_o),Xs=mv(function(c,m){return c>=m}),Vi=qr(function(){return arguments}())?qr:function(c){return zs(c)&&Kt.call(c,"callee")&&!Qo.call(c,"callee")},as=no.isArray,Ji=Dr?tl(Dr):mi;function Vn(c){return c!=null&&$s(c.length)&&!Wn(c)}function Ks(c){return zs(c)&&Vn(c)}function vr(c){return c===!0||c===!1||zs(c)&&ws(c)==be}var ys=li||Qh,Os=Xr?tl(Xr):ql;function di(c){return zs(c)&&c.nodeType===1&&!Yr(c)}function Mi(c){if(c==null)return!0;if(Vn(c)&&(as(c)||typeof c=="string"||typeof c.splice=="function"||ys(c)||Qi(c)||Vi(c)))return!c.length;var m=xd(c);if(m==Ae||m==J)return!c.size;if(ov(c))return!gl(c).length;for(var C in c)if(Kt.call(c,C))return!1;return!0}function Ln(c,m){return rc(c,m)}function wi(c,m,C){C=typeof C=="function"?C:t;var W=C?C(c,m):t;return W===t?rc(c,m,t,C):!!W}function fr(c){if(!zs(c))return!1;var m=ws(c);return m==Ce||m==Ve||typeof c.message=="string"&&typeof c.name=="string"&&!Yr(c)}function jn(c){return typeof c=="number"&&an(c)}function Wn(c){if(!jo(c))return!1;var m=ws(c);return m==Je||m==ye||m==ge||m==Ie}function hi(c){return typeof c=="number"&&c==Si(c)}function $s(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=Q}function jo(c){var m=typeof c;return c!=null&&(m=="object"||m=="function")}function zs(c){return c!=null&&typeof c=="object"}var Ti=Ki?tl(Ki):Fd;function Ps(c,m){return c===m||jl(c,m,Hv(m))}function ki(c,m,C){return C=typeof C=="function"?C:t,jl(c,m,Hv(m),C)}function ln(c){return Fr(c)&&c!=+c}function Yi(c){if(xh(c))throw new dr(r);return bd(c)}function oa(c){return c===null}function Pr(c){return c==null}function Fr(c){return typeof c=="number"||zs(c)&&ws(c)==ee}function Yr(c){if(!zs(c)||ws(c)!=ke)return!1;var m=wn(c);if(m===null)return!0;var C=Kt.call(m,"constructor")&&m.constructor;return typeof C=="function"&&C instanceof C&&Ct.call(C)==Oo}var ka=Ge?tl(Ge):Vc;function va(c){return hi(c)&&c>=-Q&&c<=Q}var ma=at?tl(at):Pc;function la(c){return typeof c=="string"||!as(c)&&zs(c)&&ws(c)==qe}function ra(c){return typeof c=="symbol"||zs(c)&&ws(c)==ft}var Qi=So?tl(So):zl;function $a(c){return c===t}function Al(c){return zs(c)&&xd(c)==Oe}function Ql(c){return zs(c)&&ws(c)==ct}var Sa=mv(Bl),cc=mv(function(c,m){return c<=m});function dc(c){if(!c)return[];if(Vn(c))return la(c)?yd(c):Hd(c);if(Ht&&c[Ht])return Bs(c[Ht]());var m=xd(c),C=m==Ae?bp:m==J?sp:vp;return C(c)}function Ya(c){if(!c)return c===0?c:0;if(c=Ua(c),c===K||c===-K){var m=c<0?-1:1;return m*q}return c===c?c:0}function Si(c){var m=Ya(c),C=m%1;return m===m?C?m-C:m:0}function kc(c){return c?Xd(Si(c),0,_e):0}function Ua(c){if(typeof c=="number")return c;if(ra(c))return ce;if(jo(c)){var m=typeof c.valueOf=="function"?c.valueOf():c;c=jo(m)?m+"":m}if(typeof c!="string")return c===0?c:+c;c=fl(c);var C=Ft.test(c);return C||xt.test(c)?ss(c.slice(2),C?2:8):rt.test(c)?ce:+c}function Tc(c){return Au(c,cl(c))}function uc(c){return c?Xd(Si(c),-Q,Q):c===0?c:0}function Er(c){return c==null?"":qd(c)}var Ac=Qp(function(c,m){if(ov(m)||Vn(m)){Au(m,ec(m),c);return}for(var C in m)Kt.call(m,C)&&Hs(c,C,m[C])}),Gl=Qp(function(c,m){Au(m,cl(m),c)}),Nl=Qp(function(c,m,C,W){Au(m,cl(m),c,W)}),nl=Qp(function(c,m,C,W){Au(m,ec(m),c,W)}),Ll=Fu(td);function Lc(c,m){var C=No(c);return m==null?C:Qc(C,m)}var Ai=ua(function(c,m){c=ve(c);var C=-1,W=m.length,ae=W>2?m[2]:t;for(ae&&wd(m[0],m[1],ae)&&(W=1);++C<W;)for(var Te=m[C],ot=cl(Te),gt=-1,Nt=ot.length;++gt<Nt;){var qo=ot[gt],Go=c[qo];(Go===t||An(Go,lt[qo])&&!Kt.call(c,qo))&&(c[qo]=Te[qo])}return c}),Ta=ua(function(c){return c.push(t,Mf),qt(Aa,t,c)});function od(c,m){return sc(c,Tr(m,3),At)}function sd(c,m){return sc(c,Tr(m,3),io)}function kd(c,m){return c==null?c:dt(c,Tr(m,3),cl)}function Bc(c,m){return c==null?c:Tt(c,Tr(m,3),cl)}function Dd(c,m){return c&&At(c,Tr(m,3))}function Ur(c,m){return c&&io(c,Tr(m,3))}function pc(c){return c==null?[]:co(c,ec(c))}function up(c){return c==null?[]:co(c,cl(c))}function Ed(c,m,C){var W=c==null?t:wo(c,m);return W===t?C:W}function hu(c,m){return c!=null&&Df(c,m,po)}function Du(c,m){return c!=null&&Df(c,m,Es)}var _u=tg(function(c,m,C){m!=null&&typeof m.toString!="function"&&(m=Co.call(m)),c[m]=C},xv(lu)),yu=tg(function(c,m,C){m!=null&&typeof m.toString!="function"&&(m=Co.call(m)),Kt.call(c,m)?c[m].push(C):c[m]=[C]},Tr),pp=ua(Bi);function ec(c){return Vn(c)?xl(c):gl(c)}function cl(c){return Vn(c)?xl(c,!0):ac(c)}function eu(c,m){var C={};return m=Tr(m,3),At(c,function(W,ae,Te){ed(C,m(W,ae,Te),W)}),C}function Ap(c,m){var C={};return m=Tr(m,3),At(c,function(W,ae,Te){ed(C,ae,m(W,ae,Te))}),C}var dl=Qp(function(c,m,C){Cp(c,m,C)}),Aa=Qp(function(c,m,C,W){Cp(c,m,C,W)}),yv=Fu(function(c,m){var C={};if(c==null)return C;var W=!1;m=In(m,function(Te){return Te=Pp(Te,c),W||(W=Te.length>1),Te}),Au(c,Wv(c),C),W&&(C=Mr(C,_|y|w,gh));for(var ae=m.length;ae--;)wf(C,m[ae]);return C});function nv(c,m){return Lp(c,Rn(Tr(m)))}var Eu=Fu(function(c,m){return c==null?{}:ap(c,m)});function Lp(c,m){if(c==null)return{};var C=In(Wv(c),function(W){return[W]});return m=Tr(m),gu(c,C,function(W,ae){return m(W,ae[0])})}function Fp(c,m,C){m=Pp(m,c);var W=-1,ae=m.length;for(ae||(ae=1,c=t);++W<ae;){var Te=c==null?t:c[mu(m[W])];Te===t&&(W=ae,Te=C),c=Wn(Te)?Te.call(c):Te}return c}function Nc(c,m,C){return c==null?c:pv(c,m,C)}function Vg(c,m,C,W){return W=typeof W=="function"?W:t,c==null?c:pv(c,m,C,W)}var Yv=sg(ec),Uv=sg(cl);function Hf(c,m,C){var W=as(c),ae=W||ys(c)||Qi(c);if(m=Tr(m,4),C==null){var Te=c&&c.constructor;ae?C=W?new Te:[]:jo(c)?C=Wn(Te)?No(wn(c)):{}:C={}}return(ae?us:At)(c,function(ot,gt,Nt){return m(C,ot,gt,Nt)}),C}function Wg(c,m){return c==null?!0:wf(c,m)}function Gf(c,m,C){return c==null?c:W0(c,m,G0(C))}function Yf(c,m,C,W){return W=typeof W=="function"?W:t,c==null?c:W0(c,m,G0(C),W)}function vp(c){return c==null?[]:hd(c,ec(c))}function qg(c){return c==null?[]:hd(c,cl(c))}function Hg(c,m,C){return C===t&&(C=m,m=t),C!==t&&(C=Ua(C),C=C===C?C:0),m!==t&&(m=Ua(m),m=m===m?m:0),Xd(Ua(c),m,C)}function Uf(c,m,C){return m=Ya(m),C===t?(C=m,m=0):C=Ya(C),c=Ua(c),ms(c,m,C)}function qh(c,m,C){if(C&&typeof C!="boolean"&&wd(c,m,C)&&(m=C=t),C===t&&(typeof m=="boolean"?(C=m,m=t):typeof c=="boolean"&&(C=c,c=t)),c===t&&m===t?(c=0,m=1):(c=Ya(c),m===t?(m=c,c=0):m=Ya(m)),c>m){var W=c;c=m,m=W}if(C||c%1||m%1){var ae=_l();return qs(c+ae*(m-c+Ao("1e-"+((ae+"").length-1))),m)}return Fv(c,m)}var Gg=ev(function(c,m,C){return m=m.toLowerCase(),c+(C?Kv(m):m)});function Kv(c){return bv(Er(c).toLowerCase())}function Kf(c){return c=Er(c),c&&c.replace(Is,Vd).replace(et,"")}function Hh(c,m,C){c=Er(c),m=qd(m);var W=c.length;C=C===t?W:Xd(Si(C),0,W);var ae=C;return C-=m.length,C>=0&&c.slice(C,ae)==m}function Zf(c){return c=Er(c),c&&jr.test(c)?c.replace(rr,ru):c}function Xf(c){return c=Er(c),c&&Kl.test(c)?c.replace(qa,"\\$&"):c}var Yg=ev(function(c,m,C){return c+(C?"-":"")+m.toLowerCase()}),Jf=ev(function(c,m,C){return c+(C?" ":"")+m.toLowerCase()}),Ug=J0("toLowerCase");function Kg(c,m,C){c=Er(c),m=Si(m);var W=m?vu(c):0;if(!m||W>=m)return c;var ae=(m-W)/2;return Ov(Rs(ae),C)+c+Ov(vs(ae),C)}function Qf(c,m,C){c=Er(c),m=Si(m);var W=m?vu(c):0;return m&&W<m?c+Ov(m-W,C):c}function Gh(c,m,C){c=Er(c),m=Si(m);var W=m?vu(c):0;return m&&W<m?Ov(m-W,C)+c:c}function e0(c,m,C){return C||m==null?m=0:m&&(m=+m),Pi(Er(c).replace(ll,""),m||0)}function Zg(c,m,C){return(C?wd(c,m,C):m===t)?m=1:m=Si(m),yf(Er(c),m)}function Xg(){var c=arguments,m=Er(c[0]);return c.length<3?m:m.replace(c[1],c[2])}var t0=ev(function(c,m,C){return c+(C?"_":"")+m.toLowerCase()});function Yh(c,m,C){return C&&typeof C!="number"&&wd(c,m,C)&&(m=C=t),C=C===t?_e:C>>>0,C?(c=Er(c),c&&(typeof m=="string"||m!=null&&!ka(m))&&(m=qd(m),!m&&Ad(c))?Ip(yd(c),0,C):c.split(m,C)):[]}var Jg=ev(function(c,m,C){return c+(C?" ":"")+bv(m)});function Qg(c,m,C){return c=Er(c),C=C==null?0:Xd(Si(C),0,c.length),m=qd(m),c.slice(C,C+m.length)==m}function em(c,m,C){var W=fe.templateSettings;C&&wd(c,m,C)&&(m=t),c=Er(c),m=Nl({},m,W,ng);var ae=Nl({},m.imports,W.imports,ng),Te=ec(ae),ot=hd(ae,Te),gt,Nt,qo=0,Go=m.interpolate||Po,ls="__p += '",Fn=Ne((m.escape||Po).source+"|"+Go.source+"|"+(Go===Ja?tc:Po).source+"|"+(m.evaluate||Po).source+"|$","g"),er="//# sourceURL="+(Kt.call(m,"sourceURL")?(m.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++lo+"]")+`
`;c.replace(Fn,function(Zr,il,pl,bu,tu,xu){return pl||(pl=bu),ls+=c.slice(qo,xu).replace(Ze,qu),il&&(gt=!0,ls+=`' +
__e(`+il+`) +
'`),tu&&(Nt=!0,ls+=`';
`+tu+`;
__p += '`),pl&&(ls+=`' +
((__t = (`+pl+`)) == null ? '' : __t) +
'`),qo=xu+Zr.length,Zr}),ls+=`';
`;var Kr=Kt.call(m,"variable")&&m.variable;if(!Kr)ls=`with (obj) {
`+ls+`
}
`;else if(el.test(Kr))throw new dr(l);ls=(Nt?ls.replace(bs,""):ls).replace(es,"$1").replace(rn,"$1;"),ls="function("+(Kr||"obj")+`) {
`+(Kr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(gt?", __e = _.escape":"")+(Nt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ls+`return __p
}`;var ja=r0(function(){return z(Te,er+"return "+ls).apply(t,ot)});if(ja.source=ls,fr(ja))throw ja;return ja}function o0(c){return Er(c).toLowerCase()}function Uh(c){return Er(c).toUpperCase()}function tm(c,m,C){if(c=Er(c),c&&(C||m===t))return fl(c);if(!c||!(m=qd(m)))return c;var W=yd(c),ae=yd(m),Te=iu(W,ae),ot=Iu(W,ae)+1;return Ip(W,Te,ot).join("")}function om(c,m,C){if(c=Er(c),c&&(C||m===t))return c.slice(0,kp(c)+1);if(!c||!(m=qd(m)))return c;var W=yd(c),ae=Iu(W,yd(m))+1;return Ip(W,0,ae).join("")}function s0(c,m,C){if(c=Er(c),c&&(C||m===t))return c.replace(ll,"");if(!c||!(m=qd(m)))return c;var W=yd(c),ae=iu(W,yd(m));return Ip(W,ae).join("")}function Zv(c,m){var C=U,W=G;if(jo(m)){var ae="separator"in m?m.separator:ae;C="length"in m?Si(m.length):C,W="omission"in m?qd(m.omission):W}c=Er(c);var Te=c.length;if(Ad(c)){var ot=yd(c);Te=ot.length}if(C>=Te)return c;var gt=C-vu(W);if(gt<1)return W;var Nt=ot?Ip(ot,0,gt).join(""):c.slice(0,gt);if(ae===t)return Nt+W;if(ot&&(gt+=Nt.length-gt),ka(ae)){if(c.slice(gt).search(ae)){var qo,Go=Nt;for(ae.global||(ae=Ne(ae.source,Er(pe.exec(ae))+"g")),ae.lastIndex=0;qo=ae.exec(Go);)var ls=qo.index;Nt=Nt.slice(0,ls===t?gt:ls)}}else if(c.indexOf(qd(ae),gt)!=gt){var Fn=Nt.lastIndexOf(ae);Fn>-1&&(Nt=Nt.slice(0,Fn))}return Nt+W}function n0(c){return c=Er(c),c&&ar.test(c)?c.replace(wr,Sp):c}var i0=ev(function(c,m,C){return c+(C?" ":"")+m.toUpperCase()}),bv=J0("toUpperCase");function Xv(c,m,C){return c=Er(c),m=C?t:m,m===t?_d(c)?ip(c):oc(c):c.match(m)||[]}var r0=ua(function(c,m){try{return qt(c,t,m)}catch(C){return fr(C)?C:new dr(C)}}),sm=Fu(function(c,m){return us(m,function(C){C=mu(C),ed(c,C,ci(c[C],c))}),c});function Jv(c){var m=c==null?0:c.length,C=Tr();return c=m?In(c,function(W){if(typeof W[1]!="function")throw new je(a);return[C(W[0]),W[1]]}):[],ua(function(W){for(var ae=-1;++ae<m;){var Te=c[ae];if(qt(Te[0],this,W))return qt(Te[1],this,W)}})}function a0(c){return Pa(Mr(c,_))}function xv(c){return function(){return c}}function nm(c,m){return c==null||c!==c?m:c}var Yu=eg(),Wx=eg(!0);function lu(c){return c}function Kh(c){return Hr(typeof c=="function"?c:Mr(c,_))}function qx(c){return Jp(Mr(c,_))}function Hx(c,m){return Tu(c,Mr(m,_))}var Gx=ua(function(c,m){return function(C){return Bi(C,c,m)}}),Yx=ua(function(c,m){return function(C){return Bi(c,C,m)}});function Zh(c,m,C){var W=ec(m),ae=co(m,W);C==null&&!(jo(m)&&(ae.length||!W.length))&&(C=m,m=c,c=this,ae=co(m,ec(m)));var Te=!(jo(C)&&"chain"in C)||!!C.chain,ot=Wn(c);return us(ae,function(gt){var Nt=m[gt];c[gt]=Nt,ot&&(c.prototype[gt]=function(){var qo=this.__chain__;if(Te||qo){var Go=c(this.__wrapped__),ls=Go.__actions__=Hd(this.__actions__);return ls.push({func:Nt,args:arguments,thisArg:c}),Go.__chain__=qo,Go}return Nt.apply(c,Ci([this.value()],arguments))})}),c}function Ux(){return ns._===this&&(ns._=Ho),this}function Xh(){}function Kx(c){return c=Si(c),ua(function(m){return Jd(m,c)})}var Zx=Sf(In),Xx=Sf(Ts),Jx=Sf(hl);function M1(c){return $f(c)?Zl(mu(c)):nh(c)}function Qx(c){return function(m){return c==null?t:wo(c,m)}}var ew=Cf(),tw=Cf(!0);function Jh(){return[]}function Qh(){return!1}function ow(){return{}}function sw(){return""}function nw(){return!0}function iw(c,m){if(c=Si(c),c<1||c>Q)return[];var C=_e,W=qs(c,_e);m=Tr(m),c-=_e;for(var ae=Od(W,m);++C<c;)m(C);return ae}function rw(c){return as(c)?In(c,mu):ra(c)?[c]:Hd(hg(Er(c)))}function aw(c){var m=++Dt;return Er(c)+m}var lw=Rv(function(c,m){return c+m},0),cw=If("ceil"),dw=Rv(function(c,m){return c/m},1),uw=If("floor");function pw(c){return c&&c.length?au(c,lu,_o):t}function vw(c,m){return c&&c.length?au(c,Tr(m,2),_o):t}function fw(c){return vc(c,lu)}function gw(c,m){return vc(c,Tr(m,2))}function mw(c){return c&&c.length?au(c,lu,Bl):t}function hw(c,m){return c&&c.length?au(c,Tr(m,2),Bl):t}var _w=Rv(function(c,m){return c*m},1),yw=If("round"),bw=Rv(function(c,m){return c-m},0);function xw(c){return c&&c.length?ld(c,lu):0}function ww(c,m){return c&&c.length?ld(c,Tr(m,2)):0}return fe.after=Ri,fe.ary=tn,fe.assign=Ac,fe.assignIn=Gl,fe.assignInWith=Nl,fe.assignWith=nl,fe.at=Ll,fe.before=ks,fe.bind=ci,fe.bindAll=sm,fe.bindKey=Ar,fe.castArray=nr,fe.chain=Ic,fe.chunk=bg,fe.compact=Ch,fe.concat=xg,fe.cond=Jv,fe.conforms=a0,fe.constant=xv,fe.countBy=hr,fe.create=Lc,fe.curry=_n,fe.curryRight=oi,fe.debounce=Oi,fe.defaults=Ai,fe.defaultsDeep=Ta,fe.defer=Lr,fe.delay=Tn,fe.difference=Ph,fe.differenceBy=wg,fe.differenceWith=Ih,fe.drop=kg,fe.dropRight=Mh,fe.dropRightWhile=Sg,fe.dropWhile=Th,fe.fill=Cg,fe.filter=Tl,fe.flatMap=Ga,fe.flatMapDeep=ei,fe.flatMapDepth=yr,fe.flatten=Vf,fe.flattenDeep=Ig,fe.flattenDepth=Mg,fe.flip=Un,fe.flow=Yu,fe.flowRight=Wx,fe.fromPairs=Tg,fe.functions=pc,fe.functionsIn=up,fe.groupBy=Rr,fe.initial=Ah,fe.intersection=Fg,fe.intersectionBy=Lh,fe.intersectionWith=Dg,fe.invert=_u,fe.invertBy=yu,fe.invokeMap=yi,fe.iteratee=Kh,fe.keyBy=Or,fe.keys=ec,fe.keysIn=cl,fe.map=pa,fe.mapKeys=eu,fe.mapValues=Ap,fe.matches=qx,fe.matchesProperty=Hx,fe.memoize=xi,fe.merge=dl,fe.mergeWith=Aa,fe.method=Gx,fe.methodOf=Yx,fe.mixin=Zh,fe.negate=Rn,fe.nthArg=Kx,fe.omit=yv,fe.omitBy=nv,fe.once=$i,fe.orderBy=bi,fe.over=Zx,fe.overArgs=Gi,fe.overEvery=Xx,fe.overSome=Jx,fe.partial=Fs,fe.partialRight=yn,fe.partition=pr,fe.pick=Eu,fe.pickBy=Lp,fe.property=M1,fe.propertyOf=Qx,fe.pull=Eh,fe.pullAll=Wf,fe.pullAllBy=$h,fe.pullAllWith=$g,fe.pullAt=jh,fe.range=ew,fe.rangeRight=tw,fe.rearg=En,fe.reject=Yn,fe.remove=jg,fe.rest=On,fe.reverse=qf,fe.sampleSize=Hi,fe.set=Nc,fe.setWith=Vg,fe.shuffle=Us,fe.slice=zg,fe.sortBy=Xi,fe.sortedUniq=Rh,fe.sortedUniqBy=Og,fe.split=Yh,fe.spread=Kn,fe.tail=Oh,fe.take=Vh,fe.takeRight=Wh,fe.takeRightWhile=h,fe.takeWhile=x,fe.tap=Wc,fe.throttle=Ii,fe.thru=gc,fe.toArray=dc,fe.toPairs=Yv,fe.toPairsIn=Uv,fe.toPath=rw,fe.toPlainObject=Tc,fe.transform=Hf,fe.unary=bn,fe.union=M,fe.unionBy=I,fe.unionWith=D,fe.uniq=E,fe.uniqBy=H,fe.uniqWith=ue,fe.unset=Wg,fe.unzip=Fe,fe.unzipWith=it,fe.update=Gf,fe.updateWith=Yf,fe.values=vp,fe.valuesIn=qg,fe.without=yo,fe.words=Xv,fe.wrap=$n,fe.xor=ao,fe.xorBy=Et,fe.xorWith=Ls,fe.zip=Mn,fe.zipObject=Ia,fe.zipObjectDeep=Hl,fe.zipWith=zc,fe.entries=Yv,fe.entriesIn=Uv,fe.extend=Gl,fe.extendWith=Nl,Zh(fe,fe),fe.add=lw,fe.attempt=r0,fe.camelCase=Gg,fe.capitalize=Kv,fe.ceil=cw,fe.clamp=Hg,fe.clone=si,fe.cloneDeep=Zs,fe.cloneDeepWith=hs,fe.cloneWith=ni,fe.conformsTo=Zn,fe.deburr=Kf,fe.defaultTo=nm,fe.divide=dw,fe.endsWith=Hh,fe.eq=An,fe.escape=Zf,fe.escapeRegExp=Xf,fe.every=ea,fe.find=_r,fe.findIndex=Pg,fe.findKey=od,fe.findLast=sl,fe.findLastIndex=Of,fe.findLastKey=sd,fe.floor=uw,fe.forEach=Ea,fe.forEachRight=Di,fe.forIn=kd,fe.forInRight=Bc,fe.forOwn=Dd,fe.forOwnRight=Ur,fe.get=Ed,fe.gt=xn,fe.gte=Xs,fe.has=hu,fe.hasIn=Du,fe.head=Ag,fe.identity=lu,fe.includes=wa,fe.indexOf=Lg,fe.inRange=Uf,fe.invoke=pp,fe.isArguments=Vi,fe.isArray=as,fe.isArrayBuffer=Ji,fe.isArrayLike=Vn,fe.isArrayLikeObject=Ks,fe.isBoolean=vr,fe.isBuffer=ys,fe.isDate=Os,fe.isElement=di,fe.isEmpty=Mi,fe.isEqual=Ln,fe.isEqualWith=wi,fe.isError=fr,fe.isFinite=jn,fe.isFunction=Wn,fe.isInteger=hi,fe.isLength=$s,fe.isMap=Ti,fe.isMatch=Ps,fe.isMatchWith=ki,fe.isNaN=ln,fe.isNative=Yi,fe.isNil=Pr,fe.isNull=oa,fe.isNumber=Fr,fe.isObject=jo,fe.isObjectLike=zs,fe.isPlainObject=Yr,fe.isRegExp=ka,fe.isSafeInteger=va,fe.isSet=ma,fe.isString=la,fe.isSymbol=ra,fe.isTypedArray=Qi,fe.isUndefined=$a,fe.isWeakMap=Al,fe.isWeakSet=Ql,fe.join=Fh,fe.kebabCase=Yg,fe.last=Qd,fe.lastIndexOf=Dh,fe.lowerCase=Jf,fe.lowerFirst=Ug,fe.lt=Sa,fe.lte=cc,fe.max=pw,fe.maxBy=vw,fe.mean=fw,fe.meanBy=gw,fe.min=mw,fe.minBy=hw,fe.stubArray=Jh,fe.stubFalse=Qh,fe.stubObject=ow,fe.stubString=sw,fe.stubTrue=nw,fe.multiply=_w,fe.nth=Eg,fe.noConflict=Ux,fe.noop=Xh,fe.now=br,fe.pad=Kg,fe.padEnd=Qf,fe.padStart=Gh,fe.parseInt=e0,fe.random=qh,fe.reduce=ta,fe.reduceRight=Ei,fe.repeat=Zg,fe.replace=Xg,fe.result=Fp,fe.round=yw,fe.runInContext=Mt,fe.sample=Vr,fe.size=Gr,fe.snakeCase=t0,fe.some=nn,fe.sortedIndex=zh,fe.sortedIndexBy=Bg,fe.sortedIndexOf=Bh,fe.sortedLastIndex=Ng,fe.sortedLastIndexBy=Nh,fe.sortedLastIndexOf=Rg,fe.startCase=Jg,fe.startsWith=Qg,fe.subtract=bw,fe.sum=xw,fe.sumBy=ww,fe.template=em,fe.times=iw,fe.toFinite=Ya,fe.toInteger=Si,fe.toLength=kc,fe.toLower=o0,fe.toNumber=Ua,fe.toSafeInteger=uc,fe.toString=Er,fe.toUpper=Uh,fe.trim=tm,fe.trimEnd=om,fe.trimStart=s0,fe.truncate=Zv,fe.unescape=n0,fe.uniqueId=aw,fe.upperCase=i0,fe.upperFirst=bv,fe.each=Ea,fe.eachRight=Di,fe.first=Ag,Zh(fe,function(){var c={};return At(fe,function(m,C){Kt.call(fe.prototype,C)||(c[C]=m)}),c}(),{chain:!1}),fe.VERSION=s,us(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){fe[c].placeholder=fe}),us(["drop","take"],function(c,m){vi.prototype[c]=function(C){C=C===t?1:As(Si(C),0);var W=this.__filtered__&&!m?new vi(this):this.clone();return W.__filtered__?W.__takeCount__=qs(C,W.__takeCount__):W.__views__.push({size:qs(C,_e),type:c+(W.__dir__<0?"Right":"")}),W},vi.prototype[c+"Right"]=function(C){return this.reverse()[c](C).reverse()}}),us(["filter","map","takeWhile"],function(c,m){var C=m+1,W=C==se||C==Y;vi.prototype[c]=function(ae){var Te=this.clone();return Te.__iteratees__.push({iteratee:Tr(ae,3),type:C}),Te.__filtered__=Te.__filtered__||W,Te}}),us(["head","last"],function(c,m){var C="take"+(m?"Right":"");vi.prototype[c]=function(){return this[C](1).value()[0]}}),us(["initial","tail"],function(c,m){var C="drop"+(m?"":"Right");vi.prototype[c]=function(){return this.__filtered__?new vi(this):this[C](1)}}),vi.prototype.compact=function(){return this.filter(lu)},vi.prototype.find=function(c){return this.filter(c).head()},vi.prototype.findLast=function(c){return this.reverse().find(c)},vi.prototype.invokeMap=ua(function(c,m){return typeof c=="function"?new vi(this):this.map(function(C){return Bi(C,c,m)})}),vi.prototype.reject=function(c){return this.filter(Rn(Tr(c)))},vi.prototype.slice=function(c,m){c=Si(c);var C=this;return C.__filtered__&&(c>0||m<0)?new vi(C):(c<0?C=C.takeRight(-c):c&&(C=C.drop(c)),m!==t&&(m=Si(m),C=m<0?C.dropRight(-m):C.take(m-c)),C)},vi.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},vi.prototype.toArray=function(){return this.take(_e)},At(vi.prototype,function(c,m){var C=/^(?:filter|find|map|reject)|While$/.test(m),W=/^(?:head|last)$/.test(m),ae=fe[W?"take"+(m=="last"?"Right":""):m],Te=W||/^find/.test(m);ae&&(fe.prototype[m]=function(){var ot=this.__wrapped__,gt=W?[1]:arguments,Nt=ot instanceof vi,qo=gt[0],Go=Nt||as(ot),ls=function(il){var pl=ae.apply(fe,Ci([il],gt));return W&&Fn?pl[0]:pl};Go&&C&&typeof qo=="function"&&qo.length!=1&&(Nt=Go=!1);var Fn=this.__chain__,er=!!this.__actions__.length,Kr=Te&&!Fn,ja=Nt&&!er;if(!Te&&Go){ot=ja?ot:new vi(this);var Zr=c.apply(ot,gt);return Zr.__actions__.push({func:gc,args:[ls],thisArg:t}),new pi(Zr,Fn)}return Kr&&ja?c.apply(this,gt):(Zr=this.thru(ls),Kr?W?Zr.value()[0]:Zr.value():Zr)})}),us(["pop","push","shift","sort","splice","unshift"],function(c){var m=Ue[c],C=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",W=/^(?:pop|shift)$/.test(c);fe.prototype[c]=function(){var ae=arguments;if(W&&!this.__chain__){var Te=this.value();return m.apply(as(Te)?Te:[],ae)}return this[C](function(ot){return m.apply(as(ot)?ot:[],ae)})}}),At(vi.prototype,function(c,m){var C=fe[m];if(C){var W=C.name+"";Kt.call(fs,W)||(fs[W]=[]),fs[W].push({name:m,func:C})}}),fs[Nv(t,T).name]=[{name:"wrapper",func:t}],vi.prototype.clone=Na,vi.prototype.reverse=Xl,vi.prototype.value=cd,fe.prototype.at=xc,fe.prototype.chain=Mc,fe.prototype.commit=mc,fe.prototype.next=lc,fe.prototype.plant=Ni,fe.prototype.reverse=aa,fe.prototype.toJSON=fe.prototype.valueOf=fe.prototype.value=Jl,fe.prototype.first=fe.prototype.head,Ht&&(fe.prototype[Ht]=wc),fe},Kd=Xp();Nn?((Nn.exports=Kd)._=Kd,Js._=Kd):ns._=Kd}).call(Op)})(Nm,Nm.exports);var bM=Nm.exports;const Rt=j0(bM);function xM(o,e,t){const s=o.target;e(parseInt(s.value)),t("opacityChange",e())}function wM(o,e){o.stopPropagation(),b(e,!0)}function kM(o,e,t,s,i,r,a,l){if(/^#[0-9A-F]{6}$/i.test(n(e))){const d=t(n(e));b(s,d.h),b(i,d.s),b(r,d.l),a(n(e)),l("colorChange",n(e))}}function SM(o,e,t,s,i,r){n(e)&&/^#[0-9A-Fa-f]{6}$/.test(n(e))&&(t(n(e)),s("colorChange",n(e)),n(i).includes(n(e))||b(i,[...n(i),n(e)]),b(r,!1))}var CM=o=>o.stopPropagation(),PM=(o,e)=>e(!1),IM=(o,e,t)=>e(n(t)),MM=de("<button></button>"),TM=de('<div class="flex gap-0.5 mb-0.5"></div>'),AM=(o,e,t)=>e(n(t)),LM=de("<button></button>"),FM=de(`<div class="flex items-center justify-between mb-3"><span class="text-sm text-gray-900 dark:text-gray-300 font-medium">Color Picker</span> <button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">OK</button></div> <div class="mb-3"></div> <div class="mb-3"><div class="flex items-center gap-2 mb-2"><!> <button class="w-5 h-5 rounded border-2 border-dashed border-gray-400 dark:border-gray-500 hover:border-gray-500 dark:hover:border-gray-300 
                   flex items-center justify-center text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4"></path></svg></button></div></div> <div><div class="flex items-center justify-between mb-2"><span class="text-xs text-gray-900 dark:text-gray-300">Opacity</span> <span class="text-xs text-gray-900 dark:text-gray-300"> </span></div> <div class="relative"><div class="absolute inset-0 h-2 rounded opacity-30" style="background-image: repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 6px 6px;"></div> <input type="range" min="0" max="100" class="relative w-full h-2 rounded appearance-none cursor-pointer opacity-slider svelte-16cejrx"> <div class="absolute top-1/2 w-4 h-4 bg-white border-2 border-gray-800 rounded-full transform -translate-y-1/2 pointer-events-none shadow-sm"></div></div></div>`,1),DM=(o,e)=>e(!1),EM=(o,e)=>b(e,!1),$M=de('<div class="mb-3 flex items-center justify-between"><span class="text-sm text-gray-900 dark:text-gray-300 font-medium">Custom Color Picker</span> <div class="flex items-center gap-2"><button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">OK</button> <button class="text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button></div></div> <div class="mb-3"><label class="block text-xs text-gray-600 dark:text-gray-400 mb-2">Hex Color</label> <input type="text" class="w-full px-3 py-2 bg-white dark:bg-[#1A1A1A] border border-gray-300 dark:border-[#404040] rounded text-gray-900 dark:text-white text-sm focus:border-blue-500 focus:outline-none" placeholder="#000000"></div> <div class="mb-3"><div class="w-full h-6 rounded border border-gray-300 dark:border-[#404040]"></div></div> <div class="mb-3"><label class="block text-xs text-gray-600 dark:text-gray-400 mb-2">Color Picker</label> <div class="relative w-full h-24 rounded border border-gray-300 dark:border-[#404040] cursor-crosshair"><div class="absolute w-3 h-3 border-2 border-white rounded-full transform -translate-x-1/2 -translate-y-1/2 pointer-events-none"></div></div></div> <div class="mb-3"><label class="block text-xs text-gray-600 dark:text-gray-400 mb-2">Hue</label> <div class="relative"><input type="range" min="0" max="360" class="w-full h-4 rounded appearance-none cursor-pointer" style="background: linear-gradient(to right, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000);"> <div class="absolute top-1/2 w-4 h-4 bg-white border-2 border-gray-800 rounded-full transform -translate-y-1/2 pointer-events-none shadow-sm"></div></div></div> <button class="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded transition-colors">Add Color</button>',1),jM=de(`<div class="color-picker-container fixed z-[80] bg-white dark:bg-[#2A2A2A] border border-gray-200 dark:border-[#404040] rounded-lg shadow-xl p-3 transition-all duration-200" style="
      left: 50%; 
      top: 50%; 
      transform: translate(-50%, -50%); 
      max-height: 90vh; 
      max-width: 90vw;
      overflow-y: auto;
    "><!></div>`);function Su(o,e){Ka(e,!1);const t=Md();let s=Ss(e,"selectedColor",12,"#1677FF"),i=Ss(e,"show",12,!1),r=Ss(e,"opacity",12,100),a=kl(),l=kl(),d=!1,v=kl(["#FF4D4F","#1890FF","#52C41A","#FA8C16","#722ED1"]),p=kl(!1),_=kl("#000000"),y=kl(0),w=kl(100),k=kl(50);const S=[["#000000","#1C1C1C","#383838","#545454","#707070","#8C8C8C","#A8A8A8","#C4C4C4","#E0E0E0","#FFFFFF"],["#FF0000","#FF4D4F","#FF7875","#FFA39E","#FFCCC7","#FFF1F0","#FFEDED","#FFF5F5","#FFFAFA","#FFFFFF"],["#FF8C00","#FA541C","#FF7A45","#FF9C6E","#FFBB96","#FFD8BF","#FFE7BA","#FFF2E8","#FFF7E6","#FFFBE6"],["#FFD700","#FADB14","#FFEC3D","#FFF566","#FFFF8F","#FFFFB8","#FFFBE6","#FFFBF0","#FFFBF0","#FFFBF0"],["#32CD32","#52C41A","#73D13D","#95DE64","#B7EB8F","#D9F7BE","#F6FFED","#F6FFED","#F6FFED","#F6FFED"],["#00CED1","#13C2C2","#36CFC9","#5CDBD3","#87E8DE","#B5F5EC","#E6FFFB","#E6FFFB","#E6FFFB","#E6FFFB"],["#1E90FF","#1890FF","#40A9FF","#69C0FF","#91D5FF","#BAE7FF","#E6F7FF","#E6F7FF","#E6F7FF","#E6F7FF"],["#9370DB","#722ED1","#9254DE","#B37FEB","#D3ADF7","#EFDBFF","#F9F0FF","#F9F0FF","#F9F0FF","#F9F0FF"]];function L(G){s(G),t("colorChange",G)}function T(G,Z,le){le/=100;const se=Z*Math.min(le,1-le)/100,ie=Y=>{const K=(Y+G/30)%12,Q=le-se*Math.max(Math.min(K-3,9-K,1),-1);return Math.round(255*Q).toString(16).padStart(2,"0")};return`#${ie(0)}${ie(8)}${ie(4)}`}function P(G){const Z=parseInt(G.slice(1,3),16)/255,le=parseInt(G.slice(3,5),16)/255,se=parseInt(G.slice(5,7),16)/255,ie=Math.max(Z,le,se),Y=Math.min(Z,le,se);let K=0,Q=0,q=(ie+Y)/2;if(ie!==Y){const ce=ie-Y;switch(Q=q>.5?ce/(2-ie-Y):ce/(ie+Y),ie){case Z:K=(le-se)/ce+(le<se?6:0);break;case le:K=(se-Z)/ce+2;break;case se:K=(Z-le)/ce+4;break}K/=6}return{h:K*360,s:Q*100,l:q*100}}function A(){b(_,T(n(y),n(w),n(k))),s(n(_)),t("colorChange",n(_))}function F(G){d=!0,N(G),document.addEventListener("mousemove",B),document.addEventListener("mouseup",R),G.preventDefault()}function B(G){d&&n(l)&&N(G)}function R(){d=!1,document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",R)}function N(G){if(!n(l))return;const Z=n(l).getBoundingClientRect(),le=Math.max(0,Math.min(1,(G.clientX-Z.left)/Z.width)),se=Math.max(0,Math.min(1,(G.clientY-Z.top)/Z.height));b(w,le*100),b(k,(1-se)*100),A()}function $(G){const Z=G.target;n(a)&&!n(a).contains(Z)&&(i(!1),b(p,!1),t("close"))}yp(()=>{typeof document<"u"&&document.removeEventListener("click",$,!0)}),nu(()=>Gd(i()),()=>{i()&&typeof document<"u"&&setTimeout(()=>{document.addEventListener("click",$,!0)},0)}),nu(()=>Gd(i()),()=>{!i()&&typeof document<"u"&&document.removeEventListener("click",$,!0)}),Av(),Ud();var V=Xt(),U=_t(V);Se(U,i,G=>{var Z=jM();Z.__click=[CM];var le=g(Z);Se(le,()=>!n(p),se=>{var ie=FM(),Y=_t(ie),K=u(g(Y),2);K.__click=[PM,i],f(Y);var Q=u(Y,2);Ns(Q,5,()=>S,dn,(Ve,Ce)=>{var Je=TM();Ns(Je,5,()=>n(Ce),dn,(ye,Ae)=>{var ee=MM();ee.__click=[IM,L,Ae],we(()=>{Pn(ee,`w-4 h-4 border hover:scale-110 transition-transform cursor-pointer
                       ${(s()===n(Ae)?"border-white dark:border-white border-2":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-400")??""}`),St(ee,"style",`background-color: ${n(Ae)??""};`)}),O(ye,ee)}),f(Je),O(Ve,Je)}),f(Q);var q=u(Q,2),ce=g(q),_e=g(ce);Ns(_e,1,()=>n(v),dn,(Ve,Ce)=>{var Je=LM();Je.__click=[AM,L,Ce],we(()=>{Pn(Je,`w-5 h-5 rounded border hover:scale-110 transition-transform cursor-pointer
                     ${(s()===n(Ce)?"border-white dark:border-white border-2":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-400")??""}`),St(Je,"style",`background-color: ${n(Ce)??""};`)}),O(Ve,Je)});var me=u(_e,2);me.__click=[wM,p],f(ce),f(q);var Pe=u(q,2),ze=g(Pe),he=u(g(ze),2),De=g(he);f(he),f(ze);var ge=u(ze,2),be=u(g(ge),2);Vt(be),be.__input=[xM,r,t];var $e=u(be,2);f(ge),f(Pe),we(()=>{Ye(De,`${r()??""}%`),St(be,"style",`background: linear-gradient(to right, transparent, ${s()??""});`),St($e,"style",`left: calc(${r()??""}% - 8px);`)}),go(be,r),O(se,ie)},se=>{var ie=$M(),Y=_t(ie),K=u(g(Y),2),Q=g(K);Q.__click=[DM,i];var q=u(Q,2);q.__click=[EM,p],f(K),f(Y);var ce=u(Y,2),_e=u(g(ce),2);Vt(_e),_e.__input=[kM,_,P,y,w,k,s,t],f(ce);var me=u(ce,2),Pe=g(me);f(me);var ze=u(me,2),he=u(g(ze),2);he.__mousedown=F;var De=g(he);f(he),Ec(he,Je=>b(l,Je),()=>n(l)),f(ze);var ge=u(ze,2),be=u(g(ge),2),$e=g(be);Vt($e),$e.__input=A;var Ve=u($e,2);f(be),f(ge);var Ce=u(ge,2);Ce.__click=[SM,_,s,t,v,p],we(()=>{St(Pe,"style",`background-color: ${n(_)??""};`),St(he,"style",`background: linear-gradient(to bottom, transparent, black), linear-gradient(to right, white, hsl(${n(y)??""}, 100%, 50%));`),St(De,"style",`left: ${n(w)??""}%; top: ${100-n(k)}%;`),St(Ve,"style",`left: calc(${n(y)/360*100}% - 8px);`)}),go(_e,()=>n(_),Je=>b(_,Je)),go($e,()=>n(y),Je=>b(y,Je)),O(se,ie)}),f(Z),Ec(Z,se=>b(a,se),()=>n(a)),we(()=>{Sn(Z,"w-64",!n(p)),Sn(Z,"w-80",n(p))}),O(G,Z)}),O(o,V),Za()}hc(["click","input","mousedown"]);const zM={data:null,loading:!1,error:null},Up=Id(zM);async function BM(o){const t=`${NM()}/auth/user/preference/${o}`,s=await RM(t,{},8e3);if(!s.ok)throw s.status===404?new Error("User not found"):new Error(`Failed to fetch user preferences: ${s.statusText}`);return await s.json()}function NM(){var e,t;const o=(t=(e=import.meta)==null?void 0:e.env)==null?void 0:t.VITE_USER_PREFS_BASE_URL;return typeof o=="string"&&o.trim()?o.trim():"https://noti.dutyai.app"}async function RM(o,e={},t=8e3){const s=new AbortController,i=setTimeout(()=>s.abort(),t);try{return await fetch(o,{...e,signal:s.signal})}finally{clearTimeout(i)}}function OM(o){Up.set({data:o,loading:!1,error:null})}function VM(o){Up.update(e=>({...e,loading:o}))}function WM(o){Up.set({data:null,loading:!1,error:o})}async function qM(o,e){const t="https://noti.dutyai.app/auth/user/preference";try{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clerkId:o,theme:e})});if(!s.ok)throw new Error(`Failed to save theme preference: ${s.statusText}`);console.log("✅ Theme preference saved successfully:",{clerkId:o,theme:e})}catch(s){console.error("❌ Failed to save theme preference:",s)}}const Py=Id(null),J_=Id(null),HM=V6,hm={},GM=[{tfsecs:604800,origin:345600,date:"1970-01-05"}];function YM(o){if(o=Math.abs(o),o>=1)return 0;let e=0;for(;o<1;)o=o*10,e+=1;return e}function ku(o){if(hm[o])return hm[o];const e=o.length-1,t=o.substring(e),s=o.substring(0,e),i=parseInt(s);let r="minute";if(t=="w")r="week";else if(t=="d")r="day";else if(t=="h")r="hour";else if(t=="m")r="minute";else if(t=="s")r="second";else throw new Error(`unsupport period: ${o}`);const a=I0(o);return hm[o]={multiplier:i,timespan:r,timeframe:o,secs:a},hm[o]}ku("1m"),ku("5m"),ku("15m"),ku("30m"),ku("1h"),ku("2h"),ku("4h"),ku("8h"),ku("12h"),ku("1d"),ku("3d"),ku("1w");function _m(o,e,t){return{id:o,position:HM.Middle,marginLeft:8,marginTop:2,marginRight:0,marginBottom:0,paddingLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,icon:e,fontFamily:"icomoon",size:14,color:t,activeColor:t,backgroundColor:"transparent",activeBackgroundColor:"rgba(22, 119, 255, 0.15)"}}function Ul(o){let e=o==="dark"?"#929AA5":"#76808F",t=o==="dark"?"#555555":"#dddddd";const s=o==="dark"?"#081115":"#F3F3F3",i=o==="dark"?"#070211":"#ffffff",r=o==="dark"?"#FFFFFF":"#333333";try{if(typeof window<"u"){const y=document.querySelector(".menu-container")||document.documentElement,w=window.getComputedStyle(y),k=T=>(w.getPropertyValue(T)||"").trim(),S=k("--menu-text"),L=k("--menu-btn-border")||k("--menu-border");S&&(e=S),L&&(t=L)}}catch{}const a=typeof window<"u"&&window.innerWidth<=768,l=typeof window<"u"&&window.innerWidth<=480,d=l?10:a?11:12,v=l?10:a?11:12,p=l?2:a?3:4,_=l?2:a?3:4;return{pane:{backgroundColor:i},candle:{pane:{backgroundColor:i},type:W6.CandleSolid,priceMark:{last:{show:!0},high:{show:!0},low:{show:!0}},tooltip:{showRule:ly.Always,text:{style:{fontSize:32,fontWeight:"bold",color:"#FFFFFF"}},title:{show:!0,size:18,family:"Helvetica Neue",weight:"normal",color:r,template:"{name} · {period} · {exchange} · {segment}"},legend:{size:12,family:"Helvetica Neue",weight:"normal",color:e,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4,defaultValue:"n/a",template:({current:y})=>{const w="#32CD32",k="#FF0000",S=((y==null?void 0:y.close)??0)>((y==null?void 0:y.open)??0),L=((y==null?void 0:y.close)??0)<((y==null?void 0:y.open)??0),T=S?w:L?k:e,P=F=>({text:F,color:T});return typeof window<"u"&&window.innerWidth<=768?[{title:"O",value:P("{open}")},{title:"H",value:P("{high}")},{title:"L",value:P("{low}")},{title:"C",value:P("{close}")},{title:"V",value:P("{volume}")}]:[{title:"O",value:P("{open}")},{title:"H",value:P("{high}")},{title:"L",value:P("{low}")},{title:"C",value:P("{close}")},{title:"V",value:P("{volume}")}]}}}},indicator:{lastValueMark:{show:!0},tooltip:{showRule:ly.Always,icons:[_m("visible","",e),_m("invisible","",e),_m("setting","",e),_m("close","",e)]}},grid:{show:!0,horizontal:{show:!0,color:s,style:Ee.Solid,size:1},vertical:{show:!0,color:s,style:Ee.Solid,size:1}},xAxis:{show:!0,axisLine:{show:!0,color:t,size:5},tickLine:{show:!0,color:t},tickText:{show:!0,style:{fontSize:d,color:e,fontFamily:"Arial, sans-serif"},margin:p}},yAxis:{type:"normal",reverse:!1,show:!0,axisLine:{show:!0,color:t,size:4},tickLine:{show:!0,color:t},tickText:{show:!0,style:{fontSize:v,color:e,fontFamily:"Arial, sans-serif"},margin:_}},separator:{size:1,color:o==="dark"?"rgba(85, 85, 85, 0.3)":"rgba(221, 221, 221, 0.3)",fill:!0,activeBackgroundColor:o==="dark"?"rgba(85, 85, 85, 0.1)":"rgba(221, 221, 221, 0.1)"}}}const Yl=hb(),Rm={AO:[{title:"Short Period",precision:0,min:1,default:5},{title:"Long Period",precision:0,min:1,default:34},{title:"Increasing Color",type:"color",styleKey:"bars[0].upColor",default:"#26A69A"},{title:"Decreasing Color",type:"color",styleKey:"bars[0].downColor",default:"#EF5350"}],BIAS:[{title:Y_(),precision:0,min:1,default:6}],BOLL:[{title:Y_(),precision:0,min:1,default:20},{title:_b(),precision:2,min:1,default:2}],BBI:[{title:Yl+"1",precision:0,min:1,default:3},{title:Yl+"2",precision:0,min:1,default:6},{title:Yl+"3",precision:0,min:1,default:12},{title:Yl+"4",precision:0,min:1,default:24}],CCI:[{title:Yl+"1",precision:0,min:1,default:20}],CR:[{title:Yl+"1",precision:0,min:1,default:26},{title:Yl+"2",precision:0,min:1,default:10},{title:Yl+"3",precision:0,min:1,default:20},{title:Yl+"4",precision:0,min:1,default:40},{title:Yl+"5",precision:0,min:1,default:60}],DMI:[{title:"DI Period",precision:0,min:1,default:14},{title:"ADX Period",precision:0,min:1,default:6}],EMV:[{title:Yl+"1",precision:0,min:1,default:14},{title:Yl+"2",precision:0,min:1,default:9}],EMA:[{title:"Period",precision:0,min:1,default:20},{title:"Line Color",type:"color",styleKey:"lines[0].color",default:"#2563eb"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:2}],ICHIMOKU:[{title:"Tenkan Period",precision:0,min:1,default:9},{title:"Kijun Period",precision:0,min:1,default:26},{title:"Senkou B Period",precision:0,min:1,default:52}],MTM:[{title:Yl+"1",precision:0,min:1,default:12},{title:Yl+"2",precision:0,min:1,default:6}],MA:[{title:"MA1",precision:0,min:1,styleKey:"lines[0].color",default:5},{title:"MA2",precision:0,min:1,styleKey:"lines[1].color",default:10},{title:"MA3",precision:0,min:1,styleKey:"lines[2].color",default:30}],MACD:[{title:"Fast Period",precision:0,min:1,default:12},{title:"Slow Period",precision:0,min:1,default:26},{title:"Signal Period",precision:0,min:1,default:9}],OBV:[{title:Yl+"1",precision:0,min:1,default:30},{title:Yl+"2",precision:0,min:1,default:10}],PVT:[],PSY:[{title:Yl+"1",precision:0,min:1,default:12},{title:Yl+"2",precision:0,min:1,default:6}],ROC:[{title:Yl+"1",precision:0,min:1,default:12},{title:Yl+"2",precision:0,min:1,default:6}],RSI:[{title:"Period",precision:0,min:1,default:14},{title:"Overbought",precision:0,min:50,max:100,default:70},{title:"Middle",precision:0,min:30,max:70,default:50},{title:"Oversold",precision:0,min:0,max:50,default:30},{title:"Line Color",type:"color",styleKey:"lines[0].color",default:"#FF6B35"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:1}],SMA:[{title:Yl+"1",precision:0,min:1,default:12},{title:Yl+"2",precision:0,min:1,default:2}],SMARTTREND:[{title:"Period",precision:0,min:1,default:10},{title:"Multiplier",precision:1,min:.1,max:10,default:3},{title:"Uptrend Color",type:"color",styleKey:"lines[0].color",default:"#10B981"},{title:"Downtrend Color",type:"color",styleKey:"lines[1].color",default:"#EF4444"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:2}],KDJ:[{title:Yl+"1",precision:0,min:1,default:9},{title:Yl+"2",precision:0,min:1,default:3},{title:Yl+"3",precision:0,min:1,default:3}],SAR:[{title:"Start",precision:3,min:.001,max:.1,default:.02},{title:"Increment",precision:3,min:.001,max:.1,default:.02},{title:"Max value",precision:2,min:.1,max:1,default:.2}],TRIX:[{title:Yl+"1",precision:0,min:1,default:12},{title:Yl+"2",precision:0,min:1,default:9}],VOL:[{title:"MA1",precision:0,min:1,default:5},{title:"MA2",precision:0,min:1,default:10},{title:"MA3",precision:0,min:1,default:20}],VR:[{title:Yl+"1",precision:0,min:1,default:26},{title:Yl+"2",precision:0,min:1,default:6},{title:Yl+"3",precision:0,min:1,default:12}],WR:[{title:"Period",precision:0,min:1,default:14},{title:"Line Color",type:"color",styleKey:"lines[0].color",default:"#2563eb"},{title:"Line Thickness",precision:0,min:1,max:5,styleKey:"lines[0].size",default:1}],TRAP_HUNTER:[{title:"Resistance Lookback",precision:0,min:1,default:20},{title:"Support Lookback",precision:0,min:1,default:20},{title:"Confirmation Bars",precision:0,min:1,default:4},{title:"Max Trap Bars",precision:0,min:1,default:6},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Min Volume Spike",precision:2,min:.1,default:1.2},{title:"Min Breakout Factor",precision:4,min:0,default:5e-4},{title:"Min Wick Ratio",precision:2,min:0,max:1,default:.35},{title:"Min Trap Score",precision:2,min:0,max:1,default:.5},{title:"Enable Normal Signal (0/1)",precision:0,min:0,max:1,default:1},{title:"Normal Quiet Bars",precision:0,min:1,default:5}],SMART_MONEY:[{title:"Zone Lookback Bars",precision:0,min:10,default:40},{title:"Min Zone Bars",precision:0,min:3,default:5},{title:"Max Zone Bars",precision:0,min:5,default:25},{title:"ATR Period",precision:0,min:1,default:14},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Min Volume Factor",precision:2,min:.1,default:1.2},{title:"Max Zone Width %",precision:3,min:.001,default:.03},{title:"Prior Trend Lookback",precision:0,min:1,default:20},{title:"Min OBV Trend Strength",precision:2,min:0,default:.2},{title:"Min Zone Score",precision:2,min:0,max:1,default:.6},{title:"Merge Nearby Zones (0/1)",precision:0,min:0,max:1,default:1},{title:"Max Zones Displayed",precision:0,min:1,default:20},{title:"Show Labels (0/1)",precision:0,min:0,max:1,default:1}],VOLCANIC:[{title:"BB Period",precision:0,min:1,default:16},{title:"BB StdDev",precision:2,min:.1,default:2},{title:"ATR Period",precision:0,min:1,default:14},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Normalize Lookback",precision:0,min:10,default:60},{title:"Pressure SMA",precision:0,min:1,default:2},{title:"Min Pressure Alert",precision:2,min:0,max:1,default:.55},{title:"Confirm Bars",precision:0,min:1,default:1},{title:"Min Volume x",precision:2,min:.5,default:1},{title:"Min Range x",precision:2,min:.5,default:1},{title:"Min Body % of Range",precision:2,min:0,max:1,default:.5},{title:"Breakout Lookback",precision:0,min:5,default:10},{title:"Min Bars Between Signals",precision:0,min:1,default:1},{title:"Trend EMA Period",precision:0,min:2,default:30},{title:"Require Trend Align (0/1)",precision:0,min:0,max:1,default:0},{title:"Breakout Buffer %",precision:4,min:0,default:7e-4},{title:"Require BB Band Break (0/1)",precision:0,min:0,max:1,default:0},{title:"Retest Window (bars)",precision:0,min:1,default:1}],VOLCANIC_SIG:[{title:"BB Period",precision:0,min:1,default:16},{title:"BB StdDev",precision:2,min:.1,default:2},{title:"ATR Period",precision:0,min:1,default:14},{title:"Volume MA Period",precision:0,min:1,default:20},{title:"Normalize Lookback",precision:0,min:10,default:60},{title:"Pressure SMA",precision:0,min:1,default:2},{title:"Min Pressure Alert",precision:2,min:0,max:1,default:.55},{title:"Confirm Bars",precision:0,min:1,default:1},{title:"Min Volume x",precision:2,min:.5,default:1},{title:"Min Range x",precision:2,min:.5,default:1},{title:"Min Body % of Range",precision:2,min:0,max:1,default:.5},{title:"Breakout Lookback",precision:0,min:5,default:10},{title:"Min Bars Between Signals",precision:0,min:1,default:1},{title:"Trend EMA Period",precision:0,min:2,default:30},{title:"Require Trend Align (0/1)",precision:0,min:0,max:1,default:0},{title:"Breakout Buffer %",precision:4,min:0,default:7e-4},{title:"Require BB Band Break (0/1)",precision:0,min:0,max:1,default:0},{title:"Retest Window (bars)",precision:0,min:1,default:1}],ZIGZAG:[{title:"Deviation %",precision:1,min:1,max:50,default:5},{title:"Depth",precision:0,min:1,max:50,default:5}]};function UM(o,e){if(o>1e12)throw Error("10 digit timestamp is require for align_tfsecs");let t=0;for(const s of GM){if(e<s.tfsecs)break;if(e%s.tfsecs==0){t=s.origin;break}}return t?Math.floor((o-t)/e)*e+t:Math.floor(o/e)*e}function Iy(o,e){if((!o||isNaN(o)||o<=0)&&(console.warn("Invalid timestamp in align_tfmsecs:",o),o=Date.now()),o<1e12&&(console.warn("13 digit timestamp is require for align_tfmsecs, got:",o),o<1e9?o=o*1e3:o=Date.now()),e<1e3)throw Error("milliseconds tf_msecs is require for align_tfmsecs");const t=Math.floor(o/1e3),s=Math.floor(e/1e3);return UM(t,s)*1e3}function KM(o,e,t,s=null){if(o=o.map((a,l)=>{const d=a[0];return(!d||isNaN(d)||d<=0)&&(console.warn(`Invalid timestamp in build_ohlcvs at index ${l}:`,d),a[0]=Date.now()),a}),s&&((!s[0]||isNaN(s[0])||s[0]<=0)&&(console.warn("Invalid timestamp in last_bar:",s[0]),s[0]=Date.now()),s[0]=Iy(s[0],t)),e==t)return s&&o.length>0&&o[0][0]>s[0]&&o.splice(0,0,s),o;const i=s?[s]:[];let r=i.length-1;return o.forEach((a,l)=>{if((!a[0]||isNaN(a[0])||a[0]<=0)&&(console.warn(`Invalid timestamp in build_ohlcvs forEach at index ${l}:`,a[0]),a[0]=Date.now()),a[0]=Iy(a[0],t),r<0||a[0]>i[r][0])i.push(a),r+=1;else{const d=i[r];d[2]=Math.max(d[2],a[2]),d[3]=Math.min(d[3],a[3]),d[4]=a[4],d[5]+=a[5]}}),i}function al(o){var s,i,r,a,l,d,v,p;const e=Rt.cloneDeep(o),t=(s=e.candle)==null?void 0:s.type;if(t&&(e._originalChartType=t),e.candle&&e.candle.type==="area"&&!e.candle._isLineChart){e.candle.area||(e.candle.area={});const _=((i=e.candle.bar)==null?void 0:i.upColor)||((r=e.candle.bar)==null?void 0:r.downColor)||((d=(l=(a=e.candle.priceMark)==null?void 0:a.last)==null?void 0:l.text)==null?void 0:d.color)||((p=(v=e.candle.tooltip)==null?void 0:v.text)==null?void 0:p.color)||"#2196F3";e.candle.area={...e.candle.area,backgroundColor:[{offset:0,color:_+"60"},{offset:1,color:_+"10"}]}}if(o.yAxis&&(e.yAxis={...e.yAxis,...o.yAxis}),o.xAxis&&(e.xAxis={...e.xAxis,...o.xAxis}),o.grid&&(e.grid={...e.grid,...o.grid}),o.indicator&&(e.indicator={...e.indicator,...o.indicator}),e.candle&&e.candle.type==="heikin_ashi"&&(e.candle.type="candle_solid"),e.candle&&e.candle.type==="renko_atr"&&(e.candle.type="candle_solid"),e.candle&&e.candle.type==="point_and_figure"){e.candle.type="candle_solid";const _="rgba(0,0,0,0)";e.candle.bar={...e.candle.bar,upColor:_,downColor:_,noChangeColor:_,upBorderColor:_,downBorderColor:_,noChangeBorderColor:_,upWickColor:_,downWickColor:_,noChangeWickColor:_},e.candle.priceMark||(e.candle.priceMark={}),e.candle.priceMark.high={show:!1},e.candle.priceMark.low={show:!1}}else if(e.candle&&e.candle.bar){const _=e.candle.bar,y=L=>!L||L==="transparent"||L==="rgba(0,0,0,0)",w="#26A69A",k="#EF5350",S="#888888";y(_.upColor)&&(_.upColor=w),y(_.downColor)&&(_.downColor=k),y(_.noChangeColor)&&(_.noChangeColor=S),y(_.upBorderColor)&&(_.upBorderColor=w),y(_.downBorderColor)&&(_.downBorderColor=k),y(_.noChangeBorderColor)&&(_.noChangeBorderColor=S),y(_.upWickColor)&&(_.upWickColor=w),y(_.downWickColor)&&(_.downWickColor=k),y(_.noChangeWickColor)&&(_.noChangeWickColor=S),e.candle.bar=_}return e}function ZM(o,e){var t,s;return(t=e==null?void 0:e.candle)!=null&&t.type?(console.log("✅ Using chart type from $save.styles:",e.candle.type),e.candle.type):o!=null&&o._originalChartType?(console.log("✅ Using original chart type from marker:",o._originalChartType),o._originalChartType):(s=o==null?void 0:o.candle)!=null&&s.type?(console.log("⚠️ Using chart type from chart.getStyles() (might be converted):",o.candle.type),o.candle.type):(console.log("⚠️ No chart type found, defaulting to candle_solid"),"candle_solid")}function My(o){if(!o||o.length===0)return o;const e=[];let t=0,s=0;for(let i=0;i<o.length;i++){const r=o[i],a=(r.open+r.high+r.low+r.close)/4;let l;i===0?l=(r.open+r.close)/2:l=(t+s)/2;const d=Math.max(r.high,l,a),v=Math.min(r.low,l,a),p={...r,open:l,high:d,low:v,close:a};e.push(p),t=l,s=a}return e}function Ty(o,e){if(!Array.isArray(o)||o.length===0)return o;const t=(e==null?void 0:e.method)||"ATR",s=Math.max(1,((e==null?void 0:e.atrLength)??14)|0),i=(e==null?void 0:e.source)||"close",r=!!(e!=null&&e.wick),a=T=>{switch(i){case"open":return T.open;case"high":return T.high;case"low":return T.low;default:return T.close}},l=[];let d=null;for(let T=0;T<o.length;T++){const P=o[T],A=d==null?Math.max(0,P.high-P.low):Math.max(P.high-P.low,Math.abs(P.high-d),Math.abs(P.low-d));l.push(Math.max(0,A)),d=P.close}const v=new Array(l.length).fill(0);let p=0;for(let T=0;T<l.length;T++)p+=l[T],T===s-1?v[T]=p/s:T>=s?v[T]=(v[T-1]*(s-1)+l[T])/s:v[T]=l[T];const _=v[Math.min(v.length-1,Math.max(0,s-1))]||l.reduce((T,P)=>T+P,0)/Math.max(1,l.length),y=Math.max(1e-12,v[v.length-1]||_),w=[];let k=a(o[0]),S=o[0]&&typeof o[0].timestamp=="number"?o[0].timestamp:Date.now();const L=1e3;for(let T=1;T<o.length;T++){const P=o[T],A=a(P);let F=y;if(!F||F<=0)continue;const R=Math.max(1e-12,Math.abs(P.high-P.low))*1e-6;F<R&&(F=R);let N=Math.floor((A-(k+F))/F)+1;N>0&&(N=Math.min(N,L));for(let V=0;V<N;V++){const U=k,G=k+F,Z=Math.max(U,G),le=Math.min(U,G),se=V===N-1,ie=r&&se?Math.max(Z,P.high):Z,Y=le;S=Math.max(P.timestamp||S,S+1),w.push({timestamp:S,open:U,high:ie,low:Y,close:G,volume:P.volume??0}),k=G}let $=Math.floor((k-F-A)/F)+1;$>0&&($=Math.min($,L));for(let V=0;V<$;V++){const U=k,G=k-F,Z=Math.max(U,G),le=Math.min(U,G),se=V===$-1,ie=Z,Y=r&&se?Math.min(le,P.low):le;S=Math.max(P.timestamp||S,S+1),w.push({timestamp:S,open:U,high:ie,low:Y,close:G,volume:P.volume??0}),k=G}}if(w.length===0){const T=o[o.length-1],P=T.open,A=T.close,F=r?T.high:Math.max(P,A),B=r?T.low:Math.min(P,A);w.push({timestamp:T.timestamp||S||Date.now(),open:P,high:F,low:B,close:A,volume:T.volume??0})}return w}const XM={boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"};function Ay(o,e){if(!Array.isArray(o)||o.length===0)return o;const t={...XM,...e};let s;if(t.boxSizeMode==="ATR"){const T=Math.max(1,t.atrLength||14),P=[];let A=null;for(let N=0;N<o.length;N++){const $=o[N],V=A==null?Math.max(0,$.high-$.low):Math.max($.high-$.low,Math.abs($.high-A),Math.abs($.low-A));P.push(Math.max(0,V)),A=$.close}const F=new Array(P.length).fill(0);let B=0;for(let N=0;N<P.length;N++)B+=P[N],N===T-1?F[N]=B/T:N>=T?F[N]=(F[N-1]*(T-1)+P[N])/T:F[N]=P[N];const R=F[F.length-1]||P.reduce((N,$)=>N+$,0)/Math.max(1,P.length);s=Math.max(1e-4,R)}else if(t.boxSizeMode==="percent"){const T=o.reduce((P,A)=>P+A.close,0)/o.length;s=Math.max(1e-4,T*t.boxSize/100)}else s=Math.max(1e-4,t.boxSize);const i=s*t.reversalBoxes,r=o[0];let a=r.close>=r.open?"up":"down",l=Math.floor(r.high/s)*s,d=Math.ceil(r.low/s)*s;const v=[];let p=0,_={columnIndex:0,direction:a,boxes:[],highPrice:l,lowPrice:d,startTime:r.timestamp||Date.now(),endTime:r.timestamp||Date.now()};const y=Math.max(1,Math.round((l-d)/s));for(let T=0;T<=y;T++){const P=d+T*s;_.boxes.push({columnIndex:0,direction:a,boxIndex:T,price:P,startTime:_.startTime,endTime:_.endTime})}const w=500;for(let T=1;T<o.length;T++){const P=o[T],A=P.timestamp||Date.now();if(_.endTime=A,a==="up"){const F=Math.floor(P.high/s)*s;if(F>l){let B=Math.round((F-l)/s);B=Math.min(B,w-_.boxes.length);for(let R=1;R<=B;R++){const N=l+R*s;_.boxes.push({columnIndex:p,direction:"up",boxIndex:_.boxes.length,price:N,startTime:A,endTime:A})}l=F,_.highPrice=l}if(l-P.low>=i){const B=Math.ceil(P.low/s)*s;v.push(_),p++,a="down",d=B,_={columnIndex:p,direction:"down",boxes:[],highPrice:l-s,lowPrice:d,startTime:A,endTime:A};let R=Math.round((_.highPrice-d)/s);R=Math.min(R,w);for(let N=0;N<=R;N++){const $=_.highPrice-N*s;_.boxes.push({columnIndex:p,direction:"down",boxIndex:N,price:$,startTime:A,endTime:A})}l=_.highPrice}}else{const F=Math.ceil(P.low/s)*s;if(F<d){let B=Math.round((d-F)/s);B=Math.min(B,w-_.boxes.length);for(let R=1;R<=B;R++){const N=d-R*s;_.boxes.push({columnIndex:p,direction:"down",boxIndex:_.boxes.length,price:N,startTime:A,endTime:A})}d=F,_.lowPrice=d}if(P.high-d>=i){const B=Math.floor(P.high/s)*s;v.push(_),p++,a="up",l=B,_={columnIndex:p,direction:"up",boxes:[],highPrice:l,lowPrice:d+s,startTime:A,endTime:A};let R=Math.round((l-_.lowPrice)/s);R=Math.min(R,w);for(let N=0;N<=R;N++){const $=_.lowPrice+N*s;_.boxes.push({columnIndex:p,direction:"up",boxIndex:N,price:$,startTime:A,endTime:A})}d=_.lowPrice}}}if(_.boxes.length>0&&v.push(_),v.length===0)return o;const k=[],S=Date.now(),L=6e4;for(const T of v){const P=T.startTime||S+T.columnIndex*L;k.push({timestamp:P,open:T.direction==="up"?T.lowPrice:T.highPrice,high:T.highPrice,low:T.lowPrice,close:T.direction==="up"?T.highPrice:T.lowPrice,volume:T.boxes.length,_pnf:{columnIndex:T.columnIndex,direction:T.direction,boxes:T.boxes,boxCount:T.boxes.length,boxSize:s,upColor:t.upColor,downColor:t.downColor}})}return k}function Hp(o){return o.exchange&&o.ticker?`${o.exchange.toUpperCase()}:${o.ticker.toUpperCase()}`:(o.ticker||o.name||"UNKNOWN").toUpperCase()}function JM(o,e){var r,a,l,d;const t=[];if(e)try{const v=((r=e.getChartStore)==null?void 0:r.call(e))||e;v&&typeof v.getPanes=="function"?v.getPanes().forEach((_,y)=>{t.push({id:_.id||`pane_${y}`,height:_.height,minHeight:_.minHeight,position:y,visible:_.visible!==!1})}):t.push({id:"candle_pane",height:400,position:0,visible:!0})}catch(v){console.warn("Error collecting pane configurations:",v),t.push({id:"candle_pane",height:400,position:0,visible:!0})}const s=[],i=new Map;if(Object.entries(o.saveInds).forEach(([v,p])=>{var S,L,T,P,A,F,B,R,N,$,V,U;const _={};p.params&&Array.isArray(p.params)&&p.params.forEach((G,Z)=>{_[`param_${Z}`]=G});const y={};p.styles&&Array.isArray(p.styles)?p.styles.forEach((G,Z)=>{y[`style_${Z}`]=G}):p.styles&&typeof p.styles=="object"&&Object.assign(y,p.styles);const w={id:v,type:p.name,params:_,styles:y,paneId:p.pane_id,visible:!0,...Object.fromEntries(Object.entries(p).filter(([G])=>!["name","pane_id","params","styles"].includes(G)))};if(w.type==="RSI"){const G=w;if(!G.rsiGroups||G.rsiGroups.length===0){const Z=w.paneId||"pane_RSI",le=mp.getInstance(Z)||mp.getInstanceConfig(Z);if(le){const se=le.overboughtThreshold??((T=(L=(S=le.levels)==null?void 0:S.find)==null?void 0:L.call(S,K=>K.id==="overbought"))==null?void 0:T.value)??70,ie=((F=(A=(P=le.levels)==null?void 0:P.find)==null?void 0:A.call(P,K=>K.id==="middle"))==null?void 0:F.value)??50,Y=le.oversoldThreshold??((N=(R=(B=le.levels)==null?void 0:B.find)==null?void 0:R.call(B,K=>K.id==="oversold"))==null?void 0:N.value)??30;G.rsiGroups=[{period:le.period??14,overboughtLevel:se,middleLevel:ie,oversoldLevel:Y,styles:{rsi:{color:le.lineColor??"#8B5CF6",thickness:le.lineThickness??2,lineStyle:le.lineStyle??"solid"},overboughtColor:le.overboughtColor??"#EF4444",oversoldColor:le.oversoldColor??"#10B981",middleLineColor:((U=(V=($=le.levels)==null?void 0:$.find)==null?void 0:V.call($,K=>K.id==="middle"))==null?void 0:U.color)??"#6B7280"}}]}}}const k=`${p.name}_${p.pane_id||"candle_pane"}`;i.set(k,w)}),e)try{const v=((a=e.getIndicators)==null?void 0:a.call(e))??[];console.log("📊 Collecting indicators from chart:",v.length,"found"),v.forEach(p=>{if(!p.name)return;const _=p.paneId||"candle_pane",y=`${p.name}_${_}`;if(i.has(y)){console.log(`✅ Indicator ${p.name} (${_}) already in saveInds`);return}console.log(`⚠️ Indicator ${p.name} (${_}) on chart but not in saveInds`);let w=null,k=null;for(const[S,L]of Object.entries(o.saveInds))if(L.name===p.name&&(L.pane_id===_||!L.pane_id&&_==="candle_pane")){w=L,k=S;break}if(w&&k){console.log(`✅ Found matching saveInd for ${p.name} with key: ${k}`);const S={};w.params&&Array.isArray(w.params)&&w.params.forEach((P,A)=>{S[`param_${A}`]=P});const L={};w.styles&&Array.isArray(w.styles)?w.styles.forEach((P,A)=>{L[`style_${A}`]=P}):w.styles&&typeof w.styles=="object"&&Object.assign(L,w.styles);const T={id:k,type:w.name,params:S,styles:L,paneId:w.pane_id||_,visible:!0,...Object.fromEntries(Object.entries(w).filter(([P])=>!["name","pane_id","params","styles"].includes(P)))};i.set(y,T)}else{if(p.name==="RSI"){console.log(`♻️ Skipping fallback SavedIndicator creation for RSI on pane ${_} (no matching saveInd)`);return}console.log(`⚠️ No matching saveInd found for ${p.name}, creating basic entry`);const L={id:`${_}_${p.name}`,type:p.name,params:{},styles:{},paneId:_,visible:!0};i.set(y,L)}})}catch(v){console.warn("⚠️ Failed to get indicators from chart, using saveInds only:",v)}return s.push(...Array.from(i.values())),console.log(`✅ Collected ${s.length} indicators for saving (${Object.keys(o.saveInds).length} from saveInds, ${s.length-Object.keys(o.saveInds).length} from chart)`),{timezone:o.timezone,interval:o.period.timeframe,chartType:((d=(l=o.styles)==null?void 0:l.candle)==null?void 0:d.type)||"candle_solid",theme:o.theme,panes:t,indicators:s,styles:o.styles||{},options:o.options||{}}}async function QM(o,e,t){var s,i,r,a,l,d,v,p,_,y,w,k,S,L,T,P,A,F,B,R,N,$,V,U,G,Z,le,se,ie,Y,K,Q,q,ce;try{if(console.log("🔄 Applying global state:",o),t){try{t.removeIndicator({}),console.log("🧹 Removed all existing indicators before applying new layout")}catch(ge){console.warn("Failed to clear existing indicators before applying layout:",ge)}try{const{RSIManager:ge}=await N1(async()=>{const{RSIManager:be}=await Promise.resolve().then(()=>yy);return{RSIManager:be}},void 0,import.meta.url);ge.clearAllInstances()}catch{}}const _e={},me=["SMART_MONEY","TRAP_HUNTER","VOLCANIC","VOLCANIC_SIG"],Pe=(s=zd(Up))==null?void 0:s.data,ze=Pe&&(Pe.isPremium===!0||Pe.isTrial===!0),he=[],De=new Set;if(o.indicators.forEach(ge=>{if(ge.type==="RSI"){const be=ge.rsiGroups,$e=Array.isArray(be)&&be.length>0&&(be[0].actualPaneId||be[0].paneId)||ge.paneId;if($e){if(De.has($e)){console.log("♻️ Skipping duplicate RSI indicator for pane:",$e);return}De.add($e),ge.paneId=$e,ge.id=`${$e}_RSI`,Array.isArray(be)&&be.length>0&&(be[0].paneId=$e,be[0].actualPaneId=$e)}}he.push(ge)}),he.forEach(ge=>{if(!ze&&ge.type&&me.includes(ge.type)){console.log(`🔒 Skipping AI indicator ${ge.type} - user does not have premium access`);return}const be=[];ge.params&&typeof ge.params=="object"&&Object.entries(ge.params).forEach(([Ce,Je])=>{if(Ce.startsWith("param_")){const ye=parseInt(Ce.replace("param_",""));be[ye]=Je}});const $e=[];ge.styles&&typeof ge.styles=="object"&&Object.entries(ge.styles).forEach(([Ce,Je])=>{if(Ce.startsWith("style_")&&typeof Je=="object"){const ye=parseInt(Ce.replace("style_",""));$e[ye]=Je}});const Ve={name:ge.type,pane_id:ge.paneId,params:be.length>0?be:void 0,styles:$e.length>0?$e:void 0,...Object.fromEntries(Object.entries(ge).filter(([Ce])=>!["id","type","paneId","params","styles","visible"].includes(Ce)))};_e[ge.id]=Ve}),e.update(ge=>{ge.timezone=o.timezone,ge.period={...ge.period,timeframe:o.interval};const be=o.styles&&typeof o.styles=="object"?{...o.styles}:{},$e=ge.theme||o.theme||"dark";if((o.theme||$e)!==$e)try{const Ce=Ul($e),Je=Rt.merge({},Ce,be);delete Je.backgroundColor,delete Je.backgroundOpacity,delete Je.backgroundType,delete Je.backgroundGradient,delete Je.gridColor,delete Je.gridOpacity,delete Je.gridType,delete Je.gridGradient,ge.styles=Je}catch{ge.styles=be}else ge.styles=be;return ge.styles.candle||(ge.styles.candle={}),ge.styles.candle.type=o.chartType,ge.options=o.options&&typeof o.options=="object"?{...o.options}:{},ge.saveInds=_e,ge}),t)try{const ge=zd(e);t.setStyles&&ge.styles&&(t.setStyles(ge.styles),console.log("🎨 Applied saved styles to chart"))}catch(ge){console.warn("Failed to apply saved styles to chart:",ge)}if(t&&he.length>0){console.log("Creating indicators on chart:",he.length);for(const ge of he)try{const be=[];ge.params&&typeof ge.params=="object"&&Object.entries(ge.params).forEach(([ye,Ae])=>{if(ye.startsWith("param_")){const ee=parseInt(ye.replace("param_",""));be[ee]=Ae}});const $e=[];ge.styles&&typeof ge.styles=="object"&&Object.entries(ge.styles).forEach(([ye,Ae])=>{if(ye.startsWith("style_")&&typeof Ae=="object"){const ee=parseInt(ye.replace("style_",""));$e[ee]=Ae}});const Ve={name:ge.type,calcParams:be.length>0?be:void 0,visible:ge.visible!==!1};if($e.length>0&&(Ve.styles={lines:$e.map(ye=>{const Ae=ye.lineStyle==="dashed"||ye.lineStyle==="dotted",ee=ye.lineStyle==="dotted"?[2,2]:[4,4];return{color:ye.color,size:ye.thickness??1,style:Ae?Ee.Dashed:Ee.Solid,dashedValue:Ae?ee:[2,2]}})}),ge.type==="SMARTTREND"){const ye=ge.superTrendGroup,Ae=ye?{showLabels:!!ye.showLabels,uptrendColor:((r=(i=ye.styles)==null?void 0:i.uptrend)==null?void 0:r.color)??"#00FF00",downtrendColor:((l=(a=ye.styles)==null?void 0:a.downtrend)==null?void 0:l.color)??"#FF0000",uptrendThickness:((v=(d=ye.styles)==null?void 0:d.uptrend)==null?void 0:v.thickness)??1,downtrendThickness:((_=(p=ye.styles)==null?void 0:p.downtrend)==null?void 0:_.thickness)??1,uptrendLineStyle:((w=(y=ye.styles)==null?void 0:y.uptrend)==null?void 0:w.lineStyle)??"dashed",downtrendLineStyle:((S=(k=ye.styles)==null?void 0:k.downtrend)==null?void 0:S.lineStyle)??"dashed"}:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"};if(Ve.extendData=Ae,!Ve.styles){const ee=Ae.uptrendLineStyle==="dotted"||Ae.uptrendLineStyle==="dashed";Ve.styles={lines:[{color:Ae.uptrendColor,size:Ae.uptrendThickness,style:ee?Ee.Dashed:Ee.Solid,dashedValue:Ae.uptrendLineStyle==="dotted"?[2,2]:[4,4]}]}}}if(ge.type==="RSI"){const ye=ge.rsiGroups||[],Ae=ge.paneId;if(Array.isArray(ye)&&ye.length>0){const ee=ye[0],xe=((L=ee.styles)==null?void 0:L.overboughtColor)??"#EF4444",ke=((T=ee.styles)==null?void 0:T.oversoldColor)??"#22C55E",He=((P=ee.styles)==null?void 0:P.middleLineColor)??"#6B7280",Ie=ee.fillOpacity??.15,ne=((A=ee.styles)==null?void 0:A.overboughtThickness)??1,J=((F=ee.styles)==null?void 0:F.oversoldThickness)??1,qe=((B=ee.styles)==null?void 0:B.middleLineThickness)??1,ft=((R=ee.styles)==null?void 0:R.overboughtLineStyle)??"dashed",Qe=((N=ee.styles)==null?void 0:N.oversoldLineStyle)??"dashed",Oe=(($=ee.styles)==null?void 0:$.middleLineStyle)??"dashed",ct={id:Ae,period:ee.period??14,lineColor:((U=(V=ee.styles)==null?void 0:V.rsi)==null?void 0:U.color)??"#8B5CF6",lineThickness:((Z=(G=ee.styles)==null?void 0:G.rsi)==null?void 0:Z.thickness)??2,lineStyle:((se=(le=ee.styles)==null?void 0:le.rsi)==null?void 0:se.lineStyle)??"solid",overboughtLevel:ee.overboughtLevel??70,oversoldLevel:ee.oversoldLevel??30,middleLevel:ee.middleLevel??50,overboughtColor:xe,overboughtThickness:ne,overboughtLineStyle:ft,oversoldColor:ke,oversoldThickness:J,oversoldLineStyle:Qe,overboughtFillColor:xe,oversoldFillColor:ke,middleLineColor:He,middleLineThickness:qe,middleLineStyle:Oe,fillOpacity:Ie,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:ee.overboughtLevel??70,color:xe,lineStyle:ft,thickness:ne,label:String(ee.overboughtLevel??70),visible:!0},{id:"middle",value:ee.middleLevel??50,color:He,lineStyle:Oe,thickness:qe,label:String(ee.middleLevel??50),visible:!0},{id:"oversold",value:ee.oversoldLevel??30,color:ke,lineStyle:Qe,thickness:J,label:String(ee.oversoldLevel??30),visible:!0}]};try{const{RSIManager:zt}=await N1(async()=>{const{RSIManager:pt}=await Promise.resolve().then(()=>yy);return{RSIManager:pt}},void 0,import.meta.url);zt.importInstanceConfig(ct)}catch{}Ve.calcParams=[ee.period??14];const Lt={color:((Y=(ie=ee.styles)==null?void 0:ie.rsi)==null?void 0:Y.color)??"#8B5CF6",size:((Q=(K=ee.styles)==null?void 0:K.rsi)==null?void 0:Q.thickness)??2,style:Ee.Solid,dashedValue:[2,2]},It=(ce=(q=ee.styles)==null?void 0:q.rsi)==null?void 0:ce.lineStyle;It==="dashed"?(Lt.style=Ee.Dashed,Lt.dashedValue=[6,4]):It==="dotted"&&(Lt.style=Ee.Dashed,Lt.dashedValue=[2,2]),Ve.styles={lines:[Lt]}}}const Ce=ge.paneId==="candle_pane",Je=t.createIndicator(Ve,Ce,{id:ge.paneId});console.log(`Created indicator ${ge.type} with ID:`,Je)}catch(be){console.error(`Failed to create indicator ${ge.type}:`,be)}}console.log("Applied global state:",{timezone:o.timezone,interval:o.interval,chartType:o.chartType,theme:o.theme,indicatorCount:he.length,indicatorsCreated:t?he.length:0})}catch(_e){throw console.error("Error applying global state:",_e),_e}}function Ly(o){return Hp(o.symbol)}class eT{constructor(e){re(this,"chart");re(this,"persistenceKey");re(this,"currentSymbol",null);re(this,"ephemeralMode",!0);re(this,"drawingsBySymbol",new Map);re(this,"renderedDrawingIds",new Set);re(this,"onDrawingCreated");re(this,"onDrawingRemoved");re(this,"onSymbolChanged");re(this,"symbolChangeCallbacks",new Set);this.chart=e.chart,this.persistenceKey=e.persistenceKey,this.onDrawingCreated=e.onDrawingCreated,this.onDrawingRemoved=e.onDrawingRemoved,this.onSymbolChanged=e.onSymbolChanged,this.ephemeralMode||this.loadFromStorage(),console.log("✅ DrawingManager initialized with key:",this.persistenceKey)}setCurrentSymbol(e){var i;const t=typeof e=="string"?e:Hp(e);if(this.currentSymbol===t){console.log("🔄 Symbol unchanged, skipping reload:",t);return}const s=this.currentSymbol;this.currentSymbol=t,console.log(`🔄 Symbol changed: ${s} → ${t}`),this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol(),s&&((i=this.onSymbolChanged)==null||i.call(this,s,t),this.symbolChangeCallbacks.forEach(r=>r(t)))}getCurrentSymbol(){return this.currentSymbol}addDrawing(e){var i;if(!e.symbolKey)throw console.error("❌ Cannot add drawing without symbolKey:",e),new Error("Drawing must have a symbolKey");let t=this.drawingsBySymbol.get(e.symbolKey);t||(t=[],this.drawingsBySymbol.set(e.symbolKey,t));const s=t.findIndex(r=>r.id===e.id);s>=0?(t[s]=e,console.log("🔄 Updated drawing:",e.id,"for symbol:",e.symbolKey)):(t.push(e),console.log("➕ Added drawing:",e.id,"for symbol:",e.symbolKey)),this.saveToStorage(),e.symbolKey===this.currentSymbol&&e.visible!==!1&&this.renderDrawing(e),(i=this.onDrawingCreated)==null||i.call(this,e)}removeDrawing(e){var i,r;let t=!1,s=null;for(const[a,l]of this.drawingsBySymbol.entries()){const d=l.findIndex(v=>v.id===e);if(d>=0){l.splice(d,1),t=!0,s=a,console.log("🗑️ Removed drawing:",e,"from symbol:",a);break}}return t&&(s&&((i=this.drawingsBySymbol.get(s))==null?void 0:i.length)===0&&this.drawingsBySymbol.delete(s),this.saveToStorage(),this.renderedDrawingIds.has(e)&&(this.chart.removeOverlay({id:e}),this.renderedDrawingIds.delete(e)),s&&((r=this.onDrawingRemoved)==null||r.call(this,e,s))),t}removeDrawingForSymbol(e,t){var r;const s=this.drawingsBySymbol.get(t);if(!s)return!1;const i=s.findIndex(a=>a.id===e);return i<0?!1:(s.splice(i,1),s.length===0&&this.drawingsBySymbol.delete(t),this.saveToStorage(),this.renderedDrawingIds.has(e)&&(this.chart.removeOverlay({id:e}),this.renderedDrawingIds.delete(e)),(r=this.onDrawingRemoved)==null||r.call(this,e,t),!0)}getDrawingsForSymbol(e){return this.drawingsBySymbol.get(e)||[]}getCurrentSymbolDrawings(){return this.currentSymbol?this.getDrawingsForSymbol(this.currentSymbol):[]}getAllDrawings(){return new Map(this.drawingsBySymbol)}clearDrawingsForSymbol(e){const t=this.drawingsBySymbol.get(e);t&&(e===this.currentSymbol&&t.forEach(s=>{this.renderedDrawingIds.has(s.id)&&(this.chart.removeOverlay({id:s.id}),this.renderedDrawingIds.delete(s.id))}),this.drawingsBySymbol.delete(e),this.saveToStorage(),console.log("🗑️ Cleared all drawings for symbol:",e))}clearCurrentSymbolDrawings(){this.currentSymbol&&this.clearDrawingsForSymbol(this.currentSymbol)}clearRenderedDrawings(){this.renderedDrawingIds.forEach(e=>{try{this.chart.removeOverlay({id:e})}catch(t){console.warn("Failed to remove overlay:",e,t)}}),this.renderedDrawingIds.clear(),console.log("🧹 Cleared rendered drawings from chart")}hideRenderedDrawings(){this.clearRenderedDrawings()}renderDrawingsForCurrentSymbol(){if(!this.currentSymbol){console.log("⚠️ No current symbol, skipping render");return}const e=this.getDrawingsForSymbol(this.currentSymbol);console.log(`🎨 Rendering ${e.length} drawings for symbol:`,this.currentSymbol),e.forEach(t=>{t.visible!==!1&&this.renderDrawing(t)})}renderCurrentSymbolDrawings(){this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol()}renderDrawing(e){if(e.symbolKey!==this.currentSymbol){console.warn("⛔ Drawing symbolKey mismatch, skipping render:",{drawingSymbol:e.symbolKey,currentSymbol:this.currentSymbol});return}try{const t={id:e.id,groupId:"drawing_tools",name:e.type,points:e.points.map(i=>({timestamp:i.time,value:i.price,t:i.time,p:i.price})),styles:e.styles,lock:e.locked,visible:e.visible,onSelected:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalSelectOverlay&&r.externalSelectOverlay(i.overlay)}catch{}return!0},onDeselected:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalDeselectOverlay&&r.externalDeselectOverlay(i.overlay)}catch{}return!0},onPressedMoveEnd:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalSyncOverlay&&r.externalSyncOverlay(i.overlay)}catch{}return!0},onRemoved:i=>{try{const r=typeof window<"u"?window.drawBarRef:null;r!=null&&r.externalRemoved&&r.externalRemoved(i.overlay.id)}catch{}return!0},...Object.fromEntries(Object.entries(e).filter(([i])=>!["id","symbolKey","type","points","styles","locked","visible","seriesId"].includes(i)))};this.chart.createOverlay(t)&&(this.renderedDrawingIds.add(e.id),console.log("✅ Rendered drawing:",e.id,"for symbol:",e.symbolKey))}catch(t){console.error("❌ Failed to render drawing:",e.id,t)}}updateDrawing(e,t){for(const[s,i]of this.drawingsBySymbol.entries()){const r=i.findIndex(a=>a.id===e);if(r>=0){const a=i[r];return i[r]={...a,...t,symbolKey:a.symbolKey},this.saveToStorage(),console.log("🔄 Updated drawing:",e),!0}}return!1}loadDrawingsForSymbol(e,t){const s=t.filter(i=>i.symbolKey!==e?(console.warn("⚠️ Drawing symbolKey mismatch during bulk load:",{expected:e,actual:i.symbolKey,drawingId:i.id}),!1):!0);this.drawingsBySymbol.set(e,s),this.saveToStorage(),e===this.currentSymbol&&(this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol()),console.log(`📥 Loaded ${s.length} drawings for symbol:`,e)}loadAllDrawings(e){this.drawingsBySymbol.clear(),Object.entries(e).forEach(([t,s])=>{const i=s.filter(r=>(r.symbolKey||(console.warn("⚠️ Drawing missing symbolKey, assigning:",t),r.symbolKey=t),!0));this.drawingsBySymbol.set(t,i)}),this.saveToStorage(),this.currentSymbol&&(this.clearRenderedDrawings(),this.renderDrawingsForCurrentSymbol()),console.log("📥 Loaded drawings for",this.drawingsBySymbol.size,"symbols")}saveToStorage(){if(!this.ephemeralMode)try{const e={drawingsBySymbol:Object.fromEntries(this.drawingsBySymbol),version:1};localStorage.setItem(this.persistenceKey,JSON.stringify(e))}catch(e){console.error("❌ Failed to save drawings to storage:",e)}}clearPersistedStorage(){try{localStorage.removeItem(this.persistenceKey),console.log("🧹 Cleared persisted drawing storage for key:",this.persistenceKey)}catch(e){console.warn("Failed to clear persisted drawing storage:",e)}}loadFromStorage(){if(!this.ephemeralMode)try{const e=localStorage.getItem(this.persistenceKey);if(!e){console.log("📭 No stored drawings found");return}const t=JSON.parse(e);if(!t.version){console.log("🔄 Migrating legacy drawing storage..."),this.migrateLegacyStorage(t);return}Object.entries(t.drawingsBySymbol||{}).forEach(([s,i])=>{const r=i.map(a=>(a.symbolKey||(a.symbolKey=s),a));this.drawingsBySymbol.set(s,r)}),console.log("📂 Loaded drawings from storage:",this.drawingsBySymbol.size,"symbols")}catch(e){console.error("❌ Failed to load drawings from storage:",e),this.drawingsBySymbol.clear()}}migrateLegacyStorage(e){if(console.log("🔄 Starting migration of legacy overlay format..."),typeof e=="object"&&!e.drawingsBySymbol){const t={};Object.entries(e).forEach(([s,i])=>{try{const r=s.split("_");if(r.length<3){console.warn("⚠️ Invalid legacy key format:",s);return}const a=r[r.length-1],l=r[r.length-2],v=r.slice(0,-2).join("_").toUpperCase(),p=this.convertLegacyOverlayToDrawing(a,i,v);p&&(t[v]||(t[v]=[]),t[v].push(p))}catch(r){console.warn("⚠️ Failed to migrate legacy overlay:",s,r)}}),Object.entries(t).forEach(([s,i])=>{this.drawingsBySymbol.set(s,i)}),this.saveToStorage(),console.log("✅ Migration complete:",this.drawingsBySymbol.size,"symbols migrated")}}convertLegacyOverlayToDrawing(e,t,s){try{const i=[];return t.points&&Array.isArray(t.points)&&t.points.forEach(r=>{r&&typeof r=="object"&&(r.timestamp&&r.value!==void 0?i.push({time:r.timestamp,price:r.value}):r.time&&r.price!==void 0?i.push({time:r.time,price:r.price}):r.t&&r.p!==void 0&&i.push({time:r.t,price:r.p}))}),i.length===0?(console.warn("Legacy overlay has no valid data coordinates:",e),null):{id:e,symbolKey:s,type:t.name||"unknown",points:i,styles:t.styles||{},locked:!!t.lock,visible:t.visible!==!1,...Object.fromEntries(Object.entries(t).filter(([r])=>!["name","points","styles","lock","visible"].includes(r)))}}catch(i){return console.warn("Error converting legacy overlay to drawing:",e,i),null}}onSymbolChange(e){this.symbolChangeCallbacks.add(e)}offSymbolChange(e){this.symbolChangeCallbacks.delete(e)}exportDrawings(){return Object.fromEntries(this.drawingsBySymbol)}getStats(){let e=0;return this.drawingsBySymbol.forEach(t=>{e+=t.length}),{totalSymbols:this.drawingsBySymbol.size,totalDrawings:e,currentSymbolDrawings:this.getCurrentSymbolDrawings().length,renderedDrawings:this.renderedDrawingIds.size}}destroy(){this.clearRenderedDrawings(),this.symbolChangeCallbacks.clear(),this.drawingsBySymbol.clear(),console.log("🗑️ DrawingManager destroyed")}}let _0=null;function tT(o){return _0&&(console.warn("⚠️ DrawingManager already initialized, destroying old instance"),_0.destroy()),_0=new eT(o),_0}function Qu(){return _0}class oT{constructor(){re(this,"state",Id({undoStack:[],redoStack:[],maxHistorySize:50}));re(this,"chart",null);re(this,"saveStore",null);re(this,"overlaysStore",null)}init({chart:e,saveStore:t,overlaysStore:s}){this.chart=e,this.saveStore=t,this.overlaysStore=s}addAction(e){this.state.update(t=>(t.redoStack=[],t.undoStack.push(e),t.undoStack.length>t.maxHistorySize&&t.undoStack.shift(),t))}recordAddIndicator(e,t,s,i){const r={type:"ADD_INDICATOR",data:{name:e,paneId:t,params:s,saveKey:i},timestamp:Date.now(),id:`indicator_${e}_${t}_${Date.now()}`};this.addAction(r)}recordRemoveIndicator(e,t,s,i){const r={type:"REMOVE_INDICATOR",data:{name:e,paneId:t,params:s,saveKey:i},timestamp:Date.now(),id:`indicator_${e}_${t}_${Date.now()}`};this.addAction(r)}recordAddOverlay(e,t,s){const i={type:"ADD_OVERLAY",data:{overlayId:e,overlayData:t,overlayKey:s},timestamp:Date.now(),id:`overlay_${e}_${Date.now()}`};this.addAction(i)}recordRemoveOverlay(e,t,s){const i={type:"REMOVE_OVERLAY",data:{overlayId:e,overlayData:t,overlayKey:s},timestamp:Date.now(),id:`overlay_${e}_${Date.now()}`};this.addAction(i)}recordModifyOverlay(e,t,s,i){const r={type:"MODIFY_OVERLAY",data:{overlayId:e,prevData:t,nextData:s,overlayKey:i},timestamp:Date.now(),id:`overlay_${e}_${Date.now()}`};this.addAction(r)}undo(){const e=zd(this.state);if(e.undoStack.length===0)return!1;const t=e.undoStack[e.undoStack.length-1],s=this.executeUndo(t);return s&&this.state.update(i=>{const r=i.undoStack.pop();return r&&i.redoStack.push(r),i}),s}redo(){const e=zd(this.state);if(e.redoStack.length===0)return!1;const t=e.redoStack[e.redoStack.length-1],s=this.executeRedo(t);return s&&this.state.update(i=>{const r=i.redoStack.pop();return r&&i.undoStack.push(r),i}),s}executeUndo(e){var t,s,i,r,a;if(!this.chart)return!1;try{switch(e.type){case"ADD_INDICATOR":this.chart.removeIndicator({paneId:e.data.paneId,name:e.data.name}),this.saveStore&&this.saveStore.update(v=>(delete v.saveInds[e.data.saveKey],v));break;case"REMOVE_INDICATOR":const l=this.chart.createIndicator({name:e.data.name,calcParams:e.data.params},!1,{id:e.data.paneId});this.saveStore&&l&&this.saveStore.update(v=>(v.saveInds[e.data.saveKey]={name:e.data.name,pane_id:e.data.paneId,params:e.data.params},v));break;case"ADD_OVERLAY":this.chart.removeOverlay({id:e.data.overlayId}),this.overlaysStore&&this.overlaysStore.update(v=>(delete v[e.data.overlayKey],v));try{const v=Qu();v&&v.removeDrawing(e.data.overlayId)}catch{}break;case"REMOVE_OVERLAY":const d=this.chart.createOverlay(e.data.overlayData);this.overlaysStore&&d&&this.overlaysStore.update(v=>(v[e.data.overlayKey]=e.data.overlayData,v));try{const v=Qu();if(v){const p=zd(this.saveStore),_=Hp(p.symbol),y=e.data.overlayData,w=Array.isArray(y==null?void 0:y.points)?y.points.map(k=>({time:(k==null?void 0:k.timestamp)??(k==null?void 0:k.t)??0,price:(k==null?void 0:k.value)??(k==null?void 0:k.p)??0})):[];if(w.length>0){const k={id:e.data.overlayId,symbolKey:_,type:(y==null?void 0:y.name)||"unknown",points:w,styles:(y==null?void 0:y.styles)||{},...y!=null&&y.extendData?{extendData:y.extendData}:{},locked:!!(y!=null&&y.lock),visible:(y==null?void 0:y.visible)!==!1};v.addDrawing(k)}}}catch{}break;case"MODIFY_OVERLAY":this.chart.overrideOverlay({id:e.data.overlayId,styles:(t=e.data.prevData)==null?void 0:t.styles,extendData:(s=e.data.prevData)==null?void 0:s.extendData,points:(i=e.data.prevData)==null?void 0:i.points,lock:(r=e.data.prevData)==null?void 0:r.lock,visible:(a=e.data.prevData)==null?void 0:a.visible}),this.overlaysStore&&this.overlaysStore.update(v=>(v[e.data.overlayKey]=e.data.prevData,v));try{const v=Qu();if(v){const p=e.data.prevData,_=Array.isArray(p==null?void 0:p.points)?p.points.map(y=>({time:(y==null?void 0:y.timestamp)??(y==null?void 0:y.t)??0,price:(y==null?void 0:y.value)??(y==null?void 0:y.p)??0})):[];v.updateDrawing(e.data.overlayId,{points:_,styles:(p==null?void 0:p.styles)||{},extendData:p==null?void 0:p.extendData,locked:!!(p!=null&&p.lock),visible:(p==null?void 0:p.visible)!==!1})}}catch{}break;default:return!1}return!0}catch(l){return console.error("Error executing undo:",l),!1}}executeRedo(e){var t,s,i,r,a;if(!this.chart)return!1;try{switch(e.type){case"ADD_INDICATOR":const l=this.chart.createIndicator({name:e.data.name,calcParams:e.data.params},!1,{id:e.data.paneId});this.saveStore&&l&&this.saveStore.update(v=>(v.saveInds[e.data.saveKey]={name:e.data.name,pane_id:e.data.paneId,params:e.data.params},v));break;case"REMOVE_INDICATOR":this.chart.removeIndicator({paneId:e.data.paneId,name:e.data.name}),this.saveStore&&this.saveStore.update(v=>(delete v.saveInds[e.data.saveKey],v));break;case"ADD_OVERLAY":const d=this.chart.createOverlay(e.data.overlayData);this.overlaysStore&&d&&this.overlaysStore.update(v=>(v[e.data.overlayKey]=e.data.overlayData,v));try{const v=Qu();if(v){const p=zd(this.saveStore),_=Hp(p.symbol),y=e.data.overlayData,w=Array.isArray(y==null?void 0:y.points)?y.points.map(k=>({time:(k==null?void 0:k.timestamp)??(k==null?void 0:k.t)??0,price:(k==null?void 0:k.value)??(k==null?void 0:k.p)??0})):[];if(w.length>0){const k={id:e.data.overlayId,symbolKey:_,type:(y==null?void 0:y.name)||"unknown",points:w,styles:(y==null?void 0:y.styles)||{},...y!=null&&y.extendData?{extendData:y.extendData}:{},locked:!!(y!=null&&y.lock),visible:(y==null?void 0:y.visible)!==!1};v.addDrawing(k)}}}catch{}break;case"REMOVE_OVERLAY":this.chart.removeOverlay({id:e.data.overlayId}),this.overlaysStore&&this.overlaysStore.update(v=>(delete v[e.data.overlayKey],v));try{const v=Qu();v&&v.removeDrawing(e.data.overlayId)}catch{}break;case"MODIFY_OVERLAY":this.chart.overrideOverlay({id:e.data.overlayId,styles:(t=e.data.nextData)==null?void 0:t.styles,extendData:(s=e.data.nextData)==null?void 0:s.extendData,points:(i=e.data.nextData)==null?void 0:i.points,lock:(r=e.data.nextData)==null?void 0:r.lock,visible:(a=e.data.nextData)==null?void 0:a.visible}),this.overlaysStore&&this.overlaysStore.update(v=>(v[e.data.overlayKey]=e.data.nextData,v));try{const v=Qu();if(v){const p=e.data.nextData,_=Array.isArray(p==null?void 0:p.points)?p.points.map(y=>({time:(y==null?void 0:y.timestamp)??(y==null?void 0:y.t)??0,price:(y==null?void 0:y.value)??(y==null?void 0:y.p)??0})):[];v.updateDrawing(e.data.overlayId,{points:_,styles:(p==null?void 0:p.styles)||{},extendData:p==null?void 0:p.extendData,locked:!!(p!=null&&p.lock),visible:(p==null?void 0:p.visible)!==!1})}}catch{}break;default:return!1}return!0}catch(l){return console.error("Error executing redo:",l),!1}}canUndo(){return zd(this.state).undoStack.length>0}canRedo(){return zd(this.state).redoStack.length>0}getState(){return this.state}clearHistory(){this.state.update(e=>({...e,undoStack:[],redoStack:[]}))}}const Dc=new oT,sT={"😀":{name:"grinning face",slug:"grinning_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😃":{name:"grinning face with big eyes",slug:"grinning_face_with_big_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😄":{name:"grinning face with smiling eyes",slug:"grinning_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😁":{name:"beaming face with smiling eyes",slug:"beaming_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😆":{name:"grinning squinting face",slug:"grinning_squinting_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😅":{name:"grinning face with sweat",slug:"grinning_face_with_sweat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤣":{name:"rolling on the floor laughing",slug:"rolling_on_the_floor_laughing",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"😂":{name:"face with tears of joy",slug:"face_with_tears_of_joy",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙂":{name:"slightly smiling face",slug:"slightly_smiling_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🙃":{name:"upside-down face",slug:"upside_down_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫠":{name:"melting face",slug:"melting_face",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😉":{name:"winking face",slug:"winking_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😊":{name:"smiling face with smiling eyes",slug:"smiling_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😇":{name:"smiling face with halo",slug:"smiling_face_with_halo",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥰":{name:"smiling face with hearts",slug:"smiling_face_with_hearts",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"😍":{name:"smiling face with heart-eyes",slug:"smiling_face_with_heart_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤩":{name:"star-struck",slug:"star_struck",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😘":{name:"face blowing a kiss",slug:"face_blowing_a_kiss",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😗":{name:"kissing face",slug:"kissing_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☺️":{name:"smiling face",slug:"smiling_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😚":{name:"kissing face with closed eyes",slug:"kissing_face_with_closed_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😙":{name:"kissing face with smiling eyes",slug:"kissing_face_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥲":{name:"smiling face with tear",slug:"smiling_face_with_tear",group:"Smileys & Emotion",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"😋":{name:"face savoring food",slug:"face_savoring_food",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😛":{name:"face with tongue",slug:"face_with_tongue",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😜":{name:"winking face with tongue",slug:"winking_face_with_tongue",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤪":{name:"zany face",slug:"zany_face",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😝":{name:"squinting face with tongue",slug:"squinting_face_with_tongue",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤑":{name:"money-mouth face",slug:"money_mouth_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤗":{name:"smiling face with open hands",slug:"smiling_face_with_open_hands",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤭":{name:"face with hand over mouth",slug:"face_with_hand_over_mouth",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🫢":{name:"face with open eyes and hand over mouth",slug:"face_with_open_eyes_and_hand_over_mouth",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🫣":{name:"face with peeking eye",slug:"face_with_peeking_eye",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🤫":{name:"shushing face",slug:"shushing_face",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🤔":{name:"thinking face",slug:"thinking_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫡":{name:"saluting face",slug:"saluting_face",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🤐":{name:"zipper-mouth face",slug:"zipper_mouth_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤨":{name:"face with raised eyebrow",slug:"face_with_raised_eyebrow",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😐":{name:"neutral face",slug:"neutral_face",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"😑":{name:"expressionless face",slug:"expressionless_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😶":{name:"face without mouth",slug:"face_without_mouth",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫥":{name:"dotted line face",slug:"dotted_line_face",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😶‍🌫️":{name:"face in clouds",slug:"face_in_clouds",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"😏":{name:"smirking face",slug:"smirking_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😒":{name:"unamused face",slug:"unamused_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙄":{name:"face with rolling eyes",slug:"face_with_rolling_eyes",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😬":{name:"grimacing face",slug:"grimacing_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😮‍💨":{name:"face exhaling",slug:"face_exhaling",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"🤥":{name:"lying face",slug:"lying_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫨":{name:"shaking face",slug:"shaking_face",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🙂‍↔️":{name:"head shaking horizontally",slug:"head_shaking_horizontally",group:"Smileys & Emotion",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🙂‍↕️":{name:"head shaking vertically",slug:"head_shaking_vertically",group:"Smileys & Emotion",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"😌":{name:"relieved face",slug:"relieved_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😔":{name:"pensive face",slug:"pensive_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😪":{name:"sleepy face",slug:"sleepy_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤤":{name:"drooling face",slug:"drooling_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"😴":{name:"sleeping face",slug:"sleeping_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫩":{name:"face with bags under eyes",slug:"face_with_bags_under_eyes",group:"Smileys & Emotion",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"😷":{name:"face with medical mask",slug:"face_with_medical_mask",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤒":{name:"face with thermometer",slug:"face_with_thermometer",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤕":{name:"face with head-bandage",slug:"face_with_head_bandage",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤢":{name:"nauseated face",slug:"nauseated_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🤮":{name:"face vomiting",slug:"face_vomiting",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🤧":{name:"sneezing face",slug:"sneezing_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥵":{name:"hot face",slug:"hot_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥶":{name:"cold face",slug:"cold_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥴":{name:"woozy face",slug:"woozy_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"😵":{name:"face with crossed-out eyes",slug:"face_with_crossed_out_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😵‍💫":{name:"face with spiral eyes",slug:"face_with_spiral_eyes",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"🤯":{name:"exploding head",slug:"exploding_head",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🤠":{name:"cowboy hat face",slug:"cowboy_hat_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥳":{name:"partying face",slug:"partying_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥸":{name:"disguised face",slug:"disguised_face",group:"Smileys & Emotion",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"😎":{name:"smiling face with sunglasses",slug:"smiling_face_with_sunglasses",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🤓":{name:"nerd face",slug:"nerd_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧐":{name:"face with monocle",slug:"face_with_monocle",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😕":{name:"confused face",slug:"confused_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫤":{name:"face with diagonal mouth",slug:"face_with_diagonal_mouth",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😟":{name:"worried face",slug:"worried_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🙁":{name:"slightly frowning face",slug:"slightly_frowning_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☹️":{name:"frowning face",slug:"frowning_face",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"😮":{name:"face with open mouth",slug:"face_with_open_mouth",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😯":{name:"hushed face",slug:"hushed_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😲":{name:"astonished face",slug:"astonished_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😳":{name:"flushed face",slug:"flushed_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥺":{name:"pleading face",slug:"pleading_face",group:"Smileys & Emotion",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥹":{name:"face holding back tears",slug:"face_holding_back_tears",group:"Smileys & Emotion",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"😦":{name:"frowning face with open mouth",slug:"frowning_face_with_open_mouth",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😧":{name:"anguished face",slug:"anguished_face",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😨":{name:"fearful face",slug:"fearful_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😰":{name:"anxious face with sweat",slug:"anxious_face_with_sweat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😥":{name:"sad but relieved face",slug:"sad_but_relieved_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😢":{name:"crying face",slug:"crying_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😭":{name:"loudly crying face",slug:"loudly_crying_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😱":{name:"face screaming in fear",slug:"face_screaming_in_fear",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😖":{name:"confounded face",slug:"confounded_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😣":{name:"persevering face",slug:"persevering_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😞":{name:"disappointed face",slug:"disappointed_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😓":{name:"downcast face with sweat",slug:"downcast_face_with_sweat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😩":{name:"weary face",slug:"weary_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😫":{name:"tired face",slug:"tired_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥱":{name:"yawning face",slug:"yawning_face",group:"Smileys & Emotion",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"😤":{name:"face with steam from nose",slug:"face_with_steam_from_nose",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😡":{name:"enraged face",slug:"enraged_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😠":{name:"angry face",slug:"angry_face",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤬":{name:"face with symbols on mouth",slug:"face_with_symbols_on_mouth",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"😈":{name:"smiling face with horns",slug:"smiling_face_with_horns",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"👿":{name:"angry face with horns",slug:"angry_face_with_horns",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💀":{name:"skull",slug:"skull",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☠️":{name:"skull and crossbones",slug:"skull_and_crossbones",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💩":{name:"pile of poo",slug:"pile_of_poo",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤡":{name:"clown face",slug:"clown_face",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"👹":{name:"ogre",slug:"ogre",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👺":{name:"goblin",slug:"goblin",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👻":{name:"ghost",slug:"ghost",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👽":{name:"alien",slug:"alien",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👾":{name:"alien monster",slug:"alien_monster",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤖":{name:"robot",slug:"robot",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"😺":{name:"grinning cat",slug:"grinning_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😸":{name:"grinning cat with smiling eyes",slug:"grinning_cat_with_smiling_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😹":{name:"cat with tears of joy",slug:"cat_with_tears_of_joy",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😻":{name:"smiling cat with heart-eyes",slug:"smiling_cat_with_heart_eyes",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😼":{name:"cat with wry smile",slug:"cat_with_wry_smile",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😽":{name:"kissing cat",slug:"kissing_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙀":{name:"weary cat",slug:"weary_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😿":{name:"crying cat",slug:"crying_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"😾":{name:"pouting cat",slug:"pouting_cat",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙈":{name:"see-no-evil monkey",slug:"see_no_evil_monkey",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙉":{name:"hear-no-evil monkey",slug:"hear_no_evil_monkey",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🙊":{name:"speak-no-evil monkey",slug:"speak_no_evil_monkey",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💌":{name:"love letter",slug:"love_letter",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💘":{name:"heart with arrow",slug:"heart_with_arrow",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💝":{name:"heart with ribbon",slug:"heart_with_ribbon",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💖":{name:"sparkling heart",slug:"sparkling_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💗":{name:"growing heart",slug:"growing_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💓":{name:"beating heart",slug:"beating_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💞":{name:"revolving hearts",slug:"revolving_hearts",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💕":{name:"two hearts",slug:"two_hearts",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💟":{name:"heart decoration",slug:"heart_decoration",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❣️":{name:"heart exclamation",slug:"heart_exclamation",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💔":{name:"broken heart",slug:"broken_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❤️‍🔥":{name:"heart on fire",slug:"heart_on_fire",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"❤️‍🩹":{name:"mending heart",slug:"mending_heart",group:"Smileys & Emotion",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!1},"❤️":{name:"red heart",slug:"red_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩷":{name:"pink heart",slug:"pink_heart",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🧡":{name:"orange heart",slug:"orange_heart",group:"Smileys & Emotion",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"💛":{name:"yellow heart",slug:"yellow_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💚":{name:"green heart",slug:"green_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💙":{name:"blue heart",slug:"blue_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩵":{name:"light blue heart",slug:"light_blue_heart",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"💜":{name:"purple heart",slug:"purple_heart",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤎":{name:"brown heart",slug:"brown_heart",group:"Smileys & Emotion",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🖤":{name:"black heart",slug:"black_heart",group:"Smileys & Emotion",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🩶":{name:"grey heart",slug:"grey_heart",group:"Smileys & Emotion",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🤍":{name:"white heart",slug:"white_heart",group:"Smileys & Emotion",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"💋":{name:"kiss mark",slug:"kiss_mark",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💯":{name:"hundred points",slug:"hundred_points",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💢":{name:"anger symbol",slug:"anger_symbol",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💥":{name:"collision",slug:"collision",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💫":{name:"dizzy",slug:"dizzy",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💦":{name:"sweat droplets",slug:"sweat_droplets",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💨":{name:"dashing away",slug:"dashing_away",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕳️":{name:"hole",slug:"hole",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💬":{name:"speech balloon",slug:"speech_balloon",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👁️‍🗨️":{name:"eye in speech bubble",slug:"eye_in_speech_bubble",group:"Smileys & Emotion",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🗨️":{name:"left speech bubble",slug:"left_speech_bubble",group:"Smileys & Emotion",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🗯️":{name:"right anger bubble",slug:"right_anger_bubble",group:"Smileys & Emotion",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💭":{name:"thought balloon",slug:"thought_balloon",group:"Smileys & Emotion",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💤":{name:"ZZZ",slug:"zzz",group:"Smileys & Emotion",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👋":{name:"waving hand",slug:"waving_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤚":{name:"raised back of hand",slug:"raised_back_of_hand",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🖐️":{name:"hand with fingers splayed",slug:"hand_with_fingers_splayed",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"✋":{name:"raised hand",slug:"raised_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🖖":{name:"vulcan salute",slug:"vulcan_salute",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🫱":{name:"rightwards hand",slug:"rightwards_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫲":{name:"leftwards hand",slug:"leftwards_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫳":{name:"palm down hand",slug:"palm_down_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫴":{name:"palm up hand",slug:"palm_up_hand",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫷":{name:"leftwards pushing hand",slug:"leftwards_pushing_hand",group:"People & Body",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!0,skin_tone_support_unicode_version:"15.0"},"🫸":{name:"rightwards pushing hand",slug:"rightwards_pushing_hand",group:"People & Body",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!0,skin_tone_support_unicode_version:"15.0"},"👌":{name:"OK hand",slug:"ok_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤌":{name:"pinched fingers",slug:"pinched_fingers",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🤏":{name:"pinching hand",slug:"pinching_hand",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"✌️":{name:"victory hand",slug:"victory_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤞":{name:"crossed fingers",slug:"crossed_fingers",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🫰":{name:"hand with index finger and thumb crossed",slug:"hand_with_index_finger_and_thumb_crossed",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🤟":{name:"love-you gesture",slug:"love_you_gesture",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤘":{name:"sign of the horns",slug:"sign_of_the_horns",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤙":{name:"call me hand",slug:"call_me_hand",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"👈":{name:"backhand index pointing left",slug:"backhand_index_pointing_left",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👉":{name:"backhand index pointing right",slug:"backhand_index_pointing_right",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👆":{name:"backhand index pointing up",slug:"backhand_index_pointing_up",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🖕":{name:"middle finger",slug:"middle_finger",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👇":{name:"backhand index pointing down",slug:"backhand_index_pointing_down",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"☝️":{name:"index pointing up",slug:"index_pointing_up",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🫵":{name:"index pointing at the viewer",slug:"index_pointing_at_the_viewer",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"👍":{name:"thumbs up",slug:"thumbs_up",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👎":{name:"thumbs down",slug:"thumbs_down",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"✊":{name:"raised fist",slug:"raised_fist",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👊":{name:"oncoming fist",slug:"oncoming_fist",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤛":{name:"left-facing fist",slug:"left_facing_fist",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤜":{name:"right-facing fist",slug:"right_facing_fist",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"👏":{name:"clapping hands",slug:"clapping_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙌":{name:"raising hands",slug:"raising_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🫶":{name:"heart hands",slug:"heart_hands",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"👐":{name:"open hands",slug:"open_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤲":{name:"palms up together",slug:"palms_up_together",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤝":{name:"handshake",slug:"handshake",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🙏":{name:"folded hands",slug:"folded_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"✍️":{name:"writing hand",slug:"writing_hand",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💅":{name:"nail polish",slug:"nail_polish",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤳":{name:"selfie",slug:"selfie",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"💪":{name:"flexed biceps",slug:"flexed_biceps",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🦾":{name:"mechanical arm",slug:"mechanical_arm",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦿":{name:"mechanical leg",slug:"mechanical_leg",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦵":{name:"leg",slug:"leg",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦶":{name:"foot",slug:"foot",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👂":{name:"ear",slug:"ear",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🦻":{name:"ear with hearing aid",slug:"ear_with_hearing_aid",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👃":{name:"nose",slug:"nose",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧠":{name:"brain",slug:"brain",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🫀":{name:"anatomical heart",slug:"anatomical_heart",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🫁":{name:"lungs",slug:"lungs",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦷":{name:"tooth",slug:"tooth",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦴":{name:"bone",slug:"bone",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"👀":{name:"eyes",slug:"eyes",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👁️":{name:"eye",slug:"eye",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"👅":{name:"tongue",slug:"tongue",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👄":{name:"mouth",slug:"mouth",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫦":{name:"biting lip",slug:"biting_lip",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"👶":{name:"baby",slug:"baby",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧒":{name:"child",slug:"child",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👦":{name:"boy",slug:"boy",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👧":{name:"girl",slug:"girl",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧑":{name:"person",slug:"person",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👱":{name:"person blond hair",slug:"person_blond_hair",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👨":{name:"man",slug:"man",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧔":{name:"person beard",slug:"person_beard",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧔‍♂️":{name:"man beard",slug:"man_beard",group:"People & Body",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"🧔‍♀️":{name:"woman beard",slug:"woman_beard",group:"People & Body",emoji_version:"13.1",unicode_version:"13.1",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍🦰":{name:"man red hair",slug:"man_red_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👨‍🦱":{name:"man curly hair",slug:"man_curly_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👨‍🦳":{name:"man white hair",slug:"man_white_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👨‍🦲":{name:"man bald",slug:"man_bald",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"👩":{name:"woman",slug:"woman",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👩‍🦰":{name:"woman red hair",slug:"woman_red_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦰":{name:"person red hair",slug:"person_red_hair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👩‍🦱":{name:"woman curly hair",slug:"woman_curly_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦱":{name:"person curly hair",slug:"person_curly_hair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👩‍🦳":{name:"woman white hair",slug:"woman_white_hair",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦳":{name:"person white hair",slug:"person_white_hair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👩‍🦲":{name:"woman bald",slug:"woman_bald",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧑‍🦲":{name:"person bald",slug:"person_bald",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👱‍♀️":{name:"woman blond hair",slug:"woman_blond_hair",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👱‍♂️":{name:"man blond hair",slug:"man_blond_hair",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧓":{name:"older person",slug:"older_person",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👴":{name:"old man",slug:"old_man",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👵":{name:"old woman",slug:"old_woman",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙍":{name:"person frowning",slug:"person_frowning",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙍‍♂️":{name:"man frowning",slug:"man_frowning",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙍‍♀️":{name:"woman frowning",slug:"woman_frowning",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙎":{name:"person pouting",slug:"person_pouting",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙎‍♂️":{name:"man pouting",slug:"man_pouting",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙎‍♀️":{name:"woman pouting",slug:"woman_pouting",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙅":{name:"person gesturing NO",slug:"person_gesturing_no",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙅‍♂️":{name:"man gesturing NO",slug:"man_gesturing_no",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙅‍♀️":{name:"woman gesturing NO",slug:"woman_gesturing_no",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙆":{name:"person gesturing OK",slug:"person_gesturing_ok",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙆‍♂️":{name:"man gesturing OK",slug:"man_gesturing_ok",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙆‍♀️":{name:"woman gesturing OK",slug:"woman_gesturing_ok",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💁":{name:"person tipping hand",slug:"person_tipping_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💁‍♂️":{name:"man tipping hand",slug:"man_tipping_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💁‍♀️":{name:"woman tipping hand",slug:"woman_tipping_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙋":{name:"person raising hand",slug:"person_raising_hand",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙋‍♂️":{name:"man raising hand",slug:"man_raising_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙋‍♀️":{name:"woman raising hand",slug:"woman_raising_hand",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧏":{name:"deaf person",slug:"deaf_person",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧏‍♂️":{name:"deaf man",slug:"deaf_man",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧏‍♀️":{name:"deaf woman",slug:"deaf_woman",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🙇":{name:"person bowing",slug:"person_bowing",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🙇‍♂️":{name:"man bowing",slug:"man_bowing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🙇‍♀️":{name:"woman bowing",slug:"woman_bowing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤦":{name:"person facepalming",slug:"person_facepalming",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤦‍♂️":{name:"man facepalming",slug:"man_facepalming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤦‍♀️":{name:"woman facepalming",slug:"woman_facepalming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤷":{name:"person shrugging",slug:"person_shrugging",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤷‍♂️":{name:"man shrugging",slug:"man_shrugging",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤷‍♀️":{name:"woman shrugging",slug:"woman_shrugging",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍⚕️":{name:"health worker",slug:"health_worker",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍⚕️":{name:"man health worker",slug:"man_health_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍⚕️":{name:"woman health worker",slug:"woman_health_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🎓":{name:"student",slug:"student",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🎓":{name:"man student",slug:"man_student",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🎓":{name:"woman student",slug:"woman_student",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🏫":{name:"teacher",slug:"teacher",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🏫":{name:"man teacher",slug:"man_teacher",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🏫":{name:"woman teacher",slug:"woman_teacher",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍⚖️":{name:"judge",slug:"judge",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍⚖️":{name:"man judge",slug:"man_judge",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍⚖️":{name:"woman judge",slug:"woman_judge",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🌾":{name:"farmer",slug:"farmer",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🌾":{name:"man farmer",slug:"man_farmer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🌾":{name:"woman farmer",slug:"woman_farmer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🍳":{name:"cook",slug:"cook",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🍳":{name:"man cook",slug:"man_cook",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🍳":{name:"woman cook",slug:"woman_cook",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🔧":{name:"mechanic",slug:"mechanic",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🔧":{name:"man mechanic",slug:"man_mechanic",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🔧":{name:"woman mechanic",slug:"woman_mechanic",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🏭":{name:"factory worker",slug:"factory_worker",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🏭":{name:"man factory worker",slug:"man_factory_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🏭":{name:"woman factory worker",slug:"woman_factory_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍💼":{name:"office worker",slug:"office_worker",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍💼":{name:"man office worker",slug:"man_office_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍💼":{name:"woman office worker",slug:"woman_office_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🔬":{name:"scientist",slug:"scientist",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🔬":{name:"man scientist",slug:"man_scientist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🔬":{name:"woman scientist",slug:"woman_scientist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍💻":{name:"technologist",slug:"technologist",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍💻":{name:"man technologist",slug:"man_technologist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍💻":{name:"woman technologist",slug:"woman_technologist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🎤":{name:"singer",slug:"singer",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🎤":{name:"man singer",slug:"man_singer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🎤":{name:"woman singer",slug:"woman_singer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🎨":{name:"artist",slug:"artist",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🎨":{name:"man artist",slug:"man_artist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🎨":{name:"woman artist",slug:"woman_artist",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍✈️":{name:"pilot",slug:"pilot",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍✈️":{name:"man pilot",slug:"man_pilot",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍✈️":{name:"woman pilot",slug:"woman_pilot",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🚀":{name:"astronaut",slug:"astronaut",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🚀":{name:"man astronaut",slug:"man_astronaut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🚀":{name:"woman astronaut",slug:"woman_astronaut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🚒":{name:"firefighter",slug:"firefighter",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"👨‍🚒":{name:"man firefighter",slug:"man_firefighter",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👩‍🚒":{name:"woman firefighter",slug:"woman_firefighter",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👮":{name:"police officer",slug:"police_officer",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👮‍♂️":{name:"man police officer",slug:"man_police_officer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👮‍♀️":{name:"woman police officer",slug:"woman_police_officer",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🕵️":{name:"detective",slug:"detective",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"2.0"},"🕵️‍♂️":{name:"man detective",slug:"man_detective",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🕵️‍♀️":{name:"woman detective",slug:"woman_detective",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💂":{name:"guard",slug:"guard",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💂‍♂️":{name:"man guard",slug:"man_guard",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💂‍♀️":{name:"woman guard",slug:"woman_guard",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🥷":{name:"ninja",slug:"ninja",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👷":{name:"construction worker",slug:"construction_worker",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👷‍♂️":{name:"man construction worker",slug:"man_construction_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👷‍♀️":{name:"woman construction worker",slug:"woman_construction_worker",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🫅":{name:"person with crown",slug:"person_with_crown",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🤴":{name:"prince",slug:"prince",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"👸":{name:"princess",slug:"princess",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👳":{name:"person wearing turban",slug:"person_wearing_turban",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👳‍♂️":{name:"man wearing turban",slug:"man_wearing_turban",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👳‍♀️":{name:"woman wearing turban",slug:"woman_wearing_turban",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👲":{name:"person with skullcap",slug:"person_with_skullcap",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🧕":{name:"woman with headscarf",slug:"woman_with_headscarf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤵":{name:"person in tuxedo",slug:"person_in_tuxedo",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤵‍♂️":{name:"man in tuxedo",slug:"man_in_tuxedo",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🤵‍♀️":{name:"woman in tuxedo",slug:"woman_in_tuxedo",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👰":{name:"person with veil",slug:"person_with_veil",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"👰‍♂️":{name:"man with veil",slug:"man_with_veil",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👰‍♀️":{name:"woman with veil",slug:"woman_with_veil",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🤰":{name:"pregnant woman",slug:"pregnant_woman",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🫃":{name:"pregnant man",slug:"pregnant_man",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🫄":{name:"pregnant person",slug:"pregnant_person",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!0,skin_tone_support_unicode_version:"14.0"},"🤱":{name:"breast-feeding",slug:"breast_feeding",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"👩‍🍼":{name:"woman feeding baby",slug:"woman_feeding_baby",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👨‍🍼":{name:"man feeding baby",slug:"man_feeding_baby",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🧑‍🍼":{name:"person feeding baby",slug:"person_feeding_baby",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"👼":{name:"baby angel",slug:"baby_angel",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🎅":{name:"Santa Claus",slug:"santa_claus",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🤶":{name:"Mrs. Claus",slug:"mrs_claus",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🧑‍🎄":{name:"Mx Claus",slug:"mx_claus",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.0"},"🦸":{name:"superhero",slug:"superhero",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦸‍♂️":{name:"man superhero",slug:"man_superhero",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦸‍♀️":{name:"woman superhero",slug:"woman_superhero",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦹":{name:"supervillain",slug:"supervillain",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦹‍♂️":{name:"man supervillain",slug:"man_supervillain",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🦹‍♀️":{name:"woman supervillain",slug:"woman_supervillain",group:"People & Body",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!0,skin_tone_support_unicode_version:"11.0"},"🧙":{name:"mage",slug:"mage",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧙‍♂️":{name:"man mage",slug:"man_mage",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧙‍♀️":{name:"woman mage",slug:"woman_mage",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧚":{name:"fairy",slug:"fairy",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧚‍♂️":{name:"man fairy",slug:"man_fairy",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧚‍♀️":{name:"woman fairy",slug:"woman_fairy",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧛":{name:"vampire",slug:"vampire",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧛‍♂️":{name:"man vampire",slug:"man_vampire",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧛‍♀️":{name:"woman vampire",slug:"woman_vampire",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧜":{name:"merperson",slug:"merperson",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧜‍♂️":{name:"merman",slug:"merman",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧜‍♀️":{name:"mermaid",slug:"mermaid",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧝":{name:"elf",slug:"elf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧝‍♂️":{name:"man elf",slug:"man_elf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧝‍♀️":{name:"woman elf",slug:"woman_elf",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧞":{name:"genie",slug:"genie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧞‍♂️":{name:"man genie",slug:"man_genie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧞‍♀️":{name:"woman genie",slug:"woman_genie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧟":{name:"zombie",slug:"zombie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧟‍♂️":{name:"man zombie",slug:"man_zombie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧟‍♀️":{name:"woman zombie",slug:"woman_zombie",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧌":{name:"troll",slug:"troll",group:"People & Body",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"💆":{name:"person getting massage",slug:"person_getting_massage",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💆‍♂️":{name:"man getting massage",slug:"man_getting_massage",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💆‍♀️":{name:"woman getting massage",slug:"woman_getting_massage",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💇":{name:"person getting haircut",slug:"person_getting_haircut",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"💇‍♂️":{name:"man getting haircut",slug:"man_getting_haircut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"💇‍♀️":{name:"woman getting haircut",slug:"woman_getting_haircut",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚶":{name:"person walking",slug:"person_walking",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚶‍♂️":{name:"man walking",slug:"man_walking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚶‍♀️":{name:"woman walking",slug:"woman_walking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚶‍➡️":{name:"person walking facing right",slug:"person_walking_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🚶‍♀️‍➡️":{name:"woman walking facing right",slug:"woman_walking_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🚶‍♂️‍➡️":{name:"man walking facing right",slug:"man_walking_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧍":{name:"person standing",slug:"person_standing",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧍‍♂️":{name:"man standing",slug:"man_standing",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧍‍♀️":{name:"woman standing",slug:"woman_standing",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎":{name:"person kneeling",slug:"person_kneeling",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎‍♂️":{name:"man kneeling",slug:"man_kneeling",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎‍♀️":{name:"woman kneeling",slug:"woman_kneeling",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"🧎‍➡️":{name:"person kneeling facing right",slug:"person_kneeling_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧎‍♀️‍➡️":{name:"woman kneeling facing right",slug:"woman_kneeling_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧎‍♂️‍➡️":{name:"man kneeling facing right",slug:"man_kneeling_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧑‍🦯":{name:"person with white cane",slug:"person_with_white_cane",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"🧑‍🦯‍➡️":{name:"person with white cane facing right",slug:"person_with_white_cane_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👨‍🦯":{name:"man with white cane",slug:"man_with_white_cane",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👨‍🦯‍➡️":{name:"man with white cane facing right",slug:"man_with_white_cane_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👩‍🦯":{name:"woman with white cane",slug:"woman_with_white_cane",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👩‍🦯‍➡️":{name:"woman with white cane facing right",slug:"woman_with_white_cane_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧑‍🦼":{name:"person in motorized wheelchair",slug:"person_in_motorized_wheelchair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"🧑‍🦼‍➡️":{name:"person in motorized wheelchair facing right",slug:"person_in_motorized_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👨‍🦼":{name:"man in motorized wheelchair",slug:"man_in_motorized_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👨‍🦼‍➡️":{name:"man in motorized wheelchair facing right",slug:"man_in_motorized_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👩‍🦼":{name:"woman in motorized wheelchair",slug:"woman_in_motorized_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👩‍🦼‍➡️":{name:"woman in motorized wheelchair facing right",slug:"woman_in_motorized_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🧑‍🦽":{name:"person in manual wheelchair",slug:"person_in_manual_wheelchair",group:"People & Body",emoji_version:"12.1",unicode_version:"12.1",skin_tone_support:!0,skin_tone_support_unicode_version:"12.1"},"🧑‍🦽‍➡️":{name:"person in manual wheelchair facing right",slug:"person_in_manual_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👨‍🦽":{name:"man in manual wheelchair",slug:"man_in_manual_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👨‍🦽‍➡️":{name:"man in manual wheelchair facing right",slug:"man_in_manual_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"👩‍🦽":{name:"woman in manual wheelchair",slug:"woman_in_manual_wheelchair",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👩‍🦽‍➡️":{name:"woman in manual wheelchair facing right",slug:"woman_in_manual_wheelchair_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🏃":{name:"person running",slug:"person_running",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏃‍♂️":{name:"man running",slug:"man_running",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏃‍♀️":{name:"woman running",slug:"woman_running",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏃‍➡️":{name:"person running facing right",slug:"person_running_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🏃‍♀️‍➡️":{name:"woman running facing right",slug:"woman_running_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"🏃‍♂️‍➡️":{name:"man running facing right",slug:"man_running_facing_right",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!0,skin_tone_support_unicode_version:"15.1"},"💃":{name:"woman dancing",slug:"woman_dancing",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🕺":{name:"man dancing",slug:"man_dancing",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🕴️":{name:"person in suit levitating",slug:"person_in_suit_levitating",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"👯":{name:"people with bunny ears",slug:"people_with_bunny_ears",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👯‍♂️":{name:"men with bunny ears",slug:"men_with_bunny_ears",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👯‍♀️":{name:"women with bunny ears",slug:"women_with_bunny_ears",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🧖":{name:"person in steamy room",slug:"person_in_steamy_room",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧖‍♂️":{name:"man in steamy room",slug:"man_in_steamy_room",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧖‍♀️":{name:"woman in steamy room",slug:"woman_in_steamy_room",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧗":{name:"person climbing",slug:"person_climbing",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧗‍♂️":{name:"man climbing",slug:"man_climbing",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧗‍♀️":{name:"woman climbing",slug:"woman_climbing",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🤺":{name:"person fencing",slug:"person_fencing",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🏇":{name:"horse racing",slug:"horse_racing",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"⛷️":{name:"skier",slug:"skier",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏂":{name:"snowboarder",slug:"snowboarder",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏌️":{name:"person golfing",slug:"person_golfing",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏌️‍♂️":{name:"man golfing",slug:"man_golfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏌️‍♀️":{name:"woman golfing",slug:"woman_golfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏄":{name:"person surfing",slug:"person_surfing",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏄‍♂️":{name:"man surfing",slug:"man_surfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏄‍♀️":{name:"woman surfing",slug:"woman_surfing",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚣":{name:"person rowing boat",slug:"person_rowing_boat",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚣‍♂️":{name:"man rowing boat",slug:"man_rowing_boat",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚣‍♀️":{name:"woman rowing boat",slug:"woman_rowing_boat",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏊":{name:"person swimming",slug:"person_swimming",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🏊‍♂️":{name:"man swimming",slug:"man_swimming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏊‍♀️":{name:"woman swimming",slug:"woman_swimming",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"⛹️":{name:"person bouncing ball",slug:"person_bouncing_ball",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"2.0"},"⛹️‍♂️":{name:"man bouncing ball",slug:"man_bouncing_ball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"⛹️‍♀️":{name:"woman bouncing ball",slug:"woman_bouncing_ball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏋️":{name:"person lifting weights",slug:"person_lifting_weights",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!0,skin_tone_support_unicode_version:"2.0"},"🏋️‍♂️":{name:"man lifting weights",slug:"man_lifting_weights",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🏋️‍♀️":{name:"woman lifting weights",slug:"woman_lifting_weights",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚴":{name:"person biking",slug:"person_biking",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚴‍♂️":{name:"man biking",slug:"man_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚴‍♀️":{name:"woman biking",slug:"woman_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚵":{name:"person mountain biking",slug:"person_mountain_biking",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🚵‍♂️":{name:"man mountain biking",slug:"man_mountain_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🚵‍♀️":{name:"woman mountain biking",slug:"woman_mountain_biking",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤸":{name:"person cartwheeling",slug:"person_cartwheeling",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤸‍♂️":{name:"man cartwheeling",slug:"man_cartwheeling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤸‍♀️":{name:"woman cartwheeling",slug:"woman_cartwheeling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤼":{name:"people wrestling",slug:"people_wrestling",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🤼‍♂️":{name:"men wrestling",slug:"men_wrestling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🤼‍♀️":{name:"women wrestling",slug:"women_wrestling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🤽":{name:"person playing water polo",slug:"person_playing_water_polo",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤽‍♂️":{name:"man playing water polo",slug:"man_playing_water_polo",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤽‍♀️":{name:"woman playing water polo",slug:"woman_playing_water_polo",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤾":{name:"person playing handball",slug:"person_playing_handball",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤾‍♂️":{name:"man playing handball",slug:"man_playing_handball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤾‍♀️":{name:"woman playing handball",slug:"woman_playing_handball",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤹":{name:"person juggling",slug:"person_juggling",group:"People & Body",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!0,skin_tone_support_unicode_version:"3.0"},"🤹‍♂️":{name:"man juggling",slug:"man_juggling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🤹‍♀️":{name:"woman juggling",slug:"woman_juggling",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧘":{name:"person in lotus position",slug:"person_in_lotus_position",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧘‍♂️":{name:"man in lotus position",slug:"man_in_lotus_position",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🧘‍♀️":{name:"woman in lotus position",slug:"woman_in_lotus_position",group:"People & Body",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!0,skin_tone_support_unicode_version:"5.0"},"🛀":{name:"person taking bath",slug:"person_taking_bath",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"1.0"},"🛌":{name:"person in bed",slug:"person_in_bed",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"4.0"},"🧑‍🤝‍🧑":{name:"people holding hands",slug:"people_holding_hands",group:"People & Body",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👭":{name:"women holding hands",slug:"women_holding_hands",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👫":{name:"woman and man holding hands",slug:"woman_and_man_holding_hands",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"👬":{name:"men holding hands",slug:"men_holding_hands",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!0,skin_tone_support_unicode_version:"12.0"},"💏":{name:"kiss",slug:"kiss",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍💋‍👨":{name:"kiss woman, man",slug:"kiss_woman_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍❤️‍💋‍👨":{name:"kiss man, man",slug:"kiss_man_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍💋‍👩":{name:"kiss woman, woman",slug:"kiss_woman_woman",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"💑":{name:"couple with heart",slug:"couple_with_heart",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍👨":{name:"couple with heart woman, man",slug:"couple_with_heart_woman_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍❤️‍👨":{name:"couple with heart man, man",slug:"couple_with_heart_man_man",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👩‍❤️‍👩":{name:"couple with heart woman, woman",slug:"couple_with_heart_woman_woman",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!0,skin_tone_support_unicode_version:"13.1"},"👨‍👩‍👦":{name:"family man, woman, boy",slug:"family_man_woman_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👧":{name:"family man, woman, girl",slug:"family_man_woman_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👧‍👦":{name:"family man, woman, girl, boy",slug:"family_man_woman_girl_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👦‍👦":{name:"family man, woman, boy, boy",slug:"family_man_woman_boy_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👩‍👧‍👧":{name:"family man, woman, girl, girl",slug:"family_man_woman_girl_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👦":{name:"family man, man, boy",slug:"family_man_man_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👧":{name:"family man, man, girl",slug:"family_man_man_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👧‍👦":{name:"family man, man, girl, boy",slug:"family_man_man_girl_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👦‍👦":{name:"family man, man, boy, boy",slug:"family_man_man_boy_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👨‍👧‍👧":{name:"family man, man, girl, girl",slug:"family_man_man_girl_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👦":{name:"family woman, woman, boy",slug:"family_woman_woman_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👧":{name:"family woman, woman, girl",slug:"family_woman_woman_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👧‍👦":{name:"family woman, woman, girl, boy",slug:"family_woman_woman_girl_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👦‍👦":{name:"family woman, woman, boy, boy",slug:"family_woman_woman_boy_boy",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👩‍👩‍👧‍👧":{name:"family woman, woman, girl, girl",slug:"family_woman_woman_girl_girl",group:"People & Body",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"👨‍👦":{name:"family man, boy",slug:"family_man_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👦‍👦":{name:"family man, boy, boy",slug:"family_man_boy_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👧":{name:"family man, girl",slug:"family_man_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👧‍👦":{name:"family man, girl, boy",slug:"family_man_girl_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👨‍👧‍👧":{name:"family man, girl, girl",slug:"family_man_girl_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👦":{name:"family woman, boy",slug:"family_woman_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👦‍👦":{name:"family woman, boy, boy",slug:"family_woman_boy_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👧":{name:"family woman, girl",slug:"family_woman_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👧‍👦":{name:"family woman, girl, boy",slug:"family_woman_girl_boy",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"👩‍👧‍👧":{name:"family woman, girl, girl",slug:"family_woman_girl_girl",group:"People & Body",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🗣️":{name:"speaking head",slug:"speaking_head",group:"People & Body",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"👤":{name:"bust in silhouette",slug:"bust_in_silhouette",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👥":{name:"busts in silhouette",slug:"busts_in_silhouette",group:"People & Body",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫂":{name:"people hugging",slug:"people_hugging",group:"People & Body",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"👪":{name:"family",slug:"family",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧑‍🧑‍🧒":{name:"family adult, adult, child",slug:"family_adult_adult_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🧑‍🧑‍🧒‍🧒":{name:"family adult, adult, child, child",slug:"family_adult_adult_child_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🧑‍🧒":{name:"family adult, child",slug:"family_adult_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🧑‍🧒‍🧒":{name:"family adult, child, child",slug:"family_adult_child_child",group:"People & Body",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"👣":{name:"footprints",slug:"footprints",group:"People & Body",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫆":{name:"fingerprint",slug:"fingerprint",group:"People & Body",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🐵":{name:"monkey face",slug:"monkey_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐒":{name:"monkey",slug:"monkey",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦍":{name:"gorilla",slug:"gorilla",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦧":{name:"orangutan",slug:"orangutan",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐶":{name:"dog face",slug:"dog_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐕":{name:"dog",slug:"dog",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦮":{name:"guide dog",slug:"guide_dog",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐕‍🦺":{name:"service dog",slug:"service_dog",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐩":{name:"poodle",slug:"poodle",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐺":{name:"wolf",slug:"wolf",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦊":{name:"fox",slug:"fox",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦝":{name:"raccoon",slug:"raccoon",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🐱":{name:"cat face",slug:"cat_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐈":{name:"cat",slug:"cat",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🐈‍⬛":{name:"black cat",slug:"black_cat",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦁":{name:"lion",slug:"lion",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐯":{name:"tiger face",slug:"tiger_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐅":{name:"tiger",slug:"tiger",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐆":{name:"leopard",slug:"leopard",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐴":{name:"horse face",slug:"horse_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫎":{name:"moose",slug:"moose",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🫏":{name:"donkey",slug:"donkey",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🐎":{name:"horse",slug:"horse",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦄":{name:"unicorn",slug:"unicorn",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦓":{name:"zebra",slug:"zebra",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🦌":{name:"deer",slug:"deer",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦬":{name:"bison",slug:"bison",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐮":{name:"cow face",slug:"cow_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐂":{name:"ox",slug:"ox",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐃":{name:"water buffalo",slug:"water_buffalo",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐄":{name:"cow",slug:"cow",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐷":{name:"pig face",slug:"pig_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐖":{name:"pig",slug:"pig",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐗":{name:"boar",slug:"boar",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐽":{name:"pig nose",slug:"pig_nose",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐏":{name:"ram",slug:"ram",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐑":{name:"ewe",slug:"ewe",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐐":{name:"goat",slug:"goat",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐪":{name:"camel",slug:"camel",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐫":{name:"two-hump camel",slug:"two_hump_camel",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦙":{name:"llama",slug:"llama",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦒":{name:"giraffe",slug:"giraffe",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🐘":{name:"elephant",slug:"elephant",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦣":{name:"mammoth",slug:"mammoth",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦏":{name:"rhinoceros",slug:"rhinoceros",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦛":{name:"hippopotamus",slug:"hippopotamus",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🐭":{name:"mouse face",slug:"mouse_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐁":{name:"mouse",slug:"mouse",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐀":{name:"rat",slug:"rat",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐹":{name:"hamster",slug:"hamster",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐰":{name:"rabbit face",slug:"rabbit_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐇":{name:"rabbit",slug:"rabbit",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐿️":{name:"chipmunk",slug:"chipmunk",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦫":{name:"beaver",slug:"beaver",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦔":{name:"hedgehog",slug:"hedgehog",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🦇":{name:"bat",slug:"bat",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐻":{name:"bear",slug:"bear",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐻‍❄️":{name:"polar bear",slug:"polar_bear",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐨":{name:"koala",slug:"koala",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐼":{name:"panda",slug:"panda",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦥":{name:"sloth",slug:"sloth",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦦":{name:"otter",slug:"otter",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦨":{name:"skunk",slug:"skunk",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦘":{name:"kangaroo",slug:"kangaroo",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦡":{name:"badger",slug:"badger",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🐾":{name:"paw prints",slug:"paw_prints",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦃":{name:"turkey",slug:"turkey",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐔":{name:"chicken",slug:"chicken",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐓":{name:"rooster",slug:"rooster",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐣":{name:"hatching chick",slug:"hatching_chick",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐤":{name:"baby chick",slug:"baby_chick",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐥":{name:"front-facing baby chick",slug:"front_facing_baby_chick",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐦":{name:"bird",slug:"bird",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐧":{name:"penguin",slug:"penguin",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕊️":{name:"dove",slug:"dove",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦅":{name:"eagle",slug:"eagle",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦆":{name:"duck",slug:"duck",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦢":{name:"swan",slug:"swan",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦉":{name:"owl",slug:"owl",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦤":{name:"dodo",slug:"dodo",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪶":{name:"feather",slug:"feather",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦩":{name:"flamingo",slug:"flamingo",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦚":{name:"peacock",slug:"peacock",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦜":{name:"parrot",slug:"parrot",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪽":{name:"wing",slug:"wing",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🐦‍⬛":{name:"black bird",slug:"black_bird",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🪿":{name:"goose",slug:"goose",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🐦‍🔥":{name:"phoenix",slug:"phoenix",group:"Animals & Nature",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🐸":{name:"frog",slug:"frog",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐊":{name:"crocodile",slug:"crocodile",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐢":{name:"turtle",slug:"turtle",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦎":{name:"lizard",slug:"lizard",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐍":{name:"snake",slug:"snake",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐲":{name:"dragon face",slug:"dragon_face",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐉":{name:"dragon",slug:"dragon",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦕":{name:"sauropod",slug:"sauropod",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🦖":{name:"T-Rex",slug:"t_rex",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🐳":{name:"spouting whale",slug:"spouting_whale",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐋":{name:"whale",slug:"whale",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🐬":{name:"dolphin",slug:"dolphin",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦭":{name:"seal",slug:"seal",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐟":{name:"fish",slug:"fish",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐠":{name:"tropical fish",slug:"tropical_fish",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐡":{name:"blowfish",slug:"blowfish",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦈":{name:"shark",slug:"shark",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐙":{name:"octopus",slug:"octopus",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐚":{name:"spiral shell",slug:"spiral_shell",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪸":{name:"coral",slug:"coral",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪼":{name:"jellyfish",slug:"jellyfish",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🦀":{name:"crab",slug:"crab",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦞":{name:"lobster",slug:"lobster",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦐":{name:"shrimp",slug:"shrimp",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦑":{name:"squid",slug:"squid",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦪":{name:"oyster",slug:"oyster",group:"Animals & Nature",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🐌":{name:"snail",slug:"snail",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦋":{name:"butterfly",slug:"butterfly",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🐛":{name:"bug",slug:"bug",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐜":{name:"ant",slug:"ant",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🐝":{name:"honeybee",slug:"honeybee",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪲":{name:"beetle",slug:"beetle",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🐞":{name:"lady beetle",slug:"lady_beetle",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🦗":{name:"cricket",slug:"cricket",group:"Animals & Nature",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🪳":{name:"cockroach",slug:"cockroach",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🕷️":{name:"spider",slug:"spider",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕸️":{name:"spider web",slug:"spider_web",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🦂":{name:"scorpion",slug:"scorpion",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦟":{name:"mosquito",slug:"mosquito",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪰":{name:"fly",slug:"fly",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪱":{name:"worm",slug:"worm",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🦠":{name:"microbe",slug:"microbe",group:"Animals & Nature",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"💐":{name:"bouquet",slug:"bouquet",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌸":{name:"cherry blossom",slug:"cherry_blossom",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💮":{name:"white flower",slug:"white_flower",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪷":{name:"lotus",slug:"lotus",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🏵️":{name:"rosette",slug:"rosette",group:"Animals & Nature",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌹":{name:"rose",slug:"rose",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥀":{name:"wilted flower",slug:"wilted_flower",group:"Animals & Nature",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🌺":{name:"hibiscus",slug:"hibiscus",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌻":{name:"sunflower",slug:"sunflower",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌼":{name:"blossom",slug:"blossom",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌷":{name:"tulip",slug:"tulip",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪻":{name:"hyacinth",slug:"hyacinth",group:"Animals & Nature",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🌱":{name:"seedling",slug:"seedling",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪴":{name:"potted plant",slug:"potted_plant",group:"Animals & Nature",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🌲":{name:"evergreen tree",slug:"evergreen_tree",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌳":{name:"deciduous tree",slug:"deciduous_tree",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌴":{name:"palm tree",slug:"palm_tree",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌵":{name:"cactus",slug:"cactus",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌾":{name:"sheaf of rice",slug:"sheaf_of_rice",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌿":{name:"herb",slug:"herb",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☘️":{name:"shamrock",slug:"shamrock",group:"Animals & Nature",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍀":{name:"four leaf clover",slug:"four_leaf_clover",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍁":{name:"maple leaf",slug:"maple_leaf",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍂":{name:"fallen leaf",slug:"fallen_leaf",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍃":{name:"leaf fluttering in wind",slug:"leaf_fluttering_in_wind",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪹":{name:"empty nest",slug:"empty_nest",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪺":{name:"nest with eggs",slug:"nest_with_eggs",group:"Animals & Nature",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🍄":{name:"mushroom",slug:"mushroom",group:"Animals & Nature",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪾":{name:"leafless tree",slug:"leafless_tree",group:"Animals & Nature",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🍇":{name:"grapes",slug:"grapes",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍈":{name:"melon",slug:"melon",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍉":{name:"watermelon",slug:"watermelon",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍊":{name:"tangerine",slug:"tangerine",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍋":{name:"lemon",slug:"lemon",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍋‍🟩":{name:"lime",slug:"lime",group:"Food & Drink",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🍌":{name:"banana",slug:"banana",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍍":{name:"pineapple",slug:"pineapple",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥭":{name:"mango",slug:"mango",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🍎":{name:"red apple",slug:"red_apple",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍏":{name:"green apple",slug:"green_apple",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍐":{name:"pear",slug:"pear",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍑":{name:"peach",slug:"peach",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍒":{name:"cherries",slug:"cherries",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍓":{name:"strawberry",slug:"strawberry",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫐":{name:"blueberries",slug:"blueberries",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥝":{name:"kiwi fruit",slug:"kiwi_fruit",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍅":{name:"tomato",slug:"tomato",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫒":{name:"olive",slug:"olive",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥥":{name:"coconut",slug:"coconut",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥑":{name:"avocado",slug:"avocado",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍆":{name:"eggplant",slug:"eggplant",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥔":{name:"potato",slug:"potato",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥕":{name:"carrot",slug:"carrot",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🌽":{name:"ear of corn",slug:"ear_of_corn",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌶️":{name:"hot pepper",slug:"hot_pepper",group:"Food & Drink",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🫑":{name:"bell pepper",slug:"bell_pepper",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥒":{name:"cucumber",slug:"cucumber",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥬":{name:"leafy green",slug:"leafy_green",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥦":{name:"broccoli",slug:"broccoli",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧄":{name:"garlic",slug:"garlic",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧅":{name:"onion",slug:"onion",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥜":{name:"peanuts",slug:"peanuts",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫘":{name:"beans",slug:"beans",group:"Food & Drink",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🌰":{name:"chestnut",slug:"chestnut",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫚":{name:"ginger root",slug:"ginger_root",group:"Food & Drink",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🫛":{name:"pea pod",slug:"pea_pod",group:"Food & Drink",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🍄‍🟫":{name:"brown mushroom",slug:"brown_mushroom",group:"Food & Drink",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"🫜":{name:"root vegetable",slug:"root_vegetable",group:"Food & Drink",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🍞":{name:"bread",slug:"bread",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥐":{name:"croissant",slug:"croissant",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥖":{name:"baguette bread",slug:"baguette_bread",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫓":{name:"flatbread",slug:"flatbread",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥨":{name:"pretzel",slug:"pretzel",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥯":{name:"bagel",slug:"bagel",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥞":{name:"pancakes",slug:"pancakes",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🧇":{name:"waffle",slug:"waffle",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧀":{name:"cheese wedge",slug:"cheese_wedge",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍖":{name:"meat on bone",slug:"meat_on_bone",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍗":{name:"poultry leg",slug:"poultry_leg",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥩":{name:"cut of meat",slug:"cut_of_meat",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥓":{name:"bacon",slug:"bacon",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍔":{name:"hamburger",slug:"hamburger",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍟":{name:"french fries",slug:"french_fries",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍕":{name:"pizza",slug:"pizza",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌭":{name:"hot dog",slug:"hot_dog",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥪":{name:"sandwich",slug:"sandwich",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🌮":{name:"taco",slug:"taco",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌯":{name:"burrito",slug:"burrito",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🫔":{name:"tamale",slug:"tamale",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥙":{name:"stuffed flatbread",slug:"stuffed_flatbread",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🧆":{name:"falafel",slug:"falafel",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥚":{name:"egg",slug:"egg",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍳":{name:"cooking",slug:"cooking",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥘":{name:"shallow pan of food",slug:"shallow_pan_of_food",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍲":{name:"pot of food",slug:"pot_of_food",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫕":{name:"fondue",slug:"fondue",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🥣":{name:"bowl with spoon",slug:"bowl_with_spoon",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥗":{name:"green salad",slug:"green_salad",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🍿":{name:"popcorn",slug:"popcorn",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧈":{name:"butter",slug:"butter",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧂":{name:"salt",slug:"salt",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥫":{name:"canned food",slug:"canned_food",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍱":{name:"bento box",slug:"bento_box",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍘":{name:"rice cracker",slug:"rice_cracker",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍙":{name:"rice ball",slug:"rice_ball",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍚":{name:"cooked rice",slug:"cooked_rice",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍛":{name:"curry rice",slug:"curry_rice",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍜":{name:"steaming bowl",slug:"steaming_bowl",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍝":{name:"spaghetti",slug:"spaghetti",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍠":{name:"roasted sweet potato",slug:"roasted_sweet_potato",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍢":{name:"oden",slug:"oden",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍣":{name:"sushi",slug:"sushi",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍤":{name:"fried shrimp",slug:"fried_shrimp",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍥":{name:"fish cake with swirl",slug:"fish_cake_with_swirl",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥮":{name:"moon cake",slug:"moon_cake",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🍡":{name:"dango",slug:"dango",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥟":{name:"dumpling",slug:"dumpling",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥠":{name:"fortune cookie",slug:"fortune_cookie",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥡":{name:"takeout box",slug:"takeout_box",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍦":{name:"soft ice cream",slug:"soft_ice_cream",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍧":{name:"shaved ice",slug:"shaved_ice",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍨":{name:"ice cream",slug:"ice_cream",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍩":{name:"doughnut",slug:"doughnut",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍪":{name:"cookie",slug:"cookie",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎂":{name:"birthday cake",slug:"birthday_cake",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍰":{name:"shortcake",slug:"shortcake",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧁":{name:"cupcake",slug:"cupcake",group:"Food & Drink",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥧":{name:"pie",slug:"pie",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍫":{name:"chocolate bar",slug:"chocolate_bar",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍬":{name:"candy",slug:"candy",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍭":{name:"lollipop",slug:"lollipop",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍮":{name:"custard",slug:"custard",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍯":{name:"honey pot",slug:"honey_pot",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍼":{name:"baby bottle",slug:"baby_bottle",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥛":{name:"glass of milk",slug:"glass_of_milk",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"☕":{name:"hot beverage",slug:"hot_beverage",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫖":{name:"teapot",slug:"teapot",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🍵":{name:"teacup without handle",slug:"teacup_without_handle",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍶":{name:"sake",slug:"sake",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍾":{name:"bottle with popping cork",slug:"bottle_with_popping_cork",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🍷":{name:"wine glass",slug:"wine_glass",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍸":{name:"cocktail glass",slug:"cocktail_glass",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍹":{name:"tropical drink",slug:"tropical_drink",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍺":{name:"beer mug",slug:"beer_mug",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🍻":{name:"clinking beer mugs",slug:"clinking_beer_mugs",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥂":{name:"clinking glasses",slug:"clinking_glasses",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥃":{name:"tumbler glass",slug:"tumbler_glass",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🫗":{name:"pouring liquid",slug:"pouring_liquid",group:"Food & Drink",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🥤":{name:"cup with straw",slug:"cup_with_straw",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧋":{name:"bubble tea",slug:"bubble_tea",group:"Food & Drink",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧃":{name:"beverage box",slug:"beverage_box",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧉":{name:"mate",slug:"mate",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧊":{name:"ice",slug:"ice",group:"Food & Drink",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥢":{name:"chopsticks",slug:"chopsticks",group:"Food & Drink",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🍽️":{name:"fork and knife with plate",slug:"fork_and_knife_with_plate",group:"Food & Drink",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🍴":{name:"fork and knife",slug:"fork_and_knife",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥄":{name:"spoon",slug:"spoon",group:"Food & Drink",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🔪":{name:"kitchen knife",slug:"kitchen_knife",group:"Food & Drink",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫙":{name:"jar",slug:"jar",group:"Food & Drink",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🏺":{name:"amphora",slug:"amphora",group:"Food & Drink",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌍":{name:"globe showing Europe-Africa",slug:"globe_showing_europe_africa",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌎":{name:"globe showing Americas",slug:"globe_showing_americas",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌏":{name:"globe showing Asia-Australia",slug:"globe_showing_asia_australia",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌐":{name:"globe with meridians",slug:"globe_with_meridians",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🗺️":{name:"world map",slug:"world_map",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗾":{name:"map of Japan",slug:"map_of_japan",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧭":{name:"compass",slug:"compass",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🏔️":{name:"snow-capped mountain",slug:"snow_capped_mountain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛰️":{name:"mountain",slug:"mountain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌋":{name:"volcano",slug:"volcano",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗻":{name:"mount fuji",slug:"mount_fuji",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏕️":{name:"camping",slug:"camping",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏖️":{name:"beach with umbrella",slug:"beach_with_umbrella",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏜️":{name:"desert",slug:"desert",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏝️":{name:"desert island",slug:"desert_island",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏞️":{name:"national park",slug:"national_park",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏟️":{name:"stadium",slug:"stadium",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏛️":{name:"classical building",slug:"classical_building",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏗️":{name:"building construction",slug:"building_construction",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🧱":{name:"brick",slug:"brick",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪨":{name:"rock",slug:"rock",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪵":{name:"wood",slug:"wood",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🛖":{name:"hut",slug:"hut",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🏘️":{name:"houses",slug:"houses",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏚️":{name:"derelict house",slug:"derelict_house",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏠":{name:"house",slug:"house",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏡":{name:"house with garden",slug:"house_with_garden",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏢":{name:"office building",slug:"office_building",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏣":{name:"Japanese post office",slug:"japanese_post_office",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏤":{name:"post office",slug:"post_office",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏥":{name:"hospital",slug:"hospital",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏦":{name:"bank",slug:"bank",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏨":{name:"hotel",slug:"hotel",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏩":{name:"love hotel",slug:"love_hotel",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏪":{name:"convenience store",slug:"convenience_store",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏫":{name:"school",slug:"school",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏬":{name:"department store",slug:"department_store",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏭":{name:"factory",slug:"factory",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏯":{name:"Japanese castle",slug:"japanese_castle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏰":{name:"castle",slug:"castle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💒":{name:"wedding",slug:"wedding",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗼":{name:"Tokyo tower",slug:"tokyo_tower",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗽":{name:"Statue of Liberty",slug:"statue_of_liberty",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛪":{name:"church",slug:"church",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕌":{name:"mosque",slug:"mosque",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛕":{name:"hindu temple",slug:"hindu_temple",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🕍":{name:"synagogue",slug:"synagogue",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⛩️":{name:"shinto shrine",slug:"shinto_shrine",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕋":{name:"kaaba",slug:"kaaba",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⛲":{name:"fountain",slug:"fountain",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛺":{name:"tent",slug:"tent",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌁":{name:"foggy",slug:"foggy",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌃":{name:"night with stars",slug:"night_with_stars",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏙️":{name:"cityscape",slug:"cityscape",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌄":{name:"sunrise over mountains",slug:"sunrise_over_mountains",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌅":{name:"sunrise",slug:"sunrise",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌆":{name:"cityscape at dusk",slug:"cityscape_at_dusk",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌇":{name:"sunset",slug:"sunset",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌉":{name:"bridge at night",slug:"bridge_at_night",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♨️":{name:"hot springs",slug:"hot_springs",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎠":{name:"carousel horse",slug:"carousel_horse",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛝":{name:"playground slide",slug:"playground_slide",group:"Travel & Places",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🎡":{name:"ferris wheel",slug:"ferris_wheel",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎢":{name:"roller coaster",slug:"roller_coaster",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💈":{name:"barber pole",slug:"barber_pole",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎪":{name:"circus tent",slug:"circus_tent",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚂":{name:"locomotive",slug:"locomotive",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚃":{name:"railway car",slug:"railway_car",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚄":{name:"high-speed train",slug:"high_speed_train",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚅":{name:"bullet train",slug:"bullet_train",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚆":{name:"train",slug:"train",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚇":{name:"metro",slug:"metro",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚈":{name:"light rail",slug:"light_rail",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚉":{name:"station",slug:"station",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚊":{name:"tram",slug:"tram",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚝":{name:"monorail",slug:"monorail",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚞":{name:"mountain railway",slug:"mountain_railway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚋":{name:"tram car",slug:"tram_car",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚌":{name:"bus",slug:"bus",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚍":{name:"oncoming bus",slug:"oncoming_bus",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚎":{name:"trolleybus",slug:"trolleybus",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚐":{name:"minibus",slug:"minibus",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚑":{name:"ambulance",slug:"ambulance",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚒":{name:"fire engine",slug:"fire_engine",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚓":{name:"police car",slug:"police_car",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚔":{name:"oncoming police car",slug:"oncoming_police_car",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚕":{name:"taxi",slug:"taxi",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚖":{name:"oncoming taxi",slug:"oncoming_taxi",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚗":{name:"automobile",slug:"automobile",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚘":{name:"oncoming automobile",slug:"oncoming_automobile",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚙":{name:"sport utility vehicle",slug:"sport_utility_vehicle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛻":{name:"pickup truck",slug:"pickup_truck",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🚚":{name:"delivery truck",slug:"delivery_truck",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚛":{name:"articulated lorry",slug:"articulated_lorry",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚜":{name:"tractor",slug:"tractor",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏎️":{name:"racing car",slug:"racing_car",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏍️":{name:"motorcycle",slug:"motorcycle",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛵":{name:"motor scooter",slug:"motor_scooter",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🦽":{name:"manual wheelchair",slug:"manual_wheelchair",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🦼":{name:"motorized wheelchair",slug:"motorized_wheelchair",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🛺":{name:"auto rickshaw",slug:"auto_rickshaw",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🚲":{name:"bicycle",slug:"bicycle",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛴":{name:"kick scooter",slug:"kick_scooter",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🛹":{name:"skateboard",slug:"skateboard",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🛼":{name:"roller skate",slug:"roller_skate",group:"Travel & Places",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🚏":{name:"bus stop",slug:"bus_stop",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛣️":{name:"motorway",slug:"motorway",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛤️":{name:"railway track",slug:"railway_track",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛢️":{name:"oil drum",slug:"oil_drum",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛽":{name:"fuel pump",slug:"fuel_pump",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛞":{name:"wheel",slug:"wheel",group:"Travel & Places",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🚨":{name:"police car light",slug:"police_car_light",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚥":{name:"horizontal traffic light",slug:"horizontal_traffic_light",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚦":{name:"vertical traffic light",slug:"vertical_traffic_light",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛑":{name:"stop sign",slug:"stop_sign",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🚧":{name:"construction",slug:"construction",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚓":{name:"anchor",slug:"anchor",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛟":{name:"ring buoy",slug:"ring_buoy",group:"Travel & Places",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"⛵":{name:"sailboat",slug:"sailboat",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛶":{name:"canoe",slug:"canoe",group:"Travel & Places",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🚤":{name:"speedboat",slug:"speedboat",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛳️":{name:"passenger ship",slug:"passenger_ship",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛴️":{name:"ferry",slug:"ferry",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛥️":{name:"motor boat",slug:"motor_boat",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚢":{name:"ship",slug:"ship",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✈️":{name:"airplane",slug:"airplane",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛩️":{name:"small airplane",slug:"small_airplane",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛫":{name:"airplane departure",slug:"airplane_departure",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛬":{name:"airplane arrival",slug:"airplane_arrival",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪂":{name:"parachute",slug:"parachute",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"💺":{name:"seat",slug:"seat",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚁":{name:"helicopter",slug:"helicopter",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚟":{name:"suspension railway",slug:"suspension_railway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚠":{name:"mountain cableway",slug:"mountain_cableway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚡":{name:"aerial tramway",slug:"aerial_tramway",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛰️":{name:"satellite",slug:"satellite",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🚀":{name:"rocket",slug:"rocket",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛸":{name:"flying saucer",slug:"flying_saucer",group:"Travel & Places",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🛎️":{name:"bellhop bell",slug:"bellhop_bell",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🧳":{name:"luggage",slug:"luggage",group:"Travel & Places",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"⌛":{name:"hourglass done",slug:"hourglass_done",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏳":{name:"hourglass not done",slug:"hourglass_not_done",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⌚":{name:"watch",slug:"watch",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏰":{name:"alarm clock",slug:"alarm_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏱️":{name:"stopwatch",slug:"stopwatch",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⏲️":{name:"timer clock",slug:"timer_clock",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🕰️":{name:"mantelpiece clock",slug:"mantelpiece_clock",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕛":{name:"twelve o’clock",slug:"twelve_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕧":{name:"twelve-thirty",slug:"twelve_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕐":{name:"one o’clock",slug:"one_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕜":{name:"one-thirty",slug:"one_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕑":{name:"two o’clock",slug:"two_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕝":{name:"two-thirty",slug:"two_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕒":{name:"three o’clock",slug:"three_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕞":{name:"three-thirty",slug:"three_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕓":{name:"four o’clock",slug:"four_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕟":{name:"four-thirty",slug:"four_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕔":{name:"five o’clock",slug:"five_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕠":{name:"five-thirty",slug:"five_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕕":{name:"six o’clock",slug:"six_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕡":{name:"six-thirty",slug:"six_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕖":{name:"seven o’clock",slug:"seven_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕢":{name:"seven-thirty",slug:"seven_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕗":{name:"eight o’clock",slug:"eight_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕣":{name:"eight-thirty",slug:"eight_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕘":{name:"nine o’clock",slug:"nine_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕤":{name:"nine-thirty",slug:"nine_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕙":{name:"ten o’clock",slug:"ten_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕥":{name:"ten-thirty",slug:"ten_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🕚":{name:"eleven o’clock",slug:"eleven_o_clock",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕦":{name:"eleven-thirty",slug:"eleven_thirty",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌑":{name:"new moon",slug:"new_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌒":{name:"waxing crescent moon",slug:"waxing_crescent_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌓":{name:"first quarter moon",slug:"first_quarter_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌔":{name:"waxing gibbous moon",slug:"waxing_gibbous_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌕":{name:"full moon",slug:"full_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌖":{name:"waning gibbous moon",slug:"waning_gibbous_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌗":{name:"last quarter moon",slug:"last_quarter_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌘":{name:"waning crescent moon",slug:"waning_crescent_moon",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌙":{name:"crescent moon",slug:"crescent_moon",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌚":{name:"new moon face",slug:"new_moon_face",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌛":{name:"first quarter moon face",slug:"first_quarter_moon_face",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌜":{name:"last quarter moon face",slug:"last_quarter_moon_face",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌡️":{name:"thermometer",slug:"thermometer",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☀️":{name:"sun",slug:"sun",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌝":{name:"full moon face",slug:"full_moon_face",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🌞":{name:"sun with face",slug:"sun_with_face",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪐":{name:"ringed planet",slug:"ringed_planet",group:"Travel & Places",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⭐":{name:"star",slug:"star",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌟":{name:"glowing star",slug:"glowing_star",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌠":{name:"shooting star",slug:"shooting_star",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌌":{name:"milky way",slug:"milky_way",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☁️":{name:"cloud",slug:"cloud",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛅":{name:"sun behind cloud",slug:"sun_behind_cloud",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛈️":{name:"cloud with lightning and rain",slug:"cloud_with_lightning_and_rain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌤️":{name:"sun behind small cloud",slug:"sun_behind_small_cloud",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌥️":{name:"sun behind large cloud",slug:"sun_behind_large_cloud",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌦️":{name:"sun behind rain cloud",slug:"sun_behind_rain_cloud",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌧️":{name:"cloud with rain",slug:"cloud_with_rain",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌨️":{name:"cloud with snow",slug:"cloud_with_snow",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌩️":{name:"cloud with lightning",slug:"cloud_with_lightning",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌪️":{name:"tornado",slug:"tornado",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌫️":{name:"fog",slug:"fog",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌬️":{name:"wind face",slug:"wind_face",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🌀":{name:"cyclone",slug:"cyclone",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌈":{name:"rainbow",slug:"rainbow",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌂":{name:"closed umbrella",slug:"closed_umbrella",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☂️":{name:"umbrella",slug:"umbrella",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☔":{name:"umbrella with rain drops",slug:"umbrella_with_rain_drops",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛱️":{name:"umbrella on ground",slug:"umbrella_on_ground",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚡":{name:"high voltage",slug:"high_voltage",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❄️":{name:"snowflake",slug:"snowflake",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☃️":{name:"snowman",slug:"snowman",group:"Travel & Places",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⛄":{name:"snowman without snow",slug:"snowman_without_snow",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☄️":{name:"comet",slug:"comet",group:"Travel & Places",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔥":{name:"fire",slug:"fire",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💧":{name:"droplet",slug:"droplet",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🌊":{name:"water wave",slug:"water_wave",group:"Travel & Places",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎃":{name:"jack-o-lantern",slug:"jack_o_lantern",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎄":{name:"Christmas tree",slug:"christmas_tree",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎆":{name:"fireworks",slug:"fireworks",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎇":{name:"sparkler",slug:"sparkler",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧨":{name:"firecracker",slug:"firecracker",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"✨":{name:"sparkles",slug:"sparkles",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎈":{name:"balloon",slug:"balloon",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎉":{name:"party popper",slug:"party_popper",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎊":{name:"confetti ball",slug:"confetti_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎋":{name:"tanabata tree",slug:"tanabata_tree",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎍":{name:"pine decoration",slug:"pine_decoration",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎎":{name:"Japanese dolls",slug:"japanese_dolls",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎏":{name:"carp streamer",slug:"carp_streamer",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎐":{name:"wind chime",slug:"wind_chime",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎑":{name:"moon viewing ceremony",slug:"moon_viewing_ceremony",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧧":{name:"red envelope",slug:"red_envelope",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🎀":{name:"ribbon",slug:"ribbon",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎁":{name:"wrapped gift",slug:"wrapped_gift",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎗️":{name:"reminder ribbon",slug:"reminder_ribbon",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎟️":{name:"admission tickets",slug:"admission_tickets",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎫":{name:"ticket",slug:"ticket",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎖️":{name:"military medal",slug:"military_medal",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏆":{name:"trophy",slug:"trophy",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏅":{name:"sports medal",slug:"sports_medal",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥇":{name:"1st place medal",slug:"1st_place_medal",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥈":{name:"2nd place medal",slug:"2nd_place_medal",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥉":{name:"3rd place medal",slug:"3rd_place_medal",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"⚽":{name:"soccer ball",slug:"soccer_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚾":{name:"baseball",slug:"baseball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥎":{name:"softball",slug:"softball",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🏀":{name:"basketball",slug:"basketball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏐":{name:"volleyball",slug:"volleyball",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏈":{name:"american football",slug:"american_football",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏉":{name:"rugby football",slug:"rugby_football",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🎾":{name:"tennis",slug:"tennis",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥏":{name:"flying disc",slug:"flying_disc",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🎳":{name:"bowling",slug:"bowling",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏏":{name:"cricket game",slug:"cricket_game",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏑":{name:"field hockey",slug:"field_hockey",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏒":{name:"ice hockey",slug:"ice_hockey",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥍":{name:"lacrosse",slug:"lacrosse",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🏓":{name:"ping pong",slug:"ping_pong",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏸":{name:"badminton",slug:"badminton",group:"Activities",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🥊":{name:"boxing glove",slug:"boxing_glove",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥋":{name:"martial arts uniform",slug:"martial_arts_uniform",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🥅":{name:"goal net",slug:"goal_net",group:"Activities",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"⛳":{name:"flag in hole",slug:"flag_in_hole",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛸️":{name:"ice skate",slug:"ice_skate",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎣":{name:"fishing pole",slug:"fishing_pole",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🤿":{name:"diving mask",slug:"diving_mask",group:"Activities",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🎽":{name:"running shirt",slug:"running_shirt",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎿":{name:"skis",slug:"skis",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛷":{name:"sled",slug:"sled",group:"Activities",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🥌":{name:"curling stone",slug:"curling_stone",group:"Activities",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🎯":{name:"bullseye",slug:"bullseye",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪀":{name:"yo-yo",slug:"yo_yo",group:"Activities",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🪁":{name:"kite",slug:"kite",group:"Activities",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🔫":{name:"water pistol",slug:"water_pistol",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎱":{name:"pool 8 ball",slug:"pool_8_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔮":{name:"crystal ball",slug:"crystal_ball",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪄":{name:"magic wand",slug:"magic_wand",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🎮":{name:"video game",slug:"video_game",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕹️":{name:"joystick",slug:"joystick",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎰":{name:"slot machine",slug:"slot_machine",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎲":{name:"game die",slug:"game_die",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧩":{name:"puzzle piece",slug:"puzzle_piece",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧸":{name:"teddy bear",slug:"teddy_bear",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪅":{name:"piñata",slug:"pinata",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪩":{name:"mirror ball",slug:"mirror_ball",group:"Activities",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪆":{name:"nesting dolls",slug:"nesting_dolls",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"♠️":{name:"spade suit",slug:"spade_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♥️":{name:"heart suit",slug:"heart_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♦️":{name:"diamond suit",slug:"diamond_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♣️":{name:"club suit",slug:"club_suit",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♟️":{name:"chess pawn",slug:"chess_pawn",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🃏":{name:"joker",slug:"joker",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🀄":{name:"mahjong red dragon",slug:"mahjong_red_dragon",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎴":{name:"flower playing cards",slug:"flower_playing_cards",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎭":{name:"performing arts",slug:"performing_arts",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖼️":{name:"framed picture",slug:"framed_picture",group:"Activities",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎨":{name:"artist palette",slug:"artist_palette",group:"Activities",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧵":{name:"thread",slug:"thread",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪡":{name:"sewing needle",slug:"sewing_needle",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧶":{name:"yarn",slug:"yarn",group:"Activities",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪢":{name:"knot",slug:"knot",group:"Activities",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"👓":{name:"glasses",slug:"glasses",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕶️":{name:"sunglasses",slug:"sunglasses",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🥽":{name:"goggles",slug:"goggles",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥼":{name:"lab coat",slug:"lab_coat",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🦺":{name:"safety vest",slug:"safety_vest",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"👔":{name:"necktie",slug:"necktie",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👕":{name:"t-shirt",slug:"t_shirt",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👖":{name:"jeans",slug:"jeans",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧣":{name:"scarf",slug:"scarf",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧤":{name:"gloves",slug:"gloves",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧥":{name:"coat",slug:"coat",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🧦":{name:"socks",slug:"socks",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"👗":{name:"dress",slug:"dress",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👘":{name:"kimono",slug:"kimono",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥻":{name:"sari",slug:"sari",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩱":{name:"one-piece swimsuit",slug:"one_piece_swimsuit",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩲":{name:"briefs",slug:"briefs",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩳":{name:"shorts",slug:"shorts",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"👙":{name:"bikini",slug:"bikini",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👚":{name:"woman’s clothes",slug:"woman_s_clothes",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪭":{name:"folding hand fan",slug:"folding_hand_fan",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"👛":{name:"purse",slug:"purse",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👜":{name:"handbag",slug:"handbag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👝":{name:"clutch bag",slug:"clutch_bag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛍️":{name:"shopping bags",slug:"shopping_bags",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎒":{name:"backpack",slug:"backpack",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩴":{name:"thong sandal",slug:"thong_sandal",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"👞":{name:"man’s shoe",slug:"man_s_shoe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👟":{name:"running shoe",slug:"running_shoe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🥾":{name:"hiking boot",slug:"hiking_boot",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🥿":{name:"flat shoe",slug:"flat_shoe",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"👠":{name:"high-heeled shoe",slug:"high_heeled_shoe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👡":{name:"woman’s sandal",slug:"woman_s_sandal",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩰":{name:"ballet shoes",slug:"ballet_shoes",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"👢":{name:"woman’s boot",slug:"woman_s_boot",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪮":{name:"hair pick",slug:"hair_pick",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"👑":{name:"crown",slug:"crown",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"👒":{name:"woman’s hat",slug:"woman_s_hat",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎩":{name:"top hat",slug:"top_hat",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎓":{name:"graduation cap",slug:"graduation_cap",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧢":{name:"billed cap",slug:"billed_cap",group:"Objects",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🪖":{name:"military helmet",slug:"military_helmet",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"⛑️":{name:"rescue worker’s helmet",slug:"rescue_worker_s_helmet",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📿":{name:"prayer beads",slug:"prayer_beads",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💄":{name:"lipstick",slug:"lipstick",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💍":{name:"ring",slug:"ring",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💎":{name:"gem stone",slug:"gem_stone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔇":{name:"muted speaker",slug:"muted_speaker",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔈":{name:"speaker low volume",slug:"speaker_low_volume",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔉":{name:"speaker medium volume",slug:"speaker_medium_volume",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔊":{name:"speaker high volume",slug:"speaker_high_volume",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📢":{name:"loudspeaker",slug:"loudspeaker",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📣":{name:"megaphone",slug:"megaphone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📯":{name:"postal horn",slug:"postal_horn",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔔":{name:"bell",slug:"bell",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔕":{name:"bell with slash",slug:"bell_with_slash",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🎼":{name:"musical score",slug:"musical_score",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎵":{name:"musical note",slug:"musical_note",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎶":{name:"musical notes",slug:"musical_notes",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎙️":{name:"studio microphone",slug:"studio_microphone",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎚️":{name:"level slider",slug:"level_slider",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎛️":{name:"control knobs",slug:"control_knobs",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎤":{name:"microphone",slug:"microphone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎧":{name:"headphone",slug:"headphone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📻":{name:"radio",slug:"radio",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎷":{name:"saxophone",slug:"saxophone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪗":{name:"accordion",slug:"accordion",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🎸":{name:"guitar",slug:"guitar",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎹":{name:"musical keyboard",slug:"musical_keyboard",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎺":{name:"trumpet",slug:"trumpet",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎻":{name:"violin",slug:"violin",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪕":{name:"banjo",slug:"banjo",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🥁":{name:"drum",slug:"drum",group:"Objects",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🪘":{name:"long drum",slug:"long_drum",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪇":{name:"maracas",slug:"maracas",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🪈":{name:"flute",slug:"flute",group:"Objects",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"🪉":{name:"harp",slug:"harp",group:"Objects",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"📱":{name:"mobile phone",slug:"mobile_phone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📲":{name:"mobile phone with arrow",slug:"mobile_phone_with_arrow",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☎️":{name:"telephone",slug:"telephone",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📞":{name:"telephone receiver",slug:"telephone_receiver",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📟":{name:"pager",slug:"pager",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📠":{name:"fax machine",slug:"fax_machine",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔋":{name:"battery",slug:"battery",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪫":{name:"low battery",slug:"low_battery",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🔌":{name:"electric plug",slug:"electric_plug",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💻":{name:"laptop",slug:"laptop",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖥️":{name:"desktop computer",slug:"desktop_computer",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖨️":{name:"printer",slug:"printer",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⌨️":{name:"keyboard",slug:"keyboard",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🖱️":{name:"computer mouse",slug:"computer_mouse",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖲️":{name:"trackball",slug:"trackball",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💽":{name:"computer disk",slug:"computer_disk",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💾":{name:"floppy disk",slug:"floppy_disk",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💿":{name:"optical disk",slug:"optical_disk",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📀":{name:"dvd",slug:"dvd",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧮":{name:"abacus",slug:"abacus",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🎥":{name:"movie camera",slug:"movie_camera",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎞️":{name:"film frames",slug:"film_frames",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📽️":{name:"film projector",slug:"film_projector",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🎬":{name:"clapper board",slug:"clapper_board",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📺":{name:"television",slug:"television",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📷":{name:"camera",slug:"camera",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📸":{name:"camera with flash",slug:"camera_with_flash",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📹":{name:"video camera",slug:"video_camera",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📼":{name:"videocassette",slug:"videocassette",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔍":{name:"magnifying glass tilted left",slug:"magnifying_glass_tilted_left",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔎":{name:"magnifying glass tilted right",slug:"magnifying_glass_tilted_right",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🕯️":{name:"candle",slug:"candle",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💡":{name:"light bulb",slug:"light_bulb",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔦":{name:"flashlight",slug:"flashlight",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏮":{name:"red paper lantern",slug:"red_paper_lantern",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪔":{name:"diya lamp",slug:"diya_lamp",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"📔":{name:"notebook with decorative cover",slug:"notebook_with_decorative_cover",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📕":{name:"closed book",slug:"closed_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📖":{name:"open book",slug:"open_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📗":{name:"green book",slug:"green_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📘":{name:"blue book",slug:"blue_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📙":{name:"orange book",slug:"orange_book",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📚":{name:"books",slug:"books",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📓":{name:"notebook",slug:"notebook",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📒":{name:"ledger",slug:"ledger",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📃":{name:"page with curl",slug:"page_with_curl",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📜":{name:"scroll",slug:"scroll",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📄":{name:"page facing up",slug:"page_facing_up",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📰":{name:"newspaper",slug:"newspaper",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗞️":{name:"rolled-up newspaper",slug:"rolled_up_newspaper",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📑":{name:"bookmark tabs",slug:"bookmark_tabs",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔖":{name:"bookmark",slug:"bookmark",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏷️":{name:"label",slug:"label",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"💰":{name:"money bag",slug:"money_bag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪙":{name:"coin",slug:"coin",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"💴":{name:"yen banknote",slug:"yen_banknote",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💵":{name:"dollar banknote",slug:"dollar_banknote",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💶":{name:"euro banknote",slug:"euro_banknote",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💷":{name:"pound banknote",slug:"pound_banknote",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💸":{name:"money with wings",slug:"money_with_wings",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💳":{name:"credit card",slug:"credit_card",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🧾":{name:"receipt",slug:"receipt",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"💹":{name:"chart increasing with yen",slug:"chart_increasing_with_yen",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✉️":{name:"envelope",slug:"envelope",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📧":{name:"e-mail",slug:"e_mail",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📨":{name:"incoming envelope",slug:"incoming_envelope",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📩":{name:"envelope with arrow",slug:"envelope_with_arrow",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📤":{name:"outbox tray",slug:"outbox_tray",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📥":{name:"inbox tray",slug:"inbox_tray",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📦":{name:"package",slug:"package",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📫":{name:"closed mailbox with raised flag",slug:"closed_mailbox_with_raised_flag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📪":{name:"closed mailbox with lowered flag",slug:"closed_mailbox_with_lowered_flag",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📬":{name:"open mailbox with raised flag",slug:"open_mailbox_with_raised_flag",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📭":{name:"open mailbox with lowered flag",slug:"open_mailbox_with_lowered_flag",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📮":{name:"postbox",slug:"postbox",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗳️":{name:"ballot box with ballot",slug:"ballot_box_with_ballot",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"✏️":{name:"pencil",slug:"pencil",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✒️":{name:"black nib",slug:"black_nib",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖋️":{name:"fountain pen",slug:"fountain_pen",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖊️":{name:"pen",slug:"pen",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖌️":{name:"paintbrush",slug:"paintbrush",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🖍️":{name:"crayon",slug:"crayon",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📝":{name:"memo",slug:"memo",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💼":{name:"briefcase",slug:"briefcase",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📁":{name:"file folder",slug:"file_folder",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📂":{name:"open file folder",slug:"open_file_folder",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗂️":{name:"card index dividers",slug:"card_index_dividers",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📅":{name:"calendar",slug:"calendar",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📆":{name:"tear-off calendar",slug:"tear_off_calendar",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗒️":{name:"spiral notepad",slug:"spiral_notepad",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗓️":{name:"spiral calendar",slug:"spiral_calendar",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📇":{name:"card index",slug:"card_index",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📈":{name:"chart increasing",slug:"chart_increasing",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📉":{name:"chart decreasing",slug:"chart_decreasing",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📊":{name:"bar chart",slug:"bar_chart",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📋":{name:"clipboard",slug:"clipboard",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📌":{name:"pushpin",slug:"pushpin",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📍":{name:"round pushpin",slug:"round_pushpin",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📎":{name:"paperclip",slug:"paperclip",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🖇️":{name:"linked paperclips",slug:"linked_paperclips",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"📏":{name:"straight ruler",slug:"straight_ruler",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📐":{name:"triangular ruler",slug:"triangular_ruler",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✂️":{name:"scissors",slug:"scissors",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗃️":{name:"card file box",slug:"card_file_box",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗄️":{name:"file cabinet",slug:"file_cabinet",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗑️":{name:"wastebasket",slug:"wastebasket",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔒":{name:"locked",slug:"locked",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔓":{name:"unlocked",slug:"unlocked",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔏":{name:"locked with pen",slug:"locked_with_pen",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔐":{name:"locked with key",slug:"locked_with_key",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔑":{name:"key",slug:"key",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🗝️":{name:"old key",slug:"old_key",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔨":{name:"hammer",slug:"hammer",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪓":{name:"axe",slug:"axe",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⛏️":{name:"pick",slug:"pick",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚒️":{name:"hammer and pick",slug:"hammer_and_pick",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛠️":{name:"hammer and wrench",slug:"hammer_and_wrench",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🗡️":{name:"dagger",slug:"dagger",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚔️":{name:"crossed swords",slug:"crossed_swords",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"💣":{name:"bomb",slug:"bomb",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪃":{name:"boomerang",slug:"boomerang",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🏹":{name:"bow and arrow",slug:"bow_and_arrow",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛡️":{name:"shield",slug:"shield",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🪚":{name:"carpentry saw",slug:"carpentry_saw",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🔧":{name:"wrench",slug:"wrench",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪛":{name:"screwdriver",slug:"screwdriver",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🔩":{name:"nut and bolt",slug:"nut_and_bolt",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚙️":{name:"gear",slug:"gear",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🗜️":{name:"clamp",slug:"clamp",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⚖️":{name:"balance scale",slug:"balance_scale",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🦯":{name:"white cane",slug:"white_cane",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🔗":{name:"link",slug:"link",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛓️‍💥":{name:"broken chain",slug:"broken_chain",group:"Objects",emoji_version:"15.1",unicode_version:"15.1",skin_tone_support:!1},"⛓️":{name:"chains",slug:"chains",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🪝":{name:"hook",slug:"hook",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧰":{name:"toolbox",slug:"toolbox",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧲":{name:"magnet",slug:"magnet",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪜":{name:"ladder",slug:"ladder",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪏":{name:"shovel",slug:"shovel",group:"Objects",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"⚗️":{name:"alembic",slug:"alembic",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧪":{name:"test tube",slug:"test_tube",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧫":{name:"petri dish",slug:"petri_dish",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧬":{name:"dna",slug:"dna",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🔬":{name:"microscope",slug:"microscope",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔭":{name:"telescope",slug:"telescope",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📡":{name:"satellite antenna",slug:"satellite_antenna",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💉":{name:"syringe",slug:"syringe",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩸":{name:"drop of blood",slug:"drop_of_blood",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"💊":{name:"pill",slug:"pill",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🩹":{name:"adhesive bandage",slug:"adhesive_bandage",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩼":{name:"crutch",slug:"crutch",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🩺":{name:"stethoscope",slug:"stethoscope",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🩻":{name:"x-ray",slug:"x_ray",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🚪":{name:"door",slug:"door",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛗":{name:"elevator",slug:"elevator",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪞":{name:"mirror",slug:"mirror",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪟":{name:"window",slug:"window",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🛏️":{name:"bed",slug:"bed",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🛋️":{name:"couch and lamp",slug:"couch_and_lamp",group:"Objects",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🪑":{name:"chair",slug:"chair",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🚽":{name:"toilet",slug:"toilet",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪠":{name:"plunger",slug:"plunger",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🚿":{name:"shower",slug:"shower",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛁":{name:"bathtub",slug:"bathtub",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪤":{name:"mouse trap",slug:"mouse_trap",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪒":{name:"razor",slug:"razor",group:"Objects",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🧴":{name:"lotion bottle",slug:"lotion_bottle",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧷":{name:"safety pin",slug:"safety_pin",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧹":{name:"broom",slug:"broom",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧺":{name:"basket",slug:"basket",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧻":{name:"roll of paper",slug:"roll_of_paper",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪣":{name:"bucket",slug:"bucket",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧼":{name:"soap",slug:"soap",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🫧":{name:"bubbles",slug:"bubbles",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🪥":{name:"toothbrush",slug:"toothbrush",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🧽":{name:"sponge",slug:"sponge",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🧯":{name:"fire extinguisher",slug:"fire_extinguisher",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🛒":{name:"shopping cart",slug:"shopping_cart",group:"Objects",emoji_version:"3.0",unicode_version:"3.0",skin_tone_support:!1},"🚬":{name:"cigarette",slug:"cigarette",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚰️":{name:"coffin",slug:"coffin",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🪦":{name:"headstone",slug:"headstone",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"⚱️":{name:"funeral urn",slug:"funeral_urn",group:"Objects",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🧿":{name:"nazar amulet",slug:"nazar_amulet",group:"Objects",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🪬":{name:"hamsa",slug:"hamsa",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🗿":{name:"moai",slug:"moai",group:"Objects",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪧":{name:"placard",slug:"placard",group:"Objects",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🪪":{name:"identification card",slug:"identification_card",group:"Objects",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"🏧":{name:"ATM sign",slug:"atm_sign",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚮":{name:"litter in bin sign",slug:"litter_in_bin_sign",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚰":{name:"potable water",slug:"potable_water",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"♿":{name:"wheelchair symbol",slug:"wheelchair_symbol",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚹":{name:"men’s room",slug:"men_s_room",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚺":{name:"women’s room",slug:"women_s_room",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚻":{name:"restroom",slug:"restroom",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚼":{name:"baby symbol",slug:"baby_symbol",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚾":{name:"water closet",slug:"water_closet",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛂":{name:"passport control",slug:"passport_control",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛃":{name:"customs",slug:"customs",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛄":{name:"baggage claim",slug:"baggage_claim",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🛅":{name:"left luggage",slug:"left_luggage",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⚠️":{name:"warning",slug:"warning",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚸":{name:"children crossing",slug:"children_crossing",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⛔":{name:"no entry",slug:"no_entry",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚫":{name:"prohibited",slug:"prohibited",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚳":{name:"no bicycles",slug:"no_bicycles",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚭":{name:"no smoking",slug:"no_smoking",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚯":{name:"no littering",slug:"no_littering",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚱":{name:"non-potable water",slug:"non_potable_water",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🚷":{name:"no pedestrians",slug:"no_pedestrians",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📵":{name:"no mobile phones",slug:"no_mobile_phones",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔞":{name:"no one under eighteen",slug:"no_one_under_eighteen",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☢️":{name:"radioactive",slug:"radioactive",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☣️":{name:"biohazard",slug:"biohazard",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⬆️":{name:"up arrow",slug:"up_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↗️":{name:"up-right arrow",slug:"up_right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➡️":{name:"right arrow",slug:"right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↘️":{name:"down-right arrow",slug:"down_right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⬇️":{name:"down arrow",slug:"down_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↙️":{name:"down-left arrow",slug:"down_left_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⬅️":{name:"left arrow",slug:"left_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↖️":{name:"up-left arrow",slug:"up_left_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↕️":{name:"up-down arrow",slug:"up_down_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↔️":{name:"left-right arrow",slug:"left_right_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↩️":{name:"right arrow curving left",slug:"right_arrow_curving_left",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"↪️":{name:"left arrow curving right",slug:"left_arrow_curving_right",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⤴️":{name:"right arrow curving up",slug:"right_arrow_curving_up",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⤵️":{name:"right arrow curving down",slug:"right_arrow_curving_down",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔃":{name:"clockwise vertical arrows",slug:"clockwise_vertical_arrows",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔄":{name:"counterclockwise arrows button",slug:"counterclockwise_arrows_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔙":{name:"BACK arrow",slug:"back_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔚":{name:"END arrow",slug:"end_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔛":{name:"ON! arrow",slug:"on_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔜":{name:"SOON arrow",slug:"soon_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔝":{name:"TOP arrow",slug:"top_arrow",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛐":{name:"place of worship",slug:"place_of_worship",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"⚛️":{name:"atom symbol",slug:"atom_symbol",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🕉️":{name:"om",slug:"om",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"✡️":{name:"star of David",slug:"star_of_david",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☸️":{name:"wheel of dharma",slug:"wheel_of_dharma",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☯️":{name:"yin yang",slug:"yin_yang",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"✝️":{name:"latin cross",slug:"latin_cross",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☦️":{name:"orthodox cross",slug:"orthodox_cross",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"☪️":{name:"star and crescent",slug:"star_and_crescent",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"☮️":{name:"peace symbol",slug:"peace_symbol",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🕎":{name:"menorah",slug:"menorah",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔯":{name:"dotted six-pointed star",slug:"dotted_six_pointed_star",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🪯":{name:"khanda",slug:"khanda",group:"Symbols",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"♈":{name:"Aries",slug:"aries",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♉":{name:"Taurus",slug:"taurus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♊":{name:"Gemini",slug:"gemini",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♋":{name:"Cancer",slug:"cancer",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♌":{name:"Leo",slug:"leo",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♍":{name:"Virgo",slug:"virgo",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♎":{name:"Libra",slug:"libra",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♏":{name:"Scorpio",slug:"scorpio",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♐":{name:"Sagittarius",slug:"sagittarius",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♑":{name:"Capricorn",slug:"capricorn",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♒":{name:"Aquarius",slug:"aquarius",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♓":{name:"Pisces",slug:"pisces",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⛎":{name:"Ophiuchus",slug:"ophiuchus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔀":{name:"shuffle tracks button",slug:"shuffle_tracks_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔁":{name:"repeat button",slug:"repeat_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔂":{name:"repeat single button",slug:"repeat_single_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"▶️":{name:"play button",slug:"play_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏩":{name:"fast-forward button",slug:"fast_forward_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏭️":{name:"next track button",slug:"next_track_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏯️":{name:"play or pause button",slug:"play_or_pause_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"◀️":{name:"reverse button",slug:"reverse_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏪":{name:"fast reverse button",slug:"fast_reverse_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏮️":{name:"last track button",slug:"last_track_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🔼":{name:"upwards button",slug:"upwards_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏫":{name:"fast up button",slug:"fast_up_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔽":{name:"downwards button",slug:"downwards_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏬":{name:"fast down button",slug:"fast_down_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⏸️":{name:"pause button",slug:"pause_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏹️":{name:"stop button",slug:"stop_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏺️":{name:"record button",slug:"record_button",group:"Symbols",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"⏏️":{name:"eject button",slug:"eject_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🎦":{name:"cinema",slug:"cinema",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔅":{name:"dim button",slug:"dim_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔆":{name:"bright button",slug:"bright_button",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"📶":{name:"antenna bars",slug:"antenna_bars",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🛜":{name:"wireless",slug:"wireless",group:"Symbols",emoji_version:"15.0",unicode_version:"15.0",skin_tone_support:!1},"📳":{name:"vibration mode",slug:"vibration_mode",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📴":{name:"mobile phone off",slug:"mobile_phone_off",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"♀️":{name:"female sign",slug:"female_sign",group:"Symbols",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"♂️":{name:"male sign",slug:"male_sign",group:"Symbols",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"⚧️":{name:"transgender symbol",slug:"transgender_symbol",group:"Symbols",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"✖️":{name:"multiply",slug:"multiply",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➕":{name:"plus",slug:"plus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➖":{name:"minus",slug:"minus",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➗":{name:"divide",slug:"divide",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟰":{name:"heavy equals sign",slug:"heavy_equals_sign",group:"Symbols",emoji_version:"14.0",unicode_version:"14.0",skin_tone_support:!1},"♾️":{name:"infinity",slug:"infinity",group:"Symbols",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"‼️":{name:"double exclamation mark",slug:"double_exclamation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⁉️":{name:"exclamation question mark",slug:"exclamation_question_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❓":{name:"red question mark",slug:"red_question_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❔":{name:"white question mark",slug:"white_question_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❕":{name:"white exclamation mark",slug:"white_exclamation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❗":{name:"red exclamation mark",slug:"red_exclamation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"〰️":{name:"wavy dash",slug:"wavy_dash",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💱":{name:"currency exchange",slug:"currency_exchange",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💲":{name:"heavy dollar sign",slug:"heavy_dollar_sign",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚕️":{name:"medical symbol",slug:"medical_symbol",group:"Symbols",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"♻️":{name:"recycling symbol",slug:"recycling_symbol",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚜️":{name:"fleur-de-lis",slug:"fleur_de_lis",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🔱":{name:"trident emblem",slug:"trident_emblem",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"📛":{name:"name badge",slug:"name_badge",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔰":{name:"Japanese symbol for beginner",slug:"japanese_symbol_for_beginner",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⭕":{name:"hollow red circle",slug:"hollow_red_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✅":{name:"check mark button",slug:"check_mark_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"☑️":{name:"check box with check",slug:"check_box_with_check",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✔️":{name:"check mark",slug:"check_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❌":{name:"cross mark",slug:"cross_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❎":{name:"cross mark button",slug:"cross_mark_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➰":{name:"curly loop",slug:"curly_loop",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"➿":{name:"double curly loop",slug:"double_curly_loop",group:"Symbols",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"〽️":{name:"part alternation mark",slug:"part_alternation_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✳️":{name:"eight-spoked asterisk",slug:"eight_spoked_asterisk",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"✴️":{name:"eight-pointed star",slug:"eight_pointed_star",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"❇️":{name:"sparkle",slug:"sparkle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"©️":{name:"copyright",slug:"copyright",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"®️":{name:"registered",slug:"registered",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"™️":{name:"trade mark",slug:"trade_mark",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🫟":{name:"splatter",slug:"splatter",group:"Symbols",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"#️⃣":{name:"keycap #",slug:"keycap_number_sign",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"*️⃣":{name:"keycap *",slug:"keycap_asterisk",group:"Symbols",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"0️⃣":{name:"keycap 0",slug:"keycap_0",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"1️⃣":{name:"keycap 1",slug:"keycap_1",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"2️⃣":{name:"keycap 2",slug:"keycap_2",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"3️⃣":{name:"keycap 3",slug:"keycap_3",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"4️⃣":{name:"keycap 4",slug:"keycap_4",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"5️⃣":{name:"keycap 5",slug:"keycap_5",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"6️⃣":{name:"keycap 6",slug:"keycap_6",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"7️⃣":{name:"keycap 7",slug:"keycap_7",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"8️⃣":{name:"keycap 8",slug:"keycap_8",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"9️⃣":{name:"keycap 9",slug:"keycap_9",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔟":{name:"keycap 10",slug:"keycap_10",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔠":{name:"input latin uppercase",slug:"input_latin_uppercase",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔡":{name:"input latin lowercase",slug:"input_latin_lowercase",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔢":{name:"input numbers",slug:"input_numbers",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔣":{name:"input symbols",slug:"input_symbols",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔤":{name:"input latin letters",slug:"input_latin_letters",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅰️":{name:"A button (blood type)",slug:"a_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆎":{name:"AB button (blood type)",slug:"ab_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅱️":{name:"B button (blood type)",slug:"b_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆑":{name:"CL button",slug:"cl_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆒":{name:"COOL button",slug:"cool_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆓":{name:"FREE button",slug:"free_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"ℹ️":{name:"information",slug:"information",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆔":{name:"ID button",slug:"id_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"Ⓜ️":{name:"circled M",slug:"circled_m",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆕":{name:"NEW button",slug:"new_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆖":{name:"NG button",slug:"ng_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅾️":{name:"O button (blood type)",slug:"o_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆗":{name:"OK button",slug:"ok_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🅿️":{name:"P button",slug:"p_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆘":{name:"SOS button",slug:"sos_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆙":{name:"UP! button",slug:"up_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🆚":{name:"VS button",slug:"vs_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈁":{name:"Japanese “here” button",slug:"japanese_here_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈂️":{name:"Japanese “service charge” button",slug:"japanese_service_charge_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈷️":{name:"Japanese “monthly amount” button",slug:"japanese_monthly_amount_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈶":{name:"Japanese “not free of charge” button",slug:"japanese_not_free_of_charge_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈯":{name:"Japanese “reserved” button",slug:"japanese_reserved_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🉐":{name:"Japanese “bargain” button",slug:"japanese_bargain_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈹":{name:"Japanese “discount” button",slug:"japanese_discount_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈚":{name:"Japanese “free of charge” button",slug:"japanese_free_of_charge_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈲":{name:"Japanese “prohibited” button",slug:"japanese_prohibited_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🉑":{name:"Japanese “acceptable” button",slug:"japanese_acceptable_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈸":{name:"Japanese “application” button",slug:"japanese_application_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈴":{name:"Japanese “passing grade” button",slug:"japanese_passing_grade_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈳":{name:"Japanese “vacancy” button",slug:"japanese_vacancy_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"㊗️":{name:"Japanese “congratulations” button",slug:"japanese_congratulations_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"㊙️":{name:"Japanese “secret” button",slug:"japanese_secret_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈺":{name:"Japanese “open for business” button",slug:"japanese_open_for_business_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🈵":{name:"Japanese “no vacancy” button",slug:"japanese_no_vacancy_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔴":{name:"red circle",slug:"red_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟠":{name:"orange circle",slug:"orange_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟡":{name:"yellow circle",slug:"yellow_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟢":{name:"green circle",slug:"green_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🔵":{name:"blue circle",slug:"blue_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟣":{name:"purple circle",slug:"purple_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟤":{name:"brown circle",slug:"brown_circle",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⚫":{name:"black circle",slug:"black_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⚪":{name:"white circle",slug:"white_circle",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🟥":{name:"red square",slug:"red_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟧":{name:"orange square",slug:"orange_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟨":{name:"yellow square",slug:"yellow_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟩":{name:"green square",slug:"green_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟦":{name:"blue square",slug:"blue_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟪":{name:"purple square",slug:"purple_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"🟫":{name:"brown square",slug:"brown_square",group:"Symbols",emoji_version:"12.0",unicode_version:"12.0",skin_tone_support:!1},"⬛":{name:"black large square",slug:"black_large_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"⬜":{name:"white large square",slug:"white_large_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◼️":{name:"black medium square",slug:"black_medium_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◻️":{name:"white medium square",slug:"white_medium_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◾":{name:"black medium-small square",slug:"black_medium_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"◽":{name:"white medium-small square",slug:"white_medium_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"▪️":{name:"black small square",slug:"black_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"▫️":{name:"white small square",slug:"white_small_square",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔶":{name:"large orange diamond",slug:"large_orange_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔷":{name:"large blue diamond",slug:"large_blue_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔸":{name:"small orange diamond",slug:"small_orange_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔹":{name:"small blue diamond",slug:"small_blue_diamond",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔺":{name:"red triangle pointed up",slug:"red_triangle_pointed_up",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔻":{name:"red triangle pointed down",slug:"red_triangle_pointed_down",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"💠":{name:"diamond with a dot",slug:"diamond_with_a_dot",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔘":{name:"radio button",slug:"radio_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔳":{name:"white square button",slug:"white_square_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🔲":{name:"black square button",slug:"black_square_button",group:"Symbols",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏁":{name:"chequered flag",slug:"chequered_flag",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🚩":{name:"triangular flag",slug:"triangular_flag",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🎌":{name:"crossed flags",slug:"crossed_flags",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🏴":{name:"black flag",slug:"black_flag",group:"Flags",emoji_version:"1.0",unicode_version:"1.0",skin_tone_support:!1},"🏳️":{name:"white flag",slug:"white_flag",group:"Flags",emoji_version:"0.7",unicode_version:"0.7",skin_tone_support:!1},"🏳️‍🌈":{name:"rainbow flag",slug:"rainbow_flag",group:"Flags",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🏳️‍⚧️":{name:"transgender flag",slug:"transgender_flag",group:"Flags",emoji_version:"13.0",unicode_version:"13.0",skin_tone_support:!1},"🏴‍☠️":{name:"pirate flag",slug:"pirate_flag",group:"Flags",emoji_version:"11.0",unicode_version:"11.0",skin_tone_support:!1},"🇦🇨":{name:"flag Ascension Island",slug:"flag_ascension_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇩":{name:"flag Andorra",slug:"flag_andorra",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇪":{name:"flag United Arab Emirates",slug:"flag_united_arab_emirates",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇫":{name:"flag Afghanistan",slug:"flag_afghanistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇬":{name:"flag Antigua & Barbuda",slug:"flag_antigua_barbuda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇮":{name:"flag Anguilla",slug:"flag_anguilla",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇱":{name:"flag Albania",slug:"flag_albania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇲":{name:"flag Armenia",slug:"flag_armenia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇴":{name:"flag Angola",slug:"flag_angola",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇶":{name:"flag Antarctica",slug:"flag_antarctica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇷":{name:"flag Argentina",slug:"flag_argentina",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇸":{name:"flag American Samoa",slug:"flag_american_samoa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇹":{name:"flag Austria",slug:"flag_austria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇺":{name:"flag Australia",slug:"flag_australia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇼":{name:"flag Aruba",slug:"flag_aruba",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇽":{name:"flag Åland Islands",slug:"flag_aland_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇦🇿":{name:"flag Azerbaijan",slug:"flag_azerbaijan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇦":{name:"flag Bosnia & Herzegovina",slug:"flag_bosnia_herzegovina",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇧":{name:"flag Barbados",slug:"flag_barbados",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇩":{name:"flag Bangladesh",slug:"flag_bangladesh",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇪":{name:"flag Belgium",slug:"flag_belgium",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇫":{name:"flag Burkina Faso",slug:"flag_burkina_faso",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇬":{name:"flag Bulgaria",slug:"flag_bulgaria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇭":{name:"flag Bahrain",slug:"flag_bahrain",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇮":{name:"flag Burundi",slug:"flag_burundi",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇯":{name:"flag Benin",slug:"flag_benin",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇱":{name:"flag St. Barthélemy",slug:"flag_st_barthelemy",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇲":{name:"flag Bermuda",slug:"flag_bermuda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇳":{name:"flag Brunei",slug:"flag_brunei",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇴":{name:"flag Bolivia",slug:"flag_bolivia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇶":{name:"flag Caribbean Netherlands",slug:"flag_caribbean_netherlands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇷":{name:"flag Brazil",slug:"flag_brazil",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇸":{name:"flag Bahamas",slug:"flag_bahamas",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇹":{name:"flag Bhutan",slug:"flag_bhutan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇻":{name:"flag Bouvet Island",slug:"flag_bouvet_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇼":{name:"flag Botswana",slug:"flag_botswana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇾":{name:"flag Belarus",slug:"flag_belarus",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇧🇿":{name:"flag Belize",slug:"flag_belize",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇦":{name:"flag Canada",slug:"flag_canada",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇨":{name:"flag Cocos (Keeling) Islands",slug:"flag_cocos_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇩":{name:"flag Congo - Kinshasa",slug:"flag_congo_kinshasa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇫":{name:"flag Central African Republic",slug:"flag_central_african_republic",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇬":{name:"flag Congo - Brazzaville",slug:"flag_congo_brazzaville",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇭":{name:"flag Switzerland",slug:"flag_switzerland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇮":{name:"flag Côte d’Ivoire",slug:"flag_cote_d_ivoire",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇰":{name:"flag Cook Islands",slug:"flag_cook_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇱":{name:"flag Chile",slug:"flag_chile",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇲":{name:"flag Cameroon",slug:"flag_cameroon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇳":{name:"flag China",slug:"flag_china",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇨🇴":{name:"flag Colombia",slug:"flag_colombia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇵":{name:"flag Clipperton Island",slug:"flag_clipperton_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇶":{name:"flag Sark",slug:"flag_sark",group:"Flags",emoji_version:"16.0",unicode_version:"16.0",skin_tone_support:!1},"🇨🇷":{name:"flag Costa Rica",slug:"flag_costa_rica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇺":{name:"flag Cuba",slug:"flag_cuba",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇻":{name:"flag Cape Verde",slug:"flag_cape_verde",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇼":{name:"flag Curaçao",slug:"flag_curacao",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇽":{name:"flag Christmas Island",slug:"flag_christmas_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇾":{name:"flag Cyprus",slug:"flag_cyprus",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇨🇿":{name:"flag Czechia",slug:"flag_czechia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇪":{name:"flag Germany",slug:"flag_germany",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇩🇬":{name:"flag Diego Garcia",slug:"flag_diego_garcia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇯":{name:"flag Djibouti",slug:"flag_djibouti",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇰":{name:"flag Denmark",slug:"flag_denmark",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇲":{name:"flag Dominica",slug:"flag_dominica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇴":{name:"flag Dominican Republic",slug:"flag_dominican_republic",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇩🇿":{name:"flag Algeria",slug:"flag_algeria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇦":{name:"flag Ceuta & Melilla",slug:"flag_ceuta_melilla",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇨":{name:"flag Ecuador",slug:"flag_ecuador",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇪":{name:"flag Estonia",slug:"flag_estonia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇬":{name:"flag Egypt",slug:"flag_egypt",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇭":{name:"flag Western Sahara",slug:"flag_western_sahara",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇷":{name:"flag Eritrea",slug:"flag_eritrea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇸":{name:"flag Spain",slug:"flag_spain",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇪🇹":{name:"flag Ethiopia",slug:"flag_ethiopia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇪🇺":{name:"flag European Union",slug:"flag_european_union",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇮":{name:"flag Finland",slug:"flag_finland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇯":{name:"flag Fiji",slug:"flag_fiji",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇰":{name:"flag Falkland Islands",slug:"flag_falkland_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇲":{name:"flag Micronesia",slug:"flag_micronesia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇴":{name:"flag Faroe Islands",slug:"flag_faroe_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇫🇷":{name:"flag France",slug:"flag_france",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇬🇦":{name:"flag Gabon",slug:"flag_gabon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇧":{name:"flag United Kingdom",slug:"flag_united_kingdom",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇬🇩":{name:"flag Grenada",slug:"flag_grenada",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇪":{name:"flag Georgia",slug:"flag_georgia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇫":{name:"flag French Guiana",slug:"flag_french_guiana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇬":{name:"flag Guernsey",slug:"flag_guernsey",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇭":{name:"flag Ghana",slug:"flag_ghana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇮":{name:"flag Gibraltar",slug:"flag_gibraltar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇱":{name:"flag Greenland",slug:"flag_greenland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇲":{name:"flag Gambia",slug:"flag_gambia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇳":{name:"flag Guinea",slug:"flag_guinea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇵":{name:"flag Guadeloupe",slug:"flag_guadeloupe",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇶":{name:"flag Equatorial Guinea",slug:"flag_equatorial_guinea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇷":{name:"flag Greece",slug:"flag_greece",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇸":{name:"flag South Georgia & South Sandwich Islands",slug:"flag_south_georgia_south_sandwich_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇹":{name:"flag Guatemala",slug:"flag_guatemala",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇺":{name:"flag Guam",slug:"flag_guam",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇼":{name:"flag Guinea-Bissau",slug:"flag_guinea_bissau",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇬🇾":{name:"flag Guyana",slug:"flag_guyana",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇰":{name:"flag Hong Kong SAR China",slug:"flag_hong_kong_sar_china",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇲":{name:"flag Heard & McDonald Islands",slug:"flag_heard_mcdonald_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇳":{name:"flag Honduras",slug:"flag_honduras",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇷":{name:"flag Croatia",slug:"flag_croatia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇹":{name:"flag Haiti",slug:"flag_haiti",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇭🇺":{name:"flag Hungary",slug:"flag_hungary",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇨":{name:"flag Canary Islands",slug:"flag_canary_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇩":{name:"flag Indonesia",slug:"flag_indonesia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇪":{name:"flag Ireland",slug:"flag_ireland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇱":{name:"flag Israel",slug:"flag_israel",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇲":{name:"flag Isle of Man",slug:"flag_isle_of_man",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇳":{name:"flag India",slug:"flag_india",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇴":{name:"flag British Indian Ocean Territory",slug:"flag_british_indian_ocean_territory",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇶":{name:"flag Iraq",slug:"flag_iraq",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇷":{name:"flag Iran",slug:"flag_iran",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇸":{name:"flag Iceland",slug:"flag_iceland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇮🇹":{name:"flag Italy",slug:"flag_italy",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇯🇪":{name:"flag Jersey",slug:"flag_jersey",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇯🇲":{name:"flag Jamaica",slug:"flag_jamaica",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇯🇴":{name:"flag Jordan",slug:"flag_jordan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇯🇵":{name:"flag Japan",slug:"flag_japan",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇰🇪":{name:"flag Kenya",slug:"flag_kenya",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇬":{name:"flag Kyrgyzstan",slug:"flag_kyrgyzstan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇭":{name:"flag Cambodia",slug:"flag_cambodia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇮":{name:"flag Kiribati",slug:"flag_kiribati",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇲":{name:"flag Comoros",slug:"flag_comoros",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇳":{name:"flag St. Kitts & Nevis",slug:"flag_st_kitts_nevis",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇵":{name:"flag North Korea",slug:"flag_north_korea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇷":{name:"flag South Korea",slug:"flag_south_korea",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇰🇼":{name:"flag Kuwait",slug:"flag_kuwait",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇾":{name:"flag Cayman Islands",slug:"flag_cayman_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇰🇿":{name:"flag Kazakhstan",slug:"flag_kazakhstan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇦":{name:"flag Laos",slug:"flag_laos",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇧":{name:"flag Lebanon",slug:"flag_lebanon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇨":{name:"flag St. Lucia",slug:"flag_st_lucia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇮":{name:"flag Liechtenstein",slug:"flag_liechtenstein",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇰":{name:"flag Sri Lanka",slug:"flag_sri_lanka",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇷":{name:"flag Liberia",slug:"flag_liberia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇸":{name:"flag Lesotho",slug:"flag_lesotho",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇹":{name:"flag Lithuania",slug:"flag_lithuania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇺":{name:"flag Luxembourg",slug:"flag_luxembourg",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇻":{name:"flag Latvia",slug:"flag_latvia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇱🇾":{name:"flag Libya",slug:"flag_libya",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇦":{name:"flag Morocco",slug:"flag_morocco",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇨":{name:"flag Monaco",slug:"flag_monaco",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇩":{name:"flag Moldova",slug:"flag_moldova",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇪":{name:"flag Montenegro",slug:"flag_montenegro",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇫":{name:"flag St. Martin",slug:"flag_st_martin",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇬":{name:"flag Madagascar",slug:"flag_madagascar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇭":{name:"flag Marshall Islands",slug:"flag_marshall_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇰":{name:"flag North Macedonia",slug:"flag_north_macedonia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇱":{name:"flag Mali",slug:"flag_mali",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇲":{name:"flag Myanmar (Burma)",slug:"flag_myanmar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇳":{name:"flag Mongolia",slug:"flag_mongolia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇴":{name:"flag Macao SAR China",slug:"flag_macao_sar_china",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇵":{name:"flag Northern Mariana Islands",slug:"flag_northern_mariana_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇶":{name:"flag Martinique",slug:"flag_martinique",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇷":{name:"flag Mauritania",slug:"flag_mauritania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇸":{name:"flag Montserrat",slug:"flag_montserrat",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇹":{name:"flag Malta",slug:"flag_malta",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇺":{name:"flag Mauritius",slug:"flag_mauritius",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇻":{name:"flag Maldives",slug:"flag_maldives",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇼":{name:"flag Malawi",slug:"flag_malawi",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇽":{name:"flag Mexico",slug:"flag_mexico",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇾":{name:"flag Malaysia",slug:"flag_malaysia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇲🇿":{name:"flag Mozambique",slug:"flag_mozambique",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇦":{name:"flag Namibia",slug:"flag_namibia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇨":{name:"flag New Caledonia",slug:"flag_new_caledonia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇪":{name:"flag Niger",slug:"flag_niger",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇫":{name:"flag Norfolk Island",slug:"flag_norfolk_island",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇬":{name:"flag Nigeria",slug:"flag_nigeria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇮":{name:"flag Nicaragua",slug:"flag_nicaragua",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇱":{name:"flag Netherlands",slug:"flag_netherlands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇴":{name:"flag Norway",slug:"flag_norway",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇵":{name:"flag Nepal",slug:"flag_nepal",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇷":{name:"flag Nauru",slug:"flag_nauru",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇺":{name:"flag Niue",slug:"flag_niue",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇳🇿":{name:"flag New Zealand",slug:"flag_new_zealand",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇴🇲":{name:"flag Oman",slug:"flag_oman",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇦":{name:"flag Panama",slug:"flag_panama",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇪":{name:"flag Peru",slug:"flag_peru",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇫":{name:"flag French Polynesia",slug:"flag_french_polynesia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇬":{name:"flag Papua New Guinea",slug:"flag_papua_new_guinea",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇭":{name:"flag Philippines",slug:"flag_philippines",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇰":{name:"flag Pakistan",slug:"flag_pakistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇱":{name:"flag Poland",slug:"flag_poland",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇲":{name:"flag St. Pierre & Miquelon",slug:"flag_st_pierre_miquelon",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇳":{name:"flag Pitcairn Islands",slug:"flag_pitcairn_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇷":{name:"flag Puerto Rico",slug:"flag_puerto_rico",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇸":{name:"flag Palestinian Territories",slug:"flag_palestinian_territories",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇹":{name:"flag Portugal",slug:"flag_portugal",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇼":{name:"flag Palau",slug:"flag_palau",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇵🇾":{name:"flag Paraguay",slug:"flag_paraguay",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇶🇦":{name:"flag Qatar",slug:"flag_qatar",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇪":{name:"flag Réunion",slug:"flag_reunion",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇴":{name:"flag Romania",slug:"flag_romania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇸":{name:"flag Serbia",slug:"flag_serbia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇷🇺":{name:"flag Russia",slug:"flag_russia",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇷🇼":{name:"flag Rwanda",slug:"flag_rwanda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇦":{name:"flag Saudi Arabia",slug:"flag_saudi_arabia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇧":{name:"flag Solomon Islands",slug:"flag_solomon_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇨":{name:"flag Seychelles",slug:"flag_seychelles",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇩":{name:"flag Sudan",slug:"flag_sudan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇪":{name:"flag Sweden",slug:"flag_sweden",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇬":{name:"flag Singapore",slug:"flag_singapore",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇭":{name:"flag St. Helena",slug:"flag_st_helena",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇮":{name:"flag Slovenia",slug:"flag_slovenia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇯":{name:"flag Svalbard & Jan Mayen",slug:"flag_svalbard_jan_mayen",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇰":{name:"flag Slovakia",slug:"flag_slovakia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇱":{name:"flag Sierra Leone",slug:"flag_sierra_leone",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇲":{name:"flag San Marino",slug:"flag_san_marino",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇳":{name:"flag Senegal",slug:"flag_senegal",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇴":{name:"flag Somalia",slug:"flag_somalia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇷":{name:"flag Suriname",slug:"flag_suriname",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇸":{name:"flag South Sudan",slug:"flag_south_sudan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇹":{name:"flag São Tomé & Príncipe",slug:"flag_sao_tome_principe",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇻":{name:"flag El Salvador",slug:"flag_el_salvador",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇽":{name:"flag Sint Maarten",slug:"flag_sint_maarten",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇾":{name:"flag Syria",slug:"flag_syria",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇸🇿":{name:"flag Eswatini",slug:"flag_eswatini",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇦":{name:"flag Tristan da Cunha",slug:"flag_tristan_da_cunha",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇨":{name:"flag Turks & Caicos Islands",slug:"flag_turks_caicos_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇩":{name:"flag Chad",slug:"flag_chad",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇫":{name:"flag French Southern Territories",slug:"flag_french_southern_territories",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇬":{name:"flag Togo",slug:"flag_togo",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇭":{name:"flag Thailand",slug:"flag_thailand",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇯":{name:"flag Tajikistan",slug:"flag_tajikistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇰":{name:"flag Tokelau",slug:"flag_tokelau",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇱":{name:"flag Timor-Leste",slug:"flag_timor_leste",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇲":{name:"flag Turkmenistan",slug:"flag_turkmenistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇳":{name:"flag Tunisia",slug:"flag_tunisia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇴":{name:"flag Tonga",slug:"flag_tonga",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇷":{name:"flag Türkiye",slug:"flag_turkiye",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇹":{name:"flag Trinidad & Tobago",slug:"flag_trinidad_tobago",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇻":{name:"flag Tuvalu",slug:"flag_tuvalu",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇼":{name:"flag Taiwan",slug:"flag_taiwan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇹🇿":{name:"flag Tanzania",slug:"flag_tanzania",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇦":{name:"flag Ukraine",slug:"flag_ukraine",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇬":{name:"flag Uganda",slug:"flag_uganda",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇲":{name:"flag U.S. Outlying Islands",slug:"flag_u_s_outlying_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇳":{name:"flag United Nations",slug:"flag_united_nations",group:"Flags",emoji_version:"4.0",unicode_version:"4.0",skin_tone_support:!1},"🇺🇸":{name:"flag United States",slug:"flag_united_states",group:"Flags",emoji_version:"0.6",unicode_version:"0.6",skin_tone_support:!1},"🇺🇾":{name:"flag Uruguay",slug:"flag_uruguay",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇺🇿":{name:"flag Uzbekistan",slug:"flag_uzbekistan",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇦":{name:"flag Vatican City",slug:"flag_vatican_city",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇨":{name:"flag St. Vincent & Grenadines",slug:"flag_st_vincent_grenadines",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇪":{name:"flag Venezuela",slug:"flag_venezuela",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇬":{name:"flag British Virgin Islands",slug:"flag_british_virgin_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇮":{name:"flag U.S. Virgin Islands",slug:"flag_u_s_virgin_islands",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇳":{name:"flag Vietnam",slug:"flag_vietnam",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇻🇺":{name:"flag Vanuatu",slug:"flag_vanuatu",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇼🇫":{name:"flag Wallis & Futuna",slug:"flag_wallis_futuna",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇼🇸":{name:"flag Samoa",slug:"flag_samoa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇽🇰":{name:"flag Kosovo",slug:"flag_kosovo",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇾🇪":{name:"flag Yemen",slug:"flag_yemen",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇾🇹":{name:"flag Mayotte",slug:"flag_mayotte",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇿🇦":{name:"flag South Africa",slug:"flag_south_africa",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇿🇲":{name:"flag Zambia",slug:"flag_zambia",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🇿🇼":{name:"flag Zimbabwe",slug:"flag_zimbabwe",group:"Flags",emoji_version:"2.0",unicode_version:"2.0",skin_tone_support:!1},"🏴󠁧󠁢󠁥󠁮󠁧󠁿":{name:"flag England",slug:"flag_england",group:"Flags",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🏴󠁧󠁢󠁳󠁣󠁴󠁿":{name:"flag Scotland",slug:"flag_scotland",group:"Flags",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1},"🏴󠁧󠁢󠁷󠁬󠁳󠁿":{name:"flag Wales",slug:"flag_wales",group:"Flags",emoji_version:"5.0",unicode_version:"5.0",skin_tone_support:!1}};function nT(o,e){const t=o.target;b(e,j(t.value))}var iT=(o,e)=>e("recent"),rT=de("<button>Recent</button>"),aT=(o,e,t)=>e(t()),lT=de("<button> </button>"),cT=de('<div class="flex border-b border-base-content/20 overflow-x-auto"><!> <!></div>'),dT=(o,e,t)=>e(n(t).emoji),uT=de('<button class="w-8 h-8 flex items-center justify-center text-lg hover:bg-base-200 rounded transition-colors"> </button>'),pT=(o,e,t)=>e(n(t)),vT=de('<button class="w-8 h-8 flex items-center justify-center text-lg hover:bg-base-200 rounded transition-colors"> </button>'),fT=(o,e,t)=>e(n(t).emoji),gT=de('<button class="w-8 h-8 flex items-center justify-center text-lg hover:bg-base-200 rounded transition-colors"> </button>'),mT=de('<div class="text-center text-base-content/60 py-8">No emojis found</div>'),hT=de('<div class="emoji-picker fixed z-50 bg-base-100 border border-base-content/20 rounded-lg shadow-lg svelte-hsh18a"><div class="p-3 border-b border-base-content/20"><input type="text" placeholder="Search emojis..." class="input input-sm w-full bg-base-200"></div> <!> <div class="p-2 overflow-y-auto" style="height: calc(100% - 120px);"><div class="grid grid-cols-8 gap-1"><!></div> <!></div></div>');function _T(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(l,"$recentlyUsed",t),i=Md();let r=Ss(e,"show",15,!1),a=Ss(e,"position",27,()=>j({x:0,y:0}));const l=f1("emoji-recently-used",[]);let d=oe(""),v=oe("smileys");const _=(()=>{const P={smileys:{name:"Smileys & Emotion",emojis:[]},people:{name:"People & Body",emojis:[]},animals:{name:"Animals & Nature",emojis:[]},food:{name:"Food & Drink",emojis:[]},activities:{name:"Activities",emojis:[]},travel:{name:"Travel & Places",emojis:[]},objects:{name:"Objects",emojis:[]},symbols:{name:"Symbols",emojis:[]},flags:{name:"Flags",emojis:[]}};return Object.entries(sT).forEach(([A,F])=>{var $;if(!A||!F.name)return;const B={emoji:A,name:F.name,keywords:F.keywords||[]},R=(($=F.group)==null?void 0:$.toLowerCase())||"",N=F.name.toLowerCase();R.includes("smileys")||R.includes("emotion")||N.includes("face")||N.includes("smile")||N.includes("laugh")||N.includes("cry")?P.smileys.emojis.push(B):R.includes("people")||R.includes("body")||N.includes("hand")||N.includes("body")||N.includes("person")||N.includes("man")||N.includes("woman")?P.people.emojis.push(B):R.includes("animals")||R.includes("nature")||N.includes("animal")||N.includes("cat")||N.includes("dog")||N.includes("bird")||N.includes("plant")||N.includes("tree")?P.animals.emojis.push(B):R.includes("food")||R.includes("drink")||N.includes("food")||N.includes("fruit")||N.includes("drink")||N.includes("coffee")||N.includes("pizza")?P.food.emojis.push(B):R.includes("activities")||R.includes("sport")||N.includes("sport")||N.includes("ball")||N.includes("game")?P.activities.emojis.push(B):R.includes("travel")||R.includes("places")||N.includes("car")||N.includes("plane")||N.includes("train")||N.includes("building")?P.travel.emojis.push(B):R.includes("objects")||N.includes("phone")||N.includes("computer")||N.includes("book")||N.includes("tool")?P.objects.emojis.push(B):R.includes("flags")||N.includes("flag")?P.flags.emojis.push(B):P.symbols.emojis.push(B)}),P})(),y=We(()=>{var P;return n(d)?Object.values(_).flatMap(A=>A.emojis).filter(A=>A.emoji.includes(n(d))||A.name.toLowerCase().includes(n(d).toLowerCase())||A.keywords.some(F=>F.toLowerCase().includes(n(d).toLowerCase()))):((P=_[n(v)])==null?void 0:P.emojis)||[]});function w(P){l.update(A=>{const F=A.filter(B=>B!==P);return[P,...F].slice(0,20)}),i("select",{emoji:P}),r(!1)}function k(P){b(v,j(P)),b(d,"")}function S(P){P.target.closest(".emoji-picker")||r(!1)}Rd(()=>{if(typeof document<"u")return document.addEventListener("click",S),()=>{document.removeEventListener("click",S)}});var L=Xt(),T=_t(L);Se(T,r,P=>{var A=hT(),F=g(A),B=g(F);Vt(B),B.__input=[nT,d],f(F);var R=u(F,2);Se(R,()=>!n(d),G=>{var Z=cT(),le=g(Z);Se(le,()=>s().length>0,ie=>{var Y=rT();Y.__click=[iT,k],we(()=>Pn(Y,`px-3 py-2 text-xs whitespace-nowrap border-b-2 transition-colors ${(n(v)==="recent"?"border-primary text-primary":"border-transparent hover:text-primary")??""}`)),O(ie,Y)});var se=u(le,2);Ns(se,17,()=>Object.entries(_),dn,(ie,Y)=>{let K=()=>n(Y)[0],Q=()=>n(Y)[1];var q=lT();q.__click=[aT,k,K];var ce=g(q,!0);f(q),we(()=>{Pn(q,`px-3 py-2 text-xs whitespace-nowrap border-b-2 transition-colors ${(n(v)===K()?"border-primary text-primary":"border-transparent hover:text-primary")??""}`),Ye(ce,Q().name)}),O(ie,q)}),f(Z),O(G,Z)});var N=u(R,2),$=g(N),V=g($);Se(V,()=>n(d),G=>{var Z=Xt(),le=_t(Z);Ns(le,17,()=>n(y),dn,(se,ie)=>{var Y=uT();Y.__click=[dT,w,ie];var K=g(Y,!0);f(Y),we(()=>{St(Y,"title",n(ie).name),Ye(K,n(ie).emoji)}),O(se,Y)}),O(G,Z)},G=>{var Z=Xt(),le=_t(Z);Se(le,()=>n(v)==="recent"&&s().length>0,se=>{var ie=Xt(),Y=_t(ie);Ns(Y,1,s,dn,(K,Q)=>{var q=vT();q.__click=[pT,w,Q];var ce=g(q,!0);f(q),we(()=>{St(q,"title",n(Q)),Ye(ce,n(Q))}),O(K,q)}),O(se,ie)},se=>{var ie=Xt(),Y=_t(ie);Ns(Y,17,()=>n(y),dn,(K,Q)=>{var q=gT();q.__click=[fT,w,Q];var ce=g(q,!0);f(q),we(()=>{St(q,"title",n(Q).name),Ye(ce,n(Q).emoji)}),O(K,q)}),O(se,ie)},!0),O(G,Z)}),f($);var U=u($,2);Se(U,()=>n(d)&&n(y).length===0,G=>{var Z=mT();O(G,Z)}),f(N),f(A),we(()=>{St(A,"style",`left: ${a().x??""}px; top: ${a().y??""}px; width: 320px; height: 400px;`),Vu(B,n(d))}),O(P,A)}),O(o,L),Za()}hc(["input","click"]);function yT(o,e){e("reset")}function bT(o,e){e("confirm")}function xT(o,e){o.target.classList.contains("modal-backdrop")&&e()}var wT=o=>o.stopPropagation(),kT=de(`<div><input type="checkbox" class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 focus:ring-2
                       sm:w-4 sm:h-4 touch-manipulation"> <input type="number" step="0.001" min="0" max="10"> <button class="w-10 h-10 rounded border-2 border-gray-300 hover:border-gray-400 transition-colors
                       sm:w-8 sm:h-8 touch-manipulation" title="Change color"></button> <span> </span></div>`),ST=de(`<div class="fixed inset-0 bg-transparent flex items-center justify-center z-[9999] modal-backdrop"><div><div><h3>Fibonacci Settings</h3> <button title="Close"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4 max-h-[60vh] overflow-y-auto svelte-ah2kky"><div class="space-y-3"></div></div> <div><button>🔁 Reset</button> <div class="flex gap-3 w-full sm:w-auto sm:gap-2"><button>❌ Cancel</button> <button class="px-6 py-3 text-sm rounded bg-blue-600 hover:bg-blue-700 text-white transition-colors
                   touch-manipulation min-h-[44px] flex-1 sm:flex-none
                   sm:px-4 sm:py-2 sm:min-h-[36px]">✅ Confirm</button></div></div></div></div>`),CT=de('<div class="fixed z-[10000]"><!></div>'),PT=de("<!> <!>",1);function IT(o,e){Ka(e,!1);let t=Ss(e,"visible",8,!1),s=Ss(e,"levels",24,()=>[]),i=Ss(e,"theme",8,"dark");const r=Md();let a=kl(!1),l=kl(-1),d=kl({x:0,y:0});function v(T,P,A){r("levelChange",{index:T,field:P,value:A})}function p(T,P){b(l,P),b(d,{x:T.clientX,y:T.clientY}),b(a,!0)}function _(T){n(l)>=0&&v(n(l),"color",T.detail),b(a,!1)}function y(){b(a,!1),b(l,-1)}function w(){r("cancel")}Ud();var k=PT(),S=_t(k);Se(S,t,T=>{var P=ST();P.__click=[xT,w];var A=g(P);A.__click=[wT];var F=g(A),B=g(F),R=u(B,2);R.__click=w;var N=g(R);f(R),f(F);var $=u(F,2),V=g($);Ns(V,5,s,dn,(ie,Y,K)=>{var Q=kT(),q=g(Q);Vt(q),q.__change=()=>v(K,"visible",n(Y).visible);var ce=u(q,2);Vt(ce),ce.__change=()=>v(K,"value",n(Y).value);var _e=u(ce,2);_e.__click=ze=>p(ze,K);var me=u(_e,2),Pe=g(me,!0);we(()=>Ye(Pe,n(Y).value===0?"Start":n(Y).value===1?"End":`${(n(Y).value*100).toFixed(1)}%`)),f(me),f(Q),we(()=>{Pn(Q,`flex items-center gap-3 p-3 rounded-lg ${(i()==="dark"?"bg-[#2a2a2a]":"bg-gray-50")??""}
                        sm:gap-4 sm:p-4`),Pn(ce,`w-24 px-3 py-2 text-sm rounded border touch-manipulation
                       sm:w-20 sm:px-2 sm:py-1
                       ${(i()==="dark"?"bg-[#3a3a3a] border-[#555] text-white focus:border-blue-500":"bg-white border-gray-300 text-gray-900 focus:border-blue-500")??""} 
                       focus:outline-none focus:ring-1 focus:ring-blue-500`),St(_e,"style",`background-color: ${n(Y).color??""}`),Pn(me,`text-sm ${(i()==="dark"?"text-gray-300":"text-gray-700")??""} flex-1
                           sm:text-sm`)}),Bu(q,()=>n(Y).visible,ze=>(n(Y).visible=ze,z1(()=>s()))),go(ce,()=>n(Y).value,ze=>(n(Y).value=ze,z1(()=>s()))),O(ie,Q)}),f(V),f($);var U=u($,2),G=g(U);G.__click=[yT,r];var Z=u(G,2),le=g(Z);le.__click=w;var se=u(le,2);se.__click=[bT,r],f(Z),f(U),f(A),f(P),we(()=>{Pn(A,`relative ${(i()==="dark"?"bg-[#1a1a1a] border-[#404040]":"bg-white border-gray-200")??""} 
             rounded-lg shadow-xl border max-w-md w-full mx-4 max-h-[80vh] overflow-hidden
             sm:max-w-lg md:max-w-xl lg:max-w-2xl svelte-ah2kky`),Pn(F,`flex items-center justify-between p-4 border-b ${(i()==="dark"?"border-[#404040]":"border-gray-200")??""}`),Pn(B,`text-lg font-semibold ${(i()==="dark"?"text-white":"text-gray-900")??""}`),Pn(R,`w-8 h-8 rounded-full ${(i()==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} 
                 flex items-center justify-center transition-colors`),w0(N,`w-5 h-5 ${(i()==="dark"?"text-gray-400":"text-gray-600")??""}`),Pn(U,`flex items-center justify-between p-4 border-t ${(i()==="dark"?"border-[#404040]":"border-gray-200")??""}
                  sm:flex-row flex-col gap-3 sm:gap-0`),Pn(G,`px-6 py-3 text-sm rounded ${(i()==="dark"?"bg-gray-600 hover:bg-gray-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700")??""} 
                 transition-colors touch-manipulation min-h-[44px] w-full sm:w-auto
                 sm:px-4 sm:py-2 sm:min-h-[36px]`),Pn(le,`px-6 py-3 text-sm rounded ${(i()==="dark"?"bg-gray-600 hover:bg-gray-700 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700")??""} 
                   transition-colors touch-manipulation min-h-[44px] flex-1 sm:flex-none
                   sm:px-4 sm:py-2 sm:min-h-[36px]`)}),O(T,P)});var L=u(S,2);Se(L,()=>n(a),T=>{var P=CT(),A=g(P),F=Yd(()=>{var B;return((B=s()[n(l)])==null?void 0:B.color)||"#FF6B6B"});Su(A,{get selectedColor(){return n(F)},get show(){return n(a)},$$events:{colorChange:_,close:y}}),f(P),we(()=>St(P,"style",`left: ${n(d).x??""}px; top: ${n(d).y??""}px;`)),O(T,P)}),O(o,k),Za()}hc(["click","change"]);const y1=Id(!1);function Ou(){y1.set(!0)}function h_(){y1.set(!1)}function __(){return zd(y1)===!0}function MT(o,e,t){e.fontWeight=e.fontWeight==="bold"?"normal":"bold",t()}function TT(o,e){e(o)}function AT(o,e,t,s,i,r,a){o.stopPropagation();const l=o.target.getBoundingClientRect();b(e,"line"),b(t,j(s.color)),b(i,j(s.opacity)),b(r,j({x:Math.max(10,Math.min(l.left,window.innerWidth-320)),y:Math.max(10,Math.min(l.bottom+5,window.innerHeight-400))})),b(a,!0)}function LT(o,e,t,s,i,r,a){b(e,"textColor"),b(t,j(s.textColor)),b(i,j(n(r))),b(a,!0)}function FT(o,e,t,s,i,r,a){b(e,"textBg"),b(t,j(s.backgroundColor)),b(i,j(n(r))),b(a,!0)}function DT(o,e){o.preventDefault(),o.stopPropagation(),e()}var ET=de('<div class="pro-active-indicator absolute bottom-[3px] left-1/2 transform -translate-x-1/2 w-[4px] h-[4px] rounded-full svelte-t6isn6" style="background: var(--menu-accent);"></div>'),$T=(o,e,t)=>e(n(t)),jT=de('<div class="submenu-portal svelte-t6isn6"></div>'),zT=de(`<div class="pro-submenu-arrow flex items-center justify-center absolute top-1/2 right-0 transform -translate-y-1/2
               w-5 h-5 opacity-0 group-hover:opacity-100 hover:opacity-100 transition-all duration-150 cubic-bezier(0.4, 0, 0.2, 1)
               bg-[var(--menu-btn-bg)] border border-[var(--menu-btn-border)] rounded-full
               hover:bg-[var(--menu-hover-bg)] hover:border-[var(--menu-btn-hover-border)] cursor-pointer z-20 backdrop-blur-[8px] svelte-t6isn6" style="backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); box-shadow: 0 1px 3px rgba(0,0,0,0.1);"><svg class="w-2.5 h-2.5 transition-all duration-150 cubic-bezier(0.4, 0, 0.2, 1) text-[var(--menu-text)] svelte-t6isn6" viewBox="0 0 8 12" fill="currentColor"><path d="M1.705 0.295C1.315 -0.095 0.685 -0.095 0.295 0.295C-0.095 0.685 -0.095 1.315 0.295 1.705L5.59 7L0.295 12.295C-0.095 12.685 -0.095 13.315 0.295 13.705C0.685 14.095 1.315 14.095 1.705 13.705L7.705 7.705C8.095 7.315 8.095 6.685 7.705 6.295L1.705 0.295Z" class="svelte-t6isn6"></path></svg></div> <!>`,1),BT=de(`<div class="group flex flex-row items-center justify-center relative w-full mt-2 cursor-pointer transition-all duration-200 ease-out svelte-t6isn6"><div class="pro-draw-button w-[36px] h-[36px] rounded-[8px] flex items-center justify-center relative overflow-hidden transition-all duration-200 cubic-bezier(0.4, 0, 0.2, 1)
             isolation-isolate svelte-t6isn6" style="background: var(--menu-btn-bg); border: 1px solid var(--menu-btn-border); backdrop-filter: blur(16px) saturate(160%); -webkit-backdrop-filter: blur(16px) saturate(160%);"><div class="button-hover-overlay absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200 rounded-[8px] svelte-t6isn6" style="background: var(--menu-hover-bg);"></div> <!> <!></div> <!></div>`),NT=de('<div class="w-full h-[2px] mt-3 mb-2 opacity-90 svelte-t6isn6" style="background: linear-gradient(to right, transparent, var(--menu-accent), transparent); box-shadow: 0 0 10px var(--menu-glow);"></div>'),RT=o=>o.stopPropagation(),OT=de("<!> <!>",1),VT=o=>o.preventDefault(),WT=de('<button class="drawbar-scroll-arrow svelte-t6isn6" title="Scroll to see more tools" aria-label="Scroll down" type="button"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-t6isn6"><polyline points="6 9 12 15 18 9"></polyline></svg></button>'),qT=(o,e,t,s,i,r)=>n(e)==="mode"?t(n(s).key):i(r.findIndex(a=>a.key===n(e)),n(s).key),HT=de(`<li class="px-4 py-3 flex flex-row items-center gap-3 transition-all duration-200 ease-in-out
                   text-[var(--menu-text)] hover:bg-[var(--menu-hover-bg)] hover:text-[var(--menu-glow)] cursor-pointer svelte-t6isn6"><!> <span class="text-sm font-medium"> </span></li>`),GT=de(`<ul class="premium-submenu fixed min-w-[140px] max-h-[70vh] z-[9999] rounded-lg shadow-2xl border border-[var(--menu-btn-border)] overflow-y-auto
                bg-[var(--menu-bg)] backdrop-blur-sm transition-all duration-300 ease-in-out svelte-t6isn6"></ul>`),YT=(o,e,t)=>e(n(t).key),UT=de(`<li class="px-4 py-3 flex flex-row items-center gap-3 transition-all duration-200 ease-in-out
                 text-[var(--menu-text)] hover:bg-[var(--menu-hover-bg)] hover:text-[var(--menu-glow)] cursor-pointer svelte-t6isn6"><!> <span class="text-sm font-medium"> </span></li>`),KT=de(`<ul class="premium-submenu fixed min-w-[140px] max-h-[70vh] z-[9999] rounded-lg shadow-2xl border border-[var(--menu-btn-border)] overflow-y-auto
              bg-[var(--menu-bg)] backdrop-blur-sm transition-all duration-300 ease-in-out svelte-t6isn6"></ul>`),ZT=de("<!> <!>",1),XT=o=>o.stopPropagation(),JT=de("<option> </option>"),QT=de(`<select title="Font size"><option>8</option><option>10</option><option>11</option><option>12</option><option>14</option><option>16</option><option>18</option><option>20</option><option>22</option><option>24</option><option>32</option><option>40</option><option>52</option></select> <button title="Bold"><span class="text-xs font-bold">B</span></button> <div class="flex items-center gap-1 svelte-t6isn6"><div class="flex items-center gap-1"><button class="w-6 h-6 rounded-md border border-gray-400 dark:border-gray-600
                       cursor-pointer hover:scale-105 transition-transform touch-manipulation flex items-center justify-center svelte-t6isn6" title="Text color"><!></button> <button class="w-6 h-6 rounded-md border border-gray-400 dark:border-gray-600
                       cursor-pointer hover:scale-105 transition-transform touch-manipulation flex items-center justify-center svelte-t6isn6" title="Background color"><!></button></div> <select title="Font family"></select></div>`,1),eA=de(`<button class="w-6 h-6 rounded-md border border-gray-400 dark:border-gray-600
                 cursor-pointer hover:scale-105 transition-transform touch-manipulation svelte-t6isn6" title="Choose color"></button> <select title="Line thickness"><option>1px</option><option>2px</option><option>3px</option><option>4px</option><option>5px</option><option>6px</option><option>7px</option><option>8px</option></select> <select title="Line style"><option>Line</option><option>Dash</option><option>Dot</option></select>`,1),tA=de('<div title="Drag to move"><div class="flex flex-col gap-0.5"><div class="flex gap-0.5"><div></div> <div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div></div> <div class="flex gap-0.5"><div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div> <div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div></div> <div class="flex gap-0.5"><div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div> <div class="w-0.5 h-0.5 bg-gray-400 dark:bg-gray-500 rounded-full"></div></div></div></div> <!>',1),oA=(o,e)=>{var t;return e(((t=o.target)==null?void 0:t.value)||"24")},sA=de('<div class="flex items-center gap-3 svelte-t6isn6"><div class="flex items-center justify-center w-8 h-8 text-lg"> </div> <div class="flex items-center gap-1 sm:gap-2 min-w-[100px] sm:min-w-[120px]"><span class="text-xs text-gray-500 dark:text-gray-400 hidden sm:inline">Size:</span> <input type="range" min="16" max="64" class="flex-1 h-2 sm:h-1 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer slider touch-manipulation svelte-t6isn6"> <span class="text-xs text-gray-500 dark:text-gray-400 w-6 text-right"> </span></div></div>'),nA=(o,e)=>{e()},iA=de('<button title="Fibonacci Settings"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></button>'),rA=(o,e)=>b(e,!n(e)),aA=o=>o.stopPropagation(),lA=(o,e,t)=>{e(),b(t,!1)},cA=(o,e,t)=>{e(),b(t,!1)},dA=(o,e,t)=>{e(),b(t,!1)},uA=de("<button>Paste</button>"),pA=de("<div><button>Clone</button> <button>Copy</button> <!></div>"),vA=(o,e,t,s)=>{e(),b(t,!1),b(s,null)},fA=de('<div><!> <!> <div class="relative svelte-t6isn6"><button title="More" aria-haspopup="true"><svg viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="5" r="2"></circle><circle cx="12" cy="12" r="2"></circle><circle cx="12" cy="19" r="2"></circle></svg></button> <!></div> <button title="Delete"><svg fill="none" stroke="currentColor" vector-effect="non-scaling-stroke" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>'),gA=de('<div class="fixed z-[200001] bg-red-500 hover:bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center cursor-pointer shadow-lg transition-all duration-200" title="Delete selected drawing"><svg class="w-4 h-4" fill="none" stroke="currentColor" vector-effect="non-scaling-stroke" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></div>'),mA=de('<div class="drawbar-wrapper svelte-t6isn6"><div class="drawbar-container h-full box-border border-r border-l-0 transition-all duration-200 ease-in-out overflow-y-auto scrollbar-hidden svelte-t6isn6" style="background: var(--menu-bg); box-shadow: var(--menu-shadow); backdrop-filter: blur(18px) saturate(170%); -webkit-backdrop-filter: blur(18px) saturate(170%); border-left: none;"><!> <!> <!> <!> <!> <!> <!> <!></div> <!></div> <!> <!> <!> <!>  <!> <!>',1);function hA(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(Qe,"$chart",t),i=()=>ir(Lt,"$undoRedoState",t),r=()=>ir(qe,"$save",t),a=(X,Le=Pv,nt=Pv,et,ht,uo,ut)=>{let Jt=Yd(()=>rm(et==null?void 0:et(),"")),fo=Yd(()=>rm(ht==null?void 0:ht(),()=>[],!0)),lo=Yd(()=>rm(uo==null?void 0:uo(),!1)),so=Yd(()=>rm(ut==null?void 0:ut(),!1));var ko=BT(),ts=g(ko);ts.__click=function(...ds){var Cs;(Cs=Le())==null||Cs.apply(this,ds)};var Xn=u(g(ts),2),ro=We(()=>ar(nt())),Do=We(()=>n(Jt)==="mode"&&n(p)===n(v));Ru(Xn,{get name(){return n(ro)},get active(){return n(Do)},size:24,class:"relative z-10 transition-all duration-200 group-hover:scale-[1.05]"});var Ao=u(Xn,2);Se(Ao,()=>n(Jt)==="mode"&&n(p)===n(v)||n(Jt)&&n(Jt)===n(d),ds=>{var Cs=ET();O(ds,Cs)}),f(ts);var ss=u(ts,2);Se(ss,()=>n(fo).length>0,ds=>{var Cs=zT(),ns=_t(Cs);ns.__click=[$T,es,Jt];var Js=g(ns);f(ns);var Nn=u(ns,2);Se(Nn,()=>n(Jt)===n(d),ui=>{var Ms=jT();O(ui,Ms)}),we(()=>Sn(Js,"rotate-180",n(d)===n(Jt))),O(ds,Cs)}),f(ko),we(()=>{St(ko,"style",`margin-top: ${(n(lo)||n(so)?"12px":"")??""}`),St(ts,"title",n(Jt)||nt()),St(ts,"aria-label",n(Jt)||nt()),Sn(ts,"active-btn",n(Jt)==="mode"&&n(p)===n(v)||n(Jt)&&n(Jt)===n(d))}),O(X,ko)},l=X=>{var Le=NT();O(X,Le)};let d=oe(""),v=oe("weakMagnet"),p=oe("normal"),_=oe(!1),y=oe(!0),w=j([]),k=oe(""),S=oe(null),L=oe(null),T=oe(!1),P=oe(!1),A=oe(null),F=j({thickness:"1",style:"solid",color:"#1677FF",opacity:100}),B=oe(!1),R=j({x:0,y:0}),N=oe(null),$=oe(0),V=oe(null),U=oe(!1),G=oe(!1),Z=oe(null),le=0,se=oe(!1),ie=oe("line"),Y=oe("#1677FF"),K=oe(100),Q=oe(!1),q=oe(j({x:0,y:0})),ce=oe(j({x:0,y:0}));const _e="system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif";let me=j({fontSize:"32",fontWeight:"bold",textColor:"#FFFFFF",backgroundColor:"#A00000",fontFamily:_e}),Pe=oe(100),ze=oe(20),he=oe(!1),De=oe(void 0);function ge(X){const Le=X.replace("#",""),nt=parseInt(Le.slice(0,2),16),et=parseInt(Le.slice(2,4),16),ht=parseInt(Le.slice(4,6),16);return{r:nt,g:et,b:ht}}function be(X){if(!X||typeof X!="string"||!X.startsWith("#"))return"#000000";const Le=X.length===9?X.slice(0,7):X,{r:nt,g:et,b:ht}=ge(Le);return .2126*nt+.7152*et+.0722*ht>128?"#000000":"#FFFFFF"}const $e=[{label:"System",value:_e},{label:"Arial",value:"Arial, Helvetica, sans-serif"},{label:"Helvetica",value:"'Helvetica Neue', Arial, sans-serif"},{label:"Segoe UI",value:"'Segoe UI', Tahoma, Geneva, sans-serif"},{label:"Roboto",value:"Roboto, system-ui, -apple-system, 'Segoe UI', Arial, sans-serif"},{label:"Times New Roman",value:"'Times New Roman', Times, serif"},{label:"Georgia",value:"Georgia, 'Times New Roman', serif"},{label:"Garamond",value:"Garamond, 'Times New Roman', serif"},{label:"Palatino",value:"'Palatino Linotype', 'Book Antiqua', Palatino, serif"},{label:"Verdana",value:"Verdana, Geneva, sans-serif"},{label:"Tahoma",value:"Tahoma, Geneva, sans-serif"},{label:"Trebuchet MS",value:"'Trebuchet MS', 'Lucida Grande', sans-serif"},{label:"Impact",value:"Impact, Charcoal, sans-serif"},{label:"Lucida Sans",value:"'Lucida Sans Unicode', 'Lucida Grande', sans-serif"},{label:"Century Gothic",value:"'Century Gothic', AppleGothic, sans-serif"},{label:"Optima",value:"Optima, 'Segoe', 'Segoe UI', sans-serif"},{label:"Comic Sans MS",value:"'Comic Sans MS', 'Comic Sans', cursive, sans-serif"},{label:"Avenir",value:"'Avenir Next', Avenir, sans-serif"},{label:"Futura",value:"Futura, 'Trebuchet MS', Arial, sans-serif"},{label:"Menlo",value:"Menlo, Monaco, Consolas, 'Courier New', monospace"},{label:"Consolas",value:"Consolas, 'Liberation Mono', Menlo, Monaco, monospace"},{label:"Courier New",value:"'Courier New', Courier, monospace"}];let Ve=oe(!1),Ce=oe(j([{value:0,visible:!0,color:"#FF6B6B"},{value:.236,visible:!0,color:"#4ECDC4"},{value:.382,visible:!0,color:"#45B7D1"},{value:.5,visible:!0,color:"#96CEB4"},{value:.618,visible:!0,color:"#FFEAA7"},{value:1,visible:!0,color:"#98D8C8"},{value:1.618,visible:!0,color:"#85C1E9"},{value:.786,visible:!1,color:"#DDA0DD"},{value:1.272,visible:!1,color:"#F7DC6F"},{value:1.414,visible:!1,color:"#BB8FCE"},{value:2,visible:!1,color:"#FFB6C1"},{value:2.272,visible:!1,color:"#98FB98"},{value:2.414,visible:!1,color:"#F0E68C"},{value:2.618,visible:!1,color:"#F8C471"},{value:3,visible:!1,color:"#DEB887"},{value:3.618,visible:!1,color:"#CD853F"},{value:4,visible:!1,color:"#D2691E"},{value:4.236,visible:!1,color:"#A0522D"},{value:4.272,visible:!1,color:"#8B4513"},{value:4.618,visible:!1,color:"#654321"}])),Je=oe(j([{value:0,visible:!0,color:"#FF6B6B"},{value:.236,visible:!0,color:"#4ECDC4"},{value:.382,visible:!0,color:"#45B7D1"},{value:.5,visible:!0,color:"#96CEB4"},{value:.618,visible:!0,color:"#FFEAA7"},{value:1,visible:!0,color:"#98D8C8"},{value:1.618,visible:!0,color:"#85C1E9"},{value:.786,visible:!1,color:"#DDA0DD"},{value:1.272,visible:!1,color:"#F7DC6F"},{value:1.414,visible:!1,color:"#BB8FCE"},{value:2,visible:!1,color:"#FFB6C1"},{value:2.272,visible:!1,color:"#98FB98"},{value:2.414,visible:!1,color:"#F0E68C"},{value:2.618,visible:!1,color:"#F8C471"},{value:3,visible:!1,color:"#DEB887"},{value:3.618,visible:!1,color:"#CD853F"},{value:4,visible:!1,color:"#D2691E"},{value:4.236,visible:!1,color:"#A0522D"},{value:4.272,visible:!1,color:"#8B4513"},{value:4.618,visible:!1,color:"#654321"}])),ye=null;function Ae(){var nt;ye||(ye=document.querySelector(".chart-container")||document.querySelector("[data-chart-container]")||document.querySelector(".kline-chart")||document.querySelector("#chart")||((nt=document.querySelector("canvas"))==null?void 0:nt.parentElement)||document.body);const X=ye==null?void 0:ye.getBoundingClientRect();if(!X)return{left:0,top:0,width:window.innerWidth,height:window.innerHeight};const Le=10;return{left:X.left+Le,top:X.top+Le,width:X.width-Le*2,height:X.height-Le*2}}function ee(X){try{const Le=Ae();ye&&(ye.style.cursor=X??"default")}catch{}}function xe(X){var Li,Dr,Xr,Ki,Ge;if(!X||!X.points||X.points.length===0||!s())return null;const Le=X.points[0],nt=X.paneId||"candle_pane",et=(Li=s())==null?void 0:Li.convertToPixel(Le,{paneId:nt}),ht=(ye||document.body).getBoundingClientRect();if(!et||typeof et.x!="number"||typeof et.y!="number"||!ht)return null;const uo=Ae(),ut=window.innerWidth<=768,Jt=ut?Math.min(300,window.innerWidth-40):300,fo=ut?48:60,lo=ut?32:24,so=(Dr=X.extendData)!=null&&Dr.editing?sf.getEditorRect():null,ko=so?so.width:((Xr=X.extendData)==null?void 0:Xr.boxWidth)??160,ts=so?so.height:((Ki=X.extendData)==null?void 0:Ki.boxHeight)??Math.round((((Ge=X.extendData)==null?void 0:Ge.fontSize)??32)*1.4)+8,Xn=et.x-ko/2,ro=et.x+ko/2,Do=et.y-Math.round(ts/2),Ao=so?so.left:ht.left+Xn,ss=so?so.right:ht.left+ro,ds=so?so.top:ht.top+Do,Cs=so?so.bottom:ds+ts;let ns=[{x:ss+lo,y:ds},{x:Ao,y:Cs+lo},{x:Ao-Jt-lo,y:ds},{x:Ao,y:ds-fo-lo}];ut&&(ns=[{x:Ao,y:Cs+lo},{x:Ao,y:ds-fo-lo},{x:ss+lo,y:ds},{x:Ao-Jt-lo,y:ds}]);const Js=ht.left+(ut?4:8),Nn=ht.top+(ut?4:8),ui=ht.left+uo.width-Jt-(ut?4:8),Ms=ht.top+uo.height-fo-(ut?4:8);for(const at of ns){let So=Math.max(Js,Math.min(at.x,ui)),qt=Math.max(Nn,Math.min(at.y,Ms));const Io=qt<Cs&&qt+fo>ds,us=So<ss&&So+Jt>Ao;if(!(Io&&us))return{x:So,y:qt}}if(ut){let at=Math.max(Js,Math.min(Ao,ui)),So=Math.max(Nn,Math.min(Cs+lo,Ms));return{x:at,y:So}}else{let at=Math.max(Js,Math.min(ss+lo,ui)),So=Math.max(Nn,Math.min(ds,Ms));return{x:at,y:So}}}function ke(X){function Le(et){const ht=X.scrollTop>0,uo=X.scrollTop<X.scrollHeight-X.clientHeight;(et.deltaY<0&&!ht||et.deltaY>0&&!uo)&&et.preventDefault(),et.stopPropagation()}function nt(et){et.preventDefault(),et.stopPropagation()}return X.addEventListener("wheel",Le,{passive:!1,capture:!0}),X.addEventListener("touchmove",nt,{passive:!1,capture:!0}),{destroy(){X.removeEventListener("wheel",Le,{capture:!0}),X.removeEventListener("touchmove",nt,{capture:!0})}}}function He(){var X,Le;if(n(P)&&n(A)&&n(N)&&!(n(A).name==="text"&&((X=n(A).extendData)!=null&&X.editing))&&n(A).points&&n(A).points.length>0){const nt=n(A).points[0],et=(Le=s())==null?void 0:Le.convertToPixel(nt,{paneId:"candle_pane"});if(et&&typeof et=="object"&&"x"in et&&"y"in et&&et.x!==void 0&&et.y!==void 0){const ut=Math.max(10,Math.min(et.x-80,window.innerWidth-300)),Jt=Math.max(10,Math.min(et.y-30,window.innerHeight-200));b(N,j({x:ut,y:Jt}))}}n(se)&&b(ce,j({x:Math.max(10,Math.min(n(ce).x,window.innerWidth-320)),y:Math.max(10,Math.min(n(ce).y,window.innerHeight-400))}))}function Ie(){if(typeof localStorage<"u"){const X=localStorage.getItem("contextMenuPosition");if(X)try{b(Z,j(JSON.parse(X)))}catch(Le){console.log("Error loading saved position:",Le)}}}function ne(X){typeof localStorage<"u"&&(localStorage.setItem("contextMenuPosition",JSON.stringify(X)),b(Z,j(X)))}const J="drawing_tools",qe=Fa("save"),ft=Fa("ctx"),Qe=Fa("chart"),Oe=Id({}),ct=Fa("drawingManager"),Lt=Dc.getState();let It=oe(!1),zt=oe(!1);Wi(()=>{const X=i();b(It,X.undoStack.length>0),b(zt,X.redoStack.length>0)}),Wi(()=>{s()&&Dc.init({chart:s(),saveStore:qe,overlaysStore:Oe})});function pt(X){const Le=r().symbol;return`${Le.shortName??Le.name??Le.ticker}_${r().period.timeframe}_${X}`}let Mo={};const Zt=j([{key:"single-line",icon:"segment",list:[{key:"segment",text:"segment"},{key:"arrow",text:"arrow"},{key:"rayLine",text:"ray_line"},{key:"straightLine",text:"straight_line"},{key:"priceLine",text:"price_line"},{key:"horizontalStraightLine",text:"horizontal_straight_line"},{key:"horizontalRayLine",text:"horizontal_ray_line"},{key:"horizontalSegment",text:"horizontal_segment"},{key:"verticalStraightLine",text:"vertical_straight_line"},{key:"verticalRayLine",text:"vertical_ray_line"},{key:"verticalSegment",text:"vertical_segment"}]},{key:"more-line",icon:"priceChannelLine",list:[{key:"priceChannelLine",text:"price_channel_line"},{key:"parallelStraightLine",text:"parallel_straight_line"}]},{key:"polygon",icon:"rect",list:[{key:"circle",text:"circle"},{key:"rect",text:"rect"},{key:"parallelogram",text:"parallelogram"},{key:"triangle",text:"triangle"}]},{key:"fibonacci",icon:"fibonacciSegment",list:[{key:"fibonacciSegment",text:"fibonacci_segment"},{key:"fibonacciCircle",text:"fibonacci_circle"},{key:"fibonacciSpiral",text:"fibonacci_spiral"},{key:"fibonacciSpeedResistanceFan",text:"fibonacci_speed_resistance_fan"},{key:"fibonacciExtension",text:"fibonacci_extension"},{key:"gannBox",text:"gann_box"}]},{key:"wave",icon:"xabcd",list:[{key:"xabcd",text:"xabcd"},{key:"abcd",text:"abcd"},{key:"threeWaves",text:"three_waves"},{key:"fiveWaves",text:"five_waves"},{key:"eightWaves",text:"eight_waves"},{key:"anyWaves",text:"any_waves"}]},{key:"emoji",icon:"emoji",list:[]},{key:"text",icon:"text",list:[]}]),bs=j([{key:"weakMagnet",text:"weakMagnet"},{key:"strongMagnet",text:"strongMagnet"}]);function es(X){n(d)==X?b(d,""):b(d,j(X))}function rn(X){var uo;let Le=!1;const nt=Z7[X.name]??{},et={groupId:J,onDrawEnd:ut=>{nt.onDrawEnd&&nt.onDrawEnd(ut),Is(ut.overlay);const Jt=pt(ut.overlay.id);if(Dc.recordAddOverlay(ut.overlay.id,ut.overlay,Jt),n(S)===ut.overlay.id&&b(S,null),ut.overlay.name==="text")try{b(A,j(ut.overlay)),b(k,j(ut.overlay.id));const fo=xe(ut.overlay),lo=n(Z)||fo;lo&&(b(N,j({...lo})),b(L,j({x:lo.x,y:lo.y})),b(P,!0),b(T,!1)),s()&&sf.startEditing(s(),ut.overlay)}catch{}return!0},onPressedMoving:ut=>{var Jt;nt.onPressedMoving&&nt.onPressedMoving(ut),Le=!0;try{if(s()&&((Jt=ut.overlay)!=null&&Jt.id)&&!Mo[ut.overlay.id]){const fo=s().getOverlays({id:ut.overlay.id});fo&&fo[0]&&(Mo[ut.overlay.id]=JSON.parse(JSON.stringify(fo[0])))}}catch{}return!1},onPressedMoveEnd:ut=>{var Jt;if(!Le)return!0;Le=!1,Is(ut.overlay);try{const fo=Mo[ut.overlay.id],lo=ut.overlay;if(fo&&lo){const so=pt(ut.overlay.id);Dc.recordModifyOverlay(ut.overlay.id,fo,lo,so)}}catch{}if(delete Mo[ut.overlay.id],n(k)===ut.overlay.id&&ut.overlay.points&&ut.overlay.points.length>0){const fo=ut.overlay.points[0],lo=ut.overlay.paneId||"candle_pane",so=(Jt=s())==null?void 0:Jt.convertToPixel(fo,{paneId:lo});so&&typeof so=="object"&&"x"in so&&"y"in so&&so.x!==void 0&&so.y!==void 0&&b(L,j({x:so.x-80,y:so.y-30}))}return!0},onSelected:ut=>{var Jt;if(nt.onSelected&&nt.onSelected(ut),le=Date.now(),b(k,j(ut.overlay.id)),b(A,j(ut.overlay)),(Jt=ut.overlay.styles)!=null&&Jt.line){const fo=ut.overlay.styles.line;F.thickness=String(fo.size||2),F.color=fo.color||"#1677FF",F.style=fo.style===Ee.Dashed?"dashed":"solid"}if(ut.overlay.points&&ut.overlay.points.length>0){const fo=xe(ut.overlay),lo=n(Z)||fo;if(lo&&(b(N,j({...lo})),b(L,j({x:lo.x,y:lo.y})),b(P,!0),b(T,!1),ut.overlay.styles&&ut.overlay.styles.line))if(F.thickness=String(ut.overlay.styles.line.size||1),F.color=ut.overlay.styles.line.color||"#1677FF",ut.overlay.styles.line.style===Ee.Dashed){const so=ut.overlay.styles.line.dashedValue;so&&so[0]===2&&so[1]===8?F.style="dotted":F.style="dashed"}else F.style="solid"}return!0},onDeselected:ut=>(nt.onDeselected&&nt.onDeselected(ut),b(k,""),b(T,!1),b(P,!1),b(G,!1),b(L,null),b(A,null),!0),onRemoved:ut=>{nt.onRemoved&&nt.onRemoved(ut),Oe.update(fo=>(delete fo[pt(ut.overlay.id)],fo));const Jt=ct.get();if(Jt)try{Jt.removeDrawing(ut.overlay.id),console.log("🗑️ Removed drawing from DrawingManager:",ut.overlay.id),Ou()}catch(fo){console.error("Error removing drawing from DrawingManager:",fo)}return!0}},ht=(uo=s())==null?void 0:uo.createOverlay(Rt.mergeWith({},et,X,(ut,Jt,fo)=>{if(fo.startsWith("on")&&ut&&Jt)return lo=>(Jt(lo),ut(lo))}));return ht&&(Array.isArray(ht)?(w.push(...ht),ht.length>0&&b(S,j(ht[0]))):(w.push(ht),b(S,j(ht)))),ht}function wr(X){X==="text"&&ee("text");let Le=Ee.Solid,nt=[8,4];F.style==="dashed"?(Le=Ee.Dashed,nt=[8,4]):F.style==="dotted"&&(Le=Ee.Dashed,nt=[2,6]);const ht={line:{size:Number(F.thickness)||1,color:F.color,style:Le,dashedValue:nt},text:{color:"#FFFFFF",backgroundColor:"#A0000020",borderColor:"#1677FF"},polygon:{color:F.color+"20"}},uo={origin:"user"};X==="text"&&(uo.text=Kl,uo.fontSize=32,uo.fontWeight="bold",uo.textColor="#FFFFFF",uo.backgroundColor="#A0000020",uo.fontFamily=_e),rn({name:X,visible:n(y),lock:n(_),mode:n(p),styles:ht,extendData:uo})}function rr(X,Le){Zt[X].icon=Le,wr(Le),b(d,"")}function ar(X){return X==="priceChannelLine"?"priceChannelLineNew":X}function jr(){var Le;let X=n(v);n(p)!=="normal"&&(X="normal"),b(p,j(X)),(Le=s())==null||Le.overrideOverlay({mode:X})}function ii(X){var Le;b(v,j(X)),b(p,j(X)),b(d,""),(Le=s())==null||Le.overrideOverlay({mode:X})}function Xa(X){let nt=0;return X==="crosshair"?nt=0:Zt.find(et=>et.key===X)?nt=1+Zt.findIndex(et=>et.key===X):X==="ruler"?nt=1+Zt.length+1:X==="mode"?nt=1+Zt.length+2:X==="lock"?nt=1+Zt.length+3:X==="visible"?nt=1+Zt.length+4:X==="remove"&&(nt=1+Zt.length+5),nt*52}function Ja(){var X;b(_,!n(_)),(X=s())==null||X.overrideOverlay({lock:n(_)})}function Va(){var X;b(y,!n(y)),(X=s())==null||X.overrideOverlay({visible:n(y)})}function Wa(){var X,Le;if(b(p,"normal"),b(v,"weakMagnet"),ee(null),n(S)){(X=s())==null||X.removeOverlay({id:n(S)});const nt=w.indexOf(n(S));nt>-1&&w.splice(nt,1),b(S,null)}(Le=s())==null||Le.overrideOverlay({mode:O6.Normal}),b(d,""),b(P,!1),b(T,!1),b(G,!1),b(L,null),b(A,null),b(k,"")}function Qa(){var nt;let X={groupId:J},Le=null;if(n(k))X.id=n(k),Le=n(A);else if(w.length>0){const et=w.pop();if(X.id=et,et&&s()){const ht=s().getOverlays({id:et});ht&&ht.length>0&&(Le=ht[0])}}if(Le){const et=pt(Le.id);Dc.recordRemoveOverlay(Le.id,Le,et)}(nt=s())==null||nt.removeOverlay(X),b(P,!1),b(T,!1),b(G,!1),b(L,null),b(A,null)}function qa(){if(!n(A)||!s())return;const X=pt(n(A).id),Le=JSON.parse(JSON.stringify(n(A))),nt=Number(F.thickness)||1;let et=Ee.Solid,ht=[8,4];F.style==="dashed"?(et=Ee.Dashed,ht=[8,4]):F.style==="dotted"&&(et=Ee.Dashed,ht=[2,6]);const uo=Math.round(F.opacity/100*255).toString(16).padStart(2,"0"),ut=F.color+uo,Jt={line:{size:nt,color:ut,style:et,dashedValue:ht},text:{color:"#FFFFFF",backgroundColor:"rgba(0, 100, 255, 0.7)",borderColor:"#FFFFFF"},polygon:{color:ut}};try{s().overrideOverlay({id:n(A).id,styles:Jt})}catch(fo){console.log("Error updating overlay styles:",fo)}Is({...n(A),styles:{...n(A).styles,...Jt}});try{const fo={...n(A),styles:{...n(A).styles,...Jt}};Dc.recordModifyOverlay(n(A).id,Le,fo,X)}catch{}}const Kl="Add text";function ll(){var Ao,ss,ds,Cs,ns,Js,Nn;if(!n(A)||!s()||n(A).name!=="text")return;const X=pt(n(A).id),Le=JSON.parse(JSON.stringify(n(A))),nt=Number(me.fontSize)||12,et=me.backgroundColor||"#A00000",ht=me.textColor||"#FFFFFF",uo=Math.round(n(ze)/100*255).toString(16).padStart(2,"0"),ut=Math.round(n(Pe)/100*255).toString(16).padStart(2,"0"),Jt=typeof et=="string"&&et.startsWith("#")&&et.length===7?`${et}${uo}`:et,fo=typeof ht=="string"&&ht.startsWith("#")&&ht.length===7?`${ht}${ut}`:ht,lo=((Ao=n(A).styles)==null?void 0:Ao.text)||{},so=lo.size??((ss=n(A).extendData)==null?void 0:ss.fontSize),ko=lo.weight??((ds=n(A).extendData)==null?void 0:ds.fontWeight),ts=lo.family??((Cs=n(A).extendData)==null?void 0:Cs.fontFamily),Xn=so!==nt||ko!==me.fontWeight||ts!==me.fontFamily,ro={...n(A).extendData||{},fontSize:nt,fontWeight:me.fontWeight,textColor:me.textColor,backgroundColor:Jt,fontFamily:me.fontFamily,...Xn?{boxWidth:0,boxHeight:0}:{}},Do={...n(A).styles||{},text:{...((ns=n(A).styles)==null?void 0:ns.text)||{},size:nt,color:fo,backgroundColor:Jt,family:me.fontFamily,weight:me.fontWeight,paddingLeft:8,paddingRight:8,paddingTop:4,paddingBottom:4,borderSize:0,borderColor:"transparent"},box:{...((Js=n(A).styles)==null?void 0:Js.box)||{},stroke:"#3b82f6",width:1,fill:"transparent"},handles:{...((Nn=n(A).styles)==null?void 0:Nn.handles)||{},size:6,fill:"#3b82f6",stroke:"#3b82f6"}};try{if(s().overrideOverlay({id:n(A).id,styles:Do,extendData:{...ro,textColor:ht,backgroundColor:Jt,textOpacity:n(Pe),textBgOpacity:n(ze)}}),(n(A).extendData||{}).editing)try{sf.updateEditorStyle(n(A))}catch{}}catch(ui){console.log("Error updating text overlay styles:",ui)}b(A,j({...n(A),styles:Do,extendData:ro})),Is(n(A));try{const ui=JSON.parse(JSON.stringify(n(A)));Dc.recordModifyOverlay(n(A).id,Le,ui,X)}catch{}}function Wr(X){var uo;b(B,!0),b($,j(Date.now()));const Le=X instanceof MouseEvent?X.clientX:X.touches[0].clientX,nt=X instanceof MouseEvent?X.clientY:X.touches[0].clientY,et=(uo=X.target.closest(".context-menu-container"))==null?void 0:uo.getBoundingClientRect();et?(R.x=Le-et.left,R.y=nt-et.top):n(N)&&(R.x=Le-n(N).x,R.y=nt-n(N).y);const ht=X;typeof ht.preventDefault=="function"&&ht.preventDefault(),typeof ht.stopPropagation=="function"&&ht.stopPropagation()}function Ca(X){if(n(B)&&n(N)){b($,j(Date.now()));const Le=X instanceof MouseEvent?X.clientX:X.touches[0].clientX,nt=X instanceof MouseEvent?X.clientY:X.touches[0].clientY,et=window.innerWidth<=768,ht=et?Math.min(250,window.innerWidth-40):300,uo=et?40:60,ut=et?5:10,Jt=ye==null?void 0:ye.getBoundingClientRect();let fo=Le-R.x,lo=nt-R.y;const so=((Jt==null?void 0:Jt.left)||0)+ut,ko=(Jt?Jt.right:window.innerWidth)-ht-ut,ts=((Jt==null?void 0:Jt.top)||0)+ut,Xn=(Jt?Jt.bottom:window.innerHeight)-uo-ut;n(N).x=Math.max(so,Math.min(fo,ko)),n(N).y=Math.max(ts,Math.min(lo,Xn))}}function vl(){n(B)&&n(N)&&ne(n(N)),b(B,!1),b($,j(Date.now()))}function ml(X){Ca(X)}function Sl(){vl()}function el(X){const Le=X.detail;n(ie)==="line"?(F.color=Le,qa()):n(ie)==="textColor"?(me.textColor=Le,ll()):n(ie)==="textBg"&&(me.backgroundColor=Le,ll())}function or(X){const Le=X.detail;n(ie)==="line"?(F.opacity=Le,b(K,j(Le)),qa()):n(ie)==="textColor"?(b(Pe,j(Le)),b(K,j(Le)),ll()):n(ie)==="textBg"&&(b(ze,j(Le)),b(K,j(Le)),ll())}function tc(){b(se,!1)}function pe(){const X=Dc.undo();console.log(X?"Undo successful":"Nothing to undo")}function rt(){const X=Dc.redo();console.log(X?"Redo successful":"Nothing to redo")}function Ft(X){(X.ctrlKey||X.metaKey)&&X.key==="z"&&!X.shiftKey?(X.preventDefault(),pe()):(X.ctrlKey||X.metaKey)&&X.key==="y"||(X.ctrlKey||X.metaKey)&&X.shiftKey&&X.key==="z"?(X.preventDefault(),rt()):(X.key==="Delete"||X.key==="Backspace")&&n(k)?(X.preventDefault(),Qa()):(X.ctrlKey||X.metaKey)&&X.key==="c"&&n(A)?(X.preventDefault(),xt()):(X.ctrlKey||X.metaKey)&&X.key==="v"&&n(V)&&(X.preventDefault(),eo(X))}function Qt(){if(!(!n(A)||!s())){b(U,!0);try{const X=JSON.parse(JSON.stringify(n(A))),Le=Date.now();X.id=`${n(A).name}_clone_${Le}`,X.points&&Array.isArray(X.points)&&(X.points=X.points.map(et=>et&&typeof et=="object"?{...et,timestamp:et.timestamp?et.timestamp+1e3*60*5:et.timestamp,value:et.value?et.value*1.002:et.value}:et));const nt=rn(X);if(nt){const et=Array.isArray(nt)?nt[0]:nt;if(et){const ht=pt(et);Dc.recordAddOverlay(et,X,ht),setTimeout(()=>{var ut,Jt;const uo=s().getOverlays({id:et})[0];if(uo){if(b(k,j(et)),b(A,j(uo)),(ut=uo.styles)!=null&&ut.line){const fo=uo.styles.line;F.thickness=String(fo.size||2),F.color=fo.color||"#1677FF",F.style=fo.style===Ee.Dashed?"dashed":"solid"}if(uo.points&&uo.points.length>0){const fo=uo.points[0],lo=(Jt=s())==null?void 0:Jt.convertToPixel(fo,{paneId:"candle_pane"});lo&&typeof lo=="object"&&"x"in lo&&"y"in lo&&lo.x!==void 0&&lo.y!==void 0&&(b(L,j({x:lo.x-80,y:lo.y-30})),n(Z)?b(N,j({...n(Z)})):b(N,j({x:lo.x-80,y:lo.y-30})),b(P,!0),b(T,!1),b(G,!1))}}},100)}console.log("Overlay cloned successfully")}}catch(X){console.error("Error cloning overlay:",X)}finally{b(U,!1)}}}function xt(){if(n(A))try{b(V,j(JSON.parse(JSON.stringify(n(A))))),console.log("Overlay copied to clipboard"),b(P,!1),setTimeout(()=>{console.log("Copy operation completed")},100)}catch(X){console.error("Error copying overlay:",X)}}function eo(X){if(!(!n(V)||!s()))try{const Le=JSON.parse(JSON.stringify(n(V))),nt=Date.now();Le.id=`${n(V).name}_paste_${nt}`,X&&Le.points&&Array.isArray(Le.points)&&(Le.points=Le.points.map(ht=>ht&&typeof ht=="object"?{...ht,timestamp:ht.timestamp?ht.timestamp+1e3*60*10:ht.timestamp,value:ht.value?ht.value*1.005:ht.value}:ht));const et=rn(Le);if(et){const ht=Array.isArray(et)?et[0]:et;if(ht){const uo=pt(ht);Dc.recordAddOverlay(ht,Le,uo),setTimeout(()=>{var Jt,fo;const ut=s().getOverlays({id:ht})[0];if(ut){if(b(k,j(ht)),b(A,j(ut)),(Jt=ut.styles)!=null&&Jt.line){const lo=ut.styles.line;F.thickness=String(lo.size||2),F.color=lo.color||"#1677FF",F.style=lo.style===Ee.Dashed?"dashed":"solid"}if(ut.points&&ut.points.length>0){const lo=ut.points[0],so=(fo=s())==null?void 0:fo.convertToPixel(lo,{paneId:"candle_pane"});so&&typeof so=="object"&&"x"in so&&"y"in so&&so.x!==void 0&&so.y!==void 0&&(b(L,j({x:so.x-80,y:so.y-30})),n(Z)?b(N,j({...n(Z)})):b(N,j({x:so.x-80,y:so.y-30})),b(P,!0),b(T,!1),b(G,!1))}}},100)}console.log("Overlay pasted successfully")}}catch(Le){console.error("Error pasting overlay:",Le)}}function Is(X){if(X.groupId!==J)return;const Le=["extendData","groupId","id","lock","mode","name","paneId","points","styles","totalStep","visible","zLevel"],nt=pt(X.id);Oe.update(ht=>(ht[nt]=Object.fromEntries(Le.map(uo=>[uo,X[uo]])),ht));const et=ct.get();if(et&&X.points&&X.points.length>0)try{const ht=Hp(r().symbol),uo={id:X.id,symbolKey:ht,type:X.name||"unknown",points:X.points.map(ut=>({time:ut.timestamp||ut.t||0,price:ut.value||ut.p||0})),styles:X.styles||{},...X.extendData?{extendData:X.extendData}:{},locked:!!X.lock,visible:X.visible!==!1};et.addDrawing(uo),Ou()}catch(ht){console.error("Error syncing overlay to DrawingManager:",ht)}}function Po(){if(b(Q,!n(Q)),n(Q)){const X=Ae();b(q,j({x:X.left+60,y:X.top+100}))}}function Ze(X){const{emoji:Le}=X.detail;console.log("Selected emoji:",Le),b(Q,!1),rn({name:"emoji",visible:n(y),lock:n(_),mode:n(p),extendData:{emoji:Le,size:24},styles:{box:{enabled:!1,stroke:"#3b82f6",width:1,fill:"transparent"},handles:{size:6,fill:"#3b82f6",stroke:"#3b82f6"}}})}function Ke(X){if(!n(A)||n(A).name!=="emoji")return;const Le=pt(n(A).id),nt=JSON.parse(JSON.stringify(n(A))),et=parseInt(X);if(!(isNaN(et)||et<16||et>64)&&(n(A).extendData&&(n(A).extendData.size=et),s()&&n(A).id)){s().overrideOverlay({id:n(A).id,extendData:n(A).extendData}),Is(n(A));try{const ht=JSON.parse(JSON.stringify(n(A)));Dc.recordModifyOverlay(n(A).id,nt,ht,Le)}catch{}}}function ps(){var X,Le;if(((X=n(A))==null?void 0:X.name)==="fibonacciSegment"){const nt=((Le=n(A).extendData)==null?void 0:Le.fibonacciLevels)||n(A).fibonacciLevels;nt&&b(Ce,j([...nt])),b(Je,j([...n(Ce)])),b(Ve,!0)}}function pn(){b(Ce,j([{value:0,visible:!0,color:"#FF6B6B"},{value:.236,visible:!0,color:"#4ECDC4"},{value:.382,visible:!0,color:"#45B7D1"},{value:.5,visible:!0,color:"#96CEB4"},{value:.618,visible:!0,color:"#FFEAA7"},{value:.786,visible:!0,color:"#DDA0DD"},{value:1,visible:!0,color:"#98D8C8"},{value:1.272,visible:!0,color:"#F7DC6F"},{value:1.414,visible:!0,color:"#BB8FCE"},{value:1.618,visible:!0,color:"#85C1E9"},{value:2.618,visible:!0,color:"#F8C471"}])),mr()}function Jo(){mr(),b(Ve,!1)}function ti(){b(Ce,j([...n(Je)])),b(Ve,!1)}function mr(){if(!n(A)||n(A).name!=="fibonacciSegment"||!s())return;const X=pt(n(A).id),Le=JSON.parse(JSON.stringify(n(A)));s().overrideOverlay({id:n(A).id,extendData:{...n(A).extendData,fibonacciLevels:[...n(Ce)]}}),n(A).fibonacciLevels=[...n(Ce)],Is(n(A));try{const nt=JSON.parse(JSON.stringify(n(A)));Dc.recordModifyOverlay(n(A).id,Le,nt,X)}catch{}}function sa(X,Le,nt){X>=0&&X<n(Ce).length&&(n(Ce)[X]={...n(Ce)[X],[Le]:nt},mr())}Cc(ft,X=>X.clickChart).subscribe(()=>{b(d,""),Date.now()-le>150&&!n(B)&&!n(k)&&!n(A)&&(b(P,!1),b(T,!1),b(G,!1),b(L,null))}),Rd(()=>{if(Ie(),typeof document<"u"&&(document.addEventListener("mousemove",Ca),document.addEventListener("mouseup",vl),document.addEventListener("touchmove",ml,{passive:!1}),document.addEventListener("touchend",Sl),document.addEventListener("touchcancel",Sl)),typeof window<"u"){window.addEventListener("resize",He);const X=Le=>{if(s()&&n(A)&&n(A).name==="text"){const nt=xe(n(A)),et=n(Z)||nt;et&&(b(N,j({...et})),b(L,j({x:et.x,y:et.y})),b(P,!0),b(T,!1)),sf.startEditing(s(),n(A))}};window.addEventListener("dblclick",X)}}),Rd(()=>{typeof document<"u"&&document.addEventListener("keydown",Ft)});function wt(){if(!n(De))return;const{scrollHeight:X,clientHeight:Le,scrollTop:nt}=n(De),et=X>Le,ht=nt+Le>=X-5;b(he,j(et&&!ht))}function to(X){if(X&&(X.preventDefault(),X.stopPropagation()),!n(De))return;const{scrollTop:Le,clientHeight:nt,scrollHeight:et}=n(De),ht=nt*.7,uo=Math.min(Le+ht,et-nt);n(De).scrollTo({top:uo,behavior:"smooth"})}Rd(()=>{wt();const X=()=>{wt()},Le=()=>{wt()};return n(De)&&n(De).addEventListener("scroll",X),typeof window<"u"&&window.addEventListener("resize",Le),setTimeout(wt,500),()=>{n(De)&&n(De).removeEventListener("scroll",X),typeof window<"u"&&window.removeEventListener("resize",Le)}}),yp(()=>{typeof document<"u"&&(document.removeEventListener("mousemove",Ca),document.removeEventListener("mouseup",vl),document.removeEventListener("keydown",Ft),document.removeEventListener("touchmove",ml),document.removeEventListener("touchend",Sl),document.removeEventListener("touchcancel",Sl)),typeof window<"u"&&window.removeEventListener("resize",He)});function mt(X){var Le;try{if(le=Date.now(),b(k,j(X.id)),b(A,j(X)),(Le=X.styles)!=null&&Le.line){const nt=X.styles.line;F.thickness=String(nt.size||2),F.color=nt.color||"#1677FF",F.style=nt.style===Ee.Dashed?"dashed":"solid"}if(X.points&&X.points.length>0){const nt=xe(X),et=n(Z)||nt;et&&(b(N,j({...et})),b(L,j({x:et.x,y:et.y})),b(P,!0),b(T,!1))}}catch(nt){console.warn("externalSelectOverlay failed:",nt)}}function Wt(X){var Le;try{(n(k)===X.id||((Le=n(A))==null?void 0:Le.id)===X.id)&&(b(k,""),b(T,!1),b(P,!1),b(G,!1),b(L,null),b(A,null))}catch(nt){console.warn("externalDeselectOverlay failed:",nt)}}function vt(X){try{Is(X)}catch(Le){console.warn("externalSyncOverlay failed:",Le)}}function $t(X){try{n(k)===X&&(b(k,""),b(T,!1),b(P,!1),b(G,!1),b(L,null),b(A,null))}catch(Le){console.warn("externalRemoved failed:",Le)}}function zo(X={}){wr("text"),rn({name:"text",visible:n(y),lock:n(_),mode:n(p),styles:{text:{color:"#FFFFFF",backgroundColor:"#A0000020",borderColor:"#1677FF",size:X.fontSize??32,weight:X.fontWeight??"bold",family:X.fontFamily??_e}},extendData:{text:X.text??Kl,fontSize:X.fontSize??32,fontWeight:X.fontWeight??"bold",textColor:X.textColor??"#FFFFFF",backgroundColor:X.backgroundColor??"#A0000020",fontFamily:X.fontFamily??_e}})}function bo(X,Le){s()&&s().overrideOverlay({id:X,...Le})}function xo(X){s()&&s().removeOverlay({id:X})}function Zo(X){b(k,j(X||""))}function os(X){var nt;if(!s())return;const Le=(nt=s().getOverlays({id:X}))==null?void 0:nt[0];Le&&Le.name==="text"&&sf.startEditing(s(),Le)}function ri(X){}var vn=mA(),sr=_t(vn),Ko=g(sr);Ko.__click=[RT];var Hn=g(Ko);a(Hn,()=>Wa,()=>"crosshair",()=>"",()=>[],()=>!0);var ji=u(Hn,2);Ns(ji,17,()=>Zt,dn,(X,Le)=>{var nt=OT(),et=_t(nt),ht=Yd(()=>()=>n(Le).key==="emoji"?Po():wr(n(Le).icon));a(et,()=>n(ht),()=>n(Le).icon,()=>n(Le).key,()=>n(Le).list,()=>!0);var uo=u(et,2);Se(uo,()=>n(Le).key==="emoji",ut=>{l(ut)}),O(X,nt)});var zn=u(ji,2),Vs=Yd(()=>()=>wr("ruler"));a(zn,()=>n(Vs),()=>"ruler");var Bn=u(zn,2);a(Bn,()=>jr,()=>n(v),()=>"mode",()=>bs,()=>!1,()=>!0);var tr=u(Bn,2);a(tr,()=>Ja,()=>n(_)?"lock":"unlock",()=>"",()=>[],()=>!1,()=>!0);var lr=u(tr,2);a(lr,()=>Va,()=>n(y)?"visible":"invisible",()=>"",()=>[],()=>!1,()=>!0);var Ui=u(lr,2);l(Ui);var _a=u(Ui,2);a(_a,()=>Qa,()=>"remove"),f(Ko),Ec(Ko,X=>b(De,X),()=>n(De));var qi=u(Ko,2);Se(qi,()=>n(he),X=>{var Le=WT();Le.__click=to,Le.__touchstart=[DT,to],Le.__touchend=[VT],O(X,Le)}),f(sr);var ai=u(sr,2);Se(ai,()=>n(d),X=>{var Le=ZT(),nt=_t(Le);Ns(nt,17,()=>Zt,dn,(ht,uo)=>{var ut=Xt(),Jt=_t(ut);Se(Jt,()=>n(uo).key===n(d)&&n(uo).list.length>0,fo=>{var lo=GT();const so=We(()=>`left: 60px; top: ${Xa(n(d))??""}px;`);Ns(lo,21,()=>n(uo).list,dn,(ko,ts)=>{var Xn=HT();Xn.__click=[qT,d,ii,ts,rr,Zt];var ro=g(Xn),Do=We(()=>ar(n(ts).key));Ru(ro,{get name(){return n(Do)},class:"w-4 h-4"});var Ao=u(ro,2),ss=g(Ao,!0);we(()=>Ye(ss,Nu[n(ts).text]())),f(Ao),f(Xn),Fl("mouseenter",Xn,ds=>ds.currentTarget.style.backgroundColor="var(--menu-hover-bg)"),Fl("mouseleave",Xn,ds=>ds.currentTarget.style.backgroundColor="transparent"),O(ko,Xn)}),f(lo),R1(lo,ko=>ke(ko)),we(()=>St(lo,"style",n(so))),O(fo,lo)}),O(ht,ut)});var et=u(nt,2);Se(et,()=>n(d)==="mode",ht=>{var uo=KT();const ut=We(()=>`left: 60px; top: ${Xa("mode")??""}px;`);Ns(uo,21,()=>bs,dn,(Jt,fo)=>{var lo=UT();lo.__click=[YT,ii,fo];var so=g(lo),ko=We(()=>ar(n(fo).key));Ru(so,{get name(){return n(ko)},class:"w-4 h-4"});var ts=u(so,2),Xn=g(ts,!0);we(()=>Ye(Xn,Nu[n(fo).text]())),f(ts),f(lo),Fl("mouseenter",lo,ro=>ro.currentTarget.style.backgroundColor="var(--menu-hover-bg)"),Fl("mouseleave",lo,ro=>ro.currentTarget.style.backgroundColor="transparent"),O(Jt,lo)}),f(uo),R1(uo,Jt=>ke(Jt)),we(()=>St(uo,"style",n(ut))),O(ht,uo)}),O(X,Le)});var cr=u(ai,2);Se(cr,()=>n(P)&&n(N),X=>{var Le=fA();Le.__click=[XT];var nt=g(Le);Se(nt,()=>{var so;return((so=n(A))==null?void 0:so.name)!=="emoji"},so=>{var ko=tA(),ts=_t(ko);ts.__mousedown=Wr,ts.__touchstart=[TT,Wr];var Xn=g(ts),ro=g(Xn),Do=g(ro);un(2),f(ro),un(4),f(Xn),f(ts);var Ao=u(ts,2);Se(Ao,()=>{var ss;return((ss=n(A))==null?void 0:ss.name)==="text"},ss=>{var ds=QT(),Cs=_t(ds);Cs.__change=ll;var ns=g(Cs);ns.value=(ns.__value="8")==null?"":"8";var Js=u(ns);Js.value=(Js.__value="10")==null?"":"10";var Nn=u(Js);Nn.value=(Nn.__value="11")==null?"":"11";var ui=u(Nn);ui.value=(ui.__value="12")==null?"":"12";var Ms=u(ui);Ms.value=(Ms.__value="14")==null?"":"14";var Li=u(Ms);Li.value=(Li.__value="16")==null?"":"16";var Dr=u(Li);Dr.value=(Dr.__value="18")==null?"":"18";var Xr=u(Dr);Xr.value=(Xr.__value="20")==null?"":"20";var Ki=u(Xr);Ki.value=(Ki.__value="22")==null?"":"22";var Ge=u(Ki);Ge.value=(Ge.__value="24")==null?"":"24";var at=u(Ge);at.value=(at.__value="32")==null?"":"32";var So=u(at);So.value=(So.__value="40")==null?"":"40";var qt=u(So);qt.value=(qt.__value="52")==null?"":"52",f(Cs);var Io=u(Cs,2);Io.__click=[MT,me,ll];var us=u(Io,2),fn=g(us),Ts=g(fn);const js=We(()=>`background-color: ${me.textColor??""}; color: ${be(me.textColor)??""};`);Ts.__click=[LT,ie,Y,me,K,Pe,se];var on=g(Ts);Ru(on,{name:"text",size:12}),f(Ts);var _s=u(Ts,2);const In=We(()=>`background-color: ${me.backgroundColor??""}; color: ${be(me.backgroundColor)??""};`);_s.__click=[FT,ie,Y,me,K,ze,se];var Ci=g(_s);Ru(Ci,{name:"rect",size:12}),f(_s),f(fn);var zr=u(fn,2);zr.__change=ll,Ns(zr,21,()=>$e,dn,(ca,hl)=>{var fa=JT(),za={},oc=g(fa,!0);f(fa),we(()=>{za!==(za=n(hl).value)&&(fa.value=(fa.__value=n(hl).value)==null?"":n(hl).value),Ye(oc,n(hl).label)}),O(ca,fa)}),f(zr),f(us),we(()=>{Pn(Cs,`px-1 py-1 text-xs border rounded cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n w-[72px] h-[28px] svelte-t6isn6`),Pn(Io,`w-8 h-8 rounded flex items-center justify-center ${(r().theme==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} transition-colors svelte-t6isn6`),St(Ts,"style",n(js)),St(_s,"style",n(In)),Pn(zr,`px-1 py-1 text-xs border rounded cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n max-w-[120px] svelte-t6isn6`)}),Bo(Cs,()=>me.fontSize,ca=>me.fontSize=ca),Bo(zr,()=>me.fontFamily,ca=>me.fontFamily=ca),O(ss,ds)},ss=>{var ds=eA(),Cs=_t(ds);Cs.__click=[AT,ie,Y,F,K,ce,se];var ns=u(Cs,2);ns.__change=qa;var Js=g(ns);Js.value=(Js.__value="1")==null?"":"1";var Nn=u(Js);Nn.value=(Nn.__value="2")==null?"":"2";var ui=u(Nn);ui.value=(ui.__value="3")==null?"":"3";var Ms=u(ui);Ms.value=(Ms.__value="4")==null?"":"4";var Li=u(Ms);Li.value=(Li.__value="5")==null?"":"5";var Dr=u(Li);Dr.value=(Dr.__value="6")==null?"":"6";var Xr=u(Dr);Xr.value=(Xr.__value="7")==null?"":"7";var Ki=u(Xr);Ki.value=(Ki.__value="8")==null?"":"8",f(ns);var Ge=u(ns,2);Ge.__change=qa;var at=g(Ge);at.value=(at.__value="solid")==null?"":"solid";var So=u(at);So.value=(So.__value="dashed")==null?"":"dashed";var qt=u(So);qt.value=(qt.__value="dotted")==null?"":"dotted",f(Ge),we(()=>{St(Cs,"style",`background-color: ${F.color??""};`),Pn(ns,`px-1 py-1 text-xs border rounded-md cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n w-[64px] h-[28px] svelte-t6isn6`),Pn(Ge,`px-1 py-1 text-xs border rounded-md cursor-pointer\\n ${(r().theme==="dark"?"bg-[#2C2C2C] border-[#3A3A3A] text-white":"bg-white border-gray-300 text-gray-900")??""} touch-manipulation\\n w-[72px] h-[28px] svelte-t6isn6`)}),Bo(ns,()=>F.thickness,Io=>F.thickness=Io),Bo(Ge,()=>F.style,Io=>F.style=Io),O(ss,ds)}),we(()=>{Pn(ts,`drag-handle cursor-grab hover:cursor-grabbing flex items-center justify-center
                 w-6 h-6 rounded ${(r().theme==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} transition-colors
                 touch-manipulation svelte-t6isn6`),Pn(Do,`w-0.5 h-0.5 ${(r().theme==="dark"?"bg-gray-500":"bg-gray-400")??""} rounded-full`)}),O(so,ko)},so=>{var ko=sA(),ts=g(ko),Xn=g(ts,!0);f(ts);var ro=u(ts,2),Do=u(g(ro),2);Vt(Do),Do.__input=[oA,Ke];var Ao=u(Do,2),ss=g(Ao,!0);f(Ao),f(ro),f(ko),we(()=>{var ds,Cs,ns,Js,Nn,ui,Ms,Li;Ye(Xn,((Cs=(ds=n(A))==null?void 0:ds.extendData)==null?void 0:Cs.emoji)||"😀"),Vu(Do,((Js=(ns=n(A))==null?void 0:ns.extendData)==null?void 0:Js.size)||24),St(Do,"title",`Emoji size: ${(((ui=(Nn=n(A))==null?void 0:Nn.extendData)==null?void 0:ui.size)||24)??""}px`),Ye(ss,((Li=(Ms=n(A))==null?void 0:Ms.extendData)==null?void 0:Li.size)||24)}),O(so,ko)});var et=u(nt,2);Se(et,()=>{var so;return((so=n(A))==null?void 0:so.name)==="fibonacciSegment"},so=>{var ko=iA();ko.__click=[nA,ps];var ts=g(ko);f(ko),we(()=>{Pn(ko,`w-8 h-8 rounded ${(r().theme==="dark"?"hover:bg-blue-900":"hover:bg-blue-100")??""} transition-colors duration-200
                 flex items-center justify-center svelte-t6isn6`),w0(ts,`w-4 h-4 ${(r().theme==="dark"?"text-gray-300":"text-gray-600")??""} hover:text-blue-500`)}),O(so,ko)});var ht=u(et,2),uo=g(ht);uo.__click=[rA,G];var ut=g(uo);f(uo);var Jt=u(uo,2);Se(Jt,()=>n(G),so=>{var ko=pA();ko.__click=[aA];var ts=g(ko);ts.__click=[lA,Qt,G];var Xn=u(ts,2);Xn.__click=[cA,xt,G];var ro=u(Xn,2);Se(ro,()=>n(V),Do=>{var Ao=uA();Ao.__click=[dA,eo,G],we(()=>Pn(Ao,`w-full text-left px-3 py-2 text-sm ${(r().theme==="dark"?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-800")??""} svelte-t6isn6`)),O(Do,Ao)}),f(ko),we(()=>{Pn(ko,`absolute right-0 top-full mt-1 min-w-[140px] rounded-md shadow-lg border ${(r().theme==="dark"?"bg-[#2B2B2B] border-[#3F3F3F]":"bg-white border-gray-200")??""} z-[200002]`),Pn(ts,`w-full text-left px-3 py-2 text-sm ${(r().theme==="dark"?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-800")??""} svelte-t6isn6`),Pn(Xn,`w-full text-left px-3 py-2 text-sm ${(r().theme==="dark"?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-800")??""} svelte-t6isn6`)}),O(so,ko)}),f(ht);var fo=u(ht,2);fo.__click=[vA,Qa,P,L];var lo=g(fo);f(fo),f(Le),we(()=>{Pn(Le,`context-menu-container fixed z-[200001] rounded-md shadow-lg flex items-center gap-1 space-x-1\\n ${(r().theme==="dark"?"bg-[#2B2B2B] border border-[#3F3F3F]":"bg-white border border-gray-200")??""} ${(n(B)?"cursor-grabbing":"")??""}\\n px-2 py-1 sm:px-3 sm:py-1\\n max-w-[85vw] sm:max-w-none svelte-t6isn6`),St(Le,"data-theme",r().theme),St(Le,"style",`left: ${n(N).x??""}px; 
           top: ${n(N).y??""}px;`),Pn(uo,`w-8 h-8 rounded ${(r().theme==="dark"?"hover:bg-gray-700":"hover:bg-gray-100")??""} transition-colors duration-200 flex items-center justify-center svelte-t6isn6`),St(uo,"aria-expanded",n(G)),w0(ut,`w-4 h-4 ${(r().theme==="dark"?"text-gray-300":"text-gray-600")??""}`),Pn(fo,`w-8 h-8 rounded ${(r().theme==="dark"?"hover:bg-red-900":"hover:bg-red-100")??""} transition-colors duration-200
               flex items-center justify-center svelte-t6isn6`),w0(lo,`w-4 h-4 ${(r().theme==="dark"?"text-gray-300":"text-gray-600")??""} hover:text-red-500`)}),O(X,Le)});var Dn=u(cr,2);Se(Dn,()=>n(T)&&n(L),X=>{var Le=gA();Le.__click=Qa,we(()=>St(Le,"style",`left: ${n(L).x??""}px; top: ${n(L).y??""}px;`)),O(X,Le)});var kr=u(Dn,2);Su(kr,{get selectedColor(){return n(Y)},set selectedColor(X){b(Y,j(X))},get opacity(){return n(K)},set opacity(X){b(K,j(X))},get show(){return n(se)},set show(X){b(se,j(X))},$$events:{colorChange:el,opacityChange:or,close:tc}});var Me=u(kr,2);_T(Me,{get show(){return n(Q)},set show(X){b(Q,j(X))},get position(){return n(q)},set position(X){b(q,j(X))},$$events:{select:Ze}});var Xe=u(Me,2);return IT(Xe,{get visible(){return n(Ve)},set visible(X){b(Ve,j(X))},get levels(){return n(Ce)},set levels(X){b(Ce,j(X))},get theme(){return r().theme},$$events:{levelChange:X=>sa(X.detail.index,X.detail.field,X.detail.value),reset:pn,confirm:Jo,cancel:ti}}),O(o,vn),Za({addOverlay:rn,clickRemove:Qa,externalSelectOverlay:mt,externalDeselectOverlay:Wt,externalSyncOverlay:vt,externalRemoved:$t,createTextDrawing:zo,updateTextDrawing:bo,deleteTextDrawing:xo,setSelectedDrawing:Zo,enterEditMode:os,exitEditMode:ri})}hc(["click","touchstart","touchend","mousedown","change","input"]);const dx={mode:"none",playing:!1,speed:1,depositAmount:1e5,leverage:null,currency:"USD",balance:1e5,positions:[],history:[],sidebarOpen:!1,pendingOrders:[],onboardingDone:!1},Td=Id(dx);function ux(){Td.set(dx)}function px(o){var t;const e=o.priceCurrency||((t=o.exchange)!=null&&t.toUpperCase().includes("DSE")?"BDT":"USD");Td.update(s=>({...s,currency:e}))}function vx(o){Td.update(e=>({...e,currency:o}))}function fx(o){Td.update(e=>({...e,depositAmount:o,balance:o}))}function gx(o){Td.update(e=>({...e,leverage:o}))}function mx(o){Td.update(e=>({...e,onboardingDone:o}))}function hx(o){Td.update(e=>({...e,mode:o}))}function z0(o){Td.update(e=>({...e,playing:o}))}function b1(o){if(Td.update(e=>({...e,speed:o})),typeof window<"u"&&window.setPlaybackSpeed)try{window.setPlaybackSpeed(o)}catch{}}function _x(o){Td.update(e=>({...e,positions:[...e.positions,o],balance:e.balance-o.avgCost*o.quantity}))}function _A(o,e,t){Td.update(s=>{const i=s.positions.findIndex(_=>_.id===o);if(i===-1)return s;const r=s.positions[i],a=Math.min(e,r.quantity),l=(t-r.avgCost)*a*(r.leverage||1),d=r.quantity-a,v=[...s.positions];d>0?v[i]={...r,quantity:d}:v.splice(i,1);const p={id:o,symbol:r.symbol,quantity:a,avgCost:r.avgCost,closedAvg:t,pnl:l,closedAt:Date.now()};return{...s,positions:v,history:[p,...s.history],balance:s.balance+t*a+l}})}function yA(o){Td.update(e=>({...e,pendingOrders:[...e.pendingOrders||[],o]}))}function y_(o){Td.update(e=>({...e,pendingOrders:(e.pendingOrders||[]).filter(t=>t.id!==o)}))}function Fy(o,e,t){e(!1),o.stopPropagation(),t.click&&t.click("close")}var bA=o=>o.stopPropagation(),xA=(o,e,t)=>e(n(t)),wA=de("<button> </button>"),kA=de('<div class="modal-action px-4 sm:px-6 py-4 sm:py-5 border-t modal-footer svelte-1a6y34w"><div class="flex flex-col sm:flex-row gap-2 sm:gap-3 justify-end w-full"></div></div>'),SA=de('<div class="fixed inset-0 z-[70] flex items-center justify-center px-3 sm:px-4 md:px-6 animate-in fade-in duration-200 modal-overlay svelte-1a6y34w"><div><div class="relative px-4 sm:px-6 py-4 sm:py-5 border-b modal-header svelte-1a6y34w"><div class="flex justify-between items-center gap-4"><div class="flex items-center gap-3 min-w-0 flex-1"><div class="icon-badge svelte-1a6y34w"><svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg></div> <h3 class="font-bold text-lg sm:text-xl md:text-2xl tracking-tight text-base-content truncate"> </h3></div> <button class="close-btn flex-shrink-0 svelte-1a6y34w" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 sm:w-6 sm:h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div><!></div> <!></div></div>');function Pu(o,e){Ka(e,!0);let t=Ss(e,"width",3,600),s=Ss(e,"maxWidth",3,"min(600px, 95vw)"),i=Ss(e,"maxHeight",3,"90vh"),r=Ss(e,"title",3,""),a=Ss(e,"buttons",19,()=>["confirm"]),l=Ss(e,"show",15,!1),d=Ss(e,"center",3,!1),v=Ss(e,"class",3,""),p=Ss(e,"theme",3,"dark");function _(S){S==="close"&&l(!1),e.click&&e.click(S)}function y(S){switch(S){case"confirm":return"btn-primary";case"cancel":return"btn-ghost";default:return"btn-secondary"}}var w=Xt(),k=_t(w);Se(k,l,S=>{var L=SA();L.__click=[Fy,l,e];var T=g(L);T.__click=[bA];var P=g(T),A=g(P),F=g(A),B=u(g(F),2),R=g(B,!0);f(B),f(F);var N=u(F,2);N.__click=[Fy,l,e],f(A),f(P);var $=u(P,2),V=g($);Se(V,()=>e.children,G=>{var Z=Xt(),le=_t(Z);Xw(le,()=>e.children),O(G,Z)}),f($);var U=u($,2);Se(U,()=>a().length>0,G=>{var Z=kA(),le=g(Z);Ns(le,21,a,dn,(se,ie)=>{var Y=wA();const K=We(()=>`btn-premium ${y(n(ie))??""} w-full sm:w-auto sm:min-w-[120px] svelte-1a6y34w`);Y.__click=[xA,_,ie];var Q=g(Y,!0);we(()=>Ye(Q,Nu[n(ie)]())),f(Y),we(()=>Pn(Y,n(K))),O(se,Y)}),f(le),f(Z),O(G,Z)}),f(T),f(L),we(()=>{Pn(T,`relative rounded-3xl shadow-luxury animate-in zoom-in-95 duration-300 overflow-hidden flex flex-col modal-container ${v()??""} svelte-1a6y34w`),St(T,"data-theme",p()),St(T,"style",`width: ${(typeof t()=="string"?t():t()+"px")??""}; max-width: ${s()??""}; max-height: ${i()??""};`),Ye(R,r()),Pn($,`flex-1 overflow-y-auto premium-scrollbar ${(d()?"flex justify-center items-center":"")??""} px-4 sm:px-6 py-4 sm:py-5 svelte-1a6y34w`)}),O(S,L)}),O(o,w),Za()}hc(["click"]);const CA="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let yx=(o=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(o|=0));for(;o--;)e+=CA[t[o]&63];return e};/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 * ---
 * 
 * The MIT License (MIT) (for portions derived from Feather)
 * 
 * Copyright (c) 2013-2023 Cole Bemis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const PA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var IA=qn("<svg><!><!></svg>");function md(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]),s=Kc(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Ka(e,!1);let i=Ss(e,"name",8,void 0),r=Ss(e,"color",8,"currentColor"),a=Ss(e,"size",8,24),l=Ss(e,"strokeWidth",8,2),d=Ss(e,"absoluteStrokeWidth",8,!1),v=Ss(e,"iconNode",24,()=>[]);const p=(...P)=>P.filter((A,F,B)=>!!A&&B.indexOf(A)===F).join(" "),_=$0(),[y,w]=_;Ud();var k=IA();let S;var L=g(k);Ns(L,1,v,dn,(P,A)=>{let F=()=>n(A)[0],B=()=>n(A)[1];var R=Xt(),N=_t(R);const $=Yd(()=>`${F()}`=="button"?w({...B()},[{attribute_name:"formaction"}]):`${F()}`=="form"?w({...B()},[{attribute_name:"action"}]):`${F()}`=="a"?w({...B()},[{attribute_name:"href",lang_attribute_name:"hreflang"}]):{...B()});o3(N,F,!0,(V,U)=>{let G;we(()=>G=B1(V,G,{...n($)},void 0,V.namespaceURI===C2,V.nodeName.includes("-")))}),O(P,R)});var T=u(L);ad(T,e,"default",{}),f(k),we(()=>S=B1(k,S,{...PA,...s,width:a(),height:a(),stroke:r(),"stroke-width":d()?Number(l())*24/Number(a()):l(),class:p("lucide-icon","lucide",i()?`lucide-${i()}`:"",t.class)},void 0,!0)),O(o,k),Za()}function MA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"banknote"},()=>t,{iconNode:[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"}],["circle",{cx:"12",cy:"12",r:"2"}],["path",{d:"M6 12h.01M18 12h.01"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function TA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"camera"},()=>t,{iconNode:[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z"}],["circle",{cx:"12",cy:"13",r:"3"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function AA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"clock"},()=>t,{iconNode:[["path",{d:"M12 6v6l4 2"}],["circle",{cx:"12",cy:"12",r:"10"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function LA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"code-xml"},()=>t,{iconNode:[["path",{d:"m18 16 4-4-4-4"}],["path",{d:"m6 8-4 4 4 4"}],["path",{d:"m14.5 4-5 16"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function FA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"download"},()=>t,{iconNode:[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function DA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"flask-conical"},()=>t,{iconNode:[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2"}],["path",{d:"M6.453 15h11.094"}],["path",{d:"M8.5 2h7"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function EA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"gauge"},()=>t,{iconNode:[["path",{d:"m12 14 4-4"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function $A(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"log-out"},()=>t,{iconNode:[["path",{d:"m16 17 5-5-5-5"}],["path",{d:"M21 12H9"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function jA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"maximize"},()=>t,{iconNode:[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function zA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"minimize"},()=>t,{iconNode:[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function BA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"moon"},()=>t,{iconNode:[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function NA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"pause"},()=>t,{iconNode:[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function RA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"play"},()=>t,{iconNode:[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function OA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"save"},()=>t,{iconNode:[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function VA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"search"},()=>t,{iconNode:[["path",{d:"m21 21-4.34-4.34"}],["circle",{cx:"11",cy:"11",r:"8"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function WA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"settings"},()=>t,{iconNode:[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function qA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"sun"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"4"}],["path",{d:"M12 2v2"}],["path",{d:"M12 20v2"}],["path",{d:"m4.93 4.93 1.41 1.41"}],["path",{d:"m17.66 17.66 1.41 1.41"}],["path",{d:"M2 12h2"}],["path",{d:"M20 12h2"}],["path",{d:"m6.34 17.66-1.41 1.41"}],["path",{d:"m19.07 4.93-1.41 1.41"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function HA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"trending-up"},()=>t,{iconNode:[["path",{d:"M16 7h6v6"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}function GA(o,e){const t=Kc(e,["children","$$slots","$$events","$$legacy"]);md(o,gd({name:"wallet"},()=>t,{iconNode:[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"}]],children:(i,r)=>{var a=Xt(),l=_t(a);ad(l,e,"default",{}),O(i,a)},$$slots:{default:!0}}))}const bx=["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BRL","BSD","BTN","BWP","BYN","BZD","CAD","CDF","CHF","CLP","CNY","COP","CRC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRU","MUR","MVR","MWK","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STN","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","UYU","UZS","VES","VND","VUV","WST","XAF","XCD","XOF","XPF","YER","ZAR","ZMW","ZWL"];function YA(o,e,t,s){vx(n(e)),fx(Math.max(0,Number(n(t))||0)),b(s,2)}function UA(){var o;try{(o=window.predictNextCandle)==null||o.call(window)}catch{}z0(!0)}function KA(o){b1(parseFloat(o.target.value))}function ZA(o,e,t,s,i){var d,v;if(!(typeof window<"u"?window.confirm("Exit simulator?"):!0))return;e();const a=t().positions;for(const p of a){try{p.lineOverlayId&&((d=s())==null||d.removeOverlay({id:p.lineOverlayId}))}catch{}try{p.noteOverlayId&&((v=s())==null||v.removeOverlay({id:p.noteOverlayId}))}catch{}}ux();const l=window.sidebarHostRef;l&&l.closeSidebar&&l.closeSidebar()}function XA(o,e,t,s,i,r,a,l){b(e,!0),b(t,"instant"),b(s,1),b(i,null),b(r,1),b(a,null),b(l,null)}function JA(o,e,t,s,i,r,a,l,d,v,p,_,y){var B,R;b(e,null);const w=n(t),k=Math.max(0,Number(n(s))||0);if(k<=0||w<=0){b(e,"Invalid quantity");return}if(!i(k,w)){b(e,"Quantity exceeds balance");return}r();const S=yx(),L=a(),T=(B=l())==null?void 0:B.createOverlay({name:"horizontalStraightLine",points:[{value:w}],styles:{line:{style:Ee.Dashed,size:1}}}),P=(R=l())==null?void 0:R.createOverlay({name:"note",points:[{timestamp:L,value:w}],extendData:{in_text:"BUY",in_color:"#10b981",line_color:"#10b981"}}),A=Array.isArray(T)?T[0]??void 0:T??void 0,F=Array.isArray(P)?P[0]??void 0:P??void 0;_x({id:S,symbol:v().symbol,quantity:k,avgCost:w,leverage:_().leverage,openedAt:Date.now(),lineOverlayId:A,noteOverlayId:F}),b(y,!1)}function QA(o,e,t,s,i,r,a,l,d,v,p,_,y){var B,R;b(e,null);const w=Math.max(0,Number(n(t))||0),k=Math.max(0,Number(n(s))||0);if(k<=0||w<=0){b(e,"Quantity exceeds balance or invalid price");return}if(!i(k,w)){b(e,"Quantity exceeds balance or invalid price");return}const S=yx(),L=w>=n(r),T=(B=a())==null?void 0:B.createOverlay({name:"horizontalStraightLine",points:[{value:w}],styles:{line:{style:Ee.Dashed,size:1}}}),P=(R=a())==null?void 0:R.createOverlay({name:"note",points:[{timestamp:d(),value:w}],extendData:{in_text:"PENDING",in_color:"#f59e0b",line_color:"#f59e0b"}}),A=Array.isArray(T)?T[0]??void 0:T??void 0,F=Array.isArray(P)?P[0]??void 0:P??void 0;yA({id:S,symbol:v().symbol,quantity:k,price:w,leverage:_().leverage,createdAt:Date.now(),triggerUp:L,lineOverlayId:A,noteOverlayId:F}),b(y,!1)}var eL=de("<option> </option>"),tL=de('<div class="grid grid-cols-1 sm:grid-cols-3 gap-2 items-end w-full"><div class="flex flex-col gap-1"><div class="text-xs opacity-80">Currency</div> <select class="select select-bordered select-sm"></select></div> <input class="input input-bordered input-sm" type="number" min="0" placeholder="Deposit"> <button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button">Confirm Deposit</button></div>'),oL=(o,e)=>b(e,!0),sL=(o,e)=>b(e,!1),nL=de('<div class="flex items-center gap-2 w-full"><select class="select select-bordered select-sm"><option>1:50</option><option>1:100</option><option>1:200</option><option>1:400</option><option>1:500</option></select> <button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button">Confirm</button></div>'),iL=(o,e,t)=>{b(e,null),t()},rL=de('<button class="btn btn-sm btn-premium-outline svelte-112gz12" type="button">Confirm</button>'),aL=de('<div class="space-y-2 w-full"><div class="text-sm">Take leverage?</div> <div class="flex items-center gap-2 w-full"><label class="label cursor-pointer"><input type="radio" name="lev" class="radio radio-sm"> <span class="label-text ml-2">Yes</span></label> <label class="label cursor-pointer"><input type="radio" name="lev" class="radio radio-sm"> <span class="label-text ml-2">No</span></label></div> <!></div>'),lL=de('<span class="text-success"> </span>'),cL=de('<span class="text-error"> </span>'),dL=de("<span>No trades</span>"),uL=de('<button class="btn btn-sm btn-premium-outline svelte-112gz12" type="button"><!></button>'),pL=de('<button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button"><!></button>'),vL=(o,e)=>b1(e),fL=de('<button type="button"> </button>'),gL=(o,e)=>b(e,"portfolio"),mL=(o,e)=>b(e,"history"),hL=(o,e,t)=>e(n(t)),_L=de('<div class="flex items-center justify-between text-sm mt-2 gap-2"><div class="flex items-center gap-2 min-w-0"><div class="badge badge-outline truncate"> </div> <div class="truncate"> </div> <div class="truncate"> </div></div> <div class="flex items-center gap-2"><button class="btn btn-sm btn-premium-ghost svelte-112gz12" type="button">Cancel</button></div></div>'),yL=de('<div class="card lux-card shadow w-full mb-3 svelte-112gz12"><div class="card-body p-3 min-w-0"><div class="text-sm font-semibold">Pending Orders</div> <!></div></div>'),bL=(o,e,t)=>{b(e,""),b(t,0)},xL=de('<button class="btn btn-xs btn-premium-ghost svelte-112gz12" type="button">Cancel</button>'),wL=(o,e,t)=>e(n(t).id),kL=de('<button class="btn btn-xs btn-premium-outline svelte-112gz12" type="button">Sell</button>'),SL=(o,e)=>e(!0),CL=(o,e)=>e(!1),PL=de('<div class="sell-panel w-full mt-2 space-y-3 svelte-112gz12"><div class="sell-section svelte-112gz12"><div class="flex items-center justify-between"><div class="text-xs opacity-70"> </div> <button class="btn btn-sm btn-premium-primary svelte-112gz12" type="button">Close All</button></div></div> <div class="sell-section svelte-112gz12"><div class="text-xs opacity-70 mb-2">Close partial position</div> <div class="flex items-center gap-2"><input class="input input-bordered input-sm flex-1" type="number" min="0" placeholder="Partial qty"> <button class="btn btn-sm btn-premium-outline svelte-112gz12" type="button">Confirm Partial</button></div> <div class="mt-2 text-xs opacity-70 flex items-center justify-between"><span> </span> <span> </span></div></div></div>'),IL=de('<div class="card lux-card shadow w-full mb-2 svelte-112gz12"><div class="card-body p-3 min-w-0"><div class="flex items-center justify-between"><div class="flex items-center gap-2 text-sm min-w-0"><div class="badge badge-outline truncate"> </div> <div class="truncate"> </div> <div class="truncate"> </div> <div class="truncate"> </div></div> <div class="flex items-center gap-2"><div> </div> <!></div></div> <!></div></div>'),ML=de("<!> <!>",1),TL=de('<div class="card trade-card shadow w-full mb-2 svelte-112gz12"><div class="card-body p-3 text-sm min-w-0"><div class="flex items-center justify-between"><div class="flex items-center gap-2 min-w-0"><div class="badge badge-outline truncate"> </div> <div class="truncate"> </div></div> <div> </div></div> <div class="mt-1 truncate"> </div></div></div>'),AL=de('<div class="card history-summary-card shadow w-full mb-2 svelte-112gz12"><div class="card-body p-3 min-w-0"><div class="grid grid-cols-3 gap-2 items-stretch"><div class="summary-tile win svelte-112gz12"><div class="summary-title svelte-112gz12">Winning</div> <div class="summary-values svelte-112gz12"><div class="badge badge-success text-[10px]"> </div> <div class="summary-amount svelte-112gz12"> </div></div></div> <div class="summary-tile loss svelte-112gz12"><div class="summary-title svelte-112gz12">Losing</div> <div class="summary-values svelte-112gz12"><div class="badge badge-error text-[10px]"> </div> <div class="summary-amount svelte-112gz12"> </div></div></div> <div><div class="summary-title svelte-112gz12">Net</div> <div class="summary-values svelte-112gz12"><div class="summary-amount svelte-112gz12"> </div></div></div></div></div></div> <!>',1),LL=de('<div class="exit-bar svelte-112gz12"><div class="exit-copy svelte-112gz12">Practice live trading. Check your predictions and improve.</div> <button class="btn btn-sm btn-premium-danger exit-cta svelte-112gz12" type="button"><!> Exit</button></div> <div class="mini-stack grid grid-cols-1 gap-2 w-full svelte-112gz12"><div class="card glass lux-card shadow overflow-hidden mini-tile deposit-tile svelte-112gz12"><div class="card-body p-3 min-w-0 svelte-112gz12"><div class="flex items-center gap-3 w-full"><div class="tile-icon svelte-112gz12"><div class="icon-wrap svelte-112gz12"><!></div></div> <div class="flex-1 min-w-0 tile-content svelte-112gz12"><div class="tile-title svelte-112gz12">Deposit</div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div> <div class="tile-sub truncate svelte-112gz12"> </div></div></div></div></div> <div class="card glass lux-card shadow overflow-hidden mini-tile investment-tile svelte-112gz12"><div class="card-body p-3 min-w-0 svelte-112gz12"><div class="flex items-center gap-3 w-full"><div class="tile-icon svelte-112gz12"><div class="icon-wrap svelte-112gz12"><!></div></div> <div class="flex-1 min-w-0 tile-content svelte-112gz12"><div class="tile-title svelte-112gz12">Investment <span class="badge badge-outline text-[9px] ml-1"> </span></div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div> <div class="tile-sub truncate svelte-112gz12"><!></div></div></div></div></div> <div class="card glass lux-card shadow overflow-hidden mini-tile available-tile svelte-112gz12"><div class="card-body p-3 min-w-0 svelte-112gz12"><div class="flex items-center gap-3 w-full"><div class="tile-icon svelte-112gz12"><div class="icon-wrap svelte-112gz12"><!></div></div> <div class="flex-1 min-w-0 tile-content svelte-112gz12"><div class="tile-title svelte-112gz12">Available</div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div> <div class="tile-sub truncate svelte-112gz12"> </div></div></div></div></div></div> <div class="card speed-card w-full svelte-112gz12"><div class="card-body p-4"><div class="speed-header flex items-center justify-between svelte-112gz12"><div class="flex items-center gap-2"><div class="speed-icon svelte-112gz12"><!></div> <div class="speed-title svelte-112gz12">Playback Speed</div></div> <div class="speed-badge svelte-112gz12"> </div></div> <div class="mt-3 flex items-center gap-3"><input type="range" min="0.5" max="10" step="0.5" class="speed-range flex-1 svelte-112gz12"> <!></div> <div class="mt-2 speed-chips svelte-112gz12"></div></div></div> <div class="card trade-action-card w-full overflow-hidden svelte-112gz12"><div class="card-body p-4 min-w-0"><div class="flex items-center justify-between"><div><div class="text-xs opacity-70">Current Price</div> <div class="metric-value font-extrabold truncate whitespace-nowrap svelte-112gz12"> </div></div> <div class="badge badge-success badge-outline">LIVE</div></div> <div class="mt-3"><button class="btn btn-premium-primary w-full svelte-112gz12" type="button">Buy Stock</button></div></div></div> <div class="tabs tabs-boxed w-full mt-3 gap-3 svelte-112gz12"><button type="button">Portfolio</button> <button type="button">History</button></div> <!>',1),FL=(o,e)=>b(e,"instant"),DL=(o,e)=>b(e,"pending"),EL=de('<div class="text-error text-xs mt-1"> </div>'),$L=de('<div class="space-y-2"><div class="card buy-card svelte-112gz12"><div class="card-body p-3"><div class="flex items-center justify-between"><div class="text-xs opacity-70">Current Price</div> <div class="metric-value font-bold truncate whitespace-nowrap svelte-112gz12"> </div></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 items-end mt-2"><input class="input input-bordered input-sm" type="number" min="0" placeholder="Quantity"> <button class="btn btn-sm btn-premium-primary w-full svelte-112gz12" type="button">Confirm Buy</button></div> <!></div></div></div>'),jL=de('<div class="text-error text-xs"> </div>'),zL=de('<div class="space-y-2"><div class="grid grid-cols-2 gap-2 items-end"><input class="input input-bordered input-sm" type="number" min="0" placeholder="Custom Price"> <input class="input input-bordered input-sm" type="number" min="0" placeholder="Quantity"></div> <button class="btn btn-sm btn-premium-primary w-full svelte-112gz12" type="button">Place Pending Buy</button> <!></div>'),BL=de('<div class="space-y-3"><div class="flex items-center gap-2"><div class="badge badge-outline">Mode</div> <label class="label cursor-pointer"><input type="radio" name="buyMode" class="radio radio-sm"> <span class="label-text ml-2">Instant</span></label> <label class="label cursor-pointer"><input type="radio" name="buyMode" class="radio radio-sm"> <span class="label-text ml-2">Pending</span></label></div> <!></div>'),NL=de('<div class="p-4 space-y-4 w-full box-border"><!></div> <!>',1);function RL(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(Td,"$simulator",t),i=()=>ir(l,"$save",t),r=()=>ir(a,"$chart",t),a=Fa("chart"),l=Fa("save");let d=oe(j(s().depositAmount)),v=oe(j(s().currency||i().symbol.priceCurrency||"USD")),p=oe(!1),_=oe(null),y=oe(j(s().onboardingDone?3:1)),w=oe(0),k=null,S=oe(0),L=oe(""),T=oe("portfolio"),P=oe(!1),A=oe("instant"),F=oe(null),B=oe(1),R=oe(1),N=oe(null),$=oe(null);const V=We(()=>(s().positions||[]).length>0),U=We(()=>(s().positions||[]).reduce((ye,Ae)=>ye+(n(w)-Ae.avgCost)*Ae.quantity*(Ae.leverage||1),0)),G=We(()=>s().history||[]),Z=We(()=>n(G).filter(ye=>(ye.pnl??0)>0).length),le=We(()=>n(G).filter(ye=>(ye.pnl??0)<0).length),se=We(()=>n(G).reduce((ye,Ae)=>ye+((Ae.pnl??0)>0?Ae.pnl??0:0),0)),ie=We(()=>n(G).reduce((ye,Ae)=>ye+((Ae.pnl??0)<0?Math.abs(Ae.pnl??0):0),0)),Y=We(()=>n(se)-n(ie)),K=We(()=>((s().speed||.5)-.5)/9.5*100);function Q(){var Ae;const ye=((Ae=r())==null?void 0:Ae.getDataList())||[];return ye.length===0?0:ye[ye.length-1].close}function q(){var Ae;const ye=((Ae=r())==null?void 0:Ae.getDataList())||[];return ye.length===0?Date.now():ye[ye.length-1].timestamp}function ce(){gx(n(p)?n(_)||100:null),b(y,3),mx(!0)}function _e(){var ye;try{(ye=window.stopPrediction)==null||ye.call(window)}catch{}z0(!1)}function me(){k||(k=setInterval(()=>{var Ie,ne,J,qe,ft;const ye=((Ie=r())==null?void 0:Ie.getDataList())||[],Ae=ye.length>0?ye[ye.length-1]:null,ee=Ae?Ae.close??0:0,xe=Ae?Ae.high??ee:ee,ke=Ae?Ae.low??ee:ee;b(w,j(ee));const He=[...s().pendingOrders||[]];for(const Qe of He)if(Qe.triggerUp?xe>=Qe.price:ke<=Qe.price){const ct=s().leverage||1;if(Qe.price*Qe.quantity/ct<=s().balance){if(Qe.lineOverlayId)try{(ne=r())==null||ne.removeOverlay({id:Qe.lineOverlayId})}catch{}if(Qe.noteOverlayId)try{(J=r())==null||J.removeOverlay({id:Qe.noteOverlayId})}catch{}y_(Qe.id);const It=q(),zt=(qe=r())==null?void 0:qe.createOverlay({name:"horizontalStraightLine",points:[{value:Qe.price}],styles:{line:{style:Ee.Dashed,size:1}}}),pt=(ft=r())==null?void 0:ft.createOverlay({name:"note",points:[{timestamp:It,value:Qe.price}],extendData:{in_text:"BUY",in_color:"#10b981",line_color:"#10b981"}}),Mo=Array.isArray(zt)?zt[0]??void 0:zt??void 0,Xo=Array.isArray(pt)?pt[0]??void 0:pt??void 0;_x({id:Qe.id,symbol:Qe.symbol,quantity:Qe.quantity,avgCost:Qe.price,leverage:Qe.leverage,openedAt:Date.now(),lineOverlayId:Mo,noteOverlayId:Xo})}else y_(Qe.id)}},300))}function Pe(){k&&(clearInterval(k),k=null)}Rd(()=>{b(w,j(Q()))}),Wi(()=>{s().playing?me():Pe()});function ze(ye,Ae){const ee=s().leverage||1;return Ae*ye/ee<=s().balance}function he(ye){var Ae,ee;try{ye.lineOverlayId&&((Ae=r())==null||Ae.removeOverlay({id:ye.lineOverlayId}))}catch{}try{ye.noteOverlayId&&((ee=r())==null||ee.removeOverlay({id:ye.noteOverlayId}))}catch{}y_(ye.id)}function De(ye){b(L,j(ye)),b(S,0),b(T,"portfolio")}function ge(ye){var ke,He;const Ae=s().positions.find(Ie=>Ie.id===n(L));if(!Ae)return;const ee=Q(),xe=ye?Ae.quantity:Math.min(Ae.quantity,Math.max(0,Number(n(S))||0));if(!(xe<=0)){if(_A(Ae.id,xe,ee),xe===Ae.quantity){try{Ae.lineOverlayId&&((ke=r())==null||ke.removeOverlay({id:Ae.lineOverlayId}))}catch{}try{Ae.noteOverlayId&&((He=r())==null||He.removeOverlay({id:Ae.noteOverlayId}))}catch{}}b(L,""),b(S,0)}}function be(ye){try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s().currency||"USD",maximumFractionDigits:2}).format(ye)}catch{return`${ye.toFixed(2)} ${s().currency||""}`}}var $e=NL(),Ve=_t($e),Ce=g(Ve);Se(Ce,()=>n(y)===1,ye=>{var Ae=tL(),ee=g(Ae),xe=u(g(ee),2);Ns(xe,21,()=>bx,dn,(Ie,ne)=>{var J=eL(),qe={},ft=g(J,!0);f(J),we(()=>{qe!==(qe=n(ne))&&(J.value=(J.__value=n(ne))==null?"":n(ne)),Ye(ft,n(ne))}),O(Ie,J)}),f(xe),f(ee);var ke=u(ee,2);Vt(ke);var He=u(ke,2);He.__click=[YA,v,d,y],f(Ae),Bo(xe,()=>n(v),Ie=>b(v,Ie)),go(ke,()=>n(d),Ie=>b(d,Ie)),O(ye,Ae)},ye=>{var Ae=Xt(),ee=_t(Ae);Se(ee,()=>n(y)===2,xe=>{var ke=aL(),He=u(g(ke),2),Ie=g(He),ne=g(Ie);Vt(ne),ne.__click=[oL,p],un(2),f(Ie);var J=u(Ie,2),qe=g(J);Vt(qe),qe.__click=[sL,p],un(2),f(J),f(He);var ft=u(He,2);Se(ft,()=>n(p),Qe=>{var Oe=nL(),ct=g(Oe),Lt=g(ct);Lt.value=(Lt.__value=50)==null?"":50;var It=u(Lt);It.value=(It.__value=100)==null?"":100;var zt=u(It);zt.value=(zt.__value=200)==null?"":200;var pt=u(zt);pt.value=(pt.__value=400)==null?"":400;var Mo=u(pt);Mo.value=(Mo.__value=500)==null?"":500,f(ct);var Xo=u(ct,2);Xo.__click=ce,f(Oe),Bo(ct,()=>n(_),en=>b(_,en)),O(Qe,Oe)},Qe=>{var Oe=rL();Oe.__click=[iL,_,ce],O(Qe,Oe)}),f(ke),we(()=>{tp(ne,n(p)),tp(qe,!n(p))}),O(xe,ke)},xe=>{var ke=LL(),He=_t(ke),Ie=u(g(He),2);Ie.__click=[ZA,_e,s,r,a];var ne=g(Ie);$A(ne,{size:16}),un(),f(Ie),f(He);var J=u(He,2),qe=g(J),ft=g(qe),Qe=g(ft),Oe=g(Qe),ct=g(Oe),Lt=g(ct);GA(Lt,{size:14}),f(ct),f(Oe);var It=u(Oe,2),zt=u(g(It),2);we(()=>St(zt,"title",be(s().depositAmount)));var pt=g(zt,!0);we(()=>Ye(pt,be(s().depositAmount))),f(zt);var Mo=u(zt,2),Xo=g(Mo);we(()=>Ye(Xo,`${be(s().depositAmount)??""} • ${s().currency??""}`)),f(Mo),f(It),f(Qe),f(ft),f(qe);var en=u(qe,2),Fo=g(en),Eo=g(Fo),cs=g(Eo),Zt=g(cs),bs=g(Zt);HA(bs,{size:14}),f(Zt),f(cs);var es=u(cs,2),rn=g(es),wr=u(g(rn)),rr=g(wr);f(wr),f(rn);var ar=u(rn,2);we(()=>St(ar,"title",be((s().positions||[]).reduce((Wt,vt)=>Wt+vt.avgCost*vt.quantity,0))));var jr=g(ar,!0);we(()=>Ye(jr,be((s().positions||[]).reduce((Wt,vt)=>Wt+vt.avgCost*vt.quantity,0)))),f(ar);var ii=u(ar,2),Xa=g(ii);Se(Xa,()=>(s().positions||[]).length>0,Wt=>{var vt=Xt(),$t=_t(vt);Se($t,()=>(s().positions||[]).reduce((zo,bo)=>zo+(n(w)-bo.avgCost)*bo.quantity*(bo.leverage||1),0)>=0,zo=>{var bo=lL(),xo=g(bo);we(()=>Ye(xo,`+${be((s().positions||[]).reduce((Zo,os)=>Zo+(n(w)-os.avgCost)*os.quantity*(os.leverage||1),0))??""}`)),f(bo),O(zo,bo)},zo=>{var bo=cL(),xo=g(bo);we(()=>Ye(xo,`-${be(Math.abs((s().positions||[]).reduce((Zo,os)=>Zo+(n(w)-os.avgCost)*os.quantity*(os.leverage||1),0)))??""}`)),f(bo),O(zo,bo)}),O(Wt,vt)},Wt=>{var vt=dL();O(Wt,vt)}),f(ii),f(es),f(Eo),f(Fo),f(en);var Ja=u(en,2),Va=g(Ja),Wa=g(Va),Qa=g(Wa),qa=g(Qa),Kl=g(qa);MA(Kl,{size:14}),f(qa),f(Qa);var ll=u(Qa,2),Wr=u(g(ll),2);we(()=>St(Wr,"title",be(s().balance*(s().leverage||1))));var Ca=g(Wr,!0);we(()=>Ye(Ca,be(s().balance*(s().leverage||1)))),f(Wr);var vl=u(Wr,2),ml=g(vl);f(vl),f(ll),f(Wa),f(Va),f(Ja),f(J);var Sl=u(J,2),el=g(Sl),or=g(el),tc=g(or),pe=g(tc),rt=g(pe);EA(rt,{size:16}),f(pe),un(2),f(tc);var Ft=u(tc,2),Qt=g(Ft);f(Ft),f(or);var xt=u(or,2),eo=g(xt);Vt(eo),eo.__input=[KA];var Is=u(eo,2);Se(Is,()=>s().playing,Wt=>{var vt=uL();vt.__click=_e;var $t=g(vt);NA($t,{size:16}),f(vt),O(Wt,vt)},Wt=>{var vt=pL();vt.__click=[UA];var $t=g(vt);RA($t,{size:16}),f(vt),O(Wt,vt)}),f(xt);var Po=u(xt,2);Ns(Po,20,()=>[.5,1,2,5,10],dn,(Wt,vt)=>{var $t=fL();$t.__click=[vL,vt];var zo=g($t);f($t),we(()=>{Pn($t,`speed-chip ${(s().speed===vt?"active":"")??""} svelte-112gz12`),Ye(zo,`${vt??""}x`)}),O(Wt,$t)}),f(Po),f(el),f(Sl);var Ze=u(Sl,2),Ke=g(Ze),ps=g(Ke),pn=g(ps),Jo=u(g(pn),2);we(()=>St(Jo,"title",n(w).toFixed(2)));var ti=g(Jo,!0);we(()=>Ye(ti,n(w).toFixed(2))),f(Jo),f(pn),un(2),f(ps);var mr=u(ps,2),sa=g(mr);sa.__click=[XA,P,A,B,F,R,N,$],f(mr),f(Ke),f(Ze);var yt=u(Ze,2),wt=g(yt);wt.__click=[gL,T];var to=u(wt,2);to.__click=[mL,T],f(yt);var mt=u(yt,2);Se(mt,()=>n(T)==="portfolio",Wt=>{var vt=ML(),$t=_t(vt);Se($t,()=>(s().pendingOrders||[]).length>0,bo=>{var xo=yL(),Zo=g(xo),os=u(g(Zo),2);Ns(os,1,()=>s().pendingOrders,dn,(ri,vn)=>{var sr=_L(),Ko=g(sr),Hn=g(Ko),ji=g(Hn,!0);f(Hn);var zn=u(Hn,2),Vs=g(zn);f(zn);var Bn=u(zn,2),tr=g(Bn);we(()=>Ye(tr,`Price ${n(vn).price.toFixed(2)??""}`)),f(Bn),f(Ko);var lr=u(Ko,2),Ui=g(lr);Ui.__click=[hL,he,vn],f(lr),f(sr),we(()=>{Ye(ji,n(vn).symbol.ticker),Ye(Vs,`Qty ${n(vn).quantity??""}`)}),O(ri,sr)}),f(Zo),f(xo),O(bo,xo)});var zo=u($t,2);Ns(zo,1,()=>s().positions,dn,(bo,xo)=>{var Zo=IL(),os=g(Zo),ri=g(os),vn=g(ri),sr=g(vn),Ko=g(sr,!0);f(sr);var Hn=u(sr,2),ji=g(Hn);f(Hn);var zn=u(Hn,2),Vs=g(zn);we(()=>Ye(Vs,`Avg ${n(xo).avgCost.toFixed(2)??""}`)),f(zn);var Bn=u(zn,2),tr=g(Bn);f(Bn),f(vn);var lr=u(vn,2),Ui=g(lr),_a=g(Ui);we(()=>Ye(_a,`${((n(w)-n(xo).avgCost)*n(xo).quantity*(n(xo).leverage||1)>=0?"+":"")??""}${((n(w)-n(xo).avgCost)*n(xo).quantity*(n(xo).leverage||1)).toFixed(2)??""}`)),f(Ui);var qi=u(Ui,2);Se(qi,()=>n(L)===n(xo).id,cr=>{var Dn=xL();Dn.__click=[bL,L,S],O(cr,Dn)},cr=>{var Dn=kL();Dn.__click=[wL,De,xo],O(cr,Dn)}),f(lr),f(ri);var ai=u(ri,2);Se(ai,()=>n(L)===n(xo).id,cr=>{var Dn=PL(),kr=g(Dn),Me=g(kr),Xe=g(Me),X=g(Xe);f(Xe);var Le=u(Xe,2);Le.__click=[SL,ge],f(Me),f(kr);var nt=u(kr,2),et=u(g(nt),2),ht=g(et);Vt(ht);var uo=u(ht,2);uo.__click=[CL,ge],we(()=>uo.disabled=!n(S)||Number(n(S))<=0||Number(n(S))>n(xo).quantity),f(et);var ut=u(et,2),Jt=g(ut),fo=g(Jt);f(Jt);var lo=u(Jt,2),so=g(lo);we(()=>Ye(so,`Est. PnL: ${((n(w)-n(xo).avgCost)*(Number(n(S))||0)*(n(xo).leverage||1)).toFixed(2)??""}`)),f(lo),f(ut),f(nt),f(Dn),we(()=>{Ye(X,`Close entire position (${n(xo).quantity??""})`),St(ht,"max",n(xo).quantity),Ye(fo,`Available: ${n(xo).quantity??""}`)}),go(ht,()=>n(S),ko=>b(S,ko)),O(cr,Dn)}),f(os),f(Zo),we(()=>{Ye(Ko,n(xo).symbol.ticker),Ye(ji,`Qty ${n(xo).quantity??""}`),Ye(tr,`Lev ${(n(xo).leverage||1)??""}x`),Pn(Ui,`badge ${((n(w)-n(xo).avgCost)*n(xo).quantity*(n(xo).leverage||1)>=0?"badge-success":"badge-error")??""}`)}),O(bo,Zo)}),O(Wt,vt)},Wt=>{var vt=AL(),$t=_t(vt),zo=g($t),bo=g(zo),xo=g(bo),Zo=u(g(xo),2),os=g(Zo),ri=g(os,!0);f(os);var vn=u(os,2);we(()=>St(vn,"title",be(n(se))));var sr=g(vn,!0);we(()=>Ye(sr,be(n(se)))),f(vn),f(Zo),f(xo);var Ko=u(xo,2),Hn=u(g(Ko),2),ji=g(Hn),zn=g(ji,!0);f(ji);var Vs=u(ji,2);we(()=>St(Vs,"title",be(n(ie))));var Bn=g(Vs,!0);we(()=>Ye(Bn,be(n(ie)))),f(Vs),f(Hn),f(Ko);var tr=u(Ko,2),lr=u(g(tr),2),Ui=g(lr);we(()=>St(Ui,"title",be(n(Y))));var _a=g(Ui);we(()=>Ye(_a,`${(n(Y)>=0?"+":"")??""}${be(n(Y))??""}`)),f(Ui),f(lr),f(tr),f(bo),f(zo),f($t);var qi=u($t,2);Ns(qi,1,()=>s().history,dn,(ai,cr)=>{var Dn=TL(),kr=g(Dn),Me=g(kr),Xe=g(Me),X=g(Xe),Le=g(X,!0);f(X);var nt=u(X,2),et=g(nt);f(nt),f(Xe);var ht=u(Xe,2),uo=g(ht);we(()=>Ye(uo,`${(n(cr).pnl>=0?"+":"")??""}${n(cr).pnl.toFixed(2)??""}`)),f(ht),f(Me);var ut=u(Me,2);const Jt=We(()=>n(cr).avgCost.toFixed(2)??""),fo=We(()=>n(cr).closedAvg.toFixed(2)??"");var lo=g(ut);we(()=>Ye(lo,`Buy ${n(Jt)} • Sell ${n(fo)}`)),f(ut),f(kr),f(Dn),we(()=>{Ye(Le,n(cr).symbol.ticker),Ye(et,`Qty ${n(cr).quantity??""}`),Pn(ht,`badge ${(n(cr).pnl>=0?"badge-success":"badge-error")??""}`)}),O(ai,Dn)}),we(()=>{Ye(ri,n(Z)),Ye(zn,n(le)),Pn(tr,`summary-tile net ${(n(Y)>=0?"pos":"neg")??""} svelte-112gz12`)}),O(Wt,vt)}),we(()=>{Sn(en,"pos",n(V)&&n(U)>=0),Sn(en,"neg",n(V)&&n(U)<0),Ye(rr,`Open ${(s().positions||[]).length??""}`),Ye(ml,`Leverage ${(s().leverage||1)??""}x`),Ye(Qt,`${s().speed??""}x`),Vu(eo,s().speed),St(eo,"style",`background: linear-gradient(to right, var(--menu-active-bg) ${n(K)}%, var(--menu-btn-bg) ${n(K)}%);`),Pn(wt,`tab ${(n(T)==="portfolio"?"tab-active":"")??""} svelte-112gz12`),Pn(to,`tab ${(n(T)==="history"?"tab-active":"")??""} svelte-112gz12`)}),O(xe,ke)},!0),O(ye,Ae)}),f(Ve);var Je=u(Ve,2);Se(Je,()=>n(P),ye=>{Pu(ye,{title:"Place Buy Order",buttons:[],get show(){return n(P)},set show(Ae){b(P,j(Ae))},get theme(){return i().theme},children:(Ae,ee)=>{var xe=BL(),ke=g(xe),He=u(g(ke),2),Ie=g(He);Vt(Ie),Ie.__click=[FL,A],un(2),f(He);var ne=u(He,2),J=g(ne);Vt(J),J.__click=[DL,A],un(2),f(ne),f(ke);var qe=u(ke,2);Se(qe,()=>n(A)==="instant",ft=>{var Qe=$L(),Oe=g(Qe),ct=g(Oe),Lt=g(ct),It=u(g(Lt),2);we(()=>St(It,"title",n(w).toFixed(2)));var zt=g(It,!0);we(()=>Ye(zt,n(w).toFixed(2))),f(It),f(Lt);var pt=u(Lt,2),Mo=g(pt);Vt(Mo);var Xo=u(Mo,2);Xo.__click=[JA,N,w,B,ze,_e,q,r,a,i,l,s,P],f(pt);var en=u(pt,2);Se(en,()=>n(N),Fo=>{var Eo=EL(),cs=g(Eo,!0);f(Eo),we(()=>Ye(cs,n(N))),O(Fo,Eo)}),f(ct),f(Oe),f(Qe),go(Mo,()=>n(B),Fo=>b(B,Fo)),O(ft,Qe)},ft=>{var Qe=zL(),Oe=g(Qe),ct=g(Oe);Vt(ct);var Lt=u(ct,2);Vt(Lt),f(Oe);var It=u(Oe,2);It.__click=[QA,$,F,R,ze,w,r,a,q,i,l,s,P];var zt=u(It,2);Se(zt,()=>n($),pt=>{var Mo=jL(),Xo=g(Mo,!0);f(Mo),we(()=>Ye(Xo,n($))),O(pt,Mo)}),f(Qe),go(ct,()=>n(F),pt=>b(F,pt)),go(Lt,()=>n(R),pt=>b(R,pt)),O(ft,Qe)}),f(xe),we(()=>{tp(Ie,n(A)==="instant"),tp(J,n(A)==="pending")}),O(Ae,xe)},$$slots:{default:!0}})}),O(o,$e),Za()}hc(["click","input"]);var OL=de('<div class="top-section svelte-3gnxyq"><div class="section-card svelte-3gnxyq"><button class="sidebar-icon svelte-3gnxyq" title="Watch List"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><path d="M8 6H21M8 12H21M8 18H21M3 6H3.01M3 12H3.01M3 18H3.01" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Watch</span></button> <button class="sidebar-icon svelte-3gnxyq" title="Alerts"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><path d="M18 8A6 6 0 0 0 6 8C6 15 3 17 3 17H21S18 15 18 8Z" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path><path d="M13.73 21A2 2 0 0 1 10.27 21" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Alerts</span></button> <button class="sidebar-icon ask-ai-btn svelte-3gnxyq" title="Ask AI"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path><path d="M12 12C13.1046 12 14 11.1046 14 10C14 8.89543 13.1046 8 12 8C10.8954 8 10 8.89543 10 10C10 11.1046 10.8954 12 12 12Z" fill="currentColor" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Ask AI</span></button></div></div> <div class="bottom-section svelte-3gnxyq"><div class="section-card svelte-3gnxyq"><button class="sidebar-icon svelte-3gnxyq" title="Calendar"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="0.5" class="svelte-3gnxyq"></rect><line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" class="svelte-3gnxyq"></line><line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" class="svelte-3gnxyq"></line><line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="0.5" class="svelte-3gnxyq"></line></svg> <span class="sidebar-label svelte-3gnxyq">Calendar</span></button> <button class="sidebar-icon svelte-3gnxyq" title="Portfolio"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-3gnxyq"><rect x="2" y="7" width="20" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="0.5" class="svelte-3gnxyq"></rect><path d="M16 21V5A2 2 0 0 0 14 3H10A2 2 0 0 0 8 5V21" stroke="currentColor" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-3gnxyq"></path></svg> <span class="sidebar-label svelte-3gnxyq">Portfolio</span></button></div></div>',1),VL=de("<div><!></div>");function WL(o,e){Ka(e,!1);const t=Zc(),s=()=>ir(a,"$save",t),i=()=>ir(Td,"$simulator",t);let r=Ss(e,"className",8,"");const a=Fa("save");Ud();var l=VL(),d=g(l);Se(d,()=>i().mode==="strategy",v=>{RL(v,{})},v=>{var p=OL();un(2),O(v,p)}),f(l),we(()=>{Pn(l,`right-sidebar hidden md:flex ${r()??""} svelte-3gnxyq`),St(l,"data-theme",s().theme)}),O(o,l),Za()}function qL(o,e){o.preventDefault(),o.stopPropagation(),e("double-click")}var HL=de('<div role="separator" aria-orientation="vertical" aria-label="Resize sidebar" tabindex="0"><div class="resize-indicator svelte-uwsrre"><div class="resize-dots svelte-uwsrre"><div class="dot svelte-uwsrre"></div> <div class="dot svelte-uwsrre"></div> <div class="dot svelte-uwsrre"></div></div></div></div>');function GL(o,e){Ka(e,!0);let t=Ss(e,"className",3,"");const s=Md();let i=oe(!1),r=0,a=0,l;const d=180,v=480,p=12;function _(A){if(A.button!==0)return;A.preventDefault(),A.stopPropagation(),b(i,!0),r=A.clientX;const F=l.closest(".sidebar-container");F&&(a=F.offsetWidth),l.setPointerCapture(A.pointerId),document.body.style.userSelect="none",document.body.style.pointerEvents="none",l.style.pointerEvents="auto",s("resize:start",{widthPx:a})}function y(A){if(!n(i))return;A.preventDefault(),A.stopPropagation();const F=A.clientX-r,B=Math.max(d,Math.min(v,a-F));requestAnimationFrame(()=>{s("resize:move",{widthPx:B})})}function w(A){if(!n(i))return;A.preventDefault(),A.stopPropagation(),b(i,!1),l.releasePointerCapture(A.pointerId),document.body.style.userSelect="",document.body.style.pointerEvents="",l.style.pointerEvents="";const F=A.clientX-r,B=Math.max(d,Math.min(v,a-F));s("resize:end",{widthPx:B})}function k(A){n(i)&&(b(i,!1),l.releasePointerCapture(A.pointerId),document.body.style.userSelect="",document.body.style.pointerEvents="",l.style.pointerEvents="",s("resize:end",{widthPx:a}))}function S(A){if(!["ArrowLeft","ArrowRight"].includes(A.key))return;A.preventDefault(),A.stopPropagation();const F=l.closest(".sidebar-container");if(!F)return;const B=F.offsetWidth;let R=B;A.key==="ArrowLeft"?R=Math.min(v,B+p):A.key==="ArrowRight"&&(R=Math.max(d,B-p)),R!==B&&(s("resize:start",{widthPx:B}),s("resize:move",{widthPx:R}),s("resize:end",{widthPx:R}))}function L(){}function T(){}var P=HL();P.__pointerdown=_,P.__pointermove=y,P.__pointerup=w,P.__dblclick=[qL,s],P.__keydown=S,Ec(P,A=>l=A,()=>l),we(()=>{Pn(P,`sidebar-resize-handle ${t()??""} svelte-uwsrre`),Sn(P,"dragging",n(i))}),Fl("pointercancel",P,k),Fl("focus",P,L),Fl("blur",P,T),O(o,P),Za()}hc(["pointerdown","pointermove","pointerup","dblclick","keydown"]);const B0=180,eh=480,D0=280;function xx(o,e=B0,t=eh,s=D0){return isNaN(o)||o<e||o>t?s:o}function $m(){return typeof window<"u"&&window.__sidebarBootstrap?window.__sidebarBootstrap:{visible:!1,widthPx:0,transitionsEnabled:!1}}function x1(o){if(typeof window<"u"){window.__sidebarBootstrap||(window.__sidebarBootstrap=$m()),window.__sidebarBootstrap={...window.__sidebarBootstrap,...o};const e=document.documentElement,t=window.__sidebarBootstrap,s=t.visible?t.widthPx+"px":"0px",i=t.visible?"1":"0";e.style.setProperty("--sidebar-width",s),e.style.setProperty("--sidebar-visible",i),e.style.setProperty("--chart-sidebar-width",s),e.style.setProperty("--chart-sidebar-visible",i)}}function YL(o,e){if(typeof window<"u"&&window.localStorage)try{if(localStorage.setItem("dutyai.chart.sidebar.visible","false"),o){const t=xx(e,B0,eh,D0);localStorage.setItem("dutyai.chart.sidebar.widthPx",String(t))}}catch(t){console.warn("Failed to persist sidebar state:",t)}}function UL(){if(typeof window>"u")return!0;const o=window.innerWidth,s=B0+80+300;return o>=s}function Dy(){x1({transitionsEnabled:!0})}function KL(){x1({transitionsEnabled:!1})}function b_(o,e){const t=e!==void 0?e:o?D0:0;x1({visible:o,widthPx:o?xx(t,B0,eh,D0):0}),YL(o,t)}const ZL={MIN_WIDTH:B0,MAX_WIDTH:eh,DEFAULT_WIDTH:D0,PRICE_SCALE_WIDTH:80};class XL{constructor(){re(this,"pending",!1);re(this,"callbacks",[]);re(this,"rafId",null)}request(e){this.callbacks.push(e),!this.pending&&(this.pending=!0,this.rafId=requestAnimationFrame(async()=>{this.pending=!1,this.rafId=null;const t=[...this.callbacks];this.callbacks=[];for(const s of t)try{await s()}catch(i){console.error("RenderScheduler: Error executing callback",i)}}))}cancel(){this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.pending=!1,this.callbacks=[]}isPending(){return this.pending}immediate(e){requestAnimationFrame(async()=>{try{await e()}catch(t){console.error("RenderScheduler: Error executing immediate callback",t)}})}}let x_=null;function th(){return x_||(x_=new XL),x_}class JL{constructor(){re(this,"scheduler",th());re(this,"inProgress",!1);re(this,"queue",[])}async run(e){if(this.inProgress){this.queue.push(e);return}this.inProgress=!0;try{await this.executeTransaction(e)}finally{if(this.inProgress=!1,this.queue.length>0){const t=this.queue.shift();this.run(t)}}}async executeTransaction(e){const{reason:t,chart:s,mutateState:i,measure:r,compute:a,draw:l,commit:d,cleanup:v,skipTransitions:p}=e;console.log(`🔄 RenderTransaction [${t}] starting...`);const _=performance.now();this.scheduler.request(async()=>{try{i&&await i(),r&&await r(),a&&await a(),l&&s&&await l(s),d&&await d();const y=performance.now()-_;console.log(`✅ RenderTransaction [${t}] completed in ${y.toFixed(2)}ms`)}catch(y){console.error(`❌ RenderTransaction [${t}] failed:`,y)}finally{v&&v()}})}async batch(e){if(e.length===0)return;const t={reason:e[0].reason,chart:e[0].chart,mutateState:async()=>{for(const s of e)s.mutateState&&await s.mutateState()},measure:async()=>{for(const s of e)s.measure&&await s.measure()},compute:async()=>{for(const s of e)s.compute&&await s.compute()},draw:async s=>{for(const i of e)i.draw&&await i.draw(s)},commit:async()=>{for(const s of e)s.commit&&await s.commit()},cleanup:()=>{for(const s of e)s.cleanup&&s.cleanup()}};await this.run(t)}isInProgress(){return this.inProgress}getQueueLength(){return this.queue.length}}let w_=null;function QL(){return w_||(w_=new JL),w_}class eF{constructor(){re(this,"states",new Map);re(this,"transitionProperty","transition")}register(e,t){this.states.set(e,{enabled:!1,element:t})}disable(e){const t=this.states.get(e);t&&(t.enabled=!1,t.element&&this.applyTransitionStyle(t.element,"none"))}enable(e){const t=this.states.get(e);t&&(t.enabled=!0,t.element&&this.applyTransitionStyle(t.element,""))}withoutTransitions(e,t){this.disable(e);const s=t();return requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.enable(e)})}),s}applyLayout(e,t,s=!0){this.disable(e),t(),s&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.enable(e)})})}isEnabled(e){var t;return((t=this.states.get(e))==null?void 0:t.enabled)??!1}updateElement(e,t){const s=this.states.get(e);s?(s.element=t,s.enabled?this.applyTransitionStyle(t,""):this.applyTransitionStyle(t,"none")):this.register(e,t)}applyTransitionStyle(e,t){e.style.setProperty(this.transitionProperty,t)}clear(){this.states.clear()}getKeys(){return Array.from(this.states.keys())}}let k_=null;function wx(){return k_||(k_=new eF),k_}class tF{constructor(){re(this,"rafId",null);re(this,"pending",!1);re(this,"lastArgs",null)}throttle(e,...t){this.lastArgs=t,!this.pending&&(this.pending=!0,this.rafId=requestAnimationFrame(async()=>{this.pending=!1,this.rafId=null;const s=this.lastArgs;this.lastArgs=null;try{await e(...s)}catch(i){console.error("Throttler: Error executing function",i)}}))}cancel(){this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.pending=!1,this.lastArgs=null}isPending(){return this.pending}}class oF{constructor(){re(this,"transaction",QL());re(this,"layoutManager",wx());re(this,"scheduler",th());re(this,"applyCanvasColorsFn",null)}async waitIndicatorReady(e,t,s,i=800){var a;const r=Date.now();for(;Date.now()-r<i;){try{const l=((a=e.getIndicators)==null?void 0:a.call(e,{name:t,paneId:s}))??[];if(l.length>0&&l.some(v=>v&&v.result&&Object.keys(v.result).length>0))return}catch{}await new Promise(l=>setTimeout(l,16))}}setApplyCanvasColorsFunction(e){this.applyCanvasColorsFn=e}reapplyCanvasColors(){this.applyCanvasColorsFn&&this.applyCanvasColorsFn()}async addIndicator(e){let t=null;return await this.transaction.run({reason:"indicator",chart:e.chart,mutateState:()=>{t=e.chart.createIndicator({name:e.name,calcParams:e.params},e.isMain??!1,e.paneId?{id:e.paneId}:void 0)},compute:async()=>{await this.waitIndicatorReady(e.chart,e.name,e.paneId)},commit:()=>{console.log(`✅ Indicator added: ${e.name} (${t})`),this.scheduler.request(()=>{this.reapplyCanvasColors()})}}),t}async removeIndicator(e){await this.transaction.run({reason:"indicator",chart:e.chart,mutateState:()=>{e.chart.removeIndicator({paneId:e.paneId,name:e.name})},commit:()=>{console.log(`✅ Indicator removed: ${e.name}`)}})}async changeTimeframe(e){await this.transaction.run({reason:"timeframe",chart:e.chart,compute:async()=>{await e.loadDataFn()},commit:()=>{console.log("✅ Timeframe changed"),this.scheduler.request(()=>{this.reapplyCanvasColors()})}})}async switchChartType(e){await this.transaction.run({reason:"type",chart:e.chart,mutateState:()=>{},compute:async()=>{await e.reloadDataFn()},commit:()=>{console.log(`✅ Chart type switched to: ${e.newType}`),this.scheduler.request(()=>{this.reapplyCanvasColors()})}})}async sidebarOperation(e){const t="sidebar";this.layoutManager.register(t),await this.transaction.run({reason:"sidebar",chart:e.chart,skipTransitions:!0,mutateState:()=>{this.layoutManager.disable(t)},measure:()=>{},commit:()=>{this.scheduler.request(()=>{e.chart.resize(),this.reapplyCanvasColors(),requestAnimationFrame(()=>{this.layoutManager.enable(t)})})}})}async changeTheme(e,t){await this.transaction.run({reason:"theme",chart:e,mutateState:()=>{t()},commit:()=>{console.log("✅ Theme changed")}})}resizeChart(e){this.scheduler.request(()=>{e.resize()})}async batchIndicatorOperations(e){const t=e.map(s=>({reason:"indicator",chart:s.operation.chart,mutateState:()=>{s.type==="add"?s.operation.chart.createIndicator({name:s.operation.name,calcParams:s.operation.params},s.operation.isMain??!1,s.operation.paneId?{id:s.operation.paneId}:void 0):s.operation.chart.removeIndicator({paneId:s.operation.paneId,name:s.operation.name})}}));await this.transaction.batch(t)}}let S_=null;function w1(){return S_||(S_=new oF),S_}var sF=de('<div class="sidebar-container svelte-1chwdug"><!> <!></div>'),nF=de("<div><!></div>");function iF(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(d,"$chart",t),i=()=>ir(S,"$sidebarWidth",t),r=()=>ir(v,"$save",t),a=()=>ir(L,"$sidebarState",t);let l=Ss(e,"className",3,"");const d=Fa("chart"),v=Fa("save"),{MIN_WIDTH:p,MAX_WIDTH:_,DEFAULT_WIDTH:y,PRICE_SCALE_WIDTH:w}=ZL,k=$m(),S=Id(k.widthPx);v.update(Pe=>(Pe.showSidebar=k.visible,Pe));const L=Cc([v,S],([Pe,ze])=>({visible:Pe.showSidebar,widthPx:ze})),T=Md();let P=oe(!1);w1();const A=th(),F=wx(),B=new tF;F.register("sidebar");function R(){s()&&A.request(()=>{var Pe;(Pe=s())==null||Pe.resize()})}function N(){s()&&B.throttle(()=>{A.request(()=>{var Pe;(Pe=s())==null||Pe.resize()})})}function $(){if(!s())return;const Pe=i()||y;F.enable("sidebar"),v.update(ze=>(ze.showSidebar=!0,ze)),S.set(Pe),b_(!0,Pe),T("sidebar:toggle",{visible:!0}),requestAnimationFrame(()=>{R(),setTimeout(()=>{R()},100),setTimeout(()=>{R()},250)})}function V(){s()&&(F.enable("sidebar"),v.update(Pe=>(Pe.showSidebar=!1,Pe)),b_(!1,0),T("sidebar:toggle",{visible:!1}),requestAnimationFrame(()=>{R(),setTimeout(()=>{R()},100),setTimeout(()=>{R()},250)}))}function U(){$m().visible?V():$()}function G(Pe){const ze=Math.max(p,Math.min(_,Pe));S.set(ze),r().showSidebar&&b_(!0,ze),T("sidebar:resize:move",{widthPx:ze}),N()}function Z(){return a()}function le(Pe){F.disable("sidebar"),KL(),T("sidebar:resize:start",{widthPx:i()})}function se(Pe){const ze=Pe.detail.widthPx;G(ze)}function ie(Pe){n(P)&&(F.enable("sidebar"),Dy()),T("sidebar:resize:end",{widthPx:i()})}function Y(){G(y)}function K(){!UL()&&r().showSidebar&&V()}function Q(Pe){if(Pe.key==="S"&&!Pe.ctrlKey&&!Pe.metaKey&&!Pe.altKey){const ze=Pe.target;ze.tagName!=="INPUT"&&ze.tagName!=="TEXTAREA"&&!ze.isContentEditable&&(Pe.preventDefault(),U())}}Rd(()=>{(async()=>(F.disable("sidebar"),await Uw(),K(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{b(P,!0),F.enable("sidebar"),Dy(),console.log("✨ Sidebar transitions enabled"),s()&&R()})})))();const Pe=()=>{K()};return window.addEventListener("resize",Pe),window.addEventListener("keydown",Q),()=>{window.removeEventListener("resize",Pe),window.removeEventListener("keydown",Q),B.cancel()}});const q=We(()=>()=>{const Pe=$m(),ze=Pe.visible?`${Pe.widthPx}px`:"0px";return{"--sidebar-width":ze,"--sidebar-visible":Pe.visible?"1":"0","--sidebar-transitions":Pe.transitionsEnabled?"width 200ms cubic-bezier(0.4, 0, 0.2, 1)":"none",width:ze}});var ce=nF();const _e=We(()=>Object.entries(n(q)).map(([Pe,ze])=>`${Pe}: ${ze}`).join("; "));var me=g(ce);return Se(me,()=>a().visible,Pe=>{var ze=sF(),he=g(ze);WL(he,{});var De=u(he,2);GL(De,{$$events:{"resize:start":le,"resize:move":se,"resize:end":ie,"double-click":Y}}),f(ze),we(()=>St(ze,"style",`width: ${i()??""}px;`)),O(Pe,ze)}),f(ce),we(()=>{Pn(ce,`sidebar-host ${l()??""} svelte-1chwdug`),St(ce,"style",n(_e))}),O(o,ce),Za({openSidebar:$,closeSidebar:V,toggleSidebar:U,setSidebarWidth:G,getSidebarState:Z})}const rF=["XAU","XAG","XPT","XPD","CNH"],Ey=new Set(["USD","EUR","GBP","JPY","CHF","CAD","AUD","NZD","SEK","NOK","DKK","SGD","HKD","CNY","INR","KRW","THB","MYR","IDR","PHP","MXN","BRL","ZAR","TRY","PLN","CZK","HUF","RON","ILS","RUB","AED","SAR","QAR","KWD",...rF]),aF=["USDT","USDC","BUSD","DAI","TUSD","FDUSD","USD","BTC","ETH","BNB","SOL","XBT"],lF=["BINANCE","COINBASE","KRAKEN","BYBIT","OKX","BITFINEX","KUCOIN","GATE","MEXC","BITGET"],cF=["OANDA","FXCM","FOREX","FX","DUKASCOPY","PEPPERSTONE","ICMARKETS","IG"];function Om(o){if(typeof o=="number"&&Number.isFinite(o))return o;if(typeof o=="string"){const e=Number(o.trim());if(Number.isFinite(e))return e}}function C_(o){return typeof o=="number"&&Number.isFinite(o)}function jp(o,e,t){return Math.min(t,Math.max(e,Math.trunc(o)))}function kx(o){const e=typeof o.exchange=="string"?o.exchange.trim():"",t=typeof o.ticker=="string"?o.ticker.trim():"";if(!e&&t.includes(":")){const s=t.indexOf(":"),i=t.slice(0,s).trim(),r=t.slice(s+1).trim();return{exchange:i?i.toUpperCase():void 0,ticker:r.toUpperCase()}}return{exchange:e?e.toUpperCase():void 0,ticker:t.toUpperCase()}}function Sx(o){return(o||"").replace(/[^A-Z]/gi,"").toUpperCase()}function Cx(o){const e=(o.market??o.type??"").toString().toLowerCase();if(e.includes("forex")||e==="fx")return"forex";if(e.includes("crypto")||e.includes("coin"))return"crypto";const{exchange:t,ticker:s}=kx(o),i=(t||"").toUpperCase();if(lF.some(a=>i.includes(a)))return"crypto";if(cF.some(a=>i.includes(a)))return"forex";const r=Sx(s);if(r.length>=6){const a=r.slice(0,3),l=r.slice(3,6);if(Ey.has(a)&&Ey.has(l))return"forex"}return aF.some(a=>r.endsWith(a))?"crypto":e.includes("stock")||e.includes("equity")||e.includes("index")?"stock":"unknown"}function ym(o){return Cx(o)}function dF(o){const{ticker:e}=kx(o),t=Sx(e),s=t.slice(0,3),i=t.slice(3,6);return s==="XAU"||s==="XAG"||s==="XPT"||s==="XPD"||i==="JPY"?3:5}function uF(o,e){if(!Number.isFinite(o))return 0;try{const t=o.toFixed(e).replace(/\.?0+$/,""),s=t.indexOf(".");return s===-1?0:t.length-s-1}catch{return 0}}function P_(o){if(!Array.isArray(o)||o.length===0)return;const e=o.slice(Math.max(0,o.length-200));let t=0;for(const s of e){const i=[s.open,s.high,s.low,s.close];for(const r of i){const a=Om(r);if(a!=null&&(t=Math.max(t,uF(a,12)),t>=12))return 12}}return t}function pF(o){var e;if(!(!Array.isArray(o)||o.length===0))for(let t=o.length-1;t>=0;t--){const s=(e=o[t])==null?void 0:e.close,i=Om(s);if(i!=null)return i}}function bm(o,e){const t=Cx(o);if(t==="forex"){const a=dF(o),l=Om(o==null?void 0:o.pricePrecision),d=e?P_(e):void 0,v=Math.max(a,l??0,C_(d)?d:0);return jp(v,0,12)}const s=o==null?void 0:o.pricePrecision,i=Om(s);if(t==="stock")return i!=null?jp(i,0,12):2;const r=e?P_(e):void 0;if(C_(r))return jp(r,2,12);if(t==="crypto"){const a=e?P_(e):void 0,l=C_(a)?a:i??6,d=Math.abs(pF(e)??NaN);return Number.isFinite(d)?d>=1e3?jp(l,2,2):d>=1?jp(l,2,4):d>=.01?jp(l,4,8):jp(l,6,12):jp(l,2,12)}return i!=null?jp(i,0,12):2}var Px={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(o,e){(function(t,s){o.exports=s()})(Op,function t(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},i=!s.document&&!!s.postMessage,r=s.IS_PAPA_WORKER||!1,a={},l=0,d={parse:function($,V){var U=(V=V||{}).dynamicTyping||!1;if(N(U)&&(V.dynamicTypingFunction=U,U={}),V.dynamicTyping=U,V.transform=!!N(V.transform)&&V.transform,V.worker&&d.WORKERS_SUPPORTED){var G=function(){if(!d.WORKERS_SUPPORTED)return!1;var le=(ie=s.URL||s.webkitURL||null,Y=t.toString(),d.BLOB_URL||(d.BLOB_URL=ie.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Y,")();"],{type:"text/javascript"})))),se=new s.Worker(le),ie,Y;return se.onmessage=P,se.id=l++,a[se.id]=se}();return G.userStep=V.step,G.userChunk=V.chunk,G.userComplete=V.complete,G.userError=V.error,V.step=N(V.step),V.chunk=N(V.chunk),V.complete=N(V.complete),V.error=N(V.error),delete V.worker,void G.postMessage({input:$,config:V,workerId:G.id})}var Z=null;return d.NODE_STREAM_INPUT,typeof $=="string"?($=function(le){return le.charCodeAt(0)===65279?le.slice(1):le}($),Z=V.download?new _(V):new w(V)):$.readable===!0&&N($.read)&&N($.on)?Z=new k(V):(s.File&&$ instanceof File||$ instanceof Object)&&(Z=new y(V)),Z.stream($)},unparse:function($,V){var U=!1,G=!0,Z=",",le=`\r
`,se='"',ie=se+se,Y=!1,K=null,Q=!1;(function(){if(typeof V=="object"){if(typeof V.delimiter!="string"||d.BAD_DELIMITERS.filter(function(me){return V.delimiter.indexOf(me)!==-1}).length||(Z=V.delimiter),(typeof V.quotes=="boolean"||typeof V.quotes=="function"||Array.isArray(V.quotes))&&(U=V.quotes),typeof V.skipEmptyLines!="boolean"&&typeof V.skipEmptyLines!="string"||(Y=V.skipEmptyLines),typeof V.newline=="string"&&(le=V.newline),typeof V.quoteChar=="string"&&(se=V.quoteChar),typeof V.header=="boolean"&&(G=V.header),Array.isArray(V.columns)){if(V.columns.length===0)throw new Error("Option columns is empty");K=V.columns}V.escapeChar!==void 0&&(ie=V.escapeChar+se),(typeof V.escapeFormulae=="boolean"||V.escapeFormulae instanceof RegExp)&&(Q=V.escapeFormulae instanceof RegExp?V.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var q=new RegExp(L(se),"g");if(typeof $=="string"&&($=JSON.parse($)),Array.isArray($)){if(!$.length||Array.isArray($[0]))return ce(null,$,Y);if(typeof $[0]=="object")return ce(K||Object.keys($[0]),$,Y)}else if(typeof $=="object")return typeof $.data=="string"&&($.data=JSON.parse($.data)),Array.isArray($.data)&&($.fields||($.fields=$.meta&&$.meta.fields||K),$.fields||($.fields=Array.isArray($.data[0])?$.fields:typeof $.data[0]=="object"?Object.keys($.data[0]):[]),Array.isArray($.data[0])||typeof $.data[0]=="object"||($.data=[$.data])),ce($.fields||[],$.data||[],Y);throw new Error("Unable to serialize unrecognized input");function ce(me,Pe,ze){var he="";typeof me=="string"&&(me=JSON.parse(me)),typeof Pe=="string"&&(Pe=JSON.parse(Pe));var De=Array.isArray(me)&&0<me.length,ge=!Array.isArray(Pe[0]);if(De&&G){for(var be=0;be<me.length;be++)0<be&&(he+=Z),he+=_e(me[be],be);0<Pe.length&&(he+=le)}for(var $e=0;$e<Pe.length;$e++){var Ve=De?me.length:Pe[$e].length,Ce=!1,Je=De?Object.keys(Pe[$e]).length===0:Pe[$e].length===0;if(ze&&!De&&(Ce=ze==="greedy"?Pe[$e].join("").trim()==="":Pe[$e].length===1&&Pe[$e][0].length===0),ze==="greedy"&&De){for(var ye=[],Ae=0;Ae<Ve;Ae++){var ee=ge?me[Ae]:Ae;ye.push(Pe[$e][ee])}Ce=ye.join("").trim()===""}if(!Ce){for(var xe=0;xe<Ve;xe++){0<xe&&!Je&&(he+=Z);var ke=De&&ge?me[xe]:xe;he+=_e(Pe[$e][ke],xe)}$e<Pe.length-1&&(!ze||0<Ve&&!Je)&&(he+=le)}}return he}function _e(me,Pe){if(me==null)return"";if(me.constructor===Date)return JSON.stringify(me).slice(1,25);var ze=!1;Q&&typeof me=="string"&&Q.test(me)&&(me="'"+me,ze=!0);var he=me.toString().replace(q,ie);return(ze=ze||U===!0||typeof U=="function"&&U(me,Pe)||Array.isArray(U)&&U[Pe]||function(De,ge){for(var be=0;be<ge.length;be++)if(-1<De.indexOf(ge[be]))return!0;return!1}(he,d.BAD_DELIMITERS)||-1<he.indexOf(Z)||he.charAt(0)===" "||he.charAt(he.length-1)===" ")?se+he+se:he}}};if(d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!s.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=T,d.ParserHandle=S,d.NetworkStreamer=_,d.FileStreamer=y,d.StringStreamer=w,d.ReadableStreamStreamer=k,s.jQuery){var v=s.jQuery;v.fn.parse=function($){var V=$.config||{},U=[];return this.each(function(le){if(!(v(this).prop("tagName").toUpperCase()==="INPUT"&&v(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var se=0;se<this.files.length;se++)U.push({file:this.files[se],inputElem:this,instanceConfig:v.extend({},V)})}),G(),this;function G(){if(U.length!==0){var le,se,ie,Y,K=U[0];if(N($.before)){var Q=$.before(K.file,K.inputElem);if(typeof Q=="object"){if(Q.action==="abort")return le="AbortError",se=K.file,ie=K.inputElem,Y=Q.reason,void(N($.error)&&$.error({name:le},se,ie,Y));if(Q.action==="skip")return void Z();typeof Q.config=="object"&&(K.instanceConfig=v.extend(K.instanceConfig,Q.config))}else if(Q==="skip")return void Z()}var q=K.instanceConfig.complete;K.instanceConfig.complete=function(ce){N(q)&&q(ce,K.file,K.inputElem),Z()},d.parse(K.file,K.instanceConfig)}else N($.complete)&&$.complete()}function Z(){U.splice(0,1),G()}}}function p($){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(V){var U=B(V);U.chunkSize=parseInt(U.chunkSize),V.step||V.chunk||(U.chunkSize=null),this._handle=new S(U),(this._handle.streamer=this)._config=U}).call(this,$),this.parseChunk=function(V,U){if(this.isFirstChunk&&N(this._config.beforeFirstChunk)){var G=this._config.beforeFirstChunk(V);G!==void 0&&(V=G)}this.isFirstChunk=!1,this._halted=!1;var Z=this._partialLine+V;this._partialLine="";var le=this._handle.parse(Z,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var se=le.meta.cursor;this._finished||(this._partialLine=Z.substring(se-this._baseIndex),this._baseIndex=se),le&&le.data&&(this._rowCount+=le.data.length);var ie=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)s.postMessage({results:le,workerId:d.WORKER_ID,finished:ie});else if(N(this._config.chunk)&&!U){if(this._config.chunk(le,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);le=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(le.data),this._completeResults.errors=this._completeResults.errors.concat(le.errors),this._completeResults.meta=le.meta),this._completed||!ie||!N(this._config.complete)||le&&le.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),ie||le&&le.meta.paused||this._nextChunk(),le}this._halted=!0},this._sendError=function(V){N(this._config.error)?this._config.error(V):r&&this._config.error&&s.postMessage({workerId:d.WORKER_ID,error:V,finished:!1})}}function _($){var V;($=$||{}).chunkSize||($.chunkSize=d.RemoteChunkSize),p.call(this,$),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(U){this._input=U,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(V=new XMLHttpRequest,this._config.withCredentials&&(V.withCredentials=this._config.withCredentials),i||(V.onload=R(this._chunkLoaded,this),V.onerror=R(this._chunkError,this)),V.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var U=this._config.downloadRequestHeaders;for(var G in U)V.setRequestHeader(G,U[G])}if(this._config.chunkSize){var Z=this._start+this._config.chunkSize-1;V.setRequestHeader("Range","bytes="+this._start+"-"+Z)}try{V.send(this._config.downloadRequestBody)}catch(le){this._chunkError(le.message)}i&&V.status===0&&this._chunkError()}},this._chunkLoaded=function(){V.readyState===4&&(V.status<200||400<=V.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:V.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(U){var G=U.getResponseHeader("Content-Range");return G===null?-1:parseInt(G.substring(G.lastIndexOf("/")+1))}(V),this.parseChunk(V.responseText)))},this._chunkError=function(U){var G=V.statusText||U;this._sendError(new Error(G))}}function y($){var V,U;($=$||{}).chunkSize||($.chunkSize=d.LocalChunkSize),p.call(this,$);var G=typeof FileReader<"u";this.stream=function(Z){this._input=Z,U=Z.slice||Z.webkitSlice||Z.mozSlice,G?((V=new FileReader).onload=R(this._chunkLoaded,this),V.onerror=R(this._chunkError,this)):V=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Z=this._input;if(this._config.chunkSize){var le=Math.min(this._start+this._config.chunkSize,this._input.size);Z=U.call(Z,this._start,le)}var se=V.readAsText(Z,this._config.encoding);G||this._chunkLoaded({target:{result:se}})},this._chunkLoaded=function(Z){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Z.target.result)},this._chunkError=function(){this._sendError(V.error)}}function w($){var V;p.call(this,$=$||{}),this.stream=function(U){return V=U,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var U,G=this._config.chunkSize;return G?(U=V.substring(0,G),V=V.substring(G)):(U=V,V=""),this._finished=!V,this.parseChunk(U)}}}function k($){p.call(this,$=$||{});var V=[],U=!0,G=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Z){this._input=Z,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){G&&V.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),V.length?this.parseChunk(V.shift()):U=!0},this._streamData=R(function(Z){try{V.push(typeof Z=="string"?Z:Z.toString(this._config.encoding)),U&&(U=!1,this._checkIsFinished(),this.parseChunk(V.shift()))}catch(le){this._streamError(le)}},this),this._streamError=R(function(Z){this._streamCleanUp(),this._sendError(Z)},this),this._streamEnd=R(function(){this._streamCleanUp(),G=!0,this._streamData("")},this),this._streamCleanUp=R(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S($){var V,U,G,Z=Math.pow(2,53),le=-Z,se=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ie=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Y=this,K=0,Q=0,q=!1,ce=!1,_e=[],me={data:[],errors:[],meta:{}};if(N($.step)){var Pe=$.step;$.step=function($e){if(me=$e,De())he();else{if(he(),me.data.length===0)return;K+=$e.data.length,$.preview&&K>$.preview?U.abort():(me.data=me.data[0],Pe(me,Y))}}}function ze($e){return $.skipEmptyLines==="greedy"?$e.join("").trim()==="":$e.length===1&&$e[0].length===0}function he(){return me&&G&&(be("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),G=!1),$.skipEmptyLines&&(me.data=me.data.filter(function($e){return!ze($e)})),De()&&function(){if(!me)return;function $e(Ce,Je){N($.transformHeader)&&(Ce=$.transformHeader(Ce,Je)),_e.push(Ce)}if(Array.isArray(me.data[0])){for(var Ve=0;De()&&Ve<me.data.length;Ve++)me.data[Ve].forEach($e);me.data.splice(0,1)}else me.data.forEach($e)}(),function(){if(!me||!$.header&&!$.dynamicTyping&&!$.transform)return me;function $e(Ce,Je){var ye,Ae=$.header?{}:[];for(ye=0;ye<Ce.length;ye++){var ee=ye,xe=Ce[ye];$.header&&(ee=ye>=_e.length?"__parsed_extra":_e[ye]),$.transform&&(xe=$.transform(xe,ee)),xe=ge(ee,xe),ee==="__parsed_extra"?(Ae[ee]=Ae[ee]||[],Ae[ee].push(xe)):Ae[ee]=xe}return $.header&&(ye>_e.length?be("FieldMismatch","TooManyFields","Too many fields: expected "+_e.length+" fields but parsed "+ye,Q+Je):ye<_e.length&&be("FieldMismatch","TooFewFields","Too few fields: expected "+_e.length+" fields but parsed "+ye,Q+Je)),Ae}var Ve=1;return!me.data.length||Array.isArray(me.data[0])?(me.data=me.data.map($e),Ve=me.data.length):me.data=$e(me.data,0),$.header&&me.meta&&(me.meta.fields=_e),Q+=Ve,me}()}function De(){return $.header&&_e.length===0}function ge($e,Ve){return Ce=$e,$.dynamicTypingFunction&&$.dynamicTyping[Ce]===void 0&&($.dynamicTyping[Ce]=$.dynamicTypingFunction(Ce)),($.dynamicTyping[Ce]||$.dynamicTyping)===!0?Ve==="true"||Ve==="TRUE"||Ve!=="false"&&Ve!=="FALSE"&&(function(Je){if(se.test(Je)){var ye=parseFloat(Je);if(le<ye&&ye<Z)return!0}return!1}(Ve)?parseFloat(Ve):ie.test(Ve)?new Date(Ve):Ve===""?null:Ve):Ve;var Ce}function be($e,Ve,Ce,Je){var ye={type:$e,code:Ve,message:Ce};Je!==void 0&&(ye.row=Je),me.errors.push(ye)}this.parse=function($e,Ve,Ce){var Je=$.quoteChar||'"';if($.newline||($.newline=function(ee,xe){ee=ee.substring(0,1048576);var ke=new RegExp(L(xe)+"([^]*?)"+L(xe),"gm"),He=(ee=ee.replace(ke,"")).split("\r"),Ie=ee.split(`
`),ne=1<Ie.length&&Ie[0].length<He[0].length;if(He.length===1||ne)return`
`;for(var J=0,qe=0;qe<He.length;qe++)He[qe][0]===`
`&&J++;return J>=He.length/2?`\r
`:"\r"}($e,Je)),G=!1,$.delimiter)N($.delimiter)&&($.delimiter=$.delimiter($e),me.meta.delimiter=$.delimiter);else{var ye=function(ee,xe,ke,He,Ie){var ne,J,qe,ft;Ie=Ie||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Qe=0;Qe<Ie.length;Qe++){var Oe=Ie[Qe],ct=0,Lt=0,It=0;qe=void 0;for(var zt=new T({comments:He,delimiter:Oe,newline:xe,preview:10}).parse(ee),pt=0;pt<zt.data.length;pt++)if(ke&&ze(zt.data[pt]))It++;else{var Mo=zt.data[pt].length;Lt+=Mo,qe!==void 0?0<Mo&&(ct+=Math.abs(Mo-qe),qe=Mo):qe=Mo}0<zt.data.length&&(Lt/=zt.data.length-It),(J===void 0||ct<=J)&&(ft===void 0||ft<Lt)&&1.99<Lt&&(J=ct,ne=Oe,ft=Lt)}return{successful:!!($.delimiter=ne),bestDelimiter:ne}}($e,$.newline,$.skipEmptyLines,$.comments,$.delimitersToGuess);ye.successful?$.delimiter=ye.bestDelimiter:(G=!0,$.delimiter=d.DefaultDelimiter),me.meta.delimiter=$.delimiter}var Ae=B($);return $.preview&&$.header&&Ae.preview++,V=$e,U=new T(Ae),me=U.parse(V,Ve,Ce),he(),q?{meta:{paused:!0}}:me||{meta:{paused:!1}}},this.paused=function(){return q},this.pause=function(){q=!0,U.abort(),V=N($.chunk)?"":V.substring(U.getCharIndex())},this.resume=function(){Y.streamer._halted?(q=!1,Y.streamer.parseChunk(V,!0)):setTimeout(Y.resume,3)},this.aborted=function(){return ce},this.abort=function(){ce=!0,U.abort(),me.meta.aborted=!0,N($.complete)&&$.complete(me),V=""}}function L($){return $.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T($){var V,U=($=$||{}).delimiter,G=$.newline,Z=$.comments,le=$.step,se=$.preview,ie=$.fastMode,Y=V=$.quoteChar===void 0||$.quoteChar===null?'"':$.quoteChar;if($.escapeChar!==void 0&&(Y=$.escapeChar),(typeof U!="string"||-1<d.BAD_DELIMITERS.indexOf(U))&&(U=","),Z===U)throw new Error("Comment character same as delimiter");Z===!0?Z="#":(typeof Z!="string"||-1<d.BAD_DELIMITERS.indexOf(Z))&&(Z=!1),G!==`
`&&G!=="\r"&&G!==`\r
`&&(G=`
`);var K=0,Q=!1;this.parse=function(q,ce,_e){if(typeof q!="string")throw new Error("Input must be a string");var me=q.length,Pe=U.length,ze=G.length,he=Z.length,De=N(le),ge=[],be=[],$e=[],Ve=K=0;if(!q)return Xo();if($.header&&!ce){var Ce=q.split(G)[0].split(U),Je=[],ye={},Ae=!1;for(var ee in Ce){var xe=Ce[ee];N($.transformHeader)&&(xe=$.transformHeader(xe,ee));var ke=xe,He=ye[xe]||0;for(0<He&&(Ae=!0,ke=xe+"_"+He),ye[xe]=He+1;Je.includes(ke);)ke=ke+"_"+He;Je.push(ke)}if(Ae){var Ie=q.split(G);Ie[0]=Je.join(U),q=Ie.join(G)}}if(ie||ie!==!1&&q.indexOf(V)===-1){for(var ne=q.split(G),J=0;J<ne.length;J++){if($e=ne[J],K+=$e.length,J!==ne.length-1)K+=G.length;else if(_e)return Xo();if(!Z||$e.substring(0,he)!==Z){if(De){if(ge=[],It($e.split(U)),en(),Q)return Xo()}else It($e.split(U));if(se&&se<=J)return ge=ge.slice(0,se),Xo(!0)}}return Xo()}for(var qe=q.indexOf(U,K),ft=q.indexOf(G,K),Qe=new RegExp(L(Y)+L(V),"g"),Oe=q.indexOf(V,K);;)if(q[K]!==V)if(Z&&$e.length===0&&q.substring(K,K+he)===Z){if(ft===-1)return Xo();K=ft+ze,ft=q.indexOf(G,K),qe=q.indexOf(U,K)}else if(qe!==-1&&(qe<ft||ft===-1))$e.push(q.substring(K,qe)),K=qe+Pe,qe=q.indexOf(U,K);else{if(ft===-1)break;if($e.push(q.substring(K,ft)),Mo(ft+ze),De&&(en(),Q))return Xo();if(se&&ge.length>=se)return Xo(!0)}else for(Oe=K,K++;;){if((Oe=q.indexOf(V,Oe+1))===-1)return _e||be.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ge.length,index:K}),pt();if(Oe===me-1)return pt(q.substring(K,Oe).replace(Qe,V));if(V!==Y||q[Oe+1]!==Y){if(V===Y||Oe===0||q[Oe-1]!==Y){qe!==-1&&qe<Oe+1&&(qe=q.indexOf(U,Oe+1)),ft!==-1&&ft<Oe+1&&(ft=q.indexOf(G,Oe+1));var ct=zt(ft===-1?qe:Math.min(qe,ft));if(q.substr(Oe+1+ct,Pe)===U){$e.push(q.substring(K,Oe).replace(Qe,V)),q[K=Oe+1+ct+Pe]!==V&&(Oe=q.indexOf(V,K)),qe=q.indexOf(U,K),ft=q.indexOf(G,K);break}var Lt=zt(ft);if(q.substring(Oe+1+Lt,Oe+1+Lt+ze)===G){if($e.push(q.substring(K,Oe).replace(Qe,V)),Mo(Oe+1+Lt+ze),qe=q.indexOf(U,K),Oe=q.indexOf(V,K),De&&(en(),Q))return Xo();if(se&&ge.length>=se)return Xo(!0);break}be.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ge.length,index:K}),Oe++}}else Oe++}return pt();function It(Fo){ge.push(Fo),Ve=K}function zt(Fo){var Eo=0;if(Fo!==-1){var cs=q.substring(Oe+1,Fo);cs&&cs.trim()===""&&(Eo=cs.length)}return Eo}function pt(Fo){return _e||(Fo===void 0&&(Fo=q.substring(K)),$e.push(Fo),K=me,It($e),De&&en()),Xo()}function Mo(Fo){K=Fo,It($e),$e=[],ft=q.indexOf(G,K)}function Xo(Fo){return{data:ge,errors:be,meta:{delimiter:U,linebreak:G,aborted:Q,truncated:!!Fo,cursor:Ve+(ce||0)}}}function en(){le(Xo()),ge=[],be=[]}},this.abort=function(){Q=!0},this.getCharIndex=function(){return K}}function P($){var V=$.data,U=a[V.workerId],G=!1;if(V.error)U.userError(V.error,V.file);else if(V.results&&V.results.data){var Z={abort:function(){G=!0,A(V.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:F,resume:F};if(N(U.userStep)){for(var le=0;le<V.results.data.length&&(U.userStep({data:V.results.data[le],errors:V.results.errors,meta:V.results.meta},Z),!G);le++);delete V.results}else N(U.userChunk)&&(U.userChunk(V.results,Z,V.file),delete V.results)}V.finished&&!G&&A(V.workerId,V.results)}function A($,V){var U=a[$];N(U.userComplete)&&U.userComplete(V),U.terminate(),delete a[$]}function F(){throw new Error("Not implemented.")}function B($){if(typeof $!="object"||$===null)return $;var V=Array.isArray($)?[]:{};for(var U in $)V[U]=B($[U]);return V}function R($,V){return function(){$.apply(V,arguments)}}function N($){return typeof $=="function"}return r&&(s.onmessage=function($){var V=$.data;if(d.WORKER_ID===void 0&&V&&(d.WORKER_ID=V.workerId),typeof V.input=="string")s.postMessage({workerId:d.WORKER_ID,results:d.parse(V.input,V.config),finished:!0});else if(s.File&&V.input instanceof File||V.input instanceof Object){var U=d.parse(V.input,V.config);U&&s.postMessage({workerId:d.WORKER_ID,results:U,finished:!0})}}),(_.prototype=Object.create(p.prototype)).constructor=_,(y.prototype=Object.create(p.prototype)).constructor=y,(w.prototype=Object.create(w.prototype)).constructor=w,(k.prototype=Object.create(p.prototype)).constructor=k,d})})(Px);var vF=Px.exports;const fF=j0(vF);function gF(o,e,t,s,i){if(!(!e()||n(t).length===0))switch(o.key){case"ArrowDown":o.preventDefault(),b(s,j(Math.min(n(s)+1,n(t).length-1)));break;case"ArrowUp":o.preventDefault(),b(s,j(Math.max(n(s)-1,-1)));break;case"Enter":o.preventDefault(),n(s)>=0&&n(s)<n(t).length&&i(n(t)[n(s)]);break;case"Escape":o.preventDefault(),e(!1);break}}var mF=de('<div class="flex justify-center py-16"><div class="relative"><div class="w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin"></div> <div class="absolute inset-0 w-12 h-12 border-4 border-transparent border-t-primary/60 rounded-full animate-spin" style="animation-delay: -0.15s;"></div></div></div>'),hF=de('<div class="flex flex-col items-center justify-center py-16 text-center"><div class="w-16 h-16 rounded-full bg-base-200/50 flex items-center justify-center mb-4"><svg class="w-8 h-8 text-base-content/40" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div> <p class="text-lg font-semibold text-base-content/60 mb-2">No symbols found</p> <p class="text-sm text-base-content/40">Try a different search term</p></div>'),_F=(o,e,t)=>e(n(t)),yF=de('<div class="absolute top-0 left-0 w-5 h-5 rounded-full overflow-hidden bg-base-200 ring-2 ring-base-100 z-10"><img class="w-full h-full object-cover"></div> <div class="absolute bottom-0 right-0 w-5 h-5 rounded-full overflow-hidden bg-base-200"><img class="w-full h-full object-cover"></div>',1),bF=de('<div class="relative w-full h-full rounded-lg overflow-hidden bg-base-200/50"><img class="w-full h-full object-cover"> <div class="absolute inset-0 bg-base-200 flex items-center justify-center hidden"><span class="text-xs font-medium text-base-content/60"> </span></div></div>'),xF=de('<span class="text-xs px-1.5 py-0.5 rounded bg-base-200/60 border border-base-300/40 text-base-content/60"> </span>'),wF=de('<p class="text-sm text-base-content/60 truncate mt-0.5"> </p>'),kF=de('<div class="flex-shrink-0"><svg class="w-4 h-4 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></svg></div>'),SF=de('<div><div class="relative w-8 h-8 flex-shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><h3 class="font-medium text-base"> </h3> <span class="text-xs text-base-content/50"> </span> <!></div> <!></div> <!></div>'),CF=de('<div class="flex items-center justify-center py-4"><div class="flex items-center gap-3 text-base-content/60"><div class="relative"><div class="w-6 h-6 border-2 border-primary/20 border-t-primary rounded-full animate-spin"></div> <div class="absolute inset-0 w-6 h-6 border-2 border-transparent border-t-primary/60 rounded-full animate-spin" style="animation-delay: -0.15s;"></div></div> <span class="text-sm">Loading more symbols…</span></div></div>'),PF=de('<div class="divide-y divide-base-300/20"><!> <!></div>'),IF=de('<div class="flex flex-col gap-6"><div class="relative"><div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-base-content/50 pointer-events-none"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div> <input type="text" class="w-full pl-12 pr-4 py-3 text-sm bg-base-100 border border-base-300/50 rounded-lg focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 placeholder:text-base-content/50" placeholder="Search symbols..."></div> <div class="relative rounded-lg overflow-hidden bg-base-100 border border-base-300/30"><div class="h-96 overflow-y-auto luxury-scrollbar svelte-1r1pdks"><!></div></div> <div class="flex justify-center items-center py-2 mt-1"><div class="group relative cursor-pointer"><div class="absolute inset-0 bg-gradient-to-r from-transparent via-primary/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-700 ease-out blur-xl"></div> <div class="relative flex items-center gap-2 px-4 py-1.5 rounded-full bg-gradient-to-r from-base-100/80 to-base-200/60 backdrop-blur-sm border border-base-300/30 shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-500 ease-out"><div class="w-2 h-2 rounded-full bg-gradient-to-r from-primary to-secondary animate-pulse"></div> <span class="text-sm font-medium text-base-content/70 group-hover:text-primary transition-colors duration-300">Powered by</span> <span class="text-sm font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent group-hover:from-secondary group-hover:to-primary transition-all duration-500">Duty AI</span> <div class="w-2 h-2 rounded-full bg-gradient-to-r from-secondary to-primary animate-pulse" style="animation-delay: 0.5s;"></div></div></div></div></div>'),MF=de("<div><!></div>");function TF(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(T,"$save",t),i=()=>ir(d,"$keyword",t),r=()=>ir(L,"$ctx",t);let a=Ss(e,"show",15);const l=vb();let d=Id(""),v=oe(j([]));const p=50;let _=oe(p),y=oe(!1),w,k=oe(j([])),S=oe(-1);const L=Fa("ctx"),T=Fa("save");Wi(()=>{a()&&(console.log("🔍 Modal opened! Available symbols:",s().allSymbols.length),console.log("🔍 Current symbol:",s().symbol),b(v,j(s().allSymbols)),b(_,p),b(S,-1))}),Wi(()=>{b(k,j(n(v).slice(0,n(_))))}),typeof window<"u"&&(window.testSymbolChange=()=>{if(s().allSymbols.length>0){const le=s().allSymbols[1];console.log("🧪 Testing symbol change to:",le),$(le)}else console.log("🧪 No symbols available for testing")});function P(le){return le.toLowerCase().replace(/[^\p{L}\p{N}]+/gu," ").trim()}function A(le){return P(le).split(/\s+/).filter(Boolean).map(ie=>ie[0]).join("")}function F(le,se){const ie=le.length,Y=se.length;if(ie===0)return Y;if(Y===0)return ie;const K=new Array(Y+1);for(let Q=0;Q<=Y;(Q+=1)-1)K[Q]=Q;for(let Q=1;Q<=ie;(Q+=1)-1){let q=Q-1;K[0]=Q;for(let ce=1;ce<=Y;(ce+=1)-1){const _e=K[ce],me=le[Q-1]===se[ce-1]?0:1;K[ce]=Math.min(K[ce]+1,K[ce-1]+1,q+me),q=_e}}return K[Y]}function B(le,se){const ie=Math.max(le.length,se.length);return ie===0?1:1-F(le,se)/ie}function R(le,se){if(!se||!se.trim())return le;const Y=P(se).split(/\s+/).filter(Boolean);return le.map(Q=>{const q=Q.ticker.toLowerCase(),ce=Q.shortName||"";ce.toLowerCase();const _e=P(ce),me=_e.split(/\s+/).filter(Boolean),Pe=(Q.exchange||"").toLowerCase(),ze=A(ce);let he=0,De=0;for(const ge of Y){let be=0;q===ge?be+=1200:q.startsWith(ge)?be+=800:q.includes(ge)?be+=600:ze===ge||ze.startsWith(ge)?be+=450:_e.startsWith(ge)?be+=500:_e.includes(ge)?be+=300:Pe.includes(ge)?be+=80:N(q,ge)?be+=60:N(_e,ge)&&(be+=40);const $e=B(q,ge);$e>.5&&(be+=Math.floor($e*300));let Ve=0;for(const Ce of me){const Je=B(Ce,ge);if(Je>Ve&&(Ve=Je),Ve>=.92)break}Ve>.5&&(be+=Math.floor(Ve*200)),be>0&&(De+=1),he+=be}return De===Y.length?he+=100:he+=De*50,he>0&&q.length<=5&&(he+=20),{symbol:Q,score:he}}).filter(Q=>Q.score>0).sort((Q,q)=>q.score!==Q.score?q.score-Q.score:Q.symbol.ticker.localeCompare(q.symbol.ticker)).map(Q=>Q.symbol)}function N(le,se){let ie=0;for(let Y=0;Y<le.length&&ie<se.length;(Y+=1)-1)le[Y]===se[ie]&&(ie+=1);return ie===se.length}d.subscribe(le=>{if(!le||!le.trim()){b(v,j(s().allSymbols)),b(_,p),b(S,-1);return}b(v,j(R(s().allSymbols,le))),b(_,p),b(S,-1)});function $(le){try{eb({logo:le.logo,logo2:le.logo2})}catch{}Ir(T,Uo(s).symbol=le,Uo(s)),a(!1)}async function V(){n(y)||n(_)>=n(v).length||(b(y,!0),await new Promise(le=>setTimeout(le,250)),b(_,j(Math.min(n(_)+p,n(v).length))),b(y,!1))}function U(le){const se=le.currentTarget;se.scrollTop+se.clientHeight>=se.scrollHeight-24&&V()}var G=MF();G.__keydown=[gF,a,k,S,$];var Z=g(G);Pu(Z,{title:l,width:650,maxHeight:"85vh",get show(){return a()},set show(le){a(le)},get theme(){return s().theme},buttons:[],children:(le,se)=>{var ie=IF(),Y=g(ie),K=u(g(Y),2);Vt(K),h2(K,!0),f(Y);var Q=u(Y,2),q=g(Q),ce=g(q);Se(ce,()=>r().loadingPairs,_e=>{var me=mF();O(_e,me)},_e=>{var me=Xt(),Pe=_t(me);Se(Pe,()=>n(v).length===0,ze=>{var he=hF();O(ze,he)},ze=>{var he=PF(),De=g(he);Ns(De,17,()=>n(k),dn,(be,$e,Ve)=>{var Ce=SF();Ce.__click=[_F,$,$e];var Je=g(Ce),ye=g(Je);Se(ye,()=>n($e).logo2,ft=>{var Qe=yF(),Oe=_t(Qe),ct=g(Oe);f(Oe);var Lt=u(Oe,2),It=g(Lt);f(Lt),we(()=>{St(ct,"src",`${n($e).logo}`),St(ct,"alt",n($e).ticker),St(It,"src",`${n($e).logo2}`),St(It,"alt",n($e).ticker)}),Fl("error",ct,zt=>{zt.target.style.display="none"}),e_(ct),Fl("error",It,zt=>{zt.target.style.display="none"}),e_(It),O(ft,Qe)},ft=>{var Qe=bF(),Oe=g(Qe),ct=u(Oe,2),Lt=g(ct),It=g(Lt,!0);we(()=>Ye(It,n($e).ticker.charAt(0))),f(Lt),f(ct),f(Qe),we(()=>{St(Oe,"src",`${n($e).logo}`),St(Oe,"alt",n($e).ticker)}),Fl("error",Oe,zt=>{const pt=zt.target;if(pt){pt.style.display="none";const Mo=pt.nextElementSibling;Mo&&(Mo.style.display="flex")}}),e_(Oe),O(ft,Qe)}),f(Je);var Ae=u(Je,2),ee=g(Ae),xe=g(ee),ke=g(xe,!0);f(xe);var He=u(xe,2),Ie=g(He,!0);f(He);var ne=u(He,2);Se(ne,()=>n($e).type,ft=>{var Qe=xF(),Oe=g(Qe,!0);f(Qe),we(()=>Ye(Oe,n($e).type)),O(ft,Qe)}),f(ee);var J=u(ee,2);Se(J,()=>n($e).shortName&&n($e).shortName!==n($e).ticker,ft=>{var Qe=wF(),Oe=g(Qe,!0);f(Qe),we(()=>Ye(Oe,n($e).shortName)),O(ft,Qe)}),f(Ae);var qe=u(Ae,2);Se(qe,()=>n(S)===Ve,ft=>{var Qe=kF();O(ft,Qe)}),f(Ce),we(()=>{Pn(Ce,`group flex items-center gap-3 px-4 py-3 cursor-pointer transition-all duration-200
                         ${(n(S)===Ve?"bg-primary/10 text-primary border-l-2 border-primary":"hover:bg-base-200/50 text-base-content")??""}`),Ye(ke,n($e).ticker),Ye(Ie,n($e).exchange)}),O(be,Ce)});var ge=u(De,2);Se(ge,()=>n(y),be=>{var $e=CF();O(be,$e)}),f(he),O(ze,he)},!0),O(_e,me)}),f(q),Ec(q,_e=>w=_e,()=>w),f(Q),un(2),f(ie),go(K,i,_e=>_2(d,_e)),Fl("scroll",q,U),O(le,ie)},$$slots:{default:!0}}),f(G),O(o,G),Za()}hc(["keydown","click"]);var AF=(o,e,t)=>e(n(t)),LF=de('<li class="w-[140px] h-[85px] flex items-center justify-center cursor-pointer rounded-lg svelte-18wwyns"><span> </span></li>'),FF=de('<div class="p-2"><ul class="flex flex-wrap justify-center gap-2"></ul></div>');function DF(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(a,"$save",t);let i=Ss(e,"show",15);const r=ub(),a=Fa("save"),l=[{timeframe:"1m",multiplier:1,timespan:"minute",secs:60},{timeframe:"5m",multiplier:5,timespan:"minute",secs:300},{timeframe:"15m",multiplier:15,timespan:"minute",secs:900},{timeframe:"30m",multiplier:30,timespan:"minute",secs:1800},{timeframe:"1h",multiplier:1,timespan:"hour",secs:3600},{timeframe:"4h",multiplier:4,timespan:"hour",secs:14400},{timeframe:"1d",multiplier:1,timespan:"day",secs:86400},{timeframe:"1w",multiplier:1,timespan:"week",secs:604800},{timeframe:"1M",multiplier:1,timespan:"month",secs:2592e3}];function d(p){var _;Ir(a,Uo(s).period=p,Uo(s));try{const y=(_=s())!=null&&_.key&&typeof s().key=="string"?s().key:"chart";typeof localStorage<"u"&&localStorage.setItem(`${y}.lastTimeframe`,(p==null?void 0:p.timeframe)||"")}catch{}try{J_.set(p)}catch{}i(!1)}function v(p){switch(p){case"minute":return wb();case"hour":return kb();case"day":return Sb();case"week":return Cb();case"month":return Pb();default:return p}}Pu(o,{title:r,width:500,get show(){return i()},set show(p){i(p)},get theme(){return s().theme},buttons:[],children:(p,_)=>{var y=FF(),w=g(y);Ns(w,21,()=>l,dn,(k,S)=>{var L=LF();L.__click=[AF,d,S];var T=g(L),P=g(T);we(()=>Ye(P,`${n(S).multiplier??""} ${v(n(S).timespan)??""}`)),f(T),f(L),we(()=>{var A,F,B;Sn(L,"hover:bg-base-200",n(S).timeframe!==((A=s().period)==null?void 0:A.timeframe)),Sn(L,"bg-primary",n(S).timeframe===((F=s().period)==null?void 0:F.timeframe)),Sn(L,"text-primary-content",n(S).timeframe===((B=s().period)==null?void 0:B.timeframe))}),O(k,L)}),f(w),f(y),O(p,y)},$$slots:{default:!0}}),Za()}hc(["click"]);const EF=o=>o;function Ix(o){const e=o-1;return e*e*e+1}function $y(o){const e=typeof o=="string"&&o.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[o,"px"]}function Vm(o,{delay:e=0,duration:t=400,easing:s=EF}={}){const i=+getComputedStyle(o).opacity;return{delay:e,duration:t,easing:s,css:r=>`opacity: ${r*i}`}}function Wm(o,{delay:e=0,duration:t=400,easing:s=Ix,x:i=0,y:r=0,opacity:a=0}={}){const l=getComputedStyle(o),d=+l.opacity,v=l.transform==="none"?"":l.transform,p=d*(1-a),[_,y]=$y(i),[w,k]=$y(r);return{delay:e,duration:t,easing:s,css:(S,L)=>`
			transform: ${v} translate(${(1-S)*_}${y}, ${(1-S)*w}${k});
			opacity: ${d-p*L}`}}function $F(o,{delay:e=0,duration:t=400,easing:s=Ix,axis:i="y"}={}){const r=getComputedStyle(o),a=+r.opacity,l=i==="y"?"height":"width",d=parseFloat(r[l]),v=i==="y"?["top","bottom"]:["left","right"],p=v.map(T=>`${T[0].toUpperCase()}${T.slice(1)}`),_=parseFloat(r[`padding${p[0]}`]),y=parseFloat(r[`padding${p[1]}`]),w=parseFloat(r[`margin${p[0]}`]),k=parseFloat(r[`margin${p[1]}`]),S=parseFloat(r[`border${p[0]}Width`]),L=parseFloat(r[`border${p[1]}Width`]);return{delay:e,duration:t,easing:s,css:T=>`overflow: hidden;opacity: ${Math.min(T*20,1)*a};${l}: ${T*d}px;padding-${v[0]}: ${T*_}px;padding-${v[1]}: ${T*y}px;margin-${v[0]}: ${T*w}px;margin-${v[1]}: ${T*k}px;border-${v[0]}-width: ${T*S}px;border-${v[1]}-width: ${T*L}px;`}}function Q_(o){const e=o-1;return e*e*e+1}const I_={CURRENT_VERSION:1,DEFAULT_FUTURE_MARGIN_MS:30*60*1e3,MAX_FUTURE_MARGIN_MS:24*60*60*1e3,MIN_FUTURE_MARGIN_MS:5*60*1e3,DEFAULT_FUTURE_MARGIN_PERCENT:.2,TIMESTAMP_PRECISION:1,PRICE_PRECISION:1e-6};function k1(o,e){try{const{chart:t,paneId:s="candle_pane"}=e,i={timestamp:o.t,value:o.p},r=t.convertToPixel(i,{paneId:s,absolute:!0});if(!r||typeof r!="object")return null;const a=Array.isArray(r)?r[0]:r;return!a||typeof a!="object"||typeof a.x!="number"||typeof a.y!="number"||!isFinite(a.x)||!isFinite(a.y)?null:{x:a.x,y:a.y}}catch(t){return console.error("Error converting data-space to screen-space:",t),null}}function jF(o,e,t){try{const{chart:s,paneId:i="candle_pane"}=e,r=s.convertFromPixel([o],{paneId:i});if(!r||!Array.isArray(r)||r.length===0||!r[0])return null;const a=r[0];return typeof a.timestamp!="number"||typeof a.value!="number"||!isFinite(a.timestamp)||!isFinite(a.value)?null:{id:t||zF(),t:Math.round(a.timestamp),p:a.value}}catch(s){return console.error("Error converting screen-space to data-space:",s),null}}function Mx(o,e){const t=[];let s=!0,i=!0;for(const r of o){const a=k1(r,e);if(!a){i=!1,t.push({x:0,y:0});continue}t.push(a),(a.x<-100||a.x>1e4||a.y<-100||a.y>1e4)&&(s=!1)}return{screenPoints:t,isVisible:s,isValid:i}}function jy(o,e,t={}){var s,i,r,a,l;try{const d={minMarginMs:I_.MIN_FUTURE_MARGIN_MS,maxMarginMs:I_.MAX_FUTURE_MARGIN_MS,defaultMarginPercent:I_.DEFAULT_FUTURE_MARGIN_PERCENT,...t},v=e.getDataList();if(!v||v.length===0)return;const p=v[v.length-1],_=typeof(p==null?void 0:p.timestamp)=="number"?p.timestamp:null;if(!_||!isFinite(_))return;let y=Number.NEGATIVE_INFINITY;for(const se of o)typeof se.t=="number"&&isFinite(se.t)&&se.t>y&&(y=se.t);if(!Number.isFinite(y)||y<=_)return;const w=Math.max(0,y-_);if(w<=0)return;const k=e.getVisibleRange();let S=0;if(k&&v.length>1){const se=(s=v[Math.max(0,Math.min(v.length-1,k.from))])==null?void 0:s.timestamp,ie=(i=v[Math.max(0,Math.min(v.length-1,k.to))])==null?void 0:i.timestamp;typeof se=="number"&&typeof ie=="number"&&isFinite(se)&&isFinite(ie)&&(S=Math.max(0,ie-se))}const L=S>0?Math.floor(S*d.defaultMarginPercent):Math.floor(w*d.defaultMarginPercent),T=Math.min(Math.max(d.minMarginMs,L),d.maxMarginMs),P=Math.min(w+T,d.maxMarginMs),A=_+P,F=p.timestamp;if(F>=A)return;const B=[];for(let se=Math.max(0,v.length-10);se<v.length-1;se++){const ie=(r=v[se])==null?void 0:r.timestamp,Y=(a=v[se+1])==null?void 0:a.timestamp;if(typeof ie=="number"&&typeof Y=="number"){const K=Y-ie;isFinite(K)&&K>0&&B.push(K)}}const R=B.length?B.sort((se,ie)=>se-ie)[Math.floor(B.length/2)]:6e4;if(!R||!isFinite(R)||R<=0)return;const N=Math.max(0,Math.ceil((A-F)/R));if(N<=0)return;const $=typeof(p==null?void 0:p.close)=="number"?p.close:typeof(p==null?void 0:p.open)=="number"?p.open:0,V=[];for(let se=1;se<=N;se++){const ie=F+se*R;V.push({timestamp:ie,open:$,high:$,low:$,close:$,volume:0})}const U=e.getVisibleRange(),G=U?U.to>=v.length-2:!0,Z=[...v,...V];e.applyNewData(Z,!1);try{(Z??[]).length>0&&(window.hasFirstDataLoaded=!0)}catch{}const le=G?Z.length-1:U?U.to:Z.length-1;try{e.scrollToDataIndex(le)}catch{const se=(l=Z[le])==null?void 0:l.timestamp;if(typeof se=="number")try{e.scrollToTimestamp(se)}catch{}}}catch{}}function zF(){return`point_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}class BF{constructor(e){re(this,"chart");re(this,"context");this.chart=e,this.context={chart:e}}enhanceTemplate(e){const t={...e,originalTemplate:e,createPointFigures:s=>{var a,l;const{overlay:i,coordinates:r}=s;if(this.isDataSpaceOverlay(i)){const d=i,v=Mx(d.points,this.context);return v.isValid?t.createDataSpaceFigures?t.createDataSpaceFigures({overlay:d,chart:this.chart,projectionResult:v,screenCoordinates:v.screenPoints}):((a=e.createPointFigures)==null?void 0:a.call(e,{...s,coordinates:v.screenPoints}))||[]:[]}if(t.createDataSpaceFigures){const d={screenPoints:r||[],isVisible:!0,isValid:Array.isArray(r)&&r.length>0};return t.createDataSpaceFigures({overlay:i,chart:this.chart,projectionResult:d,screenCoordinates:d.screenPoints})}return((l=e.createPointFigures)==null?void 0:l.call(e,s))||[]}};return t}createDataSpaceTemplate(e,t){const s={name:e,totalStep:t.totalStep,needDefaultPointFigure:t.needDefaultPointFigure??!0,needDefaultXAxisFigure:t.needDefaultXAxisFigure??!0,needDefaultYAxisFigure:t.needDefaultYAxisFigure??!0,styles:t.styles,onDrawStart:t.onDrawStart,onDrawing:t.onDrawing,onDrawEnd:t.onDrawEnd,onClick:t.onClick,onDoubleClick:t.onDoubleClick,onRightClick:t.onRightClick,onPressedMoveStart:t.onPressedMoveStart,onPressedMoving:t.onPressedMoving,onPressedMoveEnd:t.onPressedMoveEnd,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,onSelected:t.onSelected,onDeselected:t.onDeselected};return this.enhanceTemplate({...s,createDataSpaceFigures:t.createDataSpaceFigures})}isDataSpaceOverlay(e){return e&&typeof e=="object"&&"points"in e&&Array.isArray(e.points)&&e.points.length>0&&e.points.every(t=>t&&typeof t=="object"&&"t"in t&&"p"in t&&"id"in t&&typeof t.t=="number"&&typeof t.p=="number"&&typeof t.id=="string")}screenToDataSpace(e){return[]}updateChart(e){this.chart=e,this.context={chart:e}}}let zy=null;function Tx(o){return zy=new BF(o),zy}const T0={windowBars:120,horizons:[5,10,20],topK:200,stride:1,distance:"cosine",halfLifeBars:500,atrLen:14,rsiLen:14,adxLen:14,avwapAnchors:["sessionOpen","prevHigh","prevLow","swingHi","swingLo"],candidateSL:[.6,.8,1,1.25,1.5],useSwingStop:!1,minMatches:100,winsor:.98,bandAlpha:.22,showTable:!0,showBothDirections:!0},Ax="npo_mae_settings_v1";function NF(){try{const o=localStorage.getItem(Ax);if(!o)return{...T0};const e=JSON.parse(o);return{...T0,...e}}catch{return{...T0}}}function By(o){try{localStorage.setItem(Ax,JSON.stringify(o))}catch{}}function RF(o,e){const t=e.windowBars;if(o.length<t)return new Float32Array;const s=o.length-t,i=o.slice(s),r=A=>{const F=[];for(let B=A;B<i.length;B++){const R=(i[B].close-i[B-A].close)/Math.max(1e-8,i[B-A].close);F.push(R)}return F},a=r(1),l=r(2),d=r(3),v=r(5),p=[];for(let A=0;A<i.length;A++){const F=e.atrLen,B=Math.max(0,A-F+1);let R=0,N=0;for(let $=B;$<=A;$++){const V=i[$].high,U=i[$].low;R+=Math.max(0,V-U),N++}p.push(R/Math.max(1,N))}const y=((A,F)=>{const B=[];for(let R=0;R<A.length;R++){const N=Math.max(0,R-F+1),$=A[N],V=A[R];B.push(V-$)}return B})(p,5),w=[];for(let A=0;A<i.length;A++){const F=i[A],B=Math.max(1e-8,F.high-F.low),R=Math.abs(F.close-F.open);w.push(R/B)}const k=[...a,...l,...d,...v,...p,...y,...w],S=k.reduce((A,F)=>A+F,0)/Math.max(1,k.length),L=Math.sqrt(k.reduce((A,F)=>A+Math.pow(F-S,2),0)/Math.max(1,k.length)),P=k.map(A=>(A-S)/(L>1e-8?L:1)).map(A=>Math.max(-5,Math.min(5,A)));return new Float32Array(P)}function e1(o){const e=o.getDataList();if(!e||e.length===0)return null;const t=e[e.length-1];return{timestamp:t.timestamp,price:t.close}}function OF(o,e,t,s="candle_pane"){try{const i=o.convertToPixel({timestamp:e,value:t},{paneId:s}),r=Array.isArray(i)?i[0]:i;return(r==null?void 0:r.y)??null}catch{return null}}function VF(o){try{const e=o.getSize(),t=o.getVisibleRange();if(!e||!t)return 4;const s=Math.max(1,t.to-t.from+1);return e.width/s}catch{return 4}}function WF(o){try{const e=o.getDataList();if(!e||e.length<2)return 0;const t=Math.min(10,e.length-1);let s=0;for(let r=e.length-t;r<e.length-1;r++){const a=e[r],l=e[r+1],d=Math.max(0,((l==null?void 0:l.timestamp)??0)-((a==null?void 0:a.timestamp)??0));s+=d}const i=s/Math.max(1,t);return isFinite(i)&&i>0?i:0}catch{return 0}}function qF(o){return Tx(o).createDataSpaceTemplate("NearestPatternOutcomeMaeStop",{totalStep:1,needDefaultPointFigure:!0,needDefaultXAxisFigure:!1,needDefaultYAxisFigure:!1,createDataSpaceFigures:({overlay:s,screenCoordinates:i,chart:r})=>{var G,Z,le,se,ie,Y;const a=[];if(i.length<1)return a;const l=i[0],d=s.extendData;if(!d)return a;const v=VF(r),p=e1(r);if(!p)return a;const _=p.timestamp,y=p.price,w=d.forwardPathMedianR||[],k=d.forwardPathP10R||[],S=d.forwardPathP90R||[],L=w.map(K=>y+K),T=k.map(K=>y+K),P=S.map(K=>y+K),A=d.bandAlpha??T0.bandAlpha,F=K=>OF(r,_,K),B=WF(r),R=(K,Q)=>{const q=_+(B>0?K*B:0);try{const ce=r.convertToPixel({timestamp:q,value:Q},{paneId:"candle_pane"}),_e=Array.isArray(ce)?ce[0]:ce,me=(_e==null?void 0:_e.y)??F(Q);return{x:(_e==null?void 0:_e.x)??l.x+K*v,y:me??l.y}}catch{const ce=F(Q);return{x:l.x+K*v,y:ce??l.y}}};if(L.length>0){const K=d.styles&&d.styles.median||{},Q=typeof K.size=="number"?K.size:1,q=typeof K.style=="string"?K.style:"solid";for(let ce=0;ce<L.length-1;ce++){const _e=R(ce,L[ce]),me=R(ce+1,L[ce+1]);a.push({type:"line",attrs:{coordinates:[_e,me]},styles:{color:((G=d.colors)==null?void 0:G.median)||"#66c2a5",size:Q,style:q}})}}if(T.length>0&&P.length>0&&d.showOutcomeBand!==!1){const K=[];for(let q=0;q<P.length;q++)K.push(R(q,P[q]));for(let q=T.length-1;q>=0;q--)K.push(R(q,T[q]));const Q=d.colors&&d.colors.band||`rgba(102, 194, 165, ${A})`;a.push({type:"polygon",attrs:{coordinates:K},styles:{color:Q}})}const N=d.selectedSL,$=d.lastAtr,V=N&&typeof $=="number"?y-N*$:void 0;if(d.showStopLines!==!1&&typeof V=="number"){const K=F(V);if(K!=null){const Q=r.getSize(),q=(Q==null?void 0:Q.width)??0,ce=d.styles&&d.styles.slLong||{},_e=typeof ce.size=="number"?ce.size:1,me=typeof ce.style=="string"?ce.style:"dashed";a.push({type:"line",attrs:{coordinates:[{x:0,y:K},{x:q,y:K}]},styles:{color:((Z=d.colors)==null?void 0:Z.slLong)||"#e67e22",style:me,size:_e}});const Pe=(V??0).toFixed(2);a.push({type:"text",attrs:{x:q-4,y:K,text:`SL L ${Pe}`},styles:{color:((le=d.colors)==null?void 0:le.slLong)||"#e67e22",backgroundColor:"transparent",align:"right",size:11}})}}const U=N&&typeof $=="number"?y+N*$:void 0;if(d.showStopLines!==!1&&typeof U=="number"){const K=F(U);if(K!=null){const Q=r.getSize(),q=(Q==null?void 0:Q.width)??0,ce=d.styles&&d.styles.slShort||{},_e=typeof ce.size=="number"?ce.size:1,me=typeof ce.style=="string"?ce.style:"dashed";a.push({type:"line",attrs:{coordinates:[{x:0,y:K},{x:q,y:K}]},styles:{color:((se=d.colors)==null?void 0:se.slShort)||"#c0392b",style:me,size:_e}});const Pe=(U??0).toFixed(2);a.push({type:"text",attrs:{x:q-4,y:K,text:`SL S ${Pe}`},styles:{color:((ie=d.colors)==null?void 0:ie.slShort)||"#c0392b",backgroundColor:"transparent",align:"right",size:11}})}}if(d.showTable&&Array.isArray(d.evTable)){const K=r.getSize(),Q=(K==null?void 0:K.width)??0,q=240,ce=10,_e=10,me=18,Pe=Math.min(d.evTable.length,6),ze=20,he=_e*2+ze+Pe*me,De=12,be=Math.max(De,Q-q-De-80),$e=10,Ve=typeof document<"u"&&((Y=document==null?void 0:document.documentElement)==null?void 0:Y.getAttribute("data-theme"))||"",Ce=String(Ve).toLowerCase().includes("dark"),Je=Ce?"rgba(16,20,30,0.85)":"rgba(245,247,255,0.95)",ye=Ce?"rgba(140,160,220,0.35)":"rgba(80,100,160,0.35)",Ae=Ce?"rgba(28,34,50,0.90)":"rgba(232,236,250,0.90)",ee=Ce?"#a7b3d8":"#415277",xe=Ce?"#cfd6ee":"#1f2937";a.push({type:"rect",attrs:{x:be,y:$e,width:q,height:he},styles:{style:"fill",color:Je}}),a.push({type:"rect",attrs:{x:be,y:$e,width:q,height:he},styles:{style:"stroke",color:ye,borderSize:1,borderStyle:"solid"}});const ke=q-ce*2,He=qe=>Math.min(be+q-ce-4,qe),Ie={mark:He(be+ce),side:He(be+ce+12),mult:He(be+ce+ke*.1),ev:He(be+ce+ke*.35),pwin:He(be+ce+ke*.55),winr:He(be+ce+ke*.72),lossr:He(be+ce+ke*.88)};let ne=$e+_e+2;a.push({type:"rect",attrs:{x:be+1,y:$e+1,width:q-2,height:ze},styles:{style:"fill",color:Ae}}),a.push({type:"text",attrs:{x:Ie.mult,y:ne,text:"SL"},styles:{color:ee,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.ev,y:ne,text:"EV"},styles:{color:ee,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.pwin,y:ne,text:"pWin"},styles:{color:ee,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.winr,y:ne,text:"winR"},styles:{color:ee,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.lossr,y:ne,text:"lossR"},styles:{color:ee,size:12,backgroundColor:"transparent"}}),ne+=ze-6;for(let qe=0;qe<Pe;qe++){const ft=d.evTable[qe],Qe=d.selectedSL===ft.mult;a.push({type:"text",attrs:{x:Ie.mark,y:ne,text:Qe?"▶":"•"},styles:{color:xe,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.side,y:ne,text:ft.side==="long"?"L":"S"},styles:{color:xe,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.mult,y:ne,text:`${ft.mult.toFixed(2)}×`},styles:{color:xe,size:12,backgroundColor:"transparent"}});const Oe=`${ft.ev>=0?"+":""}${ft.ev.toFixed(2)}`;a.push({type:"text",attrs:{x:Ie.ev,y:ne,text:Oe},styles:{color:xe,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.pwin,y:ne,text:`${Math.round(ft.pWin*100)}%`},styles:{color:xe,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.winr,y:ne,text:ft.avgWinR.toFixed(2)},styles:{color:xe,size:12,backgroundColor:"transparent"}}),a.push({type:"text",attrs:{x:Ie.lossr,y:ne,text:ft.avgLossR.toFixed(2)},styles:{color:xe,size:12,backgroundColor:"transparent"}}),ne+=me}const J=(()=>{const qe=d.selectedSide;return d.evTable.find(Qe=>Qe.mult===d.selectedSL&&(!qe||Qe.side===qe))||d.evTable.find(Qe=>Qe.mult===d.selectedSL)||null})();if(J){const ft=$e+he+6,Qe=86,Oe=J.side==="long"?"Long":"Short",ct=`${J.mult.toFixed(2)}× ATR`,Lt=y.toFixed(2),It=(J.side==="long"?y-J.mult*($??0):y+J.mult*($??0)).toFixed(2),zt=Math.round((J.pWin??0)*100);a.push({type:"rect",attrs:{x:be,y:ft,width:q,height:Qe},styles:{style:"fill",color:Ce?"rgba(16,20,30,0.85)":"rgba(245,247,255,0.95)"}}),a.push({type:"rect",attrs:{x:be,y:ft,width:q,height:Qe},styles:{style:"stroke",color:ye,borderSize:1,borderStyle:"solid"}});let pt=ft+8+2;a.push({type:"text",attrs:{x:be+8,y:pt,text:`Active: ${Oe}`},styles:{color:ee,size:12,backgroundColor:"transparent"}}),pt+=18,a.push({type:"text",attrs:{x:be+8,y:pt,text:`Anchor: ${Lt}`},styles:{color:xe,size:12,backgroundColor:"transparent"}}),pt+=18,a.push({type:"text",attrs:{x:be+8,y:pt,text:`Stop: ${It} (${ct})`},styles:{color:xe,size:12,backgroundColor:"transparent"}}),pt+=18,a.push({type:"text",attrs:{x:be+8,y:pt,text:`pWin ${zt}% • winR ${J.avgWinR.toFixed(2)} • lossR ${J.avgLossR.toFixed(2)}`},styles:{color:xe,size:12,backgroundColor:"transparent"}});const Mo=Math.abs(y-(J.side==="long"?y-J.mult*($??0):y+J.mult*($??0))),Xo=S.length&&k.length?Math.max(0,(S[0]??0)-(k[0]??0)):0,en=Xo<=1,Fo=Xo>=2,Eo=J.side==="long"&&(J.ev??0)>=.15&&(J.pWin??0)>=.52&&!Fo,cs=J.side==="short"&&(J.ev??0)>=.1&&(J.pWin??0)>=.5&&!Fo,Zt=Eo?"BUY":cs?"SELL":"WAIT",bs=Eo?"#10b981":cs?"#ef4444":Ce?"#f59e0b":"#b45309",es=ft+Qe+6,rn=74,wr=Ce?"rgba(20,24,32,0.85)":"rgba(240,244,255,0.95)";a.push({type:"rect",attrs:{x:be,y:es,width:q,height:rn},styles:{style:"fill",color:wr}}),a.push({type:"rect",attrs:{x:be,y:es,width:q,height:rn},styles:{style:"stroke",color:ye,borderSize:1,borderStyle:"solid"}});let rr=es+8+2;a.push({type:"text",attrs:{x:be+8,y:rr,text:`Action: ${Zt}`},styles:{color:bs,size:13,backgroundColor:"transparent"}}),rr+=18;const ar=en?"Band: Narrow":Fo?"Band: Wide":"Band: Normal",jr=`1R: ${Mo.toFixed(2)}`,ii=Eo?"EV≥0.30, pWin≥55%":cs?"EV≥0.20, pWin≥50%":"Low EV / Wide band / Low pWin";a.push({type:"text",attrs:{x:be+8,y:rr,text:`${ar} • ${jr}`},styles:{color:xe,size:12,backgroundColor:"transparent"}}),rr+=18,a.push({type:"text",attrs:{x:be+8,y:rr,text:ii},styles:{color:ee,size:12,backgroundColor:"transparent"}})}}return a},onClick:s=>{var d;const i=s.overlay.extendData;if(!i||!Array.isArray(i.evTable))return!0;const a=(i.evTable.findIndex(v=>v.mult===i.selectedSL)+1)%i.evTable.length,l=i.evTable[a];return l&&(i.selectedSL=l.mult,i.selectedSide=l.side,(d=s.chart)==null||d.overrideOverlay({id:s.overlay.id,extendData:i})),!0}})}function HF(){return new Worker(new URL(""+new URL("../workers/npoMae.worker-DaGdsbjp.js",import.meta.url).href,import.meta.url),{type:"module"})}function GF(o,e){const t=qF(o);B2(t);let s={...NF()},i=null,r=!0,a=HF(),l=0,d=-1,v=0,p=!0,_=!0;function y(){var F;if(!i){const B=e1(o),R=B?[{timestamp:B.timestamp,value:B.price}]:[],N=o.createOverlay({name:"NearestPatternOutcomeMaeStop",points:R});i=Array.isArray(N)?(N==null?void 0:N[0])??null:N,w();try{const $=Qu(),V=((F=$==null?void 0:$.getCurrentSymbol)==null?void 0:F.call($))||null;$&&V&&i&&$.addDrawing({id:i,symbolKey:V,type:"NearestPatternOutcomeMaeStop",points:B?[{time:B.timestamp,price:B.price}]:[],styles:{},visible:!0})}catch{}}}function w(){var B,R;if(!i)return;const F=e1(o);if(F)try{const N=(B=o.getOverlays)==null?void 0:B.call(o,{id:i}),$=Array.isArray(N)&&N.length>0?N[0]:null,V=(R=$==null?void 0:$.points)==null?void 0:R[0],U=(V==null?void 0:V.timestamp)??(V==null?void 0:V.time)??(V==null?void 0:V.t),G=(V==null?void 0:V.value)??(V==null?void 0:V.price)??(V==null?void 0:V.p);if(typeof U!="number"||typeof G!="number"||U!==F.timestamp||Math.abs(G-F.price)>1e-6){o.overrideOverlay({id:i,points:[{timestamp:F.timestamp,value:F.price}]});try{const le=Qu();le&&i&&le.updateDrawing(i,{points:[{time:F.timestamp,price:F.price}]})}catch{}}}catch{}}function k(F){if(!i)return;const B={...F,bandAlpha:s.bandAlpha,showTable:s.showTable,showStopLines:_,showOutcomeBand:p};v&&cancelAnimationFrame(v),v=requestAnimationFrame(()=>{o.overrideOverlay({id:i,extendData:B});try{const R=Qu();R&&i&&R.updateDrawing(i,{extendData:B})}catch{}})}function S(){if(!r||!a)return;w();const F=o.getDataList();if(!F||F.length<Math.max(s.windowBars+Math.max(...s.horizons),10)){k({forwardPathMedian:[],forwardPathP10:[],forwardPathP90:[],evTable:[],suggestedSL:null});return}const B=F.map(V=>({time:V.timestamp,open:V.open,high:V.high,low:V.low,close:V.close,volume:V.volume})),R=RF(B,s),N=++l;d=N;const $={id:N,settings:s,features:R,bars:B};a.postMessage($,[R.buffer])}function L(F){var U,G;const B=F.data;if(!B||B.id!==d)return;const R=Math.max(...s.horizons),N=B.byHorizon[R];if(!N)return;const $=B.slSuggest||{},V=YF(o,s.atrLen);k({forwardPathMedianR:N.forwardPathMedian,forwardPathP10R:N.forwardPathP10,forwardPathP90R:N.forwardPathP90,evTable:$.evTable||[],selectedSL:((U=$.long)==null?void 0:U.mult)??((G=$.short)==null?void 0:G.mult),selectedSide:$.long?"long":$.short?"short":void 0,lastAtr:V})}a&&(a.onmessage=L),y(),S();const T=window.setInterval(()=>{y(),S()},500),P=F=>{F.key==="O"||F.key==="o"?(p=!p,k({})):(F.key==="S"||F.key==="s")&&(_=!_,k({}))};return window.addEventListener("keydown",P,{capture:!0}),{setEnabled(F){r=F,r&&S()},updateSettings(F){s={...s,...F},By(s),S()},setShowOutcomeBand(F){p=F,k({})},setShowStopLines(F){_=F,k({})},setColors(F){k({colors:F})},setStyles(F){k({styles:F})},resetSettings(){s={...T0},By(s),S()},getOverlayId(){return i},dispose(){if(window.removeEventListener("keydown",P,{capture:!0}),window.clearInterval(T),a&&(a.terminate(),a=null),i)try{o.removeOverlay({id:i})}catch{}}}}function YF(o,e){const t=o.getDataList();if(!t||t.length===0)return 1;const s=Math.min(e,t.length);let i=0;for(let r=t.length-s;r<t.length;r++){const a=t[r].high,l=t[r].low;i+=Math.max(0,a-l)}return i/Math.max(1,s)}var UF=(o,e)=>b(e,""),KF=de('<button class="absolute right-4 top-1/2 transform -translate-y-1/2 hover:scale-110 transition-all duration-300 z-10 clear-search-btn svelte-1bz53f9" title="Clear search"><svg class="w-4 h-4 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-1bz53f9"></path></svg></button>'),ZF=(o,e,t,s)=>!n(e)&&t(n(s).is_main,n(s).name),XF=(o,e)=>{o.stopPropagation(),b(e,!0)},JF=de('<button class="w-8 h-8 rounded-full ml-2 opacity-0 group-hover:opacity-100 hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm info-btn svelte-1bz53f9" title="How it works"><svg class="w-4 h-4 svelte-1bz53f9" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10" class="svelte-1bz53f9"></circle><line x1="12" y1="16" x2="12" y2="12" class="svelte-1bz53f9"></line><line x1="12" y1="8" x2="12.01" y2="8" class="svelte-1bz53f9"></line></svg></button>'),QF=(o,e,t)=>{o.stopPropagation(),e(n(t).name)},eD=(o,e,t)=>{o.stopPropagation(),e(n(t).name)},tD=de('<div class="flex items-center gap-2 ml-4 opacity-100 transition-all duration-300 svelte-1bz53f9"><button class="w-8 h-8 rounded-full hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm edit-btn svelte-1bz53f9" title="Edit Parameters"><svg class="w-3.5 h-3.5 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" class="svelte-1bz53f9"></path></svg></button> <button class="w-8 h-8 rounded-full hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm delete-btn svelte-1bz53f9" title="Remove Indicator"><svg class="w-3.5 h-3.5 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-1bz53f9"></path></svg></button></div>'),oD=de('<div><div></div> <div class="flex-1 min-w-0 svelte-1bz53f9"><span> </span></div> <!> <!></div>'),sD=de('<div class="flex flex-col items-center justify-center py-16 text-center svelte-1bz53f9"><div class="w-16 h-16 rounded-full bg-base-200/50 flex items-center justify-center mb-4 svelte-1bz53f9"><svg class="w-8 h-8 text-base-content/40 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" class="svelte-1bz53f9"></path></svg></div> <p class="text-lg font-semibold text-base-content/60 mb-2 svelte-1bz53f9">No indicators found</p> <p class="text-sm text-base-content/40 svelte-1bz53f9">Try a different search term</p></div>'),nD=de(`<div class="flex flex-col gap-6 svelte-1bz53f9"><div><div class="absolute left-4 top-1/2 transform -translate-y-1/2 pointer-events-none z-10 transition-all duration-300 search-icon svelte-1bz53f9"><svg class="w-4 h-4 svelte-1bz53f9" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" class="svelte-1bz53f9"></path></svg></div> <input type="text" class="w-full pl-12 pr-12 py-3.5 text-[15px] font-medium tracking-wide backdrop-blur-sm rounded-2xl
               focus:outline-none transition-all duration-500 ease-out
               placeholder:font-normal search-input svelte-1bz53f9"> <!></div> <div class="relative rounded-2xl overflow-hidden backdrop-blur-sm indicator-list-container svelte-1bz53f9"><div class="indicator-scroll ultra-minimal-scrollbar svelte-1bz53f9"><!> <!></div></div> <div class="flex justify-center items-center py-2 mt-1 svelte-1bz53f9"><div class="group relative cursor-pointer svelte-1bz53f9"><div class="absolute inset-0 bg-gradient-to-r from-transparent via-primary/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-700 ease-out blur-xl svelte-1bz53f9"></div> <div class="relative flex items-center gap-2 px-4 py-1.5 rounded-full bg-gradient-to-r from-base-100/80 to-base-200/60 backdrop-blur-sm border border-base-300/30 shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-500 ease-out svelte-1bz53f9"><div class="w-2 h-2 rounded-full bg-gradient-to-r from-primary to-secondary animate-pulse svelte-1bz53f9"></div> <span class="text-sm font-medium text-base-content/70 group-hover:text-primary transition-colors duration-300 svelte-1bz53f9">Powered by</span> <span class="text-sm font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent group-hover:from-secondary group-hover:to-primary transition-all duration-500 svelte-1bz53f9">Duty AI</span> <div class="w-2 h-2 rounded-full bg-gradient-to-r from-secondary to-primary animate-pulse svelte-1bz53f9" style="animation-delay: 0.5s;"></div></div></div></div></div>`),iD=(o,e)=>b(e,!1),rD=(o,e)=>b(e,"bn"),aD=(o,e)=>b(e,"en"),lD=(o,e)=>b(e,!1),cD=de(`<div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">খুব সহজ ব্যাখ্যা</div> <p class="text-sm text-base-content/70 svelte-1bz53f9">মনে করুন আপনি আগের দিনের ছবি দেখে আজকের দিনের কথা অনুমান করছেন।
                এই ইন্ডিকেটরটি ঠিক তেমনই করে—এখনকার দামের সঙ্গে খুব মিল‑থাকা
                আগের প্যাটার্ন খুঁজে নেয়, তাদের পথ ধরে সামনে কী হতে পারে তা
                অনুমান করে, আর অতীতে কতটা উল্টো দিকে গেছে সেটাকে ধরে নিরাপদ
                থামার জায়গা (স্টপ‑লস) বলে দেয়।</p> <p class="text-sm text-base-content/70 svelte-1bz53f9">উদাহরণ: ধরুন আজকের দামের গতি অনেকটা গত মাসের ১৫ তারিখের মতো।
                ইন্ডিকেটরটি তখন গত মাসের ১৫ তারিখের পরের দিনগুলো কী হয়েছিল সেটা
                দেখে আজকের পরের দিনগুলোর জন্য অনুমান করে।</p> <p class="text-sm text-base-content/70 svelte-1bz53f9">চার্টে রঙের ব্যান্ডটি P10–P90 প্রত্যাশিত রেঞ্জ বোঝায়—মানে ১০০‑এর
                মধ্যে ৮০ বার দাম এই সীমার মধ্যে থাকতে পারে। মাঝের রেখাটি মাঝের
                রাস্তা (মিডিয়ান পথ)—দাম সাধারণত এই পথ ধরে চলতে পারে। আর ড্যাশড
                লাইনগুলো লং/শর্টের স্টপ—এগুলোতে পৌঁছালে থামার সংকেত।</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">চার্ট উপাদান</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">মাঝের রাস্তা: দাম সাধারণত কোন পথে যেতে পারে তার মাঝের লাইন।</li> <li class="svelte-1bz53f9">রঙের ব্যান্ড: সম্ভাব্য ওঠা‑নামার এলাকা (P10–P90)। সরু মানে
                  পরিষ্কার পথ, প্রশস্ত মানে বেশি অনিশ্চয়তা।</li> <li class="svelte-1bz53f9">স্টপের দাগ: লং/শর্টের প্রস্তাবিত স্টপ‑লসের ড্যাশড লাইন।</li> <li class="svelte-1bz53f9">ইভি টেবিল: কোন স্টপ নিলে মোটের উপর লাভ‑ক্ষতি কেমন হতে পারে তা
                  দেখায়।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">ওভারলে প্যানেলগুলো</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">তথ্য প্যানেল</span>: <span class="font-medium svelte-1bz53f9">Active</span> (Long/Short), <span class="font-medium svelte-1bz53f9">Anchor</span> (বর্তমান
                  দাম), <span class="font-medium svelte-1bz53f9">Stop</span> (SL মূল্য ও ×ATR), <span class="font-medium svelte-1bz53f9">pWin</span>, <span class="font-medium svelte-1bz53f9">winR</span>, <span class="font-medium svelte-1bz53f9">lossR</span> দেখায়—সিদ্ধান্তের জন্য দ্রুত
                  প্রেক্ষাপট দেয়।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">সিদ্ধান্ত প্যানেল</span>: বড় অক্ষরে <span class="font-medium svelte-1bz53f9">Action: BUY/SELL/WAIT</span> দেখায়। সঙ্গে <span class="font-medium svelte-1bz53f9">Band</span> (Narrow/Normal/Wide), <span class="font-medium svelte-1bz53f9">1R</span> দূরত্ব ও <span class="font-medium svelte-1bz53f9">শর্তের সারাংশ</span> দেখায়। <br class="svelte-1bz53f9">BUY (লং): EV ≥ 0.30 ও pWin ≥ 55%, ব্যান্ড Wide না হলে। <br class="svelte-1bz53f9">SELL (শর্ট): EV ≥ 0.20 ও pWin ≥ 50%, ব্যান্ড Wide না
                  হলে। <br class="svelte-1bz53f9">অন্যথা: WAIT।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">ইভি টেবিল (উদাহরণ)</div> <div class="overflow-x-auto svelte-1bz53f9"><table class="table table-xs svelte-1bz53f9"><thead class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><th class="svelte-1bz53f9">পজিশন</th><th class="svelte-1bz53f9">এসএল (×এটিআর)</th><th class="svelte-1bz53f9">ইভি (আর)</th><th class="svelte-1bz53f9">জেতার সম্ভাবনা (%)</th><th class="svelte-1bz53f9">উইন R</th><th class="svelte-1bz53f9">লস R</th></tr></thead><tbody class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">লং</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">+0.45</td><td class="svelte-1bz53f9">62</td><td class="svelte-1bz53f9">1.60</td><td class="svelte-1bz53f9">0.95</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">লং</td><td class="svelte-1bz53f9">1.25×</td><td class="svelte-1bz53f9">+0.30</td><td class="svelte-1bz53f9">68</td><td class="svelte-1bz53f9">1.35</td><td class="svelte-1bz53f9">0.80</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">শর্ট</td><td class="svelte-1bz53f9">0.80×</td><td class="svelte-1bz53f9">+0.20</td><td class="svelte-1bz53f9">54</td><td class="svelte-1bz53f9">1.10</td><td class="svelte-1bz53f9">0.85</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">শর্ট</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">−0.05</td><td class="svelte-1bz53f9">48</td><td class="svelte-1bz53f9">1.20</td><td class="svelte-1bz53f9">1.10</td></tr></tbody></table></div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">ইভি: মোটের উপর গড় প্রত্যাশা। জেতা‑হারা দুটো মিলিয়ে ফল কেমন
                  হবে।</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা (%): ১০০‑এর মধ্যে সংখ্যা। যত বেশি, জেতার
                  সম্ভাবনা তত বেশি।</li> <li class="svelte-1bz53f9">উইন R ও লস R: জিতলে আনুমানিক কত, হারলে আনুমানিক কত। ভারসাম্য
                  দেখুন।</li> <li class="svelte-1bz53f9">ইভি ≥ 0 হলে সারি বিবেচনা করুন; ইভি যত বেশি, মোট প্রত্যাশা তত
                  ভালো।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">টেবিলের ▶ চিহ্ন (অ্যারো) কীভাবে কাজ করে</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">টেবিলের সারিতে ▶ দেখায় কোন এসএল মাল্টিপ্লায়ার এখন সক্রিয়।
                  ভেতরে ক্লিক করলে ▶ পরের সারিতে যায়।</li> <li class="svelte-1bz53f9">▶ যে সারিতে থাকে, সেই সারির <span class="font-medium svelte-1bz53f9">SL (×ATR)</span> অনুযায়ী চার্টের ড্যাশড স্টপ‑লাইন আপডেট হয়।</li> <li class="svelte-1bz53f9">▶ যদি লং সারিতে থাকে: সিদ্ধান্ত লং বায়াসে ভাবুন; স্টপ সাধারণত
                  বর্তমান দামের নিচে (<span class="font-medium svelte-1bz53f9">anchor − mult × ATR</span>).</li> <li class="svelte-1bz53f9">▶ যদি শর্ট সারিতে থাকে: সিদ্ধান্ত শর্ট বায়াসে ভাবুন; স্টপ
                  সাধারণত বর্তমান দামের উপরে (<span class="font-medium svelte-1bz53f9">anchor + mult × ATR</span>).</li> <li class="svelte-1bz53f9">সেরা নির্বাচন: ▶ কে এমন সারিতে রাখুন যেখানে <span class="font-medium svelte-1bz53f9">EV পজিটিভ</span>, <span class="font-medium svelte-1bz53f9">pWin বেশি</span>, আর <span class="font-medium svelte-1bz53f9">lossR নিয়ন্ত্রণে</span> থাকে।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">অ্যারো উদাহরণ (শর্ট)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">ধরুন ▶ শর্ট সারিতে আছে এবং <span class="font-medium svelte-1bz53f9">SL = 1.50×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.71</span>, <span class="font-medium svelte-1bz53f9">lossR = 1.46</span>।</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.50×</span> মানে স্টপ দূরত্ব <span class="font-medium svelte-1bz53f9">1.5 × ATR</span> উপরে। দূর স্টপ → কম
                    স্টপ‑হিট; কিন্তু রিস্ক ইউনিট বড় হয়।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.71</span> মানে জিতলে গড় লাভ <span class="font-medium svelte-1bz53f9">1.71R</span>। যদি 1R = 100 টাকা
                    রিস্ক ধরেন, জিতলে গড়ে 171 টাকা।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 1.46</span> মানে হারলে গড়
                    ক্ষতি <span class="font-medium svelte-1bz53f9">1.46R</span> ≈ 146 টাকা।</li> <li class="svelte-1bz53f9">সিদ্ধান্ত: pWin যদি ~55% হয়, তাহলে <span class="font-medium svelte-1bz53f9">EV = pWin × winR − (1−pWin) × lossR</span> = 0.55×1.71 − 0.45×1.46 ≈ <span class="font-medium svelte-1bz53f9">+0.28R</span> → গ্রহণযোগ্য।</li> <li class="svelte-1bz53f9">যদি pWin 45%‑এর নিচে নামে বা lossR বেশি হয়, ▶ অন্য সারিতে
                    সরান (কম SL বা ভালো EV)।</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">অ্যারো উদাহরণ (লং)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">ধরুন ▶ লং সারিতে আছে এবং <span class="font-medium svelte-1bz53f9">SL = 1.00×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.40</span>, <span class="font-medium svelte-1bz53f9">lossR = 0.90</span>।</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.00×</span> মানে স্টপ দূরত্ব <span class="font-medium svelte-1bz53f9">1 × ATR</span> নিচে। কাছের স্টপ → ঝুঁকি
                    ছোট; কিন্তু স্টপ‑হিট হতে পারে বেশি।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.40</span> মানে জিতলে গড় লাভ
                    1.40R।</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 0.90</span> মানে হারলে গড় ক্ষতি
                    0.90R।</li> <li class="svelte-1bz53f9">pWin যদি ~60% হয়, <span class="font-medium svelte-1bz53f9">EV ≈ 0.60×1.40 − 0.40×0.90 = +0.54R</span> → শক্ত সিদ্ধান্ত।</li> <li class="svelte-1bz53f9">যদি ব্যান্ড খুব প্রশস্ত বা pWin কম হয়, ▶ কে এমন সারিতে নিন
                    যেখানে EV পজিটিভ ও lossR নিয়ন্ত্রিত।</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">ব্যান্ড ভিত্তিক সিদ্ধান্ত</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">ব্যান্ড সরু: পথ পরিষ্কার—আত্মবিশ্বাস একটু বাড়ানো যেতে পারে।</li> <li class="svelte-1bz53f9">ব্যান্ড প্রশস্ত: অনিশ্চয়তা বেশি—সাইজ কমান বা একটু অপেক্ষা
                  করুন।</li> <li class="svelte-1bz53f9">ব্যান্ড যদি বড় সাপোর্ট/রেজিস্ট্যান্সের সঙ্গে মিলে যায়: সতর্ক
                  থাকুন, স্টপ দূরে রাখুন।</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">উদাহরণ</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">লং বায়াস</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">মাঝের রাস্তা উপরে দিকে। ইভি +0.30→+0.60, জেতার সম্ভাবনা
                    55–65%। এসএল 1.0×–1.25× নিলে সাধারণত জেতার সম্ভাবনা ও লস
                    R‑এর মধ্যে ভালো ভারসাম্য থাকে।</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">শর্ট বায়াস</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">মাঝের রাস্তা নিচের দিকে। শর্ট ইভি +0.20→+0.45। ব্যান্ড যদি
                    আগের নিচু জায়গার সঙ্গে মিলে যায়, এসএল 0.8×–1.0× নিলে সতর্ক
                    এন্ট্রির জন্য ভালো হয়।</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">কখন কিনবেন/বিক্রি করবেন</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">কিনবেন কখন (লং)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">ইভি +0.30 বা তার বেশি হলে</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা 55% বা তার বেশি হলে</li> <li class="svelte-1bz53f9">ব্যান্ড সরু হলে (পরিষ্কার পথ)</li> <li class="svelte-1bz53f9">মাঝের রাস্তা উপরের দিকে হলে</li> <li class="svelte-1bz53f9">স্টপ-লস 1.0×–1.25× ATR হলে</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">উদাহরণ: ইভি +0.45, pWin 62%, ব্যান্ড সরু → কিনুন</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">বিক্রি করবেন কখন (শর্ট)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">শর্ট ইভি +0.20 বা তার বেশি হলে</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা 50% বা তার বেশি হলে</li> <li class="svelte-1bz53f9">ব্যান্ড সরু হলে</li> <li class="svelte-1bz53f9">মাঝের রাস্তা নিচের দিকে হলে</li> <li class="svelte-1bz53f9">স্টপ-লস 0.8×–1.0× ATR হলে</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">উদাহরণ: ইভি +0.25, pWin 54%, ব্যান্ড সরু → বিক্রি করুন</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">কখন অপেক্ষা করবেন</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">ইভি নেগেটিভ হলে (−0.10 বা তার কম)</li> <li class="svelte-1bz53f9">ব্যান্ড খুব প্রশস্ত হলে (অনিশ্চয়তা বেশি)</li> <li class="svelte-1bz53f9">জেতার সম্ভাবনা 45% এর কম হলে</li> <li class="svelte-1bz53f9">ব্যান্ড বড় সাপোর্ট/রেজিস্ট্যান্সের সঙ্গে মিলে গেলে</li> <li class="svelte-1bz53f9">winR/lossR ভারসাম্য খারাপ হলে (winR ≤ 1.0 বা lossR ≥ 1.2)</li></ul> <p class="text-sm text-base-content/70 mt-2 svelte-1bz53f9">উদাহরণ: ইভি −0.15, pWin 42%, ব্যান্ড প্রশস্ত → অপেক্ষা করুন</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">টিপস</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">এডিট পপআপে গিয়ে ব্যান্ডের রং, অপাসিটি ও লাইনের স্টাইল বদলাতে
                  পারেন।</li> <li class="svelte-1bz53f9">ইভি টেবিলে ক্লিক করলে স্টপ পাল্টায়; চার্টের ড্যাশড লাইনও সাথে
                  সাথে বদলে যায়।</li> <li class="svelte-1bz53f9">ট্রেন্ড ফিল্টার বা ভলিউমের সঙ্গে জোড়া দিলে সিদ্ধান্ত আরও শক্ত
                  হয়।</li> <li class="svelte-1bz53f9">রিস্ক ম্যানেজমেন্ট: এক ট্রেডে 1–2% এর বেশি রিস্ক নেবেন না</li> <li class="svelte-1bz53f9">কনফার্মেশন: ক্যান্ডেলস্টিক প্যাটার্ন বা ইন্ডিকেটর কনফার্মেশন
                  নিন</li></ul></div>`,1),dD=de(`<div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Simple Explanation</div> <p class="text-sm text-base-content/70 svelte-1bz53f9">Think of it like looking at old pictures to guess today’s story.
                The indicator finds past patterns that look very similar to now,
                follows their path to estimate what might happen next, and uses
                historical MAE to suggest a safe place to stop (stop‑loss). The
                colored band is the expected range (P10–P90), the middle line is
                the median path, and the dashed lines are suggested long/short
                stops.</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Chart Elements</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">Middle road: the central line showing the likely path.</li> <li class="svelte-1bz53f9">Colored band: the area where price may move (P10–P90). Narrow
                  means clearer path; wide means more uncertainty.</li> <li class="svelte-1bz53f9">Stop marks: dashed lines for suggested long/short stops.</li> <li class="svelte-1bz53f9">EV table: shows overall gain‑loss balance for different stops.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Overlay Panels</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">Info Panel</span>: shows <span class="font-medium svelte-1bz53f9">Active</span> (Long/Short), <span class="font-medium svelte-1bz53f9">Anchor</span> (current
                  price), <span class="font-medium svelte-1bz53f9">Stop</span> (SL price and
                  ×ATR), <span class="font-medium svelte-1bz53f9">pWin</span>, <span class="font-medium svelte-1bz53f9">winR</span>, <span class="font-medium svelte-1bz53f9">lossR</span>—quick context for
                  decisions.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">Decision Panel</span>: prominently
                  displays <span class="font-medium svelte-1bz53f9">Action: BUY/SELL/WAIT</span> with <span class="font-medium svelte-1bz53f9">Band</span> (Narrow/Normal/Wide), <span class="font-medium svelte-1bz53f9">1R</span> distance, and <span class="font-medium svelte-1bz53f9">criteria summary</span>. <br class="svelte-1bz53f9">BUY (Long): EV ≥ 0.30 and pWin ≥ 55%, band not Wide. <br class="svelte-1bz53f9">SELL (Short): EV ≥ 0.20 and pWin ≥ 50%, band not Wide. <br class="svelte-1bz53f9">Otherwise: WAIT.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">EV Table (Example)</div> <div class="overflow-x-auto svelte-1bz53f9"><table class="table table-xs svelte-1bz53f9"><thead class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><th class="svelte-1bz53f9">Side</th><th class="svelte-1bz53f9">SL (×ATR)</th><th class="svelte-1bz53f9">EV (R)</th><th class="svelte-1bz53f9">pWin (%)</th><th class="svelte-1bz53f9">winR</th><th class="svelte-1bz53f9">lossR</th></tr></thead><tbody class="svelte-1bz53f9"><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">L</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">+0.45</td><td class="svelte-1bz53f9">62</td><td class="svelte-1bz53f9">1.60</td><td class="svelte-1bz53f9">0.95</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">L</td><td class="svelte-1bz53f9">1.25×</td><td class="svelte-1bz53f9">+0.30</td><td class="svelte-1bz53f9">68</td><td class="svelte-1bz53f9">1.35</td><td class="svelte-1bz53f9">0.80</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">S</td><td class="svelte-1bz53f9">0.80×</td><td class="svelte-1bz53f9">+0.20</td><td class="svelte-1bz53f9">54</td><td class="svelte-1bz53f9">1.10</td><td class="svelte-1bz53f9">0.85</td></tr><tr class="svelte-1bz53f9"><td class="svelte-1bz53f9">S</td><td class="svelte-1bz53f9">1.00×</td><td class="svelte-1bz53f9">−0.05</td><td class="svelte-1bz53f9">48</td><td class="svelte-1bz53f9">1.20</td><td class="svelte-1bz53f9">1.10</td></tr></tbody></table></div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">EV: the overall expectancy—combines win and loss outcomes.</li> <li class="svelte-1bz53f9">pWin (%): out of 100. Higher means better chance to win.</li> <li class="svelte-1bz53f9">winR and lossR: how much you might win or lose. Balance them.</li> <li class="svelte-1bz53f9">If EV ≥ 0, consider the row; higher EV means better overall
                  expectancy.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">How the ▶ arrow works</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">The ▶ in the table marks the <span class="font-medium svelte-1bz53f9">active SL multiplier</span>. Click inside the table to move it to the next row.</li> <li class="svelte-1bz53f9">Where ▶ sits, the chart’s dashed stop‑lines update using that
                  row’s <span class="font-medium svelte-1bz53f9">SL (×ATR)</span>.</li> <li class="svelte-1bz53f9">If ▶ is on a Long row: think with a long bias; the stop is
                  usually below current price (<span class="font-medium svelte-1bz53f9">anchor − mult × ATR</span>).</li> <li class="svelte-1bz53f9">If ▶ is on a Short row: think with a short bias; the stop is
                  usually above current price (<span class="font-medium svelte-1bz53f9">anchor + mult × ATR</span>).</li> <li class="svelte-1bz53f9">Best practice: place ▶ on rows with <span class="font-medium svelte-1bz53f9">positive EV</span>, <span class="font-medium svelte-1bz53f9">higher pWin</span>, and <span class="font-medium svelte-1bz53f9">controlled lossR</span>.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Arrow Example (Short)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">Suppose ▶ is on a Short row with <span class="font-medium svelte-1bz53f9">SL = 1.50×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.71</span>, <span class="font-medium svelte-1bz53f9">lossR = 1.46</span>.</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.50×</span> means stop
                    distance is <span class="font-medium svelte-1bz53f9">1.5 × ATR</span> above
                    anchor. Far stop → fewer stop‑hits; risk unit is larger.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.71</span> means average win
                    is <span class="font-medium svelte-1bz53f9">1.71R</span>. If 1R = 100 units
                    risk, average win ≈ 171.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 1.46</span> means average
                    loss is <span class="font-medium svelte-1bz53f9">1.46R</span>.</li> <li class="svelte-1bz53f9">Decision: if pWin ≈ 55%, <span class="font-medium svelte-1bz53f9">EV = pWin × winR − (1−pWin) × lossR</span> = 0.55×1.71 − 0.45×1.46 ≈ <span class="font-medium svelte-1bz53f9">+0.28R</span> → acceptable.</li> <li class="svelte-1bz53f9">If pWin drops below ~45% or lossR rises, move ▶ to a better
                    row (smaller SL or higher EV).</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Arrow Example (Long)</div> <div class="text-sm text-base-content/70 space-y-2 svelte-1bz53f9"><p class="svelte-1bz53f9">Suppose ▶ is on a Long row with <span class="font-medium svelte-1bz53f9">SL = 1.00×</span>, <span class="font-medium svelte-1bz53f9">winR = 1.40</span>, <span class="font-medium svelte-1bz53f9">lossR = 0.90</span>.</p> <ul class="list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">SL 1.00×</span> means stop
                    distance is <span class="font-medium svelte-1bz53f9">1 × ATR</span> below anchor.
                    Closer stop → smaller risk; may get hit more often.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">winR 1.40</span> means average win
                    is 1.40R.</li> <li class="svelte-1bz53f9"><span class="font-medium svelte-1bz53f9">lossR 0.90</span> means average loss
                    is 0.90R.</li> <li class="svelte-1bz53f9">If pWin ≈ 60%, <span class="font-medium svelte-1bz53f9">EV ≈ 0.60×1.40 − 0.40×0.90 = +0.54R</span> → strong setup.</li> <li class="svelte-1bz53f9">If band is very wide or pWin is low, move ▶ to rows with
                    positive EV and controlled lossR.</li></ul></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Band‑Based Decisions</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">Narrow band: clearer path—slightly increase conviction if
                  suitable.</li> <li class="svelte-1bz53f9">Wide band: more uncertainty—reduce size or wait for clarity.</li> <li class="svelte-1bz53f9">If band overlaps major support/resistance: be cautious; use a
                  safer stop.</li></ul></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Examples</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Long Bias</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">Middle road is upward. EV +0.30→+0.60, pWin 55–65%. SL
                    1.0×–1.25× often gives a good balance between win chance and
                    lossR.</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Short Bias</div> <p class="text-xs text-base-content/70 mt-1 svelte-1bz53f9">Middle road is downward. Short EV +0.20→+0.45. If the band
                    overlaps prior lows, SL 0.8×–1.0× is a careful choice.</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">When to Buy/Sell</div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-1bz53f9"><div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Buy When (Long)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">EV +0.30 or higher</li> <li class="svelte-1bz53f9">pWin 55% or higher</li> <li class="svelte-1bz53f9">Band is narrow (clear path)</li> <li class="svelte-1bz53f9">Middle road is upward</li> <li class="svelte-1bz53f9">Stop-loss 1.0×–1.25× ATR</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">Example: EV +0.45, pWin 62%, narrow band → Buy</p></div> <div class="p-3 rounded-md border border-base-300 bg-base-50 svelte-1bz53f9"><div class="text-xs font-semibold text-base-content svelte-1bz53f9">Sell When (Short)</div> <ul class="text-xs text-base-content/70 mt-1 list-disc pl-4 space-y-1 svelte-1bz53f9"><li class="svelte-1bz53f9">Short EV +0.20 or higher</li> <li class="svelte-1bz53f9">pWin 50% or higher</li> <li class="svelte-1bz53f9">Band is narrow</li> <li class="svelte-1bz53f9">Middle road is downward</li> <li class="svelte-1bz53f9">Stop-loss 0.8×–1.0× ATR</li></ul> <p class="text-xs text-base-content/60 mt-2 svelte-1bz53f9">Example: EV +0.25, pWin 54%, narrow band → Sell</p></div></div></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">When to Wait</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">EV is negative (−0.10 or worse)</li> <li class="svelte-1bz53f9">Band is very wide (high uncertainty)</li> <li class="svelte-1bz53f9">pWin below 45%</li> <li class="svelte-1bz53f9">Band overlaps major support/resistance</li> <li class="svelte-1bz53f9">Poor winR/lossR balance (winR ≤ 1.0 or lossR ≥ 1.2)</li></ul> <p class="text-sm text-base-content/70 mt-2 svelte-1bz53f9">Example: EV −0.15, pWin 42%, wide band → Wait</p></div> <div class="space-y-2 svelte-1bz53f9"><div class="text-sm font-semibold text-base-content svelte-1bz53f9">Tips</div> <ul class="text-sm text-base-content/70 list-disc pl-5 svelte-1bz53f9"><li class="svelte-1bz53f9">Use the edit popup to change band opacity, colors, and line
                  styles.</li> <li class="svelte-1bz53f9">Click inside the EV table to change stops; dashed lines update
                  instantly.</li> <li class="svelte-1bz53f9">Pair with trend filters or volume to make decisions more
                  robust.</li> <li class="svelte-1bz53f9">Risk management: Don't risk more than 1–2% per trade</li> <li class="svelte-1bz53f9">Confirmation: Wait for candlestick pattern or indicator
                  confirmation</li></ul></div>`,1),uD=de('<div class="fixed inset-0 z-[60] svelte-1bz53f9"><div class="absolute inset-0 bg-base-200/20 svelte-1bz53f9"></div> <div class="absolute inset-0 flex items-center justify-center p-4 svelte-1bz53f9"><div class="w-full max-w-3xl rounded-xl shadow-2xl border border-base-300 bg-base-100 overflow-hidden svelte-1bz53f9"><div class="flex items-center justify-between px-5 py-4 border-b border-base-300 bg-base-50 svelte-1bz53f9"><div class="flex items-center gap-3 svelte-1bz53f9"><div class="w-8 h-8 rounded-lg flex items-center justify-center bg-primary/10 text-primary svelte-1bz53f9"><svg class="w-5 h-5 svelte-1bz53f9" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10" class="svelte-1bz53f9"></circle><line x1="12" y1="16" x2="12" y2="12" class="svelte-1bz53f9"></line><line x1="12" y1="8" x2="12.01" y2="8" class="svelte-1bz53f9"></line></svg></div> <div class="svelte-1bz53f9"><div class="text-base font-semibold text-base-content svelte-1bz53f9"> </div> <div class="text-xs text-base-content/60 svelte-1bz53f9"> </div></div></div> <div class="flex items-center gap-2 svelte-1bz53f9"><button>বাংলা</button> <button>English</button></div> <button class="btn btn-xs btn-ghost svelte-1bz53f9" aria-label="Close"><svg class="w-4 h-4 svelte-1bz53f9" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18" class="svelte-1bz53f9"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-1bz53f9"></line></svg></button></div> <div class="px-5 py-4 space-y-5 max-h-[70vh] overflow-y-auto svelte-1bz53f9"><!></div></div></div></div>'),pD=(o,e)=>b(e,!1),vD=(o,e)=>b(e,!1),fD=de(`<div class="premium-modal-backdrop svelte-1bz53f9" role="presentation"></div> <div class="premium-modal-container svelte-1bz53f9" role="dialog" aria-modal="true" aria-labelledby="premium-modal-title"><div class="premium-background svelte-1bz53f9"><div class="premium-orb premium-orb-1 svelte-1bz53f9"></div> <div class="premium-orb premium-orb-2 svelte-1bz53f9"></div></div> <div class="premium-content svelte-1bz53f9"><button class="premium-close-btn svelte-1bz53f9" aria-label="Close"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><line x1="18" y1="6" x2="6" y2="18" class="svelte-1bz53f9"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-1bz53f9"></line></svg></button> <div class="premium-icon-wrapper svelte-1bz53f9"><div class="premium-icon svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-1bz53f9"></path><path d="M2 17l10 5 10-5" class="svelte-1bz53f9"></path><path d="M2 12l10 5 10-5" class="svelte-1bz53f9"></path></svg> <div class="premium-icon-glow svelte-1bz53f9"></div></div></div> <h2 id="premium-modal-title" class="premium-title svelte-1bz53f9">Premium Feature</h2> <p class="premium-message svelte-1bz53f9">Smart Trend is an exclusive premium indicator. Upgrade to Premium to
        unlock this advanced trend-following tool and enhance your trading
        strategy.</p> <div class="premium-features svelte-1bz53f9"><div class="premium-feature-item svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><polyline points="20 6 9 17 4 12" class="svelte-1bz53f9"></polyline></svg> <span class="svelte-1bz53f9">Smart Trend Indicator</span></div> <div class="premium-feature-item svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><polyline points="20 6 9 17 4 12" class="svelte-1bz53f9"></polyline></svg> <span class="svelte-1bz53f9">AI Indicators (Smart Money, Trap Hunter, Volcanic)</span></div> <div class="premium-feature-item svelte-1bz53f9"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><polyline points="20 6 9 17 4 12" class="svelte-1bz53f9"></polyline></svg> <span class="svelte-1bz53f9">More premium features coming soon</span></div></div> <a target="_blank" rel="noopener noreferrer" class="premium-payment-btn svelte-1bz53f9"><span class="svelte-1bz53f9">Upgrade to Premium</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-1bz53f9"><line x1="5" y1="12" x2="19" y2="12" class="svelte-1bz53f9"></line><polyline points="12 5 19 12 12 19" class="svelte-1bz53f9"></polyline></svg></a></div></div>`,1),gD=de("<!> <!> <!>",1);function mD(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(p,"$chart",t),i=()=>ir(v,"$save",t),r=()=>ir(d,"$ctx",t),a=()=>ir(Up,"$userPreferences",t);let l=Ss(e,"show",15);const d=Fa("ctx"),v=Fa("save"),p=Fa("chart"),_=w1(),y=[{name:"BBI",title:"BBI (Bull and Bear Index)",is_main:!1},{name:"BOLL",title:"BOLL (Bollinger Bands)",is_main:!0},{name:"EMA",title:"EMA (Exponential Moving Average)",is_main:!0},{name:"ICHIMOKU",title:"ICHIMOKU (Ichimoku Kinko Hyo)",is_main:!0},{name:"MA",title:"MA (Moving Average)",is_main:!0},{name:"SAR",title:"SAR (Parabolic SAR)",is_main:!0},{name:"SMA",title:"SMA (Simple Moving Average)",is_main:!0},{name:"SMARTTREND",title:"Smart Trend",is_main:!0},{name:"ZIGZAG",title:"ZigZag (Trend Reversal Indicator)",is_main:!0},{name:"AO",title:"Awesome Oscillator",is_main:!1},{name:"BIAS",title:"BIAS (Bias)",is_main:!1},{name:"CCI",title:"CCI (Commodity Channel Index)",is_main:!1},{name:"CR",title:"CR (Energy)",is_main:!1},{name:"DMI",title:"DMI (Directional Movement Index)",is_main:!1},{name:"EMV",title:"EMV (Ease of Movement)",is_main:!1},{name:"KDJ",title:"KDJ (KDJ Index)",is_main:!1},{name:"MACD",title:"MACD (Moving Average Convergence Divergence)",is_main:!1},{name:"MTM",title:"MTM (Momentum)",is_main:!1},{name:"OBV",title:"OBV (On Balance Volume)",is_main:!1},{name:"PSY",title:"PSY (Psychological Line)",is_main:!1},{name:"PVT",title:"PVT (Price Volume Trend)",is_main:!1},{name:"ROC",title:"ROC (Rate of Change)",is_main:!1},{name:"RSI",title:"RSI (Relative Strength Index)",is_main:!1},{name:"STOCH",title:"STOCH (Stochastic Oscillator)",is_main:!1},{name:"TRIX",title:"TRIX (Triple Exponential Moving Average)",is_main:!1},{name:"VOL",title:"VOL (Volume)",is_main:!0},{name:"VR",title:"VR (Volume Variation Rate)",is_main:!1},{name:"WR",title:"WR (Williams Percentage Range)",is_main:!1}];y.push({name:"NPO_MAE",title:"Nearest‑Pattern Outcome + MAE‑Stop",is_main:!0});const w=y.slice().sort((ee,xe)=>ee.name.localeCompare(xe.name));function k(ee){const xe=y.find(ke=>ke.name===ee);return xe?xe.title:ee}function S(ee,xe){const ke=new Set;if(!(ee!=null&&ee.getIndicators))return ke;try{ee.getIndicators().forEach(Ie=>{(Ie==null?void 0:Ie.name)===xe&&(Ie!=null&&Ie.paneId)&&ke.add(Ie.paneId)})}catch(He){console.warn(`⚠️ Failed to read ${xe} pane IDs from chart:`,He)}return ke}function L(ee,xe){if(!xe.has(ee))return ee;let ke=2;for(;xe.has(`${ee}_${ke}`)&&ke<1e3;)ke+=1;if(!xe.has(`${ee}_${ke}`))return`${ee}_${ke}`;let He=`${ee}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;for(;xe.has(He);)He=`${ee}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;return He}function T(ee,xe,ke,He){const Ie=S(ee,xe);for(const ne of Ie)if(!ke.has(ne))return ne;return He}let P=oe(j(new Set));function A(){var ke,He,Ie,ne,J,qe;const ee=new Set;if(s())try{const ft=((He=(ke=s()).getIndicators)==null?void 0:He.call(ke))??[];ft.forEach(ct=>{ct&&ct.name&&ee.add(ct.name)}),console.log("📊 Indicator list - from chart.getIndicators:",ft.map(ct=>ct.name));const Qe=((ne=(Ie=s()).getOverlays)==null?void 0:ne.call(Ie))??[];(Qe==null?void 0:Qe.some(ct=>(ct==null?void 0:ct.name)==="NearestPatternOutcomeMaeStop"))&&ee.add("NPO_MAE")}catch(ft){console.warn("⚠️ Indicator list - getIndicators failed, falling back to saveInds",ft)}if(ee.size===0&&i()&&i().saveInds){Object.values(i().saveInds).forEach(ft=>{ft&&ft.name&&ee.add(ft.name)}),console.log("📊 Indicator list - from saveInds (fallback):",Array.from(ee));try{(((qe=(J=s())==null?void 0:J.getOverlays)==null?void 0:qe.call(J))??[]).some(Qe=>(Qe==null?void 0:Qe.name)==="NearestPatternOutcomeMaeStop")||ee.delete("NPO_MAE")}catch{}}const xe=Array.from(ee).map(ft=>k(ft));console.log("🔄 selectedIndicators updated:",xe),b(P,j(ee))}Wi(()=>{var ee;l(),s(),(ee=i())==null||ee.saveInds,A()}),Rd(()=>{console.log("modalIndSearch mounted"),console.log("Available ActionTypes:",Object.keys(Xu)),console.log("ActionType values:",Object.values(Xu)),console.log("🔍 localStorage content:");for(let ee=0;ee<localStorage.length;(ee+=1)-1){const xe=localStorage.key(ee);xe&&console.log(`🔍 ${xe}:`,localStorage.getItem(xe))}window.debugChart=()=>{const ee=JSON.parse(localStorage.getItem("chart")||"{}");return console.log("🔍 localStorage chart data:",ee),console.log("🔍 saveInds keys:",Object.keys(ee.saveInds||{})),console.log("🔍 Current $save.saveInds keys:",Object.keys(i().saveInds)),console.log("🔍 Chart available:",s()?"Yes":"No chart"),{localStorage:ee,currentSave:i().saveInds}},setTimeout(()=>{console.log("🚀 Auto-debug on page load:"),window.debugChart()},2e3),console.log("🔍 Debug function added: window.debugChart()")});let F=oe(""),B=oe(!1),R=oe(j(new Set)),N=oe(!1),$=oe(!1),V=oe(!0),U=oe(0),G,Z=oe(!1),le=oe("bn"),se=oe(!1);Wi(()=>{n(Z)&&l()?(b(se,!0),l(!1)):!n(Z)&&!l()&&n(se)&&(b(se,!1),l(!0))}),Wi(()=>{!r().modalIndCfg&&n(B)&&(b(B,!1),setTimeout(()=>{l(!0)},100))});let ie=We(()=>{let ee=w;if(n(F)){const xe=n(F).toLowerCase();ee=ee.filter(ke=>ke.name.toLowerCase().includes(xe)||ke.title.toLowerCase().includes(xe)).sort((ke,He)=>ke.name.localeCompare(He.name))}if(l()&&n(R).size>0){const xe=ee.filter(He=>n(R).has(He.name)),ke=ee.filter(He=>!n(R).has(He.name));return[...xe,...ke]}return ee});Wi(()=>{var ee,xe;if(l()!==n(N)){if(l()){const ke=new Set;if((xe=(ee=n(P)).forEach)==null||xe.call(ee,He=>ke.add(He)),ke.size===0&&n(P)&&n(P).size>0)for(const He of n(P).values())ke.add(He);b(R,j(ke))}else b(R,j(new Set));b(N,j(l()))}});function Y(){var xe;const ee=(xe=a())==null?void 0:xe.data;return ee?ee.isPremium===!0||ee.isTrial===!0:!1}async function K(ee,xe,ke,He=800){var ne;const Ie=Date.now();for(;Date.now()-Ie<He;){try{const J=((ne=ee.getIndicators)==null?void 0:ne.call(ee,{name:xe,paneId:ke}))??[];if(J.length>0&&J.some(ft=>(ft==null?void 0:ft.result)&&Object.keys(ft.result).length>0))return}catch{}await new Promise(J=>setTimeout(J,16))}}async function Q(ee,xe){var ke,He,Ie,ne,J,qe,ft,Qe,Oe,ct,Lt,It,zt,pt,Mo,Xo,en,Fo;if(xe==="SMARTTREND"&&!Y()){console.log("🔒 Premium access required for Smart Trend indicator"),b($,!0);return}if(xe==="BBI")_e(xe,[3,6,12,24],!0,{id:"pane_BBI"});else if(xe==="EMA")_e(xe,[20],!0,{id:"candle_pane"});else if(xe==="MA"){const Eo="candle_pane",cs=s();if(cs){const Zt=cs.createIndicator({name:"MA",calcParams:[20],styles:{lines:[{color:"#2563eb",size:1,style:Ee.Solid}]},createTooltipDataSource:({indicator:bs})=>{const es=[bs.visible?1:0,2,3],rn=cs.getStyles().indicator.tooltip;return{icons:es.map(rr=>rn.features[rr])}}},!0,{id:Eo});if(await K(cs,"MA",Eo),Zt){const bs={name:"MA",pane_id:Eo,params:[20],styles:[{color:"#2563eb",thickness:1,lineStyle:"solid"}]},es=`${Eo}_MA`;v.update(rn=>(rn.saveInds[es]=bs,rn))}}}else if(xe==="SMARTTREND"){const Eo="candle_pane",cs=s();if(cs){const Zt=cs.createIndicator({name:"SMARTTREND",calcParams:[10,3],styles:{lines:[{color:"#00FF00",size:1,style:Ee.Dashed,dashedValue:[4,4]}]},extendData:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"},createTooltipDataSource:({indicator:bs})=>{const es=[bs.visible?1:0,2,3],rn=cs.getStyles().indicator.tooltip;return{icons:es.map(rr=>rn.features[rr])}}},!0,{id:Eo});if(await K(cs,"SMARTTREND",Eo),Zt){const bs={name:"SMARTTREND",pane_id:Eo,params:[10,3],superTrendGroups:[{id:"st_default",period:10,multiplier:3,showLabels:!0,styles:{uptrend:{color:"#00FF00",thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}}]},es=`${Eo}_SMARTTREND`;v.update(rn=>(rn.saveInds[es]=bs,rn))}}}else if(xe==="SMA"){const Eo="candle_pane",cs=s();if(cs){const Zt=cs.createIndicator({name:"SMA",calcParams:[20],styles:{lines:[{color:"#FF6C37",size:2,style:Ee.Solid}]},createTooltipDataSource:({indicator:bs})=>{const es=[bs.visible?1:0,2,3],rn=cs.getStyles().indicator.tooltip;return{icons:es.map(rr=>rn.features[rr])}}},!0,{id:Eo});if(await K(cs,"SMA",Eo),Zt){const bs={name:"SMA",pane_id:Eo,params:[20],styles:[{color:"#FF6C37",thickness:2,lineStyle:"solid"}]},es=`${Eo}_SMA`;v.update(rn=>(rn.saveInds[es]=bs,rn))}}}else if(xe==="RSI"){const Eo=s();if(!Eo)return;let cs=[];try{const ii=localStorage.getItem("rsiGroups");ii&&(cs=JSON.parse(ii))}catch(ii){console.warn("Failed to load saved RSI groups:",ii)}cs.length===0&&(cs=[{id:"rsi_default",period:14,overbought:70,middle:50,oversold:30,styles:{rsi:{color:"#8B5CF6",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",oversoldColor:"#10B981",middleLineColor:"#6B7280"}}]);const Zt=cs[0],bs=Zt.overboughtLevel??Zt.overbought??70,es=Zt.middleLevel??Zt.middle??50,rn=Zt.oversoldLevel??Zt.oversold??30,wr=S(Eo,"RSI"),rr=new Set(wr);Object.values(i().saveInds).forEach(ii=>{(ii==null?void 0:ii.name)==="RSI"&&(ii!=null&&ii.pane_id)&&rr.add(ii.pane_id)});const ar=L("pane_RSI",rr),jr=Eo.createIndicator({name:"RSI",calcParams:[Zt.period],styles:{lines:[{color:((He=(ke=Zt.styles)==null?void 0:ke.rsi)==null?void 0:He.color)||"#8B5CF6",size:((ne=(Ie=Zt.styles)==null?void 0:Ie.rsi)==null?void 0:ne.thickness)??2,style:((qe=(J=Zt.styles)==null?void 0:J.rsi)==null?void 0:qe.lineStyle)==="dashed"||((Qe=(ft=Zt.styles)==null?void 0:ft.rsi)==null?void 0:Qe.lineStyle)==="dotted"?Ee.Dashed:Ee.Solid}]}},!1,{id:ar,axis:{gap:{bottom:2}}});if(await K(Eo,"RSI",ar),jr){const ii=T(Eo,"RSI",wr,ar),Xa={id:Zt.id||`rsi_${Date.now()}`,period:Zt.period,overboughtLevel:bs,middleLevel:es,oversoldLevel:rn,paneId:ii,actualPaneId:ii,styles:{rsi:{color:((ct=(Oe=Zt.styles)==null?void 0:Oe.rsi)==null?void 0:ct.color)||"#8B5CF6",thickness:((It=(Lt=Zt.styles)==null?void 0:Lt.rsi)==null?void 0:It.thickness)??2,lineStyle:((pt=(zt=Zt.styles)==null?void 0:zt.rsi)==null?void 0:pt.lineStyle)||"solid"},overboughtColor:((Mo=Zt.styles)==null?void 0:Mo.overboughtColor)||"#EF4444",oversoldColor:((Xo=Zt.styles)==null?void 0:Xo.oversoldColor)||"#10B981",middleLineColor:((en=Zt.styles)==null?void 0:en.middleLineColor)||"#6B7280"}},Ja={name:"RSI",pane_id:ii,params:[Zt.period],rsiGroups:[Xa]},Va=`${ii}_RSI`;v.update(Wa=>(Wa.saveInds[Va]=Ja,Wa))}}else if(xe==="STOCH"){const Eo="pane_STOCH";let cs=[];try{const es=localStorage.getItem("stochasticGroups");es&&(cs=JSON.parse(es))}catch(es){console.warn("Failed to load saved Stochastic groups:",es)}cs.length===0&&(cs=[{id:"stochastic_default",kPeriod:14,dPeriod:3,overbought:80,mid:50,oversold:20,styles:{k:{color:"#3B82F6",thickness:2,lineStyle:"solid"},d:{color:"#EF4444",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",oversoldColor:"#10B981",midColor:"#6B7280"}}]);const Zt=cs[0],bs=s();if(bs&&bs.createIndicator({name:"STOCH",calcParams:[Zt.kPeriod,Zt.dPeriod],styles:{lines:[{color:Zt.styles.k.color,size:Zt.styles.k.thickness,style:Zt.styles.k.lineStyle==="dashed"||Zt.styles.k.lineStyle==="dotted"?Ee.Dashed:Ee.Solid},{color:Zt.styles.d.color,size:Zt.styles.d.thickness,style:Zt.styles.d.lineStyle==="dashed"||Zt.styles.d.lineStyle==="dotted"?Ee.Dashed:Ee.Solid}]}},!0,{id:Eo})){const rn={name:"STOCH",pane_id:Eo,params:[Zt.kPeriod,Zt.dPeriod]},wr=`${Eo}_STOCH`;v.update(rr=>(rr.saveInds[wr]=rn,rr))}}else if(xe==="NPO_MAE"){const Eo=s();if(!Eo)return;if(!(((Fo=Eo.getOverlays)==null?void 0:Fo.call(Eo))??[]).some(Zt=>(Zt==null?void 0:Zt.name)==="NearestPatternOutcomeMaeStop")){const Zt=GF(Eo);window.__npoMaeApi=Zt,v.update(bs=>{const es="candle_pane_NPO_MAE";return bs.saveInds[es]={name:"NPO_MAE",pane_id:"candle_pane"},bs})}}else{const Eo=ee?"candle_pane":"pane_"+xe;_e(xe,void 0,!0,{id:Eo})}}function q(ee){var ke,He;let xe=Object.entries(i().saveInds).find(([Ie,ne])=>ne.name===ee);if(!xe&&s())try{const ne=(((He=(ke=s()).getIndicators)==null?void 0:He.call(ke))??[]).find(J=>J&&J.name===ee);if(ne){Ir(d,Uo(r).editIndName=ee,Uo(r)),Ir(d,Uo(r).editPaneId=ne.paneId||r().editPaneId||"candle_pane",Uo(r)),Ir(d,Uo(r).modalIndCfg=!0,Uo(r)),b(B,!0),l(!1);return}}catch(Ie){console.warn("⚠️ Failed to locate indicator on chart for edit:",Ie)}if(xe){const[,Ie]=xe;Ir(d,Uo(r).editIndName=ee,Uo(r)),Ir(d,Uo(r).editPaneId=Ie.pane_id,Uo(r)),Ir(d,Uo(r).modalIndCfg=!0,Uo(r)),b(B,!0),l(!1)}}function ce(ee){var xe,ke,He;if(ee==="NPO_MAE"){const Ie=s();if(Ie)try{(((xe=Ie.getOverlays)==null?void 0:xe.call(Ie))??[]).forEach(J=>{if((J==null?void 0:J.name)==="NearestPatternOutcomeMaeStop")try{Ie.removeOverlay({id:J.id})}catch{}})}catch{}try{(He=(ke=window.__npoMaeApi)==null?void 0:ke.dispose)==null||He.call(ke),window.__npoMaeApi=null}catch{}v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{var qe;((qe=ne.saveInds[J])==null?void 0:qe.name)==="NPO_MAE"&&delete ne.saveInds[J]}),ne));return}if(ee==="MACD")Object.entries(i().saveInds).filter(([ne,J])=>J.name==="MACD").forEach(([ne,J])=>{me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="MACD"&&delete ne.saveInds[J]}),ne));else if(ee==="RSI")Object.entries(i().saveInds).filter(([ne,J])=>J.name==="RSI").forEach(([ne,J])=>{me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="RSI"&&delete ne.saveInds[J]}),ne));else if(ee==="STOCH")Object.entries(i().saveInds).filter(([ne,J])=>J.name==="STOCH").forEach(([ne,J])=>{me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="STOCH"&&delete ne.saveInds[J]}),ne));else if(ee==="BBI")Object.entries(i().saveInds).filter(([ne,J])=>J.name==="BBI").forEach(([ne,J])=>{me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="BBI"&&delete ne.saveInds[J]}),ne));else if(ee==="AO"){if(console.log("🗑️ Starting bulk AO deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="AO");console.log("📊 Found AO indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing AO indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"AO"})}),console.log("✅ All AO indicators removed from chart")}catch(ne){console.error("❌ Error removing AO indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="AO");console.log("🗑️ Deleting AO saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="AO"&&(console.log("🗑️ Clearing AO saved data:",J),delete ne.saveInds[J])}),ne)),console.log("✅ Bulk AO deletion completed")}else if(ee==="DMI"){if(console.log("🗑️ Starting bulk DMI deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="DMI");console.log("📊 Found DMI indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing DMI indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"DMI"})}),console.log("✅ All DMI indicators removed from chart")}catch(ne){console.error("❌ Error removing DMI indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="DMI");console.log("🗑️ Deleting DMI saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="DMI"&&(console.log("🗑️ Clearing DMI saved data:",J),delete ne.saveInds[J])}),ne)),console.log("✅ Bulk DMI deletion completed")}else if(ee==="SAR"){if(console.log("🗑️ Starting bulk SAR deletion..."),s())try{const ne=s().getIndicators().filter(J=>J.name==="SAR");console.log("📊 Found SAR indicators on chart:",ne.length),ne.forEach(J=>{console.log("🗑️ Removing SAR from pane:",J.paneId),s().removeIndicator({paneId:J.paneId,name:"SAR"})})}catch(Ie){console.error("❌ Error removing SAR indicators from chart:",Ie);try{s().removeIndicator({paneId:"candle_pane",name:"SAR"})}catch{}try{s().removeIndicator({paneId:r().editPaneId,name:"SAR"})}catch{}}v.update(Ie=>(Object.keys(Ie.saveInds).forEach(ne=>{Ie.saveInds[ne].name==="SAR"&&delete Ie.saveInds[ne]}),Ie)),d.update(Ie=>(Ie.editIndName==="SAR"&&(Ie.editIndName="",Ie.editPaneId="",Ie.modalIndCfg=!1),Ie)),console.log("✅ Bulk SAR deletion completed")}else if(ee==="SMARTTREND"){if(console.log("🗑️ Starting bulk Smart Trend deletion..."),s())try{const ne=s().getIndicators().filter(J=>J.name==="SMARTTREND");console.log("📊 Found Smart Trend indicators on chart:",ne.length),ne.forEach(J=>{console.log("🗑️ Removing Smart Trend from pane:",J.paneId),s().removeIndicator({paneId:J.paneId,name:"SMARTTREND"})})}catch(Ie){console.error("❌ Error removing Smart Trend indicators from chart:",Ie);try{s().removeIndicator({paneId:"candle_pane",name:"SMARTTREND"})}catch{}try{s().removeIndicator({paneId:r().editPaneId,name:"SMARTTREND"})}catch{}}v.update(Ie=>(Object.keys(Ie.saveInds).forEach(ne=>{Ie.saveInds[ne].name==="SMARTTREND"&&delete Ie.saveInds[ne]}),Ie)),console.log("✅ Bulk Smart Trend deletion completed")}else if(ee==="CR"){if(console.log("🗑️ Starting bulk CR deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="CR");console.log("📊 Found CR indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing CR indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"CR"})}),console.log("✅ All CR indicators removed from chart")}catch(ne){console.error("❌ Error removing CR indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="CR");console.log("🗑️ Deleting CR saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="CR"&&(console.log("🗑️ Clearing CR saved data:",J),delete ne.saveInds[J])}),ne)),console.log("✅ Bulk CR deletion completed")}else if(ee==="WR"){if(console.log("🗑️ Starting bulk WR deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="WR");console.log("📊 Found WR indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing WR indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"WR"})}),console.log("✅ All WR indicators removed from chart")}catch(ne){console.error("❌ Error removing WR indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="WR");console.log("🗑️ Deleting WR saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="WR"&&(console.log("🗑️ Clearing WR saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearWrGroups+=1,ne)),console.log("✅ Bulk WR deletion completed")}else if(ee==="KDJ"){const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="KDJ");console.log("🗑️ Deleting KDJ entries:",Ie),Ie.forEach(([ne,J])=>{console.log("🗑️ Deleting KDJ from pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="KDJ"&&(console.log("🗑️ Clearing KDJ saved data:",J),delete ne.saveInds[J])}),ne))}else if(ee==="OBV"){const Ie=Object.entries(i().saveInds).filter(([J,qe])=>qe.name==="OBV");console.log("🗑️ Deleting OBV entries from saveInds:",Ie),Ie.forEach(([J,qe])=>{console.log("🗑️ Deleting OBV from pane (saveInds):",qe.pane_id),qe.pane_id&&me(qe.pane_id,ee)});const ne=[r().editPaneId,"pane_OBV_1","pane_OBV_2","pane_OBV_3","pane_OBV_4","pane_OBV_5","main","sub1","sub2","sub3","sub4"];console.log("🗑️ Attempting to remove OBV from common pane locations..."),ne.forEach(J=>{var qe;if(J)try{console.log("🗑️ Trying to remove OBV from pane:",J),(qe=s())==null||qe.removeIndicator({paneId:J,name:"OBV"})}catch{}}),v.update(J=>(Object.keys(J.saveInds).forEach(qe=>{J.saveInds[qe].name==="OBV"&&(console.log("🗑️ Clearing OBV saved data:",qe),delete J.saveInds[qe])}),J)),d.update(J=>(J.clearObvGroups+=1,J))}else if(ee==="CCI"){if(console.log("🗑️ Starting bulk CCI deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="CCI");console.log("📊 Found CCI indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing CCI indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"CCI"})}),console.log("✅ All CCI indicators removed from chart")}catch(ne){console.error("❌ Error removing CCI indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="CCI");console.log("🗑️ Deleting CCI saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="CCI"&&(console.log("🗑️ Clearing CCI saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearCciGroups+=1,ne)),console.log("✅ Bulk CCI deletion completed")}else if(ee==="EMV"){const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="EMV");console.log("🗑️ Deleting EMV entries:",Ie),Ie.forEach(([ne,J])=>{console.log("🗑️ Deleting EMV from pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="EMV"&&(console.log("🗑️ Clearing EMV saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearEmvGroups+=1,ne))}else if(ee==="MTM"){const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="MTM");console.log("🗑️ Deleting MTM entries:",Ie),Ie.forEach(([ne,J])=>{console.log("🗑️ Deleting MTM from pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="MTM"&&(console.log("🗑️ Clearing MTM saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearMtmGroups+=1,ne))}else if(ee==="PSY"){const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="PSY");console.log("🗑️ Deleting PSY entries:",Ie),Ie.forEach(([ne,J])=>{console.log("🗑️ Deleting PSY from pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="PSY"&&(console.log("🗑️ Clearing PSY saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearPsyGroups+=1,ne))}else if(ee==="PVT"){if(console.log("🗑️ Starting bulk PVT deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="PVT");console.log("📊 Found PVT indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing PVT indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"PVT"})}),console.log("✅ All PVT indicators removed from chart")}catch(ne){console.error("❌ Error removing PVT indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="PVT");console.log("🗑️ Deleting PVT saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="PVT"&&(console.log("🗑️ Clearing PVT saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearPvtGroups+=1,ne)),console.log("✅ Bulk PVT deletion completed")}else if(ee==="ROC"){if(console.log("🗑️ Starting bulk ROC deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="ROC");console.log("📊 Found ROC indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing ROC indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"ROC"})}),console.log("✅ All ROC indicators removed from chart")}catch(ne){console.error("❌ Error removing ROC indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="ROC");console.log("🗑️ Deleting ROC saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="ROC"&&(console.log("🗑️ Clearing ROC saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearRocGroups+=1,ne)),console.log("✅ Bulk ROC deletion completed")}else if(ee==="VR"){if(console.log("🗑️ Starting bulk VR deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="VR");console.log("📊 Found VR indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing VR indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"VR"})}),console.log("✅ All VR indicators removed from chart")}catch(ne){console.error("❌ Error removing VR indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="VR");console.log("🗑️ Deleting VR saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="VR"&&(console.log("🗑️ Clearing VR saved data:",J),delete ne.saveInds[J])}),ne)),console.log("✅ Bulk VR deletion completed")}else if(ee==="VOL"){if(console.log("🗑️ Starting bulk VOL deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="VOL");console.log("📊 Found VOL indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing VOL indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"VOL"})}),console.log("✅ All VOL indicators removed from chart")}catch(ne){console.error("❌ Error removing VOL indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="VOL");console.log("🗑️ Deleting VOL saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="VOL"&&(console.log("🗑️ Clearing VOL saved data:",J),delete ne.saveInds[J])}),ne)),d.update(ne=>(ne.clearVolGroups+=1,ne)),console.log("✅ Bulk VOL deletion completed")}else if(ee==="BIAS"){if(console.log("🗑️ Starting bulk BIAS deletion..."),s())try{const J=s().getIndicators().filter(qe=>qe.name==="BIAS");console.log("📊 Found BIAS indicators on chart:",J.length),J.forEach(qe=>{console.log("🗑️ Removing BIAS indicator from pane:",qe.paneId),s().removeIndicator({paneId:qe.paneId,name:"BIAS"})}),console.log("✅ All BIAS indicators removed from chart")}catch(ne){console.error("❌ Error removing BIAS indicators from chart:",ne)}const Ie=Object.entries(i().saveInds).filter(([ne,J])=>J.name==="BIAS");console.log("🗑️ Deleting BIAS saved entries:",Ie.length),Ie.forEach(([ne,J])=>{console.log("🗑️ Cleaning saved entry:",ne,"pane:",J.pane_id),J.pane_id&&me(J.pane_id,ee)}),v.update(ne=>(Object.keys(ne.saveInds).forEach(J=>{ne.saveInds[J].name==="BIAS"&&(console.log("🗑️ Clearing BIAS saved data:",J),delete ne.saveInds[J])}),ne)),console.log("✅ Bulk BIAS deletion completed")}else{const Ie=Object.entries(i().saveInds).find(([ne,J])=>J.name===ee);if(Ie){const[,ne]=Ie;me(ne.pane_id,ee)}}}async function _e(ee,xe,ke,He){const Ie=s();if(!Ie)return null;let ne=xe,J={};if(ee==="VOL"){if((!(He!=null&&He.id)||He.id!=="candle_pane")&&(He={axis:{gap:{bottom:2}},...He}),!xe||xe.length===0){ne=[20];const Lt=(It=>{switch(It){case"dashed":return{style:Ee.Dashed,dashedValue:[4,4]};case"dotted":return{style:Ee.Dashed,dashedValue:[2,2]};default:return{style:Ee.Solid,dashedValue:[2,2]}}})("dotted");J={bars:[{upColor:"#26a69a",downColor:"#ef5350",noChangeColor:"#26a69a"}],lines:[{color:"#8B5CF6",size:1,style:Lt.style,dashedValue:Lt.dashedValue,smooth:!1}]}}}else ee==="EMV"&&((!(He!=null&&He.id)||He.id!=="candle_pane")&&(He={axis:{gap:{bottom:2}},...He}),(!xe||xe.length===0)&&(ne=(Rm[ee]||[]).filter(Lt=>Lt.type!=="color").map(Lt=>Lt.default)));if(!ne||ne.length===0){const ct=Rm[ee]||[];ct.length>0&&ee!=="VOL"&&(ne=ct.filter(It=>It.type!=="color").map(It=>It.default),ct.filter(It=>It.styleKey&&It.type==="color").forEach(It=>{const zt=It.styleKey,pt=It.default,Mo=zt.match(/^(\w+)\[(\d+)\]\.(\w+)$/);if(Mo){const[,Xo,en,Fo]=Mo;J[Xo]||(J[Xo]=[]),J[Xo][parseInt(en)]||(J[Xo][parseInt(en)]={}),J[Xo][parseInt(en)][Fo]=pt}}))}const qe=(He==null?void 0:He.id)??"",ft=`${qe}_${ee}`,Qe=Ie.createIndicator({name:ee,calcParams:ne,styles:Object.keys(J).length>0?J:void 0,createTooltipDataSource:({indicator:ct})=>{const Lt=[ct.visible?1:0,2,3],It=Ie.getStyles().indicator.tooltip;return{icons:Lt.map(pt=>It.features[pt])}}},ke,He);if(await K(Ie,ee,He==null?void 0:He.id),!Qe)return null;const Oe={name:ee,pane_id:qe,params:ne};return v.update(ct=>(ct.saveInds[ft]=Oe,ct)),Ou(),Dc.recordAddIndicator(ee,qe,ne||[],ft),Oe}async function me(ee,xe){if(console.log("🗑️ delInd called:",{paneId:ee,name:xe,chart:!!s()}),!s()){console.log("❌ No chart available");return}const ke=s(),He=`${ee}_${xe}`,Ie=i().saveInds[He];Ie&&Dc.recordRemoveIndicator(xe,ee,Ie.params||[],He),console.log("🔥 Attempting to remove indicator with correct API: removeIndicator(paneId, name)");try{ke.removeIndicator({paneId:ee,name:xe}),console.log("✅ removeIndicator successful")}catch(J){console.log("❌ removeIndicator failed:",J);try{console.log("🔄 Trying fallback: remove indicator by name directly"),console.log("Attempting to remove indicator:",xe,"from pane:",ee),console.log("Direct removal attempt for:",xe),[].forEach(ft=>{console.log("Removing indicator instance:",ft);try{ke.removeIndicator({paneId:ee,name:ft.name})}catch(Qe){console.log("Failed to remove indicator instance:",Qe)}}),console.log("✅ Fallback method successful")}catch(qe){console.log("❌ Fallback method also failed:",qe)}}console.log("🧹 Cleaning saved state for:",xe);const ne=JSON.parse(localStorage.getItem("indicators")||"{}");console.log("🧹 Current localStorage indicators:",ne),ne[ee]&&(ne[ee]=ne[ee].filter(J=>J.name!==xe),ne[ee].length===0&&delete ne[ee],localStorage.setItem("indicators",JSON.stringify(ne)),console.log("🧹 Updated localStorage indicators:",ne)),v.update(J=>{if(console.log("🧹 Before cleanup saveInds keys:",Object.keys(J.saveInds)),xe==="ZIGZAG"){const qe=`${ee}_ZIGZAG`;Object.keys(J.saveInds).forEach(ft=>{const Qe=J.saveInds[ft];ft.startsWith(qe)&&(Qe==null?void 0:Qe.name)==="ZIGZAG"&&(console.log("🧹 Removing ZigZag save key:",ft),delete J.saveInds[ft])})}else{const qe=`${ee}_${xe}`;console.log("🧹 Cleaning saved state key:",qe,"existed:",!!J.saveInds[qe]),delete J.saveInds[qe]}return console.log("🧹 After cleanup saveInds keys:",Object.keys(J.saveInds)),J}),Ou(),_.removeIndicator({chart:ke,name:xe,paneId:ee}).catch(J=>{console.warn("Background color preservation failed:",J)}),console.log("✅ delInd completed")}Cc(d,ee=>ee.cloudIndLoaded).subscribe(ee=>{console.log("🔄 cloudIndLoaded triggered, saveInds:",Object.keys(i().saveInds)),console.log("🚫 Automatic indicator restoration disabled to prevent deleted indicators from reappearing")});function ze(ee){const ke=ee.target.scrollTop;ke<n(U)||ke<=10?b(V,!0):ke>n(U)&&ke>50&&b(V,!1),b(U,j(ke))}const he=Cc(d,ee=>ee.initDone);let De=!1;he.subscribe(ee=>{if(console.log("initDone changed:",ee,"chart:",!!s(),"subscribed:",De),ee>0&&!De&&s()){console.log("Subscribing to OnTooltipIconClick with chart:",s()),console.log("Chart methods available:",Object.getOwnPropertyNames(s())),console.log("subscribeAction method:",typeof s().subscribeAction),De=!0;try{s().subscribeAction(Xu.OnCandleTooltipFeatureClick,xe=>{var He,Ie;console.log("🔥 OnTooltipIconClick fired!",xe);const ke=xe;if(ke.indicatorName)switch(console.log("Processing icon click:",ke.iconId,"for indicator:",ke.indicatorName),ke.iconId){case"visible":{console.log("Making indicator visible"),(He=s())==null||He.overrideIndicator({name:ke.indicatorName,paneId:ke.paneId,visible:!0});break}case"invisible":{console.log("Making indicator invisible"),(Ie=s())==null||Ie.overrideIndicator({name:ke.indicatorName,paneId:ke.paneId,visible:!1});break}case"setting":{console.log("Opening settings"),Ir(d,Uo(r).editIndName=ke.indicatorName,Uo(r)),Ir(d,Uo(r).editPaneId=ke.paneId,Uo(r)),Ir(d,Uo(r).modalIndCfg=!0,Uo(r)),l()&&l(!1);break}case"close":console.log("Deleting indicator:",ke.indicatorName,"from pane:",ke.paneId),me(ke.paneId,ke.indicatorName)}}),console.log("✅ Successfully subscribed to OnTooltipIconClick")}catch(xe){console.error("❌ Error subscribing to OnTooltipIconClick:",xe)}}});const ge=$0(),[be,$e]=ge;var Ve=gD(),Ce=_t(Ve),Je=We(()=>h1());Pu(Ce,{get title(){return n(Je)},width:700,maxWidth:"95vw",maxHeight:"min(92svh, 90vh)",get show(){return l()},set show(ee){l(ee)},get theme(){return i().theme},buttons:[],class:"ind-modal",children:(ee,xe)=>{var ke=nD(),He=g(ke),Ie=u(g(He),2);Vt(Ie),we(()=>St(Ie,"placeholder",gb()));var ne=u(Ie,2);Se(ne,()=>n(F),Oe=>{var ct=KF();ct.__click=[UF,F],O(Oe,ct)}),f(He);var J=u(He,2),qe=g(J),ft=g(qe);Ns(ft,17,()=>n(ie),dn,(Oe,ct,Lt)=>{var It=oD();const zt=We(()=>n(P).has(n(ct).name));It.__click=[ZF,zt,Q,ct];var pt=g(It),Mo=u(pt,2),Xo=g(Mo),en=g(Xo,!0);f(Xo),f(Mo);var Fo=u(Mo,2);Se(Fo,()=>n(ct).name==="NPO_MAE",cs=>{var Zt=JF();Zt.__click=[XF,Z],O(cs,Zt)});var Eo=u(Fo,2);Se(Eo,()=>n(zt),cs=>{var Zt=tD(),bs=g(Zt);bs.__click=[QF,q,ct];var es=u(bs,2);es.__click=[eD,ce,ct],f(Zt),O(cs,Zt)}),f(It),we(()=>{Pn(It,`group indicator-row relative flex items-center min-h-[56px] px-5 py-3 cursor-pointer transition-all duration-500 ease-out
                   ${(Lt<n(ie).length-1?"border-b":"")??""} 
                   ${(n(zt)?"indicator-item-selected":"indicator-item-unselected")??""} svelte-1bz53f9`),Pn(pt,`flex items-center justify-center w-2 h-2 rounded-full mr-4 transition-all duration-500
                        ${(n(zt)?"indicator-dot-selected":"indicator-dot-unselected")??""} svelte-1bz53f9`),Pn(Xo,`indicator-title text-[15px] font-medium tracking-wide leading-relaxed
                           ${(n(zt)?"indicator-text-selected":"indicator-text-unselected")??""} svelte-1bz53f9`),Ye(en,n(ct).title)}),O(Oe,It)});var Qe=u(ft,2);Se(Qe,()=>n(ie).length===0,Oe=>{var ct=sD();O(Oe,ct)}),f(qe),Ec(qe,Oe=>G=Oe,()=>G),f(J),un(2),f(ke),we(()=>Pn(He,`relative group transition-all duration-300 ease-out ${(n(V)?"opacity-100 translate-y-0":"opacity-0 -translate-y-4 pointer-events-none")??""} svelte-1bz53f9`)),go(Ie,()=>n(F),Oe=>b(F,Oe)),Fl("scroll",qe,ze),O(ee,ke)},$$slots:{default:!0}});var ye=u(Ce,2);Se(ye,()=>n(Z),ee=>{var xe=uD(),ke=g(xe);ke.__click=[iD,Z];var He=u(ke,2),Ie=g(He),ne=g(Ie),J=g(ne),qe=u(g(J),2),ft=g(qe),Qe=g(ft,!0);f(ft);var Oe=u(ft,2),ct=g(Oe,!0);f(Oe),f(qe),f(J);var Lt=u(J,2),It=g(Lt);It.__click=[rD,le];var zt=u(It,2);zt.__click=[aD,le],f(Lt);var pt=u(Lt,2);pt.__click=[lD,Z],f(ne);var Mo=u(ne,2),Xo=g(Mo);Se(Xo,()=>n(le)==="bn",en=>{var Fo=cD();un(22),O(en,Fo)},en=>{var Fo=dD();un(22),O(en,Fo)}),f(Mo),f(Ie),f(He),f(xe),we(()=>{Ye(Qe,n(le)==="bn"?"নিকটতম‑প্যাটার্ন আউটকাম + এমএই‑স্টপ":"Nearest‑Pattern Outcome + MAE‑Stop"),Ye(ct,n(le)==="bn"?"কিভাবে কাজ করে এবং কিভাবে ব্যবহার করবেন":"How it works and how to use"),Pn(It,`btn btn-xs ${(n(le)==="bn"?"btn-primary":"btn-outline")??""} svelte-1bz53f9`),Pn(zt,`btn btn-xs ${(n(le)==="en"?"btn-primary":"btn-outline")??""} svelte-1bz53f9`)}),O(ee,xe)});var Ae=u(ye,2);return Se(Ae,()=>n($),ee=>{var xe=fD(),ke=_t(xe);ke.__click=[pD,$];var He=u(ke,2),Ie=u(g(He),2),ne=g(Ie);ne.__click=[vD,$];var J=u(ne,10);we(()=>St(J,"href",be("https://dutyai.app/payment",void 0))),f(Ie),f(He),Vp(3,ke,()=>Vm,()=>({duration:200})),Vp(3,He,()=>Wm,()=>({y:20,duration:300,easing:Q_})),O(ee,xe)}),O(o,Ve),Za({createIndicator:_e,delInd:me})}hc(["click"]);function hD(o,e){o.target===o.currentTarget&&e(!1)}function _D(o,e,t,s,i){const r=o.target,a=parseInt(r.value);e(isNaN(a)?100:Math.max(0,Math.min(100,a)));const l=t(s(),e());i("opacityChange",{opacity:e(),rgba:l,color:s()}),i("colorChange",{color:s(),opacity:e(),rgba:l})}var yD=(o,e)=>e(!1),bD=(o,e,t)=>e(n(t)),xD=de("<button></button>"),wD=de('<div class="flex gap-1 flex-wrap"></div>'),kD=(o,e,t)=>e(n(t)),SD=de("<button></button>"),CD=(o,e)=>{const t=o.target;t&&e(t.value)},PD=(o,e)=>{const t=o.target;t&&e(t.value)},ID=de('<div class="fixed inset-0 z-[80] flex items-center justify-center bg-black/50 p-4"><div class="bg-base-100 rounded-lg shadow-xl p-4 w-full max-w-md max-h-[80vh] overflow-y-auto"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-base-content">Color Picker</h3> <button class="btn btn-sm btn-primary">OK</button></div> <div class="space-y-1 mb-4 max-h-60 overflow-y-auto"></div> <div class="mb-4"><div class="flex items-center justify-between mb-2"><div class="text-sm text-base-content/70">Opacity</div> <div class="text-sm text-base-content/80"> </div></div> <div class="relative"><div class="absolute inset-0 h-2 rounded opacity-30" style="background-image: repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 8px 8px;"></div> <input type="range" min="0" max="100" class="relative w-full h-2 rounded appearance-none cursor-pointer"> <div class="absolute top-1/2 w-4 h-4 bg-base-100 border-2 border-base-content rounded-full transform -translate-y-1/2 pointer-events-none shadow-sm"></div></div></div> <div class="mb-4"><div class="text-sm text-base-content/70 mb-2">Quick Colors</div> <div class="flex gap-2 flex-wrap"></div></div> <div class="mt-3 pt-3 border-t border-base-300"><div class="text-xs text-base-content/60 mb-2">Custom Color</div> <div class="flex items-center gap-2 flex-wrap"><input type="color" class="w-8 h-8 rounded border border-base-300 cursor-pointer flex-shrink-0"> <input type="text" class="input input-xs flex-1 min-w-0 text-xs" placeholder="#000000"></div></div></div></div>');function gr(o,e){Ka(e,!0);let t=Ss(e,"show",15),s=Ss(e,"selectedColor",7,"#000000");Ss(e,"position",19,()=>({x:0,y:0}));let i=Ss(e,"opacity",7,100);const r=Md();function a(w){const k=(w||"").trim();if(!k)return null;if(/^#?[0-9A-Fa-f]{6}$/.test(k)){const L=k.startsWith("#")?k.slice(1):k;return{r:parseInt(L.slice(0,2),16),g:parseInt(L.slice(2,4),16),b:parseInt(L.slice(4,6),16)}}const S=k.match(/^rgba?\(([^)]+)\)$/i);if(S){const L=S[1].split(",").map(T=>parseFloat(T.trim()));if(L.length>=3&&L.every(T=>!isNaN(T)))return{r:Math.round(L[0]),g:Math.round(L[1]),b:Math.round(L[2])}}return null}function l(w,k){const S=a(w);if(!S)return null;const L=Math.max(0,Math.min(100,k))/100;return`rgba(${S.r}, ${S.g}, ${S.b}, ${L})`}const d=[["#000000","#1C1C1C","#383838","#545454","#707070","#8C8C8C","#A8A8A8","#C4C4C4","#E0E0E0","#FFFFFF"],["#FF0000","#FF4D4F","#FF7875","#FFA39E","#FFCCC7","#FFF1F0","#FFEDED","#FFF5F5","#FFFAFA","#FFFFFF"],["#FF8C00","#FA541C","#FF7A45","#FF9C6E","#FFBB96","#FFD8BF","#FFE7BA","#FFF2E8","#FFF7E6","#FFFBE6"],["#FFD700","#FADB14","#FFEC3D","#FFF566","#FFFF8F","#FFFFB8","#FFFBE6","#FFFBF0","#FFFBF0","#FFFBF0"],["#32CD32","#52C41A","#73D13D","#95DE64","#B7EB8F","#D9F7BE","#F6FFED","#F6FFED","#F6FFED","#F6FFED"],["#00CED1","#13C2C2","#36CFC9","#5CDBD3","#87E8DE","#B5F5EC","#E6FFFB","#E6FFFB","#E6FFFB","#E6FFFB"],["#1E90FF","#1890FF","#40A9FF","#69C0FF","#91D5FF","#BAE7FF","#E6F7FF","#E6F7FF","#E6F7FF","#E6F7FF"],["#9370DB","#722ED1","#9254DE","#B37FEB","#D3ADF7","#EFDBFF","#F9F0FF","#F9F0FF","#F9F0FF","#F9F0FF"]],v=["#FF4D4F","#1890FF","#52C41A","#FA8C16","#722ED1","#000000"];function p(w){s(w);const k=l(w,i());r("colorChange",{color:w,opacity:i(),rgba:k}),t(!1)}var _=Xt(),y=_t(_);Se(y,t,w=>{var k=ID();k.__click=[hD,t];var S=g(k),L=g(S),T=u(g(L),2);T.__click=[yD,t],f(L);var P=u(L,2);Ns(P,21,()=>d,dn,(K,Q)=>{var q=wD();Ns(q,21,()=>n(Q),dn,(ce,_e)=>{var me=xD();me.__click=[bD,p,_e],we(()=>{Pn(me,`w-6 h-6 rounded border-2 transition-all hover:scale-110 ${(s()===n(_e)?"border-white shadow-lg":"border-base-300")??""}`),St(me,"style",`background-color: ${n(_e)??""}`),St(me,"title",n(_e))}),O(ce,me)}),f(q),O(K,q)}),f(P);var A=u(P,2),F=g(A),B=u(g(F),2),R=g(B);f(B),f(F);var N=u(F,2),$=u(g(N),2);Vt($),$.__input=[_D,i,l,s,r];const V=We(()=>`background: linear-gradient(to right, rgba(0,0,0,0), ${(l(s(),100)||s())??""});`);var U=u($,2);f(N),f(A);var G=u(A,2),Z=u(g(G),2);Ns(Z,21,()=>v,dn,(K,Q)=>{var q=SD();q.__click=[kD,p,Q],we(()=>{Pn(q,`w-8 h-8 rounded border-2 transition-all hover:scale-110 ${(s()===n(Q)?"border-white shadow-lg":"border-base-300")??""}`),St(q,"style",`background-color: ${n(Q)??""}`),St(q,"title",n(Q))}),O(K,q)}),f(Z),f(G);var le=u(G,2),se=u(g(le),2),ie=g(se);Vt(ie),ie.__change=[CD,p];var Y=u(ie,2);Vt(Y),Y.__change=[PD,p],f(se),f(le),f(S),f(k),we(()=>{Ye(R,`${i()??""}%`),St($,"style",n(V)),St(U,"style",`left: calc(${i()??""}% - 8px);`),Vu(ie,s()),Vu(Y,s())}),go($,i),O(w,k)}),O(o,_),Za()}hc(["click","input","change"]);const Sd={LAYOUTS:"chart.saves.v1",ACTIVE_SAVE_ID:"chart.activeSaveId",LEGACY_LAYOUTS:"chart.saves.v0"};function cn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const e=Math.random()*16|0;return(o==="x"?e:e&3|8).toString(16)})}function M_(o){return o.toUpperCase().trim()}function T_(o){return o&&typeof o.id=="string"&&typeof o.name=="string"&&typeof o.createdAt=="string"&&typeof o.updatedAt=="string"&&typeof o.timezone=="string"&&typeof o.interval=="string"&&typeof o.chartType=="string"&&typeof o.theme=="string"&&Array.isArray(o.panes)&&Array.isArray(o.indicators)&&typeof o.drawingsBySymbol=="object"}class Lx{constructor(){re(this,"initialized",!1);this.initialize()}async initialize(){if(!(this.initialized||!N_))try{await this.migrate(),this.initialized=!0}catch(e){console.error("Failed to initialize storage provider:",e)}}async migrate(){try{const e=localStorage.getItem(Sd.LEGACY_LAYOUTS);if(!e)return;console.log("🔄 Migrating chart saves from v0 to v1...");const t=JSON.parse(e);if(!Array.isArray(t))return;if(localStorage.getItem(Sd.LAYOUTS)){localStorage.removeItem(Sd.LEGACY_LAYOUTS);return}const i=t.map(r=>({id:r.id||cn(),name:r.name||"Migrated Layout",createdAt:r.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString(),timezone:r.timezone||"UTC",interval:r.interval||"1h",chartType:r.chartType||"candles",theme:r.theme||"dark",panes:r.panes||[],indicators:r.indicators||[],styles:r.styles||{},options:r.options||{},drawingsBySymbol:r.drawings?{[M_(r.symbol||"DEFAULT")]:r.drawings}:{}}));localStorage.setItem(Sd.LAYOUTS,JSON.stringify(i)),localStorage.removeItem(Sd.LEGACY_LAYOUTS),console.log(`✅ Migrated ${i.length} layouts to v1 format`)}catch(e){console.error("Migration failed:",e)}}async listSavedLayouts(){await this.initialize();try{const e=localStorage.getItem(Sd.LAYOUTS);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t.filter(T_).map(s=>({id:s.id,name:s.name,createdAt:s.createdAt,updatedAt:s.updatedAt})).sort((s,i)=>new Date(i.updatedAt).getTime()-new Date(s.updatedAt).getTime()):[]}catch(e){return console.error("Failed to list saved layouts:",e),[]}}async getSavedLayout(e){await this.initialize();try{const t=localStorage.getItem(Sd.LAYOUTS);if(!t)return null;const s=JSON.parse(t);if(!Array.isArray(s))return null;const i=s.find(r=>r.id===e);return i&&T_(i)?i:null}catch(t){return console.error("Failed to get saved layout:",t),null}}async createSavedLayout(e){await this.initialize();try{const t=new Date().toISOString(),s={...e,id:cn(),createdAt:t,updatedAt:t,drawingsBySymbol:Object.fromEntries(Object.entries(e.drawingsBySymbol).map(([a,l])=>[M_(a),l]))},i=localStorage.getItem(Sd.LAYOUTS),r=i?JSON.parse(i):[];return r.push(s),localStorage.setItem(Sd.LAYOUTS,JSON.stringify(r)),s}catch(t){throw console.error("Failed to create saved layout:",t),new Error("Failed to save layout")}}async updateSavedLayout(e,t){await this.initialize();try{const s=localStorage.getItem(Sd.LAYOUTS);if(!s)throw new Error("Layout not found");const i=JSON.parse(s),r=i.findIndex(l=>l.id===e);if(r===-1)throw new Error("Layout not found");const a={...i[r],...t,id:e,updatedAt:new Date().toISOString(),drawingsBySymbol:t.drawingsBySymbol?Object.fromEntries(Object.entries(t.drawingsBySymbol).map(([l,d])=>[M_(l),d])):i[r].drawingsBySymbol};return i[r]=a,localStorage.setItem(Sd.LAYOUTS,JSON.stringify(i)),a}catch(s){throw console.error("Failed to update saved layout:",s),new Error("Failed to update layout")}}async deleteSavedLayout(e){await this.initialize();try{const t=localStorage.getItem(Sd.LAYOUTS);if(!t)return;const i=JSON.parse(t).filter(a=>a.id!==e);localStorage.setItem(Sd.LAYOUTS,JSON.stringify(i)),await this.getActiveSaveId()===e&&await this.setActiveSaveId(null)}catch(t){throw console.error("Failed to delete saved layout:",t),new Error("Failed to delete layout")}}async setActiveSaveId(e){try{e===null?localStorage.removeItem(Sd.ACTIVE_SAVE_ID):localStorage.setItem(Sd.ACTIVE_SAVE_ID,e)}catch(t){console.error("Failed to set active save ID:",t)}}async getActiveSaveId(){try{return localStorage.getItem(Sd.ACTIVE_SAVE_ID)}catch(e){return console.error("Failed to get active save ID:",e),null}}async layoutNameExists(e,t){return(await this.listSavedLayouts()).some(i=>i.name===e&&i.id!==t)}async cleanup(){try{const e=localStorage.getItem(Sd.LAYOUTS);if(!e)return;const t=JSON.parse(e),s=t.filter(T_);s.length!==t.length&&(localStorage.setItem(Sd.LAYOUTS,JSON.stringify(s)),console.log(`🧹 Cleaned up ${t.length-s.length} invalid layouts`))}catch(e){console.error("Failed to cleanup storage:",e)}}}const MD=new Lx;function wu(o,e,t,s,i,r,a){if(!n(e)||!t()||!i().editPaneId)return;const l=[a.zoneLookbackBars,a.minZoneBars,a.maxZoneBars,a.atrPeriod,a.volumeMAPeriod,a.minVolumeFactor,a.maxZoneWidthPct,a.priorTrendLookback,a.minOBVTrendStrength,a.minZoneScore,a.mergeNearbyZones?1:0,a.maxZonesDisplayed,a.showLabels?1:0];try{t().overrideIndicator({name:"SMART_MONEY",calcParams:l,paneId:i().editPaneId})}catch(d){console.error("SMART_MONEY realtime update failed:",d)}}function TD(o,e,t){const s={id:cn(),deviation:5,depth:5,styles:{color:"#2962FF",thickness:2,lineStyle:"solid"}};b(e,j([...n(e),s])),t()}function Ny(o,e,t,s){const i=e();i&&i.setStyles({median:{size:n(t),style:n(s)}})}function Ry(o,e,t,s){const i=e();i&&i.setStyles({slLong:{size:n(t),style:n(s)}})}function Oy(o,e,t,s){const i=e();i&&i.setStyles({slShort:{size:n(t),style:n(s)}})}function AD(o,e,t){const s=e();s&&s.setShowOutcomeBand(!!n(t))}function LD(o,e,t){const s=e();s&&s.setShowStopLines(!!n(t))}function FD(o,e,t){const s=e();s&&s.updateSettings({showTable:!!n(t)})}function DD(o,e,t){if(n(e))try{if(n(t).length>=10){console.warn("⚠️ Maximum number of EMV groups (10) reached");return}const i=n(t).length+1,r={id:cn(),name:`EMV #${i}`,period:14,period2:9,color:"#2563eb",thickness:2,lineStyle:"solid"};n(t).push(r),console.log("✅ Added new EMV group:",r.name)}catch(s){console.error("❌ Error adding EMV group:",s)}}function ED(o,e,t,s){if(n(e))try{if(n(t).length>=10){console.warn("⚠️ Maximum number of MTM groups (10) reached");return}const r=n(t).length+1,a=["#2563eb","#8B5CF6","#F59E0B","#10B981","#EF4444","#EC4899","#06B6D4","#F97316"],l=n(t).length%a.length,d={id:cn(),name:`MTM #${r}`,period:14,color:a[l],thickness:2,lineStyle:"solid"};n(t).push(d),console.log("✅ Added new MTM group:",d.name),s()}catch(i){console.error("❌ Error adding MTM group:",i)}}function $D(o,e,t,s){if(!n(e))return;const i=n(t).length+1;n(t).push({id:cn(),name:`BIAS${i}`,period:6,color:"#2196F3",thickness:1,lineStyle:"solid"}),s()}function jD(o,e,t,s){if(!n(e))return;const i=n(t).length+1,r=i===1?"CCI":`CCI${i}`;n(t).push({id:cn(),name:r,period:14,color:"#FF9800",thickness:1,lineStyle:"solid"}),console.log("➕ Added new CCI group:",r),s()}function zD(o,e,t,s){if(!n(e))return;const i=n(t)[n(t).length-1]||n(t)[0],r={id:cn(),start:(i==null?void 0:i.start)??.02,increment:(i==null?void 0:i.increment)??.02,maxValue:(i==null?void 0:i.maxValue)??.2,color:"#2563eb",dotSize:1};b(t,j([...n(t),r])),s()}function BD(o,e,t,s){if(!n(e))return;const i=["#00FF00","#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8"],r=n(t).map(p=>p.styles.uptrend.color),a=i.filter(p=>!r.includes(p)),l=a.length>0?a[0]:i[n(t).length%i.length],d=n(t)[n(t).length-1]||n(t)[0],v={id:cn(),period:((d==null?void 0:d.period)||10)+2,multiplier:(d==null?void 0:d.multiplier)||3,showLabels:!0,styles:{uptrend:{color:l,thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}};b(t,j([...n(t),v])),console.log("✅ Added new Smart Trend group:",v),s()}function ND(o,e,t,s){if(!n(e))return;const i=n(t).length+1;n(t).push({id:cn(),name:`DMI${i}`,diPeriod:14,adxPeriod:6,styles:{diPlus:{color:"#22c55e",thickness:1,lineStyle:"solid"},diMinus:{color:"#ef4444",thickness:1,lineStyle:"solid"},adx:{color:"#3b82f6",thickness:1,lineStyle:"solid"}}}),console.log("➕ Added new DMI group"),s()}function RD(o,e,t,s){if(!n(e))return;const i=n(t).length+1;n(t).push({id:cn(),name:`CR${i}`,crPeriod:26,crMa1Period:10,crMa2Period:20,crMa3Period:40,crMa4Period:60,styles:{cr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},ma1:{color:"#2196F3",thickness:1,lineStyle:"solid"},ma2:{color:"#4CAF50",thickness:1,lineStyle:"solid"},ma3:{color:"#FF9800",thickness:1,lineStyle:"solid"},ma4:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}}),console.log("➕ Added new CR group"),s()}function OD(o,e,t,s){if(!n(e))return;const i=["#26A69A","#EF5350","#8B5CF6","#F59E0B","#10B981","#F97316","#06B6D4","#84CC16"],r=n(t).length%i.length;n(t).push({id:cn(),shortPeriod:5,longPeriod:34,styles:{increasing:{color:i[r]},decreasing:{color:i[(r+1)%i.length]}}}),s()}function VD(o,e,t){b(e,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(t,!0)}function xm(o,e,t,s,i,r,a,l,d,v,p,_,y,w,k,S,L){if(n(e))return;if(n(t)){s();return}if(n(i)){r();return}if(n(a)){l();return}if(n(d)){v();return}if(p.length>=10)return;const T=p[p.length-1],P={...T,title:`${T.title.replace(/\d+$/,"")}${p.length+1}`};p.push(P),_.push(P.default||0),y.push({color:"#2563eb",thickness:1,lineStyle:"solid"}),n(w)?k():n(S)&&L()}function WD(o,e,t,s,i,r,a,l,d,v,p,_,y,w,k){if(!n(e))return;const S=t().editPaneId||"candle_pane";n(i).push({id:cn(),paneId:S,period:n(r),stdDev:n(a),styles:{fillColor:n(l),fillOpacity:n(d),upperColor:n(v),middleColor:n(p),lowerColor:n(_),thickness:n(y),lineStyle:n(w)}}),k()}var qD=(o,e,t)=>e(n(t).id),HD=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove MACD"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),GD=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Fast</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Slow</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Signal</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">MACD Line:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">Signal Line:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">Positive Bar:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 sm:w-24 font-medium svelte-fy2ox8">Negative Bar:</span> <button class="btn btn-xs btn-circle svelte-fy2ox8"></button></div></div></div>'),YD=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More MACD"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add MACD</span></button></div></div>'),UD=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Zone Lookback Bars</label> <input type="number" min="10" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Prior Trend Lookback</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Zone Bars</label> <input type="number" min="3" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Zone Bars</label> <input type="number" min="5" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ATR Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Zone Width %</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.005" max="0.10" step="0.005" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Factor</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.5" max="2.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min OBV Trend</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="0.6" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Zone Score</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.3" max="0.9" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center justify-between bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="flex flex-col svelte-fy2ox8"><span class="text-xs font-medium svelte-fy2ox8">Merge Nearby Zones</span> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">Overlap/adjacent similar zones merge</span></div> <input type="checkbox" class="toggle toggle-sm svelte-fy2ox8"></div> <div class="flex items-center justify-between bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="flex flex-col svelte-fy2ox8"><span class="text-xs font-medium svelte-fy2ox8">Show Labels</span> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">Type + score label</span></div> <input type="checkbox" class="toggle toggle-sm svelte-fy2ox8"></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Zones Displayed</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm w-28 svelte-fy2ox8"></div></div>'),KD=(o,e,t)=>{e[9]=o.currentTarget.checked?1:0,t()},ZD=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Resistance Lookback</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Support Lookback</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Confirmation Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max Trap Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Spike (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="1.0" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Breakout Factor (%)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="number" step="0.0001" min="0.0000" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm w-28 svelte-fy2ox8"> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">e.g. 0.0005 = 0.05%</span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Wick Ratio</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Trap Score</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div></div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center justify-between bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="flex flex-col svelte-fy2ox8"><span class="text-xs font-medium svelte-fy2ox8">Stable Signal</span> <span class="text-[10px] text-base-content/60 svelte-fy2ox8">Show blue “Stable” dots</span></div> <input type="checkbox" class="toggle toggle-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Normal Quiet Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm w-28 svelte-fy2ox8"></div></div></div>'),XD=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Compression Inputs</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB StdDev</label> <input type="number" step="0.1" min="0.1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ATR Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Normalize Lookback</label> <input type="number" min="10" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Pressure SMA</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Alert & Breakout Behavior</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Pressure for Alert</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Confirmation Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Range Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Body % of Range</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Breakout Lookback</label> <input type="number" min="5" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Bars Between Signals</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div></div>'),JD=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Detection Parameters</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">BB StdDev</label> <input type="number" step="0.1" min="0.1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ATR Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Volume MA Period</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Normalize Lookback</label> <input type="number" min="10" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Pressure SMA</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 mb-2 svelte-fy2ox8">Alert & Breakout Filters</div> <div class="grid grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Pressure for Alert</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Confirmation Bars</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Volume Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Range Expansion (x)</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.8" max="3.0" step="0.05" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Body % of Range</label> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.0" max="1.0" step="0.01" class="range range-xs flex-1 svelte-fy2ox8"> <span class="text-xs w-10 text-right svelte-fy2ox8"> </span></div></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Breakout Lookback</label> <input type="number" min="5" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Min Bars Between Signals</label> <input type="number" min="1" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8"></div></div></div></div>'),QD=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove RSI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),eE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Period</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="1" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Overbought</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="50" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Middle</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Oversold</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="50"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/70 svelte-fy2ox8">RSI Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change RSI Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option><option class="svelte-fy2ox8">4</option><option class="svelte-fy2ox8">5</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 border-t border-base-200 pt-2 svelte-fy2ox8"><span class="text-xs text-base-content/70 font-medium svelte-fy2ox8">Level Lines</span> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Overbought</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Overbought Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Oversold</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Oversold Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Middle Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Middle Line Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div> <div class="flex items-center justify-between mt-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Fill Opacity</span> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="range" min="0.05" max="0.5" step="0.05" class="range range-xs w-20 svelte-fy2ox8"> <span class="text-xs text-base-content/60 w-8 svelte-fy2ox8"> </span></div></div></div></div>'),tE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 sm:gap-2 svelte-fy2ox8" title="Add More RSI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add RSI</span></button></div></div>'),oE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Stochastic"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),sE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">%K Period</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="1" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">%D Period</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="1" max="50"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Overbought</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="50" max="100"></div> <div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Oversold</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="50"></div></div> <div class="grid grid-cols-1 gap-2 sm:gap-3 svelte-fy2ox8"><div class="space-y-1 svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Mid Level</label> <input type="number" class="input input-xs w-full bg-base-100 border-base-300 text-xs svelte-fy2ox8" min="0" max="100"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/70 svelte-fy2ox8">%K Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change %K Line Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option><option class="svelte-fy2ox8">4</option><option class="svelte-fy2ox8">5</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/70 svelte-fy2ox8">%D Line</span> <div class="flex items-center gap-2 svelte-fy2ox8"><button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change %D Line Color"></button> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-12 svelte-fy2ox8"><option class="svelte-fy2ox8">1</option><option class="svelte-fy2ox8">2</option><option class="svelte-fy2ox8">3</option><option class="svelte-fy2ox8">4</option><option class="svelte-fy2ox8">5</option></select> <select class="select select-xs bg-base-100 border-base-300 text-xs min-h-0 h-6 w-16 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 border-t border-base-200 pt-2 svelte-fy2ox8"><span class="text-xs text-base-content/70 font-medium svelte-fy2ox8">Level Colors</span> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Overbought</span> <button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Overbought Color"></button></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Oversold</span> <button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Oversold Color"></button></div> <div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Mid Line</span> <button class="w-6 h-6 rounded border border-base-300 flex-shrink-0 svelte-fy2ox8" title="Change Mid Line Color"></button></div></div></div>'),nE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 sm:gap-2 svelte-fy2ox8" title="Add More Stochastic"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add Stochastic</span></button></div></div>'),iE=(o,e,t)=>e(n(t).id),rE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove DMI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),aE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">DI Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">ADX Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">DI+:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">DI-:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">ADX:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),lE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More DMI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add DMI</span></button></div></div>'),cE=(o,e,t)=>e(n(t).id),dE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Williams %R"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),uE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Overbought</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="-50" max="0"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Middle Level</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="-70" max="-30"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Oversold</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="-100" max="-50"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">WR Line:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 border-b border-base-200 pb-1 svelte-fy2ox8">Level Lines</div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 font-medium svelte-fy2ox8">Overbought:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 font-medium svelte-fy2ox8">Middle:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-20 font-medium svelte-fy2ox8">Oversold:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),pE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More Williams %R"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add Williams %R</span></button></div></div>'),vE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove VR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),fE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Short Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 sm:col-span-1 col-span-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Long Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/70 svelte-fy2ox8">VR Main Line</div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/70 svelte-fy2ox8">VR Short Line</div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/70 svelte-fy2ox8">VR Long Line</div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),gE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More VR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add More VR</span></button></div></div>'),mE=(o,e,t)=>e(n(t).id),hE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove BBI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),_E=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 1</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 2</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 3</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 4</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),yE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More BBI"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add BBI</span></button></div></div>'),bE=(o,e,t)=>e(n(t).id),xE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove EMV"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),wE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 1</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period 2</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),kE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More EMV"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add EMV</span></button></div></div>'),SE=(o,e,t)=>e(n(t).id),CE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove MTM"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),PE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="grid grid-cols-1 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),IE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More MTM"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add MTM</span></button></div></div>'),ME=(o,e,t)=>e(n(t).id),TE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove this AO"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Short Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Long Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="border-t border-base-300 pt-2 mt-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 mb-2 block svelte-fy2ox8">Histogram Colors</label> <div class="grid grid-cols-1 gap-2 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Increasing Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Decreasing Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div></div></div>'),AE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More Awesome Oscillator"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add More AO</span></button></div></div>'),LE=(o,e,t)=>e(n(t).id),FE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove CR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),DE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">CR Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA1 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA2 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA3 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">MA4 Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">CR:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA1:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA2:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA3:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">MA4:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),EE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-xs sm:btn-sm btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More CR"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add CR</span></button></div></div>'),$E=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Deviation %</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="50" step="0.1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Depth</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="50"></div></div> <div class="border-t border-base-300 pt-2 mt-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 mb-2 block svelte-fy2ox8">ZigZag Line Style</label> <div class="space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Line Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Line Thickness</span> <select class="select select-bordered select-xs w-20 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Line Style</span> <select class="select select-bordered select-xs w-24 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),jE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more ZigZag"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More ZigZag</button></div></div>'),zE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Delete this PVT instance">✕</button>'),BE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-20 sm:w-24 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),NE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-sm btn-primary svelte-fy2ox8">➕ Add More PVT</button></div></div>'),RE=(o,e,t)=>e(n(t).id),OE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove SAR Group"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),VE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Start</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.001" max="0.1" step="0.001"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Increment</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.001" max="0.1" step="0.001"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Max value</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="1.0" step="0.01"></div></div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Dot size:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div></div></div>'),WE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-sm btn-primary svelte-fy2ox8">➕ Add More SAR</button></div></div>'),qE=(o,e,t)=>e(n(t).id),HE=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Smart Trend Group"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),GE=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="100" step="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Multiplier</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="10" step="0.1"></div></div> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="checkbox" class="checkbox checkbox-sm svelte-fy2ox8"> <label class="text-xs text-base-content/60 svelte-fy2ox8">Show Labels</label></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 svelte-fy2ox8">Uptrend Line</div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-20 sm:w-24 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="text-xs font-medium text-base-content/80 svelte-fy2ox8">Downtrend Line</div> <div class="flex flex-wrap sm:flex-nowrap items-center gap-2 sm:gap-4 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-20 sm:w-24 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div></div>'),YE=de('<div class="space-y-2 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary svelte-fy2ox8" title="Add more Smart Trend"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add Smart Trend</button></div></div>'),UE=(o,e)=>e(),KE=de('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete EMA parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),ZE=de('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),XE=(o,e)=>e(),JE=(o,e)=>e(),QE=de('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div>'),e$=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-20 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <!></div>'),t$=de('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more EMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add EMA</button></div>'),o$=de('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),s$=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Delete this SMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),n$=de('<div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="flex flex-col gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/70 font-medium svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-sm svelte-fy2ox8" min="1" max="500"></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Color</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Line Thickness</label> <select class="select select-bordered select-xs w-20 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Line Style</label> <select class="select select-bordered select-xs w-24 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),i$=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center mt-3 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more SMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add SMA</button></div></div>'),r$=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Volume"><span class="text-xs svelte-fy2ox8">×</span></button>'),a$=de('<div class="w-6 svelte-fy2ox8"></div>'),l$=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs svelte-fy2ox8" min="1" max="200"></div></div> <div class="space-y-2 svelte-fy2ox8"><h4 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Volume Histogram</h4> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Up Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Down Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div> <div class="space-y-2 svelte-fy2ox8"><h4 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">EMA Line</h4> <div class="flex items-center gap-2 svelte-fy2ox8"><input type="checkbox" class="checkbox checkbox-sm svelte-fy2ox8"> <label class="text-xs text-base-content/60 svelte-fy2ox8">Show EMA with Volume</label></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),c$=de('<div class="space-y-3 mt-3 svelte-fy2ox8"></div>'),d$=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove TRIX"><span class="text-xs svelte-fy2ox8">×</span></button>'),u$=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">TRIX:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">Signal:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">TRIX Line:</span> <div class="w-3 h-2 rounded svelte-fy2ox8"></div></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <input type="color" class="w-8 h-6 rounded border border-base-300 cursor-pointer svelte-fy2ox8"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-12 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-xs text-base-content/60 svelte-fy2ox8">Signal Line:</span> <div class="w-3 h-2 rounded svelte-fy2ox8"></div></div> <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <input type="color" class="w-8 h-6 rounded border border-base-300 cursor-pointer svelte-fy2ox8"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs w-12 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),p$=(o,e)=>e(),v$=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add More TRIX"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More TRIX</button></div></div>'),f$=(o,e,t)=>e(n(t).id),g$=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove BIAS"><span class="text-xs svelte-fy2ox8">×</span></button>'),m$=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">Period:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-wrap items-center gap-2 sm:gap-3 text-xs svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Color:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Width:</span> <select class="select select-bordered select-xs w-12 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option></select></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-14 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div></div>'),h$=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More BIAS"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add BIAS</span></button></div></div>'),_$=(o,e,t)=>e(n(t).id),y$=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove CCI"><span class="text-xs svelte-fy2ox8">×</span></button>'),b$=de('<div class="bg-base-50 border border-base-200 rounded-md p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-xs sm:text-sm font-medium text-base-content/80 svelte-fy2ox8"></span> <!></div> <div class="flex items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="text-xs sm:text-sm text-base-content/60 w-12 sm:w-16 flex-shrink-0 svelte-fy2ox8">Period:</span> <input type="number" class="input input-bordered input-xs sm:input-sm flex-1 max-w-16 sm:max-w-20 text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-wrap items-center gap-2 sm:gap-3 text-xs svelte-fy2ox8"><div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Color:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Width:</span> <select class="select select-bordered select-xs w-12 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option></select></div> <div class="flex items-center gap-1 svelte-fy2ox8"><span class="text-base-content/60 text-xs svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-14 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dash</option><option class="svelte-fy2ox8">Dot</option></select></div></div></div>'),x$=de('<div class="space-y-3 mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-2 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add More CCI"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add CCI</span></button></div></div>'),w$=de('<button class="btn btn-xs btn-circle btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove Ichimoku"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),k$=de('<div class="grid grid-cols-1 sm:grid-cols-[1.4fr_0.8fr_0.8fr_0.8fr_0.9fr] gap-3 items-center px-1 py-2 border-b border-base-200 last:border-b-0 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><div class="w-4 h-4 rounded-full border border-base-300 svelte-fy2ox8"></div> <span class="text-sm font-medium text-base-content svelte-fy2ox8"> </span></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Period</span> <input type="number" class="input input-bordered input-sm w-24 text-center svelte-fy2ox8" min="1" max="200"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Color</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-5 h-5 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Thickness</span> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><span class="text-xs text-base-content/60 sm:hidden svelte-fy2ox8">Style</span> <select class="select select-bordered select-xs flex-1 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div>'),S$=de('<div class="space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><span class="text-sm sm:text-base font-medium text-base-content/80 svelte-fy2ox8"> </span> <!></div> <div class="hidden sm:grid grid-cols-[1.4fr_0.8fr_0.8fr_0.8fr_0.9fr] gap-3 text-xs text-base-content/60 px-1 svelte-fy2ox8"><div class="svelte-fy2ox8">Component</div> <div class="svelte-fy2ox8">Period</div> <div class="svelte-fy2ox8">Color</div> <div class="svelte-fy2ox8">Thickness</div> <div class="svelte-fy2ox8">Style</div></div> <!></div>'),C$=de('<div class="mt-3 sm:mt-5 svelte-fy2ox8"><div class="border border-base-300 rounded-lg p-4 bg-base-50/50 svelte-fy2ox8"><div class="flex items-center gap-3 mb-6 pb-4 border-b border-base-200 svelte-fy2ox8"><div class="w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center svelte-fy2ox8"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" class="svelte-fy2ox8"></path></svg></div> <div class="svelte-fy2ox8"><h3 class="text-lg font-semibold text-base-content svelte-fy2ox8">Ichimoku Kinko Hyo</h3> <p class="text-sm text-base-content/60 svelte-fy2ox8">Complete cloud indicator with all components</p></div></div> <div class="space-y-6 svelte-fy2ox8"></div> <div class="flex justify-center pt-4 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 svelte-fy2ox8" title="Add Ichimoku"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> <span class="text-xs sm:text-sm svelte-fy2ox8">Add Ichimoku</span></button></div> <div class="mt-6 pt-4 border-t border-base-200 svelte-fy2ox8"><div class="text-xs text-base-content/60 space-y-1 svelte-fy2ox8"><p class="svelte-fy2ox8"><strong class="svelte-fy2ox8">Components:</strong> Tenkan Sen (Conversion), Kijun Sen (Base), Senkou Span A & B (Cloud)</p> <p class="svelte-fy2ox8"><strong class="svelte-fy2ox8">Usage:</strong> Trend direction, support/resistance levels, and momentum analysis</p></div></div></div></div>'),P$=de('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete SMA parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),I$=de('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),M$=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-20 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),T$=de('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more SMA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add SMA</button></div>'),A$=de('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),L$=(o,e)=>e(),F$=de('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete MA parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),D$=de('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),E$=(o,e)=>e(),$$=(o,e)=>e(),j$=de('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div>'),z$=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-20 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <!></div>'),B$=de('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8" title="Add more MA"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> Add MA</button></div>'),N$=de('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),R$=(o,e,t)=>e(n(t).id),O$=de('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove ROC"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),V$=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Period</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),W$=de('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more ROC"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More ROC</button></div></div>'),q$=(o,e,t)=>e(n(t).id),H$=de('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove PSY"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),G$=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Param 1 (PSY Period)</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">PSY Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Param 2 (MAPSY Period)</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">MAPSY Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex items-center gap-2 pt-2 svelte-fy2ox8"><input type="checkbox" class="checkbox checkbox-primary checkbox-sm svelte-fy2ox8"> <label class="text-sm text-base-content/80 cursor-pointer svelte-fy2ox8">Show MAPSY</label></div></div></div>'),Y$=de('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more PSY"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More PSY</button></div></div>'),U$=(o,e,t)=>e(n(t).id),K$=de('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove OBV"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),Z$=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="flex flex-col gap-2 svelte-fy2ox8" style="display: none;"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">Param 1 (OBV Period)</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">OBV Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex flex-col gap-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">MAOBV Period</span> <input type="number" class="input input-bordered input-xs text-xs w-full max-w-24 svelte-fy2ox8"> <span class="text-xs text-base-content/50 svelte-fy2ox8">Moving average period for OBV smoothing</span></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">MAOBV Line Style</span> <div class="grid grid-cols-1 md:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-3 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-[45px] svelte-fy2ox8">Color:</label> <button class="btn btn-xs btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[60px] svelte-fy2ox8">Thickness:</span> <select class="select select-bordered select-xs w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-3 svelte-fy2ox8"><span class="text-base-content/60 text-xs min-w-[35px] svelte-fy2ox8">Style:</span> <select class="select select-bordered select-xs w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div></div>'),X$=de('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more OBV"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More OBV</button></div></div>'),J$=(o,e,t)=>e(n(t).id),Q$=de('<button class="btn btn-xs btn-ghost text-error hover:bg-error/10 svelte-fy2ox8" title="Remove KDJ"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),ej=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8"></h4> <!></div> <div class="space-y-3 svelte-fy2ox8"><div class="grid grid-cols-2 gap-2 sm:gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">K Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">D Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1"></div></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">K Line Style</span> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">K:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">D Line Style</span> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">D:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div> <div class="space-y-2 svelte-fy2ox8"><span class="text-base-content/70 text-xs font-medium svelte-fy2ox8">J Line Style</span> <div class="flex items-center gap-2 text-xs text-base-content/70 svelte-fy2ox8"><span class="w-12 font-medium svelte-fy2ox8">J:</span> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button> <select class="select select-bordered select-xs w-14 sm:w-16 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select> <select class="select select-bordered select-xs w-16 sm:w-20 text-xs svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),tj=de('<div class="space-y-2 sm:space-y-3 mt-2 sm:mt-3 svelte-fy2ox8"><!> <div class="flex justify-center pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more KDJ"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More KDJ</button></div></div>'),oj=(o,e)=>e("band"),sj=(o,e)=>e("slLong"),nj=(o,e)=>e("slShort"),ij=(o,e)=>e("median"),rj=de('<div class="space-y-4 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Outcome Band</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Show Band:</label> <input type="checkbox" class="toggle toggle-xs svelte-fy2ox8"></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Fill Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Opacity</label> <span class="text-xs font-medium text-primary svelte-fy2ox8"> </span></div> <input type="range" class="range range-primary range-xs svelte-fy2ox8" min="0" max="100" step="1"></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Stop Lines</h4> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Show Stops:</label> <input type="checkbox" class="toggle toggle-xs svelte-fy2ox8"></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Long SL Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Short SL Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Long Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Long Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Short Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Short Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Median Path</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option></select></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">EV Table</h4> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Show Table:</label> <input type="checkbox" class="toggle toggle-xs svelte-fy2ox8"></div></div></div>'),aj=(o,e)=>e("fill",0),lj=(o,e)=>e("upper",0),cj=(o,e)=>e("middle",0),dj=(o,e)=>e("lower",0),uj=(o,e)=>e(0),pj=de('<button class="btn btn-xs btn-outline btn-error gap-1 text-xs svelte-fy2ox8" title="Remove BOLL 1"><svg class="w-3 h-3 svelte-fy2ox8" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg> Remove BOLL 1</button>'),vj=(o,e,t)=>e(n(t)),fj=(o,e,t)=>e("fill",n(t)),gj=(o,e,t)=>e("upper",n(t)),mj=(o,e,t)=>e("middle",n(t)),hj=(o,e,t)=>e("lower",n(t)),_j=de('<div class="bg-base-50 border border-primary/20 rounded-md p-3 space-y-3 mt-3 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><h4 class="text-sm font-semibold text-primary svelte-fy2ox8"> </h4> <button class="btn btn-xs btn-ghost text-error svelte-fy2ox8"><svg class="w-3.5 h-3.5 svelte-fy2ox8" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="200"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Standard Deviation</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="10" step="0.1"></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h5 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Fill Area</h5> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Fill Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Opacity</label> <span class="text-xs font-medium text-primary svelte-fy2ox8"> </span></div> <input type="range" class="range range-primary range-xs svelte-fy2ox8" min="0" max="100" step="1"></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h5 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Line Colors</h5> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Upper Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Middle Line (SMA)</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Lower Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h5 class="text-xs font-medium text-base-content/70 svelte-fy2ox8">Line Style</h5> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div></div>'),yj=de('<div class="space-y-4 mt-3 svelte-fy2ox8"><div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Parameters</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Period</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="1" max="200"></div> <div class="flex flex-col gap-1 svelte-fy2ox8"><label class="text-xs text-base-content/60 svelte-fy2ox8">Standard Deviation</label> <input type="number" class="input input-bordered input-xs sm:input-sm text-xs sm:text-sm svelte-fy2ox8" min="0.1" max="10" step="0.1"></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Fill Area Settings</h4> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Fill Color</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between svelte-fy2ox8"><label class="text-xs text-base-content/70 svelte-fy2ox8">Opacity</label> <span class="text-xs font-medium text-primary svelte-fy2ox8"> </span></div> <input type="range" class="range range-primary range-xs svelte-fy2ox8" min="0" max="100" step="1"> <div class="flex justify-between text-xs text-base-content/50 svelte-fy2ox8"><span class="svelte-fy2ox8">0%</span> <span class="svelte-fy2ox8">50%</span> <span class="svelte-fy2ox8">100%</span></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Line Colors</h4> <div class="space-y-2 svelte-fy2ox8"><div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Upper Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Middle Line (SMA)</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div> <div class="flex items-center justify-between gap-2 px-2 py-1.5 rounded bg-base-100 border border-base-200 svelte-fy2ox8"><span class="text-xs text-base-content/70 flex-1 svelte-fy2ox8">Lower Band</span> <div class="flex items-center gap-2 svelte-fy2ox8"><div class="w-6 h-6 rounded border-2 border-base-300 svelte-fy2ox8"></div> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div></div></div></div> <div class="bg-base-50 border border-base-200 rounded-md p-3 space-y-3 svelte-fy2ox8"><h4 class="text-sm font-medium text-base-content/80 svelte-fy2ox8">Line Style</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div> <div class="flex justify-center gap-2 pt-1 svelte-fy2ox8"><button class="btn btn-xs btn-outline btn-primary gap-1 text-xs svelte-fy2ox8" title="Add more BOLL"><svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg> + Add More BOLL</button> <!></div> <!></div>'),bj=de('<div class="flex justify-center items-center min-h-[120px] svelte-fy2ox8"><div class="text-base-content/70 svelte-fy2ox8"> </div></div>'),xj=de('<button class="btn btn-sm btn-circle btn-ghost text-error hover:bg-error/10 flex-shrink-0 svelte-fy2ox8" title="Delete parameter"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M6 18L18 6M6 6l12 12" class="svelte-fy2ox8"></path></svg></button>'),wj=de('<div class="w-8 flex-shrink-0 svelte-fy2ox8"></div>'),kj=de('<div class="border border-base-300 rounded-lg p-2 sm:p-3 space-y-2 sm:space-y-3 svelte-fy2ox8"><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 svelte-fy2ox8"><span class="w-full sm:w-16 text-base-content/70 text-sm font-medium min-w-fit svelte-fy2ox8"> </span> <div class="flex items-center gap-2 sm:gap-3 flex-1 min-w-0 svelte-fy2ox8"><input type="number" class="flex-1 input input-bordered input-sm min-w-0 svelte-fy2ox8"> <!></div></div> <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 svelte-fy2ox8"><div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Color:</label> <button class="btn btn-sm btn-outline svelte-fy2ox8"><div class="w-4 h-4 rounded border border-base-300 svelte-fy2ox8"></div></button></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Thickness:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">1px</option><option class="svelte-fy2ox8">2px</option><option class="svelte-fy2ox8">3px</option><option class="svelte-fy2ox8">4px</option><option class="svelte-fy2ox8">5px</option></select></div> <div class="flex items-center gap-2 svelte-fy2ox8"><label class="text-xs text-base-content/60 min-w-fit svelte-fy2ox8">Style:</label> <select class="select select-bordered select-xs flex-1 min-w-0 svelte-fy2ox8"><option class="svelte-fy2ox8">Solid</option><option class="svelte-fy2ox8">Dashed</option><option class="svelte-fy2ox8">Dotted</option></select></div></div></div>'),Sj=de('<div class="flex justify-center mt-4 svelte-fy2ox8"><button class="btn btn-sm btn-outline btn-primary svelte-fy2ox8"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 svelte-fy2ox8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 4v16m8-8H4" class="svelte-fy2ox8"></path></svg></button></div>'),Cj=de('<div class="space-y-3 sm:space-y-4 mt-3 sm:mt-5 svelte-fy2ox8"><!> <!></div>'),Pj=de('<div class="ai-branding-container svelte-fy2ox8"><div class="ai-branding-badge svelte-fy2ox8"><svg class="ai-branding-icon svelte-fy2ox8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-fy2ox8"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-fy2ox8"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-fy2ox8"></line></svg> <div class="ai-branding-text svelte-fy2ox8"><div class="ai-branding-main svelte-fy2ox8">Duty AI Algorithm Included</div> <div class="ai-branding-sub svelte-fy2ox8">Powered by Duty AI</div></div> <div class="ai-branding-glow svelte-fy2ox8"></div></div></div>'),Ij=de('<div class="responsive-modal-content svelte-fy2ox8"><!> <!></div>'),Mj=de("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function Tj(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(v,"$chart",t),i=()=>ir(l,"$ctx",t),r=()=>ir(d,"$save",t);let a=Ss(e,"show",15);const l=Fa("ctx"),d=Fa("save"),v=Fa("chart");let p=j([]),_=j([]),y=j([]);function w(h){const x=(h||"").trim();if(!x)return null;if(/^#?[0-9A-Fa-f]{6}$/.test(x)){const I=x.startsWith("#")?x.slice(1):x;return{r:parseInt(I.slice(0,2),16),g:parseInt(I.slice(2,4),16),b:parseInt(I.slice(4,6),16)}}const M=x.match(/^rgba?\(([^)]+)\)$/i);if(M){const I=M[1].split(",").map(D=>parseFloat(D.trim()));if(I.length>=3&&I.every(D=>!isNaN(D)))return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2])}}return null}function k(h,x){const M=w(h);if(!M)return h;const I=Math.max(0,Math.min(100,x))/100;return`rgba(${M.r}, ${M.g}, ${M.b}, ${I})`}let S=oe("#2196F3"),L=oe(5),T=oe("#f23645"),P=oe("#2962ff"),A=oe("#089981"),F=oe(1),B=oe("solid"),R=oe(20),N=oe(2),$=oe(!1),V=oe(j({x:0,y:0})),U=oe(0),G=oe("macdLine"),Z=oe(!1),le=oe(j({x:0,y:0})),se=oe(0),ie=oe(!1),Y=oe(j({x:0,y:0})),K=oe(0),Q=oe("diPlus"),q=oe(!1),ce=oe(j({x:0,y:0})),_e=oe(!1),me=oe(j({x:0,y:0})),Pe=oe(!1),ze=oe(j({x:0,y:0})),he=oe(0),De=oe(!1),ge=oe(j({x:0,y:0})),be=oe(0),$e=oe(!1),Ve=oe(j({x:0,y:0})),Ce=oe(j([])),Je=oe(!1),ye=oe(j({x:0,y:0})),Ae=oe(0),ee=oe("histogram"),xe=oe(!1),ke=oe(j({x:0,y:0})),He=oe(!1),Ie=oe(j({x:0,y:0})),ne=oe(!1),J=oe(j({x:0,y:0})),qe=oe(!1),ft=oe(j({x:0,y:0})),Qe=oe(0),Oe=oe(!1),ct=oe(j({x:0,y:0})),Lt=oe(0),It=oe("vr"),zt=oe(!1),pt=oe(j({x:0,y:0})),Mo=oe(0),Xo=oe(!1),en=oe(j({x:0,y:0})),Fo=oe(0),Eo=oe(!1),cs=oe(j({x:0,y:0})),Zt=oe(0),bs=oe(!1),es=oe(j({x:0,y:0})),rn=oe(!1),wr=oe(j({x:0,y:0})),rr=oe(0),ar=oe(!1),jr=oe(j({x:0,y:0})),ii=oe(0),Xa=oe(!1),Ja=j({x:0,y:0}),Va=oe(0),Wa=oe("uptrend"),Qa=oe(!1),qa=oe(j({x:0,y:0})),Kl=oe(0),ll=oe(!1),Wr=oe(j({x:0,y:0})),Ca=oe(!1),vl=oe(j({x:0,y:0})),ml=oe(!1),Sl=oe(j({x:0,y:0})),el=oe(0),or=oe(!1),tc=oe(j({x:0,y:0})),pe=oe(0),rt=oe("cr"),Ft=oe(!1),Qt=oe(j({x:0,y:0})),xt=oe(!1),eo=oe(j({x:0,y:0})),Is=oe(!1),Po=oe(j({x:0,y:0})),Ze=oe(0),Ke=oe(!1),ps=oe(j({x:0,y:0})),pn=oe(!1),Jo=oe(j({x:0,y:0})),ti=oe(!1),mr=j({x:0,y:0}),sa=oe(!1),yt=j({x:0,y:0}),wt=oe(!1),to=oe(j({x:0,y:0})),mt=oe(!1),Wt=oe(j({x:0,y:0})),vt=oe(!1),$t=oe(j({x:0,y:0})),zo=oe(!1),bo=oe(j({x:0,y:0})),xo=oe(!1),Zo=oe(j({x:0,y:0})),os=oe(!1),ri=oe(j({x:0,y:0})),vn=oe(!1),sr=oe(j({x:0,y:0})),Ko=oe(!1),Hn=oe(j({x:0,y:0})),ji=oe(!1),zn=oe(j({x:0,y:0})),Vs=oe(1),Bn=oe("solid"),tr=oe(1),lr=oe("dashed"),Ui=oe(1),_a=oe("dashed"),qi=oe(22),ai=oe("#66c2a5"),cr=oe("#66c2a5"),Dn=oe("#e67e22"),kr=oe("#c0392b"),Me=oe(!0),Xe=oe(!0),X=oe(!0),Le=oe(!1),nt=oe(j({x:0,y:0})),et=oe(0),ht=oe(!1),uo=oe(j({x:0,y:0})),ut=oe(0),Jt=oe(0),fo=oe(0),lo=oe(!1),so=oe(j({x:0,y:0})),ko=oe(0),ts=oe(!1),Xn=oe(j({x:0,y:0})),ro=oe(0),Do=oe(!1),Ao=oe(j({x:0,y:0})),ss=oe(0),ds=oe(!1),Cs=oe(!1),ns=oe(!1),Js=oe(!1),Nn=oe(!1),ui=oe(j({x:0,y:0})),Ms=oe(0);function Li(h,x){if(s()){try{s().removeIndicator({paneId:h,name:x})}catch(M){console.log("Error removing indicator:",M)}d.update(M=>{const I=`${h}_${x}`;return delete M.saveInds[I],M})}}const Dr=We(()=>i().editIndName==="BOLL"),Xr=We(()=>i().editIndName==="MACD"),Ki=We(()=>i().editIndName==="BIAS"),Ge=We(()=>i().editIndName==="AO"),at=We(()=>i().editIndName==="WR"),So=We(()=>i().editIndName==="VR"),qt=We(()=>i().editIndName==="BBI"),Io=We(()=>i().editIndName==="EMA"),us=We(()=>i().editIndName==="SMA"),fn=We(()=>i().editIndName==="MA"),Ts=We(()=>i().editIndName==="ICHIMOKU"),js=We(()=>i().editIndName==="PVT"),on=We(()=>i().editIndName==="VOL"),_s=We(()=>i().editIndName==="SAR"),In=We(()=>i().editIndName==="DMI"),Ci=We(()=>i().editIndName==="TRIX"),zr=We(()=>i().editIndName==="ROC"),ca=We(()=>i().editIndName==="ZIGZAG"),hl=We(()=>i().editIndName==="PSY"),fa=We(()=>i().editIndName==="OBV"),za=We(()=>i().editIndName==="CR"),oc=We(()=>i().editIndName==="NPO_MAE"),sc=We(()=>i().editIndName==="KDJ"),Cl=We(()=>i().editIndName==="CCI"),Vl=We(()=>i().editIndName==="EMV"),ul=We(()=>i().editIndName==="MTM"),nc=We(()=>i().editIndName==="RSI"),vc=We(()=>i().editIndName==="STOCH"),Zl=We(()=>i().editIndName==="SMARTTREND"),Ha=We(()=>i().editIndName==="SMART_MONEY"),qc=We(()=>i().editIndName==="TRAP_HUNTER"),_c=We(()=>i().editIndName==="VOLCANIC"),ld=We(()=>i().editIndName==="VOLCANIC_SIG"),Od=We(()=>n(Ha)||n(qc)||n(_c)||n(ld));function Hc(){if(!(i().editIndName!=="TRAP_HUNTER"||!s()))try{const h=(p||[]).map(x=>Number(x));s().overrideIndicator({name:"TRAP_HUNTER",calcParams:h,paneId:i().editPaneId})}catch(h){console.error("❌ Error updating Trap Hunter:",h)}}function fl(){if(!(i().editIndName!=="VOLCANIC"||!s()))try{const h=(p||[]).map(x=>Number(x));s().overrideIndicator({name:"VOLCANIC",calcParams:h,paneId:i().editPaneId})}catch(h){console.error("❌ Error updating VOLCANIC:",h)}}function tl(){if(!(i().editIndName!=="VOLCANIC_SIG"||!s()))try{const h=(p||[]).map(x=>Number(x));s().overrideIndicator({name:"VOLCANIC_SIG",calcParams:h,paneId:i().editPaneId})}catch(h){console.error("❌ Error updating VOLCANIC_SIG:",h)}}let hd=oe("");Wi(()=>{if(!n(_c))return;const h=JSON.stringify(p??[]);h!==n(hd)&&(b(hd,j(h)),fl())});let Rc=oe("");Wi(()=>{if(!n(ld))return;const h=JSON.stringify(p??[]);h!==n(Rc)&&(b(Rc,j(h)),tl())});const iu=We(()=>i().editIndName==="SMARTTREND"?"Smart Trend":i().editIndName);let Iu=oe("#2962FF"),uu=oe(2),Vd=oe("solid"),ru=oe(26),qu=oe(10),Mu=oe(20),Ad=oe(40),_d=oe(60),Bs=j({zoneLookbackBars:40,minZoneBars:5,maxZoneBars:25,atrPeriod:14,volumeMAPeriod:20,minVolumeFactor:1.2,maxZoneWidthPct:.03,priorTrendLookback:20,minOBVTrendStrength:.2,minZoneScore:.6,mergeNearbyZones:!0,maxZonesDisplayed:20,showLabels:!0});function bp(){if(!n(Ha)||!Array.isArray(p))return;const h=p;Bs.zoneLookbackBars=Number(h[0]??Bs.zoneLookbackBars),Bs.minZoneBars=Number(h[1]??Bs.minZoneBars),Bs.maxZoneBars=Number(h[2]??Bs.maxZoneBars),Bs.atrPeriod=Number(h[3]??Bs.atrPeriod),Bs.volumeMAPeriod=Number(h[4]??Bs.volumeMAPeriod),Bs.minVolumeFactor=Number(h[5]??Bs.minVolumeFactor),Bs.maxZoneWidthPct=Number(h[6]??Bs.maxZoneWidthPct),Bs.priorTrendLookback=Number(h[7]??Bs.priorTrendLookback),Bs.minOBVTrendStrength=Number(h[8]??Bs.minOBVTrendStrength),Bs.minZoneScore=Number(h[9]??Bs.minZoneScore),Bs.mergeNearbyZones=Number(h[10]??(Bs.mergeNearbyZones?1:0))>0,Bs.maxZonesDisplayed=Number(h[11]??Bs.maxZonesDisplayed),Bs.showLabels=Number(h[12]??(Bs.showLabels?1:0))>0}Wi(()=>{n(Ha)&&bp()});function xp(){var x;const h=[Bs.zoneLookbackBars,Bs.minZoneBars,Bs.maxZoneBars,Bs.atrPeriod,Bs.volumeMAPeriod,Bs.minVolumeFactor,Bs.maxZoneWidthPct,Bs.priorTrendLookback,Bs.minOBVTrendStrength,Bs.minZoneScore,Bs.mergeNearbyZones?1:0,Bs.maxZonesDisplayed,Bs.showLabels?1:0];(x=s())==null||x.overrideIndicator({name:"SMART_MONEY",calcParams:h,paneId:i().editPaneId}),d.update(M=>(M.saveInds[`${i().editPaneId}_SMART_MONEY`]={name:"SMART_MONEY",params:h,pane_id:i().editPaneId},M))}let Xc=oe("#FF6B35"),sp=oe("#2196F3"),wp=oe("#4CAF50"),pu=oe("#FF9800"),Kp=oe("#9C27B0"),vu=oe(2),yd=oe(1),kp=oe(1),Sp=oe(1),Zp=oe(1),np=oe("solid"),ip=oe("solid"),Xp=oe("solid"),Kd=oe("solid"),Mt=oe("solid");Wi(()=>{n(zr)&&!n(Br)?(console.log("🎯 ROC modal opened, initializing..."),b(Br,!0),hn(),setTimeout(()=>{Bi()},100)):!n(zr)&&n(Br)&&b(Br,!1)});let ho=oe(!1),no=oe(!1);Wi(()=>{n(nc)&&!n(ho)?(console.log("🎯 RSI modal opened, initializing..."),b(ho,!0),Xl()):!n(nc)&&n(ho)&&b(ho,!1)}),Wi(()=>{n(vc)&&!n(no)?(console.log("🎯 Stochastic modal opened, initializing..."),b(no,!0),Da()):!n(vc)&&n(no)&&b(no,!1)}),Wi(()=>{n(Ci)&&!n(ya)?(console.log("🎯 TRIX modal opened, initializing..."),b(ya,!0),Ma()):!n(Ci)&&n(ya)&&b(ya,!1)});let gn=oe(!1);Wi(()=>{n(us)&&!n(gn)?(console.log("🎯 SMA modal opened, initializing..."),b(gn,!0),gi()):!n(us)&&n(gn)&&b(gn,!1)});let dr=oe(!1);Wi(()=>{n(So)&&!n(dr)?(console.log("🎯 VR modal opened, initializing..."),b(dr,!0),Ys()):!n(So)&&n(dr)&&b(dr,!1)});let z=oe(!1);Wi(()=>{n(on)&&!n(z)?(console.log("🎯 Volume modal opened, initializing..."),b(z,!0),Ld()):!n(on)&&n(z)&&b(z,!1)});let te=oe(!1);Wi(()=>{n(qt)&&!n(te)?(console.log("🎯 BBI modal opened, initializing..."),b(te,!0),Xd()):!n(qt)&&n(te)&&b(te,!1)}),Wi(()=>{n(qt)&&n(te)&&s()&&n(Ho).forEach((h,x)=>{const{period1:M,period2:I,period3:D,period4:E,color:H,thickness:ue,lineStyle:Fe}=h;if(M&&I&&D&&E&&H&&ue&&Fe){const it=setTimeout(()=>{Fi(x)},100);return()=>clearTimeout(it)}})});let ve=oe(!1);Wi(()=>{n(Dr)&&!n(ve)?(console.log("🎯 Bollinger Bands modal opened, initializing..."),b(ve,!0),ap()):!n(Dr)&&n(ve)&&b(ve,!1)}),Wi(()=>{if(n(Dr)&&n(ve)&&s()){const h=n(R),x=n(N),M=n(S),I=n(L),D=n(T),E=n(P),H=n(A),ue=n(F),Fe=n(B);if(h&&x&&M&&D&&E&&H&&ue&&Fe){const it=setTimeout(()=>{n(Vo).length===0?b(Vo,j([{id:cn(),paneId:i().editPaneId||"candle_pane",period:h,stdDev:x,styles:{fillColor:M,fillOpacity:I,upperColor:D,middleColor:E,lowerColor:H,thickness:ue,lineStyle:Fe}}])):(n(Vo)[0].period=h,n(Vo)[0].stdDev=x,n(Vo)[0].styles.fillColor=M,n(Vo)[0].styles.fillOpacity=I,n(Vo)[0].styles.upperColor=D,n(Vo)[0].styles.middleColor=E,n(Vo)[0].styles.lowerColor=H,n(Vo)[0].styles.thickness=ue,n(Vo)[0].styles.lineStyle=Fe),To()},100);return()=>clearTimeout(it)}}});let Ne=oe(!1);Wi(()=>{n(_s)&&!n(Ne)?(console.log("🎯 SAR modal opened, initializing..."),b(Ne,!0),Gt()):!n(_s)&&n(Ne)&&b(Ne,!1)}),Wi(()=>{n(_s)&&n(Ne)&&s()&&n(is).forEach((h,x)=>{const{start:M,increment:I,maxValue:D,color:E,dotSize:H}=h;if(M!==void 0&&I!==void 0&&D!==void 0&&E&&H){const ue=setTimeout(()=>{Tt(x)},100);return()=>clearTimeout(ue)}})});let Re=oe(!1);Wi(()=>{n(Ge)&&!n(Re)?(console.log("🎯 AO modal opened, initializing..."),b(Re,!0),jc()):!n(Ge)&&n(Re)&&b(Re,!1)}),Wi(()=>{n(Ge)&&n(Re)&&s()&&n(Oo).forEach((h,x)=>{const{shortPeriod:M,longPeriod:I,styles:D}=h;if(M&&I&&D){const E=setTimeout(()=>{gu()},100);return()=>clearTimeout(E)}})});let je=oe(!1);Wi(()=>{n(Ki)&&!n(je)?(console.log("🎯 BIAS modal opened, initializing..."),b(je,!0),Ml()):!n(Ki)&&n(je)&&b(je,!1)}),Wi(()=>{n(Ki)&&n(je)&&s()&&n(Ot).forEach((h,x)=>{const{period:M,color:I,thickness:D,lineStyle:E}=h;if(M&&I&&D&&E){const H=setTimeout(()=>{fc()},100);return()=>clearTimeout(H)}})});let Ue=oe(!1);Wi(()=>{n(ul)&&!n(Ue)?(console.log("🎯 MTM modal opened, initializing..."),b(Ue,!0),fi()):!n(ul)&&n(Ue)&&b(Ue,!1)}),Wi(()=>{n(ul)&&n(Ue)&&s()&&n(kn).forEach((h,x)=>{const{period:M,color:I,thickness:D,lineStyle:E}=h;if(M&&I&&D&&E){const H=setTimeout(()=>{Nr()},100);return()=>clearTimeout(H)}})});let kt=oe(!1),lt=oe(!1);Wi(()=>{n(fa)&&!n(kt)?(console.log("🎯 OBV modal opened, initializing..."),b(kt,!0),bd()):!n(fa)&&n(kt)&&b(kt,!1)}),Wi(()=>{if(n(lt)){console.log("⏸️ Skipping OBV effect - removal in progress");return}n(fa)&&n(kt)&&s()&&n(qs).forEach((h,x)=>{const{obvPeriod:M,maobvPeriod:I,showMaobv:D,styles:E}=h;if(M&&I&&E){const H=setTimeout(()=>{zl()},100);return()=>clearTimeout(H)}})});let bt=oe(!1);Wi(()=>{n(Cl)&&!n(bt)?(console.log("🎯 CCI modal opened, initializing..."),b(bt,!0),au()):!n(Cl)&&n(bt)&&b(bt,!1)}),Wi(()=>{n(Cl)&&n(bt)&&s()&&n(Pi).forEach((h,x)=>{const{period:M,color:I,thickness:D,lineStyle:E}=h;if(M&&I&&D&&E){const H=setTimeout(()=>{ud()},100);return()=>clearTimeout(H)}})});let Ct=oe(!1);Wi(()=>{n(za)&&!n(Ct)?(console.log("🎯 CR modal opened, initializing..."),b(Ct,!0),_o()):!n(za)&&n(Ct)&&b(Ct,!1)}),Wi(()=>{n(za)&&n(Ct)&&s()&&n(li).forEach((h,x)=>{const{crPeriod:M,crMa1Period:I,crMa2Period:D,crMa3Period:E,crMa4Period:H,styles:ue}=h;if(M&&I&&D&&E&&H&&ue){const Fe=setTimeout(()=>{ms()},100);return()=>clearTimeout(Fe)}})});let Kt=oe(!1);Wi(()=>{n(In)&&!n(Kt)?(console.log("🎯 DMI modal opened, initializing..."),b(Kt,!0),ws()):!n(In)&&n(Kt)&&b(Kt,!1)}),Wi(()=>{n(In)&&n(Kt)&&s()&&n(Rs).forEach((h,x)=>{const{diPeriod:M,adxPeriod:I,styles:D}=h;if(M&&I&&D){const E=setTimeout(()=>{po()},100);return()=>clearTimeout(E)}})}),Wi(()=>{n(So)&&n(dr)&&s()&&n(Co).forEach((h,x)=>{const{period:M,shortPeriod:I,longPeriod:D,styles:E}=h;if(M&&I&&D&&E){const H=setTimeout(()=>{ba(x)},100);return()=>clearTimeout(H)}})}),Wi(()=>{n(Xr)&&s()&&n(Dt).length>0&&n(Dt).forEach((h,x)=>{const{fastPeriod:M,slowPeriod:I,signalPeriod:D,styles:E}=h;if(M&&I&&D&&E){const H=setTimeout(()=>{st(x)},100);return()=>clearTimeout(H)}})});let Dt=oe(j([])),jt=oe(j([])),Co=oe(j([])),Oo=oe(j([])),Ho=oe(j([])),Vo=oe(j([])),Cn=oe(0),Qs=oe(j([])),Gn=oe(0);function zi(h){b(Gn,j(h)),b(es,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(bs,!0)}function wn(){if(!s())return;const h=i().editPaneId||"candle_pane";for(let x=0;x<6;(x+=1)-1)try{s().removeIndicator({paneId:h,name:"ZIGZAG"})}catch{}n(Qs).forEach((x,M)=>{const I=x.styles.lineStyle==="solid"?Ee.Solid:Ee.Dashed,D=x.styles.lineStyle==="dashed"?[4,4]:x.styles.lineStyle==="dotted"?[2,6]:[2,2],E={lines:[{color:x.styles.color,size:x.styles.thickness,style:I,dashedValue:D,smooth:!1}]};s().createIndicator({name:"ZIGZAG",calcParams:[x.deviation,x.depth],styles:E},!0,{id:h});const H=M===0?`${h}_ZIGZAG`:`${h}_ZIGZAG_${M+1}`;d.update(ue=>(ue.saveInds[H]={name:"ZIGZAG",pane_id:h,params:[x.deviation,x.depth],styles:E},ue))}),d.update(x=>{const M=`${h}_ZIGZAG`;return Object.keys(x.saveInds).filter(D=>D.startsWith(M)).forEach(D=>{const E=D.match(/_ZIGZAG(?:_(\d+))?$/);(E&&E[1]?parseInt(E[1],10):1)>n(Qs).length&&delete x.saveInds[D]}),x})}function Ro(h,x){b(Cn,j(x));const M={x:window.innerWidth/2,y:window.innerHeight/2};h==="fill"&&(b(Wt,j(M)),b(mt,!0)),h==="upper"&&(b($t,j(M)),b(vt,!0)),h==="middle"&&(b(bo,j(M)),b(zo,!0)),h==="lower"&&(b(Zo,j(M)),b(xo,!0))}function Qo(){return window.__npoMaeApi}function oo(h){const x={x:window.innerWidth/2,y:window.innerHeight/2};h==="median"&&(b(ri,j(x)),b(os,!0)),h==="band"&&(b(sr,j(x)),b(vn,!0)),h==="slLong"&&(b(Hn,j(x)),b(Ko,!0)),h==="slShort"&&(b(zn,j(x)),b(ji,!0))}function Yt(){const h=Qo();if(!h)return;h.updateSettings({bandAlpha:Math.max(0,Math.min(100,n(qi)))/100});const x=k(n(ai),n(qi));h.setColors({band:x})}let Ht=oe(!1);Wi(()=>{var h,x;if(!(!n(oc)||n(Ht)||!s()))try{const I=(((x=(h=s()).getOverlays)==null?void 0:x.call(h))??[]).find(ue=>(ue==null?void 0:ue.name)==="NearestPatternOutcomeMaeStop"),D=(I==null?void 0:I.extendData)||{},E=D.colors||{};E.median&&b(cr,j(E.median)),E.band&&b(ai,j(E.band)),E.slLong&&b(Dn,j(E.slLong)),E.slShort&&b(kr,j(E.slShort)),typeof D.showOutcomeBand=="boolean"&&b(Me,j(D.showOutcomeBand)),typeof D.showStopLines=="boolean"&&b(Xe,j(D.showStopLines)),typeof D.showTable=="boolean"&&b(X,j(D.showTable));const H=D.styles||{};H.median&&(typeof H.median.size=="number"&&b(Vs,j(H.median.size)),typeof H.median.style=="string"&&b(Bn,j(H.median.style))),H.slLong&&(typeof H.slLong.size=="number"&&b(tr,j(H.slLong.size)),typeof H.slLong.style=="string"&&b(lr,j(H.slLong.style))),H.slShort&&(typeof H.slShort.size=="number"&&b(Ui,j(H.slShort.size)),typeof H.slShort.style=="string"&&b(_a,j(H.slShort.style))),typeof D.bandAlpha=="number"&&b(qi,j(Math.round((D.bandAlpha||0)*100))),b(Ht,!0)}catch{}});function To(){if(!s())return;const h=i().editPaneId||"candle_pane";for(let x=0;x<6;(x+=1)-1)try{s().removeIndicator({paneId:h,name:"BOLL"})}catch{}n(Vo).forEach((x,M)=>{const I=x.styles.lineStyle==="solid"?Ee.Solid:Ee.Dashed,D=x.styles.lineStyle==="dashed"?[4,4]:[0,0],E={lines:[{color:x.styles.upperColor,size:x.styles.thickness,style:I,dashedValue:D},{color:x.styles.middleColor,size:x.styles.thickness,style:I,dashedValue:D},{color:x.styles.lowerColor,size:x.styles.thickness,style:I,dashedValue:D}],fill:{color:x.styles.fillColor,opacity:(x.styles.fillOpacity||0)/100}};s().createIndicator({name:"BOLL",calcParams:[x.period,x.stdDev],styles:E},!0,{id:h});const H=M===0?`${h}_BOLL`:`${h}_BOLL_${M+1}`;d.update(ue=>(ue.saveInds[H]={name:"BOLL",pane_id:h,params:[x.period,x.stdDev],bollingerStyles:{fillColor:x.styles.fillColor,fillOpacity:x.styles.fillOpacity,upperColor:x.styles.upperColor,middleColor:x.styles.middleColor,lowerColor:x.styles.lowerColor,thickness:x.styles.thickness,lineStyle:x.styles.lineStyle}},ue))}),d.update(x=>{const M=`${h}_BOLL`;return Object.keys(x.saveInds).filter(D=>D.startsWith(M)).forEach(D=>{const E=D.match(/_BOLL(?:_(\d+))?$/);(E&&E[1]?parseInt(E[1],10):1)>n(Vo).length&&delete x.saveInds[D]}),x})}function vo(h){if(n(Vo).length<=1)return;b(Vo,j(n(Vo).filter((M,I)=>I!==h)));const x=n(Vo)[0];x&&(b(R,j(x.period)),b(N,j(x.stdDev)),b(S,j(x.styles.fillColor)),b(L,j(x.styles.fillOpacity)),b(T,j(x.styles.upperColor)),b(P,j(x.styles.middleColor)),b(A,j(x.styles.lowerColor)),b(F,j(x.styles.thickness)),b(B,j(x.styles.lineStyle))),To()}let Ot=oe(j([])),Yo=oe(j([])),is=oe(j([])),vs=oe(j([])),Rs=oe(j([])),Ws=oe(j([])),li=oe(j([])),an=oe(j([])),Br=oe(!1),ya=oe(!1),As=oe(j([])),qs=oe(j([])),Jn=oe(j([])),Pi=oe(j([]));function _l(){b(Pi,j([])),console.log("✅ CCI groups cleared from modal state")}let ur=oe(j([]));function yl(){b(ur,j([])),console.log("✅ EMV groups cleared from modal state")}let kn=oe(j([]));function Sr(){b(kn,j([])),console.log("✅ MTM groups cleared from modal state")}function Ba(){b(qs,j([])),console.log("✅ OBV groups cleared from modal state")}function Pt(){b(As,j([])),console.log("✅ PSY groups cleared from modal state")}let Ut=oe(j([]));function xs(){b(Ut,j([])),console.log("✅ PVT groups cleared from modal state")}function fs(){b(Ce,j([])),console.log("✅ VOL groups cleared from modal state")}function rs(){b(jt,j([])),console.log("✅ WR groups cleared from modal state")}function mn(){if(!n(js))return;const h=`${i().editPaneId}_PVT`,x=r().saveInds[h];x&&x.pvtGroups&&x.pvtGroups.length>0?b(Ut,j([...x.pvtGroups])):n(Ut).length===0&&b(Ut,j([{id:cn(),name:"PVT #1",color:"#2563eb",thickness:1,lineStyle:"solid"}]))}function Ds(){var x;if(!n(js))return;const h={id:cn(),name:`PVT #${n(Ut).length+1}`,color:"#2563eb",thickness:1,lineStyle:"solid"};if(n(Ut).push(h),s()){let M=Ee.Solid,I=[2,2];h.lineStyle==="dashed"?(M=Ee.Dashed,I=[4,4]):h.lineStyle==="dotted"&&(M=Ee.Dashed,I=[2,2]);const D={lines:[{color:h.color,size:h.thickness,style:M,dashedValue:I}]},E=(x=s())==null?void 0:x.createIndicator({name:"PVT",styles:D,figures:[{key:"pvt",title:"PVT: ",type:"line"}]},!1);console.log("✅ Created PVT indicator on pane:",E),E&&d.update(H=>{const ue=`${E}_PVT`;return H.saveInds[ue]||(H.saveInds[ue]={name:"PVT",pane_id:E,pvtGroups:[]}),H.saveInds[ue].pvtGroups||(H.saveInds[ue].pvtGroups=[]),H.saveInds[ue].pvtGroups.push({...h}),console.log("💾 Saved new PVT group to storage:",ue,h),H})}console.log("➕ Added new PVT group:",h.name,"ID:",h.id)}function sn(h){var M,I;if(!n(js)||n(Ut).length<=1||h<0||h>=n(Ut).length)return;console.log("🗑️ Removing PVT group at index:",h);const x=n(Ut).length;if(n(Ut)[h],n(Ut).splice(h,1),console.log(`📝 Removed group: ${x} -> ${n(Ut).length}`),n(Ut).forEach((D,E)=>{D.name=`PVT #${E+1}`}),s())try{const E=((M=s())==null?void 0:M.getIndicators()).filter(H=>H.name==="PVT");console.log("📈 PVT indicators found:",E.length);for(const H of E)console.log("🗑️ Removing PVT from pane:",H.paneId),(I=s())==null||I.removeIndicator({paneId:H.paneId,name:"PVT"});n(Ut).forEach((H,ue)=>{var Et;let Fe=Ee.Solid,it=[2,2];H.lineStyle==="dashed"?(Fe=Ee.Dashed,it=[4,4]):H.lineStyle==="dotted"&&(Fe=Ee.Dashed,it=[2,2]);const yo={lines:[{color:H.color,size:H.thickness,style:Fe,dashedValue:it}]};console.log("➕ Re-adding PVT group:",H.name,"at index:",ue);const ao=(Et=s())==null?void 0:Et.createIndicator({name:"PVT",styles:yo,figures:[{key:"pvt",title:"PVT: ",type:"line"}]},!1);ao&&d.update(Ls=>{const Mn=`${ao}_PVT`;return Ls.saveInds[Mn]||(Ls.saveInds[Mn]={name:"PVT",pane_id:ao,pvtGroups:[]}),Ls.saveInds[Mn].pvtGroups||(Ls.saveInds[Mn].pvtGroups=[]),Ls.saveInds[Mn].pvtGroups[ue]={...H},Ls})}),console.log("✅ Successfully updated PVT indicators on chart")}catch(D){console.error("❌ Error updating PVT indicators:",D)}console.log("✅ PVT group removed. Remaining groups:",n(Ut).length)}function na(){b(an,j([])),console.log("✅ ROC groups cleared from modal state")}let Wo=oe(j([]));function Pl(){b(Wo,j([])),console.log("✅ RSI groups cleared from modal state")}function El(){const h=new Set,x=s();if(!(x!=null&&x.getIndicators))return h;try{x.getIndicators().forEach(I=>{(I==null?void 0:I.name)==="RSI"&&(I!=null&&I.paneId)&&h.add(I.paneId)})}catch(M){console.warn("⚠️ Failed to read RSI pane IDs from chart:",M)}return h}function fe(h,x){const M=El();for(const I of M)if(!h.has(I))return I;return x}function No(h){const x="pane_RSI";if(!h.has(x))return x;let M=2;for(;h.has(`${x}_${M}`)&&M<1e3;)M+=1;if(!h.has(`${x}_${M}`))return`${x}_${M}`;let I=`${x}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;for(;h.has(I);)I=`${x}_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;return I}function gs(h,x={}){return{...h,...x,styles:{...h.styles,rsi:{...h.styles.rsi}}}}function pi(h){var D,E,H;if(!h||h.name!=="RSI")return null;const x=Array.isArray(h.rsiGroups)&&h.rsiGroups.length>0?h.rsiGroups[0]:null;if(!x)return null;const M=x.actualPaneId||x.paneId||h.pane_id,I=x.styles||{};return{id:x.id||cn(),period:x.period??(Array.isArray(h.params)?h.params[0]:14),overboughtLevel:x.overboughtLevel??70,middleLevel:x.middleLevel??50,oversoldLevel:x.oversoldLevel??30,fillOpacity:x.fillOpacity??.15,paneId:M||h.pane_id,actualPaneId:M||h.pane_id,styles:{rsi:{color:((D=I.rsi)==null?void 0:D.color)??"#8B5CF6",thickness:((E=I.rsi)==null?void 0:E.thickness)??2,lineStyle:((H=I.rsi)==null?void 0:H.lineStyle)??"solid"},overboughtColor:I.overboughtColor??"#EF4444",overboughtThickness:I.overboughtThickness??1,overboughtLineStyle:I.overboughtLineStyle??"dashed",oversoldColor:I.oversoldColor??"#22C55E",oversoldThickness:I.oversoldThickness??1,oversoldLineStyle:I.oversoldLineStyle??"dashed",middleLineColor:I.middleLineColor??"#6B7280",middleLineThickness:I.middleLineThickness??1,middleLineStyle:I.middleLineStyle??"dashed"}}}function vi(){const h=new Map;Object.values(r().saveInds||{}).forEach(M=>{if(!M||M.name!=="RSI")return;const I=pi(M);I!=null&&I.actualPaneId&&!h.has(I.actualPaneId)&&h.set(I.actualPaneId,I)});const x=Array.from(h.values());return i().editPaneId&&x.sort((M,I)=>M.actualPaneId===i().editPaneId?-1:I.actualPaneId===i().editPaneId?1:(M.actualPaneId||"").localeCompare(I.actualPaneId||"")),x}function Na(){if(!n(nc))return;const h=n(Wo).map(x=>{const M=x.actualPaneId||x.paneId||i().editPaneId;return gs(x,{paneId:M,actualPaneId:M})});d.update(x=>(Object.keys(x.saveInds||{}).forEach(M=>{var I;((I=x.saveInds[M])==null?void 0:I.name)==="RSI"&&delete x.saveInds[M]}),h.forEach(M=>{const I=M.actualPaneId;if(!I)return;const D=`${I}_RSI`;x.saveInds[D]={name:"RSI",pane_id:I,params:[M.period],rsiGroups:[gs(M)]}}),x))}function Xl(){if(!n(nc))return;const h=vi(),x=El();if(x.size>0&&h.length<x.size){const M=[];if(x.forEach(I=>{try{const D=mp.getInstance(I)||mp.getInstanceConfig(I);if(!D)return;const E={id:cn(),period:D.period??14,overboughtLevel:D.overboughtLevel??70,middleLevel:D.middleLevel??50,oversoldLevel:D.oversoldLevel??30,fillOpacity:D.fillOpacity??.15,paneId:I,actualPaneId:I,styles:{rsi:{color:D.lineColor??"#8B5CF6",thickness:D.lineThickness??2,lineStyle:D.lineStyle??"solid"},overboughtColor:D.overboughtColor??"#EF4444",overboughtThickness:D.overboughtThickness??1,overboughtLineStyle:D.overboughtLineStyle??"dashed",oversoldColor:D.oversoldColor??"#22C55E",oversoldThickness:D.oversoldThickness??1,oversoldLineStyle:D.oversoldLineStyle??"dashed",middleLineColor:D.middleLineColor??"#6B7280",middleLineThickness:D.middleLineThickness??1,middleLineStyle:D.middleLineStyle??"dashed"}};M.push(E)}catch(D){console.warn("⚠️ Failed to reconstruct RSI group from instance:",D)}}),M.length>0){b(Wo,j(M)),Na();return}}if(h.length>0){b(Wo,j(h)),Na();return}if(n(Wo).length===0){const M={id:cn(),period:14,overboughtLevel:70,middleLevel:50,oversoldLevel:30,fillOpacity:.15,paneId:i().editPaneId,actualPaneId:i().editPaneId,styles:{rsi:{color:"#8B5CF6",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",overboughtThickness:1,overboughtLineStyle:"dashed",oversoldColor:"#22C55E",oversoldThickness:1,oversoldLineStyle:"dashed",middleLineColor:"#6B7280",middleLineThickness:1,middleLineStyle:"dashed"}};b(Wo,j([M])),mp.createInstance(M.actualPaneId,{period:M.period,lineColor:M.styles.rsi.color,lineThickness:M.styles.rsi.thickness,lineStyle:M.styles.rsi.lineStyle,overboughtLevel:M.overboughtLevel,oversoldLevel:M.oversoldLevel,middleLevel:M.middleLevel,overboughtColor:M.styles.overboughtColor,overboughtThickness:M.styles.overboughtThickness??1,overboughtLineStyle:M.styles.overboughtLineStyle||"dashed",oversoldColor:M.styles.oversoldColor,oversoldThickness:M.styles.oversoldThickness??1,oversoldLineStyle:M.styles.oversoldLineStyle||"dashed",overboughtFillColor:M.styles.overboughtColor,oversoldFillColor:M.styles.oversoldColor,middleLineColor:M.styles.middleLineColor,middleLineThickness:M.styles.middleLineThickness??1,middleLineStyle:M.styles.middleLineStyle||"dashed",fillOpacity:M.fillOpacity,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:M.overboughtLevel,color:M.styles.overboughtColor,lineStyle:M.styles.overboughtLineStyle||"dashed",thickness:M.styles.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:M.middleLevel,color:M.styles.middleLineColor,lineStyle:M.styles.middleLineStyle||"dashed",thickness:M.styles.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:M.oversoldLevel,color:M.styles.oversoldColor,lineStyle:M.styles.oversoldLineStyle||"dashed",thickness:M.styles.oversoldThickness??1,label:"30",visible:!0}]}),Na()}}function cd(){if(!n(nc))return;const h=El(),x=new Set(h);n(Wo).forEach(E=>{const H=E.actualPaneId||E.paneId;H&&x.add(H)});const M=No(x),I={id:cn(),period:14,overboughtLevel:70,middleLevel:50,oversoldLevel:30,fillOpacity:.15,paneId:M,actualPaneId:M,styles:{rsi:{color:"#8B5CF6",thickness:2,lineStyle:"solid"},overboughtColor:"#EF4444",overboughtThickness:1,overboughtLineStyle:"dashed",oversoldColor:"#22C55E",oversoldThickness:1,oversoldLineStyle:"dashed",middleLineColor:"#6B7280",middleLineThickness:1,middleLineStyle:"dashed"}};n(Wo).push(I);let D=M;if(s()){const E=s(),H=new Set(h);let ue=Ee.Solid,Fe=[2,2];I.styles.rsi.lineStyle==="dashed"?(ue=Ee.Dashed,Fe=[6,4]):I.styles.rsi.lineStyle==="dotted"&&(ue=Ee.Dashed,Fe=[2,2]);const it=E.createIndicator({name:"RSI",calcParams:[I.period],styles:{lines:[{color:I.styles.rsi.color,size:I.styles.rsi.thickness,style:ue,dashedValue:Fe}]}},!1,{id:M,axis:{gap:{bottom:2}}});if(D=fe(H,M),I.paneId=D,I.actualPaneId=D,mp.createInstance(D,{period:I.period,lineColor:I.styles.rsi.color,lineThickness:I.styles.rsi.thickness,lineStyle:I.styles.rsi.lineStyle,overboughtLevel:I.overboughtLevel,oversoldLevel:I.oversoldLevel,middleLevel:I.middleLevel,overboughtColor:I.styles.overboughtColor,overboughtThickness:I.styles.overboughtThickness??1,overboughtLineStyle:I.styles.overboughtLineStyle||"dashed",oversoldColor:I.styles.oversoldColor,oversoldThickness:I.styles.oversoldThickness??1,oversoldLineStyle:I.styles.oversoldLineStyle||"dashed",overboughtFillColor:I.styles.overboughtColor,oversoldFillColor:I.styles.oversoldColor,middleLineColor:I.styles.middleLineColor,middleLineThickness:I.styles.middleLineThickness??1,middleLineStyle:I.styles.middleLineStyle||"dashed",fillOpacity:I.fillOpacity,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:I.overboughtLevel,color:I.styles.overboughtColor,lineStyle:I.styles.overboughtLineStyle||"dashed",thickness:I.styles.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:I.middleLevel,color:I.styles.middleLineColor,lineStyle:I.styles.middleLineStyle||"dashed",thickness:I.styles.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:I.oversoldLevel,color:I.styles.oversoldColor,lineStyle:I.styles.oversoldLineStyle||"dashed",thickness:I.styles.oversoldThickness??1,label:"30",visible:!0}]}),it){const yo=`${D}_RSI`;d.update(ao=>(ao.saveInds[yo]={name:"RSI",pane_id:D,params:[I.period],rsiGroups:[{id:I.id,period:I.period,overboughtLevel:I.overboughtLevel,middleLevel:I.middleLevel,oversoldLevel:I.oversoldLevel,paneId:D,actualPaneId:D,styles:I.styles}]},ao))}}else mp.createInstance(D,{period:I.period,lineColor:I.styles.rsi.color,lineThickness:I.styles.rsi.thickness,lineStyle:I.styles.rsi.lineStyle,overboughtLevel:I.overboughtLevel,oversoldLevel:I.oversoldLevel,middleLevel:I.middleLevel,overboughtColor:I.styles.overboughtColor,overboughtThickness:I.styles.overboughtThickness??1,overboughtLineStyle:I.styles.overboughtLineStyle||"dashed",oversoldColor:I.styles.oversoldColor,oversoldThickness:I.styles.oversoldThickness??1,oversoldLineStyle:I.styles.oversoldLineStyle||"dashed",overboughtFillColor:I.styles.overboughtColor,oversoldFillColor:I.styles.oversoldColor,middleLineColor:I.styles.middleLineColor,middleLineThickness:I.styles.middleLineThickness??1,middleLineStyle:I.styles.middleLineStyle||"dashed",fillOpacity:I.fillOpacity,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:I.overboughtLevel,color:I.styles.overboughtColor,lineStyle:I.styles.overboughtLineStyle||"dashed",thickness:I.styles.overboughtThickness??1,label:"70",visible:!0},{id:"middle",value:I.middleLevel,color:I.styles.middleLineColor,lineStyle:I.styles.middleLineStyle||"dashed",thickness:I.styles.middleLineThickness??1,label:"50",visible:!0},{id:"oversold",value:I.oversoldLevel,color:I.styles.oversoldColor,lineStyle:I.styles.oversoldLineStyle||"dashed",thickness:I.styles.oversoldThickness??1,label:"30",visible:!0}]});Na()}function Be(h){var D;if(!n(nc)||n(Wo).length<=1||h<0||h>=n(Wo).length)return;console.log("🗑️ Removing RSI group at index:",h);const x=n(Wo)[h];let M=x.actualPaneId||x.paneId||i().editPaneId;if(!M&&((D=s())!=null&&D.getIndicators))try{const E=new Set(n(Wo).filter((Fe,it)=>it!==h).map(Fe=>Fe.actualPaneId||Fe.paneId).filter(Fe=>!!Fe)),ue=s().getIndicators().find(Fe=>(Fe==null?void 0:Fe.name)==="RSI"&&(Fe==null?void 0:Fe.paneId)&&!E.has(Fe.paneId));ue!=null&&ue.paneId&&(M=ue.paneId)}catch(E){console.warn("⚠️ Failed to resolve RSI pane ID for removal:",E)}const I=n(Wo).length;if(n(Wo).splice(h,1),console.log(`📝 Removed group: ${I} -> ${n(Wo).length}`),s()&&M)try{console.log("🗑️ Removing RSI from pane:",M),mp.deleteInstance(M),Li(M,"RSI")}catch(E){console.error("❌ Error removing RSI indicator:",E)}Na(),console.log("✅ RSI group removed. Remaining groups:",n(Wo).length)}function Bt(h){if(!n(nc)||!s()||h<0||h>=n(Wo).length)return;const x=n(Wo)[h],M=x.actualPaneId||x.paneId||i().editPaneId;if(!M){console.warn("⚠️ Unable to resolve pane ID for RSI update");return}try{mp.updateInstance(M,{period:x.period,lineColor:x.styles.rsi.color,lineThickness:x.styles.rsi.thickness,lineStyle:x.styles.rsi.lineStyle,overboughtLevel:x.overboughtLevel,oversoldLevel:x.oversoldLevel,middleLevel:x.middleLevel,overboughtColor:x.styles.overboughtColor||"#EF4444",overboughtThickness:x.styles.overboughtThickness??1,overboughtLineStyle:x.styles.overboughtLineStyle||"dashed",oversoldColor:x.styles.oversoldColor||"#22C55E",oversoldThickness:x.styles.oversoldThickness??1,oversoldLineStyle:x.styles.oversoldLineStyle||"dashed",overboughtFillColor:x.styles.overboughtColor||"#EF4444",oversoldFillColor:x.styles.oversoldColor||"#22C55E",middleLineColor:x.styles.middleLineColor||"#6B7280",middleLineThickness:x.styles.middleLineThickness??1,middleLineStyle:x.styles.middleLineStyle||"dashed",fillOpacity:x.fillOpacity??.15,showLevels:!0,showFill:!0,levels:[{id:"overbought",value:x.overboughtLevel,color:x.styles.overboughtColor||"#EF4444",lineStyle:x.styles.overboughtLineStyle||"dashed",thickness:x.styles.overboughtThickness??1,label:String(x.overboughtLevel),visible:!0},{id:"middle",value:x.middleLevel,color:x.styles.middleLineColor||"#6B7280",lineStyle:x.styles.middleLineStyle||"dashed",thickness:x.styles.middleLineThickness??1,label:String(x.middleLevel),visible:!0},{id:"oversold",value:x.oversoldLevel,color:x.styles.oversoldColor||"#22C55E",lineStyle:x.styles.oversoldLineStyle||"dashed",thickness:x.styles.oversoldThickness??1,label:String(x.oversoldLevel),visible:!0}]}),s().removeIndicator({paneId:M,name:"RSI"});let I=Ee.Solid,D=[2,2];x.styles.rsi.lineStyle==="dashed"?(I=Ee.Dashed,D=[6,4]):x.styles.rsi.lineStyle==="dotted"&&(I=Ee.Dashed,D=[2,2]);const E=s().createIndicator({name:"RSI",calcParams:[x.period],styles:{lines:[{color:x.styles.rsi.color,size:x.styles.rsi.thickness,style:I,dashedValue:D}]}},!1,{id:M,axis:{gap:{bottom:2}}});try{typeof s().resize=="function"&&s().resize()}catch{}if(x.actualPaneId=M,x.paneId=M,E){const H=`${M}_RSI`;d.update(ue=>{const Fe=(n(Wo)||[]).filter(it=>(it.actualPaneId||it.paneId)===M);return ue.saveInds[H]={name:"RSI",pane_id:M,params:[x.period],rsiGroups:Fe},ue})}Na()}catch(I){console.error("❌ Error updating RSI indicator:",I)}}let Gs=oe(j([]));function Cr(){b(Gs,j([])),console.log("✅ Stochastic groups cleared from modal state")}function Da(){if(!n(vc))return;const h=`${i().editPaneId}_STOCH`,x=r().saveInds[h];if(x&&x.stochasticGroups&&x.stochasticGroups.length>0)b(Gs,j([...x.stochasticGroups]));else if(n(Gs).length===0){const M={id:cn(),kPeriod:14,dPeriod:3,overboughtLevel:80,oversoldLevel:20,midLevel:50,paneId:i().editPaneId,styles:{kLine:{color:"#1E90FF",thickness:2,lineStyle:"solid"},dLine:{color:"#FF1493",thickness:2,lineStyle:"dashed"},overboughtColor:"#EF4444",oversoldColor:"#10B981",midLineColor:"#6B7280"}};b(Gs,j([M])),vm.createInstance(i().editPaneId,{kPeriod:M.kPeriod,dPeriod:M.dPeriod,kLineColor:M.styles.kLine.color,kLineThickness:M.styles.kLine.thickness,kLineStyle:M.styles.kLine.lineStyle,dLineColor:M.styles.dLine.color,dLineThickness:M.styles.dLine.thickness,dLineStyle:M.styles.dLine.lineStyle,levels:[{id:"overbought",value:M.overboughtLevel,color:M.styles.overboughtColor,lineStyle:"dashed",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:M.oversoldLevel,color:M.styles.oversoldColor,lineStyle:"dashed",thickness:1,label:"Oversold",visible:!0},{id:"mid",value:M.midLevel,color:M.styles.midLineColor,lineStyle:"dashed",thickness:1,label:"Mid",visible:!0}]})}}function ic(){var x;if(!n(vc))return;const h={id:cn(),kPeriod:14,dPeriod:3,overboughtLevel:80,oversoldLevel:20,midLevel:50,paneId:void 0,styles:{kLine:{color:"#1E90FF",thickness:2,lineStyle:"solid"},dLine:{color:"#FF1493",thickness:2,lineStyle:"dashed"},overboughtColor:"#EF4444",oversoldColor:"#10B981",midLineColor:"#6B7280"}};if(b(Gs,j([...n(Gs),h])),n(Gs).length>1){const M=Object.values(r().saveInds).filter(it=>it.name==="STOCH"&&it.pane_id).map(it=>it.pane_id);let I=2;for(;M.includes(`pane_STOCH_${I}`);)I+=1;const D=n(Gs).length-1,E=[h.kPeriod,h.dPeriod,1],H={lines:[{color:h.styles.kLine.color,size:h.styles.kLine.thickness,style:h.styles.kLine.lineStyle==="dashed"||h.styles.kLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:h.styles.kLine.lineStyle==="dashed"?[4,4]:h.styles.kLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:h.styles.dLine.color,size:h.styles.dLine.thickness,style:h.styles.dLine.lineStyle==="dashed"||h.styles.dLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:h.styles.dLine.lineStyle==="dashed"?[4,4]:h.styles.dLine.lineStyle==="dotted"?[2,2]:[2,2]}]},ue=`pane_STOCH_${I}`;console.log(`🆕 Immediately creating Stochastic ${I} with pane ID:`,ue),((x=s())==null?void 0:x.createIndicator({name:"STOCH",calcParams:E,styles:H},!1,{id:ue,axis:{gap:{bottom:2}}}))&&(console.log(`✅ Stochastic ${I} created with pane ID:`,ue),h.paneId=ue,vm.updateInstance(ue,{kPeriod:h.kPeriod,dPeriod:h.dPeriod,levels:[{id:"overbought",value:h.overboughtLevel,color:h.styles.overboughtColor,lineStyle:"solid",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:h.oversoldLevel,color:h.styles.oversoldColor,lineStyle:"solid",thickness:1,label:"Oversold",visible:!0},{id:"midline",value:h.midLevel,color:h.styles.midLineColor,lineStyle:"solid",thickness:1,label:"Midline",visible:!0}],zones:[{id:"overbought_zone",type:"overbought",topLevel:100,bottomLevel:h.overboughtLevel,fillColor:h.styles.overboughtColor,fillOpacity:.1,visible:!0},{id:"oversold_zone",type:"oversold",topLevel:h.oversoldLevel,bottomLevel:0,fillColor:h.styles.oversoldColor,fillOpacity:.1,visible:!0}],kLineColor:h.styles.kLine.color,dLineColor:h.styles.dLine.color,showLevels:!0,showZones:!0,overboughtLevel:h.overboughtLevel,oversoldLevel:h.oversoldLevel,midlineLevel:h.midLevel}),d.update(it=>{const yo=`pane_STOCH_${I}_STOCH`;return it.saveInds[yo]={name:"STOCH",stochasticGroup:h,pane_id:ue,groupIndex:D,params:[h.kPeriod,h.dPeriod,1]},it}))}console.log("✅ New Stochastic group added:",h)}function Jr(h){if(!n(vc)||h<0||h>=n(Gs).length)return;const M=n(Gs)[h].paneId||i().editPaneId;try{vm.deleteInstance(M),s()&&s().removeIndicator({paneId:M,name:"STOCH"}),d.update(I=>(Object.keys(I.saveInds).filter(E=>I.saveInds[E].name==="STOCH"&&I.saveInds[E].pane_id===M).forEach(E=>{delete I.saveInds[E]}),I)),b(Gs,j(n(Gs).filter((I,D)=>D!==h))),console.log("✅ Stochastic group removed successfully")}catch(I){console.error("❌ Error removing Stochastic group:",I)}}function bl(h){if(!n(vc)||h<0||h>=n(Gs).length)return;const x=n(Gs)[h],M=x.paneId||i().editPaneId;try{vm.updateInstance(M,{kPeriod:x.kPeriod,dPeriod:x.dPeriod,kLineColor:x.styles.kLine.color,kLineThickness:x.styles.kLine.thickness,kLineStyle:x.styles.kLine.lineStyle,dLineColor:x.styles.dLine.color,dLineThickness:x.styles.dLine.thickness,dLineStyle:x.styles.dLine.lineStyle,overboughtLevel:x.overboughtLevel,oversoldLevel:x.oversoldLevel,midlineLevel:x.midLevel,showZones:!0,zones:[{id:"overbought-zone",topLevel:100,bottomLevel:x.overboughtLevel,fillColor:x.styles.overboughtColor||"#EF4444",fillOpacity:.1,visible:!0,type:"overbought"},{id:"oversold-zone",topLevel:x.oversoldLevel,bottomLevel:0,fillColor:x.styles.oversoldColor||"#10B981",fillOpacity:.1,visible:!0,type:"oversold"}],levels:[{id:"overbought",value:x.overboughtLevel,color:x.styles.overboughtColor||"#EF4444",lineStyle:"dashed",thickness:1,label:"Overbought",visible:!0},{id:"oversold",value:x.oversoldLevel,color:x.styles.oversoldColor||"#10B981",lineStyle:"dashed",thickness:1,label:"Oversold",visible:!0},{id:"mid",value:x.midLevel,color:x.styles.midLineColor||"#6B7280",lineStyle:"dashed",thickness:1,label:"Mid",visible:!0}]}),s()&&s().removeIndicator({paneId:M,name:"STOCH"});let I=Ee.Solid,D=[2,2],E=Ee.Solid,H=[2,2];if(x.styles.kLine.lineStyle==="dashed"?(I=Ee.Dashed,D=[4,4]):x.styles.kLine.lineStyle==="dotted"&&(I=Ee.Dashed,D=[2,2]),x.styles.dLine.lineStyle==="dashed"?(E=Ee.Dashed,H=[4,4]):x.styles.dLine.lineStyle==="dotted"&&(E=Ee.Dashed,H=[2,2]),s()?s().createIndicator({name:"STOCH",calcParams:[x.kPeriod,x.dPeriod],styles:{lines:[{color:x.styles.kLine.color,size:x.styles.kLine.thickness,style:I,dashedValue:D},{color:x.styles.dLine.color,size:x.styles.dLine.thickness,style:E,dashedValue:H}]}},M===i().editPaneId,{id:M}):null){const Fe=`${M}_STOCH`;d.update(it=>(it.saveInds[Fe]={name:"STOCH",pane_id:M,params:[x.kPeriod,x.dPeriod],stochasticGroups:n(Gs)},it))}console.log("✅ Stochastic indicator and levels updated successfully")}catch(I){console.error("❌ Error updating Stochastic indicator:",I)}}function dd(){if(!n(Xr))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="MACD").sort();console.log("🔍 Found existing MACD keys:",h),h.length>0?(b(Dt,j([])),h.forEach((x,M)=>{const I=r().saveInds[x];if(I){if(I.macdGroup){const D={...I.macdGroup};M>0&&I.pane_id&&(D.actualPaneId=I.pane_id),n(Dt).push(D)}else if(I.params&&I.params.length>=3){const D={id:cn(),fastPeriod:I.params[0]||12,slowPeriod:I.params[1]||26,signalPeriod:I.params[2]||9,actualPaneId:void 0,styles:{macdLine:{color:"#2563eb",thickness:1,lineStyle:"solid"},signalLine:{color:"#dc2626",thickness:1,lineStyle:"solid"},positiveHistogram:{color:"#22c55e"},negativeHistogram:{color:"#ef4444"}}};M>0&&I.pane_id&&(D.actualPaneId=I.pane_id),n(Dt).push(D)}}}),console.log("✅ Loaded",n(Dt).length,"existing MACD groups")):n(Dt).length===0&&(b(Dt,j([{id:cn(),fastPeriod:12,slowPeriod:26,signalPeriod:9,styles:{macdLine:{color:"#2563eb",thickness:1,lineStyle:"solid"},signalLine:{color:"#dc2626",thickness:1,lineStyle:"solid"},positiveHistogram:{color:"#22c55e"},negativeHistogram:{color:"#ef4444"}}}])),console.log("🆕 Created default MACD group"))}function yc(){var I;if(!n(Xr))return;const h=[{macdLine:"#2563eb",signalLine:"#dc2626",positiveHistogram:"#22c55e",negativeHistogram:"#ef4444"},{macdLine:"#9333ea",signalLine:"#ea580c",positiveHistogram:"#059669",negativeHistogram:"#dc2626"},{macdLine:"#ec4899",signalLine:"#f59e0b",positiveHistogram:"#0891b2",negativeHistogram:"#f97316"}],x=n(Dt).length%h.length,M={id:cn(),fastPeriod:12,slowPeriod:26,signalPeriod:9,actualPaneId:void 0,styles:{macdLine:{color:h[x].macdLine,thickness:1,lineStyle:"solid"},signalLine:{color:h[x].signalLine,thickness:1,lineStyle:"solid"},positiveHistogram:{color:h[x].positiveHistogram},negativeHistogram:{color:h[x].negativeHistogram}}};if(n(Dt).push(M),n(Dt).length>1){const D=Object.values(r().saveInds).filter(ao=>ao.name==="MACD"&&ao.pane_id).map(ao=>ao.pane_id);let E=2;for(;D.includes(`pane_MACD_${E}`);)E+=1;const H=n(Dt).length-1,ue=[M.fastPeriod,M.slowPeriod,M.signalPeriod],Fe={lines:[{color:M.styles.macdLine.color,size:M.styles.macdLine.thickness,style:M.styles.macdLine.lineStyle==="dashed"||M.styles.macdLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:M.styles.macdLine.lineStyle==="dashed"?[4,4]:M.styles.macdLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:M.styles.signalLine.color,size:M.styles.signalLine.thickness,style:M.styles.signalLine.lineStyle==="dashed"||M.styles.signalLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:M.styles.signalLine.lineStyle==="dashed"?[4,4]:M.styles.signalLine.lineStyle==="dotted"?[2,2]:[2,2]}],bars:[{upColor:M.styles.positiveHistogram.color,downColor:M.styles.negativeHistogram.color,noChangeColor:M.styles.positiveHistogram.color,borderSize:0,borderColor:M.styles.positiveHistogram.color}]},it=`pane_MACD_${E}`;console.log(`🆕 Immediately creating MACD ${E} with pane ID:`,it),((I=s())==null?void 0:I.createIndicator({name:"MACD",calcParams:ue,styles:Fe},!1,{id:it,axis:{gap:{bottom:2}}}))&&(console.log(`✅ MACD ${E} created with pane ID:`,it),M.actualPaneId=it,d.update(ao=>{const Et=`pane_MACD_${E}_MACD`;return ao.saveInds[Et]={name:"MACD",macdGroup:M,pane_id:it,groupIndex:H,params:[M.fastPeriod,M.slowPeriod,M.signalPeriod]},ao}))}}function bc(h){var M,I;if(!n(Xr)||n(Dt).length<=1)return;const x=n(Dt).findIndex(D=>D.id===h);if(x!==-1){console.log("🗑️ Removing MACD group at index:",x,"ID:",h);try{if(x===0&&n(Dt).length>1){console.log("🔄 Special handling: First MACD removed, promoting second MACD to first position"),b(Dt,j(n(Dt).filter(E=>E.id!==h))),console.log("✅ MACD group removed from array. Remaining groups:",n(Dt).length);const D=n(Dt)[0];D.actualPaneId&&(console.log("🗑️ Removing old second MACD from sub-pane:",D.actualPaneId),(M=s())==null||M.removeIndicator({paneId:D.actualPaneId,name:"MACD"})),D.actualPaneId=void 0,console.log("📊 Updating MACD in edit pane with new first group settings"),st(0)}else{const D=n(Dt)[x];D.actualPaneId&&(console.log("🗑️ Removing MACD from actual pane:",D.actualPaneId),(I=s())==null||I.removeIndicator({paneId:D.actualPaneId,name:"MACD"}),console.log("✅ Successfully removed MACD from actual pane:",D.actualPaneId)),b(Dt,j(n(Dt).filter(E=>E.id!==h))),console.log("✅ MACD group removed from array. Remaining groups:",n(Dt).length)}d.update(D=>(Object.keys(D.saveInds).forEach(E=>{D.saveInds[E].name==="MACD"&&(console.log("🧹 Cleaning saved state for key:",E),delete D.saveInds[E])}),n(Dt).forEach((E,H)=>{const ue=H===0?`${i().editPaneId}_MACD`:`pane_MACD_${H+1}_MACD`,Fe=H===0?i().editPaneId:E.actualPaneId||`pane_MACD_${H+1}`;console.log(`💾 Re-saving MACD group ${H+1} with key:`,ue,"pane ID:",Fe),D.saveInds[ue]={name:"MACD",macdGroup:E,pane_id:Fe,groupIndex:H,macdGroups:H===0?[...n(Dt)]:void 0,params:[E.fastPeriod,E.slowPeriod,E.signalPeriod]}}),D)),console.log("🔄 MACD groups reindexed successfully")}catch(D){console.log("❌ Error removing MACD indicator:",D)}}}function st(h){var E;const x=n(Dt)[h];if(!x||!s())return;const M=h===0?i().editPaneId:x.actualPaneId||`pane_MACD_${h+1}`,I={lines:[{color:x.styles.macdLine.color,size:x.styles.macdLine.thickness,style:x.styles.macdLine.lineStyle==="dashed"||x.styles.macdLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:x.styles.macdLine.lineStyle==="dashed"?[4,4]:x.styles.macdLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:x.styles.signalLine.color,size:x.styles.signalLine.thickness,style:x.styles.signalLine.lineStyle==="dashed"||x.styles.signalLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:x.styles.signalLine.lineStyle==="dashed"?[4,4]:x.styles.signalLine.lineStyle==="dotted"?[2,2]:[2,2]}],bars:[{upColor:x.styles.positiveHistogram.color,downColor:x.styles.negativeHistogram.color,noChangeColor:x.styles.positiveHistogram.color,borderSize:0,borderColor:x.styles.positiveHistogram.color}]};(E=s())==null||E.overrideIndicator({name:"MACD",paneId:M,styles:I,calcParams:[x.fastPeriod,x.slowPeriod,x.signalPeriod]});const D=h===0?`${i().editPaneId}_MACD`:`pane_MACD_${h+1}_MACD`;d.update(H=>(H.saveInds[D]&&(H.saveInds[D].params=[x.fastPeriod,x.slowPeriod,x.signalPeriod],H.saveInds[D].macdGroup={...x},console.log("💾 Persisted MACD changes to save data:",D,x)),H)),console.log("🔄 Updated MACD indicator:",h,x)}function ia(h,x){var E;const M=n(Dt)[h];if(!M||!s())return;const I=h===0?i().editPaneId:M.actualPaneId||`pane_MACD_${h+1}`,D={lines:[{color:M.styles.macdLine.color,size:M.styles.macdLine.thickness,style:M.styles.macdLine.lineStyle==="dashed"||M.styles.macdLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:M.styles.macdLine.lineStyle==="dashed"?[4,4]:M.styles.macdLine.lineStyle==="dotted"?[2,2]:[2,2]},{color:M.styles.signalLine.color,size:M.styles.signalLine.thickness,style:M.styles.signalLine.lineStyle==="dashed"||M.styles.signalLine.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:M.styles.signalLine.lineStyle==="dashed"?[4,4]:M.styles.signalLine.lineStyle==="dotted"?[2,2]:[2,2]}],bars:[{upColor:M.styles.positiveHistogram.color,downColor:M.styles.negativeHistogram.color,noChangeColor:M.styles.positiveHistogram.color,borderSize:0,borderColor:M.styles.positiveHistogram.color}]};(E=s())==null||E.overrideIndicator({name:"MACD",paneId:I,styles:D}),console.log("🎨 Updated MACD color:",x,M.styles[x].color)}function Oc(){if(n(Vl))try{const h=`${i().editPaneId}_EMV`,x=r().saveInds[h];if(x&&x.emvGroups&&Array.isArray(x.emvGroups)&&x.emvGroups.length>0){const M=x.emvGroups.filter(I=>I&&typeof I.id=="string"&&typeof I.name=="string"&&typeof I.period=="number"&&I.period>0&&typeof I.period2=="number"&&I.period2>0&&typeof I.color=="string"&&typeof I.thickness=="number"&&I.thickness>0&&typeof I.lineStyle=="string");M.length>0?(b(ur,j([...M])),console.log("✅ Loaded",M.length,"valid EMV groups")):(console.warn("⚠️ No valid EMV groups found in saved data, creating default"),Zd())}else n(ur).length===0&&Zd()}catch(h){console.error("❌ Error initializing EMV groups:",h),Zd()}}function Zd(){b(ur,j([{id:cn(),name:"EMV #1",period:14,period2:9,color:"#2563eb",thickness:2,lineStyle:"solid"}])),console.log("✅ Created default EMV group")}function fu(h){if(!n(Vl)||n(ur).length<=1){console.warn("⚠️ Cannot remove EMV group: minimum one group required");return}try{if(!h||typeof h!="string"){console.error("❌ Invalid group ID provided for EMV group removal");return}const x=n(ur).length;b(ur,j(n(ur).filter(M=>M.id!==h))),n(ur).length<x?console.log("✅ Removed EMV group with ID:",h):console.warn("⚠️ EMV group not found for removal:",h)}catch(x){console.error("❌ Error removing EMV group:",x)}}function fi(){if(n(ul))try{const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x]&&r().saveInds[x].name==="MTM").sort((x,M)=>x===`${i().editPaneId}_MTM`?-1:M===`${i().editPaneId}_MTM`?1:x.localeCompare(M));h.length>0?(b(kn,j([])),h.forEach((x,M)=>{const I=r().saveInds[x];if(I){if(I.mtmGroup){const D={...I.mtmGroup};M>0&&I.pane_id&&(D.actualPaneId=I.pane_id),n(kn).push(D)}else if(I.mtmGroups&&Array.isArray(I.mtmGroups)&&M===0){const D=I.mtmGroups.filter(E=>E&&typeof E.id=="string"&&typeof E.name=="string"&&typeof E.period=="number"&&E.period>0&&typeof E.color=="string"&&typeof E.thickness=="number"&&E.thickness>0&&typeof E.lineStyle=="string");b(kn,j([...D]))}}}),n(kn).length>0?console.log("✅ Loaded",n(kn).length,"MTM groups from saved data"):(console.warn("⚠️ No valid MTM groups found, creating default"),Il())):n(kn).length===0&&Il()}catch(h){console.error("❌ Error initializing MTM groups:",h),Il()}}function Il(){b(kn,j([{id:cn(),name:"MTM #1",period:14,color:"#2563eb",thickness:2,lineStyle:"solid"}])),console.log("✅ Created default MTM group")}function da(h){if(!n(ul)||n(kn).length<=1){console.warn("⚠️ Cannot remove MTM group: minimum one group required");return}try{if(!h||typeof h!="string"){console.error("❌ Invalid group ID provided for MTM group removal");return}const x=n(kn).length;b(kn,j(n(kn).filter(M=>M.id!==h))),n(kn).length<x?(console.log("✅ Removed MTM group with ID:",h),Nr()):console.warn("⚠️ MTM group not found for removal:",h)}catch(x){console.error("❌ Error removing MTM group:",x)}}function Nr(){var h;if(!(!n(ul)||!s()))try{console.log("🔄 Applying MTM changes to chart...");const x=Object.keys(r().saveInds).filter(I=>r().saveInds[I]&&r().saveInds[I].name==="MTM").sort((I,D)=>I===`${i().editPaneId}_MTM`?-1:D===`${i().editPaneId}_MTM`?1:I.localeCompare(D));console.log("🔧 Applying MTM changes. Existing keys:",x),console.log("🔧 Current MTM groups:",n(kn).length);const M=n(kn).length;if(x.length>M)for(let I=M;I<x.length;(I+=1)-1){const D=x[I],E=r().saveInds[D];if(E&&E.pane_id)try{console.log("🗑️ Removing excess MTM indicator from pane:",E.pane_id),(h=s())==null||h.removeIndicator({paneId:E.pane_id,name:"MTM"})}catch(H){console.log("❌ Error removing excess MTM indicator:",H)}}n(kn).forEach((I,D)=>{var ue,Fe,it;const E=[I.period],H={lines:[{color:I.color,size:I.thickness,style:I.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:I.lineStyle==="dashed"?[4,4]:I.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(D===0)console.log("🔄 Updating first MTM in pane:",i().editPaneId),(ue=s())==null||ue.overrideIndicator({name:"MTM",calcParams:E,styles:H,paneId:i().editPaneId});else{const yo=`pane_MTM_${D+1}_MTM`,ao=x.find(Et=>Et===yo);if(ao){const Et=r().saveInds[ao];Et&&Et.pane_id&&(console.log("🔄 Updating existing MTM in pane:",Et.pane_id),(Fe=s())==null||Fe.overrideIndicator({name:"MTM",calcParams:E,styles:H,paneId:Et.pane_id}),I.actualPaneId=Et.pane_id)}else{const Et=`pane_MTM_${D+1}`;console.log("🆕 Creating new MTM in pane:",Et);const Ls=(it=s())==null?void 0:it.createIndicator({name:"MTM",calcParams:E,styles:H},!0,{id:Et,axis:{gap:{bottom:2}}});Ls&&(I.actualPaneId=Et,console.log("✅ Created new MTM indicator with ID:",Ls,"in pane:",Et))}}}),d.update(I=>{try{Object.keys(I.saveInds).forEach(D=>{I.saveInds[D]&&I.saveInds[D].name==="MTM"&&delete I.saveInds[D]}),n(kn).forEach((D,E)=>{try{const H=E===0?`${i().editPaneId}_MTM`:`pane_MTM_${E+1}_MTM`,ue=E===0?i().editPaneId:D.actualPaneId||`pane_MTM_${E+1}`;if(!H||!ue){console.error(`❌ Invalid save key or pane ID for MTM group ${E}`);return}const Fe={name:"MTM",mtmGroup:D,pane_id:ue,groupIndex:E,mtmGroups:E===0?[...n(kn)]:void 0,params:[D.period]};I.saveInds[H]=Fe,console.log("💾 Saved MTM group",E,"with key:",H,"and pane ID:",ue)}catch(H){console.error(`❌ Error saving MTM group ${E}:`,H)}})}catch(D){console.error("❌ Error in MTM save operation:",D)}return I}),console.log("✅ MTM changes applied successfully")}catch(x){console.error("❌ Critical error in applyMtm:",x)}}function _i(){if(!n(at))return;const h=`${i().editPaneId}_WR`,x=r().saveInds[h];if(x&&x.wrGroups&&x.wrGroups.length>0){b(jt,j([...x.wrGroups]));return}const M=[];Object.keys(r().saveInds).forEach(I=>{if((I.includes("_WR")||I.startsWith("WR_"))&&I!==h){const D=r().saveInds[I];D&&D.wrGroup&&M.push(D.wrGroup)}}),x&&x.wrGroup&&M.unshift(x.wrGroup),M.length>0?b(jt,j([...M])):n(jt).length===0&&b(jt,j([{id:cn(),period:14,overboughtLevel:-20,middleLevel:-50,oversoldLevel:-80,paneId:i().editPaneId,styles:{wr:{color:"#2563eb",thickness:1,lineStyle:"solid"},overbought:{color:"#EF4444",thickness:1,lineStyle:"solid"},oversold:{color:"#10B981",thickness:1,lineStyle:"solid"},middleLine:{color:"#6B7280",thickness:1,lineStyle:"solid"}}}]))}function Wl(){if(!n(at))return;const h=`pane_WR_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,x={id:cn(),period:14,overboughtLevel:-20,middleLevel:-50,oversoldLevel:-80,paneId:h,styles:{wr:{color:"#2563eb",thickness:1,lineStyle:"solid"},overbought:{color:"#EF4444",thickness:1,lineStyle:"solid"},oversold:{color:"#10B981",thickness:1,lineStyle:"solid"},middleLine:{color:"#6B7280",thickness:1,lineStyle:"solid"}}};if(n(jt).push(x),f_.createInstance(h,{period:x.period,lineColor:x.styles.wr.color,lineThickness:x.styles.wr.thickness,lineStyle:x.styles.wr.lineStyle,levels:[{id:"overbought",value:x.overboughtLevel,color:x.styles.overbought.color,lineStyle:x.styles.overbought.lineStyle,thickness:x.styles.overbought.thickness,label:"Overbought",visible:!0},{id:"middle",value:x.middleLevel,color:x.styles.middleLine.color,lineStyle:x.styles.middleLine.lineStyle,thickness:x.styles.middleLine.thickness,label:"Middle",visible:!0},{id:"oversold",value:x.oversoldLevel,color:x.styles.oversold.color,lineStyle:x.styles.oversold.lineStyle,thickness:x.styles.oversold.thickness,label:"Oversold",visible:!0}]}),s()){let M=Ee.Solid,I=[2,2];if(x.styles.wr.lineStyle==="dashed"?(M=Ee.Dashed,I=[4,4]):x.styles.wr.lineStyle==="dotted"&&(M=Ee.Dashed,I=[2,2]),s().createIndicator({name:"WR",calcParams:[x.period],styles:{lines:[{color:x.styles.wr.color,size:x.styles.wr.thickness,style:M,dashedValue:I}]}},!1,{id:h})){const E=`${h}_WR`;d.update(H=>(H.saveInds[E]={name:"WR",pane_id:h,params:[x.period]},H))}}console.log("➕ Added new WR group in new pane:",x.id,h)}function Zi(h){if(!n(at)||n(jt).length<=1)return;const x=n(jt).find(I=>I.id===h);if(!x)return;n(jt).findIndex(I=>I.id===h);const M=x.paneId;b(jt,j(n(jt).filter(I=>I.id!==h))),M&&f_.deleteInstance(M),M&&Li(M,"WR"),console.log("🗑️ Removed WR group from pane:",M)}function ol(h){if(!n(at)||!s()||h<0||h>=n(jt).length)return;const x=n(jt)[h],M=x.paneId||i().editPaneId;console.log("🔄 Updating WR indicator:",h,M);try{f_.updateInstance(M,{period:x.period,lineColor:x.styles.wr.color,lineThickness:x.styles.wr.thickness,lineStyle:x.styles.wr.lineStyle,enableDynamicColoring:!0,overboughtColor:x.styles.overbought.color||"#EF4444",oversoldColor:x.styles.oversold.color||"#10B981",overboughtThreshold:x.overboughtLevel,oversoldThreshold:x.oversoldLevel,levels:[{id:"overbought",value:x.overboughtLevel,color:x.styles.overbought.color||"#EF4444",lineStyle:x.styles.overbought.lineStyle,thickness:x.styles.overbought.thickness,label:"Overbought",visible:!0},{id:"middle",value:x.middleLevel,color:x.styles.middleLine.color||"#6B7280",lineStyle:x.styles.middleLine.lineStyle,thickness:x.styles.middleLine.thickness,label:"Middle",visible:!0},{id:"oversold",value:x.oversoldLevel,color:x.styles.oversold.color||"#10B981",lineStyle:x.styles.oversold.lineStyle,thickness:x.styles.oversold.thickness,label:"Oversold",visible:!0}]}),s().removeIndicator({paneId:M,name:"WR"});let I=Ee.Solid,D=[2,2];if(x.styles.wr.lineStyle==="dashed"?(I=Ee.Dashed,D=[4,4]):x.styles.wr.lineStyle==="dotted"&&(I=Ee.Dashed,D=[2,2]),s().createIndicator({name:"WR",calcParams:[x.period],styles:{lines:[{color:x.styles.wr.color,size:x.styles.wr.thickness,style:I,dashedValue:D}]}},M===i().editPaneId,{id:M})){const H=`${M}_WR`;d.update(ue=>(ue.saveInds[H]={name:"WR",pane_id:M,params:[x.period]},ue))}console.log("✅ WR indicator and levels updated successfully")}catch(I){console.error("❌ Error updating WR indicator:",I)}}function Ys(){if(!n(So))return;const h=Object.entries(r().saveInds).filter(([x,M])=>M.name==="VR");if(h.length>0)b(Co,j(h.map(([x,M])=>{var I,D,E;return M.vrGroups&&M.vrGroups.length>0?M.vrGroups[0]:M.vrGroup?M.vrGroup:{id:cn(),paneId:M.pane_id,period:((I=M.params)==null?void 0:I[0])||26,shortPeriod:((D=M.params)==null?void 0:D[1])||6,longPeriod:((E=M.params)==null?void 0:E[2])||12,styles:{vr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},vrShort:{color:"#2196F3",thickness:1,lineStyle:"solid"},vrLong:{color:"#4CAF50",thickness:1,lineStyle:"solid"}}}}))),console.log("✅ Loaded VR groups from save system:",n(Co).length);else if(n(Co).length===0){const x={id:cn(),paneId:i().editPaneId,period:26,shortPeriod:6,longPeriod:12,styles:{vr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},vrShort:{color:"#2196F3",thickness:1,lineStyle:"solid"},vrLong:{color:"#4CAF50",thickness:1,lineStyle:"solid"}}};b(Co,j([x])),console.log("✅ Created default VR group with pane ID:",i().editPaneId)}}function Ld(){if(!n(on))return;const h=Object.entries(r().saveInds).filter(([x,M])=>M.name==="VOL");if(h.length>0)b(Ce,j(h.map(([x,M])=>{var I,D,E,H,ue;if(M.volGroups&&M.volGroups.length>0){const Fe=M.volGroups[0];return{...Fe,paneId:"candle_pane",styles:{...Fe.styles,ema:{visible:((D=(I=Fe.styles)==null?void 0:I.ema)==null?void 0:D.visible)??!1,...Fe.styles.ema}}}}else if(M.volGroup){const Fe=M.volGroup;return{...Fe,paneId:"candle_pane",styles:{...Fe.styles,ema:{visible:((H=(E=Fe.styles)==null?void 0:E.ema)==null?void 0:H.visible)??!1,...Fe.styles.ema}}}}else return{id:cn(),paneId:"candle_pane",period:((ue=M.params)==null?void 0:ue[0])||20,styles:{histogram:{upColor:"#26a69a",downColor:"#ef5350",thickness:1,lineStyle:"solid"},ema:{color:"#8B5CF6",thickness:1,lineStyle:"dotted",visible:!1}}}}))),console.log("✅ Loaded Volume groups from save system:",n(Ce).length);else if(n(Ce).length===0){const x={id:cn(),paneId:"candle_pane",period:20,styles:{histogram:{upColor:"#26a69a",downColor:"#ef5350",thickness:1,lineStyle:"solid"},ema:{color:"#8B5CF6",thickness:1,lineStyle:"dotted",visible:!1}}};b(Ce,j([x])),console.log("✅ Created default Volume group:",x)}}function Jc(){if(!n(So))return;const h=`pane_VR_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,x={id:cn(),paneId:h,period:26,shortPeriod:6,longPeriod:12,styles:{vr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},vrShort:{color:"#2196F3",thickness:1,lineStyle:"solid"},vrLong:{color:"#4CAF50",thickness:1,lineStyle:"solid"}}};if(n(Co).push(x),s()){let M=Ee.Solid,I=[2,2];if(x.styles.vr.lineStyle==="dashed"?(M=Ee.Dashed,I=[4,4]):x.styles.vr.lineStyle==="dotted"&&(M=Ee.Dashed,I=[2,2]),s().createIndicator({name:"VR",calcParams:[x.period,x.shortPeriod,x.longPeriod],styles:{lines:[{color:x.styles.vr.color,size:x.styles.vr.thickness,style:M,dashedValue:I}]}},!1,{id:h})){const E=`${h}_VR`;d.update(H=>(H.saveInds[E]={name:"VR",pane_id:h,params:[x.period,x.shortPeriod,x.longPeriod]},H))}}console.log("➕ Added new VR group in new pane:",x.id,h)}function xl(h){if(!n(So)||n(Co).length<=1||h<0||h>=n(Co).length)return;console.log("🗑️ Removing VR group at index:",h);const M=n(Co)[h].paneId,I=n(Co).length;if(n(Co).splice(h,1),console.log(`📝 Removed group: ${I} -> ${n(Co).length}`),s()&&M)try{console.log("🗑️ Removing VR from pane:",M),Li(M,"VR")}catch(D){console.error("❌ Error removing VR indicator:",D)}console.log("✅ VR group removed. Remaining groups:",n(Co).length),console.log("🗑️ Removed VR group from list (will be applied on confirm)")}function $l(h){if(!n(on)||n(Ce).length<=1||h<0||h>=n(Ce).length)return;console.log("🗑️ Removing Volume group at index:",h),n(Ce)[h];const x="candle_pane",M=n(Ce).length;if(n(Ce).splice(h,1),console.log(`📝 Removed group: ${M} -> ${n(Ce).length}`),s()&&x)try{console.log("🗑️ Removing Volume from pane:",x),Li(x,"VOL")}catch(I){console.error("❌ Error removing Volume indicator:",I)}console.log("✅ Volume group removed. Remaining groups:",n(Ce).length),console.log("🗑️ Removed Volume group from list (will be applied on confirm)")}function ba(h){if(i().editIndName!=="VR"||!s()||h<0||h>=n(Co).length)return;const x=n(Co)[h],M=x.paneId||i().editPaneId;console.log("🔄 Updating VR indicator:",h,M);try{s().removeIndicator({paneId:M,name:"VR"});const I=Fe=>{switch(Fe){case"dashed":return{style:Ee.Dashed,dashedValue:[4,4]};case"dotted":return{style:Ee.Dashed,dashedValue:[2,2]};default:return{style:Ee.Solid,dashedValue:[2,2]}}},D=I(x.styles.vr.lineStyle),E=I(x.styles.vrShort.lineStyle),H=I(x.styles.vrLong.lineStyle);if(s().createIndicator({name:"VR",calcParams:[x.period,x.shortPeriod,x.longPeriod],styles:{lines:[{color:x.styles.vr.color,size:x.styles.vr.thickness,style:D.style,dashedValue:D.dashedValue},{color:x.styles.vrShort.color,size:x.styles.vrShort.thickness,style:E.style,dashedValue:E.dashedValue},{color:x.styles.vrLong.color,size:x.styles.vrLong.thickness,style:H.style,dashedValue:H.dashedValue}]}},M===i().editPaneId,{id:M})){const Fe=`${M}_VR`;d.update(it=>(it.saveInds[Fe]={name:"VR",pane_id:M,params:[x.period,x.shortPeriod,x.longPeriod]},it))}console.log("✅ VR indicator updated successfully")}catch(I){console.error("❌ Error updating VR indicator:",I)}}function Qr(h){if(i().editIndName!=="VOL"||!s()||h<0||h>=n(Ce).length)return;const x=n(Ce)[h],M="candle_pane";try{console.log("🔄 Updating Volume indicator for group:",h,"paneId:",M),s().removeIndicator({paneId:M,name:"VOL"});let I=Ee.Solid,D=[2,2];if(x.styles.ema.lineStyle==="dashed"?(I=Ee.Dashed,D=[4,4]):x.styles.ema.lineStyle==="dotted"&&(I=Ee.Dashed,D=[2,2]),console.log("updateVolIndicator - Colors being applied:",{upColor:x.styles.histogram.upColor,downColor:x.styles.histogram.downColor,noChangeColor:x.styles.histogram.upColor,emaColor:x.styles.ema.color}),s().createIndicator({name:"VOL",calcParams:[x.period],styles:{bars:[{upColor:x.styles.histogram.upColor,downColor:x.styles.histogram.downColor,noChangeColor:x.styles.histogram.upColor}],lines:[{color:x.styles.ema.color,size:x.styles.ema.thickness,style:I,dashedValue:D}]}},!0,{id:M})){const H=`${M}_VOL`;d.update(ue=>(ue.saveInds[H]={name:"VOL",pane_id:M,params:[x.period],volGroup:x},ue))}console.log("✅ Volume indicator updated successfully")}catch(I){console.error("❌ Error updating Volume indicator:",I)}}function Fi(h){if(i().editIndName!=="BBI"||!s()||h<0||h>=n(Ho).length)return;const x=n(Ho)[h],M=x.paneId||i().editPaneId;console.log("🔄 Updating BBI indicator:",h,M);try{s().removeIndicator({paneId:M,name:"BBI"});const D=(H=>{switch(H){case"dashed":return{style:Ee.Dashed,dashedValue:[4,4]};case"dotted":return{style:Ee.Dashed,dashedValue:[2,2]};default:return{style:Ee.Solid,dashedValue:[2,2]}}})(x.lineStyle);if(s().createIndicator({name:"BBI",calcParams:[x.period1,x.period2,x.period3,x.period4],styles:{lines:[{color:x.color,size:x.thickness,style:D.style,dashedValue:D.dashedValue}]}},M===i().editPaneId,{id:M})){const H=`${M}_BBI`;d.update(ue=>(ue.saveInds[H]={name:"BBI",pane_id:M,params:[x.period1,x.period2,x.period3,x.period4],bbiGroup:x},ue))}console.log("✅ BBI indicator updated successfully")}catch(I){console.error("❌ Error updating BBI indicator:",I)}}function Hs(){if(!(i().editIndName!=="EMA"||!s()))try{console.log("🔄 Updating EMA indicator"),s().removeIndicator({paneId:i().editPaneId,name:"EMA"});const h=s().createIndicator({name:"EMA",calcParams:p,styles:{lines:p.map((x,M)=>{const I=y[M];let D=Ee.Solid,E=[2,2];return(I==null?void 0:I.lineStyle)==="dashed"?(D=Ee.Dashed,E=[4,4]):(I==null?void 0:I.lineStyle)==="dotted"&&(D=Ee.Dashed,E=[2,2]),{color:(I==null?void 0:I.color)||"#FF6B6B",size:(I==null?void 0:I.thickness)||1,style:D,dashedValue:E}})}},!0,{id:i().editPaneId});console.log("✅ EMA indicator updated successfully")}catch(h){console.error("❌ Error updating EMA indicator:",h)}}function xa(){if(!(i().editIndName!=="MA"||!s()))try{console.log("🔄 Updating MA indicator"),s().removeIndicator({paneId:i().editPaneId,name:"MA"});const h=s().createIndicator({name:"MA",calcParams:p,styles:{lines:p.map((M,I)=>{const D=y[I];let E=Ee.Solid,H=[2,2];return(D==null?void 0:D.lineStyle)==="dashed"?(E=Ee.Dashed,H=[4,4]):(D==null?void 0:D.lineStyle)==="dotted"&&(E=Ee.Dashed,H=[2,2]),{color:(D==null?void 0:D.color)||"#2563eb",size:(D==null?void 0:D.thickness)||1,style:E,dashedValue:H}})}},!0,{id:i().editPaneId}),x=`${i().editPaneId}_MA`;d.update(M=>(M.saveInds[x]&&(M.saveInds[x].params=[...p],M.saveInds[x].styles=y.map(I=>({...I}))),M)),console.log("✅ MA indicator updated successfully")}catch(h){console.error("❌ Error updating MA indicator:",h)}}function gi(){var M,I,D;if(!n(us))return;const h=`${i().editPaneId}_SMA`,x=r().saveInds[h];x&&x.smaGroups&&x.smaGroups.length>0?(b(Yo,j([...x.smaGroups])),console.log("✅ Loaded",n(Yo).length,"SMA groups from saved data")):x&&x.params&&x.params.length>0&&x.styles?(b(Yo,j([{id:cn(),name:"SMA",period:x.params[0]||20,color:((M=x.styles[0])==null?void 0:M.color)||"#FF6C37",thickness:((I=x.styles[0])==null?void 0:I.thickness)||2,lineStyle:((D=x.styles[0])==null?void 0:D.lineStyle)||"solid"}])),console.log("✅ Loaded SMA from saved data (old format)")):n(Yo).length===0&&(b(Yo,j([{id:cn(),name:"SMA",period:20,color:"#FF6C37",thickness:2,lineStyle:"solid"}])),console.log("✅ Created default SMA group"))}function Qc(h){var x,M;if(!(i().editIndName!=="SMA"||!s()||n(Yo).length===0||h>=n(Yo).length))try{console.log("🔄 Updating SMA indicator at index:",h);const I=n(Yo)[h],E=((x=s())==null?void 0:x.getIndicators()).filter(ue=>ue.name==="SMA");for(const ue of E)(M=s())==null||M.removeIndicator({paneId:ue.paneId,name:"SMA"});n(Yo).forEach((ue,Fe)=>{var ao;let it=Ee.Solid,yo=[2,2];ue.lineStyle==="dashed"?(it=Ee.Dashed,yo=[8,4]):ue.lineStyle==="dotted"&&(it=Ee.Dashed,yo=[2,2]),(ao=s())==null||ao.createIndicator({name:"SMA",calcParams:[ue.period],styles:{lines:[{color:ue.color,size:ue.thickness,style:it,dashedValue:yo}]}},!0,{id:i().editPaneId})});const H=`${i().editPaneId}_SMA`;d.update(ue=>(ue.saveInds[H]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(Yo).map(Fe=>({...Fe}))},ue)),console.log("✅ SMA indicators updated successfully")}catch(I){console.error("❌ Error updating SMA indicator:",I)}}function Hu(){if(!n(us))return;const h=n(Yo).length>0?n(Yo)[n(Yo).length-1].period+10:20,x=["#FF6C37","#2563eb","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899"],M=x[n(Yo).length%x.length],I={id:cn(),name:"SMA",period:h,color:M,thickness:2,lineStyle:"solid"};if(n(Yo).push(I),s()){s().createIndicator({name:"SMA",calcParams:[I.period],styles:{lines:[{color:I.color,size:I.thickness,style:Ee.Solid,dashedValue:[2,2]}]}},!0,{id:i().editPaneId});const D=`${i().editPaneId}_SMA`;d.update(E=>(E.saveInds[D]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(Yo).map(H=>({...H}))},E))}console.log("➕ Added new SMA group:",I)}function ed(h){var x,M;if(!(!n(us)||n(Yo).length<=1||h<0||h>=n(Yo).length)&&(console.log("🗑️ Removing SMA group at index:",h),n(Yo).splice(h,1),s()))try{const D=((x=s())==null?void 0:x.getIndicators()).filter(H=>H.name==="SMA");for(const H of D)(M=s())==null||M.removeIndicator({paneId:H.paneId,name:"SMA"});n(Yo).forEach(H=>{var it;let ue=Ee.Solid,Fe=[2,2];H.lineStyle==="dashed"?(ue=Ee.Dashed,Fe=[8,4]):H.lineStyle==="dotted"&&(ue=Ee.Dashed,Fe=[2,2]),(it=s())==null||it.createIndicator({name:"SMA",calcParams:[H.period],styles:{lines:[{color:H.color,size:H.thickness,style:ue,dashedValue:Fe}]}},!0,{id:i().editPaneId})});const E=`${i().editPaneId}_SMA`;d.update(H=>(n(Yo).length>0?H.saveInds[E]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(Yo).map(ue=>({...ue}))}:delete H.saveInds[E],H)),console.log("✅ SMA group removed and chart updated")}catch(I){console.error("❌ Error removing SMA group:",I)}}function td(){var h,x;if(n(us)){console.log("🔧 SMA Confirm: Saving",n(Yo).length,"SMA groups");try{const M=(h=s())==null?void 0:h.getIndicators(),I=(M==null?void 0:M.filter(E=>E.name==="SMA"))||[];for(const E of I)(x=s())==null||x.removeIndicator({paneId:E.paneId,name:"SMA"});n(Yo).forEach(E=>{var Fe;let H=Ee.Solid,ue=[2,2];E.lineStyle==="dashed"?(H=Ee.Dashed,ue=[8,4]):E.lineStyle==="dotted"&&(H=Ee.Dashed,ue=[2,2]),(Fe=s())==null||Fe.createIndicator({name:"SMA",calcParams:[E.period],styles:{lines:[{color:E.color,size:E.thickness,style:H,dashedValue:ue}]}},!0,{id:i().editPaneId}),console.log("✅ Created SMA with period:",E.period)});const D=`${i().editPaneId}_SMA`;d.update(E=>(E.saveInds[D]={name:"SMA",pane_id:i().editPaneId,smaGroups:n(Yo).map(H=>({...H}))},console.log("💾 Saved",n(Yo).length,"SMA groups to:",D),E)),console.log("✅ SMA confirm completed successfully"),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E))}catch(M){console.error("❌ Error in SMA confirm:",M)}}}function Xd(){if(!n(qt))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="BBI").sort((x,M)=>x===`${i().editPaneId}_BBI`?-1:M===`${i().editPaneId}_BBI`?1:x.localeCompare(M));console.log("🔍 Found existing BBI keys:",h),h.length>0?(b(Ho,j([])),h.forEach((x,M)=>{const I=r().saveInds[x];if(I){const D=I.pane_id||x.replace("_BBI","");if(I.bbiGroup){const E={...I.bbiGroup};E.paneId||(E.paneId=D),n(Ho).push(E)}else I.params&&I.params.length===4&&n(Ho).push({id:cn(),name:`BBI${M+1}`,paneId:D,period1:I.params[0]||3,period2:I.params[1]||6,period3:I.params[2]||12,period4:I.params[3]||24,color:"#8B5CF6",thickness:1,lineStyle:"solid"})}}),console.log("✅ Loaded",n(Ho).length,"existing BBI groups")):n(Ho).length===0&&(b(Ho,j([{id:cn(),name:"BBI",paneId:i().editPaneId,period1:3,period2:6,period3:12,period4:24,color:"#8B5CF6",thickness:1,lineStyle:"solid"}])),console.log("🆕 Created default BBI group"))}function Mr(){if(!n(qt))return;const h=`pane_BBI_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,x=n(Ho).length+1,M={id:cn(),name:`BBI${x}`,paneId:h,period1:3,period2:6,period3:12,period4:24,color:"#8B5CF6",thickness:1,lineStyle:"solid"};if(n(Ho).push(M),s()){const D=(H=>{switch(H){case"dashed":return{style:Ee.Dashed,dashedValue:[4,4]};case"dotted":return{style:Ee.Dashed,dashedValue:[2,2]};default:return{style:Ee.Solid,dashedValue:[2,2]}}})(M.lineStyle);if(s().createIndicator({name:"BBI",calcParams:[M.period1,M.period2,M.period3,M.period4],styles:{lines:[{color:M.color,size:M.thickness,style:D.style,dashedValue:D.dashedValue}]}},!1,{id:h})){const H=`${h}_BBI`;d.update(ue=>(ue.saveInds[H]={name:"BBI",pane_id:h,params:[M.period1,M.period2,M.period3,M.period4],bbiGroup:M},ue))}}console.log("➕ Added new BBI group in new pane:",M.id,h)}function Pa(h){var D;if(!n(qt)||n(Ho).length<=1)return;const x=n(Ho).findIndex(E=>E.id===h);if(x===-1)return;const M=n(Ho)[x];console.log("🗑️ Removing BBI group at index:",x,"ID:",h,"paneId:",M.paneId);const I=M.paneId||(x===0?i().editPaneId:null);if(s()&&I){try{console.log("🗑️ Removing BBI from pane:",I),(D=s())==null||D.removeIndicator({paneId:I,name:"BBI"}),console.log("✅ Successfully removed BBI from pane:",I)}catch(E){console.log("❌ Error removing BBI indicator from pane:",I,E)}d.update(E=>{const H=`${I}_BBI`;return console.log("🧹 Cleaning saved state key:",H),delete E.saveInds[H],E})}else console.log("❌ Cannot remove BBI: no valid paneId found for group:",M);b(Ho,j(n(Ho).filter(E=>E.id!==h))),console.log("✅ BBI group removed from array. Remaining groups:",n(Ho).length)}function Ma(){if(!n(Ci))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="TRIX").sort((x,M)=>x===`${i().editPaneId}_TRIX`?-1:M===`${i().editPaneId}_TRIX`?1:x.localeCompare(M));console.log("🔍 Found existing TRIX keys:",h),h.length>0?(b(Ws,j([])),h.forEach((x,M)=>{const I=r().saveInds[x];if(I)if(I.trixGroup){const D={...I.trixGroup};D.paneId||(D.paneId=I.pane_id||i().editPaneId),n(Ws).push(D)}else I.params&&I.params.length>=2&&n(Ws).push({id:cn(),name:`TRIX${M+1}`,trixPeriod:I.params[0]||15,signalPeriod:I.params[1]||9,paneId:I.pane_id||i().editPaneId,styles:{trix:{color:"#2563eb",thickness:2,lineStyle:"solid"},signal:{color:"#dc2626",thickness:1,lineStyle:"solid"}}})}),console.log("✅ Loaded",n(Ws).length,"existing TRIX groups")):n(Ws).length===0&&(b(Ws,j([{id:cn(),name:"TRIX",trixPeriod:15,signalPeriod:9,paneId:i().editPaneId,styles:{trix:{color:"#2563eb",thickness:2,lineStyle:"solid"},signal:{color:"#dc2626",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default TRIX group"))}function wl(){if(!n(Ci))return;const h=`pane_TRIX_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,x={id:cn(),name:`TRIX${n(Ws).length+1}`,trixPeriod:15,signalPeriod:9,paneId:h,styles:{trix:{color:"#2563eb",thickness:2,lineStyle:"solid"},signal:{color:"#dc2626",thickness:1,lineStyle:"solid"}}};if(n(Ws).push(x),s()){let M=Ee.Solid,I=[2,2],D=Ee.Solid,E=[2,2];if(x.styles.trix.lineStyle==="dashed"?(M=Ee.Dashed,I=[4,4]):x.styles.trix.lineStyle==="dotted"&&(M=Ee.Dashed,I=[2,2]),x.styles.signal.lineStyle==="dashed"?(D=Ee.Dashed,E=[4,4]):x.styles.signal.lineStyle==="dotted"&&(D=Ee.Dashed,E=[2,2]),s().createIndicator({name:"TRIX",calcParams:[x.trixPeriod,x.signalPeriod],styles:{lines:[{color:x.styles.trix.color,size:x.styles.trix.thickness,style:M,dashedValue:I},{color:x.styles.signal.color,size:x.styles.signal.thickness,style:D,dashedValue:E}]}},!1,{id:h})){const ue=`${h}_TRIX`;d.update(Fe=>(Fe.saveInds[ue]={name:"TRIX",pane_id:h,params:[x.trixPeriod,x.signalPeriod]},Fe))}}console.log("➕ Added new TRIX group in new pane:",x.id,h)}function ga(h){if(!n(Ci)||n(Ws).length<=1||h<0||h>=n(Ws).length)return;console.log("🗑️ Removing TRIX group at index:",h);const M=n(Ws)[h].paneId||i().editPaneId,I=n(Ws).length;if(n(Ws).splice(h,1),console.log(`📝 Removed group: ${I} -> ${n(Ws).length}`),s()&&M)try{console.log("🗑️ Removing TRIX from pane:",M),Li(M,"TRIX")}catch(D){console.error("❌ Error removing TRIX indicator:",D)}console.log("✅ TRIX group removed. Remaining groups:",n(Ws).length)}function Ml(){if(!n(Ki))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="BIAS").sort((x,M)=>x===`${i().editPaneId}_BIAS`?-1:M===`${i().editPaneId}_BIAS`?1:x.localeCompare(M));console.log("🔍 Found existing BIAS keys:",h),h.length>0?(b(Ot,j([])),h.forEach((x,M)=>{const I=r().saveInds[x];I&&(I.biasGroup?n(Ot).push({...I.biasGroup}):I.params&&I.params.length>=1&&n(Ot).push({id:cn(),name:`BIAS${M+1}`,period:I.params[0]||6,color:"#2196F3",thickness:1,lineStyle:"solid"}))}),console.log("✅ Loaded",n(Ot).length,"existing BIAS groups")):n(Ot).length===0&&(b(Ot,j([{id:cn(),name:"BIAS",period:6,color:"#2196F3",thickness:1,lineStyle:"solid"}])),console.log("🆕 Created default BIAS group"))}function fc(){var M;if(!n(Ki)||!s())return;console.log("🔄 Applying BIAS changes in real-time, groups:",n(Ot).length);const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="BIAS").sort((I,D)=>I===`${i().editPaneId}_BIAS`?-1:D===`${i().editPaneId}_BIAS`?1:I.localeCompare(D));console.log("🔍 Existing BIAS keys:",h);const x=n(Ot).length;if(h.length>x){console.log(`🗑️ Removing ${h.length-x} excess BIAS indicators`);for(let I=x;I<h.length;(I+=1)-1){const D=h[I],E=r().saveInds[D];if(E&&E.pane_id){console.log("🗑️ Removing BIAS indicator from pane:",E.pane_id);try{(M=s())==null||M.removeIndicator({paneId:E.pane_id,name:"BIAS"})}catch(H){console.log("Error removing excess BIAS indicator:",H)}}}}n(Ot).forEach((I,D)=>{var ue,Fe,it;const E=[I.period],H={lines:[{color:I.color,size:I.thickness,style:I.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:I.lineStyle==="dashed"?[4,4]:I.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(D===0)console.log("🔄 Updating first BIAS indicator in pane:",i().editPaneId),(ue=s())==null||ue.overrideIndicator({name:"BIAS",calcParams:E,styles:H,paneId:i().editPaneId});else{const yo=`pane_BIAS_${D+1}_BIAS`,ao=h.find(Et=>Et===yo);if(ao){const Et=r().saveInds[ao];Et&&Et.pane_id&&(console.log(`🔄 Updating existing BIAS ${D+1} in pane:`,Et.pane_id),(Fe=s())==null||Fe.overrideIndicator({name:"BIAS",calcParams:E,styles:H,paneId:Et.pane_id}))}else{const Et=`pane_BIAS_${D+1}`;console.log(`🆕 Creating new BIAS ${D+1} with pane ID:`,Et),(it=s())==null||it.createIndicator({name:"BIAS",calcParams:E,styles:H},!0,{id:Et})}}}),d.update(I=>(Object.keys(I.saveInds).forEach(D=>{I.saveInds[D].name==="BIAS"&&delete I.saveInds[D]}),n(Ot).forEach((D,E)=>{const H=E===0?`${i().editPaneId}_BIAS`:`pane_BIAS_${E+1}_BIAS`,ue=E===0?i().editPaneId:`pane_BIAS_${E+1}`;console.log(`💾 Saving BIAS group ${E+1} with key:`,H),I.saveInds[H]={name:"BIAS",biasGroup:D,pane_id:ue,groupIndex:E,biasGroups:E===0?[...n(Ot)]:void 0,params:[D.period]}}),I))}function rp(h){if(!n(Ki)||n(Ot).length<=1)return;const x=n(Ot).findIndex(M=>M.id===h);x!==-1&&(console.log("🗑️ Removing BIAS group at index:",x,"ID:",h),b(Ot,j(n(Ot).filter(M=>M.id!==h))),fc(),console.log("✅ BIAS group removed. Remaining groups:",n(Ot).length))}function au(){if(!n(Cl))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="CCI").sort((x,M)=>x===`${i().editPaneId}_CCI`?-1:M===`${i().editPaneId}_CCI`?1:x.localeCompare(M));if(console.log("🔍 Found existing CCI keys:",h),h.length>0){b(Pi,j([]));let x=1;h.forEach((M,I)=>{const D=r().saveInds[M];if(D)if(D.cciGroup){const E={...D.cciGroup};E.name=x===1?"CCI":`CCI${x}`,n(Pi).push(E),x+=1}else D.params&&D.params.length>=1&&(n(Pi).push({id:cn(),name:x===1?"CCI":`CCI${x}`,period:D.params[0]||14,color:"#FF9800",thickness:1,lineStyle:"solid"}),x+=1)}),console.log("✅ Loaded",n(Pi).length,"existing CCI groups with proper naming")}else n(Pi).length===0&&(b(Pi,j([{id:cn(),name:"CCI",period:14,color:"#FF9800",thickness:1,lineStyle:"solid"}])),console.log("🆕 Created default CCI group"))}function ud(){if(!n(Cl)||!s())return;console.log("🔄 Applying CCI changes in real-time, groups:",n(Pi).length);const h=Object.keys(r().saveInds).filter(E=>r().saveInds[E].name==="CCI").sort((E,H)=>E===`${i().editPaneId}_CCI`?-1:H===`${i().editPaneId}_CCI`?1:E.localeCompare(H));console.log("🔍 Existing CCI keys:",h);const x=new Map,M=new Set;n(Pi).forEach((E,H)=>{let ue=null;for(const Fe of h){if(M.has(Fe))continue;const it=r().saveInds[Fe];if(it&&it.cciGroup&&it.cciGroup.id===E.id){ue=Fe,M.add(Fe);break}}if(!ue){if(H===0&&!M.has(`${i().editPaneId}_CCI`))ue=`${i().editPaneId}_CCI`;else{let Fe=2;for(;M.has(`pane_CCI_${Fe}_CCI`)||h.includes(`pane_CCI_${Fe}_CCI`);)Fe+=1;ue=`pane_CCI_${Fe}_CCI`}M.add(ue)}x.set(E.id,ue)});const I=Array.from(x.values()),D=h.filter(E=>!I.includes(E));D.forEach(E=>{var ue;const H=r().saveInds[E];if(H&&H.pane_id){console.log("🗑️ Removing CCI indicator from pane:",H.pane_id,"key:",E);try{(ue=s())==null||ue.removeIndicator({paneId:H.pane_id,name:"CCI"})}catch(Fe){console.log("Error removing excess CCI indicator:",Fe)}}}),n(Pi).forEach((E,H)=>{var ao,Et;const ue=[E.period],Fe=x.get(E.id),it={lines:[{color:E.color,size:E.thickness,style:E.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.lineStyle==="dashed"?[4,4]:E.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},yo=h.includes(Fe)?r().saveInds[Fe]:null;if(yo&&yo.pane_id)console.log("🔄 Updating existing CCI in pane:",yo.pane_id),(ao=s())==null||ao.overrideIndicator({name:"CCI",calcParams:ue,styles:it,paneId:yo.pane_id});else{const Ls=Fe===`${i().editPaneId}_CCI`?i().editPaneId:Fe.replace("_CCI","");console.log("🆕 Creating new CCI with pane ID:",Ls,"key:",Fe),(Et=s())==null||Et.createIndicator({name:"CCI",calcParams:ue,styles:it},!0,{id:Ls})}}),d.update(E=>(D.forEach(H=>{delete E.saveInds[H],console.log("🗑️ Deleted save data for key:",H)}),n(Pi).forEach((H,ue)=>{const Fe=x.get(H.id),it=Fe===`${i().editPaneId}_CCI`?i().editPaneId:Fe.replace("_CCI","");console.log(`💾 Saving CCI group ${ue+1} with key:`,Fe),E.saveInds[Fe]={name:"CCI",cciGroup:H,pane_id:it,groupIndex:ue,cciGroups:ue===0?[...n(Pi)]:void 0,params:[H.period]}}),E))}function tt(h){if(!n(Cl)||n(Pi).length<=1)return;const x=n(Pi).findIndex(M=>M.id===h);x!==-1&&(console.log("🗑️ Removing CCI group at index:",x,"ID:",h),b(Pi,j(n(Pi).filter(M=>M.id!==h))),ud(),console.log("✅ CCI group removed. Remaining groups:",n(Pi).length))}function Gt(){if(!n(_s))return;const x=Object.values(r().saveInds||{}).filter(M=>(M==null?void 0:M.name)==="SAR").filter(M=>(M==null?void 0:M.pane_id)==="candle_pane");if(x.length>0){const M=x[0];M.sarGroups&&Array.isArray(M.sarGroups)&&M.sarGroups.length>0?b(is,j([...M.sarGroups])):b(is,j(x.map(I=>{const[D=.02,E=.02,H=.2]=I.params||[];return{id:cn(),start:D,increment:E,maxValue:H,color:"#2563eb",dotSize:1}})))}else b(is,j([{id:cn(),start:.02,increment:.02,maxValue:.2,color:"#2563eb",dotSize:1}]));s()&&n(is).length>0&&At()}function dt(h){!n(_s)||n(is).length<=1||(b(is,j(n(is).filter(x=>x.id!==h))),At())}function Tt(h){!n(_s)||!s()||h>=n(is).length||At()}function At(){if(!s()||!n(_s))return;const h="candle_pane";for(let x=0;x<6;(x+=1)-1)try{s().removeIndicator({paneId:h,name:"SAR"})}catch{}n(is).forEach(x=>{var D;const M=[x.start,x.increment,x.maxValue],I={lines:[{color:x.color,size:x.dotSize,style:Ee.Solid}]};(D=s())==null||D.createIndicator({name:"SAR",calcParams:M,styles:I},!0,{id:h})})}function io(){if(!n(Zl))return;const h=`${i().editPaneId}_SMARTTREND`,x=r().saveInds[h];if(x&&x.superTrendGroups&&x.superTrendGroups.length>0)b(vs,j([...x.superTrendGroups]));else if(x&&Array.isArray(x.params)){const M=Number(x.params[0]??10),I=Number(x.params[1]??3);b(vs,j([{id:cn(),period:M,multiplier:I,showLabels:!0,styles:{uptrend:{color:"#00FF00",thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}}]))}else n(vs).length===0&&b(vs,j([{id:cn(),period:10,multiplier:3,showLabels:!0,styles:{uptrend:{color:"#00FF00",thickness:1,lineStyle:"dashed"},downtrend:{color:"#FF0000",thickness:1,lineStyle:"dashed"}}}]));$o()}function co(h){!n(Zl)||n(vs).length<=1||(b(vs,j(n(vs).filter(x=>x.id!==h))),$o())}function wo(h){!n(Zl)||!s()||h>=n(vs).length||(n(vs)[h],$o())}function $o(){if(!s()||!n(Zl))return;const h="candle_pane";for(let x=0;x<6;(x+=1)-1)try{s().removeIndicator({paneId:h,name:"SMARTTREND"})}catch{}n(vs).forEach((x,M)=>{var E;const I=[x.period,x.multiplier],D={lines:[{color:x.styles.uptrend.color,size:x.styles.uptrend.thickness,style:x.styles.uptrend.lineStyle==="dashed"?Ee.Dashed:Ee.Solid}]};(E=s())==null||E.createIndicator({name:"SMARTTREND",calcParams:I,styles:D,extendData:{showLabels:x.showLabels,uptrendColor:x.styles.uptrend.color,downtrendColor:x.styles.downtrend.color,uptrendThickness:x.styles.uptrend.thickness,downtrendThickness:x.styles.downtrend.thickness,uptrendLineStyle:x.styles.uptrend.lineStyle,downtrendLineStyle:x.styles.downtrend.lineStyle}},!0,{id:h})}),d.update(x=>(Object.keys(x.saveInds).forEach(M=>{x.saveInds[M].name==="SMARTTREND"&&delete x.saveInds[M]}),n(vs).forEach((M,I)=>{const D=I===0?`${h}_SMARTTREND`:`${h}_SMARTTREND_${I+1}`;x.saveInds[D]={name:"SMARTTREND",pane_id:h,params:[M.period,M.multiplier],superTrendGroup:M,groupIndex:I}}),x))}function ws(){if(!n(In))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="DMI").sort((x,M)=>x===`${i().editPaneId}_DMI`?-1:M===`${i().editPaneId}_DMI`?1:x.localeCompare(M));if(console.log("🔍 Found existing DMI keys:",h),h.length>0){b(Rs,j([]));let x=1;h.forEach((M,I)=>{const D=r().saveInds[M];if(D.dmiGroup){const E={...D.dmiGroup};E.name=x===1?"DMI":`DMI${x}`,n(Rs).push(E),x+=1}else D.params&&D.params.length>=2&&(n(Rs).push({id:cn(),name:x===1?"DMI":`DMI${x}`,diPeriod:D.params[0]||14,adxPeriod:D.params[1]||6,styles:{diPlus:{color:"#22c55e",thickness:1,lineStyle:"solid"},diMinus:{color:"#ef4444",thickness:1,lineStyle:"solid"},adx:{color:"#3b82f6",thickness:1,lineStyle:"solid"}}}),x+=1)}),console.log("✅ Loaded",n(Rs).length,"existing DMI groups with proper naming")}else n(Rs).length===0&&(b(Rs,j([{id:cn(),name:"DMI",diPeriod:14,adxPeriod:6,styles:{diPlus:{color:"#22c55e",thickness:1,lineStyle:"solid"},diMinus:{color:"#ef4444",thickness:1,lineStyle:"solid"},adx:{color:"#3b82f6",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default DMI group"))}function _o(){if(!n(za))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="CR").sort((x,M)=>x===`${i().editPaneId}_CR`?-1:M===`${i().editPaneId}_CR`?1:x.localeCompare(M));console.log("🔍 Found existing CR keys:",h),h.length>0?(b(li,j([])),h.forEach((x,M)=>{var D,E,H,ue,Fe;const I=r().saveInds[x];I.crGroup?n(li).push({...I.crGroup}):n(li).push({id:cn(),name:`CR${M+1}`,crPeriod:((D=I.params)==null?void 0:D[0])||26,crMa1Period:((E=I.params)==null?void 0:E[1])||10,crMa2Period:((H=I.params)==null?void 0:H[2])||20,crMa3Period:((ue=I.params)==null?void 0:ue[3])||40,crMa4Period:((Fe=I.params)==null?void 0:Fe[4])||60,styles:{cr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},ma1:{color:"#2196F3",thickness:1,lineStyle:"solid"},ma2:{color:"#4CAF50",thickness:1,lineStyle:"solid"},ma3:{color:"#FF9800",thickness:1,lineStyle:"solid"},ma4:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}})}),console.log("✅ Loaded",n(li).length,"existing CR groups")):n(li).length===0&&(b(li,j([{id:cn(),name:"CR",crPeriod:26,crMa1Period:10,crMa2Period:20,crMa3Period:40,crMa4Period:60,styles:{cr:{color:"#FF6B35",thickness:2,lineStyle:"solid"},ma1:{color:"#2196F3",thickness:1,lineStyle:"solid"},ma2:{color:"#4CAF50",thickness:1,lineStyle:"solid"},ma3:{color:"#FF9800",thickness:1,lineStyle:"solid"},ma4:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default CR group"))}function po(){if(!n(In)||!s())return;console.log("🔄 Applying DMI changes in real-time, groups:",n(Rs).length);const h=Object.keys(r().saveInds).filter(E=>r().saveInds[E].name==="DMI").sort((E,H)=>E===`${i().editPaneId}_DMI`?-1:H===`${i().editPaneId}_DMI`?1:E.localeCompare(H));console.log("🔍 Existing DMI keys:",h);const x=new Map,M=new Set;n(Rs).forEach((E,H)=>{for(const ue of h){if(M.has(ue))continue;const Fe=r().saveInds[ue];if(Fe&&Fe.dmiGroup&&Fe.dmiGroup.id===E.id){x.set(E.id,ue),M.add(ue),console.log(`✅ Matched group ${H+1} (ID: ${E.id}) to existing key: ${ue}`);break}}}),n(Rs).forEach((E,H)=>{if(x.has(E.id))return;let ue=null;if(H===0&&!M.has(`${i().editPaneId}_DMI`)&&!h.includes(`${i().editPaneId}_DMI`))ue=`${i().editPaneId}_DMI`;else{let Fe=2;for(;M.has(`pane_DMI_${Fe}_DMI`)||h.includes(`pane_DMI_${Fe}_DMI`);)Fe+=1;ue=`pane_DMI_${Fe}_DMI`}x.set(E.id,ue),M.add(ue),console.log(`🆕 Assigned new key for group ${H+1} (ID: ${E.id}): ${ue}`)});const I=Array.from(x.values()),D=h.filter(E=>!I.includes(E));D.forEach(E=>{var ue;const H=r().saveInds[E];if(H&&H.pane_id){console.log("🗑️ Removing DMI indicator from pane:",H.pane_id,"key:",E);try{(ue=s())==null||ue.removeIndicator({paneId:H.pane_id,name:"DMI"})}catch(Fe){console.log("Error removing excess DMI indicator:",Fe)}}}),n(Rs).forEach((E,H)=>{var Ls,Mn,Ia,Hl;const ue=[E.diPeriod,E.adxPeriod],Fe=x.get(E.id),it=H===0?i().editPaneId:`pane_DMI_${H+1}`;console.log(`📍 Group ${H+1} (ID: ${E.id}) -> Target pane: ${it}, Save key: ${Fe}`);const yo={lines:[{color:E.styles.diPlus.color,size:E.styles.diPlus.thickness,style:E.styles.diPlus.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.diPlus.lineStyle==="dashed"?[4,4]:E.styles.diPlus.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:E.styles.diMinus.color,size:E.styles.diMinus.thickness,style:E.styles.diMinus.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.diMinus.lineStyle==="dashed"?[4,4]:E.styles.diMinus.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:E.styles.adx.color,size:E.styles.adx.thickness,style:E.styles.adx.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.adx.lineStyle==="dashed"?[4,4]:E.styles.adx.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},ao=h.includes(Fe)?r().saveInds[Fe]:null,Et=ao==null?void 0:ao.pane_id;if(Et&&Et!==it){console.log(`🔀 Moving DMI from pane ${Et} to ${it}`);try{(Ls=s())==null||Ls.removeIndicator({paneId:Et,name:"DMI"})}catch(zc){console.log("Note: Indicator may not exist in old pane:",zc)}(Mn=s())==null||Mn.createIndicator({name:"DMI",calcParams:ue,styles:yo},!0,{id:it})}else Et?(console.log(`🔄 Updating existing DMI in pane: ${it}`),(Ia=s())==null||Ia.overrideIndicator({name:"DMI",calcParams:ue,styles:yo,paneId:it})):(console.log(`🆕 Creating new DMI in pane: ${it}`),(Hl=s())==null||Hl.createIndicator({name:"DMI",calcParams:ue,styles:yo},!0,{id:it}))}),d.update(E=>(D.forEach(H=>{delete E.saveInds[H],console.log("🗑️ Deleted save data for key:",H)}),n(Rs).forEach((H,ue)=>{const Fe=x.get(H.id),it=ue===0?i().editPaneId:`pane_DMI_${ue+1}`;console.log(`💾 Saving DMI group ${ue+1} with key: ${Fe}, pane: ${it}`),E.saveInds[Fe]={name:"DMI",dmiGroup:H,pane_id:it,groupIndex:ue,dmiGroups:ue===0?[...n(Rs)]:void 0,params:[H.diPeriod,H.adxPeriod]}}),E))}function Es(h){if(!n(In)||n(Rs).length<=1)return;const x=n(Rs).findIndex(M=>M.id===h);x!==-1&&(console.log("🗑️ Removing DMI group at index:",x,"ID:",h),b(Rs,j(n(Rs).filter(M=>M.id!==h))),po(),console.log("✅ DMI group removed. Remaining groups:",n(Rs).length))}function ms(){if(!n(za)||!s())return;console.log("🔄 Applying CR changes in real-time, groups:",n(li).length);const h=Object.keys(r().saveInds).filter(E=>r().saveInds[E].name==="CR").sort((E,H)=>E===`${i().editPaneId}_CR`?-1:H===`${i().editPaneId}_CR`?1:E.localeCompare(H));console.log("🔍 Existing CR keys:",h);const x=new Map,M=new Set;n(li).forEach((E,H)=>{let ue=null;for(const Fe of h){if(M.has(Fe))continue;const it=r().saveInds[Fe];if(it&&it.crGroup&&it.crGroup.id===E.id){ue=Fe,M.add(Fe);break}}if(!ue){if(H===0&&!M.has(`${i().editPaneId}_CR`))ue=`${i().editPaneId}_CR`;else{let Fe=2;for(;M.has(`pane_CR_${Fe}_CR`)||h.includes(`pane_CR_${Fe}_CR`);)Fe+=1;ue=`pane_CR_${Fe}_CR`}M.add(ue)}x.set(E.id,ue)});const I=Array.from(x.values()),D=h.filter(E=>!I.includes(E));D.forEach(E=>{var ue;const H=r().saveInds[E];if(H&&H.pane_id){console.log("🗑️ Removing CR indicator from pane:",H.pane_id,"key:",E);try{(ue=s())==null||ue.removeIndicator({paneId:H.pane_id,name:"CR"})}catch(Fe){console.log("Error removing excess CR indicator:",Fe)}}}),n(li).forEach((E,H)=>{var ao,Et;const ue=[E.crPeriod,E.crMa1Period,E.crMa2Period,E.crMa3Period,E.crMa4Period],Fe=x.get(E.id),it={lines:[{color:E.styles.cr.color,size:E.styles.cr.thickness,style:E.styles.cr.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.cr.lineStyle==="dashed"?[4,4]:E.styles.cr.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:E.styles.ma1.color,size:E.styles.ma1.thickness,style:E.styles.ma1.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.ma1.lineStyle==="dashed"?[4,4]:E.styles.ma1.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:E.styles.ma2.color,size:E.styles.ma2.thickness,style:E.styles.ma2.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.ma2.lineStyle==="dashed"?[4,4]:E.styles.ma2.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:E.styles.ma3.color,size:E.styles.ma3.thickness,style:E.styles.ma3.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.ma3.lineStyle==="dashed"?[4,4]:E.styles.ma3.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:E.styles.ma4.color,size:E.styles.ma4.thickness,style:E.styles.ma4.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.styles.ma4.lineStyle==="dashed"?[4,4]:E.styles.ma4.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},yo=h.includes(Fe)?r().saveInds[Fe]:null;if(yo&&yo.pane_id)console.log("🔄 Updating existing CR in pane:",yo.pane_id),(ao=s())==null||ao.overrideIndicator({name:"CR",calcParams:ue,styles:it,paneId:yo.pane_id});else{const Ls=Fe===`${i().editPaneId}_CR`?i().editPaneId:Fe.replace("_CR","");console.log("🆕 Creating new CR with pane ID:",Ls,"key:",Fe),(Et=s())==null||Et.createIndicator({name:"CR",calcParams:ue,styles:it},!0,{id:Ls})}}),d.update(E=>(D.forEach(H=>{delete E.saveInds[H],console.log("🗑️ Deleted save data for key:",H)}),n(li).forEach((H,ue)=>{const Fe=x.get(H.id),it=Fe===`${i().editPaneId}_CR`?i().editPaneId:Fe.replace("_CR","");console.log(`💾 Saving CR group ${ue+1} with key:`,Fe),E.saveInds[Fe]={name:"CR",crGroup:H,pane_id:it,groupIndex:ue,crGroups:ue===0?[...n(li)]:void 0,params:[H.crPeriod,H.crMa1Period,H.crMa2Period,H.crMa3Period,H.crMa4Period]}}),E))}function Qn(h){if(!n(za)||n(li).length<=1)return;const x=n(li).findIndex(M=>M.id===h);x!==-1&&(console.log("🗑️ Removing CR group at index:",x,"ID:",h),b(li,j(n(li).filter(M=>M.id!==h))),ms(),console.log("✅ CR group removed. Remaining groups:",n(li).length))}function hn(){if(!n(zr))return;const h=`${i().editPaneId}_ROC`,x=r().saveInds[h];x&&x.rocGroups&&x.rocGroups.length>0?(b(an,j([...x.rocGroups])),n(an).forEach((M,I)=>{M.paneId||(M.paneId=I===0?i().editPaneId:void 0)})):x&&x.rocGroup?(b(an,j([x.rocGroup])),n(an)[0]&&!n(an)[0].paneId&&(n(an)[0].paneId=i().editPaneId)):n(an).length===0&&b(an,j([{id:cn(),period:14,period2:21,paneId:i().editPaneId,styles:{roc:{color:"#2563eb",thickness:1,lineStyle:"solid"},roc2:{color:"#dc2626",thickness:1,lineStyle:"solid",visible:!1}}}]))}function Bi(){var h;if(!(!s()||!n(zr)))try{const M=((h=s())==null?void 0:h.getIndicators()).filter(I=>I.name==="ROC");console.log("🔍 Detecting paneIds for ROC indicators:",M.length),M.forEach((I,D)=>{D<n(an).length&&!n(an)[D].paneId&&(n(an)[D].paneId=I.paneId,console.log(`📍 Set paneId ${I.paneId} for ROC group ${D}`))})}catch(x){console.error("❌ Error detecting ROC paneIds:",x)}}function qr(){var it,yo;if(!n(zr)||!s())return;const h=["#2563eb","#dc2626","#16a34a","#ca8a04","#9333ea","#c2410c"],x=n(an).length%h.length,M={id:cn(),period:14,period2:21,paneId:void 0,styles:{roc:{color:h[x],thickness:1,lineStyle:"solid"},roc2:{color:h[(x+1)%h.length],thickness:1,lineStyle:"solid",visible:!1}}};n(an).push(M);const I=[M.period];let D=Ee.Solid,E=[2,2];M.styles.roc.lineStyle==="dashed"?(D=Ee.Dashed,E=[4,4]):M.styles.roc.lineStyle==="dotted"&&(D=Ee.Dashed,E=[2,2]);const H={lines:[{color:M.styles.roc.color,size:M.styles.roc.thickness,style:D,dashedValue:E,smooth:!1}]},ue={name:"ROC",calcParams:I,styles:H,figures:[{key:"roc",title:"ROC: ",type:"line"}]};let Fe;n(an).length===1?((it=s())==null||it.overrideIndicator({...ue,paneId:i().editPaneId}),Fe=i().editPaneId):Fe=(yo=s())==null?void 0:yo.createIndicator(ue,!1,{axis:{gap:{bottom:2}}}),M.paneId=Fe??void 0,d.update(ao=>{const Et=`${i().editPaneId}_ROC`;return ao.saveInds[Et]||(ao.saveInds[Et]={name:"ROC",pane_id:i().editPaneId,params:[M.period],rocGroups:[]}),ao.saveInds[Et].rocGroups||(ao.saveInds[Et].rocGroups=[]),ao.saveInds[Et].rocGroups=[...n(an)],ao})}function mi(h){var I,D;if(!n(zr)||n(an).length<=1)return;const x=n(an).findIndex(E=>E.id===h);if(x===-1)return;console.log("🗑️ Removing ROC group at index:",x,"with ID:",h);const M=n(an).length;if(n(an).splice(x,1),console.log(`📝 Removed ROC group: ${M} -> ${n(an).length}`),n(an).forEach((E,H)=>{E.name=`ROC #${H+1}`}),s())try{const H=((I=s())==null?void 0:I.getIndicators()).filter(ue=>ue.name==="ROC");console.log("📈 ROC indicators found:",H.length);for(const ue of H)console.log("🗑️ Removing ROC from pane:",ue.paneId),(D=s())==null||D.removeIndicator({paneId:ue.paneId,name:"ROC"});n(an).forEach((ue,Fe)=>{var Ls;let it=Ee.Solid,yo=[2,2];ue.styles.roc.lineStyle==="dashed"?(it=Ee.Dashed,yo=[4,4]):ue.styles.roc.lineStyle==="dotted"&&(it=Ee.Dashed,yo=[2,2]);const ao={lines:[{color:ue.styles.roc.color,size:ue.styles.roc.thickness,style:it,dashedValue:yo}]};console.log("➕ Re-adding ROC group:",`ROC_${Fe+1}`,"at index:",Fe);const Et=(Ls=s())==null?void 0:Ls.createIndicator({name:"ROC",calcParams:[ue.period],styles:ao,figures:[{key:"roc",title:"ROC: ",type:"line"}]},!1);Et&&(ue.paneId=Et,d.update(Mn=>{const Ia=`${Et}_ROC`;return Mn.saveInds[Ia]||(Mn.saveInds[Ia]={name:"ROC",pane_id:Et,rocGroups:[]}),Mn.saveInds[Ia].rocGroups||(Mn.saveInds[Ia].rocGroups=[]),Mn.saveInds[Ia].rocGroups[Fe]={...ue},Mn}))}),console.log("✅ Successfully updated ROC indicators on chart")}catch(E){console.error("❌ Error updating ROC indicators:",E)}console.log("✅ ROC group removed. Remaining groups:",n(an).length)}function ql(h){var H,ue;const x=n(an)[h];if(!x||!s()){console.warn("❌ updateRocIndicator: Missing group or chart",{group:x,chart:!!s()});return}console.log("🔄 updateRocIndicator called:",{groupIndex:h,group:x});let M=Ee.Solid,I=[2,2];x.styles.roc.lineStyle==="dashed"?(M=Ee.Dashed,I=[4,4]):x.styles.roc.lineStyle==="dotted"&&(M=Ee.Dashed,I=[2,2]);const E=((H=s())==null?void 0:H.getIndicators()).filter(Fe=>Fe.name==="ROC");if(console.log("📊 Found ROC indicators on chart:",E.length),console.log("📊 Looking for group index:",h),E.length>h){const Fe=E[h];console.log("✅ Found matching ROC indicator by index, updating styles...");const it=(ue=s())==null?void 0:ue.overrideIndicator({name:"ROC",paneId:Fe.paneId,calcParams:[x.period],styles:{lines:[{color:x.styles.roc.color,size:x.styles.roc.thickness,style:M,dashedValue:I,smooth:!1}]},figures:[{key:"roc",title:"ROC: ",type:"line"}]});console.log("🎨 overrideIndicator result:",it),console.log("🎨 Applied styles:",{color:x.styles.roc.color,size:x.styles.roc.thickness,style:M,dashedValue:I});const yo=`${Fe.paneId}_ROC`;console.log("💾 Using save key:",yo),d.update(ao=>{ao.saveInds[yo]||(ao.saveInds[yo]={name:"ROC",pane_id:Fe.paneId,params:[x.period],rocGroups:[]}),ao.saveInds[yo].rocGroups||(ao.saveInds[yo].rocGroups=[]);const Et=ao.saveInds[yo].rocGroups||[];for(;Et.length<=h;)Et.push({});return Et[h]={...x},ao.saveInds[yo].rocGroups=Et,ao.saveInds[yo].params=[x.period],console.log("💾 Persisted ROC changes to save data:",yo,x),ao}),console.log("✅ ROC indicator updated successfully:",h,x)}else console.error("❌ ROC indicator not found on chart for group index:",h),console.log("📊 Available ROC indicators:",E.length),console.log("📊 Requested group index:",h)}function rc(){if(!n(hl))return;b(As,j([]));const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="PSY").sort((x,M)=>x===`${i().editPaneId}_PSY`?-1:M===`${i().editPaneId}_PSY`?1:x.localeCompare(M));h.length>0?b(As,j(h.map((x,M)=>{const I=r().saveInds[x];if(I.psyGroup)return{...I.psyGroup,id:I.psyGroup.id||cn(),actualPaneId:I.pane_id};if(I.psyGroups){const D=I.psyGroups[M]||I.psyGroups[0];return{...D,id:D.id||cn(),actualPaneId:I.pane_id}}else{const[D=12,E=6]=I.params||[12,6],H=["#2563eb","#dc2626","#16a34a","#ca8a04","#9333ea","#c2410c"];return{id:cn(),psyPeriod:D,mapsyPeriod:E,showMapsy:!0,actualPaneId:I.pane_id,styles:{psy:{color:H[M%H.length],thickness:1,lineStyle:"solid"},mapsy:{color:H[(M+1)%H.length],thickness:1,lineStyle:"solid"}}}}}))):n(As).push({id:cn(),psyPeriod:12,mapsyPeriod:6,showMapsy:!0,styles:{psy:{color:"#2563eb",thickness:1,lineStyle:"solid"},mapsy:{color:"#dc2626",thickness:1,lineStyle:"solid"}}}),b(As,j(n(As).map(x=>({...x,id:x.id||cn()}))))}function pd(){var D;if(!n(hl))return;const h=["#2563eb","#dc2626","#16a34a","#ca8a04","#9333ea","#c2410c"],x=n(As).length%h.length,M={id:cn(),psyPeriod:12,mapsyPeriod:6,showMapsy:!0,actualPaneId:void 0,styles:{psy:{color:h[x],thickness:1,lineStyle:"solid"},mapsy:{color:h[(x+1)%h.length],thickness:1,lineStyle:"solid"}}};if(n(As).push(M),n(As).length>1){let E=2;for(;Object.keys(r().saveInds).some(Mn=>Mn===`psy_${String(E).padStart(3,"0")}_PSY`);)E+=1;const H=n(As).length-1,ue=[M.psyPeriod,M.mapsyPeriod],Fe=[{key:"psy",title:"PSY: ",type:"line"}];M.showMapsy&&Fe.push({key:"mapsy",title:"MAPSY: ",type:"line"});const it={lines:[]};let yo=Ee.Solid,ao=[2,2];if(M.styles.psy.lineStyle==="dashed"?(yo=Ee.Dashed,ao=[4,4]):M.styles.psy.lineStyle==="dotted"&&(yo=Ee.Dashed,ao=[2,2]),it.lines.push({color:M.styles.psy.color,size:M.styles.psy.thickness,style:yo,dashedValue:ao,smooth:!1}),M.showMapsy){let Mn=Ee.Solid,Ia=[2,2];M.styles.mapsy.lineStyle==="dashed"?(Mn=Ee.Dashed,Ia=[4,4]):M.styles.mapsy.lineStyle==="dotted"&&(Mn=Ee.Dashed,Ia=[2,2]),it.lines.push({color:M.styles.mapsy.color,size:M.styles.mapsy.thickness,style:Mn,dashedValue:Ia,smooth:!1})}const Et=`psy_${String(E).padStart(3,"0")}`;console.log(`🆕 Immediately creating PSY ${E} with pane ID:`,Et),((D=s())==null?void 0:D.createIndicator({name:"PSY",calcParams:ue,styles:it,figures:Fe},!1,{id:Et,axis:{gap:{bottom:2}}}))&&(console.log(`✅ PSY ${E} created with pane ID:`,Et),M.actualPaneId=Et,d.update(Mn=>{const Ia=`psy_${String(E).padStart(3,"0")}_PSY`;return Mn.saveInds[Ia]={name:"PSY",psyGroup:M,pane_id:Et,groupIndex:H,params:[M.psyPeriod,M.mapsyPeriod]},Mn}))}else console.log("📝 New PSY group will be added to edit pane on confirm")}function Fd(h){var M,I,D;if(!n(hl)||n(As).length<=1)return;const x=n(As).findIndex(E=>E.id===h);if(x!==-1){console.log("🗑️ Removing PSY group at index:",x,"ID:",h);try{if(x===0&&n(As).length>1){console.log("🔄 Special handling: First PSY removed, promoting second PSY to first position"),b(As,j(n(As).filter(H=>H.id!==h))),console.log("✅ PSY group removed from array. Remaining groups:",n(As).length);const E=n(As)[0];E.actualPaneId&&(console.log("🗑️ Removing old second PSY from sub-pane:",E.actualPaneId),(M=s())==null||M.removeIndicator({paneId:E.actualPaneId,name:"PSY"})),E.actualPaneId=void 0,console.log("📊 Updating PSY in edit pane with new first group settings"),jl(0)}else{const E=`pane_PSY_${x+1}_PSY`;if(r().saveInds[E]){const H=r().saveInds[E];console.log("🗑️ Removing PSY from pane:",H.pane_id),(I=s())==null||I.removeIndicator({paneId:H.pane_id,name:"PSY"}),console.log("✅ Successfully removed PSY from pane:",H.pane_id)}else{const H=n(As)[x];H.actualPaneId&&(console.log("🗑️ Removing PSY from actual pane:",H.actualPaneId),(D=s())==null||D.removeIndicator({paneId:H.actualPaneId,name:"PSY"}),console.log("✅ Successfully removed PSY from actual pane:",H.actualPaneId))}b(As,j(n(As).filter(H=>H.id!==h))),console.log("✅ PSY group removed from array. Remaining groups:",n(As).length)}d.update(E=>(Object.keys(E.saveInds).forEach(H=>{E.saveInds[H].name==="PSY"&&(console.log("🧹 Cleaning saved state for key:",H),delete E.saveInds[H])}),n(As).forEach((H,ue)=>{const Fe=ue===0?`${i().editPaneId}_PSY`:`pane_PSY_${ue+1}_PSY`,it=ue===0?i().editPaneId:H.actualPaneId||`pane_PSY_${ue+1}`;E.saveInds[Fe]={name:"PSY",psyGroup:H,pane_id:it,groupIndex:ue,psyGroups:ue===0?[...n(As)]:void 0,params:[H.psyPeriod,H.mapsyPeriod]},console.log("💾 Re-saved PSY group",ue,"with key:",Fe,"and pane ID:",it)}),E))}catch(E){console.error("❌ Error removing PSY group:",E)}}}function jl(h){var Fe;const x=n(As)[h];if(!x||!s())return;const M=h===0?i().editPaneId:x.actualPaneId||`psy_${String(h+1).padStart(3,"0")}`,I=[{key:"psy",title:"PSY: ",type:"line"}];x.showMapsy&&I.push({key:"mapsy",title:"MAPSY: ",type:"line"});const D={lines:[]};let E=Ee.Solid,H=[2,2];if(x.styles.psy.lineStyle==="dashed"?(E=Ee.Dashed,H=[4,4]):x.styles.psy.lineStyle==="dotted"&&(E=Ee.Dashed,H=[2,2]),D.lines.push({color:x.styles.psy.color,size:x.styles.psy.thickness,style:E,dashedValue:H,smooth:!1}),x.showMapsy){let it=Ee.Solid,yo=[2,2];x.styles.mapsy.lineStyle==="dashed"?(it=Ee.Dashed,yo=[4,4]):x.styles.mapsy.lineStyle==="dotted"&&(it=Ee.Dashed,yo=[2,2]),D.lines.push({color:x.styles.mapsy.color,size:x.styles.mapsy.thickness,style:it,dashedValue:yo,smooth:!1})}(Fe=s())==null||Fe.overrideIndicator({name:"PSY",paneId:M,styles:D,calcParams:[x.psyPeriod,x.mapsyPeriod],figures:I});const ue=h===0?`${i().editPaneId}_PSY`:`psy_${String(h+1).padStart(3,"0")}_PSY`;d.update(it=>(it.saveInds[ue]&&(it.saveInds[ue].params=[x.psyPeriod,x.mapsyPeriod],it.saveInds[ue].psyGroup={...x},console.log("💾 Persisted PSY changes to save data:",ue,x)),it)),console.log("🔄 Updated PSY indicator:",h,x)}function bd(){if(!n(fa))return;b(qs,j([]));const h=Object.entries(r().saveInds).filter(([x,M])=>M.name==="OBV");h.length>0?(h.sort(([x,M],[I,D])=>{const E=M.groupIndex||0,H=D.groupIndex||0;return E-H}),h.forEach(([x,M])=>{var D,E;const I=M;if(I.obvGroup){const H=I.obvGroup;I.pane_id&&(H.actualPaneId=I.pane_id),n(qs).push(H)}else if(I.obvGroups&&I.obvGroups.length>0)b(qs,j([...I.obvGroups])),n(qs).forEach((H,ue)=>{H.actualPaneId||(ue===0?H.actualPaneId=i().editPaneId:I.pane_id&&(H.actualPaneId=I.pane_id))});else{const H={id:cn(),obvPeriod:((D=I.params)==null?void 0:D[0])||30,maobvPeriod:((E=I.params)==null?void 0:E[1])||10,showMaobv:!0,actualPaneId:void 0,styles:{obv:{color:"#FF6B35",thickness:2,lineStyle:"solid"},maobv:{color:"#2196F3",thickness:1,lineStyle:"solid"}}};I.pane_id&&(H.actualPaneId=I.pane_id),n(qs).push(H)}})):n(qs).push({id:cn(),obvPeriod:30,maobvPeriod:10,showMaobv:!0,actualPaneId:i().editPaneId,styles:{obv:{color:"#FF6B35",thickness:2,lineStyle:"solid"},maobv:{color:"#2196F3",thickness:1,lineStyle:"solid"}}})}function Vc(){if(!n(fa))return;const h=["#FF6B35","#2196F3","#16a34a","#ca8a04","#9333ea","#c2410c"],x=n(qs).length%h.length,M={id:cn(),obvPeriod:30,maobvPeriod:10,showMaobv:!0,actualPaneId:void 0,styles:{obv:{color:h[x],thickness:2,lineStyle:"solid"},maobv:{color:h[(x+1)%h.length],thickness:1,lineStyle:"solid"}}},I=new Set;n(qs).forEach(H=>{H.actualPaneId&&I.add(H.actualPaneId)}),Object.keys(r().saveInds).forEach(H=>{r().saveInds[H]&&r().saveInds[H].name==="OBV"&&r().saveInds[H].pane_id&&I.add(r().saveInds[H].pane_id)}),console.log("🔍 Existing OBV pane IDs:",Array.from(I));let D=2;for(;I.has(`pane_OBV_${D}`);)D+=1;const E=`pane_OBV_${D}`;M.actualPaneId=E,console.log("✅ Adding new OBV group with pane ID:",E),n(qs).push(M),zl()}function Pc(h){var I;if(!n(fa)||n(qs).length<=1)return;b(lt,!0),console.log("🚫 Set obvRemovalInProgress = true");const x=n(qs).findIndex(D=>D.id===h);if(x===-1){b(lt,!1);return}const M=n(qs)[x];console.log("🗑️ Removing OBV group at index:",x,"ID:",h),console.log("🗑️ Group to remove:",M);try{let D;D=M.actualPaneId,D||Object.keys(r().saveInds).forEach(E=>{const H=r().saveInds[E];H&&H.name==="OBV"&&H.groupIndex===x&&(D=H.pane_id)}),!D&&x===0&&(D=i().editPaneId),console.log("🗑️ Removing OBV at index",x,"from pane:",D),D&&(console.log("🗑️ Removing OBV indicator from pane:",D),(I=s())==null||I.removeIndicator({paneId:D,name:"OBV"}),console.log("✅ Successfully removed OBV from pane:",D)),b(qs,j(n(qs).filter(E=>E.id!==h))),console.log("✅ OBV group removed from array. Remaining groups:",n(qs).length),d.update(E=>{const H=[];return Object.keys(E.saveInds).forEach(ue=>{E.saveInds[ue]&&E.saveInds[ue].name==="OBV"&&H.push(ue)}),console.log("🧹 Clearing all OBV save data:",H),H.forEach(ue=>delete E.saveInds[ue]),n(qs).forEach((ue,Fe)=>{const it=ue.actualPaneId||i().editPaneId;if(!it){console.error(`❌ No pane ID for OBV group ${Fe} during removal cleanup`);return}const yo=`${it}_OBV`;E.saveInds[yo]={name:"OBV",obvGroup:ue,pane_id:it,groupIndex:Fe,obvGroups:Fe===0?[...n(qs)]:void 0,params:[ue.obvPeriod,ue.maobvPeriod]},console.log("💾 Re-saved OBV group",Fe,"with key:",yo,"pane:",it)}),E}),console.log("✅ OBV removal and reindexing completed"),setTimeout(()=>{b(lt,!1),console.log("✅ Reset obvRemovalInProgress = false")},200)}catch(D){console.error("❌ Error removing OBV group:",D)}}function zl(){if(!(!n(fa)||!s()))try{console.log("🔄 Applying OBV changes to chart..."),console.log("🔧 Current OBV groups:",n(qs).length);const h=Object.keys(r().saveInds).filter(M=>r().saveInds[M]&&r().saveInds[M].name==="OBV");console.log("🔧 Existing OBV keys in save data:",h);const x=new Set;n(qs).forEach((M,I)=>{const D=M.actualPaneId||i().editPaneId;x.add(D)}),console.log("🔧 Pane IDs that should exist:",Array.from(x)),h.forEach(M=>{var D;const I=r().saveInds[M];if(I&&I.pane_id&&!x.has(I.pane_id))try{console.log("🗑️ Removing stale OBV indicator from pane:",I.pane_id),(D=s())==null||D.removeIndicator({paneId:I.pane_id,name:"OBV"})}catch(E){console.log("❌ Error removing stale OBV indicator:",E)}}),n(qs).forEach((M,I)=>{var H,ue,Fe;const D=[M.obvPeriod,M.maobvPeriod],E={lines:[{color:M.styles.obv.color,size:M.styles.obv.thickness,style:M.styles.obv.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:M.styles.obv.lineStyle==="dashed"?[4,4]:M.styles.obv.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1},{color:M.styles.maobv.color,size:M.styles.maobv.thickness,style:M.styles.maobv.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:M.styles.maobv.lineStyle==="dashed"?[4,4]:M.styles.maobv.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(I===0){const it=M.actualPaneId||i().editPaneId;M.actualPaneId||(M.actualPaneId=i().editPaneId),console.log("🔄 Updating first OBV in pane:",it),(H=s())==null||H.overrideIndicator({name:"OBV",calcParams:D,styles:E,paneId:it})}else{const it=M.actualPaneId||`pane_OBV_${I+1}`;if(h.find(ao=>{const Et=r().saveInds[ao];return Et&&Et.pane_id===it}))console.log("🔄 Updating existing OBV in pane:",it),(ue=s())==null||ue.overrideIndicator({name:"OBV",calcParams:D,styles:E,paneId:it}),M.actualPaneId=it;else{const ao=M.actualPaneId||`pane_OBV_${I+1}`;console.log("🆕 Creating new OBV in pane:",ao);const Et=(Fe=s())==null?void 0:Fe.createIndicator({name:"OBV",calcParams:D,styles:E},!0,{id:ao,axis:{gap:{bottom:2}}});Et&&(M.actualPaneId=ao,console.log("✅ Created new OBV indicator with ID:",Et,"in pane:",ao))}}}),d.update(M=>{try{Object.keys(M.saveInds).forEach(I=>{M.saveInds[I]&&M.saveInds[I].name==="OBV"&&delete M.saveInds[I]}),n(qs).forEach((I,D)=>{try{const E=I.actualPaneId||i().editPaneId;if(!E){console.error(`❌ No pane ID for OBV group ${D}`);return}const H=`${E}_OBV`,ue={name:"OBV",obvGroup:I,pane_id:E,groupIndex:D,obvGroups:D===0?[...n(qs)]:void 0,params:[I.obvPeriod,I.maobvPeriod]};M.saveInds[H]=ue,console.log("💾 Saved OBV group",D,"with key:",H,"and pane ID:",E)}catch(E){console.error(`❌ Error saving OBV group ${D}:`,E)}})}catch(I){console.error("❌ Error in OBV save operation:",I)}return M}),console.log("✅ OBV changes applied successfully")}catch(h){console.error("❌ Critical error in applyObv:",h)}}function Hr(){if(!n(sc))return;console.log("🔄 Initializing KDJ groups for edit pane:",i().editPaneId);const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="KDJ").sort((x,M)=>x===`${i().editPaneId}_KDJ`?-1:M===`${i().editPaneId}_KDJ`?1:x.localeCompare(M));console.log("🔍 Found KDJ keys:",h),h.length>0?(b(Jn,j([])),h.forEach((x,M)=>{const I=r().saveInds[x];if(console.log(`🔄 Loading KDJ group ${M+1} from key:`,x,I),I){if(I.kdjGroup){const D={...I.kdjGroup};M>0&&I.pane_id&&(D.actualPaneId=I.pane_id),n(Jn).push(D)}else if(I.params&&I.params.length>=2){const D={id:cn(),kPeriod:I.params[0]||9,dPeriod:I.params[1]||3,actualPaneId:void 0,styles:{k:{color:"#FF6B35",thickness:1,lineStyle:"solid"},d:{color:"#2196F3",thickness:1,lineStyle:"solid"},j:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}};M>0&&I.pane_id&&(D.actualPaneId=I.pane_id),n(Jn).push(D)}}}),console.log("✅ Loaded",n(Jn).length,"existing KDJ groups")):n(Jn).length===0&&(b(Jn,j([{id:cn(),kPeriod:9,dPeriod:3,styles:{k:{color:"#FF6B35",thickness:1,lineStyle:"solid"},d:{color:"#2196F3",thickness:1,lineStyle:"solid"},j:{color:"#9C27B0",thickness:1,lineStyle:"solid"}}}])),console.log("🆕 Created default KDJ group"))}function gl(){var I;if(!n(sc))return;const h=["#FF6B35","#2196F3","#9C27B0","#16a34a","#ca8a04","#dc2626"],x=n(Jn).length%h.length,M={id:cn(),kPeriod:9,dPeriod:3,actualPaneId:void 0,styles:{k:{color:h[x],thickness:1,lineStyle:"solid"},d:{color:h[(x+1)%h.length],thickness:1,lineStyle:"solid"},j:{color:h[(x+2)%h.length],thickness:1,lineStyle:"solid"}}};if(n(Jn).push(M),n(Jn).length>1){const D=Object.values(r().saveInds).filter(ao=>ao.name==="KDJ"&&ao.pane_id).map(ao=>ao.pane_id);let E=2;for(;D.includes(`pane_KDJ_${E}`);)E+=1;const H=n(Jn).length-1,ue=[M.kPeriod,M.dPeriod,3],Fe={lines:[{color:M.styles.k.color,size:M.styles.k.thickness,style:M.styles.k.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:M.styles.k.lineStyle==="dashed"?[4,4]:[2,2]},{color:M.styles.d.color,size:M.styles.d.thickness,style:M.styles.d.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:M.styles.d.lineStyle==="dashed"?[4,4]:[2,2]},{color:M.styles.j.color,size:M.styles.j.thickness,style:M.styles.j.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:M.styles.j.lineStyle==="dashed"?[4,4]:[2,2]}]},it=`pane_KDJ_${E}`;console.log(`🆕 Immediately creating KDJ ${E} with pane ID:`,it),((I=s())==null?void 0:I.createIndicator({name:"KDJ",calcParams:ue,styles:Fe},!1,{id:it,axis:{gap:{bottom:2}}}))&&(console.log(`✅ KDJ ${E} created with pane ID:`,it),M.actualPaneId=it,d.update(ao=>{const Et=`pane_KDJ_${E}_KDJ`;return ao.saveInds[Et]={name:"KDJ",kdjGroup:M,pane_id:it,groupIndex:H,params:[M.kPeriod,M.dPeriod,3]},ao}))}}function ac(h){var E;const x=n(Jn)[h];if(!x||!s())return;const M=h===0?i().editPaneId:x.actualPaneId||`pane_KDJ_${h+1}`,I={lines:[{color:x.styles.k.color,size:x.styles.k.thickness,style:x.styles.k.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:x.styles.k.lineStyle==="dashed"?[4,4]:[2,2]},{color:x.styles.d.color,size:x.styles.d.thickness,style:x.styles.d.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:x.styles.d.lineStyle==="dashed"?[4,4]:[2,2]},{color:x.styles.j.color,size:x.styles.j.thickness,style:x.styles.j.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:x.styles.j.lineStyle==="dashed"?[4,4]:[2,2]}]};(E=s())==null||E.overrideIndicator({name:"KDJ",paneId:M,styles:I,calcParams:[x.kPeriod,x.dPeriod,3]});const D=h===0?`${i().editPaneId}_KDJ`:`pane_KDJ_${h+1}_KDJ`;d.update(H=>(H.saveInds[D]&&(H.saveInds[D].params=[x.kPeriod,x.dPeriod,3],H.saveInds[D].kdjGroup={...x},console.log("💾 Persisted KDJ changes to save data:",D,x)),H)),console.log("🔄 Updated KDJ indicator:",h,x)}let Bl=oe(j([]));function Lv(){if(!n(Ts)||n(Bl).length>0)return;const h=`${i().editPaneId}_ICHIMOKU`,x=r().saveInds[h];if(x&&Array.isArray(x.ichimokuGroups)&&x.ichimokuGroups.length>0)b(Bl,j(x.ichimokuGroups.map((M,I)=>{var D;return{id:M.id||cn(),name:M.name||`Ichimoku #${I+1}`,params:M.params||[9,26,52],styles:((D=M.styles)==null?void 0:D.map(E=>({color:E.color||"#2563eb",thickness:E.thickness??1,lineStyle:E.lineStyle||"solid"})))||[{color:"#ef4444",thickness:1,lineStyle:"solid"},{color:"#3b82f6",thickness:1,lineStyle:"solid"},{color:"#10b981",thickness:1,lineStyle:"solid"}]}})));else{const M=[p[0]||9,p[1]||26,p[2]||52],I=[0,1,2].map(D=>{var E,H,ue;return{color:((E=y[D])==null?void 0:E.color)||["#ef4444","#3b82f6","#10b981"][D]||"#2563eb",thickness:((H=y[D])==null?void 0:H.thickness)??1,lineStyle:((ue=y[D])==null?void 0:ue.lineStyle)||"solid"}});b(Bl,j([{id:cn(),name:"Ichimoku #1",params:M,styles:I}]))}}function Jp(){var D;if(!n(Ts))return;const h=n(Bl).length+1,x=[["#ef4444","#3b82f6","#10b981"],["#f59e0b","#8b5cf6","#06b6d4"],["#22c55e","#e11d48","#0ea5e9"]],M=x[(h-1)%x.length],I={id:cn(),name:`Ichimoku #${h}`,params:[9,26,52],styles:[{color:M[0],thickness:1,lineStyle:"solid"},{color:M[1],thickness:1,lineStyle:"solid"},{color:M[2],thickness:1,lineStyle:"solid"}]};b(Bl,j([...n(Bl),I]));try{const E={lines:I.styles.map(ue=>({color:ue.color,size:ue.thickness,style:ue.lineStyle==="dashed"||ue.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:ue.lineStyle==="dashed"?[4,4]:ue.lineStyle==="dotted"?[2,2]:[2,2]}))};(D=s())==null||D.createIndicator({name:"ICHIMOKU",calcParams:I.params,styles:E},!0,{id:i().editPaneId});const H=`${i().editPaneId}_ICHIMOKU`;d.update(ue=>{var Fe;return ue.saveInds[H]={name:"ICHIMOKU",pane_id:i().editPaneId,params:((Fe=n(Bl)[0])==null?void 0:Fe.params)||[9,26,52],ichimokuGroups:n(Bl).map(it=>({...it}))},ue})}catch(E){console.error("❌ Error adding Ichimoku group:",E)}}function Tu(h){var x,M,I;if(!(!n(Ts)||!s()))try{const E=(((M=(x=s())==null?void 0:x.getIndicators)==null?void 0:M.call(x))||[]).filter(ue=>ue.name==="ICHIMOKU"&&ue.paneId===i().editPaneId);for(const ue of E)(I=s())==null||I.removeIndicator({paneId:ue.paneId,name:"ICHIMOKU"});n(Bl).forEach(ue=>{var it;const Fe={lines:ue.styles.map(yo=>({color:yo.color,size:yo.thickness,style:yo.lineStyle==="dashed"||yo.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:yo.lineStyle==="dashed"?[4,4]:yo.lineStyle==="dotted"?[2,2]:[2,2]}))};(it=s())==null||it.createIndicator({name:"ICHIMOKU",calcParams:ue.params,styles:Fe},!0,{id:i().editPaneId})});const H=`${i().editPaneId}_ICHIMOKU`;d.update(ue=>{var Fe;return ue.saveInds[H]={name:"ICHIMOKU",pane_id:i().editPaneId,params:((Fe=n(Bl)[0])==null?void 0:Fe.params)||[9,26,52],ichimokuGroups:n(Bl).map(it=>({...it}))},ue}),console.log("🔄 Updated Ichimoku groups")}catch(D){console.error("❌ Error updating Ichimoku groups:",D)}}function Cp(h){if(n(Ts)&&!(n(Bl).length<=1)&&!(h<0||h>=n(Bl).length))try{b(Bl,j(n(Bl).filter((x,M)=>M!==h))),Tu(0),console.log("🗑️ Removed Ichimoku group at index:",h)}catch(x){console.error("❌ Error removing Ichimoku group:",x)}}function mf(){var h,x,M;if(!(!n(Ts)||!s()))try{const D=(((x=(h=s())==null?void 0:h.getIndicators)==null?void 0:x.call(h))||[]).filter(H=>H.name==="ICHIMOKU"&&H.paneId===i().editPaneId);for(const H of D)(M=s())==null||M.removeIndicator({paneId:H.paneId,name:"ICHIMOKU"});n(Bl).forEach(H=>{var Fe;const ue={lines:H.styles.map(it=>({color:it.color,size:it.thickness,style:it.lineStyle==="dashed"||it.lineStyle==="dotted"?Ee.Dashed:Ee.Solid,dashedValue:it.lineStyle==="dashed"?[4,4]:it.lineStyle==="dotted"?[2,2]:[2,2]}))};(Fe=s())==null||Fe.createIndicator({name:"ICHIMOKU",calcParams:H.params,styles:ue},!0,{id:i().editPaneId})});const E=`${i().editPaneId}_ICHIMOKU`;d.update(H=>{var ue;return H.saveInds[E]={name:"ICHIMOKU",pane_id:i().editPaneId,params:((ue=n(Bl)[0])==null?void 0:ue.params)||[9,26,52],ichimokuGroups:n(Bl).map(Fe=>({...Fe}))},H}),l.update(H=>(H.editIndName="",H.editPaneId="",H.modalIndCfg=!1,H)),a(!1),console.log("✅ Ichimoku confirm applied")}catch(I){console.error("❌ Error confirming Ichimoku groups:",I)}}function Jd(h){var M,I;if(!n(sc)||n(Jn).length<=1)return;const x=n(Jn).findIndex(D=>D.id===h);if(x!==-1){console.log("🗑️ Removing KDJ group at index:",x,"ID:",h);try{if(x===0&&n(Jn).length>1){console.log("🔄 Special handling: First KDJ removed, promoting second KDJ to first position"),b(Jn,j(n(Jn).filter(E=>E.id!==h))),console.log("✅ KDJ group removed from array. Remaining groups:",n(Jn).length);const D=n(Jn)[0];D.actualPaneId&&(console.log("🗑️ Removing old second KDJ from sub-pane:",D.actualPaneId),(M=s())==null||M.removeIndicator({paneId:D.actualPaneId,name:"KDJ"})),D.actualPaneId=void 0,console.log("📊 Updating KDJ in edit pane with new first group settings"),ac(0)}else{const D=n(Jn)[x];D.actualPaneId&&(console.log("🗑️ Removing KDJ from actual pane:",D.actualPaneId),(I=s())==null||I.removeIndicator({paneId:D.actualPaneId,name:"KDJ"}),console.log("✅ Successfully removed KDJ from actual pane:",D.actualPaneId)),b(Jn,j(n(Jn).filter(E=>E.id!==h))),console.log("✅ KDJ group removed from array. Remaining groups:",n(Jn).length)}d.update(D=>(Object.keys(D.saveInds).forEach(E=>{D.saveInds[E].name==="KDJ"&&(console.log("🧹 Cleaning saved state for key:",E),delete D.saveInds[E])}),n(Jn).forEach((E,H)=>{const ue=H===0?`${i().editPaneId}_KDJ`:`pane_KDJ_${H+1}_KDJ`,Fe=H===0?i().editPaneId:E.actualPaneId||`pane_KDJ_${H+1}`;console.log(`💾 Re-saving KDJ group ${H+1} with key:`,ue,"pane ID:",Fe),D.saveInds[ue]={name:"KDJ",kdjGroup:E,pane_id:Fe,groupIndex:H,kdjGroups:H===0?[...n(Jn)]:void 0,params:[E.kPeriod,E.dPeriod,3]}}),D)),console.log("🔄 KDJ groups reindexed successfully")}catch(D){console.log("❌ Error removing KDJ indicator:",D)}}}function jc(){var x,M;if(!n(Ge))return;console.log("🔄 Initializing AO groups for edit pane:",i().editPaneId);const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="AO").sort((I,D)=>I===`${i().editPaneId}_AO`?-1:D===`${i().editPaneId}_AO`?1:I.localeCompare(D));if(console.log("🔍 Found AO keys:",h),h.length>0)b(Oo,j([])),h.forEach((I,D)=>{const E=r().saveInds[I];console.log(`🔄 Loading AO group ${D+1} from key:`,I,E),E&&(E.aoGroup?n(Oo).push({...E.aoGroup}):E.params&&E.params.length===2&&n(Oo).push({id:cn(),shortPeriod:E.params[0]||5,longPeriod:E.params[1]||34,styles:{increasing:{color:"#26A69A"},decreasing:{color:"#EF5350"}}}))}),console.log("✅ Loaded AO groups:",n(Oo).length);else{const I=Object.entries(r().saveInds).find(([D,E])=>E.name==="AO"&&D.includes(i().editPaneId||""));if(I){const[,D]=I;console.log("🔄 Found existing AO indicator, creating group from it"),b(Oo,j([{id:cn(),shortPeriod:((x=D.params)==null?void 0:x[0])||5,longPeriod:((M=D.params)==null?void 0:M[1])||34,styles:{increasing:{color:"#26A69A"},decreasing:{color:"#EF5350"}}}]))}else console.log("🔄 Creating default AO group"),b(Oo,j([{id:cn(),shortPeriod:5,longPeriod:34,styles:{increasing:{color:"#26A69A"},decreasing:{color:"#EF5350"}}}]))}}function ap(){if(!n(Dr))return;const h=i().editPaneId||"candle_pane",x=Object.entries(r().saveInds).filter(([I,D])=>D&&D.name==="BOLL"&&D.pane_id===h);if(x.length>0){const I=x.sort(([D],[E])=>{var Fe,it;const H=(Fe=D.match(/_BOLL_(\d+)$/))!=null&&Fe[1]?parseInt(D.match(/_BOLL_(\d+)$/)[1],10):1,ue=(it=E.match(/_BOLL_(\d+)$/))!=null&&it[1]?parseInt(E.match(/_BOLL_(\d+)$/)[1],10):1;return H-ue});b(Vo,j(I.map(([D,E])=>{var H,ue,Fe,it,yo,ao,Et;return{id:cn(),paneId:h,period:E.params&&E.params[0]||20,stdDev:E.params&&E.params[1]||2,styles:{fillColor:((H=E.bollingerStyles)==null?void 0:H.fillColor)||"#2196F3",fillOpacity:((ue=E.bollingerStyles)==null?void 0:ue.fillOpacity)??5,upperColor:((Fe=E.bollingerStyles)==null?void 0:Fe.upperColor)||"#f23645",middleColor:((it=E.bollingerStyles)==null?void 0:it.middleColor)||"#2962ff",lowerColor:((yo=E.bollingerStyles)==null?void 0:yo.lowerColor)||"#089981",thickness:((ao=E.bollingerStyles)==null?void 0:ao.thickness)||1,lineStyle:((Et=E.bollingerStyles)==null?void 0:Et.lineStyle)||"solid"}}})))}else b(Vo,j([{id:cn(),paneId:h,period:n(R)||20,stdDev:n(N)||2,styles:{fillColor:n(S)||"#2196F3",fillOpacity:n(L)??5,upperColor:n(T)||"#f23645",middleColor:n(P)||"#2962ff",lowerColor:n(A)||"#089981",thickness:n(F)||1,lineStyle:n(B)||"solid"}}]));const M=n(Vo)[0];M&&(b(R,j(M.period)),b(N,j(M.stdDev)),b(S,j(M.styles.fillColor)),b(L,j(M.styles.fillOpacity)),b(T,j(M.styles.upperColor)),b(P,j(M.styles.middleColor)),b(A,j(M.styles.lowerColor)),b(F,j(M.styles.thickness)),b(B,j(M.styles.lineStyle))),To()}function gu(){var M;if(!n(Ge)||!s())return;console.log("🔄 Applying AO changes in real-time, groups:",n(Oo).length);const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="AO").sort((I,D)=>I===`${i().editPaneId}_AO`?-1:D===`${i().editPaneId}_AO`?1:I.localeCompare(D));console.log("🔍 Existing AO keys:",h);const x=n(Oo).length;if(h.length>x){console.log(`🗑️ Removing ${h.length-x} excess AO indicators`);for(let I=x;I<h.length;(I+=1)-1){const D=h[I],E=r().saveInds[D];if(E&&E.pane_id){console.log("🗑️ Removing AO indicator from pane:",E.pane_id);try{(M=s())==null||M.removeIndicator({paneId:E.pane_id,name:"AO"})}catch(H){console.log("Error removing excess AO indicator:",H)}}}}n(Oo).forEach((I,D)=>{var ue,Fe,it;const E=[I.shortPeriod,I.longPeriod],H={bars:[{upColor:I.styles.increasing.color,downColor:I.styles.decreasing.color,noChangeColor:"#888888"}]};if(D===0)console.log("🔄 Updating first AO indicator in pane:",i().editPaneId),(ue=s())==null||ue.overrideIndicator({name:"AO",calcParams:E,styles:H,paneId:i().editPaneId});else{const yo=`pane_AO_${D+1}_AO`,ao=h.find(Et=>Et===yo);if(ao){const Et=r().saveInds[ao];Et&&Et.pane_id&&(console.log(`🔄 Updating existing AO ${D+1} in pane:`,Et.pane_id),(Fe=s())==null||Fe.overrideIndicator({name:"AO",calcParams:E,styles:H,paneId:Et.pane_id}))}else{const Et=`pane_AO_${D+1}`;console.log(`🆕 Creating new AO ${D+1} with pane ID:`,Et),(it=s())==null||it.createIndicator({name:"AO",calcParams:E,styles:H},!0,{id:Et})}}}),d.update(I=>(Object.keys(I.saveInds).forEach(D=>{I.saveInds[D].name==="AO"&&delete I.saveInds[D]}),n(Oo).forEach((D,E)=>{const H=E===0?`${i().editPaneId}_AO`:`pane_AO_${E+1}_AO`,ue=E===0?i().editPaneId:`pane_AO_${E+1}`;console.log(`💾 Saving AO group ${E+1} with key:`,H),I.saveInds[H]={name:"AO",aoGroup:D,pane_id:ue,groupIndex:E,aoGroups:E===0?[...n(Oo)]:void 0,params:[D.shortPeriod,D.longPeriod]}}),I))}function nh(h){!n(Ge)||n(Oo).length<=1||!n(Oo).find(M=>M.id===h)||(n(Oo).findIndex(M=>M.id===h),b(Oo,j(n(Oo).filter(M=>M.id!==h))),gu())}function hf(){const h=`${i().editPaneId}_CR`,x=r().saveInds[h];x&&(b(ru,j(x.crPeriod||26)),b(qu,j(x.crMa1Period||10)),b(Mu,j(x.crMa2Period||20)),b(Ad,j(x.crMa3Period||40)),b(_d,j(x.crMa4Period||60)),b(Xc,j(x.crColor||"#FF6B35")),b(sp,j(x.crMa1Color||"#2196F3")),b(wp,j(x.crMa2Color||"#4CAF50")),b(pu,j(x.crMa3Color||"#FF9800")),b(Kp,j(x.crMa4Color||"#9C27B0")),b(vu,j(x.crThickness||2)),b(yd,j(x.crMa1Thickness||1)),b(kp,j(x.crMa2Thickness||1)),b(Sp,j(x.crMa3Thickness||1)),b(Zp,j(x.crMa4Thickness||1)),b(np,j(x.crLineStyle||"solid")),b(ip,j(x.crMa1LineStyle||"solid")),b(Xp,j(x.crMa2LineStyle||"solid")),b(Kd,j(x.crMa3LineStyle||"solid")),b(Mt,j(x.crMa4LineStyle||"solid")))}function uv(h,x){return M=>{b(U,j(h)),b(G,j(x)),b(V,j({x:window.innerWidth/2,y:window.innerHeight/2})),b($,!0)}}function Fv(h){return x=>{b(se,j(h)),b(le,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(Z,!0)}}function _f(h,x){return M=>{b(K,j(h)),b(Q,j(x)),b(Y,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(ie,!0)}}function yf(h){return x=>{b(be,j(h)),b(ge,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(De,!0)}}function ua(h,x){return M=>{b(pe,j(h)),b(rt,j(x)),b(tc,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(or,!0)}}function bf(h,x){return M=>{b(he,h*3+x),b(ze,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(Pe,!0)}}function xf(h,x){return M=>{if(b(Ae,j(h)),b(ee,j(x)),b(ye,j({x:M.clientX,y:M.clientY})),b(Je,!0),n(Ce).length>h&&(x==="histogram"||x==="histogram-down")){const I=n(Ce)[h];x==="histogram"?I.styles.histogram.upColor=k(I.styles.histogram.upColor||"#26a69a",70):I.styles.histogram.downColor=k(I.styles.histogram.downColor||"#ef5350",70),Qr(h)}}}function pv(h){return x=>{if(b(Qe,j(h)),x.currentTarget&&x.currentTarget instanceof Element){const M=x.currentTarget.getBoundingClientRect();b(ke,j({x:M.left+M.width/2,y:M.bottom+5}))}else b(ke,j({x:window.innerWidth/2,y:window.innerHeight/2}));b(xe,!0)}}function R0(h){return x=>{if(b(Qe,j(h)),x.currentTarget&&x.currentTarget instanceof Element){const M=x.currentTarget.getBoundingClientRect();b(Ie,j({x:M.left+M.width/2,y:M.bottom+5}))}else b(Ie,j({x:window.innerWidth/2,y:window.innerHeight/2}));b(He,!0)}}function ih(h){return x=>{if(b(Qe,j(h)),x.currentTarget&&x.currentTarget instanceof Element){const M=x.currentTarget.getBoundingClientRect();b(J,j({x:M.left+M.width/2,y:M.bottom+5}))}else b(J,j({x:window.innerWidth/2,y:window.innerHeight/2}));b(ne,!0)}}function rh(h){return x=>{if(b(Qe,j(h)),x.currentTarget&&x.currentTarget instanceof Element){const M=x.currentTarget.getBoundingClientRect();b(ft,j({x:M.left+M.width/2,y:M.bottom+5}))}else b(ft,j({x:window.innerWidth/2,y:window.innerHeight/2}));b(qe,!0)}}function Wd(h,x){return M=>{b(Lt,j(h)),b(It,j(x)),b(ct,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(Oe,!0)}}function ah(h){return x=>{b(Mo,j(h)),b(pt,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(zt,!0)}}function vv(h){return x=>{b(Fo,j(h)),b(en,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(Xo,!0)}}function Dv(h){return x=>{b(Zt,j(h)),b(cs,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(Eo,!0)}}function O0(h){return x=>{b(rr,j(h)),b(wr,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(rn,!0)}}function V0(h){return x=>{b(ii,j(h)),b(jr,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(ar,!0)}}function qd(h){return x=>{b(el,j(h)),b(Sl,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(ml,!0)}}function lp(h){return x=>{b(Kl,j(h)),b(qa,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(Qa,!0)}}function wf(h){return x=>{b(et,j(h)),b(nt,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(Le,!0)}}function W0(h){return x=>{b(ut,j(h)),b(uo,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(ht,!0)}}function Ev(h,x=0){return M=>{b(fo,j(x)),b(Jt,j(h)),b(Wr,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(ll,!0)}}function q0(h){return x=>{b(ko,j(h)),b(so,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(lo,!0)}}function kf(h){return x=>{b(ro,j(h)),b(Xn,j({x:window.innerWidth/2,y:window.innerHeight/2})),b(ts,!0)}}Cc(l,h=>h.modalIndCfg).subscribe(()=>{if(!i().editIndName)return;if(n(Ts)){Lv();const M=Rm.ICHIMOKU||[];_.splice(0,_.length,...M);return}if(n(ca)){const I=`${i().editPaneId||"candle_pane"}_ZIGZAG`,D=Object.keys(r().saveInds).filter(H=>{var ue;return H.startsWith(I)&&((ue=r().saveInds[H])==null?void 0:ue.name)==="ZIGZAG"}).sort((H,ue)=>{const Fe=it=>{const yo=it.match(/_ZIGZAG(?:_(\d+))?$/);return yo&&yo[1]?parseInt(yo[1],10):1};return Fe(H)-Fe(ue)});b(Qs,j([])),D.length>0?D.forEach(H=>{var ao,Et,Ls,Mn;const ue=r().saveInds[H],Fe=((Et=(ao=ue==null?void 0:ue.styles)==null?void 0:ao.lines)==null?void 0:Et[0])||{},it=Array.isArray(Fe.dashedValue)?Fe.dashedValue.join(","):"",yo=Fe.style===Ee.Solid?"solid":it==="2,6"?"dotted":"dashed";n(Qs).push({id:cn(),deviation:Number(((Ls=ue==null?void 0:ue.params)==null?void 0:Ls[0])??5),depth:Number(((Mn=ue==null?void 0:ue.params)==null?void 0:Mn[1])??5),styles:{color:Fe.color??"#2962FF",thickness:Number(Fe.size??2),lineStyle:yo}})}):b(Qs,j([{id:cn(),deviation:5,depth:5,styles:{color:"#2962FF",thickness:2,lineStyle:"solid"}}]));const E=n(Qs)[0];p.splice(0,p.length,E.deviation,E.depth),b(Iu,j(E.styles.color)),b(uu,j(E.styles.thickness)),b(Vd,j(E.styles.lineStyle));return}if(n(Xr)){dd();return}if(n(js)){mn();return}if(n(Vl)){Oc();return}if(n(ul)){fi();return}if(n(at)){_i();return}if(n(So)){Ys();return}if(n(qt)){Xd();return}if(n(Ci)){Ma();return}if(n(Ki)){Ml();return}if(n(Cl)){au();return}if(n(_s)){Gt();return}if(n(Zl)){io();return}if(n(In)){ws();return}if(n(za)){_o();return}if(n(zr)){hn();return}if(n(hl)){rc();return}if(n(fa)){bd();return}if(n(sc)){Hr();return}if(n(Ge)){jc();return}if(n(za)){hf();return}if(n(Dr)){ap();return}const h=`${i().editPaneId}_${i().editIndName}`,x=r().saveInds[h];if(x&&x.fields&&!n(Dr))_.splice(0,_.length,...x.fields),p.splice(0,p.length,...x.params||[]),y.splice(0,y.length,...x.styles||[]);else{const M=Rm[i().editIndName]||[];if(n(Dr)){_.splice(0,_.length,...M);const I=M.map(D=>D.default);p.splice(0,p.length,...I),x&&x.params&&x.params.length>=2&&(p[0]=x.params[0],p[1]=x.params[1])}else if(_.splice(0,_.length,...M),x&&x.params)p.splice(0,p.length,...x.params),y.splice(0,y.length,...x.styles||[]),(n(fn)||n(Io))&&_.length>p.length&&_.splice(p.length,_.length-p.length);else{const I=M.filter(D=>D.type!=="color").map(D=>D.default);p.splice(0,p.length,...I)}}if(n(Ci)){for(;y.length<2;)y.length===0?y.push({color:"#2563eb",thickness:1,lineStyle:"solid"}):y.push({color:"#dc2626",thickness:1,lineStyle:"solid"});for(;y.length>2;)y.pop()}else{for(;y.length<p.length;)y.push({color:"#2563eb",thickness:1,lineStyle:"solid"});for(;y.length>p.length;)y.pop()}}),Cc(l,h=>h.clearCciGroups).subscribe(h=>{h>0&&_l()}),Cc(l,h=>h.clearEmvGroups).subscribe(h=>{h>0&&yl()}),Cc(l,h=>h.clearMtmGroups).subscribe(h=>{h>0&&Sr()}),Cc(l,h=>h.clearObvGroups).subscribe(h=>{h>0&&Ba()}),Cc(l,h=>h.clearPsyGroups).subscribe(h=>{h>0&&Pt()}),Cc(l,h=>h.clearPvtGroups).subscribe(h=>{h>0&&xs()}),Cc(l,h=>h.clearRocGroups).subscribe(h=>{h>0&&na()}),Cc(l,h=>h.clearVolGroups).subscribe(h=>{h>0&&fs()}),Cc(l,h=>h.clearWrGroups).subscribe(h=>{h>0&&rs()});function $v(h){n(Dr)||p.length<=1||(p.splice(h,1),_.splice(h,1),y.splice(h,1),n(fn)?xa():n(Io)&&Hs())}function jv(){const h=s();if(!h)return;const x=[6],M=h.createIndicator({name:"BIAS",calcParams:x,createTooltipDataSource:({indicator:H})=>{const ue=[H.visible?1:0,2,3],Fe=h.getStyles().indicator.tooltip;return{icons:ue.map(yo=>Fe.features[yo])}}},!1,{axis:{gap:{bottom:2}}});if(!M)return;const I=M,D={name:"BIAS",pane_id:I,params:x},E=`${I}_BIAS`;d.update(H=>(H.saveInds[E]=D,H)),a(!1)}function fv(){const h=s();if(!h)return;const x=[5,34],M=h.createIndicator({name:"AO",calcParams:x,createTooltipDataSource:({indicator:H})=>{const ue=[H.visible?1:0,2,3],Fe=h.getStyles().indicator.tooltip;return{icons:ue.map(yo=>Fe.features[yo])}}},!1,{axis:{gap:{bottom:2}}});if(M){const H=h.getStyles();h.setStyles({...H,indicator:{...H.indicator,bars:[{upColor:"#8B5CF6",downColor:"#EF4444",noChangeColor:"#8B5CF6"}]}})}if(!M)return;const I=M,D={name:"AO",pane_id:I,params:x},E=`${I}_AO`;d.update(H=>(H.saveInds[E]=D,H)),a(!1)}function gv(){const h=s();if(!h)return;const x=[14],M=h.createIndicator({name:"WR",calcParams:x,createTooltipDataSource:({indicator:H})=>{const ue=[H.visible?1:0,2,3],Fe=h.getStyles().indicator.tooltip;return{icons:ue.map(yo=>Fe.features[yo])}}},!1,{axis:{gap:{bottom:2}}});if(!M)return;const I=M,D={name:"WR",pane_id:I,params:x},E=`${I}_WR`;d.update(H=>(H.saveInds[E]=D,H)),a(!1)}function zv(){const h=s();if(!h)return;const x=[15,9],M=h.createIndicator({name:"TRIX",calcParams:x,createTooltipDataSource:({indicator:H})=>{const ue=[H.visible?1:0,2,3],Fe=h.getStyles().indicator.tooltip;return{icons:ue.map(yo=>Fe.features[yo])}}},!1,{axis:{gap:{bottom:2}}});if(!M)return;const I=M,D={name:"TRIX",pane_id:I,params:x},E=`${I}_TRIX`;d.update(H=>(H.saveInds[E]=D,H)),a(!1)}function U0(){var M;if(!n(za))return;const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="CR").sort((I,D)=>I===`${i().editPaneId}_CR`?-1:D===`${i().editPaneId}_CR`?1:I.localeCompare(D));console.log("🔧 Applying CR changes. Existing keys:",h),console.log("🔧 Current CR groups:",n(li).length);const x=n(li).length;if(h.length>x)for(let I=x;I<h.length;(I+=1)-1){const D=h[I],E=r().saveInds[D];try{console.log("🗑️ Removing excess CR indicator from pane:",E.pane_id),(M=s())==null||M.removeIndicator({paneId:E.pane_id,name:"CR"})}catch(H){console.log("❌ Error removing excess CR indicator:",H)}delete r().saveInds[D]}n(li).forEach((I,D)=>{var ue,Fe,it;const E=[I.crPeriod,I.crMa1Period,I.crMa2Period,I.crMa3Period,I.crMa4Period],H={lines:[{color:I.styles.cr.color,size:I.styles.cr.thickness,style:I.styles.cr.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.cr.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:I.styles.ma1.color,size:I.styles.ma1.thickness,style:I.styles.ma1.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.ma1.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:I.styles.ma2.color,size:I.styles.ma2.thickness,style:I.styles.ma2.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.ma2.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:I.styles.ma3.color,size:I.styles.ma3.thickness,style:I.styles.ma3.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.ma3.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:I.styles.ma4.color,size:I.styles.ma4.thickness,style:I.styles.ma4.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.ma4.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1}]};if(D===0)console.log("🔄 Updating first CR in pane:",i().editPaneId),(ue=s())==null||ue.overrideIndicator({name:"CR",calcParams:E,styles:H,paneId:i().editPaneId});else{const yo=`pane_CR_${D+1}_CR`,ao=h.find(Et=>Et===yo);if(ao){const Et=r().saveInds[ao];console.log("🔄 Updating existing CR in pane:",Et.pane_id),(Fe=s())==null||Fe.overrideIndicator({name:"CR",calcParams:E,styles:H,paneId:Et.pane_id})}else{const Et=`pane_CR_${D+1}`;console.log("🆕 Creating new CR in pane:",Et);const Ls=(it=s())==null?void 0:it.createIndicator({name:"CR",calcParams:E,styles:H},!0,{id:Et});console.log("✅ Created new CR indicator with ID:",Ls,"in pane:",Et)}}}),d.update(I=>(Object.keys(I.saveInds).forEach(D=>{I.saveInds[D].name==="CR"&&delete I.saveInds[D]}),n(li).forEach((D,E)=>{const H=E===0?`${i().editPaneId}_CR`:`pane_CR_${E+1}_CR`,ue=E===0?i().editPaneId:`pane_CR_${E+1}`,Fe={name:"CR",crGroup:D,pane_id:ue,groupIndex:E,crGroups:E===0?[...n(li)]:void 0,params:[D.crPeriod,D.crMa1Period,D.crMa2Period,D.crMa3Period,D.crMa4Period]};I.saveInds[H]=Fe,console.log("💾 Saved CR group",E,"with key:",H,"and pane ID:",ue)}),I)),l.update(I=>(I.editIndName="",I.editPaneId="",I.modalIndCfg=!1,I)),a(!1)}function K0(){n(Dt).forEach((h,x)=>{st(x)}),d.update(h=>(Object.keys(h.saveInds).forEach(x=>{h.saveInds[x].name==="MACD"&&delete h.saveInds[x]}),n(Dt).forEach((x,M)=>{const I=M===0?`${i().editPaneId}_MACD`:`pane_MACD_${M+1}_MACD`,D=M===0?i().editPaneId:x.actualPaneId||`pane_MACD_${M+1}`;h.saveInds[I]={name:"MACD",macdGroup:x,pane_id:D,groupIndex:M,params:[x.fastPeriod,x.slowPeriod,x.signalPeriod]}}),h)),console.log("🔄 Clearing edit state and closing popup..."),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,console.log("✅ Context updated - modalIndCfg set to false"),h)),a(!1)}function Hd(){if(n(at)){n(jt).forEach((h,x)=>{h.paneId&&ol(x)}),d.update(h=>{const x=`${i().editPaneId}_WR`,M={name:"WR",wrGroups:n(jt),pane_id:i().editPaneId};return h.saveInds[x]=M,n(jt).forEach((I,D)=>{const E=D===0?`${i().editPaneId}_WR_single`:`WR_${D+1}`,H={name:"WR",wrGroup:I,pane_id:D===0?i().editPaneId:`new_pane_${D}`,groupIndex:D};h.saveInds[E]=H}),h});try{console.log("🔄 Clearing edit state and closing popup..."),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,console.log("✅ Context updated - modalIndCfg set to false"),h)),a(!1),console.log("✅ Popup show flag set to false - handleKdjConfirm completed successfully")}catch(h){console.error("❌ Error in handleKdjConfirm:",h),console.log("🔄 Forcing popup close due to error..."),l.update(x=>(x.editIndName="",x.editPaneId="",x.modalIndCfg=!1,x)),a(!1),console.log("✅ Popup forcefully closed after error")}}}function Au(){n(So)&&(n(Co).forEach((h,x)=>{var D;const M=[h.period,h.shortPeriod,h.longPeriod],I={lines:[{color:h.styles.vr.color,size:h.styles.vr.thickness,style:h.styles.vr.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:h.styles.vr.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:h.styles.vrShort.color,size:h.styles.vrShort.thickness,style:h.styles.vrShort.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:h.styles.vrShort.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:h.styles.vrLong.color,size:h.styles.vrLong.thickness,style:h.styles.vrLong.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:h.styles.vrLong.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1}]};h.paneId&&((D=s())==null||D.overrideIndicator({name:"VR",calcParams:M,styles:I,paneId:h.paneId}),console.log(`✅ Updated VR indicator in pane: ${h.paneId}`))}),d.update(h=>(n(Co).forEach((x,M)=>{const I=`${x.paneId}_VR`,D={name:"VR",vrGroup:x,pane_id:x.paneId,params:[x.period,x.shortPeriod,x.longPeriod],groupIndex:M};h.saveInds[I]=D,console.log(`💾 Saved VR group to: ${I}`)}),h)),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1))}function uh(){n(on)&&(n(Ce).forEach((h,x)=>{var D;const M=[h.period],I={bars:[{upColor:h.styles.histogram.upColor,downColor:h.styles.histogram.downColor,noChangeColor:h.styles.histogram.upColor}],lines:[{color:h.styles.ema.color,size:h.styles.ema.thickness,style:h.styles.ema.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:h.styles.ema.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1,visible:h.styles.ema.visible===!0}]};h.paneId&&((D=s())==null||D.overrideIndicator({name:"VOL",calcParams:M,styles:I,paneId:h.paneId}),console.log(`✅ Updated Volume indicator in pane: ${h.paneId}`))}),d.update(h=>(n(Ce).forEach((x,M)=>{const I=`${x.paneId}_VOL`,D={name:"VOL",volGroup:x,pane_id:x.paneId,params:[x.period],groupIndex:M};h.saveInds[I]=D,console.log(`💾 Saved Volume group to: ${I}`)}),h)),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1))}function ph(){n(qt)&&(console.log("🔧 Applying BBI changes. Current BBI groups:",n(Ho).length),n(Ho).forEach((h,x)=>{var ue;const M=[h.period1,h.period2,h.period3,h.period4],D=(Fe=>{switch(Fe){case"dashed":return{style:Ee.Dashed,dashedValue:[4,4]};case"dotted":return{style:Ee.Dashed,dashedValue:[2,2]};default:return{style:Ee.Solid,dashedValue:[2,2]}}})(h.lineStyle),E={lines:[{color:h.color,size:h.thickness,style:D.style,dashedValue:D.dashedValue,smooth:!1}]},H=h.paneId||(x===0?i().editPaneId:`pane_BBI_${x+1}`);console.log("🔄 Updating BBI group",x,"in pane:",H),(ue=s())==null||ue.overrideIndicator({name:"BBI",calcParams:M,styles:E,paneId:H}),h.paneId||(h.paneId=H)}),d.update(h=>(Object.keys(h.saveInds).forEach(x=>{h.saveInds[x].name==="BBI"&&delete h.saveInds[x]}),n(Ho).forEach((x,M)=>{const I=`${x.paneId}_BBI`,D={name:"BBI",bbiGroup:x,pane_id:x.paneId,groupIndex:M,bbiGroups:M===0?[...n(Ho)]:void 0,params:[x.period1,x.period2,x.period3,x.period4]};h.saveInds[I]=D,console.log("💾 Saved BBI group",M,"with key:",I,"and pane ID:",x.paneId)}),h)),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1))}function Bv(){var h;if(!n(Vl)){console.warn("⚠️ handleEmvConfirm called but not in EMV mode");return}try{if(!n(ur)||n(ur).length===0){console.error("❌ No EMV groups to process");return}const x=n(ur).filter(D=>!(!D||typeof D!="object"||typeof D.period!="number"||D.period<=0||typeof D.period2!="number"||D.period2<=0||typeof D.color!="string"||!D.color||typeof D.thickness!="number"||D.thickness<=0||typeof D.lineStyle!="string"||!D.lineStyle));if(x.length===0){console.error("❌ No valid EMV groups found");return}x.length!==n(ur).length&&(console.warn(`⚠️ ${n(ur).length-x.length} invalid EMV groups filtered out`),b(ur,j(x)));const M=Object.keys(r().saveInds).filter(D=>r().saveInds[D]&&r().saveInds[D].name==="EMV").sort((D,E)=>D===`${i().editPaneId}_EMV`?-1:E===`${i().editPaneId}_EMV`?1:D.localeCompare(E));console.log("🔧 Applying EMV changes. Existing keys:",M),console.log("🔧 Current EMV groups:",n(ur).length);const I=n(ur).length;if(M.length>I)for(let D=I;D<M.length;(D+=1)-1){const E=M[D],H=r().saveInds[E];if(H&&H.pane_id)try{console.log("🗑️ Removing excess EMV indicator from pane:",H.pane_id),(h=s())==null||h.removeIndicator({paneId:H.pane_id,name:"EMV"})}catch(ue){console.log("❌ Error removing excess EMV indicator:",ue)}}n(ur).forEach((D,E)=>{var Fe,it,yo;const H=[D.period,D.period2],ue={lines:[{color:D.color,size:D.thickness,style:D.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:D.lineStyle==="dashed"?[4,4]:D.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(E===0)console.log("🔄 Updating first EMV in pane:",i().editPaneId),(Fe=s())==null||Fe.overrideIndicator({name:"EMV",calcParams:H,styles:ue,paneId:i().editPaneId});else{const ao=`pane_EMV_${E+1}_EMV`,Et=M.find(Ls=>Ls===ao);if(Et){const Ls=r().saveInds[Et];Ls&&Ls.pane_id&&(console.log("🔄 Updating existing EMV in pane:",Ls.pane_id),(it=s())==null||it.overrideIndicator({name:"EMV",calcParams:H,styles:ue,paneId:Ls.pane_id}))}else{const Ls=`pane_EMV_${E+1}`;console.log("🆕 Creating new EMV in pane:",Ls);const Mn=(yo=s())==null?void 0:yo.createIndicator({name:"EMV",calcParams:H,styles:ue},!0,{id:Ls});Mn&&console.log("✅ Created new EMV indicator with ID:",Mn,"in pane:",Ls)}}}),d.update(D=>{try{Object.keys(D.saveInds).forEach(E=>{D.saveInds[E]&&D.saveInds[E].name==="EMV"&&delete D.saveInds[E]}),n(ur).forEach((E,H)=>{try{const ue=H===0?`${i().editPaneId}_EMV`:`pane_EMV_${H+1}_EMV`,Fe=H===0?i().editPaneId:`pane_EMV_${H+1}`;if(!ue||!Fe){console.error(`❌ Invalid save key or pane ID for EMV group ${H}`);return}const it={name:"EMV",emvGroup:E,pane_id:Fe,groupIndex:H,emvGroups:H===0?[...n(ur)]:void 0,params:[E.period,E.period2]};D.saveInds[ue]=it,console.log("💾 Saved EMV group",H,"with key:",ue,"and pane ID:",Fe)}catch(ue){console.error(`❌ Error saving EMV group ${H}:`,ue)}})}catch(E){console.error("❌ Error in EMV save operation:",E)}return D}),l.update(D=>(D.editIndName="",D.editPaneId="",D.modalIndCfg=!1,D)),a(!1),console.log("✅ EMV configuration completed successfully")}catch(x){console.error("❌ Critical error in handleEmvConfirm:",x)}}function Qp(){var h;if(!n(ul)){console.warn("⚠️ handleMtmConfirm called but not in MTM mode");return}try{if(!n(kn)||n(kn).length===0){console.error("❌ No MTM groups to process");return}const x=n(kn).filter(D=>!(!D||typeof D!="object"||typeof D.period!="number"||D.period<=0||typeof D.color!="string"||!D.color||typeof D.thickness!="number"||D.thickness<=0||typeof D.lineStyle!="string"||!D.lineStyle));if(x.length===0){console.error("❌ No valid MTM groups found");return}x.length!==n(kn).length&&(console.warn(`⚠️ ${n(kn).length-x.length} invalid MTM groups filtered out`),b(kn,j(x)));const M=Object.keys(r().saveInds).filter(D=>r().saveInds[D]&&r().saveInds[D].name==="MTM").sort((D,E)=>D===`${i().editPaneId}_MTM`?-1:E===`${i().editPaneId}_MTM`?1:D.localeCompare(E));console.log("🔧 Applying MTM changes. Existing keys:",M),console.log("🔧 Current MTM groups:",n(kn).length);const I=n(kn).length;if(M.length>I)for(let D=I;D<M.length;(D+=1)-1){const E=M[D],H=r().saveInds[E];if(H&&H.pane_id)try{console.log("🗑️ Removing excess MTM indicator from pane:",H.pane_id),(h=s())==null||h.removeIndicator({paneId:H.pane_id,name:"MTM"})}catch(ue){console.log("❌ Error removing excess MTM indicator:",ue)}}n(kn).forEach((D,E)=>{var Fe,it,yo;const H=[D.period],ue={lines:[{color:D.color,size:D.thickness,style:D.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:D.lineStyle==="dashed"?[4,4]:D.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(E===0)console.log("🔄 Updating first MTM in pane:",i().editPaneId),(Fe=s())==null||Fe.overrideIndicator({name:"MTM",calcParams:H,styles:ue,paneId:i().editPaneId});else{const ao=`pane_MTM_${E+1}_MTM`,Et=M.find(Ls=>Ls===ao);if(Et){const Ls=r().saveInds[Et];Ls&&Ls.pane_id&&(console.log("🔄 Updating existing MTM in pane:",Ls.pane_id),(it=s())==null||it.overrideIndicator({name:"MTM",calcParams:H,styles:ue,paneId:Ls.pane_id}))}else{const Ls=`pane_MTM_${E+1}`;console.log("🆕 Creating new MTM in pane:",Ls);const Mn=(yo=s())==null?void 0:yo.createIndicator({name:"MTM",calcParams:H,styles:ue},!0,{id:Ls});Mn&&console.log("✅ Created new MTM indicator with ID:",Mn,"in pane:",Ls)}}}),d.update(D=>{try{Object.keys(D.saveInds).forEach(E=>{D.saveInds[E]&&D.saveInds[E].name==="MTM"&&delete D.saveInds[E]}),n(kn).forEach((E,H)=>{try{const ue=H===0?`${i().editPaneId}_MTM`:`pane_MTM_${H+1}_MTM`,Fe=H===0?i().editPaneId:`pane_MTM_${H+1}`;if(!ue||!Fe){console.error(`❌ Invalid save key or pane ID for MTM group ${H}`);return}const it={name:"MTM",mtmGroup:E,pane_id:Fe,groupIndex:H,mtmGroups:H===0?[...n(kn)]:void 0,params:[E.period]};D.saveInds[ue]=it,console.log("💾 Saved MTM group",H,"with key:",ue,"and pane ID:",Fe)}catch(ue){console.error(`❌ Error saving MTM group ${H}:`,ue)}})}catch(E){console.error("❌ Error in MTM save operation:",E)}return D}),l.update(D=>(D.editIndName="",D.editPaneId="",D.modalIndCfg=!1,D)),a(!1),console.log("✅ MTM configuration completed successfully")}catch(x){console.error("❌ Critical error in handleMtmConfirm:",x)}}function Z0(){var M;if(!n(Ki))return;const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="BIAS").sort((I,D)=>I===`${i().editPaneId}_BIAS`?-1:D===`${i().editPaneId}_BIAS`?1:I.localeCompare(D));console.log("🔧 Applying BIAS changes. Existing keys:",h),console.log("🔧 Current BIAS groups:",n(Ot).length);const x=n(Ot).length;if(h.length>x)for(let I=x;I<h.length;(I+=1)-1){const D=h[I],E=r().saveInds[D];if(E&&E.pane_id)try{console.log("🗑️ Removing excess BIAS indicator from pane:",E.pane_id),(M=s())==null||M.removeIndicator({paneId:E.pane_id,name:"BIAS"})}catch(H){console.log("❌ Error removing excess BIAS indicator:",H)}}n(Ot).forEach((I,D)=>{var ue,Fe,it;const E=[I.period],H={lines:[{color:I.color,size:I.thickness,style:I.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:I.lineStyle==="dashed"?[4,4]:I.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]};if(D===0)console.log("🔄 Updating first BIAS in pane:",i().editPaneId),(ue=s())==null||ue.overrideIndicator({name:"BIAS",calcParams:E,styles:H,paneId:i().editPaneId});else{const yo=`pane_BIAS_${D+1}_BIAS`,ao=h.find(Et=>Et===yo);if(ao){const Et=r().saveInds[ao];Et&&Et.pane_id&&(console.log("🔄 Updating existing BIAS in pane:",Et.pane_id),(Fe=s())==null||Fe.overrideIndicator({name:"BIAS",calcParams:E,styles:H,paneId:Et.pane_id}))}else{const Et=`pane_BIAS_${D+1}`;console.log("🆕 Creating new BIAS in pane:",Et);const Ls=(it=s())==null?void 0:it.createIndicator({name:"BIAS",calcParams:E,styles:H},!0,{id:Et});Ls&&console.log("✅ Created new BIAS indicator with ID:",Ls,"in pane:",Et)}}}),d.update(I=>(Object.keys(I.saveInds).forEach(D=>{I.saveInds[D].name==="BIAS"&&delete I.saveInds[D]}),n(Ot).forEach((D,E)=>{const H=E===0?`${i().editPaneId}_BIAS`:`pane_BIAS_${E+1}_BIAS`,ue=E===0?i().editPaneId:`pane_BIAS_${E+1}`,Fe={name:"BIAS",biasGroup:D,pane_id:ue,groupIndex:E,biasGroups:E===0?[...n(Ot)]:void 0,params:[D.period]};I.saveInds[H]=Fe,console.log("💾 Saved BIAS group",E,"with key:",H,"and pane ID:",ue)}),I)),l.update(I=>(I.editIndName="",I.editPaneId="",I.modalIndCfg=!1,I)),a(!1),console.log("✅ BIAS configuration saved successfully")}function X0(){if(!n(Cl))return;const h=Object.keys(r().saveInds).filter(E=>r().saveInds[E].name==="CCI").sort((E,H)=>E===`${i().editPaneId}_CCI`?-1:H===`${i().editPaneId}_CCI`?1:E.localeCompare(H));console.log("🔧 Applying CCI changes. Existing keys:",h),console.log("🔧 Current CCI groups:",n(Pi).length);const x=new Map,M=[],I=new Set;n(Pi).forEach((E,H)=>{let ue=null;for(const Fe of h){if(I.has(Fe))continue;const it=r().saveInds[Fe];if(it&&it.cciGroup&&(it.cciGroup.id===E.id||it.cciGroup.period===E.period&&it.cciGroup.color===E.color&&it.cciGroup.thickness===E.thickness&&it.cciGroup.lineStyle===E.lineStyle)){ue=Fe,I.add(Fe);break}}if(!ue){let Fe=H+1,it;do it=Fe===1?`${i().editPaneId}_CCI`:`pane_CCI_${Fe}_CCI`,Fe+=1;while(I.has(it)||h.includes(it));ue=it,I.add(ue)}x.set(E.id,ue),M.push(ue)});const D=h.filter(E=>!M.includes(E));D.forEach(E=>{var ue;const H=r().saveInds[E];if(H&&H.pane_id)try{console.log("🗑️ Removing CCI indicator from pane:",H.pane_id,"key:",E),(ue=s())==null||ue.removeIndicator({paneId:H.pane_id,name:"CCI"})}catch(Fe){console.log("❌ Error removing CCI indicator:",Fe)}}),n(Pi).forEach((E,H)=>{var ao,Et;const ue=[E.period],Fe={lines:[{color:E.color,size:E.thickness,style:E.lineStyle==="solid"?Ee.Solid:Ee.Dashed,dashedValue:E.lineStyle==="dashed"?[4,4]:E.lineStyle==="dotted"?[2,6]:[2,2],smooth:!1}]},it=x.get(E.id),yo=r().saveInds[it];if(yo&&yo.pane_id)console.log("🔄 Updating existing CCI in pane:",yo.pane_id,"with key:",it),(ao=s())==null||ao.overrideIndicator({name:"CCI",calcParams:ue,styles:Fe,paneId:yo.pane_id});else{const Ls=it===`${i().editPaneId}_CCI`?i().editPaneId:it.replace("_CCI","");console.log("🆕 Creating new CCI in pane:",Ls,"with key:",it);const Mn=(Et=s())==null?void 0:Et.createIndicator({name:"CCI",calcParams:ue,styles:Fe},!0,{id:Ls});Mn&&console.log("✅ Created new CCI indicator with ID:",Mn,"in pane:",Ls)}}),d.update(E=>(D.forEach(H=>{delete E.saveInds[H],console.log("🗑️ Deleted save data for key:",H)}),n(Pi).forEach((H,ue)=>{const Fe=x.get(H.id),it=Fe===`${i().editPaneId}_CCI`?i().editPaneId:Fe.replace("_CCI",""),yo={name:"CCI",cciGroup:H,pane_id:it,groupIndex:ue,cciGroups:ue===0?[...n(Pi)]:void 0,params:[H.period]};E.saveInds[Fe]=yo,console.log("💾 Saved CCI group",ue,"with key:",Fe,"and pane ID:",it)}),E)),l.update(E=>(E.editIndName="",E.editPaneId="",E.modalIndCfg=!1,E)),a(!1),console.log("✅ CCI configuration saved successfully")}function vh(){n(_s)&&(At(),d.update(h=>(Object.keys(h.saveInds).forEach(x=>{h.saveInds[x].name==="SAR"&&delete h.saveInds[x]}),n(is).forEach((x,M)=>{const I=M===0?"candle_pane_SAR":`SAR_${M+1}`,D={name:"SAR",sarGroup:x,pane_id:"candle_pane",groupIndex:M,sarGroups:M===0?[...n(is)]:void 0,params:[x.start,x.increment,x.maxValue]};h.saveInds[I]=D}),h)),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1))}function J0(){n(Zl)&&($o(),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1))}function ev(){var M;if(!n(In))return;const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="DMI").sort((I,D)=>I===`${i().editPaneId}_DMI`?-1:D===`${i().editPaneId}_DMI`?1:I.localeCompare(D));console.log("🔧 Applying DMI changes. Existing keys:",h),console.log("🔧 Current DMI groups:",n(Rs).length);const x=n(Rs).length;if(h.length>x)for(let I=x;I<h.length;(I+=1)-1){const D=h[I],E=r().saveInds[D];try{console.log("🗑️ Removing excess DMI indicator from pane:",E.pane_id),(M=s())==null||M.removeIndicator({paneId:E.pane_id,name:"DMI"})}catch(H){console.log("❌ Error removing excess DMI indicator:",H)}delete r().saveInds[D]}n(Rs).forEach((I,D)=>{var ue,Fe,it;const E=[I.diPeriod,I.adxPeriod],H={lines:[{color:I.styles.diPlus.color,size:I.styles.diPlus.thickness,style:I.styles.diPlus.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.diPlus.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:I.styles.diMinus.color,size:I.styles.diMinus.thickness,style:I.styles.diMinus.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.diMinus.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1},{color:I.styles.adx.color,size:I.styles.adx.thickness,style:I.styles.adx.lineStyle==="dashed"?Ee.Dashed:Ee.Solid,dashedValue:I.styles.adx.lineStyle==="dashed"?[4,4]:[2,2],smooth:!1}]};if(D===0)console.log("🔄 Updating first DMI in pane:",i().editPaneId),(ue=s())==null||ue.overrideIndicator({name:"DMI",calcParams:E,styles:H,paneId:i().editPaneId});else{const yo=`pane_DMI_${D+1}_DMI`,ao=h.find(Et=>Et===yo);if(ao){const Et=r().saveInds[ao];console.log("🔄 Updating existing DMI in pane:",Et.pane_id),(Fe=s())==null||Fe.overrideIndicator({name:"DMI",calcParams:E,styles:H,paneId:Et.pane_id})}else{const Et=`pane_DMI_${D+1}`;console.log("🆕 Creating new DMI in pane:",Et);const Ls=(it=s())==null?void 0:it.createIndicator({name:"DMI",calcParams:E,styles:H},!0,{id:Et});console.log("✅ Created new DMI indicator with ID:",Ls,"in pane:",Et)}}}),d.update(I=>(Object.keys(I.saveInds).forEach(D=>{I.saveInds[D].name==="DMI"&&delete I.saveInds[D]}),n(Rs).forEach((D,E)=>{const H=E===0?`${i().editPaneId}_DMI`:`pane_DMI_${E+1}_DMI`,ue=E===0?i().editPaneId:`pane_DMI_${E+1}`,Fe={name:"DMI",dmiGroup:D,pane_id:ue,groupIndex:E,dmiGroups:E===0?[...n(Rs)]:void 0,params:[D.diPeriod,D.adxPeriod]};I.saveInds[H]=Fe,console.log("💾 Saved DMI group",E,"with key:",H,"and pane ID:",ue)}),I)),l.update(I=>(I.editIndName="",I.editPaneId="",I.modalIndCfg=!1,I)),a(!1)}function cp(h){var H,ue;const x=n(Ut)[h];if(!x||!s()){console.warn("❌ updatePvtIndicator: Missing group or chart",{group:x,chart:!!s()});return}console.log("🔄 updatePvtIndicator called:",{groupIndex:h,group:x});let M=Ee.Solid,I=[2,2];x.lineStyle==="dashed"?(M=Ee.Dashed,I=[4,4]):x.lineStyle==="dotted"&&(M=Ee.Dashed,I=[2,2]);const E=((H=s())==null?void 0:H.getIndicators()).filter(Fe=>Fe.name==="PVT");if(console.log("📊 Found PVT indicators on chart:",E.length),console.log("📊 Looking for group index:",h),E.length>h){const Fe=E[h];console.log("✅ Found matching PVT indicator by index, updating styles...");const it=(ue=s())==null?void 0:ue.overrideIndicator({name:"PVT",paneId:Fe.paneId,styles:{lines:[{color:x.color,size:x.thickness,style:M,dashedValue:I,smooth:!1}]},figures:[{key:"pvt",title:"PVT: ",type:"line"}]});console.log("🎨 overrideIndicator result:",it),console.log("🎨 Applied styles:",{color:x.color,size:x.thickness,style:M,dashedValue:I});const yo=`${Fe.paneId}_PVT`;console.log("💾 Using save key:",yo),d.update(ao=>{ao.saveInds[yo]||(ao.saveInds[yo]={name:"PVT",pane_id:Fe.paneId,pvtGroups:[]}),ao.saveInds[yo].pvtGroups||(ao.saveInds[yo].pvtGroups=[]);const Et=ao.saveInds[yo].pvtGroups||[];for(;Et.length<=h;)Et.push({});return Et[h]={...x},ao.saveInds[yo].pvtGroups=Et,console.log("💾 Persisted PVT changes to save data:",yo,x),ao}),console.log("✅ PVT indicator updated successfully:",h,x)}else console.error("❌ PVT indicator not found on chart for group index:",h),console.log("📊 Available PVT indicators:",E.length),console.log("📊 Requested group index:",h)}function dp(h){if(!n(Ci)||!s()||h<0||h>=n(Ws).length)return;const x=n(Ws)[h];console.log("🔄 Updating TRIX indicator:",h,x);try{let I=function(ue){let Fe=Ee.Solid,it=[2,2];return ue==="dashed"?(Fe=Ee.Dashed,it=[4,4]):ue==="dotted"&&(Fe=Ee.Dashed,it=[2,2]),{lineStyle:Fe,dashedValue:it}},M=x.paneId||i().editPaneId;console.log("🔍 Using pane ID for TRIX update:",M,"for group:",h),s().removeIndicator({paneId:M,name:"TRIX"});const D=I(x.styles.trix.lineStyle),E=I(x.styles.signal.lineStyle);if(s().createIndicator({name:"TRIX",calcParams:[x.trixPeriod,x.signalPeriod],styles:{lines:[{color:x.styles.trix.color,size:x.styles.trix.thickness,style:D.lineStyle,dashedValue:D.dashedValue},{color:x.styles.signal.color,size:x.styles.signal.thickness,style:E.lineStyle,dashedValue:E.dashedValue}]}},M===i().editPaneId,{id:M})){const ue=`${M}_TRIX`;d.update(Fe=>(Fe.saveInds[ue]?Fe.saveInds[ue].params=[x.trixPeriod,x.signalPeriod]:Fe.saveInds[ue]={name:"TRIX",pane_id:M,params:[x.trixPeriod,x.signalPeriod]},Fe.saveInds[ue].trixGroup={...x},Fe))}console.log("✅ TRIX indicator updated successfully:",h)}catch(M){console.error("❌ Error updating TRIX indicator:",M)}}function Q0(){var M;if(!n(zr)||!s())return;const x=((M=s())==null?void 0:M.getIndicators()).filter(I=>I.name==="ROC");console.log("📊 Found ROC indicators on chart:",x.length),console.log("📊 ROC groups to apply:",n(an).length),n(an).forEach((I,D)=>{var it,yo;const E=[I.period];let H=Ee.Solid,ue=[2,2];I.styles.roc.lineStyle==="dashed"?(H=Ee.Dashed,ue=[4,4]):I.styles.roc.lineStyle==="dotted"&&(H=Ee.Dashed,ue=[2,2]);const Fe=x[D];if(Fe){console.log(`🎨 Updating existing ROC indicator ${D} in pane:`,Fe.paneId);const ao=(it=s())==null?void 0:it.overrideIndicator({name:"ROC",paneId:Fe.paneId,calcParams:E,styles:{lines:[{color:I.styles.roc.color,size:I.styles.roc.thickness,style:H,dashedValue:ue,smooth:!1}]},figures:[{key:"roc",title:"ROC: ",type:"line"}]});console.log("🎨 overrideIndicator result:",ao);const Et=`${Fe.paneId}_ROC`;d.update(Ls=>{Ls.saveInds[Et]||(Ls.saveInds[Et]={name:"ROC",pane_id:Fe.paneId,params:E,rocGroups:[]}),Ls.saveInds[Et].rocGroups||(Ls.saveInds[Et].rocGroups=[]);const Mn=Ls.saveInds[Et].rocGroups||[];for(;Mn.length<=D;)Mn.push({});return Mn[D]={...I},Ls.saveInds[Et].rocGroups=Mn,Ls.saveInds[Et].params=E,console.log("💾 Persisted ROC changes to save data:",Et,I),Ls}),console.log("✅ ROC indicator updated successfully:",D,I)}else{console.log(`➕ Creating new ROC indicator for group ${D}`);const ao={name:"ROC",calcParams:E,styles:{lines:[{color:I.styles.roc.color,size:I.styles.roc.thickness,style:H,dashedValue:ue,smooth:!1}]},figures:[{key:"roc",title:"ROC: ",type:"line"}]};(yo=s())==null||yo.createIndicator(ao,!1,{axis:{gap:{bottom:2}}})}}),l.update(I=>(I.editIndName="",I.editPaneId="",I.modalIndCfg=!1,I)),a(!1)}function eg(){var M;if(!n(hl))return;const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="PSY").sort((I,D)=>I===`${i().editPaneId}_PSY`?-1:D===`${i().editPaneId}_PSY`?1:I.localeCompare(D)),x=n(As).length;if(h.length>x)for(let I=x;I<h.length;(I+=1)-1){const D=h[I],E=r().saveInds[D];if(E&&E.pane_id)try{(M=s())==null||M.removeIndicator({paneId:E.pane_id,name:"PSY"})}catch(H){console.log("Error removing excess PSY indicator:",H)}}n(As).forEach((I,D)=>{var ao,Et,Ls;const E=[I.psyPeriod,I.mapsyPeriod],H=[{key:"psy",title:"PSY: ",type:"line"}];I.showMapsy&&H.push({key:"mapsy",title:"MAPSY: ",type:"line"});const ue={lines:[]};let Fe=Ee.Solid,it=[2,2];if(I.styles.psy.lineStyle==="dashed"?(Fe=Ee.Dashed,it=[4,4]):I.styles.psy.lineStyle==="dotted"&&(Fe=Ee.Dashed,it=[2,2]),ue.lines.push({color:I.styles.psy.color,size:I.styles.psy.thickness,style:Fe,dashedValue:it,smooth:!1}),I.showMapsy){let Mn=Ee.Solid,Ia=[2,2];I.styles.mapsy.lineStyle==="dashed"?(Mn=Ee.Dashed,Ia=[4,4]):I.styles.mapsy.lineStyle==="dotted"&&(Mn=Ee.Dashed,Ia=[2,2]),ue.lines.push({color:I.styles.mapsy.color,size:I.styles.mapsy.thickness,style:Mn,dashedValue:Ia,smooth:!1})}const yo={name:"PSY",calcParams:E,styles:ue,figures:H};if(D===0)(ao=s())==null||ao.overrideIndicator({...yo,paneId:i().editPaneId});else{const Mn=`psy_${String(D+1).padStart(3,"0")}_PSY`,Ia=h.find(Hl=>Hl===Mn);if(Ia){const Hl=r().saveInds[Ia];Hl&&Hl.pane_id&&((Et=s())==null||Et.overrideIndicator({...yo,paneId:Hl.pane_id}))}else{const Hl=`psy_${String(D+1).padStart(3,"0")}`;((Ls=s())==null?void 0:Ls.createIndicator(yo,!1,{id:Hl,axis:{gap:{bottom:2}}}))&&(console.log(`✅ PSY ${D+1} created with pane ID:`,Hl),I.actualPaneId=Hl)}}}),d.update(I=>(Object.keys(I.saveInds).forEach(D=>{I.saveInds[D].name==="PSY"&&delete I.saveInds[D]}),n(As).forEach((D,E)=>{const H=E===0?`${i().editPaneId}_PSY`:`psy_${String(E+1).padStart(3,"0")}_PSY`,ue=E===0?i().editPaneId:D.actualPaneId||`psy_${String(E+1).padStart(3,"0")}`;I.saveInds[H]={name:"PSY",psyGroup:D,pane_id:ue,groupIndex:E,params:[D.psyPeriod,D.mapsyPeriod]}}),I)),l.update(I=>(I.editIndName="",I.editPaneId="",I.modalIndCfg=!1,I)),a(!1)}function Nv(){if(!n(fa))return;const h=Object.keys(r().saveInds).filter(x=>r().saveInds[x].name==="OBV");n(qs).forEach((x,M)=>{var it,yo,ao;const I=[x.obvPeriod,x.maobvPeriod],D=[{key:"obv",title:"OBV: ",type:"line"}];x.showMaobv&&D.push({key:"maobv",title:"MAOBV: ",type:"line"});const E={lines:[]};let H=Ee.Solid,ue=[2,2];if(x.styles.obv.lineStyle==="dashed"?(H=Ee.Dashed,ue=[4,4]):x.styles.obv.lineStyle==="dotted"&&(H=Ee.Dashed,ue=[2,2]),E.lines.push({color:x.styles.obv.color,size:x.styles.obv.thickness,style:H,dashedValue:ue,smooth:!1}),x.showMaobv){let Et=Ee.Solid,Ls=[2,2];x.styles.maobv.lineStyle==="dashed"?(Et=Ee.Dashed,Ls=[4,4]):x.styles.maobv.lineStyle==="dotted"&&(Et=Ee.Dashed,Ls=[2,2]),E.lines.push({color:x.styles.maobv.color,size:x.styles.maobv.thickness,style:Et,dashedValue:Ls,smooth:!1})}const Fe={name:"OBV",calcParams:I,styles:E,figures:D};if(M===0)(it=s())==null||it.overrideIndicator({...Fe,paneId:i().editPaneId});else{const Et=`pane_OBV_${M+1}_OBV`,Ls=h.find(Mn=>Mn===Et);if(Ls){const Mn=r().saveInds[Ls];Mn&&Mn.pane_id&&((yo=s())==null||yo.overrideIndicator({...Fe,paneId:Mn.pane_id}))}else{const Mn=`pane_OBV_${M+1}`;((ao=s())==null?void 0:ao.createIndicator(Fe,!1,{id:Mn,axis:{gap:{bottom:2}}}))&&(console.log(`✅ OBV ${M+1} created with pane ID:`,Mn),x.actualPaneId=Mn)}}}),d.update(x=>(Object.keys(x.saveInds).forEach(M=>{x.saveInds[M].name==="OBV"&&delete x.saveInds[M]}),n(qs).forEach((M,I)=>{const D=I===0?`${i().editPaneId}_OBV`:`pane_OBV_${I+1}_OBV`,E=I===0?i().editPaneId:M.actualPaneId||`pane_OBV_${I+1}`,H={name:"OBV",obvGroup:M,pane_id:E,groupIndex:I,obvGroups:I===0?[...n(qs)]:void 0,params:[M.obvPeriod,M.maobvPeriod]};x.saveInds[D]=H}),x)),l.update(x=>(x.editIndName="",x.editPaneId="",x.modalIndCfg=!1,x)),a(!1)}function tg(){if(console.log("🚀 handleKdjConfirm started"),!n(sc)){console.log("❌ Not KDJ indicator, returning early");return}try{console.log("🔄 Applying KDJ changes, groups:",n(Jn).length),console.log("📊 Current KDJ groups data:",JSON.parse(JSON.stringify(n(Jn)))),console.log("🔄 Preserving existing indicators and updating with current values"),n(Jn).forEach((h,x)=>{console.log(`🔄 Applying KDJ group ${x+1} with current values`),ac(x)}),d.update(h=>(n(Jn).forEach((x,M)=>{const I=M===0?`${i().editPaneId}_KDJ`:`pane_KDJ_${M+1}_KDJ`,D=M===0?i().editPaneId:x.actualPaneId||`pane_KDJ_${M+1}`;console.log(`💾 Updating saved KDJ group ${M+1} with key:`,I,"pane ID:",D),h.saveInds[I]={name:"KDJ",kdjGroup:x,pane_id:D,groupIndex:M,kdjGroups:M===0?[...n(Jn)]:void 0,params:[x.kPeriod,x.dPeriod,3]}}),h)),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1)}catch(h){console.error("❌ Error in handleKdjConfirm main logic:",h),console.log("🔄 Forcing popup close due to error in main logic..."),l.update(x=>(x.editIndName="",x.editPaneId="",x.modalIndCfg=!1,x)),a(!1),console.log("✅ Popup forcefully closed after error in main logic")}}function Rv(){n(ca)&&(wn(),b(bs,!1),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1))}function Sf(){var M;if(!n(Ge))return;console.log("🔄 Applying AO changes, groups:",n(Oo).length);const h=Object.keys(r().saveInds).filter(I=>r().saveInds[I].name==="AO").sort((I,D)=>I===`${i().editPaneId}_AO`?-1:D===`${i().editPaneId}_AO`?1:I.localeCompare(D));console.log("🔍 Existing AO keys:",h);const x=n(Oo).length;if(h.length>x){console.log(`🗑️ Removing ${h.length-x} excess AO indicators`);for(let I=x;I<h.length;(I+=1)-1){const D=h[I],E=r().saveInds[D];if(E&&E.pane_id){console.log("🗑️ Removing AO indicator from pane:",E.pane_id);try{(M=s())==null||M.removeIndicator({paneId:E.pane_id,name:"AO"})}catch(H){console.log("Error removing excess AO indicator:",H)}}}}n(Oo).forEach((I,D)=>{var ue,Fe,it;const E=[I.shortPeriod,I.longPeriod],H={bars:[{upColor:I.styles.increasing.color,downColor:I.styles.decreasing.color,noChangeColor:"#888888"}]};if(D===0)console.log("🔄 Updating first AO indicator in pane:",i().editPaneId),(ue=s())==null||ue.overrideIndicator({name:"AO",calcParams:E,styles:H,paneId:i().editPaneId});else{const yo=`pane_AO_${D+1}_AO`,ao=h.find(Et=>Et===yo);if(ao){const Et=r().saveInds[ao];Et&&Et.pane_id&&(console.log(`🔄 Updating existing AO ${D+1} in pane:`,Et.pane_id),(Fe=s())==null||Fe.overrideIndicator({name:"AO",calcParams:E,styles:H,paneId:Et.pane_id}))}else{const Et=`pane_AO_${D+1}`;console.log(`🆕 Creating new AO ${D+1} with pane ID:`,Et),(it=s())==null||it.createIndicator({name:"AO",calcParams:E,styles:H},!0,{id:Et})}}}),d.update(I=>(Object.keys(I.saveInds).forEach(D=>{I.saveInds[D].name==="AO"&&delete I.saveInds[D]}),n(Oo).forEach((D,E)=>{const H=E===0?`${i().editPaneId}_AO`:`pane_AO_${E+1}_AO`,ue=E===0?i().editPaneId:`pane_AO_${E+1}`;console.log(`💾 Saving AO group ${E+1} with key:`,H),I.saveInds[H]={name:"AO",aoGroup:D,pane_id:ue,groupIndex:E,aoGroups:E===0?[...n(Oo)]:void 0,params:[D.shortPeriod,D.longPeriod]}}),I)),l.update(I=>(I.editIndName="",I.editPaneId="",I.modalIndCfg=!1,I)),a(!1)}function Ov(){n(Dr)&&(n(Vo).length===0?b(Vo,j([{id:cn(),paneId:i().editPaneId||"candle_pane",period:n(R),stdDev:n(N),styles:{fillColor:n(S),fillOpacity:n(L),upperColor:n(T),middleColor:n(P),lowerColor:n(A),thickness:n(F),lineStyle:n(B)}}])):(n(Vo)[0].period=n(R),n(Vo)[0].stdDev=n(N),n(Vo)[0].styles.fillColor=n(S),n(Vo)[0].styles.fillOpacity=n(L),n(Vo)[0].styles.upperColor=n(T),n(Vo)[0].styles.middleColor=n(P),n(Vo)[0].styles.lowerColor=n(A),n(Vo)[0].styles.thickness=n(F),n(Vo)[0].styles.lineStyle=n(B)),To(),l.update(h=>(h.editIndName="",h.editPaneId="",h.modalIndCfg=!1,h)),a(!1))}function fh(h){var I;if(console.log("🔄 handleConfirm called with:",h),console.log("📊 Current context:",{editIndName:i().editIndName,editPaneId:i().editPaneId,isKdj:n(sc),kdjGroups:n(Jn)}),h==="close"||h==="cancel"){l.update(D=>(D.editIndName="",D.editPaneId="",D.modalIndCfg=!1,D)),b(bs,!1),a(!1);return}if(h==="confirm"&&n(Xr)&&i().editIndName&&i().editPaneId){K0();return}if(h==="confirm"&&n(Ha)&&i().editIndName&&i().editPaneId){xp(),l.update(D=>(D.editIndName="",D.editPaneId="",D.modalIndCfg=!1,D)),a(!1);return}if(h==="confirm"&&n(js)&&i().editIndName&&i().editPaneId){console.log("🔄 PVT Confirm: Applying all changes to chart"),n(Ut).forEach((D,E)=>{console.log(`🔄 Applying PVT group ${E}:`,D),cp(E)}),d.update(D=>{const E=`${i().editPaneId}_PVT`;return D.saveInds[E]={...D.saveInds[E],pvtGroups:[...n(Ut)]},console.log("💾 Saved PVT groups to:",E),D}),l.update(D=>(D.editIndName="",D.editPaneId="",D.modalIndCfg=!1,D)),a(!1);return}if(h==="confirm"&&n(za)&&i().editIndName&&i().editPaneId){U0();return}if(h==="confirm"&&n(at)&&i().editIndName&&i().editPaneId){Hd();return}if(h==="confirm"&&n(So)&&i().editIndName&&i().editPaneId){Au();return}if(h==="confirm"&&n(on)&&i().editIndName&&i().editPaneId){uh();return}if(h==="confirm"&&n(qt)&&i().editIndName&&i().editPaneId){ph();return}if(h==="confirm"&&n(nc)&&i().editIndName&&i().editPaneId){n(Wo).forEach((D,E)=>{Bt(E)}),Na(),l.update(D=>(D.editIndName="",D.editPaneId="",D.modalIndCfg=!1,D)),a(!1);return}if(h==="confirm"&&n(Vl)&&i().editIndName&&i().editPaneId){Bv();return}if(h==="confirm"&&n(ul)&&i().editIndName&&i().editPaneId){Qp();return}if(h==="confirm"&&n(Ki)&&i().editIndName&&i().editPaneId){Z0();return}if(h==="confirm"&&n(us)&&i().editIndName&&i().editPaneId){td();return}if(h==="confirm"&&n(Cl)&&i().editIndName&&i().editPaneId){X0();return}if(h==="confirm"&&n(_s)&&i().editIndName&&i().editPaneId){vh();return}if(h==="confirm"&&n(Zl)&&i().editIndName&&i().editPaneId){J0();return}if(h==="confirm"&&n(In)&&i().editIndName&&i().editPaneId){ev();return}if(h==="confirm"&&n(zr)&&i().editIndName&&i().editPaneId){Q0();return}if(h==="confirm"&&n(hl)&&i().editIndName&&i().editPaneId){eg();return}if(h==="confirm"&&n(fa)&&i().editIndName&&i().editPaneId){Nv();return}if(h==="confirm"&&n(Ts)&&i().editIndName&&i().editPaneId){mf();return}if(h==="confirm"&&n(sc)&&i().editIndName&&i().editPaneId){console.log("✅ KDJ confirm condition met, calling handleKdjConfirm"),tg();return}if(h==="confirm"&&n(Ge)&&i().editIndName&&i().editPaneId){Sf();return}if(h==="confirm"&&n(Dr)&&i().editIndName&&i().editPaneId){Ov();return}if(h==="confirm"&&n(ca)&&i().editIndName&&i().editPaneId){Rv();return}if(h!=="confirm"||!i().editIndName||!i().editPaneId||_.length===0){a(!1);return}const x=[],M={lines:[],bars:[]};p.forEach((D,E)=>{const H=_[E];if(H&&H.type==="color"){const ue=H.styleKey;if(ue){const Fe=ue.match(/^(\w+)\[(\d+)\]\.(\w+)$/);if(Fe){const[,it,yo,ao]=Fe,Et=parseInt(yo);M[it]||(M[it]=[]),M[it][Et]||(M[it][Et]={}),M[it][Et][ao]=D||H.default}}}else(!Yp.isValid(D)||D==="")&&H&&H.default&&(D=H.default),x.push(Number(D))}),y.forEach((D,E)=>{let H=Ee.Solid,ue=[2,2];D.lineStyle==="dashed"?(H=Ee.Dashed,ue=[4,4]):D.lineStyle==="dotted"&&(H=Ee.Dashed,ue=[2,6]),M.lines[E]={color:D.color,size:D.thickness,style:H,dashedValue:ue}}),(I=s())==null||I.overrideIndicator({name:i().editIndName,calcParams:x,styles:M,paneId:i().editPaneId}),d.update(D=>{const E={name:i().editIndName,params:x,pane_id:i().editPaneId,styles:[...y]};return n(Dr)||(E.fields=[..._]),D.saveInds[`${i().editPaneId}_${i().editIndName}`]=E,D}),l.update(D=>(D.editIndName="",D.editPaneId="",D.modalIndCfg=!1,D)),a(!1)}$0();var Cf=Mj(),mv=_t(Cf);Pu(mv,{get title(){return n(iu)},width:600,maxWidth:"min(600px, 95vw)",maxHeight:"90vh",get show(){return a()},set show(h){a(h)},get theme(){return r().theme},click:fh,children:(h,x)=>{var M=Ij(),I=g(M);Se(I,()=>n(Xr),E=>{var H=YD(),ue=g(H);Ns(ue,17,()=>n(Dt),dn,(yo,ao,Et)=>{var Ls=GD(),Mn=g(Ls),Ia=g(Mn);Ia.textContent=`MACD ${Et+1}`;var Hl=u(Ia,2);Se(Hl,()=>n(Dt).length>1,tn=>{var ks=HD();ks.__click=[qD,bc,ao],O(tn,ks)}),f(Mn);var zc=u(Mn,2),Ic=g(zc),Wc=u(g(Ic),2);Vt(Wc),f(Ic);var gc=u(Ic,2),xc=u(g(gc),2);Vt(xc),f(gc);var Mc=u(gc,2),mc=u(g(Mc),2);Vt(mc),f(Mc),f(zc);var lc=u(zc,2),wc=g(lc),Ni=u(g(wc),2),aa=We(()=>uv(Et,"macdLine"));Ni.__click=function(...tn){var ks;(ks=n(aa))==null||ks.apply(this,tn)};var Jl=u(Ni,2);Jl.__change=()=>st(Et);var hr=g(Jl);hr.value=(hr.__value=1)==null?"":1;var ea=u(hr);ea.value=(ea.__value=2)==null?"":2;var Tl=u(ea);Tl.value=(Tl.__value=3)==null?"":3;var _r=u(Tl);_r.value=(_r.__value=4)==null?"":4;var sl=u(_r);sl.value=(sl.__value=5)==null?"":5,f(Jl);var Ga=u(Jl,2);Ga.__change=()=>st(Et);var ei=g(Ga);ei.value=(ei.__value="solid")==null?"":"solid";var yr=u(ei);yr.value=(yr.__value="dashed")==null?"":"dashed";var Ea=u(yr);Ea.value=(Ea.__value="dotted")==null?"":"dotted",f(Ga),f(wc);var Di=u(wc,2),Rr=u(g(Di),2),wa=We(()=>uv(Et,"signalLine"));Rr.__click=function(...tn){var ks;(ks=n(wa))==null||ks.apply(this,tn)};var yi=u(Rr,2);yi.__change=()=>st(Et);var Or=g(yi);Or.value=(Or.__value=1)==null?"":1;var pa=u(Or);pa.value=(pa.__value=2)==null?"":2;var bi=u(pa);bi.value=(bi.__value=3)==null?"":3;var pr=u(bi);pr.value=(pr.__value=4)==null?"":4;var ta=u(pr);ta.value=(ta.__value=5)==null?"":5,f(yi);var Ei=u(yi,2);Ei.__change=()=>st(Et);var Yn=g(Ei);Yn.value=(Yn.__value="solid")==null?"":"solid";var Vr=u(Yn);Vr.value=(Vr.__value="dashed")==null?"":"dashed";var Hi=u(Vr);Hi.value=(Hi.__value="dotted")==null?"":"dotted",f(Ei),f(Di);var Us=u(Di,2),Gr=u(g(Us),2),nn=We(()=>uv(Et,"positiveHistogram"));Gr.__click=function(...tn){var ks;(ks=n(nn))==null||ks.apply(this,tn)},f(Us);var Xi=u(Us,2),br=u(g(Xi),2),Ri=We(()=>uv(Et,"negativeHistogram"));br.__click=function(...tn){var ks;(ks=n(Ri))==null||ks.apply(this,tn)},f(Xi),f(lc),f(Ls),we(()=>{St(Ni,"style",`background-color: ${n(ao).styles.macdLine.color??""}; border: 1px solid #ddd;`),St(Rr,"style",`background-color: ${n(ao).styles.signalLine.color??""}; border: 1px solid #ddd;`),St(Gr,"style",`background-color: ${n(ao).styles.positiveHistogram.color??""}; border: 1px solid #ddd;`),St(br,"style",`background-color: ${n(ao).styles.negativeHistogram.color??""}; border: 1px solid #ddd;`)}),go(Wc,()=>n(ao).fastPeriod,tn=>n(ao).fastPeriod=tn),go(xc,()=>n(ao).slowPeriod,tn=>n(ao).slowPeriod=tn),go(mc,()=>n(ao).signalPeriod,tn=>n(ao).signalPeriod=tn),Bo(Jl,()=>n(ao).styles.macdLine.thickness,tn=>n(ao).styles.macdLine.thickness=tn),Bo(Ga,()=>n(ao).styles.macdLine.lineStyle,tn=>n(ao).styles.macdLine.lineStyle=tn),Bo(yi,()=>n(ao).styles.signalLine.thickness,tn=>n(ao).styles.signalLine.thickness=tn),Bo(Ei,()=>n(ao).styles.signalLine.lineStyle,tn=>n(ao).styles.signalLine.lineStyle=tn),O(yo,Ls)});var Fe=u(ue,2),it=g(Fe);it.__click=yc,f(Fe),f(H),O(E,H)},E=>{var H=Xt(),ue=_t(H);Se(ue,()=>n(Ha),Fe=>{var it=UD(),yo=g(it),ao=g(yo),Et=u(g(ao),2);Vt(Et),Et.__input=[wu,Ha,s,v,i,l,Bs],f(ao);var Ls=u(ao,2),Mn=u(g(Ls),2);Vt(Mn),Mn.__input=[wu,Ha,s,v,i,l,Bs],f(Ls);var Ia=u(Ls,2),Hl=u(g(Ia),2);Vt(Hl),Hl.__input=[wu,Ha,s,v,i,l,Bs],f(Ia);var zc=u(Ia,2),Ic=u(g(zc),2);Vt(Ic),Ic.__input=[wu,Ha,s,v,i,l,Bs],f(zc);var Wc=u(zc,2),gc=u(g(Wc),2);Vt(gc),gc.__input=[wu,Ha,s,v,i,l,Bs],f(Wc);var xc=u(Wc,2),Mc=u(g(xc),2);Vt(Mc),Mc.__input=[wu,Ha,s,v,i,l,Bs],f(xc),f(yo);var mc=u(yo,2),lc=g(mc),wc=u(g(lc),2),Ni=g(wc);Vt(Ni),Ni.__input=[wu,Ha,s,v,i,l,Bs];var aa=u(Ni,2),Jl=g(aa);we(()=>Ye(Jl,`${(Bs.maxZoneWidthPct*100).toFixed(1)??""}%`)),f(aa),f(wc),f(lc);var hr=u(lc,2),ea=u(g(hr),2),Tl=g(ea);Vt(Tl),Tl.__input=[wu,Ha,s,v,i,l,Bs];var _r=u(Tl,2),sl=g(_r);we(()=>Ye(sl,`${Bs.minVolumeFactor.toFixed(2)??""}x`)),f(_r),f(ea),f(hr);var Ga=u(hr,2),ei=u(g(Ga),2),yr=g(ei);Vt(yr),yr.__input=[wu,Ha,s,v,i,l,Bs];var Ea=u(yr,2),Di=g(Ea,!0);we(()=>Ye(Di,Bs.minOBVTrendStrength.toFixed(2))),f(Ea),f(ei),f(Ga);var Rr=u(Ga,2),wa=u(g(Rr),2),yi=g(wa);Vt(yi),yi.__input=[wu,Ha,s,v,i,l,Bs];var Or=u(yi,2),pa=g(Or,!0);we(()=>Ye(pa,Bs.minZoneScore.toFixed(2))),f(Or),f(wa),f(Rr),f(mc);var bi=u(mc,2),pr=g(bi),ta=u(g(pr),2);Vt(ta),ta.__change=[wu,Ha,s,v,i,l,Bs],f(pr);var Ei=u(pr,2),Yn=u(g(Ei),2);Vt(Yn),Yn.__change=[wu,Ha,s,v,i,l,Bs],f(Ei),f(bi);var Vr=u(bi,2),Hi=u(g(Vr),2);Vt(Hi),Hi.__input=[wu,Ha,s,v,i,l,Bs],f(Vr),f(it),go(Et,()=>Bs.zoneLookbackBars,Us=>Bs.zoneLookbackBars=Us),go(Mn,()=>Bs.priorTrendLookback,Us=>Bs.priorTrendLookback=Us),go(Hl,()=>Bs.minZoneBars,Us=>Bs.minZoneBars=Us),go(Ic,()=>Bs.maxZoneBars,Us=>Bs.maxZoneBars=Us),go(gc,()=>Bs.atrPeriod,Us=>Bs.atrPeriod=Us),go(Mc,()=>Bs.volumeMAPeriod,Us=>Bs.volumeMAPeriod=Us),go(Ni,()=>Bs.maxZoneWidthPct,Us=>Bs.maxZoneWidthPct=Us),go(Tl,()=>Bs.minVolumeFactor,Us=>Bs.minVolumeFactor=Us),go(yr,()=>Bs.minOBVTrendStrength,Us=>Bs.minOBVTrendStrength=Us),go(yi,()=>Bs.minZoneScore,Us=>Bs.minZoneScore=Us),Bu(ta,()=>Bs.mergeNearbyZones,Us=>Bs.mergeNearbyZones=Us),Bu(Yn,()=>Bs.showLabels,Us=>Bs.showLabels=Us),go(Hi,()=>Bs.maxZonesDisplayed,Us=>Bs.maxZonesDisplayed=Us),O(Fe,it)},Fe=>{var it=Xt(),yo=_t(it);Se(yo,()=>n(qc),ao=>{var Et=ZD(),Ls=g(Et),Mn=g(Ls),Ia=u(g(Mn),2);Vt(Ia),Ia.__input=Hc,f(Mn);var Hl=u(Mn,2),zc=u(g(Hl),2);Vt(zc),zc.__input=Hc,f(Hl);var Ic=u(Hl,2),Wc=u(g(Ic),2);Vt(Wc),Wc.__input=Hc,f(Ic);var gc=u(Ic,2),xc=u(g(gc),2);Vt(xc),xc.__input=Hc,f(gc);var Mc=u(gc,2),mc=u(g(Mc),2);Vt(mc),mc.__input=Hc,f(Mc);var lc=u(Mc,2),wc=u(g(lc),2),Ni=g(wc);Vt(Ni),Ni.__input=Hc;var aa=u(Ni,2),Jl=g(aa);we(()=>Ye(Jl,`${Number(p[5]??1.2).toFixed(2)??""}x`)),f(aa),f(wc),f(lc),f(Ls);var hr=u(Ls,2),ea=g(hr),Tl=u(g(ea),2),_r=g(Tl);Vt(_r),_r.__input=Hc,un(2),f(Tl),f(ea);var sl=u(ea,2),Ga=u(g(sl),2),ei=g(Ga);Vt(ei),ei.__input=Hc;var yr=u(ei,2),Ea=g(yr,!0);we(()=>Ye(Ea,Number(p[7]??.35).toFixed(2))),f(yr),f(Ga),f(sl);var Di=u(sl,2),Rr=u(g(Di),2),wa=g(Rr);Vt(wa),wa.__input=Hc;var yi=u(wa,2),Or=g(yi,!0);we(()=>Ye(Or,Number(p[8]??.5).toFixed(2))),f(yi),f(Rr),f(Di),f(hr);var pa=u(hr,2),bi=g(pa),pr=u(g(bi),2);Vt(pr),we(()=>tp(pr,Number(p[9]??1)>0)),pr.__change=[KD,p,Hc],f(bi);var ta=u(bi,2),Ei=u(g(ta),2);Vt(Ei),Ei.__input=Hc,f(ta),f(pa),f(Et),go(Ia,()=>p[0],Yn=>p[0]=Yn),go(zc,()=>p[1],Yn=>p[1]=Yn),go(Wc,()=>p[2],Yn=>p[2]=Yn),go(xc,()=>p[3],Yn=>p[3]=Yn),go(mc,()=>p[4],Yn=>p[4]=Yn),go(Ni,()=>p[5],Yn=>p[5]=Yn),go(_r,()=>p[6],Yn=>p[6]=Yn),go(ei,()=>p[7],Yn=>p[7]=Yn),go(wa,()=>p[8],Yn=>p[8]=Yn),go(Ei,()=>p[10],Yn=>p[10]=Yn),O(ao,Et)},ao=>{var Et=Xt(),Ls=_t(Et);Se(Ls,()=>n(_c),Mn=>{var Ia=XD(),Hl=g(Ia),zc=u(g(Hl),2),Ic=g(zc),Wc=u(g(Ic),2);Vt(Wc),Wc.__input=fl,f(Ic);var gc=u(Ic,2),xc=u(g(gc),2);Vt(xc),xc.__input=fl,f(gc);var Mc=u(gc,2),mc=u(g(Mc),2);Vt(mc),mc.__input=fl,f(Mc);var lc=u(Mc,2),wc=u(g(lc),2);Vt(wc),wc.__input=fl,f(lc);var Ni=u(lc,2),aa=u(g(Ni),2);Vt(aa),aa.__input=fl,f(Ni);var Jl=u(Ni,2),hr=u(g(Jl),2);Vt(hr),hr.__input=fl,f(Jl),f(zc),f(Hl);var ea=u(Hl,2),Tl=u(g(ea),2),_r=g(Tl),sl=u(g(_r),2),Ga=g(sl);Vt(Ga),Ga.__input=fl;var ei=u(Ga,2),yr=g(ei,!0);we(()=>Ye(yr,Number(p[6]??.7).toFixed(2))),f(ei),f(sl),f(_r);var Ea=u(_r,2),Di=u(g(Ea),2);Vt(Di),Di.__input=fl,f(Ea);var Rr=u(Ea,2),wa=u(g(Rr),2),yi=g(wa);Vt(yi),yi.__input=fl;var Or=u(yi,2),pa=g(Or);we(()=>Ye(pa,`${Number(p[8]??1.3).toFixed(2)??""}x`)),f(Or),f(wa),f(Rr);var bi=u(Rr,2),pr=u(g(bi),2),ta=g(pr);Vt(ta),ta.__input=fl;var Ei=u(ta,2),Yn=g(Ei);we(()=>Ye(Yn,`${Number(p[9]??1.3).toFixed(2)??""}x`)),f(Ei),f(pr),f(bi);var Vr=u(bi,2),Hi=u(g(Vr),2),Us=g(Hi);Vt(Us),Us.__input=fl;var Gr=u(Us,2),nn=g(Gr,!0);we(()=>Ye(nn,Number(p[10]??.6).toFixed(2))),f(Gr),f(Hi),f(Vr);var Xi=u(Vr,2),br=u(g(Xi),2);Vt(br),br.__input=fl,f(Xi);var Ri=u(Xi,2),tn=u(g(Ri),2);Vt(tn),tn.__input=fl,f(Ri),f(Tl),f(ea),f(Ia),go(Wc,()=>p[0],ks=>p[0]=ks),go(xc,()=>p[1],ks=>p[1]=ks),go(mc,()=>p[2],ks=>p[2]=ks),go(wc,()=>p[3],ks=>p[3]=ks),go(aa,()=>p[4],ks=>p[4]=ks),go(hr,()=>p[5],ks=>p[5]=ks),go(Ga,()=>p[6],ks=>p[6]=ks),go(Di,()=>p[7],ks=>p[7]=ks),go(yi,()=>p[8],ks=>p[8]=ks),go(ta,()=>p[9],ks=>p[9]=ks),go(Us,()=>p[10],ks=>p[10]=ks),go(br,()=>p[11],ks=>p[11]=ks),go(tn,()=>p[12],ks=>p[12]=ks),O(Mn,Ia)},Mn=>{var Ia=Xt(),Hl=_t(Ia);Se(Hl,()=>n(ld),zc=>{var Ic=JD(),Wc=g(Ic),gc=u(g(Wc),2),xc=g(gc),Mc=u(g(xc),2);Vt(Mc),Mc.__input=tl,f(xc);var mc=u(xc,2),lc=u(g(mc),2);Vt(lc),lc.__input=tl,f(mc);var wc=u(mc,2),Ni=u(g(wc),2);Vt(Ni),Ni.__input=tl,f(wc);var aa=u(wc,2),Jl=u(g(aa),2);Vt(Jl),Jl.__input=tl,f(aa);var hr=u(aa,2),ea=u(g(hr),2);Vt(ea),ea.__input=tl,f(hr);var Tl=u(hr,2),_r=u(g(Tl),2);Vt(_r),_r.__input=tl,f(Tl),f(gc),f(Wc);var sl=u(Wc,2),Ga=u(g(sl),2),ei=g(Ga),yr=u(g(ei),2),Ea=g(yr);Vt(Ea),Ea.__input=tl;var Di=u(Ea,2),Rr=g(Di,!0);we(()=>Ye(Rr,Number(p[6]??.7).toFixed(2))),f(Di),f(yr),f(ei);var wa=u(ei,2),yi=u(g(wa),2);Vt(yi),yi.__input=tl,f(wa);var Or=u(wa,2),pa=u(g(Or),2),bi=g(pa);Vt(bi),bi.__input=tl;var pr=u(bi,2),ta=g(pr);we(()=>Ye(ta,`${Number(p[8]??1.3).toFixed(2)??""}x`)),f(pr),f(pa),f(Or);var Ei=u(Or,2),Yn=u(g(Ei),2),Vr=g(Yn);Vt(Vr),Vr.__input=tl;var Hi=u(Vr,2),Us=g(Hi);we(()=>Ye(Us,`${Number(p[9]??1.3).toFixed(2)??""}x`)),f(Hi),f(Yn),f(Ei);var Gr=u(Ei,2),nn=u(g(Gr),2),Xi=g(nn);Vt(Xi),Xi.__input=tl;var br=u(Xi,2),Ri=g(br,!0);we(()=>Ye(Ri,Number(p[10]??.6).toFixed(2))),f(br),f(nn),f(Gr);var tn=u(Gr,2),ks=u(g(tn),2);Vt(ks),ks.__input=tl,f(tn);var ci=u(tn,2),Ar=u(g(ci),2);Vt(Ar),Ar.__input=tl,f(ci),f(Ga),f(sl),f(Ic),go(Mc,()=>p[0],_n=>p[0]=_n),go(lc,()=>p[1],_n=>p[1]=_n),go(Ni,()=>p[2],_n=>p[2]=_n),go(Jl,()=>p[3],_n=>p[3]=_n),go(ea,()=>p[4],_n=>p[4]=_n),go(_r,()=>p[5],_n=>p[5]=_n),go(Ea,()=>p[6],_n=>p[6]=_n),go(yi,()=>p[7],_n=>p[7]=_n),go(bi,()=>p[8],_n=>p[8]=_n),go(Vr,()=>p[9],_n=>p[9]=_n),go(Xi,()=>p[10],_n=>p[10]=_n),go(ks,()=>p[11],_n=>p[11]=_n),go(Ar,()=>p[12],_n=>p[12]=_n),O(zc,Ic)},zc=>{var Ic=Xt(),Wc=_t(Ic);Se(Wc,()=>n(nc),gc=>{var xc=tE(),Mc=g(xc);Ns(Mc,17,()=>n(Wo),dn,(wc,Ni,aa)=>{var Jl=eE(),hr=g(Jl),ea=g(hr);ea.textContent=`RSI ${aa+1}`;var Tl=u(ea,2);Se(Tl,()=>n(Wo).length>1,ys=>{var Os=QD();Os.__click=()=>Be(aa),O(ys,Os)}),f(hr);var _r=u(hr,2),sl=g(_r),Ga=u(g(sl),2);Vt(Ga),Ga.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)},f(sl);var ei=u(sl,2),yr=u(g(ei),2);Vt(yr),yr.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)},f(ei);var Ea=u(ei,2),Di=u(g(Ea),2);Vt(Di),Di.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)},f(Ea);var Rr=u(Ea,2),wa=u(g(Rr),2);Vt(wa),wa.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)},f(Rr),f(_r);var yi=u(_r,2),Or=g(yi),pa=u(g(Or),2),bi=g(pa);bi.__click=ys=>{b(ss,j(aa));const Os=ys.currentTarget.getBoundingClientRect();b(Ao,j({x:Os.left+Os.width/2,y:Os.bottom+5})),b(Do,!0)};var pr=u(bi,2);pr.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var ta=g(pr);ta.value=(ta.__value=1)==null?"":1;var Ei=u(ta);Ei.value=(Ei.__value=2)==null?"":2;var Yn=u(Ei);Yn.value=(Yn.__value=3)==null?"":3;var Vr=u(Yn);Vr.value=(Vr.__value=4)==null?"":4;var Hi=u(Vr);Hi.value=(Hi.__value=5)==null?"":5,f(pr);var Us=u(pr,2);Us.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var Gr=g(Us);Gr.value=(Gr.__value="solid")==null?"":"solid";var nn=u(Gr);nn.value=(nn.__value="dashed")==null?"":"dashed";var Xi=u(nn);Xi.value=(Xi.__value="dotted")==null?"":"dotted",f(Us),f(pa),f(Or),f(yi);var br=u(yi,2),Ri=u(g(br),2),tn=u(g(Ri),2),ks=g(tn);ks.__click=ys=>{b(Ze,j(aa));const Os=ys.currentTarget.getBoundingClientRect();b(Qt,j({x:Os.left+Os.width/2,y:Os.bottom+5})),b(Ft,!0)};var ci=u(ks,2);ci.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var Ar=g(ci);Ar.value=(Ar.__value=1)==null?"":1;var _n=u(Ar);_n.value=(_n.__value=2)==null?"":2;var oi=u(_n);oi.value=(oi.__value=3)==null?"":3,f(ci);var Oi=u(ci,2);Oi.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var Lr=g(Oi);Lr.value=(Lr.__value="solid")==null?"":"solid";var Tn=u(Lr);Tn.value=(Tn.__value="dashed")==null?"":"dashed";var Un=u(Tn);Un.value=(Un.__value="dotted")==null?"":"dotted",f(Oi),f(tn),f(Ri);var xi=u(Ri,2),Rn=u(g(xi),2),$i=g(Rn);$i.__click=ys=>{b(Ze,j(aa));const Os=ys.currentTarget.getBoundingClientRect();b(eo,j({x:Os.left+Os.width/2,y:Os.bottom+5})),b(xt,!0)};var Gi=u($i,2);Gi.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var Fs=g(Gi);Fs.value=(Fs.__value=1)==null?"":1;var yn=u(Fs);yn.value=(yn.__value=2)==null?"":2;var En=u(yn);En.value=(En.__value=3)==null?"":3,f(Gi);var On=u(Gi,2);On.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var Kn=g(On);Kn.value=(Kn.__value="solid")==null?"":"solid";var Ii=u(Kn);Ii.value=(Ii.__value="dashed")==null?"":"dashed";var bn=u(Ii);bn.value=(bn.__value="dotted")==null?"":"dotted",f(On),f(Rn),f(xi);var $n=u(xi,2),nr=u(g($n),2),si=g(nr);si.__click=ys=>{b(Ze,j(aa));const Os=ys.currentTarget.getBoundingClientRect();b(Po,j({x:Os.left+Os.width/2,y:Os.bottom+5})),b(Is,!0)};var ni=u(si,2);ni.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var Zs=g(ni);Zs.value=(Zs.__value=1)==null?"":1;var hs=u(Zs);hs.value=(hs.__value=2)==null?"":2;var Zn=u(hs);Zn.value=(Zn.__value=3)==null?"":3,f(ni);var An=u(ni,2);An.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var xn=g(An);xn.value=(xn.__value="solid")==null?"":"solid";var Xs=u(xn);Xs.value=(Xs.__value="dashed")==null?"":"dashed";var Vi=u(Xs);Vi.value=(Vi.__value="dotted")==null?"":"dotted",f(An),f(nr),f($n);var as=u($n,2),Ji=u(g(as),2),Vn=g(Ji);Vt(Vn),Vn.__change=()=>{b(Wo,j([...n(Wo)])),Bt(aa)};var Ks=u(Vn,2),vr=g(Ks);we(()=>Ye(vr,`${Math.round((n(Ni).fillOpacity??.15)*100)??""}%`)),f(Ks),f(Ji),f(as),f(br),f(Jl),we(()=>{St(bi,"style",`background-color: ${n(Ni).styles.rsi.color??""}`),St(ks,"style",`background-color: ${(n(Ni).styles.overboughtColor||"#EF4444")??""}`),St($i,"style",`background-color: ${(n(Ni).styles.oversoldColor||"#22C55E")??""}`),St(si,"style",`background-color: ${(n(Ni).styles.middleLineColor||"#6B7280")??""}`)}),go(Ga,()=>n(Ni).period,ys=>n(Ni).period=ys),go(yr,()=>n(Ni).overboughtLevel,ys=>n(Ni).overboughtLevel=ys),go(Di,()=>n(Ni).middleLevel,ys=>n(Ni).middleLevel=ys),go(wa,()=>n(Ni).oversoldLevel,ys=>n(Ni).oversoldLevel=ys),Bo(pr,()=>n(Ni).styles.rsi.thickness,ys=>n(Ni).styles.rsi.thickness=ys),Bo(Us,()=>n(Ni).styles.rsi.lineStyle,ys=>n(Ni).styles.rsi.lineStyle=ys),Bo(ci,()=>n(Ni).styles.overboughtThickness,ys=>n(Ni).styles.overboughtThickness=ys),Bo(Oi,()=>n(Ni).styles.overboughtLineStyle,ys=>n(Ni).styles.overboughtLineStyle=ys),Bo(Gi,()=>n(Ni).styles.oversoldThickness,ys=>n(Ni).styles.oversoldThickness=ys),Bo(On,()=>n(Ni).styles.oversoldLineStyle,ys=>n(Ni).styles.oversoldLineStyle=ys),Bo(ni,()=>n(Ni).styles.middleLineThickness,ys=>n(Ni).styles.middleLineThickness=ys),Bo(An,()=>n(Ni).styles.middleLineStyle,ys=>n(Ni).styles.middleLineStyle=ys),go(Vn,()=>n(Ni).fillOpacity,ys=>n(Ni).fillOpacity=ys),O(wc,Jl)});var mc=u(Mc,2),lc=g(mc);lc.__click=cd,f(mc),f(xc),O(gc,xc)},gc=>{var xc=Xt(),Mc=_t(xc);Se(Mc,()=>n(vc),mc=>{var lc=nE(),wc=g(lc);Ns(wc,17,()=>n(Gs),dn,(Jl,hr,ea)=>{var Tl=sE(),_r=g(Tl),sl=g(_r);sl.textContent=`Stochastic ${ea+1}`;var Ga=u(sl,2);Se(Ga,()=>n(Gs).length>1,Zs=>{var hs=oE();hs.__click=()=>Jr(ea),O(Zs,hs)}),f(_r);var ei=u(_r,2),yr=g(ei),Ea=u(g(yr),2);Vt(Ea),Ea.__change=()=>bl(ea),f(yr);var Di=u(yr,2),Rr=u(g(Di),2);Vt(Rr),Rr.__change=()=>bl(ea),f(Di);var wa=u(Di,2),yi=u(g(wa),2);Vt(yi),yi.__change=()=>bl(ea),f(wa);var Or=u(wa,2),pa=u(g(Or),2);Vt(pa),pa.__change=()=>bl(ea),f(Or),f(ei);var bi=u(ei,2),pr=g(bi),ta=u(g(pr),2);Vt(ta),ta.__change=()=>bl(ea),f(pr),f(bi);var Ei=u(bi,2),Yn=g(Ei),Vr=u(g(Yn),2),Hi=g(Vr);Hi.__click=Zs=>{const hs=Zs.currentTarget.getBoundingClientRect();b(ui,j({x:hs.left,y:hs.bottom+5})),b(Ms,j(ea)),b(ds,!0)};var Us=u(Hi,2);Us.__change=()=>bl(ea);var Gr=g(Us);Gr.value=(Gr.__value=1)==null?"":1;var nn=u(Gr);nn.value=(nn.__value=2)==null?"":2;var Xi=u(nn);Xi.value=(Xi.__value=3)==null?"":3;var br=u(Xi);br.value=(br.__value=4)==null?"":4;var Ri=u(br);Ri.value=(Ri.__value=5)==null?"":5,f(Us);var tn=u(Us,2);tn.__change=()=>bl(ea);var ks=g(tn);ks.value=(ks.__value="solid")==null?"":"solid";var ci=u(ks);ci.value=(ci.__value="dashed")==null?"":"dashed";var Ar=u(ci);Ar.value=(Ar.__value="dotted")==null?"":"dotted",f(tn),f(Vr),f(Yn),f(Ei);var _n=u(Ei,2),oi=g(_n),Oi=u(g(oi),2),Lr=g(Oi);Lr.__click=Zs=>{const hs=Zs.currentTarget.getBoundingClientRect();b(ui,j({x:hs.left,y:hs.bottom+5})),b(Ms,j(ea)),b(Cs,!0)};var Tn=u(Lr,2);Tn.__change=()=>bl(ea);var Un=g(Tn);Un.value=(Un.__value=1)==null?"":1;var xi=u(Un);xi.value=(xi.__value=2)==null?"":2;var Rn=u(xi);Rn.value=(Rn.__value=3)==null?"":3;var $i=u(Rn);$i.value=($i.__value=4)==null?"":4;var Gi=u($i);Gi.value=(Gi.__value=5)==null?"":5,f(Tn);var Fs=u(Tn,2);Fs.__change=()=>bl(ea);var yn=g(Fs);yn.value=(yn.__value="solid")==null?"":"solid";var En=u(yn);En.value=(En.__value="dashed")==null?"":"dashed";var On=u(En);On.value=(On.__value="dotted")==null?"":"dotted",f(Fs),f(Oi),f(oi),f(_n);var Kn=u(_n,2),Ii=u(g(Kn),2),bn=u(g(Ii),2);bn.__click=Zs=>{const hs=Zs.currentTarget.getBoundingClientRect();b(ui,j({x:hs.left,y:hs.bottom+5})),b(Ms,j(ea)),b(ns,!0)},f(Ii);var $n=u(Ii,2),nr=u(g($n),2);nr.__click=Zs=>{const hs=Zs.currentTarget.getBoundingClientRect();b(ui,j({x:hs.left,y:hs.bottom+5})),b(Ms,j(ea)),b(Js,!0)},f($n);var si=u($n,2),ni=u(g(si),2);ni.__click=Zs=>{const hs=Zs.currentTarget.getBoundingClientRect();b(ui,j({x:hs.left,y:hs.bottom+5})),b(Ms,j(ea)),b(Nn,!0)},f(si),f(Kn),f(Tl),we(()=>{St(Hi,"style",`background-color: ${n(hr).styles.kLine.color??""}`),St(Lr,"style",`background-color: ${n(hr).styles.dLine.color??""}`),St(bn,"style",`background-color: ${(n(hr).styles.overboughtColor||"#EF4444")??""}`),St(nr,"style",`background-color: ${(n(hr).styles.oversoldColor||"#10B981")??""}`),St(ni,"style",`background-color: ${(n(hr).styles.midLineColor||"#6B7280")??""}`)}),go(Ea,()=>n(hr).kPeriod,Zs=>n(hr).kPeriod=Zs),go(Rr,()=>n(hr).dPeriod,Zs=>n(hr).dPeriod=Zs),go(yi,()=>n(hr).overboughtLevel,Zs=>n(hr).overboughtLevel=Zs),go(pa,()=>n(hr).oversoldLevel,Zs=>n(hr).oversoldLevel=Zs),go(ta,()=>n(hr).midLevel,Zs=>n(hr).midLevel=Zs),Bo(Us,()=>n(hr).styles.kLine.thickness,Zs=>n(hr).styles.kLine.thickness=Zs),Bo(tn,()=>n(hr).styles.kLine.lineStyle,Zs=>n(hr).styles.kLine.lineStyle=Zs),Bo(Tn,()=>n(hr).styles.dLine.thickness,Zs=>n(hr).styles.dLine.thickness=Zs),Bo(Fs,()=>n(hr).styles.dLine.lineStyle,Zs=>n(hr).styles.dLine.lineStyle=Zs),O(Jl,Tl)});var Ni=u(wc,2),aa=g(Ni);aa.__click=ic,f(Ni),f(lc),O(mc,lc)},mc=>{var lc=Xt(),wc=_t(lc);Se(wc,()=>n(In),Ni=>{var aa=lE(),Jl=g(aa);Ns(Jl,17,()=>n(Rs),dn,(Tl,_r,sl)=>{var Ga=aE(),ei=g(Ga),yr=g(ei);yr.textContent=`DMI ${sl+1}`;var Ea=u(yr,2);Se(Ea,()=>n(Rs).length>1,xn=>{var Xs=rE();Xs.__click=[iE,Es,_r],O(xn,Xs)}),f(ei);var Di=u(ei,2),Rr=g(Di),wa=u(g(Rr),2);Vt(wa),wa.__input=po,f(Rr);var yi=u(Rr,2),Or=u(g(yi),2);Vt(Or),Or.__input=po,f(yi),f(Di);var pa=u(Di,2),bi=g(pa),pr=u(g(bi),2),ta=We(()=>_f(sl,"diPlus"));pr.__click=function(...xn){var Xs;(Xs=n(ta))==null||Xs.apply(this,xn)};var Ei=g(pr);f(pr);var Yn=u(pr,2);Yn.__change=po;var Vr=g(Yn);Vr.value=(Vr.__value=1)==null?"":1;var Hi=u(Vr);Hi.value=(Hi.__value=2)==null?"":2;var Us=u(Hi);Us.value=(Us.__value=3)==null?"":3;var Gr=u(Us);Gr.value=(Gr.__value=4)==null?"":4;var nn=u(Gr);nn.value=(nn.__value=5)==null?"":5,f(Yn);var Xi=u(Yn,2);Xi.__change=po;var br=g(Xi);br.value=(br.__value="solid")==null?"":"solid";var Ri=u(br);Ri.value=(Ri.__value="dashed")==null?"":"dashed";var tn=u(Ri);tn.value=(tn.__value="dotted")==null?"":"dotted",f(Xi),f(bi);var ks=u(bi,2),ci=u(g(ks),2),Ar=We(()=>_f(sl,"diMinus"));ci.__click=function(...xn){var Xs;(Xs=n(Ar))==null||Xs.apply(this,xn)};var _n=g(ci);f(ci);var oi=u(ci,2);oi.__change=po;var Oi=g(oi);Oi.value=(Oi.__value=1)==null?"":1;var Lr=u(Oi);Lr.value=(Lr.__value=2)==null?"":2;var Tn=u(Lr);Tn.value=(Tn.__value=3)==null?"":3;var Un=u(Tn);Un.value=(Un.__value=4)==null?"":4;var xi=u(Un);xi.value=(xi.__value=5)==null?"":5,f(oi);var Rn=u(oi,2);Rn.__change=po;var $i=g(Rn);$i.value=($i.__value="solid")==null?"":"solid";var Gi=u($i);Gi.value=(Gi.__value="dashed")==null?"":"dashed";var Fs=u(Gi);Fs.value=(Fs.__value="dotted")==null?"":"dotted",f(Rn),f(ks);var yn=u(ks,2),En=u(g(yn),2),On=We(()=>_f(sl,"adx"));En.__click=function(...xn){var Xs;(Xs=n(On))==null||Xs.apply(this,xn)};var Kn=g(En);f(En);var Ii=u(En,2);Ii.__change=po;var bn=g(Ii);bn.value=(bn.__value=1)==null?"":1;var $n=u(bn);$n.value=($n.__value=2)==null?"":2;var nr=u($n);nr.value=(nr.__value=3)==null?"":3;var si=u(nr);si.value=(si.__value=4)==null?"":4;var ni=u(si);ni.value=(ni.__value=5)==null?"":5,f(Ii);var Zs=u(Ii,2);Zs.__change=po;var hs=g(Zs);hs.value=(hs.__value="solid")==null?"":"solid";var Zn=u(hs);Zn.value=(Zn.__value="dashed")==null?"":"dashed";var An=u(Zn);An.value=(An.__value="dotted")==null?"":"dotted",f(Zs),f(yn),f(pa),f(Ga),we(()=>{St(Ei,"style",`background-color: ${n(_r).styles.diPlus.color??""}`),St(_n,"style",`background-color: ${n(_r).styles.diMinus.color??""}`),St(Kn,"style",`background-color: ${n(_r).styles.adx.color??""}`)}),go(wa,()=>n(_r).diPeriod,xn=>n(_r).diPeriod=xn),go(Or,()=>n(_r).adxPeriod,xn=>n(_r).adxPeriod=xn),Bo(Yn,()=>n(_r).styles.diPlus.thickness,xn=>n(_r).styles.diPlus.thickness=xn),Bo(Xi,()=>n(_r).styles.diPlus.lineStyle,xn=>n(_r).styles.diPlus.lineStyle=xn),Bo(oi,()=>n(_r).styles.diMinus.thickness,xn=>n(_r).styles.diMinus.thickness=xn),Bo(Rn,()=>n(_r).styles.diMinus.lineStyle,xn=>n(_r).styles.diMinus.lineStyle=xn),Bo(Ii,()=>n(_r).styles.adx.thickness,xn=>n(_r).styles.adx.thickness=xn),Bo(Zs,()=>n(_r).styles.adx.lineStyle,xn=>n(_r).styles.adx.lineStyle=xn),O(Tl,Ga)});var hr=u(Jl,2),ea=g(hr);ea.__click=[ND,In,Rs,po],f(hr),f(aa),O(Ni,aa)},Ni=>{var aa=Xt(),Jl=_t(aa);Se(Jl,()=>n(at),hr=>{var ea=pE(),Tl=g(ea);Ns(Tl,17,()=>n(jt),dn,(Ga,ei,yr)=>{var Ea=uE(),Di=g(Ea),Rr=g(Di);Rr.textContent=`Williams %R ${yr+1}`;var wa=u(Rr,2);Se(wa,()=>n(jt).length>1,Ps=>{var ki=dE();ki.__click=[cE,Zi,ei],O(Ps,ki)}),f(Di);var yi=u(Di,2),Or=g(yi),pa=u(g(Or),2);Vt(pa),pa.__change=()=>ol(yr),f(Or);var bi=u(Or,2),pr=u(g(bi),2);Vt(pr),pr.__change=()=>ol(yr),f(bi);var ta=u(bi,2),Ei=u(g(ta),2);Vt(Ei),Ei.__change=()=>ol(yr),f(ta);var Yn=u(ta,2),Vr=u(g(Yn),2);Vt(Vr),Vr.__change=()=>ol(yr),f(Yn),f(yi);var Hi=u(yi,2),Us=g(Hi),Gr=u(g(Us),2),nn=We(()=>pv(yr));Gr.__click=function(...Ps){var ki;(ki=n(nn))==null||ki.apply(this,Ps)};var Xi=g(Gr);f(Gr);var br=u(Gr,2);br.__change=()=>ol(yr);var Ri=g(br);Ri.value=(Ri.__value=1)==null?"":1;var tn=u(Ri);tn.value=(tn.__value=2)==null?"":2;var ks=u(tn);ks.value=(ks.__value=3)==null?"":3;var ci=u(ks);ci.value=(ci.__value=4)==null?"":4;var Ar=u(ci);Ar.value=(Ar.__value=5)==null?"":5,f(br);var _n=u(br,2);_n.__change=()=>ol(yr);var oi=g(_n);oi.value=(oi.__value="solid")==null?"":"solid";var Oi=u(oi);Oi.value=(Oi.__value="dashed")==null?"":"dashed";var Lr=u(Oi);Lr.value=(Lr.__value="dotted")==null?"":"dotted",f(_n),f(Us),f(Hi);var Tn=u(Hi,2),Un=u(g(Tn),2),xi=u(g(Un),2),Rn=We(()=>R0(yr));xi.__click=function(...Ps){var ki;(ki=n(Rn))==null||ki.apply(this,Ps)};var $i=g(xi);f(xi);var Gi=u(xi,2);Gi.__change=()=>ol(yr);var Fs=g(Gi);Fs.value=(Fs.__value=1)==null?"":1;var yn=u(Fs);yn.value=(yn.__value=2)==null?"":2;var En=u(yn);En.value=(En.__value=3)==null?"":3;var On=u(En);On.value=(On.__value=4)==null?"":4;var Kn=u(On);Kn.value=(Kn.__value=5)==null?"":5,f(Gi);var Ii=u(Gi,2);Ii.__change=()=>ol(yr);var bn=g(Ii);bn.value=(bn.__value="solid")==null?"":"solid";var $n=u(bn);$n.value=($n.__value="dashed")==null?"":"dashed";var nr=u($n);nr.value=(nr.__value="dotted")==null?"":"dotted",f(Ii),f(Un);var si=u(Un,2),ni=u(g(si),2),Zs=We(()=>rh(yr));ni.__click=function(...Ps){var ki;(ki=n(Zs))==null||ki.apply(this,Ps)};var hs=g(ni);f(ni);var Zn=u(ni,2);Zn.__change=()=>ol(yr);var An=g(Zn);An.value=(An.__value=1)==null?"":1;var xn=u(An);xn.value=(xn.__value=2)==null?"":2;var Xs=u(xn);Xs.value=(Xs.__value=3)==null?"":3;var Vi=u(Xs);Vi.value=(Vi.__value=4)==null?"":4;var as=u(Vi);as.value=(as.__value=5)==null?"":5,f(Zn);var Ji=u(Zn,2);Ji.__change=()=>ol(yr);var Vn=g(Ji);Vn.value=(Vn.__value="solid")==null?"":"solid";var Ks=u(Vn);Ks.value=(Ks.__value="dashed")==null?"":"dashed";var vr=u(Ks);vr.value=(vr.__value="dotted")==null?"":"dotted",f(Ji),f(si);var ys=u(si,2),Os=u(g(ys),2),di=We(()=>ih(yr));Os.__click=function(...Ps){var ki;(ki=n(di))==null||ki.apply(this,Ps)};var Mi=g(Os);f(Os);var Ln=u(Os,2);Ln.__change=()=>ol(yr);var wi=g(Ln);wi.value=(wi.__value=1)==null?"":1;var fr=u(wi);fr.value=(fr.__value=2)==null?"":2;var jn=u(fr);jn.value=(jn.__value=3)==null?"":3;var Wn=u(jn);Wn.value=(Wn.__value=4)==null?"":4;var hi=u(Wn);hi.value=(hi.__value=5)==null?"":5,f(Ln);var $s=u(Ln,2);$s.__change=()=>ol(yr);var jo=g($s);jo.value=(jo.__value="solid")==null?"":"solid";var zs=u(jo);zs.value=(zs.__value="dashed")==null?"":"dashed";var Ti=u(zs);Ti.value=(Ti.__value="dotted")==null?"":"dotted",f($s),f(ys),f(Tn),f(Ea),we(()=>{St(Xi,"style",`background-color: ${n(ei).styles.wr.color??""}`),St($i,"style",`background-color: ${n(ei).styles.overbought.color??""}`),St(hs,"style",`background-color: ${n(ei).styles.middleLine.color??""}`),St(Mi,"style",`background-color: ${n(ei).styles.oversold.color??""}`)}),go(pa,()=>n(ei).period,Ps=>n(ei).period=Ps),go(pr,()=>n(ei).overboughtLevel,Ps=>n(ei).overboughtLevel=Ps),go(Ei,()=>n(ei).middleLevel,Ps=>n(ei).middleLevel=Ps),go(Vr,()=>n(ei).oversoldLevel,Ps=>n(ei).oversoldLevel=Ps),Bo(br,()=>n(ei).styles.wr.thickness,Ps=>n(ei).styles.wr.thickness=Ps),Bo(_n,()=>n(ei).styles.wr.lineStyle,Ps=>n(ei).styles.wr.lineStyle=Ps),Bo(Gi,()=>n(ei).styles.overbought.thickness,Ps=>n(ei).styles.overbought.thickness=Ps),Bo(Ii,()=>n(ei).styles.overbought.lineStyle,Ps=>n(ei).styles.overbought.lineStyle=Ps),Bo(Zn,()=>n(ei).styles.middleLine.thickness,Ps=>n(ei).styles.middleLine.thickness=Ps),Bo(Ji,()=>n(ei).styles.middleLine.lineStyle,Ps=>n(ei).styles.middleLine.lineStyle=Ps),Bo(Ln,()=>n(ei).styles.oversold.thickness,Ps=>n(ei).styles.oversold.thickness=Ps),Bo($s,()=>n(ei).styles.oversold.lineStyle,Ps=>n(ei).styles.oversold.lineStyle=Ps),O(Ga,Ea)});var _r=u(Tl,2),sl=g(_r);sl.__click=Wl,f(_r),f(ea),O(hr,ea)},hr=>{var ea=Xt(),Tl=_t(ea);Se(Tl,()=>n(So),_r=>{var sl=gE(),Ga=g(sl);Ns(Ga,17,()=>n(Co),dn,(Ea,Di,Rr)=>{var wa=fE(),yi=g(wa),Or=g(yi);Or.textContent=`VR ${Rr+1}`;var pa=u(Or,2);Se(pa,()=>n(Co).length>1,jo=>{var zs=vE();zs.__click=()=>xl(Rr),O(jo,zs)}),f(yi);var bi=u(yi,2),pr=g(bi),ta=u(g(pr),2);Vt(ta),f(pr);var Ei=u(pr,2),Yn=u(g(Ei),2);Vt(Yn),f(Ei);var Vr=u(Ei,2),Hi=u(g(Vr),2);Vt(Hi),f(Vr),f(bi);var Us=u(bi,2),Gr=u(g(Us),2),nn=g(Gr),Xi=u(g(nn),2),br=We(()=>Wd(Rr,"vr"));Xi.__click=function(...jo){var zs;(zs=n(br))==null||zs.apply(this,jo)};var Ri=g(Xi);f(Xi),f(nn);var tn=u(nn,2),ks=u(g(tn),2);ks.__change=()=>ba(Rr);var ci=g(ks);ci.value=(ci.__value=1)==null?"":1;var Ar=u(ci);Ar.value=(Ar.__value=2)==null?"":2;var _n=u(Ar);_n.value=(_n.__value=3)==null?"":3;var oi=u(_n);oi.value=(oi.__value=4)==null?"":4;var Oi=u(oi);Oi.value=(Oi.__value=5)==null?"":5,f(ks),f(tn);var Lr=u(tn,2),Tn=u(g(Lr),2);Tn.__change=()=>ba(Rr);var Un=g(Tn);Un.value=(Un.__value="solid")==null?"":"solid";var xi=u(Un);xi.value=(xi.__value="dashed")==null?"":"dashed";var Rn=u(xi);Rn.value=(Rn.__value="dotted")==null?"":"dotted",f(Tn),f(Lr),f(Gr),f(Us);var $i=u(Us,2),Gi=u(g($i),2),Fs=g(Gi),yn=u(g(Fs),2),En=We(()=>Wd(Rr,"vrShort"));yn.__click=function(...jo){var zs;(zs=n(En))==null||zs.apply(this,jo)};var On=g(yn);f(yn),f(Fs);var Kn=u(Fs,2),Ii=u(g(Kn),2);Ii.__change=()=>ba(Rr);var bn=g(Ii);bn.value=(bn.__value=1)==null?"":1;var $n=u(bn);$n.value=($n.__value=2)==null?"":2;var nr=u($n);nr.value=(nr.__value=3)==null?"":3;var si=u(nr);si.value=(si.__value=4)==null?"":4;var ni=u(si);ni.value=(ni.__value=5)==null?"":5,f(Ii),f(Kn);var Zs=u(Kn,2),hs=u(g(Zs),2);hs.__change=()=>ba(Rr);var Zn=g(hs);Zn.value=(Zn.__value="solid")==null?"":"solid";var An=u(Zn);An.value=(An.__value="dashed")==null?"":"dashed";var xn=u(An);xn.value=(xn.__value="dotted")==null?"":"dotted",f(hs),f(Zs),f(Gi),f($i);var Xs=u($i,2),Vi=u(g(Xs),2),as=g(Vi),Ji=u(g(as),2),Vn=We(()=>Wd(Rr,"vrLong"));Ji.__click=function(...jo){var zs;(zs=n(Vn))==null||zs.apply(this,jo)};var Ks=g(Ji);f(Ji),f(as);var vr=u(as,2),ys=u(g(vr),2);ys.__change=()=>ba(Rr);var Os=g(ys);Os.value=(Os.__value=1)==null?"":1;var di=u(Os);di.value=(di.__value=2)==null?"":2;var Mi=u(di);Mi.value=(Mi.__value=3)==null?"":3;var Ln=u(Mi);Ln.value=(Ln.__value=4)==null?"":4;var wi=u(Ln);wi.value=(wi.__value=5)==null?"":5,f(ys),f(vr);var fr=u(vr,2),jn=u(g(fr),2);jn.__change=()=>ba(Rr);var Wn=g(jn);Wn.value=(Wn.__value="solid")==null?"":"solid";var hi=u(Wn);hi.value=(hi.__value="dashed")==null?"":"dashed";var $s=u(hi);$s.value=($s.__value="dotted")==null?"":"dotted",f(jn),f(fr),f(Vi),f(Xs),f(wa),we(()=>{St(Ri,"style",`background-color: ${n(Di).styles.vr.color??""}`),St(On,"style",`background-color: ${n(Di).styles.vrShort.color??""}`),St(Ks,"style",`background-color: ${n(Di).styles.vrLong.color??""}`)}),go(ta,()=>n(Di).period,jo=>n(Di).period=jo),go(Yn,()=>n(Di).shortPeriod,jo=>n(Di).shortPeriod=jo),go(Hi,()=>n(Di).longPeriod,jo=>n(Di).longPeriod=jo),Bo(ks,()=>n(Di).styles.vr.thickness,jo=>n(Di).styles.vr.thickness=jo),Bo(Tn,()=>n(Di).styles.vr.lineStyle,jo=>n(Di).styles.vr.lineStyle=jo),Bo(Ii,()=>n(Di).styles.vrShort.thickness,jo=>n(Di).styles.vrShort.thickness=jo),Bo(hs,()=>n(Di).styles.vrShort.lineStyle,jo=>n(Di).styles.vrShort.lineStyle=jo),Bo(ys,()=>n(Di).styles.vrLong.thickness,jo=>n(Di).styles.vrLong.thickness=jo),Bo(jn,()=>n(Di).styles.vrLong.lineStyle,jo=>n(Di).styles.vrLong.lineStyle=jo),O(Ea,wa)});var ei=u(Ga,2),yr=g(ei);yr.__click=Jc,f(ei),f(sl),O(_r,sl)},_r=>{var sl=Xt(),Ga=_t(sl);Se(Ga,()=>n(qt),ei=>{var yr=yE(),Ea=g(yr);Ns(Ea,17,()=>n(Ho),dn,(wa,yi,Or)=>{var pa=_E(),bi=g(pa),pr=g(bi);pr.textContent=`BBI ${Or+1}`;var ta=u(pr,2);Se(ta,()=>n(Ho).length>1,En=>{var On=hE();On.__click=[mE,Pa,yi],O(En,On)}),f(bi);var Ei=u(bi,2),Yn=g(Ei),Vr=u(g(Yn),2);Vt(Vr),Vr.__change=()=>Fi(Or),f(Yn);var Hi=u(Yn,2),Us=u(g(Hi),2);Vt(Us),Us.__change=()=>Fi(Or),f(Hi);var Gr=u(Hi,2),nn=u(g(Gr),2);Vt(nn),nn.__change=()=>Fi(Or),f(Gr);var Xi=u(Gr,2),br=u(g(Xi),2);Vt(br),br.__change=()=>Fi(Or),f(Xi),f(Ei);var Ri=u(Ei,2),tn=g(Ri),ks=u(g(tn),2),ci=We(()=>kf(Or));ks.__click=function(...En){var On;(On=n(ci))==null||On.apply(this,En)};var Ar=g(ks);f(ks),f(tn);var _n=u(tn,2),oi=u(g(_n),2);oi.__change=()=>Fi(Or);var Oi=g(oi);Oi.value=(Oi.__value=1)==null?"":1;var Lr=u(Oi);Lr.value=(Lr.__value=2)==null?"":2;var Tn=u(Lr);Tn.value=(Tn.__value=3)==null?"":3;var Un=u(Tn);Un.value=(Un.__value=4)==null?"":4;var xi=u(Un);xi.value=(xi.__value=5)==null?"":5,f(oi),f(_n);var Rn=u(_n,2),$i=u(g(Rn),2);$i.__change=()=>Fi(Or);var Gi=g($i);Gi.value=(Gi.__value="solid")==null?"":"solid";var Fs=u(Gi);Fs.value=(Fs.__value="dashed")==null?"":"dashed";var yn=u(Fs);yn.value=(yn.__value="dotted")==null?"":"dotted",f($i),f(Rn),f(Ri),f(pa),we(()=>St(Ar,"style",`background-color: ${n(yi).color??""}`)),go(Vr,()=>n(yi).period1,En=>n(yi).period1=En),go(Us,()=>n(yi).period2,En=>n(yi).period2=En),go(nn,()=>n(yi).period3,En=>n(yi).period3=En),go(br,()=>n(yi).period4,En=>n(yi).period4=En),Bo(oi,()=>n(yi).thickness,En=>n(yi).thickness=En),Bo($i,()=>n(yi).lineStyle,En=>n(yi).lineStyle=En),O(wa,pa)});var Di=u(Ea,2),Rr=g(Di);Rr.__click=Mr,f(Di),f(yr),O(ei,yr)},ei=>{var yr=Xt(),Ea=_t(yr);Se(Ea,()=>n(Vl),Di=>{var Rr=kE(),wa=g(Rr);Ns(wa,17,()=>n(ur),dn,(pa,bi)=>{var pr=wE(),ta=g(pr),Ei=g(ta),Yn=g(Ei,!0);f(Ei);var Vr=u(Ei,2);Se(Vr,()=>n(ur).length>1,Fs=>{var yn=xE();yn.__click=[bE,fu,bi],O(Fs,yn)}),f(ta);var Hi=u(ta,2),Us=g(Hi),Gr=u(g(Us),2);Vt(Gr),f(Us);var nn=u(Us,2),Xi=u(g(nn),2);Vt(Xi),f(nn),f(Hi);var br=u(Hi,2),Ri=g(br),tn=u(g(Ri),2);tn.__click=[VD,ce,q];var ks=g(tn);f(tn),f(Ri);var ci=u(Ri,2),Ar=u(g(ci),2),_n=g(Ar);_n.value=(_n.__value=1)==null?"":1;var oi=u(_n);oi.value=(oi.__value=2)==null?"":2;var Oi=u(oi);Oi.value=(Oi.__value=3)==null?"":3;var Lr=u(Oi);Lr.value=(Lr.__value=4)==null?"":4;var Tn=u(Lr);Tn.value=(Tn.__value=5)==null?"":5,f(Ar),f(ci);var Un=u(ci,2),xi=u(g(Un),2),Rn=g(xi);Rn.value=(Rn.__value="solid")==null?"":"solid";var $i=u(Rn);$i.value=($i.__value="dashed")==null?"":"dashed";var Gi=u($i);Gi.value=(Gi.__value="dotted")==null?"":"dotted",f(xi),f(Un),f(br),f(pr),we(()=>{Ye(Yn,n(bi).name),St(ks,"style",`background-color: ${n(bi).color??""}`)}),go(Gr,()=>n(bi).period,Fs=>n(bi).period=Fs),go(Xi,()=>n(bi).period2,Fs=>n(bi).period2=Fs),Bo(Ar,()=>n(bi).thickness,Fs=>n(bi).thickness=Fs),Bo(xi,()=>n(bi).lineStyle,Fs=>n(bi).lineStyle=Fs),O(pa,pr)});var yi=u(wa,2),Or=g(yi);Or.__click=[DD,Vl,ur],f(yi),f(Rr),O(Di,Rr)},Di=>{var Rr=Xt(),wa=_t(Rr);Se(wa,()=>n(ul),yi=>{var Or=IE(),pa=g(Or);Ns(pa,17,()=>n(kn),dn,(ta,Ei,Yn)=>{var Vr=PE(),Hi=g(Vr),Us=g(Hi),Gr=g(Us,!0);f(Us);var nn=u(Us,2);Se(nn,()=>n(kn).length>1,On=>{var Kn=CE();Kn.__click=[SE,da,Ei],O(On,Kn)}),f(Hi);var Xi=u(Hi,2),br=g(Xi),Ri=u(g(br),2);Vt(Ri),Ri.__input=Nr,f(br),f(Xi);var tn=u(Xi,2),ks=g(tn),ci=u(g(ks),2),Ar=We(()=>yf(Yn));ci.__click=function(...On){var Kn;(Kn=n(Ar))==null||Kn.apply(this,On)};var _n=g(ci);f(ci),f(ks);var oi=u(ks,2),Oi=u(g(oi),2);Oi.__change=Nr;var Lr=g(Oi);Lr.value=(Lr.__value=1)==null?"":1;var Tn=u(Lr);Tn.value=(Tn.__value=2)==null?"":2;var Un=u(Tn);Un.value=(Un.__value=3)==null?"":3;var xi=u(Un);xi.value=(xi.__value=4)==null?"":4;var Rn=u(xi);Rn.value=(Rn.__value=5)==null?"":5,f(Oi),f(oi);var $i=u(oi,2),Gi=u(g($i),2);Gi.__change=Nr;var Fs=g(Gi);Fs.value=(Fs.__value="solid")==null?"":"solid";var yn=u(Fs);yn.value=(yn.__value="dashed")==null?"":"dashed";var En=u(yn);En.value=(En.__value="dotted")==null?"":"dotted",f(Gi),f($i),f(tn),f(Vr),we(()=>{Ye(Gr,n(Ei).name),St(_n,"style",`background-color: ${n(Ei).color??""}`)}),go(Ri,()=>n(Ei).period,On=>n(Ei).period=On),Bo(Oi,()=>n(Ei).thickness,On=>n(Ei).thickness=On),Bo(Gi,()=>n(Ei).lineStyle,On=>n(Ei).lineStyle=On),O(ta,Vr)});var bi=u(pa,2),pr=g(bi);pr.__click=[ED,ul,kn,Nr],f(bi),f(Or),O(yi,Or)},yi=>{var Or=Xt(),pa=_t(Or);Se(pa,()=>n(Ge),bi=>{var pr=AE(),ta=g(pr);Ns(ta,17,()=>n(Oo),dn,(Vr,Hi,Us)=>{var Gr=TE(),nn=g(Gr),Xi=g(nn);Xi.textContent=Us===0?"Awesome Oscillator":`AO ${Us+1}`;var br=u(Xi,2);br.__click=[ME,nh,Hi],f(nn);var Ri=u(nn,2),tn=g(Ri),ks=u(g(tn),2);Vt(ks),ks.__input=gu,f(tn);var ci=u(tn,2),Ar=u(g(ci),2);Vt(Ar),Ar.__input=gu,f(ci),f(Ri);var _n=u(Ri,2),oi=u(g(_n),2),Oi=g(oi),Lr=u(g(Oi),2),Tn=g(Lr),Un=u(Tn,2),xi=We(()=>qd(Us*2));Un.__click=function(...Kn){var Ii;(Ii=n(xi))==null||Ii.apply(this,Kn)};var Rn=g(Un);f(Un),f(Lr),f(Oi);var $i=u(Oi,2),Gi=u(g($i),2),Fs=g(Gi),yn=u(Fs,2),En=We(()=>qd(Us*2+1));yn.__click=function(...Kn){var Ii;(Ii=n(En))==null||Ii.apply(this,Kn)};var On=g(yn);f(yn),f(Gi),f($i),f(oi),f(_n),f(Gr),we(()=>{St(Tn,"style",`background-color: ${n(Hi).styles.increasing.color??""}`),St(Rn,"style",`background-color: ${n(Hi).styles.increasing.color??""}`),St(Fs,"style",`background-color: ${n(Hi).styles.decreasing.color??""}`),St(On,"style",`background-color: ${n(Hi).styles.decreasing.color??""}`)}),go(ks,()=>n(Hi).shortPeriod,Kn=>n(Hi).shortPeriod=Kn),go(Ar,()=>n(Hi).longPeriod,Kn=>n(Hi).longPeriod=Kn),O(Vr,Gr)});var Ei=u(ta,2),Yn=g(Ei);Yn.__click=[OD,Ge,Oo,gu],f(Ei),f(pr),O(bi,pr)},bi=>{var pr=Xt(),ta=_t(pr);Se(ta,()=>n(za),Ei=>{var Yn=EE(),Vr=g(Yn);Ns(Vr,17,()=>n(li),dn,(Gr,nn,Xi)=>{var br=DE(),Ri=g(br),tn=g(Ri);tn.textContent=`CR ${Xi+1}`;var ks=u(tn,2);Se(ks,()=>n(li).length>1,Ai=>{var Ta=FE();Ta.__click=[LE,Qn,nn],O(Ai,Ta)}),f(Ri);var ci=u(Ri,2),Ar=g(ci),_n=u(g(Ar),2);Vt(_n),_n.__input=ms,f(Ar);var oi=u(Ar,2),Oi=u(g(oi),2);Vt(Oi),Oi.__input=ms,f(oi);var Lr=u(oi,2),Tn=u(g(Lr),2);Vt(Tn),Tn.__input=ms,f(Lr);var Un=u(Lr,2),xi=u(g(Un),2);Vt(xi),xi.__input=ms,f(Un);var Rn=u(Un,2),$i=u(g(Rn),2);Vt($i),$i.__input=ms,f(Rn),f(ci);var Gi=u(ci,2),Fs=g(Gi),yn=u(g(Fs),2),En=We(()=>ua(Xi,"cr"));yn.__click=function(...Ai){var Ta;(Ta=n(En))==null||Ta.apply(this,Ai)};var On=g(yn);f(yn);var Kn=u(yn,2);Kn.__change=ms;var Ii=g(Kn);Ii.value=(Ii.__value=1)==null?"":1;var bn=u(Ii);bn.value=(bn.__value=2)==null?"":2;var $n=u(bn);$n.value=($n.__value=3)==null?"":3;var nr=u($n);nr.value=(nr.__value=4)==null?"":4;var si=u(nr);si.value=(si.__value=5)==null?"":5,f(Kn);var ni=u(Kn,2);ni.__change=ms;var Zs=g(ni);Zs.value=(Zs.__value="solid")==null?"":"solid";var hs=u(Zs);hs.value=(hs.__value="dashed")==null?"":"dashed";var Zn=u(hs);Zn.value=(Zn.__value="dotted")==null?"":"dotted",f(ni),f(Fs);var An=u(Fs,2),xn=u(g(An),2),Xs=We(()=>ua(Xi,"ma1"));xn.__click=function(...Ai){var Ta;(Ta=n(Xs))==null||Ta.apply(this,Ai)};var Vi=g(xn);f(xn);var as=u(xn,2);as.__change=ms;var Ji=g(as);Ji.value=(Ji.__value=1)==null?"":1;var Vn=u(Ji);Vn.value=(Vn.__value=2)==null?"":2;var Ks=u(Vn);Ks.value=(Ks.__value=3)==null?"":3;var vr=u(Ks);vr.value=(vr.__value=4)==null?"":4;var ys=u(vr);ys.value=(ys.__value=5)==null?"":5,f(as);var Os=u(as,2);Os.__change=ms;var di=g(Os);di.value=(di.__value="solid")==null?"":"solid";var Mi=u(di);Mi.value=(Mi.__value="dashed")==null?"":"dashed";var Ln=u(Mi);Ln.value=(Ln.__value="dotted")==null?"":"dotted",f(Os),f(An);var wi=u(An,2),fr=u(g(wi),2),jn=We(()=>ua(Xi,"ma2"));fr.__click=function(...Ai){var Ta;(Ta=n(jn))==null||Ta.apply(this,Ai)};var Wn=g(fr);f(fr);var hi=u(fr,2);hi.__change=ms;var $s=g(hi);$s.value=($s.__value=1)==null?"":1;var jo=u($s);jo.value=(jo.__value=2)==null?"":2;var zs=u(jo);zs.value=(zs.__value=3)==null?"":3;var Ti=u(zs);Ti.value=(Ti.__value=4)==null?"":4;var Ps=u(Ti);Ps.value=(Ps.__value=5)==null?"":5,f(hi);var ki=u(hi,2);ki.__change=ms;var ln=g(ki);ln.value=(ln.__value="solid")==null?"":"solid";var Yi=u(ln);Yi.value=(Yi.__value="dashed")==null?"":"dashed";var oa=u(Yi);oa.value=(oa.__value="dotted")==null?"":"dotted",f(ki),f(wi);var Pr=u(wi,2),Fr=u(g(Pr),2),Yr=We(()=>ua(Xi,"ma3"));Fr.__click=function(...Ai){var Ta;(Ta=n(Yr))==null||Ta.apply(this,Ai)};var ka=g(Fr);f(Fr);var va=u(Fr,2);va.__change=ms;var ma=g(va);ma.value=(ma.__value=1)==null?"":1;var la=u(ma);la.value=(la.__value=2)==null?"":2;var ra=u(la);ra.value=(ra.__value=3)==null?"":3;var Qi=u(ra);Qi.value=(Qi.__value=4)==null?"":4;var $a=u(Qi);$a.value=($a.__value=5)==null?"":5,f(va);var Al=u(va,2);Al.__change=ms;var Ql=g(Al);Ql.value=(Ql.__value="solid")==null?"":"solid";var Sa=u(Ql);Sa.value=(Sa.__value="dashed")==null?"":"dashed";var cc=u(Sa);cc.value=(cc.__value="dotted")==null?"":"dotted",f(Al),f(Pr);var dc=u(Pr,2),Ya=u(g(dc),2),Si=We(()=>ua(Xi,"ma4"));Ya.__click=function(...Ai){var Ta;(Ta=n(Si))==null||Ta.apply(this,Ai)};var kc=g(Ya);f(Ya);var Ua=u(Ya,2);Ua.__change=ms;var Tc=g(Ua);Tc.value=(Tc.__value=1)==null?"":1;var uc=u(Tc);uc.value=(uc.__value=2)==null?"":2;var Er=u(uc);Er.value=(Er.__value=3)==null?"":3;var Ac=u(Er);Ac.value=(Ac.__value=4)==null?"":4;var Gl=u(Ac);Gl.value=(Gl.__value=5)==null?"":5,f(Ua);var Nl=u(Ua,2);Nl.__change=ms;var nl=g(Nl);nl.value=(nl.__value="solid")==null?"":"solid";var Ll=u(nl);Ll.value=(Ll.__value="dashed")==null?"":"dashed";var Lc=u(Ll);Lc.value=(Lc.__value="dotted")==null?"":"dotted",f(Nl),f(dc),f(Gi),f(br),we(()=>{St(On,"style",`background-color: ${n(nn).styles.cr.color??""}`),St(Vi,"style",`background-color: ${n(nn).styles.ma1.color??""}`),St(Wn,"style",`background-color: ${n(nn).styles.ma2.color??""}`),St(ka,"style",`background-color: ${n(nn).styles.ma3.color??""}`),St(kc,"style",`background-color: ${n(nn).styles.ma4.color??""}`)}),go(_n,()=>n(nn).crPeriod,Ai=>n(nn).crPeriod=Ai),go(Oi,()=>n(nn).crMa1Period,Ai=>n(nn).crMa1Period=Ai),go(Tn,()=>n(nn).crMa2Period,Ai=>n(nn).crMa2Period=Ai),go(xi,()=>n(nn).crMa3Period,Ai=>n(nn).crMa3Period=Ai),go($i,()=>n(nn).crMa4Period,Ai=>n(nn).crMa4Period=Ai),Bo(Kn,()=>n(nn).styles.cr.thickness,Ai=>n(nn).styles.cr.thickness=Ai),Bo(ni,()=>n(nn).styles.cr.lineStyle,Ai=>n(nn).styles.cr.lineStyle=Ai),Bo(as,()=>n(nn).styles.ma1.thickness,Ai=>n(nn).styles.ma1.thickness=Ai),Bo(Os,()=>n(nn).styles.ma1.lineStyle,Ai=>n(nn).styles.ma1.lineStyle=Ai),Bo(hi,()=>n(nn).styles.ma2.thickness,Ai=>n(nn).styles.ma2.thickness=Ai),Bo(ki,()=>n(nn).styles.ma2.lineStyle,Ai=>n(nn).styles.ma2.lineStyle=Ai),Bo(va,()=>n(nn).styles.ma3.thickness,Ai=>n(nn).styles.ma3.thickness=Ai),Bo(Al,()=>n(nn).styles.ma3.lineStyle,Ai=>n(nn).styles.ma3.lineStyle=Ai),Bo(Ua,()=>n(nn).styles.ma4.thickness,Ai=>n(nn).styles.ma4.thickness=Ai),Bo(Nl,()=>n(nn).styles.ma4.lineStyle,Ai=>n(nn).styles.ma4.lineStyle=Ai),O(Gr,br)});var Hi=u(Vr,2),Us=g(Hi);Us.__click=[RD,za,li,ms],f(Hi),f(Yn),O(Ei,Yn)},Ei=>{var Yn=Xt(),Vr=_t(Yn);Se(Vr,()=>n(ca),Hi=>{var Us=jE(),Gr=g(Us);Ns(Gr,17,()=>n(Qs),dn,(br,Ri,tn)=>{var ks=$E(),ci=g(ks),Ar=g(ci);Ar.textContent=`ZigZag ${tn+1}`,f(ci);var _n=u(ci,2),oi=g(_n),Oi=u(g(oi),2);Vt(Oi),Oi.__input=wn,f(oi);var Lr=u(oi,2),Tn=u(g(Lr),2);Vt(Tn),Tn.__input=wn,f(Lr),f(_n);var Un=u(_n,2),xi=u(g(Un),2),Rn=g(xi),$i=u(g(Rn),2),Gi=g($i),Fs=u(Gi,2);Fs.__click=()=>zi(tn);var yn=g(Fs);f(Fs),f($i),f(Rn);var En=u(Rn,2),On=u(g(En),2);On.__change=wn;var Kn=g(On);Kn.value=(Kn.__value=1)==null?"":1;var Ii=u(Kn);Ii.value=(Ii.__value=2)==null?"":2;var bn=u(Ii);bn.value=(bn.__value=3)==null?"":3;var $n=u(bn);$n.value=($n.__value=4)==null?"":4;var nr=u($n);nr.value=(nr.__value=5)==null?"":5,f(On),f(En);var si=u(En,2),ni=u(g(si),2);ni.__change=wn;var Zs=g(ni);Zs.value=(Zs.__value="solid")==null?"":"solid";var hs=u(Zs);hs.value=(hs.__value="dashed")==null?"":"dashed";var Zn=u(hs);Zn.value=(Zn.__value="dotted")==null?"":"dotted",f(ni),f(si),f(xi),f(Un),f(ks),we(()=>{St(Gi,"style",`background-color: ${n(Ri).styles.color??""}`),St(yn,"style",`background-color: ${n(Ri).styles.color??""}`)}),go(Oi,()=>n(Ri).deviation,An=>n(Ri).deviation=An),go(Tn,()=>n(Ri).depth,An=>n(Ri).depth=An),Bo(On,()=>n(Ri).styles.thickness,An=>n(Ri).styles.thickness=An),Bo(ni,()=>n(Ri).styles.lineStyle,An=>n(Ri).styles.lineStyle=An),O(br,ks)});var nn=u(Gr,2),Xi=g(nn);Xi.__click=[TD,Qs,wn],f(nn),f(Us),O(Hi,Us)},Hi=>{var Us=Xt(),Gr=_t(Us);Se(Gr,()=>n(js),nn=>{var Xi=NE(),br=g(Xi);Ns(br,17,()=>n(Ut),dn,(ks,ci,Ar)=>{var _n=BE(),oi=g(_n),Oi=g(oi),Lr=g(Oi);we(()=>Ye(Lr,`${n(ci).name??""} (ID: ${n(ci).id.slice(0,8)??""})`)),f(Oi);var Tn=u(Oi,2);Se(Tn,()=>n(Ut).length>1,hs=>{var Zn=zE();Zn.__click=()=>sn(Ar),O(hs,Zn)}),f(oi);var Un=u(oi,2),xi=g(Un),Rn=u(g(xi),2),$i=We(()=>O0(Ar));Rn.__click=function(...hs){var Zn;(Zn=n($i))==null||Zn.apply(this,hs)};var Gi=g(Rn);f(Rn),f(xi);var Fs=u(xi,2),yn=u(g(Fs),2);yn.__change=hs=>{hs.target&&(n(ci).thickness=parseInt(hs.target.value),cp(Ar))};var En=g(yn);En.value=(En.__value=1)==null?"":1;var On=u(En);On.value=(On.__value=2)==null?"":2;var Kn=u(On);Kn.value=(Kn.__value=3)==null?"":3;var Ii=u(Kn);Ii.value=(Ii.__value=4)==null?"":4;var bn=u(Ii);bn.value=(bn.__value=5)==null?"":5,f(yn),f(Fs);var $n=u(Fs,2),nr=u(g($n),2);nr.__change=hs=>{hs.target&&(n(ci).lineStyle=hs.target.value,cp(Ar))};var si=g(nr);si.value=(si.__value="solid")==null?"":"solid";var ni=u(si);ni.value=(ni.__value="dashed")==null?"":"dashed";var Zs=u(ni);Zs.value=(Zs.__value="dotted")==null?"":"dotted",f(nr),f($n),f(Un),f(_n),we(()=>St(Gi,"style",`background-color: ${n(ci).color??""}`)),Bo(yn,()=>n(ci).thickness,hs=>n(ci).thickness=hs),Bo(nr,()=>n(ci).lineStyle,hs=>n(ci).lineStyle=hs),O(ks,_n)});var Ri=u(br,2),tn=g(Ri);tn.__click=Ds,f(Ri),f(Xi),O(nn,Xi)},nn=>{var Xi=Xt(),br=_t(Xi);Se(br,()=>n(_s),Ri=>{var tn=WE(),ks=g(tn);Ns(ks,17,()=>n(is),dn,(_n,oi,Oi)=>{var Lr=VE(),Tn=g(Lr),Un=g(Tn);Un.textContent=`SAR ${Oi+1}`;var xi=u(Un,2);Se(xi,()=>n(is).length>1,Xs=>{var Vi=OE();Vi.__click=[RE,dt,oi],O(Xs,Vi)}),f(Tn);var Rn=u(Tn,2),$i=g(Rn),Gi=u(g($i),2);Vt(Gi),f($i);var Fs=u($i,2),yn=u(g(Fs),2);Vt(yn),f(Fs);var En=u(Fs,2),On=u(g(En),2);Vt(On),f(En),f(Rn);var Kn=u(Rn,2),Ii=g(Kn),bn=u(g(Ii),2),$n=We(()=>V0(Oi));bn.__click=function(...Xs){var Vi;(Vi=n($n))==null||Vi.apply(this,Xs)};var nr=g(bn);f(bn),f(Ii);var si=u(Ii,2),ni=u(g(si),2),Zs=g(ni);Zs.value=(Zs.__value=1)==null?"":1;var hs=u(Zs);hs.value=(hs.__value=2)==null?"":2;var Zn=u(hs);Zn.value=(Zn.__value=3)==null?"":3;var An=u(Zn);An.value=(An.__value=4)==null?"":4;var xn=u(An);xn.value=(xn.__value=5)==null?"":5,f(ni),f(si),f(Kn),f(Lr),we(()=>St(nr,"style",`background-color: ${n(oi).color??""}`)),go(Gi,()=>n(oi).start,Xs=>n(oi).start=Xs),go(yn,()=>n(oi).increment,Xs=>n(oi).increment=Xs),go(On,()=>n(oi).maxValue,Xs=>n(oi).maxValue=Xs),Bo(ni,()=>n(oi).dotSize,Xs=>n(oi).dotSize=Xs),O(_n,Lr)});var ci=u(ks,2),Ar=g(ci);Ar.__click=[zD,_s,is,At],f(ci),f(tn),O(Ri,tn)},Ri=>{var tn=Xt(),ks=_t(tn);Se(ks,()=>n(Zl),ci=>{var Ar=YE(),_n=g(Ar);Ns(_n,17,()=>n(vs),dn,(Lr,Tn,Un)=>{var xi=GE(),Rn=g(xi),$i=g(Rn);$i.textContent=`Smart Trend ${Un+1}`;var Gi=u($i,2);Se(Gi,()=>n(vs).length>1,ln=>{var Yi=HE();Yi.__click=[qE,co,Tn],O(ln,Yi)}),f(Rn);var Fs=u(Rn,2),yn=g(Fs),En=u(g(yn),2);Vt(En),En.__change=()=>wo(Un),f(yn);var On=u(yn,2),Kn=u(g(On),2);Vt(Kn),Kn.__change=()=>wo(Un),f(On),f(Fs);var Ii=u(Fs,2),bn=g(Ii);Vt(bn),bn.__change=()=>wo(Un),un(2),f(Ii);var $n=u(Ii,2),nr=u(g($n),2),si=g(nr),ni=u(g(si),2);ni.__click=()=>{b(Xa,!0),b(Va,j(Un)),b(Wa,"uptrend")};var Zs=g(ni);f(ni),f(si);var hs=u(si,2),Zn=u(g(hs),2);Zn.__change=()=>wo(Un);var An=g(Zn);An.value=(An.__value=1)==null?"":1;var xn=u(An);xn.value=(xn.__value=2)==null?"":2;var Xs=u(xn);Xs.value=(Xs.__value=3)==null?"":3;var Vi=u(Xs);Vi.value=(Vi.__value=4)==null?"":4;var as=u(Vi);as.value=(as.__value=5)==null?"":5,f(Zn),f(hs);var Ji=u(hs,2),Vn=u(g(Ji),2);Vn.__change=()=>wo(Un);var Ks=g(Vn);Ks.value=(Ks.__value="solid")==null?"":"solid";var vr=u(Ks);vr.value=(vr.__value="dashed")==null?"":"dashed",f(Vn),f(Ji),f(nr),f($n);var ys=u($n,2),Os=u(g(ys),2),di=g(Os),Mi=u(g(di),2);Mi.__click=()=>{b(Xa,!0),b(Va,j(Un)),b(Wa,"downtrend")};var Ln=g(Mi);f(Mi),f(di);var wi=u(di,2),fr=u(g(wi),2);fr.__change=()=>wo(Un);var jn=g(fr);jn.value=(jn.__value=1)==null?"":1;var Wn=u(jn);Wn.value=(Wn.__value=2)==null?"":2;var hi=u(Wn);hi.value=(hi.__value=3)==null?"":3;var $s=u(hi);$s.value=($s.__value=4)==null?"":4;var jo=u($s);jo.value=(jo.__value=5)==null?"":5,f(fr),f(wi);var zs=u(wi,2),Ti=u(g(zs),2);Ti.__change=()=>wo(Un);var Ps=g(Ti);Ps.value=(Ps.__value="solid")==null?"":"solid";var ki=u(Ps);ki.value=(ki.__value="dashed")==null?"":"dashed",f(Ti),f(zs),f(Os),f(ys),f(xi),we(()=>{St(Zs,"style",`background-color: ${n(Tn).styles.uptrend.color??""}`),St(Ln,"style",`background-color: ${n(Tn).styles.downtrend.color??""}`)}),go(En,()=>n(Tn).period,ln=>n(Tn).period=ln),go(Kn,()=>n(Tn).multiplier,ln=>n(Tn).multiplier=ln),Bu(bn,()=>n(Tn).showLabels,ln=>n(Tn).showLabels=ln),Bo(Zn,()=>n(Tn).styles.uptrend.thickness,ln=>n(Tn).styles.uptrend.thickness=ln),Bo(Vn,()=>n(Tn).styles.uptrend.lineStyle,ln=>n(Tn).styles.uptrend.lineStyle=ln),Bo(fr,()=>n(Tn).styles.downtrend.thickness,ln=>n(Tn).styles.downtrend.thickness=ln),Bo(Ti,()=>n(Tn).styles.downtrend.lineStyle,ln=>n(Tn).styles.downtrend.lineStyle=ln),O(Lr,xi)});var oi=u(_n,2),Oi=g(oi);Oi.__click=[BD,Zl,vs,$o],f(oi),f(Ar),O(ci,Ar)},ci=>{var Ar=Xt(),_n=_t(Ar);Se(_n,()=>n(Io),oi=>{var Oi=o$(),Lr=g(Oi);Ns(Lr,17,()=>_,dn,(Un,xi,Rn)=>{var $i=e$(),Gi=g($i),Fs=g(Gi),yn=g(Fs,!0);f(Fs);var En=u(Fs,2),On=g(En);Vt(On),On.__change=[UE,Hs];var Kn=u(On,2);Se(Kn,()=>p.length>1,bn=>{var $n=KE();$n.__click=()=>$v(Rn),O(bn,$n)},bn=>{var $n=ZE();O(bn,$n)}),f(En),f(Gi);var Ii=u(Gi,2);Se(Ii,()=>y[Rn],bn=>{var $n=QE(),nr=g($n),si=u(g(nr),2),ni=We(()=>wf(Rn));si.__click=function(...Os){var di;(di=n(ni))==null||di.apply(this,Os)};var Zs=g(si);f(si),f(nr);var hs=u(nr,2),Zn=u(g(hs),2);Zn.__change=[XE,Hs];var An=g(Zn);An.value=(An.__value=1)==null?"":1;var xn=u(An);xn.value=(xn.__value=2)==null?"":2;var Xs=u(xn);Xs.value=(Xs.__value=3)==null?"":3;var Vi=u(Xs);Vi.value=(Vi.__value=4)==null?"":4;var as=u(Vi);as.value=(as.__value=5)==null?"":5,f(Zn),f(hs);var Ji=u(hs,2),Vn=u(g(Ji),2);Vn.__change=[JE,Hs];var Ks=g(Vn);Ks.value=(Ks.__value="solid")==null?"":"solid";var vr=u(Ks);vr.value=(vr.__value="dashed")==null?"":"dashed";var ys=u(vr);ys.value=(ys.__value="dotted")==null?"":"dotted",f(Vn),f(Ji),f($n),we(()=>St(Zs,"style",`background-color: ${y[Rn].color??""}`)),Bo(Zn,()=>y[Rn].thickness,Os=>y[Rn].thickness=Os),Bo(Vn,()=>y[Rn].lineStyle,Os=>y[Rn].lineStyle=Os),O(bn,$n)}),f($i),we(()=>Ye(yn,n(xi).title)),go(On,()=>p[Rn],bn=>p[Rn]=bn),O(Un,$i)});var Tn=u(Lr,2);Se(Tn,()=>_.length<10,Un=>{var xi=t$(),Rn=g(xi);Rn.__click=[xm,Dr,Ki,jv,Ge,fv,at,gv,Ci,zv,_,p,y,fn,xa,Io,Hs],f(xi),O(Un,xi)}),f(Oi),O(oi,Oi)},oi=>{var Oi=Xt(),Lr=_t(Oi);Se(Lr,()=>n(us),Tn=>{var Un=i$(),xi=g(Un);Ns(xi,17,()=>n(Yo),dn,(Gi,Fs,yn)=>{var En=n$(),On=g(En),Kn=g(On),Ii=g(Kn);f(Kn);var bn=u(Kn,2);Se(bn,()=>n(Yo).length>1,di=>{var Mi=s$();Mi.__click=()=>ed(yn),O(di,Mi)}),f(On);var $n=u(On,2),nr=u(g($n),2);Vt(nr),nr.__change=()=>Qc(yn),f($n);var si=u($n,2),ni=g(si),Zs=u(g(ni),2);Zs.__click=di=>{b(ut,j(yn));const Mi=di.currentTarget.getBoundingClientRect();b(uo,j({x:Mi.left+Mi.width/2,y:Mi.bottom+5})),b(ht,!0)};var hs=g(Zs);f(Zs),f(ni);var Zn=u(ni,2),An=u(g(Zn),2);An.__change=()=>Qc(yn);var xn=g(An);xn.value=(xn.__value=1)==null?"":1;var Xs=u(xn);Xs.value=(Xs.__value=2)==null?"":2;var Vi=u(Xs);Vi.value=(Vi.__value=3)==null?"":3;var as=u(Vi);as.value=(as.__value=4)==null?"":4;var Ji=u(as);Ji.value=(Ji.__value=5)==null?"":5,f(An),f(Zn);var Vn=u(Zn,2),Ks=u(g(Vn),2);Ks.__change=()=>Qc(yn);var vr=g(Ks);vr.value=(vr.__value="solid")==null?"":"solid";var ys=u(vr);ys.value=(ys.__value="dashed")==null?"":"dashed";var Os=u(ys);Os.value=(Os.__value="dotted")==null?"":"dotted",f(Ks),f(Vn),f(si),f(En),we(()=>{Ye(Ii,`SMA (${n(Fs).period??""})`),St(hs,"style",`background-color: ${n(Fs).color??""}`)}),go(nr,()=>n(Fs).period,di=>n(Fs).period=di),Bo(An,()=>n(Fs).thickness,di=>n(Fs).thickness=di),Bo(Ks,()=>n(Fs).lineStyle,di=>n(Fs).lineStyle=di),O(Gi,En)});var Rn=u(xi,2),$i=g(Rn);$i.__click=Hu,f(Rn),f(Un),O(Tn,Un)},Tn=>{var Un=Xt(),xi=_t(Un);Se(xi,()=>n(on),Rn=>{var $i=c$();Ns($i,21,()=>n(Ce),dn,(Gi,Fs,yn)=>{var En=l$(),On=g(En),Kn=g(On);Kn.textContent=`Volume ${yn+1}`;var Ii=u(Kn,2);Se(Ii,()=>n(Ce).length>1,ln=>{var Yi=r$();Yi.__click=()=>$l(yn),O(ln,Yi)},ln=>{var Yi=a$();O(ln,Yi)}),f(On);var bn=u(On,2),$n=g(bn),nr=u(g($n),2);Vt(nr),nr.__change=()=>Qr(yn),f($n),f(bn);var si=u(bn,2),ni=u(g(si),2),Zs=g(ni),hs=u(g(Zs),2),Zn=We(()=>xf(yn,"histogram"));hs.__click=function(...ln){var Yi;(Yi=n(Zn))==null||Yi.apply(this,ln)};var An=g(hs);f(hs),f(Zs);var xn=u(Zs,2),Xs=u(g(xn),2),Vi=We(()=>xf(yn,"histogram-down"));Xs.__click=function(...ln){var Yi;(Yi=n(Vi))==null||Yi.apply(this,ln)};var as=g(Xs);f(Xs),f(xn),f(ni),f(si);var Ji=u(si,2),Vn=u(g(Ji),2),Ks=g(Vn);Vt(Ks),Ks.__change=()=>Qr(yn),un(2),f(Vn);var vr=u(Vn,2),ys=g(vr),Os=u(g(ys),2),di=We(()=>xf(yn,"ema"));Os.__click=function(...ln){var Yi;(Yi=n(di))==null||Yi.apply(this,ln)};var Mi=g(Os);f(Os),f(ys);var Ln=u(ys,2),wi=u(g(Ln),2);wi.__change=()=>Qr(yn);var fr=g(wi);fr.value=(fr.__value=1)==null?"":1;var jn=u(fr);jn.value=(jn.__value=2)==null?"":2;var Wn=u(jn);Wn.value=(Wn.__value=3)==null?"":3;var hi=u(Wn);hi.value=(hi.__value=4)==null?"":4;var $s=u(hi);$s.value=($s.__value=5)==null?"":5,f(wi),f(Ln);var jo=u(Ln,2),zs=u(g(jo),2);zs.__change=()=>Qr(yn);var Ti=g(zs);Ti.value=(Ti.__value="solid")==null?"":"solid";var Ps=u(Ti);Ps.value=(Ps.__value="dashed")==null?"":"dashed";var ki=u(Ps);ki.value=(ki.__value="dotted")==null?"":"dotted",f(zs),f(jo),f(vr),f(Ji),f(En),we(()=>{St(An,"style",`background-color: ${n(Fs).styles.histogram.upColor??""}`),St(as,"style",`background-color: ${n(Fs).styles.histogram.downColor??""}`),St(Mi,"style",`background-color: ${n(Fs).styles.ema.color??""}`)}),go(nr,()=>n(Fs).period,ln=>n(Fs).period=ln),Bu(Ks,()=>n(Fs).styles.ema.visible,ln=>n(Fs).styles.ema.visible=ln),Bo(wi,()=>n(Fs).styles.ema.thickness,ln=>n(Fs).styles.ema.thickness=ln),Bo(zs,()=>n(Fs).styles.ema.lineStyle,ln=>n(Fs).styles.ema.lineStyle=ln),O(Gi,En)}),f($i),O(Rn,$i)},Rn=>{var $i=Xt(),Gi=_t($i);Se(Gi,()=>n(Ci),Fs=>{var yn=v$(),En=g(yn);Ns(En,17,()=>n(Ws),dn,(Ii,bn,$n)=>{var nr=u$(),si=g(nr),ni=g(si),Zs=g(ni,!0);f(ni);var hs=u(ni,2);Se(hs,()=>n(Ws).length>1,Sa=>{var cc=d$();cc.__click=()=>ga($n),O(Sa,cc)}),f(si);var Zn=u(si,2),An=g(Zn),xn=u(g(An),2);Vt(xn),xn.__input=()=>dp($n),f(An);var Xs=u(An,2),Vi=u(g(Xs),2);Vt(Vi),Vi.__input=()=>dp($n),f(Xs),f(Zn);var as=u(Zn,2),Ji=g(as),Vn=u(g(Ji),2);f(Ji);var Ks=u(Ji,2),vr=g(Ks),ys=u(g(vr),2);Vt(ys),ys.__input=()=>dp($n),f(vr);var Os=u(vr,2),di=u(g(Os),2);di.__change=()=>dp($n);var Mi=g(di);Mi.value=(Mi.__value=1)==null?"":1;var Ln=u(Mi);Ln.value=(Ln.__value=2)==null?"":2;var wi=u(Ln);wi.value=(wi.__value=3)==null?"":3;var fr=u(wi);fr.value=(fr.__value=4)==null?"":4;var jn=u(fr);jn.value=(jn.__value=5)==null?"":5,f(di),f(Os);var Wn=u(Os,2),hi=u(g(Wn),2);hi.__change=()=>dp($n);var $s=g(hi);$s.value=($s.__value="solid")==null?"":"solid";var jo=u($s);jo.value=(jo.__value="dashed")==null?"":"dashed";var zs=u(jo);zs.value=(zs.__value="dotted")==null?"":"dotted",f(hi),f(Wn),f(Ks),f(as);var Ti=u(as,2),Ps=g(Ti),ki=u(g(Ps),2);f(Ps);var ln=u(Ps,2),Yi=g(ln),oa=u(g(Yi),2);Vt(oa),oa.__input=()=>dp($n),f(Yi);var Pr=u(Yi,2),Fr=u(g(Pr),2);Fr.__change=()=>dp($n);var Yr=g(Fr);Yr.value=(Yr.__value=1)==null?"":1;var ka=u(Yr);ka.value=(ka.__value=2)==null?"":2;var va=u(ka);va.value=(va.__value=3)==null?"":3;var ma=u(va);ma.value=(ma.__value=4)==null?"":4;var la=u(ma);la.value=(la.__value=5)==null?"":5,f(Fr),f(Pr);var ra=u(Pr,2),Qi=u(g(ra),2);Qi.__change=()=>dp($n);var $a=g(Qi);$a.value=($a.__value="solid")==null?"":"solid";var Al=u($a);Al.value=(Al.__value="dashed")==null?"":"dashed";var Ql=u(Al);Ql.value=(Ql.__value="dotted")==null?"":"dotted",f(Qi),f(ra),f(ln),f(Ti),f(nr),we(()=>{Ye(Zs,n(bn).name),St(Vn,"style",`background-color: ${n(bn).styles.trix.color??""}`),St(ki,"style",`background-color: ${n(bn).styles.signal.color??""}`)}),go(xn,()=>n(bn).trixPeriod,Sa=>n(bn).trixPeriod=Sa),go(Vi,()=>n(bn).signalPeriod,Sa=>n(bn).signalPeriod=Sa),go(ys,()=>n(bn).styles.trix.color,Sa=>n(bn).styles.trix.color=Sa),Bo(di,()=>n(bn).styles.trix.thickness,Sa=>n(bn).styles.trix.thickness=Sa),Bo(hi,()=>n(bn).styles.trix.lineStyle,Sa=>n(bn).styles.trix.lineStyle=Sa),go(oa,()=>n(bn).styles.signal.color,Sa=>n(bn).styles.signal.color=Sa),Bo(Fr,()=>n(bn).styles.signal.thickness,Sa=>n(bn).styles.signal.thickness=Sa),Bo(Qi,()=>n(bn).styles.signal.lineStyle,Sa=>n(bn).styles.signal.lineStyle=Sa),O(Ii,nr)});var On=u(En,2),Kn=g(On);Kn.__click=[p$,wl],f(On),f(yn),O(Fs,yn)},Fs=>{var yn=Xt(),En=_t(yn);Se(En,()=>n(Ki),On=>{var Kn=h$(),Ii=g(Kn);Ns(Ii,17,()=>n(Ot),dn,(nr,si,ni)=>{var Zs=m$(),hs=g(Zs),Zn=g(hs);Zn.textContent=`BIAS ${ni+1}`;var An=u(Zn,2);Se(An,()=>n(Ot).length>1,$s=>{var jo=g$();jo.__click=[f$,rp,si],O($s,jo)}),f(hs);var xn=u(hs,2),Xs=u(g(xn),2);Vt(Xs),Xs.__input=fc,f(xn);var Vi=u(xn,2),as=g(Vi),Ji=u(g(as),2),Vn=We(()=>lp(ni));Ji.__click=function(...$s){var jo;(jo=n(Vn))==null||jo.apply(this,$s)};var Ks=g(Ji);f(Ji),f(as);var vr=u(as,2),ys=u(g(vr),2);ys.__change=fc;var Os=g(ys);Os.value=(Os.__value=1)==null?"":1;var di=u(Os);di.value=(di.__value=2)==null?"":2;var Mi=u(di);Mi.value=(Mi.__value=3)==null?"":3;var Ln=u(Mi);Ln.value=(Ln.__value=4)==null?"":4,f(ys),f(vr);var wi=u(vr,2),fr=u(g(wi),2);fr.__change=fc;var jn=g(fr);jn.value=(jn.__value="solid")==null?"":"solid";var Wn=u(jn);Wn.value=(Wn.__value="dashed")==null?"":"dashed";var hi=u(Wn);hi.value=(hi.__value="dotted")==null?"":"dotted",f(fr),f(wi),f(Vi),f(Zs),we(()=>St(Ks,"style",`background-color: ${n(si).color??""}`)),go(Xs,()=>n(si).period,$s=>n(si).period=$s),Bo(ys,()=>n(si).thickness,$s=>n(si).thickness=$s),Bo(fr,()=>n(si).lineStyle,$s=>n(si).lineStyle=$s),O(nr,Zs)});var bn=u(Ii,2),$n=g(bn);$n.__click=[$D,Ki,Ot,fc],f(bn),f(Kn),O(On,Kn)},On=>{var Kn=Xt(),Ii=_t(Kn);Se(Ii,()=>n(Cl),bn=>{var $n=x$(),nr=g($n);Ns(nr,17,()=>n(Pi),dn,(Zs,hs,Zn)=>{var An=b$(),xn=g(An),Xs=g(xn);Xs.textContent=`CCI ${Zn+1}`;var Vi=u(Xs,2);Se(Vi,()=>n(Pi).length>1,Ti=>{var Ps=y$();Ps.__click=[_$,tt,hs],O(Ti,Ps)}),f(xn);var as=u(xn,2),Ji=u(g(as),2);Vt(Ji),Ji.__input=ud,f(as);var Vn=u(as,2),Ks=g(Vn),vr=u(g(Ks),2),ys=We(()=>Fv(Zn));vr.__click=function(...Ti){var Ps;(Ps=n(ys))==null||Ps.apply(this,Ti)};var Os=g(vr);f(vr),f(Ks);var di=u(Ks,2),Mi=u(g(di),2);Mi.__change=ud;var Ln=g(Mi);Ln.value=(Ln.__value=1)==null?"":1;var wi=u(Ln);wi.value=(wi.__value=2)==null?"":2;var fr=u(wi);fr.value=(fr.__value=3)==null?"":3;var jn=u(fr);jn.value=(jn.__value=4)==null?"":4,f(Mi),f(di);var Wn=u(di,2),hi=u(g(Wn),2);hi.__change=ud;var $s=g(hi);$s.value=($s.__value="solid")==null?"":"solid";var jo=u($s);jo.value=(jo.__value="dashed")==null?"":"dashed";var zs=u(jo);zs.value=(zs.__value="dotted")==null?"":"dotted",f(hi),f(Wn),f(Vn),f(An),we(()=>St(Os,"style",`background-color: ${n(hs).color??""}`)),go(Ji,()=>n(hs).period,Ti=>n(hs).period=Ti),Bo(Mi,()=>n(hs).thickness,Ti=>n(hs).thickness=Ti),Bo(hi,()=>n(hs).lineStyle,Ti=>n(hs).lineStyle=Ti),O(Zs,An)});var si=u(nr,2),ni=g(si);ni.__click=[jD,Cl,Pi,ud],f(si),f($n),O(bn,$n)},bn=>{var $n=Xt(),nr=_t($n);Se(nr,()=>n(Ts),si=>{var ni=C$(),Zs=g(ni),hs=u(g(Zs),2);Ns(hs,21,()=>n(Bl),dn,(xn,Xs,Vi)=>{var as=S$(),Ji=g(as),Vn=g(Ji),Ks=g(Vn,!0);f(Vn);var vr=u(Vn,2);Se(vr,()=>n(Bl).length>1,Os=>{var di=w$();di.__click=()=>Cp(Vi),O(Os,di)}),f(Ji);var ys=u(Ji,4);Ns(ys,17,()=>_,dn,(Os,di,Mi)=>{var Ln=k$(),wi=g(Ln),fr=g(wi),jn=u(fr,2),Wn=g(jn,!0);f(jn),f(wi);var hi=u(wi,2),$s=u(g(hi),2);Vt($s),$s.__change=()=>Tu(),f(hi);var jo=u(hi,2),zs=u(g(jo),2),Ti=We(()=>Ev(Mi,Vi));zs.__click=function(...Qi){var $a;($a=n(Ti))==null||$a.apply(this,Qi)};var Ps=g(zs);f(zs),f(jo);var ki=u(jo,2),ln=u(g(ki),2);ln.__change=()=>Tu();var Yi=g(ln);Yi.value=(Yi.__value=1)==null?"":1;var oa=u(Yi);oa.value=(oa.__value=2)==null?"":2;var Pr=u(oa);Pr.value=(Pr.__value=3)==null?"":3;var Fr=u(Pr);Fr.value=(Fr.__value=4)==null?"":4;var Yr=u(Fr);Yr.value=(Yr.__value=5)==null?"":5,f(ln),f(ki);var ka=u(ki,2),va=u(g(ka),2);va.__change=()=>Tu();var ma=g(va);ma.value=(ma.__value="solid")==null?"":"solid";var la=u(ma);la.value=(la.__value="dashed")==null?"":"dashed";var ra=u(la);ra.value=(ra.__value="dotted")==null?"":"dotted",f(va),f(ka),f(Ln),we(()=>{var Qi,$a;St(fr,"style",`background-color: ${((Qi=n(Xs).styles[Mi])==null?void 0:Qi.color)??""}`),Ye(Wn,n(di).title),St(Ps,"style",`background-color: ${(($a=n(Xs).styles[Mi])==null?void 0:$a.color)??""}`)}),go($s,()=>n(Xs).params[Mi],Qi=>n(Xs).params[Mi]=Qi),Bo(ln,()=>n(Xs).styles[Mi].thickness,Qi=>n(Xs).styles[Mi].thickness=Qi),Bo(va,()=>n(Xs).styles[Mi].lineStyle,Qi=>n(Xs).styles[Mi].lineStyle=Qi),O(Os,Ln)}),f(as),we(()=>Ye(Ks,n(Xs).name)),O(xn,as)}),f(hs);var Zn=u(hs,2),An=g(Zn);An.__click=Jp,f(Zn),un(2),f(Zs),f(ni),O(si,ni)},si=>{var ni=Xt(),Zs=_t(ni);Se(Zs,()=>n(us),hs=>{var Zn=A$(),An=g(Zn);Ns(An,17,()=>_,dn,(Xs,Vi,as)=>{var Ji=M$(),Vn=g(Ji),Ks=g(Vn),vr=g(Ks,!0);f(Ks);var ys=u(Ks,2),Os=g(ys);Vt(Os);var di=u(Os,2);Se(di,()=>p.length>1,Fr=>{var Yr=P$();Yr.__click=()=>$v(as),O(Fr,Yr)},Fr=>{var Yr=I$();O(Fr,Yr)}),f(ys),f(Vn);var Mi=u(Vn,2),Ln=g(Mi),wi=u(g(Ln),2),fr=We(()=>W0(as));wi.__click=function(...Fr){var Yr;(Yr=n(fr))==null||Yr.apply(this,Fr)};var jn=g(wi);f(wi),f(Ln);var Wn=u(Ln,2),hi=u(g(Wn),2),$s=g(hi);$s.value=($s.__value=1)==null?"":1;var jo=u($s);jo.value=(jo.__value=2)==null?"":2;var zs=u(jo);zs.value=(zs.__value=3)==null?"":3;var Ti=u(zs);Ti.value=(Ti.__value=4)==null?"":4;var Ps=u(Ti);Ps.value=(Ps.__value=5)==null?"":5,f(hi),f(Wn);var ki=u(Wn,2),ln=u(g(ki),2),Yi=g(ln);Yi.value=(Yi.__value="solid")==null?"":"solid";var oa=u(Yi);oa.value=(oa.__value="dashed")==null?"":"dashed";var Pr=u(oa);Pr.value=(Pr.__value="dotted")==null?"":"dotted",f(ln),f(ki),f(Mi),f(Ji),we(()=>{Ye(vr,n(Vi).title),St(jn,"style",`background-color: ${y[as].color??""}`)}),go(Os,()=>p[as],Fr=>p[as]=Fr),Bo(hi,()=>y[as].thickness,Fr=>y[as].thickness=Fr),Bo(ln,()=>y[as].lineStyle,Fr=>y[as].lineStyle=Fr),O(Xs,Ji)});var xn=u(An,2);Se(xn,()=>_.length<10,Xs=>{var Vi=T$(),as=g(Vi);as.__click=[xm,Dr,Ki,jv,Ge,fv,at,gv,Ci,zv,_,p,y,fn,xa,Io,Hs],f(Vi),O(Xs,Vi)}),f(Zn),O(hs,Zn)},hs=>{var Zn=Xt(),An=_t(Zn);Se(An,()=>n(fn),xn=>{var Xs=N$(),Vi=g(Xs);Ns(Vi,17,()=>_,dn,(Ji,Vn,Ks)=>{var vr=z$(),ys=g(vr),Os=g(ys),di=g(Os,!0);f(Os);var Mi=u(Os,2),Ln=g(Mi);Vt(Ln),Ln.__change=[L$,xa];var wi=u(Ln,2);Se(wi,()=>p.length>1,jn=>{var Wn=F$();Wn.__click=()=>$v(Ks),O(jn,Wn)},jn=>{var Wn=D$();O(jn,Wn)}),f(Mi),f(ys);var fr=u(ys,2);Se(fr,()=>y[Ks],jn=>{var Wn=j$(),hi=g(Wn),$s=u(g(hi),2),jo=We(()=>q0(Ks));$s.__click=function(...la){var ra;(ra=n(jo))==null||ra.apply(this,la)};var zs=g($s);f($s),f(hi);var Ti=u(hi,2),Ps=u(g(Ti),2);Ps.__change=[E$,xa];var ki=g(Ps);ki.value=(ki.__value=1)==null?"":1;var ln=u(ki);ln.value=(ln.__value=2)==null?"":2;var Yi=u(ln);Yi.value=(Yi.__value=3)==null?"":3;var oa=u(Yi);oa.value=(oa.__value=4)==null?"":4;var Pr=u(oa);Pr.value=(Pr.__value=5)==null?"":5,f(Ps),f(Ti);var Fr=u(Ti,2),Yr=u(g(Fr),2);Yr.__change=[$$,xa];var ka=g(Yr);ka.value=(ka.__value="solid")==null?"":"solid";var va=u(ka);va.value=(va.__value="dashed")==null?"":"dashed";var ma=u(va);ma.value=(ma.__value="dotted")==null?"":"dotted",f(Yr),f(Fr),f(Wn),we(()=>St(zs,"style",`background-color: ${y[Ks].color??""}`)),Bo(Ps,()=>y[Ks].thickness,la=>y[Ks].thickness=la),Bo(Yr,()=>y[Ks].lineStyle,la=>y[Ks].lineStyle=la),O(jn,Wn)}),f(vr),we(()=>Ye(di,n(Vn).title)),go(Ln,()=>p[Ks],jn=>p[Ks]=jn),O(Ji,vr)});var as=u(Vi,2);Se(as,()=>_.length<10,Ji=>{var Vn=B$(),Ks=g(Vn);Ks.__click=[xm,Dr,Ki,jv,Ge,fv,at,gv,Ci,zv,_,p,y,fn,xa,Io,Hs],f(Vn),O(Ji,Vn)}),f(Xs),O(xn,Xs)},xn=>{var Xs=Xt(),Vi=_t(Xs);Se(Vi,()=>n(zr),as=>{var Ji=W$(),Vn=g(Ji);Ns(Vn,17,()=>n(an),dn,(ys,Os,di)=>{var Mi=V$(),Ln=g(Mi),wi=g(Ln);wi.textContent=`ROC ${di+1}`;var fr=u(wi,2);Se(fr,()=>n(an).length>1,Qi=>{var $a=O$();$a.__click=[R$,mi,Os],O(Qi,$a)}),f(Ln);var jn=u(Ln,2),Wn=g(jn),hi=u(g(Wn),2);Vt(hi),hi.__change=()=>ql(di),f(Wn);var $s=u(Wn,2),jo=g($s),zs=u(g(jo),2),Ti=We(()=>ah(di));zs.__click=function(...Qi){var $a;($a=n(Ti))==null||$a.apply(this,Qi)};var Ps=g(zs);f(zs),f(jo);var ki=u(jo,2),ln=u(g(ki),2);ln.__change=()=>ql(di);var Yi=g(ln);Yi.value=(Yi.__value=1)==null?"":1;var oa=u(Yi);oa.value=(oa.__value=2)==null?"":2;var Pr=u(oa);Pr.value=(Pr.__value=3)==null?"":3;var Fr=u(Pr);Fr.value=(Fr.__value=4)==null?"":4;var Yr=u(Fr);Yr.value=(Yr.__value=5)==null?"":5,f(ln),f(ki);var ka=u(ki,2),va=u(g(ka),2);va.__change=()=>ql(di);var ma=g(va);ma.value=(ma.__value="solid")==null?"":"solid";var la=u(ma);la.value=(la.__value="dashed")==null?"":"dashed";var ra=u(la);ra.value=(ra.__value="dotted")==null?"":"dotted",f(va),f(ka),f($s),f(jn),f(Mi),we(()=>St(Ps,"style",`background-color: ${n(Os).styles.roc.color??""}`)),go(hi,()=>n(Os).period,Qi=>n(Os).period=Qi),Bo(ln,()=>n(Os).styles.roc.thickness,Qi=>n(Os).styles.roc.thickness=Qi),Bo(va,()=>n(Os).styles.roc.lineStyle,Qi=>n(Os).styles.roc.lineStyle=Qi),O(ys,Mi)});var Ks=u(Vn,2),vr=g(Ks);vr.__click=qr,f(Ks),f(Ji),O(as,Ji)},as=>{var Ji=Xt(),Vn=_t(Ji);Se(Vn,()=>n(hl),Ks=>{var vr=Y$(),ys=g(vr);Ns(ys,17,()=>n(As),dn,(Mi,Ln,wi)=>{var fr=G$(),jn=g(fr),Wn=g(jn);Wn.textContent=`PSY ${wi+1}`;var hi=u(Wn,2);Se(hi,()=>n(As).length>1,Ur=>{var pc=H$();pc.__click=[q$,Fd,Ln],O(Ur,pc)}),f(jn);var $s=u(jn,2),jo=g($s),zs=u(g(jo),2);Vt(zs),zs.__change=()=>jl(wi),f(jo);var Ti=u(jo,2),Ps=u(g(Ti),2),ki=g(Ps),ln=u(g(ki),2),Yi=We(()=>vv(wi*2));ln.__click=function(...Ur){var pc;(pc=n(Yi))==null||pc.apply(this,Ur)};var oa=g(ln);f(ln),f(ki);var Pr=u(ki,2),Fr=u(g(Pr),2);Fr.__change=()=>jl(wi);var Yr=g(Fr);Yr.value=(Yr.__value=1)==null?"":1;var ka=u(Yr);ka.value=(ka.__value=2)==null?"":2;var va=u(ka);va.value=(va.__value=3)==null?"":3;var ma=u(va);ma.value=(ma.__value=4)==null?"":4;var la=u(ma);la.value=(la.__value=5)==null?"":5,f(Fr),f(Pr);var ra=u(Pr,2),Qi=u(g(ra),2);Qi.__change=()=>jl(wi);var $a=g(Qi);$a.value=($a.__value="solid")==null?"":"solid";var Al=u($a);Al.value=(Al.__value="dashed")==null?"":"dashed";var Ql=u(Al);Ql.value=(Ql.__value="dotted")==null?"":"dotted",f(Qi),f(ra),f(Ps),f(Ti);var Sa=u(Ti,2),cc=u(g(Sa),2);Vt(cc),cc.__change=()=>jl(wi),f(Sa);var dc=u(Sa,2),Ya=u(g(dc),2),Si=g(Ya),kc=u(g(Si),2),Ua=We(()=>vv(wi*2+1));kc.__click=function(...Ur){var pc;(pc=n(Ua))==null||pc.apply(this,Ur)};var Tc=g(kc);f(kc),f(Si);var uc=u(Si,2),Er=u(g(uc),2);Er.__change=()=>jl(wi);var Ac=g(Er);Ac.value=(Ac.__value=1)==null?"":1;var Gl=u(Ac);Gl.value=(Gl.__value=2)==null?"":2;var Nl=u(Gl);Nl.value=(Nl.__value=3)==null?"":3;var nl=u(Nl);nl.value=(nl.__value=4)==null?"":4;var Ll=u(nl);Ll.value=(Ll.__value=5)==null?"":5,f(Er),f(uc);var Lc=u(uc,2),Ai=u(g(Lc),2);Ai.__change=()=>jl(wi);var Ta=g(Ai);Ta.value=(Ta.__value="solid")==null?"":"solid";var od=u(Ta);od.value=(od.__value="dashed")==null?"":"dashed";var sd=u(od);sd.value=(sd.__value="dotted")==null?"":"dotted",f(Ai),f(Lc),f(Ya),f(dc);var kd=u(dc,2),Bc=g(kd);Vt(Bc),Bc.__change=()=>jl(wi);var Dd=u(Bc,2);f(kd),f($s),f(fr),we(()=>{St(oa,"style",`background-color: ${n(Ln).styles.psy.color??""}`),St(Tc,"style",`background-color: ${n(Ln).styles.mapsy.color??""}`),St(Bc,"id",`showMapsy_${n(Ln).id??""}`),St(Dd,"for",`showMapsy_${n(Ln).id??""}`)}),go(zs,()=>n(Ln).psyPeriod,Ur=>n(Ln).psyPeriod=Ur),Bo(Fr,()=>n(Ln).styles.psy.thickness,Ur=>n(Ln).styles.psy.thickness=Ur),Bo(Qi,()=>n(Ln).styles.psy.lineStyle,Ur=>n(Ln).styles.psy.lineStyle=Ur),go(cc,()=>n(Ln).mapsyPeriod,Ur=>n(Ln).mapsyPeriod=Ur),Bo(Er,()=>n(Ln).styles.mapsy.thickness,Ur=>n(Ln).styles.mapsy.thickness=Ur),Bo(Ai,()=>n(Ln).styles.mapsy.lineStyle,Ur=>n(Ln).styles.mapsy.lineStyle=Ur),Bu(Bc,()=>n(Ln).showMapsy,Ur=>n(Ln).showMapsy=Ur),O(Mi,fr)});var Os=u(ys,2),di=g(Os);di.__click=pd,f(Os),f(vr),O(Ks,vr)},Ks=>{var vr=Xt(),ys=_t(vr);Se(ys,()=>n(fa),Os=>{var di=X$(),Mi=g(di);Ns(Mi,17,()=>n(qs),dn,(fr,jn,Wn)=>{var hi=Z$(),$s=g(hi),jo=g($s);jo.textContent=`OBV ${Wn+1}`;var zs=u(jo,2);Se(zs,()=>n(qs).length>1,Ur=>{var pc=K$();pc.__click=[U$,Pc,jn],O(Ur,pc)}),f($s);var Ti=u($s,2),Ps=g(Ti),ki=u(g(Ps),2);Vt(ki),ki.__input=zl,f(Ps);var ln=u(Ps,2),Yi=u(g(ln),2),oa=g(Yi),Pr=u(g(oa),2),Fr=We(()=>Dv(Wn*2));Pr.__click=function(...Ur){var pc;(pc=n(Fr))==null||pc.apply(this,Ur)};var Yr=g(Pr);f(Pr),f(oa);var ka=u(oa,2),va=u(g(ka),2);va.__change=zl;var ma=g(va);ma.value=(ma.__value=1)==null?"":1;var la=u(ma);la.value=(la.__value=2)==null?"":2;var ra=u(la);ra.value=(ra.__value=3)==null?"":3;var Qi=u(ra);Qi.value=(Qi.__value=4)==null?"":4;var $a=u(Qi);$a.value=($a.__value=5)==null?"":5,f(va),f(ka);var Al=u(ka,2),Ql=u(g(Al),2);Ql.__change=zl;var Sa=g(Ql);Sa.value=(Sa.__value="solid")==null?"":"solid";var cc=u(Sa);cc.value=(cc.__value="dashed")==null?"":"dashed";var dc=u(cc);dc.value=(dc.__value="dotted")==null?"":"dotted",f(Ql),f(Al),f(Yi),f(ln);var Ya=u(ln,2),Si=u(g(Ya),2);Vt(Si),Si.__input=zl,un(2),f(Ya);var kc=u(Ya,2),Ua=u(g(kc),2),Tc=g(Ua),uc=u(g(Tc),2),Er=We(()=>Dv(Wn*2+1));uc.__click=function(...Ur){var pc;(pc=n(Er))==null||pc.apply(this,Ur)};var Ac=g(uc);f(uc),f(Tc);var Gl=u(Tc,2),Nl=u(g(Gl),2);Nl.__change=zl;var nl=g(Nl);nl.value=(nl.__value=1)==null?"":1;var Ll=u(nl);Ll.value=(Ll.__value=2)==null?"":2;var Lc=u(Ll);Lc.value=(Lc.__value=3)==null?"":3;var Ai=u(Lc);Ai.value=(Ai.__value=4)==null?"":4;var Ta=u(Ai);Ta.value=(Ta.__value=5)==null?"":5,f(Nl),f(Gl);var od=u(Gl,2),sd=u(g(od),2);sd.__change=zl;var kd=g(sd);kd.value=(kd.__value="solid")==null?"":"solid";var Bc=u(kd);Bc.value=(Bc.__value="dashed")==null?"":"dashed";var Dd=u(Bc);Dd.value=(Dd.__value="dotted")==null?"":"dotted",f(sd),f(od),f(Ua),f(kc),f(Ti),f(hi),we(()=>{St(Yr,"style",`background-color: ${n(jn).styles.obv.color??""}`),St(Ac,"style",`background-color: ${n(jn).styles.maobv.color??""}`)}),go(ki,()=>n(jn).obvPeriod,Ur=>n(jn).obvPeriod=Ur),Bo(va,()=>n(jn).styles.obv.thickness,Ur=>n(jn).styles.obv.thickness=Ur),Bo(Ql,()=>n(jn).styles.obv.lineStyle,Ur=>n(jn).styles.obv.lineStyle=Ur),go(Si,()=>n(jn).maobvPeriod,Ur=>n(jn).maobvPeriod=Ur),Bo(Nl,()=>n(jn).styles.maobv.thickness,Ur=>n(jn).styles.maobv.thickness=Ur),Bo(sd,()=>n(jn).styles.maobv.lineStyle,Ur=>n(jn).styles.maobv.lineStyle=Ur),O(fr,hi)});var Ln=u(Mi,2),wi=g(Ln);wi.__click=Vc,f(Ln),f(di),O(Os,di)},Os=>{var di=Xt(),Mi=_t(di);Se(Mi,()=>n(sc),Ln=>{var wi=tj(),fr=g(wi);Ns(fr,17,()=>n(Jn),dn,(hi,$s,jo)=>{var zs=ej(),Ti=g(zs),Ps=g(Ti);Ps.textContent=`KDJ ${jo+1}`;var ki=u(Ps,2);Se(ki,()=>n(Jn).length>1,dl=>{var Aa=Q$();Aa.__click=[J$,Jd,$s],O(dl,Aa)}),f(Ti);var ln=u(Ti,2),Yi=g(ln),oa=g(Yi),Pr=u(g(oa),2);Vt(Pr),Pr.__input=dl=>{dl.target&&(console.log("📊 K Period changed to:",dl.target.value,"for group:",jo),ac(jo))},f(oa);var Fr=u(oa,2),Yr=u(g(Fr),2);Vt(Yr),Yr.__input=dl=>{dl.target&&(console.log("📊 D Period changed to:",dl.target.value,"for group:",jo),ac(jo))},f(Fr),f(Yi);var ka=u(Yi,2),va=u(g(ka),2),ma=u(g(va),2),la=We(()=>bf(jo,0));ma.__click=function(...dl){var Aa;(Aa=n(la))==null||Aa.apply(this,dl)};var ra=g(ma);f(ma);var Qi=u(ma,2);Qi.__change=()=>ac(jo);var $a=g(Qi);$a.value=($a.__value=1)==null?"":1;var Al=u($a);Al.value=(Al.__value=2)==null?"":2;var Ql=u(Al);Ql.value=(Ql.__value=3)==null?"":3;var Sa=u(Ql);Sa.value=(Sa.__value=4)==null?"":4;var cc=u(Sa);cc.value=(cc.__value=5)==null?"":5,f(Qi);var dc=u(Qi,2);dc.__change=()=>ac(jo);var Ya=g(dc);Ya.value=(Ya.__value="solid")==null?"":"solid";var Si=u(Ya);Si.value=(Si.__value="dashed")==null?"":"dashed";var kc=u(Si);kc.value=(kc.__value="dotted")==null?"":"dotted",f(dc),f(va),f(ka);var Ua=u(ka,2),Tc=u(g(Ua),2),uc=u(g(Tc),2),Er=We(()=>bf(jo,1));uc.__click=function(...dl){var Aa;(Aa=n(Er))==null||Aa.apply(this,dl)};var Ac=g(uc);f(uc);var Gl=u(uc,2);Gl.__change=()=>ac(jo);var Nl=g(Gl);Nl.value=(Nl.__value=1)==null?"":1;var nl=u(Nl);nl.value=(nl.__value=2)==null?"":2;var Ll=u(nl);Ll.value=(Ll.__value=3)==null?"":3;var Lc=u(Ll);Lc.value=(Lc.__value=4)==null?"":4;var Ai=u(Lc);Ai.value=(Ai.__value=5)==null?"":5,f(Gl);var Ta=u(Gl,2);Ta.__change=()=>ac(jo);var od=g(Ta);od.value=(od.__value="solid")==null?"":"solid";var sd=u(od);sd.value=(sd.__value="dashed")==null?"":"dashed";var kd=u(sd);kd.value=(kd.__value="dotted")==null?"":"dotted",f(Ta),f(Tc),f(Ua);var Bc=u(Ua,2),Dd=u(g(Bc),2),Ur=u(g(Dd),2),pc=We(()=>bf(jo,2));Ur.__click=function(...dl){var Aa;(Aa=n(pc))==null||Aa.apply(this,dl)};var up=g(Ur);f(Ur);var Ed=u(Ur,2);Ed.__change=()=>ac(jo);var hu=g(Ed);hu.value=(hu.__value=1)==null?"":1;var Du=u(hu);Du.value=(Du.__value=2)==null?"":2;var _u=u(Du);_u.value=(_u.__value=3)==null?"":3;var yu=u(_u);yu.value=(yu.__value=4)==null?"":4;var pp=u(yu);pp.value=(pp.__value=5)==null?"":5,f(Ed);var ec=u(Ed,2);ec.__change=()=>ac(jo);var cl=g(ec);cl.value=(cl.__value="solid")==null?"":"solid";var eu=u(cl);eu.value=(eu.__value="dashed")==null?"":"dashed";var Ap=u(eu);Ap.value=(Ap.__value="dotted")==null?"":"dotted",f(ec),f(Dd),f(Bc),f(ln),f(zs),we(()=>{St(ra,"style",`background-color: ${n($s).styles.k.color??""}`),St(Ac,"style",`background-color: ${n($s).styles.d.color??""}`),St(up,"style",`background-color: ${n($s).styles.j.color??""}`)}),go(Pr,()=>n($s).kPeriod,dl=>n($s).kPeriod=dl),go(Yr,()=>n($s).dPeriod,dl=>n($s).dPeriod=dl),Bo(Qi,()=>n($s).styles.k.thickness,dl=>n($s).styles.k.thickness=dl),Bo(dc,()=>n($s).styles.k.lineStyle,dl=>n($s).styles.k.lineStyle=dl),Bo(Gl,()=>n($s).styles.d.thickness,dl=>n($s).styles.d.thickness=dl),Bo(Ta,()=>n($s).styles.d.lineStyle,dl=>n($s).styles.d.lineStyle=dl),Bo(Ed,()=>n($s).styles.j.thickness,dl=>n($s).styles.j.thickness=dl),Bo(ec,()=>n($s).styles.j.lineStyle,dl=>n($s).styles.j.lineStyle=dl),O(hi,zs)});var jn=u(fr,2),Wn=g(jn);Wn.__click=gl,f(jn),f(wi),O(Ln,wi)},Ln=>{var wi=Xt(),fr=_t(wi);Se(fr,()=>n(oc),jn=>{var Wn=rj(),hi=g(Wn),$s=u(g(hi),2),jo=g($s),zs=u(g(jo),2);Vt(zs),zs.__change=[AD,Qo,Me],f(jo);var Ti=u(jo,2),Ps=u(g(Ti),2);Ps.__click=[oj,oo];var ki=g(Ps);const ln=We(()=>`background-color: ${k(n(ai),n(qi))}`);f(Ps),f(Ti),f($s);var Yi=u($s,2),oa=g(Yi),Pr=u(g(oa),2),Fr=g(Pr);f(Pr),f(oa);var Yr=u(oa,2);Vt(Yr),Yr.__change=Yt,f(Yi),f(hi);var ka=u(hi,2),va=u(g(ka),2),ma=u(g(va),2);Vt(ma),ma.__change=[LD,Qo,Xe],f(va);var la=u(va,2),ra=g(la),Qi=u(g(ra),2);Qi.__click=[sj,oo];var $a=g(Qi);f(Qi),f(ra);var Al=u(ra,2),Ql=u(g(Al),2);Ql.__click=[nj,oo];var Sa=g(Ql);f(Ql),f(Al),f(la);var cc=u(la,2),dc=g(cc),Ya=u(g(dc),2);Ya.__change=[Ry,Qo,tr,lr];var Si=g(Ya);Si.value=(Si.__value=1)==null?"":1;var kc=u(Si);kc.value=(kc.__value=2)==null?"":2;var Ua=u(kc);Ua.value=(Ua.__value=3)==null?"":3;var Tc=u(Ua);Tc.value=(Tc.__value=4)==null?"":4;var uc=u(Tc);uc.value=(uc.__value=5)==null?"":5,f(Ya),f(dc);var Er=u(dc,2),Ac=u(g(Er),2);Ac.__change=[Ry,Qo,tr,lr];var Gl=g(Ac);Gl.value=(Gl.__value="solid")==null?"":"solid";var Nl=u(Gl);Nl.value=(Nl.__value="dashed")==null?"":"dashed",f(Ac),f(Er);var nl=u(Er,2),Ll=u(g(nl),2);Ll.__change=[Oy,Qo,Ui,_a];var Lc=g(Ll);Lc.value=(Lc.__value=1)==null?"":1;var Ai=u(Lc);Ai.value=(Ai.__value=2)==null?"":2;var Ta=u(Ai);Ta.value=(Ta.__value=3)==null?"":3;var od=u(Ta);od.value=(od.__value=4)==null?"":4;var sd=u(od);sd.value=(sd.__value=5)==null?"":5,f(Ll),f(nl);var kd=u(nl,2),Bc=u(g(kd),2);Bc.__change=[Oy,Qo,Ui,_a];var Dd=g(Bc);Dd.value=(Dd.__value="solid")==null?"":"solid";var Ur=u(Dd);Ur.value=(Ur.__value="dashed")==null?"":"dashed",f(Bc),f(kd),f(cc),f(ka);var pc=u(ka,2),up=u(g(pc),2),Ed=g(up),hu=u(g(Ed),2);hu.__click=[ij,oo];var Du=g(hu);f(hu),f(Ed);var _u=u(Ed,2),yu=u(g(_u),2);yu.__change=[Ny,Qo,Vs,Bn];var pp=g(yu);pp.value=(pp.__value=1)==null?"":1;var ec=u(pp);ec.value=(ec.__value=2)==null?"":2;var cl=u(ec);cl.value=(cl.__value=3)==null?"":3;var eu=u(cl);eu.value=(eu.__value=4)==null?"":4;var Ap=u(eu);Ap.value=(Ap.__value=5)==null?"":5,f(yu),f(_u);var dl=u(_u,2),Aa=u(g(dl),2);Aa.__change=[Ny,Qo,Vs,Bn];var yv=g(Aa);yv.value=(yv.__value="solid")==null?"":"solid";var nv=u(yv);nv.value=(nv.__value="dashed")==null?"":"dashed",f(Aa),f(dl),f(up),f(pc);var Eu=u(pc,2),Lp=u(g(Eu),2),Fp=u(g(Lp),2);Vt(Fp),Fp.__change=[FD,Qo,X],f(Lp),f(Eu),f(Wn),we(()=>{St(ki,"style",n(ln)),Ye(Fr,`${n(qi)??""}%`),St($a,"style",`background-color: ${n(Dn)}`),St(Sa,"style",`background-color: ${n(kr)}`),St(Du,"style",`background-color: ${n(cr)}`)}),Bu(zs,()=>n(Me),Nc=>b(Me,Nc)),go(Yr,()=>n(qi),Nc=>b(qi,Nc)),Bu(ma,()=>n(Xe),Nc=>b(Xe,Nc)),Bo(Ya,()=>n(tr),Nc=>b(tr,Nc)),Bo(Ac,()=>n(lr),Nc=>b(lr,Nc)),Bo(Ll,()=>n(Ui),Nc=>b(Ui,Nc)),Bo(Bc,()=>n(_a),Nc=>b(_a,Nc)),Bo(yu,()=>n(Vs),Nc=>b(Vs,Nc)),Bo(Aa,()=>n(Bn),Nc=>b(Bn,Nc)),Bu(Fp,()=>n(X),Nc=>b(X,Nc)),O(jn,Wn)},jn=>{var Wn=Xt(),hi=_t(Wn);Se(hi,()=>n(Dr),$s=>{var jo=yj(),zs=g(jo),Ti=u(g(zs),2),Ps=g(Ti),ki=u(g(Ps),2);Vt(ki),f(Ps);var ln=u(Ps,2),Yi=u(g(ln),2);Vt(Yi),f(ln),f(Ti),f(zs);var oa=u(zs,2),Pr=u(g(oa),2),Fr=u(g(Pr),2),Yr=g(Fr),ka=u(Yr,2);ka.__click=[aj,Ro];var va=g(ka);f(ka),f(Fr),f(Pr);var ma=u(Pr,2),la=g(ma),ra=u(g(la),2),Qi=g(ra);f(ra),f(la);var $a=u(la,2);Vt($a),un(2),f(ma),f(oa);var Al=u(oa,2),Ql=u(g(Al),2),Sa=g(Ql),cc=u(g(Sa),2),dc=g(cc),Ya=u(dc,2);Ya.__click=[lj,Ro];var Si=g(Ya);f(Ya),f(cc),f(Sa);var kc=u(Sa,2),Ua=u(g(kc),2),Tc=g(Ua),uc=u(Tc,2);uc.__click=[cj,Ro];var Er=g(uc);f(uc),f(Ua),f(kc);var Ac=u(kc,2),Gl=u(g(Ac),2),Nl=g(Gl),nl=u(Nl,2);nl.__click=[dj,Ro];var Ll=g(nl);f(nl),f(Gl),f(Ac),f(Ql),f(Al);var Lc=u(Al,2),Ai=u(g(Lc),2),Ta=g(Ai),od=u(g(Ta),2),sd=g(od);sd.value=(sd.__value=1)==null?"":1;var kd=u(sd);kd.value=(kd.__value=2)==null?"":2;var Bc=u(kd);Bc.value=(Bc.__value=3)==null?"":3;var Dd=u(Bc);Dd.value=(Dd.__value=4)==null?"":4;var Ur=u(Dd);Ur.value=(Ur.__value=5)==null?"":5,f(od),f(Ta);var pc=u(Ta,2),up=u(g(pc),2),Ed=g(up);Ed.value=(Ed.__value="solid")==null?"":"solid";var hu=u(Ed);hu.value=(hu.__value="dashed")==null?"":"dashed";var Du=u(hu);Du.value=(Du.__value="dotted")==null?"":"dotted",f(up),f(pc),f(Ai),f(Lc);var _u=u(Lc,2),yu=g(_u);yu.__click=[WD,Dr,i,l,Vo,R,N,S,L,T,P,A,F,B,To];var pp=u(yu,2);Se(pp,()=>n(Vo).length>1,cl=>{var eu=pj();eu.__click=[uj,vo],O(cl,eu)}),f(_u);var ec=u(_u,2);Se(ec,()=>n(Vo).length>1,cl=>{var eu=Xt(),Ap=_t(eu);Ns(Ap,17,()=>n(Vo).slice(1),dn,(dl,Aa,yv)=>{var nv=_j();const Eu=We(()=>yv+1);var Lp=g(nv),Fp=g(Lp),Nc=g(Fp);f(Fp);var Vg=u(Fp,2);Vg.__click=[vj,vo,Eu],f(Lp);var Yv=u(Lp,2),Uv=g(Yv),Hf=u(g(Uv),2);Vt(Hf),Hf.__change=To,f(Uv);var Wg=u(Uv,2),Gf=u(g(Wg),2);Vt(Gf),Gf.__change=To,f(Wg),f(Yv);var Yf=u(Yv,2),vp=u(g(Yf),2),qg=u(g(vp),2),Hg=g(qg),Uf=u(Hg,2);Uf.__click=[fj,Ro,Eu];var qh=g(Uf);f(Uf),f(qg),f(vp);var Gg=u(vp,2),Kv=g(Gg),Kf=u(g(Kv),2),Hh=g(Kf);f(Kf),f(Kv);var Zf=u(Kv,2);Vt(Zf),Zf.__change=To,f(Gg),f(Yf);var Xf=u(Yf,2),Yg=u(g(Xf),2),Jf=g(Yg),Ug=u(g(Jf),2),Kg=g(Ug),Qf=u(Kg,2);Qf.__click=[gj,Ro,Eu];var Gh=g(Qf);f(Qf),f(Ug),f(Jf);var e0=u(Jf,2),Zg=u(g(e0),2),Xg=g(Zg),t0=u(Xg,2);t0.__click=[mj,Ro,Eu];var Yh=g(t0);f(t0),f(Zg),f(e0);var Jg=u(e0,2),Qg=u(g(Jg),2),em=g(Qg),o0=u(em,2);o0.__click=[hj,Ro,Eu];var Uh=g(o0);f(o0),f(Qg),f(Jg),f(Yg),f(Xf);var tm=u(Xf,2),om=u(g(tm),2),s0=g(om),Zv=u(g(s0),2);Zv.__change=To;var n0=g(Zv);n0.value=(n0.__value=1)==null?"":1;var i0=u(n0);i0.value=(i0.__value=2)==null?"":2;var bv=u(i0);bv.value=(bv.__value=3)==null?"":3;var Xv=u(bv);Xv.value=(Xv.__value=4)==null?"":4;var r0=u(Xv);r0.value=(r0.__value=5)==null?"":5,f(Zv),f(s0);var sm=u(s0,2),Jv=u(g(sm),2);Jv.__change=To;var a0=g(Jv);a0.value=(a0.__value="solid")==null?"":"solid";var xv=u(a0);xv.value=(xv.__value="dashed")==null?"":"dashed";var nm=u(xv);nm.value=(nm.__value="dotted")==null?"":"dotted",f(Jv),f(sm),f(om),f(tm),f(nv),we(()=>{Ye(Nc,`BOLL ${n(Eu)+1}`),St(Vg,"title",`Remove BOLL ${n(Eu)+1}`),St(Hg,"style",`background-color: ${n(Aa).styles.fillColor}; opacity: ${(n(Aa).styles.fillOpacity||0)/100}`),St(qh,"style",`background-color: ${n(Aa).styles.fillColor}; opacity: ${(n(Aa).styles.fillOpacity||0)/100}`),Ye(Hh,`${n(Aa).styles.fillOpacity??""}%`),St(Kg,"style",`background-color: ${n(Aa).styles.upperColor}`),St(Gh,"style",`background-color: ${n(Aa).styles.upperColor}`),St(Xg,"style",`background-color: ${n(Aa).styles.middleColor}`),St(Yh,"style",`background-color: ${n(Aa).styles.middleColor}`),St(em,"style",`background-color: ${n(Aa).styles.lowerColor}`),St(Uh,"style",`background-color: ${n(Aa).styles.lowerColor}`)}),go(Hf,()=>n(Aa).period,Yu=>n(Aa).period=Yu),go(Gf,()=>n(Aa).stdDev,Yu=>n(Aa).stdDev=Yu),go(Zf,()=>n(Aa).styles.fillOpacity,Yu=>n(Aa).styles.fillOpacity=Yu),Bo(Zv,()=>n(Aa).styles.thickness,Yu=>n(Aa).styles.thickness=Yu),Bo(Jv,()=>n(Aa).styles.lineStyle,Yu=>n(Aa).styles.lineStyle=Yu),O(dl,nv)}),O(cl,eu)}),f(jo),we(()=>{St(Yr,"style",`background-color: ${n(S)??""}; opacity: ${n(L)/100}`),St(va,"style",`background-color: ${n(S)??""}; opacity: ${n(L)/100}`),Ye(Qi,`${n(L)??""}%`),St(dc,"style",`background-color: ${n(T)??""}`),St(Si,"style",`background-color: ${n(T)??""}`),St(Tc,"style",`background-color: ${n(P)??""}`),St(Er,"style",`background-color: ${n(P)??""}`),St(Nl,"style",`background-color: ${n(A)??""}`),St(Ll,"style",`background-color: ${n(A)??""}`)}),go(ki,()=>n(R),cl=>b(R,cl)),go(Yi,()=>n(N),cl=>b(N,cl)),go($a,()=>n(L),cl=>b(L,cl)),Bo(od,()=>n(F),cl=>b(F,cl)),Bo(up,()=>n(B),cl=>b(B,cl)),O($s,jo)},$s=>{var jo=Xt(),zs=_t(jo);Se(zs,()=>!_.length,Ti=>{var Ps=bj(),ki=g(Ps),ln=g(ki,!0);we(()=>Ye(ln,fb())),f(ki),f(Ps),O(Ti,Ps)},Ti=>{var Ps=Cj(),ki=g(Ps);Ns(ki,17,()=>_,dn,(Yi,oa,Pr)=>{var Fr=kj(),Yr=g(Fr),ka=g(Yr),va=g(ka,!0);f(ka);var ma=u(ka,2),la=g(ma);Vt(la);var ra=u(la,2);Se(ra,()=>p.length>1&&!n(Dr),nl=>{var Ll=xj();Ll.__click=()=>$v(Pr),O(nl,Ll)},nl=>{var Ll=Xt(),Lc=_t(Ll);Se(Lc,()=>!n(Dr),Ai=>{var Ta=wj();O(Ai,Ta)},null,!0),O(nl,Ll)}),f(ma),f(Yr);var Qi=u(Yr,2),$a=g(Qi),Al=u(g($a),2),Ql=We(()=>Fv(Pr));Al.__click=function(...nl){var Ll;(Ll=n(Ql))==null||Ll.apply(this,nl)};var Sa=g(Al);f(Al),f($a);var cc=u($a,2),dc=u(g(cc),2),Ya=g(dc);Ya.value=(Ya.__value=1)==null?"":1;var Si=u(Ya);Si.value=(Si.__value=2)==null?"":2;var kc=u(Si);kc.value=(kc.__value=3)==null?"":3;var Ua=u(kc);Ua.value=(Ua.__value=4)==null?"":4;var Tc=u(Ua);Tc.value=(Tc.__value=5)==null?"":5,f(dc),f(cc);var uc=u(cc,2),Er=u(g(uc),2),Ac=g(Er);Ac.value=(Ac.__value="solid")==null?"":"solid";var Gl=u(Ac);Gl.value=(Gl.__value="dashed")==null?"":"dashed";var Nl=u(Gl);Nl.value=(Nl.__value="dotted")==null?"":"dotted",f(Er),f(uc),f(Qi),f(Fr),we(()=>{Ye(va,n(oa).title),St(Sa,"style",`background-color: ${y[Pr].color??""}`)}),go(la,()=>p[Pr],nl=>p[Pr]=nl),Bo(dc,()=>y[Pr].thickness,nl=>y[Pr].thickness=nl),Bo(Er,()=>y[Pr].lineStyle,nl=>y[Pr].lineStyle=nl),O(Yi,Fr)});var ln=u(ki,2);Se(ln,()=>_.length<10&&!n(Dr)&&!n(js)&&!n(ca),Yi=>{var oa=Sj(),Pr=g(oa);Pr.__click=[xm,Dr,Ki,jv,Ge,fv,at,gv,Ci,zv,_,p,y,fn,xa,Io,Hs],f(oa),we(()=>St(Pr,"title",n(Ki)?"Add more BIAS indicator":n(Ge)?"Add more Awesome Oscillator":n(at)?"Add more WR indicator":n(Io)?"Add more EMA":"Add parameter")),O(Yi,oa)}),f(Ps),O(Ti,Ps)},!0),O($s,jo)},!0),O(jn,Wn)},!0),O(Ln,wi)},!0),O(Os,di)},!0),O(Ks,vr)},!0),O(as,Ji)},!0),O(xn,Xs)},!0),O(hs,Zn)},!0),O(si,ni)},!0),O(bn,$n)},!0),O(On,Kn)},!0),O(Fs,yn)},!0),O(Rn,$i)},!0),O(Tn,Un)},!0),O(oi,Oi)},!0),O(ci,Ar)},!0),O(Ri,tn)},!0),O(nn,Xi)},!0),O(Hi,Us)},!0),O(Ei,Yn)},!0),O(bi,pr)},!0),O(yi,Or)},!0),O(Di,Rr)},!0),O(ei,yr)},!0),O(_r,sl)},!0),O(hr,ea)},!0),O(Ni,aa)},!0),O(mc,lc)},!0),O(gc,xc)},!0),O(zc,Ic)},!0),O(Mn,Ia)},!0),O(ao,Et)},!0),O(Fe,it)},!0),O(E,H)});var D=u(I,2);Se(D,()=>n(Od),E=>{var H=Pj();O(E,H)}),f(M),O(h,M)},$$slots:{default:!0}});var Pf=u(mv,2),If=We(()=>{var h,x;return((x=(h=n(Vo)[n(Cn)])==null?void 0:h.styles)==null?void 0:x.upperColor)||"#f23645"});gr(Pf,{get show(){return n(vt)},set show(h){b(vt,j(h))},get selectedColor(){return n(If)},get position(){return n($t)},$$events:{colorChange:h=>{n(Vo)[n(Cn)]?(n(Vo)[n(Cn)].styles.upperColor=h.detail.rgba||h.detail.color,To()):b(T,j(h.detail.rgba||h.detail.color))}}});var og=u(Pf,2),sg=We(()=>{var h,x;return((x=(h=n(Vo)[n(Cn)])==null?void 0:h.styles)==null?void 0:x.middleColor)||"#2962ff"});gr(og,{get show(){return n(zo)},set show(h){b(zo,j(h))},get selectedColor(){return n(sg)},get position(){return n(bo)},$$events:{colorChange:h=>{n(Vo)[n(Cn)]?(n(Vo)[n(Cn)].styles.middleColor=h.detail.rgba||h.detail.color,To()):b(P,j(h.detail.rgba||h.detail.color))}}});var Lu=u(og,2),ng=We(()=>{var h,x;return((x=(h=n(Vo)[n(Cn)])==null?void 0:h.styles)==null?void 0:x.lowerColor)||"#089981"});gr(Lu,{get show(){return n(xo)},set show(h){b(xo,j(h))},get selectedColor(){return n(ng)},get position(){return n(Zo)},$$events:{colorChange:h=>{n(Vo)[n(Cn)]?(n(Vo)[n(Cn)].styles.lowerColor=h.detail.rgba||h.detail.color,To()):b(A,j(h.detail.rgba||h.detail.color))}}});var Mf=u(Lu,2),gh=We(()=>{var h,x;return((x=(h=n(Vo)[n(Cn)])==null?void 0:h.styles)==null?void 0:x.fillColor)||"#2196F3"});gr(Mf,{get show(){return n(mt)},set show(h){b(mt,j(h))},get selectedColor(){return n(gh)},get position(){return n(Wt)},$$events:{colorChange:h=>{n(Vo)[n(Cn)]?(n(Vo)[n(Cn)].styles.fillColor=h.detail.rgba||h.detail.color,To()):b(S,j(h.detail.rgba||h.detail.color))}}});var Tf=u(Mf,2);gr(Tf,{get show(){return n(os)},set show(h){b(os,j(h))},get selectedColor(){return n(cr)},get position(){return n(ri)},$$events:{colorChange:h=>{var M;b(cr,j(h.detail.rgba||h.detail.color));const x=window.__npoMaeApi;(M=x==null?void 0:x.setColors)==null||M.call(x,{median:n(cr)})}}});var ig=u(Tf,2),mh=We(()=>k(n(ai),n(qi)));gr(ig,{get show(){return n(vn)},set show(h){b(vn,j(h))},get selectedColor(){return n(mh)},get position(){return n(sr)},$$events:{colorChange:h=>{b(ai,j(h.detail.rgba||h.detail.color)),Yt()}}});var Fu=u(ig,2);gr(Fu,{get show(){return n(Ko)},set show(h){b(Ko,j(h))},get selectedColor(){return n(Dn)},get position(){return n(Hn)},$$events:{colorChange:h=>{var M;b(Dn,j(h.detail.rgba||h.detail.color));const x=window.__npoMaeApi;(M=x==null?void 0:x.setColors)==null||M.call(x,{slLong:n(Dn)})}}});var Vv=u(Fu,2);gr(Vv,{get show(){return n(ji)},set show(h){b(ji,j(h))},get selectedColor(){return n(kr)},get position(){return n(zn)},$$events:{colorChange:h=>{var M;b(kr,j(h.detail.rgba||h.detail.color));const x=window.__npoMaeApi;(M=x==null?void 0:x.setColors)==null||M.call(x,{slShort:n(kr)})}}});var Wv=u(Vv,2),Af=We(()=>{var h,x,M;return((M=(x=(h=n(Dt)[n(U)])==null?void 0:h.styles)==null?void 0:x[n(G)])==null?void 0:M.color)||"#2563eb"});gr(Wv,{get show(){return n($)},set show(h){b($,j(h))},get selectedColor(){return n(Af)},get position(){return n(V)},$$events:{colorChange:h=>{n(Dt).length>n(U)&&(n(Dt)[n(U)].styles[n(G)].color=h.detail.rgba||h.detail.color,ia(n(U),n(G)))}}});var hv=u(Wv,2),tv=We(()=>{var h,x,M;return((M=(x=(h=n(vs)[n(Va)])==null?void 0:h.styles)==null?void 0:x[n(Wa)])==null?void 0:M.color)||"#2563eb"});gr(hv,{get show(){return n(Xa)},set show(h){b(Xa,j(h))},get selectedColor(){return n(tv)},get position(){return Ja},$$events:{colorChange:h=>{n(vs).length>n(Va)&&n(vs)[n(Va)].styles[n(Wa)]&&(n(vs)[n(Va)].styles[n(Wa)].color=h.detail.rgba||h.detail.color,$o())}}});var Tr=u(hv,2),qv=We(()=>{var h;return((h=n(Pi)[n(se)])==null?void 0:h.color)||"#2563eb"});gr(Tr,{get show(){return n(Z)},set show(h){b(Z,j(h))},get selectedColor(){return n(qv)},get position(){return n(le)},$$events:{colorChange:h=>{n(Pi).length>n(se)&&(n(Pi)[n(se)].color=h.detail.rgba||h.detail.color,ud())}}});var Hv=u(Tr,2),Mp=We(()=>{var h,x,M;return((M=(x=(h=n(Rs)[0])==null?void 0:h.styles)==null?void 0:x.diPlus)==null?void 0:M.color)||"#2563eb"});gr(Hv,{get show(){return n(ie)},set show(h){b(ie,j(h))},get selectedColor(){return n(Mp)},get position(){return n(Y)},$$events:{colorChange:h=>{n(Rs).length>0&&(n(Rs)[0].styles.diPlus.color=h.detail.rgba||h.detail.color)}}});var rg=u(Hv,2),Lf=We(()=>{var h;return((h=y[0])==null?void 0:h.color)||"#2563eb"});gr(rg,{get show(){return n(q)},set show(h){b(q,j(h))},get selectedColor(){return n(Lf)},get position(){return n(ce)},$$events:{colorChange:h=>{y.length>0&&(y[0].color=h.detail.rgba||h.detail.color)}}});var Ff=u(rg,2),xd=We(()=>{var h;return((h=n(kn)[n(be)])==null?void 0:h.color)||"#2563eb"});gr(Ff,{get show(){return n(De)},set show(h){b(De,j(h))},get selectedColor(){return n(xd)},get position(){return n(ge)},$$events:{colorChange:h=>{n(kn)[n(be)]&&(n(kn)[n(be)].color=h.detail.rgba||h.detail.color,Nr())}}});var ag=u(Ff,2),hh=We(()=>{var h;return((h=y[0])==null?void 0:h.color)||"#2563eb"});gr(ag,{get show(){return n(_e)},set show(h){b(_e,j(h))},get selectedColor(){return n(hh)},get position(){return n(me)},$$events:{colorChange:h=>{y.length>0&&(y[0].color=h.detail.rgba||h.detail.color)}}});var Df=u(ag,2),_h=We(()=>{var h;return((h=y[0])==null?void 0:h.color)||"#2563eb"});gr(Df,{get show(){return n($e)},set show(h){b($e,j(h))},get selectedColor(){return n(_h)},get position(){return n(Ve)},$$events:{colorChange:h=>{y.length>0&&(y[0].color=h.detail.rgba||h.detail.color)}}});var Ef=u(Df,2),yh=We(()=>{var h,x,M,I,D,E,H,ue,Fe;return n(ee)==="histogram"?((M=(x=(h=n(Ce)[n(Ae)])==null?void 0:h.styles)==null?void 0:x.histogram)==null?void 0:M.upColor)||"#26a69a":n(ee)==="histogram-down"?((E=(D=(I=n(Ce)[n(Ae)])==null?void 0:I.styles)==null?void 0:D.histogram)==null?void 0:E.downColor)||"#ef5350":((Fe=(ue=(H=n(Ce)[n(Ae)])==null?void 0:H.styles)==null?void 0:ue.ema)==null?void 0:Fe.color)||"#2563eb"}),bh=We(()=>n(ee)==="histogram"||n(ee)==="histogram-down"?70:100);gr(Ef,{get show(){return n(Je)},set show(h){b(Je,j(h))},get selectedColor(){return n(yh)},get opacity(){return n(bh)},get position(){return n(ye)},$$events:{colorChange:h=>{n(Ce).length>n(Ae)&&(n(ee)==="histogram"?n(Ce)[n(Ae)].styles.histogram.upColor=h.detail.rgba||h.detail.color:n(ee)==="histogram-down"?n(Ce)[n(Ae)].styles.histogram.downColor=h.detail.rgba||h.detail.color:n(ee)==="ema"&&(n(Ce)[n(Ae)].styles.ema.color=h.detail.rgba||h.detail.color),Qr(n(Ae)))}}});var lg=u(Ef,2),Gu=We(()=>{var h,x,M;return((M=(x=(h=n(jt)[n(Qe)])==null?void 0:h.styles)==null?void 0:x.wr)==null?void 0:M.color)||"#2563eb"});gr(lg,{get show(){return n(xe)},set show(h){b(xe,j(h))},get selectedColor(){return n(Gu)},get position(){return n(ke)},$$events:{colorChange:h=>{n(jt).length>n(Qe)&&n(jt)[n(Qe)].styles.wr&&(n(jt)[n(Qe)].styles.wr.color=h.detail.rgba||h.detail.color,ol(n(Qe)))}}});var wd=u(lg,2),$f=We(()=>{var h,x,M;return((M=(x=(h=n(jt)[n(Qe)])==null?void 0:h.styles)==null?void 0:x.overbought)==null?void 0:M.color)||"#FF4444"});gr(wd,{get show(){return n(He)},set show(h){b(He,j(h))},get selectedColor(){return n($f)},get position(){return n(Ie)},$$events:{colorChange:h=>{n(jt).length>n(Qe)&&n(jt)[n(Qe)].styles.overbought&&(n(jt)[n(Qe)].styles.overbought.color=h.detail.rgba||h.detail.color,ol(n(Qe)))}}});var cg=u(wd,2),jf=We(()=>{var h,x,M;return((M=(x=(h=n(jt)[n(Qe)])==null?void 0:h.styles)==null?void 0:x.oversold)==null?void 0:M.color)||"#00C851"});gr(cg,{get show(){return n(ne)},set show(h){b(ne,j(h))},get selectedColor(){return n(jf)},get position(){return n(J)},$$events:{colorChange:h=>{n(jt).length>n(Qe)&&n(jt)[n(Qe)].styles.oversold&&(n(jt)[n(Qe)].styles.oversold.color=h.detail.rgba||h.detail.color,ol(n(Qe)))}}});var dg=u(cg,2),xh=We(()=>{var h,x,M;return((M=(x=(h=n(jt)[n(Qe)])==null?void 0:h.styles)==null?void 0:x.middleLine)==null?void 0:M.color)||"#808080"});gr(dg,{get show(){return n(qe)},set show(h){b(qe,j(h))},get selectedColor(){return n(xh)},get position(){return n(ft)},$$events:{colorChange:h=>{n(jt).length>n(Qe)&&n(jt)[n(Qe)].styles.middleLine&&(n(jt)[n(Qe)].styles.middleLine.color=h.detail.rgba||h.detail.color,ol(n(Qe)))}}});var ov=u(dg,2),ug=We(()=>{var h,x,M;return((M=(x=(h=n(Co)[n(Lt)])==null?void 0:h.styles)==null?void 0:x[n(It)])==null?void 0:M.color)||"#2563eb"});gr(ov,{get show(){return n(Oe)},set show(h){b(Oe,j(h))},get selectedColor(){return n(ug)},get position(){return n(ct)},$$events:{colorChange:h=>{n(Co).length>n(Lt)&&n(Co)[n(Lt)].styles[n(It)]&&(n(Co)[n(Lt)].styles[n(It)].color=h.detail.rgba||h.detail.color,ba(n(Lt)))}}});var zf=u(ov,2),wh=We(()=>{var h,x,M;return((M=(x=(h=n(an)[n(Mo)])==null?void 0:h.styles)==null?void 0:x.roc)==null?void 0:M.color)||"#2563eb"});gr(zf,{get show(){return n(zt)},set show(h){b(zt,j(h))},get selectedColor(){return n(wh)},get position(){return n(pt)},$$events:{colorChange:h=>{n(an).length>n(Mo)&&(n(an)[n(Mo)].styles.roc.color=h.detail.rgba||h.detail.color,ql(n(Mo)))}}});var pg=u(zf,2),kh=We(()=>{var h,x,M,I,D,E;return n(Fo)%2===0?((M=(x=(h=n(As)[Math.floor(n(Fo)/2)])==null?void 0:h.styles)==null?void 0:x.psy)==null?void 0:M.color)||"#2563eb":((E=(D=(I=n(As)[Math.floor(n(Fo)/2)])==null?void 0:I.styles)==null?void 0:D.mapsy)==null?void 0:E.color)||"#dc2626"});gr(pg,{get show(){return n(Xo)},set show(h){b(Xo,j(h))},get selectedColor(){return n(kh)},get position(){return n(en)},$$events:{colorChange:h=>{const x=Math.floor(n(Fo)/2);n(As).length>x&&(n(Fo)%2===0?(n(As)[x].styles.psy.color=h.detail.rgba||h.detail.color,console.log("🎨 Updated PSY color to:",h.detail.color)):(n(As)[x].styles.mapsy.color=h.detail.rgba||h.detail.color,console.log("🎨 Updated MAPSY color to:",h.detail.color)),jl(x))}}});var vg=u(pg,2),fg=We(()=>{var h,x,M,I,D,E;return n(Zt)%2===0?((M=(x=(h=n(qs)[Math.floor(n(Zt)/2)])==null?void 0:h.styles)==null?void 0:x.obv)==null?void 0:M.color)||"#FF6B35":((E=(D=(I=n(qs)[Math.floor(n(Zt)/2)])==null?void 0:I.styles)==null?void 0:D.maobv)==null?void 0:E.color)||"#2196F3"});gr(vg,{get show(){return n(Eo)},set show(h){b(Eo,j(h))},get selectedColor(){return n(fg)},get position(){return n(cs)},$$events:{colorChange:h=>{const x=Math.floor(n(Zt)/2);n(qs).length>x&&(n(Zt)%2===0?(n(qs)[x].styles.obv.color=h.detail.rgba||h.detail.color,console.log("🎨 Updated OBV color to:",h.detail.color)):(n(qs)[x].styles.maobv.color=h.detail.rgba||h.detail.color,console.log("🎨 Updated MAOBV color to:",h.detail.color)),zl())}}});var Bf=u(vg,2),Sh=We(()=>{var h;return((h=n(Qs)[n(Gn)])==null?void 0:h.styles.color)||"#2962FF"});gr(Bf,{get show(){return n(bs)},set show(h){b(bs,j(h))},get selectedColor(){return n(Sh)},get position(){return n(es)},$$events:{colorChange:h=>{n(Qs).length>n(Gn)&&(n(Qs)[n(Gn)].styles.color=h.detail.rgba||h.detail.color,wn())}}});var Gv=u(Bf,2),gg=We(()=>{var h;return((h=n(Ut)[n(rr)])==null?void 0:h.color)||"#FF6B35"});gr(Gv,{get show(){return n(rn)},set show(h){b(rn,j(h))},get selectedColor(){return n(gg)},get position(){return n(wr)},$$events:{colorChange:h=>{n(Ut).length>n(rr)&&(n(Ut)[n(rr)].color=h.detail.rgba||h.detail.color,console.log("🎨 Updated PVT color to:",h.detail.color),cp(n(rr)))}}});var sv=u(Gv,2),Nf=We(()=>{var h;return((h=n(is)[n(ii)])==null?void 0:h.color)||"#2563eb"});gr(sv,{get show(){return n(ar)},set show(h){b(ar,j(h))},get selectedColor(){return n(Nf)},get position(){return n(jr)},$$events:{colorChange:h=>{n(is).length>n(ii)&&(n(is)[n(ii)].color=h.detail.rgba||h.detail.color)}}});var Rf=u(sv,2),mg=We(()=>{var h;return((h=n(Ot)[n(Kl)])==null?void 0:h.color)||"#2563eb"});gr(Rf,{get show(){return n(Qa)},set show(h){b(Qa,j(h))},get selectedColor(){return n(mg)},get position(){return n(qa)},$$events:{colorChange:h=>{n(Ot).length>n(Kl)&&(n(Ot)[n(Kl)].color=h.detail.rgba||h.detail.color,fc())}}});var _v=u(Rf,2),hg=We(()=>{var h,x;return((x=(h=n(Bl)[n(fo)])==null?void 0:h.styles[n(Jt)])==null?void 0:x.color)||"#2563eb"});gr(_v,{get show(){return n(ll)},set show(h){b(ll,j(h))},get selectedColor(){return n(hg)},get position(){return n(Wr)},$$events:{colorChange:h=>{const x=n(Bl)[n(fo)];x&&x.styles&&x.styles.length>n(Jt)&&(x.styles[n(Jt)].color=h.detail.rgba||h.detail.color,Tu(n(fo)))}}});var mu=u(_v,2),Tp=We(()=>{var h;return((h=y[0])==null?void 0:h.color)||"#2563eb"});gr(mu,{get show(){return n(Ca)},set show(h){b(Ca,j(h))},get selectedColor(){return n(Tp)},get position(){return n(vl)},$$events:{colorChange:h=>{y.length>0&&(y[0].color=h.detail.rgba||h.detail.color)}}});var _g=u(mu,2),yg=We(()=>{var h,x,M,I,D,E;return n(el)%2===0?((M=(x=(h=n(Oo)[Math.floor(n(el)/2)])==null?void 0:h.styles)==null?void 0:x.increasing)==null?void 0:M.color)||"#00C851":((E=(D=(I=n(Oo)[Math.floor(n(el)/2)])==null?void 0:I.styles)==null?void 0:D.decreasing)==null?void 0:E.color)||"#FF4444"});gr(_g,{get show(){return n(ml)},set show(h){b(ml,j(h))},get selectedColor(){return n(yg)},get position(){return n(Sl)},$$events:{colorChange:h=>{const x=Math.floor(n(el)/2);n(Oo)[x]&&(n(el)%2===0?n(Oo)[x].styles.increasing.color=h.detail.rgba||h.detail.color:n(Oo)[x].styles.decreasing.color=h.detail.rgba||h.detail.color,gu())}}});var bg=u(_g,2),Ch=We(()=>{var h,x,M;return((M=(x=(h=n(Rs)[n(K)])==null?void 0:h.styles)==null?void 0:x[n(Q)])==null?void 0:M.color)||"#2563eb"});gr(bg,{get show(){return n(ie)},set show(h){b(ie,j(h))},get selectedColor(){return n(Ch)},get position(){return n(Y)},$$events:{colorChange:h=>{n(Rs).length>n(K)&&n(Rs)[n(K)].styles[n(Q)]&&(n(Rs)[n(K)].styles[n(Q)].color=h.detail.rgba||h.detail.color,po())}}});var xg=u(bg,2),Ph=We(()=>{var h,x,M;return((M=(x=(h=n(Oo)[0])==null?void 0:h.styles)==null?void 0:x.increasing)==null?void 0:M.color)||"#16a34a"});gr(xg,{get show(){return n(Ke)},set show(h){b(Ke,j(h))},get selectedColor(){return n(Ph)},get position(){return n(ps)},$$events:{colorChange:h=>{n(Oo).length>0&&(n(Oo)[0].styles.increasing.color=h.detail.rgba||h.detail.color)}}});var wg=u(xg,2),Ih=We(()=>{var h,x,M;return((M=(x=(h=n(Oo)[0])==null?void 0:h.styles)==null?void 0:x.decreasing)==null?void 0:M.color)||"#dc2626"});gr(wg,{get show(){return n(pn)},set show(h){b(pn,j(h))},get selectedColor(){return n(Ih)},get position(){return n(Jo)},$$events:{colorChange:h=>{n(Oo).length>0&&(n(Oo)[0].styles.decreasing.color=h.detail.rgba||h.detail.color)}}});var kg=u(wg,2),Mh=We(()=>{var h;return((h=y[0])==null?void 0:h.color)||"#2563eb"});gr(kg,{get show(){return n(ti)},set show(h){b(ti,j(h))},get selectedColor(){return n(Mh)},get position(){return mr},$$events:{colorChange:h=>{y.length>0&&(y[0].color=h.detail.rgba||h.detail.color)}}});var Sg=u(kg,2),Th=We(()=>{var h;return((h=y[1])==null?void 0:h.color)||"#dc2626"});gr(Sg,{get show(){return n(sa)},set show(h){b(sa,j(h))},get selectedColor(){return n(Th)},get position(){return yt},$$events:{colorChange:h=>{y.length>1&&(y[1].color=h.detail.rgba||h.detail.color)}}});var Cg=u(Sg,2),Pg=We(()=>{var h;return((h=y[2])==null?void 0:h.color)||"#16a34a"});gr(Cg,{get show(){return n(wt)},set show(h){b(wt,j(h))},get selectedColor(){return n(Pg)},get position(){return n(to)},$$events:{colorChange:h=>{y.length>2&&(y[2].color=h.detail.rgba||h.detail.color)}}});var Of=u(Cg,2);gr(Of,{get show(){return n(mt)},set show(h){b(mt,j(h))},get selectedColor(){return n(S)},get position(){return n(Wt)},$$events:{colorChange:h=>{b(S,j(h.detail.rgba||h.detail.color))}}});var Vf=u(Of,2);gr(Vf,{get show(){return n(vt)},set show(h){b(vt,j(h))},get selectedColor(){return n(T)},get position(){return n($t)},$$events:{colorChange:h=>{b(T,j(h.detail.rgba||h.detail.color))}}});var Ig=u(Vf,2);gr(Ig,{get show(){return n(zo)},set show(h){b(zo,j(h))},get selectedColor(){return n(P)},get position(){return n(bo)},$$events:{colorChange:h=>{b(P,j(h.detail.rgba||h.detail.color))}}});var Mg=u(Ig,2);gr(Mg,{get show(){return n(xo)},set show(h){b(xo,j(h))},get selectedColor(){return n(A)},get position(){return n(Zo)},$$events:{colorChange:h=>{b(A,j(h.detail.rgba||h.detail.color))}}});var Tg=u(Mg,2),Ag=We(()=>{var h;return((h=y[n(et)])==null?void 0:h.color)||"#2563eb"});gr(Tg,{get show(){return n(Le)},set show(h){b(Le,j(h))},get selectedColor(){return n(Ag)},get position(){return n(nt)},$$events:{colorChange:h=>{y.length>n(et)&&(y[n(et)].color=h.detail.rgba||h.detail.color,Hs())}}});var Lg=u(Tg,2),Ah=We(()=>{var h;return((h=n(Yo)[n(ut)])==null?void 0:h.color)||"#FF6C37"});gr(Lg,{get show(){return n(ht)},set show(h){b(ht,j(h))},get selectedColor(){return n(Ah)},get position(){return n(uo)},$$events:{colorChange:h=>{n(Yo).length>n(ut)&&(n(Yo)[n(ut)].color=h.detail.rgba||h.detail.color,Qc(n(ut)))}}});var Fg=u(Lg,2),Lh=We(()=>{var h;return((h=y[n(ko)])==null?void 0:h.color)||"#2563eb"});gr(Fg,{get show(){return n(lo)},set show(h){b(lo,j(h))},get selectedColor(){return n(Lh)},get position(){return n(so)},$$events:{colorChange:h=>{y.length>n(ko)&&(y[n(ko)].color=h.detail.rgba||h.detail.color,xa())}}});var Dg=u(Fg,2),Fh=We(()=>{var h;return((h=n(Ho)[n(ro)])==null?void 0:h.color)||"#2563eb"});gr(Dg,{get show(){return n(ts)},set show(h){b(ts,j(h))},get selectedColor(){return n(Fh)},get position(){return n(Xn)},$$events:{colorChange:h=>{n(Ho).length>n(ro)&&(n(Ho)[n(ro)].color=h.detail.rgba||h.detail.color,Fi(n(ro)))}}});var Qd=u(Dg,2),Dh=We(()=>(()=>{const h=Math.floor(n(he)/3),x=n(he)%3,M=n(Jn)[h];if(!M)return"#2563eb";switch(x){case 0:return M.styles.k.color;case 1:return M.styles.d.color;case 2:return M.styles.j.color;default:return"#2563eb"}})());gr(Qd,{get show(){return n(Pe)},set show(h){b(Pe,j(h))},get selectedColor(){return n(Dh)},get position(){return n(ze)},$$events:{colorChange:h=>{const x=Math.floor(n(he)/3),M=n(he)%3,I=n(Jn)[x];if(console.log("🎨 KDJ Color change:",{groupIndex:x,lineIndex:M,newColor:h.detail.color,group:I}),I){switch(M){case 0:I.styles.k.color=h.detail.rgba||h.detail.color,console.log("🎨 Updated K color to:",h.detail.color);break;case 1:I.styles.d.color=h.detail.rgba||h.detail.color,console.log("🎨 Updated D color to:",h.detail.color);break;case 2:I.styles.j.color=h.detail.rgba||h.detail.color,console.log("🎨 Updated J color to:",h.detail.color);break}console.log("🎨 Updated KDJ group:",I),ac(x)}}}});var Eg=u(Qd,2),Eh=We(()=>(()=>{const h=n(li)[n(pe)];if(!h)return"#2563eb";switch(n(rt)){case"cr":return h.styles.cr.color;case"ma1":return h.styles.ma1.color;case"ma2":return h.styles.ma2.color;case"ma3":return h.styles.ma3.color;case"ma4":return h.styles.ma4.color;default:return"#2563eb"}})());gr(Eg,{get show(){return n(or)},set show(h){b(or,j(h))},get selectedColor(){return n(Eh)},get position(){return n(tc)},$$events:{colorChange:h=>{const x=n(li)[n(pe)];if(x){switch(n(rt)){case"cr":x.styles.cr.color=h.detail.rgba||h.detail.color;break;case"ma1":x.styles.ma1.color=h.detail.rgba||h.detail.color;break;case"ma2":x.styles.ma2.color=h.detail.rgba||h.detail.color;break;case"ma3":x.styles.ma3.color=h.detail.rgba||h.detail.color;break;case"ma4":x.styles.ma4.color=h.detail.rgba||h.detail.color;break}ms()}}}});var Wf=u(Eg,2),$h=We(()=>{var h,x,M;return((M=(x=(h=n(Wo)[n(ss)])==null?void 0:h.styles)==null?void 0:x.rsi)==null?void 0:M.color)||"#8B5CF6"});gr(Wf,{get show(){return n(Do)},set show(h){b(Do,j(h))},get selectedColor(){return n($h)},get position(){return n(Ao)},$$events:{colorChange:h=>{n(Wo).length>n(ss)&&(n(Wo)[n(ss)].styles.rsi.color=h.detail.rgba||h.detail.color,Bt(n(ss)))}}});var $g=u(Wf,2),jh=We(()=>{var h,x;return((x=(h=n(Wo)[n(Ze)])==null?void 0:h.styles)==null?void 0:x.overboughtColor)||"#EF4444"});gr($g,{get show(){return n(Ft)},set show(h){b(Ft,j(h))},get selectedColor(){return n(jh)},get position(){return n(Qt)},$$events:{colorChange:h=>{if(n(Wo).length>n(Ze)){const x=h.detail.rgba||h.detail.color;n(Wo)[n(Ze)].styles.overboughtColor=x,b(Wo,j([...n(Wo)])),Bt(n(Ze))}}}});var jg=u($g,2),qf=We(()=>{var h,x;return((x=(h=n(Wo)[n(Ze)])==null?void 0:h.styles)==null?void 0:x.oversoldColor)||"#22C55E"});gr(jg,{get show(){return n(xt)},set show(h){b(xt,j(h))},get selectedColor(){return n(qf)},get position(){return n(eo)},$$events:{colorChange:h=>{if(n(Wo).length>n(Ze)){const x=h.detail.rgba||h.detail.color;n(Wo)[n(Ze)].styles.oversoldColor=x,b(Wo,j([...n(Wo)])),Bt(n(Ze))}}}});var zg=u(jg,2),zh=We(()=>{var h,x;return((x=(h=n(Wo)[n(Ze)])==null?void 0:h.styles)==null?void 0:x.middleLineColor)||"#6B7280"});gr(zg,{get show(){return n(Is)},set show(h){b(Is,j(h))},get selectedColor(){return n(zh)},get position(){return n(Po)},$$events:{colorChange:h=>{if(n(Wo).length>n(Ze)){const x=h.detail.rgba||h.detail.color;n(Wo)[n(Ze)].styles.middleLineColor=x,b(Wo,j([...n(Wo)])),Bt(n(Ze))}}}});var Bg=u(zg,2),Bh=We(()=>{var h,x,M;return((M=(x=(h=n(Gs)[n(Ms)])==null?void 0:h.styles)==null?void 0:x.kLine)==null?void 0:M.color)||"#2962FF"});gr(Bg,{get show(){return n(ds)},set show(h){b(ds,j(h))},get selectedColor(){return n(Bh)},get position(){return n(ui)},$$events:{colorChange:h=>{n(Gs).length>n(Ms)&&(n(Gs)[n(Ms)].styles.kLine.color=h.detail.rgba||h.detail.color,bl(n(Ms)))}}});var Ng=u(Bg,2),Nh=We(()=>{var h,x,M;return((M=(x=(h=n(Gs)[n(Ms)])==null?void 0:h.styles)==null?void 0:x.dLine)==null?void 0:M.color)||"#FF6D00"});gr(Ng,{get show(){return n(Cs)},set show(h){b(Cs,j(h))},get selectedColor(){return n(Nh)},get position(){return n(ui)},$$events:{colorChange:h=>{n(Gs).length>n(Ms)&&(n(Gs)[n(Ms)].styles.dLine.color=h.detail.rgba||h.detail.color,bl(n(Ms)))}}});var Rg=u(Ng,2),Rh=We(()=>{var h,x;return((x=(h=n(Gs)[n(Ms)])==null?void 0:h.styles)==null?void 0:x.overboughtColor)||"#EF4444"});gr(Rg,{get show(){return n(ns)},set show(h){b(ns,j(h))},get selectedColor(){return n(Rh)},get position(){return n(ui)},$$events:{colorChange:h=>{n(Gs).length>n(Ms)&&(n(Gs)[n(Ms)].styles.overboughtColor=h.detail.rgba||h.detail.color,bl(n(Ms)))}}});var Og=u(Rg,2),Oh=We(()=>{var h,x;return((x=(h=n(Gs)[n(Ms)])==null?void 0:h.styles)==null?void 0:x.oversoldColor)||"#10B981"});gr(Og,{get show(){return n(Js)},set show(h){b(Js,j(h))},get selectedColor(){return n(Oh)},get position(){return n(ui)},$$events:{colorChange:h=>{n(Gs).length>n(Ms)&&(n(Gs)[n(Ms)].styles.oversoldColor=h.detail.rgba||h.detail.color,bl(n(Ms)))}}});var Vh=u(Og,2),Wh=We(()=>{var h,x;return((x=(h=n(Gs)[n(Ms)])==null?void 0:h.styles)==null?void 0:x.midLineColor)||"#6B7280"});return gr(Vh,{get show(){return n(Nn)},set show(h){b(Nn,j(h))},get selectedColor(){return n(Wh)},get position(){return n(ui)},$$events:{colorChange:h=>{n(Gs).length>n(Ms)&&(n(Gs)[n(Ms)].styles.midLineColor=h.detail.rgba||h.detail.color,bl(n(Ms)))}}}),O(o,Cf),Za({clearCciGroups:_l,clearEmvGroups:yl,clearMtmGroups:Sr,clearObvGroups:Ba,clearPsyGroups:Pt,clearPvtGroups:xs,clearVolGroups:fs,clearWrGroups:rs,clearRocGroups:na,clearRsiGroups:Pl,clearStochasticGroups:Cr})}hc(["click","change","input"]);function Aj(o,e,t){const s=o.target;b(e,parseInt(s.value)),t()}function Lj(o,e){o.target===o.currentTarget&&e(!1)}var Fj=o=>o.stopPropagation(),Dj=(o,e)=>e(!1),Ej=(o,e)=>e("linear"),$j=(o,e)=>e("radial"),jj=(o,e,t)=>e(n(t).angle),zj=de('<button class="w-8 h-8 text-sm rounded border transition-colors flex items-center justify-center"> </button>'),Bj=de('<div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Direction</label> <div class="grid grid-cols-4 gap-1 mb-3"></div> <div class="relative"><input type="range" min="0" max="360" class="w-full h-2 rounded appearance-none cursor-pointer bg-[#404040] svelte-e3zmk9"> <div class="flex justify-between text-xs text-gray-500 mt-1"><span>0°</span> <span class="text-gray-300"> </span> <span>360°</span></div></div></div>'),Nj=de('<button class="absolute -top-2 -right-1 w-3 h-3 bg-red-500 text-white text-xs rounded-full flex items-center justify-center hover:bg-red-600 transition-colors">×</button>'),Rj=de('<div class="absolute top-0 w-4 h-6 border-2 rounded cursor-grab transform -translate-x-1/2"><!></div>'),Oj=de('<button class="mt-2 w-full py-1 text-xs text-gray-400 border border-dashed border-gray-600 rounded hover:border-gray-400 hover:text-gray-300 transition-colors">+ Add Color Stop</button>'),Vj=(o,e,t)=>e(n(t),parseInt(o.currentTarget.value)),Wj=(o,e,t)=>e(o,n(t)),qj=(o,e,t)=>e(n(t),o.currentTarget.value),Hj=(o,e,t)=>e(n(t),parseInt(o.currentTarget.value)),Gj=de('<div class="mb-4 p-3 bg-[#1A1A1A] rounded border border-[#404040]"><h4 class="text-xs font-medium text-gray-300 mb-3"> </h4> <div class="mb-3"><label class="block text-xs text-gray-400 mb-1">Position</label> <div class="flex items-center gap-2"><input type="range" min="0" max="100" class="flex-1 h-2 rounded appearance-none cursor-pointer bg-[#404040] svelte-e3zmk9"> <span class="text-xs text-gray-300 w-8"> </span></div></div> <div class="mb-3"><label class="block text-xs text-gray-400 mb-1">Color</label> <div class="flex items-center gap-2"><button class="w-8 h-8 rounded border-2 border-[#404040] cursor-pointer hover:border-gray-300 transition-colors"></button> <input type="text" class="flex-1 px-2 py-1 bg-[#404040] border border-[#555] rounded text-white text-xs focus:border-blue-500 focus:outline-none" placeholder="#000000"></div></div> <div><label class="block text-xs text-gray-400 mb-1">Opacity</label> <div class="flex items-center gap-2"><input type="range" min="0" max="100" class="flex-1 h-2 rounded appearance-none cursor-pointer bg-[#404040] svelte-e3zmk9"> <span class="text-xs text-gray-300 w-8"> </span></div></div></div>'),Yj=de('<div class="fixed inset-0 z-[70] flex items-center justify-center p-4"><div class="gradient-editor-container bg-[#2A2A2A] border border-[#404040] rounded-lg shadow-xl w-full max-w-sm max-h-[90vh] overflow-y-auto svelte-e3zmk9"><div class="p-4"><div class="mb-4"><div class="flex items-center justify-between mb-3"><h3 class="text-sm font-semibold text-white">Gradient Editor</h3> <button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">OK</button></div> <div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Gradient Type</label> <div class="flex gap-2"><button class="flex-1 px-3 py-2 text-xs rounded transition-colors">Linear</button> <button class="flex-1 px-3 py-2 text-xs rounded transition-colors">Radial</button></div></div> <!> <div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Preview</label> <div class="w-full h-12 rounded border border-[#404040]"></div></div> <div class="mb-4"><label class="block text-xs text-gray-400 mb-2">Color Stops</label> <div class="relative"><div class="relative w-full h-6 rounded border border-[#404040] cursor-pointer"></div> <!></div></div> <!></div></div></div></div>'),Uj=de("<!> <!>",1);function Vy(o,e){Ka(e,!1);const t=Md();let s=Ss(e,"show",12,!1),i=Ss(e,"initialGradient",24,()=>({type:"linear",direction:0,stops:[{position:0,color:"#ffffff",opacity:100},{position:100,color:"#000000",opacity:100}]})),r=kl(),a=kl(),l=!1,d=-1,v=kl(!1),p=kl(0),_=kl(i().type),y=kl(i().direction),w=kl([...i().stops]);const k=[{angle:0,label:"→",title:"Left to Right"},{angle:45,label:"↗",title:"Bottom-Left to Top-Right"},{angle:90,label:"↑",title:"Bottom to Top"},{angle:135,label:"↖",title:"Bottom-Right to Top-Left"},{angle:180,label:"←",title:"Right to Left"},{angle:225,label:"↙",title:"Top-Right to Bottom-Left"},{angle:270,label:"↓",title:"Top to Bottom"},{angle:315,label:"↘",title:"Top-Left to Bottom-Right"}];function S(){const q=[...n(w)].sort((ce,_e)=>ce.position-_e.position).map(ce=>`${L(ce.color,ce.opacity/100)} ${ce.position}%`);return n(_)==="linear"?`linear-gradient(${n(y)}deg, ${q.join(", ")})`:`radial-gradient(circle, ${q.join(", ")})`}function L(Q,q){const ce=parseInt(Q.slice(1,3),16),_e=parseInt(Q.slice(3,5),16),me=parseInt(Q.slice(5,7),16);return`rgba(${ce}, ${_e}, ${me}, ${q})`}function T(Q){b(_,Q),se()}function P(Q){b(y,Q),se()}function A(){if(n(w).length>=5)return;const Q=[...n(w)].sort((Pe,ze)=>Pe.position-ze.position);let q=50,ce=0,_e=50;for(let Pe=0;Pe<Q.length-1;(Pe+=1)-1){const ze=Q[Pe+1].position-Q[Pe].position;ze>ce&&(ce=ze,_e=Q[Pe].position+ze/2)}ce>10&&(q=_e);const me={position:q,color:"#808080",opacity:100};b(w,[...n(w),me]),b(p,n(w).length-1),se()}function F(Q){n(w).length<=2||(b(w,n(w).filter((q,ce)=>ce!==Q)),n(p)>=n(w).length&&b(p,n(w).length-1),se())}function B(Q,q){Ep(w,n(w)[Q].position=Math.max(0,Math.min(100,q))),se()}function R(Q,q){Ep(w,n(w)[Q].color=q),se()}function N(Q,q){Ep(w,n(w)[Q].opacity=Math.max(0,Math.min(100,q))),se()}function $(Q,q){const ce=Q.target.getBoundingClientRect();ce.right+10,ce.top,b(p,q),b(v,!0)}function V(Q){n(p)>=0&&n(p)<n(w).length&&(Ep(w,n(w)[n(p)].color=Q.detail),se())}function U(Q){n(p)>=0&&n(p)<n(w).length&&(Ep(w,n(w)[n(p)].opacity=Q.detail),se())}function G(Q){if(!n(a))return;const q=n(a).getBoundingClientRect(),ce=Q.clientX-q.left,_e=ce/q.width*100;let me=-1;const Pe=8;if(n(w).forEach((ze,he)=>{const De=ze.position/100*q.width;Math.abs(ce-De)<=Pe&&(me=he)}),me>=0)l=!0,d=me,b(p,me);else if(n(w).length<5){const ze={position:Math.max(0,Math.min(100,_e)),color:"#808080",opacity:100};b(w,[...n(w),ze]),b(p,n(w).length-1),se()}}function Z(Q){if(!l||d<0||!n(a))return;const q=n(a).getBoundingClientRect(),ce=Q.clientX-q.left,_e=Math.max(0,Math.min(100,ce/q.width*100));Ep(w,n(w)[d].position=_e),se()}function le(){l=!1,d=-1}function se(){const Q={type:n(_),direction:n(y),stops:[...n(w)],css:S()};t("gradientChange",Q)}yp(()=>{typeof document<"u"&&(document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",le))}),Rd(()=>{se()}),nu(()=>Gd(s()),()=>{s()&&typeof document<"u"&&setTimeout(()=>{document.addEventListener("mousemove",Z),document.addEventListener("mouseup",le)},0)}),nu(()=>Gd(s()),()=>{!s()&&typeof document<"u"&&(document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",le))}),Av(),Ud();var ie=Uj(),Y=_t(ie);Se(Y,s,Q=>{var q=Yj();q.__click=[Lj,s];var ce=g(q);ce.__click=[Fj];var _e=g(ce),me=g(_e),Pe=g(me),ze=u(g(Pe),2);ze.__click=[Dj,s],f(Pe);var he=u(Pe,2),De=u(g(he),2),ge=g(De);ge.__click=[Ej,T];var be=u(ge,2);be.__click=[$j,T],f(De),f(he);var $e=u(he,2);Se($e,()=>n(_)==="linear",Ie=>{var ne=Bj(),J=u(g(ne),2);Ns(J,5,()=>k,dn,(Lt,It)=>{var zt=zj();zt.__click=[jj,P,It];var pt=g(zt,!0);f(zt),we(()=>{St(zt,"title",n(It).title),Sn(zt,"border-blue-500",n(y)===n(It).angle),Sn(zt,"bg-blue-600",n(y)===n(It).angle),Sn(zt,"text-white",n(y)===n(It).angle),Sn(zt,"border-[#404040]",n(y)!==n(It).angle),Sn(zt,"text-gray-300",n(y)!==n(It).angle),Ye(pt,n(It).label)}),O(Lt,zt)}),f(J);var qe=u(J,2),ft=g(qe);Vt(ft),ft.__input=[Aj,y,se];var Qe=u(ft,2),Oe=u(g(Qe),2),ct=g(Oe);f(Oe),un(2),f(Qe),f(qe),f(ne),we(()=>Ye(ct,`${n(y)??""}°`)),go(ft,()=>n(y),Lt=>b(y,Lt)),O(Ie,ne)});var Ve=u($e,2),Ce=u(g(Ve),2);const Je=Yd(()=>`background: ${S()??""};`);f(Ve);var ye=u(Ve,2),Ae=u(g(ye),2),ee=g(Ae);const xe=Yd(()=>`background: ${S()??""};`);ee.__mousedown=G,Ns(ee,5,()=>n(w),dn,(Ie,ne,J)=>{var qe=Rj();qe.__click=Qe=>{Qe.stopPropagation(),b(p,J)};var ft=g(qe);Se(ft,()=>n(w).length>2,Qe=>{var Oe=Nj();Oe.__click=ct=>{ct.stopPropagation(),F(J)},O(Qe,Oe)}),f(qe),we(()=>{St(qe,"style",`left: ${n(ne).position??""}%; background-color: ${n(ne).color??""};`),Sn(qe,"border-white",J===n(p)),Sn(qe,"border-gray-500",J!==n(p))}),O(Ie,qe)}),f(ee),Ec(ee,Ie=>b(a,Ie),()=>n(a));var ke=u(ee,2);Se(ke,()=>n(w).length<5,Ie=>{var ne=Oj();ne.__click=A,O(Ie,ne)}),f(Ae),f(ye);var He=u(ye,2);Se(He,()=>n(p)>=0&&n(p)<n(w).length,Ie=>{var ne=Gj(),J=g(ne),qe=g(J);f(J);var ft=u(J,2),Qe=u(g(ft),2),Oe=g(Qe);Vt(Oe),Oe.__input=[Vj,B,p];var ct=u(Oe,2),Lt=g(ct);f(ct),f(Qe),f(ft);var It=u(ft,2),zt=u(g(It),2),pt=g(zt);pt.__click=[Wj,$,p];var Mo=u(pt,2);Vt(Mo),Mo.__input=[qj,R,p],f(zt),f(It);var Xo=u(It,2),en=u(g(Xo),2),Fo=g(en);Vt(Fo),Fo.__input=[Hj,N,p];var Eo=u(Fo,2),cs=g(Eo);f(Eo),f(en),f(Xo),f(ne),we(()=>{Ye(qe,`Stop ${n(p)+1} Configuration`),Ye(Lt,`${n(w)[n(p)].position??""}%`),St(pt,"style",`background-color: ${n(w)[n(p)].color??""};`),Ye(cs,`${n(w)[n(p)].opacity??""}%`)}),go(Oe,()=>n(w)[n(p)].position,Zt=>Ep(w,n(w)[n(p)].position=Zt)),go(Mo,()=>n(w)[n(p)].color,Zt=>Ep(w,n(w)[n(p)].color=Zt)),go(Fo,()=>n(w)[n(p)].opacity,Zt=>Ep(w,n(w)[n(p)].opacity=Zt)),O(Ie,ne)}),f(me),f(_e),f(ce),Ec(ce,Ie=>b(r,Ie),()=>n(r)),f(q),we(()=>{Sn(ge,"bg-blue-600",n(_)==="linear"),Sn(ge,"text-white",n(_)==="linear"),Sn(ge,"bg-[#404040]",n(_)!=="linear"),Sn(ge,"text-gray-300",n(_)!=="linear"),Sn(be,"bg-blue-600",n(_)==="radial"),Sn(be,"text-white",n(_)==="radial"),Sn(be,"bg-[#404040]",n(_)!=="radial"),Sn(be,"text-gray-300",n(_)!=="radial"),St(Ce,"style",n(Je)),St(ee,"style",n(xe))}),O(Q,q)});var K=u(Y,2);Se(K,()=>n(v),Q=>{var q=Yd(()=>{var _e;return((_e=n(w)[n(p)])==null?void 0:_e.color)||"#000000"}),ce=Yd(()=>{var _e;return((_e=n(w)[n(p)])==null?void 0:_e.opacity)||100});Su(Q,{get show(){return n(v)},set show(_e){b(v,_e)},get selectedColor(){return n(q)},get opacity(){return n(ce)},$$events:{colorChange:V,opacityChange:U},$$legacy:!0})}),O(o,ie),Za()}hc(["click","input","mousedown"]);var hp,_p,Rp,uf,jm;const C1=class C1 extends Map{constructor(t){super();l0(this,uf);l0(this,hp,new Map);l0(this,_p,Qv(0));l0(this,Rp,Qv(0));if(t){for(var[s,i]of t)super.set(s,i);Yc(this,Rp).v=super.size}}has(t){var s=Yc(this,hp),i=s.get(t);if(i===void 0){var r=super.get(t);if(r!==void 0)i=Qv(0),s.set(t,i);else return n(Yc(this,_p)),!1}return n(i),!0}forEach(t,s){im(this,uf,jm).call(this),super.forEach(t,s)}get(t){var s=Yc(this,hp),i=s.get(t);if(i===void 0){var r=super.get(t);if(r!==void 0)i=Qv(0),s.set(t,i);else{n(Yc(this,_p));return}}return n(i),super.get(t)}set(t,s){var _;var i=Yc(this,hp),r=i.get(t),a=super.get(t),l=super.set(t,s),d=Yc(this,_p);if(r===void 0)i.set(t,Qv(0)),b(Yc(this,Rp),super.size),c0(d);else if(a!==s){c0(r);var v=d.reactions===null?null:new Set(d.reactions),p=v===null||!((_=r.reactions)!=null&&_.every(y=>v.has(y)));p&&c0(d)}return l}delete(t){var s=Yc(this,hp),i=s.get(t),r=super.delete(t);return i!==void 0&&(s.delete(t),b(Yc(this,Rp),super.size),b(i,-1),c0(Yc(this,_p))),r}clear(){if(super.size!==0){super.clear();var t=Yc(this,hp);b(Yc(this,Rp),0);for(var s of t.values())b(s,-1);c0(Yc(this,_p)),t.clear()}}keys(){return n(Yc(this,_p)),super.keys()}values(){return im(this,uf,jm).call(this),super.values()}entries(){return im(this,uf,jm).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return n(Yc(this,Rp)),super.size}};hp=new WeakMap,_p=new WeakMap,Rp=new WeakMap,uf=new WeakSet,jm=function(){n(Yc(this,_p));var t=Yc(this,hp);if(Yc(this,Rp).v!==t.size)for(var s of F1(C1.prototype,this,"keys").call(this))t.has(s)||t.set(s,Qv(0));for(var[,i]of Yc(this,hp))n(i)};let E0=C1;function t1(o="dark"){return{version:2,canvas:{background:{mode:"solid",solid:{color:o==="dark"?"#070211":"#ffffff",alpha:1}},grid:{mode:"solid",solid:{color:o==="dark"?"#081115":"#F3F3F3",alpha:1}}}}}function wm(o){return JSON.parse(JSON.stringify(o))}function Kj(o,e="dark"){const s={current:t1(e),pending:null,chartId:o};return Id(s)}function Zj(o,e){if(typeof window>"u"||!window.localStorage)return;const t=`dutyai.chart.theme.${o}`;try{localStorage.setItem(t,JSON.stringify(e)),console.debug("THEME_PERSIST",{chartId:o,settings:e})}catch(s){console.error("Failed to persist theme settings:",s)}}function Wy(o,e="dark"){if(typeof window>"u"||!window.localStorage)return t1(e);const t=`dutyai.chart.theme.${o}`;try{const s=localStorage.getItem(t);if(s){const i=JSON.parse(s);if(i.version===2&&i.canvas)return console.debug("THEME_LOAD",{chartId:o,settings:i}),i}}catch(s){console.error("Failed to load persisted theme settings:",s)}return t1(e)}function Xj(o){if(!o||!o.stops||o.stops.length===0)return"transparent";const e=o.stops.map(t=>{const s=t.alpha!==void 0?t.alpha:1,i=t.color;if(s!==1&&i.startsWith("#")){const r=parseInt(i.slice(1,3),16),a=parseInt(i.slice(3,5),16),l=parseInt(i.slice(5,7),16);return`rgba(${r}, ${a}, ${l}, ${s}) ${t.offset*100}%`}return`${i} ${t.offset*100}%`}).join(", ");if(o.type==="linear")return`linear-gradient(${o.angle||0}deg, ${e})`;if(o.type==="radial"){const t=o.cx||.5,s=o.cy||.5;return o.r,`radial-gradient(circle at ${t*100}% ${s*100}%, ${e})`}return"transparent"}function A_(o,e=1){if(!o.startsWith("#"))return o;const t=parseInt(o.slice(1,3),16),s=parseInt(o.slice(3,5),16),i=parseInt(o.slice(5,7),16);return`rgba(${t}, ${s}, ${i}, ${e})`}class S1{constructor(e,t,s="dark"){re(this,"settingsStore");re(this,"chart");re(this,"chartId");re(this,"pendingThemeApplication",null);re(this,"chartUnsubscribe",null);re(this,"chartReadinessTimeout",null);re(this,"applyCanvasColorsFn",null);this.chartId=e,this.chart=t,this.settingsStore=Kj(e,s),this.setupChartReadinessMonitoring(),this.loadPersistedSettings(s)}setApplyCanvasColorsFunction(e){this.applyCanvasColorsFn=e,console.log("🎨 Canvas colors function registered with theme manager")}applyCanvasColorsIfAvailable(){this.applyCanvasColorsFn&&(console.log("🎨 Applying canvas colors via theme manager"),this.applyCanvasColorsFn())}getStore(){return this.settingsStore}setupChartReadinessMonitoring(){this.chartUnsubscribe=this.chart.subscribe(e=>{e&&this.pendingThemeApplication&&(console.log("📊 Chart became available, applying pending theme"),this.applyTheme(this.pendingThemeApplication,{preview:!1}),this.pendingThemeApplication=null,this.chartReadinessTimeout&&(clearTimeout(this.chartReadinessTimeout),this.chartReadinessTimeout=null))})}setupChartReadinessTimeout(){this.chartReadinessTimeout&&clearTimeout(this.chartReadinessTimeout),this.chartReadinessTimeout=setTimeout(()=>{this.pendingThemeApplication&&(console.warn("📊 Chart readiness timeout - clearing pending theme application"),this.pendingThemeApplication=null),this.chartReadinessTimeout=null},1e4)}destroy(){this.chartUnsubscribe&&(this.chartUnsubscribe(),this.chartUnsubscribe=null),this.chartReadinessTimeout&&(clearTimeout(this.chartReadinessTimeout),this.chartReadinessTimeout=null)}loadPersistedSettings(e){let t=Wy(this.chartId,e);const s=this.loadFromLegacySystem();s&&(t=this.mergeThemeSettings(t,s)),this.settingsStore.update(r=>({...r,current:t})),zd(this.chart)?this.applyTheme(t,{preview:!1}):(console.log("📊 Chart not ready, deferring theme application"),this.pendingThemeApplication=t,this.setupChartReadinessTimeout())}loadFromLegacySystem(){var e,t,s,i,r,a;try{const l=localStorage.getItem("chart");if(!l)return null;const d=JSON.parse(l);if(!d.styles)return null;console.log("📦 Loading from localStorage - chart type:",(t=(e=d.styles)==null?void 0:e.candle)==null?void 0:t.type);const v={canvas:{background:{},grid:{}}},p=d.styles.backgroundType||"solid";p==="solid"&&d.styles.backgroundColor?v.canvas.background={mode:"solid",solid:{color:d.styles.backgroundColor,alpha:(d.styles.backgroundOpacity??100)/100}}:p==="gradient"&&d.styles.backgroundGradient&&(v.canvas.background={mode:"gradient",gradient:d.styles.backgroundGradient});const _=d.styles.gridType||"solid";if(_==="solid"){const y=((i=(s=d.styles.grid)==null?void 0:s.horizontal)==null?void 0:i.color)||((a=(r=d.styles.grid)==null?void 0:r.vertical)==null?void 0:a.color);if(y){const w=this.extractHexFromColor(y),k=d.styles.gridOpacity??100;v.canvas.grid={mode:"solid",solid:{color:w,alpha:k/100}}}}else _==="gradient"&&d.styles.gridGradient&&(v.canvas.grid={mode:"gradient",gradient:d.styles.gridGradient});return console.debug("LEGACY_LOAD",{loadedSettings:v}),v}catch(l){return console.error("Failed to load from legacy system:",l),null}}extractHexFromColor(e){if(e.startsWith("#"))return e;if(e.startsWith("rgba")||e.startsWith("rgb")){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(t){const s=parseInt(t[1]).toString(16).padStart(2,"0"),i=parseInt(t[2]).toString(16).padStart(2,"0"),r=parseInt(t[3]).toString(16).padStart(2,"0");return`#${s}${i}${r}`}}return e}mergeThemeSettings(e,t){var i,r;const s=wm(e);return(i=t.canvas)!=null&&i.background&&(s.canvas.background=t.canvas.background),(r=t.canvas)!=null&&r.grid&&(s.canvas.grid=t.canvas.grid),s}openModal(){this.settingsStore.update(e=>(e.pending===null&&(e.pending=wm(e.current),console.debug("THEME_MODAL_OPEN",{pending:e.pending})),e))}updatePending(e,t=!1){this.settingsStore.update(s=>(s.pending&&(e(s.pending),t&&this.applyTheme(s.pending,{preview:!0}),console.debug("THEME_PENDING_UPDATE",{pending:s.pending,applyPreview:t})),s))}confirm(){this.settingsStore.update(e=>(e.pending&&(e.current=wm(e.pending),Zj(this.chartId,e.current),this.applyTheme(e.current,{preview:!1}),this.syncToLegacySystem(e.current),console.debug("THEME_COMMIT",{current:e.current}),e.pending=null),e))}syncToLegacySystem(e){var t,s;try{const i=localStorage.getItem("chart");if(i){const r=JSON.parse(i),a=(s=(t=r.styles)==null?void 0:t.candle)==null?void 0:s.type;if(console.log("🔒 Preserving chart type in syncToLegacySystem:",a),r.styles||(r.styles={}),e.canvas.background.mode==="solid"&&e.canvas.background.solid?(r.styles.backgroundColor=e.canvas.background.solid.color,r.styles.backgroundOpacity=(e.canvas.background.solid.alpha??1)*100,r.styles.backgroundType="solid",delete r.styles.backgroundGradient):e.canvas.background.mode==="gradient"&&e.canvas.background.gradient&&(r.styles.backgroundGradient=e.canvas.background.gradient,r.styles.backgroundType="gradient",delete r.styles.backgroundColor,delete r.styles.backgroundOpacity),e.canvas.grid.mode==="solid"&&e.canvas.grid.solid){r.styles.grid||(r.styles.grid={}),r.styles.grid.horizontal||(r.styles.grid.horizontal={}),r.styles.grid.vertical||(r.styles.grid.vertical={});const l=e.canvas.grid.solid.alpha!==void 0&&e.canvas.grid.solid.alpha!==1?A_(e.canvas.grid.solid.color,e.canvas.grid.solid.alpha):e.canvas.grid.solid.color;r.styles.grid.horizontal.color=l,r.styles.grid.vertical.color=l,r.styles.gridOpacity=(e.canvas.grid.solid.alpha??1)*100,r.styles.gridType="solid",delete r.styles.gridGradient}else e.canvas.grid.mode==="gradient"&&e.canvas.grid.gradient&&(r.styles.gridGradient=e.canvas.grid.gradient,r.styles.gridType="gradient");a&&(r.styles.candle||(r.styles.candle={}),r.styles.candle.type=a,console.log("✅ Restored chart type in syncToLegacySystem:",a)),localStorage.setItem("chart",JSON.stringify(r)),console.debug("LEGACY_SYNC",{syncedStyles:r.styles,preservedChartType:a})}}catch(i){console.error("Failed to sync to legacy system:",i)}}cancel(){this.settingsStore.update(e=>(e.pending&&(this.applyTheme(e.current,{preview:!1}),console.debug("THEME_CANCEL",{reverted_to:e.current}),e.pending=null),e))}reset(){this.settingsStore.update(e=>(e.pending&&(e.pending=wm(e.current),this.applyTheme(e.pending,{preview:!0}),console.debug("THEME_RESET",{pending:e.pending})),e))}applyTheme(e,t={}){const s=zd(this.chart);if(!s){console.log("📊 Chart not available for theme application, storing for later"),t.preview||(this.pendingThemeApplication=e,this.setupChartReadinessTimeout());return}if(!e||!e.canvas){console.warn("Invalid theme configuration, skipping application");return}const i=t.preview||!1;i?this.addPreviewWatermark():this.removePreviewWatermark();try{e.canvas.background&&this.applyBackground(e.canvas.background),i||(e.canvas.grid&&this.applyGrid(e.canvas.grid,s),setTimeout(()=>{this.applyCanvasColorsIfAvailable()},150)),console.debug("THEME_APPLIED",{theme:e.canvas,preview:i,chartId:this.chartId,appliedGrid:!i})}catch(r){console.error("Failed to apply theme:",r)}}applyBackground(e){const t=document.querySelector(".kline-main"),s=document.querySelector(".kline-widget");if(!t&&!s){console.warn("Chart containers not found for background application");return}if(!e){console.warn("Background configuration is null or undefined, skipping");return}let i;if(e.mode==="solid"&&e.solid&&e.solid.color){const r=e.solid.alpha!==void 0?e.solid.alpha:1;i=r!==1?A_(e.solid.color,r):e.solid.color}else e.mode==="gradient"&&e.gradient?i=Xj(e.gradient):(console.warn("Invalid background configuration, using fallback"),i="#070211");console.log("🎨 Applying background:",i),[t,s].forEach(r=>{r&&(r.style.removeProperty("background"),r.style.removeProperty("background-color"),r.offsetHeight,r.style.background=i,r.style.backgroundColor=i,r.style.setProperty("--chart-background-color",i),r.offsetHeight)})}applyGrid(e,t){var a,l;const s=t.getStyles()??{},i=Rt.cloneDeep(s);try{const d=localStorage.getItem("chart");if(d){const v=JSON.parse(d);(l=(a=v.styles)==null?void 0:a.candle)!=null&&l.type&&(i.candle||(i.candle={}),i.candle.type=v.styles.candle.type,console.log("🔒 Preserved chart type in applyGrid:",v.styles.candle.type))}}catch(d){console.warn("Failed to preserve chart type:",d)}let r;if(e.mode==="solid"&&e.solid){const d=e.solid.alpha!==void 0?e.solid.alpha:1;r=d!==1?A_(e.solid.color,d):e.solid.color}else if(e.mode==="gradient"&&e.gradient){const d=e.gradient.stops;if(d.length===1)r=d[0].color;else if(d.length>=2)r=this.blendColors(d[0].color,d[d.length-1].color,.5);else{console.warn("Invalid grid gradient configuration");return}}else{console.warn("Invalid grid configuration");return}console.log("🎨 ThemeManager applying grid color:",r),Rt.set(i,"grid.horizontal.color",r),Rt.set(i,"grid.vertical.color",r),t.setStyles(i),console.log("✅ Applied grid styles directly:",{gridColor:r,gridConfig:i.grid})}blendColors(e,t,s){if(!e.startsWith("#")||!t.startsWith("#"))return e;const i=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16),l=parseInt(t.slice(1,3),16),d=parseInt(t.slice(3,5),16),v=parseInt(t.slice(5,7),16),p=Math.round(i*(1-s)+l*s),_=Math.round(r*(1-s)+d*s),y=Math.round(a*(1-s)+v*s);return`#${p.toString(16).padStart(2,"0")}${_.toString(16).padStart(2,"0")}${y.toString(16).padStart(2,"0")}`}addPreviewWatermark(){this.removePreviewWatermark();const e=document.querySelector(".kline-main");if(!e)return;const t=document.createElement("div");t.id="theme-preview-watermark",t.style.cssText=`
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 1000;
      pointer-events: none;
    `,t.textContent="PREVIEW",e.style.position="relative",e.appendChild(t)}removePreviewWatermark(){const e=document.getElementById("theme-preview-watermark");e&&e.remove()}getCurrentSettings(){return zd(this.settingsStore).current}getPendingSettings(){return zd(this.settingsStore).pending}isModalOpen(){return zd(this.settingsStore).pending!==null}resetToThemeDefaults(e){const t=Wy(this.chartId,e);this.settingsStore.update(s=>({...s,current:t,pending:null})),console.log("🔄 Reset TransactionalThemeManager to theme defaults:",e)}}function Jj(o,e,t){const s=o.target.checked;b(e,j(s)),t({wick:s})}function Qj(o,e,t){const s=o.target.value;b(e,j(s)),t({source:s})}function ez(o,e,t){const s="ATR";b(e,s),t({method:s})}function tz(o,e,t){const s=parseInt(o.target.value||"14",10),i=Math.max(1,isNaN(s)?14:s);b(e,j(i)),t({atrLength:i})}function oz(o,e,t){const s=o.target.value;b(e,j(s)),t({boxSizeMode:s})}function sz(o,e,t){const s=parseFloat(o.target.value||"1"),i=Math.max(1e-4,isNaN(s)?1:s);b(e,j(i)),t({boxSize:i})}function nz(o,e,t){const s=parseInt(o.target.value||"14",10),i=Math.max(1,isNaN(s)?14:s);b(e,j(i)),t({atrLength:i})}function iz(o,e,t){const s=parseInt(o.target.value||"3",10),i=Math.max(1,isNaN(s)?3:s);b(e,j(i)),t({reversalBoxes:i})}function rz(o,e,t){const s=o.target.value;b(e,j(s)),t({upColor:s})}function az(o,e,t){const s=o.target.value;b(e,j(s)),t({downColor:s})}function lz(o,e,t,s,i,r,a,l){b(e,"ATR"),b(t,1),b(s,14),b(i,3),b(r,"#00E6D8"),b(a,"#FF4D4D"),l({boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"})}function cz(o,e,t,s,i,r,a,l,d,v){if(n(e)==="solid"){const p=o.target.getBoundingClientRect();b(t,j({x:p.right+10,y:p.top})),b(s,!0),b(i,!1),b(r,!1),b(a,!1),b(l,!1),b(d,!1),v()}else n(e)==="gradient"&&(b(r,!0),b(s,!1),b(i,!1),b(a,!1),b(l,!1),b(d,!1))}function dz(o,e,t,s,i,r,a,l,d){if(console.log("🔥 Grid picker clicked, type:",n(e)),n(e)==="solid"){const v=o.target.getBoundingClientRect();b(t,j({x:v.right+10,y:v.top})),console.log("🔥 Opening grid color picker at:",n(t)),b(s,!0),b(i,!1),b(r,!1),b(a,!1),b(l,!1),b(d,!1)}else n(e)==="gradient"&&(b(a,!0),b(s,!1),b(i,!1),b(r,!1),b(l,!1),b(d,!1))}function uz(o,e,t,s,i,r,a,l,d){const v=o.target.getBoundingClientRect();b(e,j({x:v.right+10,y:v.top})),b(t,!0),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d()}function pz(o,e,t,s,i,r,a,l,d){const v=o.target.getBoundingClientRect();b(e,j({x:v.right+10,y:v.top})),b(t,!0),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d()}function vz(o,e,t,s,i,r,a,l,d,v){const p=o.target.getBoundingClientRect();b(e,j({x:p.right+10,y:p.top})),b(t,!1),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d(),b(v,!0)}function fz(o,e,t,s,i,r,a,l,d,v){const p=o.target.getBoundingClientRect();b(e,j({x:p.right+10,y:p.top})),b(t,!1),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d(),b(v,!0)}function gz(o,e,t,s,i,r,a,l,d,v){const p=o.target.getBoundingClientRect();b(e,j({x:p.right+10,y:p.top})),b(t,!1),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d(),b(v,!0)}function mz(o,e,t,s,i,r,a,l,d,v){const p=o.target.getBoundingClientRect();b(e,j({x:p.right+10,y:p.top})),b(t,!1),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d(),b(v,!0)}function hz(o,e,t,s,i,r,a,l,d,v){const p=o.target.getBoundingClientRect();b(e,j({x:p.right+10,y:p.top})),b(t,!1),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d(),b(v,!0)}function _z(o,e,t,s,i,r,a,l,d,v){const p=o.target.getBoundingClientRect();b(e,j({x:p.right+10,y:p.top})),b(t,!1),b(s,!1),b(i,!1),b(r,!1),b(a,!1),b(l,!1),d(),b(v,!0)}function yz(o,e,t){b(e,!n(e)),t()}function bz(o,e,t){b(e,!n(e)),t()}function xz(o,e,t){b(e,!n(e)),t()}var wz=(o,e)=>b(e,"canvas"),kz=(o,e)=>b(e,"other"),Sz=(o,e)=>b(e,"candle"),Cz=(o,e)=>b(e,"renko"),Pz=de('<button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Duty AI Renko</button>'),Iz=(o,e)=>b(e,"pnf"),Mz=de('<button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Point & Figure</button>'),Tz=de('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Canvas Settings</h4> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">Background color</label> <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3"><select class="select select-bordered select-sm w-full sm:w-32"><option>Solid</option><option>Gradient</option></select> <button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">Grid color</label> <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3"><select class="select select-bordered select-sm w-full sm:w-32"><option>Solid</option><option>Gradient</option></select> <button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">X-Axis tick text color</label> <div class="flex items-center space-x-3"><button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div> <div class="space-y-3"><label class="text-sm font-medium text-base-content/80">Y-Axis tick text color</label> <div class="flex items-center space-x-3"><button class="w-8 h-8 rounded border-2 border-base-300 cursor-pointer hover:border-primary transition-colors flex-shrink-0"></button></div></div></div>'),Az=(o,e,t)=>e(n(t).key,o.target.value),Lz=de("<option> </option>"),Fz=de('<select class="select select-bordered select-sm w-full sm:w-32 flex-shrink-0"></select>'),Dz=(o,e,t)=>e(n(t).key,o.target.checked),Ez=de('<input type="checkbox" class="toggle toggle-sm flex-shrink-0">'),$z=de('<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-2 space-y-2 sm:space-y-0"><label class="text-sm font-medium text-base-content/80 flex-1"> </label> <!></div>'),jz=de('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Other Settings</h4> <div class="grid grid-cols-1 gap-4"></div></div>'),zz=de('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Candle Color Customization</h4> <div class="space-y-4"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-3 border-b border-base-300"><div class="flex items-center space-x-3 mb-3 sm:mb-0"><input type="checkbox" class="checkbox checkbox-sm"> <label class="text-sm font-medium text-base-content">Body</label></div> <div class="flex space-x-3"><div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bull</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div> <div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bear</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div></div></div> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-3 border-b border-base-300"><div class="flex items-center space-x-3 mb-3 sm:mb-0"><input type="checkbox" class="checkbox checkbox-sm"> <label class="text-sm font-medium text-base-content">Borders</label></div> <div class="flex space-x-3"><div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bull</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div> <div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bear</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div></div></div> <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between py-3"><div class="flex items-center space-x-3 mb-3 sm:mb-0"><input type="checkbox" class="checkbox checkbox-sm"> <label class="text-sm font-medium text-base-content">Wick</label></div> <div class="flex space-x-3"><div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bull</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div> <div class="flex flex-col items-center space-y-1"><span class="text-xs text-base-content/60">Bear</span> <button class="w-8 h-8 rounded border-2 border-base-300 flex-shrink-0"></button></div></div></div></div></div>'),Bz=de('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Duty AI Renko Settings</h4> <div class="space-y-4 p-3 rounded-lg border border-base-300"><div class="flex items-center gap-3"><label class="flex items-center gap-2"><input type="checkbox" class="checkbox checkbox-sm"> <span>Wick</span></label></div> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3"><div class="flex flex-col gap-1"><label class="text-xs opacity-80">Source</label> <select class="select select-bordered select-sm"><option>Close</option><option>Open</option><option>High</option><option>Low</option></select></div> <div class="flex flex-col gap-1"><label class="text-xs opacity-80">Box size assignment method</label> <select class="select select-bordered select-sm" disabled><option>ATR</option></select></div> <div class="flex flex-col gap-1"><label class="text-xs opacity-80">ATR length</label> <input type="number" min="1" class="input input-bordered input-sm"></div></div></div></div>'),Nz=de('<div class="flex flex-col gap-1"><label class="text-xs opacity-80">ATR Length</label> <input type="number" min="1" max="200" step="1" class="input input-bordered input-sm"></div>'),Rz=de('<div class="flex flex-col gap-1"><label class="text-xs opacity-80"> </label> <input type="number" min="0.0001" step="0.1" class="input input-bordered input-sm"></div>'),Oz=de('<div class="space-y-6 pb-6"><h4 class="text-lg font-semibold mb-4">Point & Figure Settings</h4> <div class="space-y-4 p-3 rounded-lg border border-base-300"><div class="grid grid-cols-1 sm:grid-cols-2 gap-3"><div class="flex flex-col gap-1"><label class="text-xs opacity-80">Box Size Mode</label> <select class="select select-bordered select-sm"><option>ATR (Auto-fit)</option><option>Absolute (Price Units)</option><option>Percent (%)</option></select></div> <!></div> <div class="flex flex-col gap-1"><label class="text-xs opacity-80">Reversal Boxes (typical: 3)</label> <input type="number" min="1" max="10" step="1" class="input input-bordered input-sm w-32"></div> <div class="pt-2 border-t border-base-300"><h5 class="text-sm font-medium mb-3">Symbol Colors</h5> <div class="grid grid-cols-2 gap-4"><div class="flex flex-col items-center gap-2"><label class="text-xs opacity-80">Up Column (X)</label> <div class="flex items-center gap-2"><input type="color" class="w-10 h-10 cursor-pointer rounded border border-base-300"> <span class="text-xs font-mono opacity-70"> </span></div></div> <div class="flex flex-col items-center gap-2"><label class="text-xs opacity-80">Down Column (O)</label> <div class="flex items-center gap-2"><input type="color" class="w-10 h-10 cursor-pointer rounded border border-base-300"> <span class="text-xs font-mono opacity-70"> </span></div></div></div></div> <div class="pt-4 border-t border-base-300"><button class="btn btn-sm btn-outline">Reset P&F to Defaults</button></div></div></div>'),Vz=de('<div class="flex flex-col lg:flex-row min-h-[400px] max-h-[70vh] overflow-hidden"><div class="w-full lg:w-48 border-b lg:border-b-0 lg:border-r border-base-300 pb-4 lg:pb-0 lg:pr-4 mb-4 lg:mb-0"><div class="flex lg:flex-col space-x-2 lg:space-x-0 lg:space-y-2 overflow-x-auto lg:overflow-x-visible"><button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Canvas</button> <button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Other Settings</button> <button class="flex-shrink-0 lg:w-full text-left px-4 py-2 rounded-lg transition-colors duration-200">Candle</button> <!> <!></div></div> <div class="flex-1 lg:pl-6 overflow-y-auto"><!></div></div>'),Wz=de("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function Fx(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(d,"$save",t),i=()=>ir(v,"$chart",t),r=()=>ir(l,"$ctx",t);let a=Ss(e,"show",15);const l=Fa("ctx"),d=Fa("save"),v=Fa("chart"),p=new S1("chart-settings",v,"dark");yp(()=>{p.destroy()});let _=oe(!1),y=null;Wi(()=>{var yt,wt,to,mt,Wt;if(a())console.log("🔧 Settings modal OPENED"),console.log("  - Current $save.styles.candle.type:",(wt=(yt=s().styles)==null?void 0:yt.candle)==null?void 0:wt.type),console.log("  - Current chart.getStyles().candle.type:",(Wt=(mt=(to=i())==null?void 0:to.getStyles())==null?void 0:mt.candle)==null?void 0:Wt.type),b(_,!1),p.openModal();else if(!n(_)){console.log("🚫 Settings modal CANCELLED"),y&&(clearTimeout(y),y=null);try{window.__forceApplySavedCanvasColors=!0}catch{}r().applyCanvasColors&&r().applyCanvasColors()}});let w=oe("canvas");const k=new E0;let S=oe(!1),L=oe(!1),T=oe(!1),P=oe(!1),A=oe(j({x:0,y:0})),F=oe(j({x:0,y:0})),B=oe(j({x:0,y:0})),R=oe(j({x:0,y:0})),N=oe(!1),$=oe(!1),V=oe(!1),U=oe(!1),G=oe(!1),Z=oe(!1),le=oe(j({x:0,y:0})),se=oe(j({x:0,y:0})),ie=oe(j({x:0,y:0})),Y=oe(j({x:0,y:0})),K=oe(j({x:0,y:0})),Q=oe(j({x:0,y:0})),q=oe(!1),ce=oe(!1),_e=oe(!1),me=oe(j(Rt.get(s().styles,"backgroundType")||"solid")),Pe=oe(j(Rt.get(s().styles,"gridType")||"solid")),ze=oe(j(Rt.get(s().styles,"backgroundColor")||"#000000")),he=oe(j(Rt.get(s().styles,"grid.horizontal.color")||"#333333")),De=oe(100),ge=oe(100),be=oe(100),$e=oe(100);const Ve=[{key:"candle.priceMark.last.show",label:"Show Last Price",type:"switch",default:!0},{key:"candle.priceMark.high.show",label:"Show High Price",type:"switch",default:!0},{key:"candle.priceMark.low.show",label:"Show Low Price",type:"switch",default:!0},{key:"indicator.lastValueMark.show",label:"Show Indicator Last Value",type:"switch",default:!0},{key:"yAxis.reverse",label:"Reverse Coordinate",type:"switch",default:!1},{key:"grid.show",label:"Grid Show",type:"switch",default:!0}],Ce=new E0;let Je=oe(!0),ye=oe(!0),Ae=oe(!0),ee=oe("#26a69a"),xe=oe("#ef5350"),ke=oe("#26a69a"),He=oe("#ef5350"),Ie=oe("#26a69a"),ne=oe("#ef5350");const J=We(()=>{var yt,wt;return((wt=(yt=s().styles)==null?void 0:yt.candle)==null?void 0:wt.type)==="renko_atr"});let qe=oe(!1),ft=oe("close"),Qe=oe("ATR"),Oe=oe(14);Wi(()=>{var wt,to;if(!a())return;const yt=((to=(wt=s().styles)==null?void 0:wt.candle)==null?void 0:to.renko)||{};b(qe,!!yt.wick),b(ft,j(yt.source||"close")),b(Qe,j(yt.method||"ATR")),b(Oe,j(Math.max(1,(yt.atrLength??14)|0)))}),Wi(()=>{a()&&(n(J)?b(w,j(n(w)==="canvas"||n(w)==="other"?n(w):"renko")):n(w)==="renko"&&b(w,"candle"))});function ct(yt){d.update(wt=>{wt.styles||(wt.styles={}),wt.styles.candle||(wt.styles.candle={});const to=wt.styles.candle;return to.renko||(to.renko={method:"ATR",atrLength:14,source:"close",wick:!1}),to.renko={...to.renko,...yt},wt})}const Lt=We(()=>{var yt,wt;return((wt=(yt=s().styles)==null?void 0:yt.candle)==null?void 0:wt.type)==="point_and_figure"});let It=oe("ATR"),zt=oe(1),pt=oe(14),Mo=oe(3),Xo=oe("#00E6D8"),en=oe("#FF4D4D");Wi(()=>{var wt,to;if(!a())return;const yt=((to=(wt=s().styles)==null?void 0:wt.candle)==null?void 0:to.pnf)||{};b(It,j(yt.boxSizeMode||"ATR")),b(zt,j(Math.max(1e-4,yt.boxSize??1))),b(pt,j(Math.max(1,Math.round(yt.atrLength??14)))),b(Mo,j(Math.max(1,Math.round(yt.reversalBoxes??3)))),b(Xo,j(yt.upColor||"#00E6D8")),b(en,j(yt.downColor||"#FF4D4D"))}),Wi(()=>{a()&&(n(Lt)?b(w,j(n(w)==="canvas"||n(w)==="other"?n(w):"pnf")):n(w)==="pnf"&&b(w,"candle"))});function Fo(yt){d.update(wt=>{wt.styles||(wt.styles={}),wt.styles.candle||(wt.styles.candle={});const to=wt.styles.candle;return to.pnf||(to.pnf={boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"}),to.pnf={...to.pnf,...yt},wt})}let Eo=oe(j(Rt.get(s().styles,"backgroundGradient")||{type:"linear",direction:90,stops:[{position:0,color:"#1a1a1a",opacity:100},{position:100,color:"#4a4a4a",opacity:100}]})),cs=oe(j(Rt.get(s().styles,"gridGradient")||{type:"linear",direction:90,stops:[{position:0,color:"#2a2a2a",opacity:100},{position:100,color:"#3a3a3a",opacity:100}]}));function Zt(yt){if(!yt||!yt.stops)return"";const to=[...yt.stops].sort((mt,Wt)=>mt.position-Wt.position).map(mt=>{const Wt=parseInt(mt.color.slice(1,3),16),vt=parseInt(mt.color.slice(3,5),16),$t=parseInt(mt.color.slice(5,7),16),zo=mt.opacity/100;return`rgba(${Wt}, ${vt}, ${$t}, ${zo}) ${mt.position}%`});return yt.type==="linear"?`linear-gradient(${yt.direction}deg, ${to.join(", ")})`:`radial-gradient(circle, ${to.join(", ")})`}function bs(yt){if(typeof yt=="string"&&yt.startsWith("rgba(")){const wt=yt.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*[\d.]+\)/);if(wt){const to=parseInt(wt[1]),mt=parseInt(wt[2]),Wt=parseInt(wt[3]);return`#${to.toString(16).padStart(2,"0")}${mt.toString(16).padStart(2,"0")}${Wt.toString(16).padStart(2,"0")}`}}return yt}function es(){const yt=s().theme;return{backgroundColor:yt==="dark"?"#070211":"#ffffff",backgroundOpacity:100,gridColor:yt==="dark"?"#081115":"#F3F3F3",gridOpacity:100,xAxisTickTextColor:yt==="dark"?"#ffffff":"#000000",yAxisTickTextColor:yt==="dark"?"#ffffff":"#000000"}}Wi(()=>{a()&&i()&&(console.log("📂 Modal opened - restoring saved values..."),b(_e,!0),k.clear(),rn(),queueMicrotask(()=>{b(_e,!1),console.log("✅ Restoration complete - preview enabled")}))}),Wi(()=>{if(!i()||!a()||n(_e))return;const yt=n(De),wt=n(ze),to=n(me),mt=n(Eo);mt==null||mt.stops,mt==null||mt.type,mt==null||mt.direction;const Wt=document.querySelector(".kline-main"),vt=document.querySelector(".kline-widget");if(to==="solid"){const $t=k.get("backgroundColor")||wt||es().backgroundColor,bo=(k.get("backgroundOpacity")??yt??100)/100,xo=Wr($t,bo);[Wt,vt].forEach(Zo=>{if(Zo){const os=Zo;os.style.removeProperty("background"),os.style.removeProperty("background-color"),os.offsetHeight,os.style.setProperty("background",xo,"important"),os.style.setProperty("background-color",xo,"important"),os.style.setProperty("--chart-background-color",xo),os.offsetHeight}})}else if(to==="gradient"){const $t=k.get("backgroundGradient")||mt;let zo=$t;(!$t||!$t.stops||$t.stops.length===0)&&(zo={type:"linear",direction:90,stops:[{position:0,color:"#1a1a1a",opacity:100},{position:100,color:"#4a4a4a",opacity:100}]},k.set("backgroundGradient",zo));const bo=zo.css||Zt(zo);[Wt,vt].forEach(xo=>{if(xo){const Zo=xo;Zo.style.removeProperty("background"),Zo.style.removeProperty("background-color"),Zo.offsetHeight,Zo.style.setProperty("background",bo,"important"),Zo.style.setProperty("background-color",bo,"important"),Zo.style.setProperty("--chart-background-color",bo),Zo.offsetHeight}})}}),Wi(()=>{var Wt,vt,$t,zo;if(!i()||!a()||n(_e))return;const yt=n(ge),wt=n(he),to=n(Pe),mt=n(cs);if(mt==null||mt.stops,mt==null||mt.type,mt==null||mt.direction,console.log("🔄 Grid effect triggered:",{gridColorType:to,gridColor:wt,gridOpacity:yt}),to==="solid"){const bo=k.get("gridColor")||wt||es().gridColor,xo=k.get("gridOpacity")??yt??100,Zo=Wr(bo,xo/100);console.log("🎨 Applying solid grid color via effect:",Zo);const os=i().getStyles()??{},ri=Rt.cloneDeep(os);(vt=(Wt=s().styles)==null?void 0:Wt.candle)!=null&&vt.type&&Rt.set(ri,"candle.type",s().styles.candle.type);const vn=Rt.get(os,"grid.show",!0);Rt.set(ri,"grid.show",vn),Rt.set(ri,"grid.horizontal.show",vn),Rt.set(ri,"grid.horizontal.color",Zo),Rt.set(ri,"grid.vertical.show",vn),Rt.set(ri,"grid.vertical.color",Zo),i().setStyles(ri)}else if(to==="gradient"){const bo=k.get("gridGradient")||mt;if(bo&&bo.stops&&bo.stops.length>0){const xo=bo.stops[0],Zo=bo.stops[bo.stops.length-1],os=qa(xo.color,Zo.color,.5);console.log("🎨 Applying gradient grid color via effect:",os);const ri=i().getStyles()??{},vn=Rt.cloneDeep(ri);(zo=($t=s().styles)==null?void 0:$t.candle)!=null&&zo.type&&Rt.set(vn,"candle.type",s().styles.candle.type);const sr=Rt.get(ri,"grid.show",!0);Rt.set(vn,"grid.show",sr),Rt.set(vn,"grid.horizontal.show",sr),Rt.set(vn,"grid.horizontal.color",os),Rt.set(vn,"grid.vertical.show",sr),Rt.set(vn,"grid.vertical.color",os),i().setStyles(vn)}}});function rn(){const yt=es();console.log("🔄 Restoring saved values...",{backgroundType:Rt.get(s().styles,"backgroundType"),gridType:Rt.get(s().styles,"gridType")});const wt=Rt.get(s().styles,"backgroundType")||"solid";if(b(me,j(wt)),wt==="solid"){const Ko=Rt.get(s().styles,"backgroundColor")||yt.backgroundColor,Hn=Rt.get(s().styles,"backgroundOpacity")||yt.backgroundOpacity,ji=bs(Ko);b(ze,j(ji)),b(De,j(Hn)),k.set("backgroundColor",ji),k.set("backgroundOpacity",Hn),console.log("✅ Restored solid BG:",ji,"opacity:",Hn)}else if(wt==="gradient"){const Ko=Rt.get(s().styles,"backgroundGradient");Ko&&(b(Eo,j({...Ko})),k.set("backgroundGradient",Ko),console.log("✅ Restored gradient BG:",Ko))}const to=Rt.get(s().styles,"gridType")||"solid";if(b(Pe,j(to)),to==="solid"){const Ko=Rt.get(s().styles,"grid.horizontal.color")||Rt.get(s().styles,"grid.vertical.color")||yt.gridColor,Hn=Rt.get(s().styles,"gridOpacity")||yt.gridOpacity,ji=bs(Ko);b(he,j(ji)),b(ge,j(Hn)),k.set("gridColor",ji),k.set("gridOpacity",Hn),console.log("✅ Restored solid Grid:",ji,"opacity:",Hn)}else if(to==="gradient"){const Ko=Rt.get(s().styles,"gridGradient");Ko&&(b(cs,j({...Ko})),k.set("gridGradient",Ko),console.log("✅ Restored gradient Grid:",Ko))}const mt=Rt.get(s().styles,"xAxis.tickText.color")||yt.xAxisTickTextColor,Wt=Rt.get(s().styles,"xAxis.tickText.opacity")||100,vt=bs(mt);b(be,j(Wt)),k.set("xAxisTickTextColor",vt),k.set("xAxisTickTextOpacity",Wt);const $t=Rt.get(s().styles,"yAxis.tickText.color")||yt.yAxisTickTextColor,zo=Rt.get(s().styles,"yAxis.tickText.opacity")||100,bo=bs($t);b($e,j(zo)),k.set("yAxisTickTextColor",bo),k.set("yAxisTickTextOpacity",zo);try{if(i()&&typeof i().getStyles=="function"){const Ko=i().getStyles()??{},Hn=Rt.get(Ko,"xAxis.tickText.color"),ji=Rt.get(Ko,"yAxis.tickText.color");if(Hn){const zn=bs(Hn);k.set("xAxisTickTextColor",zn)}if(ji){const zn=bs(ji);k.set("yAxisTickTextColor",zn)}}}catch(Ko){console.warn("Failed to read live axis styles from chart:",Ko)}const xo=Rt.get(s().styles,"candle.bar.upColor")||"#26a69a",Zo=Rt.get(s().styles,"candle.bar.downColor")||"#ef5350",os=Rt.get(s().styles,"candle.bar.upBorderColor")||"#26a69a",ri=Rt.get(s().styles,"candle.bar.downBorderColor")||"#ef5350",vn=Rt.get(s().styles,"candle.bar.upWickColor")||"#26a69a",sr=Rt.get(s().styles,"candle.bar.downWickColor")||"#ef5350";b(ee,j(xo)),b(xe,j(Zo)),b(ke,j(os)),b(He,j(ri)),b(Ie,j(vn)),b(ne,j(sr)),Ve.forEach(Ko=>{const Hn=Rt.get(s().styles,Ko.key);Hn!==void 0?Ce.set(Ko.key,Hn):Ce.set(Ko.key,Ko.default)})}function wr(yt){if(b(ze,j(yt.detail)),k.set("backgroundColor",yt.detail),n(me)==="solid"){const wt=n(De)/100,to=Wr(yt.detail,wt),mt=document.querySelector(".kline-main"),Wt=document.querySelector(".kline-widget");[mt,Wt].forEach(vt=>{if(vt){const $t=vt;$t.style.removeProperty("background"),$t.style.removeProperty("background-color"),$t.style.removeProperty("background-image"),$t.offsetHeight,$t.style.setProperty("background",to,"important"),$t.style.setProperty("background-color",to,"important"),$t.style.setProperty("--chart-background-color",to),$t.offsetHeight}})}}function rr(yt){if(b(De,j(yt.detail)),k.set("backgroundOpacity",yt.detail),n(me)==="solid"){const wt=k.get("backgroundColor")||n(ze)||es().backgroundColor,to=yt.detail/100,mt=Wr(wt,to),Wt=document.querySelector(".kline-main"),vt=document.querySelector(".kline-widget");[Wt,vt].forEach($t=>{if($t){const zo=$t;zo.style.removeProperty("background"),zo.style.removeProperty("background-color"),zo.offsetHeight,zo.style.setProperty("background",mt,"important"),zo.style.setProperty("background-color",mt,"important"),zo.style.setProperty("--chart-background-color",mt),zo.offsetHeight}})}}function ar(yt){var vt,$t;if(console.log("🎨 Grid color changed to:",yt.detail),b(he,j(yt.detail)),k.set("gridColor",yt.detail),!i()){console.warn("⚠️ No chart available for grid color preview");return}const wt=Wr(yt.detail,n(ge)/100);console.log("🎨 Applying grid color:",wt);const to=i().getStyles()??{},mt=Rt.cloneDeep(to);($t=(vt=s().styles)==null?void 0:vt.candle)!=null&&$t.type&&Rt.set(mt,"candle.type",s().styles.candle.type);const Wt=Rt.get(to,"grid.show",!0);Rt.set(mt,"grid.show",Wt),Rt.set(mt,"grid.horizontal.show",Wt),Rt.set(mt,"grid.horizontal.color",wt),Rt.set(mt,"grid.vertical.show",Wt),Rt.set(mt,"grid.vertical.color",wt),console.log("🎨 New grid styles:",mt.grid);try{i().setStyles(mt),console.log("✅ Grid styles applied successfully")}catch(zo){console.error("❌ Failed to apply grid styles:",zo)}}function jr(yt){var $t,zo;if(console.log("🎨 Grid opacity changed to:",yt.detail),b(ge,j(yt.detail)),k.set("gridOpacity",yt.detail),!i()){console.warn("⚠️ No chart available for grid opacity preview");return}const wt=k.get("gridColor")||n(he)||es().gridColor,to=Wr(wt,yt.detail/100);console.log("🎨 Applying grid opacity:",to);const mt=i().getStyles()??{},Wt=Rt.cloneDeep(mt);(zo=($t=s().styles)==null?void 0:$t.candle)!=null&&zo.type&&Rt.set(Wt,"candle.type",s().styles.candle.type);const vt=Rt.get(mt,"grid.show",!0);Rt.set(Wt,"grid.show",vt),Rt.set(Wt,"grid.horizontal.show",vt),Rt.set(Wt,"grid.horizontal.color",to),Rt.set(Wt,"grid.vertical.show",vt),Rt.set(Wt,"grid.vertical.color",to),console.log("🎨 New grid styles:",Wt.grid);try{i().setStyles(Wt),console.log("✅ Grid opacity applied successfully")}catch(bo){console.error("❌ Failed to apply grid opacity:",bo)}}function ii(yt){if(k.set("xAxisTickTextColor",yt.detail),i()){const wt=i().getStyles()??{},to=Rt.cloneDeep(wt);Rt.set(to,"xAxis.tickText.color",yt.detail);const mt=al(to);i().setStyles(mt)}}function Xa(yt){if(k.set("yAxisTickTextColor",yt.detail),i()){const wt=i().getStyles()??{},to=Rt.cloneDeep(wt);Rt.set(to,"yAxis.tickText.color",yt.detail);const mt=al(to);i().setStyles(mt)}}function Ja(yt){if(b(be,j(yt.detail)),k.set("xAxisTickTextOpacity",yt.detail),i()){const wt=i().getStyles()??{},to=Rt.cloneDeep(wt),mt=k.get("xAxisTickTextColor")||es().xAxisTickTextColor,Wt=yt.detail/100,vt=Wr(mt,Wt);Rt.set(to,"xAxis.tickText.color",vt);const $t=al(to);i().setStyles($t)}}function Va(yt){if(b($e,j(yt.detail)),k.set("yAxisTickTextOpacity",yt.detail),i()){const wt=i().getStyles()??{},to=Rt.cloneDeep(wt),mt=k.get("yAxisTickTextColor")||es().yAxisTickTextColor,Wt=yt.detail/100,vt=Wr(mt,Wt);Rt.set(to,"yAxis.tickText.color",vt);const $t=al(to);i().setStyles($t)}}function Wa(yt){if(b(Eo,j({...yt.detail})),k.set("backgroundGradient",n(Eo)),n(me)==="gradient"){const wt=document.querySelector(".kline-main"),to=document.querySelector(".kline-widget"),mt=Zt(n(Eo));[wt,to].forEach(Wt=>{if(Wt){const vt=Wt;vt.style.removeProperty("background"),vt.style.removeProperty("background-color"),vt.offsetHeight,vt.style.setProperty("background",mt,"important"),vt.style.setProperty("background-color",mt,"important"),vt.style.setProperty("--chart-background-color",mt),vt.offsetHeight}})}}function Qa(yt){var wt,to;if(b(cs,j({...yt.detail})),k.set("gridGradient",n(cs)),i()&&n(Pe)==="gradient"){const mt=yt.detail.stops[0],Wt=yt.detail.stops[yt.detail.stops.length-1],vt=qa(mt.color,Wt.color,.5),$t=i().getStyles()??{},zo=Rt.cloneDeep($t);(to=(wt=s().styles)==null?void 0:wt.candle)!=null&&to.type&&Rt.set(zo,"candle.type",s().styles.candle.type),Rt.set(zo,"grid.horizontal.color",vt),Rt.set(zo,"grid.vertical.color",vt);const bo=al(zo);i().setStyles(bo)}}function qa(yt,wt,to){const mt=yt.replace("#",""),Wt=wt.replace("#",""),vt=parseInt(mt.substr(0,2),16),$t=parseInt(mt.substr(2,2),16),zo=parseInt(mt.substr(4,2),16),bo=parseInt(Wt.substr(0,2),16),xo=parseInt(Wt.substr(2,2),16),Zo=parseInt(Wt.substr(4,2),16),os=Math.round(vt*(1-to)+bo*to),ri=Math.round($t*(1-to)+xo*to),vn=Math.round(zo*(1-to)+Zo*to);return`#${os.toString(16).padStart(2,"0")}${ri.toString(16).padStart(2,"0")}${vn.toString(16).padStart(2,"0")}`}function Kl(yt,wt){var $t,zo,bo;const to=($t=i())==null?void 0:$t.getStyles(),mt=Rt.get(to,yt);if(yt==="yAxis.reverse")try{(zo=i())==null||zo.setPaneOptions({axis:{reverse:wt}}),d.update(xo=>(Rt.set(xo.styles,yt,wt),xo)),Ce.set(yt,wt);return}catch(xo){console.warn("setPaneOptions not available, falling back to styles:",xo)}else if(yt==="yAxis.type"){console.warn("yAxis.type is not supported in klinecharts v10");return}if(mt==wt)return;Ce.set(yt,wt),d.update(xo=>(Rt.set(xo.styles,yt,wt),xo));const Wt=Ul(s().theme),vt=Rt.merge({},Wt,s().styles);(bo=i())==null||bo.setStyles(al(vt))}function ll(){let yt=i();if(!yt)return;const wt=yt.getStyles()??{};Ve.forEach(to=>{const mt=Rt.get(wt,to.key);to.key==="yAxis.reverse"?Ce.set(to.key,mt||!1):Ce.set(to.key,mt??to.default)})}function Wr(yt,wt){const to=yt.replace("#",""),mt=parseInt(to.substr(0,2),16),Wt=parseInt(to.substr(2,2),16),vt=parseInt(to.substr(4,2),16);return`rgba(${mt}, ${Wt}, ${vt}, ${wt})`}function Ca(){b(N,!1),b($,!1),b(V,!1),b(U,!1),b(G,!1),b(Z,!1)}function vl(yt){b(ee,j(yt.detail)),pe()}function ml(yt){b(xe,j(yt.detail)),pe()}function Sl(yt){b(ke,j(yt.detail)),pe()}function el(yt){b(He,j(yt.detail)),pe()}function or(yt){b(Ie,j(yt.detail)),pe()}function tc(yt){b(ne,j(yt.detail)),pe()}function pe(){y&&clearTimeout(y),y=setTimeout(()=>{var mt,Wt;if(!i())return;const yt=i().getStyles()??{},wt=Rt.cloneDeep(yt);(Wt=(mt=s().styles)==null?void 0:mt.candle)!=null&&Wt.type&&Rt.set(wt,"candle.type",s().styles.candle.type),n(Je)&&(Rt.set(wt,"candle.bar.upColor",n(ee)),Rt.set(wt,"candle.bar.downColor",n(xe))),n(ye)&&(Rt.set(wt,"candle.bar.upBorderColor",n(ke)),Rt.set(wt,"candle.bar.downBorderColor",n(He))),n(Ae)&&(Rt.set(wt,"candle.bar.upWickColor",n(Ie)),Rt.set(wt,"candle.bar.downWickColor",n(ne)));const to=al(wt);i().setStyles(to),y=null},16)}function rt(yt){var wt,to;if(yt==="confirm"){console.log("🔧 CONFIRM CLICKED - Using theme manager"),p.updatePending(mt=>{if(n(me)==="solid"){const Wt=k.get("backgroundColor")||n(ze),vt=k.get("backgroundOpacity")??n(De);mt.canvas.background.mode="solid",mt.canvas.background.solid={color:Wt,alpha:vt/100},delete mt.canvas.background.gradient}else if(n(me)==="gradient"){const Wt=k.get("backgroundGradient")||n(Eo);mt.canvas.background.mode="gradient",mt.canvas.background.gradient=Wt,delete mt.canvas.background.solid}if(n(Pe)==="solid"){const Wt=k.get("gridColor")||n(he),vt=k.get("gridOpacity")??n(ge);mt.canvas.grid.mode="solid",mt.canvas.grid.solid={color:Wt,alpha:vt/100},delete mt.canvas.grid.gradient}else if(n(Pe)==="gradient"){const Wt=k.get("gridGradient")||n(cs);mt.canvas.grid.mode="gradient",mt.canvas.grid.gradient=Wt,delete mt.canvas.grid.solid}}),d.update(mt=>{var vt,$t,zo,bo,xo,Zo;mt.styles||(mt.styles={}),mt.styles.candle||(mt.styles.candle={}),mt.styles.candle.bar||(mt.styles.candle.bar={}),console.log("🎨 Saving settings - Background Type:",n(me)),console.log("🎨 Saving settings - Grid Type:",n(Pe));const Wt=($t=(vt=mt.styles)==null?void 0:vt.candle)==null?void 0:$t.type;if(Wt&&console.log("🔒 Preserving chart type:",Wt),n(me)==="solid"){const os=k.get("backgroundColor")||n(ze),ri=k.get("backgroundOpacity")??n(De);console.log("🎨 Solid BG:",{bgColor:os,bgOpacity:ri}),os&&(mt.styles.backgroundColor=os,mt.styles.backgroundOpacity=ri,mt.styles.backgroundType="solid",delete mt.styles.backgroundGradient)}else if(n(me)==="gradient"){const os=k.get("backgroundGradient")||n(Eo);console.log("🎨 Gradient BG:",os),os&&os.stops&&os.stops.length>0?(mt.styles.backgroundGradient=os,mt.styles.backgroundType="gradient",delete mt.styles.backgroundColor,delete mt.styles.backgroundOpacity,console.log("✅ Gradient background saved to $save.styles")):console.warn("⚠️ Invalid gradient data:",os)}if(n(Pe)==="solid"){const os=k.get("gridColor")||n(he),ri=k.get("gridOpacity")??100;console.log("🎨 Solid Grid:",{gridColor:os,gridOpacity:ri}),os&&(mt.styles.grid||(mt.styles.grid={}),mt.styles.grid.horizontal||(mt.styles.grid.horizontal={}),mt.styles.grid.vertical||(mt.styles.grid.vertical={}),mt.styles.grid.horizontal.color=os,mt.styles.grid.vertical.color=os,mt.styles.gridOpacity=ri,mt.styles.gridType="solid",delete mt.styles.gridGradient)}else if(n(Pe)==="gradient"){const os=k.get("gridGradient")||n(cs);console.log("🎨 Gradient Grid:",os),os&&os.stops&&os.stops.length>0?(mt.styles.gridGradient=os,mt.styles.gridType="gradient",(bo=(zo=mt.styles.grid)==null?void 0:zo.horizontal)==null||delete bo.color,(Zo=(xo=mt.styles.grid)==null?void 0:xo.vertical)==null||delete Zo.color,delete mt.styles.gridOpacity,console.log("✅ Gradient grid saved to $save.styles")):console.warn("⚠️ Invalid grid gradient data:",os)}try{const os=k.get("xAxisTickTextColor")||es().xAxisTickTextColor,ri=k.get("xAxisTickTextOpacity")??100,vn=Wr(os,ri/100);Rt.set(mt.styles,"xAxis.tickText.color",vn),Rt.set(mt.styles,"xAxis.tickText.opacity",ri);const sr=k.get("yAxisTickTextColor")||es().yAxisTickTextColor,Ko=k.get("yAxisTickTextOpacity")??100,Hn=Wr(sr,Ko/100);Rt.set(mt.styles,"yAxis.tickText.color",Hn),Rt.set(mt.styles,"yAxis.tickText.opacity",Ko)}catch(os){console.warn("Failed to persist axis tick text colors:",os)}try{const os=mt.styles.candle.bar;n(Je)&&(os.upColor=n(ee),os.downColor=n(xe)),n(ye)&&(os.upBorderColor=n(ke),os.downBorderColor=n(He)),n(Ae)&&(os.upWickColor=n(Ie),os.downWickColor=n(ne))}catch(os){console.warn("Failed to persist candle colors to $save.styles:",os)}return Wt&&mt.styles.candle&&(mt.styles.candle.type=Wt,console.log("✅ Restored chart type:",Wt)),mt}),p.confirm(),b(_,!0);try{window.__forceApplySavedCanvasColors=!0}catch{}r().applyCanvasColors&&r().applyCanvasColors(),a(!1)}else if(yt==="reset"){console.log("🔄 RESET CLICKED - Using theme manager"),p.reset();const mt=es();b(me,"solid"),b(De,j(mt.backgroundOpacity)),b(Pe,"solid"),b(ge,j(mt.gridOpacity)),b(be,100),b($e,100),b(Je,!0),b(ye,!0),b(Ae,!0),b(ee,"#26a69a"),b(xe,"#ef5350"),b(ke,"#26a69a"),b(He,"#ef5350"),b(Ie,"#26a69a"),b(ne,"#ef5350");try{const Wt=es();if(d.update(vt=>{vt.styles||(vt.styles={}),vt.styles.backgroundType="solid",vt.styles.backgroundColor=Wt.backgroundColor,vt.styles.backgroundOpacity=Wt.backgroundOpacity,delete vt.styles.backgroundGradient,vt.styles.grid||(vt.styles.grid={}),vt.styles.grid.horizontal||(vt.styles.grid.horizontal={}),vt.styles.grid.vertical||(vt.styles.grid.vertical={}),vt.styles.gridType="solid",vt.styles.gridOpacity=Wt.gridOpacity,vt.styles.grid.horizontal.color=Wt.gridColor,vt.styles.grid.vertical.color=Wt.gridColor,delete vt.styles.gridGradient;const $t=Wt.xAxisTickTextColor,zo=Wt.yAxisTickTextColor,bo=Wr($t,1),xo=Wr(zo,1);Rt.set(vt.styles,"xAxis.tickText.color",bo),Rt.set(vt.styles,"xAxis.tickText.opacity",100),Rt.set(vt.styles,"yAxis.tickText.color",xo),Rt.set(vt.styles,"yAxis.tickText.opacity",100),vt.styles.candle||(vt.styles.candle={}),vt.styles.candle.bar||(vt.styles.candle.bar={});const Zo=vt.styles.candle.bar;return Zo.upColor=n(ee),Zo.downColor=n(xe),Zo.upBorderColor=n(ke),Zo.downBorderColor=n(He),Zo.upWickColor=n(Ie),Zo.downWickColor=n(ne),vt}),i()){const vt=Ul(s().theme),$t=Rt.merge({},vt,s().styles);(to=(wt=s().styles)==null?void 0:wt.candle)!=null&&to.type&&Rt.set($t,"candle.type",s().styles.candle.type);const zo=es().xAxisTickTextColor,bo=es().yAxisTickTextColor,xo=Wr(zo,1),Zo=Wr(bo,1);Rt.set($t,"xAxis.tickText.color",xo),Rt.set($t,"yAxis.tickText.color",Zo);const os=al($t);i().setStyles(os);try{const ri=document.querySelector(".kline-main"),vn=document.querySelector(".kline-widget");[ri,vn].forEach(sr=>{if(sr){const Ko=sr;Ko.style.removeProperty("background"),Ko.style.removeProperty("background-color"),Ko.style.removeProperty("background-image"),Ko.style.removeProperty("--chart-background-color")}})}catch{}try{window.__forceApplySavedCanvasColors=!0}catch{}r().applyCanvasColors&&r().applyCanvasColors()}}catch(Wt){console.warn("Failed to apply default candle colors on reset:",Wt)}ll(),k.clear(),k.set("backgroundColor",mt.backgroundColor),k.set("backgroundOpacity",mt.backgroundOpacity),k.set("gridColor",mt.gridColor),k.set("gridOpacity",mt.gridOpacity),k.set("xAxisTickTextColor",mt.xAxisTickTextColor),k.set("xAxisTickTextOpacity",100),k.set("yAxisTickTextColor",mt.yAxisTickTextColor),k.set("yAxisTickTextOpacity",100)}else console.log("🚫 CANCEL CLICKED - Using theme manager"),p.cancel(),a(!1);b(S,!1),b(L,!1),b(T,!1),b(P,!1),b(q,!1),b(ce,!1),Ca()}var Ft=Wz(),Qt=_t(Ft);Pu(Qt,{title:"Chart Setting",width:"min(90vw, 700px)",get show(){return a()},set show(yt){a(yt)},get theme(){return s().theme},click:rt,buttons:["confirm","reset"],children:(yt,wt)=>{var to=Vz(),mt=g(to),Wt=g(mt),vt=g(Wt);vt.__click=[wz,w];var $t=u(vt,2);$t.__click=[kz,w];var zo=u($t,2);zo.__click=[Sz,w];var bo=u(zo,2);Se(bo,()=>n(J),ri=>{var vn=Pz();vn.__click=[Cz,w],we(()=>{Sn(vn,"bg-primary",n(w)==="renko"),Sn(vn,"text-primary-content",n(w)==="renko"),Sn(vn,"hover:bg-base-200",n(w)!=="renko")}),O(ri,vn)});var xo=u(bo,2);Se(xo,()=>n(Lt),ri=>{var vn=Mz();vn.__click=[Iz,w],we(()=>{Sn(vn,"bg-primary",n(w)==="pnf"),Sn(vn,"text-primary-content",n(w)==="pnf"),Sn(vn,"hover:bg-base-200",n(w)!=="pnf")}),O(ri,vn)}),f(Wt),f(mt);var Zo=u(mt,2),os=g(Zo);Se(os,()=>n(w)==="canvas",ri=>{var vn=Tz(),sr=u(g(vn),2),Ko=u(g(sr),2),Hn=g(Ko),ji=g(Hn);ji.value=(ji.__value="solid")==null?"":"solid";var zn=u(ji);zn.value=(zn.__value="gradient")==null?"":"gradient",f(Hn);var Vs=u(Hn,2);const Bn=We(()=>{var ht;return`background: ${(n(me)==="gradient"?((ht=k.get("backgroundGradient"))==null?void 0:ht.css)||Zt(n(Eo))||"linear-gradient(0deg, #ffffff 0%, #000000 100%)":k.get("backgroundColor")||es().backgroundColor)??""}`});Vs.__click=[cz,me,A,S,L,q,ce,T,P,Ca],f(Ko),f(sr);var tr=u(sr,2),lr=u(g(tr),2),Ui=g(lr),_a=g(Ui);_a.value=(_a.__value="solid")==null?"":"solid";var qi=u(_a);qi.value=(qi.__value="gradient")==null?"":"gradient",f(Ui);var ai=u(Ui,2);const cr=We(()=>{var ht;return`background: ${(n(Pe)==="gradient"?((ht=k.get("gridGradient"))==null?void 0:ht.css)||Zt(n(cs))||"linear-gradient(0deg, #f3f3f3 0%, #1c1c1c 100%)":k.get("gridColor")||n(he)||es().gridColor)??""}`});ai.__click=[dz,Pe,F,L,S,q,ce,T,P],f(lr),f(tr);var Dn=u(tr,2),kr=u(g(Dn),2),Me=g(kr);const Xe=We(()=>`background: ${(k.get("xAxisTickTextColor")||es().xAxisTickTextColor)??""}`);Me.__click=[uz,B,T,S,L,q,ce,P,Ca],f(kr),f(Dn);var X=u(Dn,2),Le=u(g(X),2),nt=g(Le);const et=We(()=>`background: ${(k.get("yAxisTickTextColor")||es().yAxisTickTextColor)??""}`);nt.__click=[pz,R,P,S,L,q,ce,T,Ca],f(Le),f(X),f(vn),we(()=>{St(Vs,"style",n(Bn)),St(ai,"style",n(cr)),St(Me,"style",n(Xe)),St(nt,"style",n(et))}),Bo(Hn,()=>n(me),ht=>b(me,ht)),Bo(Ui,()=>n(Pe),ht=>b(Pe,ht)),O(ri,vn)},ri=>{var vn=Xt(),sr=_t(vn);Se(sr,()=>n(w)==="other",Ko=>{var Hn=jz(),ji=u(g(Hn),2);Ns(ji,21,()=>Ve,dn,(zn,Vs)=>{var Bn=$z(),tr=g(Bn),lr=g(tr,!0);f(tr);var Ui=u(tr,2);Se(Ui,()=>n(Vs).type==="select",_a=>{var qi=Fz();Km(qi,()=>Ce.get(n(Vs).key)??n(Vs).default);var ai;qi.__change=[Az,Kl,Vs],Ns(qi,21,()=>n(Vs).options||[],dn,(cr,Dn)=>{var kr=Lz(),Me={},Xe=g(kr,!0);f(kr),we(()=>{Me!==(Me=n(Dn).value)&&(kr.value=(kr.__value=n(Dn).value)==null?"":n(Dn).value),Ye(Xe,n(Dn).label)}),O(cr,kr)}),f(qi),we(()=>{ai!==(ai=Ce.get(n(Vs).key)??n(Vs).default)&&(qi.value=(qi.__value=Ce.get(n(Vs).key)??n(Vs).default)==null?"":Ce.get(n(Vs).key)??n(Vs).default,pf(qi,Ce.get(n(Vs).key)??n(Vs).default))}),O(_a,qi)},_a=>{var qi=Xt(),ai=_t(qi);Se(ai,()=>n(Vs).type==="switch",cr=>{var Dn=Ez();Vt(Dn),we(()=>tp(Dn,Ce.get(n(Vs).key)??n(Vs).default)),Dn.__change=[Dz,Kl,Vs],O(cr,Dn)},null,!0),O(_a,qi)}),f(Bn),we(()=>Ye(lr,n(Vs).label)),O(zn,Bn)}),f(ji),f(Hn),O(Ko,Hn)},Ko=>{var Hn=Xt(),ji=_t(Hn);Se(ji,()=>n(w)==="candle",zn=>{var Vs=zz(),Bn=u(g(Vs),2),tr=g(Bn),lr=g(tr),Ui=g(lr);Vt(Ui),Ui.__change=[yz,Je,pe],un(2),f(lr);var _a=u(lr,2),qi=g(_a),ai=u(g(qi),2);ai.__click=[vz,le,S,L,T,P,q,ce,Ca,N],f(qi);var cr=u(qi,2),Dn=u(g(cr),2);Dn.__click=[fz,se,S,L,T,P,q,ce,Ca,$],f(cr),f(_a),f(tr);var kr=u(tr,2),Me=g(kr),Xe=g(Me);Vt(Xe),Xe.__change=[bz,ye,pe],un(2),f(Me);var X=u(Me,2),Le=g(X),nt=u(g(Le),2);nt.__click=[gz,ie,S,L,T,P,q,ce,Ca,V],f(Le);var et=u(Le,2),ht=u(g(et),2);ht.__click=[mz,Y,S,L,T,P,q,ce,Ca,U],f(et),f(X),f(kr);var uo=u(kr,2),ut=g(uo),Jt=g(ut);Vt(Jt),Jt.__change=[xz,Ae,pe],un(2),f(ut);var fo=u(ut,2),lo=g(fo),so=u(g(lo),2);so.__click=[hz,K,S,L,T,P,q,ce,Ca,G],f(lo);var ko=u(lo,2),ts=u(g(ko),2);ts.__click=[_z,Q,S,L,T,P,q,ce,Ca,Z],f(ko),f(fo),f(uo),f(Bn),f(Vs),we(()=>{St(ai,"style",`background-color: ${n(ee)??""}`),ai.disabled=!n(Je),Sn(ai,"opacity-50",!n(Je)),St(Dn,"style",`background-color: ${n(xe)??""}`),Dn.disabled=!n(Je),Sn(Dn,"opacity-50",!n(Je)),St(nt,"style",`background-color: ${n(ke)??""}`),nt.disabled=!n(ye),Sn(nt,"opacity-50",!n(ye)),St(ht,"style",`background-color: ${n(He)??""}`),ht.disabled=!n(ye),Sn(ht,"opacity-50",!n(ye)),St(so,"style",`background-color: ${n(Ie)??""}`),so.disabled=!n(Ae),Sn(so,"opacity-50",!n(Ae)),St(ts,"style",`background-color: ${n(ne)??""}`),ts.disabled=!n(Ae),Sn(ts,"opacity-50",!n(Ae))}),Bu(Ui,()=>n(Je),Xn=>b(Je,Xn)),Bu(Xe,()=>n(ye),Xn=>b(ye,Xn)),Bu(Jt,()=>n(Ae),Xn=>b(Ae,Xn)),O(zn,Vs)},zn=>{var Vs=Xt(),Bn=_t(Vs);Se(Bn,()=>n(w)==="renko",tr=>{var lr=Bz(),Ui=u(g(lr),2),_a=g(Ui),qi=g(_a),ai=g(qi);Vt(ai),ai.__change=[Jj,qe,ct],un(2),f(qi),f(_a);var cr=u(_a,2),Dn=g(cr),kr=u(g(Dn),2);kr.__change=[Qj,ft,ct];var Me=g(kr);Me.value=(Me.__value="close")==null?"":"close";var Xe=u(Me);Xe.value=(Xe.__value="open")==null?"":"open";var X=u(Xe);X.value=(X.__value="high")==null?"":"high";var Le=u(X);Le.value=(Le.__value="low")==null?"":"low",f(kr),f(Dn);var nt=u(Dn,2),et=u(g(nt),2);et.__change=[ez,Qe,ct];var ht=g(et);ht.value=(ht.__value="ATR")==null?"":"ATR",f(et),f(nt);var uo=u(nt,2),ut=u(g(uo),2);Vt(ut),ut.__input=[tz,Oe,ct],f(uo),f(cr),f(Ui),f(lr),we(()=>{tp(ai,n(qe)),Vu(ut,n(Oe))}),Bo(kr,()=>n(ft),Jt=>b(ft,Jt)),Bo(et,()=>n(Qe),Jt=>b(Qe,Jt)),O(tr,lr)},tr=>{var lr=Xt(),Ui=_t(lr);Se(Ui,()=>n(w)==="pnf",_a=>{var qi=Oz(),ai=u(g(qi),2),cr=g(ai),Dn=g(cr),kr=u(g(Dn),2);kr.__change=[oz,It,Fo];var Me=g(kr);Me.value=(Me.__value="ATR")==null?"":"ATR";var Xe=u(Me);Xe.value=(Xe.__value="absolute")==null?"":"absolute";var X=u(Xe);X.value=(X.__value="percent")==null?"":"percent",f(kr),f(Dn);var Le=u(Dn,2);Se(Le,()=>n(It)==="ATR",ds=>{var Cs=Nz(),ns=u(g(Cs),2);Vt(ns),ns.__input=[nz,pt,Fo],f(Cs),we(()=>Vu(ns,n(pt))),O(ds,Cs)},ds=>{var Cs=Rz(),ns=g(Cs),Js=g(ns);f(ns);var Nn=u(ns,2);Vt(Nn),Nn.__input=[sz,zt,Fo],f(Cs),we(()=>{Ye(Js,`Box Size ${(n(It)==="percent"?"(%)":"(Price)")??""}`),Vu(Nn,n(zt))}),O(ds,Cs)}),f(cr);var nt=u(cr,2),et=u(g(nt),2);Vt(et),et.__input=[iz,Mo,Fo],f(nt);var ht=u(nt,2),uo=u(g(ht),2),ut=g(uo),Jt=u(g(ut),2),fo=g(Jt);Vt(fo),fo.__input=[rz,Xo,Fo];var lo=u(fo,2),so=g(lo,!0);f(lo),f(Jt),f(ut);var ko=u(ut,2),ts=u(g(ko),2),Xn=g(ts);Vt(Xn),Xn.__input=[az,en,Fo];var ro=u(Xn,2),Do=g(ro,!0);f(ro),f(ts),f(ko),f(uo),f(ht);var Ao=u(ht,2),ss=g(Ao);ss.__click=[lz,It,zt,pt,Mo,Xo,en,Fo],f(Ao),f(ai),f(qi),we(()=>{Vu(et,n(Mo)),Ye(so,n(Xo)),Ye(Do,n(en))}),Bo(kr,()=>n(It),ds=>b(It,ds)),go(fo,()=>n(Xo),ds=>b(Xo,ds)),go(Xn,()=>n(en),ds=>b(en,ds)),O(_a,qi)},null,!0),O(tr,lr)},!0),O(zn,Vs)},!0),O(Ko,Hn)},!0),O(ri,vn)}),f(Zo),f(to),we(()=>{Sn(vt,"bg-primary",n(w)==="canvas"),Sn(vt,"text-primary-content",n(w)==="canvas"),Sn(vt,"hover:bg-base-200",n(w)!=="canvas"),Sn($t,"bg-primary",n(w)==="other"),Sn($t,"text-primary-content",n(w)==="other"),Sn($t,"hover:bg-base-200",n(w)!=="other"),Sn(zo,"bg-primary",n(w)==="candle"),Sn(zo,"text-primary-content",n(w)==="candle"),Sn(zo,"hover:bg-base-200",n(w)!=="candle")}),O(yt,to)},$$slots:{default:!0}});var xt=u(Qt,2);Se(xt,()=>n(S),yt=>{var wt=We(()=>k.get("backgroundColor")||es().backgroundColor);Su(yt,{get show(){return n(S)},set show(to){b(S,j(to))},get selectedColor(){return n(wt)},get opacity(){return n(De)},$$events:{colorChange:wr,opacityChange:rr}})});var eo=u(xt,2);Se(eo,()=>n(L),yt=>{var wt=We(()=>k.get("gridColor")||n(he)||es().gridColor);Su(yt,{get show(){return n(L)},set show(to){b(L,j(to))},get selectedColor(){return n(wt)},get opacity(){return n(ge)},$$events:{colorChange:ar,opacityChange:jr}})});var Is=u(eo,2);Se(Is,()=>n(T),yt=>{var wt=We(()=>k.get("xAxisTickTextColor")||es().xAxisTickTextColor);Su(yt,{get show(){return n(T)},set show(to){b(T,j(to))},get selectedColor(){return n(wt)},get opacity(){return n(be)},$$events:{colorChange:ii,opacityChange:Ja}})});var Po=u(Is,2);Se(Po,()=>n(P),yt=>{var wt=We(()=>k.get("yAxisTickTextColor")||es().yAxisTickTextColor);Su(yt,{get show(){return n(P)},set show(to){b(P,j(to))},get selectedColor(){return n(wt)},get opacity(){return n($e)},$$events:{colorChange:Xa,opacityChange:Va}})});var Ze=u(Po,2);Se(Ze,()=>n(N),yt=>{Su(yt,{get show(){return n(N)},set show(wt){b(N,j(wt))},get selectedColor(){return n(ee)},$$events:{colorChange:vl}})});var Ke=u(Ze,2);Se(Ke,()=>n($),yt=>{Su(yt,{get show(){return n($)},set show(wt){b($,j(wt))},get selectedColor(){return n(xe)},$$events:{colorChange:ml}})});var ps=u(Ke,2);Se(ps,()=>n(V),yt=>{Su(yt,{get show(){return n(V)},set show(wt){b(V,j(wt))},get selectedColor(){return n(ke)},$$events:{colorChange:Sl}})});var pn=u(ps,2);Se(pn,()=>n(U),yt=>{Su(yt,{get show(){return n(U)},set show(wt){b(U,j(wt))},get selectedColor(){return n(He)},$$events:{colorChange:el}})});var Jo=u(pn,2);Se(Jo,()=>n(G),yt=>{Su(yt,{get show(){return n(G)},set show(wt){b(G,j(wt))},get selectedColor(){return n(Ie)},$$events:{colorChange:or}})});var ti=u(Jo,2);Se(ti,()=>n(Z),yt=>{Su(yt,{get show(){return n(Z)},set show(wt){b(Z,j(wt))},get selectedColor(){return n(ne)},$$events:{colorChange:tc}})});var mr=u(ti,2);Se(mr,()=>n(q),yt=>{Vy(yt,{get show(){return n(q)},set show(wt){b(q,j(wt))},get initialGradient(){return n(Eo)},$$events:{gradientChange:Wa}})});var sa=u(mr,2);Se(sa,()=>n(ce),yt=>{Vy(yt,{get show(){return n(ce)},set show(wt){b(ce,j(wt))},get initialGradient(){return n(cs)},$$events:{gradientChange:Qa}})}),O(o,Ft),Za()}hc(["click","change","input"]);var qz=(o,e,t)=>e(n(t).key,o.currentTarget.value),Hz=de("<option> </option>"),Gz=de('<select class="select select-bordered select-sm w-full"></select>'),Yz=(o,e,t)=>e(n(t).key,o.currentTarget.checked),Uz=de('<input type="checkbox" class="toggle toggle-sm">'),Kz=de('<span class="text-base-content/70 text-right"> </span> <!>',1),Zz=(o,e)=>b(e,!0),Xz=de('<div class="grid grid-cols-[3fr_2fr_3fr_2fr] gap-5 mx-7 my-5 items-center"><!> <div class="col-span-4 mt-4 pt-4 border-t border-base-300"><button class="btn btn-outline btn-primary w-full">Chart Setting</button></div></div>'),Jz=de("<!> <!>",1);function Qz(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(v,"$chart",t),i=()=>ir(d,"$save",t);let r=Ss(e,"show",15);const a=new E0,l=Fa("ctx"),d=Fa("save"),v=Fa("chart");let p=oe(!1);const _=[{key:"candle.priceMark.last.show",text:"last_price_show",component:"switch"},{key:"candle.priceMark.high.show",text:"high_price_show",component:"switch"},{key:"candle.priceMark.low.show",text:"low_price_show",component:"switch"},{key:"indicator.lastValueMark.show",text:"indicator_last_value_show",component:"switch"},{key:"yAxis.reverse",text:"reverse_coordinate",component:"switch"},{key:"grid.show",text:"grid_show",component:"switch"}];function y(F,B){var U,G,Z,le,se,ie,Y,K,Q,q,ce,_e,me,Pe,ze,he,De,ge,be,$e,Ve,Ce,Je,ye,Ae,ee,xe;const R=(U=s())==null?void 0:U.getStyles(),N=Rt.get(R,F);if(F==="yAxis.reverse")try{(G=s())==null||G.setPaneOptions({axis:{reverse:B}}),d.update(ke=>(Rt.set(ke.styles,F,B),ke)),a.set(F,B);return}catch(ke){console.warn("setPaneOptions not available, falling back to styles:",ke)}if(N==B)return;a.set(F,B),d.update(ke=>(Rt.set(ke.styles,F,B),ke));const $=Ul(i().theme);console.log("🟡 Settings.update key:",F,"value:",B,"theme:",i().theme),console.log("🎨 theme axis colors:",(se=(le=(Z=$==null?void 0:$.xAxis)==null?void 0:Z.tickText)==null?void 0:le.style)==null?void 0:se.color,(K=(Y=(ie=$==null?void 0:$.yAxis)==null?void 0:ie.tickText)==null?void 0:Y.style)==null?void 0:K.color),console.log("💾 saved axis colors:",Rt.get(i().styles,"xAxis.tickText.style.color"),Rt.get(i().styles,"yAxis.tickText.style.color"));const V=Rt.merge({},$,i().styles);try{const ke=(ce=(q=(Q=$==null?void 0:$.xAxis)==null?void 0:Q.tickText)==null?void 0:q.style)==null?void 0:ce.color,He=(Pe=(me=(_e=$==null?void 0:$.yAxis)==null?void 0:_e.tickText)==null?void 0:me.style)==null?void 0:Pe.color;ke&&((he=(ze=V==null?void 0:V.xAxis)==null?void 0:ze.tickText)!=null&&he.style)&&(V.xAxis.tickText.style.color=ke,(De=V==null?void 0:V.xAxis)!=null&&De.tickText&&(delete V.xAxis.tickText.color,delete V.xAxis.tickText.opacity)),He&&((be=(ge=V==null?void 0:V.yAxis)==null?void 0:ge.tickText)!=null&&be.style)&&(V.yAxis.tickText.style.color=He,($e=V==null?void 0:V.yAxis)!=null&&$e.tickText&&(delete V.yAxis.tickText.color,delete V.yAxis.tickText.opacity))}catch{}console.log("🔄 merged axis colors before apply:",(Je=(Ce=(Ve=V==null?void 0:V.xAxis)==null?void 0:Ve.tickText)==null?void 0:Ce.style)==null?void 0:Je.color,(ee=(Ae=(ye=V==null?void 0:V.yAxis)==null?void 0:ye.tickText)==null?void 0:Ae.style)==null?void 0:ee.color),(xe=s())==null||xe.setStyles(al(V)),setTimeout(()=>{var ne,J,qe,ft,Qe,Oe,ct,Lt,It,zt,pt;const ke=((ne=s())==null?void 0:ne.getStyles())||{},He=((ft=(qe=(J=ke==null?void 0:ke.xAxis)==null?void 0:J.tickText)==null?void 0:qe.style)==null?void 0:ft.color)??((Oe=(Qe=ke==null?void 0:ke.xAxis)==null?void 0:Qe.tickText)==null?void 0:Oe.color),Ie=((It=(Lt=(ct=ke==null?void 0:ke.yAxis)==null?void 0:ct.tickText)==null?void 0:Lt.style)==null?void 0:It.color)??((pt=(zt=ke==null?void 0:ke.yAxis)==null?void 0:zt.tickText)==null?void 0:pt.color);console.log("✅ chart axis colors after apply:",He,Ie)},0)}function w(F){var B,R,N,$,V,U,G,Z,le,se,ie,Y,K,Q,q,ce,_e,me,Pe,ze,he,De,ge,be,$e,Ve,Ce;if(F==="reset"){const Je=(R=(B=i().styles)==null?void 0:B.candle)==null?void 0:R.type,ye=Ul(i().theme),Ae=i().styles;_.forEach(xe=>{Rt.unset(Ae,xe.key)}),d.update(xe=>(xe.styles=Ae,Je&&(xe.styles.candle||(xe.styles.candle={}),xe.styles.candle.type=Je),xe));const ee=Rt.merge({},ye,i().styles);console.log("🟠 Settings.reset theme:",i().theme),console.log("🎨 default axis colors:",(V=($=(N=ye==null?void 0:ye.xAxis)==null?void 0:N.tickText)==null?void 0:$.style)==null?void 0:V.color,(Z=(G=(U=ye==null?void 0:ye.yAxis)==null?void 0:U.tickText)==null?void 0:G.style)==null?void 0:Z.color);try{const xe=(ie=(se=(le=ye==null?void 0:ye.xAxis)==null?void 0:le.tickText)==null?void 0:se.style)==null?void 0:ie.color,ke=(Q=(K=(Y=ye==null?void 0:ye.yAxis)==null?void 0:Y.tickText)==null?void 0:K.style)==null?void 0:Q.color;xe&&((ce=(q=ee==null?void 0:ee.xAxis)==null?void 0:q.tickText)!=null&&ce.style)&&(ee.xAxis.tickText.style.color=xe,(_e=ee==null?void 0:ee.xAxis)!=null&&_e.tickText&&(delete ee.xAxis.tickText.color,delete ee.xAxis.tickText.opacity)),ke&&((Pe=(me=ee==null?void 0:ee.yAxis)==null?void 0:me.tickText)!=null&&Pe.style)&&(ee.yAxis.tickText.style.color=ke,(ze=ee==null?void 0:ee.yAxis)!=null&&ze.tickText&&(delete ee.yAxis.tickText.color,delete ee.yAxis.tickText.opacity))}catch{}console.log("🔄 merged axis colors on reset:",(ge=(De=(he=ee==null?void 0:ee.xAxis)==null?void 0:he.tickText)==null?void 0:De.style)==null?void 0:ge.color,(Ve=($e=(be=ee==null?void 0:ee.yAxis)==null?void 0:be.tickText)==null?void 0:$e.style)==null?void 0:Ve.color),(Ce=s())==null||Ce.setStyles(al(ee)),setTimeout(()=>{var Ie,ne,J,qe,ft,Qe,Oe,ct,Lt,It,zt;const xe=((Ie=s())==null?void 0:Ie.getStyles())||{},ke=((qe=(J=(ne=xe==null?void 0:xe.xAxis)==null?void 0:ne.tickText)==null?void 0:J.style)==null?void 0:qe.color)??((Qe=(ft=xe==null?void 0:xe.xAxis)==null?void 0:ft.tickText)==null?void 0:Qe.color),He=((Lt=(ct=(Oe=xe==null?void 0:xe.yAxis)==null?void 0:Oe.tickText)==null?void 0:ct.style)==null?void 0:Lt.color)??((zt=(It=xe==null?void 0:xe.yAxis)==null?void 0:It.tickText)==null?void 0:zt.color);console.log("✅ chart axis colors after reset apply:",ke,He)},0),k()}else r(!1)}function k(){let F=s();if(!F)return;const B=F.getStyles()??{};_.forEach(R=>{const N=Rt.get(B,R.key);R.key==="yAxis.reverse"?a.set(R.key,N||!1):a.set(R.key,N)})}Cc(l,F=>F.initDone).subscribe(k),Wi(()=>{r()&&s()&&k()});var L=Jz(),T=_t(L),P=We(()=>mb());Pu(T,{get title(){return n(P)},width:760,get show(){return r()},set show(F){r(F)},get theme(){return i().theme},click:w,buttons:["confirm","reset"],children:(F,B)=>{var R=Xz(),N=g(R);Ns(N,17,()=>_,dn,(U,G)=>{var Z=Kz(),le=_t(Z),se=g(le,!0);we(()=>{var Y;return Ye(se,(Y=Nu[n(G).text])==null?void 0:Y.call(Nu))}),f(le);var ie=u(le,2);Se(ie,()=>n(G).component==="select",Y=>{var K=Gz();Km(K,()=>a.get(n(G).key));var Q;K.__change=[qz,y,G],Ns(K,21,()=>n(G).dataSource||[],dn,(q,ce)=>{var _e=Hz(),me={},Pe=g(_e,!0);we(()=>{var ze;return Ye(Pe,((ze=Nu[n(ce).text])==null?void 0:ze.call(Nu))||n(ce).text)}),f(_e),we(()=>{me!==(me=n(ce).key)&&(_e.value=(_e.__value=n(ce).key)==null?"":n(ce).key)}),O(q,_e)}),f(K),we(()=>{Q!==(Q=a.get(n(G).key))&&(K.value=(K.__value=a.get(n(G).key))==null?"":a.get(n(G).key),pf(K,a.get(n(G).key)))}),O(Y,K)},Y=>{var K=Xt(),Q=_t(K);Se(Q,()=>n(G).component==="switch",q=>{var ce=Uz();Vt(ce),we(()=>tp(ce,!!a.get(n(G).key))),ce.__change=[Yz,y,G],O(q,ce)},null,!0),O(Y,K)}),O(U,Z)});var $=u(N,2),V=g($);V.__click=[Zz,p],f($),f(R),O(F,R)},$$slots:{default:!0}});var A=u(T,2);Fx(A,{get show(){return n(p)},set show(F){b(p,j(F))}}),O(o,L),Za()}hc(["change","click"]);var eB=de('<img alt="screenshot" class="w-[500px] mt-5">');function tB(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(r,"$save",t);let i=Ss(e,"show",15);const r=Fa("save");function a(l){if(l==="confirm"){const d=document.createElement("a");d.download="screenshot",d.href=e.url,document.body.appendChild(d),d.click(),d.remove()}i(!1)}Pu(o,{title:"Screenshot",width:540,get show(){return i()},set show(l){i(l)},get theme(){return s().theme},click:a,children:(l,d)=>{var v=eB();we(()=>St(v,"src",e.url)),O(l,v)},$$slots:{default:!0}}),Za()}function oB(o,e,t){const s=o.target;Ir(t,Uo(e).timezone=s.value,Uo(e))}var sB=de("<option> </option>"),nB=de('<div class="flex justify-center items-center min-h-[70px]"><select class="select select-bordered w-[70%]"></select></div>');function iB(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(r,"$save",t);let i=Ss(e,"show",15);const r=Fa("save"),a=ok();function l(v){i(!1)}var d=We(()=>pb());Pu(o,{get title(){return n(d)},width:400,get show(){return i()},set show(v){i(v)},get theme(){return s().theme},click:l,children:(v,p)=>{var _=nB(),y=g(_);Km(y,()=>s().timezone);var w;y.__change=[oB,s,r],Ns(y,21,()=>a,dn,(k,S)=>{var L=sB(),T={},P=g(L,!0);we(()=>Ye(P,Nu[n(S).text]())),f(L),we(()=>{T!==(T=n(S).key)&&(L.value=(L.__value=n(S).key)==null?"":n(S).key)}),O(k,L)}),f(y),f(_),we(()=>{w!==(w=s().timezone)&&(y.value=(y.__value=s().timezone)==null?"":s().timezone,pf(y,s().timezone))}),O(v,_)},$$slots:{default:!0}}),Za()}hc(["change"]);var rB=de('<div class="warning-banner"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 9v2m0 4h.01M10.29 3.86l-7.6 13.17A1 1 0 003.53 19h16.94a1 1 0 00.84-1.5L13.71 3.86a1 1 0 00-1.73 0z"></path></svg> <span> </span></div>'),aB=(o,e,t)=>e(n(t),o),lB=de('<div class="selection-badge"><svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M13.3 4.3L6 11.6 2.7 8.3l1.1-1.1L6 9.4l6.2-6.2 1.1 1.1z" fill="currentColor" stroke="currentColor" stroke-width="0.5"></path></svg></div>'),cB=de('<button class="chart-card"><div class="card-bg"></div> <!> <div class="icon-container"><div class="icon-glow"></div> <!></div> <span class="chart-name"> </span> <div class="shine-effect"></div></button>'),dB=de(`<!> <div class="premium-grid"></div> <style>/* ===== PREMIUM GRID LAYOUT ===== */
    .premium-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      padding: 8px;
    }
    
    @media (max-width: 640px) {
      .premium-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        padding: 6px;
      }
    }
    
    @media (max-width: 480px) {
      .premium-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        padding: 8px;
      }
    }
    
    /* ===== PREMIUM CHART CARD ===== */
    .chart-card {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 20px 12px 18px;
      background: linear-gradient(145deg, 
        rgba(30, 35, 48, 0.6) 0%, 
        rgba(20, 25, 35, 0.4) 100%);
      border: 1.5px solid rgba(255, 255, 255, 0.06);
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    
    @media (max-width: 640px) {
      .chart-card {
        padding: 16px 10px 14px;
        gap: 8px;
      }
    }
    
    @media (max-width: 480px) {
      .chart-card {
        padding: 22px 14px 20px;
        gap: 12px;
      }
    }
    
    /* Animated background */
    .card-bg {
      position: absolute;
      inset: 0;
      background: linear-gradient(145deg,
        rgba(45, 55, 75, 0.3) 0%,
        rgba(30, 40, 60, 0.2) 50%,
        rgba(20, 30, 50, 0.3) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 0;
    }
    
    /* Hover state */
    .chart-card:hover {
      transform: translateY(-3px);
      border-color: rgba(255, 255, 255, 0.12);
      background: linear-gradient(145deg, 
        rgba(35, 45, 60, 0.7) 0%, 
        rgba(25, 35, 50, 0.5) 100%);
      box-shadow: 
        0 12px 40px rgba(0, 0, 0, 0.4),
        0 6px 20px rgba(20, 30, 50, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.08);
    }
    
    .chart-card:hover .card-bg {
      opacity: 1;
    }
    
    /* Active state */
    .chart-card.active {
      background: linear-gradient(145deg, 
        rgba(30, 50, 80, 0.5) 0%,
        rgba(20, 40, 70, 0.4) 50%,
        rgba(25, 45, 75, 0.5) 100%);
      border-color: rgba(70, 120, 180, 0.4);
      box-shadow: 
        0 8px 32px rgba(30, 60, 100, 0.3),
        0 4px 16px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 0 1px rgba(60, 100, 150, 0.2);
      transform: translateY(-2px);
    }
    
    .chart-card.active .card-bg {
      background: linear-gradient(145deg,
        rgba(40, 65, 95, 0.4) 0%,
        rgba(30, 55, 85, 0.3) 50%,
        rgba(35, 60, 90, 0.4) 100%);
      opacity: 1;
    }
    
    .chart-card.active:hover {
      transform: translateY(-2px);
      border-color: rgba(80, 130, 190, 0.5);
    }
    
    /* ===== SELECTION BADGE ===== */
    .selection-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, 
        rgba(70, 120, 180, 0.9) 0%, 
        rgba(50, 100, 160, 0.85) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 
        0 3px 10px rgba(30, 60, 100, 0.4),
        0 1px 3px rgba(0, 0, 0, 0.3);
      animation: badgePulse 2.5s ease-in-out infinite;
    }
    
    @keyframes badgePulse {
      0%, 100% {
        transform: scale(1);
        box-shadow: 
          0 3px 10px rgba(30, 60, 100, 0.4),
          0 1px 3px rgba(0, 0, 0, 0.3);
      }
      50% {
        transform: scale(1.05);
        box-shadow: 
          0 4px 14px rgba(40, 70, 110, 0.5),
          0 2px 5px rgba(0, 0, 0, 0.35);
      }
    }
    
    /* ===== ICON CONTAINER ===== */
    .icon-container {
      position: relative;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      background: linear-gradient(145deg, 
        rgba(40, 50, 65, 0.5) 0%, 
        rgba(25, 35, 50, 0.3) 100%);
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 
        0 3px 12px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.06);
      z-index: 1;
    }
    
    @media (max-width: 640px) {
      .icon-container {
        width: 42px;
        height: 42px;
        border-radius: 10px;
      }
    }
    
    @media (max-width: 480px) {
      .icon-container {
        width: 50px;
        height: 50px;
        border-radius: 12px;
      }

    }
    
    .icon-glow {
      position: absolute;
      inset: -3px;
      background: linear-gradient(145deg, 
        rgba(50, 90, 140, 0.3) 0%, 
        rgba(35, 70, 120, 0.25) 100%);
      border-radius: inherit;
      opacity: 0;
      filter: blur(10px);
      transition: opacity 0.3s ease;
      z-index: -1;
    }
    
    .chart-card:hover .icon-container {
      transform: scale(1.06);
      background: linear-gradient(145deg, 
        rgba(50, 65, 85, 0.6) 0%, 
        rgba(35, 50, 70, 0.4) 100%);
      box-shadow: 
        0 5px 18px rgba(0, 0, 0, 0.25),
        0 2px 10px rgba(30, 50, 80, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    
    .chart-card.active .icon-container {
      background: linear-gradient(145deg, 
        rgba(40, 70, 110, 0.5) 0%, 
        rgba(30, 60, 95, 0.4) 100%);
      border-color: rgba(70, 110, 160, 0.3);
      transform: scale(1.04);
      box-shadow: 
        0 6px 20px rgba(30, 60, 100, 0.3),
        0 3px 12px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.12);
    }
    
    .chart-card.active .icon-glow {
      opacity: 0.5;
    }
    
    /* ===== CHART ICON ===== */
    :global(.chart-icon) {
      color: rgba(200, 210, 230, 0.85);
      filter: drop-shadow(0 2px 5px rgba(0, 0, 0, 0.3));
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 2;
    }
    
    .chart-card:hover :global(.chart-icon) {
      color: rgba(220, 230, 245, 0.95);
      filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.35));
      transform: scale(1.05);
    }
    
    .chart-card.active :global(.chart-icon) {
      color: rgba(160, 200, 240, 1);
      filter: drop-shadow(0 4px 12px rgba(40, 80, 130, 0.5));
      transform: scale(1.03);
    }
    
    /* ===== CHART NAME ===== */
    .chart-name {
      color: rgba(180, 190, 210, 0.85);
      font-size: 12px;
      font-weight: 500;
      text-align: center;
      line-height: 1.3;
      letter-spacing: 0.4px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1;
    }
    
    @media (max-width: 640px) {
      .chart-name {
        font-size: 11px;
      }
    }
    
    @media (max-width: 480px) {
      .chart-name {
        font-size: 12.5px;
      }
    }
    
    .chart-card:hover .chart-name {
      color: rgba(210, 220, 235, 0.95);
      transform: translateY(-1px);
    }
    
    .chart-card.active .chart-name {
      color: rgba(180, 210, 240, 1);
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    
    /* ===== SHINE EFFECT ===== */
    .shine-effect {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        115deg,
        transparent 25%,
        rgba(255, 255, 255, 0.08) 45%,
        rgba(200, 220, 240, 0.12) 50%,
        rgba(255, 255, 255, 0.08) 55%,
        transparent 75%
      );
      transform: translateX(-100%) skewX(-15deg);
      transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .chart-card:hover .shine-effect {
      transform: translateX(100%) skewX(-15deg);
    }
    
    /* ===== LIGHT THEME ===== */
    :global([data-theme="light"]) .chart-card {
      background: linear-gradient(145deg, #ffffff 0%, #f9fbff 100%);
      border-color: rgba(59, 130, 246, 0.15);
      box-shadow: 
        0 2px 6px rgba(59, 130, 246, 0.08),
        0 1px 2px rgba(0, 0, 0, 0.04);
    }
    
    :global([data-theme="light"]) .card-bg {
      background: transparent;
      opacity: 0;
    }
    
    :global([data-theme="light"]) .chart-card:hover {
      background: #ffffff;
      border-color: rgba(59, 130, 246, 0.25);
      box-shadow: 
        0 6px 14px rgba(59, 130, 246, 0.10),
        0 3px 8px rgba(0, 0, 0, 0.05);
    }
    
    :global([data-theme="light"]) .chart-card.active {
      background: linear-gradient(145deg, #e8f4ff 0%, #f0f8ff 100%);
      border-color: rgba(100, 150, 220, 0.4);
      box-shadow: 
        0 3px 10px rgba(100, 150, 220, 0.15),
        0 1px 4px rgba(0, 0, 0, 0.05);
    }
    
    :global([data-theme="light"]) .chart-card.active .card-bg {
      opacity: 0;
    }
    
    :global([data-theme="light"]) .icon-container {
      background: #f3f6fb;
      border-color: rgba(59, 130, 246, 0.15);
      box-shadow: 
        0 1px 3px rgba(0, 0, 0, 0.04),
        inset 0 0.5px 0 rgba(255, 255, 255, 1);
    }
    
    :global([data-theme="light"]) .chart-card:hover .icon-container {
      background: #f0f2f5;
      box-shadow: 
        0 2px 6px rgba(0, 0, 0, 0.05),
        inset 0 0.5px 0 rgba(255, 255, 255, 1);
    }
    
    :global([data-theme="light"]) .chart-card.active .icon-container {
      background: linear-gradient(145deg, #dceeff 0%, #e6f3ff 100%);
      border-color: rgba(100, 150, 220, 0.2);
      box-shadow: 
        0 2px 8px rgba(100, 150, 220, 0.12),
        inset 0 0.5px 0 rgba(255, 255, 255, 1);
    }
    
    :global([data-theme="light"]) .icon-glow {
      opacity: 0;
    }
    
    :global([data-theme="light"]) :global(.chart-icon) {
      color: #3b82f6;
      filter: drop-shadow(0 0.5px 1px rgba(59, 130, 246, 0.15));
    }
    
    :global([data-theme="light"]) .chart-card:hover :global(.chart-icon) {
      color: #2563eb;
      filter: drop-shadow(0 1px 2px rgba(37, 99, 235, 0.2));
    }
    
    :global([data-theme="light"]) .chart-card.active :global(.chart-icon) {
      color: #1d4ed8;
      filter: drop-shadow(0 1px 3px rgba(29, 78, 216, 0.3));
    }
    
    :global([data-theme="light"]) .chart-name {
      color: #334155;
    }
    
    :global([data-theme="light"]) .chart-card:hover .chart-name {
      color: #1f2937;
    }
    
    :global([data-theme="light"]) .chart-card.active .chart-name {
      color: #2563eb;
      font-weight: 600;
    }
    
    :global([data-theme="light"]) .selection-badge {
      background: linear-gradient(135deg, #5ba3f5 0%, #4a90e2 100%);
      border-color: rgba(255, 255, 255, 0.8);
      box-shadow: 
        0 2px 8px rgba(74, 144, 226, 0.3),
        0 1px 2px rgba(0, 0, 0, 0.1);
    }
    
    /* ===== WARNING BANNER ===== */
    .warning-banner {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 18px;
      margin-bottom: 16px;
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(239, 68, 68, 0.1) 100%);
      border: 1px solid rgba(245, 158, 11, 0.3);
      border-radius: 12px;
      color: rgba(251, 191, 36, 0.95);
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.15);
    }
    
    .warning-banner svg {
      flex-shrink: 0;
      color: rgba(251, 191, 36, 1);
      filter: drop-shadow(0 2px 4px rgba(245, 158, 11, 0.3));
    }
    
    :global([data-theme="light"]) .warning-banner {
      background: linear-gradient(135deg, rgba(254, 243, 199, 0.9) 0%, rgba(254, 226, 226, 0.8) 100%);
      border-color: rgba(217, 119, 6, 0.3);
      color: rgba(146, 64, 14, 0.95);
      box-shadow: 0 2px 8px rgba(217, 119, 6, 0.15);
    }
    
    :global([data-theme="light"]) .warning-banner svg {
      color: rgba(217, 119, 6, 1);
      filter: drop-shadow(0 1px 2px rgba(217, 119, 6, 0.2));
    }
    
    /* ===== DISABLED STATE ===== */
    .chart-card.disabled {
      opacity: 0.35;
      cursor: not-allowed;
      pointer-events: auto;
    }
    
    .chart-card.disabled:hover {
      transform: none;
      opacity: 0.35;
      border-color: rgba(255, 255, 255, 0.06);
      background: linear-gradient(145deg, 
        rgba(30, 35, 48, 0.6) 0%, 
        rgba(20, 25, 35, 0.4) 100%);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    
    .chart-card.disabled .card-bg {
      opacity: 0;
    }
    
    .chart-card.disabled .icon-container {
      transform: none;
    }
    
    .chart-card.disabled .shine-effect {
      display: none;
    }
    
    :global([data-theme="light"]) .chart-card.disabled {
      opacity: 0.4;
    }
    
    :global([data-theme="light"]) .chart-card.disabled:hover {
      opacity: 0.4;
    }</style>`,1);function uB(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(a,"$save",t),i=()=>ir(l,"$chart",t);let r=Ss(e,"show",15);Fa("ctx");const a=Fa("save"),l=Fa("chart"),d=[{id:"candle_solid",name:"Candlestick",icon:"candle_solid"},{id:"candle_stroke",name:"Hollow",icon:"candle_stroke"},{id:"candle_up_stroke",name:"Up Hollow",icon:"candle_up_stroke"},{id:"candle_down_stroke",name:"Down Hollow",icon:"candle_down_stroke"},{id:"heikin_ashi",name:"Heikin Ashi",icon:"candle_solid"},{id:"renko_atr",name:"Duty AI Renko",icon:"candle_solid"},{id:"point_and_figure",name:"Point & Figure",icon:"point_and_figure"},{id:"ohlc",name:"OHLC",icon:"ohlc"},{id:"area",name:"Area",icon:"area"},{id:"line_chart",name:"Line",icon:"line"}],v=["SMART_MONEY","TRAP_HUNTER","VOLCANIC","VOLCANIC_SIG"];function p(){return!s()||!s().saveInds?!1:Object.values(s().saveInds).some(S=>S&&v.includes(S.name))}let _=oe(!1),y=oe("");Wi(()=>{if(n(_)){const S=setTimeout(()=>{b(_,!1)},5e3);return()=>clearTimeout(S)}});function w(S,L){var F,B,R,N,$;const T=S;if(T.id==="renko_atr"&&p()){b(y,"You cannot use Duty AI Renko chart with AI Indicator"),b(_,!0),console.log("⚠️ Cannot add Renko chart: AI indicators present");return}if(T.id==="point_and_figure"&&p()){b(y,"You cannot use Point & Figure chart with AI Indicator"),b(_,!0),console.log("⚠️ Cannot add P&F chart: AI indicators present");return}if(console.log("📊 CHART TYPE CLICK:",T.id),L){const V=L.currentTarget;V.classList.add("selecting"),setTimeout(()=>{V.classList.remove("selecting")},800)}if(s().styles.candle||Ir(a,Uo(s).styles.candle={},Uo(s)),T.id==="line_chart"){console.log("🎯 Setting up LINE CHART (using area with transparent background)"),Ir(a,Uo(s).styles.candle.type="area",Uo(s));const V=((B=(F=s().styles.candle)==null?void 0:F.bar)==null?void 0:B.upColor)||"#2196F3";Ir(a,Uo(s).styles.candle.area={lineSize:2,lineColor:V,lineSmooth:!1,value:"close",backgroundColor:[{offset:0,color:"rgba(0, 0, 0, 0)"},{offset:1,color:"rgba(0, 0, 0, 0)"}]},Uo(s)),Ir(a,Uo(s).styles.candle._isLineChart=!0,Uo(s)),console.log("✅ Line chart configured with area type and transparent background")}else if(T.id==="area"){console.log("🎯 Setting up AREA CHART with gradient fill"),Ir(a,Uo(s).styles.candle.type="area",Uo(s)),delete s().styles.candle._isLineChart;const V=((N=(R=s().styles.candle)==null?void 0:R.bar)==null?void 0:N.upColor)||"#2196F3";Ir(a,Uo(s).styles.candle.area={lineSize:2,lineColor:V,lineSmooth:!1,value:"close",backgroundColor:[{offset:0,color:V+"60"},{offset:1,color:V+"10"}]},Uo(s)),console.log("✅ Area chart configured with gradient background")}else T.id==="renko_atr"?(console.log("🎯 Setting up RENKO (ATR) chart"),Ir(a,Uo(s).styles.candle.type="renko_atr",Uo(s)),s().styles.candle.renko||Ir(a,Uo(s).styles.candle.renko={method:"ATR",atrLength:14,source:"close",wick:!1},Uo(s)),delete s().styles.candle._isLineChart,delete s().styles.candle.area):T.id==="point_and_figure"?(console.log("🎯 Setting up POINT & FIGURE chart"),Ir(a,Uo(s).styles.candle.type="point_and_figure",Uo(s)),s().styles.candle.pnf||Ir(a,Uo(s).styles.candle.pnf={boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"},Uo(s)),delete s().styles.candle._isLineChart,delete s().styles.candle.area):(Ir(a,Uo(s).styles.candle.type=T.id,Uo(s)),delete s().styles.candle._isLineChart,delete s().styles.candle.area);console.log("✅ Saved chart type to $save.styles:",{type:s().styles.candle.type,isLineChart:s().styles.candle._isLineChart,area:s().styles.candle.area});const P=Ul(s().theme);Rt.merge(P,s().styles);const A=al(P);($=i())==null||$.setStyles(A),console.log("✅ Styles applied to chart with processing"),r(!1)}function k(){var L,T,P,A;return(T=(L=s().styles)==null?void 0:L.candle)!=null&&T._isLineChart?"line_chart":((A=(P=s().styles)==null?void 0:P.candle)==null?void 0:A.type)||"renko_atr"}Pu(o,{get show(){return r()},set show(S){r(S)},title:"Chart Type",width:"550px",maxWidth:"95vw",maxHeight:"90vh",buttons:[],get theme(){return s().theme},class:"chart-type-modal-premium",children:(S,L)=>{var T=dB(),P=_t(T);Se(P,()=>n(_),F=>{var B=rB(),R=u(g(B),2),N=g(R,!0);f(R),f(B),we(()=>Ye(N,n(y))),Vp(3,B,()=>Wm,()=>({y:-20,duration:300})),O(F,B)});var A=u(P,2);Ns(A,21,()=>d,F=>F.id,(F,B)=>{var R=cB();const N=We(()=>(n(B).id==="renko_atr"||n(B).id==="point_and_figure")&&p());R.__click=[aB,w,B];const $=We(()=>k()===n(B).id);we(()=>Sn(R,"active",n($)));var V=u(g(R),2);Se(V,()=>k()===n(B).id&&!n(N),se=>{var ie=lB();O(se,ie)});var U=u(V,2),G=u(g(U),2);Ru(G,{get name(){return n(B).icon},size:26,class:"chart-icon"}),f(U);var Z=u(U,2),le=g(Z,!0);f(Z),un(2),f(R),we(()=>{Sn(R,"disabled",n(N)),Ye(le,n(B).name)}),O(F,R)}),f(A),un(2),O(S,T)},$$slots:{default:!0}}),Za()}hc(["click"]);function qy(o,e){e(!1)}var pB=(o,e,t,s,i)=>!n(e)&&!n(t)&&s(n(i).is_main,n(i).name),vB=de('<div class="particle svelte-uswuii"></div>'),fB=de('<div class="stream-line svelte-uswuii"></div>'),gB=de('<div class="segment svelte-uswuii"></div>'),mB=de('<div class="ai-loading-overlay svelte-uswuii"><div class="particles-container svelte-uswuii"></div> <div class="data-stream svelte-uswuii"></div> <div class="loading-content svelte-uswuii"><div class="ai-loader-icon svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-uswuii"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-uswuii"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-uswuii"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-uswuii"></line></svg> <div class="ai-pulse-ring ring-1 svelte-uswuii"></div> <div class="ai-pulse-ring ring-2 svelte-uswuii"></div> <div class="ai-pulse-ring ring-3 svelte-uswuii"></div> <div class="ai-glow svelte-uswuii"></div></div> <div class="loading-text-container svelte-uswuii"><div class="loading-text-main svelte-uswuii"> </div> <div class="loading-text-sub svelte-uswuii"> </div></div> <div class="progress-container svelte-uswuii"><div class="progress-bar svelte-uswuii"><div class="progress-glow svelte-uswuii"></div></div> <div class="progress-segments svelte-uswuii"></div></div> <div class="progress-info svelte-uswuii"><div class="progress-percentage svelte-uswuii"> </div> <div class="progress-status svelte-uswuii"> </div></div></div></div>'),hB=(o,e,t,s)=>{o.stopPropagation(),e(n(t),n(s).name)},_B=(o,e,t,s)=>{o.stopPropagation(),e(n(t),n(s).name)},yB=de('<div class="indicator-actions svelte-uswuii"><button class="action-btn edit-btn svelte-uswuii" title="Edit Parameters"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" class="svelte-uswuii"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" class="svelte-uswuii"></path></svg></button> <button class="action-btn delete-btn svelte-uswuii" title="Remove Indicator"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="3 6 5 6 21 6" class="svelte-uswuii"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" class="svelte-uswuii"></path><line x1="10" y1="11" x2="10" y2="17" class="svelte-uswuii"></line><line x1="14" y1="11" x2="14" y2="17" class="svelte-uswuii"></line></svg></button></div>'),bB=de('<div class="add-indicator-hint svelte-uswuii"><span class="svelte-uswuii">Click to add</span></div>'),xB=de('<div class="indicator-icon svelte-uswuii"> </div> <div class="indicator-info svelte-uswuii"><span class="indicator-name svelte-uswuii"> </span></div> <!>',1),wB=de("<div><!></div>"),kB=o=>o.stopPropagation(),SB=de('<div class="ai-modal-backdrop svelte-uswuii" role="presentation"></div> <div class="ai-modal-container svelte-uswuii" role="dialog" aria-modal="true" aria-labelledby="ai-modal-title"><div class="ai-background svelte-uswuii"><div class="orb orb-1 svelte-uswuii"></div> <div class="orb orb-2 svelte-uswuii"></div> <div class="orb orb-3 svelte-uswuii"></div></div> <div class="ai-content svelte-uswuii"><div class="ai-header svelte-uswuii"><div class="ai-header-left svelte-uswuii"><div class="ai-icon-small svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-uswuii"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-uswuii"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-uswuii"></line></svg></div> <div class="ai-header-text svelte-uswuii"><h2 id="ai-modal-title" class="ai-title svelte-uswuii">AI Indicators</h2> <p class="ai-subtitle svelte-uswuii">Duty AI Advanced Algorithm - Exclusive for Pro Traders</p></div></div> <button class="close-btn svelte-uswuii" aria-label="Close"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><line x1="18" y1="6" x2="6" y2="18" class="svelte-uswuii"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-uswuii"></line></svg></button></div> <div class="indicators-list svelte-uswuii"><!> <div class="indicator-row coming-soon-item disabled svelte-uswuii"><div class="coming-soon-glitter-bg svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-1 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-2 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-3 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-4 svelte-uswuii"></div> <div class="coming-soon-glitter-particle coming-soon-glitter-5 svelte-uswuii"></div> <div class="coming-soon-shine-sweep svelte-uswuii"></div> <div class="indicator-icon svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-uswuii"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-uswuii"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-uswuii"></line></svg></div> <div class="indicator-info svelte-uswuii"><span class="indicator-name svelte-uswuii">AI Trade Entry Finder and more AI algorithms</span> <span class="coming-soon-badge svelte-uswuii">Coming Soon</span></div></div></div> <div class="ai-powered-footer svelte-uswuii"><span class="powered-by-text svelte-uswuii">Powered by Duty AI</span></div></div></div>',1),CB=(o,e)=>b(e,!1),PB=(o,e)=>b(e,!1),IB=de('<div class="premium-modal-backdrop svelte-uswuii" role="presentation"></div> <div class="premium-modal-container svelte-uswuii" role="dialog" aria-modal="true" aria-labelledby="premium-modal-title"><div class="premium-background svelte-uswuii"><div class="premium-orb premium-orb-1 svelte-uswuii"></div> <div class="premium-orb premium-orb-2 svelte-uswuii"></div></div> <div class="premium-content svelte-uswuii"><button class="premium-close-btn svelte-uswuii" aria-label="Close"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><line x1="18" y1="6" x2="6" y2="18" class="svelte-uswuii"></line><line x1="6" y1="6" x2="18" y2="18" class="svelte-uswuii"></line></svg></button> <div class="premium-icon-wrapper svelte-uswuii"><div class="premium-icon svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-uswuii"></path><path d="M2 17l10 5 10-5" class="svelte-uswuii"></path><path d="M2 12l10 5 10-5" class="svelte-uswuii"></path></svg> <div class="premium-icon-glow svelte-uswuii"></div></div></div> <h2 id="premium-modal-title" class="premium-title svelte-uswuii">Premium Feature</h2> <p class="premium-message svelte-uswuii">AI Indicators are exclusive premium features. Upgrade to Premium to unlock all advanced AI algorithms and take your trading to the next level.</p> <div class="premium-features svelte-uswuii"><div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">Smart Money Footprint</span></div> <div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">Trap Hunter (Bull/Bear Traps)</span></div> <div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">Volcanic Move & Eruptions</span></div> <div class="premium-feature-item svelte-uswuii"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><polyline points="20 6 9 17 4 12" class="svelte-uswuii"></polyline></svg> <span class="svelte-uswuii">More AI algorithms coming soon</span></div></div> <a target="_blank" rel="noopener noreferrer" class="premium-payment-btn svelte-uswuii"><span class="svelte-uswuii">Upgrade to Premium</span> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-uswuii"><line x1="5" y1="12" x2="19" y2="12" class="svelte-uswuii"></line><polyline points="12 5 19 12 12 19" class="svelte-uswuii"></polyline></svg></a></div></div>',1),MB=de("<!> <!>",1);function TB(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(p,"$chart",t),i=()=>ir(v,"$save",t),r=()=>ir(d,"$ctx",t),a=()=>ir(Up,"$userPreferences",t);let l=Ss(e,"show",15);const d=Fa("ctx"),v=Fa("save"),p=Fa("chart"),_=[{name:"SMART_MONEY",title:"Smart Money Footprint",is_main:!0,icon:"💰"},{name:"TRAP_HUNTER",title:"Trap Hunter (Bull/Bear Traps)",is_main:!0,icon:"🎯"},{name:"VOLCANIC",title:"Volcanic Move (Pressure) (Sub Pane)",is_main:!1,icon:"🌋"},{name:"VOLCANIC_SIG",title:"Volcanic Eruptions (Markers) (Main Pane)",is_main:!0,icon:"💥"}],y={SMART_MONEY:[{text:"💰 Tracking institutional money flow",duration:1200,subtext:"Analyzing whale movements..."},{text:"🏦 Detecting smart money footprints",duration:1400,subtext:"Scanning OBV patterns..."},{text:"📊 Mapping accumulation zones",duration:1300,subtext:"Identifying support levels..."},{text:"🎯 Calculating volume clusters",duration:1200,subtext:"Processing 50,000+ trades..."},{text:"✨ Activating smart money radar",duration:1100,subtext:"Deploying footprint tracker..."}],TRAP_HUNTER:[{text:"🎯 Scanning for bull/bear traps",duration:1200,subtext:"Analyzing false breakouts..."},{text:"🔍 Detecting fake-out patterns",duration:1400,subtext:"Identifying trap signatures..."},{text:"⚡ Processing trap probability",duration:1300,subtext:"Calculating 20+ parameters..."},{text:"🚨 Mapping high-risk zones",duration:1200,subtext:"Locating potential traps..."},{text:"✨ Deploying trap detection AI",duration:1100,subtext:"Activating alert system..."}],VOLCANIC:[{text:"🌋 Measuring market pressure",duration:1200,subtext:"Analyzing momentum buildup..."},{text:"📈 Detecting volcanic activity",duration:1400,subtext:"Scanning RSI extremes..."},{text:"🔥 Calculating eruption zones",duration:1300,subtext:"Processing pressure levels..."},{text:"⚡ Tracking explosive setups",duration:1200,subtext:"Identifying breakout points..."},{text:"✨ Activating volcanic pressure",duration:1100,subtext:"Deploying oscillator..."}],VOLCANIC_SIG:[{text:"💥 Detecting eruption signals",duration:1200,subtext:"Scanning breakout candles..."},{text:"🚀 Analyzing explosive moves",duration:1400,subtext:"Tracking volume spikes..."},{text:"🎯 Mapping eruption markers",duration:1300,subtext:"Calculating signal strength..."},{text:"⚡ Processing 15,000+ patterns",duration:1200,subtext:"Identifying eruption points..."},{text:"✨ Deploying eruption markers",duration:1100,subtext:"Activating signal alerts..."}]};let w=oe(j(new Set));Wi(()=>{var Q;if(!l()||!s())return;const Y=s();let K=new Set;try{const q=((Q=Y.getIndicators)==null?void 0:Q.call(Y))??[];K=new Set(q.map(ce=>ce.name)),console.log("🧠 AI Modal (open) - from chart.getIndicators:",q)}catch(q){console.warn("⚠️ AI Modal - getIndicators failed, falling back to saveInds",q);const ce=new Set;i()&&i().saveInds&&Object.values(i().saveInds).forEach(_e=>{_e&&_e.name&&ce.add(_e.name)}),K=ce}console.log("🔄 AI Modal (open) - selectedIndicators updated:",Array.from(K)),console.log("🔍 AI Modal (open) - saveInds keys:",Object.keys(i().saveInds||{})),b(w,j(K))});let k=oe(!1),S=oe(null),L=oe(0),T=oe(0),P=oe(j([])),A=oe(!1);Wi(()=>{!r().modalIndCfg&&n(k)&&(b(k,!1),setTimeout(()=>{l(!0)},100))}),Wi(()=>{l()&&(console.log("🎯 AI Modal opened"),console.log("📊 Current saveInds:",i().saveInds),console.log("✅ AI indicators in chart:",Array.from(n(w))))});function F(){var K,Q,q;if(((Q=(K=i().styles)==null?void 0:K.candle)==null?void 0:Q.type)==="renko_atr"){console.log("🔄 Converting Renko chart to Candlestick for AI indicator compatibility"),Ir(v,Uo(i).styles.candle.type="candle_solid",Uo(i)),delete i().styles.candle.renko,delete i().styles.candle._isLineChart,delete i().styles.candle.area;const ce=Ul(i().theme);Rt.merge(ce,i().styles);const _e=al(ce);return(q=s())==null||q.setStyles(_e),console.log("✅ Chart converted from Renko to Candlestick"),!0}return!1}async function B(Y){b(S,j(Y)),b(L,0),b(T,0),b(P,j(y[Y]||y.SMART_MONEY));for(let K=0;K<n(P).length;(K+=1)-1){b(L,j(K));const Q=n(P)[K],q=K/n(P).length*100,ce=(K+1)/n(P).length*100,_e=20,me=Q.duration/_e;for(let Pe=0;Pe<=_e;(Pe+=1)-1)b(T,q+(ce-q)*(Pe/_e)),await new Promise(ze=>setTimeout(ze,me))}b(S,null),b(L,0),b(T,0),b(P,j([]))}function R(){var K;const Y=(K=a())==null?void 0:K.data;return Y?Y.isPremium===!0||Y.isTrial===!0:!1}async function N(Y,K){if(!R()){console.log("🔒 Premium access required for AI indicators"),b(A,!0);return}await B(K),F();let Q=!1;if(K==="SMART_MONEY"){const q="candle_pane",ce=s();if(ce&&ce.createIndicator({name:"SMART_MONEY",calcParams:[40,5,25,14,20,1.2,.03,20,.2,.6,1,20,1]},!0,{id:q})){const me={name:"SMART_MONEY",pane_id:q,params:[40,5,25,14,20,1.2,.03,20,.2,.6,1,20,1]},Pe=`${q}_SMART_MONEY`;v.update(ze=>(ze.saveInds[Pe]=me,ze)),Ou(),Dc.recordAddIndicator(K,q,me.params,Pe),Q=!0}}else if(K==="TRAP_HUNTER"){const q="candle_pane",ce=s();if(ce){const _e=[20,20,3,5,20,1.3,7e-4,.35,.5,1,5];if(ce.createIndicator({name:"TRAP_HUNTER",calcParams:_e},!0,{id:q})){const Pe={name:"TRAP_HUNTER",pane_id:q,params:_e},ze=`${q}_TRAP_HUNTER`;v.update(he=>(he.saveInds[ze]=Pe,he)),Ou(),Dc.recordAddIndicator(K,q,Pe.params,ze),Q=!0}}}else if(K==="VOLCANIC"){const q="pane_VOLCANIC",ce=s();if(ce){const _e=[16,2,14,20,60,2,.5,1,.8,.8,.4,10,1,30,0,7e-4,0,1];if(ce.createIndicator({name:"VOLCANIC",calcParams:_e},!1,{id:q})){const Pe={name:"VOLCANIC",pane_id:q,params:_e},ze=`${q}_VOLCANIC`;v.update(he=>(he.saveInds[ze]=Pe,he)),Ou(),Dc.recordAddIndicator(K,q,Pe.params,ze),Q=!0}}}else if(K==="VOLCANIC_SIG"){const q="candle_pane",ce=s();if(ce){const _e=[16,2,14,20,60,2,.5,1,.8,.8,.4,10,1,30,0,7e-4,0,1];if(ce.createIndicator({name:"VOLCANIC_SIG",calcParams:_e},!0,{id:q})){const Pe={name:"VOLCANIC_SIG",pane_id:q,params:_e},ze=`${q}_VOLCANIC_SIG`;v.update(he=>(he.saveInds[ze]=Pe,he)),Ou(),Dc.recordAddIndicator(K,q,Pe.params,ze),Q=!0}}}Q&&console.log(`✅ ${K} added successfully from AI modal`)}function $(Y,K){b(k,!0),l(!1),d.update(Q=>(Q.editPaneId=Y,Q.editIndName=K,Q.modalIndCfg=!0,Q))}async function V(Y,K){if(console.log("🗑️ Deleting indicator:",{paneId:Y,name:K}),!s()){console.log("❌ No chart available");return}const Q=s(),q=`${Y}_${K}`,ce=i().saveInds[q];ce&&Dc.recordRemoveIndicator(K,Y,ce.params||[],q);try{Q.removeIndicator({paneId:Y,name:K}),console.log("✅ Indicator removed"),v.update(_e=>(delete _e.saveInds[q],_e)),Ou()}catch(_e){console.log("❌ Error removing indicator:",_e)}}const U=$0(),[G,Z]=U;var le=MB(),se=_t(le);Se(se,l,Y=>{var K=SB(),Q=_t(K);Q.__click=[qy,l];var q=u(Q,2),ce=u(g(q),2),_e=g(ce),me=u(g(_e),2);me.__click=[qy,l],f(_e);var Pe=u(_e,2),ze=g(Pe);Ns(ze,19,()=>_,De=>De.name,(De,ge)=>{var be=wB();const $e=We(()=>n(w).has(n(ge).name)),Ve=We(()=>n(S)===n(ge).name),Ce=We(()=>n(ge).is_main?"candle_pane":`pane_${n(ge).name}`);be.__click=[pB,$e,Ve,N,ge];var Je=g(be);Se(Je,()=>n(Ve),ye=>{var Ae=mB(),ee=g(Ae);Ns(ee,20,()=>Array(12),dn,(Fo,Eo,cs)=>{var Zt=vB();St(Zt,"style",`--delay: ${cs*.15}s; --x: ${Math.random()*100}%; --y: ${Math.random()*100}%`),O(Fo,Zt)}),f(ee);var ke=u(ee,2);Ns(ke,20,()=>Array(8),dn,(Fo,Eo,cs)=>{var Zt=fB();St(Zt,"style",`--stream-delay: ${cs*.2}s; left: ${10+cs*12}%`),O(Fo,Zt)}),f(ke);var Ie=u(ke,2),ne=u(g(Ie),2),J=g(ne),qe=g(J,!0);f(J);var ft=u(J,2),Qe=g(ft,!0);f(ft),f(ne);var Oe=u(ne,2),ct=g(Oe),Lt=u(ct,2);Ns(Lt,20,()=>Array(5),dn,(Fo,Eo,cs)=>{var Zt=gB();we(()=>Sn(Zt,"active",n(L)>=cs)),O(Fo,Zt)}),f(Lt),f(Oe);var zt=u(Oe,2),pt=g(zt),Mo=g(pt);we(()=>Ye(Mo,`${Math.round(n(T))??""}%`)),f(pt);var Xo=u(pt,2),en=g(Xo);f(Xo),f(zt),f(Ie),f(Ae),we(()=>{var Fo,Eo;Ye(qe,((Fo=n(P)[n(L)])==null?void 0:Fo.text)||""),Ye(Qe,((Eo=n(P)[n(L)])==null?void 0:Eo.subtext)||""),St(ct,"style",`width: ${n(T)??""}%`),Ye(en,`Phase ${n(L)+1}/5`)}),O(ye,Ae)},ye=>{var Ae=xB(),ee=_t(Ae),xe=g(ee,!0);f(ee);var ke=u(ee,2),He=g(ke),Ie=g(He,!0);f(He),f(ke);var ne=u(ke,2);Se(ne,()=>n($e),J=>{var qe=yB(),ft=g(qe);ft.__click=[hB,$,Ce,ge];var Qe=u(ft,2);Qe.__click=[_B,V,Ce,ge],f(qe),O(J,qe)},J=>{var qe=bB();O(J,qe)}),we(()=>{Ye(xe,n(ge).icon),Ye(Ie,n(ge).title)}),O(ye,Ae)}),f(be),we(()=>Pn(be,`indicator-row ${(n($e)?"indicator-selected":"")??""} ${(n(Ve)?"indicator-loading":"")??""} svelte-uswuii`)),O(De,be)});var he=u(ze,2);he.__click=[kB],f(Pe),un(2),f(ce),f(q),Vp(3,Q,()=>Vm,()=>({duration:200})),Vp(3,q,()=>Wm,()=>({y:20,duration:300,easing:Q_})),O(Y,K)});var ie=u(se,2);Se(ie,()=>n(A),Y=>{var K=IB(),Q=_t(K);Q.__click=[CB,A];var q=u(Q,2),ce=u(g(q),2),_e=g(ce);_e.__click=[PB,A];var me=u(_e,10);we(()=>St(me,"href",G("https://dutyai.app/payment",void 0))),f(ce),f(q),Vp(3,Q,()=>Vm,()=>({duration:200})),Vp(3,q,()=>Wm,()=>({y:20,duration:300,easing:Q_})),O(Y,K)}),O(o,le),Za()}hc(["click"]);var AB=de('<span class="loading loading-spinner loading-xs"></span>'),LB=de('<span class="text-xs">•</span>'),FB=de('<button class="btn btn-primary btn-sm min-w-[100px] transition-all duration-200 svelte-1ib83i5" title="Save Layout Options"><!> Save <!></button>');function DB(o,e){Ka(e,!1);const t=kl(),s=kl();let i=Ss(e,"savedLayouts",24,()=>[]),r=Ss(e,"activeSaveId",8,null),a=Ss(e,"isLoading",8,!1),l=Ss(e,"hasUnsavedChanges",8,!1);const d=Md();function v(){d("showPopup")}nu(()=>(Gd(r()),Gd(i())),()=>{b(t,r()?i().find(w=>w.id===r()):null)}),nu(()=>n(t),()=>{b(s,!!n(t))}),Av(),Ud();var p=FB(),_=g(p);Se(_,a,w=>{var k=AB();O(w,k)},w=>{OA(w,{class:"h-4 w-4"})});var y=u(_,2);Se(y,l,w=>{var k=LB();O(w,k)}),f(p),we(()=>{p.disabled=a(),Sn(p,"btn-warning",l())}),Fl("click",p,v),O(o,p),Za()}function EB(o,e,t,s,i){o.key==="Enter"&&n(e).valid&&n(t).trim()?(o.preventDefault(),s()):o.key==="Escape"&&(o.preventDefault(),i())}var $B=de('<div class="flex items-center gap-2 text-sm text-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </div>'),jB=de('<div class="flex items-center gap-2 text-sm text-success"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Layout name is available</div>'),zB=de('<div class="flex items-center justify-between text-sm"><span class="text-base-content/80"> </span> <span class="text-xs text-base-content/50"> </span></div>'),BB=de('<div class="space-y-2"><h4 class="text-sm font-medium text-base-content/70"> </h4> <div class="max-h-32 overflow-y-auto space-y-1 p-3 bg-base-200/30 rounded-lg border border-base-300/50 svelte-bhlz05"></div></div>'),NB=de('<span class="loading loading-spinner loading-sm"></span> Saving...',1),RB=de('<div class="space-y-6"><div class="space-y-2"><label for="layout-name" class="block text-sm font-medium text-base-content">Layout Name</label> <input id="layout-name" type="text" placeholder="Enter layout name..." class="w-full px-4 py-3 border border-base-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200 bg-base-100 text-base-content placeholder-base-content/50"> <!></div> <!> <div class="flex gap-3 justify-end pt-4 border-t border-base-300/50"><button class="btn btn-ghost min-w-[100px] rounded-lg font-medium transition-all duration-200">Cancel</button> <button class="btn btn-primary min-w-[100px] rounded-lg font-medium transition-all duration-200 hover:scale-105"><!></button></div></div>');function OB(o,e){Ka(e,!1);const t=kl();let s=Ss(e,"show",12,!1),i=Ss(e,"savedLayouts",24,()=>[]),r=Ss(e,"isLoading",8,!1),a=Ss(e,"mode",8,"save"),l=Ss(e,"showExisting",8,!1),d=kl(""),v=kl({valid:!0}),p=kl(!1);const _=Md();function y(S){if(b(p,!0),!S){b(v,{valid:!1,error:"Layout name is required"}),b(p,!1);return}if(S.length<2){b(v,{valid:!1,error:"Layout name must be at least 2 characters"}),b(p,!1);return}if(S.length>50){b(v,{valid:!1,error:"Layout name must be less than 50 characters"}),b(p,!1);return}if(/[<>:"/\\|?*]/.test(S)){b(v,{valid:!1,error:"Layout name contains invalid characters"}),b(p,!1);return}if(i().some(P=>P.name.toLowerCase()===S.toLowerCase())){b(v,{valid:!1,error:"A layout with this name already exists"}),b(p,!1);return}b(v,{valid:!0}),b(p,!1)}function w(){const S=n(d).trim();n(v).valid&&S&&_("save",{name:S})}function k(){s(!1),_("cancel")}nu(()=>Gd(s()),()=>{s()&&(b(d,""),b(v,{valid:!0}),b(p,!1))}),nu(()=>n(d),()=>{n(d).trim()?y(n(d).trim()):b(v,{valid:!1,error:"Layout name is required"})}),nu(()=>Gd(a()),()=>{b(t,a()==="save"?"Save Chart Layout":"Save Layout As")}),Av(),Ud(),Pu(o,{get show(){return s()},set show(S){s(S)},get title(){return n(t)},width:450,buttons:[],children:(S,L)=>{var T=RB(),P=g(T),A=u(g(P),2);Vt(A),A.__keydown=[EB,v,d,w,k],h2(A,!0);const F=Yd(()=>!n(v).valid&&n(d).trim()),B=Yd(()=>n(v).valid&&n(d).trim());var R=u(A,2);Se(R,()=>n(d).trim()&&!n(v).valid,Z=>{var le=$B(),se=u(g(le));f(le),we(()=>Ye(se,` ${n(v).error??""}`)),O(Z,le)},Z=>{var le=Xt(),se=_t(le);Se(se,()=>n(v).valid&&n(d).trim(),ie=>{var Y=jB();O(ie,Y)},null,!0),O(Z,le)}),f(P);var N=u(P,2);Se(N,()=>l()&&i().length>0,Z=>{var le=BB(),se=g(le),ie=g(se);f(se);var Y=u(se,2);Ns(Y,5,i,dn,(K,Q)=>{var q=zB(),ce=g(q),_e=g(ce,!0);f(ce);var me=u(ce,2),Pe=g(me,!0);we(()=>Ye(Pe,new Date(n(Q).updatedAt).toLocaleDateString())),f(me),f(q),we(()=>Ye(_e,n(Q).name)),O(K,q)}),f(Y),f(le),we(()=>Ye(ie,`Existing Layouts (${i().length??""})`)),O(Z,le)});var $=u(N,2),V=g($);V.__click=k;var U=u(V,2);U.__click=w,we(()=>U.disabled=!n(v).valid||!n(d).trim()||r()||n(p));var G=g(U);Se(G,r,Z=>{var le=NB();un(),O(Z,le)},Z=>{var le=Np("Save Layout");O(Z,le)}),f(U),f($),f(T),we(()=>{A.disabled=r(),Sn(A,"border-error",n(F)),Sn(A,"border-success",n(B)),V.disabled=r()}),go(A,()=>n(d),Z=>b(d,Z)),O(S,T)},$$slots:{default:!0},$$legacy:!0}),Za()}hc(["keydown","click"]);var VB=de('<span class="loading loading-spinner loading-xs"></span>'),WB=de('<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path></svg>'),qB=de('<span class="text-xs text-warning">• Unsaved changes</span>'),HB=de('<div class="p-4 bg-primary/5 border-b border-base-300/50"><div class="flex items-center gap-2 text-sm"><div class="w-2 h-2 bg-primary rounded-full"></div> <span class="font-medium text-base-content"> </span> <!></div> <div class="text-xs text-base-content/60 mt-1"> </div></div>'),GB=de('<div class="p-6 text-center text-base-content/60 text-sm">No saved layouts yet</div>'),YB=de('<div class="w-1.5 h-1.5 bg-primary rounded-full"></div>'),UB=de('<div><div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="text-sm font-medium text-base-content truncate"> </span> <!></div> <div class="text-xs text-base-content/60"> </div></div> <button class="opacity-0 group-hover:opacity-100 p-1 hover:bg-error/20 rounded transition-all duration-150" title="Delete layout"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>'),KB=de('<div class="p-4"><div class="text-xs font-medium text-base-content/70 px-2 py-2"> </div> <div class="space-y-1"></div></div>'),ZB=de('<div class="max-h-48 overflow-y-auto svelte-10s4pck"><!></div>'),XB=de('<div class="fixed inset-0 bg-transparent z-40"></div> <div class="fixed z-50 bg-base-100 border border-base-300 rounded-lg shadow-xl animate-in fade-in zoom-in-95 duration-200"><div class="flex items-center justify-between p-4 border-b border-base-300/50"><h3 class="text-lg font-semibold text-base-content">Save Chart Layout</h3> <button class="btn btn-ghost btn-sm btn-circle" title="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-4 border-b border-base-300/50"><div class="space-y-2"><button class="w-full flex items-center gap-3 px-4 py-3 text-sm bg-primary text-primary-content hover:bg-primary/90 rounded-md transition-colors duration-150"><!> </button> <button class="w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-base-200 rounded-md transition-colors duration-150"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> Save As...</button> <button class="w-full flex items-center gap-3 px-4 py-3 text-sm hover:bg-base-200 rounded-md transition-colors duration-150"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> New Layout</button></div></div> <!> <!></div>',1);function JB(o,e){Ka(e,!1);const t=kl(),s=kl();let i=Ss(e,"show",12,!1),r=Ss(e,"savedLayouts",24,()=>[]),a=Ss(e,"activeSaveId",8,null),l=Ss(e,"isLoading",8,!1),d=Ss(e,"hasUnsavedChanges",8,!1),v=Ss(e,"position",24,()=>({x:0,y:0})),p=Ss(e,"showLayouts",8,!0),_=kl();const y=Md();function w(V){n(_)&&!n(_).contains(V.target)&&S()}function k(V){V.key==="Escape"&&S()}Rd(()=>{console.log("🎯 ChartSavePopup mounted with props:",{show:i(),savedLayouts:r(),activeSaveId:a(),isLoading:l(),hasUnsavedChanges:d(),position:v()}),i()&&(document.addEventListener("click",w),document.addEventListener("keydown",k))}),yp(()=>{document.removeEventListener("click",w),document.removeEventListener("keydown",k)});function S(){i(!1),y("close")}function L(){n(s)?y("quickSave"):(y("save"),S())}function T(){y("saveAs"),S()}function P(){y("newLayout"),S()}function A(V){y("load",{layoutId:V}),S()}function F(V,U){V.stopPropagation(),y("delete",{layoutId:U})}function B(V){return new Date(V).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function R(){const G=document.querySelector(".chart-container")||document.querySelector(".kline-widget");if(!G)return`left: ${v().x}px; top: ${v().y}px;`;const Z=G.getBoundingClientRect();let le=Z.left+Z.width/2-320/2,se=Z.top+Z.height/2-400/2;return le=Math.max(20,Math.min(le,window.innerWidth-320-20)),se=Math.max(20,Math.min(se,window.innerHeight-400-20)),`left: ${le}px; top: ${se}px;`}nu(()=>(Gd(a()),Gd(r())),()=>{b(t,a()?r().find(V=>V.id===a()):null)}),nu(()=>n(t),()=>{b(s,!!n(t))}),nu(()=>(Gd(i()),Gd(r()),Gd(a()),n(t),n(s)),()=>{var V;i()&&console.log("🔄 ChartSavePopup reactive update (visible):",{show:i(),savedLayouts:((V=r())==null?void 0:V.length)||0,savedLayoutsData:r(),activeSaveId:a(),activeLayout:n(t),hasActiveSave:n(s)})}),nu(()=>Gd(i()),()=>{i()?setTimeout(()=>{document.addEventListener("click",w),document.addEventListener("keydown",k)},0):(document.removeEventListener("click",w),document.removeEventListener("keydown",k))}),Av(),Ud();var N=Xt(),$=_t(N);Se($,i,V=>{var U=XB(),G=_t(U),Z=u(G,2);const le=Yd(R);var se=g(Z),ie=u(g(se),2);f(se);var Y=u(se,2),K=g(Y),Q=g(K),q=g(Q);Se(q,l,he=>{var De=VB();O(he,De)},he=>{var De=WB();O(he,De)});var ce=u(q);f(Q);var _e=u(Q,2),me=u(_e,2);f(K),f(Y);var Pe=u(Y,2);Se(Pe,()=>n(t),he=>{var De=HB(),ge=g(De),be=u(g(ge),2),$e=g(be);f(be);var Ve=u(be,2);Se(Ve,d,ye=>{var Ae=qB();O(ye,Ae)}),f(ge);var Ce=u(ge,2),Je=g(Ce);we(()=>Ye(Je,`Last saved: ${B(new Date(n(t).updatedAt).getTime())??""}`)),f(Ce),f(De),we(()=>Ye($e,`Active: ${n(t).name??""}`)),O(he,De)});var ze=u(Pe,2);Se(ze,p,he=>{var De=ZB(),ge=g(De);Se(ge,()=>r().length===0,be=>{var $e=GB();O(be,$e)},be=>{var $e=KB(),Ve=g($e),Ce=g(Ve);f(Ve);var Je=u(Ve,2);Ns(Je,5,r,dn,(ye,Ae)=>{var ee=UB(),xe=g(ee),ke=g(xe),He=g(ke),Ie=g(He,!0);f(He);var ne=u(He,2);Se(ne,()=>n(Ae).id===a(),Qe=>{var Oe=YB();O(Qe,Oe)}),f(ke);var J=u(ke,2),qe=g(J,!0);we(()=>Ye(qe,B(new Date(n(Ae).updatedAt).getTime()))),f(J),f(xe);var ft=u(xe,2);f(ee),we(()=>{Pn(ee,`group flex items-center justify-between px-3 py-2 hover:bg-base-200 rounded-md transition-colors duration-150 cursor-pointer ${(n(Ae).id===a()?"bg-primary/10":"")??""}`),Ye(Ie,n(Ae).name)}),Fl("click",ft,Qe=>F(Qe,n(Ae).id)),Fl("click",ee,()=>A(n(Ae).id)),O(ye,ee)}),f(Je),f($e),we(()=>Ye(Ce,`Saved Layouts (${r().length??""})`)),O(be,$e)}),f(De),O(he,De)}),f(Z),Ec(Z,he=>b(_,he),()=>n(_)),we(()=>{St(Z,"style",n(le)),Q.disabled=l(),Ye(ce,` ${(n(s)?"Save to Current Layout":"Save New Layout")??""}`)}),Fl("click",G,S),Fl("click",ie,S),Fl("click",Q,L),Fl("click",_e,T),Fl("click",me,P),O(V,U)}),O(o,N),Za()}var QB=de('<div class="p-6 text-center text-base-content/60 text-sm"><span class="loading loading-spinner loading-xs"></span></div>'),eN=de('<div class="p-6 text-center text-base-content/60 text-sm">No saved layouts yet</div>'),tN=de('<div class="w-1.5 h-1.5 bg-primary rounded-full"></div>'),oN=de('<div><div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="text-sm font-medium text-base-content truncate"> </span> <!></div> <div class="text-xs text-base-content/60"> </div></div> <button class="opacity-0 group-hover:opacity-100 p-1 hover:bg-error/20 rounded transition-all duration-150" title="Delete layout"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>'),sN=de('<div class="p-4"><div class="text-xs font-medium text-base-content/70 px-2 py-2"> </div> <div class="space-y-1"></div></div>'),nN=de('<div class="fixed inset-0 bg-transparent z-40"></div> <div class="fixed z-50 bg-base-100 border border-base-300 rounded-lg shadow-xl animate-in fade-in zoom-in-95 duration-200"><div class="flex items-center justify-between p-4 border-b border-base-300/50"><h3 class="text-lg font-semibold text-base-content">Load Chart Layout</h3> <button class="btn btn-ghost btn-sm btn-circle" title="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="max-h-80 overflow-y-auto svelte-ciowbr"><!></div></div>',1);function iN(o,e){Ka(e,!1);let t=Ss(e,"show",12,!1),s=Ss(e,"savedLayouts",24,()=>[]),i=Ss(e,"activeSaveId",8,null),r=Ss(e,"isLoading",8,!1),a=Ss(e,"position",24,()=>({x:0,y:0})),l=kl();const d=Md();function v(A){n(l)&&!n(l).contains(A.target)&&_()}function p(A){A.key==="Escape"&&_()}Rd(()=>{t()&&(document.addEventListener("click",v),document.addEventListener("keydown",p))}),yp(()=>{document.removeEventListener("click",v),document.removeEventListener("keydown",p)});function _(){t(!1),d("close")}function y(A){d("load",{layoutId:A}),_()}function w(A){A!==i()&&y(A)}function k(A,F){A.stopPropagation(),d("delete",{layoutId:F})}function S(A){return new Date(A).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function L(){const B=document.querySelector(".chart-container")||document.querySelector(".kline-widget");if(!B)return`left: ${a().x}px; top: ${a().y}px;`;const R=B.getBoundingClientRect();let N=R.left+R.width/2-320/2,$=R.top+R.height/2-400/2;return N=Math.max(20,Math.min(N,window.innerWidth-320-20)),$=Math.max(20,Math.min($,window.innerHeight-400-20)),`left: ${N}px; top: ${$}px;`}nu(()=>Gd(t()),()=>{t()?setTimeout(()=>{document.addEventListener("click",v),document.addEventListener("keydown",p)},0):(document.removeEventListener("click",v),document.removeEventListener("keydown",p))}),Av(),Ud();var T=Xt(),P=_t(T);Se(P,t,A=>{var F=nN(),B=_t(F),R=u(B,2);const N=Yd(L);var $=g(R),V=u(g($),2);f($);var U=u($,2),G=g(U);Se(G,r,Z=>{var le=QB();O(Z,le)},Z=>{var le=Xt(),se=_t(le);Se(se,()=>s().length===0,ie=>{var Y=eN();O(ie,Y)},ie=>{var Y=sN(),K=g(Y),Q=g(K);f(K);var q=u(K,2);Ns(q,5,s,dn,(ce,_e)=>{var me=oN(),Pe=g(me),ze=g(Pe),he=g(ze),De=g(he,!0);f(he);var ge=u(he,2);Se(ge,()=>n(_e).id===i(),Ce=>{var Je=tN();O(Ce,Je)}),f(ze);var be=u(ze,2),$e=g(be,!0);we(()=>Ye($e,S(new Date(n(_e).updatedAt).getTime()))),f(be),f(Pe);var Ve=u(Pe,2);f(me),we(()=>{Pn(me,`group flex items-center justify-between px-3 py-2 hover:bg-base-200 rounded-md transition-colors duration-150 cursor-pointer ${(n(_e).id===i()?"bg-primary/10":"")??""}`),Ye(De,n(_e).name)}),Fl("click",Ve,Ce=>k(Ce,n(_e).id)),Fl("click",me,()=>w(n(_e).id)),O(ce,me)}),f(q),f(Y),we(()=>Ye(Q,`Saved Layouts (${s().length??""})`)),O(ie,Y)},!0),O(Z,le)}),f(U),f(R),Ec(R,Z=>b(l,Z),()=>n(l)),we(()=>St(R,"style",n(N))),Fl("click",B,_),Fl("click",V,_),O(A,F)}),O(o,T),Za()}function rN(o,e,t){n(e)?(console.log("💾 SaveAsSelectModal dispatching saveTo event with layoutId:",n(e)),t("saveTo",{layoutId:n(e)})):console.log("❌ SaveAsSelectModal: No layout selected")}function aN(o,e){e("back")}function lN(o,e){e("cancel")}var cN=de('<div class="p-6 text-center text-base-content/60 text-sm"><span class="loading loading-spinner loading-xs"></span></div>'),dN=de('<div class="p-6 text-center text-base-content/60 text-sm">No saved layouts found.</div>'),uN=de('<label class="flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-base-200"><input type="radio" name="save-as-target" class="radio radio-primary"> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-base-content truncate"> </div> <div class="text-xs text-base-content/60"> </div></div></label>'),pN=de('<span class="loading loading-spinner loading-xs"></span> Saving...',1),vN=de('<div class="space-y-4"><div class="flex items-center justify-between"><button class="btn btn-ghost btn-sm" title="Back">← Back</button> <div></div></div> <div class="text-sm text-base-content/70">Select a saved layout to overwrite with the current chart.</div> <div class="max-h-80 overflow-y-auto divide-y divide-base-300/50 rounded-lg border border-base-300/50 svelte-1a3gcnl"><!></div> <div class="flex justify-end gap-3 pt-2"><button class="btn btn-ghost">Cancel</button> <button class="btn btn-primary"><!></button></div></div>');function fN(o,e){Ka(e,!1);const t=[];let s=Ss(e,"show",12,!1),i=Ss(e,"savedLayouts",24,()=>[]),r=Ss(e,"isLoading",8,!1),a=kl(null);const l=Md();nu(()=>Gd(s()),()=>{s()&&b(a,null)}),Av(),Ud(),Pu(o,{get show(){return s()},set show(d){s(d)},title:"Save As: Choose Layout to Overwrite",width:520,buttons:[],children:(d,v)=>{var p=vN(),_=g(p),y=g(_);y.__click=[aN,l],un(2),f(_);var w=u(_,4),k=g(w);Se(k,r,A=>{var F=cN();O(A,F)},A=>{var F=Xt(),B=_t(F);Se(B,()=>i().length===0,R=>{var N=dN();O(R,N)},R=>{var N=Xt(),$=_t(N);Ns($,1,i,dn,(V,U)=>{var G=uN(),Z=g(G);Vt(Z);var le,se=u(Z,2),ie=g(se),Y=g(ie,!0);f(ie);var K=u(ie,2),Q=g(K,!0);we(()=>Ye(Q,new Date(n(U).updatedAt).toLocaleString())),f(K),f(se),f(G),we(()=>{le!==(le=n(U).id)&&(Z.value=(Z.__value=n(U).id)==null?"":n(U).id),Ye(Y,n(U).name)}),a3(t,[],Z,()=>(n(U).id,n(a)),q=>b(a,q)),O(V,G)}),O(R,N)},!0),O(A,F)}),f(w);var S=u(w,2),L=g(S);L.__click=[lN,l];var T=u(L,2);T.__click=[rN,a,l];var P=g(T);Se(P,r,A=>{var F=pN();un(),O(A,F)},A=>{var F=Np("Save");O(A,F)}),f(T),f(S),f(p),we(()=>{L.disabled=r(),T.disabled=!n(a)||r()}),O(d,p)},$$slots:{default:!0},$$legacy:!0}),Za()}hc(["click"]);function gN(o,e,t,s,i){hx("normal"),z0(!0),px(e().symbol),s(!1),i("close");try{window.predictNextCandle&&window.predictNextCandle()}catch{}}function mN(o,e,t,s){px(e().symbol),b(s,"deposit")}function hN(o,e,t,s){vx(n(e)),fx(Math.max(0,Number(n(t))||0)),b(s,"leverage")}function Hy(o,e,t,s,i){gx(n(e)?n(t)||100:null),mx(!0),hx("strategy"),s(!1),i("close");const r=window.sidebarHostRef;r&&r.openSidebar&&r.openSidebar()}var _N=de('<div class="grid grid-cols-1 md:grid-cols-2 gap-3 items-stretch"><div class="card lux-card shadow overflow-hidden h-full svelte-ojcx6s"><div class="card-body p-4 min-w-0 flex flex-col h-full"><div class="flex items-center gap-2"><div class="text-sm font-semibold">Normal Price Simulator</div></div> <div class="text-xs opacity-70 mt-1">Auto-play historical candles to simulate price movement.</div> <div class="mt-auto pt-3"><button class="btn btn-premium-primary w-full svelte-ojcx6s" type="button">Start Normal Mode</button></div></div></div> <div class="card lux-card shadow overflow-hidden h-full svelte-ojcx6s"><div class="card-body p-4 min-w-0 flex flex-col h-full"><div class="flex items-center gap-2"><div class="p-2 rounded-full bg-base-300/60"><!></div> <div class="text-sm font-semibold">Trade Strategy Test</div></div> <div class="text-xs opacity-70 mt-1">Deposit, set leverage, buy/pending orders, and track portfolio & PnL.</div> <div class="mt-auto pt-3"><button class="btn btn-premium-outline w-full svelte-ojcx6s" type="button">Start Strategy Mode</button></div></div></div></div>'),yN=(o,e)=>b(e,"choose"),bN=de("<option> </option>"),xN=de('<div class="card lux-card shadow overflow-hidden svelte-ojcx6s"><div class="card-body p-4 min-w-0"><div class="text-sm font-semibold">Confirm Deposit</div> <div class="mt-2 flex items-center"><button class="btn btn-xs btn-premium-outline svelte-ojcx6s" type="button">Back</button></div> <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-2 items-end"><div class="flex flex-col gap-1"><div class="text-xs opacity-80">Currency</div> <select class="select select-bordered select-sm"></select></div> <input class="input input-bordered input-sm" type="number" min="0" placeholder="Deposit"> <button class="btn btn-sm btn-premium-primary svelte-ojcx6s" type="button">Confirm Deposit</button></div></div></div>'),wN=(o,e)=>b(e,"deposit"),kN=(o,e)=>b(e,!0),SN=(o,e)=>b(e,!1),CN=de('<div class="mt-2 flex items-center gap-2"><select class="select select-bordered select-sm"><option>1:50</option><option>1:100</option><option>1:200</option><option>1:400</option><option>1:500</option></select> <button class="btn btn-sm btn-premium-primary svelte-ojcx6s" type="button">Confirm</button></div>'),PN=de('<div class="mt-2"><button class="btn btn-sm btn-premium-outline svelte-ojcx6s" type="button">Confirm</button></div>'),IN=de('<div class="card lux-card shadow overflow-hidden svelte-ojcx6s"><div class="card-body p-4 min-w-0"><div class="text-sm font-semibold">Take leverage?</div> <div class="mt-2 flex items-center"><button class="btn btn-xs btn-premium-outline svelte-ojcx6s" type="button">Back</button></div> <div class="mt-2 flex items-center gap-2"><label class="label cursor-pointer"><input type="radio" name="lev-modal" class="radio radio-sm"> <span class="label-text ml-2">Yes</span></label> <label class="label cursor-pointer"><input type="radio" name="lev-modal" class="radio radio-sm"> <span class="label-text ml-2">No</span></label></div> <!></div></div>'),MN=de('<div class="p-3 space-y-3"><!></div>');function TN(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(v,"$save",t);let i=Ss(e,"show",15),r=oe("choose"),a=oe(1e5),l=oe(!1),d=oe(null);const v=Fa("save");let p=oe(j(s().symbol.priceCurrency||"USD"));const _=Md();function y(w){w==="close"&&_("close")}Pu(o,{get show(){return i()},set show(w){i(w)},title:"Choose Simulator Mode",buttons:[],click:y,get theme(){return s().theme},children:(w,k)=>{var S=MN(),L=g(S);Se(L,()=>n(r)==="choose",T=>{var P=_N(),A=g(P),F=g(A),B=u(g(F),4),R=g(B);R.__click=[gN,s,v,i,_],f(B),f(F),f(A);var N=u(A,2),$=g(N),V=g($),U=g(V),G=g(U);DA(G,{size:18}),f(U),un(2),f(V);var Z=u(V,4),le=g(Z);le.__click=[mN,s,v,r],f(Z),f($),f(N),f(P),O(T,P)},T=>{var P=Xt(),A=_t(P);Se(A,()=>n(r)==="deposit",F=>{var B=xN(),R=g(B),N=u(g(R),2),$=g(N);$.__click=[yN,r],f(N);var V=u(N,2),U=g(V),G=u(g(U),2);Ns(G,21,()=>bx,dn,(se,ie)=>{var Y=bN(),K={},Q=g(Y,!0);f(Y),we(()=>{K!==(K=n(ie))&&(Y.value=(Y.__value=n(ie))==null?"":n(ie)),Ye(Q,n(ie))}),O(se,Y)}),f(G),f(U);var Z=u(U,2);Vt(Z);var le=u(Z,2);le.__click=[hN,p,a,r],f(V),f(R),f(B),Bo(G,()=>n(p),se=>b(p,se)),go(Z,()=>n(a),se=>b(a,se)),O(F,B)},F=>{var B=IN(),R=g(B),N=u(g(R),2),$=g(N);$.__click=[wN,r],f(N);var V=u(N,2),U=g(V),G=g(U);Vt(G),G.__click=[kN,l],un(2),f(U);var Z=u(U,2),le=g(Z);Vt(le),le.__click=[SN,l],un(2),f(Z),f(V);var se=u(V,2);Se(se,()=>n(l),ie=>{var Y=CN(),K=g(Y),Q=g(K);Q.value=(Q.__value=50)==null?"":50;var q=u(Q);q.value=(q.__value=100)==null?"":100;var ce=u(q);ce.value=(ce.__value=200)==null?"":200;var _e=u(ce);_e.value=(_e.__value=400)==null?"":400;var me=u(_e);me.value=(me.__value=500)==null?"":500,f(K);var Pe=u(K,2);Pe.__click=[Hy,l,d,i,_],f(Y),Bo(K,()=>n(d),ze=>b(d,ze)),O(ie,Y)},ie=>{var Y=PN(),K=g(Y);K.__click=[Hy,l,d,i,_],f(Y),O(ie,Y)}),f(R),f(B),we(()=>{tp(G,n(l)),tp(le,!n(l))}),O(F,B)},!0),O(T,P)}),f(S),O(w,S)},$$slots:{default:!0}}),Za()}hc(["click"]);var AN=de('<div class="toast svelte-66mo1o"><span class="toast-message svelte-66mo1o"> </span></div>');function Dx(o,e){Ka(e,!1);let t=Ss(e,"message",8,""),s=Ss(e,"duration",8,3e3),i=Ss(e,"visible",12,!1);const r=Md();let a=kl();Rd(()=>{i()&&l()});function l(){i(!0),setTimeout(()=>{d()},s())}function d(){i(!1),r("hide")}Ud();var v=Xt(),p=_t(v);return Se(p,i,_=>{var y=AN(),w=g(y),k=g(w,!0);f(w),f(y),Ec(y,S=>b(a,S),()=>n(a)),we(()=>{Sn(y,"show",i()),Ye(k,t())}),O(_,y)}),O(o,v),W1(e,"showToast",l),W1(e,"hideToast",d),Za({showToast:l,hideToast:d})}function LN(o,e,t,s,i,r,a){const l=e().theme==="dark"?"light":"dark";if(s()){b(i,j(l)),b(r,!0);return}a(l,!0)}function FN(o,e,t,s){n(e)&&(t(n(e),!0),b(s,!1),b(e,null))}function DN(o,e,t,s){n(e)&&(t(n(e),!1),b(s,!1),b(e,null))}function EN(o,e,t,s,i,r,a,l){const d=o.target;if(!d.files||!d.files.length)return;const v=d.files[0],p=v.name.split(".").shift()||"Unknown";fF.parse(v,{skipEmptyLines:!0,complete:_=>{var w;const y=_.data.map(k=>({timestamp:parseInt(k[0]),open:parseFloat(k[1]),high:parseFloat(k[2]),low:parseFloat(k[3]),close:parseFloat(k[4]),volume:parseFloat(k[5])}));if(b(e,j(p)),y.length>1){const k=y.length-1,S=Math.min(y[1].timestamp-y[0].timestamp,y[k].timestamp-y[k-1].timestamp);Ir(s,Uo(t).period=ku(ek(S/1e3)),Uo(t))}y.length>0&&YM(Math.min(y[0].low,y[y.length-1].low))+3,(w=i())==null||w.applyNewData(y,!1),Ir(l,Uo(a).loadingKLine=!1,Uo(a)),Ir(l,Uo(a).klineLoaded+=1,Uo(a))}})}function $N(o,e,t,s,i){const r=!n(e);b(e,r);try{sessionStorage.setItem("drawbarShown",String(r))}catch{}try{const a=t();a&&a.style.setProperty("--drawing-bar-width",r?"52px":"0px");const l=typeof document<"u"?document.querySelector(".kline-main"):null;l&&l.style.setProperty("--drawing-bar-width",r?"52px":"0px");const d=typeof document<"u"?document.querySelector(".drawbar-host"):null;d&&(d.style.width=r?"52px":"0px",d.style.overflow="hidden");const v=typeof document<"u"?document.querySelector(".drawbar-container"):null;v&&r&&(v.style.borderRightWidth="2px",v.style.borderRightStyle="solid",v.style.borderRightColor="var(--menu-border)");const p=typeof document<"u"?document.querySelector(".drawbar-wrapper"):null;p&&r&&(p.style.display="")}catch{}requestAnimationFrame(()=>{var a;(a=s())==null||a.resize()})}async function jN(o,e,t,s,i,r,a,l,d,v,p,_){if(!n(e)){b(e,!0);try{if(n(t))if(s())try{v();let y=!1;if(document.webkitExitFullscreen)try{document.webkitExitFullscreen(),y=!0}catch(w){console.log("webkitExitFullscreen failed:",w)}if(window.iosFullscreenCleanup)try{window.iosFullscreenCleanup(),delete window.iosFullscreenCleanup,y=!0}catch(w){console.log("iOS cleanup function failed:",w)}if(!y)try{document.body.classList.remove("ios-fullscreen");const w=document.getElementById("ios-fullscreen-style");w&&w.remove();const k=document.querySelector('meta[name="viewport"]');k&&k.setAttribute("content","width=device-width, initial-scale=1.0")}catch(w){console.log("Manual iOS cleanup failed:",w)}b(t,!1),b(p,!1),setTimeout(()=>{a()&&a().resize(),setTimeout(()=>{b(e,!1)},50)},150)}catch(y){console.log("iOS exit rotation failed:",y),b(t,!1),b(p,!1),b(e,!1)}else{try{"screen"in window&&"orientation"in window.screen&&"unlock"in window.screen.orientation&&window.screen.orientation.unlock()}catch(y){console.log("Screen orientation unlock failed:",y)}await _(),b(t,!1),a()?setTimeout(()=>{a().resize(),setTimeout(()=>{b(e,!1)},50)},150):setTimeout(()=>{b(e,!1)},50)}else if(s())try{await i(),window.DeviceOrientationEvent&&r(),b(t,!0),setTimeout(()=>{window.scrollTo(0,1),setTimeout(()=>{window.scrollTo(0,0),a()&&a().resize(),setTimeout(()=>{b(e,!1)},50)},50)},100)}catch(y){console.log("iOS rotation setup failed:",y),b(t,!0),b(e,!1)}else await d(),setTimeout(async()=>{try{"screen"in window&&"orientation"in window.screen&&"lock"in window.screen.orientation?await window.screen.orientation.lock("landscape"):console.log("Screen Orientation API not supported. Please rotate your device manually.")}catch(y){console.log("Screen orientation lock failed:",y)}b(t,!0),a()?setTimeout(()=>{a().resize(),setTimeout(()=>{b(e,!1)},50)},100):setTimeout(()=>{b(e,!1)},50)},50)}catch(y){console.error("Rotation failed:",y),b(t,!1),b(e,!1)}}}function zN(o,e,t,s){if(e()){const i=e().querySelector(".chart-container");if(i){const r=i.getBoundingClientRect();b(t,j({x:r.left+r.width/2,y:r.top+r.height/2}))}else{const r=e().getBoundingClientRect();b(t,j({x:r.left+r.width/2,y:r.top+r.height/2}))}}b(s,!0)}var BN=de('<div class="save-overlay svelte-pyr5xt"><div class="save-success svelte-pyr5xt">Saved to current layout</div></div>'),NN=(o,e)=>{var t;return(t=n(e))==null?void 0:t.click()},RN=de('<div class="custom-load-section svelte-pyr5xt"><input type="file" class="hidden svelte-pyr5xt" accept="text/csv"> <button class="custom-load-btn svelte-pyr5xt"><span class="custom-load-text svelte-pyr5xt">打开</span> <div class="custom-load-glow svelte-pyr5xt"></div></button></div>'),ON=de('<div class="rotate-loading-overlay svelte-pyr5xt"><div class="rotate-loading-spinner svelte-pyr5xt"><div class="rotate-spinner-ring svelte-pyr5xt"></div> <div class="rotate-spinner-ring svelte-pyr5xt"></div> <div class="rotate-spinner-ring svelte-pyr5xt"></div></div> <div class="rotate-loading-text svelte-pyr5xt">Rotating...</div></div>'),VN=qn('<path d="M322.402 1.33524C319.002 2.83524 282.402 41.3352 279.802 46.2352C277.602 50.4352 277.602 56.6352 279.802 60.9352C282.102 65.5352 317.402 107.535 320.802 109.735C324.702 112.235 335.002 112.035 338.602 109.335C345.002 104.635 347.402 97.6352 345.002 90.4352C344.302 88.4352 340.902 83.3352 337.402 79.1352C333.902 74.9352 331.302 71.3352 331.502 71.1352C331.702 70.8352 334.802 71.2352 338.202 71.8352C379.802 79.7352 409.802 111.735 415.002 153.835C416.302 163.835 417.802 167.035 422.702 170.435C430.002 175.335 440.902 173.135 445.702 165.735C448.202 162.135 448.302 161.435 447.702 152.135C446.102 124.435 432.902 96.5352 411.102 74.9352C390.202 54.0352 367.102 42.7352 336.702 38.4352L331.902 37.8352L338.402 30.9352C345.302 23.5352 347.002 18.9352 345.502 12.0352C343.502 2.73524 331.702 -2.66476 322.402 1.33524Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M169.504 40.9358C163.204 42.2358 157.004 44.7358 152.004 47.9358C149.504 49.5358 125.204 73.2358 97.8044 100.636C44.9044 153.736 44.8044 153.936 41.4044 167.236C39.3044 175.336 40.0044 188.336 43.0044 196.136C44.1044 199.336 47.1044 204.436 49.4044 207.636C51.8044 210.836 95.8043 255.336 147.104 306.536C217.704 376.836 241.704 400.236 245.604 402.236C259.904 409.736 277.304 409.836 292.304 402.336C296.404 400.336 308.404 388.836 348.304 349.136C393.904 303.636 399.404 297.736 402.504 291.736C406.904 282.936 408.404 275.436 407.704 265.436C407.104 255.636 404.304 247.836 398.604 240.236C396.204 237.036 352.404 192.736 301.404 141.836C200.004 40.8358 204.204 44.5358 189.304 41.4358C181.904 39.8358 175.704 39.7358 169.504 40.9358ZM185.804 74.8358C187.904 75.9358 229.704 117.136 281.704 169.136C363.504 251.136 373.904 261.836 374.504 265.236C376.204 274.436 377.804 272.436 326.204 324.336C299.004 351.536 277.104 372.736 275.304 373.536C270.904 375.436 266.604 375.336 262.204 373.036C257.604 370.636 76.8043 189.636 74.6043 185.236C72.4043 180.936 72.6043 175.636 75.0043 170.936C78.3043 164.336 78.8044 164.436 94.8044 172.336C108.704 179.136 109.704 179.436 117.404 179.736C123.904 180.036 126.704 179.636 131.504 177.936C136.904 175.836 139.304 173.836 156.604 156.536C173.904 139.236 175.904 136.836 178.004 131.436C179.704 126.636 180.104 123.836 179.804 117.336C179.504 109.636 179.204 108.636 172.404 94.7358C164.504 78.8358 164.504 78.3358 170.804 74.9358C175.604 72.4358 181.104 72.4358 185.804 74.8358ZM133.404 133.036L119.404 147.036L112.204 143.736L105.004 140.436L122.804 122.636L140.504 104.936L144.004 111.936L147.504 118.936L133.404 133.036Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M310.402 275.936C308.602 276.336 305.902 277.536 304.402 278.736C299.102 282.436 278.102 304.436 277.102 307.336C275.502 311.236 275.802 318.536 277.502 321.836C280.902 328.436 288.102 331.836 295.802 330.436C298.802 329.836 302.002 327.236 313.902 315.636C321.802 307.836 328.902 300.036 329.602 298.236C334.902 285.836 323.602 272.736 310.402 275.936Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M7.40372 276.837C-0.296283 281.537 -1.79628 290.337 2.00372 309.037C12.9037 362.537 55.5037 401.637 111.304 409.437L116.104 410.037L109.604 416.937C102.704 424.337 101.004 428.937 102.504 435.837C104.504 445.137 116.004 450.537 125.304 446.537C128.904 445.037 165.304 407.037 168.304 401.637C170.504 397.537 170.504 391.337 168.204 386.937C165.904 382.337 130.604 340.337 127.204 338.137C123.304 335.637 113.004 335.837 109.404 338.537C103.004 343.237 100.604 350.237 103.004 357.437C103.704 359.437 107.104 364.537 110.604 368.737C114.104 372.937 116.704 376.537 116.504 376.737C116.304 377.037 113.204 376.637 109.804 376.037C79.4037 370.237 54.9037 351.637 41.9037 324.437C36.6037 313.337 34.4037 305.937 32.9037 293.737C31.7037 284.037 30.2037 280.837 25.3037 277.437C20.5037 274.237 12.1037 273.937 7.40372 276.837Z" fill="currentColor" class="svelte-pyr5xt"></path>',1),WN=qn('<path d="M322.402 1.33524C319.002 2.83524 282.402 41.3352 279.802 46.2352C277.602 50.4352 277.602 56.6352 279.802 60.9352C282.102 65.5352 317.402 107.535 320.802 109.735C324.702 112.235 335.002 112.035 338.602 109.335C345.002 104.635 347.402 97.6352 345.002 90.4352C344.302 88.4352 340.902 83.3352 337.402 79.1352C333.902 74.9352 331.302 71.3352 331.502 71.1352C331.702 70.8352 334.802 71.2352 338.202 71.8352C379.802 79.7352 409.802 111.735 415.002 153.835C416.302 163.835 417.802 167.035 422.702 170.435C430.002 175.335 440.902 173.135 445.702 165.735C448.202 162.135 448.302 161.435 447.702 152.135C446.102 124.435 432.902 96.5352 411.102 74.9352C390.202 54.0352 367.102 42.7352 336.702 38.4352L331.902 37.8352L338.402 30.9352C345.302 23.5352 347.002 18.9352 345.502 12.0352C343.502 2.73524 331.702 -2.66476 322.402 1.33524Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M169.504 40.9358C163.204 42.2358 157.004 44.7358 152.004 47.9358C149.504 49.5358 125.204 73.2358 97.8044 100.636C44.9044 153.736 44.8044 153.936 41.4044 167.236C39.3044 175.336 40.0044 188.336 43.0044 196.136C44.1044 199.336 47.1044 204.436 49.4044 207.636C51.8044 210.836 95.8043 255.336 147.104 306.536C217.704 376.836 241.704 400.236 245.604 402.236C259.904 409.736 277.304 409.836 292.304 402.336C296.404 400.336 308.404 388.836 348.304 349.136C393.904 303.636 399.404 297.736 402.504 291.736C406.904 282.936 408.404 275.436 407.704 265.436C407.104 255.636 404.304 247.836 398.604 240.236C396.204 237.036 352.404 192.736 301.404 141.836C200.004 40.8358 204.204 44.5358 189.304 41.4358C181.904 39.8358 175.704 39.7358 169.504 40.9358ZM185.804 74.8358C187.904 75.9358 229.704 117.136 281.704 169.136C363.504 251.136 373.904 261.836 374.504 265.236C376.204 274.436 377.804 272.436 326.204 324.336C299.004 351.536 277.104 372.736 275.304 373.536C270.904 375.436 266.604 375.336 262.204 373.036C257.604 370.636 76.8043 189.636 74.6043 185.236C72.4043 180.936 72.6043 175.636 75.0043 170.936C78.3043 164.336 78.8044 164.436 94.8044 172.336C108.704 179.136 109.704 179.436 117.404 179.736C123.904 180.036 126.704 179.636 131.504 177.936C136.904 175.836 139.304 173.836 156.604 156.536C173.904 139.236 175.904 136.836 178.004 131.436C179.704 126.636 180.104 123.836 179.804 117.336C179.504 109.636 179.204 108.636 172.404 94.7358C164.504 78.8358 164.504 78.3358 170.804 74.9358C175.604 72.4358 181.104 72.4358 185.804 74.8358ZM133.404 133.036L119.404 147.036L112.204 143.736L105.004 140.436L122.804 122.636L140.504 104.936L144.004 111.936L147.504 118.936L133.404 133.036Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M310.402 275.936C308.602 276.336 305.902 277.536 304.402 278.736C299.102 282.436 278.102 304.436 277.102 307.336C275.502 311.236 275.802 318.536 277.502 321.836C280.902 328.436 288.102 331.836 295.802 330.436C298.802 329.836 302.002 327.236 313.902 315.636C321.802 307.836 328.902 300.036 329.602 298.236C334.902 285.836 323.602 272.736 310.402 275.936Z" fill="currentColor" class="svelte-pyr5xt"></path><path d="M7.40372 276.837C-0.296283 281.537 -1.79628 290.337 2.00372 309.037C12.9037 362.537 55.5037 401.637 111.304 409.437L116.104 410.037L109.604 416.937C102.704 424.337 101.004 428.937 102.504 435.837C104.504 445.137 116.004 450.537 125.304 446.537C128.904 445.037 165.304 407.037 168.304 401.637C170.504 397.537 170.504 391.337 168.204 386.937C165.904 382.337 130.604 340.337 127.204 338.137C123.304 335.637 113.004 335.837 109.404 338.537C103.004 343.237 100.604 350.237 103.004 357.437C103.704 359.437 107.104 364.537 110.604 368.737C114.104 372.937 116.704 376.537 116.504 376.737C116.304 377.037 113.204 376.637 109.804 376.037C79.4037 370.237 54.9037 351.637 41.9037 324.437C36.6037 313.337 34.4037 305.937 32.9037 293.737C31.7037 284.037 30.2037 280.837 25.3037 277.437C20.5037 274.237 12.1037 273.937 7.40372 276.837Z" fill="currentColor" class="svelte-pyr5xt"></path>',1),qN=(o,e)=>b(e,!0),HN=(o,e,t)=>e(n(t)),GN=de('<button><span class="timeframe-text svelte-pyr5xt"> </span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),YN=(o,e,t)=>e(t[0]),UN=(o,e,t)=>e(n(t)),KN=de('<button><span class="timeframe-text svelte-pyr5xt"> </span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),ZN=de('<div class="timeframe-group desktop-only svelte-pyr5xt"><!> <button><span class="timeframe-text svelte-pyr5xt">4h</span> <div class="timeframe-glow svelte-pyr5xt"></div></button> <!></div>'),XN=(o,e,t)=>e(t.find(s=>s.timeframe==="1d")),JN=de('<button><span class="timeframe-text svelte-pyr5xt">1d</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),QN=(o,e,t)=>e(t.find(s=>s.timeframe==="1w")),eR=de('<button><span class="timeframe-text svelte-pyr5xt">1w</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),tR=(o,e)=>b(e,!n(e)),oR=(o,e,t)=>e(n(t)),sR=de('<button><span class="timeframe-text svelte-pyr5xt"> </span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),nR=(o,e,t)=>e(t[0]),iR=(o,e,t)=>e(t.find(s=>s.timeframe==="1M")),rR=de('<button><span class="timeframe-text svelte-pyr5xt">1M</span> <div class="timeframe-glow svelte-pyr5xt"></div></button>'),aR=de('<div class="timeframe-inline-expand svelte-pyr5xt"><!> <button><span class="timeframe-text svelte-pyr5xt">4h</span> <div class="timeframe-glow svelte-pyr5xt"></div></button> <!></div>'),lR=de('<div class="timeframe-group mobile-only svelte-pyr5xt"><!> <!> <button aria-label="More timeframes" title="More"><span class="timeframe-text svelte-pyr5xt">⋯</span> <div class="timeframe-glow svelte-pyr5xt"></div></button> <!></div>'),cR=(o,e)=>b(e,!0),dR=(o,e)=>b(e,!0),uR=(o,e)=>b(e,!0),pR=(o,e)=>b(e,!0),vR=de('<button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Play" type="button"><!></button>'),fR=de('<button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" disabled title="Simulator active" type="button"><!></button>'),gR=(o,e)=>b(e,!0),mR=(o,e)=>b(e,!0),hR=(o,e,t)=>{e("🖱️ Fullscreen button clicked!"),t()},_R=(o,e)=>e(o),yR=(o,e)=>e(o),bR=o=>{o.preventDefault(),o.stopPropagation()},xR=(o,e)=>e(o),wR=de('<button class="menu-scroll-arrow svelte-pyr5xt" title="Scroll to see more" aria-label="Scroll right" type="button"><span class="arrow-icon svelte-pyr5xt"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-pyr5xt"><polyline points="9 18 15 12 9 6" class="svelte-pyr5xt"></polyline></svg></span></button>'),kR=de(`<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/50 svelte-pyr5xt" role="dialog" aria-modal="true"><div class="bg-base-100 rounded-lg shadow-xl p-6 w-full max-w-md svelte-pyr5xt"><div class="text-base-content text-lg font-semibold mb-2 svelte-pyr5xt">Switch chart template theme?</div> <div class="text-base-content/80 text-sm mb-5 svelte-pyr5xt"> <br class="svelte-pyr5xt"> Would you like to switch the chart template's theme too?</div> <div class="flex justify-end gap-2 svelte-pyr5xt"><button class="btn btn-sm svelte-pyr5xt" type="button">No</button> <button class="btn btn-sm btn-primary svelte-pyr5xt" type="button">Yes</button></div></div></div>`),SR=de('<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <div class="menu-wrapper svelte-pyr5xt"><div class="menu-container svelte-pyr5xt"><div class="menu-left-section svelte-pyr5xt"><div class="menu-toggle-wrapper svelte-pyr5xt"><button class="menu-toggle-btn svelte-pyr5xt" title="Toggle Left Panel"><div class="menu-toggle-icon-wrapper svelte-pyr5xt"><svg viewBox="0 0 1024 1024"><path d="M192.037 287.953h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32zM832.161 479.169H438.553c-17.673 0-32 14.327-32 32s14.327 32 32 32h393.608c17.673 0 32-14.327 32-32s-14.327-32-32-32zM832.161 735.802H192.037c-17.673 0-32 14.327-32 32s14.327 32 32 32h640.124c17.673 0 32-14.327 32-32s-14.327-32-32-32zM319.028 351.594l-160 160 160 160z" class="svelte-pyr5xt"></path></svg></div> <div class="menu-toggle-glow svelte-pyr5xt"></div></button></div> <!> <div class="rotate-button-wrapper-mobile svelte-pyr5xt"><button type="button"><!> <div class="menu-btn-content svelte-pyr5xt"><div class="menu-icon-wrapper svelte-pyr5xt"><svg width="20" height="20" viewBox="0 0 448 448" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-pyr5xt"><!></svg></div></div> <div class="menu-btn-glow svelte-pyr5xt"></div></button></div> <div class="symbol-search-section svelte-pyr5xt"><div class="symbol-search-content svelte-pyr5xt"><div class="symbol-search-icon svelte-pyr5xt"><!></div> <span class="symbol-name svelte-pyr5xt"> </span></div></div> <div class="timeframe-section svelte-pyr5xt"><!> <!></div> <div class="ai-section svelte-pyr5xt"><button class="ai-btn group relative overflow-hidden svelte-pyr5xt" aria-label="AI Indicators" title="AI Powered Indicators" type="button"><div class="ai-glitter-bg svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-1 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-2 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-3 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-4 svelte-pyr5xt"></div> <div class="ai-glitter-particle ai-glitter-5 svelte-pyr5xt"></div> <div class="ai-shine-sweep svelte-pyr5xt"></div> <div class="ai-btn-content svelte-pyr5xt"><div class="ai-icon-wrapper svelte-pyr5xt"><svg class="ai-icon svelte-pyr5xt" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" class="svelte-pyr5xt"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96" class="svelte-pyr5xt"></polyline><line x1="12" y1="22.08" x2="12" y2="12" class="svelte-pyr5xt"></line></svg></div> <span class="ai-text svelte-pyr5xt">AI</span> <div class="ai-badge-mini svelte-pyr5xt">New</div></div></button></div> <div class="chart-type-section svelte-pyr5xt"><button class="pro-menu-btn svelte-pyr5xt" title="Chart Type"><!> <span class="pro-menu-text svelte-pyr5xt"> </span></button></div> <div class="indicator-section svelte-pyr5xt"><button class="pro-menu-btn svelte-pyr5xt" title="Indicators"><!> <span class="pro-menu-text svelte-pyr5xt"> </span></button></div> <div class="undo-redo-section svelte-pyr5xt"><button title="Undo (Ctrl+Z)"><!></button> <button title="Redo (Ctrl+Y)"><!></button></div></div> <div class="menu-right-section svelte-pyr5xt"><!> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Load Chart Layout" type="button"><!></button> <!> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Timezone" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Settings" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Script Studio" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Screenshot" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" type="button"><!></button> <button class="pro-menu-btn pro-menu-btn-icon-only svelte-pyr5xt" title="Toggle Theme" type="button"><!></button></div></div> <!></div> <!> <!>',1);function CR(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(p,"$chart",t),i=()=>ir(y,"$save",t),r=()=>ir(_,"$ctx",t),a=()=>ir(Up,"$userPreferences",t),l=()=>ir(Td,"$simulator",t);let d=Ss(e,"customLoad",3,!1),v=Ss(e,"mainContainer",15);const p=Fa("chart"),_=Fa("ctx"),y=Fa("save");let w=oe(!0);Rd(()=>{try{const Ge=sessionStorage.getItem("drawbarShown");if(Ge!=null){b(w,Ge==="true");const at=v(),So=typeof document<"u"?document.querySelector(".kline-main"):null,qt=typeof document<"u"?document.querySelector(".drawbar-host"):null,Io=n(w)?"52px":"0px";at&&at.style.setProperty("--drawing-bar-width",Io),So&&So.style.setProperty("--drawing-bar-width",Io),qt&&(qt.style.width=Io)}else{const at=typeof document<"u"?document.querySelector(".drawbar-host"):null;if(at){const So=parseFloat(getComputedStyle(at).width||"52");b(w,So>0)}}}catch{}});const k="*";function S(){let Ge=document;return(Ge.fullscreenElement||Ge.mozFullScreenElement||Ge.webkitFullscreenElement||Ge.msFullscreenElement)!=null}let L=oe(j(S())),T=oe(!1);{const Ge=()=>{const So=n(L);if(b(L,j(S())),So&&!n(L)){if(s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const qt=Ul(i().theme);Rt.merge(qt,i().styles),s().setStyles(al(qt)),r().applyCanvasColors&&r().applyCanvasColors(),console.log("🎨 Pre-applied chart styles before fullscreen exit")}v()&&(v(v().style.cssText="",!0),v().classList.remove("fullscreen")),setTimeout(()=>{var qt;if(v()&&(v().offsetHeight,v().offsetWidth,window.getComputedStyle(v()).height),(qt=s())==null||qt.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Io=Ul(i().theme);Rt.merge(Io,i().styles),s().setStyles(al(Io)),r().applyCanvasColors&&r().applyCanvasColors()}},10),setTimeout(()=>{var qt;if((qt=s())==null||qt.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Io=Ul(i().theme);Rt.merge(Io,i().styles),s().setStyles(al(Io)),r().applyCanvasColors&&r().applyCanvasColors()}},100),setTimeout(()=>{var qt;if((qt=s())==null||qt.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Io=Ul(i().theme);if(Rt.merge(Io,i().styles),s().setStyles(al(Io)),r().applyCanvasColors){r().applyCanvasColors();const us=s().getVisibleRange();us&&s().scrollToDataIndex(us.to,0)}console.log("✅ Final chart colors applied after fullscreen exit")}},300),setTimeout(()=>{var qt;(qt=s())==null||qt.resize()},600),setTimeout(()=>{var qt;(qt=s())==null||qt.resize()},1200)}else setTimeout(()=>{var qt;(qt=s())==null||qt.resize()},100)},at=()=>{if(console.log("📱 handleIOSFullscreenChange triggered"),rn()){const So=window.innerHeight===screen.height,qt=document.body.classList.contains("ios-fullscreen"),Io=window.navigator.standalone;console.log("🔍 iOS fullscreen checks:",{heightMatch:So,hasIOSClass:qt,isStandalone:Io,windowHeight:window.innerHeight,screenHeight:screen.height,currentFullScreen:n(L)});const us=So||qt||Io,fn=n(L);if(n(L)!==us){if(console.log(`🔄 iOS fullscreen state changed: ${n(L)} → ${us}`),b(L,j(us)),fn&&!us&&s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const Ts=Ul(i().theme);Rt.merge(Ts,i().styles),s().setStyles(al(Ts)),r().applyCanvasColors&&r().applyCanvasColors(),console.log("🎨 Pre-applied chart styles for iOS exit")}console.log("📏 Scheduling iOS chart resizes..."),setTimeout(()=>{var Ts;if((Ts=s())==null||Ts.resize(),fn&&!us&&s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const js=Ul(i().theme);Rt.merge(js,i().styles),s().setStyles(al(js)),r().applyCanvasColors&&r().applyCanvasColors()}},100),setTimeout(()=>{var Ts;if((Ts=s())==null||Ts.resize(),fn&&!us&&s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const js=Ul(i().theme);if(Rt.merge(js,i().styles),s().setStyles(al(js)),r().applyCanvasColors){r().applyCanvasColors();const on=s().getVisibleRange();on&&s().scrollToDataIndex(on.to,0)}console.log("✅ Final iOS chart colors applied")}},300)}else console.log("✅ No iOS fullscreen state change needed")}else console.log("❌ Not iOS Safari, skipping handler")};document.addEventListener("fullscreenchange",Ge),document.addEventListener("webkitfullscreenchange",Ge),document.addEventListener("mozfullscreenchange",Ge),document.addEventListener("MSFullscreenChange",Ge),rn()&&(window.addEventListener("resize",at),window.addEventListener("orientationchange",at),document.addEventListener("webkitfullscreenchange",at),"standalone"in window.navigator&&window.addEventListener("beforeunload",()=>{n(Ae)&&n(Ae)()}))}let P=oe(!1),A=oe(!1),F=oe(!1),B=oe(!1),R=oe(!1),N=oe(!1),$=oe(!1),V=oe(!1),U=oe(""),G=oe(""),Z=oe(!1),le=oe(!1),se=oe(!1),ie=oe(!1),Y=oe(!1),K=oe(null),Q=oe(!1),q=oe(!1),ce=oe(!1),_e=oe(j({x:0,y:0})),me=oe(!1),Pe=oe(j({x:0,y:0})),ze=oe(j([])),he=oe(null),De=oe(!1),ge=oe(!1),be=!1,$e=oe(!1),Ve=oe(""),Ce=oe(!1),Je=oe(j({x:0,y:0}));function ye(){try{if(v()){const at=(v().querySelector(".chart-container")||v()).getBoundingClientRect();b(Je,j({x:at.left+at.width/2,y:at.top+at.height/2}))}else{const Ge=typeof window<"u"?window.innerWidth:0,at=typeof window<"u"?window.innerHeight:0;b(Je,j({x:Ge/2,y:at/2}))}}catch{}}let Ae=oe(null);function ee(Ge){console.log(Ge)}let xe=oe(void 0);const ke=[{timeframe:"1m",multiplier:1,timespan:"minute",secs:60},{timeframe:"5m",multiplier:5,timespan:"minute",secs:300},{timeframe:"15m",multiplier:15,timespan:"minute",secs:900},{timeframe:"30m",multiplier:30,timespan:"minute",secs:1800},{timeframe:"1h",multiplier:1,timespan:"hour",secs:3600}],He=[{timeframe:"1d",multiplier:1,timespan:"day",secs:86400},{timeframe:"1w",multiplier:1,timespan:"week",secs:604800},{timeframe:"1M",multiplier:1,timespan:"month",secs:2592e3}],Ie=[{timeframe:"4h",multiplier:4,timespan:"hour",secs:14400}],ne=[{id:"candle_solid",name:"Candlestick",icon:"candle_solid"},{id:"candle_stroke",name:"Hollow",icon:"candle_stroke"},{id:"candle_up_stroke",name:"Up Hollow",icon:"candle_up_stroke"},{id:"candle_down_stroke",name:"Down Hollow",icon:"candle_down_stroke"},{id:"heikin_ashi",name:"Heikin Ashi",icon:"candle_solid"},{id:"renko_atr",name:"Duty AI Renko",icon:"candle_solid"},{id:"point_and_figure",name:"Point & Figure",icon:"point_and_figure"},{id:"ohlc",name:"OHLC",icon:"ohlc"},{id:"area",name:"Area",icon:"area"},{id:"line_chart",name:"Line",icon:"line"}];let J=oe(!1),qe=oe(!1),ft=oe(!1),Qe=oe(!1),Oe=oe(void 0);Wi(()=>{let Ge=null,at=null;function So(){return typeof window<"u"&&window.saveManager?(Ge=window.saveManager.state.subscribe(Io=>{console.log("📊 SaveManager state updated:",Io),Io.initialized?(console.log("🔗 SaveManager is initialized, updating UI state..."),b(ze,j(Io.savedLayouts)),b(he,j(Io.activeSaveId)),b(De,j(Io.isLoading)),at&&(clearInterval(at),at=null)):console.log("⏳ SaveManager exists but not yet initialized...")}),!0):!1}return So()||(console.log("⏳ Waiting for SaveManager to be available..."),at=setInterval(()=>{So()},100)),()=>{Ge&&Ge(),at&&clearInterval(at)}});function ct(){s()&&setTimeout(()=>{s().resize()},300)}Rd(()=>{Dc.init({chart:s(),saveStore:y,overlaysStore:null});const Ge=()=>{b(qe,j(Dc.canUndo())),b(ft,j(Dc.canRedo()))};Ge();const at=setInterval(Ge,100);"screen"in window&&"orientation"in window.screen?window.screen.orientation.addEventListener("change",ct):window.addEventListener("orientationchange",ct),ml();const So=()=>{ml()},qt=()=>{ml(),typeof window<"u"&&b(ie,window.innerWidth<=768)};return n(Oe)&&n(Oe).addEventListener("scroll",So),window.addEventListener("resize",qt),setTimeout(()=>{ml(),typeof window<"u"&&b(ie,window.innerWidth<=768)},500),()=>{clearInterval(at),"screen"in window&&"orientation"in window.screen?window.screen.orientation.removeEventListener("change",ct):window.removeEventListener("orientationchange",ct),n(Oe)&&n(Oe).removeEventListener("scroll",So),window.removeEventListener("resize",qt)}});function Lt(){n(qe)&&Dc.undo()}function It(){n(ft)&&Dc.redo()}function zt(Ge){var at;Ir(y,Uo(i).period=Ge,Uo(i));try{const So=(at=i())!=null&&at.key&&typeof i().key=="string"?i().key:"chart";typeof localStorage<"u"&&localStorage.setItem(`${So}.lastTimeframe`,(Ge==null?void 0:Ge.timeframe)||"")}catch{}n(se)&&b(se,!1)}function pt(){var So,qt,Io,us;if((qt=(So=i().styles)==null?void 0:So.candle)!=null&&qt._isLineChart)return ne.find(fn=>fn.id==="line_chart")||ne[0];const Ge=((us=(Io=i().styles)==null?void 0:Io.candle)==null?void 0:us.type)||"renko_atr";return ne.find(fn=>fn.id===Ge)||ne[0]}const Mo=Cc(y,Ge=>Ge.symbol.ticker),Xo=Cc(y,Ge=>Ge.symbol.shortName);Mo.subscribe(()=>{b(G,j(i().symbol.shortName||i().symbol.ticker))}),Xo.subscribe(()=>{b(G,j(i().symbol.shortName||i().symbol.ticker))});function en(){const Ge=i().styles||{},at=Ul(i().theme);if(Ge.backgroundColor||Ge.backgroundGradient||Ge.backgroundType||Ge.backgroundOpacity!==void 0||Ge.gridGradient||Ge.gridType||Ge.gridOpacity!==void 0)return!0;const So=_s=>{if(!_s||typeof _s!="string")return"";const In=_s.trim().toLowerCase();if(In.startsWith("rgba(")){const Ci=In.match(/rgba\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)/);if(Ci){const zr=Number(Ci[1]).toString(16).padStart(2,"0"),ca=Number(Ci[2]).toString(16).padStart(2,"0"),hl=Number(Ci[3]).toString(16).padStart(2,"0");return`#${zr}${ca}${hl}`}}return In},qt=So(Rt.get(Ge,"pane.backgroundColor")),Io=So(Rt.get(Ge,"candle.pane.backgroundColor")),us=So(Rt.get(at,"pane.backgroundColor"));if(qt&&us&&qt!==us||Io&&us&&Io!==us)return!0;const fn=So(Rt.get(Ge,"grid.horizontal.color")),Ts=So(Rt.get(Ge,"grid.vertical.color")),js=So(Rt.get(at,"grid.horizontal.color")),on=So(Rt.get(at,"grid.vertical.color"));return!!(fn&&js&&fn!==js||Ts&&on&&Ts!==on)}function Fo(Ge){try{if(window.self!==window.top){const at={type:"theme-change",theme:Ge};let So=k;try{window.parent.location&&(So=window.parent.location.origin)}catch{So=k}window.parent.postMessage(at,So),console.log("📤 Sent theme-change message to parent:",at,"origin:",So)}}catch(at){console.error("Failed to send theme-change message to parent:",at)}}function Eo(Ge,at){var Io,us,fn,Ts,js;const So=document.querySelector(".kline-main");if(So&&So.setAttribute("data-theme",Ge),at){try{const on=localStorage.getItem("chart");if(on){const _s=JSON.parse(on);_s.styles&&(delete _s.styles.backgroundColor,delete _s.styles.backgroundOpacity,delete _s.styles.backgroundType,delete _s.styles.backgroundGradient,_s.styles.grid&&(delete _s.styles.grid.horizontal,delete _s.styles.grid.vertical),delete _s.styles.gridColor,delete _s.styles.gridOpacity,delete _s.styles.gridType,delete _s.styles.gridGradient,localStorage.setItem("chart",JSON.stringify(_s)),console.log("🧹 Cleared custom background and grid colors from localStorage"))}}catch(on){console.error("Failed to clear custom colors from localStorage:",on)}if(s()){window.__forceApplyThemeDefaults=!0;const on=Ul(Ge),_s=JSON.parse(JSON.stringify(i().styles||{})),In=on,Ci={..._s,pane:{..._s.pane,backgroundColor:In.pane.backgroundColor},candle:{..._s.candle,pane:{...(Io=_s.candle)==null?void 0:Io.pane,backgroundColor:In.candle.pane.backgroundColor}},grid:{..._s.grid,horizontal:{...(us=_s.grid)==null?void 0:us.horizontal,color:In.grid.horizontal.color},vertical:{...(fn=_s.grid)==null?void 0:fn.vertical,color:In.grid.vertical.color}}},zr=(Ts=_s==null?void 0:_s.candle)==null?void 0:Ts.type,ca=Rt.merge({},on,Ci);delete ca.backgroundColor,delete ca.backgroundOpacity,delete ca.backgroundType,delete ca.backgroundGradient,delete ca.gridColor,delete ca.gridOpacity,delete ca.gridType,delete ca.gridGradient,zr&&ca.candle&&(ca.candle.type=zr),s().setStyles(al(ca)),Ir(y,Uo(i).styles=ca,Uo(i))}try{const on=new S1("chart-settings",p,Ge);on.resetToThemeDefaults(Ge),on.destroy(),console.log("🔄 Reset TransactionalThemeManager for theme toggle")}catch(on){console.error("Failed to reset TransactionalThemeManager:",on)}}Ir(y,Uo(i).theme=Ge,Uo(i));const qt=(js=a())==null?void 0:js.data;if(qt!=null&&qt.clerkId){const on=Ge==="dark"?"Dark":"Light";qM(qt.clerkId,on).catch(_s=>{console.error("Failed to save theme to API:",_s)})}Fo(Ge)}function cs(){const Ge=Rt.get(i().styles,"backgroundType")==="gradient",at=Rt.get(i().styles,"backgroundGradient"),So=Ge&&at&&Array.isArray(at.stops)&&at.stops.length>0,qt=(us,fn)=>{const Ts=(us||"#000000").replace("#",""),js=parseInt(Ts.substring(0,2),16)||0,on=parseInt(Ts.substring(2,4),16)||0,_s=parseInt(Ts.substring(4,6),16)||0,In=Math.max(0,Math.min(1,fn??1));return`rgba(${js}, ${on}, ${_s}, ${In})`};if(So){requestAnimationFrame(()=>{var us,fn;try{const Ts=(us=s())==null?void 0:us.getConvertPictureUrl(!0,"png","rgba(0, 0, 0, 0)");if(!Ts)return;const js=new Image;js.onload=()=>{const on=js.naturalWidth||js.width,_s=js.naturalHeight||js.height,In=document.createElement("canvas");In.width=on,In.height=_s;const Ci=In.getContext("2d");if(!Ci)return;let zr;if((at.type==="radial"?"radial":"linear")==="radial")zr=Ci.createRadialGradient(on/2,_s/2,0,on/2,_s/2,Math.max(on,_s)/2);else{const za=((typeof at.direction=="number"?at.direction:90)-90)*Math.PI/180,oc=Math.cos(za),sc=Math.sin(za),Cl=on/2-on/2*oc,Vl=_s/2-_s/2*sc,ul=on/2+on/2*oc,nc=_s/2+_s/2*sc;zr=Ci.createLinearGradient(Cl,Vl,ul,nc)}[...at.stops].sort((fa,za)=>(fa.position??0)-(za.position??0)).forEach(fa=>{const za=Math.max(0,Math.min(1,(fa.position??0)/100)),oc=qt(fa.color,(fa.opacity??100)/100);zr.addColorStop(za,oc)}),Ci.fillStyle=zr,Ci.fillRect(0,0,on,_s),Ci.drawImage(js,0,0,on,_s),b(U,j(In.toDataURL("image/png"))),b(N,!0)},js.src=Ts}catch{let js=i().theme==="dark"?"#151517":"#ffffff";b(U,j(((fn=s())==null?void 0:fn.getConvertPictureUrl(!0,"jpeg",js))??"")),b(N,!0)}});return}let Io;try{const us=document.querySelector(".kline-widget"),fn=document.querySelector(".kline-main"),Ts=js=>{if(!js)return"";const on=getComputedStyle(js).getPropertyValue("--chart-background-color").trim();return on&&!on.includes("gradient")?on:""};if(Io=Ts(us)||Ts(fn)||void 0,!Io&&s()&&typeof s().getStyles=="function"){const js=s().getStyles()??{};Io=Rt.get(js,"pane.backgroundColor")||Rt.get(js,"candle.pane.backgroundColor")||void 0}if(!Io){const js=Rt.get(i().styles,"backgroundColor");Io=js&&typeof js=="string"?js:void 0}}catch{}Io||(Io=i().theme==="dark"?"#151517":"#ffffff"),requestAnimationFrame(()=>{var us;b(U,j(((us=s())==null?void 0:us.getConvertPictureUrl(!0,"jpeg",Io))??"")),b(N,!0)})}function Zt(){if(rn()&&n(Ae)){n(Ae)();return}let Ge=document;const at=Ge.exitFullscreen??Ge.mozCancelFullScreen??Ge.webkitExitFullscreen??Ge.msExitFullscreen;at?at.call(Ge):rn()&&rr()}function bs(){ee("🔄 toggleFullscreen called, current fullScreen: "+n(L)),ee("🔍 iOS detection - isIOS(): "+es()+", isIOSSafari(): "+rn()),n(L)?(ee("🚪 Exiting fullscreen..."),Zt()):rn()?(ee("📱 Using iOS Safari fullscreen method"),wr()):(ee("🖥️ Using standard fullscreen method"),ar())}function es(){return/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1}function rn(){const Ge=navigator.userAgent,at=/iPad|iPhone|iPod/.test(Ge)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,So=/Safari/.test(Ge)&&!/Chrome|CriOS|FxiOS/.test(Ge);return at&&So}function wr(){return ee("📱 enterFullscreenIOS called"),new Promise(Ge=>{var So;const at=v();if(ee("🎯 mainContainer element: "+(at?"Found":"Not found")),at&&at.webkitRequestFullscreen){ee("🔧 Trying webkitRequestFullscreen...");try{at.webkitRequestFullscreen(),setTimeout(()=>{ee("✅ webkitRequestFullscreen success, setting fullScreen = true"),b(L,!0),Ge(!0)},300);return}catch(qt){ee("❌ webkitRequestFullscreen failed: "+qt)}}else ee("❌ webkitRequestFullscreen not available");if(at&&at.webkitEnterFullscreen)try{at.webkitEnterFullscreen(),setTimeout(()=>{b(L,!0),Ge(!0)},300);return}catch(qt){console.log("webkitEnterFullscreen failed:",qt)}ee("🔧 Trying viewport manipulation fallback...");try{const qt=document.querySelector('meta[name="viewport"]'),Io=(qt==null?void 0:qt.getAttribute("content"))||"";ee("📋 Original viewport content: "+Io);const us=qt||document.createElement("meta");us.setAttribute("name","viewport"),us.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"),qt?console.log("🔄 Updated existing viewport meta tag"):(document.head.appendChild(us),console.log("➕ Added new viewport meta tag")),window.scrollTo(0,1),console.log("📜 Scrolled to hide Safari UI");const fn=document.createElement("style");fn.id="ios-fullscreen-style",fn.textContent=`
          body.ios-fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100vh !important;
            overflow: hidden !important;
            -webkit-overflow-scrolling: touch !important;
          }
          
          .ios-fullscreen #main-container {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999 !important;
          }
          
          /* Hide Safari bottom bar */
          @supports (padding: max(0px)) {
            .ios-fullscreen {
              padding-bottom: env(safe-area-inset-bottom) !important;
            }
          }
        `,document.head.appendChild(fn),console.log("🎨 Added iOS fullscreen CSS styles");const Ts=((So=v())==null?void 0:So.getAttribute("data-theme"))||i().theme;ee("🎨 Preserving theme during iOS fullscreen: "+Ts),document.body.classList.add("ios-fullscreen"),console.log("✅ Applied ios-fullscreen class to body"),v()&&(v().setAttribute("data-theme",Ts),ee("🔄 Restored theme attribute: "+Ts)),setTimeout(()=>{window.scrollTo(0,0),b(L,!0),ee("🎯 iOS fullscreen activated successfully!"),b(Ae,()=>{var _s;ee("🧹 Cleaning up iOS fullscreen...");const js=((_s=v())==null?void 0:_s.getAttribute("data-theme"))||i().theme;ee("🎨 Preserving theme during cleanup: "+js),document.body.classList.remove("ios-fullscreen");const on=document.getElementById("ios-fullscreen-style");on&&on.remove(),qt&&Io&&qt.setAttribute("content",Io),v()&&(v().setAttribute("data-theme",js),ee("🔄 Restored theme attribute after cleanup: "+js)),b(L,!1),ee("✅ iOS fullscreen cleanup completed")}),Ge(!0)},100)}catch(qt){console.log("iOS Safari viewport fallback failed:",qt),Ge(!1)}})}function rr(){var Ge;if(console.log("🚪 exitFullscreenIOS called"),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const at=Ul(i().theme);Rt.merge(at,i().styles),s().setStyles(al(at)),r().applyCanvasColors&&r().applyCanvasColors(),console.log("🎨 Pre-applied styles before iOS exit")}try{document.webkitExitFullscreen?(console.log("🔧 Trying webkitExitFullscreen..."),document.webkitExitFullscreen()):console.log("❌ webkitExitFullscreen not available"),n(Ae)?(console.log("🧹 Using stored cleanup function..."),n(Ae)(),b(Ae,null)):console.log("❌ No stored cleanup function available"),console.log("🔧 Performing manual cleanup...");const at=((Ge=v())==null?void 0:Ge.getAttribute("data-theme"))||i().theme;console.log("🎨 Preserving theme during manual cleanup: "+at),document.body.classList.remove("ios-fullscreen");const So=document.getElementById("ios-fullscreen-style");So&&(So.remove(),console.log("🗑️ Removed iOS fullscreen styles"));const qt=document.querySelector('meta[name="viewport"]');qt&&(qt.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),console.log("📱 Restored viewport meta tag")),v()&&(v().setAttribute("data-theme",at),console.log("🔄 Restored theme attribute after manual cleanup: "+at)),b(L,!1),console.log("✅ Set fullScreen = false"),setTimeout(()=>{var Io;if(console.log("📏 First chart resize..."),(Io=s())==null||Io.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const us=Ul(i().theme);Rt.merge(us,i().styles),s().setStyles(al(us)),r().applyCanvasColors&&r().applyCanvasColors()}},10),setTimeout(()=>{var Io;if((Io=s())==null||Io.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const us=Ul(i().theme);Rt.merge(us,i().styles),s().setStyles(al(us)),r().applyCanvasColors&&r().applyCanvasColors()}},100),setTimeout(()=>{var Io;if((Io=s())==null||Io.resize(),s()&&i().styles){window.__forceApplySavedCanvasColors=!0;const us=Ul(i().theme);if(Rt.merge(us,i().styles),s().setStyles(al(us)),r().applyCanvasColors){r().applyCanvasColors();const fn=s().getVisibleRange();fn&&s().scrollToDataIndex(fn.to,0)}console.log("✅ Final iOS chart colors applied after exit")}},300)}catch(at){console.log("❌ iOS exit fullscreen failed:",at)}}function ar(){return es()?wr():new Promise(Ge=>{let at=v();at&&at.requestFullscreen?at.requestFullscreen().then(()=>Ge(!0)).catch(()=>Ge(!1)):at&&at.mozRequestFullScreen?(at.mozRequestFullScreen(),setTimeout(()=>Ge(!0),100)):at&&at.webkitRequestFullscreen?(at.webkitRequestFullscreen(),setTimeout(()=>Ge(!0),100)):at&&at.msRequestFullscreen?(at.msRequestFullscreen(),setTimeout(()=>Ge(!0),100)):Ge(!1)})}function jr(){ii();const Ge=document.createElement("div");Ge.id="ios-rotation-hint",Ge.innerHTML=`
      <div style="
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        z-index: 10000;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        max-width: 280px;
        backdrop-filter: blur(10px);
      ">
        <div style="font-size: 24px; margin-bottom: 10px;">📱</div>
        <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Rotate Your Device</div>
        <div style="font-size: 14px; opacity: 0.8;">Turn your device to landscape mode for the best experience</div>
        <div style="margin-top: 15px; font-size: 12px; opacity: 0.6;">Tap anywhere to dismiss</div>
      </div>
    `,Ge.onclick=ii,document.body.appendChild(Ge),setTimeout(ii,4e3)}function ii(){const Ge=document.getElementById("ios-rotation-hint");Ge&&Ge.remove()}async function Xa(){if(typeof window<"u"&&window.saveManager){const Ge=window.saveManager,at=Ge.getState();if(b(Ce,!1),at.activeSaveId){const So=await Ge.quickSave();So.success||console.error("Quick save failed:",So.error),So.success&&(b(ce,!1),b(Ve,"Saved to current layout"),b($e,!0),setTimeout(()=>{b($e,!1)},2e3),b(Ce,!0),ye(),setTimeout(()=>{b(Ce,!1)},1500))}else b(ce,!1),b(Q,!0)}}function Ja(){b(ce,!1),b(q,!0)}function Va(){b(ce,!1),b(Q,!0)}async function Wa(Ge){const{layoutId:at}=Ge.detail;if(typeof window<"u"&&window.saveManager){const So=window.saveManager;b(ge,!0);const qt=await So.load(at);b(ge,!1),qt.success||console.error("Load failed:",qt.error)}}async function Qa(Ge){const{layoutId:at}=Ge.detail;if(typeof window<"u"&&window.saveManager){const qt=await window.saveManager.delete(at);if(!qt.success){console.error("Delete failed:",qt.error);return}b(ze,j((n(ze)||[]).filter(Io=>Io.id!==at))),n(he)===at&&b(he,null),b(De,!1)}}async function qa(Ge){const{name:at}=Ge.detail;if(typeof window<"u"&&window.saveManager){const So=window.saveManager;b(Ce,!1);const qt=await So.save(at);qt.success?(b(Q,!1),b(Ce,!0),ye(),setTimeout(()=>{b(Ce,!1)},1500)):console.error("Save failed:",qt.error)}}function Kl(){b(Q,!1)}async function ll(Ge){const{layoutId:at}=Ge.detail;if(console.log("💾 SaveAsSelectSave triggered with layoutId:",at),typeof window<"u"&&window.saveManager){const So=window.saveManager;console.log("✅ SaveManager found, calling saveTo..."),b(Ce,!1);const qt=await So.saveTo(at);qt.success?(console.log("✅ Save to existing successful"),b(q,!1),b(Ce,!0),ye(),setTimeout(()=>{b(Ce,!1)},1500)):console.error("❌ Save to existing failed:",qt.error)}else console.error("❌ SaveManager not available")}function Wr(){b(q,!1),vl()}function Ca(){b(q,!1)}function vl(){console.log("🎯 Save button clicked, showing popup..."),console.log("📊 Current savedLayouts:",n(ze)),console.log("🎯 Current activeSaveId:",n(he)),console.log("💾 SaveManager available:",!!window.saveManager);try{if(typeof window<"u"&&window.saveManager){const at=window.saveManager.getState();if(!at||!Array.isArray(at.savedLayouts)||at.savedLayouts.length===0){b(ce,!1),b(Q,!0);return}}else if(!n(ze)||n(ze).length===0){b(ce,!1),b(Q,!0);return}}catch{b(ce,!1),b(Q,!0);return}if(v()){const Ge=v().querySelector(".chart-container");if(Ge){const at=Ge.getBoundingClientRect();b(_e,j({x:at.left+at.width/2,y:at.top+at.height/2}))}else{const at=v().getBoundingClientRect();b(_e,j({x:at.left+at.width/2,y:at.top+at.height/2}))}}b(ce,!0)}function ml(){if(!n(Oe))return;const{scrollWidth:Ge,clientWidth:at,scrollLeft:So}=n(Oe),qt=Ge>at,Io=So+at>=Ge-5;b(Qe,j(qt&&!Io))}function Sl(Ge){if(Ge&&(Ge.preventDefault(),Ge.stopPropagation()),!n(Oe))return;const{scrollLeft:at,clientWidth:So,scrollWidth:qt}=n(Oe),Io=So*.7,us=Math.min(at+Io,qt-So);try{n(Oe).scrollTo({left:us,behavior:"smooth"})}catch{n(Oe).scrollLeft=us}}function el(Ge){Ge.preventDefault(),Ge.stopPropagation(),Sl()}var or=SR(),tc=_t(or);TF(tc,{get show(){return n(P)},set show(Ge){b(P,j(Ge))}});var pe=u(tc,2);DF(pe,{get show(){return n(A)},set show(Ge){b(A,j(Ge))}});var rt=u(pe,2);mD(rt,{get show(){return n(F)},set show(Ge){b(F,j(Ge))}});var Ft=u(rt,2);Tj(Ft,{get show(){return r().modalIndCfg},set show(Ge){Ir(_,Uo(r).modalIndCfg=Ge,Uo(r))}});var Qt=u(Ft,2);Qz(Qt,{get show(){return n(B)},set show(Ge){b(B,j(Ge))}});var xt=u(Qt,2);Fx(xt,{get show(){return n(R)},set show(Ge){b(R,j(Ge))}});var eo=u(xt,2);tB(eo,{get show(){return n(N)},set show(Ge){b(N,j(Ge))},get url(){return n(U)},set url(Ge){b(U,j(Ge))}});var Is=u(eo,2);iB(Is,{get show(){return n($)},set show(Ge){b($,j(Ge))}});var Po=u(Is,2);uB(Po,{get show(){return n(J)},set show(Ge){b(J,j(Ge))}});var Ze=u(Po,2);TB(Ze,{get show(){return n(V)},set show(Ge){b(V,j(Ge))}});var Ke=u(Ze,2);OB(Ke,{get show(){return n(Q)},set show(Ge){b(Q,j(Ge))},get savedLayouts(){return n(ze)},get isLoading(){return n(De)},mode:"save",showExisting:!1,$$events:{save:qa,cancel:Kl}});var ps=u(Ke,2);fN(ps,{get show(){return n(q)},set show(Ge){b(q,j(Ge))},get savedLayouts(){return n(ze)},get isLoading(){return n(De)},$$events:{saveTo:ll,back:Wr,cancel:Ca}});var pn=u(ps,2);JB(pn,{get show(){return n(ce)},set show(Ge){b(ce,j(Ge))},get savedLayouts(){return n(ze)},get activeSaveId(){return n(he)},get isLoading(){return n(De)},get hasUnsavedChanges(){return be},get position(){return n(_e)},showLayouts:!1,$$events:{save:Xa,saveAs:Ja,quickSave:Xa,newLayout:Va}});var Jo=u(pn,2);iN(Jo,{get show(){return n(me)},set show(Ge){b(me,j(Ge))},get savedLayouts(){return n(ze)},get activeSaveId(){return n(he)},get position(){return n(Pe)},get isLoading(){return n(De)},$$events:{load:Wa,delete:Qa}});var ti=u(Jo,2);Dx(ti,{get visible(){return n($e)},set visible(Ge){b($e,j(Ge))},get message(){return n(Ve)},duration:2e3});var mr=u(ti,2);Se(mr,()=>n(Ce),Ge=>{var at=BN();we(()=>St(at,"style",`left: ${n(Je).x??""}px; top: ${n(Je).y??""}px;`)),O(Ge,at)});var sa=u(mr,2),yt=g(sa),wt=g(yt),to=g(wt),mt=g(to);mt.__click=[$N,w,v,s,p];var Wt=g(mt),vt=g(Wt);f(Wt),un(2),f(mt),f(to);var $t=u(to,2);Se($t,d,Ge=>{var at=RN(),So=g(at);So.__change=[EN,G,i,y,s,p,r,_],Ec(So,Io=>b(xe,Io),()=>n(xe));var qt=u(So,2);qt.__click=[NN,xe],f(at),O(Ge,at)});var zo=u($t,2),bo=g(zo);bo.__click=[jN,le,Z,es,wr,jr,s,p,ar,ii,L,Zt];var xo=g(bo);Se(xo,()=>n(le),Ge=>{var at=ON();O(Ge,at)});var Zo=u(xo,2),os=g(Zo),ri=g(os),vn=g(ri);Se(vn,()=>n(Z),Ge=>{var at=VN();un(3),O(Ge,at)},Ge=>{var at=WN();un(3),O(Ge,at)}),f(ri),f(os),f(Zo),un(2),f(bo),f(zo);var sr=u(zo,2);sr.__click=[qN,P];var Ko=g(sr),Hn=g(Ko),ji=g(Hn);VA(ji,{class:"search-icon"}),f(Hn);var zn=u(Hn,2),Vs=g(zn,!0);f(zn),f(Ko),f(sr);var Bn=u(sr,2),tr=g(Bn);Se(tr,()=>!n(ie),Ge=>{var at=ZN(),So=g(at);Ns(So,17,()=>ke,dn,(us,fn)=>{var Ts=GN();Ts.__click=[HN,zt,fn];var js=g(Ts),on=g(js,!0);f(js),un(2),f(Ts),we(()=>{var _s;Pn(Ts,`timeframe-btn ${(n(fn).timeframe===((_s=i().period)==null?void 0:_s.timeframe)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),Ye(on,n(fn).timeframe)}),O(us,Ts)});var qt=u(So,2);qt.__click=[YN,zt,Ie];var Io=u(qt,2);Ns(Io,17,()=>He,dn,(us,fn)=>{var Ts=KN();Ts.__click=[UN,zt,fn];var js=g(Ts),on=g(js,!0);f(js),un(2),f(Ts),we(()=>{var _s;Pn(Ts,`timeframe-btn ${(n(fn).timeframe===((_s=i().period)==null?void 0:_s.timeframe)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),Ye(on,n(fn).timeframe)}),O(us,Ts)}),f(at),we(()=>{var us;return Pn(qt,`timeframe-btn ${(((us=i().period)==null?void 0:us.timeframe)==="4h"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(Ge,at)});var lr=u(tr,2);Se(lr,()=>n(ie),Ge=>{var at=lR(),So=g(at);Se(So,()=>He.find(fn=>fn.timeframe==="1d"),fn=>{var Ts=JN();Ts.__click=[XN,zt,He],we(()=>{var js;return Pn(Ts,`timeframe-btn ${(((js=i().period)==null?void 0:js.timeframe)==="1d"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(fn,Ts)});var qt=u(So,2);Se(qt,()=>He.find(fn=>fn.timeframe==="1w"),fn=>{var Ts=eR();Ts.__click=[QN,zt,He],we(()=>{var js;return Pn(Ts,`timeframe-btn ${(((js=i().period)==null?void 0:js.timeframe)==="1w"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(fn,Ts)});var Io=u(qt,2);Io.__click=[tR,se];var us=u(Io,2);Se(us,()=>n(se),fn=>{var Ts=aR(),js=g(Ts);Ns(js,17,()=>ke,dn,(In,Ci)=>{var zr=sR();zr.__click=[oR,zt,Ci];var ca=g(zr),hl=g(ca,!0);f(ca),un(2),f(zr),we(()=>{var fa;Pn(zr,`timeframe-btn ${(n(Ci).timeframe===((fa=i().period)==null?void 0:fa.timeframe)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),Ye(hl,n(Ci).timeframe)}),O(In,zr)});var on=u(js,2);on.__click=[nR,zt,Ie];var _s=u(on,2);Se(_s,()=>He.find(In=>In.timeframe==="1M"),In=>{var Ci=rR();Ci.__click=[iR,zt,He],we(()=>{var zr;return Pn(Ci,`timeframe-btn ${(((zr=i().period)==null?void 0:zr.timeframe)==="1M"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),O(In,Ci)}),f(Ts),we(()=>{var In;return Pn(on,`timeframe-btn ${(((In=i().period)==null?void 0:In.timeframe)==="4h"?"timeframe-btn-active":"")??""} svelte-pyr5xt`)}),Vp(1,Ts,()=>$F,()=>({duration:180})),Vp(2,Ts,()=>Vm,()=>({duration:120})),O(fn,Ts)}),f(at),we(()=>{Pn(Io,`timeframe-btn timeframe-more-btn ${(n(se)?"timeframe-btn-active":"")??""} svelte-pyr5xt`),St(Io,"aria-expanded",n(se))}),O(Ge,at)}),f(Bn);var Ui=u(Bn,2),_a=g(Ui);_a.__click=[cR,V],f(Ui);var qi=u(Ui,2),ai=g(qi);ai.__click=[dR,J];var cr=g(ai);Ru(cr,{get name(){return pt().icon},size:16});var Dn=u(cr,2),kr=g(Dn,!0);we(()=>Ye(kr,pt().name)),f(Dn),f(ai),f(qi);var Me=u(qi,2),Xe=g(Me);Xe.__click=[uR,F];var X=g(Xe);Ru(X,{name:"indicator",size:16});var Le=u(X,2),nt=g(Le,!0);we(()=>Ye(nt,h1())),f(Le),f(Xe),f(Me);var et=u(Me,2),ht=g(et);ht.__click=function(...Ge){var at;(at=n(qe)?Lt:void 0)==null||at.apply(this,Ge)};var uo=g(ht);Ru(uo,{class:"undo-redo-icon",name:"undo",size:16}),f(ht);var ut=u(ht,2);ut.__click=function(...Ge){var at;(at=n(ft)?It:void 0)==null||at.apply(this,Ge)};var Jt=g(ut);Ru(Jt,{class:"undo-redo-icon",name:"redo",size:16}),f(ut),f(et),f(wt);var fo=u(wt,2),lo=g(fo),so=We(()=>n(De)&&!n(ge));DB(lo,{get savedLayouts(){return n(ze)},get activeSaveId(){return n(he)},get isLoading(){return n(so)},get hasUnsavedChanges(){return be},$$events:{save:Xa,saveAs:Ja,quickSave:Xa,load:Wa,delete:Qa,newLayout:Va,showPopup:vl}});var ko=u(lo,2);ko.__click=[zN,v,Pe,me];var ts=g(ko);FA(ts,{size:18}),f(ko);var Xn=u(ko,2);Se(Xn,()=>l().mode==="none",Ge=>{var at=vR();at.__click=[pR,T];var So=g(at);Ru(So,{name:"play",size:18}),f(at),O(Ge,at)},Ge=>{var at=fR(),So=g(at);Ru(So,{name:"play",size:18}),f(at),O(Ge,at)});var ro=u(Xn,2);ro.__click=[gR,$];var Do=g(ro);AA(Do,{size:18}),f(ro);var Ao=u(ro,2);Ao.__click=[mR,R];var ss=g(Ao);WA(ss,{size:18}),f(Ao);var ds=u(Ao,2);ds.__click=function(...Ge){var at;(at=e.onToggleScriptStudio)==null||at.apply(this,Ge)};var Cs=g(ds);LA(Cs,{size:18}),f(ds);var ns=u(ds,2);ns.__click=cs;var Js=g(ns);TA(Js,{size:18}),f(ns);var Nn=u(ns,2);Nn.__click=[hR,ee,bs];var ui=g(Nn);Se(ui,()=>n(L),Ge=>{zA(Ge,{size:18})},Ge=>{jA(Ge,{size:18})}),f(Nn);var Ms=u(Nn,2);Ms.__click=[LN,i,y,en,K,Y,Eo];var Li=g(Ms);Se(Li,()=>i().theme==="dark",Ge=>{BA(Ge,{size:20})},Ge=>{qA(Ge,{size:20})}),f(Ms),f(fo),f(yt),Ec(yt,Ge=>b(Oe,Ge),()=>n(Oe));var Dr=u(yt,2);Se(Dr,()=>n(Qe),Ge=>{var at=wR();at.__click=[_R,Sl],at.__touchstart=[yR,el],at.__touchend=[bR],at.__pointerdown=[xR,Sl],O(Ge,at)}),f(sa);var Xr=u(sa,2);Se(Xr,()=>n(Y),Ge=>{var at=kR(),So=g(at),qt=u(g(So),2),Io=g(qt);un(2),f(qt);var us=u(qt,2),fn=g(us);fn.__click=[DN,K,Eo,Y];var Ts=u(fn,2);Ts.__click=[FN,K,Eo,Y],f(us),f(So),f(at),we(()=>Ye(Io,`${`You're changing the user interface to the ${n(K)==="light"?"Light":"Dark"} theme.`??""} `)),O(Ge,at)});var Ki=u(Xr,2);TN(Ki,{get show(){return n(T)},$$events:{close:()=>b(T,!1)}}),we(()=>{w0(vt,`menu-toggle-icon ${(n(w)?"":"rotate")??""} svelte-pyr5xt`),Pn(bo,`menu-btn ${(n(Z)?"menu-btn-active":"")??""} ${(n(le)?"rotate-loading":"")??""} svelte-pyr5xt`),St(bo,"title",n(Z)?"Exit Fullscreen & Rotation":"Fullscreen & Rotate to Landscape"),bo.disabled=n(le),Sn(Zo,"rotate-content-hidden",n(le)),Sn(ri,"rotate-icon-spinning",n(le)),Ye(Vs,n(G)),Pn(ht,`undo-redo-btn ${(n(qe)?"":"undo-redo-disabled")??""} svelte-pyr5xt`),Pn(ut,`undo-redo-btn ${(n(ft)?"":"undo-redo-disabled")??""} svelte-pyr5xt`),St(Nn,"title",n(L)?"Exit Fullscreen":"Fullscreen")}),O(o,or),Za()}hc(["click","change","touchstart","touchend","pointerdown"]);var PR=de('<div class="modal-backdrop svelte-1oypfgf"><div class="modal-content svelte-1oypfgf"><div class="modal-actions svelte-1oypfgf"><button class="action-btn copy-btn svelte-1oypfgf"><svg width="12" height="12" viewBox="0 0 24 24" fill="none"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2"></rect><path d="M5 15H4C2.9 15 2 14.1 2 13V4C2 2.9 2.9 2 4 2H13C14.1 2 15 2.9 15 4V5" stroke="currentColor" stroke-width="2"></path></svg> <span class="svelte-1oypfgf"> </span></button> <button class="action-btn reset-btn svelte-1oypfgf"><svg width="12" height="12" viewBox="0 0 24 24" fill="none"><path d="M3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12C21 16.97 16.97 21 12 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><path d="M3 12L7 8M3 12L7 16" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path></svg> <span class="svelte-1oypfgf">Reset View</span></button></div></div></div>');function IR(o,e){Ka(e,!1);let t=Ss(e,"isOpen",12,!1),s=Ss(e,"x",8,0),i=Ss(e,"y",8,0),r=Ss(e,"currentPrice",8,"");const a=Md();function l(){t(!1),a("close")}function d(){a("reset"),l()}function v(){a("copy",{price:r()}),l()}function p(k){k.target===k.currentTarget&&l()}function _(k){k.key==="Escape"&&l()}Ud();var y=Xt();Fl("keydown",Kw,_);var w=_t(y);Se(w,t,k=>{var S=PR(),L=g(S),T=g(L),P=g(T),A=u(g(P),2),F=g(A);f(A),f(P);var B=u(P,2);f(T),f(L),f(S),we(()=>{St(L,"style",`left: ${s()??""}px; top: ${i()??""}px;`),Ye(F,`Copy Price ${(r()?`(${r()})`:"")??""}`)}),Fl("click",P,v),Fl("click",B,d),Fl("click",S,p),O(k,S)}),O(o,y),Za()}class MR{constructor(e){re(this,"chart");re(this,"overlays",new Map);re(this,"projectionQueue",new Set);re(this,"isProjecting",!1);re(this,"eventListeners",new Map);re(this,"resizeObserver");re(this,"periodicProjectionId");re(this,"lastViewportState");re(this,"animationFrameId",null);this.chart=e,this.initializeEventListeners()}initializeEventListeners(){if(typeof ResizeObserver<"u"){const e=this.chart.getDom();if(e){const t=new ResizeObserver(()=>{this.scheduleProjection("resize")});t.observe(e),this.resizeObserver=t}}this.setupPeriodicProjection()}setupPeriodicProjection(){this.periodicProjectionId=window.setInterval(()=>{const e=this.getViewportState();e!==this.lastViewportState&&(this.lastViewportState=e,this.scheduleProjection("scroll"))},100)}getViewportState(){try{const e=this.chart.getVisibleRange(),t=this.chart.getSize();return JSON.stringify({visibleRange:e,chartSize:t})}catch{return""}}scheduleProjection(e){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.animationFrameId=requestAnimationFrame(()=>{this.projectAllOverlays(e),this.animationFrameId=null})}addOverlay(e){this.overlays.set(e.id,e),e.points.length>0&&jy(e.points,this.chart),this.projectOverlay(e)}removeOverlay(e){this.overlays.delete(e);try{this.chart.removeOverlay({id:e})}catch(t){console.warn("Could not remove overlay from chart:",t)}}updateOverlay(e){this.overlays.has(e.id)&&(this.overlays.set(e.id,e),e.points.length>0&&jy(e.points,this.chart),this.projectOverlay(e))}getOverlay(e){return this.overlays.get(e)}getAllOverlays(){return Array.from(this.overlays.values())}projectOverlay(e){const t={chart:this.chart,paneId:"candle_pane"},s=Mx(e.points,t);return s.isValid&&e.visible!==!1&&this.updateChartOverlay(e,s.screenPoints),s}projectAllOverlays(e){if(!this.isProjecting){this.isProjecting=!0;try{const t={type:e,chart:this.chart,timestamp:Date.now()};this.emitEvent(e,t);for(const s of this.overlays.values())s.visible!==!1&&this.projectOverlay(s)}finally{this.isProjecting=!1}}}updateChartOverlay(e,t){try{const s=t.map(l=>({x:l.x,y:l.y})),i={id:e.id,name:e.type,points:s.map((l,d)=>{var v,p;return{...l,timestamp:(v=e.points[d])==null?void 0:v.t,value:(p=e.points[d])==null?void 0:p.p}}),styles:this.convertOverlayStyles(e.style),visible:e.visible,lock:e.lock},r=this.chart.getOverlays({id:e.id});(r.length>0?r[0]:null)?this.chart.overrideOverlay(i):this.chart.createOverlay(i)}catch(s){console.error("Error updating chart overlay:",s)}}convertOverlayStyles(e){const t={};return e.line&&(t.line={color:e.line.color,size:e.line.size,style:e.line.style==="dashed"?"dashed":"solid"},e.line.dashedValue&&(t.line.dashedValue=e.line.dashedValue)),e.text&&(t.text={color:e.text.color,backgroundColor:e.text.backgroundColor,borderColor:e.text.borderColor,fontSize:e.text.fontSize}),e.polygon&&(t.polygon={color:e.polygon.color,fillColor:e.polygon.fillColor}),t}onTimeframeChange(){this.scheduleProjection("timeframeChange")}onTimezoneChange(){this.scheduleProjection("timezoneChange")}onPriceScaleChange(){this.scheduleProjection("priceScaleChange")}addEventListener(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}removeEventListener(e,t){const s=this.eventListeners.get(e);s&&s.delete(t)}emitEvent(e,t){const s=this.eventListeners.get(e);s&&s.forEach(i=>{try{i(t)}catch(r){console.error("Error in overlay event listener:",r)}})}forceProjection(){this.projectAllOverlays("resize")}clearAllOverlays(){for(const e of this.overlays.keys())this.removeOverlay(e);this.overlays.clear()}dispose(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=void 0),this.periodicProjectionId&&(clearInterval(this.periodicProjectionId),this.periodicProjectionId=void 0),this.clearAllOverlays(),this.eventListeners.clear()}}const TR={timeframeChange:{debounceMs:100,enabled:!0},zoom:{throttleMs:16,enabled:!0},scroll:{throttleMs:16,enabled:!0},resize:{debounceMs:250,enabled:!0},dataUpdate:{debounceMs:50,enabled:!0},priceScaleChange:{debounceMs:100,enabled:!0}};class AR{constructor(e,t={}){re(this,"chart");re(this,"projectionManager",null);re(this,"creationManager",null);re(this,"eventListeners",new Map);re(this,"resizeObserver",null);re(this,"config");re(this,"debounceTimers",new Map);re(this,"throttleTimers",new Map);this.chart=e,this.config={...TR,...t}}setProjectionManager(e){this.projectionManager=e}setCreationManager(e){this.creationManager=e}initialize(){this.setupChartEventListeners(),this.setupResizeObserver(),this.setupCustomEventListeners()}setupChartEventListeners(){this.setupViewportChangeDetection()}setupViewportChangeDetection(){let e=null;const s=setInterval(()=>{try{const i=this.chart.getVisibleRange();i&&this.hasRangeChanged(e,i)&&(e=i,this.handleEvent("scroll"))}catch(i){console.error("Error checking viewport changes:",i)}},16);this.eventListeners.set("viewportPolling",()=>clearInterval(s))}setupResizeObserver(){const e=this.chart.getDom();e&&(this.resizeObserver=new ResizeObserver(()=>{this.handleEvent("resize")}),this.resizeObserver.observe(e))}setupCustomEventListeners(){const e=this.chart.getDom();if(!e)return;const t=()=>this.handleEvent("timeframeChange"),s=()=>this.handleEvent("dataUpdate");e.addEventListener("timeframeChange",t),e.addEventListener("dataUpdate",s),this.eventListeners.set("timeframeChange",()=>{e.removeEventListener("timeframeChange",t)}),this.eventListeners.set("dataUpdate",()=>{e.removeEventListener("dataUpdate",s)})}handleEvent(e){const t=this.config[e];t.enabled&&(t.debounceMs?this.debounceEvent(e,t.debounceMs):t.throttleMs?this.throttleEvent(e,t.throttleMs):this.executeEvent(e))}debounceEvent(e,t){const s=this.debounceTimers.get(e);s&&clearTimeout(s);const i=setTimeout(()=>{this.executeEvent(e),this.debounceTimers.delete(e)},t);this.debounceTimers.set(e,i)}throttleEvent(e,t){const s=this.throttleTimers.get(e)||0,i=Date.now();i-s>=t&&(this.executeEvent(e),this.throttleTimers.set(e,i))}executeEvent(e){try{this.projectionManager&&this.projectionManager.forceProjection();const t=this.chart.getDom();t&&t.dispatchEvent(new CustomEvent("overlayEvent",{detail:{type:e,timestamp:Date.now()}}))}catch(t){console.error(`Error handling ${e} event:`,t)}}hasRangeChanged(e,t){return e?e.from!==t.from||e.to!==t.to:!0}hasPriceRangeChanged(e,t){return e?Math.abs(e.min-t.min)>1e-8||Math.abs(e.max-t.max)>1e-8:!0}triggerEvent(e){this.handleEvent(e)}updateConfig(e,t){this.config[e]={...this.config[e],...t}}setEventEnabled(e,t){this.config[e].enabled=t}destroy(){this.debounceTimers.forEach(e=>clearTimeout(e)),this.debounceTimers.clear(),this.throttleTimers.clear(),this.eventListeners.forEach(e=>e()),this.eventListeners.clear(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}}function Gy(o){return typeof o=="object"&&o!==null&&typeof o.x=="number"&&typeof o.y=="number"}function Yy(o){return typeof o=="object"&&o!==null&&typeof o.timestamp=="number"&&typeof o.value=="number"}function L_(o){return typeof o=="object"&&o!==null}class LR{constructor(e){re(this,"chart");re(this,"currentSymbolKey",null);this.chart=e}toDrawing(e,t){try{if(!this.currentSymbolKey)return null;const s=Array.isArray(t==null?void 0:t.points)?t.points.map(v=>{if(v&&typeof v=="object"){if(typeof v.timestamp=="number"&&typeof v.value=="number")return{time:v.timestamp,price:v.value};if(typeof v.t=="number"&&typeof v.p=="number")return{time:v.t,price:v.p}}return null}).filter(Boolean):[];if(s.length===0)return null;const i=(t==null?void 0:t.name)||(t==null?void 0:t.type)||"unknown",r=(t==null?void 0:t.styles)||(t==null?void 0:t.style)||{},a=!!(t!=null&&t.lock),l=(t==null?void 0:t.visible)!==!1;return{id:e,symbolKey:this.currentSymbolKey,type:i,points:s,styles:r,...t!=null&&t.extendData?{extendData:t.extendData}:{},locked:a,visible:l}}catch{return null}}setCurrentSymbolKey(e){this.currentSymbolKey=e,console.log("📍 OverlayCreationManager symbol set:",e)}getCurrentSymbolKey(){return this.currentSymbolKey}createPointFromMouse(e,t){try{const s={x:e,y:t},i={chart:this.chart},r=jF(s,i);return r?{timestamp:r.t,value:r.p}:null}catch(s){return console.error("Failed to create point from mouse coordinates:",s),null}}createDataSpaceOverlay(e){if(!L_(e)||!e.points||!Array.isArray(e.points))return e;const t=e.points.map(s=>{if(Gy(s)){const i=this.createPointFromMouse(s.x,s.y);return i?{timestamp:i.timestamp,value:i.value}:s}else if(Yy(s))return s;return s});return{...e,points:t,_isDataSpace:!0}}convertLegacyOverlay(e){if(!L_(e)||e._isDataSpace||!e.points)return e;const t=e.points.map(s=>{if(Gy(s)){const i=this.createPointFromMouse(s.x,s.y);return i?{timestamp:i.timestamp,value:i.value}:s}return s});return{...e,points:t,_isDataSpace:!0}}projectOverlayToScreen(e){if(!L_(e)||!e._isDataSpace||!e.points)return e;const t=e.points.map(s=>{if(Yy(s)){const i={id:s.id||"temp",t:s.timestamp,p:s.value},r={chart:this.chart},a=k1(i,r);return a?{x:a.x,y:a.y}:s}return s});return{...e,points:t}}addOverlay(e){try{const t=this.createDataSpaceOverlay(e),s=this.projectOverlayToScreen(t),i=this.chart.createOverlay(s);if(i){const r=Array.isArray(i)?i[0]:i;if(typeof r=="string"){const a=Qu();if(a){const l=this.toDrawing(r,t);if(l){a.addDrawing(l);try{Ou()}catch{}}}}return r}return null}catch(t){return console.error("Failed to add overlay:",t),null}}storeDataSpaceOverlay(e,t){}getStoredDataSpaceOverlay(e){try{const t=localStorage.getItem("dataSpaceOverlays");return t&&JSON.parse(t)[e]||null}catch(t){return console.error("Failed to retrieve data-space overlay:",t),null}}removeStoredDataSpaceOverlay(e){try{const t=Qu();if(t){t.removeDrawing(e);try{Ou()}catch{}}}catch(t){console.error("Failed to remove overlay from DrawingManager:",t)}}}function FR(o){return o.createDataSpaceTemplate("enhancedRect",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{var d,v,p,_,y,w;if(s.length<2)return[];const[i,r]=s,a=[],l=30;return a.push({type:"rect",attrs:{x:Math.min(i.x,r.x)-l,y:Math.min(i.y,r.y)-l,width:Math.abs(r.x-i.x)+l*2,height:Math.abs(r.y-i.y)+l*2},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),a.push({type:"rect",attrs:{x:Math.min(i.x,r.x),y:Math.min(i.y,r.y),width:Math.abs(r.x-i.x),height:Math.abs(r.y-i.y)},styles:{style:"stroke",color:((v=(d=e.style)==null?void 0:d.line)==null?void 0:v.color)||"#1677FF",borderSize:((_=(p=e.style)==null?void 0:p.line)==null?void 0:_.size)||1,borderStyle:((w=(y=e.style)==null?void 0:y.line)==null?void 0:w.style)||"solid"}}),a},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function DR(o){return o.createDataSpaceTemplate("enhancedCircle",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{var v,p,_,y,w,k;if(s.length<2)return[];const[i,r]=s,a=Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)),l=[];return l.push({type:"circle",attrs:{x:i.x,y:i.y,r:a+30},styles:{style:"fill",color:"transparent"},ignoreEvent:!1}),l.push({type:"circle",attrs:{x:i.x,y:i.y,r:a},styles:{style:"stroke",color:((p=(v=e.style)==null?void 0:v.line)==null?void 0:p.color)||"#1677FF",borderSize:((y=(_=e.style)==null?void 0:_.line)==null?void 0:y.size)||1,borderStyle:((k=(w=e.style)==null?void 0:w.line)==null?void 0:k.style)||"solid"}}),l},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function ER(o){return o.createDataSpaceTemplate("enhancedLine",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{var r,a,l,d,v,p;if(s.length<2)return[];const i=[];for(let _=0;_<s.length-1;_++){const y=s[_],w=s[_+1];i.push({type:"line",attrs:{coordinates:[{x:y.x,y:y.y},{x:w.x,y:w.y}]},styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),i.push({type:"line",attrs:{coordinates:[{x:y.x,y:y.y},{x:w.x,y:w.y}]},styles:{color:((a=(r=e.style)==null?void 0:r.line)==null?void 0:a.color)||"#1677FF",size:((d=(l=e.style)==null?void 0:l.line)==null?void 0:d.size)||.5,style:((p=(v=e.style)==null?void 0:v.line)==null?void 0:p.style)||"solid"}})}return i},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function $R(o){return o.createDataSpaceTemplate("enhancedTrendLine",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s,chart:i})=>{var y,w,k,S,L,T;if(s.length<2)return[];const[r,a]=s,l=[];let d=r,v=a;const p=e.extendLeft,_=e.extendRight;if(p||_){const P=i.getSize();if(P){const A=(a.y-r.y)/(a.x-r.x);if(p&&(d={x:0,y:r.y+A*(0-r.x)}),_){const F=r.y+A*(P.width-r.x);v={x:P.width,y:F}}}}return l.push({type:"line",attrs:{coordinates:[{x:d.x,y:d.y},{x:v.x,y:v.y}]},styles:{color:"transparent",size:40,style:"solid"},ignoreEvent:!1}),l.push({type:"line",attrs:{coordinates:[{x:d.x,y:d.y},{x:v.x,y:v.y}]},styles:{color:((w=(y=e.style)==null?void 0:y.line)==null?void 0:w.color)||"#1677FF",size:((S=(k=e.style)==null?void 0:k.line)==null?void 0:S.size)||.5,style:((T=(L=e.style)==null?void 0:L.line)==null?void 0:T.style)||"solid"}}),l},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function jR(o){return o.createDataSpaceTemplate("enhancedFibonacci",{totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createDataSpaceFigures:({overlay:e,projectionResult:t,screenCoordinates:s})=>{if(s.length<2)return[];const[i,r]=s,a=[],l=[0,.236,.382,.5,.618,.786,1,1.618,2.618],d=r.y-i.y;return l.forEach(v=>{var _,y,w,k,S,L,T,P;const p=i.y+d*v;a.push({type:"line",attrs:{coordinates:[{x:Math.min(i.x,r.x),y:p},{x:Math.max(i.x,r.x),y:p}]},styles:{color:"transparent",size:30,style:"solid"},ignoreEvent:!1}),a.push({type:"line",attrs:{coordinates:[{x:Math.min(i.x,r.x),y:p},{x:Math.max(i.x,r.x),y:p}]},styles:{color:((y=(_=e.style)==null?void 0:_.line)==null?void 0:y.color)||"#1677FF",style:"dashed",size:((k=(w=e.style)==null?void 0:w.line)==null?void 0:k.size)||2}}),a.push({type:"text",attrs:{x:Math.max(i.x,r.x)+5,y:p,text:`${(v*100).toFixed(1)}%`},styles:{color:((L=(S=e.style)==null?void 0:S.text)==null?void 0:L.color)||"#666666",size:((P=(T=e.style)==null?void 0:T.text)==null?void 0:P.fontSize)||12}})}),a},onDrawStart:()=>!0,onDrawing:()=>!0,onDrawEnd:()=>!0})}function zR(o){return{enhancedRect:FR(o),enhancedCircle:DR(o),enhancedLine:ER(o),enhancedTrendLine:$R(o),enhancedFibonacci:jR(o)}}const km=o=>o>="0"&&o<="9",Uy=o=>o>="a"&&o<="z"||o>="A"&&o<="Z"||o==="_"||o==="$";class BR{constructor(e){re(this,"pos",0);this.input=e}next(){const e=this.input,t=e.length;for(;this.pos<t&&/\s/.test(e[this.pos]??"");)this.pos++;if(this.pos>=t)return{type:"eof",start:this.pos,end:this.pos};const s=e[this.pos],i=this.pos;if(km(s)||s==="."&&km(e[this.pos+1]??"")){let r=s===".";for(this.pos++;this.pos<t;){const a=e[this.pos];if(km(a))this.pos++;else if(a==="."&&!r)r=!0,this.pos++;else break}return{type:"number",value:e.slice(i,this.pos),start:i,end:this.pos}}if(Uy(s)){for(this.pos++;this.pos<t;){const r=e[this.pos];if(Uy(r)||km(r))this.pos++;else break}return{type:"identifier",value:e.slice(i,this.pos),start:i,end:this.pos}}switch(this.pos++,s){case"+":return{type:"plus",start:i,end:this.pos};case"-":return{type:"minus",start:i,end:this.pos};case"*":return{type:"star",start:i,end:this.pos};case"/":return{type:"slash",start:i,end:this.pos};case"%":return{type:"percent",start:i,end:this.pos};case"(":return{type:"lparen",start:i,end:this.pos};case")":return{type:"rparen",start:i,end:this.pos};case",":return{type:"comma",start:i,end:this.pos};default:throw new Error(`Unexpected character "${s}" at position ${i}`)}}}class cf extends Error{constructor(e,t){super(e),this.position=t,this.name="ParseError"}}class NR{constructor(e){re(this,"current");this.tokenizer=e,this.current=e.next()}eat(e){if(this.current.type!==e)throw new cf(`Expected ${e} but found ${this.current.type}`,this.current.start);const t=this.current;return this.current=this.tokenizer.next(),t}match(e){return this.current.type===e?(this.current=this.tokenizer.next(),!0):!1}parseExpression(){const e=this.parseTerm();return this.parseAddSub(e)}parseAddSub(e){let t=e;for(;this.current.type==="plus"||this.current.type==="minus";){const s=this.current;this.current=this.tokenizer.next();const i=this.parseTerm();t={kind:"BinaryExpression",operator:s.type==="plus"?"+":"-",left:t,right:i}}return t}parseTerm(){let e=this.parseFactor();for(;this.current.type==="star"||this.current.type==="slash"||this.current.type==="percent";){const t=this.current;this.current=this.tokenizer.next();const s=this.parseFactor();e={kind:"BinaryExpression",operator:t.type==="star"?"*":t.type==="slash"?"/":"%",left:e,right:s}}return e}parseFactor(){if(this.current.type==="plus"||this.current.type==="minus"){const e=this.current.type==="minus";this.current=this.tokenizer.next();const t=this.parseFactor();return e?{kind:"BinaryExpression",operator:"*",left:{kind:"NumberLiteral",value:-1},right:t}:t}return this.parsePrimary()}parsePrimary(){const e=this.current;switch(e.type){case"number":{this.current=this.tokenizer.next();const t=Number(e.value);if(!Number.isFinite(t))throw new cf("Invalid number literal",e.start);return{kind:"NumberLiteral",value:t}}case"identifier":{this.current=this.tokenizer.next();const t=(e.value||"").toString();if(this.current.type==="lparen"){this.eat("lparen");const s=[];if(this.current.type!=="rparen")for(;s.push(this.parseExpression()),!!this.match("comma"););return this.eat("rparen"),{kind:"CallExpression",callee:t,args:s}}return{kind:"Identifier",name:t}}case"lparen":{this.eat("lparen");const t=this.parseExpression();return this.eat("rparen"),t}default:throw new cf(`Unexpected token ${e.type}`,e.start)}}}function o1(o){const e=new NR(new BR(o)),t=e.parseExpression();if(e.current.type!=="eof")throw new cf("Unexpected input after end of expression",e.current.start);return t}class rl extends Error{constructor(e){super(e),this.name="ExpressionEngineError"}}function RR(o,e){const t=o.length,s=new Float32Array(t);let i=0;for(let r=0;r<t;r++){const a=o[r];if(Number.isFinite(a)&&(i+=a),r>=e){const l=o[r-e];Number.isFinite(l)&&(i-=l)}s[r]=r>=e-1?i:NaN}return s}function OR(o,e){const t=o.length,s=new Float32Array(t),i=Math.max(1,Math.floor(e));for(let r=0;r<t;r++){const a=r-i,l=o[r],d=a>=0?o[a]:NaN;s[r]=Number.isFinite(l)&&Number.isFinite(d)?l-d:NaN}return s}function Uc(o,e){if(o.kind==="series")return o.value;const t=new Float32Array(e.length);return t.fill(o.value),t}function g0(o){if(o.kind==="scalar")return o.value;const e=o.value;return e.length?e[e.length-1]:NaN}function VR(o,e,t,s){const i=e.kind==="series",r=t.kind==="series";if(!i&&!r){const p=e.value,_=t.value;switch(o){case"+":return{kind:"scalar",value:p+_};case"-":return{kind:"scalar",value:p-_};case"*":return{kind:"scalar",value:p*_};case"/":return{kind:"scalar",value:_===0?NaN:p/_};case"%":return{kind:"scalar",value:_===0?NaN:p%_}}}const a=Uc(e,s),l=Uc(t,s),d=s.length,v=new Float32Array(d);for(let p=0;p<d;p++){const _=a[p],y=l[p];switch(o){case"+":v[p]=_+y;break;case"-":v[p]=_-y;break;case"*":v[p]=_*y;break;case"/":v[p]=y===0?NaN:_/y;break;case"%":v[p]=y===0?NaN:_%y;break}}return{kind:"series",value:v}}function WR(o,e){const t=o.length,s=new Float32Array(t);let i=0,r=0;for(let a=0;a<t;a++){const l=o[a];if(Number.isFinite(l)&&(i+=l,r+=1),a>=e){const d=o[a-e];Number.isFinite(d)&&(i-=d,r-=1)}a>=e-1?s[a]=r>0?i/r:NaN:s[a]=NaN}return s}function qR(o,e){const t=o.length,s=new Float32Array(t),i=2/(e+1);let r;for(let a=0;a<t;a++){const l=o[a];if(!Number.isFinite(l)){s[a]=r===void 0?NaN:r;continue}if(r===void 0||!Number.isFinite(r)){r=l,s[a]=l;continue}r=l*i+r*(1-i),s[a]=r}return s}function Ky(o,e){const t=o.length,s=new Float32Array(t);let i,r=0,a=0;for(let l=0;l<t;l++){const d=o[l];if(i===void 0){if(Number.isFinite(d)&&(r+=d,a+=1),a<e){s[l]=NaN;continue}i=r/e,s[l]=i;continue}Number.isFinite(d)&&(i=(i*(e-1)+d)/e),s[l]=i}return s}function HR(o,e){const t=o.length,s=new Float32Array(t);let i,r=0,a=0,l=!1;const d=[],v=[];for(let p=0;p<t;p++){const _=o[p];if(!Number.isFinite(_)){s[p]=NaN;continue}if(i===void 0){i=_,s[p]=NaN;continue}if(!Number.isFinite(i)){i=_,s[p]=NaN;continue}const y=_-i;i=_;const w=y>0?y:0,k=y<0?-y:0;if(l)r=(r*(e-1)+w)/e,a=(a*(e-1)+k)/e;else{d.push(w),v.push(k);const S=d.length,L=Math.max(1,Math.min(e,S));r=d.reduce((T,P)=>T+P,0)/L,a=v.reduce((T,P)=>T+P,0)/L,S>=e&&(l=!0)}if(a===0)s[p]=100;else{const S=r/a;s[p]=100-100/(1+S)}}return s}function GR(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){if(i<e-1){s[i]=NaN;continue}let r=0,a=0;for(let v=i-e+1;v<=i;v++){const p=o[v];Number.isFinite(p)&&(r+=p,a+=1)}if(a<2){s[i]=NaN;continue}const l=r/a;let d=0;for(let v=i-e+1;v<=i;v++){const p=o[v];if(!Number.isFinite(p))continue;const _=p-l;d+=_*_}s[i]=Math.sqrt(d/a)}return s}function YR(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){if(i<e-1){s[i]=NaN;continue}let r=0,a=0;for(let l=0;l<e;l++){const d=o[i-l],v=e-l;Number.isFinite(d)&&(r+=d*v,a+=v)}s[i]=a>0?r/a:NaN}return s}function UR(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){let r=-1/0,a=!1;const l=Math.max(0,i-e+1);for(let d=l;d<=i;d++){const v=o[d];Number.isFinite(v)&&(a=!0,v>r&&(r=v))}s[i]=a?r:NaN}return s}function KR(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){let r=1/0,a=!1;const l=Math.max(0,i-e+1);for(let d=l;d<=i;d++){const v=o[d];Number.isFinite(v)&&(a=!0,v<r&&(r=v))}s[i]=a?r:NaN}return s}function ZR(o,e){const t=o.callee.toLowerCase(),s=o.args.map(r=>qm(r,e)),i=()=>{if(s.length!==2)throw new rl(`${t} expects (series, period)`);const r=Uc(s[0],e),a=Math.max(1,Math.floor(g0(s[1])));return[r,a]};switch(t){case"nz":{if(s.length<1||s.length>2)throw new rl("nz expects (series[, fallback])");const r=s[0],a=s[1]??{kind:"scalar",value:0};if(r.kind==="scalar"&&a.kind==="scalar")return{kind:"scalar",value:Number.isFinite(r.value)?r.value:a.value};const l=Uc(r,e),d=Uc(a,e),v=e.length,p=new Float32Array(v);for(let _=0;_<v;_++){const y=l[_];p[_]=Number.isFinite(y)?y:d[_]}return{kind:"series",value:p}}case"add":case"sub":case"mul":case"div":{if(s.length!==2)throw new rl(`${t} expects 2 arguments`);const r=s[0],a=s[1];if(r.kind==="scalar"&&a.kind==="scalar"){const _=r.value,y=a.value;return t==="add"?{kind:"scalar",value:_+y}:t==="sub"?{kind:"scalar",value:_-y}:t==="mul"?{kind:"scalar",value:_*y}:{kind:"scalar",value:y===0?NaN:_/y}}const l=Uc(r,e),d=Uc(a,e),v=e.length,p=new Float32Array(v);for(let _=0;_<v;_++){const y=l[_],w=d[_];t==="add"?p[_]=y+w:t==="sub"?p[_]=y-w:t==="mul"?p[_]=y*w:p[_]=w===0?NaN:y/w}return{kind:"series",value:p}}case"sma":{const[r,a]=i();return{kind:"series",value:WR(r,a)}}case"wma":{const[r,a]=i();return{kind:"series",value:YR(r,a)}}case"ema":{const[r,a]=i();return{kind:"series",value:qR(r,a)}}case"smma":{const[r,a]=i();return{kind:"series",value:Ky(r,a)}}case"rsi":{const[r,a]=i();return{kind:"series",value:HR(r,a)}}case"rma":{const[r,a]=i();return{kind:"series",value:Ky(r,a)}}case"atr":{if(s.length!==4)throw new rl("atr expects (high, low, close, period)");const r=Uc(s[0],e),a=Uc(s[1],e),l=Uc(s[2],e),d=Math.max(1,Math.floor(g0(s[3]))),v=e.length,p=new Float32Array(v);let _=NaN;for(let k=0;k<v;k++){const S=r[k],L=a[k],T=l[k];let P=Math.max(0,S-L);Number.isFinite(_)&&(P=Math.max(P,Math.abs(S-_),Math.abs(L-_))),p[k]=P,_=T}const y=new Float32Array(v);let w=0;for(let k=0;k<v;k++)w+=p[k],k===d-1?y[k]=w/d:k>=d?y[k]=(y[k-1]*(d-1)+p[k])/d:y[k]=NaN;return{kind:"series",value:y}}case"stdev":{const[r,a]=i();return{kind:"series",value:GR(r,a)}}case"highest":{const[r,a]=i();return{kind:"series",value:UR(r,a)}}case"lowest":{const[r,a]=i();return{kind:"series",value:KR(r,a)}}case"sum":{const[r,a]=i();return{kind:"series",value:RR(r,a)}}case"lag":{const[r,a]=i();return{kind:"series",value:Zy(r,a)}}case"prev":{if(s.length<1||s.length>2)throw new rl("prev expects (series[, n])");const r=Uc(s[0],e),a=Math.max(1,Math.floor(g0(s[1]??{kind:"scalar",value:1})));return{kind:"series",value:Zy(r,a)}}case"change":{if(s.length<1||s.length>2)throw new rl("change expects (series[, n])");const r=Uc(s[0],e),a=Math.max(1,Math.floor(g0(s[1]??{kind:"scalar",value:1})));return{kind:"series",value:OR(r,a)}}case"hl2":{if(s.length!==0)throw new rl("hl2 expects no arguments");const r=e.series.high,a=e.series.low;if(!r||!a)throw new rl("hl2 requires high/low series");const l=e.length,d=new Float32Array(l);for(let v=0;v<l;v++)d[v]=(r[v]+a[v])/2;return{kind:"series",value:d}}case"hlc3":{if(s.length!==0)throw new rl("hlc3 expects no arguments");const r=e.series.high,a=e.series.low,l=e.series.close;if(!r||!a||!l)throw new rl("hlc3 requires high/low/close series");const d=e.length,v=new Float32Array(d);for(let p=0;p<d;p++)v[p]=(r[p]+a[p]+l[p])/3;return{kind:"series",value:v}}case"ohlc4":{if(s.length!==0)throw new rl("ohlc4 expects no arguments");const r=e.series.open,a=e.series.high,l=e.series.low,d=e.series.close;if(!r||!a||!l||!d)throw new rl("ohlc4 requires open/high/low/close series");const v=e.length,p=new Float32Array(v);for(let _=0;_<v;_++)p[_]=(r[_]+a[_]+l[_]+d[_])/4;return{kind:"series",value:p}}case"vwap":{if(s.length!==2)throw new rl("vwap expects (close, volume)");const r=Uc(s[0],e),a=Uc(s[1],e),l=e.length,d=new Float32Array(l);let v=0,p=0;for(let _=0;_<l;_++){const y=r[_],w=a[_];if(!Number.isFinite(y)||!Number.isFinite(w)){d[_]=NaN;continue}v+=y*w,p+=w,d[_]=p===0?NaN:v/p}return{kind:"series",value:d}}case"vwma":{if(s.length!==3)throw new rl("vwma expects (close, volume, period)");const r=Uc(s[0],e),a=Uc(s[1],e),l=Math.max(1,Math.floor(g0(s[2]))),d=e.length,v=new Float32Array(d);let p=0,_=0;for(let y=0;y<d;y++){const w=r[y],k=a[y];if(Number.isFinite(w)&&Number.isFinite(k)&&(p+=w*k,_+=k),y>=l){const S=r[y-l],L=a[y-l];Number.isFinite(S)&&Number.isFinite(L)&&(p-=S*L,_-=L)}v[y]=y>=l-1&&_!==0?p/_:NaN}return{kind:"series",value:v}}case"min":{if(s.length!==2)throw new rl("min expects 2 arguments");const r=s[0],a=s[1];if(r.kind==="scalar"&&a.kind==="scalar")return{kind:"scalar",value:Math.min(r.value,a.value)};const l=Uc(r,e),d=Uc(a,e),v=e.length,p=new Float32Array(v);for(let _=0;_<v;_++)p[_]=Math.min(l[_],d[_]);return{kind:"series",value:p}}case"max":{if(s.length!==2)throw new rl("max expects 2 arguments");const r=s[0],a=s[1];if(r.kind==="scalar"&&a.kind==="scalar")return{kind:"scalar",value:Math.max(r.value,a.value)};const l=Uc(r,e),d=Uc(a,e),v=e.length,p=new Float32Array(v);for(let _=0;_<v;_++)p[_]=Math.max(l[_],d[_]);return{kind:"series",value:p}}case"abs":{if(s.length!==1)throw new rl("abs expects 1 argument");const r=s[0];if(r.kind==="scalar")return{kind:"scalar",value:Math.abs(r.value)};const a=r.value,l=e.length,d=new Float32Array(l);for(let v=0;v<l;v++)d[v]=Math.abs(a[v]);return{kind:"series",value:d}}default:throw new rl(`Unknown function "${o.callee}"`)}}function qm(o,e){var t;switch(o.kind){case"NumberLiteral":return{kind:"scalar",value:o.value};case"Identifier":{const s=o.name.replace(/\s+/g,"_").toLowerCase();if(s==="na"||s==="nan")return{kind:"scalar",value:NaN};const i=e.series[s];if(i)return{kind:"series",value:i};const r=(t=e.scalars)==null?void 0:t[s];if(typeof r=="number"&&Number.isFinite(r))return{kind:"scalar",value:r};throw e.seriesNames.has(s)?new rl(`Series "${o.name}" is used before it is defined (circular or forward reference)`):new rl(`Unknown identifier "${o.name}"`)}case"BinaryExpression":return VR(o.operator,qm(o.left,e),qm(o.right,e),e);case"CallExpression":return ZR(o,e);default:throw new rl("Unsupported expression node")}}function df(o,e,t){var T;const s=new Set;for(const P of o){const A=P.name.replace(/\s+/g,"_").toLowerCase();s.add(A)}const i=Object.entries(e),r=((T=i[0])==null?void 0:T[1].length)??0;for(const[,P]of i)if(P.length!==r)throw new rl("All base series must have the same length");const a=o.map(P=>{try{const A=o1(P.expr);return{name:P.name.replace(/\s+/g,"_").toLowerCase(),expr:P.expr,ast:A}}catch(A){throw A instanceof cf?new rl(`Syntax error in series "${P.name}" at position ${A.position}: ${A.message}`):A}}),l={length:r,series:{...e},seriesNames:s,scalars:(()=>{if(!t||typeof t!="object")return;const P={};return Object.entries(t).forEach(([A,F])=>{const B=A.replace(/\s+/g,"_").toLowerCase();if(typeof F=="number"&&Number.isFinite(F)){P[B]=F;return}if(typeof F=="string"){const R=Number(F);Number.isFinite(R)&&(P[B]=R)}}),Object.keys(P).length?P:void 0})()},d={},v=P=>{const A=new Set,F=B=>{switch(B.kind){case"Identifier":{const R=B.name.replace(/\s+/g,"_").toLowerCase();A.add(R);break}case"BinaryExpression":F(B.left),F(B.right);break;case"CallExpression":B.args.forEach(R=>F(R));break}};return F(P),A},p=new Set(a.map(P=>P.name)),_={},y={};a.forEach(P=>{_[P.name]=new Set,y[P.name]=new Set}),a.forEach(P=>{v(P.ast).forEach(F=>{p.has(F)&&F!==P.name&&(_[P.name].add(F),y[F].add(P.name))})});const w={};Object.keys(_).forEach(P=>{var A;w[P]=((A=_[P])==null?void 0:A.size)??0});const k=Object.keys(w).filter(P=>(w[P]||0)===0),S=[];for(;k.length;){const P=k.shift();S.push(P);for(const A of y[P]||[])w[A]=(w[A]||0)-1,w[A]===0&&k.push(A)}if(S.length!==a.length){const P=a.map(A=>A.name).filter(A=>!S.includes(A));throw new rl(`Circular dependency detected among series: ${P.join(" -> ")}`)}const L={};a.forEach(P=>{L[P.name]=P});for(const P of S){const A=L[P];if(l.series[A.name])throw new rl(`Series name "${A.name}" conflicts with an existing base series`);const F=qm(A.ast,l),B=Uc(F,l);l.series[A.name]=B,d[A.name]=B}return d}function XR(o,e){var r;const t=o.replace(/\s+/g,"_").toLowerCase();if(t==="na"||t==="nan")return NaN;if(e.selfKey&&e.selfOut&&t===e.selfKey){const a=e.index-1;return a>=0?e.selfOut[a]:NaN}const s=e.series[t];if(s)return s[e.index]??NaN;const i=(r=e.scalars)==null?void 0:r[t];if(typeof i=="number"&&Number.isFinite(i))return i;throw new rl(`Unknown identifier "${o}"`)}function Zu(o,e){switch(o.kind){case"NumberLiteral":return o.value;case"Identifier":return XR(o.name,e);case"BinaryExpression":{const t=Zu(o.left,e),s=Zu(o.right,e);switch(o.operator){case"+":return t+s;case"-":return t-s;case"*":return t*s;case"/":return s===0?NaN:t/s;case"%":return s===0?NaN:t%s;default:return NaN}}case"CallExpression":{const t=o.callee.toLowerCase(),s=o.args[0],i=o.args[1];if(t==="nz"){if(o.args.length<1||o.args.length>2)throw new rl("nz expects (x[, fallback])");const r=Zu(s,e);return Number.isFinite(r)?r:o.args.length===2?Zu(i,e):0}if(t==="add"||t==="sub"||t==="mul"||t==="div"){if(o.args.length!==2)throw new rl(`${o.callee} expects 2 arguments`);const r=Zu(s,e),a=Zu(i,e);return t==="add"?r+a:t==="sub"?r-a:t==="mul"?r*a:a===0?NaN:r/a}if(t==="min"||t==="max"){if(o.args.length!==2)throw new rl(`${o.callee} expects 2 arguments`);const r=Zu(s,e),a=Zu(i,e);return t==="min"?Math.min(r,a):Math.max(r,a)}if(t==="abs"){if(o.args.length!==1)throw new rl("abs expects 1 argument");return Math.abs(Zu(s,e))}if(t==="prev"||t==="lag"||t==="change"){if(o.args.length!==2)throw new rl(`${o.callee} expects (series, n)`);const r=s;if(r.kind!=="Identifier")throw new rl(`${o.callee} expects first argument to be a series identifier`);const a=r.name.replace(/\s+/g,"_").toLowerCase(),l=Zu(i,e),d=Math.max(1,Math.floor(l)),v=e.index-d,p=w=>{if(w<0)return NaN;if(e.selfKey&&e.selfOut&&a===e.selfKey)return e.selfOut[w]??NaN;const k=e.series[a];if(!k)throw new rl(`Unknown identifier "${r.name}"`);return k[w]??NaN};if(t==="prev"||t==="lag")return p(v);const _=p(e.index),y=p(v);return Number.isFinite(_)&&Number.isFinite(y)?_-y:NaN}throw new rl(`Unknown function "${o.callee}"`)}default:return NaN}}function JR(o,e,t){var v;const s=Object.entries(e),i=((v=s[0])==null?void 0:v[1].length)??0;for(const[,p]of s)if(p.length!==i)throw new rl("All base series must have the same length");const r=(()=>{if(!t||typeof t!="object")return;const p={};return Object.entries(t).forEach(([_,y])=>{const w=_.replace(/\s+/g,"_").toLowerCase();if(typeof y=="number"&&Number.isFinite(y)){p[w]=y;return}if(typeof y=="string"){const k=Number(y);Number.isFinite(k)&&(p[w]=k)}}),Object.keys(p).length?p:void 0})(),a=o.map(p=>{const _=p.name.replace(/\s+/g,"_").toLowerCase();try{const y=p.initExpr?o1(p.initExpr):null,w=o1(p.updateExpr);return{name:_,initAst:y,updateAst:w,initExpr:p.initExpr,updateExpr:p.updateExpr}}catch(y){throw y instanceof cf?new rl(`Syntax error in series "${p.name}" at position ${y.position}: ${y.message}`):y}}),l={},d={...e};for(const p of a){if(d[p.name])throw new rl(`Series name "${p.name}" conflicts with an existing base series`);const _=new Float32Array(i);_.fill(NaN),d[p.name]=_,l[p.name]=_}for(let p=0;p<i;p++)for(const _ of a){const y=l[_.name],w={series:d,scalars:r,length:i,index:p,selfKey:_.name,selfOut:y},k=p===0&&_.initAst?_.initAst:_.updateAst,S=Zu(k,w);y[p]=S}return l}function Zy(o,e){const t=o.length,s=new Float32Array(t);for(let i=0;i<t;i++){const r=i-e;s[i]=r>=0?o[r]:NaN}return s}const Sm=o=>o>="0"&&o<="9",Xy=o=>o>="a"&&o<="z"||o>="A"&&o<="Z"||o==="_"||o==="$";class QR{constructor(e){re(this,"pos",0);this.input=e}next(){const e=this.input,t=e.length;for(;this.pos<t&&/\s/.test(e[this.pos]??"");)this.pos++;if(this.pos>=t)return{type:"eof",pos:this.pos};const s=this.pos,i=e[this.pos];if(Sm(i)||i==="."&&Sm(e[this.pos+1]??"")){let r=i===".";for(this.pos++;this.pos<t;){const a=e[this.pos];if(Sm(a))this.pos++;else if(a==="."&&!r)r=!0,this.pos++;else break}return{type:"number",value:e.slice(s,this.pos),pos:s}}if(Xy(i)){for(this.pos++;this.pos<t;){const l=e[this.pos];if(Xy(l)||Sm(l))this.pos++;else break}const r=e.slice(s,this.pos),a=r.toLowerCase();return a==="and"?{type:"and",pos:s}:a==="or"?{type:"or",pos:s}:a==="not"?{type:"not",pos:s}:a==="crossesabove"?{type:"crossesAbove",pos:s}:a==="crossesbelow"?{type:"crossesBelow",pos:s}:{type:"identifier",value:r,pos:s}}switch(this.pos++,i){case">":return e[this.pos]==="="?(this.pos++,{type:"gte",pos:s}):{type:"gt",pos:s};case"<":return e[this.pos]==="="?(this.pos++,{type:"lte",pos:s}):{type:"lt",pos:s};case"=":{if(e[this.pos]==="=")return this.pos++,{type:"eq",pos:s};throw new Error(`Unexpected '=' at ${s}, expected '=='`)}case"!":{if(e[this.pos]==="=")return this.pos++,{type:"neq",pos:s};throw new Error(`Unexpected '!' at ${s}, expected '!='`)}case"(":return{type:"lparen",pos:s};case")":return{type:"rparen",pos:s};case",":return{type:"comma",pos:s};default:throw new Error(`Unexpected character "${i}" at position ${s}`)}}}class rv extends Error{constructor(e,t){super(e),this.position=t,this.name="ConditionParseError"}}class eO{constructor(e){re(this,"current");this.tokenizer=e,this.current=e.next()}cur(){return this.current.type}eat(e){if(this.current.type!==e)throw new rv(`Expected ${e} but found ${this.current.type}`,this.current.pos);const t=this.current;return this.current=this.tokenizer.next(),t}match(e){return this.current.type===e?(this.current=this.tokenizer.next(),!0):!1}parseCondition(){const e=this.parseOr();if(this.current.type!=="eof")throw new rv("Unexpected input after end of condition",this.current.pos);return e}parseOr(){let e=this.parseAnd();for(;this.current.type==="or";){this.eat("or");const t=this.parseAnd();e={kind:"Logical",op:"or",left:e,right:t}}return e}parseAnd(){let e=this.parsePrimary();for(;this.current.type==="and";){this.eat("and");const t=this.parsePrimary();e={kind:"Logical",op:"and",left:e,right:t}}return e}parsePrimary(){if(this.current.type==="lparen"){this.eat("lparen");const e=this.parseOr();return this.eat("rparen"),e}if(this.current.type==="not")return this.eat("not"),{kind:"Negation",expr:this.parsePrimary()};if(this.current.type==="identifier"){const e=this.eat("identifier");if(this.cur()==="lparen"){this.eat("lparen");const a=[];if(this.cur()!=="rparen")for(;a.push(this.parseValue()),!!this.match("comma"););return this.eat("rparen"),String(e.value||"").toLowerCase()==="between"&&a.length===3?{kind:"Between",value:a[0],a:a[1],b:a[2]}:{kind:"Call",name:String(e.value||""),args:a}}const t={kind:"SeriesRef",name:String(e.value||"")};{const a=this.cur();if(a==="crossesAbove"||a==="crossesBelow"){const l=this.current;if(this.current=this.tokenizer.next(),t.kind!=="SeriesRef")throw new rv("`crossesAbove/crossesBelow` left side must be a series name",l.pos);const d=this.parseValue();return{kind:"Cross",dir:l.type==="crossesAbove"?"above":"below",left:t,right:d}}}{const a=this.cur();if(a!=="gt"&&a!=="lt"&&a!=="gte"&&a!=="lte"&&a!=="eq"&&a!=="neq")return{kind:"Comparison",op:">",left:t,right:{kind:"NumberLiteral",value:0}}}const s=this.current;this.current=this.tokenizer.next();let i=">";s.type==="lt"?i="<":s.type==="gte"?i=">=":s.type==="lte"?i="<=":s.type==="eq"&&(i="==");const r=this.parseValue();return s.type==="neq"?{kind:"Logical",op:"or",left:{kind:"Comparison",op:">",left:t,right:r},right:{kind:"Comparison",op:"<",left:t,right:r}}:{kind:"Comparison",op:i,left:t,right:r}}return this.parseAtomCondition()}parseAtomCondition(){const e=this.parseValue();if(this.current.type==="crossesAbove"||this.current.type==="crossesBelow"){const a=this.current;if(this.current=this.tokenizer.next(),e.kind!=="SeriesRef")throw new rv("`crossesAbove/crossesBelow` left side must be a series name",a.pos);const l=this.parseValue();return{kind:"Cross",dir:a.type==="crossesAbove"?"above":"below",left:e,right:l}}if(this.current.type!=="gt"&&this.current.type!=="lt"&&this.current.type!=="gte"&&this.current.type!=="lte"&&this.current.type!=="eq"&&this.current.type!=="neq")return{kind:"Comparison",op:">",left:e,right:{kind:"NumberLiteral",value:0}};const t=this.current;let s;switch(t.type){case"gt":s=">";break;case"lt":s="<";break;case"gte":s=">=";break;case"lte":s="<=";break;case"eq":s="==";break;case"neq":s="==";break;default:s=">";break}this.current=this.tokenizer.next();const i=this.parseValue(),r={kind:"Comparison",op:s,left:e,right:i};return t.type==="neq"?{kind:"Logical",op:"or",left:{kind:"Comparison",op:">",left:e,right:i},right:{kind:"Comparison",op:"<",left:e,right:i}}:r}parseSeriesRef(){if(this.current.type!=="identifier")throw new rv("Expected series name",this.current.pos);const e=this.current;return this.current=this.tokenizer.next(),{kind:"SeriesRef",name:e.value||""}}parseValue(){if(this.current.type==="number"){const e=this.current;this.current=this.tokenizer.next();const t=Number(e.value);if(!Number.isFinite(t))throw new rv("Invalid number literal",e.pos);return{kind:"NumberLiteral",value:t}}if(this.current.type==="identifier"){const e=this.current;if(this.current=this.tokenizer.next(),this.current.type==="lparen"){this.eat("lparen");const t=[];if(this.current.type!=="rparen")for(;t.push(this.parseValue()),!!this.match("comma"););return this.eat("rparen"),{kind:"ValueCall",name:String(e.value||""),args:t}}return{kind:"SeriesRef",name:String(e.value||"")}}throw new rv(`Expected number or identifier but found ${this.current.type}`,this.current.pos)}}function Mv(o){return new eO(new QR(o)).parseCondition()}class Ex extends Error{constructor(e){super(e),this.name="ConditionEngineError"}}function tO(o){return o.replace(/\s+/g,"_").toLowerCase()}function id(o,e){const t=tO(e),s=o[t];if(s)return s;const i=t.replace(/_/g,"");if(i&&o[i])return o[i];if(i){const a=Object.keys(o).find(l=>l.replace(/_/g,"")===i);if(a&&o[a])return o[t]=o[a],o[t]}const r=Object.keys(o).slice(0,24).join(", ");throw new Ex(`Series "${e}" not found; available series: ${r}${Object.keys(o).length>24?", ...":""}`)}function oO(o){const e=Object.entries(o);if(!e.length)return 0;const t=e[0][1].length;for(const[,s]of e)if(s.length!==t)throw new Ex("All series must have the same length");return t}function ep(o,e,t){var s,i,r,a,l,d;if(o.kind==="NumberLiteral")return o.value;if(o.kind==="SeriesRef")return id(t,o.name)[e];if(o.kind==="ValueCall"){const v=String(o.name||"").toLowerCase(),p=o.args;if(v==="lowest"||v==="highest"){const _=p[0],y=p[1],w=id(t,_.name||String(_)),k=Math.max(1,Math.floor(y.value??Number(y.name)??1)),S=Math.max(0,e-k+1);let L=v==="lowest"?1/0:-1/0;for(let T=S;T<=e;T++){const P=w[T];Number.isFinite(P)&&(v==="lowest"?L=Math.min(L,P):L=Math.max(L,P))}return Number.isFinite(L)?L:NaN}if(v==="lag"||v==="prev"){const _=p[0],y=p[1],w=id(t,_.name||String(_)),k=Math.max(1,Math.floor((y==null?void 0:y.value)??Number(y==null?void 0:y.name)??1)),S=e-k;return S>=0?w[S]:NaN}if(v==="change"){const _=p[0],y=p[1],w=id(t,_.name||String(_)),k=Math.max(1,Math.floor((y==null?void 0:y.value)??Number(y==null?void 0:y.name)??1)),S=e-k,L=w[e],T=S>=0?w[S]:NaN;return Number.isFinite(L)&&Number.isFinite(T)?L-T:NaN}if(v==="abs"){const _=ep(p[0],e,t);return Math.abs(_)}if(v==="add"||v==="sub"||v==="mul"||v==="div"){const _=ep(p[0],e,t),y=ep(p[1],e,t);return[_,y].every(Number.isFinite)?v==="add"?_+y:v==="sub"?_-y:v==="mul"?_*y:y===0?NaN:_/y:NaN}if(v==="min"||v==="max"){const _=ep(p[0],e,t),y=ep(p[1],e,t);return[_,y].every(Number.isFinite)?v==="min"?Math.min(_,y):Math.max(_,y):NaN}if(v==="sma"){const _=((s=p[0])==null?void 0:s.name)||String(p[0]),y=((i=p[1])==null?void 0:i.value)??Number((r=p[1])==null?void 0:r.name),w=Math.max(1,Math.floor(Number(y)||0)),k=id(t,_);if(!Number.isFinite(k[e]))return NaN;let S=0,L=0;const T=Math.max(0,e-w+1);for(let P=T;P<=e;P++){const A=k[P];Number.isFinite(A)&&(S+=A,L++)}return L?S/L:NaN}if(v==="ema"){const _=((a=p[0])==null?void 0:a.name)||String(p[0]),y=((l=p[1])==null?void 0:l.value)??Number((d=p[1])==null?void 0:d.name),w=Math.max(1,Math.floor(Number(y)||0)),k=id(t,_),S=2/(w+1);let L;for(let T=0;T<=e;T++){const P=k[T];Number.isFinite(P)&&(L===void 0?L=P:L=P*S+L*(1-S))}return L??NaN}return NaN}return NaN}function sO(o,e,t){const s=ep(o.left,e,t),i=ep(o.right,e,t);if(!Number.isFinite(s)||!Number.isFinite(i))return!1;switch(o.op){case">":return s>i;case"<":return s<i;case">=":return s>=i;case"<=":return s<=i;case"==":return Math.abs(s-i)<1e-9;default:return!1}}function nO(o,e,t){if(e===0)return!1;const s=id(t,o.left.name);let i,r;if(o.right.kind==="NumberLiteral")i=o.right.value,r=o.right.value;else{const d=id(t,o.right.name);i=d[e-1],r=d[e]}const a=s[e-1],l=s[e];return!Number.isFinite(a)||!Number.isFinite(i)||!Number.isFinite(l)||!Number.isFinite(r)?!1:o.dir==="above"?a<=i&&l>r:a>=i&&l<r}function iO(o,e,t){return o.op==="and"?nf(o.left,e,t)&&nf(o.right,e,t):nf(o.left,e,t)||nf(o.right,e,t)}function rO(o,e,t){let s=-1/0;for(let i=e;i<=t;i++){const r=o[i];Number.isFinite(r)&&r>s&&(s=r)}return s}function aO(o,e,t){let s=1/0;for(let i=e;i<=t;i++){const r=o[i];Number.isFinite(r)&&r<s&&(s=r)}return s}function kv(o,e=1){if(!o)return e;if(o.kind==="NumberLiteral")return Number(o.value)||e;const t=o.name?String(o.name):"",s=Number(t);return Number.isFinite(s)?s:e}function lO(o,e,t,s){var l,d;const i=o.toLowerCase(),r=v=>ep(v,t,s),a=v=>{const p=v?r(v):NaN;return Number.isFinite(p)?Math.max(0,p):0};if(i==="higherhigh"){const v=Math.max(1,Math.floor(kv(e[0],1))),p=id(s,"high"),_=Math.max(0,t-v),y=rO(p,_,Math.max(0,t-1));return Number.isFinite(p[t])&&p[t]>y}if(i==="lowerlow"){const v=Math.max(1,Math.floor(kv(e[0],1))),p=id(s,"low"),_=Math.max(0,t-v),y=aO(p,_,Math.max(0,t-1));return Number.isFinite(p[t])&&p[t]<y}if(i==="swinghigh"){const v=Math.max(1,Math.floor(kv(e[0],3))),p=id(s,"high"),_=p[t];if(!Number.isFinite(_))return!1;for(let y=t-v;y<=t+v;y++){if(y===t)continue;const w=p[y];if(Number.isFinite(w)&&w>=_)return!1}return!0}if(i==="swinglow"){const v=Math.max(1,Math.floor(kv(e[0],3))),p=id(s,"low"),_=p[t];if(!Number.isFinite(_))return!1;for(let y=t-v;y<=t+v;y++){if(y===t)continue;const w=p[y];if(Number.isFinite(w)&&w<=_)return!1}return!0}if(i==="volspike"){const v=Math.max(1,kv(e[0],1)),p=id(s,"volume"),y=Math.max(0,t-20+1),w=(()=>{let k=0,S=0;for(let L=y;L<=t;L++){const T=p[L];Number.isFinite(T)&&(k+=T,S++)}return S?k/S:NaN})();return Number.isFinite(p[t])&&Number.isFinite(w)&&p[t]>v*w}if(i==="atrspike"){const v=Math.max(1,kv(e[0],1)),p=id(s,"high"),_=id(s,"low"),y=id(s,"close"),w=14,k=F=>{const B=p[F],R=_[F],N=y[F-1];let $=Math.max(0,B-R);return Number.isFinite(N)&&($=Math.max($,Math.abs(B-N),Math.abs(R-N))),$};let S=NaN,L=0;for(let F=0;F<=t;F++){const B=k(F);L+=B,F===w-1?S=L/w:F>=w&&(S=(S*(w-1)+B)/w)}let T=NaN,P=0,A=0;for(let F=Math.max(0,t-w+1);F<=t;F++){const B=k(F);P+=B,A++}return T=A?P/A:NaN,Number.isFinite(S)&&Number.isFinite(T)&&S>v*T}if(i==="trend"){const v=String(((l=e[0])==null?void 0:l.name)||"").toLowerCase()||"up",p=id(s,"close"),y=Math.max(0,t-10+1),w=(()=>{let k=0,S=0,L=0,T=0,P=0;for(let F=y;F<=t;F++){const B=F-y,R=p[F];Number.isFinite(R)&&(k+=B,S+=R,L+=B*B,T+=B*R,P++)}const A=P*L-k*k;return A===0||P===0?0:(P*T-k*S)/A})();return v==="up"?w>0:w<0}if(i==="crossover"||i==="crossunder"){const v=e[0],p=e[1],_=a(e[2]),y=id(s,v.name||String(v));let w,k;if(p.kind==="NumberLiteral")w=p.value,k=p.value;else{const T=id(s,p.name||String(p));w=T[t-1],k=T[t]}const S=y[t-1],L=y[t];return[S,L,w,k].every(Number.isFinite)?i==="crossover"?S<=w+_&&L>k+_:S>=w-_&&L<k-_:!1}if(i==="rising"||i==="falling"){const v=id(s,((d=e[0])==null?void 0:d.name)||String(e[0])),p=Math.max(1,Math.floor(kv(e[1],3))),_=Math.max(0,t-p+1);let y=0,w=0,k=0,S=0,L=0;for(let A=_;A<=t;A++){const F=A-_,B=v[A];Number.isFinite(B)&&(y+=F,w+=B,k+=F*F,S+=F*B,L++)}const T=L*k-y*y,P=T===0||L===0?0:(L*S-y*w)/T;return i==="rising"?P>0:P<0}if(i==="above"||i==="below"){const v=r(e[0]),p=r(e[1]),_=a(e[2]);return!Number.isFinite(v)||!Number.isFinite(p)?!1:i==="above"?v>p+_:v<p-_}return!1}function nf(o,e,t){switch(o.kind){case"Comparison":return sO(o,e,t);case"Cross":return nO(o,e,t);case"Logical":return iO(o,e,t);case"Negation":return!nf(o.expr,e,t);case"Between":{const s=o,i=ep(s.value,e,t),r=ep(s.a,e,t),a=ep(s.b,e,t);if(![i,r,a].every(Number.isFinite))return!1;const l=Math.min(r,a),d=Math.max(r,a);return i>=l&&i<=d}case"Call":{const s=o;return lO(String(s.name||""),s.args||[],e,t)}default:return!1}}function Jy(o,e){const t=oO(e),s=new Uint8Array(t);for(let i=0;i<t;i++)s[i]=nf(o,i,e)?1:0;return s}const Qy=["sma","smma","ema","wma","rsi","bbands","bollinger","bollinger_bands","atr","obv","cci","mfi","ao","trix","vwap","vwma","zscore","evwma","roc","macd","supertrend","kc","keltner","donchian","atr_bands","vwap_bands","linreg_channel","sar","stoch","ichimoku","pivot_high","pivot_low","auto_fib","autofib","last_value","prev_value","line_value","security","expr","formula"],e2=["line","histogram","area","dots","stepped","bar","neon_line","bezier_line","glow_points","heatmap","distortion","cloud","aura","candleshadow","supertrend_cloud","fractal_boxes","liquidity_tiles"],t2=["arrowUp","arrowDown","circle","square","triangle_up_filled","triangle_down_filled","box","label","text","emoji","triangle_up_gradient","arrow_up_glow","pill","tag","flag"];function Rl(o){return Array.isArray(o)?o:[]}function Fc(o){return typeof o=="string"?o:void 0}function $c(o){return typeof o=="number"&&Number.isFinite(o)?o:void 0}function $x(o){const e=[];if(!o||typeof o!="object")return e.push("Script must be an object"),{ok:!1,errors:e};const t=o,s=!!(t!=null&&t.strategy)||Rl(t==null?void 0:t.signals).length>0,i=Rl(t.calc),r=Rl(t.series),a=Rl(t.stateSeries),l=[];if(Array.isArray(t.panes)&&t.panes.length)for(const v of t.panes){const p=v.pane==="sub"?"sub":"main";l.push({pane:p,plots:Rl(v.plots),levels:Rl(v.levels),labels:Rl(v.labels),lines:Rl(v.lines),overlays:Rl(v.overlays),min:$c(v.min),max:$c(v.max),shortName:Fc(v.shortName),fills:Rl(v.fills),backgroundZones:Rl(v.backgroundZones),height:$c(v.height)})}else if(t.main||t.sub)t.main&&l.push({pane:"main",plots:Rl(t.main.plots),levels:Rl(t.main.levels),labels:Rl(t.main.labels),lines:Rl(t.main.lines),overlays:Rl(t.main.overlays),min:$c(t.main.min),max:$c(t.main.max),shortName:Fc(t.main.shortName||t.shortName),fills:Rl(t.main.fills),backgroundZones:Rl(t.main.backgroundZones),height:$c(t.main.height)}),t.sub&&l.push({pane:"sub",plots:Rl(t.sub.plots),levels:Rl(t.sub.levels),labels:Rl(t.sub.labels),lines:Rl(t.sub.lines),overlays:Rl(t.sub.overlays),min:$c(t.sub.min),max:$c(t.sub.max),shortName:Fc(t.sub.shortName||t.shortName),fills:Rl(t.sub.fills),backgroundZones:Rl(t.sub.backgroundZones),height:$c(t.sub.height)});else if(t.pane||t.plots||t.labels||t.levels||t.lines){const v=t.pane==="sub"?"sub":"main";l.push({pane:v,plots:Rl(t.plots),levels:Rl(t.levels),labels:Rl(t.labels),lines:Rl(t.lines),overlays:Rl(t.overlays),min:$c(t.min),max:$c(t.max),shortName:Fc(t.shortName),fills:[],backgroundZones:[],height:void 0})}l.length||(s?l.push({pane:"main",plots:[],levels:[],labels:[],lines:[],overlays:[],min:$c(t.min),max:$c(t.max),shortName:Fc(t.shortName),fills:[],backgroundZones:[],height:void 0}):e.push("No panes defined"));const d={calc:i.map((v,p)=>({name:Fc(v.name)||Fc(v.type)||`calc_${p}`,type:Fc(v.type)||Fc(v.name),source:Fc(v.source),period:$c(v.period),fast:$c(v.fast),slow:$c(v.slow),signal:$c(v.signal),kPeriod:$c(v.kPeriod),dPeriod:$c(v.dPeriod),left:$c(v.left),right:$c(v.right),tenkan:$c(v.tenkan),kijun:$c(v.kijun),senkouB:$c(v.senkouB),expr:Fc(v.expr),timeframe:Fc(v.timeframe),symbol:Fc(v.symbol),country:Fc(v.country),lookahead:Fc(v.lookahead),gaps:Fc(v.gaps),params:v.params,style:v.style})),series:r.map((v,p)=>({name:Fc(v.name)||`series_${p}`,expr:Fc(v.expr)||""})),stateSeries:a.map((v,p)=>({name:Fc(v.name)||`state_${p}`,initExpr:Fc(v.initExpr),updateExpr:Fc(v.updateExpr)||""})),panes:l,signals:Rl(t.signals).map(v=>{const p=v==null?void 0:v.order,_=Fc(p==null?void 0:p.kind),y=_?_.trim().toLowerCase().replace(/stop\s*limit|stoplimit/g,"stop_limit"):void 0,w=U=>{if(typeof U=="number"&&Number.isFinite(U)||typeof U=="string")return U},k=w(p==null?void 0:p.price),S=w((p==null?void 0:p.stopPrice)??(p==null?void 0:p.stop)??(p==null?void 0:p.trigger)),L=w((p==null?void 0:p.limitPrice)??(p==null?void 0:p.limit)??(p==null?void 0:p.lmt)),T=typeof(p==null?void 0:p.qtyPct)=="number"&&Number.isFinite(p.qtyPct)?p.qtyPct:void 0,P=typeof T=="number"?Math.max(0,Math.min(100,T)):void 0,A=Fc(p==null?void 0:p.oco),F=typeof(p==null?void 0:p.expiresBars)=="number"&&Number.isFinite(p.expiresBars)?p.expiresBars:void 0,B=typeof F=="number"?Math.max(0,Math.floor(F)):void 0,R=p==null?void 0:p.bracket,N=(()=>{if(!R||typeof R!="object")return;const U=R,G=typeof U.stopLossPct=="number"&&Number.isFinite(U.stopLossPct)?Math.max(0,U.stopLossPct):void 0,Z=typeof U.takeProfitPct=="number"&&Number.isFinite(U.takeProfitPct)?Math.max(0,U.takeProfitPct):void 0,le=typeof U.trailingStopPct=="number"&&Number.isFinite(U.trailingStopPct)?Math.max(0,U.trailingStopPct):void 0,se=[],ie=Array.isArray(U.takeProfits)?U.takeProfits:[];for(const Y of ie){if(!Y||typeof Y!="object")continue;const K=typeof Y.takeProfitPct=="number"?Y.takeProfitPct:Number(Y.takeProfitPct),Q=typeof Y.qtyPct=="number"?Y.qtyPct:Number(Y.qtyPct);!Number.isFinite(K)||K<=0||!Number.isFinite(Q)||Q<=0||se.push({takeProfitPct:Math.max(0,K),qtyPct:Math.max(0,Math.min(100,Q))})}if(se.sort((Y,K)=>Y.takeProfitPct-K.takeProfitPct),!(G==null&&Z==null&&le==null&&se.length===0))return{stopLossPct:G,takeProfitPct:Z,trailingStopPct:le,takeProfits:se.length?se:void 0}})(),$=typeof(v==null?void 0:v.cooldownBars)=="number"&&Number.isFinite(v.cooldownBars)?v.cooldownBars:void 0,V=typeof $=="number"?Math.max(0,Math.floor($)):void 0;return{type:String((v==null?void 0:v.type)||""),when:String((v==null?void 0:v.when)||""),id:Fc(v==null?void 0:v.id),order:y||k!=null||S!=null||L!=null||P!=null||A!=null||B!=null||N!=null?{kind:y,price:k,stopPrice:S,limitPrice:L,qtyPct:P,oco:A,expiresBars:B,bracket:N}:void 0,cooldownBars:V}}),shortName:Fc(t.shortName),strategy:t.strategy,params:t.params,style:t.style};return d.series.forEach((v,p)=>{v.name||e.push(`series[${p}] missing name`)}),d.stateSeries.forEach((v,p)=>{v.name||e.push(`stateSeries[${p}] missing name`),v.updateExpr||e.push(`stateSeries[${p}] missing updateExpr`)}),d.panes.forEach((v,p)=>{var _,y,w,k;!s&&!((_=v.plots)!=null&&_.length)&&!((y=v.labels)!=null&&y.length)&&!((w=v.levels)!=null&&w.length)&&!((k=v.lines)!=null&&k.length)&&e.push(`pane[${p}] has no plots/labels/levels/lines`)}),{ok:e.length===0,spec:d,errors:e}}function jx(o,e){const t=i=>i.replace(/\$\{([^}]+)\}/g,(r,a)=>{const l=String(a),d=e[l];if(d==null)return r;if(typeof d=="number"&&Number.isFinite(d))return String(d);if(typeof d=="string")return d;try{return JSON.stringify(d)}catch{return String(d)}}),s=i=>{if(i==null)return i;if(typeof i=="string"){const r=i.match(/^\$\{([^}]+)\}$/);if(r){const a=String(r[1]),l=e[a];return l??i}return t(i)}if(Array.isArray(i))return i.map(s);if(typeof i=="object"){const r=Array.isArray(i)?[]:{};return Object.keys(i).forEach(a=>{const l=i[a];r[a]=s(l)}),r}return i};return s(o)}function oh(o,e,t){if(o.save(),e&&(o.beginPath(),o.rect(e.left,e.top,e.width,e.height),o.clip()),t)try{t()}finally{o.restore()}}function o2(o,e,t,s,i){if(!e.length)return;const r=Math.max(1,s/2);oh(o,i,()=>{o.save(),o.fillStyle=t;for(let a=0;a<e.length;a++){const{x:l,y:d}=e[a];!Number.isFinite(l)||!Number.isFinite(d)||(o.beginPath(),o.arc(l,d,r,0,Math.PI*2),o.fill())}o.restore()})}function cO(o,e,t,s,i,r,a){e.length&&oh(o,a,()=>{o.beginPath();let l=!1;for(let p=0;p<e.length;p++){const _=e[p];!Number.isFinite(_.x)||!Number.isFinite(_.y)||(l?o.lineTo(_.x,_.y):(o.moveTo(_.x,_.y),l=!0))}if(!l)return;const d=e[e.length-1],v=e.find(p=>Number.isFinite(p.x)&&Number.isFinite(p.y));o.lineTo(d.x,t),o.lineTo(v.x,t),o.closePath(),o.save(),o.fillStyle=s,o.fill(),o.restore(),i&&r>0})}function dO(o,e,t,s,i){e.length&&oh(o,i,()=>{o.beginPath();let r=!1;for(let a=0;a<e.length-1;a++){const l=e[a],d=e[a+1];!Number.isFinite(l.x)||!Number.isFinite(l.y)||!Number.isFinite(d.x)||!Number.isFinite(d.y)||(r||(o.moveTo(l.x,l.y),r=!0),o.lineTo(d.x,l.y),o.lineTo(d.x,d.y))}r&&(o.strokeStyle=t,o.lineWidth=s,o.setLineDash([]),o.stroke())})}function s2(o,e,t,s,i){!e.length||!t.length||oh(o,i,()=>{var a,l;o.beginPath();let r=0;for(;r<e.length&&!(Number.isFinite((a=e[r])==null?void 0:a.x)&&Number.isFinite((l=e[r])==null?void 0:l.y));)r++;if(!(r>=e.length)){for(o.moveTo(e[r].x,e[r].y);r<e.length;r++){const d=e[r];!Number.isFinite(d==null?void 0:d.x)||!Number.isFinite(d==null?void 0:d.y)||o.lineTo(d.x,d.y)}for(let d=t.length-1;d>=0;d--){const v=t[d];!Number.isFinite(v==null?void 0:v.x)||!Number.isFinite(v==null?void 0:v.y)||o.lineTo(v.x,v.y)}o.closePath(),o.save(),o.fillStyle=s,o.fill(),o.restore()}})}class zx{constructor(e){re(this,"storage");re(this,"runtime",null);re(this,"events",{});re(this,"state");re(this,"symbolChangeCallbacks",new Set);re(this,"currentSymbol",null);this.storage=e||MD,this.state=Id({activeSaveId:null,savedLayouts:[],isLoading:!1,lastError:null,initialized:!1}),this.initialize()}async initialize(){try{this.updateState({isLoading:!0});const[e,t]=await Promise.all([this.storage.getActiveSaveId(),this.storage.listSavedLayouts()]);this.updateState({activeSaveId:e,savedLayouts:t,isLoading:!1,lastError:null})}catch(e){console.error("Failed to initialize SaveManager:",e),this.updateState({isLoading:!1,lastError:"Failed to initialize save system"})}}setRuntimeContracts(e){this.runtime=e,this.runtime.onSymbolChange(this.handleSymbolChange.bind(this)),this.currentSymbol=this.runtime.getCurrentSymbol(),this.updateState({initialized:!0}),console.log("✅ SaveManager fully initialized and ready")}setEventHandlers(e){this.events={...this.events,...e}}async handleSymbolChange(e){this.currentSymbol,this.currentSymbol=e;const t=this.getState();if(t.activeSaveId&&this.runtime)try{const s=await this.storage.getSavedLayout(t.activeSaveId);if(s){this.runtime.clearAllDrawings();const i=s.drawingsBySymbol[e]||[];this.runtime.renderDrawings(i)}}catch(s){console.error("Failed to reload drawings for symbol change:",s)}this.symbolChangeCallbacks.forEach(s=>{try{s(e)}catch(i){console.error("Symbol change callback error:",i)}})}onSymbolChange(e){this.symbolChangeCallbacks.add(e)}offSymbolChange(e){this.symbolChangeCallbacks.delete(e)}updateState(e){this.state.update(t=>({...t,...e}))}getState(){let e;return this.state.subscribe(t=>e=t)(),e}validateSaveName(e,t){return!e||e.trim().length===0?{valid:!1,error:"Name is required"}:e.length>100?{valid:!1,error:"Name must be 100 characters or less"}:this.getState().savedLayouts.some(r=>r.name===e&&r.id!==t)?{valid:!1,error:"Name already exists"}:{valid:!0}}async collectCurrentState(){if(!this.runtime)throw new Error("Runtime contracts not set");try{const e=this.runtime.getCurrentSymbol(),t=this.runtime.collectGlobalState(),s=this.runtime.collectDrawings(e);return{global:t,drawings:s,symbol:e}}catch(e){return console.error("Failed to collect chart state:",e),null}}async save(e){var t,s,i,r;try{this.updateState({isLoading:!0,lastError:null});const a=this.validateSaveName(e);if(!a.valid)return this.updateState({isLoading:!1,lastError:a.error}),{success:!1,error:a.error};const l=await this.collectCurrentState();if(!l)return this.updateState({isLoading:!1,lastError:"Failed to collect chart state"}),{success:!1,error:"Failed to collect chart state"};const d={name:e,timezone:l.global.timezone,interval:l.global.interval,chartType:l.global.chartType,theme:l.global.theme,panes:l.global.panes,indicators:l.global.indicators,styles:l.global.styles,options:l.global.options,drawingsBySymbol:{[l.symbol]:l.drawings}},v=await this.storage.createSavedLayout(d);await this.storage.setActiveSaveId(v.id);const p=await this.storage.listSavedLayouts();return this.updateState({activeSaveId:v.id,savedLayouts:p,isLoading:!1}),(s=(t=this.events).onSaved)==null||s.call(t,v),{success:!0,layout:v}}catch(a){console.error("Save failed:",a);const l=a instanceof Error?a.message:"Save failed";return this.updateState({isLoading:!1,lastError:l}),(r=(i=this.events).onError)==null||r.call(i,l),{success:!1,error:l}}}async quickSave(){var t,s,i,r;const e=this.getState();if(!e.activeSaveId)return this.updateState({isLoading:!1,lastError:"No active save to update"}),{success:!1,error:"No active save to update"};try{this.updateState({isLoading:!0,lastError:null});const a=await this.storage.getSavedLayout(e.activeSaveId);if(!a)return this.updateState({isLoading:!1,lastError:"Active save not found"}),{success:!1,error:"Active save not found"};const l=await this.collectCurrentState();if(!l)return this.updateState({isLoading:!1,lastError:"Failed to collect chart state"}),{success:!1,error:"Failed to collect chart state"};const d={timezone:l.global.timezone,interval:l.global.interval,chartType:l.global.chartType,theme:l.global.theme,panes:l.global.panes,indicators:l.global.indicators,styles:l.global.styles,options:l.global.options,drawingsBySymbol:{...a.drawingsBySymbol,[l.symbol]:l.drawings}},v=await this.storage.updateSavedLayout(e.activeSaveId,d),p=await this.storage.listSavedLayouts();return this.updateState({savedLayouts:p,isLoading:!1}),(s=(t=this.events).onSaved)==null||s.call(t,v),{success:!0,layout:v}}catch(a){console.error("Quick save failed:",a);const l=a instanceof Error?a.message:"Quick save failed";return this.updateState({isLoading:!1,lastError:l}),(r=(i=this.events).onError)==null||r.call(i,l),{success:!1,error:l}}}async saveTo(e){var t,s,i,r,a,l;try{this.updateState({isLoading:!0,lastError:null});const d=await this.collectCurrentState();if(!d)return this.updateState({isLoading:!1,lastError:"Failed to collect chart state"}),{success:!1,error:"Failed to collect chart state"};const v=await this.storage.getSavedLayout(e),p={timezone:d.global.timezone,interval:d.global.interval,chartType:d.global.chartType,theme:d.global.theme,panes:d.global.panes,indicators:d.global.indicators,styles:d.global.styles,options:d.global.options,drawingsBySymbol:v?{...v.drawingsBySymbol,[d.symbol]:d.drawings}:{[d.symbol]:d.drawings}};if(!v){console.log("📝 Layout not found locally, creating new layout via API");const w={name:`Layout ${new Date().toLocaleString()}`,...p},k=await this.storage.createSavedLayout(w);await this.storage.setActiveSaveId(k.id);const S=await this.storage.listSavedLayouts();return this.updateState({activeSaveId:k.id,savedLayouts:S,isLoading:!1}),(s=(t=this.events).onSaved)==null||s.call(t,k),{success:!0,layout:k}}const _=await this.storage.updateSavedLayout(e,p);await this.storage.setActiveSaveId(e);const y=await this.storage.listSavedLayouts();return this.updateState({activeSaveId:e,savedLayouts:y,isLoading:!1}),(r=(i=this.events).onSaved)==null||r.call(i,_),{success:!0,layout:_}}catch(d){console.error("Save to existing failed:",d);const v=d instanceof Error?d.message:"Save failed";return this.updateState({isLoading:!1,lastError:v}),(l=(a=this.events).onError)==null||l.call(a,v),{success:!1,error:v}}}async saveAs(e){return this.save(e)}async load(e){var t,s,i,r,a,l,d,v,p,_,y,w;try{this.updateState({isLoading:!0,lastError:null}),console.log("🔄 Loading layout:",e);const k=await this.storage.getSavedLayout(e);if(!k)try{await this.refresh();const T=await this.storage.getSavedLayout(e);if(!T){const B=await this.storage.listSavedLayouts();if(B&&B.length>0){const R=B[0].id,N=await this.storage.getSavedLayout(R);if(N){if(!this.runtime)return this.updateState({isLoading:!1,lastError:"Runtime contracts not set"}),{success:!1,error:"Runtime contracts not set"};await this.runtime.applyGlobalState({timezone:N.timezone,interval:N.interval,chartType:N.chartType,theme:N.theme,panes:N.panes,indicators:N.indicators,styles:N.styles,options:N.options});const $=this.runtime.getCurrentSymbol();this.runtime.clearAllDrawings();const V=N.drawingsBySymbol[$]||[];return this.runtime.renderDrawings(V),await this.storage.setActiveSaveId(N.id),this.updateState({activeSaveId:N.id,isLoading:!1}),(s=(t=this.events).onLoaded)==null||s.call(t,N),{success:!0}}}return await this.storage.setActiveSaveId(null),this.updateState({isLoading:!1,lastError:"Layout not found"}),{success:!1,error:"Layout not found"}}const P=T;if(!this.runtime)return this.updateState({isLoading:!1,lastError:"Runtime contracts not set"}),{success:!1,error:"Runtime contracts not set"};await this.runtime.applyGlobalState({timezone:P.timezone,interval:P.interval,chartType:P.chartType,theme:P.theme,panes:P.panes,indicators:P.indicators,styles:P.styles,options:P.options});const A=this.runtime.getCurrentSymbol();this.runtime.clearAllDrawings();const F=P.drawingsBySymbol[A]||[];return this.runtime.renderDrawings(F),await this.storage.setActiveSaveId(P.id),this.updateState({activeSaveId:P.id,isLoading:!1}),(r=(i=this.events).onLoaded)==null||r.call(i,P),{success:!0}}catch{return await this.storage.setActiveSaveId(null),this.updateState({isLoading:!1,lastError:"Layout not found"}),{success:!1,error:"Layout not found"}}if(console.log("📊 Layout data loaded:",{name:k.name,indicatorCount:((a=k.indicators)==null?void 0:a.length)||0,indicators:((l=k.indicators)==null?void 0:l.map(T=>T.type))||[]}),!this.runtime)return console.error("❌ Runtime contracts not set"),this.updateState({isLoading:!1,lastError:"Runtime contracts not set"}),{success:!1,error:"Runtime contracts not set"};console.log("🔧 Applying global state with indicators:",((d=k.indicators)==null?void 0:d.length)||0),await this.runtime.applyGlobalState({timezone:k.timezone,interval:k.interval,chartType:k.chartType,theme:k.theme,panes:k.panes,indicators:k.indicators,styles:k.styles,options:k.options});const S=this.runtime.getCurrentSymbol();this.runtime.clearAllDrawings();const L=k.drawingsBySymbol[S]||[];return this.runtime.renderDrawings(L),await this.storage.setActiveSaveId(k.id),this.updateState({activeSaveId:k.id,isLoading:!1}),(p=(v=this.events).onLoaded)==null||p.call(v,k),console.log("✅ Layout loaded successfully:",{layoutId:k.id,name:k.name,indicatorsRestored:((_=k.indicators)==null?void 0:_.length)||0}),{success:!0}}catch(k){console.error("Load failed:",k);const S=k instanceof Error?k.message:"Load failed";return this.updateState({isLoading:!1,lastError:S}),(w=(y=this.events).onError)==null||w.call(y,S),{success:!1,error:S}}}async delete(e){var t,s,i,r;try{this.updateState({isLoading:!0,lastError:null}),await this.storage.deleteSavedLayout(e);const[a,l]=await Promise.all([this.storage.getActiveSaveId(),this.storage.listSavedLayouts()]);return this.updateState({activeSaveId:a,savedLayouts:l,isLoading:!1}),(s=(t=this.events).onDeleted)==null||s.call(t,e),{success:!0}}catch(a){console.error("Delete failed:",a);const l=a instanceof Error?a.message:"Delete failed";return this.updateState({isLoading:!1,lastError:l}),(r=(i=this.events).onError)==null||r.call(i,l),{success:!1,error:l}}}hasActiveSave(){return this.getState().activeSaveId!==null}getActiveSaveId(){return this.getState().activeSaveId}async clearActiveSave(){await this.storage.setActiveSaveId(null),this.updateState({activeSaveId:null})}async refresh(){try{this.updateState({isLoading:!0});const e=await this.storage.listSavedLayouts();this.updateState({savedLayouts:e,isLoading:!1,lastError:null})}catch(e){console.error("Refresh failed:",e),this.updateState({isLoading:!1,lastError:"Failed to refresh layouts"})}}destroy(){this.runtime&&this.symbolChangeCallbacks.clear()}}new zx;const F_="https://noti.dutyai.app/auth/chart/settings";class uO{constructor(){re(this,"localStorageProvider");re(this,"initialized",!1);this.localStorageProvider=new Lx}async initialize(){this.initialized||(await this.localStorageProvider.initialize(),this.initialized=!0)}hasUserId(){return typeof window<"u"&&!!localStorage.getItem("userId")}getUserId(){return typeof window<"u"?localStorage.getItem("userId"):null}async saveToApi(e){const t=this.getUserId();if(!t)throw new Error("User ID not found in localStorage");if(e._source==="api"&&!e._isModified)return console.log("🔄 Skipping API save for unmodified API-loaded data"),{...e,_source:"api"};try{console.log(e,"layoutData");const s=e.id||this.generateApiId(),i={clerkId:t,settings:e,id:s};console.log("🌐 Sending to API:",i);const r=await fetch(F_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!r.ok){const l=await r.text();throw console.error("API error response:",l),new Error(`API request failed: ${r.status} ${r.statusText} - ${l}`)}const a=await r.json();return console.log("✅ API save successful:",a),{...e,id:a.id||s,createdAt:a.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()}}catch(s){throw console.error("API save failed:",s),new Error("Failed to save to API")}}generateApiId(){return`api_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async loadFromApi(){var t;const e=this.getUserId();if(!e)throw new Error("User ID not found in localStorage");try{const s=`${F_}/${e}`;console.log("🌐 API Request:",s);const i=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"}});if(console.log("🌐 API Response Status:",i.status,i.statusText),!i.ok)throw new Error(`API request failed: ${i.status} ${i.statusText}`);const r=await i.json();return console.log("🌐 API Response Data:",r),Array.isArray(r)?r.map(a=>{var l;return{id:a.id,name:((l=a.settings)==null?void 0:l.name)||"Untitled Layout",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...a.settings,_source:"api"}}):[{id:r.id,name:((t=r.settings)==null?void 0:t.name)||"Untitled Layout",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),...r.settings,_source:"api"}]}catch(s){throw console.error("API load failed:",s),new Error("Failed to load from API")}}async deleteFromApi(e){if(!this.getUserId())throw new Error("User ID not found in localStorage");try{const s=`${F_}/${e}`;console.log("🌐 API Delete Request:",s);const i=await fetch(s,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(console.log("🌐 API Delete Response Status:",i.status,i.statusText),!i.ok)throw new Error(`API delete request failed: ${i.status} ${i.statusText}`);console.log("✅ Layout deleted successfully from API")}catch(s){throw console.error("API delete failed:",s),new Error("Failed to delete from API")}}async listSavedLayouts(){if(await this.initialize(),this.hasUserId())try{return console.log("🌐 Loading layouts from API (userId found)"),(await this.loadFromApi()).map(t=>({id:t.id,name:t.name||"Untitled Layout",createdAt:t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt||new Date().toISOString()}))}catch(e){console.error("API load failed, falling back to localStorage:",e)}return console.log("💾 Loading layouts from localStorage (no userId or API failed)"),this.localStorageProvider.listSavedLayouts()}async getSavedLayout(e){if(await this.initialize(),this.hasUserId())try{console.log("🌐 Loading specific layout from API");const s=(await this.loadFromApi()).find(i=>i.id===e);if(s)return s;console.log("📖 Layout not found in API response, falling back to localStorage")}catch(t){console.error("API load failed, falling back to localStorage:",t)}return this.localStorageProvider.getSavedLayout(e)}async createSavedLayout(e){if(await this.initialize(),this.hasUserId())try{return console.log("🌐 Saving to API (userId found)"),await this.saveToApi(e)}catch(t){console.error("API save failed, falling back to localStorage:",t)}return console.log("💾 Saving to localStorage (no userId or API failed)"),this.localStorageProvider.createSavedLayout(e)}async updateSavedLayout(e,t){if(await this.initialize(),this.hasUserId())try{console.log("🌐 Updating via API (userId found)");try{const a=(await this.loadFromApi()).find(l=>l.id===e);if(a){console.log("📝 Layout found in API, updating via API");const l={...a,...t,_isModified:!0};return await this.saveToApi(l)}}catch(r){console.log("📖 Layout not found in API, checking localStorage:",r)}const s=await this.localStorageProvider.getSavedLayout(e);if(s){console.log("📝 Layout found in localStorage, updating via API");const r={...s,...t};return await this.saveToApi(r)}console.log("📝 Layout not found, creating new via API");const i={id:e,...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),_isModified:!0};return await this.saveToApi(i)}catch(s){console.error("API update failed, falling back to localStorage:",s)}return console.log("💾 Updating in localStorage"),this.localStorageProvider.updateSavedLayout(e,t)}async deleteSavedLayout(e){if(await this.initialize(),this.hasUserId())try{console.log("🌐 Deleting layout from API"),await this.deleteFromApi(e),console.log("✅ Layout deleted from API successfully");return}catch(t){console.error("API delete failed, falling back to localStorage:",t)}return console.log("💾 Deleting from localStorage"),this.localStorageProvider.deleteSavedLayout(e)}async getActiveSaveId(){return await this.initialize(),this.localStorageProvider.getActiveSaveId()}async setActiveSaveId(e){return await this.initialize(),this.localStorageProvider.setActiveSaveId(e)}async cleanup(){return await this.initialize(),this.localStorageProvider.cleanup()}}function pO(o,e){Ka(e,!1);const t=Zc(),s=()=>ir(r,"$save",t),i=()=>ir(a,"$chart",t),r=Fa("save");Fa("ctx");const a=Fa("chart"),l=Fa("drawingManager"),d=(()=>{try{return Fa("saveRestoring")||null}catch{return null}})(),v=new uO,p=new zx(v);let _=null,y=null;function w(){try{console.log("🧹 Clearing persisted chart cache to prevent showing unsaved changes...");const L=s(),T=L!=null&&L.key&&typeof L.key=="string"?L.key:"chart";if(typeof localStorage<"u"){const P=localStorage.getItem(T);if(P)try{const B=JSON.parse(P),R={key:B.key||T,theme:B.theme||"dark",symbol:B.symbol||"BINANCE:BTCUSDT",period:B.period||{timeframe:"1d",timespan:"day"}};localStorage.setItem(T,JSON.stringify(R)),console.log("✅ Cleared unsaved chart changes, kept basic settings")}catch(B){console.warn("⚠️ Could not parse stored chart, clearing completely:",B),localStorage.removeItem(T)}const A=`${T}_drawings`,F=`${T}_overlays`;localStorage.removeItem(A),localStorage.removeItem(F),localStorage.removeItem("dataSpaceOverlays"),console.log("✅ Persisted chart cache cleared successfully")}try{r.update(P=>{var B,R,N,$;const A=((R=(B=P.styles)==null?void 0:B.candle)==null?void 0:R.type)||"renko_atr",F=(($=(N=P.styles)==null?void 0:N.candle)==null?void 0:$.renko)||{method:"ATR",atrLength:14,source:"close",wick:!1};return P.styles={candle:{type:A,renko:F}},P.options={},P.saveInds={},P})}catch(P){console.warn("⚠️ Failed to clear in‑memory save styles/options:",P)}}catch(L){console.error("❌ Error clearing persisted chart cache:",L)}}Rd(async()=>{if(i())k(i());else{const L=a.subscribe(T=>{T&&(L(),k(T))})}});async function k(L){var T,P;try{let A=0;const F=20;for(;!l.get()&&A<F;)await new Promise(N=>setTimeout(N,100)),A+=1;const B=l.get();B?console.log("✅ DrawingManager is available for save system"):console.error("❌ DrawingManager not available after waiting");const R={getCurrentSymbol:()=>Ly(s()),collectGlobalState:()=>JM(s(),L),collectDrawings:N=>{if(!B)return console.warn("⚠️ DrawingManager not available, returning empty drawings"),[];const $=B.getDrawingsForSymbol(N);return console.log(`📥 Collected ${$.length} drawings for symbol:`,N),$},applyGlobalState:async N=>await QM(N,r,L),clearAllDrawings:()=>{var N,$;B?B.hideRenderedDrawings():console.warn("⚠️ DrawingManager not available, cannot clear drawings");try{const V=((N=L==null?void 0:L.getOverlays)==null?void 0:N.call(L,{groupId:"drawing_tools"}))||[];for(const U of V)try{($=L==null?void 0:L.removeOverlay)==null||$.call(L,{id:U.id})}catch{}console.log("🗑️ Cleared chart overlays for drawing_tools group")}catch{}},renderDrawings:N=>{if(!B){console.warn("⚠️ DrawingManager not available, cannot render drawings");return}const $=Ly(s());console.log(`🎨 Rendering ${N.length} drawings for symbol:`,$),B.setCurrentSymbol($),B.loadDrawingsForSymbol($,N)},onSymbolChange:N=>{y=Cc(r,V=>Hp(V.symbol)).subscribe(V=>{_!==null&&_!==V&&(console.log("🔄 Save system detected symbol change:",_,"->",V),N(V)),_=V})},offSymbolChange:N=>{y&&(y(),y=null)}};p.setRuntimeContracts(R),p.setEventHandlers({onSaved:()=>{try{h_()}catch{}},onLoaded:()=>{try{h_()}catch{}}}),typeof window<"u"&&(window.saveManager=p,window.forceRefreshChart=async()=>{console.log("🔄 Force refresh triggered from WebView parent"),await S()},window.clearChartCache=()=>{var N;console.log("🗑️ Clearing chart cache");try{const $=(N=s())!=null&&N.key&&typeof s().key=="string"?s().key:"chart";localStorage.removeItem($);const V=`${$}_drawings`;localStorage.removeItem(V);const U=`${$}_overlays`;localStorage.removeItem(U),localStorage.removeItem("dataSpaceOverlays"),console.log("✅ Chart cache cleared")}catch($){console.error("❌ Error clearing cache:",$)}});try{p.getActiveSaveId()&&(d==null||d.set(!0))}catch{}w();try{const N=(T=s())!=null&&T.key&&typeof s().key=="string"?s().key:"chart";(typeof localStorage<"u"?localStorage.getItem(`${N}.lastTimeframe`):null)||typeof localStorage<"u"&&localStorage.setItem(`${N}.lastTimeframe`,"1d")}catch{}await S();try{const N=(P=s())!=null&&P.key&&typeof s().key=="string"?s().key:"chart",$=typeof localStorage<"u"?localStorage.getItem(`${N}.lastTimeframe`):null;if($&&typeof $=="string"&&$.length>0){const V=$.slice(-1),U=parseInt($.slice(0,-1))||1,G=V==="M"?"month":V==="w"?"week":V==="d"?"day":V==="h"?"hour":V==="m"?"minute":V==="s"?"second":"day",Z=I0($);r.update(le=>(le.period={multiplier:U,timespan:G,timeframe:$,secs:Z},le))}}catch{}try{h_()}catch{}try{d==null||d.set(!1)}catch{}console.log("✅ Save system initialized successfully")}catch(A){console.error("❌ Failed to initialize save system:",A)}}async function S(){try{console.log("🔍 Starting automatic restoration process (WebView-safe)...");let L=null;try{L=typeof window<"u"?localStorage.getItem("userId"):null}catch{}if(L){console.log("🌐 User logged in, refreshing saved layouts from server...");try{await p.refresh(),console.log("✅ Saved layouts refreshed from server")}catch(F){console.warn("⚠️ Could not refresh saved layouts from server:",F)}}const T=p.getActiveSaveId();if(console.log("🔍 Active save ID found:",T),T){console.log("🔄 Restoring active saved data:",T);const F=await p.load(T);if(F.success){console.log("✅ Active saved data restored successfully:",T);return}else{console.warn("⚠️ Failed to restore active saved data:",F.error);try{await p.clearActiveSave(),console.log("🧹 Cleared stale activeSaveId after failed restore")}catch(B){console.warn("⚠️ Could not clear activeSaveId:",B)}}}let P=[];const A=p.state.subscribe(F=>{P=(F==null?void 0:F.savedLayouts)||[]});if(A&&A(),P&&P.length>0){const F=P[0];if(console.log("🧭 Auto-selecting first saved layout:",F==null?void 0:F.id,F==null?void 0:F.name),F!=null&&F.id){const B=await p.load(F.id);if(B.success){console.log("✅ First saved layout auto-restored and set active:",F.id);return}else console.warn("⚠️ Failed to auto-load chosen layout:",B.error)}}console.log("ℹ️ No saved layouts found, using default chart configuration")}catch(L){console.error("❌ Error restoring active saved data:",L)}}yp(()=>{y&&y(),p.destroy()}),Ud(),Za()}function vO(o,e){e("cancel")}function fO(o,e){e("confirm")}var gO=de('<div class="ucm-backdrop svelte-16egrl4"><div class="ucm-modal svelte-16egrl4" role="dialog" aria-modal="true" aria-labelledby="ucm-title"><div class="ucm-header svelte-16egrl4"><h2 id="ucm-title" class="svelte-16egrl4"> </h2></div> <div class="ucm-body svelte-16egrl4"><p> </p></div> <div class="ucm-actions svelte-16egrl4"><button class="btn btn-cancel svelte-16egrl4">Cancel</button> <button class="btn btn-confirm svelte-16egrl4">Confirm</button></div></div></div>');function mO(o,e){Ka(e,!1);let t=Ss(e,"show",8,!1),s=Ss(e,"title",8,"Unsaved changes"),i=Ss(e,"message",8,"You have unsaved changes. If you refresh, your changes will be lost.");const r=Md();Ud();var a=Xt(),l=_t(a);Se(l,t,d=>{var v=gO(),p=g(v),_=g(p),y=g(_),w=g(y,!0);f(y),f(_);var k=u(_,2),S=g(k),L=g(S,!0);f(S),f(k);var T=u(k,2),P=g(T);P.__click=[vO,r];var A=u(P,2);A.__click=[fO,r],f(T),f(p),f(v),we(()=>{Ye(w,s()),Ye(L,i())}),O(d,v)}),O(o,a),Za()}hc(["click"]);const hO={lookbackPeriod:50,trendWeight:.3,momentumWeight:.25,volatilityWeight:.2,supportResistanceWeight:.15,volumeWeight:.1};function cu(o,e){return o.length<e?o[o.length-1]||0:o.slice(-e).reduce((s,i)=>s+i,0)/e}function D_(o,e){if(o.length===0)return 0;if(o.length<e)return cu(o,o.length);const t=2/(e+1);let s=cu(o.slice(0,e),e);for(let i=e;i<o.length;i++)s=(o[i]-s)*t+s;return s}function Bx(o,e=14){if(o.length<e+1)return 50;const t=[];for(let d=1;d<o.length;d++)t.push(o[d]-o[d-1]);let s=0,i=0;for(let d=0;d<e;d++)t[d]>=0?s+=t[d]:i-=t[d];let r=s/e,a=i/e;for(let d=e;d<t.length;d++)t[d]>=0?(r=(r*(e-1)+t[d])/e,a=a*(e-1)/e):(r=r*(e-1)/e,a=(a*(e-1)-t[d])/e);return a===0?100:100-100/(1+r/a)}function _O(o,e=14){if(o.length<2)return 0;const t=[];for(let s=1;s<o.length;s++){const i=o[s].high,r=o[s].low,a=o[s-1].close,l=Math.max(i-r,Math.abs(i-a),Math.abs(r-a));t.push(l)}return cu(t,Math.min(e,t.length))}function yO(o,e=3){if(o.length<10)return{support:[],resistance:[]};const t=o.map(a=>a.high),s=o.map(a=>a.low),i=[],r=[];for(let a=2;a<o.length-2;a++)t[a]>t[a-1]&&t[a]>t[a-2]&&t[a]>t[a+1]&&t[a]>t[a+2]&&i.push(t[a]),s[a]<s[a-1]&&s[a]<s[a-2]&&s[a]<s[a+1]&&s[a]<s[a+2]&&r.push(s[a]);return i.sort((a,l)=>l-a),r.sort((a,l)=>a-l),{resistance:i.slice(0,e),support:r.slice(0,e)}}function bO(o){if(o.length<3)return{pattern:"none",bullish:!0,confidence:.5};const e=o[o.length-1],t=o[o.length-2],s=o[o.length-3],i=Math.abs(e.close-e.open),r=e.high-e.low,a=e.close>e.open,l=Math.abs(t.close-t.open),d=t.close>t.open;if(i>l*1.5){if(a&&!d)return{pattern:"bullish_engulfing",bullish:!0,confidence:.75};if(!a&&d)return{pattern:"bearish_engulfing",bullish:!1,confidence:.75}}if(i<r*.1)return{pattern:"doji",bullish:d,confidence:.4};const v=a?e.open-e.low:e.close-e.low,p=a?e.high-e.close:e.high-e.open;return v>i*2&&p<i*.5?{pattern:"hammer",bullish:!0,confidence:.65}:p>i*2&&v<i*.5?{pattern:"shooting_star",bullish:!1,confidence:.65}:a&&d&&s.close>s.open?{pattern:"three_white_soldiers",bullish:!0,confidence:.7}:!a&&!d&&s.close<s.open?{pattern:"three_black_crows",bullish:!1,confidence:.7}:{pattern:"none",bullish:a,confidence:.5}}function xO(o){if(o.length<30)return{phase:"accumulation",confidence:.5};const e=o.slice(-30),t=e.map(p=>p.close),s=e.map(p=>p.volume||0),i=e.map(p=>p.high-p.low),r=(t[t.length-1]-t[0])/t.length,a=cu(s,s.length),l=cu(s.slice(-5),5),d=cu(i,i.length),v=cu(i.slice(-5),5);return Math.abs(r)<d*.1&&l<a*1.1&&v<d*1.1?{phase:"accumulation",confidence:.7}:r>d*.3&&l>a*1.2?{phase:"markup",confidence:.75}:Math.abs(r)<d*.15&&l>a*1.3&&(t[t.length-10]-t[0])/10>0?{phase:"distribution",confidence:.7}:r<-d*.3&&l>a*1.2?{phase:"markdown",confidence:.75}:{phase:"accumulation",confidence:.5}}function wO(o){if(o.length<20)return{direction:"sideways",strength:.5};const e=o.map(N=>N.close),t=o.map(N=>N.high),s=o.map(N=>N.low),i=D_(e,9),r=D_(e,21),a=D_(e,Math.min(50,e.length)),l=e[e.length-1];let d="sideways",v=0,p=0;i>r?v++:p++,r>a?v++:p++,l>i?v++:p++;const _=t.slice(-5),y=s.slice(-5),w=_[_.length-1]>_[0],k=y[y.length-1]>y[0],S=_[_.length-1]<_[0],L=y[y.length-1]<y[0];w&&k?v+=2:S&&L&&(p+=2);const T=e.slice(-10),P=(T[T.length-1]-T[0])/T.length,A=cu(T,T.length),F=P/A*100;F>.15?v+=2:F<-.15&&(p+=2),v>p+1?d="up":p>v+1&&(d="down");const B=v+p,R=B>0?Math.abs(v-p)/B:.5;return{direction:d,strength:Math.min(R,1)}}function kO(o){if(o.length<20)return{value:0,strength:.5};const e=o.map(d=>d.close),t=Bx(e,14),s=(t-50)/50,i=(e[e.length-1]-e[e.length-10])/e[e.length-10],r=s*.6+i*10*.4,a=Math.max(-1,Math.min(1,r)),l=Math.abs(t-50)/50;return{value:a,strength:Math.min(l,1)}}function SO(o){if(o.length<20)return{trend:"stable",relativeCurrent:1};const e=o.map(l=>l.volume||0),t=cu(e,Math.min(20,e.length)),s=cu(e.slice(-5),5),i=e[e.length-1],r=t>0?i/t:1;let a="stable";return s>t*1.2?a="increasing":s<t*.8&&(a="decreasing"),{trend:a,relativeCurrent:r}}function CO(o,e={}){const t={...hO,...e};if(o.length<10)return console.warn("Not enough historical data for prediction"),null;const s=o.slice(-t.lookbackPeriod),i=s[s.length-1];console.log("🔮 Predicting next candle from",s.length,"candles");const r=wO(s);console.log("📈 Trend:",r);const a=kO(s);console.log("⚡ Momentum:",a);const l=_O(s,14),d=cu(s.map(Ve=>Ve.close),s.length),v=l/d*100;console.log("📊 Volatility (ATR%):",v.toFixed(2));const p=yO(s);console.log("🎯 Support/Resistance:",p);const _=SO(s);console.log("📦 Volume:",_);const y=bO(s);console.log("🎨 Pattern:",y);const w=xO(s);console.log("🔄 Market Cycle:",w);let k=0;const S=(Math.random()-.5)*.8;k+=S;const L=Bx(s.map(Ve=>Ve.close),14),T=L>70,P=L<30,A=r.strength>.7;let F=.15;if(T&&r.direction==="up"&&(F+=.25),P&&r.direction==="down"&&(F+=.25),A&&(F+=.15),Math.random()<F){console.log("🔄 REVERSAL DETECTED - Creating counter-trend candle");const Ve=.5+Math.random()*1.5;r.direction==="up"?k-=Ve:r.direction==="down"?k+=Ve:k+=(Math.random()>.5?1:-1)*Ve}else r.direction==="up"?k+=r.strength*t.trendWeight*1.5:r.direction==="down"?k-=r.strength*t.trendWeight*1.5:k+=(Math.random()-.5)*.6,k+=a.value*a.strength*t.momentumWeight*1.8;if(y.pattern!=="none"){const Ve=y.confidence*1.2;y.bullish?k+=Ve:k-=Ve,console.log(`🎯 Pattern impact: ${y.bullish?"+":"-"}${Ve.toFixed(2)}%`)}w.phase==="markup"?k+=w.confidence*.5:w.phase==="markdown"?k-=w.confidence*.5:w.phase==="distribution"?k-=w.confidence*.2:w.phase==="accumulation"&&(k+=w.confidence*.2);const R=Math.min(v/2,2)*t.volatilityWeight;let N=0;const $=i.close;for(const Ve of p.resistance)$>=Ve*.98&&$<=Ve*1.02&&(N-=.5);for(const Ve of p.support)$>=Ve*.98&&$<=Ve*1.02&&(N+=.5);if(k+=N*t.supportResistanceWeight*1.5,_.trend==="increasing"){const Ve=t.volumeWeight*.8;(k>0||k<0)&&(k*=1+Ve)}else _.trend==="decreasing"&&(k*=.85);const V=(Math.random()-.5)*R*2.5;if(k+=V,Math.random()<.05){const Ve=(Math.random()-.5)*3;k+=Ve,console.log("📰 Surprise move:",Ve.toFixed(2)+"%")}k=Math.max(-6,Math.min(6,k)),console.log("💹 Predicted change:",k.toFixed(2)+"%");const U=$*(k/100),G=k>0;let Z,le,se,ie;const Y=v>2?.15:.05,Q=Math.random()<Y?(Math.random()*.5+.2)*(G?1:-1):0,q=Math.abs(U),ce=(Math.random()-.5)*.4,_e=q*(1+ce);if(G){Z=$*(1+Q/100),ie=Z+_e;const Ve=Math.random();let Ce,Je;Ve<.2?(Ce=l*(.05+Math.random()*.15),Je=l*(.05+Math.random()*.15)):Ve<.4?(Ce=l*(.4+Math.random()*.5),Je=l*(.1+Math.random()*.2)):Ve<.6?(Ce=l*(.05+Math.random()*.15),Je=l*(.4+Math.random()*.6)):(Ce=l*(.15+Math.random()*.35),Je=l*(.15+Math.random()*.35)),le=ie+Ce,se=Z-Je}else{Z=$*(1+Q/100),ie=Z-_e;const Ve=Math.random();let Ce,Je;Ve<.2?(Ce=l*(.05+Math.random()*.15),Je=l*(.05+Math.random()*.15)):Ve<.4?(Ce=l*(.4+Math.random()*.6),Je=l*(.05+Math.random()*.15)):Ve<.6?(Ce=l*(.1+Math.random()*.2),Je=l*(.4+Math.random()*.5)):(Ce=l*(.15+Math.random()*.35),Je=l*(.15+Math.random()*.35)),le=Z+Ce,se=ie-Je}const me=r.direction==="sideways"?.15:.05;if(Math.random()<me){ie=Z+(Math.random()-.5)*l*.1;const Ve=l*(.3+Math.random()*.4);le=Math.max(Z,ie)+Ve,se=Math.min(Z,ie)-Ve,console.log("🎲 Created Doji candle (indecision)")}le=Math.max(Z,ie,le),se=Math.min(Z,ie,se);const Pe=cu(s.map(Ve=>Ve.volume||0),20);cu(s.slice(-5).map(Ve=>Ve.volume||0),5);let ze=Pe;const he=Math.min(Math.abs(k)/2,1.5);ze*=.8+he*.4,_.trend==="increasing"?ze*=1.1+Math.random()*.3:_.trend==="decreasing"?ze*=.7+Math.random()*.2:ze*=.85+Math.random()*.3,y.pattern==="bullish_engulfing"||y.pattern==="bearish_engulfing"?ze*=1.2+Math.random()*.3:y.pattern==="doji"&&(ze*=.7+Math.random()*.2),(w.phase==="distribution"||w.phase==="markdown")&&(ze*=1.1+Math.random()*.2),ze=Math.max(Pe*.3,Math.min(ze,Pe*3));const De=s.slice(-5).map((Ve,Ce,Je)=>Ce>0?Ve.timestamp-Je[Ce-1].timestamp:0).filter(Ve=>Ve>0),ge=De.length>0?cu(De,De.length):6e4,$e={timestamp:i.timestamp+ge,open:Math.round(Z*100)/100,high:Math.round(le*100)/100,low:Math.round(se*100)/100,close:Math.round(ie*100)/100,volume:Math.round(ze)};return console.log("🎯 Predicted candle:",$e),$e}function PO(o,e){return Date.now()-o>e*2}function IO(){var o;try{(o=window.predictNextCandle)==null||o.call(window)}catch{}z0(!0)}function MO(o,e){(!(typeof window<"u")||window.confirm("Exit simulator?"))&&(e(),ux())}function TO(o){const e=parseFloat(o.target.value);b1(e)}var AO=de('<button class="fc-btn svelte-u36ajg" type="button">Stop</button>'),LO=de('<button class="fc-btn svelte-u36ajg" type="button">Start</button>'),FO=de('<div class="floating-controls svelte-u36ajg"><div class="fc-content svelte-u36ajg"><div class="fc-header svelte-u36ajg"><div class="fc-title svelte-u36ajg">Simulator</div> <div class="fc-badge svelte-u36ajg"> </div></div> <div class="fc-row svelte-u36ajg"><input type="range" min="0.5" max="10" step="0.5" class="fc-range svelte-u36ajg"></div> <div class="fc-row svelte-u36ajg"><!> <button class="fc-btn fc-danger svelte-u36ajg" type="button">Exit</button></div></div></div>');function DO(o,e){Ka(e,!0);const t=Zc(),s=()=>ir(Td,"$simulator",t);let i=oe(20),r=oe(80),a=oe(!1),l=0,d=0;function v(S){const L="touches"in S?S.touches[0]:S;l=L.clientX-n(i),d=L.clientY-n(r),b(a,!0),window.addEventListener("mousemove",p),window.addEventListener("mouseup",_),window.addEventListener("touchmove",p,{passive:!0}),window.addEventListener("touchend",_)}function p(S){if(!n(a))return;const L="touches"in S?S.touches[0]:S;b(i,L.clientX-l),b(r,L.clientY-d)}function _(){b(a,!1),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",_),window.removeEventListener("touchmove",p),window.removeEventListener("touchend",_)}function y(){var S;try{(S=window.stopPrediction)==null||S.call(window)}catch{}z0(!1)}var w=Xt(),k=_t(w);Se(k,()=>s().mode==="normal",S=>{var L=FO(),T=g(L),P=g(T);P.__mousedown=v,P.__touchstart=v;var A=u(g(P),2),F=g(A);f(A),f(P);var B=u(P,2),R=g(B);Vt(R),R.__input=[TO],f(B);var N=u(B,2),$=g(N);Se($,()=>s().playing,U=>{var G=AO();G.__click=y,O(U,G)},U=>{var G=LO();G.__click=[IO],O(U,G)});var V=u($,2);V.__click=[MO,y],f(N),f(T),f(L),we(()=>{St(L,"style",`left:${n(i)}px;top:${n(r)}px;`),Ye(F,`${s().speed??""}x`),Vu(R,s().speed)}),O(S,L)}),O(o,w),Za()}hc(["mousedown","touchstart","input","click"]);function EO(o){let e="",t=null;for(let s=0;s<o.length;s++){const i=o[s],r=o[s+1];if(t){e+=i,i===t&&o[s-1]!=="\\"&&(t=null);continue}if(i==="'"||i==='"'){t=i,e+=i;continue}if(i==="/"&&r==="/")break;e+=i}return e.replace(/\s+$/,"")}function ha(o){const e=o.trim();return e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e}function ou(o){const e=[];let t="",s=0,i=null;for(let r=0;r<o.length;r++){const a=o[r];if(i){t+=a,a===i&&o[r-1]!=="\\"&&(i=null);continue}if(a==="'"||a==='"'){i=a,t+=a;continue}if(a==="("){s+=1,t+=a;continue}if(a===")"){s=Math.max(0,s-1),t+=a;continue}if(a===","&&s===0){e.push(t.trim()),t="";continue}t+=a}return t.trim()&&e.push(t.trim()),e}function zu(o){const e={};for(const t of o){const s=t.match(/^([A-Za-z_$][A-Za-z0-9_$]*)\s*=\s*(.+)$/);s&&(e[s[1]]=s[2].trim())}return e}function Hm(o){let e=o.trim();return e=e.replace(/\bta\./g,""),e=e.replace(/\bmath\./g,""),e=(()=>{const t=e;let s="",i=null,r=0;const a=d=>/[A-Za-z_$]/.test(d),l=d=>/[A-Za-z0-9_$]/.test(d);for(;r<t.length;){const d=t[r];if(i){s+=d,d===i&&t[r-1]!=="\\"&&(i=null),r+=1;continue}if(d==="'"||d==='"'){i=d,s+=d,r+=1;continue}if(a(d)){let v=r+1;for(;v<t.length&&l(t[v]);)v+=1;const p=t.slice(r,v);let _=v;for(;_<t.length&&/\s/.test(t[_]);)_+=1;if(t[_]==="["){let y=_+1;for(;y<t.length&&/\s/.test(t[y]);)y+=1;let w=1;t[y]==="-"&&(w=-1,y+=1);let k=y;for(;k<t.length&&/[0-9]/.test(t[k]);)k+=1;const S=t.slice(y,k);for(;k<t.length&&/\s/.test(t[k]);)k+=1;if(S&&t[k]==="]"){const L=w*Number(S);if(Number.isFinite(L)&&L>=1){s+=`prev(${p}, ${Math.floor(L)})`,r=k+1;continue}if(Number.isFinite(L)&&L===0){s+=p,r=k+1;continue}}}s+=p,r=v;continue}s+=d,r+=1}return s})(),e}function Sv(o){let e=Hm(o);return e=e.replace(/\bcrossover\s*\(/gi,"crossover("),e=e.replace(/\bcrossunder\s*\(/gi,"crossunder("),e}function av(o){return/^[A-Za-z_$][A-Za-z0-9_$]*\s*=/.test(o.trim())}function Cm(o){const e=o.trim().toLowerCase();return e==="true"?!0:e==="false"?!1:null}function gp(o){const e=o.trim();if(!/^[-+]?\d+(?:\.\d+)?$/.test(e))return null;const t=Number(e);return Number.isFinite(t)?t:null}function Cv(o){const e=ha(String(o||"").trim());if(!e)return;if(e.startsWith("#")||e.startsWith("rgb"))return e;const t=e.toLowerCase();if(t==="color.green"||t==="green")return"#16a34a";if(t==="color.red"||t==="red")return"#ef4444";if(t==="color.orange"||t==="orange")return"#f59e0b";if(t==="color.blue"||t==="blue")return"#3b82f6";if(t==="color.gray"||t==="gray"||t==="grey")return"#64748b";if(t==="color.white"||t==="white")return"#e2e8f0";if(t==="color.black"||t==="black")return"#0b1220"}function $O(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^shape\./,"").replace(/^label\./,"");if(t.includes("triangleup"))return"triangle_up_filled";if(t.includes("triangledown"))return"triangle_down_filled";if(t.includes("arrowup"))return"arrowUp";if(t.includes("arrowdown"))return"arrowDown";if(t.includes("circle"))return"circle";if(t.includes("square"))return"square";if(t.includes("label"))return"label"}function n2(o){const e=String(o||"").trim().toLowerCase();if(!e)return;const t=e.replace(/^size\./,"");if(t==="tiny")return 10;if(t==="small")return 12;if(t==="normal")return 14;if(t==="large")return 18;if(t==="huge")return 22;const s=gp(ha(e));if(s!=null)return Math.max(6,Math.min(64,s))}function i2(o){const e=String(o||"").trim().toLowerCase();if(e){if(e.includes("on"))return"on";if(e.includes("off"))return"off"}}function r2(o){const t=String(o||"").trim().match(/^(?:request\.)?security\s*\((.*)\)\s*$/i);if(!t)return null;const s=ou(t[1]||"");if(s.length<2)return null;const i=zu(s),r=s.filter(S=>!av(S)),a=r[0]!=null?String(r[0]).trim():"",l=ha(a),d=l&&l.toLowerCase()==="syminfo.tickerid"?"syminfo.tickerid":!(a.startsWith('"')&&a.endsWith('"')||a.startsWith("'")&&a.endsWith("'"))&&/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(l)&&!/^\d+$/.test(l)?`\${${l}}`:l,v=r[1]!=null?String(r[1]).trim():"",p=ha(v),_=p&&p.toLowerCase()==="timeframe.period"?"__CURRENT__":!(v.startsWith('"')&&v.endsWith('"')||v.startsWith("'")&&v.endsWith("'"))&&/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(p)&&!/^\d+$/.test(p)?`\${${p}}`:p,y=r[2]!=null?Hm(String(r[2])):"close",w=i2(String(i.lookahead??""))??(String(i.lookahead??"").toLowerCase().includes("lookahead_on")?"on":String(i.lookahead??"").toLowerCase().includes("lookahead_off")?"off":void 0),k=i2(String(i.gaps??""))??(String(i.gaps??"").toLowerCase().includes("gaps_on")?"on":String(i.gaps??"").toLowerCase().includes("gaps_off")?"off":void 0);return{symbol:d,country:i.country!=null?ha(String(i.country)):void 0,timeframe:_||"__CURRENT__",expr:y||"close",lookahead:w,gaps:k}}function s1(o){const e=String(o||"").split(/\r?\n/),t=[],s=[],i=he=>{let De=0;for(let ge=0;ge<he.length;ge++){const be=he[ge];if(be===" ")De+=1;else if(be==="	")De+=2;else break}return De},r=he=>{let De=0,ge=null;for(let be=0;be<he.length;be++){const $e=he[be];if(ge){$e===ge&&he[be-1]!=="\\"&&(ge=null);continue}if($e==="'"||$e==='"'){ge=$e;continue}$e==="("?De+=1:$e===")"&&(De-=1)}return De},a=[];let l="",d=1,v=0,p=0;for(let he=0;he<e.length;he++){const De=he+1,ge=EO(e[he]||""),be=ge.trim();be&&(l||(d=De,p=i(ge)),l=l?`${l} ${be}`:be,v+=r(be),v<=0&&(a.push({text:l.trim(),indent:p,lineNo:d}),l="",v=0,p=0))}l.trim()&&a.push({text:l.trim(),indent:p,lineNo:d});const _=[{pane:"main",plots:[],labels:[],levels:[],lines:[],overlays:[],fills:[],backgroundZones:[]}],y=[],w=[],k={},S=[],L=[],T={},P=[],A={};let F=null;const B={},R={};let N=0;const $=(he,De)=>{const ge=De.replace(/[^A-Za-z0-9_]+/g,"_").toLowerCase(),be=ge?`__sec_${ge}`:"__sec";let $e=be,Ve=1;const Ce=Je=>y.some(ye=>String((ye==null?void 0:ye.name)||"").toLowerCase()===Je.toLowerCase())||S.some(ye=>String((ye==null?void 0:ye.name)||"").toLowerCase()===Je.toLowerCase());for(;Ce($e);)Ve+=1,$e=`${be}_${Ve}`;return S.push({name:$e,type:"security",symbol:he.symbol,country:he.country,timeframe:he.timeframe,expr:he.expr,lookahead:he.lookahead,gaps:he.gaps}),$e},V=(he,De)=>{const ge=String(he||"");let be="",$e=0,Ve=null;const Ce=ge.toLowerCase();for(;$e<ge.length;){const Je=ge[$e];if(Ve){be+=Je,Je===Ve&&ge[$e-1]!=="\\"&&(Ve=null),$e+=1;continue}if(Je==="'"||Je==='"'){Ve=Je,be+=Je,$e+=1;continue}const ye=Ce.slice($e),Ae=ye.startsWith("request.security"),ee=!Ae&&ye.startsWith("security")&&($e===0||!/[a-z0-9_$]/i.test(Ce[$e-1]||""));if(Ae||ee){let ke=$e+(Ae?16:8);for(;ke<ge.length&&/\s/.test(ge[ke]);)ke+=1;if(ge[ke]!=="("){be+=Je,$e+=1;continue}let He=0,Ie=ke,ne=null;for(;Ie<ge.length;Ie++){const Qe=ge[Ie];if(ne){Qe===ne&&ge[Ie-1]!=="\\"&&(ne=null);continue}if(Qe==="'"||Qe==='"'){ne=Qe;continue}if(Qe==="(")He+=1;else if(Qe===")"&&(He-=1,He===0))break}if(Ie>=ge.length){be+=ge.slice($e);break}const J=ge.slice($e,Ie+1),qe=r2(J);if(!qe){be+=J,$e=Ie+1;continue}N+=1;const ft=$(qe,`${De}_${N}`);be+=ft,$e=Ie+1;continue}be+=Je,$e+=1}return be};if(!/(^\s*\/\/@\s*pine)|(^\s*\/\/@\s*version)|\b(strategy|indicator|study)\s*\(/m.test(o))return{ok:!1,errors:[{message:"Not a Pine-like script",line:1}]};const G=()=>{_.some(he=>he.pane==="sub")||_.push({pane:"sub",plots:[],labels:[],levels:[],lines:[],overlays:[],fills:[],backgroundZones:[]})},Z=he=>(he==="sub"&&G(),_.find(De=>De.pane===he)||_[0]),le=he=>{const De=String(he||"").trim();return De?!!(/\b(crossover|crossunder|between|above|below)\s*\(/i.test(De)||/\bcrosses(Above|Below)\b/i.test(De)||/[<>]=?|==|!=/.test(De)||/\b(and|or|not)\b/i.test(De)||/^\s*true\s*$|^\s*false\s*$/i.test(De)):!1},se=he=>String(he||"").trim().replace(/\s+/g,"_").toLowerCase(),ie=(he,De)=>{let ge="",be=null;for(let $e=0;$e<he.length;$e++){const Ve=he[$e];if(be){ge+=Ve,Ve===be&&he[$e-1]!=="\\"&&(be=null);continue}if(Ve==="'"||Ve==='"'){be=Ve,ge+=Ve;continue}if(/[A-Za-z_$]/.test(Ve)){let Ce=$e+1;for(;Ce<he.length&&/[A-Za-z0-9_$]/.test(he[Ce]);)Ce+=1;const Je=he.slice($e,Ce),ye=De[Je];ge+=ye??Je,$e=Ce-1;continue}ge+=Ve}return ge},Y=(he,De)=>{let ge=String(he||"");for(let be=0;be<8;be++){let $e=!1,Ve="",Ce=0,Je=null;for(;Ce<ge.length;){const ye=ge[Ce];if(Je){Ve+=ye,ye===Je&&ge[Ce-1]!=="\\"&&(Je=null),Ce+=1;continue}if(ye==="'"||ye==='"'){Je=ye,Ve+=ye,Ce+=1;continue}if(/[A-Za-z_$]/.test(ye)){let Ae=Ce+1;for(;Ae<ge.length&&/[A-Za-z0-9_$]/.test(ge[Ae]);)Ae+=1;const ee=ge.slice(Ce,Ae);let xe=Ae;for(;xe<ge.length&&/\s/.test(ge[xe]);)xe+=1;if(ge[xe]==="("){const ke=B[se(ee)];if(ke){let He=0,Ie=xe,ne=null;for(;Ie<ge.length;Ie++){const J=ge[Ie];if(ne){J===ne&&ge[Ie-1]!=="\\"&&(ne=null);continue}if(J==="'"||J==='"'){ne=J;continue}if(J==="(")He+=1;else if(J===")"&&(He-=1,He===0))break}if(Ie<ge.length&&ge[Ie]===")"){const J=ge.slice(xe+1,Ie),qe=ou(J),ft={};for(let Oe=0;Oe<ke.args.length;Oe++){const ct=ke.args[Oe],Lt=qe[Oe]!=null?String(qe[Oe]).trim():"na";ft[ct]=Hm(V(Lt,`${De}_${ke.name}`))}const Qe=ie(ke.body,ft);Ve+=`(${Qe})`,Ce=Ie+1,$e=!0;continue}}}Ve+=ee,Ce=Ae;continue}Ve+=ye,Ce+=1}if(!$e)return ge;ge=Ve}return s.push({message:`User function expansion reached max depth while processing "${De}".`,line:1}),ge},K=(he,De)=>Hm(Y(V(he,De),De));for(let he=0;he<a.length;he++){const De=a[he],ge=De.text.match(/^([A-Za-z_$][A-Za-z0-9_$]*)\s*\((.*)\)\s*=>\s*(.+)$/);if(!ge)continue;const be=ge[1],$e=ge[2]||"",Ve=String(ge[3]||"").trim(),Ce=ou($e).map(ye=>String(ye||"").trim()).filter(Boolean).map(ye=>{const Ae=ye.match(/^(?:var\s+)?(?:float|int|bool|string)\s+([A-Za-z_$][A-Za-z0-9_$]*)$/i);return(Ae?Ae[1]:ye).trim()}),Je=se(be);B[Je]&&s.push({message:`Duplicate function definition "${be}" (later definition overrides).`,line:De.lineNo}),B[Je]={name:be,args:Ce,body:Ve,lineNo:De.lineNo},a[he]={...De,text:"//@pine_fn"}}const Q=he=>{const De=String(he||"").trim(),ge=se(De),be=A[ge];return be||De},q=he=>{const De=/\b[A-Za-z_$][A-Za-z0-9_$]*\b/g,ge=new Map,be=new Set,$e=xe=>{const ke=se(xe);if(ge.has(ke))return ge.get(ke);const He=A[ke];if(!He)return xe;if(be.has(ke))return He;be.add(ke);const Ie=String(He).replace(De,ne=>{const J=se(ne);return A[J]?`(${$e(J)})`:ne});return be.delete(ke),ge.set(ke,Ie),Ie},Ve=Q(he),Ce=String(Ve).replace(De,xe=>{const ke=se(xe);return A[ke]?`(${$e(ke)})`:xe}),Je=new Set(y.map(xe=>se(String((xe==null?void 0:xe.name)||""))).filter(Boolean)),ye=new Set(Object.keys(T||{}).map(xe=>se(xe)).filter(Boolean)),Ae=new Set(["open","high","low","close","volume","time","and","or","not","true","false","crossesabove","crossesbelow"]);return Ce.replace(De,(xe,ke)=>{const He=se(xe);if(!He||Ae.has(He))return xe;const Ie=Ce.slice(ke+xe.length);return/^\s*\(/.test(Ie)||!ye.has(He)||Je.has(He)?xe:`\${${xe}}`})},ce=(he,De)=>{const ge=String(he||"").trim(),be=K(ge,De),$e=be.match(/^[A-Za-z_$][A-Za-z0-9_$]*$/);if($e)return $e[0];const Ve=gp(be);if(Ve!=null){const Ae=`__const_${String(Ve).replace(/[^\d]/g,"_")}`;return y.some(ee=>ee.name.toLowerCase()===Ae.toLowerCase())||y.push({name:Ae,expr:String(Ve)}),Ae}const Ce=De.replace(/[^A-Za-z0-9_]+/g,"_").toLowerCase();let Je=`__${Ce||"expr"}`,ye=1;for(;y.some(Ae=>Ae.name.toLowerCase()===Je.toLowerCase());)ye+=1,Je=`__${Ce||"expr"}_${ye}`;return y.push({name:Je,expr:be}),Je},_e=(he,De,ge)=>{const be=De.match(/^input\.(int|float|bool|string)\s*\((.*)\)\s*$/i);if(!be)return!1;const $e=be[1].toLowerCase(),Ve=ou(be[2]||""),Ce=zu(Ve),Je=Ve.filter(qe=>!av(qe)),ye=Ce.defval??Je[0]??"",Ae=Ce.title??Je[1]??"",ee=Ae?ha(String(Ae)):void 0,xe=qe=>{t.push({message:qe,line:ge})},ke=qe=>{const ft=typeof qe=="number"?qe:Number(qe);return Number.isFinite(ft)?ft:void 0},He=ke(Ce.minval),Ie=ke(Ce.maxval),ne=ke(Ce.step);let J=null;if($e==="bool"){const qe=Cm(String(ye));if(qe==null)return xe(`input.bool() requires defval true/false for "${he}"`),!0;J=qe}else if($e==="string")J=ha(String(ye||""));else{const qe=ke(ye);if(qe==null)return xe(`input.${$e}() requires numeric defval for "${he}"`),!0;J=$e==="int"?Math.floor(qe):qe}return T[he]=J,P.push({name:he,type:$e,title:ee,defval:J,minval:He,maxval:Ie,step:ne}),!0},me=he=>{const De=he.qty_percent??he.qtyPct??he.qtyPctVal??he.qtyPercent,ge=De!=null?Number(De):void 0,be=he.oco?ha(String(he.oco)):void 0,$e=he.expiresBars!=null?Number(he.expiresBars):void 0,Ve=he.stop??he.stopPrice,Ce=he.limit??he.limitPrice,Je=he.price,ye=(He,Ie)=>{if(He==null)return null;const ne=K(String(He),Ie);if(!ne)return null;const J=ne.match(/^[A-Za-z_$][A-Za-z0-9_$]*$/);if(J)return J[0];const qe=gp(ha(ne));return qe!=null?String(qe):ce(ne,Ie)},Ae=ye(Ve,"order_stop"),ee=ye(Ce,"order_limit"),xe=ye(Je,"order_price"),ke={};return typeof ge=="number"&&Number.isFinite(ge)&&(ke.qtyPct=ge),be&&(ke.oco=be),typeof $e=="number"&&Number.isFinite($e)&&(ke.expiresBars=$e),Ae&&ee?(ke.kind="stop_limit",ke.stopPrice=Ae,ke.limitPrice=ee,ke):ee?(ke.kind="limit",ke.price=ee,ke):Ae?(ke.kind="stop",ke.price=Ae,ke):xe?(ke.kind="market",ke):Object.keys(ke).length?{kind:"market",...ke}:null};for(let he=0;he<a.length;he++){const De=a[he],ge=De.lineNo,be=De.text;if(!be||be.startsWith("//@pine_fn"))continue;const $e=be.match(/^for\s+([A-Za-z_$][A-Za-z0-9_$]*)\s*=\s*([^\s]+)\s+to\s+([^\s]+)(?:\s+by\s+([^\s]+))?$/i);if($e){const Qe=$e[1],Oe=K($e[2]||"","for_start"),ct=K($e[3]||"","for_end"),Lt=K($e[4]||"1","for_step"),It=bs=>{const es=gp(ha(bs));if(es!=null)return es;const rn=se(bs),wr=T[rn];return typeof wr=="number"&&Number.isFinite(wr)?wr:null},zt=It(Oe),pt=It(ct),Mo=It(Lt);if(zt==null||pt==null||Mo==null||Mo===0){t.push({message:"for-loop bounds must be numeric constants or previously defined numeric params (and step != 0)",line:ge});continue}const Xo=[],en=De.indent;let Fo=he+1;for(;Fo<a.length&&a[Fo].indent>en;)a[Fo].text.startsWith("//@pine_fn")||Xo.push(a[Fo]),Fo+=1;if(!Xo.length){t.push({message:"for-loop requires an indented body",line:ge});continue}const Eo=[],cs=(bs,es)=>{let rn=bs;return rn=rn.replace(/\barray\.get\s*\(\s*([A-Za-z_$][A-Za-z0-9_$]*)\s*,\s*([A-Za-z_$][A-Za-z0-9_$]*|[-+]?\d+(?:\.\d+)?)\s*\)/gi,(wr,rr,ar)=>{const jr=R[se(String(rr))];if(!jr)return wr;const ii=se(String(ar))===se(Qe)?Math.floor(es):gp(String(ar))!=null?Math.floor(gp(String(ar))):NaN;if(!Number.isFinite(ii))return wr;const Xa=jr[ii];return typeof Xa=="number"&&Number.isFinite(Xa)?String(Xa):"na"}),ie(rn,{[Qe]:String(es)})};if(Mo>0)for(let bs=zt;bs<=pt+1e-12;bs+=Mo)for(const es of Xo)Eo.push({...es,text:cs(es.text,bs),indent:en});else for(let bs=zt;bs>=pt-1e-12;bs+=Mo)for(const es of Xo)Eo.push({...es,text:cs(es.text,bs),indent:en});a.splice(he,Fo-he,...Eo),he-=1;continue}const Ve=be.match(/^(?:(?:var)\s+)?(?:(?:float|int|bool|string)\s+)?([A-Za-z_$][A-Za-z0-9_$]*)\s*(?::=|=)\s*array\.from\s*\((.*)\)\s*$/i);if(Ve){const Qe=se(Ve[1]),Oe=ou(Ve[2]||""),ct=[];let Lt=!0;for(const It of Oe){const zt=K(String(It||""),`array_from_${Qe}`),pt=gp(ha(zt));if(pt==null){Lt=!1;break}ct.push(pt)}if(!Lt||!ct.length){t.push({message:"array.from(...) currently supports only numeric literals (compile-time)",line:ge});continue}R[Qe]=ct;continue}const Ce=be.match(/^(var\s+)?(?:(float|int|bool|string)\s+)?([A-Za-z_$][A-Za-z0-9_$]*)\s*(:=|=)\s*(.+)$/i);if(Ce){const Qe=!!Ce[1],Oe=Ce[2]?String(Ce[2]).toLowerCase():"",ct=Ce[3],Lt=Ce[4],It=String(Ce[5]||"").trim();if(Lt===":="){const Eo=se(ct);Eo in T||ct in T||!!A[Eo]||y.some(Zt=>se(String((Zt==null?void 0:Zt.name)||""))===Eo)||w.some(Zt=>se(String((Zt==null?void 0:Zt.name)||""))===Eo)||S.some(Zt=>se(String((Zt==null?void 0:Zt.name)||""))===Eo)||s.push({message:`":=" used before "${ct}" is defined (use "=" for first assignment)`,line:ge})}const zt=r2(It);if(zt){S.push({name:ct,type:"security",symbol:zt.symbol,country:zt.country,timeframe:zt.timeframe,expr:zt.expr,lookahead:zt.lookahead,gaps:zt.gaps});continue}const pt=K(It,ct);if(_e(ct,pt,ge))continue;if(le(pt)){A[ct.replace(/\s+/g,"_").toLowerCase()]=Sv(pt);continue}if((Qe||Lt===":=")&&Oe!=="bool"&&Oe!=="string"){const Eo=se(ct),Zt=(()=>{const bs=k[Eo];if(typeof bs=="number")return bs;const es=w.length;return k[Eo]=es,w.push({name:ct,initExpr:void 0,updateExpr:ct}),es})();if(Qe&&Lt==="="){w[Zt].initExpr=pt;continue}if(Qe&&Lt===":="){w[Zt].initExpr=pt,w[Zt].updateExpr=pt;continue}w[Zt].updateExpr=pt;continue}const en=gp(pt);if(en!=null){T[ct]=en;continue}const Fo=Cm(pt);if(Fo!=null){T[ct]=Fo;continue}if(pt.startsWith('"')&&pt.endsWith('"')||pt.startsWith("'")&&pt.endsWith("'")){T[ct]=ha(pt);continue}y.push({name:ct,expr:pt});continue}const Je=be.match(/^strategy\s*\((.*)\)\s*$/i);if(Je){const Qe=ou(Je[1]||""),Oe=zu(Qe),ct=(...pt)=>{for(const Mo of pt){if(Oe[Mo]==null)continue;const Xo=ha(String(Oe[Mo])),en=gp(Xo);if(en!=null)return en}},Lt=ha(String(Oe.default_qty_type??Oe.default_qty_type??"")).toLowerCase(),It=Number(Oe.default_qty_value??Oe.default_qty_value??NaN),zt=Lt==="cash"?{type:"cash",value:Number.isFinite(It)?It:1e4}:Lt==="qty"?{type:"qty",value:Number.isFinite(It)?It:1}:{type:"percent_of_equity",value:Number.isFinite(It)?It:100};F={initialCapital:ct("initial_capital","initialCapital")??1e4,orderSize:zt,commissionPct:ct("commissionPct","commission")??0,slippagePct:ct("slippagePct","slippage")??0,spreadPct:ct("spreadPct","spread_pct","spread")??(ct("spreadBps","spread_bps")!=null?ct("spreadBps","spread_bps")/100:void 0),leverage:ct("leverage","lev","marginLeverage","margin_leverage")??void 0,maintenanceMarginPct:ct("maintenanceMarginPct","maintenance_margin_pct","maintMarginPct")??void 0,liquidationFeePct:ct("liquidationFeePct","liquidation_fee_pct","liqFeePct")??void 0,borrowPctPerYear:ct("borrowPctPerYear","borrow_pct_per_year","shortBorrowPctPerYear")??void 0,fundingPctPerDay:ct("fundingPctPerDay","funding_pct_per_day","funding")??void 0,positionMode:(()=>{const pt=ha(String(Oe.positionMode??Oe.position_mode??"")).toLowerCase();if(pt)return pt.includes("hedge")?"hedging":"netting"})()??void 0,closeMethod:(()=>{const pt=ha(String(Oe.closeMethod??Oe.close_method??Oe.costBasis??Oe.cost_basis??"")).toLowerCase();if(pt)return pt.includes("lifo")?"lifo":pt.includes("avg")||pt.includes("average")?"avg":"fifo"})()??void 0,priceTick:ct("priceTick","price_tick","tickSize","tick_size","tick","minTick","min_tick")??void 0,qtyStep:ct("qtyStep","qty_step","quantityStep","quantity_step","lotStep","lot_step")??void 0,minQty:ct("minQty","min_qty","minimumQty","minimum_qty")??void 0,pyramiding:ct("pyramiding")??1,execution:ha(String(Oe.execution??"intrabar_ohlc")),intrabarTieBreak:ha(String(Oe.intrabarTieBreak??"worst_case")),ohlcPath:ha(String(Oe.ohlcPath??"open_high_low_close")),allowShort:Cm(String(Oe.allowShort??""))??void 0,allowLong:Cm(String(Oe.allowLong??""))??void 0};continue}if(be.match(/^(indicator|study)\s*\((.*)\)\s*$/i))continue;const Ae=be.match(/^plot\s*\((.*)\)\s*$/i);if(Ae){const Qe=ou(Ae[1]||"");if(!Qe.length){t.push({message:"plot() requires at least 1 argument",line:ge});continue}const Oe=Qe[0],ct=Qe[1]&&!Qe[1].includes("=")?Qe[1]:null,Lt=zu(Qe),It=ha(String(Lt.pane??"main")).toLowerCase()==="sub"?"sub":"main",zt=Z(It),pt=ce(Oe,ha(String(Lt.title??Lt.name??ct??Oe??"plot")));zt.plots.push({name:ha(String(Lt.title??Lt.name??ct??pt)),source:pt.replace(/\s+/g,"_").toLowerCase(),type:ha(String(Lt.type??"line")),color:Cv(String(Lt.color??""))||void 0,width:Lt.width!=null?Number(Lt.width):Lt.linewidth!=null?Number(Lt.linewidth):void 0,style:Lt.style!=null?ha(String(Lt.style)):void 0});continue}const ee=be.match(/^plotshape\s*\((.*)\)\s*$/i);if(ee){const Qe=ou(ee[1]||"");if(!Qe.length){t.push({message:"plotshape() requires at least 1 argument",line:ge});continue}const Oe=zu(Qe),ct=Qe.filter(rn=>!av(rn)),Lt=ct[0]?q(Sv(K(ct[0],"when"))):null;if(!Lt){t.push({message:"plotshape() missing condition",line:ge});continue}const It=ha(String(Oe.pane??"main")).toLowerCase()==="sub"?"sub":"main",zt=Z(It),pt=String(Oe.location??"").toLowerCase(),Mo=pt.includes("below")||pt.includes("bottom")||pt.includes("low"),Xo=Mo?"below":"above",en=Oe.price??Oe.y??Oe.source??Oe.series,Fo=en!=null?ce(String(en),"shape_price").replace(/\s+/g,"_").toLowerCase():Mo?"low":"high",Eo=$O(String(Oe.style??Oe.shape??""))||(Mo?"triangle_up_filled":"triangle_down_filled"),cs=ha(String(Oe.text??Oe.title??""))||(Mo?"BUY":"SELL"),Zt=Cv(String(Oe.color??""))||(Mo?"#16a34a":"#ef4444"),bs=Cv(String(Oe.textcolor??Oe.textColor??""))||void 0,es=n2(String(Oe.size??""))||void 0;zt.labels.push({when:Lt,text:cs,color:Zt,textColor:bs,position:Xo,source:Fo,shape:Eo,size:es});continue}const xe=be.match(/^plotchar\s*\((.*)\)\s*$/i);if(xe){const Qe=ou(xe[1]||"");if(!Qe.length){t.push({message:"plotchar() requires at least 1 argument",line:ge});continue}const Oe=zu(Qe),ct=Qe.filter(es=>!av(es)),Lt=ct[0]?q(Sv(K(ct[0],"when"))):null;if(!Lt){t.push({message:"plotchar() missing condition",line:ge});continue}const It=ha(String(Oe.pane??"main")).toLowerCase()==="sub"?"sub":"main",zt=Z(It),pt=String(Oe.location??"").toLowerCase(),Mo=pt.includes("below")||pt.includes("bottom")||pt.includes("low"),Xo=Mo?"below":"above",en=Oe.price??Oe.y??Oe.source??Oe.series,Fo=en!=null?ce(String(en),"char_price").replace(/\s+/g,"_").toLowerCase():Mo?"low":"high",Eo=ha(String(Oe.char??""))||ha(String(Oe.text??""))||"•",cs=Cv(String(Oe.color??""))||(Mo?"#16a34a":"#ef4444"),Zt=Cv(String(Oe.textcolor??Oe.textColor??""))||void 0,bs=n2(String(Oe.size??""))||14;zt.labels.push({when:Lt,text:Eo,color:cs,textColor:Zt,position:Xo,source:Fo,shape:"text",size:bs});continue}const ke=be.match(/^hline\s*\((.*)\)\s*$/i);if(ke){const Qe=ou(ke[1]||"");if(!Qe.length){t.push({message:"hline() requires value",line:ge});continue}const Oe=zu(Qe),ct=Qe.filter(pt=>!av(pt)),Lt=gp(ha(ct[0]??""));if(Lt==null){t.push({message:"hline() value must be a number",line:ge});continue}const It=ha(String(Oe.pane??"main")).toLowerCase()==="sub"?"sub":"main";Z(It).levels.push({name:ha(String(Oe.title??Oe.name??String(Lt))),value:Lt,color:Cv(String(Oe.color??""))||void 0,style:ha(String(Oe.linestyle??Oe.style??"dashed")),width:Oe.width!=null?Number(Oe.width):void 0});continue}const He=be.match(/^fill\s*\((.*)\)\s*$/i);if(He){const Qe=ou(He[1]||""),Oe=zu(Qe),ct=Qe.filter(Mo=>!av(Mo));if(ct.length<2){t.push({message:"fill() requires 2 plot series",line:ge});continue}const Lt=ha(String(Oe.pane??"main")).toLowerCase()==="sub"?"sub":"main",It=Z(Lt),zt=ce(ct[0],"fill_a"),pt=ce(ct[1],"fill_b");It.fills=Array.isArray(It.fills)?It.fills:[],It.fills.push({between:[zt,pt],color:Cv(String(Oe.color??""))||ha(String(Oe.color??""))||"rgba(34,197,94,0.10)"});continue}const Ie=be.match(/^signal\s+(entry_long|exit_long|entry_short|exit_short)\s+when\s+(.+)$/i);if(Ie){L.push({type:Ie[1].toLowerCase(),when:q(Sv(K(Ie[2],"when")))});continue}const ne=be.match(/^strategy\.entry\s*\((.*)\)\s*$/i);if(ne){const Qe=ou(ne[1]||""),Oe=zu(Qe),Lt=Qe.filter(Xo=>!av(Xo))[0]||"",It=Qe.find(Xo=>/strategy\.(long|short)/i.test(Xo))||"",zt=/short/i.test(It)?"short":"long",pt=Oe.when?q(Sv(K(Oe.when,"when"))):null;if(!pt){t.push({message:"strategy.entry(...) requires when=...",line:ge});continue}const Mo=me(Oe);L.push({id:Lt?ha(String(Lt)):void 0,type:zt==="long"?"entry_long":"entry_short",when:pt,order:Mo||void 0});continue}const J=be.match(/^strategy\.(close|exit)\s*\((.*)\)\s*$/i);if(J){const Qe=ou(J[2]||""),Oe=zu(Qe),Lt=Qe.filter(es=>!av(es))[0]||"",It=Oe.when?q(Sv(K(Oe.when,"when"))):null,zt=Oe.side&&/short/i.test(String(Oe.side))?"short":"long",pt=me(Oe),Mo=Oe.stop??Oe.stopPrice,Xo=Oe.limit??Oe.limitPrice,en=Oe.qty_percent??Oe.qtyPct??Oe.qtyPctVal??Oe.qtyPercent,Fo=en!=null?Number(en):void 0,Eo=Mo!=null?ce(String(Mo),"exit_stop"):null,cs=Xo!=null?ce(String(Xo),"exit_limit"):null,Zt=Lt?`${ha(String(Lt))}__bracket`:`exit__bracket_${ge}`;let bs=!1;if(Mo!=null&&(L.push({id:`${Lt?ha(String(Lt)):ge}_STOP`,type:zt==="long"?"exit_long":"exit_short",when:`between(${Eo||"close"}, low, high)`,order:{kind:"stop",price:(Eo||"close").replace(/\s+/g,"_").toLowerCase(),qtyPct:typeof Fo=="number"&&Number.isFinite(Fo)?Fo:void 0,oco:Zt}}),bs=!0),Xo!=null&&(L.push({id:`${Lt?ha(String(Lt)):ge}_LIMIT`,type:zt==="long"?"exit_long":"exit_short",when:`between(${cs||"close"}, low, high)`,order:{kind:"limit",price:(cs||"close").replace(/\s+/g,"_").toLowerCase(),qtyPct:typeof Fo=="number"&&Number.isFinite(Fo)?Fo:void 0,oco:Zt}}),bs=!0),It&&(L.push({id:Lt?ha(String(Lt)):void 0,type:zt==="long"?"exit_long":"exit_short",when:It,order:Mo!=null||Xo!=null?typeof Fo=="number"&&Number.isFinite(Fo)?{kind:"market",qtyPct:Fo}:void 0:pt||(typeof Fo=="number"&&Number.isFinite(Fo)?{kind:"market",qtyPct:Fo}:void 0)}),bs=!0),!bs){t.push({message:"strategy.exit/close(...) needs when=... or stop=/limit=...",line:ge});continue}continue}const qe=be.match(/^strategy\.close_all\s*\((.*)\)\s*$/i);if(qe){const Qe=ou(qe[1]||""),Oe=zu(Qe),ct=Oe.when?q(Sv(K(Oe.when,"when"))):null;if(!ct){t.push({message:"strategy.close_all(...) requires when=...",line:ge});continue}L.push({type:"exit_long",when:ct,id:`close_all_long_${ge}`,order:{kind:"market",qtyPct:100}}),L.push({type:"exit_short",when:ct,id:`close_all_short_${ge}`,order:{kind:"market",qtyPct:100}});continue}const ft=be.match(/^draw\.fib\.auto\s*\((.*)\)\s*$/i);if(ft){const Qe=ou(ft[1]||""),Oe=zu(Qe),ct=ha(String(Oe.name??"fibo"));S.push({name:ct,type:"auto_fib",method:ha(String(Oe.method??"pivots")),pivotLeft:Number(Oe.left??Oe.pivotLeft??3),pivotRight:Number(Oe.right??Oe.pivotRight??3),lookback:Number(Oe.lookback??400),direction:ha(String(Oe.direction??"up")),draw:!0});continue}be.startsWith("//@")||s.push({message:`Ignored Pine statement: ${be}`,line:ge})}if(!_.some(he=>Array.isArray(he.plots)&&he.plots.length||Array.isArray(he.labels)&&he.labels.length||Array.isArray(he.levels)&&he.levels.length||Array.isArray(he.lines)&&he.lines.length)){const he=y.length?y[y.length-1].name:w.length?w[w.length-1].name:null,De=he||"close";Z("main").plots.push({name:he?ha(String(he)):"Close",source:De.replace(/\s+/g,"_").toLowerCase(),type:"line",color:"#60a5fa",width:2}),s.push({message:he?`No plot() found; auto-plotted "${he}". Add plot(...) to control output.`:'No plot() found; auto-plotted "close". Add plot(...) to control output.',line:1})}if(t.length)return{ok:!1,errors:t,warnings:s.length?s:void 0};try{const he=_.find(De=>De.pane==="sub");if(he&&typeof he.min!="number"&&typeof he.max!="number"){const ge=(Array.isArray(he.levels)?he.levels:[]).map(be=>Number(be==null?void 0:be.value)).filter(be=>Number.isFinite(be));if(ge.length){const be=Math.min(...ge),$e=Math.max(...ge),Ve=ge.some(Je=>Je<=30),Ce=ge.some(Je=>Je>=70);ge.length>=2&&be>=0&&$e<=100&&Ve&&Ce&&(he.min=0,he.max=100)}}}catch{}return{ok:!0,spec:{panes:_,calc:S,series:y,stateSeries:w,signals:L,strategy:F,params:T},inputDefs:P,warnings:s.length?s:void 0}}function jO(o,e,t,s){e("run",{code:t(),params:n(s)})}function zO(o,e){e("reset")}function BO(o,e,t){e("save",{code:t()})}function NO(o,e,t){n(e)&&(b(e,!1),t("fullpage",{enabled:!1})),t("close")}function RO(o,e){e("guide")}function OO(o,e,t){b(e,!n(e)),t("labels",{enabled:n(e)})}function VO(o,e,t){b(e,!n(e)),t("fullpage",{enabled:n(e)})}function WO(o,e,t){b(e,null),t("selectTrade",{trade:null})}function a2(o,e){b(e,!1)}function l2(o,e,t,s){const i=[e(["side","qty","entryIndex","entryTime","entryPrice","exitIndex","exitTime","exitPrice","grossPnl","fees","netPnl","pnlPct","cumNetPnl","exitReason","maePct","mfePct"])];for(const r of n(t))i.push(e([r.side,r.qty,r.entryIndex,r.entryTimestamp,r.entryPrice,r.exitIndex,r.exitTimestamp,r.exitPrice,r.pnl,r.fees,r.netPnl,r.pnlPct,r.cumNet,r.exitReason,r.maePct,r.mfePct]));s("backtest_trades.csv",i.join(`
`),"text/csv;charset=utf-8")}function c2(o,e,t,s){const i=[e(["id","action","side","kind","status","signalId","ocoGroup","createdIndex","createdTime","activeFromIndex","expiresAtIndex","qtyPct","price","stopPrice","limitPrice","filledIndex","filledTime","fillPrice","fillQty","fees","note"])];for(const r of n(t))i.push(e([r.id,r.action,r.side,r.kind,r.status,r.signalId,r.ocoGroup,r.createdIndex,r.createdTimestamp,r.activeFromIndex,r.expiresAtIndex,r.qtyPct,r.price,r.stopPrice,r.limitPrice,r.filledIndex,r.filledTimestamp,r.fillPrice,r.fillQty,r.fees,r.note]));s("backtest_orders.csv",i.join(`
`),"text/csv;charset=utf-8")}function d2(o,e,t,s,i){const r=[e(["side","qty","entryIndex","entryTime","entryPrice","exitIndex","exitTime","exitPrice","grossPnl","fees","netPnl","pnlPct","cumNetPnl","exitReason","maePct","mfePct"])];for(const l of n(t))r.push(e([l.side,l.qty,l.entryIndex,l.entryTimestamp,l.entryPrice,l.exitIndex,l.exitTimestamp,l.exitPrice,l.pnl,l.fees,l.netPnl,l.pnlPct,l.cumNet,l.exitReason,l.maePct,l.mfePct]));const a=n(s).type==="all"?"all":`${n(s).type}_${String(n(s).key).replace(/[^a-zA-Z0-9_-]+/g,"_")}`;i(`backtest_trades_${a}.csv`,r.join(`
`),"text/csv;charset=utf-8")}function qO(o,e,t,s){const i=[e(["index","timestamp","equity"])];for(const r of n(t))i.push(e([r.index,r.timestamp,r.equity]));s("backtest_equity.csv",i.join(`
`),"text/csv;charset=utf-8")}var HO=o=>o.stopPropagation(),GO=(o,e)=>{o.stopPropagation(),b(e,"editor")},YO=(o,e)=>{o.stopPropagation(),b(e,"errors")},UO=de("<span> </span>"),KO=(o,e)=>{o.stopPropagation(),b(e,"results")},ZO=(o,e)=>e("main"),XO=(o,e)=>e("sub"),JO=de('<div class="pane-toggle svelte-za388g" aria-label="Target pane"><button type="button" class="svelte-za388g">Main</button> <button type="button" class="svelte-za388g">Sub pane</button></div>'),QO=de('<button class="icon svelte-za388g" type="button" aria-label="Full page view" title="Full page view"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 9V4h5M20 9V4h-5M4 15v5h5M20 15v5h-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg></button>'),eV=de('<button class="icon svelte-za388g" type="button" aria-label="Exit full page view" title="Exit full page view (Esc)"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 4H4v5M15 4h5v5M9 20H4v-5M15 20h5v-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg></button>'),tV=de('<div class="gutter-line svelte-za388g"></div>'),oV=de('<div class="pine-warn-row svelte-za388g"> </div>'),sV=de('<div class="pine-warn svelte-za388g"></div>'),nV=(o,e,t)=>e(n(t).name,o.currentTarget.checked),iV=de('<label class="toggle svelte-za388g"><input type="checkbox" class="svelte-za388g"> <span class="toggle-track svelte-za388g"></span></label>'),rV=(o,e,t)=>e(n(t).name,o.currentTarget.value),aV=de('<input class="input svelte-za388g" type="text">'),lV=(o,e,t)=>{const s=o.currentTarget.value,i=Number(s);Number.isFinite(i)&&e(n(t).name,n(t).type==="int"?Math.floor(i):i)},cV=de('<input class="input svelte-za388g" type="number">'),dV=de('<div class="input-row svelte-za388g"><div class="input-label svelte-za388g"><div class="input-name svelte-za388g"> </div> <div class="input-key mono svelte-za388g"> </div></div> <div class="input-control svelte-za388g"><!></div></div>'),uV=de('<div class="editor-side svelte-za388g"><div class="side-card svelte-za388g"><div class="side-title svelte-za388g">Inputs</div> <div class="side-sub svelte-za388g">TradingView‑style parameters (Pine)</div> <!> <div class="inputs-list svelte-za388g"></div> <div class="side-hint svelte-za388g">Change inputs → press <b>Run</b> to re‑calculate.</div></div></div>'),pV=de('<div class="editor-area svelte-za388g"><div class="editor-shell svelte-za388g"><div class="editor-main svelte-za388g"><div class="editor-toolbar svelte-za388g"><div class="editor-file svelte-za388g"><span class="file-dot svelte-za388g"></span> <span class="file-name svelte-za388g">inline-script.dsl</span> <span class="file-meta svelte-za388g"> </span></div> <div class="editor-hints svelte-za388g"><span class="hint svelte-za388g">1. Write or paste script</span> <span class="hint svelte-za388g">2. Press Run ▶</span></div></div> <div class="editor-scroll svelte-za388g"><div class="editor-gutter svelte-za388g"></div> <div class="code-shell svelte-za388g"><pre class="code-overlay svelte-za388g" aria-hidden="true"><code class="svelte-za388g"><!></code><mark class="err svelte-za388g" style="display:none" aria-hidden="true"></mark><mark class="err-warning svelte-za388g" style="display:none" aria-hidden="true"></mark></pre> <textarea class="code-input svelte-za388g" spellcheck="false" placeholder="Write or paste your script here, then press Run to see it on the chart"></textarea></div></div></div> <!></div></div>'),vV=de('<div class="no-errors svelte-za388g">No errors • All good</div>'),fV=de('<span class="diag-loc svelte-za388g"> <!> —</span>'),gV=de('<span class="diag-hint svelte-za388g"> </span>'),mV=de('<div><span class="diag-dot svelte-za388g"></span> <span class="diag-msg svelte-za388g"><!> </span> <!></div>'),hV=de('<div class="errors-header svelte-za388g"><div class="errors-title svelte-za388g"> </div> <div class="errors-sub svelte-za388g">Newest errors appear here as you type.</div></div> <div class="errors-list svelte-za388g" aria-live="polite"></div>',1),_V=de('<div class="errors-area svelte-za388g"><!></div>'),yV=o=>{var e;try{(e=o==null?void 0:o.stopPropagation)==null||e.call(o)}catch{}},bV=(o,e)=>b(e,"trades"),xV=(o,e)=>b(e,"orders"),wV=(o,e)=>e({type:"all"}),kV=de('<button class="btn btn-xs btn-outline" type="button">Clear filter</button>'),SV=(o,e,t)=>e(n(t)),CV=(o,e,t)=>{o.key==="Enter"&&e(n(t))},PV=(o,e,t)=>{var s;try{(s=o==null?void 0:o.stopPropagation)==null||s.call(o)}catch{}e(n(t))},IV=de('<tr tabindex="0" class="svelte-za388g"><td class="svelte-za388g"><button class="btn btn-xs btn-ghost" type="button" title="Focus this trade on chart">Focus</button></td><td class="svelte-za388g"><span class="badge badge-outline"> </span></td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td></tr>'),MV=de('<div class="tt-scroll svelte-za388g"><table class="tt-table svelte-za388g"><thead class="svelte-za388g"><tr><th class="svelte-za388g">Focus</th><th class="svelte-za388g">Side</th><th class="right svelte-za388g">Qty</th><th class="svelte-za388g">Entry</th><th class="svelte-za388g">Exit</th><th class="right svelte-za388g">Net PnL</th><th class="right svelte-za388g">Fees</th><th class="right svelte-za388g">Gross PnL</th><th class="right svelte-za388g">PnL%</th><th class="right svelte-za388g">Cum Net</th><th class="svelte-za388g">Reason</th><th class="right svelte-za388g">MAE%</th><th class="right svelte-za388g">MFE%</th></tr></thead><tbody class="svelte-za388g"></tbody></table></div>'),TV=de('<div class="no-errors svelte-za388g">No trades to show.</div>'),AV=de('<div class="tt-toolbar svelte-za388g"><div class="tt-toolbar-left svelte-za388g"><div class="tt-title svelte-za388g">Trades Table <span class="tt-sub mono svelte-za388g"> </span></div></div> <div class="tt-toolbar-right"><!> <button class="btn btn-xs btn-outline" type="button">Download CSV</button></div></div> <!>',1),LV=de('<tr class="svelte-za388g"><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td></tr>'),FV=de('<div class="tt-scroll svelte-za388g"><table class="tt-table svelte-za388g"><thead class="svelte-za388g"><tr><th class="svelte-za388g">ID</th><th class="svelte-za388g">Action</th><th class="svelte-za388g">Side</th><th class="svelte-za388g">Kind</th><th class="svelte-za388g">Status</th><th class="svelte-za388g">Created</th><th class="right svelte-za388g">Qty%</th><th class="right svelte-za388g">Price</th><th class="right svelte-za388g">Stop</th><th class="right svelte-za388g">Limit</th><th class="svelte-za388g">Filled</th><th class="right svelte-za388g">Fill Qty</th><th class="right svelte-za388g">Fill Px</th><th class="right svelte-za388g">Fees</th><th class="svelte-za388g">OCO</th><th class="svelte-za388g">Signal</th><th class="svelte-za388g">Note</th></tr></thead><tbody class="svelte-za388g"></tbody></table></div>'),DV=de('<div class="no-errors svelte-za388g">No orders to show.</div>'),EV=de('<div class="tt-title-row svelte-za388g"><div class="tt-title svelte-za388g">Orders</div> <div class="tt-sub mono svelte-za388g"> <!></div> <button class="btn btn-xs btn-outline" type="button">Download CSV</button></div> <!>',1),$V=de('<div class="tables-modal-backdrop svelte-za388g" role="presentation"><div class="tables-modal svelte-za388g" role="dialog" aria-modal="true" aria-label="Trades and Orders"><div class="tables-modal-head svelte-za388g"><div class="tables-modal-title svelte-za388g">Trades & Orders</div> <div class="tables-modal-actions svelte-za388g"><div class="tables-modal-tabs svelte-za388g" role="tablist" aria-label="Tables"><button type="button" role="tab" class="svelte-za388g">Trades</button> <button type="button" role="tab" class="svelte-za388g">Orders</button></div> <button class="btn btn-xs btn-outline" type="button">Close</button></div></div> <div class="tables-modal-body svelte-za388g"><!></div></div></div>'),jV=de("Backtest requires <code>strategy(...)</code> — add it, then press <b>Run</b>.",1),zV=de('Backtest requires <code>"strategy"</code> — add it, then press <b>Run</b>.',1),BV=de('<div class="no-errors svelte-za388g"><!></div>'),NV=de("No backtest results yet — add <code>strategy.entry/strategy.exit</code>, then press <b>Run</b>.",1),RV=de('No backtest results yet — add <code>"signals"</code>, then press <b>Run</b>.',1),OV=de('<div class="no-errors svelte-za388g"><!></div>'),VV=de("Ready — press <b>Run</b> to calculate results.",1),WV=de('<div class="mono svelte-za388g" style="margin-top:6px; opacity:0.8"> </div>'),qV=de('<div class="no-errors svelte-za388g"><!> <!></div>'),HV=de('<div class="bt-meta-item svelte-za388g">Last signal: <span class="mono svelte-za388g"> </span></div>'),GV=de("No signals matched. Check <code>when</code> conditions and series names; try a simpler condition first.",1),YV=de('Signals matched but no orders filled. Common causes: limit/stop price never touches • stop‑limit expires • try <code>"order": &#123; "kind": "market" &#125;</code> first, then add limit/stop.',1),UV=de('<div class="bt-hint svelte-za388g"><div class="bt-hint-title svelte-za388g">No trades yet</div> <div class="bt-hint-body svelte-za388g"><!></div></div>'),KV=(o,e)=>{b(e,"1m")},ZV=(o,e)=>{b(e,"3m")},XV=(o,e)=>{b(e,"6m")},JV=(o,e)=>{b(e,"all")},QV=de('<svg class="report-svg svelte-za388g" viewBox="0 0 100 100" preserveAspectRatio="none" aria-label="Equity curve"><path fill="var(--report-equity-fill)"></path><path fill="none" stroke="var(--report-equity-stroke)" stroke-width="1.5" vector-effect="non-scaling-stroke" stroke-linejoin="round" stroke-linecap="round"></path><line x1="0" y1="25" x2="100" y2="25" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="50" x2="100" y2="50" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="75" x2="100" y2="75" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg> <div class="chart-axis top mono svelte-za388g"> </div> <div class="chart-axis bottom mono svelte-za388g"> </div>',1),eW=de('<div class="report-empty svelte-za388g">No data</div>'),tW=de('<div class="crosshair v svelte-za388g"></div> <div class="crosshair h svelte-za388g"></div> <div class="chart-tooltip svelte-za388g"><div class="tt-title mono svelte-za388g"> </div> <div class="tt-val svelte-za388g">Equity: <span class="mono svelte-za388g"> </span></div></div>',1),oW=de('<svg class="report-svg svelte-za388g" viewBox="0 0 100 100" preserveAspectRatio="none" aria-label="Drawdown"><path fill="var(--report-dd-fill)"></path><path fill="none" stroke="var(--report-dd-stroke)" stroke-width="1.5" vector-effect="non-scaling-stroke" stroke-linejoin="round" stroke-linecap="round"></path><line x1="0" y1="25" x2="100" y2="25" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="50" x2="100" y2="50" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line><line x1="0" y1="75" x2="100" y2="75" stroke="var(--report-grid)" stroke-width="1" vector-effect="non-scaling-stroke"></line></svg> <div class="chart-axis top mono svelte-za388g"> </div> <div class="chart-axis bottom mono svelte-za388g"> </div>',1),sW=de('<div class="report-empty svelte-za388g">No data</div>'),nW=de('<div class="crosshair v svelte-za388g"></div> <div class="crosshair h svelte-za388g"></div> <div class="chart-tooltip svelte-za388g"><div class="tt-title mono svelte-za388g"> </div> <div class="tt-val svelte-za388g">DD: <span class="mono svelte-za388g"> </span></div></div>',1),iW=(o,e,t,s,i)=>{e({type:"month",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i()},rW=(o,e,t,s,i)=>{o.key==="Enter"&&(e({type:"month",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i())},aW=de('<div role="button" tabindex="0"><div class="mono svelte-za388g"> </div> <div class="right mono svelte-za388g"> </div></div>'),lW=de('<div class="returns-table svelte-za388g"><div class="rt-head svelte-za388g"><div>Month</div><div class="right svelte-za388g">Return</div></div> <!></div>'),cW=de('<div class="no-errors svelte-za388g">No monthly returns yet.</div>'),dW=(o,e,t,s,i)=>{e({type:"week",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i()},uW=(o,e,t,s,i)=>{o.key==="Enter"&&(e({type:"week",key:n(t).key}),s("focusIndex",{index:n(t).toIndex,timestamp:n(t).toTs}),i())},pW=de('<div role="button" tabindex="0"><div class="mono svelte-za388g"> </div> <div class="right mono svelte-za388g"> </div></div>'),vW=de('<div class="returns-table svelte-za388g"><div class="rt-head svelte-za388g"><div>Week</div><div class="right svelte-za388g">Return</div></div> <!></div>'),fW=de('<div class="no-errors svelte-za388g">No weekly returns yet.</div>'),gW=(o,e)=>e("trades"),mW=(o,e)=>e("orders"),hW=de('<button class="btn btn-sm btn-outline" type="button">Download Filtered Trades CSV</button>'),_W=(o,e,t,s)=>{e(n(t)),s()},yW=de('<button class="btn btn-xs btn-outline" type="button" title="Focus best trade (max net PnL)">Focus best</button>'),bW=(o,e,t,s)=>{e(n(t)),s()},xW=de('<button class="btn btn-xs btn-outline" type="button" title="Focus worst trade (min net PnL)">Focus worst</button>'),wW=(o,e)=>e({type:"all"}),kW=de('<div class="fm-pill mono svelte-za388g"> </div> <div class="fm-pill mono svelte-za388g"> </div>',1),SW=de('<div class="filter-strip svelte-za388g"><div class="filter-chip mono svelte-za388g"> </div> <div class="filter-actions svelte-za388g"><!> <!> <button class="btn btn-xs btn-outline" type="button" title="Download filtered trades as CSV">Export filtered</button> <button class="btn btn-xs btn-outline" type="button">Clear</button></div></div> <div class="filter-metrics svelte-za388g"><div class="fm-pill mono svelte-za388g"> </div> <div class="fm-pill mono svelte-za388g"> </div> <div class="fm-pill mono svelte-za388g"> </div> <div class="fm-pill mono svelte-za388g"> </div> <!></div>',1),CW=de('<div class="tt-note-inline svelte-za388g"> </div>'),PW=(o,e)=>e({type:"all"}),IW=de('<button class="btn btn-xs btn-outline" type="button">Clear filter</button>'),MW=de('<button class="btn btn-xs btn-outline" type="button">Clear focus</button>'),TW=de('<div class="tt-selected svelte-za388g"><div class="tt-selected-title svelte-za388g">Selected</div> <div class="tt-selected-body mono svelte-za388g"> </div></div>'),AW=(o,e,t)=>e(n(t)),LW=(o,e,t)=>{o.key==="Enter"&&e(n(t))},FW=(o,e,t)=>{var s;try{(s=o==null?void 0:o.stopPropagation)==null||s.call(o)}catch{}e(n(t))},DW=de('<tr tabindex="0" class="svelte-za388g"><td class="svelte-za388g"><button class="btn btn-xs btn-ghost" type="button" title="Focus this trade on chart">Focus</button></td><td class="svelte-za388g"><span class="badge badge-outline"> </span></td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td></tr>'),EW=de('<div class="tt-scroll svelte-za388g"><table class="tt-table svelte-za388g"><thead class="svelte-za388g"><tr><th class="svelte-za388g">Focus</th><th class="svelte-za388g">Side</th><th class="right svelte-za388g">Qty</th><th class="svelte-za388g">Entry</th><th class="svelte-za388g">Exit</th><th class="right svelte-za388g">Net PnL</th><th class="right svelte-za388g">Fees</th><th class="right svelte-za388g">Gross PnL</th><th class="right svelte-za388g">PnL%</th><th class="right svelte-za388g">Cum Net</th><th class="svelte-za388g">Reason</th><th class="right svelte-za388g">MAE%</th><th class="right svelte-za388g">MFE%</th></tr></thead><tbody class="svelte-za388g"></tbody></table></div>'),$W=de('No trades yet. Press <span class="mono svelte-za388g">Run</span> to calculate results.',1),jW=de('No trades match the current filter (<span class="mono svelte-za388g"> </span> ',1),zW=de('<div class="no-errors svelte-za388g"><!></div>'),BW=de('<tr class="svelte-za388g"><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="right mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td><td class="mono svelte-za388g"> </td></tr>'),NW=de('<div class="tt-scroll svelte-za388g"><table class="tt-table svelte-za388g"><thead class="svelte-za388g"><tr><th class="svelte-za388g">ID</th><th class="svelte-za388g">Action</th><th class="svelte-za388g">Side</th><th class="svelte-za388g">Kind</th><th class="svelte-za388g">Status</th><th class="svelte-za388g">Created</th><th class="right svelte-za388g">Qty%</th><th class="right svelte-za388g">Price</th><th class="right svelte-za388g">Stop</th><th class="right svelte-za388g">Limit</th><th class="svelte-za388g">Filled</th><th class="right svelte-za388g">Fill Qty</th><th class="right svelte-za388g">Fill Px</th><th class="right svelte-za388g">Fees</th><th class="svelte-za388g">OCO</th><th class="svelte-za388g">Signal</th><th class="svelte-za388g">Note</th></tr></thead><tbody class="svelte-za388g"></tbody></table></div>'),RW=de('<div class="no-errors svelte-za388g">No orders to show yet.</div>'),OW=de('<div class="errors-header svelte-za388g"><div class="errors-title svelte-za388g">Strategy Results</div> <div class="errors-sub svelte-za388g"> </div></div> <div class="bt-meta svelte-za388g"><div class="bt-meta-item svelte-za388g">Signals: <span class="mono svelte-za388g"> </span> <span class="bt-meta-sub mono svelte-za388g"> </span></div> <!></div> <div class="results-grid svelte-za388g"><div class="result-card svelte-za388g"><div class="rc-title svelte-za388g">Trades</div> <div class="rc-value svelte-za388g"> </div> <div class="rc-sub svelte-za388g"> <!></div></div> <div class="result-card svelte-za388g"><div class="rc-title svelte-za388g">Win rate</div> <div class="rc-value svelte-za388g"> </div> <div class="rc-sub svelte-za388g"> </div></div> <div class="result-card svelte-za388g"><div class="rc-title svelte-za388g">Net PnL</div> <div class="rc-value svelte-za388g"> </div> <div class="rc-sub svelte-za388g"> </div></div> <div class="result-card svelte-za388g"><div class="rc-title svelte-za388g">Expectancy</div> <div class="rc-value svelte-za388g"> </div> <div class="rc-sub svelte-za388g"> </div></div></div> <!> <div class="reports-head svelte-za388g"><div class="reports-title svelte-za388g">Charts</div> <div class="range-toggle svelte-za388g" role="group" aria-label="Report range"><button type="button" class="svelte-za388g">1M</button> <button type="button" class="svelte-za388g">3M</button> <button type="button" class="svelte-za388g">6M</button> <button type="button" class="svelte-za388g">All</button></div></div> <div class="reports-grid svelte-za388g"><div class="report-card svelte-za388g"><div class="report-head svelte-za388g"><div class="rc-title svelte-za388g">Equity Curve</div> <div class="report-sub mono svelte-za388g"><!></div></div> <div class="report-canvas svelte-za388g"><!> <!></div></div> <div class="report-card svelte-za388g"><div class="report-head svelte-za388g"><div class="rc-title svelte-za388g">Drawdown (%)</div> <div class="report-sub mono svelte-za388g"> </div></div> <div class="report-canvas svelte-za388g"><!> <!></div></div></div> <div class="returns-grid svelte-za388g"><div class="return-card svelte-za388g"><div class="rc-title-row svelte-za388g"><div class="rc-title svelte-za388g">Monthly Returns</div> <button class="btn btn-xs btn-outline" type="button">Go to Trades</button></div> <div class="rc-subhint svelte-za388g">Click a row to filter trades by that period.</div> <!></div> <div class="return-card svelte-za388g"><div class="rc-title-row svelte-za388g"><div class="rc-title svelte-za388g">Weekly Returns</div> <button class="btn btn-xs btn-outline" type="button">Go to Trades</button></div> <div class="rc-subhint svelte-za388g">Click a row to filter trades by that period.</div> <!></div></div> <div class="export-row svelte-za388g"><button class="btn btn-sm btn-primary" type="button">Open Trades Table</button> <button class="btn btn-sm btn-primary" type="button">Open Orders Table</button> <button class="btn btn-sm btn-outline" type="button">Download Trades CSV</button> <!> <button class="btn btn-sm btn-outline" type="button">Download Orders CSV</button> <button class="btn btn-sm btn-outline" type="button">Download Equity CSV</button></div> <div class="pnl-strip svelte-za388g"><div class="pnl-item pos svelte-za388g"> </div> <div class="pnl-item neg svelte-za388g"> </div> <div> </div></div> <div class="pnl-strip pnl-strip-2 svelte-za388g"><div class="pnl-item svelte-za388g"> </div> <div class="pnl-item svelte-za388g"> </div> <div class="pnl-item svelte-za388g"> </div></div> <!> <div class="trades-anchor svelte-za388g"></div> <div class="trades-table svelte-za388g" aria-label="Trades table"><div class="tt-toolbar svelte-za388g"><div class="tt-toolbar-left svelte-za388g"><div class="tt-title svelte-za388g">Trades Table <span class="tt-sub mono svelte-za388g"> </span></div> <!></div> <div class="tt-toolbar-right"><!> <!></div></div> <!> <!></div> <div class="trades-table svelte-za388g" style="margin-top:12px" aria-label="Orders table"><div class="tt-title-row svelte-za388g"><div class="tt-title svelte-za388g">Orders</div> <div class="tt-sub mono svelte-za388g"> <!></div></div> <!></div>',1),VW=de('<div class="errors-area svelte-za388g"><!> <!></div>'),WW=de('<div class="script-studio svelte-za388g"><div class="studio-header svelte-za388g"><div class="studio-title svelte-za388g"><div class="title-dot svelte-za388g"></div> <div class="title-text-group svelte-za388g"><div class="title-text svelte-za388g">Script Studio</div> <div class="title-sub svelte-za388g">Inline editor · draft → chart</div></div></div> <div class="studio-meta svelte-za388g"><div class="view-toggle svelte-za388g"><button type="button" class="svelte-za388g">Editor</button> <button type="button" class="svelte-za388g"><span> </span> <!></button> <button type="button" class="svelte-za388g">Results</button></div></div> <div class="studio-actions svelte-za388g"><!> <button class="ghost svelte-za388g" type="button" title="Toggle chart labels"><span class="btn-icon svelte-za388g"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true"><path d="M2 3.5h8M2 6h8M2 8.5h5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path></svg></span> <span> </span></button> <button class="ghost ghost-secondary svelte-za388g" type="button"><span>Documentation</span></button> <button class="ghost svelte-za388g" type="button"><span class="btn-icon svelte-za388g"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true"><path d="M3 2.5h6v7H3z" stroke="currentColor" stroke-width="1.2"></path><path d="M4 1h4v2H4z" fill="currentColor"></path><path d="M5 7h2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path></svg></span> <span>Save</span></button> <button class="ghost svelte-za388g" type="button"><span class="btn-icon svelte-za388g"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" aria-hidden="true"><path d="M6 2a4 4 0 1 1-3.5 2.06" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path><path d="M2.5 2.5v3h3" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"></path></svg></span> <span>Reset</span></button> <button class="primary svelte-za388g" type="button"><span class="btn-icon svelte-za388g"><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" aria-hidden="true"><path d="M4 3.2v5.6L9 6 4 3.2Z"></path></svg></span> <span> </span></button> <!> <button class="icon svelte-za388g" type="button" aria-label="Collapse script dock">&times;</button></div></div> <!> <div class="studio-footer svelte-za388g"><div class="footer-left svelte-za388g"><span></span> <span class="footer-text svelte-za388g"> </span></div> <div class="footer-right svelte-za388g"><span class="footer-hint svelte-za388g">Ctrl/Cmd + S to save</span> <span class="footer-divider svelte-za388g">•</span> <span class="footer-hint svelte-za388g">Ctrl/Cmd + Enter to run</span></div></div></div>');function qW(o,e){Ka(e,!0);let t=Ss(e,"code",15,""),s=Ss(e,"status",3,null),i=Ss(e,"error",3,null),r=Ss(e,"backtest",3,null),a=Ss(e,"signalEvents",19,()=>[]),l=Ss(e,"isRunning",3,!1),d=Ss(e,"isOpen",3,!0),v=Ss(e,"paneTarget",7,"main"),p=Ss(e,"labelsEnabled",3,!0);const _=Md();function y(Me){v()!==Me&&(v(Me),_("pane",{target:Me}))}let w=oe("editor"),k=oe(j(!!p())),S=oe(!1),L=oe("trades"),T=oe(!1);Wi(()=>{b(k,j(!!p()))});const P=We(()=>n(w)==="results");function A(){b(T,!1),_("fullpage",{enabled:!1})}Rd(()=>{const Me=Xe=>{n(T)&&Xe.key==="Escape"&&(Xe.preventDefault(),A())};return window.addEventListener("keydown",Me),()=>window.removeEventListener("keydown",Me)}),yp(()=>{try{n(T)&&_("fullpage",{enabled:!1})}catch{}});const F=We(()=>{try{const Me=JSON.parse(String(t()||"").trim());return!!(Me!=null&&Me.strategy)}catch{return!1}}),B=We(()=>{try{const Me=JSON.parse(String(t()||"").trim());return Array.isArray(Me==null?void 0:Me.signals)&&Me.signals.length>0}catch{return!1}}),R=We(()=>{try{return s1(String(t()||""))}catch{return null}}),N=We(()=>{const Me=n(R);return!!(Me&&Me.ok&&Me.spec&&Me.spec.strategy)}),$=We(()=>{const Me=n(R),Xe=Me&&Me.ok&&Me.spec?Me.spec.signals:null;return Array.isArray(Xe)&&Xe.length>0}),V=We(()=>!!(n(F)||n(N))),U=We(()=>!!(n(B)||n($))),G=We(()=>{const Me=n(R);return!Me||!Me.ok?[]:Array.isArray(Me.warnings)?Me.warnings:[]}),Z=We(()=>{const Me=n(R);return!Me||!Me.ok?[]:Array.isArray(Me.inputDefs)?Me.inputDefs:[]});let le=oe(null);Wi(()=>{if(!n(Z).length){b(le,null);return}n(le)==null&&b(le,j({}))});const se=We(()=>{const Me={};for(const Xe of n(Z))Me[Xe.name]=n(le)&&Xe.name in n(le)?n(le)[Xe.name]:Xe.defval;return Me}),ie=(Me,Xe)=>{b(le,j({...n(le)||{},[Me]:Xe}))},Y=We(()=>{var Me;return((Me=r())==null?void 0:Me.summary)||null}),K=We(()=>{if(!n(P))return{total:0,entryLong:0,exitLong:0,entryShort:0,exitShort:0,lastTs:null};const Me=Array.isArray(a())?a():[],Xe={total:Me.length,entryLong:0,exitLong:0,entryShort:0,exitShort:0};let X=null;for(const Le of Me){if(!Le)continue;Le.type==="entry_long"?Xe.entryLong+=1:Le.type==="exit_long"?Xe.exitLong+=1:Le.type==="entry_short"?Xe.entryShort+=1:Le.type==="exit_short"&&(Xe.exitShort+=1);const nt=Number(Le.timestamp);Number.isFinite(nt)&&(X=X==null?nt:Math.max(X,nt))}return{...Xe,lastTs:X}}),Q=We(()=>{var Me;return n(P)&&Array.isArray((Me=r())==null?void 0:Me.trades)?r().trades:[]}),q=We(()=>{var Me;return n(P)&&Array.isArray((Me=r())==null?void 0:Me.orders)?r().orders:[]}),ce=Me=>{const Xe=typeof Me=="number"?Me:Number(Me);return!Number.isFinite(Xe)||Xe<=0?null:Xe<1e12?Xe*1e3:Xe},_e=Me=>{const Xe=ce(Me);if(Xe==null)return"-";try{const Le=new Date(Xe).toISOString();return`${Le.slice(0,10)} ${Le.slice(11,16)}`}catch{return"-"}},me=Me=>{const Xe=typeof Me=="number"?Me:Number(Me);return Number.isFinite(Xe)?Xe:null},Pe=We(()=>{const Me=n(Q).filter(X=>X&&Number.isFinite(Number(X.entryIndex))&&Number.isFinite(Number(X.exitIndex))).slice().sort((X,Le)=>Number(X.exitIndex)-Number(Le.exitIndex)||Number(X.entryIndex)-Number(Le.entryIndex));let Xe=0;return Me.map((X,Le)=>{const nt=me(X.pnl??X.grossPnl??X.profit),et=me(X.fees??X.fee??X.commission),ht=(nt??0)-(et??0);Xe+=ht;const uo=ce(X.entryTimestamp),ut=ce(X.exitTimestamp);return{id:[X.side||"",X.entryIndex,X.exitIndex,uo??0,ut??0,X.entryOrderId??"",X.exitOrderId??"",Le].join(":"),side:String(X.side||""),qty:me(X.qty??X.size)??0,entryIndex:Number(X.entryIndex)||0,exitIndex:Number(X.exitIndex)||0,entryTimestamp:uo,exitTimestamp:ut,entryPrice:me(X.entryPrice??X.entry_price??X.entry)??0,exitPrice:me(X.exitPrice??X.exit_price??X.exit)??0,pnl:nt??0,pnlPct:me(X.pnlPct??X.pnl_pct??X.returnPct)??0,fees:et??0,netPnl:ht,cumNet:Xe,exitReason:String(X.exitReason||""),maePct:Number.isFinite(Number(X.maePct))?Number(X.maePct):null,mfePct:Number.isFinite(Number(X.mfePct))?Number(X.mfePct):null}})}),ze=We(()=>n(q).filter(Xe=>Xe&&Number.isFinite(Number(Xe.createdIndex))).slice().sort((Xe,X)=>Number(Xe.createdIndex)-Number(X.createdIndex)||String(Xe.id||"").localeCompare(String(X.id||""))).map((Xe,X)=>{const Le=ce(Xe.createdTimestamp),nt=ce(Xe.filledTimestamp),et=String(Xe.kind||"").toLowerCase(),ht=me(Xe.price),uo=me(Xe.stopPrice),ut=me(Xe.limitPrice);return{id:String(Xe.id||X),action:String(Xe.action||""),side:String(Xe.side||""),kind:String(Xe.kind||""),originalKind:String(Xe.originalKind||""),status:String(Xe.status||""),signalId:Xe.signalId!=null?String(Xe.signalId):"",ocoGroup:Xe.ocoGroup!=null?String(Xe.ocoGroup):"",createdIndex:Number(Xe.createdIndex)||0,createdTimestamp:Le,activeFromIndex:Number(Xe.activeFromIndex)||0,expiresAtIndex:Number.isFinite(Number(Xe.expiresAtIndex))?Number(Xe.expiresAtIndex):null,qtyPct:Number(Xe.qtyPct)||0,price:ht,stopPrice:uo??(et==="stop"?ht:null),limitPrice:ut??(et==="limit"?ht:null),filledIndex:Number.isFinite(Number(Xe.filledIndex))?Number(Xe.filledIndex):null,filledTimestamp:nt,fillPrice:me(Xe.fillPrice),fillQty:me(Xe.fillQty),fees:me(Xe.fees),note:Xe.note!=null?String(Xe.note):""}})),he=We(()=>n(ze).length>500?n(ze).slice(n(ze).length-500):n(ze));let De=oe(j({type:"all"}));const ge=We(()=>{if(n(De).type==="all")return n(Pe);const Me=Xe=>{const X=Number(Xe==null?void 0:Xe.exitTimestamp);return!Number.isFinite(X)||X<=0?!1:n(De).type==="month"?Mo(X)===n(De).key:n(De).type==="week"?Xo(X)===n(De).key:!0};return n(Pe).filter(Me)}),be=We(()=>{const Me=n(ge),Xe=Me.length;let X=0,Le=0,nt=0,et=0,ht=0,uo=0,ut=0,Jt=0,fo=0;for(const ro of Me){const Do=Number(ro==null?void 0:ro.netPnl)||0,Ao=Number(ro==null?void 0:ro.fees)||0,ss=Number(ro==null?void 0:ro.pnl)||0;nt+=Do,et+=Ao,ht+=ss,ss>0?uo+=ss:ss<0&&(ut+=Math.abs(ss)),Do>0?(X+=1,Jt+=Do):Do<0&&(Le+=1,fo+=Do)}const lo=Xe?X/Xe*100:0,so=X?Jt/X:0,ko=Le?fo/Le:0,ts=ut>0?uo/ut:uo>0?1/0:0,Xn=Xe?X/Xe*so+Le/Xe*ko:0;return{trades:Xe,wins:X,losses:Le,winRate:lo,net:nt,fees:et,gross:ht,grossProfit:uo,grossLoss:ut,profitFactor:ts,avgWin:so,avgLoss:ko,expectancy:Xn}}),$e=We(()=>{let Me=null,Xe=-1/0;for(const X of n(ge)){const Le=Number(X==null?void 0:X.netPnl);Number.isFinite(Le)&&Le>Xe&&(Xe=Le,Me=X)}return Me}),Ve=We(()=>{let Me=null,Xe=1/0;for(const X of n(ge)){const Le=Number(X==null?void 0:X.netPnl);Number.isFinite(Le)&&Le<Xe&&(Xe=Le,Me=X)}return Me}),Ce=We(()=>n(ge).length>500?n(ge).slice(n(ge).length-500):n(ge)),Je=We(()=>n(ge).length>500?`Showing last 500 of ${n(ge).length}`:""),ye=We(()=>n(Pe).reduce((Me,Xe)=>Me+(Number(Xe.netPnl)||0),0));let Ae=oe(null);const ee=We(()=>n(Ae)&&n(Pe).find(Me=>Me.id===n(Ae))||null);function xe(Me){b(Ae,j((Me==null?void 0:Me.id)||null)),_("selectTrade",{trade:Me||null})}function ke(Me){b(De,j(Me)),n(Ae)&&(n(ge).some(X=>X.id===n(Ae))||b(Ae,null))}let He=oe(null),Ie=oe(!1);function ne(){var Me;try{(Me=n(He))==null||Me.scrollIntoView({behavior:"smooth",block:"center"}),b(Ie,!0),setTimeout(()=>b(Ie,!1),900)}catch{}}function J(Me){b(L,j(Me)),b(S,!0)}const qe=We(()=>{var Me;return n(P)&&Array.isArray((Me=r())==null?void 0:Me.equity)?r().equity:[]});let ft=oe("6m");function Qe(Me,Xe){var et;if(!Array.isArray(Me)||Me.length===0)return[];if(Xe==="all")return Me;const X=Number((et=Me[Me.length-1])==null?void 0:et.timestamp);if(!Number.isFinite(X)||X<=0)return Me;const nt=X-(Xe==="1m"?30:Xe==="3m"?90:180)*864e5;return Me.filter(ht=>Number(ht==null?void 0:ht.timestamp)>=nt)}const Oe=We(()=>Qe(n(qe),n(ft))),ct=We(()=>n(Oe).map(Me=>({index:Number(Me.index),ts:Number(Me.timestamp),equity:Number(Me.equity)})).filter(Me=>Number.isFinite(Me.index)&&Number.isFinite(Me.ts)&&Number.isFinite(Me.equity))),Lt=We(()=>{if(!n(ct).length)return[];let Me=-1/0;return n(ct).map(Xe=>{Me=Math.max(Me,Xe.equity);const X=Me>0?(Xe.equity-Me)/Me*100:0;return{index:Xe.index,ts:Xe.ts,ddPct:X}})});function It(Me,Xe){const X=Me.filter(ko=>Number.isFinite(ko));if(!X.length)return null;const Le=typeof Xe=="number"&&Number.isFinite(Xe)?Xe:Math.min(...X);let nt=Math.min(...X,Le),et=Math.max(...X,Le);if(!Number.isFinite(nt)||!Number.isFinite(et))return null;nt===et&&(nt-=1,et+=1);const ht=X.length,uo=ko=>ht<=1?0:ko/(ht-1)*100,ut=ko=>(1-(ko-nt)/(et-nt))*100,Jt=ut(Le),fo=X.map((ko,ts)=>({x:uo(ts),y:ut(ko)})),lo=fo.map((ko,ts)=>`${ts===0?"M":"L"} ${ko.x.toFixed(3)} ${ko.y.toFixed(3)}`).join(" "),so=[`M ${fo[0].x.toFixed(3)} ${Jt.toFixed(3)}`,...fo.map(ko=>`L ${ko.x.toFixed(3)} ${ko.y.toFixed(3)}`),`L ${fo[fo.length-1].x.toFixed(3)} ${Jt.toFixed(3)}`,"Z"].join(" ");return{line:lo,area:so,minY:nt,maxY:et,baselineY:Jt}}const zt=We(()=>It(n(ct).map(Me=>Me.equity))),pt=We(()=>It(n(Lt).map(Me=>Me.ddPct),0));function Mo(Me){const Xe=new Date(Me),X=Xe.getUTCFullYear(),Le=String(Xe.getUTCMonth()+1).padStart(2,"0");return`${X}-${Le}`}function Xo(Me){const Xe=new Date(Me),X=new Date(Date.UTC(Xe.getUTCFullYear(),Xe.getUTCMonth(),Xe.getUTCDate())),Le=X.getUTCDay()||7;X.setUTCDate(X.getUTCDate()+4-Le);const nt=new Date(Date.UTC(X.getUTCFullYear(),0,1)),et=Math.ceil(((X-nt)/864e5+1)/7);return`${X.getUTCFullYear()}-W${String(et).padStart(2,"0")}`}function en(Me,Xe){if(!(Me!=null&&Me.length))return[];const X=Xe==="month"?Mo:Xo,Le=new Map;for(const uo of Me){const ut=Number(uo==null?void 0:uo.timestamp),Jt=Number(uo==null?void 0:uo.equity),fo=Number(uo==null?void 0:uo.index);if(!Number.isFinite(ut)||!Number.isFinite(Jt)||!Number.isFinite(fo))continue;const lo=X(ut),so=Le.get(lo);so?so.last={ts:ut,eq:Jt,idx:fo}:Le.set(lo,{first:{ts:ut,eq:Jt,idx:fo},last:{ts:ut,eq:Jt,idx:fo}})}const nt=Array.from(Le.keys()).sort(),et=[];let ht=null;for(const uo of nt){const ut=Le.get(uo),Jt=Number(ut.last.eq);if(!Number.isFinite(Jt))continue;if(ht==null){ht=Jt;continue}const fo=ht!==0?(Jt-ht)/ht*100:0;et.push({key:uo,retPct:fo,from:ht,to:Jt,toIndex:Number(ut.last.idx),toTs:Number(ut.last.ts)}),ht=Jt}return et}const Fo=We(()=>en(n(qe),"month")),Eo=We(()=>en(n(qe),"week")),cs=We(()=>{const Me=new Map;for(const Xe of n(Pe)){const X=Number(Xe==null?void 0:Xe.exitTimestamp);if(!Number.isFinite(X)||X<=0)continue;const Le=Mo(X),nt=Me.get(Le)||{trades:0,wins:0,losses:0,net:0,fees:0},et=Number(Xe==null?void 0:Xe.netPnl)||0;nt.trades+=1,nt.net+=et,nt.fees+=Number(Xe==null?void 0:Xe.fees)||0,et>0?nt.wins+=1:et<0&&(nt.losses+=1),Me.set(Le,nt)}return Me}),Zt=We(()=>{const Me=new Map;for(const Xe of n(Pe)){const X=Number(Xe==null?void 0:Xe.exitTimestamp);if(!Number.isFinite(X)||X<=0)continue;const Le=Xo(X),nt=Me.get(Le)||{trades:0,wins:0,losses:0,net:0,fees:0},et=Number(Xe==null?void 0:Xe.netPnl)||0;nt.trades+=1,nt.net+=et,nt.fees+=Number(Xe==null?void 0:Xe.fees)||0,et>0?nt.wins+=1:et<0&&(nt.losses+=1),Me.set(Le,nt)}return Me}),bs=We(()=>{if(n(De).type==="all")return null;const Me=n(qe).map(ut=>({ts:Number(ut==null?void 0:ut.timestamp),eq:Number(ut==null?void 0:ut.equity)})).filter(ut=>Number.isFinite(ut.ts)&&Number.isFinite(ut.eq));if(!Me.length)return null;const Xe=n(De).type==="month"?Mo:Xo,X=Me.filter(ut=>Xe(ut.ts)===n(De).key);if(X.length<2)return{maxDrawdownPct:0,retPct:0};let Le=-1/0,nt=0;for(const ut of X){Le=Math.max(Le,ut.eq);const Jt=Le>0?(Le-ut.eq)/Le:0;Jt>nt&&(nt=Jt)}const et=X[0].eq,ht=X[X.length-1].eq,uo=et!==0?(ht-et)/et*100:0;return{maxDrawdownPct:nt*100,retPct:uo}});function es(Me){const Xe=X=>{const Le=X==null?"":String(X);return/[",\n]/.test(Le)?`"${Le.replace(/"/g,'""')}"`:Le};return Me.map(Xe).join(",")}function rn(Me,Xe,X){try{const Le=new Blob([Xe],{type:X}),nt=URL.createObjectURL(Le),et=document.createElement("a");et.href=nt,et.download=Me,document.body.appendChild(et),et.click(),et.remove(),setTimeout(()=>URL.revokeObjectURL(nt),2500)}catch{}}const wr=190,rr=58,ar=10;let jr=oe(null),ii=oe(null);const Xa=We(()=>{try{const Me=JSON.parse(String(t()||"").trim());return!!(Me!=null&&Me.pane||Me!=null&&Me.panes||Me!=null&&Me.main||Me!=null&&Me.sub)}catch{return!1}});Wi(()=>{n(ct),n(Lt),n(w),n(w)});function Ja(Me){if(!n(ct).length)return;const X=Me.currentTarget.getBoundingClientRect(),Le=Math.max(0,Math.min(wr,X.width-ar*2)),nt=Math.max(0,Math.min(rr,X.height-ar*2)),et=Math.max(0,Math.min(X.width,Me.clientX-X.left)),ht=Math.max(0,Math.min(X.height,Me.clientY-X.top)),uo=Math.round(et/Math.max(1,X.width)*(n(ct).length-1)),ut=n(ct)[uo];if(!ut)return;let Jt=et+12;Jt+Le+ar>X.width&&(Jt=et-12-Le),Jt=Math.max(ar,Math.min(Jt,X.width-Le-ar));let fo=ht-12-nt;fo<ar&&(fo=ht+12),fo=Math.max(ar,Math.min(fo,X.height-nt-ar)),b(jr,j({x:et,y:ht,left:Jt,top:fo,ts:ut.ts,equity:ut.equity}))}function Va(Me){if(!n(Lt).length)return;const X=Me.currentTarget.getBoundingClientRect(),Le=Math.max(0,Math.min(wr,X.width-ar*2)),nt=Math.max(0,Math.min(rr,X.height-ar*2)),et=Math.max(0,Math.min(X.width,Me.clientX-X.left)),ht=Math.max(0,Math.min(X.height,Me.clientY-X.top)),uo=Math.round(et/Math.max(1,X.width)*(n(Lt).length-1)),ut=n(Lt)[uo];if(!ut)return;let Jt=et+12;Jt+Le+ar>X.width&&(Jt=et-12-Le),Jt=Math.max(ar,Math.min(Jt,X.width-Le-ar));let fo=ht-12-nt;fo<ar&&(fo=ht+12),fo=Math.max(ar,Math.min(fo,X.height-nt-ar)),b(ii,j({x:et,y:ht,left:Jt,top:fo,ts:ut.ts,ddPct:ut.ddPct}))}const Wa=We(()=>String(t()||"").split(`
`)),Qa=We(()=>n(Wa).length||1);function qa(Me,Xe){let X=1,Le=1;for(let nt=0;nt<Xe&&nt<Me.length;nt+=1)Me[nt]===`
`?(X+=1,Le=1):Le+=1;return{line:X,col:Le}}function Kl(Me){try{return{ok:!0,value:JSON.parse(Me)}}catch(Xe){const X=String((Xe==null?void 0:Xe.message)||"Invalid JSON"),Le=X.match(/position\s+(\d+)/i),nt=Le?Number(Le[1]):null,et=typeof nt=="number"&&Number.isFinite(nt)?qa(Me,nt):void 0;return{ok:!1,error:{level:"error",message:X,hint:"Fix JSON syntax (quotes/commas/braces).",line:et==null?void 0:et.line,col:et==null?void 0:et.col}}}}function ll(){const Me=[],Xe=String(t()||"").trim();if(!Xe)return Me;if(/^\s*\/\/@\s*pine/m.test(Xe)||/\b(strategy|indicator)\s*\(/m.test(Xe)){try{const Le=s1(Xe);Le&&Le.ok===!1&&Array.isArray(Le.errors)&&Le.errors.length&&Le.errors.slice(0,12).forEach(nt=>{Me.push({level:"error",message:String((nt==null?void 0:nt.message)||"Pine error"),hint:"Fix the Pine line or use the Guide examples.",line:typeof(nt==null?void 0:nt.line)=="number"?nt.line:void 0,col:1})})}catch{}return Me}const X=Kl(Xe);if(!X.ok)return Me.push(X.error),Me;try{const Le=X.value;if(Le&&(Le.plots||Le.calc||Le.panes||Le.main||Le.sub)){const nt=Le&&typeof Le=="object"?Le.params||{}:{},et=jx(Le,nt),ht=$x(et);ht.ok||(ht.errors||[]).forEach(ro=>Me.push({level:"error",message:ro,hint:yt(ro)}));const uo=et.pane||et.plots||et.labels||et.levels||et.lines?{pane:et.pane||"main",plots:et.plots||[],labels:et.labels||[],levels:et.levels||[],lines:et.lines||[],min:et.min,max:et.max}:null,ut=[].concat(uo?[uo]:[]).concat(et.panes||[]).concat(et.main?[et.main]:[]).concat(et.sub?[et.sub]:[]),Jt=Array.isArray(et.calc)?et.calc:[],fo=Array.isArray(et.series)?et.series:[],lo=new Set(["open","high","low","close","volume"]);fo.forEach(ro=>{const Do=String((ro==null?void 0:ro.name)||"").replace(/\s+/g,"_").toLowerCase();Do&&lo.add(Do)}),Jt.forEach(ro=>{const Do=String((ro==null?void 0:ro.type)||(ro==null?void 0:ro.name)||"").toLowerCase(),Ao=String((ro==null?void 0:ro.name)||(ro==null?void 0:ro.type)||"").replace(/\s+/g,"_").toLowerCase();if(Qy.includes(Do)||Do&&Me.push({level:"error",message:`Unsupported calc type "${ro==null?void 0:ro.type}"`,hint:`Use one of: ${Array.from(Qy).join(", ")}`}),Do==="ema"){const ss=ro==null?void 0:ro.period;(typeof ss!="number"||!(ss>0))&&Me.push({level:"error",message:"EMA requires numeric period > 0",hint:'Add "period": e.g., 20'})}if(Do==="macd"){const ss=ds=>typeof ds=="number"&&ds>0;(!ss(ro==null?void 0:ro.fast)||!ss(ro==null?void 0:ro.slow)||!ss(ro==null?void 0:ro.signal))&&Me.push({level:"error",message:"MACD requires numeric fast/slow/signal",hint:'Add "fast":12, "slow":26, "signal":9'})}if(Do==="stoch"){const ss=ds=>typeof ds=="number"&&ds>0;(!ss(ro==null?void 0:ro.kPeriod)||!ss(ro==null?void 0:ro.dPeriod))&&Me.push({level:"error",message:"Stochastic requires kPeriod and dPeriod",hint:'Add "kPeriod":14, "dPeriod":3'})}Ao&&(Do==="bbands"||Do==="bollinger"||Do==="bollinger_bands"||Do==="kc"||Do==="keltner"||Do==="donchian"||Do==="linreg_channel"?(lo.add(`${Ao}_mid`),lo.add(`${Ao}_upper`),lo.add(`${Ao}_lower`)):Do==="atr_bands"?(lo.add(`${Ao}_upper`),lo.add(`${Ao}_lower`)):Do==="macd"?(lo.add("macd_line"),lo.add("macd_signal"),lo.add("macd_hist")):Do==="stoch"?(lo.add(`${Ao}_k`),lo.add(`${Ao}_d`)):Do==="ichimoku"?["tenkan","kijun","spana","spanb","chikou"].forEach(ss=>lo.add(ss)):lo.add(Ao))}),ut.forEach((ro,Do)=>{(ro.plots||[]).forEach((Ao,ss)=>{const ds=String((Ao==null?void 0:Ao.type)||"line").toLowerCase();e2.includes(ds)||Me.push({level:"warning",message:`Pane[${Do}] plot[${ss}] unsupported type "${Ao==null?void 0:Ao.type}"`,hint:`Supported: ${Array.from(e2).join(", ")}`});const Cs=String((Ao==null?void 0:Ao.source)||"").replace(/\s+/g,"_").toLowerCase();Cs&&!lo.has(Cs)&&Me.push({level:"error",message:`Pane[${Do}] plot[${ss}] source "${Ao==null?void 0:Ao.source}" not defined`,hint:"Define it in calc/series or use a valid alias."})}),(ro.labels||[]).forEach((Ao,ss)=>{const ds=String((Ao==null?void 0:Ao.shape)||"label");ds&&!t2.includes(ds)&&Me.push({level:"warning",message:`Pane[${Do}] label[${ss}] unsupported shape "${ds}"`,hint:`Supported: ${Array.from(t2).join(", ")}`}),Ao!=null&&Ao.shape||Me.push({level:"warning",message:`Pane[${Do}] label[${ss}] no shape set (default: label)`,hint:'Set "shape": triangle_up_filled, triangle_down_filled, label, pill, tag, flag'});const Cs=String((Ao==null?void 0:Ao.source)||"").replace(/\s+/g,"_").toLowerCase();Cs&&!["open","high","low","close","volume"].includes(Cs)&&!lo.has(Cs)&&Me.push({level:"error",message:`Pane[${Do}] label[${ss}] source "${Ao==null?void 0:Ao.source}" not defined`,hint:"Use high/low/open/close or a defined series"}),String((ro==null?void 0:ro.pane)||"main").toLowerCase()==="sub"&&(Cs==="high"||Cs==="low")&&Me.push({level:"warning",message:`Pane[${Do}] label[${ss}] anchors to price in sub pane`,hint:"Move label to main pane for price anchors"});const ns=String((Ao==null?void 0:Ao.when)||"");if(ns.trim())try{const Js=Mv(ns),Nn=[],ui=Ms=>{!Ms||typeof Ms!="object"||(Ms.kind==="SeriesRef"&&Nn.push(String(Ms.name||"")),Object.values(Ms).forEach(ui))};ui(Js),Nn.forEach(Ms=>{const Li=Ms.replace(/\s+/g,"_").toLowerCase();!lo.has(Li)&&!["open","high","low","close","volume"].includes(Li)&&Me.push({level:"warning",message:`Label[${Do}:${ss}] references unknown series "${Ms}"`,hint:"Define via calc/series or use a base series (open/high/low/close/volume)."})})}catch(Js){const Nn=(Js==null?void 0:Js.position)!=null?` at ${Js.position}`:"",ui=Js instanceof rv?Js.message:String(Js),Ms=typeof(Js==null?void 0:Js.position)=="number"?qa(Xe,Js.position):void 0;Me.push({level:"error",message:`Label[${Do}:${ss}] condition parse failed${Nn}: ${ui}`,hint:"Use crossover(a,b), crossunder(a,b), between(x,a,b). Ensure series names exist.",line:Ms==null?void 0:Ms.line,col:Ms==null?void 0:Ms.col})}})});const so=new Set;ut.forEach(ro=>{(ro.plots||[]).forEach(Do=>{const Ao=String((Do==null?void 0:Do.source)||"").replace(/\s+/g,"_").toLowerCase();Ao&&so.add(Ao)}),(ro.labels||[]).forEach(Do=>{const Ao=String((Do==null?void 0:Do.source)||"").replace(/\s+/g,"_").toLowerCase();Ao&&so.add(Ao);const ss=String((Do==null?void 0:Do.when)||"");try{const ds=Mv(ss),Cs=[],ns=Js=>{!Js||typeof Js!="object"||(Js.kind==="SeriesRef"&&Cs.push(String(Js.name||"")),Object.values(Js).forEach(ns))};ns(ds),Cs.forEach(Js=>so.add(Js.replace(/\s+/g,"_").toLowerCase()))}catch{}}),(ro.lines||[]).forEach(Do=>{const Ao=String((Do==null?void 0:Do.segmentsFrom)||"").replace(/\s+/g,"_").toLowerCase();Ao&&so.add(Ao);const ss=String((Do==null?void 0:Do.start)||"").replace(/\s+/g,"_").toLowerCase();ss&&so.add(ss);const ds=String((Do==null?void 0:Do.end)||"").replace(/\s+/g,"_").toLowerCase();ds&&so.add(ds)})}),(Array.isArray(Le.signals)?Le.signals:[]).forEach(ro=>{const Do=String((ro==null?void 0:ro.when)||"");try{const Ao=Mv(Do),ss=[],ds=Cs=>{!Cs||typeof Cs!="object"||(Cs.kind==="SeriesRef"&&ss.push(String(Cs.name||"")),Object.values(Cs).forEach(ds))};ds(Ao),ss.forEach(Cs=>so.add(Cs.replace(/\s+/g,"_").toLowerCase()))}catch{}});const ts=fo.map(ro=>String((ro==null?void 0:ro.expr)||"")).join(" ").replace(/\s+/g," ").toLowerCase(),Xn=(ro,Do)=>{const Ao=ro.toLowerCase(),ss=Do;return Ao==="bbands"||Ao==="bollinger"||Ao==="bollinger_bands"||Ao==="kc"||Ao==="keltner"||Ao==="donchian"||Ao==="linreg_channel"?[`${ss}_mid`,`${ss}_upper`,`${ss}_lower`]:Ao==="atr_bands"?[`${ss}_upper`,`${ss}_lower`]:Ao==="stoch"?[`${ss}_k`,`${ss}_d`]:Ao==="macd"?["macd_line","macd_signal","macd_hist"]:Ao==="ichimoku"?["tenkan","kijun","spana","spanb","chikou"]:[ss]};return Jt.forEach(ro=>{const Do=String((ro==null?void 0:ro.name)||(ro==null?void 0:ro.type)||"").replace(/\s+/g,"_").toLowerCase();if(Do&&!so.has(Do)){const Ao=String((ro==null?void 0:ro.type)||""),ss=Xn(Ao,Do);if(!ss.some(Cs=>so.has(Cs))){const Cs=ts&&new RegExp(`\\b${Do.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")}\\b`,"i").test(ts),ns=ts&&ss.some(Js=>new RegExp(`\\b${Js.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\\\$&")}\\b`,"i").test(ts));if(Cs||ns)return;Me.push({level:"warning",message:`Calc "${Ao}" (${Do}) is defined but not used`,hint:"Reference it in plots or label conditions"})}}}),Me}}catch{Me.push({level:"warning",message:"Non‑JSON script detected",hint:"Use JSON spec or the DSL examples from Guide. If JSON, ensure valid commas/quotes/braces.",line:1,col:1})}return Me}const Wr=We(ll),Ca=We(()=>n(Wr).filter(Me=>Me.level==="error").length),vl=We(()=>n(Wr).filter(Me=>Me.level==="warning").length),ml=We(()=>n(Wr).length),Sl=We(()=>n(Ca)>0?"Errors":n(vl)>0?"Warnings":"Issues"),el=We(()=>i()?`Error: ${i()}`:l()?"Running…":s()?s():"Ready"),or=(Me,Xe=2)=>Number.isFinite(Me)?Me.toFixed(Xe):"—",tc=(Me,Xe=2,X=8)=>{if(!Number.isFinite(Me))return"—";const Le=Math.abs(Me);if(Le===0||Le>=1)return Me.toFixed(Xe);const nt=Math.ceil(-Math.log10(Le)),et=Math.max(Xe,Math.min(X,Xe+nt));return Me.toFixed(et)},pe=Me=>tc(Me,2,6),rt=Me=>tc(Me,2,10),Ft=Me=>tc(Me,6,10),Qt=(Me,Xe=2)=>{const X=typeof Me=="number"?Me:Number(Me);return Number.isFinite(X)?or(X,Xe):"—"},xt=Me=>{const Xe=typeof Me=="number"?Me:Number(Me);return Number.isFinite(Xe)?pe(Xe):"—"},eo=Me=>{const Xe=typeof Me=="number"?Me:Number(Me);return Number.isFinite(Xe)?rt(Xe):"—"},Is=Me=>{const Xe=typeof Me=="number"?Me:Number(Me);return Number.isFinite(Xe)?Ft(Xe):"—"},Po=Me=>{const Xe=typeof Me=="number"?Me:Number(Me);return Number.isFinite(Xe)?Ze(Xe):"—"},Ze=Me=>`${or(Me,2)}%`,Ke=Me=>Me===1/0?"∞":or(Me,2),ps=We(()=>n(Wr).filter(Me=>typeof Me.line=="number").map(Me=>({line:Me.line,col:Me.col,level:Me.level}))),pn=We(()=>{const Me=String(t()||"").split(`
`),Xe=new Map;n(ps).forEach(Le=>{Xe.has(Le.line)||Xe.set(Le.line,[]),Xe.get(Le.line).push({col:Le.col,level:Le.level})});const X=Le=>Le.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return Me.map((Le,nt)=>{const et=nt+1,ht=Xe.get(et)||[],uo=ht.some(so=>!so.col),ut=X(Le||" ");if(uo)return`<div class="code-line"><mark class="err err-${ht[0].level}">${ut}</mark></div>`;if(!ht.length)return`<div class="code-line"><span>${ut}</span></div>`;const Jt=ht.filter(so=>typeof so.col=="number"&&so.col>0).sort((so,ko)=>so.col-ko.col);let fo="",lo=0;return Jt.forEach((so,ko)=>{const ts=Math.max(0,so.col-1);ts>lo&&(fo+=X(Le.slice(lo,ts))),fo+=`<mark class="err err-${so.level}">${X(Le.slice(ts))||"&nbsp;"}</mark>`,lo=Le.length}),lo<Le.length&&(fo+=X(Le.slice(lo))),`<div class="code-line"><span>${fo||"&nbsp;"}</span></div>`}).join("")});let Jo=oe(void 0),ti=oe(void 0),mr=oe(void 0);function sa(){var X,Le;const Me=((X=n(Jo))==null?void 0:X.scrollTop)??0,Xe=((Le=n(Jo))==null?void 0:Le.scrollLeft)??0;n(ti)&&(n(ti).scrollTop=Me,n(ti).scrollLeft=Xe),n(mr)&&(n(mr).scrollTop=Me)}function yt(Me){const Xe=Me.toLowerCase();return Xe.includes("no panes defined")?'Add pane:"main" or {main:{...}} with plots/labels.':Xe.includes("has no plots/labels/levels/lines")?"Add at least one plot or label in the pane.":Xe.includes("series")?"Check series names and expressions; use normalized aliases like macd_line.":"Review field names/types; see Guide examples."}$0();var wt=WW(),to=g(wt);to.__pointerdown=[HO];var mt=u(g(to),2),Wt=g(mt),vt=g(Wt);vt.__click=[GO,w];var $t=u(vt,2);$t.__click=[YO,w];var zo=g($t),bo=g(zo,!0);f(zo);var xo=u(zo,2);Se(xo,()=>n(ml),Me=>{var Xe=UO(),X=g(Xe,!0);f(Xe),we(()=>{Pn(Xe,`err-badge ${(n(Ca)===0&&n(vl)>0?"warn":"")??""} svelte-za388g`),Ye(X,n(ml))}),O(Me,Xe)}),f($t);var Zo=u($t,2);Zo.__click=[KO,w],f(Wt),f(mt);var os=u(mt,2),ri=g(os);Se(ri,()=>!n(Xa),Me=>{var Xe=JO(),X=g(Xe);X.__click=[ZO,y];var Le=u(X,2);Le.__click=[XO,y],f(Xe),we(()=>{Sn(X,"active",v()==="main"),Sn(Le,"active",v()==="sub")}),O(Me,Xe)});var vn=u(ri,2);vn.__click=[OO,k,_];var sr=u(g(vn),2),Ko=g(sr);f(sr),f(vn);var Hn=u(vn,2);Hn.__click=[RO,_];var ji=u(Hn,2);ji.__click=[BO,_,t];var zn=u(ji,2);zn.__click=[zO,_];var Vs=u(zn,2);Vs.__click=[jO,_,t,le];var Bn=u(g(Vs),2),tr=g(Bn,!0);f(Bn),f(Vs);var lr=u(Vs,2);Se(lr,()=>!n(T),Me=>{var Xe=QO();Xe.__click=[VO,T,_],O(Me,Xe)},Me=>{var Xe=eV();Xe.__click=A,O(Me,Xe)});var Ui=u(lr,2);Ui.__click=[NO,T,_],f(os),f(to);var _a=u(to,2);Se(_a,()=>n(w)==="editor",Me=>{var Xe=pV(),X=g(Xe),Le=g(X),nt=g(Le),et=g(nt),ht=u(g(et),4),uo=g(ht);f(ht),f(et),un(2),f(nt);var ut=u(nt,2),Jt=g(ut);Ns(Jt,21,()=>n(Wa),dn,(ro,Do,Ao)=>{var ss=tV();ss.textContent=Ao+1,O(ro,ss)}),f(Jt),Ec(Jt,ro=>b(mr,ro),()=>n(mr));var fo=u(Jt,2),lo=g(fo),so=g(lo),ko=g(so);t3(ko,()=>n(pn)),f(so),un(2),f(lo),Ec(lo,ro=>b(ti,ro),()=>n(ti));var ts=u(lo,2);Tw(ts),ts.__input=sa,Ec(ts,ro=>b(Jo,ro),()=>n(Jo)),f(fo),f(ut),f(Le);var Xn=u(Le,2);Se(Xn,()=>n(Z).length,ro=>{var Do=uV(),Ao=g(Do),ss=u(g(Ao),4);Se(ss,()=>n(G).length,Cs=>{var ns=sV();Ns(ns,21,()=>n(G).slice(0,3),Js=>Js.message,(Js,Nn)=>{var ui=oV(),Ms=g(ui);f(ui),we(()=>Ye(Ms,`Line ${n(Nn).line??""}: ${n(Nn).message??""}`)),O(Js,ui)}),f(ns),O(Cs,ns)});var ds=u(ss,2);Ns(ds,21,()=>n(Z),Cs=>Cs.name,(Cs,ns)=>{var Js=dV(),Nn=g(Js),ui=g(Nn),Ms=g(ui,!0);f(ui);var Li=u(ui,2),Dr=g(Li,!0);f(Li),f(Nn);var Xr=u(Nn,2),Ki=g(Xr);Se(Ki,()=>n(ns).type==="bool",Ge=>{var at=iV(),So=g(at);Vt(So),we(()=>tp(So,!!n(se)[n(ns).name])),So.__change=[nV,ie,ns],un(2),f(at),O(Ge,at)},Ge=>{var at=Xt(),So=_t(at);Se(So,()=>n(ns).type==="string",qt=>{var Io=aV();Vt(Io),we(()=>Vu(Io,String(n(se)[n(ns).name]??""))),Io.__input=[rV,ie,ns],O(qt,Io)},qt=>{var Io=cV();Vt(Io),we(()=>Vu(Io,Number(n(se)[n(ns).name]??n(ns).defval))),Io.__input=[lV,ie,ns],we(()=>{St(Io,"step",n(ns).step??(n(ns).type==="int"?1:.01)),St(Io,"min",n(ns).minval),St(Io,"max",n(ns).maxval)}),O(qt,Io)},!0),O(Ge,at)}),f(Xr),f(Js),we(()=>{Ye(Ms,n(ns).title||n(ns).name),Ye(Dr,n(ns).name)}),O(Cs,Js)}),f(ds),un(2),f(Ao),f(Do),O(ro,Do)}),f(X),f(Xe),we(()=>Ye(uo,`Lines: ${n(Qa)??""}`)),Fl("scroll",ts,sa),go(ts,t),O(Me,Xe)},Me=>{var Xe=Xt(),X=_t(Xe);Se(X,()=>n(w)==="errors",Le=>{var nt=_V(),et=g(nt);Se(et,()=>n(Wr).length===0,ht=>{var uo=vV();O(ht,uo)},ht=>{var uo=hV(),ut=_t(uo),Jt=g(ut),fo=g(Jt);f(Jt),un(2),f(ut);var lo=u(ut,2);Ns(lo,21,()=>n(Wr),dn,(so,ko)=>{var ts=mV(),Xn=u(g(ts),2),ro=g(Xn);Se(ro,()=>n(ko).line,ss=>{var ds=fV(),Cs=g(ds),ns=u(Cs);Se(ns,()=>n(ko).col,Js=>{var Nn=Np();we(()=>Ye(Nn,`· Col ${n(ko).col??""}`)),O(Js,Nn)}),un(),f(ds),we(()=>Ye(Cs,`Line ${n(ko).line??""}`)),O(ss,ds)});var Do=u(ro);f(Xn);var Ao=u(Xn,2);Se(Ao,()=>n(ko).hint,ss=>{var ds=gV(),Cs=g(ds);f(ds),we(()=>Ye(Cs,`— ${n(ko).hint??""}`)),O(ss,ds)}),f(ts),we(()=>{Pn(ts,`${`diag-item ${n(ko).level}`??""} svelte-za388g`),Ye(Do,` ${n(ko).message??""}`)}),O(so,ts)}),f(lo),we(()=>Ye(fo,`Errors (${(n(Ca)||0)??""})`)),O(ht,uo)}),f(nt),O(Le,nt)},Le=>{var nt=VW(),et=g(nt);Se(et,()=>n(S),uo=>{var ut=$V();ut.__click=[a2,S];var Jt=g(ut);Jt.__click=[yV];var fo=g(Jt),lo=u(g(fo),2),so=g(lo),ko=g(so);ko.__click=[bV,L];var ts=u(ko,2);ts.__click=[xV,L],f(so);var Xn=u(so,2);Xn.__click=[a2,S],f(lo),f(fo);var ro=u(fo,2),Do=g(ro);Se(Do,()=>n(L)==="trades",Ao=>{var ss=AV(),ds=_t(ss),Cs=g(ds),ns=g(Cs),Js=u(g(ns)),Nn=g(Js);f(Js),f(ns),f(Cs);var ui=u(Cs,2),Ms=g(ui);Se(Ms,()=>n(De).type!=="all",Xr=>{var Ki=kV();Ki.__click=[wV,ke],O(Xr,Ki)});var Li=u(Ms,2);Li.__click=[l2,es,Pe,rn],f(ui),f(ds);var Dr=u(ds,2);Se(Dr,()=>n(Ce).length,Xr=>{var Ki=MV(),Ge=g(Ki),at=u(g(Ge));Ns(at,21,()=>n(Ce),So=>So.id,(So,qt)=>{var Io=IV();Io.__click=[SV,xe,qt],Io.__keydown=[CV,xe,qt];var us=g(Io),fn=g(us);fn.__click=[PV,xe,qt],f(us);var Ts=u(us),js=g(Ts),on=g(js,!0);f(js),f(Ts);var _s=u(Ts),In=g(_s,!0);we(()=>Ye(In,Is(n(qt).qty))),f(_s);var Ci=u(_s);const zr=We(()=>n(qt).entryIndex??""),ca=We(()=>_e(n(qt).entryTimestamp)??""),hl=We(()=>eo(n(qt).entryPrice)??"");var fa=g(Ci);we(()=>Ye(fa,`#${n(zr)} • ${n(ca)} • ${n(hl)}`)),f(Ci);var za=u(Ci);const oc=We(()=>n(qt).exitIndex??""),sc=We(()=>_e(n(qt).exitTimestamp)??""),Cl=We(()=>eo(n(qt).exitPrice)??"");var Vl=g(za);we(()=>Ye(Vl,`#${n(oc)} • ${n(sc)} • ${n(Cl)}`)),f(za);var ul=u(za);const nc=We(()=>(Number(n(qt).netPnl)>=0?"+":"")??""),vc=We(()=>xt(n(qt).netPnl)??"");var Zl=g(ul);we(()=>Ye(Zl,`${n(nc)}${n(vc)}`)),f(ul);var Ha=u(ul),qc=g(Ha,!0);we(()=>Ye(qc,xt(n(qt).fees))),f(Ha);var _c=u(Ha);const ld=We(()=>(Number(n(qt).pnl)>=0?"+":"")??""),Od=We(()=>xt(n(qt).pnl)??"");var Hc=g(_c);we(()=>Ye(Hc,`${n(ld)}${n(Od)}`)),f(_c);var fl=u(_c),tl=g(fl,!0);we(()=>Ye(tl,Po(n(qt).pnlPct))),f(fl);var hd=u(fl);const Rc=We(()=>(Number(n(qt).cumNet)>=0?"+":"")??""),iu=We(()=>xt(n(qt).cumNet)??"");var Iu=g(hd);we(()=>Ye(Iu,`${n(Rc)}${n(iu)}`)),f(hd);var uu=u(hd),Vd=g(uu,!0);f(uu);var ru=u(uu),qu=g(ru,!0);we(()=>Ye(qu,n(qt).maePct==null?"-":Po(n(qt).maePct))),f(ru);var Mu=u(ru),Ad=g(Mu,!0);we(()=>Ye(Ad,n(qt).mfePct==null?"-":Po(n(qt).mfePct))),f(Mu),f(Io),we(()=>{Sn(Io,"selected",n(Ae)===n(qt).id),Sn(Io,"pos",n(qt).netPnl>=0),Sn(Io,"neg",n(qt).netPnl<0),Ye(on,n(qt).side),Ye(Vd,n(qt).exitReason)}),O(So,Io)}),f(at),f(Ge),f(Ki),O(Xr,Ki)},Xr=>{var Ki=TV();O(Xr,Ki)}),we(()=>Ye(Nn,`(${n(ge).length??""}/${n(Pe).length??""})`)),O(Ao,ss)},Ao=>{var ss=EV(),ds=_t(ss),Cs=u(g(ds),2),ns=g(Cs),Js=u(ns);Se(Js,()=>n(ze).length>500,Ms=>{var Li=Np("• Showing last 500");O(Ms,Li)}),f(Cs);var Nn=u(Cs,2);Nn.__click=[c2,es,ze,rn],f(ds);var ui=u(ds,2);Se(ui,()=>n(ze).length,Ms=>{var Li=FV(),Dr=g(Li),Xr=u(g(Dr));Ns(Xr,21,()=>n(he),Ki=>Ki.id,(Ki,Ge)=>{var at=LV(),So=g(at),qt=g(So,!0);f(So);var Io=u(So),us=g(Io,!0);f(Io);var fn=u(Io),Ts=g(fn,!0);f(fn);var js=u(fn),on=g(js,!0);f(js);var _s=u(js),In=g(_s,!0);f(_s);var Ci=u(_s),zr=g(Ci);we(()=>Ye(zr,`#${n(Ge).createdIndex??""} • ${_e(n(Ge).createdTimestamp)??""}`)),f(Ci);var ca=u(Ci),hl=g(ca,!0);we(()=>Ye(hl,Qt(n(Ge).qtyPct,2))),f(ca);var fa=u(ca),za=g(fa,!0);we(()=>Ye(za,eo(n(Ge).price))),f(fa);var oc=u(fa),sc=g(oc,!0);we(()=>Ye(sc,eo(n(Ge).stopPrice))),f(oc);var Cl=u(oc),Vl=g(Cl,!0);we(()=>Ye(Vl,eo(n(Ge).limitPrice))),f(Cl);var ul=u(Cl),nc=g(ul,!0);we(()=>Ye(nc,n(Ge).filledIndex==null?"-":`#${n(Ge).filledIndex} • ${_e(n(Ge).filledTimestamp)}`)),f(ul);var vc=u(ul),Zl=g(vc,!0);we(()=>Ye(Zl,Is(n(Ge).fillQty))),f(vc);var Ha=u(vc),qc=g(Ha,!0);we(()=>Ye(qc,eo(n(Ge).fillPrice))),f(Ha);var _c=u(Ha),ld=g(_c,!0);we(()=>Ye(ld,xt(n(Ge).fees))),f(_c);var Od=u(_c),Hc=g(Od,!0);f(Od);var fl=u(Od),tl=g(fl,!0);f(fl);var hd=u(fl),Rc=g(hd,!0);f(hd),f(at),we(()=>{Ye(qt,n(Ge).id),Ye(us,n(Ge).action),Ye(Ts,n(Ge).side),Ye(on,n(Ge).kind),Ye(In,n(Ge).status),Ye(Hc,n(Ge).ocoGroup||"-"),Ye(tl,n(Ge).signalId||"-"),Ye(Rc,n(Ge).note||"-")}),O(Ki,at)}),f(Xr),f(Dr),f(Li),O(Ms,Li)},Ms=>{var Li=DV();O(Ms,Li)}),we(()=>Ye(ns,`Rows ${n(ze).length??""}`)),O(Ao,ss)}),f(ro),f(Jt),f(ut),we(()=>{Sn(ko,"active",n(L)==="trades"),Sn(ts,"active",n(L)==="orders")}),O(uo,ut)});var ht=u(et,2);Se(ht,()=>!n(Y),uo=>{var ut=Xt(),Jt=_t(ut);Se(Jt,()=>!n(V),fo=>{var lo=BV(),so=g(lo);Se(so,()=>n(N)||n($),ko=>{var ts=jV();un(4),O(ko,ts)},ko=>{var ts=zV();un(4),O(ko,ts)}),f(lo),O(fo,lo)},fo=>{var lo=Xt(),so=_t(lo);Se(so,()=>!n(U),ko=>{var ts=OV(),Xn=g(ts);Se(Xn,()=>n(N)||n($),ro=>{var Do=NV();un(4),O(ro,Do)},ro=>{var Do=RV();un(4),O(ro,Do)}),f(ts),O(ko,ts)},ko=>{var ts=qV(),Xn=g(ts);Se(Xn,l,Do=>{var Ao=Np("Running… please wait.");O(Do,Ao)},Do=>{var Ao=VV();un(2),O(Do,Ao)});var ro=u(Xn,2);Se(ro,()=>n(N)||n($),Do=>{var Ao=WV(),ss=g(Ao);f(Ao),we(()=>Ye(ss,`Pine parsed: strategy ${(n(N)?"yes":"no")??""} • signals ${(n($)?"yes":"no")??""}`)),O(Do,Ao)}),f(ts),O(ko,ts)},!0),O(fo,lo)}),O(uo,ut)},uo=>{var ut=OW(),Jt=_t(ut),fo=u(g(Jt),2);const lo=We(()=>or(n(Y).finalEquity,2)??""),so=We(()=>or(n(Y).netPnl,2)??""),ko=We(()=>Ze(n(Y).netPnlPct)??"");var ts=g(fo);we(()=>Ye(ts,`Equity: ${n(lo)} • Net: ${n(so)} (${n(ko)})`)),f(fo),f(Jt);var Xn=u(Jt,2),ro=g(Xn),Do=u(g(ro)),Ao=g(Do,!0);f(Do);var ss=u(Do,2),ds=g(ss);f(ss),f(ro);var Cs=u(ro,2);Se(Cs,()=>n(K).lastTs,oo=>{var Yt=HV(),Ht=u(g(Yt)),To=g(Ht,!0);we(()=>Ye(To,new Date(n(K).lastTs).toISOString().slice(0,10))),f(Ht),f(Yt),O(oo,Yt)}),f(Xn);var ns=u(Xn,2),Js=g(ns),Nn=u(g(Js),2),ui=g(Nn,!0);f(Nn);var Ms=u(Nn,2),Li=g(Ms),Dr=u(Li);Se(Dr,()=>n(Y).roundTrips!=null,oo=>{var Yt=Np();we(()=>Ye(Yt,`• Positions ${n(Y).roundTrips??""}`)),O(oo,Yt)}),f(Ms),f(Js);var Xr=u(Js,2),Ki=u(g(Xr),2),Ge=g(Ki,!0);we(()=>Ye(Ge,Ze(n(Y).winRate))),f(Ki);var at=u(Ki,2),So=g(at);we(()=>Ye(So,`Max DD ${Ze(n(Y).maxDrawdownPct)??""}`)),f(at),f(Xr);var qt=u(Xr,2),Io=u(g(qt),2),us=g(Io);we(()=>Ye(us,`${(n(Y).netPnl>=0?"+":"")??""}${or(n(Y).netPnl,2)??""}`)),f(Io);var fn=u(Io,2);const Ts=We(()=>Ze(n(Y).netPnlPct)??""),js=We(()=>or(n(Y).feesPaid,2)??""),on=We(()=>Ke(n(Y).profitFactor)??"");var _s=g(fn);we(()=>Ye(_s,`${n(Ts)} • Fees ${n(js)} • PF ${n(on)}`)),f(fn),f(qt);var In=u(qt,2),Ci=u(g(In),2),zr=g(Ci);we(()=>Ye(zr,`${(n(Y).expectancy>=0?"+":"")??""}${or(n(Y).expectancy??0,2)??""}`)),f(Ci);var ca=u(Ci,2);const hl=We(()=>or(n(Y).avgTrade??0,2)??""),fa=We(()=>Ke(n(Y).payoffRatio??0)??""),za=We(()=>n(Y).maxConsecWins??0??""),oc=We(()=>n(Y).maxConsecLosses??0??"");var sc=g(ca);we(()=>Ye(sc,`Avg ${n(hl)} • Payoff ${n(fa)} • Streak W ${n(za)}/L ${n(oc)}`)),f(ca),f(In),f(ns);var Cl=u(ns,2);Se(Cl,()=>n(Y).trades===0,oo=>{var Yt=UV(),Ht=u(g(Yt),2),To=g(Ht);Se(To,()=>n(K).total===0,vo=>{var Ot=GV();un(2),O(vo,Ot)},vo=>{var Ot=YV();un(2),O(vo,Ot)}),f(Ht),f(Yt),O(oo,Yt)});var Vl=u(Cl,2),ul=u(g(Vl),2),nc=g(ul);nc.__click=[KV,ft];var vc=u(nc,2);vc.__click=[ZV,ft];var Zl=u(vc,2);Zl.__click=[XV,ft];var Ha=u(Zl,2);Ha.__click=[JV,ft],f(ul),f(Vl);var qc=u(Vl,2),_c=g(qc),ld=g(_c),Od=u(g(ld),2),Hc=g(Od);Se(Hc,()=>n(ct).length,oo=>{var Yt=Np();const Ht=We(()=>or(n(ct)[0].equity,2)??""),To=We(()=>or(n(ct)[n(ct).length-1].equity,2)??"");we(()=>Ye(Yt,`${n(Ht)} → ${n(To)}`)),O(oo,Yt)}),f(Od),f(ld);var fl=u(ld,2);fl.__pointermove=Ja;var tl=g(fl);Se(tl,()=>n(zt),oo=>{var Yt=QV(),Ht=_t(Yt),To=g(Ht),vo=u(To);un(3),f(Ht);var Ot=u(Ht,2),Yo=g(Ot,!0);we(()=>Ye(Yo,or(n(zt).maxY,2))),f(Ot);var is=u(Ot,2),vs=g(is,!0);we(()=>Ye(vs,or(n(zt).minY,2))),f(is),we(()=>{St(To,"d",n(zt).area),St(vo,"d",n(zt).line)}),O(oo,Yt)},oo=>{var Yt=eW();O(oo,Yt)});var hd=u(tl,2);Se(hd,()=>n(jr),oo=>{var Yt=tW(),Ht=_t(Yt),To=u(Ht,2),vo=u(To,2),Ot=g(vo),Yo=g(Ot,!0);we(()=>Ye(Yo,new Date(n(jr).ts).toISOString().slice(0,10))),f(Ot);var is=u(Ot,2),vs=u(g(is)),Rs=g(vs,!0);we(()=>Ye(Rs,or(n(jr).equity,2))),f(vs),f(is),f(vo),we(()=>{St(Ht,"style",`left:${n(jr).x}px;`),St(To,"style",`top:${n(jr).y}px;`),St(vo,"style",`left:${n(jr).left}px; top:${n(jr).top}px;`)}),O(oo,Yt)}),f(fl),f(_c);var Rc=u(_c,2),iu=g(Rc),Iu=u(g(iu),2),uu=g(Iu);we(()=>Ye(uu,`Max ${Ze(n(Y).maxDrawdownPct)??""}`)),f(Iu),f(iu);var Vd=u(iu,2);Vd.__pointermove=Va;var ru=g(Vd);Se(ru,()=>n(pt),oo=>{var Yt=oW(),Ht=_t(Yt),To=g(Ht),vo=u(To);un(3),f(Ht);var Ot=u(Ht,2),Yo=g(Ot);we(()=>Ye(Yo,`${or(n(pt).maxY,2)??""}%`)),f(Ot);var is=u(Ot,2),vs=g(is);we(()=>Ye(vs,`${or(n(pt).minY,2)??""}%`)),f(is),we(()=>{St(To,"d",n(pt).area),St(vo,"d",n(pt).line)}),O(oo,Yt)},oo=>{var Yt=sW();O(oo,Yt)});var qu=u(ru,2);Se(qu,()=>n(ii),oo=>{var Yt=nW(),Ht=_t(Yt),To=u(Ht,2),vo=u(To,2),Ot=g(vo),Yo=g(Ot,!0);we(()=>Ye(Yo,new Date(n(ii).ts).toISOString().slice(0,10))),f(Ot);var is=u(Ot,2),vs=u(g(is)),Rs=g(vs,!0);we(()=>Ye(Rs,Ze(n(ii).ddPct))),f(vs),f(is),f(vo),we(()=>{St(Ht,"style",`left:${n(ii).x}px;`),St(To,"style",`top:${n(ii).y}px;`),St(vo,"style",`left:${n(ii).left}px; top:${n(ii).top}px;`)}),O(oo,Yt)}),f(Vd),f(Rc),f(qc);var Mu=u(qc,2),Ad=g(Mu),_d=g(Ad),Bs=u(g(_d),2);Bs.__click=ne,f(_d);var bp=u(_d,4);Se(bp,()=>n(Fo).length,oo=>{var Yt=lW(),Ht=u(g(Yt),2);Ns(Ht,17,()=>n(Fo).slice(n(Fo).length-12),dn,(To,vo)=>{var Ot=aW();we(()=>St(Ot,"title",(()=>{const Ws=n(cs).get(n(vo).key)||null;if(!Ws)return"Click to filter trades by this month";const li=Ws.trades?Ws.wins/Ws.trades*100:0,an=Ws.net>=0?`+${or(Ws.net,2)}`:`${or(Ws.net,2)}`;return`Trades ${Ws.trades} • Win ${Ze(li)} • Net ${an} • Fees ${or(Ws.fees,2)} • Click to filter`})())),Ot.__click=[iW,ke,vo,_,ne],Ot.__keydown=[rW,ke,vo,_,ne];var Yo=g(Ot),is=g(Yo,!0);f(Yo);var vs=u(Yo,2),Rs=g(vs);we(()=>Ye(Rs,`${(n(vo).retPct>=0?"+":"")??""}${Ze(n(vo).retPct)??""}`)),f(vs),f(Ot),we(()=>{Pn(Ot,`${`rt-row ${n(vo).retPct>=0?"pos":"neg"} ${n(De).type==="month"&&n(De).key===n(vo).key?"active":""}`??""} svelte-za388g`),Ye(is,n(vo).key)}),O(To,Ot)}),f(Yt),O(oo,Yt)},oo=>{var Yt=cW();O(oo,Yt)}),f(Ad);var xp=u(Ad,2),Xc=g(xp),sp=u(g(Xc),2);sp.__click=ne,f(Xc);var wp=u(Xc,4);Se(wp,()=>n(Eo).length,oo=>{var Yt=vW(),Ht=u(g(Yt),2);Ns(Ht,17,()=>n(Eo).slice(n(Eo).length-12),dn,(To,vo)=>{var Ot=pW();we(()=>St(Ot,"title",(()=>{const Ws=n(Zt).get(n(vo).key)||null;if(!Ws)return"Click to filter trades by this week";const li=Ws.trades?Ws.wins/Ws.trades*100:0,an=Ws.net>=0?`+${or(Ws.net,2)}`:`${or(Ws.net,2)}`;return`Trades ${Ws.trades} • Win ${Ze(li)} • Net ${an} • Fees ${or(Ws.fees,2)} • Click to filter`})())),Ot.__click=[dW,ke,vo,_,ne],Ot.__keydown=[uW,ke,vo,_,ne];var Yo=g(Ot),is=g(Yo,!0);f(Yo);var vs=u(Yo,2),Rs=g(vs);we(()=>Ye(Rs,`${(n(vo).retPct>=0?"+":"")??""}${Ze(n(vo).retPct)??""}`)),f(vs),f(Ot),we(()=>{Pn(Ot,`${`rt-row ${n(vo).retPct>=0?"pos":"neg"} ${n(De).type==="week"&&n(De).key===n(vo).key?"active":""}`??""} svelte-za388g`),Ye(is,n(vo).key)}),O(To,Ot)}),f(Yt),O(oo,Yt)},oo=>{var Yt=fW();O(oo,Yt)}),f(xp),f(Mu);var pu=u(Mu,2),Kp=g(pu);Kp.__click=[gW,J];var vu=u(Kp,2);vu.__click=[mW,J];var yd=u(vu,2);yd.__click=[l2,es,Pe,rn];var kp=u(yd,2);Se(kp,()=>n(De).type!=="all",oo=>{var Yt=hW();Yt.__click=[d2,es,ge,De,rn],O(oo,Yt)});var Sp=u(kp,2);Sp.__click=[c2,es,ze,rn];var Zp=u(Sp,2);Zp.__click=[qO,es,qe,rn],f(pu);var np=u(pu,2),ip=g(np),Xp=g(ip);we(()=>Ye(Xp,`Gross Profit: +${or(n(Y).grossProfit,2)??""}`)),f(ip);var Kd=u(ip,2),Mt=g(Kd);we(()=>Ye(Mt,`Gross Loss: -${or(n(Y).grossLoss,2)??""}`)),f(Kd);var ho=u(Kd,2),no=g(ho);we(()=>Ye(no,`Total: ${(n(Y).netPnl>=0?"+":"")??""}${or(n(Y).netPnl,2)??""}`)),f(ho),f(np);var gn=u(np,2),dr=g(gn),z=g(dr);we(()=>Ye(z,`Net (from trades): ${(n(ye)>=0?"+":"")??""}${pe(n(ye))??""}`)),f(dr);var te=u(dr,2),ve=g(te);we(()=>Ye(ve,`Initial: ${or(n(Y).initialCapital,2)??""}`)),f(te);var Ne=u(te,2),Re=g(Ne);we(()=>Ye(Re,`Final: ${or(n(Y).finalEquity,2)??""}`)),f(Ne),f(gn);var je=u(gn,2);Se(je,()=>n(De).type!=="all",oo=>{var Yt=SW(),Ht=_t(Yt),To=g(Ht);const vo=We(()=>n(De).type.toUpperCase()??""),Ot=We(()=>n(De).key??""),Yo=We(()=>n(be).trades??""),is=We(()=>n(be).wins??""),vs=We(()=>n(be).losses??""),Rs=We(()=>Ze(n(be).winRate)??""),Ws=We(()=>(n(be).net>=0?"+":"")??""),li=We(()=>or(n(be).net,2)??""),an=We(()=>or(n(be).fees,2)??"");var Br=g(To);we(()=>Ye(Br,`Filtered: ${n(vo)} ${n(Ot)} • Trades ${n(Yo)} •
	              W ${n(is)} / L ${n(vs)} • Win ${n(Rs)} •
	              Net ${n(Ws)}${n(li)} • Fees ${n(an)}`)),f(To);var ya=u(To,2),As=g(ya);Se(As,()=>n($e)&&n(be).trades>0,rs=>{var mn=yW();mn.__click=[_W,xe,$e,ne],O(rs,mn)});var qs=u(As,2);Se(qs,()=>n(Ve)&&n(be).trades>0,rs=>{var mn=xW();mn.__click=[bW,xe,Ve,ne],O(rs,mn)});var Jn=u(qs,2);Jn.__click=[d2,es,ge,De,rn];var Pi=u(Jn,2);Pi.__click=[wW,ke],f(ya),f(Ht);var _l=u(Ht,2),ur=g(_l),yl=g(ur);we(()=>Ye(yl,`PF ${Ke(n(be).profitFactor)??""}`)),f(ur);var kn=u(ur,2),Sr=g(kn);we(()=>Ye(Sr,`Exp ${(n(be).expectancy>=0?"+":"")??""}${or(n(be).expectancy,2)??""}`)),f(kn);var Ba=u(kn,2),Pt=g(Ba);we(()=>Ye(Pt,`Avg W ${(n(be).avgWin>=0?"+":"")??""}${or(n(be).avgWin,2)??""}`)),f(Ba);var Ut=u(Ba,2),xs=g(Ut);we(()=>Ye(xs,`Avg L ${(n(be).avgLoss>=0?"+":"")??""}${or(n(be).avgLoss,2)??""}`)),f(Ut);var fs=u(Ut,2);Se(fs,()=>n(bs),rs=>{var mn=kW(),Ds=_t(mn),sn=g(Ds);we(()=>Ye(sn,`Max DD ${Ze(n(bs).maxDrawdownPct)??""}`)),f(Ds);var na=u(Ds,2),Wo=g(na);we(()=>Ye(Wo,`Ret ${(n(bs).retPct>=0?"+":"")??""}${Ze(n(bs).retPct)??""}`)),f(na),O(rs,mn)}),f(_l),O(oo,Yt)});var Ue=u(je,2);Ec(Ue,oo=>b(He,oo),()=>n(He));var kt=u(Ue,2),lt=g(kt),bt=g(lt),Ct=g(bt),Kt=u(g(Ct)),Dt=g(Kt);f(Kt),f(Ct);var jt=u(Ct,2);Se(jt,()=>n(Je),oo=>{var Yt=CW(),Ht=g(Yt,!0);f(Yt),we(()=>Ye(Ht,n(Je))),O(oo,Yt)}),f(bt);var Co=u(bt,2),Oo=g(Co);Se(Oo,()=>n(De).type!=="all",oo=>{var Yt=IW();Yt.__click=[PW,ke],O(oo,Yt)});var Ho=u(Oo,2);Se(Ho,()=>n(ee),oo=>{var Yt=MW();Yt.__click=[WO,Ae,_],O(oo,Yt)}),f(Co),f(lt);var Vo=u(lt,2);Se(Vo,()=>n(ee),oo=>{var Yt=TW(),Ht=u(g(Yt),2);const To=We(()=>n(ee).side.toUpperCase()??""),vo=We(()=>n(ee).entryIndex??""),Ot=We(()=>n(ee).exitIndex??""),Yo=We(()=>_e(n(ee).entryTimestamp)??""),is=We(()=>_e(n(ee).exitTimestamp)??""),vs=We(()=>(Number(n(ee).netPnl)>=0?"+":"")??""),Rs=We(()=>xt(n(ee).netPnl)??""),Ws=We(()=>xt(n(ee).fees)??""),li=We(()=>n(ee).exitReason??"");var an=g(Ht);we(()=>Ye(an,`${n(To)} • #${n(vo)} → #${n(Ot)} •
		                ${n(Yo)} → ${n(is)} •
		                Net ${n(vs)}${n(Rs)} • Fees ${n(Ws)} • Reason ${n(li)}`)),f(Ht),f(Yt),O(oo,Yt)});var Cn=u(Vo,2);Se(Cn,()=>n(Ce).length,oo=>{var Yt=EW(),Ht=g(Yt),To=u(g(Ht));Ns(To,21,()=>n(Ce),vo=>vo.id,(vo,Ot)=>{var Yo=DW();Yo.__click=[AW,xe,Ot],Yo.__keydown=[LW,xe,Ot];var is=g(Yo),vs=g(is);vs.__click=[FW,xe,Ot],f(is);var Rs=u(is),Ws=g(Rs),li=g(Ws,!0);f(Ws),f(Rs);var an=u(Rs),Br=g(an,!0);we(()=>Ye(Br,Is(n(Ot).qty))),f(an);var ya=u(an);const As=We(()=>n(Ot).entryIndex??""),qs=We(()=>_e(n(Ot).entryTimestamp)??""),Jn=We(()=>eo(n(Ot).entryPrice)??"");var Pi=g(ya);we(()=>Ye(Pi,`#${n(As)} • ${n(qs)} • ${n(Jn)}`)),f(ya);var _l=u(ya);const ur=We(()=>n(Ot).exitIndex??""),yl=We(()=>_e(n(Ot).exitTimestamp)??""),kn=We(()=>eo(n(Ot).exitPrice)??"");var Sr=g(_l);we(()=>Ye(Sr,`#${n(ur)} • ${n(yl)} • ${n(kn)}`)),f(_l);var Ba=u(_l);const Pt=We(()=>(Number(n(Ot).netPnl)>=0?"+":"")??""),Ut=We(()=>xt(n(Ot).netPnl)??"");var xs=g(Ba);we(()=>Ye(xs,`${n(Pt)}${n(Ut)}`)),f(Ba);var fs=u(Ba),rs=g(fs,!0);we(()=>Ye(rs,xt(n(Ot).fees))),f(fs);var mn=u(fs);const Ds=We(()=>(Number(n(Ot).pnl)>=0?"+":"")??""),sn=We(()=>xt(n(Ot).pnl)??"");var na=g(mn);we(()=>Ye(na,`${n(Ds)}${n(sn)}`)),f(mn);var Wo=u(mn),Pl=g(Wo,!0);we(()=>Ye(Pl,Po(n(Ot).pnlPct))),f(Wo);var El=u(Wo);const fe=We(()=>(Number(n(Ot).cumNet)>=0?"+":"")??""),No=We(()=>xt(n(Ot).cumNet)??"");var gs=g(El);we(()=>Ye(gs,`${n(fe)}${n(No)}`)),f(El);var pi=u(El),vi=g(pi,!0);f(pi);var Na=u(pi),Xl=g(Na,!0);we(()=>Ye(Xl,n(Ot).maePct==null?"-":Po(n(Ot).maePct))),f(Na);var cd=u(Na),Be=g(cd,!0);we(()=>Ye(Be,n(Ot).mfePct==null?"-":Po(n(Ot).mfePct))),f(cd),f(Yo),we(()=>{Sn(Yo,"selected",n(Ae)===n(Ot).id),Sn(Yo,"pos",n(Ot).netPnl>=0),Sn(Yo,"neg",n(Ot).netPnl<0),Ye(li,n(Ot).side),Ye(vi,n(Ot).exitReason)}),O(vo,Yo)}),f(To),f(Ht),f(Yt),O(oo,Yt)},oo=>{var Yt=zW(),Ht=g(Yt);Se(Ht,()=>n(Pe).length===0,To=>{var vo=$W();un(2),O(To,vo)},To=>{var vo=Xt(),Ot=_t(vo);Se(Ot,()=>n(De).type!=="all",Yo=>{var is=jW(),vs=u(_t(is)),Rs=g(vs);we(()=>Ye(Rs,`${n(De).type.toUpperCase()??""} ${n(De).key??""}`)),f(vs);var Ws=u(vs);we(()=>Ye(Ws,`). Click “Clear filter” to show all trades. Total trades: ${n(Pe).length??""}.`)),O(Yo,is)},Yo=>{var is=Np();we(()=>Ye(is,`No trade rows to show. Total trades: ${n(Pe).length??""}.`)),O(Yo,is)},!0),O(To,vo)}),f(Yt),O(oo,Yt)}),f(kt);var Qs=u(kt,2),Gn=g(Qs),zi=u(g(Gn),2),wn=g(zi),Ro=u(wn);Se(Ro,()=>n(ze).length>500,oo=>{var Yt=Np("• Showing last 500");O(oo,Yt)}),f(zi),f(Gn);var Qo=u(Gn,2);Se(Qo,()=>n(ze).length,oo=>{var Yt=NW(),Ht=g(Yt),To=u(g(Ht));Ns(To,21,()=>n(he),vo=>vo.id,(vo,Ot)=>{var Yo=BW(),is=g(Yo),vs=g(is,!0);f(is);var Rs=u(is),Ws=g(Rs,!0);f(Rs);var li=u(Rs),an=g(li,!0);f(li);var Br=u(li),ya=g(Br,!0);f(Br);var As=u(Br),qs=g(As,!0);f(As);var Jn=u(As),Pi=g(Jn);we(()=>Ye(Pi,`#${n(Ot).createdIndex??""} • ${_e(n(Ot).createdTimestamp)??""}`)),f(Jn);var _l=u(Jn),ur=g(_l,!0);we(()=>Ye(ur,Qt(n(Ot).qtyPct,2))),f(_l);var yl=u(_l),kn=g(yl,!0);we(()=>Ye(kn,eo(n(Ot).price))),f(yl);var Sr=u(yl),Ba=g(Sr,!0);we(()=>Ye(Ba,eo(n(Ot).stopPrice))),f(Sr);var Pt=u(Sr),Ut=g(Pt,!0);we(()=>Ye(Ut,eo(n(Ot).limitPrice))),f(Pt);var xs=u(Pt),fs=g(xs,!0);we(()=>Ye(fs,n(Ot).filledIndex==null?"-":`#${n(Ot).filledIndex} • ${_e(n(Ot).filledTimestamp)}`)),f(xs);var rs=u(xs),mn=g(rs,!0);we(()=>Ye(mn,Is(n(Ot).fillQty))),f(rs);var Ds=u(rs),sn=g(Ds,!0);we(()=>Ye(sn,eo(n(Ot).fillPrice))),f(Ds);var na=u(Ds),Wo=g(na,!0);we(()=>Ye(Wo,xt(n(Ot).fees))),f(na);var Pl=u(na),El=g(Pl,!0);f(Pl);var fe=u(Pl),No=g(fe,!0);f(fe);var gs=u(fe),pi=g(gs,!0);f(gs),f(Yo),we(()=>{Ye(vs,n(Ot).id),Ye(Ws,n(Ot).action),Ye(an,n(Ot).side),Ye(ya,n(Ot).kind),Ye(qs,n(Ot).status),Ye(El,n(Ot).ocoGroup||"-"),Ye(No,n(Ot).signalId||"-"),Ye(pi,n(Ot).note||"-")}),O(vo,Yo)}),f(To),f(Ht),f(Yt),O(oo,Yt)},oo=>{var Yt=RW();O(oo,Yt)}),f(Qs),we(()=>{Ye(Ao,n(K).total),Ye(ds,`L ${n(K).entryLong??""}/${n(K).exitLong??""} • S ${n(K).entryShort??""}/${n(K).exitShort??""}`),Ye(ui,n(Y).trades),Ye(Li,`Wins ${n(Y).wins??""} • Loss ${n(Y).losses??""} `),Sn(nc,"active",n(ft)==="1m"),Sn(vc,"active",n(ft)==="3m"),Sn(Zl,"active",n(ft)==="6m"),Sn(Ha,"active",n(ft)==="all"),Pn(ho,`${`pnl-item ${n(Y).netPnl>=0?"pos":"neg"}`??""} svelte-za388g`),Sn(kt,"flash",n(Ie)),Ye(Dt,`(${n(ge).length??""}/${n(Pe).length??""})`),Ye(wn,`Rows ${n(ze).length??""}`)}),Fl("pointerleave",fl,()=>{b(jr,null)}),Fl("pointerleave",Vd,()=>{b(ii,null)}),O(uo,ut)}),f(nt),O(Le,nt)},!0),O(Me,Xe)});var qi=u(_a,2),ai=g(qi),cr=g(ai),Dn=u(cr,2),kr=g(Dn,!0);f(Dn),f(ai),un(2),f(qi),f(wt),we(()=>{St(wt,"aria-hidden",!d()),Sn(wt,"fullpage",n(T)),Sn(vt,"selected",n(w)==="editor"),Sn($t,"selected",n(w)==="errors"),Sn($t,"has-errors",n(Ca)>0),Sn($t,"has-warnings",n(Ca)===0&&n(vl)>0),Ye(bo,n(Sl)),Sn(Zo,"selected",n(w)==="results"),St(vn,"aria-pressed",n(k)),Ye(Ko,`Labels ${(n(k)?"On":"Off")??""}`),Vs.disabled=l(),Ye(tr,l()?"Running...":"Run"),Pn(cr,`footer-dot ${(i()?"error":l()?"running":"ok")??""} svelte-za388g`),Ye(kr,n(el))}),O(o,wt),Za()}hc(["pointerdown","click","input","change","keydown","pointermove"]);var HW=(o,e)=>{o.target===o.currentTarget&&e()},GW=(o,e)=>b(e,"details"),YW=(o,e)=>b(e,"examples"),UW=(o,e)=>b(e,"bn"),KW=(o,e)=>b(e,"en"),ZW=de('<p class="ss-guide-intro svelte-50qv65">Script Studio দুইভাবে কাজ করে: DSL (সহজ টেক্সট) এবং JSON। নিচে পেশাদার স্টাইলের স্টেপ‑বাই‑স্টেপ ডকুমেন্টেশন দেওয়া হলো।</p> <h3 class="ss-section-title svelte-50qv65">কুইক স্টার্ট</h3> <ul class="ss-list svelte-50qv65"><li>প্যান নির্বাচন করুন: <code>pane</code> = <code>main</code> বা <code>sub</code></li> <li>ক্যালকুলেশন যোগ করুন: <code>calc</code> এ EMA/RSI/MACD ইত্যাদি</li> <li>প্লট আঁকুন: <code>plots</code> এ সিরিজকে line/neon_line/dots</li> <li>সিগন্যাল/লেবেল দিন: <code>labels</code> ও <code>signals</code> এ শর্ত</li> <li>স্ট্র্যাটেজি ব্যাকটেস্ট চাইলে: <code>strategy</code> যোগ করুন এবং <code>Results</code> ট্যাব দেখুন</li> <li>Run চাপুন এবং চার্টে ফলাফল দেখুন</li></ul> <h3 class="ss-section-title svelte-50qv65">স্ক্রিপ্ট টাইপ</h3> <ul class="ss-list svelte-50qv65"><li>DSL: ছোট, দ্রুত টেক্সট ভিত্তিক সিনট্যাক্স</li> <li>JSON: স্ট্রাকচারড, বিস্তারিত কনফিগ</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">DSL উদাহরণ</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON উদাহরণ</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">স্কিমা চিটশিট</h3> <ul class="ss-list svelte-50qv65"><li><code>calc</code>: ইনডিকেটর সিরিজ ডিফাইন (উদা: EMA/RSI/MACD)</li> <li><code>plots</code>: সিরিজ কিভাবে আঁকবেন (color/width/style)</li> <li><code>labels</code>: শর্ত পূরণে শেপ/টেক্সট দেখায়</li> <li><code>signals</code>: ট্রেড ইভেন্ট (entry/exit)</li> <li><code>strategy</code>: ব্যাকটেস্ট সেটিংস (capital/fees/slippage/size/SL/TP)</li> <li><code>overlays</code>: ড্রয়িং টুলস (Fibo, trendline, wave, text, horizontal line)</li> <li><code>levels</code>: সাব‑প্যানে লেভেল লাইন</li> <li><code>lines</code>: পিভট থেকে ট্রেন্ডলাইন সেগমেন্ট</li> <li><code>fills</code>: দুই সিরিজের মধ্যে ফিল কালার</li></ul> <h3 class="ss-section-title svelte-50qv65">ড্রয়িং (Overlays) — Script দিয়ে Fib/Line/Text</h3> <ul class="ss-list svelte-50qv65"><li><code>overlays</code> এ <code>name</code> দিন (যেমন: <code>fibonacciSegment</code>, <code>horizontalRayLine</code>, <code>note</code>, <code>threeWaves</code>)</li> <li>পয়েন্ট দিন: <code></code> (নেগেটিভ index = শেষ থেকে গণনা)</li> <li><code>extendData</code> দিয়ে fib levels বা note text কাস্টমাইজ করা যায়</li></ul> <h3 class="ss-section-title svelte-50qv65">স্ট্র্যাটেজি (Backtest) — প্রফেশনাল মোড</h3> <ul class="ss-list svelte-50qv65"><li>ডাটা যদি OHLC হয় (tick না থাকে), তাহলে আমরা <code>intrabar_ohlc</code> মোডে <code>high/low</code> touch দেখে SL/TP হিট ধরতে পারি</li> <li>একই ক্যান্ডেলে SL+TP দুটো touch হলে ডিফল্ট <code>intrabarTieBreak</code> = <code>worst_case</code> (সেফ/কনজারভেটিভ)</li> <li>Risk fields: <code>stopLossPct</code>, <code>takeProfitPct</code>, <code>trailingStopPct</code></li> <li>Broker realism: <code>priceTick</code> / <code>qtyStep</code> / <code>minQty</code> দিলে price/qty broker নিয়মে রাউন্ড হবে (ম্যাচ না করলে order <code>rejected</code> হবে — Orders টেবিলে note দেখবেন)</li> <li>Orders: <code>signals[i].order</code> দিয়ে <code>market/limit/stop/stop_limit</code> entry/exit করা যায় (price হিসেবে number বা সিরিজ নাম)</li> <li>Stop‑limit: <code></code> (ঐচ্ছিক <code>expiresBars</code> দিলে অটো‑ক্যান্সেল)</li> <li>OCO: <code>order.oco</code> একই গ্রুপের অন্য pending order ক্যান্সেল করে</li> <li>Bracket (entry‑তে): <code>order.bracket</code> দিয়ে ওই entry‑র জন্য আলাদা SL/TP/Trailing/Partial TP সেট করা যায় (strategy‑level risk override)</li> <li>Cooldown: <code>signals[i].cooldownBars</code> দিলে একই সিগন্যাল বারবার ফায়ার হবে না</li> <li>Partial: <code>order.qtyPct</code> দিয়ে partial entry/exit করা যায় (উদা: TP তে 50% exit)</li></ul> <h3 class="ss-section-title svelte-50qv65">Broker realism v2 (Spread/Margin/Netting)</h3> <ul class="ss-list svelte-50qv65"><li><code>spreadPct</code>: bid/ask spread % (উদা: <code>0.05</code> মানে <code>0.05%</code>)</li> <li><code>leverage</code>: leverage (>=1) — % equity order size হলে এক্সপোজার বাড়ে</li> <li><code>maintenanceMarginPct</code> + <code>liquidationFeePct</code>: margin কমে গেলে <b>AUTO liquidation</b></li> <li><code>borrowPctPerYear</code> + <code>fundingPctPerDay</code>: short borrow/funding fee equity থেকে কেটে নেয়</li> <li><code>positionMode</code>: <code>netting</code> (ডিফল্ট) বা <code>hedging</code></li> <li><code>closeMethod</code>: <code>fifo</code> (ডিফল্ট) / <code>lifo</code> / <code>avg</code> (average‑cost)</li></ul> <h3 class="ss-section-title svelte-50qv65">স্টেপ‑বাই‑স্টেপ: EMA ক্রস স্ক্রিপ্ট</h3> <ul class="ss-list svelte-50qv65"><li>Step 1 — <code>pane</code>: <code>main</code></li> <li>Step 2 — <code>calc</code>: <code>ema_fast</code> ও <code>ema_slow</code></li> <li>Step 3 — <code>plots</code>: দুই EMA লাইন</li> <li>Step 4 — <code>labels</code>: ক্রস হলে BUY/SELL ট্যাগ</li> <li>Step 5 — Run করে চার্ট দেখুন</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON · EMA ক্রস</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">কন্ডিশন রেফারেন্স</h3> <ul class="ss-list svelte-50qv65"><li>কম্পারিজন: <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code></li> <li>লজিক: <code>and</code>, <code>or</code>, <code>not</code></li> <li>ক্রস: <code>crossesAbove</code>, <code>crossesBelow</code></li> <li>ট্রেন্ড: <code>trend(up)</code>, <code>trend(down)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">ডাইনামিক প্যারাম</h3> <ul class="ss-list svelte-50qv65"><li><code>params</code> এ ভ্যালু দিন, তারপর যেকোনো স্ট্রিং/নাম্বার ফিল্ডে <code></code> লিখুন (উদাহরণ: <code></code>)</li> <li>উদাহরণ: <code></code> হলে <code>when</code>‑এ লিখুন <code></code></li> <li>Series expressions এ প্যারাম সরাসরি আইডেন্টিফায়ার হিসেবেও চলে: <code>highest(close, WIN)</code> (যদি <code>params.WIN</code> থাকে)</li></ul> <h3 class="ss-section-title svelte-50qv65">এক্সটেন্ডেড ফাংশন</h3> <ul class="ss-list svelte-50qv65"><li>ক্রস/কম্পেয়ার: <code>crossover</code>, <code>crossunder</code>, <code>above</code>, <code>below</code>, <code>between</code></li> <li>ডিরেকশন: <code>rising(series[, n])</code>, <code>falling(series[, n])</code></li> <li>উইন্ডো/ল্যাগ: <code>lowest</code>, <code>highest</code>, <code>lag</code>, <code>prev</code>, <code>change</code>, <code>abs</code></li> <li>অ্যারিথমেটিক: <code>add</code>, <code>sub</code>, <code>mul</code>, <code>div</code>, <code>min</code>, <code>max</code></li> <li>মুভিং এভারেজ: <code>sma(series, period)</code>, <code>ema(series, period)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">সাপোর্টেড ফিচার</h3> <ul class="ss-list svelte-50qv65"><li>Pane: <code>main</code>, <code>sub</code></li> <li>Indicators (calc): <code>sma</code>, <code>smma</code>, <code>ema</code>, <code>wma</code>, <code>rsi</code>, <code>macd</code>, <code>bbands</code>, <code>atr</code>, <code>supertrend</code>, <code>kc</code>, <code>donchian</code>, <code>ichimoku</code>, <code>stoch</code>, <code>sar</code>, <code>zscore</code>, <code>vwap</code>, <code>vwma</code>, <code>atr_bands</code>, <code>vwap_bands</code>, <code>linreg_channel</code>, <code>pivot_high</code>, <code>pivot_low</code>, <code>auto_fib</code>, <code>last_value</code>, <code>prev_value</code></li> <li>Plots: <code>line</code>, <code>neon_line</code>, <code>bezier_line</code>, <code>histogram</code>, <code>area</code>, <code>dots</code>, <code>bar</code>, <code>cloud</code>, <code>aura</code>, <code>candleshadow</code>, <code>supertrend_cloud</code></li> <li>Label shapes: <code>arrowUp</code>, <code>arrowDown</code>, <code>circle</code>, <code>square</code>, <code>triangle_up_filled</code>, <code>triangle_down_filled</code>, <code>box</code>, <code>label</code>, <code>text</code>, <code>emoji</code>, <code>triangle_up_gradient</code>, <code>arrow_up_glow</code>, <code>pill</code>, <code>tag</code>, <code>flag</code></li> <li>Signals: <code>entry_long</code>, <code>exit_long</code>, <code>entry_short</code>, <code>exit_short</code></li> <li>Backtest: add <code>strategy</code> and check <code>Results</code> tab</li></ul> <h3 class="ss-section-title svelte-50qv65">সীমাবদ্ধতা</h3> <ul class="ss-list svelte-50qv65"><li>JSON স্ক্রিপ্টে কমেন্ট/ব্যাকটিক/সিঙ্গেল কোট সাপোর্ট না — ডাবল কোট ও বৈধ কমা ব্যবহার করুন</li> <li>DSL পেস্ট করলে এডিটর <code>Non‑JSON script</code> দেখাতে পারে — তবুও Run করলে কাজ করবে</li> <li><code>when</code>‑এ ইচ্ছেমতো জাভাস্ক্রিপ্ট নয় — সমর্থিত ফাংশন/কম্পারিজন ব্যবহার করুন</li> <li><code>request.security</code> (MTF/HTF) এখন <b>same symbol + multi‑symbol</b> কাজ করে — অন্য symbol দিতে চাইলে টিকার দিন (উদা: <code>"AAPL"</code> বা <code>"AAPL@US"</code>)</li> <li>HTF মানে Higher Timeframe (উচ্চ টাইমফ্রেম) — উদাহরণ: চার্ট 15m কিন্তু <code>request.security(..., "240", ...)</code> = 4H ডেটা</li> <li>Lower‑timeframe security (যেমন চার্ট 1H কিন্তু security 15m) এখনও সাপোর্টেড না, কারণ lower‑TF candle সার্ভার থেকে লাগবে</li> <li>HTF ইন্ডিকেটর ঠিকমতো দেখতে হলে যথেষ্ট history লোড করুন (বামে scroll করলে পুরোনো candles লোড হয়)</li> <li><code>request.security</code> চালালে Script Studio প্রয়োজন হলে ঐ timeframe‑এর অতিরিক্ত historical candles background‑এ লোড করতে পারে</li></ul> <h3 class="ss-section-title svelte-50qv65">এরর ডায়াগনস্টিক্স</h3> <ul class="ss-list svelte-50qv65"><li>পার্স ফেল হলে: <code>Label[i:j] parse failed at &lt;pos&gt;</code> — ঠিক কোথায় সমস্যা</li> <li>অজানা সিরিজ: <code>Label[i:j] unknown series: …</code> — এলিয়াস ঠিক করে নিন</li> <li>প্যান কন্টেন্ট: <code>Pane has no plots</code> — অন্তত একটি প্লট যোগ করুন</li></ul> <h3 class="ss-section-title svelte-50qv65">সাব‑প্যানে অ্যাঙ্করিং</h3> <ul class="ss-list svelte-50qv65"><li>সাব‑প্যানে লেবেল/সিগন্যালের <code>source</code> হিসেবে ইনডিকেটর সিরিজ ব্যবহার করুন</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">RSI সাব‑প্যান</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">ট্রেন্ডলাইন ও ফিল</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">অটো ট্রেন্ডলাইন</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">বোলিঞ্জার ফিল</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">মাল্টি‑প্যান টেমপ্লেট</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Main + Sub</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">কমন ভুল ও ফিক্স</h3> <ul class="ss-list svelte-50qv65"><li><code>when</code> স্ট্রিং‑এ ট্রেইলিং কমা/সেমিকোলন থাকলে স্বয়ংক্রিয়ভাবে পরিষ্কার হয় (কিন্তু JSON অবশ্যই ভ্যালিড হতে হবে)</li> <li>ঝুলে থাকা <code>and</code>/<code>or</code> থাকলে শর্ত ট্রিম হয়</li> <li>কমেন্ট লিখলে পার্সের আগে বাদ দেওয়া হয়</li></ul>',1),XW=de('<p class="ss-guide-intro svelte-50qv65">Script Studio supports DSL and JSON. Below is a professional, step‑by‑step guide.</p> <h3 class="ss-section-title svelte-50qv65">Quick Start</h3> <ul class="ss-list svelte-50qv65"><li>Select <code>pane</code>: <code>main</code> or <code>sub</code></li> <li>Add indicators in <code>calc</code> (EMA/RSI/MACD)</li> <li>Draw with <code>plots</code> (line/neon_line/dots)</li> <li>Configure <code>labels</code> and <code>signals</code></li> <li>For backtest: add <code>strategy</code> and open <code>Results</code></li> <li>Press Run and review on chart</li></ul> <h3 class="ss-section-title svelte-50qv65">Script Types</h3> <ul class="ss-list svelte-50qv65"><li>DSL: concise text syntax</li> <li>JSON: structured configuration</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">DSL example</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON example</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Schema Cheatsheet</h3> <ul class="ss-list svelte-50qv65"><li><code>calc</code>: define indicator series</li> <li><code>plots</code>: render series with styles</li> <li><code>labels</code>: draw shapes/text on conditions</li> <li><code>signals</code>: trading events</li> <li><code>strategy</code>: backtest settings (capital/fees/slippage/size/SL/TP)</li> <li><code>overlays</code>: drawing tools (Fibo, trendline, wave, text, horizontal line)</li> <li><code>levels</code>: horizontal levels in sub pane</li> <li><code>lines</code>: trendline segments from pivots</li> <li><code>fills</code>: fill between two series</li></ul> <h3 class="ss-section-title svelte-50qv65">Drawings (Overlays) — Scripted Fib/Lines/Text</h3> <ul class="ss-list svelte-50qv65"><li>Add <code>overlays</code> with a registered overlay <code>name</code> (example: <code>fibonacciSegment</code>, <code>horizontalRayLine</code>, <code>note</code>)</li> <li>Points support <code>index</code> (negative = from end) and <code>source</code> (<code>open/high/low/close</code>)</li> <li>Use <code>extendData</code> to customize fib levels and note text/colors</li></ul> <h3 class="ss-section-title svelte-50qv65">Strategy Backtest — Pro Mode</h3> <ul class="ss-list svelte-50qv65"><li>If you have OHLC history (no tick), use <code>execution: intrabar_ohlc</code> to treat SL/TP as “touched” by <code>high/low</code></li> <li>If SL and TP are both touched in the same candle, default <code>intrabarTieBreak</code> is <code>worst_case</code> (conservative)</li> <li>Risk fields: <code>stopLossPct</code>, <code>takeProfitPct</code>, <code>trailingStopPct</code></li> <li>Broker realism: set <code>priceTick</code> / <code>qtyStep</code> / <code>minQty</code> to enforce tick size + lot size (mismatches can create <code>rejected</code> orders — see Orders table notes)</li> <li>Orders: use <code>signals[i].order</code> to place <code>market/limit/stop/stop_limit</code> entries/exits (price can be a number or a series name)</li> <li>Stop‑limit: <code></code> (use <code>expiresBars</code> to auto-cancel)</li> <li>OCO: add <code>order.oco</code> to cancel other pending orders in the same group when one fills</li> <li>Bracket (per-entry): attach <code>order.bracket</code> on an entry to override SL/TP/trailing/partial take-profits for that entry lot</li> <li>Cooldown: add <code>signals[i].cooldownBars</code> to prevent repeated signals (useful for one-time entries)</li> <li>Partial: use <code>order.qtyPct</code> for partial entry/exit (example: take 50% profit at TP)</li> <li>Advanced: <code>pyramiding</code> (max stacked entries), <code>takeProfits</code> (partial TP levels)</li> <li>Reports: equity curve + drawdown + monthly/weekly returns + CSV export in <code>Results</code> tab</li> <li>Too many labels? Use the <b>Labels On/Off</b> toggle, or set <code>style.labelLimit</code></li></ul> <h3 class="ss-section-title svelte-50qv65">Step‑by‑Step: EMA Cross</h3> <ul class="ss-list svelte-50qv65"><li>Step 1 — <code>pane</code>: <code>main</code></li> <li>Step 2 — <code>calc</code>: <code>ema_fast</code> and <code>ema_slow</code></li> <li>Step 3 — <code>plots</code>: draw both EMAs</li> <li>Step 4 — <code>labels</code>: show BUY/SELL on cross</li> <li>Step 5 — Run and verify</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">JSON · EMA cross</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Condition Reference</h3> <ul class="ss-list svelte-50qv65"><li>Comparisons: <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code></li> <li>Logic: <code>and</code>, <code>or</code>, <code>not</code></li> <li>Crosses: <code>crossesAbove</code>, <code>crossesBelow</code></li> <li>Trend: <code>trend(up)</code>, <code>trend(down)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">Dynamic Params</h3> <ul class="ss-list svelte-50qv65"><li>Put values in <code>params</code>, then reference them as <code></code> (example: <code></code>) anywhere in the script.</li> <li>Example: <code></code> then <code></code></li> <li>In series expressions, numeric params can also be used as bare identifiers: <code>highest(close, WIN)</code> (if <code>params.WIN</code> exists)</li></ul> <h3 class="ss-section-title svelte-50qv65">Extended Functions</h3> <ul class="ss-list svelte-50qv65"><li>Cross/compare: <code>crossover</code>, <code>crossunder</code>, <code>above</code>, <code>below</code>, <code>between</code></li> <li>Direction: <code>rising(series[, n])</code>, <code>falling(series[, n])</code></li> <li>Window/lag: <code>lowest</code>, <code>highest</code>, <code>lag</code>, <code>prev</code>, <code>change</code>, <code>abs</code></li> <li>Arithmetic: <code>add</code>, <code>sub</code>, <code>mul</code>, <code>div</code>, <code>min</code>, <code>max</code></li> <li>Moving average: <code>sma(series, period)</code>, <code>ema(series, period)</code></li></ul> <h3 class="ss-section-title svelte-50qv65">Supported Features</h3> <ul class="ss-list svelte-50qv65"><li>Pane: <code>main</code>, <code>sub</code></li> <li>Indicators (calc): <code>sma</code>, <code>smma</code>, <code>ema</code>, <code>wma</code>, <code>rsi</code>, <code>macd</code>, <code>bbands</code>, <code>atr</code>, <code>supertrend</code>, <code>kc</code>, <code>donchian</code>, <code>ichimoku</code>, <code>stoch</code>, <code>sar</code>, <code>zscore</code>, <code>vwap</code>, <code>vwma</code>, <code>atr_bands</code>, <code>vwap_bands</code>, <code>linreg_channel</code>, <code>pivot_high</code>, <code>pivot_low</code>, <code>auto_fib</code>, <code>last_value</code>, <code>prev_value</code></li> <li>Plots: <code>line</code>, <code>neon_line</code>, <code>bezier_line</code>, <code>histogram</code>, <code>area</code>, <code>dots</code>, <code>bar</code>, <code>cloud</code>, <code>aura</code>, <code>candleshadow</code>, <code>supertrend_cloud</code></li> <li>Label shapes: <code>arrowUp</code>, <code>arrowDown</code>, <code>circle</code>, <code>square</code>, <code>triangle_up_filled</code>, <code>triangle_down_filled</code>, <code>box</code>, <code>label</code>, <code>text</code>, <code>emoji</code>, <code>triangle_up_gradient</code>, <code>arrow_up_glow</code>, <code>pill</code>, <code>tag</code>, <code>flag</code></li> <li>Signals: <code>entry_long</code>, <code>exit_long</code>, <code>entry_short</code>, <code>exit_short</code></li> <li>Backtest: add <code>strategy</code> and open <code>Results</code> in Script Studio</li></ul> <h3 class="ss-section-title svelte-50qv65">Strategy Engine v2</h3> <ul class="ss-list svelte-50qv65"><li>Spread: set <code>spreadPct</code> to simulate bid/ask; market/stop fills use bid/ask, limits use the limit price</li> <li>Leverage/Margin: set <code>leverage</code> + <code>maintenanceMarginPct</code>; breaches trigger <b>AUTO liquidation</b> (optional <code>liquidationFeePct</code>)</li> <li>Carry costs: <code>borrowPctPerYear</code> (short) and <code>fundingPctPerDay</code> (both sides) reduce equity over time</li> <li>Position mode: <code>positionMode="netting"</code> (one direction) or <code>"hedging"</code> (long+short simultaneously)</li> <li>Cost basis: <code>closeMethod="fifo"</code>, <code>"lifo"</code>, or <code>"avg"</code> (average-cost)</li></ul> <h3 class="ss-section-title svelte-50qv65">Limitations</h3> <ul class="ss-list svelte-50qv65"><li>JSON: no comments/backticks/single quotes — use double quotes and valid commas</li> <li>DSL may show <code>Non‑JSON script</code> in editor — press Run, it still works</li> <li><code>when</code>: no arbitrary JavaScript — use supported functions/comparisons</li> <li><code>request.security</code> (MTF/HTF) supports <b>same symbol + multi‑symbol</b> — pass a ticker like <code>"AAPL"</code> (optional <code>"AAPL@US"</code>)</li> <li>HTF = Higher Timeframe — example: chart is 15m but <code>request.security(..., "240", ...)</code> uses 4H candles</li> <li>Lower‑timeframe security (e.g. chart 1H but security 15m) is not supported yet because it requires true lower‑TF candles from server</li> <li>Load enough history (scroll left) so HTF indicators have enough candles to calculate</li> <li>When using <code>request.security</code>, Script Studio may background-fetch extra candles for that timeframe if needed</li></ul> <h3 class="ss-section-title svelte-50qv65">Error Diagnostics</h3> <ul class="ss-list svelte-50qv65"><li>Parse fail: <code>Label[i:j] parse failed at &lt;pos&gt;</code> shows exact position</li> <li>Unknown series: <code>Label[i:j] unknown series: …</code> fix alias</li> <li>Pane content: <code>Pane has no plots</code> add at least one plot</li></ul> <h3 class="ss-section-title svelte-50qv65">Sub‑Pane Anchoring</h3> <ul class="ss-list svelte-50qv65"><li>Sub pane labels should use a sub‑pane series as <code>source</code> (example: <code>stoch_k</code>, <code>rsi14</code>)</li> <li>If you use <code>high/low/close</code> inside a fixed <code>min/max</code> sub pane, the label will clamp to the top/bottom and look “un‑anchored” when you resize</li></ul> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">RSI sub pane</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Trendlines & Fills</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Auto trendlines</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Bollinger fill</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Multi‑Pane Template</h3> <div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65">Main + Sub</div></div> <pre class="ss-code svelte-50qv65"><code></code></pre></div> <h3 class="ss-section-title svelte-50qv65">Common Mistakes</h3> <ul class="ss-list svelte-50qv65"><li>In <code>when</code>, trailing commas/semicolons are ignored (JSON itself must still be valid)</li> <li>Dangling <code>and</code>/<code>or</code> are trimmed</li> <li>Inline comments are stripped before parsing</li></ul>',1),JW=de('<section class="ss-section svelte-50qv65" role="tabpanel" id="ss-tabpanel-details" aria-labelledby="ss-tab-details"><div class="ss-details-head svelte-50qv65"><div class="ss-details-title svelte-50qv65">Documentation</div> <div class="ss-lang-toggle svelte-50qv65" aria-label="Language toggle"><button type="button">বাংলা</button> <button type="button">English</button></div></div> <!></section>'),QW=(o,e,t)=>e(n(t).code),eq=(o,e,t)=>e(n(t).code),tq=de('<div class="ss-example svelte-50qv65"><div class="ss-example-head svelte-50qv65"><div class="ss-example-title svelte-50qv65"> </div> <div class="ss-example-actions svelte-50qv65"><button type="button" class="ss-copy svelte-50qv65">Copy</button><button type="button" class="ss-use svelte-50qv65">Use in editor</button></div></div> <pre class="ss-code svelte-50qv65"><code> </code></pre></div>'),oq=de('<section class="ss-section svelte-50qv65" role="tabpanel" id="ss-tabpanel-examples" aria-labelledby="ss-tab-examples"><h3 class="ss-section-title svelte-50qv65">উদাহরণ স্ক্রিপ্ট</h3> <!></section>'),sq=de('<div class="ss-guide-backdrop svelte-50qv65" role="dialog" aria-modal="true" aria-labelledby="ss-guide-title"><div class="ss-guide-modal svelte-50qv65"><div class="ss-guide-header svelte-50qv65"><h2 id="ss-guide-title" class="svelte-50qv65">Script Studio – Documentation</h2> <button class="ss-guide-close svelte-50qv65" type="button" aria-label="Close guide">&times;</button></div> <div class="ss-guide-body svelte-50qv65"><div class="ss-tabs svelte-50qv65" role="tablist" aria-label="Guide sections"><button id="ss-tab-details" role="tab" aria-controls="ss-tabpanel-details">Documentation</button> <button id="ss-tab-examples" role="tab" aria-controls="ss-tabpanel-examples">Examples</button></div> <!></div></div></div>');function nq(o,e){Ka(e,!1);let t=Ss(e,"show",8,!1),s=kl("details"),i=kl("bn");const r=Md();function a(){r("close")}function l(U){return String(U||"").replace(/\\r\\n/g,`
`).replace(/\\n/g,`
`).replace(/\\t/g,"	").replace(/\\"/g,'"')}function d(U){r("insert",{code:l(U)})}function v(U){try{navigator.clipboard.writeText(l(U))}catch{}}const p=[{title:"DSL · Fractal tops/bots",code:`WIN = 5
HIWIN = highest(close, WIN)
LOWIN = lowest(close, WIN)
signal top when (close == HIWIN)
signal bot when (close == LOWIN)
label at top text:"▲ fractal" color:#f97316
label at bot text:"▼ fractal" color:#3b82f6`},{title:"Strategy (JSON) · Engine v2 smoke test (partials + trailing + orders table)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 25 },
    "commissionPct": 0.06,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 2,
    "stopLossPct": 1.2,
    "trailingStopPct": 0.8,
    "takeProfits": [
      { "takeProfitPct": 1.0, "qtyPct": 50 },
      { "takeProfitPct": 2.0, "qtyPct": 50 }
    ],
    "allowShort": false
  },
  "calc": [
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 },
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "EMA 50", "source": "ema50", "color": "#22c55e", "width": 2 },
    { "name": "RSI", "source": "rsi14", "color": "#f59e0b", "width": 2, "pane": "sub" }
  ],
  "levels": [
    { "name": "RSI 70", "value": 70, "color": "#ef4444", "style": "dashed", "pane": "sub" },
    { "name": "RSI 50", "value": 50, "color": "#64748b", "style": "dotted", "pane": "sub" },
    { "name": "RSI 30", "value": 30, "color": "#22c55e", "style": "dashed", "pane": "sub" }
  ],
  "labels": [
    { "when": "rsi14 crossesAbove 50", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "rsi14 crossesBelow 50", "text": "EXIT", "shape": "triangle_down_filled", "color": "#f59e0b", "position": "above", "source": "high" }
  ],
  "signals": [
    { "id": "L", "type": "entry_long", "when": "rsi14 crossesAbove 50", "order": { "kind": "market", "qtyPct": 100 } },
    { "id": "X", "type": "exit_long",  "when": "rsi14 crossesBelow 50", "order": { "kind": "market", "qtyPct": 100 } }
  ]
}`},{title:"Pine (pro) · EMA cross (market) + plotshape",code:`//@pine
//@version=5
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="bar_close", allowShort=false)

ema_fast_len = input.int(20,  title="EMA Fast", minval=1)
ema_slow_len = input.int(50,  title="EMA Slow", minval=2)

ema_fast = ema(close, ema_fast_len)
ema_slow = ema(close, ema_slow_len)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond = crossover(ema_fast, ema_slow)
exit_cond = crossunder(ema_fast, ema_slow)

plotshape(long_cond, text="BUY",  color=color.green,  location=location.belowbar, style=shape.triangleup)
plotshape(exit_cond, text="EXIT", color=color.red,    location=location.abovebar, style=shape.triangledown)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · var/ := state (counter + history)",code:`//@pine
//@version=5
indicator("State demo", overlay=true)

// var = initialize once; := = update per bar
var float bars = 0
bars := bars + 1

// history access: x[1]
var float delta = na
delta := close - close[1]

plot(bars, title="Bars since start", color="#22c55e", width=2)
plot(delta, title="Close change", color="#3b82f6", width=1)

plotshape(delta > 0, text="UP", color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(delta < 0, text="DN", color=color.red,   location=location.abovebar, style=shape.triangledown)`},{title:"Pine (pro) · Broker realism (tick/step/minQty) + SL/TP bracket",code:`//@pine
//@version=5
// Broker realism fields (optional):
// - priceTick: minimum price increment (e.g. 0.01)
// - qtyStep: quantity step (e.g. 1 for stocks)
// - minQty: minimum tradable quantity
// Edit these to match your market.
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="intrabar_ohlc", intrabarTieBreak="worst_case", allowShort=false, priceTick=0.01, qtyStep=1, minQty=1)

ema_fast_len = input.int(20, title="EMA Fast", minval=1)
ema_slow_len = input.int(50, title="EMA Slow", minval=2)
sl_pct = input.float(1.2, title="Stop %", minval=0.1, step=0.1)
tp_pct = input.float(2.4, title="TP %",   minval=0.1, step=0.1)

ema_fast = ema(close, ema_fast_len)
ema_slow = ema(close, ema_slow_len)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond = crossover(ema_fast, ema_slow)
exit_cond = crossunder(ema_fast, ema_slow)

plotshape(long_cond, text="BUY",  color=color.green,  location=location.belowbar, style=shape.triangleup)
plotshape(exit_cond, text="EXIT", color=color.orange, location=location.abovebar, style=shape.triangledown)

entry_px = close
sl_px = entry_px * (1 - sl_pct/100)
tp_px = entry_px * (1 + tp_pct/100)

plot(sl_px, title="SL", color="rgba(239,68,68,0.55)", width=1, style="dotted")
plot(tp_px, title="TP", color="rgba(34,197,94,0.55)", width=1, style="dotted")

strategy.entry("L", strategy.long, when=long_cond)
// This expands into stop + limit exits with OCO.
strategy.exit("BRKT", side="long", when=exit_cond, stop=sl_px, limit=tp_px, qty_percent=100)`},{title:"Pine (pro) · Broker realism v2 (spread/leverage/liquidation + FIFO/LIFO/AVG)",code:`//@pine
//@version=5
// Broker realism v2 fields (optional):
// - spreadPct: bid/ask spread in percent (0.05 = 0.05%)
// - leverage: position leverage (>= 1)
// - maintenanceMarginPct: liquidation if equity <= notional * maintenance%
// - liquidationFeePct: extra fee charged on liquidation exits
// - borrowPctPerYear: short borrow cost (annual %)
// - fundingPctPerDay: funding/interest cost (daily %)
// - positionMode: "netting" (default) or "hedging"
// - closeMethod: "fifo" (default), "lifo", or "avg" (average-cost)
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, spreadPct=0.05, leverage=5, maintenanceMarginPct=1.0, liquidationFeePct=0.2, borrowPctPerYear=6, fundingPctPerDay=0.01, positionMode="netting", closeMethod="fifo", pyramiding=1, execution="intrabar_ohlc", intrabarTieBreak="worst_case", allowShort=true)

fast_len = input.int(20, title="EMA Fast", minval=1)
slow_len = input.int(50, title="EMA Slow", minval=2)
atr_len  = input.int(14, title="ATR", minval=2)
sl_atr   = input.float(2.0, title="SL = ATR x",  minval=0.1, step=0.1)
tp_atr   = input.float(3.0, title="TP = ATR x",  minval=0.1, step=0.1)

ema_fast = ema(close, fast_len)
ema_slow = ema(close, slow_len)
atr_val  = atr(high, low, close, atr_len)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")

long_cond  = crossover(ema_fast, ema_slow)
short_cond = crossunder(ema_fast, ema_slow)

plotshape(long_cond,  text="BUY",  color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(short_cond, text="SELL", color=color.red,   location=location.abovebar, style=shape.triangledown)

sl_long = close - (atr_val * sl_atr)
tp_long = close + (atr_val * tp_atr)
sl_short = close + (atr_val * sl_atr)
tp_short = close - (atr_val * tp_atr)

strategy.entry("L", strategy.long,  when=long_cond)
strategy.entry("S", strategy.short, when=short_cond)

// Intrabar exits (gap + best/worst case controlled by intrabarTieBreak)
strategy.exit("XL", side="long",  stop=sl_long,  limit=tp_long,  qty_percent=100)
strategy.exit("XS", side="short", stop=sl_short, limit=tp_short, qty_percent=100)`},{title:"Pine (pro) · request.security (HTF EMA filter) + BUY/SELL",code:`//@pine
//@version=5
// Shows both BUY (long) and SELL (short) entries.
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="bar_close", allowShort=true)

fast_len = input.int(20, title="EMA Fast", minval=1)
slow_len = input.int(50, title="EMA Slow", minval=2)
htf_tf   = input.string("240", title="HTF (minutes)")

ema_fast = ema(close, fast_len)
ema_slow = ema(close, slow_len)

// Higher-timeframe EMA (same symbol). lookahead_off = updates only after HTF bar closes.
ema_htf = request.security(syminfo.tickerid, htf_tf, ema(close, 50), lookahead=barmerge.lookahead_off, gaps=barmerge.gaps_off)

plot(ema_fast, title="EMA Fast", color="#22c55e", width=2)
plot(ema_slow, title="EMA Slow", color="#3b82f6", width=2, style="dashed")
plot(ema_htf,  title="HTF EMA 50", color="#a78bfa", width=2)

long_cond  = crossover(ema_fast, ema_slow) and (close > ema_htf)
short_cond = crossunder(ema_fast, ema_slow) and (close < ema_htf)

exit_long  = crossunder(ema_fast, ema_slow)
exit_short = crossover(ema_fast, ema_slow)

plotshape(long_cond,  text="BUY",  color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(short_cond, text="SELL", color=color.red,   location=location.abovebar, style=shape.triangledown)

strategy.entry("L", strategy.long,  when=long_cond)
strategy.entry("S", strategy.short, when=short_cond)

strategy.exit("XL", side="long",  when=exit_long,  qty_percent=100)
strategy.exit("XS", side="short", when=exit_short, qty_percent=100)`},{title:"Pine (pro) · request.security (multi-symbol spread) · Z-score (more trades)",code:`//@pine
//@version=5
// Multi-symbol request.security demo.
// IMPORTANT: chart symbol (A) and sym_b (B) should be DIFFERENT.
// If A == B, spread ~ 0 and trades can be 0.
// Optional country: "TICKER@US" or country="US".
// Tip: if sub pane looks blank, reduce lookbk (e.g. 10).

strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="bar_close", allowShort=false)

sym_b   = input.string("AAMRANET", title="Symbol B (ticker OR name)")
htf_tf  = input.string("240", title="HTF (minutes)")
lookbk  = input.int(20, title="Z lookback", minval=5)

close_a = request.security(syminfo.tickerid, htf_tf, close, lookahead=barmerge.lookahead_off)
close_b = request.security(sym_b,            htf_tf, close, lookahead=barmerge.lookahead_off)

// Debug marker: shows "B" only when symbol B has valid data (needs Labels ON)
b_ok = close_b > 0
plotchar(b_ok, char="B", color="#a78bfa", location=location.abovebar, price=close, size=size.small)

spread = close_a - close_b
mu = sma(spread, lookbk)
sd = stdev(spread, lookbk)

// Z-score normalizes spread (so DSEX vs AAMRANET still works visually)
z = (spread - mu) / sd

// Put plots in sub pane so you can see them clearly
plot(z, title="Z-score (A-B)", color="#60a5fa", width=2, pane="sub")
hline(0, title="Zero", color="#64748b", pane="sub")

long_cond = crossover(z, 0)
exit_cond = crossunder(z, 0)

plotshape(long_cond, text="BUY",  color=color.green, location=location.belowbar, style=shape.triangleup)
plotshape(exit_cond, text="SELL", color=color.red,   location=location.abovebar, style=shape.triangledown)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · Trend+RSI filter + ATR bracket (partial TP + SL)",code:`//@pine
//@version=5
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="intrabar_ohlc", intrabarTieBreak="worst_case", allowShort=false)

ema_fast_len  = input.int(21,  title="EMA Fast",  minval=1)
ema_slow_len  = input.int(55,  title="EMA Slow",  minval=2)
ema_trend_len = input.int(200, title="EMA Trend", minval=10)

rsi_len = input.int(14,  title="RSI Length", minval=2)
rsi_min = input.float(52, title="RSI Min", minval=1, maxval=99, step=0.5)

atr_len  = input.int(14,  title="ATR Length", minval=2)
sl_atr   = input.float(2.0, title="SL = ATR x",  minval=0.1, step=0.1)
tp1_atr  = input.float(1.5, title="TP1 = ATR x", minval=0.1, step=0.1)
tp2_atr  = input.float(3.0, title="TP2 = ATR x", minval=0.1, step=0.1)

ema_fast  = ema(close, ema_fast_len)
ema_slow  = ema(close, ema_slow_len)
ema_trend = ema(close, ema_trend_len)

rsi_val = rsi(close, rsi_len)
atr_val = atr(high, low, close, atr_len)

plot(ema_fast,  title="EMA Fast",  color="#22c55e", width=2)
plot(ema_slow,  title="EMA Slow",  color="#3b82f6", width=2, style="dashed")
plot(ema_trend, title="EMA Trend", color="#94a3b8", width=2)

plot(rsi_val, title="RSI", color="#f59e0b", width=2, pane="sub")
hline(70, title="OB",  color="#ef4444", pane="sub")
hline(50, title="MID", color="#64748b", pane="sub")
hline(30, title="OS",  color="#22c55e", pane="sub")

long_cond = (close > ema_trend) and crossover(ema_fast, ema_slow) and (rsi_val > rsi_min)
exit_cond = crossunder(ema_fast, ema_slow)

plotshape(long_cond, text="BUY",  color=color.green,  location=location.belowbar, style=shape.triangleup)
plotshape(exit_cond, text="EXIT", color=color.orange, location=location.abovebar, style=shape.triangledown)

entry_px = close
sl_px  = entry_px - (atr_val * sl_atr)
tp1_px = entry_px + (atr_val * tp1_atr)
tp2_px = entry_px + (atr_val * tp2_atr)

strategy.entry("L", strategy.long, when=long_cond)
strategy.exit("TP1", side="long", limit=tp1_px, qty_percent=50)
strategy.exit("BRKT", side="long", stop=sl_px, limit=tp2_px, qty_percent=100)
strategy.exit("X", side="long", when=exit_cond, qty_percent=100)`},{title:"Pine (pro) · plotchar + close_all (sub pane anchored)",code:`//@pine
//@version=5
strategy(initial_capital=10000, commissionPct=0.06, slippagePct=0.02, pyramiding=1, execution="bar_close", allowShort=false)

len = input.int(14, title="RSI Length", minval=2)
rsi_val = rsi(close, len)

plot(rsi_val, title="RSI", color="#f59e0b", width=2, pane="sub")
hline(70, title="OB", color="#ef4444", pane="sub")
hline(50, title="MID", color="#64748b", pane="sub")
hline(30, title="OS", color="#22c55e", pane="sub")

go_long = crossover(rsi_val, 50)
close_all = crossunder(rsi_val, 50)

// price=rsi_val anchors labels to RSI series (so sub pane never looks blank)
plotchar(go_long,   char="L", color="#22c55e", location=location.belowbar, pane="sub", price=rsi_val, size=size.large)
plotchar(close_all, char="X", color="#f59e0b", location=location.abovebar, pane="sub", price=rsi_val, size=size.large)

strategy.entry("L", strategy.long, when=go_long)
strategy.close_all(when=close_all)`},{title:"Simple · EMA 20 (main)",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#3b82f6", "width": 2 }
  ]
}`},{title:"Simple · Stochastic (sub)",code:`{
  "pane": "sub",
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "stoch", "type": "stoch", "kPeriod": 14, "dPeriod": 3 }
  ],
  "plots": [
    { "name": "%K", "source": "stoch_k", "color": "#1E90FF", "width": 2 },
    { "name": "%D", "source": "stoch_d", "color": "#FF1493", "width": 2, "style": "dashed" }
  ]
}`},{title:"EMA 20/50 cross labels",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema50", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema20 crossesAbove ema50", "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "ema20 crossesBelow ema50", "text": "SELL", "color": "#ef4444", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ]
}`},{title:"Drawing · Fibonacci + trendline (script)",code:`{
  "pane": "main",
  "overlays": [
    {
      "name": "fibonacciSegment",
      "points": [
        { "index": -120, "source": "low" },
        { "index": -20,  "source": "high" }
      ],
      "extendData": {
        "fibonacciLevels": [
          { "value": 0,     "color": "#64748b", "label": "0" },
          { "value": 0.382, "color": "#60a5fa", "label": "0.382" },
          { "value": 0.5,   "color": "#22c55e", "label": "0.5" },
          { "value": 0.618, "color": "#f59e0b", "label": "0.618" },
          { "value": 1,     "color": "#64748b", "label": "1" }
        ]
      }
    },
    {
      "name": "horizontalRayLine",
      "points": [
        { "index": -20, "source": "close" }
      ]
    },
    {
      "name": "note",
      "points": [
        { "index": -20, "source": "close" }
      ],
      "extendData": {
        "in_text": "SCRIPT NOTE",
        "in_color": "#22c55e",
        "line_color": "#22c55e"
      }
    }
  ]
}`},{title:"Strategy · Orders (market entry + partial exits)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 2,
    "allowShort": false
  },
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 },
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema50", "color": "#60a5fa", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema20 crossesAbove ema50", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "rsi14 crossesAbove 70",    "text": "TP 50%", "shape": "pill",               "color": "#16a34a", "position": "above", "source": "high" },
    { "when": "ema20 crossesBelow ema50", "text": "EXIT", "shape": "triangle_down_filled", "color": "#f59e0b", "position": "above", "source": "high" }
  ],
  "signals": [
    {
      "id": "ENTRY",
      "type": "entry_long",
      "when": "ema20 crossesAbove ema50",
      "order": { "kind": "market", "qtyPct": 100 }
    },
    {
      "id": "TP_PART",
      "type": "exit_long",
      "when": "rsi14 crossesAbove 70",
      "order": { "kind": "market", "qtyPct": 50 }
    },
    {
      "id": "EXIT_FULL",
      "type": "exit_long",
      "when": "(ema20 crossesBelow ema50) or (rsi14 crossesBelow 50)",
      "order": { "kind": "market", "qtyPct": 100 }
    }
  ]
}`},{title:"Strategy · Stop‑Limit entry (expiresBars)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "allowShort": false
  },
  "calc": [
    { "name": "dc",    "type": "donchian", "period": 20 },
    { "name": "atr14", "type": "atr", "period": 14 }
  ],
  "series": [
    { "name": "entry_stop",  "expr": "dc_upper" },
    { "name": "entry_limit", "expr": "add(dc_upper, mul(atr14, 0.05))" }
  ],
  "plots": [
    { "name": "DC Upper", "source": "dc_upper", "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "DC Lower", "source": "dc_lower", "color": "#ef4444", "width": 1, "style": "dashed" }
  ],
  "signals": [
    {
      "id": "BRK",
      "type": "entry_long",
      "when": "close crossesAbove dc_upper",
      "order": {
        "kind": "stop_limit",
        "stopPrice": "entry_stop",
        "limitPrice": "entry_limit",
        "expiresBars": 20
      }
    }
  ]
}`},{title:"Strategy · Smoke test (guaranteed trades)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "bar_close",
    "pyramiding": 1,
    "allowShort": false
  },
  "signals": [
    {
      "id": "ONE",
      "type": "entry_long",
      "when": "close > 0",
      "cooldownBars": 999999,
      "order": { "kind": "market", "qtyPct": 100 }
    }
  ]
}`},{title:"Strategy · Auto Fibonacci (pivot swing) 50% → 100%",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "allowShort": false
  },
  "calc": [
    {
      "name": "fibo",
      "type": "auto_fib",
      "method": "pivots",
      "pivotLeft": 3,
      "pivotRight": 3,
      "lookback": 400,
      "direction": "up",
      "draw": true
    }
  ],
  "plots": [
    { "name": "Fibo 50",  "source": "fibo_50",  "color": "rgba(34,197,94,0.9)", "width": 1, "style": "dotted" },
    { "name": "Fibo 100", "source": "fibo_100", "color": "rgba(148,163,184,0.9)", "width": 1, "style": "dashed" }
  ],
  "labels": [
    { "when": "between(fibo_50, low, high)",  "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "between(fibo_100, low, high)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "between(fibo_50, low, high)" },
    { "type": "exit_long",  "when": "between(fibo_100, low, high)" }
  ]
}`},{title:"Strategy · EMA cross backtest (SL/TP)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "stopLossPct": 1.5,
    "takeProfitPct": 3,
    "trailingStopPct": 1,
    "allowShort": false
  },
  "calc": [
    { "name": "ema_fast", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema_slow", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema_fast", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema_slow", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema_fast crossesAbove ema_slow", "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "ema_fast crossesBelow ema_slow", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "ema_fast crossesAbove ema_slow" },
    { "type": "exit_long",  "when": "ema_fast crossesBelow ema_slow" }
  ]
}`},{title:"RSI signals + backtest (sub)",code:`{
  "pane": "sub",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02
  },
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "RSI", "source": "rsi14", "color": "#60a5fa", "width": 2 }
  ],
  "levels": [
    { "name": "30", "value": 30, "color": "#64748b", "style": "dotted" },
    { "name": "50", "value": 50, "color": "#94a3b8" },
    { "name": "70", "value": 70, "color": "#64748b", "style": "dotted" }
  ],
  "labels": [
    { "when": "rsi14 crossesAbove 50", "text": "BUY",  "color": "#16a34a", "position": "above", "source": "rsi14", "shape": "pill", "textPadding": 10 },
    { "when": "rsi14 crossesBelow 50", "text": "SELL", "color": "#ef4444", "position": "below", "source": "rsi14", "shape": "pill", "textPadding": 10 }
  ],
  "signals": [
    { "type": "entry_long",  "when": "rsi14 crossesAbove 50" },
    { "type": "entry_short", "when": "rsi14 crossesBelow 50" }
  ]
}`},{title:"Bollinger basis glow",code:`{
  "pane": "main",
  "calc": [
    { "name": "bb", "type": "bbands", "source": "close", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "BB Glow", "source": "bb_mid", "type": "neon_line", "color": "rgba(0,255,255,0.35)", "width": 8 },
    { "name": "BB Core", "source": "bb_mid", "type": "line", "color": "#00ffff", "width": 2 }
  ]
}`},{title:"Full Bollinger with fill",code:`{
  "pane": "main",
  "calc": [
    { "name": "bb", "type": "bbands", "source": "close", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "Upper", "source": "bb_upper", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Lower", "source": "bb_lower", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Mid Glow", "source": "bb_mid", "type": "neon_line", "color": "rgba(0,255,255,0.30)", "width": 8 },
    { "name": "Mid", "source": "bb_mid", "type": "line", "color": "#00ffff", "width": 2 }
  ],
  "fills": [
    { "between": ["bb_upper", "bb_lower"], "color": "rgba(0,255,255,0.10)" }
  ]
}`},{title:"Shape · tags at swing",code:`{
  "pane": "main",
  "calc": [
    { "name": "ph", "type": "pivot_high", "left": 3, "right": 3 },
    { "name": "pl", "type": "pivot_low",  "left": 3, "right": 3 }
  ],
  "labels": [
    { "when": "swinghigh(3)", "text": "▲ HH", "color": "#ef4444", "position": "above", "source": "ph", "shape": "tag" },
    { "when": "swinglow(3)",  "text": "▼ LL", "color": "#22c55e", "position": "below", "source": "pl", "shape": "tag" }
  ]
}`},{title:"Box shape · engulfing",code:`{
  "pane": "main",
  "series": [
    { "name": "prevOpen",  "expr": "lag(open, 1)" },
    { "name": "prevClose", "expr": "lag(close, 1)" }
  ],
  "labels": [
    { "when": "(close>open) and (prevClose<prevOpen) and (close>=prevOpen) and (open<=prevClose)", "shape": "box", "boxMode": "wick", "bgColor": "rgba(59,130,246,0.25)", "borderColor": "#3b82f6", "text": "Bullish Engulfing", "position": "below", "source": "low",  "size": 2, "offsetY": 12 },
    { "when": "(close<open) and (prevClose>prevOpen) and (close<=prevOpen) and (open>=prevClose)", "shape": "box", "boxMode": "wick", "bgColor": "rgba(59,130,246,0.25)", "borderColor": "#3b82f6", "text": "Bearish Engulfing", "position": "above", "source": "high", "size": 2, "offsetY": 12 }
  ]
}`},{title:"Trendlines · auto",code:`{
  "pane": "main",
  "calc": [
    { "name": "ph", "type": "pivot_high", "left": 3, "right": 3 },
    { "name": "pl", "type": "pivot_low",  "left": 3, "right": 3 },
    { "name": "ph_prev", "type": "prev_value", "source": "ph" },
    { "name": "pl_prev", "type": "prev_value", "source": "pl" }
  ],
  "plots": [
    { "name": "PH", "source": "ph", "type": "dots", "color": "#ef4444", "width": 2 },
    { "name": "PL", "source": "pl", "type": "dots", "color": "#22c55e", "width": 2 }
  ],
  "lines": [
    { "name": "Down TL", "segmentsFrom": "ph", "color": "#64748b", "width": 1, "style": "dotted", "extend": "right", "maxSegments": 50 },
    { "name": "Up TL",   "segmentsFrom": "pl", "color": "#64748b", "width": 1, "style": "dotted", "extend": "right", "maxSegments": 50 }
  ],
  "labels": [
    { "when": "swinghigh(3)", "text": "▲ HH", "color": "#ef4444", "position": "above", "source": "ph", "shape": "tag" },
    { "when": "swinglow(3)",  "text": "▼ LL", "color": "#22c55e", "position": "below", "source": "pl", "shape": "tag" }
  ]
}`},{title:"Advanced · EMA200 pullback (backtest)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "trailingStopPct": 1.2,
    "allowShort": false
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "ema20",  "type": "ema", "source": "close", "period": 20 },
    { "name": "rsi14",  "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "EMA 20",  "source": "ema20",  "color": "#22c55e", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (rsi14 crossesAbove 35)", "text": "LONG", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" },
    { "when": "(rsi14 crossesAbove 55) or (close crossesBelow ema20)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "(close > ema200) and (rsi14 crossesAbove 35)" },
    { "type": "exit_long",  "when": "(rsi14 crossesAbove 55) or (close crossesBelow ema20)" }
  ]
}`},{title:"Advanced · Donchian breakout (backtest)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "stopLossPct": 2.2,
    "takeProfitPct": 4.5,
    "trailingStopPct": 1.4,
    "allowShort": false
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "dc", "type": "donchian", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "DC Upper", "source": "dc_upper", "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "DC Mid",   "source": "dc_mid",   "color": "#64748b", "width": 1, "style": "dotted" },
    { "name": "DC Lower", "source": "dc_lower", "color": "#ef4444", "width": 1, "style": "dashed" },
    { "name": "EMA 50",   "source": "ema50",   "color": "#60a5fa", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (close crossesAbove dc_upper)", "text": "BREAK", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" },
    { "when": "(close crossesBelow dc_mid) or (close crossesBelow ema50)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "(close > ema200) and (close crossesAbove dc_upper)" },
    { "type": "exit_long",  "when": "(close crossesBelow dc_mid) or (close crossesBelow ema50)" }
  ]
}`},{title:"Keltner channels + mid",code:`{
  "pane": "main",
  "calc": [
    { "name": "kc", "type": "keltner", "period": 20, "mult": 2 }
  ],
  "plots": [
    { "name": "KC Mid", "source": "kc_mid",    "color": "#22c55e", "width": 2 },
    { "name": "KC Up",  "source": "kc_upper",  "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "KC Low", "source": "kc_lower",  "color": "#22c55e", "width": 1, "style": "dashed" }
  ]
}`},{title:"ATR bands",code:`{
  "pane": "main",
  "calc": [
    { "name": "atrb", "type": "atr_bands", "period": 14, "mult": 2 }
  ],
  "plots": [
    { "name": "ATR Up",  "source": "atrb_upper", "color": "#94a3b8", "width": 1 },
    { "name": "ATR Low", "source": "atrb_lower", "color": "#94a3b8", "width": 1 }
  ]
}`},{title:"VWAP bands",code:`{
  "pane": "main",
  "calc": [
    { "name": "vb", "type": "vwap_bands", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "VWAP Mid", "source": "vb_mid",   "color": "#22c55e", "width": 2 },
    { "name": "VWAP Up",  "source": "vb_upper", "color": "#22c55e", "width": 1, "style": "dashed" },
    { "name": "VWAP Low", "source": "vb_lower", "color": "#22c55e", "width": 1, "style": "dashed" }
  ]
}`},{title:"Stochastic cross + backtest (sub)",code:`{
  "pane": "sub",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02
  },
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "stoch", "type": "stoch", "kPeriod": 14, "dPeriod": 3 }
  ],
  "plots": [
    { "name": "%K", "source": "stoch_k", "color": "#1E90FF", "width": 2 },
    { "name": "%D", "source": "stoch_d", "color": "#FF1493", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "stoch_k crossesAbove stoch_d", "text": "K>D", "color": "#16a34a", "position": "above", "source": "stoch_k", "shape": "pill" },
    { "when": "stoch_k crossesBelow stoch_d", "text": "K<D", "color": "#ef4444", "position": "below", "source": "stoch_k", "shape": "pill" }
  ],
  "signals": [
    { "type": "entry_long",  "when": "stoch_k crossesAbove stoch_d" },
    { "type": "entry_short", "when": "stoch_k crossesBelow stoch_d" }
  ]
}`},{title:"Ichimoku cloud (core)",code:`{
  "pane": "main",
  "calc": [
    { "name": "ichimoku", "type": "ichimoku", "tenkan": 9, "kijun": 26, "senkouB": 52 }
  ],
  "plots": [
    { "name": "Tenkan", "source": "tenkan", "color": "#22c55e", "width": 1 },
    { "name": "Kijun",  "source": "kijun",  "color": "#ef4444", "width": 1 }
  ]
}`},{title:"Complex combo signals",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "ema50",  "type": "ema", "source": "close", "period": 50 },
    { "name": "ema20",  "type": "ema", "source": "close", "period": 20 },
    { "name": "macd",   "type": "macd", "source": "close", "fast": 12, "slow": 26, "signal": 9 },
    { "name": "rsi14",  "type": "rsi",  "source": "close", "period": 14 },
    { "name": "sar",    "type": "sar",  "step": 0.02, "max": 0.2 }
  ],
  "labels": [
    { "when": "(close>ema200) and (ema20>ema50) and (macd_line>macd_signal) and (rsi14>55) and (sar<close)", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "(close<ema200) and (ema20<ema50) and (macd_line<macd_signal) and (rsi14<45) and (sar>close)", "text": "SELL", "shape": "triangle_down_filled", "color": "#ef4444", "position": "above", "source": "high" }
  ]
}`},{title:"EMA cross filtered",code:`{
  "pane": "main",
  "calc": [
    { "name": "ema_fast", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema_slow", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema_fast", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema_slow", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema_fast crossesAbove ema_slow and trend(up)",  "text": "BUY",  "color": "#16a34a", "position": "below", "source": "low",  "shape": "triangle_up_filled" },
    { "when": "ema_fast crossesBelow ema_slow and trend(down)", "text": "SELL", "color": "#ef4444", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ]
}`}];try{const U=p.findIndex(G=>String((G==null?void 0:G.title)||"").toLowerCase().includes("multi-symbol spread"));if(U>=0){const G=p[U];let Z=String(G.code||"");Z=Z.replace(/lookbk\s*=\s*input\.int\(\s*20\s*,/,"lookbk  = input.int(10,"),Z=Z.replace(/z\s*=\s*\(spread\s*-\s*mu\)\s*\/\s*sd/g,"z = (spread - mu) / nz(sd, 0.000001)"),p[U]={...G,code:Z}}}catch{}const _=`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "stopLossPct": 2,
    "takeProfitPct": 4,
    "allowShort": false
  },
  "calc": [
    { "name": "dc",    "type": "donchian", "period": 20 },
    { "name": "atr14", "type": "atr", "period": 14 }
  ],
  "series": [
    { "name": "dc_upper_prev", "expr": "lag(dc_upper, 1)" },
    { "name": "entry_stop",  "expr": "dc_upper_prev" },
    { "name": "entry_limit", "expr": "add(dc_upper_prev, mul(atr14, 0.05))" }
  ],
  "plots": [
    { "name": "DC Upper",      "source": "dc_upper",      "color": "#94a3b8", "width": 1, "style": "dashed" },
    { "name": "DC Upper prev", "source": "dc_upper_prev", "color": "#22c55e", "width": 2 },
    { "name": "DC Lower",      "source": "dc_lower",      "color": "#ef4444", "width": 1, "style": "dashed" }
  ],
  "signals": [
    {
      "id": "BRK",
      "type": "entry_long",
      "when": "high crossesAbove entry_stop",
      "order": {
        "kind": "stop_limit",
        "stopPrice": "entry_stop",
        "limitPrice": "entry_limit",
        "expiresBars": 20
      }
    }
  ]
}`,y=`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "stopLossPct": 2.2,
    "takeProfitPct": 4.5,
    "trailingStopPct": 1.4,
    "allowShort": false
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "dc", "type": "donchian", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "series": [
    { "name": "dc_upper_prev", "expr": "lag(dc_upper, 1)" },
    { "name": "dc_mid_prev",   "expr": "lag(dc_mid, 1)" }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "DC Upper", "source": "dc_upper", "color": "#60a5fa", "width": 1, "style": "dashed" },
    { "name": "DC Mid",   "source": "dc_mid",   "color": "#64748b", "width": 1, "style": "dotted" },
    { "name": "DC Lower", "source": "dc_lower", "color": "#ef4444", "width": 1, "style": "dashed" },
    { "name": "EMA 50",   "source": "ema50",   "color": "#22c55e", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (high crossesAbove dc_upper_prev)", "text": "BREAK", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" },
    { "when": "(close crossesBelow dc_mid_prev) or (close crossesBelow ema50)", "text": "EXIT", "color": "#f59e0b", "position": "above", "source": "high", "shape": "triangle_down_filled" }
  ],
  "signals": [
    { "type": "entry_long", "when": "(close > ema200) and (high crossesAbove dc_upper_prev)" },
    { "type": "exit_long",  "when": "(close crossesBelow dc_mid_prev) or (close crossesBelow ema50)" }
  ]
}`,L=p.map(U=>U.title==="Strategy · Stop‑Limit entry (expiresBars)"?{...U,code:_}:U.title==="Advanced · Donchian breakout (backtest)"?{...U,code:y}:U).concat([{title:"Strategy · Bracket entry (SL/TP + partials)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "allowShort": false
  },
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema50", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#22c55e", "width": 2 },
    { "name": "EMA 50", "source": "ema50", "color": "#60a5fa", "width": 2, "style": "dashed" }
  ],
  "labels": [
    { "when": "ema20 crossesAbove ema50", "text": "BUY",  "shape": "triangle_up_filled",   "color": "#16a34a", "position": "below", "source": "low" },
    { "when": "ema20 crossesBelow ema50", "text": "EXIT", "shape": "triangle_down_filled", "color": "#f59e0b", "position": "above", "source": "high" }
  ],
  "signals": [
    {
      "id": "L",
      "type": "entry_long",
      "when": "ema20 crossesAbove ema50",
      "order": {
        "kind": "market",
        "qtyPct": 100,
        "bracket": {
          "stopLossPct": 1.2,
          "trailingStopPct": 0.9,
          "takeProfits": [
            { "takeProfitPct": 1.0, "qtyPct": 50 },
            { "takeProfitPct": 2.0, "qtyPct": 50 }
          ]
        }
      }
    },
    {
      "id": "X",
      "type": "exit_long",
      "when": "ema20 crossesBelow ema50",
      "order": { "kind": "market", "qtyPct": 100 }
    }
  ]
}`},{title:"Strategy · Intrabar pending entry (same‑bar exits)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "ohlc",
    "ohlcPath": "open_high_low_close",
    "pyramiding": 1,
    "allowShort": false
  },
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#60a5fa", "width": 2 }
  ],
  "labels": [
    { "when": "close > 0", "text": "STOP BUY (pending)", "shape": "tag", "color": "#64748b", "position": "above", "source": "high", "offsetY": -14 }
  ],
  "signals": [
    {
      "id": "PENDING_STOP",
      "type": "entry_long",
      "when": "close > 0",
      "cooldownBars": 999999,
      "order": {
        "kind": "stop",
        "price": "low",
        "bracket": {
          "stopLossPct": 0.25,
          "takeProfitPct": 0.35
        }
      }
    }
  ]
}`},{title:"Strategy · Donchian stop entry (lag + bracket)",code:`{
  "pane": "main",
  "strategy": {
    "initialCapital": 10000,
    "orderSize": { "type": "percent_of_equity", "value": 100 },
    "commissionPct": 0.1,
    "slippagePct": 0.02,
    "execution": "intrabar_ohlc",
    "intrabarTieBreak": "worst_case",
    "pyramiding": 1,
    "allowShort": false,
    "closeOnEnd": true
  },
  "calc": [
    { "name": "ema200", "type": "ema", "source": "close", "period": 200 },
    { "name": "dc", "type": "donchian", "period": 20 }
  ],
  "series": [
    { "name": "dc_upper_prev", "expr": "lag(dc_upper, 1)" }
  ],
  "plots": [
    { "name": "EMA 200", "source": "ema200", "color": "#94a3b8", "width": 2 },
    { "name": "DC Upper",      "source": "dc_upper",      "color": "#60a5fa", "width": 1, "style": "dashed" },
    { "name": "DC Upper prev", "source": "dc_upper_prev", "color": "#22c55e", "width": 2 }
  ],
  "labels": [
    { "when": "(close > ema200) and (high crossesAbove dc_upper_prev)", "text": "BREAK", "color": "#16a34a", "position": "below", "source": "low", "shape": "triangle_up_filled" }
  ],
  "signals": [
    {
      "id": "BRK_STOP",
      "type": "entry_long",
      "when": "(close > ema200) and (high crossesAbove dc_upper_prev)",
      "order": {
        "kind": "stop",
        "price": "dc_upper_prev",
        "qtyPct": 100,
        "bracket": {
          "stopLossPct": 1.2,
          "takeProfitPct": 2.4,
          "takeProfits": [{ "takeProfitPct": 1.2, "qtyPct": 50 }]
        }
      }
    }
  ]
}`},{title:"Pine (pro) · Functions + for loop + array.from (compile‑time)",code:`//@pine
//@version=5
// New Pine core (v1):
// - single-line functions: f(x)=>...
// - for-loops (compile-time unroll; body must be indented)
// - array.from + array.get (compile-time only)

upper(src, p, m) => sma(src, p) + (stdev(src, p) * m)
lower(src, p, m) => sma(src, p) - (stdev(src, p) * m)

p = input.int(20, title="Period")
m = input.float(2.0, title="Std", step=0.1)

basis = sma(close, p)
u = upper(close, p, m)
l = lower(close, p, m)

plot(basis, title="Basis", color="#94a3b8", width=2)
plot(u,     title="Upper", color="#22c55e", width=2)
plot(l,     title="Lower", color="#ef4444", width=2)

levels = array.from(30, 50, 70)
for i = 0 to 2
  hline(array.get(levels, i), title="RSI level", color="#64748b", style="dotted", pane="sub")

r = rsi(close, 14)
plot(r, title="RSI", color="#f59e0b", width=2, pane="sub")`}]),T=`WIN = 5
HIWIN = highest(close, WIN)
LOWIN = lowest(close, WIN)
signal top when (close == HIWIN)
signal bot when (close == LOWIN)
label at top text:"▲ fractal" color:#f97316
label at bot text:"▼ fractal" color:#3b82f6`,P=`{
  "pane": "main",
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema20", "color": "#3b82f6", "width": 2, "style": "solid" }
  ]
}`,A=`{
  "pane": "main",
  "calc": [
    { "name": "ema_fast", "type": "ema", "source": "close", "period": 20 },
    { "name": "ema_slow", "type": "ema", "source": "close", "period": 50 }
  ],
  "plots": [
    { "name": "EMA 20", "source": "ema_fast", "color": "#22c55e", "width": 2, "style": "solid" },
    { "name": "EMA 50", "source": "ema_slow", "color": "#3b82f6", "width": 2, "style": "dashed" }
  ]
}`,F=`{
  "pane": "sub",
  "strategy": {
    "initialCapital": 10000,
    "commissionPct": 0.1,
    "slippagePct": 0.02
  },
  "min": 0,
  "max": 100,
  "calc": [
    { "name": "rsi14", "type": "rsi", "source": "close", "period": 14 }
  ],
  "plots": [
    { "name": "RSI 14", "source": "rsi14", "color": "#60a5fa", "width": 2 }
  ],
  "levels": [
    { "name": "30", "value": 30, "color": "#64748b", "style": "dotted" },
    { "name": "50", "value": 50, "color": "#94a3b8" },
    { "name": "70", "value": 70, "color": "#64748b", "style": "dotted" }
  ],
  "labels": [
    { "when": "rsi14 crossesAbove 50", "text": "BUY",  "color": "#16a34a", "position": "above", "source": "rsi14", "shape": "pill", "textPadding": 10 },
    { "when": "rsi14 crossesBelow 50", "text": "SELL", "color": "#ef4444", "position": "below", "source": "rsi14", "shape": "pill", "textPadding": 10 }
  ],
  "signals": [
    { "type": "entry_long",  "when": "rsi14 crossesAbove 50" },
    { "type": "entry_short", "when": "rsi14 crossesBelow 50" }
  ]
}`,B=`{
  "pane": "main",
  "calc": [
    { "name": "bb", "type": "bbands", "source": "close", "period": 20, "std": 2 }
  ],
  "plots": [
    { "name": "Upper", "source": "bb_upper", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Lower", "source": "bb_lower", "type": "line", "color": "#00ffff", "width": 1, "style": "dashed" },
    { "name": "Mid Glow", "source": "bb_mid", "type": "neon_line", "color": "rgba(0,255,255,0.30)", "width": 8 },
    { "name": "Mid", "source": "bb_mid", "type": "line", "color": "#00ffff", "width": 2 }
  ],
  "fills": [
    { "between": ["bb_upper", "bb_lower"], "color": "rgba(0,255,255,0.10)" }
  ]
}`,R=`{
  "calc": [
    { "name": "ema20", "type": "ema", "source": "close", "period": 20 },
    { "name": "stoch", "type": "stoch", "kPeriod": 14, "dPeriod": 3 }
  ],
  "main": {
    "plots": [
      { "name": "EMA 20", "source": "ema20", "color": "#3b82f6", "width": 2, "style": "solid" }
    ]
  },
  "sub": {
    "min": 0,
    "max": 100,
    "plots": [
      { "name": "%K", "source": "stoch_k", "color": "#1E90FF", "width": 2, "style": "solid" },
      { "name": "%D", "source": "stoch_d", "color": "#FF1493", "width": 2, "style": "dashed" }
    ],
    "levels": [
      { "name": "OB", "value": 80, "color": "#f97316", "width": 1, "style": "dashed" },
      { "name": "OS", "value": 20, "color": "#22c55e", "width": 1, "style": "dashed" }
    ]
  }
}`,N=`{
  "pane": "main",
  "calc": [
    { "name": "ph_s", "type": "pivot_high", "left": 2, "right": 2 },
    { "name": "pl_s", "type": "pivot_low",  "left": 2, "right": 2 },
    { "name": "ph_m", "type": "pivot_high", "left": 5, "right": 5 },
    { "name": "pl_m", "type": "pivot_low",  "left": 5, "right": 5 },
    { "name": "ph_l", "type": "pivot_high", "left": 10, "right": 10 },
    { "name": "pl_l", "type": "pivot_low",  "left": 10, "right": 10 }
  ],
  "lines": [
    { "name": "Minor Down", "segmentsFrom": "ph_s", "color": "#fb7185", "width": 1,   "style": "dotted", "extend": "right", "maxSegments": 150 },
    { "name": "Minor Up",   "segmentsFrom": "pl_s", "color": "#86efac", "width": 1,   "style": "dotted", "extend": "right", "maxSegments": 150 },
    { "name": "Mid Down",   "segmentsFrom": "ph_m", "color": "#f97316", "width": 1.5, "style": "dashed", "extend": "right", "maxSegments": 100 },
    { "name": "Mid Up",     "segmentsFrom": "pl_m", "color": "#22d3ee", "width": 1.5, "style": "dashed", "extend": "right", "maxSegments": 100 },
    { "name": "Major Down", "segmentsFrom": "ph_l", "color": "#ef4444", "width": 2,   "style": "solid",  "extend": "both",  "maxSegments": 60 },
    { "name": "Major Up",   "segmentsFrom": "pl_l", "color": "#22c55e", "width": 2,   "style": "solid",  "extend": "both",  "maxSegments": 60 }
  ]
}`;Ud();var $=Xt(),V=_t($);Se(V,t,U=>{var G=sq();G.__click=[HW,a];var Z=g(G),le=g(Z),se=u(g(le),2);se.__click=a,f(le);var ie=u(le,2),Y=g(ie),K=g(Y);K.__click=[GW,s];var Q=u(K,2);Q.__click=[YW,s],f(Y);var q=u(Y,2);Se(q,()=>n(s)==="details",ce=>{var _e=JW(),me=g(_e),Pe=u(g(me),2),ze=g(Pe);ze.__click=[UW,i];var he=u(ze,2);he.__click=[KW,i],f(Pe),f(me);var De=u(me,2);Se(De,()=>n(i)==="bn",ge=>{var be=ZW(),$e=u(_t(be),10),Ve=u(g($e),2),Ce=g(Ve);Ce.textContent=T,f(Ve),f($e);var Je=u($e,2),ye=u(g(Je),2),Ae=g(ye);Ae.textContent=P,f(ye),f(Je);var ee=u(Je,8),xe=u(g(ee),2),ke=u(g(xe));ke.textContent='{ index: -20, source: "high" }',un(),f(xe),un(2),f(ee);var He=u(ee,4),Ie=u(g(He),10),ne=u(g(Ie));ne.textContent='{ "kind":"stop_limit", "stopPrice":"series", "limitPrice":"series" }',un(3),f(Ie),un(8),f(He);var J=u(He,10),qe=u(g(J),2),ft=g(qe);ft.textContent=A,f(qe),f(J);var Qe=u(J,8),Oe=g(Qe),ct=u(g(Oe),2);ct.textContent="${KEY}";var Lt=u(ct,2);Lt.textContent="${TOL}",un(),f(Oe);var It=u(Oe,2),zt=u(g(It));zt.textContent='"params": { "TOL": 0.0003 }';var pt=u(zt,4);pt.textContent="crossover(close, bb_mid, ${TOL})",f(It),un(2),f(Qe);var Mo=u(Qe,22),Xo=u(g(Mo),2),en=g(Xo);en.textContent=F,f(Xo),f(Mo);var Fo=u(Mo,4),Eo=u(g(Fo),2),cs=g(Eo);cs.textContent=N,f(Eo),f(Fo);var Zt=u(Fo,2),bs=u(g(Zt),2),es=g(bs);es.textContent=B,f(bs),f(Zt);var rn=u(Zt,4),wr=u(g(rn),2),rr=g(wr);rr.textContent=R,f(wr),f(rn),un(4),O(ge,be)},ge=>{var be=XW(),$e=u(_t(be),10),Ve=u(g($e),2),Ce=g(Ve);Ce.textContent=T,f(Ve),f($e);var Je=u($e,2),ye=u(g(Je),2),Ae=g(ye);Ae.textContent=P,f(ye),f(Je);var ee=u(Je,12),xe=u(g(ee),10),ke=u(g(xe));ke.textContent='{ "kind":"stop_limit", "stopPrice":"series", "limitPrice":"series" }',un(3),f(xe),un(14),f(ee);var He=u(ee,6),Ie=u(g(He),2),ne=g(Ie);ne.textContent=A,f(Ie),f(He);var J=u(He,8),qe=g(J),ft=u(g(qe),3);ft.textContent="${KEY}";var Qe=u(ft,2);Qe.textContent="${TOL}",un(),f(qe);var Oe=u(qe,2),ct=u(g(Oe));ct.textContent='"params": { "TOL": 0.0003 }';var Lt=u(ct,2);Lt.textContent="when: crossover(close, bb_mid, ${TOL})",f(Oe),un(2),f(J);var It=u(J,26),zt=u(g(It),2),pt=g(zt);pt.textContent=F,f(zt),f(It);var Mo=u(It,4),Xo=u(g(Mo),2),en=g(Xo);en.textContent=N,f(Xo),f(Mo);var Fo=u(Mo,2),Eo=u(g(Fo),2),cs=g(Eo);cs.textContent=B,f(Eo),f(Fo);var Zt=u(Fo,4),bs=u(g(Zt),2),es=g(bs);es.textContent=R,f(bs),f(Zt),un(4),O(ge,be)}),f(_e),we(()=>{Pn(ze,`ss-lang-btn ${(n(i)==="bn"?"active":"")??""} svelte-50qv65`),Pn(he,`ss-lang-btn ${(n(i)==="en"?"active":"")??""} svelte-50qv65`)}),O(ce,_e)},ce=>{var _e=oq(),me=u(g(_e),2);Ns(me,1,()=>L,dn,(Pe,ze)=>{var he=tq(),De=g(he),ge=g(De),be=g(ge,!0);f(ge);var $e=u(ge,2),Ve=g($e);Ve.__click=[QW,v,ze];var Ce=u(Ve);Ce.__click=[eq,d,ze],f($e),f(De);var Je=u(De,2),ye=g(Je),Ae=g(ye,!0);f(ye),f(Je),f(he),we(()=>{Ye(be,n(ze).title),Ye(Ae,n(ze).code)}),O(Pe,he)}),f(_e),O(ce,_e)}),f(ie),f(Z),f(G),we(()=>{Pn(K,`ss-tab ${(n(s)==="details"?"active":"")??""} svelte-50qv65`),St(K,"aria-selected",n(s)==="details"),Pn(Q,`ss-tab ${(n(s)==="examples"?"active":"")??""} svelte-50qv65`),St(Q,"aria-selected",n(s)==="examples")}),O(U,G)}),O(o,$),Za()}hc(["click"]);const Nx="scriptStudio.scripts";function iq(){try{const o=localStorage.getItem(Nx);if(!o)return[];const e=JSON.parse(o);return Array.isArray(e)?e:[]}catch{return[]}}function rq(o){try{localStorage.setItem(Nx,JSON.stringify(o))}catch{}}function aq(o,e,t){const s=iq(),i=Date.now(),a={id:`${i}`,name:o,code:e,tags:[],createdAt:i,updatedAt:i};return s.push(a),rq(s),a}const lq={signals:new Set,label:new Set};function u2(o,e){lq[o].forEach(t=>{try{t(e)}catch{}})}const N0=Id({});function cq(o,e){N0.update(t=>({...t,[o]:e}))}function dq(o){return zd(N0)[o]||[]}const uq=N0;function pq(o){N0.update(e=>{const{[o]:t,...s}=e;return s})}function vq(){N0.set({})}const sh=Id({}),fq=sh;function gq(o,e){sh.update(t=>({...t,[o]:e}))}function p2(o){sh.update(e=>{const{[o]:t,...s}=e;return s})}function mq(){sh.set({})}function nd(o,e){const t=typeof o=="number"?o:Number(o);return Number.isFinite(t)?t:e}function hq(o){if(o===!0)return{enabled:!0,execution:"intrabar_ohlc",intrabarTieBreak:"worst_case",ohlcPath:"open_high_low_close",initialCapital:1e4,orderSize:{type:"percent_of_equity",value:100},commissionPct:0,slippagePct:0,priceTick:null,qtyStep:null,minQty:null,spreadPct:null,leverage:1,maintenanceMarginPct:null,liquidationFeePct:null,borrowPctPerYear:null,fundingPctPerDay:null,positionMode:"netting",closeMethod:"fifo",pyramiding:1,stopLossPct:null,takeProfitPct:null,takeProfits:[],trailingStopPct:null,allowLong:!0,allowShort:!0,closeOnEnd:!0};if(!o||typeof o!="object")return null;const e=o;if(e.enabled===!1)return null;const t=String(e.execution||e.exec||e.mode||"").trim().toLowerCase()||"intrabar_ohlc",s=t==="bar_close"||t==="barclose"||t==="close"?"bar_close":"intrabar_ohlc",i=String(e.intrabarTieBreak||e.tieBreak||"").trim().toLowerCase(),r=i==="best_case"||i==="best"||i==="tp"?"best_case":i==="ohlc"||i==="path"?"ohlc":"worst_case",a=String(e.ohlcPath||e.path||"").trim().toLowerCase(),l=a==="open_low_high_close"||a==="olhc"?"open_low_high_close":"open_high_low_close",d=Math.max(0,nd(e.initialCapital,1e4)),v=Math.max(0,nd(e.commissionPct,0)),p=Math.max(0,nd(e.slippagePct,0)),_=e.priceTick??e.price_tick??e.tickSize??e.tick_size??e.tick??e.minTick??e.min_tick??null,y=e.qtyStep??e.qty_step??e.quantityStep??e.quantity_step??e.lotStep??e.lot_step??null,w=e.minQty??e.min_qty??e.minimumQty??e.minimum_qty??null,k=_==null?null:Math.max(0,nd(_,0)),S=y==null?null:Math.max(0,nd(y,0)),L=w==null?null:Math.max(0,nd(w,0)),T=e.spreadPct??e.spread_pct??e.spread??e.spreadBps??e.spread_bps??null,P=(()=>{if(T==null)return null;const ye=nd(T,0);return!Number.isFinite(ye)||ye<=0?null:"spreadBps"in e||"spread_bps"in e?ye/100:ye})(),A=e.leverage??e.lev??e.marginLeverage??e.margin_leverage??1,F=Math.max(1,nd(A,1)),B=e.maintenanceMarginPct??e.maintenance_margin_pct??e.maintMarginPct??null,R=e.liquidationFeePct??e.liquidation_fee_pct??e.liqFeePct??null,N=e.borrowPctPerYear??e.borrow_pct_per_year??e.shortBorrowPctPerYear??null,$=e.fundingPctPerDay??e.funding_pct_per_day??e.funding??null,V=B==null?null:Math.max(0,nd(B,0)),U=R==null?null:Math.max(0,nd(R,0)),G=N==null?null:Math.max(0,nd(N,0)),Z=$==null?null:Math.max(0,nd($,0)),le=String(e.positionMode??e.position_mode??"").trim().toLowerCase(),se=le==="hedge"||le==="hedging"?"hedging":"netting",ie=String(e.closeMethod??e.close_method??e.costBasis??e.cost_basis??"").trim().toLowerCase(),Y=ie==="lifo"?"lifo":ie==="avg"||ie==="average"?"avg":"fifo",K=Math.max(1,Math.min(50,Math.floor(nd(e.pyramiding??e.maxEntries??e.max_positions??e.maxPositions??1,1)))),Q=e.stopLossPct??e.slPct??e.sl??e.stopLoss??e.stop_loss??null,q=e.takeProfitPct??e.tpPct??e.tp??e.takeProfit??e.take_profit??null,ce=e.trailingStopPct??e.trailPct??e.trailing??e.trailingStop??null,_e=Q==null?null:Math.max(0,nd(Q,0)),me=q==null?null:Math.max(0,nd(q,0)),Pe=ce==null?null:Math.max(0,nd(ce,0)),ze=typeof e.allowLong=="boolean"?e.allowLong:e.allowLong!==!1,he=typeof e.allowShort=="boolean"?e.allowShort:e.allowShort!==!1,De=typeof e.closeOnEnd=="boolean"?e.closeOnEnd:e.closeOnEnd!==!1,ge=e.takeProfits??e.tpLevels??e.takeProfitLevels??[],be=[];if(Array.isArray(ge))for(const ye of ge){if(!ye||typeof ye!="object")continue;const Ae=nd(ye.takeProfitPct??ye.tpPct??ye.pct,NaN),ee=nd(ye.qtyPct??ye.qty??ye.percent,NaN);!Number.isFinite(Ae)||Ae<=0||!Number.isFinite(ee)||ee<=0||be.push({takeProfitPct:Ae,qtyPct:Math.max(0,Math.min(100,ee))})}be.sort((ye,Ae)=>ye.takeProfitPct-Ae.takeProfitPct);let $e=0;const Ve=[];for(const ye of be){if($e>=100)break;const Ae=100-$e,ee=Math.min(Ae,ye.qtyPct);ee<=0||(Ve.push({takeProfitPct:ye.takeProfitPct,qtyPct:ee}),$e+=ee)}const Ce=e.orderSize??e.positionSize??e.order??null;let Je={type:"percent_of_equity",value:100};if(Ce&&typeof Ce=="object"){const ye=String(Ce.type||"").trim().toLowerCase(),Ae=nd(Ce.value,100);ye==="cash"?Je={type:"cash",value:Math.max(0,Ae)}:ye==="qty"?Je={type:"qty",value:Math.max(0,Ae)}:ye?Je={type:"percent_of_equity",value:Math.max(0,Math.min(100,Ae))}:Je={type:"percent_of_equity",value:Math.max(0,Math.min(100,Ae))}}else if(Ce!=null){const ye=nd(Ce,100);Je={type:"percent_of_equity",value:Math.max(0,Math.min(100,ye))}}return{enabled:!0,execution:s,intrabarTieBreak:r,ohlcPath:l,initialCapital:d,orderSize:Je,commissionPct:v,slippagePct:p,priceTick:k&&k>0?k:null,qtyStep:S&&S>0?S:null,minQty:L&&L>0?L:null,spreadPct:P&&P>0?P:null,leverage:F,maintenanceMarginPct:V&&V>0?V:null,liquidationFeePct:U&&U>0?U:null,borrowPctPerYear:G&&G>0?G:null,fundingPctPerDay:Z&&Z>0?Z:null,positionMode:se,closeMethod:Y,pyramiding:K,stopLossPct:_e!=null&&_e>0?_e:null,takeProfitPct:me!=null&&me>0?me:null,takeProfits:Ve,trailingStopPct:Pe!=null&&Pe>0?Pe:null,allowLong:ze,allowShort:he,closeOnEnd:De}}function v2(o){return o==="exit_long"?0:o==="exit_short"?1:o==="entry_long"?2:o==="entry_short"?3:9}function Rx(o){const e=o==null?void 0:o.close;return typeof e=="number"&&Number.isFinite(e)?e:null}function E_(o){return typeof o=="number"&&Number.isFinite(o)?o:null}function _q(o){const e=Rx(o);if(e==null)return null;const t=E_(o==null?void 0:o.open)??e,s=E_(o==null?void 0:o.high)??Math.max(t,e),i=E_(o==null?void 0:o.low)??Math.min(t,e);return{o:t,h:s,l:i,c:e}}function yq(o,e,t){var or,tc;const s=t.initialCapital,i=t.commissionPct/100,r=t.slippagePct/100,a=t.priceTick&&t.priceTick>0?t.priceTick:null,l=t.qtyStep&&t.qtyStep>0?t.qtyStep:null,d=t.minQty&&t.minQty>0?t.minQty:null,v=t.spreadPct&&t.spreadPct>0?t.spreadPct/100:0,p=v>0?v/2:0,_=Math.max(1,Number(t.leverage)||1),y=t.maintenanceMarginPct&&t.maintenanceMarginPct>0?t.maintenanceMarginPct/100:null,w=t.liquidationFeePct&&t.liquidationFeePct>0?t.liquidationFeePct/100:null,k=t.borrowPctPerYear&&t.borrowPctPerYear>0?t.borrowPctPerYear/100:null,S=t.fundingPctPerDay&&t.fundingPctPerDay>0?t.fundingPctPerDay/100:null,L=pe=>{if(!Number.isFinite(pe)||pe<=0)return 0;const rt=String(pe),Ft=rt.match(/e-(\d+)$/i);if(Ft)return Math.max(0,Math.min(12,Number(Ft[1])||0));const Qt=rt.indexOf(".");return Qt>=0?Math.max(0,Math.min(12,rt.length-Qt-1)):0},T=(pe,rt,Ft)=>{if(!Number.isFinite(pe))return NaN;if(!Number.isFinite(rt)||rt<=0)return pe;const Qt=L(rt),xt=Math.pow(10,Qt),eo=Math.round(rt*xt);if(!Number.isFinite(eo)||eo<=0)return pe;const Is=pe*xt;return(Ft==="ceil"?Math.ceil(Is/eo-1e-12):Ft==="round"?Math.round(Is/eo):Math.floor(Is/eo+1e-12))*eo/xt},P=(pe,rt)=>l?T(pe,l,rt):pe,A=(pe,rt)=>pe==="entry"?rt==="long":rt==="short",F=(pe,rt)=>p?A(pe,rt)?1+p:1-p:1,B=(pe,rt,Ft)=>{const Qt=F(rt,Ft);return Qt===1?pe:{o:pe.o*Qt,h:pe.h*Qt,l:pe.l*Qt,c:pe.c*Qt}},R=(pe,rt,Ft,Qt)=>{if(!a)return Qt;const xt=A(pe,rt);return T(Qt,a,Ft==="limit"?xt?"floor":"ceil":xt?"ceil":"floor")},N=(pe,rt,Ft)=>{if(!a)return Ft;const xt=A(pe,rt)?"ceil":"floor";return T(Ft,a,xt)};let $=0,V=0;const U={long:[],short:[]},G=pe=>U[pe],Z=pe=>G(pe).some(rt=>rt.qty>1e-12),le=()=>Z("long")||Z("short"),se=pe=>G(pe).filter(rt=>rt.qty>1e-12).length,ie=pe=>pe==="long"?"short":"long",Y=[],K=[],Q=[],q=new Map;let ce=1;const _e=[],me=()=>`o${ce++}`,Pe=pe=>{var Ft;const rt=Number((Ft=o[pe])==null?void 0:Ft.timestamp);return Number.isFinite(rt)&&rt>0?rt:Date.now()},ze=pe=>{const rt=me(),Ft={id:rt,...pe};return Q.push(Ft),q.set(rt,Ft),Ft},he=(pe,rt)=>{if(!pe)return;const Ft=q.get(pe);Ft&&Object.assign(Ft,rt)},De=(Array.isArray(e)?e:[]).filter(pe=>typeof(pe==null?void 0:pe.index)=="number"&&pe.index>=0).slice().sort((pe,rt)=>pe.index-rt.index||v2(pe.type)-v2(rt.type));let ge=0,be=s,$e=0,Ve=1;const Ce={long:null,short:null},Je=(pe,rt)=>{const Ft=Ce[pe];if(Ft)return Ft;const Qt={id:`t${Ve++}`,side:pe,entryIndex:rt,entryTimestamp:Pe(rt),exitIndex:rt,exitTimestamp:Pe(rt),qtyEntered:0,entryNotional:0,qtyExited:0,exitNotional:0,grossPnl:0,fees:0,entries:0,exits:0};return Ce[pe]=Qt,Qt},ye=(pe,rt)=>{if(Z(pe))return;const Ft=Ce[pe];if(!Ft)return;const Qt=Ft.qtyEntered,xt=Qt>0?Ft.entryNotional/Qt:0,eo=Ft.qtyExited>0?Ft.exitNotional/Ft.qtyExited:0,Is=Ft.entryNotional>0?Ft.grossPnl/Ft.entryNotional*100:0;K.push({id:Ft.id,side:Ft.side,entryIndex:Ft.entryIndex,entryTimestamp:Ft.entryTimestamp,exitIndex:Ft.exitIndex,exitTimestamp:Ft.exitTimestamp,qty:Qt,avgEntryPrice:xt,avgExitPrice:eo,grossPnl:Ft.grossPnl,fees:Ft.fees,netPnl:Ft.grossPnl-Ft.fees,pnlPct:Is,entries:Ft.entries,exits:Ft.exits,maePct:typeof Ft.maeMin=="number"&&Number.isFinite(Ft.maeMin)?Ft.maeMin:void 0,mfePct:typeof Ft.mfeMax=="number"&&Number.isFinite(Ft.mfeMax)?Ft.mfeMax:void 0}),Ce[pe]=null},Ae=(pe,rt)=>{let Ft=0;for(const Qt of G("long"))Qt.qty<=0||(Ft+=(rt-Qt.entryPrice)*Qt.qty);for(const Qt of G("short"))Qt.qty<=0||(Ft+=(Qt.entryPrice-rt)*Qt.qty);return s+$+Ft-V},ee=(pe,rt)=>{if(t.orderSize.type==="cash")return Math.max(0,t.orderSize.value)*_;if(t.orderSize.type==="qty")return Math.max(0,t.orderSize.value*rt);const Ft=Math.max(0,Math.min(100,t.orderSize.value));return pe*Ft/100*_},xe=()=>{let pe=0;for(const rt of G("long"))pe+=rt.qty>0?rt.entryNotional:0;for(const rt of G("short"))pe+=rt.qty>0?rt.entryNotional:0;return pe},ke=()=>_>0?xe()/_:0,He=pe=>{const rt=Number(pe);if(!Number.isFinite(rt)||rt<=0)return{long:0,short:0,total:0};let Ft=0,Qt=0;for(const xt of G("long"))Ft+=xt.qty>0?xt.qty*rt:0;for(const xt of G("short"))Qt+=xt.qty>0?xt.qty*rt:0;return{long:Ft,short:Qt,total:Ft+Qt}},Ie=(pe,rt)=>{var pn,Jo;if(!le()||!k&&!S||pe<=0)return;const Ft=Number((pn=o[pe-1])==null?void 0:pn.timestamp),Qt=Number((Jo=o[pe])==null?void 0:Jo.timestamp);if(!Number.isFinite(Ft)||!Number.isFinite(Qt)||Qt<=Ft)return;const xt=Qt-Ft,eo=xt/864e5,Is=xt/(365*864e5);if(!Number.isFinite(eo)||eo<=0)return;const Po=He(rt);let Ze=0,Ke=0;S&&(Ze=Math.max(0,Po.total*S*eo)),k&&(Ke=Math.max(0,Po.short*k*Is));const ps=Ze+Ke;if(!(!Number.isFinite(ps)||ps<=0)){if(V+=ps,Ze>0&&Po.total>0){const ti=Ze*Po.long/Po.total,mr=Ze-ti;Ce.long&&(Ce.long.fees+=ti),Ce.short&&(Ce.short.fees+=mr)}Ke>0&&Ce.short&&(Ce.short.fees+=Ke)}},ne=(pe,rt,Ft)=>{if(!le())return!1;const Qt=Pe(pe);let xt=!1;for(const eo of["long","short"]){if(!Z(eo))continue;const Is=ze({action:"exit",side:eo,kind:"market",originalKind:"market",status:"pending",createdIndex:pe,createdTimestamp:Qt,activeFromIndex:pe,qtyPct:100,price:rt,note:Ft}),Po=Lt(eo,pe,rt,"liquidation","market",{orderId:Is.id},w??void 0);Po?(he(Is.id,{status:"filled",filledIndex:pe,filledTimestamp:Qt,fillPrice:Po.execPrice,fillQty:Po.qtyClosed,fees:Po.exitFees}),xt=!0):he(Is.id,{status:"rejected",note:`${Ft} (no fill)`})}if(xt&&pt.length){for(const eo of pt)he(eo.orderId,{status:"canceled",note:"Canceled on liquidation"});pt.length=0}return xt},J=(pe,rt)=>{if(!y||!le())return!1;const Ft=Ze=>{const Ke=Ae(pe,Ze),pn=He(Ze).total*y;return{px:Ze,equityNow:Ke,req:pn,gap:Ke-pn}},Qt=Ft(rt.l),xt=Ft(rt.h),eo=Number.isFinite(Qt.gap)&&Qt.gap<=1e-9,Is=Number.isFinite(xt.gap)&&xt.gap<=1e-9;if(!eo&&!Is)return!1;const Po=eo&&Is?Qt.gap<=xt.gap?Qt:xt:eo?Qt:xt;return ne(pe,Po.px,"AUTO liquidation")},qe=(pe,rt,Ft)=>{if(Ft==="limit")return N("entry",pe,rt);const Qt=rt*F("entry",pe),xt=pe==="long"?Qt*(1+r):Qt*(1-r);return N("entry",pe,xt)},ft=(pe,rt,Ft)=>{if(Ft==="limit")return N("exit",pe,rt);const Qt=rt*F("exit",pe),xt=pe==="long"?Qt*(1-r):Qt*(1+r);return N("exit",pe,xt)},Qe=pe=>{if(!pe||typeof pe!="object")return;const rt=Ke=>{const ps=typeof Ke=="number"?Ke:Number(Ke);return Number.isFinite(ps)?ps:void 0},Ft=rt(pe.stopLossPct),Qt=rt(pe.takeProfitPct),xt=rt(pe.trailingStopPct),eo=pe.takeProfits,Is=[];if(Array.isArray(eo))for(const Ke of eo){if(!Ke||typeof Ke!="object")continue;const ps=rt(Ke.takeProfitPct),pn=rt(Ke.qtyPct);ps==null||ps<=0||pn==null||pn<=0||Is.push({takeProfitPct:Math.max(0,ps),qtyPct:Math.max(0,Math.min(100,pn))})}Is.sort((Ke,ps)=>Ke.takeProfitPct-ps.takeProfitPct);let Po=0;const Ze=[];for(const Ke of Is){if(Po>=100)break;const ps=100-Po,pn=Math.min(ps,Ke.qtyPct);pn<=0||(Ze.push({takeProfitPct:Ke.takeProfitPct,qtyPct:pn}),Po+=pn)}if(!(Ft==null&&Qt==null&&xt==null&&Ze.length===0))return{stopLossPct:Ft,takeProfitPct:Qt,trailingStopPct:xt,takeProfits:Ze.length?Ze:void 0}},Oe=(pe,rt,Ft,Qt=100,xt="market",eo,Is)=>{var ri,vn,sr;if(t.positionMode==="netting"&&Z(ie(pe)))return{ok:!1,reject:"Netting mode: opposite position open"};if(se(pe)>=t.pyramiding)return{ok:!1,reject:`Pyramiding limit reached (${t.pyramiding})`};const Po=Ae(rt,Ft),Ze=qe(pe,Ft,xt);if(!Number.isFinite(Ze)||Ze<=0)return{ok:!1,reject:"Invalid fill price"};const Ke=Number.isFinite(Qt)?Math.max(0,Math.min(100,Qt)):100;if(Ke<=0)return{ok:!1,reject:"qtyPct <= 0"};const ps=ee(Po,Ze)*Ke/100;if(!Number.isFinite(ps)||ps<=0)return{ok:!1,reject:"Notional <= 0"};const pn=ps/Ze;if(!Number.isFinite(pn)||pn<=0)return{ok:!1,reject:"Qty <= 0"};const Jo=P(pn,"floor");if(!Number.isFinite(Jo)||Jo<=0)return l?{ok:!1,reject:`Qty rounded to 0 (qtyStep=${l})`}:{ok:!1,reject:"Qty <= 0"};if(d!=null&&Jo<d)return{ok:!1,reject:`Qty ${Jo} < minQty ${d}`};const ti=Ze*Jo,mr=_>0?ti/_:ti,sa=ke();if(mr>0&&sa+mr>Po+1e-9)return{ok:!1,reject:"Insufficient margin"};const yt=ti*i;V+=yt;{const Ko=Je(pe,rt);Ko.qtyEntered+=Jo,Ko.entryNotional+=ti,Ko.fees+=yt,Ko.entries+=1}const wt=t.closeMethod==="avg"?void 0:Qe(eo),to=(wt==null?void 0:wt.stopLossPct)!=null?wt.stopLossPct:t.stopLossPct,mt=(wt==null?void 0:wt.takeProfitPct)!=null?wt.takeProfitPct:t.takeProfitPct,Wt=(wt==null?void 0:wt.trailingStopPct)!=null?wt.trailingStopPct:t.trailingStopPct,vt=to&&to>0?pe==="long"?Ze*(1-to/100):Ze*(1+to/100):null,$t=mt&&mt>0?pe==="long"?Ze*(1+mt/100):Ze*(1-mt/100):null,zo=vt!=null&&Number.isFinite(vt)?R("exit",pe,"stop",vt):null,bo=$t!=null&&Number.isFinite($t)?R("exit",pe,"limit",$t):null,xo={side:pe,qty:Jo,entryIndex:rt,entryTimestamp:((ri=o[rt])==null?void 0:ri.timestamp)??Date.now(),entryPrice:Ze,entrySignalId:Is==null?void 0:Is.signalId,entryOrderId:Is==null?void 0:Is.orderId,entryNotional:ti,entryFee:yt,entryFeeRemaining:yt,stopPrice:zo&&Number.isFinite(zo)?zo:null,takePrice:bo&&Number.isFinite(bo)?bo:null,trailingPct:Wt,trailingStop:Wt&&Wt>0?pe==="long"?R("exit",pe,"stop",Ze*(1-Wt/100)):R("exit",pe,"stop",Ze*(1+Wt/100)):null,takeProfitOrders:[],maxFav:Ze,maxAdv:Ze},Zo=(vn=wt==null?void 0:wt.takeProfits)!=null&&vn.length?wt.takeProfits:t.takeProfits;if(Zo!=null&&Zo.length){const Ko=[];let Hn=0;for(const ji of Zo){if(Hn>=Jo)break;const zn=Math.max(0,Math.min(Jo-Hn,Jo*ji.qtyPct/100)),Vs=P(zn,"floor");if(!Number.isFinite(Vs)||Vs<=0||d!=null&&Vs<d&&Vs<Jo-Hn-1e-12)continue;const Bn=pe==="long"?Ze*(1+ji.takeProfitPct/100):Ze*(1-ji.takeProfitPct/100),tr=R("exit",pe,"limit",Bn);!Number.isFinite(tr)||tr<=0||(Ko.push({price:tr,qty:Vs,pct:ji.takeProfitPct}),Hn+=Vs)}xo.takeProfitOrders=Ko.sort((ji,zn)=>pe==="long"?ji.price-zn.price:zn.price-ji.price)}const os=G(pe);if(t.closeMethod==="avg"&&os.length){const Ko=os[0],Hn=Ko.qty+xo.qty,ji=Ko.entryNotional+xo.entryNotional,zn=Hn>0?ji/Hn:Ko.entryPrice;Ko.qty=Hn,Ko.entryNotional=ji,Ko.entryPrice=zn,Ko.entryFee+=xo.entryFee,Ko.entryFeeRemaining+=xo.entryFeeRemaining;const Vs=t.stopLossPct,Bn=t.takeProfitPct,tr=t.trailingStopPct,lr=Vs&&Vs>0?pe==="long"?zn*(1-Vs/100):zn*(1+Vs/100):null,Ui=Bn&&Bn>0?pe==="long"?zn*(1+Bn/100):zn*(1-Bn/100):null;if(Ko.stopPrice=lr!=null&&Number.isFinite(lr)?R("exit",pe,"stop",lr):null,Ko.takePrice=Ui!=null&&Number.isFinite(Ui)?R("exit",pe,"limit",Ui):null,Ko.trailingPct=tr,Ko.trailingStop=tr&&tr>0?pe==="long"?R("exit",pe,"stop",zn*(1-tr/100)):R("exit",pe,"stop",zn*(1+tr/100)):null,Ko.takeProfitOrders=[],(sr=t.takeProfits)!=null&&sr.length){const _a=[];let qi=0;for(const ai of t.takeProfits){if(qi>=Ko.qty)break;const cr=Math.max(0,Math.min(Ko.qty-qi,Ko.qty*ai.qtyPct/100)),Dn=P(cr,"floor");if(!Number.isFinite(Dn)||Dn<=0)continue;const kr=pe==="long"?zn*(1+ai.takeProfitPct/100):zn*(1-ai.takeProfitPct/100),Me=R("exit",pe,"limit",kr);!Number.isFinite(Me)||Me<=0||(_a.push({price:Me,qty:Dn,pct:ai.takeProfitPct}),qi+=Dn)}Ko.takeProfitOrders=_a.sort((ai,cr)=>pe==="long"?ai.price-cr.price:cr.price-ai.price)}return Ko.maxFav=Ko.maxFav==null?zn:Ko.maxFav,Ko.maxAdv=Ko.maxAdv==null?zn:Ko.maxAdv,{ok:!0,lot:Ko}}return os.push(xo),{ok:!0,lot:xo}},ct=(pe,rt,Ft,Qt="signal",xt,eo="market",Is,Po)=>{var vt;const Ze=pe.side;l&&(pe.qty=P(pe.qty,"round"));const Ke=ft(Ze,Ft,eo);if(!Number.isFinite(Ke)||Ke<=0)return null;const ps=pe.qty,pn=xt==null?ps:Math.max(0,Math.min(ps,xt)),Jo=xt==null?l?P(pn,"round"):pn:l?P(pn,"floor"):pn;if(!Number.isFinite(Jo)||Jo<=0||d!=null&&xt!=null&&Jo<d&&Jo<ps-1e-12)return null;const ti=ps>0&&Number.isFinite(pe.entryFeeRemaining)?pe.entryFeeRemaining*Jo/ps:0,mr=Ke*Jo,sa=mr*i,yt=Po&&Po>0?mr*Po:0;V+=sa,V+=yt;const wt=Ze==="long"?(Ke-pe.entryPrice)*Jo:(pe.entryPrice-Ke)*Jo;$+=wt;{const $t=Je(Ze,pe.entryIndex);$t.qtyExited+=Jo,$t.exitNotional+=mr,$t.grossPnl+=wt,$t.fees+=ti+sa+yt,$t.exits+=1,$t.exitIndex=rt,$t.exitTimestamp=Pe(rt)}const to=Number.isFinite(pe.entryPrice)&&pe.entryPrice>0?pe.entryPrice*Jo:NaN,mt=(()=>{if(!(pe.entryPrice<=0)&&!(pe.maxAdv==null||!Number.isFinite(pe.maxAdv)))return pe.side==="long"?(pe.maxAdv-pe.entryPrice)/pe.entryPrice*100:(pe.entryPrice-pe.maxAdv)/pe.entryPrice*100})(),Wt=(()=>{if(!(pe.entryPrice<=0)&&!(pe.maxFav==null||!Number.isFinite(pe.maxFav)))return pe.side==="long"?(pe.maxFav-pe.entryPrice)/pe.entryPrice*100:(pe.entryPrice-pe.maxFav)/pe.entryPrice*100})();Y.push({side:Ze,qty:Jo,entryIndex:pe.entryIndex,entryTimestamp:pe.entryTimestamp,entryPrice:pe.entryPrice,entrySignalId:pe.entrySignalId,entryOrderId:pe.entryOrderId,exitIndex:rt,exitTimestamp:((vt=o[rt])==null?void 0:vt.timestamp)??Date.now(),exitPrice:Ke,exitSignalId:Is==null?void 0:Is.signalId,exitOrderId:Is==null?void 0:Is.orderId,exitReason:Qt,pnl:wt,pnlPct:Number.isFinite(to)&&to>0?wt/to*100:0,fees:ti+sa+yt,maePct:typeof mt=="number"&&Number.isFinite(mt)?mt:void 0,mfePct:typeof Wt=="number"&&Number.isFinite(Wt)?Wt:void 0});try{const $t=Ce[Ze];typeof mt=="number"&&Number.isFinite(mt)&&$t&&($t.maeMin=$t.maeMin==null?mt:Math.min($t.maeMin,mt)),typeof Wt=="number"&&Number.isFinite(Wt)&&$t&&($t.mfeMax=$t.mfeMax==null?Wt:Math.max($t.mfeMax,Wt))}catch{}return pe.qty-=Jo,l&&(pe.qty=P(pe.qty,"round")),pe.entryFeeRemaining=Math.max(0,pe.entryFeeRemaining-ti),pe.qty<=1e-12&&(pe.entryFeeRemaining=0),{qtyClosed:Jo,fees:ti+sa+yt,exitFee:sa+yt,execPrice:Ke}},Lt=(pe,rt,Ft,Qt="signal",xt="market",eo,Is)=>{const Po=G(pe);if(!Po.length)return null;const Ze=Po.slice();let Ke=0,ps=0,pn=0,Jo=0;for(const ti of Ze)if(ti.qty>0){const mr=ct(ti,rt,Ft,Qt,ti.qty,xt,eo,Is);mr&&(Ke+=mr.qtyClosed,ps+=mr.fees,pn+=mr.exitFee,Jo+=mr.execPrice*mr.qtyClosed)}return U[pe]=G(pe).filter(ti=>ti.qty>1e-12),ye(pe),Ke<=0?null:{qtyClosed:Ke,fees:ps,exitFees:pn,execPrice:Jo/Ke}},It=pe=>{const rt=G(pe);return rt.length?rt.reduce((Ft,Qt)=>Ft+(Qt.qty>0?Qt.qty:0),0):0},zt=(pe,rt,Ft,Qt,xt="signal",eo="market",Is,Po)=>{const Ze=G(pe);if(!Ze.length)return null;let Ke=Math.max(0,Qt),ps=0,pn=0,Jo=0,ti=0;const mr=t.closeMethod==="lifo"?Ze.slice().reverse():Ze;for(const sa of mr){if(Ke<=0)break;if(sa.qty<=0)continue;const yt=Math.min(sa.qty,Ke),wt=ct(sa,rt,Ft,xt,yt,eo,Is,Po);wt&&(ps+=wt.qtyClosed,pn+=wt.fees,Jo+=wt.exitFee,ti+=wt.execPrice*wt.qtyClosed),Ke-=yt}return U[pe]=G(pe).filter(sa=>sa.qty>1e-12),ye(pe),ps<=0?null:{qtyClosed:ps,fees:pn,exitFees:Jo,execPrice:ti/ps}},pt=[],Mo=pe=>(pe==null?void 0:pe.order)||{},Xo=pe=>{const rt=typeof pe=="number"?pe:Number(pe);return!Number.isFinite(rt)||rt<=0?100:Math.max(0,Math.min(100,rt))},en=pe=>{const rt=String(pe||"market").trim().toLowerCase();return rt==="limit"?"limit":rt==="stop"?"stop":"market"},Fo=(pe,rt,Ft,Qt,xt)=>Number.isFinite(xt)?pe==="entry"?rt==="long"?Ft==="limit"?Qt.l<=xt:Qt.h>=xt:Ft==="limit"?Qt.h>=xt:Qt.l<=xt:rt==="long"?Ft==="limit"?Qt.h>=xt:Qt.l<=xt:Ft==="limit"?Qt.l<=xt:Qt.h>=xt:!1,Eo=(pe,rt,Ft)=>{for(const Qt of Ft)pe.side==="long"?Qt==="high"?pe.maxFav=pe.maxFav==null?rt.h:Math.max(pe.maxFav,rt.h):pe.maxAdv=pe.maxAdv==null?rt.l:Math.min(pe.maxAdv,rt.l):Qt==="low"?pe.maxFav=pe.maxFav==null?rt.l:Math.min(pe.maxFav,rt.l):pe.maxAdv=pe.maxAdv==null?rt.h:Math.max(pe.maxAdv,rt.h)},cs=pe=>t.intrabarTieBreak==="ohlc"?t.ohlcPath==="open_high_low_close"?["high","low"]:["low","high"]:t.intrabarTieBreak==="best_case"?pe==="long"?["high","low"]:["low","high"]:pe==="long"?["low","high"]:["high","low"],Zt=pe=>{const{lot:rt,i:Ft,triggerPx:Qt,reason:xt,qty:eo,fillKind:Is,note:Po}=pe;if(!Number.isFinite(Qt)||Qt<=0||!Number.isFinite(eo)||eo<=0)return!1;const Ze=Is==="limit"?"limit":"stop",Ke=Pe(Ft),ps=ze({action:"exit",side:rt.side,kind:Ze,originalKind:Ze,status:"pending",createdIndex:Ft,createdTimestamp:Ke,activeFromIndex:Ft,qtyPct:100,price:Qt,note:Po}),pn=ct(rt,Ft,Qt,xt,eo,Is,{orderId:ps.id});return pn?(he(ps.id,{status:"filled",filledIndex:Ft,filledTimestamp:Ke,fillPrice:pn.execPrice,fillQty:pn.qtyClosed,fees:pn.exitFee,note:Po}),!0):(he(ps.id,{status:"rejected",note:`${Po} (no fill)`}),!1)},bs=(pe,rt,Ft,Qt)=>{if(!Z(pe)||t.execution!=="intrabar_ohlc")return!1;let xt=!1;const eo=Is=>{var Po,Ze;for(const Ke of G(pe)){if(Ke.qty<=0)continue;const ps=B(Ft,"exit",Ke.side);if(Ke.trailingPct&&Ke.trailingPct>0){const pn=Ke.trailingPct/100;if(Ke.side==="long"&&Is==="high"){const Jo=Ft.h*(1-pn);Ke.trailingStop=Ke.trailingStop==null?Jo:Math.max(Ke.trailingStop,Jo)}if(Ke.side==="short"&&Is==="low"){const Jo=Ft.l*(1+pn);Ke.trailingStop=Ke.trailingStop==null?Jo:Math.min(Ke.trailingStop,Jo)}}if(Ke.side==="long"&&Is==="high"){if((Po=Ke.takeProfitOrders)!=null&&Po.length){const pn=[];for(const Jo of Ke.takeProfitOrders){if(Ke.qty<=0)break;ps.h>=Jo.price?xt=Zt({lot:Ke,i:rt,triggerPx:Jo.price,reason:"take_profit",qty:Jo.qty,fillKind:"limit",note:`AUTO take_profit (${Jo.pct}%)`})||xt:pn.push(Jo)}Ke.takeProfitOrders=pn}Ke.takePrice!=null&&ps.h>=Ke.takePrice&&Ke.qty>0&&(xt=Zt({lot:Ke,i:rt,triggerPx:Ke.takePrice,reason:"take_profit",qty:Ke.qty,fillKind:"limit",note:"AUTO take_profit"})||xt)}if(Ke.side==="short"&&Is==="low"){if((Ze=Ke.takeProfitOrders)!=null&&Ze.length){const pn=[];for(const Jo of Ke.takeProfitOrders){if(Ke.qty<=0)break;ps.l<=Jo.price?xt=Zt({lot:Ke,i:rt,triggerPx:Jo.price,reason:"take_profit",qty:Jo.qty,fillKind:"limit",note:`AUTO take_profit (${Jo.pct}%)`})||xt:pn.push(Jo)}Ke.takeProfitOrders=pn}Ke.takePrice!=null&&ps.l<=Ke.takePrice&&Ke.qty>0&&(xt=Zt({lot:Ke,i:rt,triggerPx:Ke.takePrice,reason:"take_profit",qty:Ke.qty,fillKind:"limit",note:"AUTO take_profit"})||xt)}if(Ke.side==="long"&&Is==="low"){if(Ke.stopPrice!=null&&ps.l<=Ke.stopPrice){xt=Zt({lot:Ke,i:rt,triggerPx:Ke.stopPrice,reason:"stop_loss",qty:Ke.qty,fillKind:"stop",note:"AUTO stop_loss"})||xt;continue}Ke.trailingStop!=null&&ps.l<=Ke.trailingStop&&(xt=Zt({lot:Ke,i:rt,triggerPx:Ke.trailingStop,reason:"trailing_stop",qty:Ke.qty,fillKind:"stop",note:"AUTO trailing_stop"})||xt)}if(Ke.side==="short"&&Is==="high"){if(Ke.stopPrice!=null&&ps.h>=Ke.stopPrice){xt=Zt({lot:Ke,i:rt,triggerPx:Ke.stopPrice,reason:"stop_loss",qty:Ke.qty,fillKind:"stop",note:"AUTO stop_loss"})||xt;continue}Ke.trailingStop!=null&&ps.h>=Ke.trailingStop&&(xt=Zt({lot:Ke,i:rt,triggerPx:Ke.trailingStop,reason:"trailing_stop",qty:Ke.qty,fillKind:"stop",note:"AUTO trailing_stop"})||xt)}}U[pe]=G(pe).filter(Ke=>Ke.qty>1e-12),ye(pe)};for(const Is of Qt){if(!Z(pe))break;eo(Is)}return xt},es=(pe,rt)=>{if(pe)for(let Ft=pt.length-1;Ft>=0;Ft--){const Qt=pt[Ft];(Qt==null?void 0:Qt.ocoGroup)===pe&&(rt&&Qt.orderId===rt||(he(Qt.orderId,{status:"canceled",note:"OCO canceled"}),pt.splice(Ft,1)))}},rn=(pe,rt,Ft)=>pe==="entry"?rt==="long"?Ft==="limit"?"low":"high":Ft==="limit"?"high":"low":rt==="long"?Ft==="limit"?"high":"low":Ft==="limit"?"low":"high",wr=(pe,rt,Ft,Qt,xt)=>{const eo=xt.o;if(!Number.isFinite(eo)||!Number.isFinite(Qt))return{px:Qt,fillsAtOpen:!1};const Is=eo*F(pe,rt);return Ft==="limit"?pe==="entry"&&rt==="long"&&eo<=Qt||pe==="entry"&&rt==="short"&&eo>=Qt||pe==="exit"&&rt==="long"&&eo>=Qt||pe==="exit"&&rt==="short"&&eo<=Qt?{px:Is,fillsAtOpen:!0}:{px:Qt,fillsAtOpen:!1}:pe==="entry"&&rt==="long"&&eo>=Qt||pe==="entry"&&rt==="short"&&eo<=Qt||pe==="exit"&&rt==="long"&&eo<=Qt||pe==="exit"&&rt==="short"&&eo>=Qt?{px:eo,fillsAtOpen:!0}:{px:Qt,fillsAtOpen:!1}},rr=(pe,rt,Ft)=>{var Is,Po;if(!Z(pe)||t.execution!=="intrabar_ohlc")return!1;const Qt=Ft.o;if(!Number.isFinite(Qt)||Qt<=0)return!1;const xt=Qt*F("exit",pe);let eo=!1;for(const Ze of G(pe).slice())if(!(Ze.qty<=0))if(Ze.side==="long"){if(Ze.stopPrice!=null&&xt<=Ze.stopPrice){eo=Zt({lot:Ze,i:rt,triggerPx:Qt,reason:"stop_loss",qty:Ze.qty,fillKind:"stop",note:"AUTO stop_loss (gap)"})||eo;continue}if(Ze.trailingStop!=null&&xt<=Ze.trailingStop){eo=Zt({lot:Ze,i:rt,triggerPx:Qt,reason:"trailing_stop",qty:Ze.qty,fillKind:"stop",note:"AUTO trailing_stop (gap)"})||eo;continue}if((Is=Ze.takeProfitOrders)!=null&&Is.length){const Ke=[];for(const ps of Ze.takeProfitOrders){if(Ze.qty<=0)break;xt>=ps.price?eo=Zt({lot:Ze,i:rt,triggerPx:xt,reason:"take_profit",qty:ps.qty,fillKind:"limit",note:`AUTO take_profit (${ps.pct}%) (gap)`})||eo:Ke.push(ps)}Ze.takeProfitOrders=Ke}Ze.takePrice!=null&&xt>=Ze.takePrice&&Ze.qty>0&&(eo=Zt({lot:Ze,i:rt,triggerPx:xt,reason:"take_profit",qty:Ze.qty,fillKind:"limit",note:"AUTO take_profit (gap)"})||eo)}else{if(Ze.stopPrice!=null&&xt>=Ze.stopPrice){eo=Zt({lot:Ze,i:rt,triggerPx:Qt,reason:"stop_loss",qty:Ze.qty,fillKind:"stop",note:"AUTO stop_loss (gap)"})||eo;continue}if(Ze.trailingStop!=null&&xt>=Ze.trailingStop){eo=Zt({lot:Ze,i:rt,triggerPx:Qt,reason:"trailing_stop",qty:Ze.qty,fillKind:"stop",note:"AUTO trailing_stop (gap)"})||eo;continue}if((Po=Ze.takeProfitOrders)!=null&&Po.length){const Ke=[];for(const ps of Ze.takeProfitOrders){if(Ze.qty<=0)break;xt<=ps.price?eo=Zt({lot:Ze,i:rt,triggerPx:xt,reason:"take_profit",qty:ps.qty,fillKind:"limit",note:`AUTO take_profit (${ps.pct}%) (gap)`})||eo:Ke.push(ps)}Ze.takeProfitOrders=Ke}Ze.takePrice!=null&&xt<=Ze.takePrice&&Ze.qty>0&&(eo=Zt({lot:Ze,i:rt,triggerPx:xt,reason:"take_profit",qty:Ze.qty,fillKind:"limit",note:"AUTO take_profit (gap)"})||eo)}return U[pe]=G(pe).filter(Ze=>Ze.qty>1e-12),ye(pe),eo},ar=(pe,rt)=>{if(!pt.length)return;for(let Po=pt.length-1;Po>=0;Po--){const Ze=pt[Po];if(!(pe<Ze.activeFromIndex)){if(Ze.expiresAtIndex!=null&&pe>Ze.expiresAtIndex){he(Ze.orderId,{status:"expired",note:"Expired"}),pt.splice(Po,1);continue}if(Ze.action==="exit"&&!Z(Ze.side)){he(Ze.orderId,{status:"canceled",note:"No position"}),pt.splice(Po,1);continue}}}const Ft=[];for(let Po=0;Po<pt.length;Po++){const Ze=pt[Po];if(pe<Ze.activeFromIndex||Ze.expiresAtIndex!=null&&pe>Ze.expiresAtIndex)continue;const Ke=B(rt,Ze.action,Ze.side);if(Ze.action==="exit"){if(!Z(Ze.side))continue}else if(se(Ze.side)>=t.pyramiding)continue;const ps=Ze.ocoGroup||`__solo__${Ze.orderId||Po}`,pn=Ze.action==="exit"?0:1,Jo=cs(Ze.side);if(Ze.kind==="stop_limit"){const vt=Ze.stopPrice??Ze.price,$t=Ze.limitPrice??Ze.price;if(!Number.isFinite(vt)||!Number.isFinite($t)||!Fo(Ze.action,Ze.side,"stop",Ke,vt))continue;const bo=rn(Ze.action,Ze.side,"stop"),xo=Jo.indexOf(bo),Zo=wr(Ze.action,Ze.side,"stop",vt,rt),os=Zo.fillsAtOpen?0:xo>=0?xo+1:99,ri=bo==="high"?vt:-vt;Ft.push({groupKey:ps,orderId:Ze.orderId,pi:Po,action:Ze.action,side:Ze.side,kind:"stop_limit",triggerExt:bo,phase:os,actionRank:pn,priceRank:ri,sp:vt,lp:$t,stopAtOpen:Zo.fillsAtOpen,limitAtOpen:wr(Ze.action,Ze.side,"limit",$t,rt).fillsAtOpen});continue}const ti=Ze.price;if(ti==null||!Number.isFinite(ti)||!(Ze.kind==="limit"?Fo(Ze.action,Ze.side,"limit",Ke,ti):Fo(Ze.action,Ze.side,"stop",Ke,ti)))continue;const sa=Ze.kind,yt=rn(Ze.action,Ze.side,sa),wt=Jo.indexOf(yt),mt=wr(Ze.action,Ze.side,sa,ti,rt).fillsAtOpen?0:wt>=0?wt+1:99,Wt=yt==="high"?ti:-ti;Ft.push({groupKey:ps,orderId:Ze.orderId,pi:Po,action:Ze.action,side:Ze.side,kind:sa,triggerExt:yt,phase:mt,actionRank:pn,priceRank:Wt,px:ti})}if(!Ft.length)return;const Qt=new Map,xt=(Po,Ze)=>Po.phase!==Ze.phase?Po.phase<Ze.phase?Po:Ze:Po.actionRank!==Ze.actionRank?Po.actionRank<Ze.actionRank?Po:Ze:Po.priceRank!==Ze.priceRank?Po.priceRank<Ze.priceRank?Po:Ze:Po.pi<Ze.pi?Po:Ze;for(const Po of Ft){const Ze=Qt.get(Po.groupKey);Qt.set(Po.groupKey,Ze?xt(Ze,Po):Po)}const eo=Array.from(Qt.values()).sort((Po,Ze)=>Po.phase!==Ze.phase?Po.phase-Ze.phase:Po.actionRank!==Ze.actionRank?Po.actionRank-Ze.actionRank:Po.priceRank!==Ze.priceRank?Po.priceRank-Ze.priceRank:Po.pi-Ze.pi),Is=(Po,Ze)=>{if(Po){const Ke=pt.findIndex(ps=>ps.orderId===Po);if(Ke>=0)return Ke}return typeof Ze=="number"?Ze:-1};for(const Po of eo){const Ze=Is(Po.orderId,Po.pi);if(Ze<0||Ze>=pt.length)continue;const Ke=pt[Ze];if(pe<Ke.activeFromIndex||Ke.expiresAtIndex!=null&&pe>Ke.expiresAtIndex)continue;const ps=B(rt,Ke.action,Ke.side);if(Ke.action==="exit"){if(!Z(Ke.side)){he(Ke.orderId,{status:"canceled",note:"No position"}),pt.splice(Ze,1);continue}}else if(se(Ke.side)>=t.pyramiding)continue;if(Ke.kind==="stop_limit"){const Wt=Ke.stopPrice??Ke.price,vt=Ke.limitPrice??Ke.price;if(!Number.isFinite(Wt)||!Number.isFinite(vt)||!Fo(Ke.action,Ke.side,"stop",ps,Wt))continue;const zo=Fo(Ke.action,Ke.side,"limit",ps,vt),bo=rn(Ke.action,Ke.side,"stop"),xo=rn(Ke.action,Ke.side,"limit"),Zo=cs(Ke.side),os=Zo.indexOf(bo),ri=Zo.indexOf(xo);if(zo&&os>=0&&ri>=0&&os<ri){const Ko=wr(Ke.action,Ke.side,"limit",vt,rt).px;if(Ke.action==="entry"){const zn=Oe(Ke.side,pe,Ko,Ke.qtyPct,"limit",Ke.bracket,{orderId:Ke.orderId,signalId:Ke.signalId});if(zn.ok){const Vs=zn.lot;he(Ke.orderId,{status:"filled",filledIndex:pe,filledTimestamp:Pe(pe),fillPrice:Vs.entryPrice,fillQty:Vs.qty,fees:Vs.entryFee})}else he(Ke.orderId,{status:"rejected",note:zn.reject||"Entry not filled"});if(zn.ok&&t.execution==="intrabar_ohlc"){const Vs=zn.lot,Bn=bo,tr=cs(Ke.side),lr=tr.indexOf(Bn),Ui=lr>=0?tr.slice(lr+1):tr;Eo(Vs,rt,Ui),bs(Ke.side,pe,rt,Ui)}}else{const zn=It(Ke.side),Vs=P(zn*Ke.qtyPct/100,"floor");if(d!=null&&Vs>0&&Vs<d&&Vs<zn-1e-12)he(Ke.orderId,{status:"rejected",note:`Qty ${Vs} < minQty ${d}`});else{const Bn=Vs>=zn-1e-12?Lt(Ke.side,pe,Ko,"signal","limit",{orderId:Ke.orderId,signalId:Ke.signalId}):zt(Ke.side,pe,Ko,Vs,"signal","limit",{orderId:Ke.orderId,signalId:Ke.signalId});he(Ke.orderId,{status:Bn?"filled":"rejected",filledIndex:Bn?pe:void 0,filledTimestamp:Bn?Pe(pe):void 0,fillPrice:(Bn==null?void 0:Bn.execPrice)??Ko,fillQty:(Bn==null?void 0:Bn.qtyClosed)??0,fees:(Bn==null?void 0:Bn.exitFees)??0,note:Bn?void 0:"Exit not filled"})}}const Hn=Ke.ocoGroup,ji=Ke.orderId;pt.splice(Ze,1),es(Hn,ji);continue}he(Ke.orderId,{kind:"limit",note:"Stop triggered → limit active next bar"}),Ke.kind="limit",Ke.price=vt,Ke.activeFromIndex=pe+1,es(Ke.ocoGroup,Ke.orderId);continue}const pn=Ke.price;if(pn==null||!Number.isFinite(pn)||!(Ke.kind==="limit"?Fo(Ke.action,Ke.side,"limit",ps,pn):Fo(Ke.action,Ke.side,"stop",ps,pn)))continue;const ti=Ke.kind,mr=en(ti),yt=wr(Ke.action,Ke.side,ti,pn,rt).px,wt=rn(Ke.action,Ke.side,ti);if(Ke.action==="entry"){if(t.positionMode==="netting"){const vt=ie(Ke.side);if(Z(vt)){const $t=Pe(pe),zo=ze({action:"exit",side:vt,kind:mr==="limit"?"limit":"market",originalKind:"market",status:"pending",createdIndex:pe,createdTimestamp:$t,activeFromIndex:pe,qtyPct:100,price:yt,note:"AUTO netting close (reverse)"}),bo=Lt(vt,pe,yt,"signal",mr,{orderId:zo.id,signalId:Ke.signalId});he(zo.id,{status:bo?"filled":"rejected",filledIndex:bo?pe:void 0,filledTimestamp:bo?$t:void 0,fillPrice:bo==null?void 0:bo.execPrice,fillQty:(bo==null?void 0:bo.qtyClosed)??0,fees:(bo==null?void 0:bo.exitFees)??0,note:bo?"AUTO netting close (reverse)":"AUTO netting close failed"})}}const Wt=Oe(Ke.side,pe,yt,Ke.qtyPct,mr,Ke.bracket,{orderId:Ke.orderId,signalId:Ke.signalId});if(Wt.ok){const vt=Wt.lot;he(Ke.orderId,{status:"filled",filledIndex:pe,filledTimestamp:Pe(pe),fillPrice:vt.entryPrice,fillQty:vt.qty,fees:vt.entryFee})}else he(Ke.orderId,{status:"rejected",note:Wt.reject||"Entry not filled"});if(Wt.ok&&t.execution==="intrabar_ohlc"){const vt=Wt.lot,$t=cs(Ke.side),zo=$t.indexOf(wt),bo=zo>=0?$t.slice(zo+1):$t;Eo(vt,rt,bo),bs(Ke.side,pe,rt,bo)}}else{const Wt=It(Ke.side),vt=P(Wt*Ke.qtyPct/100,"floor");if(d!=null&&vt>0&&vt<d&&vt<Wt-1e-12)he(Ke.orderId,{status:"rejected",note:`Qty ${vt} < minQty ${d}`});else{const $t=vt>=Wt-1e-12?Lt(Ke.side,pe,yt,"signal",mr,{orderId:Ke.orderId,signalId:Ke.signalId}):zt(Ke.side,pe,yt,vt,"signal",mr,{orderId:Ke.orderId,signalId:Ke.signalId});he(Ke.orderId,{status:$t?"filled":"rejected",filledIndex:$t?pe:void 0,filledTimestamp:$t?Pe(pe):void 0,fillPrice:($t==null?void 0:$t.execPrice)??yt,fillQty:($t==null?void 0:$t.qtyClosed)??0,fees:($t==null?void 0:$t.exitFees)??0,note:$t?void 0:"Exit not filled"})}}const to=Ke.ocoGroup,mt=Ke.orderId;pt.splice(Ze,1),es(to,mt)}},jr=(pe,rt)=>{if(!le()||t.execution!=="intrabar_ohlc")return!1;const Ft=rr("long",pe,rt),Qt=rr("short",pe,rt),xt=bs("long",pe,rt,cs("long")),eo=bs("short",pe,rt,cs("short"));return Ft||Qt||xt||eo};for(let pe=0;pe<o.length;pe++){const rt=_q(o[pe]);if(!rt)continue;const Ft=rt.c;Ie(pe,Ft);for(const xt of G("long"))xt.qty<=0||(xt.maxFav=xt.maxFav==null?rt.h:Math.max(xt.maxFav,rt.h),xt.maxAdv=xt.maxAdv==null?rt.l:Math.min(xt.maxAdv,rt.l));for(const xt of G("short"))xt.qty<=0||(xt.maxFav=xt.maxFav==null?rt.l:Math.min(xt.maxFav,rt.l),xt.maxAdv=xt.maxAdv==null?rt.h:Math.max(xt.maxAdv,rt.h));for(le()&&jr(pe,rt),ar(pe,rt),J(pe,rt);ge<De.length&&De[ge].index===pe;){const xt=De[ge],eo=Mo(xt),Po=String((eo==null?void 0:eo.kind)||"market").trim().toLowerCase().replace(/stop\s*limit|stoplimit/g,"stop_limit"),Ze=Xo(eo==null?void 0:eo.qtyPct),Ke=typeof(eo==null?void 0:eo.oco)=="string"&&String(eo.oco).trim()?String(eo.oco).trim():void 0,ps=eo==null?void 0:eo.expiresBars,pn=typeof ps=="number"&&Number.isFinite(ps)&&ps>0?Math.floor(ps):null,Jo=pn?pe+pn:void 0,ti=Qe(eo==null?void 0:eo.bracket),mr=(Po==="limit"||Po==="stop")&&typeof(eo==null?void 0:eo.price)=="number"?eo.price:Ft,sa=typeof(eo==null?void 0:eo.stopPrice)=="number"?eo.stopPrice:typeof(eo==null?void 0:eo.price)=="number"?eo.price:Ft,yt=typeof(eo==null?void 0:eo.limitPrice)=="number"?eo.limitPrice:typeof(eo==null?void 0:eo.price)=="number"?eo.price:Ft,wt=Po==="limit"||Po==="stop"?R(xt.type.startsWith("entry")?"entry":"exit",xt.type.endsWith("long")?"long":"short",Po==="limit"?"limit":"stop",mr):mr,to=Po==="stop_limit"?R(xt.type.startsWith("entry")?"entry":"exit",xt.type.endsWith("long")?"long":"short","stop",sa):sa,mt=Po==="stop_limit"?R(xt.type.startsWith("entry")?"entry":"exit",xt.type.endsWith("long")?"long":"short","limit",yt):yt,Wt=Pe(pe),vt=Po==="limit"||Po==="stop"||Po==="stop_limit"?Po:"market";if(xt.type==="exit_long"&&Z("long"))if(vt==="stop_limit"){if(Number.isFinite(to)&&to>0&&Number.isFinite(mt)&&mt>0){const $t=ze({action:"exit",side:"long",kind:"stop_limit",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,stopPrice:to,limitPrice:mt});pt.push({action:"exit",side:"long",kind:"stop_limit",signalId:xt.signalId,stopPrice:to,limitPrice:mt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,orderId:$t.id})}}else if(vt==="limit"||vt==="stop"){if(Number.isFinite(wt)&&wt>0){const $t=ze({action:"exit",side:"long",kind:vt,originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,price:wt});pt.push({action:"exit",side:"long",kind:vt,signalId:xt.signalId,price:wt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,orderId:$t.id})}}else{const $t=It("long"),zo=P($t*Ze/100,"floor"),bo=ze({action:"exit",side:"long",kind:"market",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe,expiresAtIndex:Jo,qtyPct:Ze});if(d!=null&&zo>0&&zo<d&&zo<$t-1e-12)he(bo.id,{status:"rejected",note:`Qty ${zo} < minQty ${d}`});else{const xo=zo>=$t-1e-12?Lt("long",pe,Ft,"signal","market",{signalId:xt.signalId,orderId:bo.id}):zt("long",pe,Ft,zo,"signal","market",{signalId:xt.signalId,orderId:bo.id});he(bo.id,{status:xo?"filled":"rejected",filledIndex:xo?pe:void 0,filledTimestamp:xo?Wt:void 0,fillPrice:(xo==null?void 0:xo.execPrice)??ft("long",Ft,"market"),fillQty:(xo==null?void 0:xo.qtyClosed)??0,fees:(xo==null?void 0:xo.exitFees)??0,note:xo?void 0:"Exit not filled"})}}else if(xt.type==="exit_short"&&Z("short"))if(vt==="stop_limit"){if(Number.isFinite(to)&&to>0&&Number.isFinite(mt)&&mt>0){const $t=ze({action:"exit",side:"short",kind:"stop_limit",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,stopPrice:to,limitPrice:mt});pt.push({action:"exit",side:"short",kind:"stop_limit",signalId:xt.signalId,stopPrice:to,limitPrice:mt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,orderId:$t.id})}}else if(vt==="limit"||vt==="stop"){if(Number.isFinite(wt)&&wt>0){const $t=ze({action:"exit",side:"short",kind:vt,originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,price:wt});pt.push({action:"exit",side:"short",kind:vt,signalId:xt.signalId,price:wt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,orderId:$t.id})}}else{const $t=It("short"),zo=P($t*Ze/100,"floor"),bo=ze({action:"exit",side:"short",kind:"market",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe,expiresAtIndex:Jo,qtyPct:Ze});if(d!=null&&zo>0&&zo<d&&zo<$t-1e-12)he(bo.id,{status:"rejected",note:`Qty ${zo} < minQty ${d}`});else{const xo=zo>=$t-1e-12?Lt("short",pe,Ft,"signal","market",{signalId:xt.signalId,orderId:bo.id}):zt("short",pe,Ft,zo,"signal","market",{signalId:xt.signalId,orderId:bo.id});he(bo.id,{status:xo?"filled":"rejected",filledIndex:xo?pe:void 0,filledTimestamp:xo?Wt:void 0,fillPrice:(xo==null?void 0:xo.execPrice)??ft("short",Ft,"market"),fillQty:(xo==null?void 0:xo.qtyClosed)??0,fees:(xo==null?void 0:xo.exitFees)??0,note:xo?void 0:"Exit not filled"})}}else if(xt.type==="entry_long"&&t.allowLong)if(vt==="stop_limit"){if(Number.isFinite(to)&&to>0&&Number.isFinite(mt)&&mt>0){const $t=ze({action:"entry",side:"long",kind:"stop_limit",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,stopPrice:to,limitPrice:mt});pt.push({action:"entry",side:"long",kind:"stop_limit",signalId:xt.signalId,stopPrice:to,limitPrice:mt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,bracket:ti,orderId:$t.id})}}else if(vt==="limit"||vt==="stop"){if(Number.isFinite(wt)&&wt>0){const $t=ze({action:"entry",side:"long",kind:vt,originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,price:wt});pt.push({action:"entry",side:"long",kind:vt,signalId:xt.signalId,price:wt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,bracket:ti,orderId:$t.id})}}else{const $t=ze({action:"entry",side:"long",kind:"market",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe,expiresAtIndex:Jo,qtyPct:Ze});if(t.positionMode==="netting"){const bo="short";if(Z(bo)){const xo=ze({action:"exit",side:bo,kind:"market",originalKind:"market",status:"pending",createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe,qtyPct:100,price:Ft,note:"AUTO netting close (reverse)"}),Zo=Lt(bo,pe,Ft,"signal","market",{signalId:xt.signalId,orderId:xo.id});he(xo.id,{status:Zo?"filled":"rejected",filledIndex:Zo?pe:void 0,filledTimestamp:Zo?Wt:void 0,fillPrice:(Zo==null?void 0:Zo.execPrice)??ft(bo,Ft,"market"),fillQty:(Zo==null?void 0:Zo.qtyClosed)??0,fees:(Zo==null?void 0:Zo.exitFees)??0})}}const zo=Oe("long",pe,Ft,Ze,"market",ti,{signalId:xt.signalId,orderId:$t.id});if(zo.ok){const bo=zo.lot;he($t.id,{status:"filled",filledIndex:pe,filledTimestamp:Wt,fillPrice:bo.entryPrice,fillQty:bo.qty,fees:bo.entryFee})}else he($t.id,{status:"rejected",note:zo.reject||"Entry blocked"})}else if(xt.type==="entry_short"&&t.allowShort)if(vt==="stop_limit"){if(Number.isFinite(to)&&to>0&&Number.isFinite(mt)&&mt>0){const $t=ze({action:"entry",side:"short",kind:"stop_limit",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,stopPrice:to,limitPrice:mt});pt.push({action:"entry",side:"short",kind:"stop_limit",signalId:xt.signalId,stopPrice:to,limitPrice:mt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,bracket:ti,orderId:$t.id})}}else if(vt==="limit"||vt==="stop"){if(Number.isFinite(wt)&&wt>0){const $t=ze({action:"entry",side:"short",kind:vt,originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe+1,expiresAtIndex:Jo,qtyPct:Ze,price:wt});pt.push({action:"entry",side:"short",kind:vt,signalId:xt.signalId,price:wt,qtyPct:Ze,activeFromIndex:pe+1,expiresAtIndex:Jo,ocoGroup:Ke,bracket:ti,orderId:$t.id})}}else{const $t=ze({action:"entry",side:"short",kind:"market",originalKind:vt,status:"pending",signalId:xt.signalId,ocoGroup:Ke,createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe,expiresAtIndex:Jo,qtyPct:Ze});if(t.positionMode==="netting"){const bo="long";if(Z(bo)){const xo=ze({action:"exit",side:bo,kind:"market",originalKind:"market",status:"pending",createdIndex:pe,createdTimestamp:Wt,activeFromIndex:pe,qtyPct:100,price:Ft,note:"AUTO netting close (reverse)"}),Zo=Lt(bo,pe,Ft,"signal","market",{signalId:xt.signalId,orderId:xo.id});he(xo.id,{status:Zo?"filled":"rejected",filledIndex:Zo?pe:void 0,filledTimestamp:Zo?Wt:void 0,fillPrice:(Zo==null?void 0:Zo.execPrice)??ft(bo,Ft,"market"),fillQty:(Zo==null?void 0:Zo.qtyClosed)??0,fees:(Zo==null?void 0:Zo.exitFees)??0})}}const zo=Oe("short",pe,Ft,Ze,"market",ti,{signalId:xt.signalId,orderId:$t.id});if(zo.ok){const bo=zo.lot;he($t.id,{status:"filled",filledIndex:pe,filledTimestamp:Wt,fillPrice:bo.entryPrice,fillQty:bo.qty,fees:bo.entryFee})}else he($t.id,{status:"rejected",note:zo.reject||"Entry blocked"})}ge+=1}const Qt=Ae(pe,Ft);{const xt=(or=o==null?void 0:o[pe])==null?void 0:or.timestamp,eo=Number(xt);_e.push({index:pe,timestamp:Number.isFinite(eo)&&eo>0?eo:Date.now(),equity:Qt})}if(Qt>be&&(be=Qt),be>0){const xt=(be-Qt)/be;xt>$e&&($e=xt)}}if(t.closeOnEnd&&le()&&o.length){const pe=o.length-1,rt=Rx(o[pe]);if(rt!=null){Z("long")&&Lt("long",pe,rt,"end","market"),Z("short")&&Lt("short",pe,rt,"end","market");const Ft=Ae(pe,rt);{const Qt=(tc=o==null?void 0:o[pe])==null?void 0:tc.timestamp,xt=Number(Qt);_e.push({index:pe,timestamp:Number.isFinite(xt)&&xt>0?xt:Date.now(),equity:Ft})}if(Ft>be&&(be=Ft),be>0){const Qt=(be-Ft)/be;Qt>$e&&($e=Qt)}}if(pt.length){for(const Ft of pt)he(Ft.orderId,{status:"canceled",note:"Canceled on end"});pt.length=0}}const ii=_e.length?_e[_e.length-1].equity:s,Xa=ii-s,Ja=Y.reduce((pe,rt)=>pe+(rt.pnl>0?rt.pnl:0),0),Va=Y.reduce((pe,rt)=>pe+(rt.pnl<0?Math.abs(rt.pnl):0),0),Wa=Y.filter(pe=>pe.pnl>0).length,Qa=Y.filter(pe=>pe.pnl<0).length,qa=Y.length,Kl=qa?Wa/qa*100:0,ll=qa?Xa/qa:0,Wr=Wa?Ja/Wa:0,Ca=Qa?-(Va/Qa):0,vl=Ca!==0?Math.abs(Wr/Ca):Wr>0?1/0:0,ml=qa?Wa/qa*Wr+Qa/qa*Ca:0;let Sl=0,el=0;{let pe=0,rt=0;for(const Ft of Y)Ft.pnl>0?(pe+=1,rt=0,pe>Sl&&(Sl=pe)):Ft.pnl<0&&(rt+=1,pe=0,rt>el&&(el=rt))}return{summary:{initialCapital:s,finalEquity:ii,netPnl:Xa,netPnlPct:s>0?Xa/s*100:0,grossProfit:Ja,grossLoss:Va,profitFactor:Va>0?Ja/Va:Ja>0?1/0:0,trades:qa,roundTrips:K.length,wins:Wa,losses:Qa,winRate:Kl,maxDrawdownPct:$e*100,feesPaid:V,avgTrade:ll,avgWin:Wr,avgLoss:Ca,payoffRatio:vl,expectancy:ml,maxConsecWins:Sl,maxConsecLosses:el},trades:Y,roundTrips:K,orders:Q,equity:_e}}function Gm(o){return typeof o=="number"&&Number.isFinite(o)}function y0(o,e,t){const s=o[t];if(Gm(s))return s;const i=e[t];return Gm(i)?i:NaN}function b0(o,e,t){const s=o[t];if(Gm(s))return s;const i=e[t];return Gm(i)?i:NaN}function f2(o,e,t,s){let i=-1,r=-1/0;for(let a=t;a<=s;a++){const l=y0(o,e,a);Number.isFinite(l)&&l>r&&(r=l,i=a)}return i}function g2(o,e,t,s){let i=-1,r=1/0;for(let a=t;a<=s;a++){const l=b0(o,e,a);Number.isFinite(l)&&l<r&&(r=l,i=a)}return i}function Ox(o,e,t,s,i){const r=Math.min(o.length,e.length,t.length);if(r<=1)return null;const a=Math.min(r-1,Math.max(0,Math.trunc(s))),l=Math.max(2,Math.trunc(i.lookback||200)),d=Math.max(0,a-l+1),v=i.direction==="down"?"down":"up";if((i.method==="pivots"?"pivots":"extremes")==="pivots"){const S=Math.max(1,Math.floor(Number(i.pivotLeft??3))),L=Math.max(1,Math.floor(Number(i.pivotRight??3))),T=a;if(T<L)return null;const P=[],A=[],F=U=>{const G=y0(o,t,U);if(!Number.isFinite(G))return null;const Z=Math.max(0,U-S),le=Math.min(T,U+L);if(le<U+L)return null;for(let se=Z;se<=le;se++){if(se===U)continue;const ie=y0(o,t,se);if(!Number.isFinite(ie)||ie>=G)return null}return G},B=U=>{const G=b0(e,t,U);if(!Number.isFinite(G))return null;const Z=Math.max(0,U-S),le=Math.min(T,U+L);if(le<U+L)return null;for(let se=Z;se<=le;se++){if(se===U)continue;const ie=b0(e,t,se);if(!Number.isFinite(ie)||ie<=G)return null}return G},R=Math.max(d,0),N=Math.min(a-L,a);for(let U=R;U<=N;U++){const G=F(U);G!=null&&P.push({index:U,value:G});const Z=B(U);Z!=null&&A.push({index:U,value:Z})}const $=P.length?P[P.length-1]:null,V=A.length?A[A.length-1]:null;if(!(!$||!V))if(v==="up"){let U=null;for(let G=A.length-1;G>=0;G--)if(A[G].index<$.index){U=A[G];break}if(U)return{fromIndex:U.index,toIndex:$.index,fromValue:U.value,toValue:$.value}}else{let U=null;for(let G=P.length-1;G>=0;G--)if(P[G].index<V.index){U=P[G];break}if(U)return{fromIndex:U.index,toIndex:V.index,fromValue:U.value,toValue:V.value}}}if(v==="up"){const S=f2(o,t,d,a);if(S<0)return null;const L=g2(e,t,d,S);if(L<0)return null;const T=b0(e,t,L),P=y0(o,t,S);return[T,P].every(Number.isFinite)?{fromIndex:L,toIndex:S,fromValue:T,toValue:P}:null}const _=g2(e,t,d,a);if(_<0)return null;const y=f2(o,t,d,_);if(y<0)return null;const w=b0(e,t,_),k=y0(o,t,y);return[w,k].every(Number.isFinite)?{fromIndex:y,toIndex:_,fromValue:k,toValue:w}:null}function bq(o,e,t,s){const i=Math.min(o.length,e.length,t.length),r=new Array(i),a=new Array(i),l=new Array(i),d=new Array(i),v=new Array(i),p=new Array(i),_=new Array(i);for(let y=0;y<i;y++){const w=Ox(o,e,t,y,s);if(!w){r[y]=void 0,a[y]=void 0,l[y]=void 0,d[y]=void 0,v[y]=void 0,p[y]=void 0,_[y]=void 0;continue}r[y]=w.fromValue,a[y]=w.toValue,l[y]=w.fromIndex,d[y]=w.toIndex,v[y]=w.fromValue,_[y]=w.toValue,p[y]=w.fromValue+(w.toValue-w.fromValue)*.5}return{from:r,to:a,fromIndex:l,toIndex:d,lvl0:v,lvl50:p,lvl100:_}}function rf(o){return!Number.isFinite(o)||o<=0?0:o<1e12?o*1e3:o}function Vx(o){const e=new Date(o);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),0,0,0,0)}function xq(o){const s=(new Date(o).getUTCDay()+6)%7;return Vx(o)-s*24*60*60*1e3}function wq(o){const e=new Date(o);return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0)}function kq(o){const e=String(o||"").trim(),t=e.toUpperCase();if(!t)return null;if(t==="D"||t==="1D")return{kind:"calendar",unit:"D"};if(t==="W"||t==="1W")return{kind:"calendar",unit:"W"};if(e==="M"||e==="1M")return{kind:"calendar",unit:"M"};if(/^\d+$/.test(t))return{kind:"fixed",ms:Math.max(1,Number(t))*60*1e3};const s=t.match(/^(\d+)\s*([A-Z]+)$/);if(s){const i=Math.max(1,Number(s[1])),r=s[2];if(r==="H"||r==="HR"||r==="HRS")return{kind:"fixed",ms:i*60*60*1e3};if(r==="MIN"||r==="MINS")return{kind:"fixed",ms:i*60*1e3};if(r==="M"&&e.toLowerCase().endsWith("m"))return{kind:"fixed",ms:i*60*1e3};if(r==="D"||r==="DAY"||r==="DAYS")return{kind:"fixed",ms:i*24*60*60*1e3};if(r==="W"||r==="WK"||r==="WEEK"||r==="WEEKS")return{kind:"fixed",ms:i*7*24*60*60*1e3}}return null}function Sq(o,e){return e?e.kind==="fixed"?Math.floor(o/e.ms)*e.ms:e.unit==="D"?Vx(o):e.unit==="W"?xq(o):wq(o):o}function m2(o){const e=[];let t=null;for(let s=0;s<o.length;s++){const i=rf(o[s]??0);if(i){if(t!=null){const r=i-t;r>0&&Number.isFinite(r)&&e.push(r)}if(t=i,e.length>=200)break}}return e.length<3?null:(e.sort((s,i)=>s-i),e[Math.floor(e.length/2)]??null)}function Cq(o,e){let t=0,s=o.length;for(;t<s;){const i=t+s>>>1;o[i]>e?s=i:t=i+1}return t}function Pq(o){const e=o.length,t=new Float32Array(e),s=new Float32Array(e),i=new Float32Array(e),r=new Float32Array(e),a=new Float32Array(e),l=new Float32Array(e);for(let d=0;d<e;d++){const v=o[d],p=rf((v==null?void 0:v.timestamp)??(v==null?void 0:v.time)??(v==null?void 0:v.t)??0),_=Number(v==null?void 0:v.close),y=Number(v==null?void 0:v.open),w=Number(v==null?void 0:v.high),k=Number(v==null?void 0:v.low);t[d]=Number.isFinite(y)?y:Number.isFinite(_)?_:NaN,r[d]=Number.isFinite(_)?_:NaN,s[d]=Number.isFinite(w)?w:Number.isFinite(_)?_:t[d],i[d]=Number.isFinite(k)?k:Number.isFinite(_)?_:t[d];const S=Number(v==null?void 0:v.volume);a[d]=Number.isFinite(S)?S:0,l[d]=p||0}return{open:t,high:s,low:i,close:r,volume:a,time:l}}function Iq(o){var B,R,N;const e=o.timestamps.length,t=o.lookahead||"off";o.gaps;const s=String(o.timeframe||"").trim();if(!s||s.toLowerCase()==="current"||s==="__CURRENT__"){const $={open:new Float32Array(e),high:new Float32Array(e),low:new Float32Array(e),close:new Float32Array(e),volume:new Float32Array(e),time:new Float32Array(e)};for(let Z=0;Z<e;Z++)$.open[Z]=o.open[Z]??NaN,$.high[Z]=o.high[Z]??NaN,$.low[Z]=o.low[Z]??NaN,$.close[Z]=o.close[Z]??NaN,$.volume[Z]=((B=o.volume)==null?void 0:B[Z])??0,$.time[Z]=rf(o.timestamps[Z]??0);const U=df([{name:"__out",expr:String(o.expr||"close")}],$,o.scalars).__out||new Float32Array(e),G=new Array(e);for(let Z=0;Z<e;Z++){const le=U[Z];G[Z]=Number.isFinite(le)?le:void 0}return G}const i=kq(s);if(!i)return new Array(e);if(o.sourceCandles&&o.sourceCandles.length>1){const $=o.sourceCandles,V=$.length,U=Pq($),Z=df([{name:"__out",expr:String(o.expr||"close")}],U,o.scalars).__out||new Float32Array(V),le=U.time,se=m2(o.timestamps),ie=new Array(e);for(let Q=0;Q<e;Q++){const q=rf(o.timestamps[Q]??0);if(!q){ie[Q]=-1;continue}let ce=q;if(Q+1<e){const me=rf(o.timestamps[Q+1]??0);me&&me>q&&(ce=me-1)}else se!=null&&se>0&&(ce=q+se-1);const _e=Cq(le,ce);ie[Q]=_e-1}const Y=new Array(e);for(let Q=0;Q<e;Q++){const q=ie[Q],ce=Q+1<e?ie[Q+1]:q;Y[Q]=q>=0&&Q+1<e&&q!==ce}const K=new Array(e);for(let Q=0;Q<e;Q++){const q=ie[Q];if(q<0||q>=V){K[Q]=void 0;continue}const ce=t==="on"||Y[Q]?Z[q]:q>0?Z[q-1]:NaN;K[Q]=Number.isFinite(ce)?ce:void 0}return K}const r=m2(o.timestamps);if(i.kind==="fixed"&&r!=null&&i.ms<r)throw new Error(`request.security: lower timeframe "${s}" is not available from current chart data (base ~${Math.round(r/6e4)}m). Switch chart timeframe lower or provide lower-TF datafeed.`);const a=new Array(e),l=new Array(e),d=[],v=[],p=[],_=[],y=[],w=[];let k=NaN,S=-1;for(let $=0;$<e;$++){const V=rf(o.timestamps[$]??0);if(!V){a[$]=-1;continue}const U=Sq(V,i);if(!Number.isFinite(k)||U!==k){k=U,S+=1,w[S]=U,d[S]=o.open[$]??o.close[$]??NaN;const G=o.close[$]??NaN;v[S]=o.high[$]??G,p[S]=o.low[$]??G,_[S]=o.close[$]??NaN,y[S]=((R=o.volume)==null?void 0:R[$])??0}else{const G=o.high[$],Z=o.low[$],le=o.close[$];G!=null&&Number.isFinite(G)&&(v[S]=Math.max(v[S],G)),Z!=null&&Number.isFinite(Z)&&(p[S]=Math.min(p[S],Z)),le!=null&&Number.isFinite(le)&&(_[S]=le);const se=(N=o.volume)==null?void 0:N[$];se!=null&&Number.isFinite(se)&&(y[S]+=se)}a[$]=S}for(let $=0;$<e;$++){const V=a[$],U=$+1<e?a[$+1]:V;l[$]=V>=0&&$+1<e&&V!==U}const L=S+1;if(L<=0)return new Array(e);const T={open:new Float32Array(L),high:new Float32Array(L),low:new Float32Array(L),close:new Float32Array(L),volume:new Float32Array(L),time:new Float32Array(L)};for(let $=0;$<L;$++)T.open[$]=d[$]??NaN,T.high[$]=v[$]??NaN,T.low[$]=p[$]??NaN,T.close[$]=_[$]??NaN,T.volume[$]=y[$]??0,T.time[$]=w[$]??0;const A=df([{name:"__out",expr:String(o.expr||"close")}],T,o.scalars).__out||new Float32Array(L),F=new Array(e);for(let $=0;$<e;$++){const V=a[$];if(V<0){F[$]=void 0;continue}const U=t==="on"||l[$]?A[V]:V>0?A[V-1]:NaN,G=Number.isFinite(U)?U:void 0;F[$]=G}return F}function Pm(o){return o.replace(/^"|"$/g,"").replace(/^'|'$/g,"")}function Mq(o){const e={},t=/([A-Za-z_$][A-Za-z0-9_$]*)\s*:\s*("([^"\\]|\\.)*"|'([^'\\]|\\.)*'|[^\s]+)/g;let s;for(;s=t.exec(o);){const i=String(s[1]||"").toLowerCase(),r=String(s[2]||"");e[i]=r}return e}function Tq(o){const e=String(o||"").split(/\n+/),t={},s=[],i=[],r=[],a=[],l={};for(const v of e){const p=v.replace(/#.*$/,"").replace(/\/\/.*$/,"").trim();if(!p)continue;let _;if(_=p.match(/^([A-Za-z_$][A-Za-z0-9_$]*)\s*=\s*(.+)$/),_){const y=_[1],w=_[2].trim(),k=Number(w);Number.isFinite(k)&&/^[-+]?\d+(?:\.\d+)?$/.test(w)?t[y]=k:w.startsWith('"')&&w.endsWith('"')||w.startsWith("'")&&w.endsWith("'")?t[y]=Pm(w):s.push({name:y,expr:w});continue}if(_=p.match(/^signal\s+([A-Za-z_$][A-Za-z0-9_$]*)\s+when\s*\((.+)\)\s*$/i),_||(_=p.match(/^signal\s+([A-Za-z_$][A-Za-z0-9_$]*)\s+when\s+(.+)\s*$/i)),_){const y=_[1],w=_[2].trim();l[y.toLowerCase()]=w;const k=y.toLowerCase()==="top"?"entry_long":y.toLowerCase()==="bot"?"entry_short":y.toLowerCase();i.push({type:k,when:w});continue}if(_=p.match(/^label\s+at\s+(top|bot)(?:\s+when\s*\((.+?)\))?\s+(.+)$/i),_){const y=_[1].toLowerCase(),w=(_[2]||"").trim(),k=_[3]||"",S=Mq(k),L=S.text?Pm(S.text):y==="top"?"▲":"▼",T=S.color||(y==="top"?"#f97316":"#3b82f6"),P=y==="top"?"above":"below",A=S.source?Pm(S.source):y==="top"?"high":"low",F=S.shape?Pm(S.shape):void 0,B=U=>s.some(G=>G.name.replace(/\s+/g,"_").toLowerCase()===U.replace(/\s+/g,"_").toLowerCase()),R=typeof t.WIN=="number"||typeof t.WIN=="string"&&Number.isFinite(Number(t.WIN)),N=y==="top"?B("hiwin")?"close == HIWIN":R?"close == highest(close, WIN)":"close < -1e20":B("lowin")?"close == LOWIN":R?"close == lowest(close, WIN)":"close < -1e20",V={when:w||l[y]||N,text:L,color:T,position:P,source:A,shape:F};A==="high"||A==="low"?r.push(V):a.push(V);continue}}const d=[];return(r.length||i.length)&&d.push({pane:"main",plots:[],labels:r,levels:[],lines:[]}),a.length&&d.push({pane:"sub",plots:[],labels:a,levels:[],lines:[],min:0,max:100}),{params:t,series:s,signals:i,panes:d}}function Aq(o,e){var t;(o.key==="Delete"||o.key==="Backspace")&&(o.preventDefault(),(t=n(e))==null||t.clickRemove())}function Lq(o,e,t,s,i){n(e)&&t(),n(s)&&i()}var Fq=(o,e,t)=>Ir(t(),Uo(e).clickChart+=1,Uo(e)),Dq=de('<div class="kline-loading-overlay svelte-10y1ir0"><div class="loader-content svelte-10y1ir0"><div class="ai-minimal svelte-10y1ir0"><div class="brand-text svelte-10y1ir0">Duty AI</div> <span class="brand-shine svelte-10y1ir0"></span> <div class="orbit svelte-10y1ir0"><span class="o-dot o1 svelte-10y1ir0"></span><span class="o-dot o2 svelte-10y1ir0"></span></div> <div class="progress-line svelte-10y1ir0"><span class="dot svelte-10y1ir0"></span></div> <div class="tagline svelte-10y1ir0">Preparing data</div></div></div></div>'),Eq=o=>o.stopPropagation(),$q=de('<div class="historical-loading-indicator svelte-10y1ir0"><div class="loading-spinner svelte-10y1ir0"></div> <span class="svelte-10y1ir0">Loading historical data...</span></div>'),jq=de('<div class="reset-menu svelte-10y1ir0"><button class="action-btn copy-btn svelte-10y1ir0"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" class="svelte-10y1ir0"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2" class="svelte-10y1ir0"></rect><path d="M5 15H4C2.9 15 2 14.1 2 13V4C2 2.9 2.9 2 4 2H13C14.1 2 15 2.9 15 4V5" stroke="currentColor" stroke-width="2" class="svelte-10y1ir0"></path></svg> <span class="svelte-10y1ir0"> </span></button> <button class="action-btn reset-btn svelte-10y1ir0"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" class="svelte-10y1ir0"><path d="M3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12C21 16.97 16.97 21 12 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" class="svelte-10y1ir0"></path><path d="M3 12L7 8M3 12L7 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" class="svelte-10y1ir0"></path></svg> <span class="svelte-10y1ir0">Reset View</span></button></div>'),zq=de('<div class="kline-main svelte-10y1ir0"><div class="alerts-container svelte-10y1ir0"></div> <!> <div class="chart-container svelte-10y1ir0"><div class="chart-shell svelte-10y1ir0"><div class="kline-content svelte-10y1ir0"><div class="drawbar-host svelte-10y1ir0" style="width: var(--drawing-bar-width); overflow: hidden;"><!></div> <!> <div class="kline-widget svelte-10y1ir0" role="application" tabindex="0"><canvas class="script-overlay svelte-10y1ir0"></canvas> <canvas class="tool-overlay svelte-10y1ir0"></canvas></div> <!></div> <div><div class="dock-resize-handle svelte-10y1ir0" aria-label="Resize script dock"><div class="handle-bar svelte-10y1ir0"></div></div> <div class="dock-body svelte-10y1ir0"><!></div></div></div> <!></div> <!> <!> <!> <!> <!> <!> <!></div>');function Bq(o,e){var ho,no,gn,dr;Ka(e,!0);const t=Zc(),s=()=>ir(T(),"$save",t),i=()=>ir(ce,"$chart",t),r=()=>ir(L(),"$ctx",t),a=()=>ir(y2,"$page",t),l=()=>ir(Td,"$simulator",t),d=()=>ir(Up,"$userPreferences",t),v=()=>ir(me,"$alerts",t),p=()=>ir(or,"$saveRestoring",t),_=()=>ir(fq,"$scriptBacktests",t),y=()=>ir(uq,"$scriptSignals",t);console.log("%c🤖 Welcome to Duty AI Chart %c v1.0.0 ","background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; font-size: 16px; font-weight: bold; padding: 10px 15px; border-radius: 8px 0 0 8px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);","background: #1a1a2e; color: #00d4ff; font-size: 14px; font-weight: bold; padding: 10px 15px; border-radius: 0 8px 8px 0;"),console.log("%c⚡ Everything Powered by Duty AI %c All Rights Reserved © 2025","background: #0f0f23; color: #00ff88; font-size: 12px; padding: 6px 12px; border-left: 3px solid #00ff88;","background: #0f0f23; color: #888; font-size: 11px; padding: 6px 12px;"),console.log("%c🧠 AI-Driven Trading Intelligence | Real-Time Market Analysis","color: #a855f7; font-size: 11px; font-style: italic; padding: 4px 0;"),gy("UTC");function w(z){const ve=`${z??""}`.replace(/0[\{\(](\d+)[\}\)]/g,(Re,je)=>{const Ue=Number(je);return!Number.isFinite(Ue)||Ue<=0?"0":"0".repeat(Math.min(50,Math.trunc(Ue)))}),Ne=(Re,je)=>{if(!Number.isFinite(Re)||Re===0)return`${Re}`;const Ue=Re<0?"-":"",kt=Math.abs(Re),lt=Math.floor(Math.log10(kt))+1;let bt=kt/Math.pow(10,lt),Ct=lt;const Kt=Number(bt.toFixed(je));return Kt>=1?(bt=Kt/10,Ct=lt+1):bt=Kt,`${Ue}${bt.toFixed(je)}e${Ct}`};try{const Re=/^(-?)([\d,]+)(?:\.(\d+))?$/.exec(ve.trim());if(Re){const je=Re[1]||"",Ue=Re[2]||"0",kt=Re[3]||"";if(Ue.replace(/,/g,"").length>=5&&kt.length>2)return`${je}${Ue}.${kt.slice(0,2).padEnd(2,"0")}`}}catch{}try{const Re=ym(s().symbol);if(Re==="stock"||Re==="crypto"){const je=Number(ve.replace(/,/g,"").trim());if(Number.isFinite(je)){const Ue=Math.abs(je);if(Ue>0&&Ue<1e-4)return Ne(je,5)}}}catch{}return ve}const k=new iI;let S=null;K7.forEach(z=>B2(z)),sP.forEach(z=>Z5(z)),tI.forEach(z=>{z.extendData=="datafeed"&&(z.extendData=k),r_(z)});let L=Ss(e,"ctx",19,()=>Id(new Ib)),T=Ss(e,"save",19,()=>f1("chart",new Lm)),P=Ss(e,"customLoad",3,!1);const A=5e3,F=`{
  "pane": "sub",
  "min": -2,
  "max": 2,
  "shortName": "Debug Area",
  "plots": [
    {
      "name": "AreaTest",
      "source": "close",
      "type": "area",
      "color": "rgba(129,140,248,0.4)",
      "width": 1
    }
  ]
}`;try{const z=sessionStorage.getItem("chart.tabId");z?Ir(T(),Uo(s).key=`chart:${z}`,Uo(s)):s().key||Ir(T(),Uo(s).key="chart",Uo(s))}catch{s().key||Ir(T(),Uo(s).key="chart",Uo(s))}try{const z=s()&&s().symbol&&typeof s().symbol=="object",te=s()&&s().period&&typeof s().period=="object";(!z||!te)&&T().set(new Lm)}catch{T().set(new Lm)}T().update(z=>{if(!(z.allExgs instanceof Set)){const te=Array.isArray(z.allExgs)?z.allExgs:[];z.allExgs=new Set(te)}return z});let B,R,N,$=null,V=[];const U=new Set;let G=null,Z=oe(!1),le=oe(!1),se=oe(null),ie=oe(!1),Y=oe(void 0),K=oe(void 0),Q=oe(void 0),q=oe(void 0);const ce=Id(null),_e=500,me=Qw();let Pe=oe(!1),ze=oe(!1),he=oe(!1),De=oe(.35);const ge=.2,be=.6;let $e=oe(!1),Ve=0,Ce=0,Je=oe(F),ye=oe("Ready"),Ae=oe(null),ee=oe(!1),xe=oe(!0);const ke="SCRIPT_STUDIO";let He=[],Ie=[],ne=oe(null),J=oe("main"),qe=new Set;const ft="script-trade-focus",Qe=(z,te)=>{const ve=typeof z=="number"?z:Number(z);if(!Number.isFinite(ve))return"-";try{return w(ve.toFixed(Math.max(0,Math.min(10,te))))}catch{return`${ve}`}};function Oe(){const z=i();if(z)try{z.removeOverlay({groupId:ft})}catch{}}function ct(z){var Ne;const te=i();if(!te||!z)return;const ve=Re=>{const je=typeof Re=="number"?Re:Number(Re);return!Number.isFinite(je)||je<=0?null:je<1e12?je*1e3:je};try{const Re=((Ne=te.getDataList)==null?void 0:Ne.call(te))||[],je=Math.max(0,Math.floor(Number(z.entryIndex)||0)),Ue=Math.max(0,Math.floor(Number(z.exitIndex)||0)),kt=Re[je]||null,lt=Re[Ue]||null,bt=ve(z.entryTimestamp)??ve((kt==null?void 0:kt.timestamp)??(kt==null?void 0:kt.time))??null,Ct=ve(z.exitTimestamp)??ve((lt==null?void 0:lt.timestamp)??(lt==null?void 0:lt.time))??null,Kt=Number(z.entryPrice),Dt=Number(z.exitPrice);if(!Number.isFinite(Kt)||!Number.isFinite(Dt)||bt==null||Ct==null)return;Oe();const jt=Number(z.netPnl)>=0,Co=jt?"#22c55e":"#ef4444",Oo=jt?"#16a34a":"#ef4444",Ho=jt?"#16a34a":"#f59e0b",Vo=Number(z.netPnl)||0,Cn=Number(z.fees)||0,Qs=String(z.exitReason||"").replace(/_/g," ");te.createOverlay({name:"trade",paneId:"candle_pane",groupId:ft,lock:!0,visible:!0,points:[{timestamp:bt,value:Kt},{timestamp:Ct,value:Dt},{timestamp:Ct,value:Dt}],extendData:{line_color:Co,in_color:Oo,out_color:Ho,in_text:`ENTRY ${String(z.side||"").toUpperCase()} @ ${Qe(Kt,6)}`,out_text:`EXIT @ ${Qe(Dt,6)} • ${Qs||"signal"} • Net ${Vo>=0?"+":""}${Qe(Vo,2)} • Fees ${Qe(Cn,2)}`,selected:!0,active:!0,distance:18}});try{te.createOverlay({name:"note",paneId:"candle_pane",groupId:ft,lock:!0,visible:!0,points:[{timestamp:bt,value:Kt},{timestamp:bt,value:Kt}],extendData:{line_color:"transparent",in_color:Oo,in_text:"ENTRY",out_color:Oo,out_text:"",distance:22}}),te.createOverlay({name:"note",paneId:"candle_pane",groupId:ft,lock:!0,visible:!0,points:[{timestamp:Ct,value:Dt},{timestamp:Ct,value:Dt}],extendData:{line_color:"transparent",in_color:Ho,in_text:`EXIT • ${Qs||"signal"}`,out_color:Ho,out_text:"",distance:22}})}catch{}try{te.scrollToDataIndex(Ue,0)}catch{try{te.scrollToTimestamp(Ct,0)}catch{}}}catch(Re){console.error("[ScriptStudio] focus trade failed",Re)}}function Lt(z){const te=i();if(!te)return!1;const ve=Math.max(0,Math.floor(Number(z)||0));try{return te.scrollToDataIndex(ve,0),!0}catch(Ne){return console.error("[ScriptStudio] focus index failed",Ne),!1}}function It(z){const te=i();if(!te)return!1;const ve=Math.floor(Number(z)||0);if(!Number.isFinite(ve)||ve<=0)return!1;try{return te.scrollToTimestamp(ve,0),!0}catch(Ne){return console.error("[ScriptStudio] focus timestamp failed",Ne),!1}}let zt=new Map;const pt=new Set;let Mo=null,Xo=null;const en={solid:Ee.Solid,dashed:Ee.Dashed,dotted:Ee.Dashed};let Fo={};function Eo(z){let te=String(z||"").trim();return te=te.replace(/\$\{([^}]+)\}/g,(ve,Ne)=>{const Re=Fo[String(Ne)];if(Re==null)return ve;if(typeof Re=="number"&&Number.isFinite(Re)||typeof Re=="string")return String(Re);try{return JSON.stringify(Re)}catch{return String(Re)}}),te=te.replace(/\/\/.*$/,"").replace(/#.*$/,""),te=te.split(";")[0],te=te.replace(/,\s*$/,""),te=te.replace(/\b(and|or)\b\s*$/i,""),te=te.replace(/\bcrosses\s+above\b/gi,"crossesAbove"),te=te.replace(/\bcrosses\s+below\b/gi,"crossesBelow"),te.trim()}function cs(z){const te=Eo(z);try{return Mv(te)}catch{let Ne=te.replace(/[^A-Za-z0-9_().<>=!,\s]/g,"");Ne=Ne.replace(/[,;]+\s*$/,"").replace(/\b(and|or)\b\s*$/i,"").trim(),Ne=Ne.replace(/\bcrosses\s+above\b/gi,"crossesAbove").replace(/\bcrosses\s+below\b/gi,"crossesBelow");try{return Mv(Ne)}catch{const je=Ne.match(/([A-Za-z_$][A-Za-z0-9_$]*)/),Ue=Ne.match(/([-+]?\d+(?:\.\d+)?)/),kt=/crossesBelow|\bbelow\b/i.test(Ne),lt=je?je[1]:"close",bt=Ue?Ue[1]:"0",Ct=`${lt} ${kt?"<":">"} ${bt}`;return Mv(Ct)}}}function Zt(z,te){var ve,Ne,Re;try{const je=cs(z);return Jy(je,te)}catch{const kt=Eo(z).match(/^(\w+)\s*(crossesAbove|crossesBelow)\s*(\w+|[-+]?\d+(?:\.\d+)?)$/i),lt=((ve=Object.values(te)[0])==null?void 0:ve.length)||0,bt=new Uint8Array(lt);if(kt&&lt){const Ct=kt[1],Kt=kt[2],Dt=kt[3],jt=te[((Ne=Ct==null?void 0:Ct.toLowerCase)==null?void 0:Ne.call(Ct).replace(/\s+/g,"_"))||Ct],Co=/^[-+]?\d+(?:\.\d+)?$/.test(Dt),Oo=Co?null:te[((Re=Dt==null?void 0:Dt.toLowerCase)==null?void 0:Re.call(Dt).replace(/\s+/g,"_"))||Dt],Ho=Co?Number(Dt):NaN;if(jt&&(Oo||Co))for(let Vo=1;Vo<lt;(Vo+=1)-1){const Cn=jt[Vo-1],Qs=jt[Vo],Gn=Co?Ho:Oo[Vo-1],zi=Co?Ho:Oo[Vo];if(![Cn,Qs,Gn,zi].every(Number.isFinite)){bt[Vo]=0;continue}bt[Vo]=Kt.toLowerCase()==="crossesabove"?Cn<=Gn&&Qs>zi?1:0:Cn>=Gn&&Qs<zi?1:0}}return bt}}let bs=!1,es=oe(!1),rn=oe(null),wr=!0,rr=null,ar=oe(!1),jr=null,ii=0;function Xa(){return ii+=1,ii}let Ja=null,Va=null,Wa=null,Qa=null,qa=null,Kl=null,ll=null,Wr=null;const Ca=()=>{i()&&(Ja&&(clearTimeout(Ja),Ja=null),Va&&(cancelAnimationFrame(Va),Va=null),Va=requestAnimationFrame(()=>{Va=null,ml.request(()=>{if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const z=Ul(s().theme);Rt.merge(z,iv(s().styles)),i().setStyles(al(z)),ai(),rt(),Is()})}),Ja=setTimeout(()=>{Ja=null,ml.request(()=>{var ve,Ne;if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const z=Ul(s().theme);Rt.merge(z,iv(s().styles)),i().setStyles(al(z)),ai(),rt(),Is();const te=(Ne=(ve=i()).getVisibleRange)==null?void 0:Ne.call(ve);te&&typeof te.to=="number"&&setTimeout(()=>{i()&&(i().scrollToDataIndex(te.to,0),console.log("🔄 Forced canvas redraw after window resize to prevent blur"))},30)})},160))},vl=w1(),ml=th(),Sl=new S1("global-chart",ce,s().theme||"dark");let el=null;const or=Id(!1);$p("ctx",L()),$p("save",T()),$p("chart",ce),$p("alerts",me),$p("datafeed",k),$p("renderIntegration",vl),$p("globalThemeManager",Sl),$p("drawingManager",{get:()=>el}),$p("saveRestoring",or);function tc(z){const te=z.match(/WIN\s*=\s*(\d+)/i),ve=Math.max(2,Math.min(500,te&&parseInt(te[1],10)||5)),Ne=z.match(/label\s+at\s+top\s+text:\s*\"?([^\"\n]+)\"?/i),Re=z.match(/label\s+at\s+bot\s+text:\s*\"?([^\"\n]+)\"?/i),je=z.match(/label\s+at\s+top.*color:\s*([#a-zA-Z0-9]+)/i),Ue=z.match(/label\s+at\s+bot.*color:\s*([#a-zA-Z0-9]+)/i),kt=((Ne==null?void 0:Ne[1])||"▲").trim(),lt=((Re==null?void 0:Re[1])||"▼").trim(),bt=((je==null?void 0:je[1])||"#f97316").trim(),Ct=((Ue==null?void 0:Ue[1])||"#3b82f6").trim();if(!kt||!lt)throw new Error("Script is missing label text for top/bot.");return{window:ve,topText:kt,botText:lt,topColor:bt,botColor:Ct}}function pe(z,te){return{name:te,shortName:"Script",precision:4,zLevel:10,calcParams:[z.window],figures:[{key:"hi",title:`HI(${z.window})`,type:"line"},{key:"lo",title:`LO(${z.window})`,type:"line"}],styles:{lines:[{color:"rgba(0,0,0,0)",size:1e-4,style:Ee.Solid},{color:"rgba(0,0,0,0)",size:1e-4,style:Ee.Solid}]},shouldOhlc:!0,calc:(ve,Ne)=>{var kt;const Re=Math.max(2,Math.min(500,((kt=Ne.calcParams)==null?void 0:kt[0])||z.window||5)),je=Math.max(2,Math.floor(Re/2)),Ue=[];for(let lt=0;lt<ve.length;(lt+=1)-1){const bt=ve[lt].high??ve[lt].close,Ct=ve[lt].low??ve[lt].close;let Kt,Dt,jt=!1,Co=!1;if(lt>=je&&lt<=ve.length-je-1){const Oo=lt-je,Ho=lt+je;let Vo=-1/0,Cn=1/0;for(let wn=Oo;wn<=Ho;(wn+=1)-1){const Ro=ve[wn].high??ve[wn].close,Qo=ve[wn].low??ve[wn].close;Ro>Vo&&(Vo=Ro),Qo<Cn&&(Cn=Qo)}Kt=Vo,Dt=Cn;const Qs=Math.max(1e-8,Math.abs(bt||Ct||1)*1e-4);let Gn=-1,zi=-1;for(let wn=Oo;wn<=Ho;(wn+=1)-1){const Ro=ve[wn].high??ve[wn].close,Qo=ve[wn].low??ve[wn].close;if(Gn===-1&&Math.abs(Ro-Vo)<=Qs&&(Gn=wn),zi===-1&&Math.abs(Qo-Cn)<=Qs&&(zi=wn),Gn!==-1&&zi!==-1)break}jt=Math.abs(bt-Vo)<=Qs&&lt===Gn,Co=Math.abs(Ct-Cn)<=Qs&&lt===zi}Ue.push({hi:Kt,lo:Dt,high:bt,low:Ct,topSignal:jt,botSignal:Co})}return Ue},draw:({ctx:ve,indicator:Ne,xAxis:Re,yAxis:je,bounding:Ue})=>{if(!ve||!Re||!je)return!1;const kt=(Ne==null?void 0:Ne.result)||[];ve.save(),Ue&&(ve.beginPath(),ve.rect(0,0,Ue.width,Ue.height),ve.clip()),ve.textAlign="center",ve.textBaseline="middle",ve.font='12px "Inter", "SF Pro", system-ui, -apple-system, sans-serif';for(let lt=0;lt<kt.length;(lt+=1)-1){const bt=kt[lt];if(!bt)continue;const Ct=Re.convertToPixel(lt);if(bt.topSignal&&bt.hi!==void 0){const Kt=je.convertToPixel(bt.hi);if(Number.isFinite(Kt)){const Dt=Kt-8;ve.fillStyle=z.topColor,ve.strokeStyle="rgba(0,0,0,0.35)",ve.lineWidth=1,ve.textBaseline="middle",ve.fillText(z.topText,Ct,Dt),ve.strokeText(z.topText,Ct,Dt),ve.beginPath(),ve.arc(Ct,Dt-8,3.5,0,Math.PI*2),ve.fill(),ve.stroke()}}if(bt.botSignal&&bt.lo!==void 0){const Kt=je.convertToPixel(bt.lo);if(Number.isFinite(Kt)){const Dt=Kt+8;ve.fillStyle=z.botColor,ve.strokeStyle="rgba(0,0,0,0.35)",ve.lineWidth=1,ve.textBaseline="middle",ve.fillText(z.botText,Ct,Dt),ve.strokeText(z.botText,Ct,Dt),ve.beginPath(),ve.arc(Ct,Dt+8,3.5,0,Math.PI*2),ve.fill(),ve.stroke()}}}return ve.restore(),!0}}}function rt(){if(!B)return;const z=B.getBoundingClientRect(),te=typeof window<"u"?Math.max(1,window.devicePixelRatio||1):1,ve=Ne=>{if(!Ne)return;Ne.style.width=`${z.width}px`,Ne.style.height=`${z.height}px`,Ne.width=Math.floor(z.width*te),Ne.height=Math.floor(z.height*te);const Re=Ne.getContext("2d");Re&&Re.setTransform(te,0,0,te,0,0)};ve(R),ve(N),$=R==null?void 0:R.getContext("2d"),N==null||N.getContext("2d")}function Ft(){const z={},te=B==null?void 0:B.getBoundingClientRect(),ve=(te==null?void 0:te.width)??((R==null?void 0:R.width)||0),Ne=(te==null?void 0:te.height)??((R==null?void 0:R.height)||0),Re=new DOMRect(0,0,ve,Ne);return((B==null?void 0:B.querySelectorAll('[class*="klinecharts-pane"]'))||[]).forEach((Ue,kt)=>{const bt=Ue.getAttribute("data-pane-id")||Ue.getAttribute("data-id")||""||(kt===0?"candle_pane":`pane_index_${kt}`);if(!bt)return;const Ct=Ue.getBoundingClientRect();if(te){const Kt=Ct.left-te.left,Dt=Ct.top-te.top;z[bt]=new DOMRect(Kt,Dt,Ct.width,Ct.height)}else z[bt]=Re}),z.candle_pane||(z.candle_pane=Re),z}function Qt(z){var je,Ue,kt,lt,bt,Ct;if(!i())return null;const te=i(),ve=((je=te.getDrawPaneById)==null?void 0:je.call(te,z))??((Ue=te._drawPanes)==null?void 0:Ue.find(Kt=>{var Dt;return((Dt=Kt==null?void 0:Kt.getId)==null?void 0:Dt.call(Kt))===z}));if(!(ve!=null&&ve.getAxisComponent))return null;const Ne=ve.getAxisComponent(),Re=((bt=(lt=(kt=ve.getMainWidget)==null?void 0:kt.call(ve))==null?void 0:lt.getBounding)==null?void 0:bt.call(lt))??((Ct=ve.getBounding)==null?void 0:Ct.call(ve));return Ne?{axis:Ne,bounding:Re}:null}function xt(z){var lt,bt;const te=zt.get(z);if(!te)return;const ve=Qt(z);if(!ve)return;const{axis:Ne}=ve,Re=Math.min(te.min,te.max),je=Math.max(te.min,te.max),Ue=Math.max(1e-9,je-Re),kt={from:Re,to:je,range:Ue,realFrom:Re,realTo:je,realRange:Ue,displayFrom:Re,displayTo:je,displayRange:Ue};(lt=Ne.setRange)==null||lt.call(Ne,kt),(bt=Ne.buildTicks)==null||bt.call(Ne,!0)}function eo(z){zt.has(z)&&(pt.has(z)||(pt.add(z),ml.request(()=>{pt.delete(z),xt(z)})))}function Is(){var Ne,Re,je,Ue;if(!$||!i())return;const z=$;z.clearRect(0,0,R.width,R.height),z.save(),z.font='12px "Inter", system-ui, -apple-system, sans-serif',z.textAlign="center",z.textBaseline="middle";const te=Ft(),ve=((Re=(Ne=i()).getDataList)==null?void 0:Re.call(Ne))||[];for(const kt of V){const{def:lt,paneId:bt}=kt;let Ct=[];try{const Co=((je=lt.calc)==null?void 0:je.call(lt,ve,{calcParams:lt.calcParams||[]}))||[];Ct=Array.isArray(Co)?Co:Array.isArray(Co==null?void 0:Co.__rows)?Co.__rows:[]}catch{}if(!Array.isArray(Ct)||Ct.length===0)continue;const Kt=te[bt]||te.candle_pane,Dt={left:Kt.left,top:Kt.top,width:Kt.width,height:Kt.height},jt=dq(lt.name);if(Array.isArray(jt)&&jt.length)for(const Co of jt){const Oo=Co.index,Ho=ve[Oo],Vo=(Ho==null?void 0:Ho.timestamp)??(Ho==null?void 0:Ho.time);if(!Number.isFinite(Vo))continue;let Cn,Qs="",Gn="",zi=!0,wn="";Co.type==="entry_long"?(Cn=(Ho==null?void 0:Ho.low)??(Ho==null?void 0:Ho.close),Qs="triangle_up_filled",Gn="#16a34a",zi=!0,wn="BUY"):Co.type==="exit_long"?(Cn=(Ho==null?void 0:Ho.high)??(Ho==null?void 0:Ho.close),Qs="triangle_down_filled",Gn="#f59e0b",zi=!1,wn="EXIT"):Co.type==="entry_short"?(Cn=(Ho==null?void 0:Ho.high)??(Ho==null?void 0:Ho.close),Qs="triangle_down_filled",Gn="#ef4444",zi=!1,wn="SELL"):Co.type==="exit_short"&&(Cn=(Ho==null?void 0:Ho.low)??(Ho==null?void 0:Ho.close),Qs="triangle_up_filled",Gn="#f59e0b",zi=!0,wn="EXIT");const Ro=Array.isArray(lt==null?void 0:lt.figures)&&((Ue=lt.figures[0])!=null&&Ue.key)?String(lt.figures[0].key):"",Qo=bt!=="candle_pane";let oo=Cn;if(Qo&&Ro){const Br=(Ct[Oo]||{})[Ro];Br!=null&&Number.isFinite(Br)&&(oo=Br)}if(!Number.isFinite(oo))continue;const Yt=k1({id:Oo,t:Vo,p:oo},{chart:i(),paneId:bt});if(!Yt)continue;let Ht=Yt.y;const To=10;Ht=zi?Ht-To:Ht+To;const vo=Dt.top+6,Ot=Dt.top+Dt.height-6;Ht=Math.max(vo,Math.min(Ot,Ht));const Yo=Qs==="triangle_up_filled"?"triangleUpFilled":Qs==="triangle_down_filled"?"triangleDownFilled":Qs==="arrow_up"?"arrowUp":Qs==="arrow_down"?"arrowDown":"label",is=16,vs=is/2,Rs="rgba(15,23,42,0.95)",Ws="rgba(0,0,0,0.65)",li=Gn;if(z.lineWidth=1,z.strokeStyle=Ws,z.fillStyle=Gn||Rs,Yo==="triangleUpFilled")z.beginPath(),z.moveTo(Yt.x,Ht-vs),z.lineTo(Yt.x-vs,Ht+vs),z.lineTo(Yt.x+vs,Ht+vs),z.closePath(),z.fill(),z.stroke();else if(Yo==="triangleDownFilled")z.beginPath(),z.moveTo(Yt.x,Ht+vs),z.lineTo(Yt.x-vs,Ht-vs),z.lineTo(Yt.x+vs,Ht-vs),z.closePath(),z.fill(),z.stroke();else if(Yo==="arrowUp")z.beginPath(),z.moveTo(Yt.x,Ht-vs),z.lineTo(Yt.x-vs,Ht+vs),z.lineTo(Yt.x+vs,Ht+vs),z.closePath(),z.fill(),z.stroke();else if(Yo==="arrowDown")z.beginPath(),z.moveTo(Yt.x,Ht+vs),z.lineTo(Yt.x-vs,Ht-vs),z.lineTo(Yt.x+vs,Ht-vs),z.closePath(),z.fill(),z.stroke();else{const an=Math.max(10,z.measureText(wn).width+12),Br=Math.max(12,is+6),ya=Math.max(3,Math.floor(Br/3)),As=Yt.x-Math.floor(an/2),qs=Ht-Math.floor(Br/2);z.beginPath();const Jn=ya;z.moveTo(As+Jn,qs),z.lineTo(As+an-Jn,qs),z.quadraticCurveTo(As+an,qs,As+an,qs+Jn),z.lineTo(As+an,qs+Br-Jn),z.quadraticCurveTo(As+an,qs+Br,As+an-Jn,qs+Br),z.lineTo(As+Jn,qs+Br),z.quadraticCurveTo(As,qs+Br,As,qs+Br-Jn),z.lineTo(As,qs+Jn),z.quadraticCurveTo(As,qs,As+Jn,qs),z.closePath(),z.fill(),z.stroke()}wn&&(z.fillStyle=li,z.strokeStyle="rgba(0,0,0,0.45)",z.fillText(wn,Yt.x,Ht),z.strokeText(wn,Yt.x,Ht))}}$==null||$.restore()}function Po(z,te){const ve=[];let Ne=0;for(let Re=0;Re<z.length;(Re+=1)-1){const je=z[Re];Ne+=je??0,Re>=te&&(Ne-=z[Re-te]??0),ve.push(Re>=te-1?Ne/te:void 0)}return ve}function Ze(z,te){const ve=[],Ne=te*(te+1)/2;for(let Re=0;Re<z.length;(Re+=1)-1){if(Re<te-1){ve.push(void 0);continue}let je=0;for(let Ue=0;Ue<te;(Ue+=1)-1)je+=(z[Re-Ue]??0)*(te-Ue);ve.push(je/Ne)}return ve}function Ke(z,te){const ve=[];let Ne,Re=0;for(let je=0;je<z.length;(je+=1)-1){const Ue=z[je];if(Ue==null){ve.push(void 0);continue}if(Ne===void 0){if(Re+=Ue,je<te-1){ve.push(void 0);continue}Ne=Re/te,ve.push(Ne);continue}Ne=(Ne*(te-1)+Ue)/te,ve.push(Ne)}return ve}function ps(z,te){const ve=[],Ne=2/(te+1);let Re;for(let je=0;je<z.length;(je+=1)-1){const Ue=z[je];if(Ue==null){ve.push(void 0);continue}Re=Re===void 0?Ue:Ue*Ne+Re*(1-Ne),ve.push(Re)}return ve}function pn(z,te){const ve=[];let Ne,Re=0,je=0,Ue=!1;const kt=[],lt=[];for(let bt=0;bt<z.length;(bt+=1)-1){const Ct=z[bt];if(Ct==null){ve.push(void 0);continue}if(Ne===void 0){Ne=Ct,ve.push(void 0);continue}const Kt=Ct-Ne;Ne=Ct;const Dt=Kt>0?Kt:0,jt=Kt<0?-Kt:0;if(Ue)Re=(Re*(te-1)+Dt)/te,je=(je*(te-1)+jt)/te;else{if(kt.push(Dt),lt.push(jt),kt.length<te){ve.push(void 0);continue}Re=kt.reduce((Co,Oo)=>Co+Oo,0)/te,je=lt.reduce((Co,Oo)=>Co+Oo,0)/te,Ue=!0}if(je===0)ve.push(100);else{const Co=Re/je;ve.push(100-100/(1+Co))}}return ve}function Jo(z,te,ve,Ne){const Re=ve.length,je=new Array(Re).fill(0);let Ue;for(let bt=0;bt<Re;(bt+=1)-1){const Ct=z[bt]??ve[bt]??NaN,Kt=te[bt]??ve[bt]??NaN,Dt=ve[bt]??NaN;let jt=Math.max(0,Ct-Kt);Ue!==void 0&&(jt=Math.max(jt,Math.abs(Ct-Ue),Math.abs(Kt-Ue))),je[bt]=jt,Ue=Dt}const kt=new Array(Re);let lt=0;for(let bt=0;bt<Re;(bt+=1)-1)lt+=je[bt],bt===Ne-1?kt[bt]=lt/Ne:bt>=Ne?kt[bt]=(kt[bt-1]*(Ne-1)+je[bt])/Ne:kt[bt]=void 0;return kt}function ti(z,te){const ve=new Array(z.length);let Ne=0,Re;for(let je=0;je<z.length;(je+=1)-1){const Ue=z[je],kt=te[je]??0;if(Re===void 0||Ue===void 0){ve[je]=void 0,Re=Ue;continue}Ue>Re?Ne+=kt:Ue<Re&&(Ne-=kt),ve[je]=Ne,Re=Ue}return ve}function mr(z,te,ve,Ne){const Re=ve.length,je=new Array(Re);for(let lt=0;lt<Re;(lt+=1)-1)je[lt]=((z[lt]??ve[lt]??0)+(te[lt]??ve[lt]??0)+(ve[lt]??0))/3;const Ue=Po(je.map(lt=>lt),Ne).map(lt=>lt),kt=new Array(Re);for(let lt=0;lt<Re;(lt+=1)-1){if(lt<Ne-1){kt[lt]=void 0;continue}let bt=0;for(let Kt=lt-Ne+1;Kt<=lt;(Kt+=1)-1)bt+=Math.abs(je[Kt]-Ue[lt]);bt=bt/Ne;const Ct=.015*bt;kt[lt]=Ct===0?void 0:(je[lt]-Ue[lt])/Ct}return kt}function sa(z,te,ve,Ne,Re){const je=ve.length,Ue=new Array(je),kt=new Array(je);for(let bt=0;bt<je;(bt+=1)-1)kt[bt]=((z[bt]??ve[bt]??0)+(te[bt]??ve[bt]??0)+(ve[bt]??0))/3;const lt=new Array(je);for(let bt=0;bt<je;(bt+=1)-1)lt[bt]=kt[bt]*(Ne[bt]??0);for(let bt=0;bt<je;(bt+=1)-1){if(bt<Re){Ue[bt]=void 0;continue}let Ct=0,Kt=0;for(let jt=bt-Re+1;jt<=bt;(jt+=1)-1)kt[jt]>=kt[jt-1]?Ct+=lt[jt]:Kt+=lt[jt];const Dt=Kt===0?1/0:Ct/Kt;Ue[bt]=100-100/(1+Dt)}return Ue}function yt(z,te){const ve=z.map((Ue,kt)=>((Ue??0)+(te[kt]??0))/2),Ne=Po(ve,5),Re=Po(ve,34),je=new Array(ve.length);for(let Ue=0;Ue<ve.length;(Ue+=1)-1){const kt=Ne[Ue],lt=Re[Ue];je[Ue]=kt===void 0||lt===void 0?void 0:kt-lt}return je}function wt(z,te){const ve=ps(z,te).map(Ue=>Ue??NaN),Ne=ps(ve,te).map(Ue=>Ue??NaN),Re=ps(Ne,te).map(Ue=>Ue??NaN),je=new Array(z.length);for(let Ue=1;Ue<z.length;(Ue+=1)-1){const kt=Re[Ue-1],lt=Re[Ue];je[Ue]=kt===void 0||lt===void 0||kt===0?void 0:(lt/kt-1)*100}return je[0]=void 0,je}function to(z,te){const ve=new Array(z.length);let Ne=0,Re=0;for(let je=0;je<z.length;(je+=1)-1){const Ue=z[je],kt=te[je]??0;if(Ue===void 0){ve[je]=void 0;continue}Ne+=Ue*kt,Re+=kt,ve[je]=Re===0?void 0:Ne/Re}return ve}function mt(z,te,ve){const Ne=new Array(z.length);let Re=0,je=0;for(let Ue=0;Ue<z.length;(Ue+=1)-1){const kt=z[Ue],lt=te[Ue]??0;if(kt!==void 0&&(Re+=kt*lt,je+=lt),Ue>=ve){const bt=z[Ue-ve],Ct=te[Ue-ve]??0;bt!==void 0&&(Re-=bt*Ct,je-=Ct)}Ne[Ue]=Ue>=ve-1&&je!==0?Re/je:void 0}return Ne}function Wt(z,te,ve){const Ne=z.map(lt=>lt??NaN),Re=Po(Ne,te);pn(Ne,1)&&Ne&&Po(Ne,1);const je=[];for(let lt=0;lt<Ne.length;(lt+=1)-1){if(lt<te-1){je.push(void 0);continue}let bt=0;for(let Dt=lt-te+1;Dt<=lt;(Dt+=1)-1)bt+=Ne[Dt];const Ct=bt/te;let Kt=0;for(let Dt=lt-te+1;Dt<=lt;(Dt+=1)-1){const jt=Ne[Dt]-Ct;Kt+=jt*jt}je.push(Math.sqrt(Kt/te))}const Ue=new Array(Ne.length),kt=new Array(Ne.length);for(let lt=0;lt<Ne.length;(lt+=1)-1){const bt=Re[lt],Ct=je[lt];Ue[lt]=bt===void 0||Ct===void 0?void 0:bt+ve*Ct,kt[lt]=bt===void 0||Ct===void 0?void 0:bt-ve*Ct}return{mid:Re,upper:Ue,lower:kt}}function vt(z,te,ve,Ne,Re){const je=ve.length,Ue=Jo(z,te,ve,Ne).map(jt=>jt??NaN),kt=new Array(je),lt=new Array(je);for(let jt=0;jt<je;(jt+=1)-1){const Co=((z[jt]??ve[jt]??0)+(te[jt]??ve[jt]??0))/2,Oo=Ue[jt];kt[jt]=Co+Re*Oo,lt[jt]=Co-Re*Oo}const bt=new Array(je);let Ct=NaN,Kt=NaN,Dt=!0;for(let jt=0;jt<je;(jt+=1)-1){Ct=Number.isFinite(Ct)?Math.min(kt[jt],Ct):kt[jt],Kt=Number.isFinite(Kt)?Math.max(lt[jt],Kt):lt[jt];const Co=ve[jt]??NaN;if(!Number.isFinite(Co)){bt[jt]=void 0;continue}Dt?(Co<Kt&&(Dt=!1,Ct=kt[jt]),bt[jt]=Kt):(Co>Ct&&(Dt=!0,Kt=lt[jt]),bt[jt]=Ct)}return bt}function $t(z,te,ve,Ne,Re){const je=ps(ve,Ne).map(Ct=>Ct??NaN),Ue=Jo(z,te,ve,Ne).map(Ct=>Ct??NaN),kt=ve.length,lt=new Array(kt),bt=new Array(kt);for(let Ct=0;Ct<kt;(Ct+=1)-1){const Kt=je[Ct],Dt=Ue[Ct];lt[Ct]=Number.isFinite(Kt)&&Number.isFinite(Dt)?Kt+Re*Dt:void 0,bt[Ct]=Number.isFinite(Kt)&&Number.isFinite(Dt)?Kt-Re*Dt:void 0}return{mid:je,upper:lt,lower:bt}}function zo(z,te,ve){const Ne=z.length,Re=new Array(Ne),je=new Array(Ne),Ue=new Array(Ne);for(let kt=0;kt<Ne;(kt+=1)-1){if(kt<ve-1){Re[kt]=void 0,je[kt]=void 0,Ue[kt]=void 0;continue}let lt=-1/0,bt=1/0;for(let Ct=kt-ve+1;Ct<=kt;(Ct+=1)-1){const Kt=z[Ct]??te[Ct]??NaN,Dt=te[Ct]??z[Ct]??NaN;Number.isFinite(Kt)&&Kt>lt&&(lt=Kt),Number.isFinite(Dt)&&Dt<bt&&(bt=Dt)}Re[kt]=lt,je[kt]=bt,Ue[kt]=Number.isFinite(lt)&&Number.isFinite(bt)?(lt+bt)/2:void 0}return{upper:Re,lower:je,mid:Ue}}function bo(z,te){const ve=z.length,Ne=new Array(ve);for(let Re=0;Re<ve;(Re+=1)-1){if(Re<te-1){Ne[Re]=void 0;continue}let je=0;for(let Ct=Re-te+1;Ct<=Re;(Ct+=1)-1)je+=z[Ct]??0;const Ue=je/te;let kt=0;for(let Ct=Re-te+1;Ct<=Re;(Ct+=1)-1){const Kt=(z[Ct]??0)-Ue;kt+=Kt*Kt}const lt=Math.sqrt(kt/te),bt=z[Re]??NaN;Ne[Re]=Number.isFinite(lt)&&lt!==0?(bt-Ue)/lt:void 0}return Ne}function xo(z,te){const ve=z.length,Ne=new Array(ve);let Re=z[0];for(let je=0;je<ve;(je+=1)-1){const Ue=z[je],kt=te[je]??0;if(Ue==null){Ne[je]=void 0;continue}const lt=Ue>=(Re??Ue)?1:-1;Ne[je]=lt*kt,Re=Ue}return Ne}function Zo(z){const te=z.length,ve=new Array(te);let Ne=0;for(let Re=0;Re<te;(Re+=1)-1){const je=z[Re];if(je==null){ve[Re]=void 0;continue}Ne+=je,ve[Re]=Ne}return ve}function os(z,te){const ve=z.length,Ne=new Array(ve),Re=new Array(ve),je=new Array(ve);for(let Ue=0;Ue<ve;(Ue+=1)-1){if(Ue<te-1){Ne[Ue]=void 0,Re[Ue]=void 0,je[Ue]=void 0;continue}let kt=0,lt=0,bt=0,Ct=0,Kt=0;for(let Qs=Ue-te+1;Qs<=Ue;(Qs+=1)-1){const Gn=Qs-(Ue-te+1),zi=z[Qs]??NaN;Number.isFinite(zi)&&(kt+=Gn,lt+=zi,bt+=Gn*Gn,Ct+=Gn*zi,Kt+=1)}const Dt=Kt*bt-kt*kt;if(Dt===0||Kt===0){Ne[Ue]=void 0,Re[Ue]=void 0,je[Ue]=void 0;continue}const jt=(Kt*Ct-kt*lt)/Dt,Co=(lt-jt*kt)/Kt,Oo=te-1,Ho=jt*Oo+Co;Ne[Ue]=Ho;const Vo=bo(z.slice(Ue-te+1,Ue+1).map(Qs=>Qs??NaN),te).pop(),Cn=Number(Vo)*(z[Ue]??0?1:0);Re[Ue]=Number.isFinite(Ho)?Ho+Math.abs(Cn||0):void 0,je[Ue]=Number.isFinite(Ho)?Ho-Math.abs(Cn||0):void 0}return{mid:Ne,upper:Re,lower:je}}function ri(z,te,ve){const Ne=z.length,Re=new Array(Ne);let je=0;for(let Ue=0;Ue<Ne;(Ue+=1)-1){const kt=z[Ue],lt=te[Ue]??0;if(kt==null){Re[Ue]=void 0;continue}const bt=lt/Math.max(1,te[Ue-1]??lt);je=(je*(ve-1)+kt*bt)/ve,Re[Ue]=je}return Re}function vn(z,te){let ve=z.replace(/\s+/g,"_").toLowerCase().replace(/[^a-z0-9_]+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"")||"plot",Ne=1;for(;te.has(ve);)ve=`${ve}_${Ne}`,Ne+=1;return te.add(ve),ve}function sr(z){if(z){try{Ie.forEach(te=>{pq(te),p2(te)})}catch{}He.forEach(te=>{try{z.removeIndicator({id:te})}catch{}}),He=[],Ie.forEach(te=>{try{z.removeIndicator({paneId:"candle_pane",name:te})}catch{}try{z.removeIndicator({paneId:"pane_script",name:te})}catch{}try{z.removeIndicator({paneId:"script_pane",name:te})}catch{}}),Ie=[],zt.forEach((te,ve)=>{var Re,je,Ue;const Ne=Qt(ve);(Re=Ne==null?void 0:Ne.axis)!=null&&Re.setAutoCalcTickFlag&&(Ne.axis.setAutoCalcTickFlag(!0),(Ue=(je=Ne.axis).buildTicks)==null||Ue.call(je,!0))}),zt.clear(),pt.clear(),b(ne,null)}}async function Ko(z){var Ws,li,an,Br,ya,As,qs,Jn,Pi,_l,ur,yl,kn,Sr,Ba;const te=i();if(!te)throw new Error("Chart not ready yet. Please try again in a moment.");const ve=Array.isArray(z.calc)?z.calc:[],Ne=Array.isArray(z.series)?z.series:[],Re=Array.isArray(z.stateSeries)?z.stateSeries:[],je=[],Ue=Array.isArray(z.signals)?z.signals:[];if(Array.isArray(z.panes))for(const Pt of z.panes){const Ut=Pt.pane==="sub"?"sub":"main";je.push({pane:Ut,plots:Array.isArray(Pt.plots)?Pt.plots:[],levels:Array.isArray(Pt.levels)?Pt.levels:[],labels:Array.isArray(Pt.labels)?Pt.labels:[],lines:Array.isArray(Pt.lines)?Pt.lines:[],overlays:Array.isArray(Pt.overlays)?Pt.overlays:[],fills:Array.isArray(Pt.fills)?Pt.fills:[],backgroundZones:Array.isArray(Pt.backgroundZones)?Pt.backgroundZones:[],min:Pt.min,max:Pt.max,shortName:Pt.shortName||z.shortName,height:Pt.height})}else if(z.main||z.sub)z.main&&je.push({pane:"main",plots:Array.isArray(z.main.plots)?z.main.plots:[],levels:Array.isArray(z.main.levels)?z.main.levels:[],labels:Array.isArray(z.main.labels)?z.main.labels:[],lines:Array.isArray(z.main.lines)?z.main.lines:[],overlays:Array.isArray(z.main.overlays)?z.main.overlays:Array.isArray(z.overlays)?z.overlays:[],fills:Array.isArray(z.main.fills)?z.main.fills:[],backgroundZones:Array.isArray(z.main.backgroundZones)?z.main.backgroundZones:[],min:z.main.min,max:z.main.max,shortName:z.main.shortName||z.shortName,height:z.main.height}),z.sub&&je.push({pane:"sub",plots:Array.isArray(z.sub.plots)?z.sub.plots:[],levels:Array.isArray(z.sub.levels)?z.sub.levels:[],labels:Array.isArray(z.sub.labels)?z.sub.labels:[],lines:Array.isArray(z.sub.lines)?z.sub.lines:[],overlays:Array.isArray(z.sub.overlays)?z.sub.overlays:[],fills:Array.isArray(z.sub.fills)?z.sub.fills:[],backgroundZones:Array.isArray(z.sub.backgroundZones)?z.sub.backgroundZones:[],min:z.sub.min,max:z.sub.max,shortName:z.sub.shortName||z.shortName,height:z.sub.height});else{const Ut=z.pane==="sub"?"sub":z.pane==="main"?"main":n(J);je.push({pane:Ut,plots:Array.isArray(z.plots)?z.plots:[],levels:Array.isArray(z.levels)?z.levels:[],labels:Array.isArray(z.labels)?z.labels:[],lines:Array.isArray(z.lines)?z.lines:[],overlays:Array.isArray(z.overlays)?z.overlays:[],fills:Array.isArray(z.fills)?z.fills:[],backgroundZones:Array.isArray(z.backgroundZones)?z.backgroundZones:[],min:z.min,max:z.max,shortName:z.shortName,height:z.height}),b(J,j(Ut))}if(!je.length)throw new Error("No panes defined in script.");const kt=(()=>{const Pt=je.findIndex(Ut=>Ut.pane==="main");return Pt>=0?Pt:0})(),lt=je.some(Pt=>Pt.plots&&Pt.plots.length||Pt.labels&&Pt.labels.length||Pt.levels&&Pt.levels.length||Pt.lines&&Pt.lines.length),bt=!!(z!=null&&z.strategy)||Ue.length>0;if(!lt&&!bt)throw new Error("No plots or labels defined in script.");!lt&&bt&&(je[0]||je.push({pane:"main",plots:[],levels:[],labels:[],lines:[],overlays:[]}),je[0].plots=Array.isArray(je[0].plots)?je[0].plots:[],je[0].plots.push({name:"__hidden__",source:"close",type:"line",color:"rgba(0,0,0,0)",width:1e-4,style:"solid",layer:"background"})),sr(te);try{te.removeOverlay({groupId:"runtime"})}catch{}const Ct=`${ke}_${Date.now()}`,Kt=new Map,Dt=Pt=>{const Ut=String(Pt||"").trim(),xs=Ut.lastIndexOf("@");if(xs>0&&xs<Ut.length-1){const fs=Ut.slice(0,xs).trim(),rs=Ut.slice(xs+1).trim();if(fs&&rs)return{ticker:fs,country:rs}}return{ticker:Ut}},jt=Pt=>String(Pt||"").trim().toLowerCase().replace(/\s+/g,""),Co=Array.isArray((Ws=s())==null?void 0:Ws.allSymbols)?s().allSymbols:[],Oo=new Map,Ho=new Map,Vo=new Map;for(const Pt of Co){const Ut=jt(String((Pt==null?void 0:Pt.ticker)||""));Ut&&Oo.set(Ut,Pt);const xs=jt(String((Pt==null?void 0:Pt.shortName)||""));xs&&!Ho.has(xs)&&Ho.set(xs,Pt);const fs=jt(String((Pt==null?void 0:Pt.name)||""));fs&&!Vo.has(fs)&&Vo.set(fs,Pt)}const Cn=(Pt,Ut)=>{let xs=String(Pt??"").trim();if(!xs)return"__CURRENT__";try{xs=xs.replace(/\$\{([^}]+)\}/g,(Ds,sn)=>{var Wo;const na=(Ut==null?void 0:Ut[sn])??(Ut==null?void 0:Ut[(Wo=sn==null?void 0:sn.toLowerCase)==null?void 0:Wo.call(sn)]);return na==null?Ds:String(na)})}catch{}const fs=xs.trim();if(/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(fs)){const Ds=(Ut==null?void 0:Ut[fs])??(Ut==null?void 0:Ut[fs.toLowerCase()]);typeof Ds=="string"&&Ds.trim()&&(xs=Ds.trim())}const rs=String(xs).trim(),mn=rs.toLowerCase();return mn==="syminfo.tickerid"||mn==="syminfo.ticker"||mn==="syminfo.root"||mn==="__current__"||mn==="__current_symbol__"?"__CURRENT__":rs},Qs=(Pt,Ut,xs)=>{const fs=Cn(Pt,xs);if(fs==="__CURRENT__")return zi;const rs=Dt(fs),mn=String(rs.ticker||"").trim(),Ds=jt(mn),sn=Ds&&Oo.get(Ds)||Ds&&Ho.get(Ds)||Ds&&Vo.get(Ds)||null,na=String(Ut||rs.country||(sn==null?void 0:sn.country)||zi.country||"BD").trim()||"BD";return sn&&String(sn.ticker||"").trim()?{...sn,country:na}:{...zi,ticker:mn,country:na}},Gn=z!=null&&z.params&&typeof z.params=="object"?z.params:{},zi=((li=s())==null?void 0:li.symbol)||{ticker:"UNKNOWN"},wn=((an=te.getDataList)==null?void 0:an.call(te))||[],Ro=typeof((Br=wn==null?void 0:wn[0])==null?void 0:Br.timestamp)=="number"?wn[0].timestamp:typeof((ya=wn==null?void 0:wn[0])==null?void 0:ya.time)=="number"?wn[0].time:0,Qo=typeof((As=wn==null?void 0:wn[wn.length-1])==null?void 0:As.timestamp)=="number"?wn[wn.length-1].timestamp:typeof((qs=wn==null?void 0:wn[wn.length-1])==null?void 0:qs.time)=="number"?wn[wn.length-1].time:0,oo=Pt=>{const Ut=String(Pt??"").trim();if(!Ut)return"__CURRENT__";const xs=Ut.toUpperCase();if(xs==="CURRENT"||xs==="__CURRENT__"||xs==="TIMEFRAME.PERIOD")return"__CURRENT__";if(xs==="D"||xs==="1D")return"1d";if(xs==="W"||xs==="1W")return"1w";if(xs==="M"||xs==="1M")return"1M";const fs=xs.match(/^(\d+)\s*H$/);return fs?`${fs[1]}h`:Ut},Yt=Pt=>{const Ut=String(Pt||"").trim();if(!Ut)return"__CURRENT__";const xs=Ut.toLowerCase();if(xs.endsWith("m")){const fs=Number(xs.slice(0,-1));if(Number.isFinite(fs)&&fs>0)return String(Math.floor(fs))}if(xs.endsWith("h")){const fs=Number(xs.slice(0,-1));if(Number.isFinite(fs)&&fs>0)return String(Math.floor(fs*60))}return xs.endsWith("d")?"D":xs.endsWith("w")?"W":Ut==="1M"||Ut==="M"?"M":(/^\d+$/.test(Ut),Ut)},Ht=Pt=>{let Ut=String(Pt??"__CURRENT__");try{Ut=Ut.replace(/\$\{([^}]+)\}/g,(fs,rs)=>{var Ds;const mn=(Gn==null?void 0:Gn[rs])??(Gn==null?void 0:Gn[(Ds=rs==null?void 0:rs.toLowerCase)==null?void 0:Ds.call(rs)]);return mn==null?fs:String(mn)});const xs=Ut.trim();if(/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(xs)){const fs=(Gn==null?void 0:Gn[xs])??(Gn==null?void 0:Gn[xs.toLowerCase()]);fs!=null&&(Ut=String(fs))}}catch{}return Ut},To=new Map;let vo=[];try{const Pt=(ve||[]).filter(Ut=>String((Ut==null?void 0:Ut.type)||"").toLowerCase()==="security");if(Pt.length&&(zi!=null&&zi.ticker)){if(qe.size)for(const fs of qe){const[rs]=String(fs).split("@");if(rs&&rs!==zi.ticker)try{k.stopSymbolPipelines(rs)}catch{}}const Ut=new Set,xs=new Map;for(const fs of Pt){const rs=String((fs==null?void 0:fs.name)||"security").replace(/\s+/g,"_").toLowerCase();if(!rs)continue;const mn=Qs(fs==null?void 0:fs.symbol,fs==null?void 0:fs.country,Gn),Ds=String((mn==null?void 0:mn.ticker)||"").trim(),sn=String((mn==null?void 0:mn.country)||"BD");if(!Ds)continue;Ut.add(`${Ds}@${sn}`);const na=Ht((fs==null?void 0:fs.timeframe)||(fs==null?void 0:fs.tf)||"__CURRENT__"),Wo=na==="__CURRENT__"?((Pi=(Jn=s())==null?void 0:Jn.period)==null?void 0:Pi.timeframe)||"1m":oo(na),Pl=na==="__CURRENT__"?Yt(((ur=(_l=s())==null?void 0:_l.period)==null?void 0:ur.timeframe)||"1m"):String(na||"__CURRENT__");To.set(rs,{ticker:Ds,country:sn,pipelineTf:Wo,computeTf:Pl});const El=`${Ds}@${sn}|${Wo}`;Wo&&Wo!=="__CURRENT__"&&xs.set(El,{sym:mn,tf:Wo})}if(vo=Array.from(xs.values()),qe=Ut,xs.size&&Ro>0&&Qo>0)await Promise.all(Array.from(xs.values()).map(({sym:fs,tf:rs})=>k.ensureHistoryCovers(fs,rs,Ro,Qo,3e3).catch(()=>null)));else if(xs.size)for(const{sym:fs,tf:rs}of xs.values())try{k.startBackgroundPrefetch(fs,{timeframe:rs})}catch{}}}catch(Pt){console.warn("[ScriptStudio] request.security prefetch skipped",Pt)}try{G&&(clearInterval(G),G=null)}catch{}if(vo.length){const Pt=Date.now(),Ut=25e3;G=setInterval(()=>{var rs;const xs=i();if(!xs)return;if(Date.now()-Pt>Ut){try{clearInterval(G)}catch{}G=null;return}let fs=0;for(const{sym:mn,tf:Ds}of vo){const sn=k.getHistorySnapshot(mn,Ds);if(sn!=null&&sn.error)continue;const na=(((rs=sn==null?void 0:sn.candles)==null?void 0:rs.length)||0)>=2,Wo=Ro>0&&Qo>0&&((sn==null?void 0:sn.oldestTimestampLoaded)??1/0)<=Ro&&((sn==null?void 0:sn.newestTimestampLoaded)??0)>=Qo;!(sn!=null&&sn.isComplete)&&(!na||!Wo)&&(fs+=1)}if(fs<=0){try{clearInterval(G)}catch{}G=null;return}ml.request(()=>{try{xs.resize()}catch{}try{Is()}catch{}})},350)}const Ot=(Pt,Ut)=>{const xs=new Set,fs=[],rs=Pt.plots||[],mn=rs.some(Be=>String((Be==null?void 0:Be.type)||"").toLowerCase()==="histogram");Pt.pane==="sub"&&mn&&rs.push({name:"__zero__",source:"__zero__",type:"line",color:"rgba(0,0,0,0)",width:0});const Ds=Pt.levels||[],sn=Pt.labels||[],na=Pt.lines||[],Wo={},Pl=rs.map(Be=>{const Bt=vn(Be.name||Be.source||"plot",xs);fs.push(Bt);const Gs=(Be.source||Be.name||"").replace(/\s+/g,"_").toLowerCase();Gs&&(Wo[Gs]=Bt);const Cr=(Be.type||Be.style||"").toLowerCase();return Cr==="histogram"?{key:Bt,title:Be.name||Bt,type:"bar",baseValue:0}:Cr==="bar"?{key:Bt,title:Be.name||Bt,type:"bar",baseValue:0}:{key:Bt,title:Be.name||Bt,type:"line"}}),El=`${Ct}_${Pt.pane}_${Ut}`,fe={};let No="",gs=!1;const pi=Ut===kt;let vi=!1,Na="",Xl=null;return{name:El,shortName:Pt.shortName||"Script",precision:4,calcParams:[],figures:Pl,shouldOhlc:!1,minValue:(()=>{const Be=Pt.pane==="sub",Bt=rs.some(Gs=>String((Gs==null?void 0:Gs.type)||"").toLowerCase()==="histogram");if(typeof Pt.min=="number")return Pt.min;if(Be&&Bt)return-5})(),maxValue:(()=>{const Be=Pt.pane==="sub",Bt=rs.some(Gs=>String((Gs==null?void 0:Gs.type)||"").toLowerCase()==="histogram");if(typeof Pt.max=="number")return Pt.max;if(Be&&Bt)return 5})(),styles:{lines:rs.map((Be,Bt)=>{var ic;const Gs=(Be.source||Be.name||"").replace(/\s+/g,"_").toLowerCase();let Cr="#22d3ee";return/ema\d+/i.test(Gs)?Cr=(ic=/ema(\d+)/i.exec(Gs))!=null&&ic[1]&&Number(RegExp.$1)<=20?"#22c55e":"#ef4444":/signal|sig/i.test(Gs)?Cr="#f59e0b":/hist|bar/i.test(Be.type||Be.style||"")&&(Cr="#64748b"),(Be.type||Be.style||"").toLowerCase()==="histogram"?{color:"rgba(0,0,0,0)",size:1e-4,style:Ee.Solid}:{color:Be.color||Cr,size:Be.width??2,style:en[(Be.style||"solid").toLowerCase()]??Ee.Solid}})},calc:Be=>{var $l,ba,Qr,Fi,Hs,xa,gi,Qc,Hu,ed,td,Xd,Mr,Pa,Ma,wl,ga,Ml,fc,rp,au,ud;const Bt=Be.length,Gs=Bt?Be[Bt-1]:null,Cr=(Gs==null?void 0:Gs.timestamp)??(Gs==null?void 0:Gs.time)??(Gs==null?void 0:Gs.t)??0,Da=typeof Cr=="number"?Cr:Number(Cr);let ic=0,Jr=0,bl=0,dd=0;if(vo.length)for(const{sym:tt,tf:Gt}of vo){const dt=k.getHistorySnapshot(tt,Gt),Tt=Number((dt==null?void 0:dt.lastUpdatedAt)??0);Number.isFinite(Tt)&&(ic=Math.max(ic,Tt));const At=(($l=dt==null?void 0:dt.candles)==null?void 0:$l.length)??0;Jr+=Number.isFinite(At)?At:0,dt!=null&&dt.error&&(bl+=1),!(dt!=null&&dt.error)&&!(dt!=null&&dt.isComplete)&&(((ba=dt==null?void 0:dt.candles)==null?void 0:ba.length)??0)<2&&(dd+=1)}const yc=`${Bt}:${Number.isFinite(Da)?Da:0}:${n(xe)?1:0}:${ic}:${Jr}:${bl}:${dd}`;if(yc===Na&&Xl)return Xl;const bc={},st={},ia=(z==null?void 0:z.params)||{};Fo=ia;const Oc=(tt,Gt,dt)=>{if(typeof tt=="number"&&Number.isFinite(tt))return tt;if(typeof tt=="string"){const Tt=Number(tt);if(Number.isFinite(Tt))return Tt;const At=tt.match(/^\$\{([^}]+)\}$/),io=At?At[1]:tt,co=ia[io],wo=typeof co=="number"?co:Number(co);if(Number.isFinite(wo))return wo}if(Gt&&ia[Gt]!=null){const Tt=ia[Gt],At=typeof Tt=="number"?Tt:Number(Tt);if(Number.isFinite(At))return At}return dt??0},Zd=tt=>{const Gt=typeof tt=="number"?tt:Number(tt);return Number.isFinite(Gt)?Gt:void 0},fu=new Array(Bt),fi=new Array(Bt),Il=new Array(Bt),da=new Array(Bt),Nr=new Array(Bt),_i=new Array(Bt);for(let tt=0;tt<Bt;(tt+=1)-1){const Gt=Be[tt],dt=Zd((Gt==null?void 0:Gt.close)??(Gt==null?void 0:Gt.c)??(Gt==null?void 0:Gt.price)??(Gt==null?void 0:Gt.value)),Tt=Zd((Gt==null?void 0:Gt.open)??(Gt==null?void 0:Gt.o))??dt,At=Zd((Gt==null?void 0:Gt.high)??(Gt==null?void 0:Gt.h))??dt??Tt,io=Zd((Gt==null?void 0:Gt.low)??(Gt==null?void 0:Gt.l))??dt??Tt,co=Zd((Gt==null?void 0:Gt.volume)??(Gt==null?void 0:Gt.vol))??0,wo=Zd((Gt==null?void 0:Gt.timestamp)??(Gt==null?void 0:Gt.time)??(Gt==null?void 0:Gt.t))??0;da[tt]=dt,fu[tt]=Tt,fi[tt]=At,Il[tt]=io,Nr[tt]=co,_i[tt]=wo}st.open=fu,st.close=da,st.high=fi,st.low=Il,st.volume=Nr,st.time=_i;const Wl=[];try{const tt=(ve||[]).filter(Gt=>String((Gt==null?void 0:Gt.type)||"").toLowerCase()==="security");if(tt.length&&Bt>0)for(const Gt of tt){const dt=String((Gt==null?void 0:Gt.name)||"security").replace(/\s+/g,"_").toLowerCase();if(!dt)continue;const Tt=Qs(Gt==null?void 0:Gt.symbol,Gt==null?void 0:Gt.country,ia);let At=String((Gt==null?void 0:Gt.timeframe)||(Gt==null?void 0:Gt.tf)||"__CURRENT__");try{At=At.replace(/\$\{([^}]+)\}/g,(Hr,gl)=>{var Bl;const ac=(ia==null?void 0:ia[gl])??(ia==null?void 0:ia[(Bl=gl==null?void 0:gl.toLowerCase)==null?void 0:Bl.call(gl)]);return ac==null?Hr:String(ac)});const zl=At.trim();if(/^[A-Za-z_$][A-Za-z0-9_$]*$/.test(zl)){const Hr=(ia==null?void 0:ia[zl])??(ia==null?void 0:ia[zl.toLowerCase()]);Hr!=null&&(At=String(Hr))}}catch{}const io=String(At||"__CURRENT__"),co=io==="__CURRENT__"?((Fi=(Qr=s())==null?void 0:Qr.period)==null?void 0:Fi.timeframe)||"1m":oo(io),wo=To.get(dt),$o=(wo==null?void 0:wo.pipelineTf)||co,ws=(wo==null?void 0:wo.computeTf)||(io==="__CURRENT__"?Yt(((xa=(Hs=s())==null?void 0:Hs.period)==null?void 0:xa.timeframe)||"1m"):io),_o=$o&&$o!=="__CURRENT__"?k.getHistorySnapshot(Tt,$o):null,po=_o?_o.candles:null,Es=Number(_i[0]??0),ms=Number(_i[Bt-1]??0);if($o&&$o!=="__CURRENT__"){const zl=Jd=>{const jc=typeof Jd=="number"?Jd:Number(Jd);return!Number.isFinite(jc)||jc<=0?0:jc<1e12?jc*1e3:jc},Hr=zl(Es),gl=zl(ms),ac=po&&po.length>=2,Bl=po&&po.length?Number(((gi=po[0])==null?void 0:gi.timestamp)??((Qc=po[0])==null?void 0:Qc.time)??((Hu=po[0])==null?void 0:Hu.t)??0):0,Lv=po&&po.length?Number(((ed=po[po.length-1])==null?void 0:ed.timestamp)??((td=po[po.length-1])==null?void 0:td.time)??((Xd=po[po.length-1])==null?void 0:Xd.t)??0):0,Jp=zl((_o==null?void 0:_o.oldestTimestampLoaded)??Bl),Tu=zl((_o==null?void 0:_o.newestTimestampLoaded)??Lv),Cp=ac&&Hr>0&&gl>0&&Jp>0&&Tu>0&&Jp<=gl&&Tu>=Hr,mf=Cp&&Jp<=Hr&&Tu>=gl;if(!ac||!Cp){const Jd=String((Tt==null?void 0:Tt.ticker)||""),jc=String((Tt==null?void 0:Tt.country)||"");if(_o!=null&&_o.error)n(Ae)||b(Ae,`request.security: ${Jd}${jc?`@${jc}`:""} (${$o}) error: ${_o.error}`);else if(_o!=null&&_o.isComplete){if(!n(Ae)){const ap=!ac||!(po&&po.length);b(Ae,j(ap?`request.security: no data for ${Jd}${jc?`@${jc}`:""} (${$o})`:`request.security: no overlap for ${Jd}${jc?`@${jc}`:""} (${$o})`))}}else if(n(ye)==="Running..."||n(ye)==="Plotted from Pine"||n(ye)==="Plotted from DSL"){const ap=_o!=null&&_o.oldestTimestampLoaded?new Date(_o.oldestTimestampLoaded).toISOString().slice(0,10):"?",gu=_o!=null&&_o.newestTimestampLoaded?new Date(_o.newestTimestampLoaded).toISOString().slice(0,10):"?";b(ye,`Loading request.security: ${Jd}${jc?`@${jc}`:""} (${$o})… loaded ${ap}→${gu}`)}st[dt]=new Array(Bt),Wl.push(dt);continue}if(!mf&&!(_o!=null&&_o.error)&&!(_o!=null&&_o.isComplete)&&(n(ye)==="Running..."||n(ye)==="Plotted from Pine"||n(ye)==="Plotted from DSL")){const Jd=String((Tt==null?void 0:Tt.ticker)||""),jc=String((Tt==null?void 0:Tt.country)||""),ap=_o!=null&&_o.oldestTimestampLoaded?new Date(_o.oldestTimestampLoaded).toISOString().slice(0,10):"?",gu=_o!=null&&_o.newestTimestampLoaded?new Date(_o.newestTimestampLoaded).toISOString().slice(0,10):"?";b(ye,`Loading request.security (partial): ${Jd}${jc?`@${jc}`:""} (${$o})… loaded ${ap}→${gu}`)}}const Qn=String((Gt==null?void 0:Gt.expr)||"close"),hn=String((Gt==null?void 0:Gt.lookahead)||"off").toLowerCase(),Bi=hn==="on"||hn.includes("on")&&!hn.includes("off")?"on":"off",qr=String((Gt==null?void 0:Gt.gaps)||"off").toLowerCase(),mi=qr==="on"||qr.includes("on")&&!qr.includes("off")?"on":"off",ql=`${fu[Bt-1]??""}|${fi[Bt-1]??""}|${Il[Bt-1]??""}|${da[Bt-1]??""}|${Nr[Bt-1]??""}`,rc=po&&po.length?Number(((Mr=po[0])==null?void 0:Mr.timestamp)??((Pa=po[0])==null?void 0:Pa.time)??0):0,pd=po&&po.length?Number(((Ma=po[po.length-1])==null?void 0:Ma.timestamp)??((wl=po[po.length-1])==null?void 0:wl.time)??0):0,Fd=String((Tt==null?void 0:Tt.ticker)||"").trim(),jl=String((Tt==null?void 0:Tt.country)||"").trim(),bd=`sym=${Fd}${jl?`@${jl}`:""}|tf=${ws}|srcTf=${$o}|srcLen=${po?po.length:0}|src0=${rc}|srcN=${pd}|la=${Bi}|gaps=${mi}|expr=${Qn}|len=${Bt}|t0=${Es}|tN=${ms}|tail=${ql}`,Vc=Kt.get(bd),Pc=Vc&&Vc.len===Bt&&Vc.firstTime===Es&&Vc.lastTime===ms&&Vc.tailSig===ql?Vc.out:(()=>{const zl=Iq({timestamps:_i,open:fu,high:fi,low:Il,close:da,volume:Nr,sourceCandles:po||void 0,timeframe:ws,expr:Qn,lookahead:Bi,gaps:mi,scalars:ia});return Kt.set(bd,{out:zl,len:Bt,firstTime:Es,lastTime:ms,tailSig:ql}),zl})();try{let zl=!1;const Hr=Math.max(0,Bt-250);for(let gl=Bt-1;gl>=Hr;(gl-=1)+1){const ac=Pc[gl];if(ac!=null&&Number.isFinite(ac)){zl=!0;break}}if(!zl&&!n(Ae)){const gl=String((Tt==null?void 0:Tt.ticker)||""),ac=String((Tt==null?void 0:Tt.country)||"");b(ye,`request.security: no overlap for ${gl}${ac?`@${ac}`:""} (${$o}) — try a more recent chart range or switch chart timeframe`)}}catch{}st[dt]=Pc,Wl.push(dt)}}catch(tt){const Gt=(tt==null?void 0:tt.message)!=null?String(tt.message):String(tt);console.error("[ScriptStudio] request.security error",tt),n(Ae)||b(Ae,`request.security error: ${Gt}`)}if(rs.some(tt=>String((tt==null?void 0:tt.source)||"").toLowerCase()==="__zero__")){const tt=new Array(Bt);for(let Gt=0;Gt<Bt;(Gt+=1)-1)tt[Gt]=0;st.__zero__=tt}if(Ne.length&&Bt>0)try{const tt={open:new Float32Array(Bt),high:new Float32Array(Bt),low:new Float32Array(Bt),close:new Float32Array(Bt),volume:new Float32Array(Bt),time:new Float32Array(Bt)};for(let dt=0;dt<Bt;(dt+=1)-1)tt.open[dt]=fu[dt]??NaN,tt.high[dt]=fi[dt]??NaN,tt.low[dt]=Il[dt]??NaN,tt.close[dt]=da[dt]??NaN,tt.volume[dt]=Nr[dt]??0,tt.time[dt]=_i[dt]??0;for(const dt of Wl){const Tt=st[dt];if(!Tt)continue;const At=new Float32Array(Bt);for(let io=0;io<Bt;(io+=1)-1)At[io]=Tt[io]??NaN;tt[dt]=At}const Gt=df(Ne.map((dt,Tt)=>({name:String(dt.name||`series_${Tt}`),expr:String(dt.expr||"").replace(/\$\{([^}]+)\}/g,(At,io)=>String(ia[io]??At))})),tt,ia);Object.entries(Gt).forEach(([dt,Tt])=>{const At=dt.replace(/\s+/g,"_").toLowerCase(),io=new Array(Bt);for(let co=0;co<Bt;(co+=1)-1)io[co]=Tt[co];st[At]=io})}catch(tt){const Gt=(tt==null?void 0:tt.message)!=null?String(tt.message):String(tt);console.error("[ScriptStudio] expression engine error",tt),n(Ae)||b(Ae,`Expression error: ${Gt}`),n(ye)||b(ye,"Expression error")}for(const tt of ve){const Gt=tt.name||tt.type;if(!Gt)continue;const dt=Gt.replace(/\s+/g,"_").toLowerCase();if(String(tt.type||"").toLowerCase()!=="security"){if(tt.type==="sma"){const Tt=tt.source||"close";st[dt]=Po(st[Tt]||st.close,Math.max(1,Oc(tt.period,`${dt}_period`,14)))}else if(tt.type==="smma"){const Tt=tt.source||"close";st[dt]=Ke(st[Tt]||st.close,Math.max(1,Oc(tt.period,`${dt}_period`,13)))}else if(tt.type==="ema"){const Tt=tt.source||"close";st[dt]=ps(st[Tt]||st.close,Math.max(1,Oc(tt.period,`${dt}_period`,14)))}else if(tt.type==="wma"){const Tt=tt.source||"close";st[dt]=Ze(st[Tt]||st.close,Math.max(1,Oc(tt.period,`${dt}_period`,14)))}else if(tt.type==="rsi"){const Tt=tt.source||"close";st[dt]=pn(st[Tt]||st.close,Math.max(1,Oc(tt.period,`${dt}_period`,14)))}else if(tt.type==="bbands"||tt.type==="bollinger"||tt.type==="bollinger_bands"){const Tt=tt.source||"close",At=Math.max(1,Oc(tt.period,`${dt}_period`,20)),io=Math.max(.1,Oc(tt.std,`${dt}_std`,Oc(tt.deviation,`${dt}_deviation`,2))),{mid:co,upper:wo,lower:$o}=Wt(st[Tt]||st.close,At,io);st[dt+"_mid"]=co,st[dt+"_upper"]=wo,st[dt+"_lower"]=$o}else if(tt.type==="atr"){const Tt=Math.max(1,Oc(tt.period,`${dt}_period`,14));st[dt]=Jo(st.high,st.low,st.close,Tt)}else if(tt.type==="obv")st[dt]=ti(st.close,st.volume);else if(tt.type==="cci"){const Tt=Math.max(1,Oc(tt.period,`${dt}_period`,20));st[dt]=mr(st.high,st.low,st.close,Tt)}else if(tt.type==="mfi"){const Tt=Math.max(1,Oc(tt.period,`${dt}_period`,14));st[dt]=sa(st.high,st.low,st.close,st.volume,Tt)}else if(tt.type==="ao")st[dt]=yt(st.high,st.low);else if(tt.type==="trix"){const Tt=Math.max(1,Oc(tt.period,`${dt}_period`,12));st[dt]=wt(st.close,Tt)}else if(tt.type==="vwap")st[dt]=to(st.close,st.volume);else if(tt.type==="vwma"){const Tt=Math.max(1,Oc(tt.period,`${dt}_period`,20));st[dt]=mt(st.close,st.volume,Tt)}else if(tt.type==="macd"){const Tt=(tt.source||"close").replace(/\s+/g,"_").toLowerCase(),At=Math.max(1,Number(tt.fast)||12),io=Math.max(1,Number(tt.slow)||26),co=Math.max(1,Number(tt.signal)||9),wo=st[Tt]||st.close,$o=ps(wo,At),ws=ps(wo,io),_o=new Array(Bt);for(let Qn=0;Qn<Bt;(Qn+=1)-1)_o[Qn]=$o[Qn]===void 0||ws[Qn]===void 0?void 0:$o[Qn]-ws[Qn];const po=ps(_o,co),Es=new Array(Bt),ms=new Array(Bt);for(let Qn=0;Qn<Bt;(Qn+=1)-1){const hn=_o[Qn],Bi=po[Qn];Es[Qn]=typeof Bi=="number"&&Number.isFinite(Bi)?Bi:void 0,ms[Qn]=hn!==void 0&&Bi!==void 0?hn-Bi:void 0}st.macd_line=_o,st.macd_signal=Es,st.macd_hist=ms}else if(tt.type==="supertrend"){const Tt=Math.max(1,Number(tt.period)||10),At=Math.max(.1,Number(tt.factor)||3);st[dt]=vt(st.high,st.low,st.close,Tt,At)}else if(tt.type==="kc"||tt.type==="keltner"){const Tt=Math.max(1,Number(tt.period)||20),At=Math.max(.1,Number(tt.mult)||2),io=$t(st.high,st.low,st.close,Tt,At);st[dt+"_mid"]=io.mid,st[dt+"_upper"]=io.upper,st[dt+"_lower"]=io.lower}else if(tt.type==="donchian"){const Tt=Math.max(1,Number(tt.period)||20),At=zo(st.high,st.low,Tt);st[dt+"_mid"]=At.mid,st[dt+"_upper"]=At.upper,st[dt+"_lower"]=At.lower}else if(tt.type==="atr_bands"){const Tt=Math.max(1,Number(tt.period)||14),At=Math.max(.1,Number(tt.mult)||2),io=Jo(st.high,st.low,st.close,Tt),co=new Array(Bt),wo=new Array(Bt);for(let $o=0;$o<Bt;($o+=1)-1){const ws=io[$o],_o=st.close[$o];co[$o]=ws!=null&&_o!=null?_o+At*ws:void 0,wo[$o]=ws!=null&&_o!=null?_o-At*ws:void 0}st[dt+"_upper"]=co,st[dt+"_lower"]=wo}else if(tt.type==="zscore"){const Tt=Math.max(1,Number(tt.period)||20),At=tt.source||"close";st[dt]=bo(st[At]||st.close,Tt)}else if(tt.type==="volume_delta")st[dt]=xo(st.close,st.volume);else if(tt.type==="cum_delta"){const Tt=xo(st.close,st.volume);st[dt]=Zo(Tt)}else if(tt.type==="vwap_bands"){const Tt=Math.max(1,Number(tt.period)||20),At=to(st.close,st.volume),{upper:io,lower:co}=Wt(Array.from(At).map(wo=>wo),Tt,Math.max(.1,Number(tt.std)||2));st[dt+"_mid"]=Array.from(At),st[dt+"_upper"]=io,st[dt+"_lower"]=co}else if(tt.type==="linreg_channel"){const Tt=Math.max(1,Number(tt.period)||20),At=tt.source||"close",io=os(st[At]||st.close,Tt);st[dt+"_mid"]=io.mid,st[dt+"_upper"]=io.upper,st[dt+"_lower"]=io.lower}else if(tt.type==="evwma"){const Tt=Math.max(1,Number(tt.period)||20);st[dt]=ri(st.close,st.volume,Tt)}else if(tt.type==="sar"){const Tt=Math.max(.001,Number(tt.step)||.02),At=Math.max(Tt,Number(tt.max)||.2),io=st.high,co=st.low,wo=new Array(Bt);let $o=Tt,ws=io[0],_o=co[0],po=!0;for(let Es=1;Es<Bt;(Es+=1)-1){const ms=io[Es]??NaN,Qn=co[Es]??NaN;if(!Number.isFinite(ms)||!Number.isFinite(Qn)){wo[Es]=void 0;continue}let hn=_o;po?(hn=_o+$o*(ws-_o),ms>ws&&(ws=ms,$o=Math.min(At,$o+Tt)),hn>Qn&&(po=!1,hn=ws,ws=Qn,$o=Tt)):(hn=_o-$o*(_o-ws),Qn<ws&&(ws=Qn,$o=Math.min(At,$o+Tt)),hn<ms&&(po=!0,hn=ws,ws=ms,$o=Tt)),wo[Es]=hn,_o=hn}wo[0]=_o,st.sar=wo}else if(tt.type==="stoch"){const Tt=Number(tt.kPeriod)||14,At=Number(tt.dPeriod)||3,io=[],co=[];for(let $o=0;$o<Bt;($o+=1)-1){const ws=Math.max(0,$o-Tt+1);let _o=-1/0,po=1/0;for(let hn=ws;hn<=$o;(hn+=1)-1){const Bi=st.high[hn]??st.close[hn]??NaN,qr=st.low[hn]??st.close[hn]??NaN;Bi>_o&&(_o=Bi),qr<po&&(po=qr)}const Es=st.close[$o]??NaN,ms=_o-po,Qn=ms===0?void 0:100*((Es-po)/ms);io.push(Qn)}const wo=Po(io.map($o=>$o??NaN),At);for(let $o=0;$o<Bt;($o+=1)-1)co.push(isNaN(wo[$o])?void 0:wo[$o]);st[dt+"_k"]=io,st[dt+"_d"]=co}else if(tt.type==="roc"){const Tt=tt.source||"close",At=st[Tt]||st.close,io=Math.max(1,Number(tt.period)||10),co=new Array(Bt);for(let wo=0;wo<Bt;(wo+=1)-1){const $o=At[wo],ws=At[wo-io];$o===void 0||ws===void 0||ws===0?co[wo]=void 0:co[wo]=($o/ws-1)*100}st[dt]=co}else if(tt.type==="ichimoku"){const Tt=Math.max(1,Number(tt.tenkan)||9),At=Math.max(1,Number(tt.kijun)||26),io=Math.max(1,Number(tt.senkouB)||52),co=At,wo=new Array(Bt),$o=new Array(Bt),ws=new Array(Bt),_o=new Array(Bt),po=new Array(Bt),Es=new Array(Bt),ms=new Array(Bt),Qn=st.high,hn=st.low,Bi=st.close,qr=(mi,ql)=>{let rc=-1/0,pd=1/0;const Fd=Math.max(0,mi-ql+1);for(let jl=Fd;jl<=mi;(jl+=1)-1){const bd=Qn[jl]??Bi[jl]??NaN,Vc=hn[jl]??Bi[jl]??NaN;bd>rc&&(rc=bd),Vc<pd&&(pd=Vc)}return{hi:rc,lo:pd}};for(let mi=0;mi<Bt;(mi+=1)-1){if(mi>=Tt-1){const{hi:ql,lo:rc}=qr(mi,Tt);wo[mi]=(ql+rc)/2}if(mi>=At-1){const{hi:ql,lo:rc}=qr(mi,At);$o[mi]=(ql+rc)/2}if(wo[mi]!==void 0&&$o[mi]!==void 0&&(ws[mi]=(wo[mi]+$o[mi])/2),mi>=io-1){const{hi:ql,lo:rc}=qr(mi,io);_o[mi]=(ql+rc)/2}ms[mi]=mi+co<Bt?Bi[mi+co]:void 0}for(let mi=0;mi<Bt;(mi+=1)-1)po[mi]=mi>=co?ws[mi-co]:void 0,Es[mi]=mi>=co?_o[mi-co]:void 0;st.tenkan=wo,st.kijun=$o,st.spana=po,st.spanb=Es,st.chikou=ms}else if(tt.type==="pivot_high"){const Tt=Math.max(0,Number(tt.left)||3),At=Math.max(0,Number(tt.right)||3),io=new Array(Bt);for(let co=0;co<Bt;(co+=1)-1){const wo=st.high[co]??st.close[co]??NaN;if(!Number.isFinite(wo)){io[co]=void 0;continue}let $o=!0;const ws=Math.max(0,co-Tt),_o=Math.min(Bt-1,co+At);for(let po=ws;po<=_o;(po+=1)-1){if(po===co)continue;const Es=st.high[po]??st.close[po]??NaN;if(!Number.isFinite(Es)){$o=!1;break}if(Es>=wo){$o=!1;break}}io[co]=$o?wo:void 0}st[dt]=io}else if(tt.type==="pivot_low"){const Tt=Math.max(0,Number(tt.left)||3),At=Math.max(0,Number(tt.right)||3),io=new Array(Bt);for(let co=0;co<Bt;(co+=1)-1){const wo=st.low[co]??st.close[co]??NaN;if(!Number.isFinite(wo)){io[co]=void 0;continue}let $o=!0;const ws=Math.max(0,co-Tt),_o=Math.min(Bt-1,co+At);for(let po=ws;po<=_o;(po+=1)-1){if(po===co)continue;const Es=st.low[po]??st.close[po]??NaN;if(!Number.isFinite(Es)){$o=!1;break}if(Es<=wo){$o=!1;break}}io[co]=$o?wo:void 0}st[dt]=io}else if(tt.type==="auto_fib"||tt.type==="autofib"){const Tt=Math.max(2,Math.floor(Oc(tt.lookback,`${dt}_lookback`,200))),io=String(tt.direction||"up").trim().toLowerCase()==="down"?"down":"up",co=String(tt.method||tt.mode||"extremes").trim().toLowerCase(),wo=co==="pivots"||co==="pivot"||co==="swing"?"pivots":"extremes",$o=Math.max(1,Math.floor(Number(tt.pivotLeft??tt.left??3))),ws=Math.max(1,Math.floor(Number(tt.pivotRight??tt.right??3))),_o=bq(st.high,st.low,st.close,{lookback:Tt,direction:io,method:wo,pivotLeft:$o,pivotRight:ws});st[`${dt}_from`]=_o.from,st[`${dt}_to`]=_o.to,st[`${dt}_from_idx`]=_o.fromIndex,st[`${dt}_to_idx`]=_o.toIndex,st[`${dt}_0`]=_o.lvl0,st[`${dt}_50`]=_o.lvl50,st[`${dt}_100`]=_o.lvl100}else if(tt.type==="last_value"){const Tt=String(tt.source||"close").replace(/\s+/g,"_").toLowerCase(),At=st[Tt]||st.close,io=new Array(Bt);let co;for(let wo=0;wo<Bt;(wo+=1)-1){const $o=At[wo];$o!=null&&Number.isFinite($o)&&(co=$o),io[wo]=co}st[dt]=io,fe[dt]=Tt}else if(tt.type==="prev_value"){const Tt=String(tt.source||"close").replace(/\s+/g,"_").toLowerCase(),At=st[Tt]||st.close,io=new Array(Bt);let co,wo;for(let $o=0;$o<Bt;($o+=1)-1){const ws=At[$o];if(ws!=null&&Number.isFinite(ws)){const _o=ws;(co===void 0||_o!==co)&&(wo=co,co=_o)}io[$o]=wo}st[dt]=io,fe[dt]=Tt}else if(tt.type==="line_value"){const Tt=String(tt.startValue||"").replace(/\s+/g,"_").toLowerCase(),At=String(tt.endValue||"").replace(/\s+/g,"_").toLowerCase();let co=fe[Tt]||fe[At]||"";co||(/pl|low/i.test(Tt)||/pl|low/i.test(At)?co="pl":(/ph|high/i.test(Tt)||/ph|high/i.test(At))&&(co="ph"));const wo=st[co],$o=new Array(Bt);if(wo){const ws=[];for(let _o=Bt-1;_o>=0&&ws.length<2;(_o-=1)+1){const po=wo[_o];po!=null&&Number.isFinite(po)&&ws.push(_o)}if(ws.reverse(),ws.length===2){const _o=ws[0],po=ws[1],Es=wo[_o],ms=wo[po];if(Number.isFinite(Es)&&Number.isFinite(ms)&&po!==_o){const Qn=(ms-Es)/(po-_o),hn=Es-Qn*_o,Bi=Math.max(1,Number(tt.lookback)||Bt),qr=Math.max(0,po-Bi);for(let mi=0;mi<Bt;(mi+=1)-1)$o[mi]=mi>=qr?Qn*mi+hn:void 0}}}st[dt]=$o}else if(tt.type==="compare"){const Tt=String(tt.left??"").trim(),At=String(tt.right??"").trim(),io=String(tt.op||">"),co=/^[-+]?\d+(?:\.\d+)?$/.test(Tt),wo=/^[-+]?\d+(?:\.\d+)?$/.test(At),$o=Tt.replace(/\s+/g,"_").toLowerCase(),ws=At.replace(/\s+/g,"_").toLowerCase(),_o=co?null:st[$o]||st.close,po=wo?null:st[ws]||st.close,Es=co?Number(Tt):NaN,ms=wo?Number(At):NaN,Qn=new Array(Bt);for(let hn=0;hn<Bt;(hn+=1)-1){const Bi=co?Es:(_o==null?void 0:_o[hn])??NaN,qr=wo?ms:(po==null?void 0:po[hn])??NaN;if(!Number.isFinite(Bi)||!Number.isFinite(qr)){Qn[hn]=0;continue}let mi=!1;switch(io){case">":mi=Bi>qr;break;case"<":mi=Bi<qr;break;case">=":mi=Bi>=qr;break;case"<=":mi=Bi<=qr;break;case"==":mi=Math.abs(Bi-qr)<1e-9;break;default:mi=Bi>qr;break}Qn[hn]=mi?1:0}st[dt]=Qn}else if(typeof tt.expr=="string"&&tt.expr.trim().length)try{const Tt={};Object.entries(st).forEach(([wo,$o])=>{const ws=new Float32Array(Bt);for(let _o=0;_o<Bt;(_o+=1)-1)ws[_o]=$o[_o]??NaN;Tt[wo.replace(/\s+/g,"_").toLowerCase()]=ws});const At=df([{name:dt,expr:String(tt.expr).replace(/\$\{([^}]+)\}/g,(wo,$o)=>String(ia[$o]??wo))}],Tt,ia),io=new Array(Bt),co=At[dt];for(let wo=0;wo<Bt;(wo+=1)-1){const $o=co==null?void 0:co[wo];io[wo]=Number.isFinite($o)?$o:void 0}st[dt]=io}catch(Tt){const At=(Tt==null?void 0:Tt.message)!=null?String(Tt.message):String(Tt);console.error("[ScriptStudio] expr eval error",Tt),n(Ae)||b(Ae,`Expression error: ${At}`),n(ye)||b(ye,"Expression error")}}}if(Pt.pane==="sub"){const tt=new Set,Gt=new Set,dt=(Pt.plots||[]).some(io=>String((io==null?void 0:io.type)||"").toLowerCase()==="histogram"),Tt=typeof Pt.min=="number"||typeof Pt.max=="number";rs.forEach(io=>{const co=(io.source||io.name||"").replace(/\s+/g,"_").toLowerCase();co&&tt.add(co),String(io.type||"").toLowerCase()==="histogram"&&co&&Gt.add(co)}),(Pt.labels||[]).forEach(io=>{const co=((io==null?void 0:io.source)||(io==null?void 0:io.name)||"").replace(/\s+/g,"_").toLowerCase();co&&tt.add(co)}),(ga=Pt.fills)==null||ga.forEach(io=>{(Array.isArray(io==null?void 0:io.between)?io.between:[]).forEach(wo=>{const $o=String(wo||"").replace(/\s+/g,"_").toLowerCase();$o&&tt.add($o)})});const At=(io,co)=>{let wo=1/0,$o=-1/0;for(let Es=0;Es<io.length;(Es+=1)-1){const ms=io[Es];ms==null||Number.isNaN(ms)||(ms<wo&&(wo=ms),ms>$o&&($o=ms))}const ws=$o-wo;if(!($o>200||wo<-50||ws>200))return io;const po=new Array(io.length);if(ws>1e-8){for(let Es=0;Es<io.length;(Es+=1)-1){const ms=io[Es];po[Es]=ms==null?void 0:(ms-wo)/ws*100}return po}if(co){for(let Es=0;Es<io.length;(Es+=1)-1){const ms=io[Es],Qn=co[Es];po[Es]=ms==null||Qn===void 0||Qn===null||Qn===0?void 0:ms/Qn*50+50}return po}return io};!dt&&!Tt&&tt.forEach(io=>{st[io]&&!Gt.has(io)&&!/hist|macd|signal/i.test(io)&&(st[io]=At(st[io],st.close))})}if(Ne.length&&Bt>0)try{const tt=new Set(Ne.map((Tt,At)=>String((Tt==null?void 0:Tt.name)||`series_${At}`).replace(/\s+/g,"_").toLowerCase()).filter(Boolean)),Gt={};Object.entries(st).forEach(([Tt,At])=>{const io=String(Tt||"").replace(/\s+/g,"_").toLowerCase();if(tt.has(io))return;const co=new Float32Array(Bt);for(let wo=0;wo<Bt;(wo+=1)-1)co[wo]=At[wo]??NaN;Gt[io]=co});const dt=df(Ne.map((Tt,At)=>({name:String(Tt.name||`series_${At}`),expr:String(Tt.expr||"").replace(/\$\{([^}]+)\}/g,(io,co)=>String(ia[co]??io))})),Gt,ia);Object.entries(dt).forEach(([Tt,At])=>{const io=Tt.replace(/\s+/g,"_").toLowerCase(),co=new Array(Bt);for(let wo=0;wo<Bt;(wo+=1)-1)co[wo]=At[wo];st[io]=co})}catch(tt){const Gt=(tt==null?void 0:tt.message)!=null?String(tt.message):String(tt);console.error("[ScriptStudio] expression engine error (2nd pass)",tt),n(Ae)||b(Ae,`Expression error: ${Gt}`),n(ye)||b(ye,"Expression error")}if(Re.length&&Bt>0)try{const tt={};Object.entries(st).forEach(([dt,Tt])=>{const At=String(dt||"").replace(/\s+/g,"_").toLowerCase(),io=new Float32Array(Bt);for(let co=0;co<Bt;(co+=1)-1)io[co]=Tt[co]??NaN;tt[At]=io});const Gt=JR(Re.map((dt,Tt)=>({name:String((dt==null?void 0:dt.name)||`state_${Tt}`),initExpr:(dt==null?void 0:dt.initExpr)!=null?String(dt.initExpr).replace(/\$\{([^}]+)\}/g,(At,io)=>String(ia[io]??At)):void 0,updateExpr:String((dt==null?void 0:dt.updateExpr)??(dt==null?void 0:dt.expr)??"").replace(/\$\{([^}]+)\}/g,(At,io)=>String(ia[io]??At))})),tt,ia);Object.entries(Gt).forEach(([dt,Tt])=>{const At=dt.replace(/\s+/g,"_").toLowerCase(),io=new Array(Bt);for(let co=0;co<Bt;(co+=1)-1)io[co]=Tt[co];st[At]=io})}catch(tt){const Gt=(tt==null?void 0:tt.message)!=null?String(tt.message):String(tt);console.error("[ScriptStudio] state series error",tt),n(Ae)||b(Ae,`Expression error: ${Gt}`),n(ye)||b(ye,"Expression error")}const Zi={};Pl.forEach(tt=>{Zi[tt.key]=new Array(Bt)});const ol=new Array(Bt);for(let tt=0;tt<Bt;(tt+=1)-1){const Gt={};rs.forEach((Tt,At)=>{const io=fs[At]||Pl[At].key,co=(Tt.source||Tt.name||"").replace(/\s+/g,"_").toLowerCase(),$o=(st[co]||st[io]||st.close)[tt];Gt[io]=$o,Zi[io][tt]=$o}),Gt.__open=st.open[tt],Gt.__close=st.close[tt],Gt.__high=st.high[tt],Gt.__low=st.low[tt],ol[tt]=Gt;const dt=(Ml=Be[tt])==null?void 0:Ml.timestamp;typeof dt=="number"&&(bc[String(dt)]=Gt)}const Ys={},Ld=tt=>{const Gt=new Float32Array(Bt);for(let dt=0;dt<Bt;(dt+=1)-1){const Tt=tt[dt];Gt[dt]=Tt??NaN}return Gt};Object.entries(st).forEach(([tt,Gt])=>{Ys[tt.replace(/\s+/g,"_").toLowerCase()]=Ld(Gt)}),Object.entries(Zi).forEach(([tt,Gt])=>{Ys[tt]=Ld(Gt)});try{Object.entries(Wo).forEach(([tt,Gt])=>{const dt=String(tt||"").replace(/\s+/g,"_").toLowerCase(),Tt=String(Gt||"");!dt||!Tt||Ys[dt]||Ys[Tt]&&(Ys[dt]=Ys[Tt])})}catch{}{const tt=Object.keys(Ys);for(const Gt of tt){if(!Gt.includes("_"))continue;const dt=Gt.replace(/_/g,"");!dt||dt===Gt||Ys[dt]||(Ys[dt]=Ys[Gt])}}if(pi&&!vi&&Ne.length){try{const Gt=Ne.map(dt=>String((dt==null?void 0:dt.name)||"")).map(dt=>dt.replace(/\s+/g,"_").toLowerCase()).filter(Boolean).filter(dt=>!(dt in st));if(Gt.length){const dt=`Missing series: ${Gt.slice(0,6).join(", ")}${Gt.length>6?", ...":""}`;b(Ae,j(n(Ae)?`${n(Ae)} • ${dt}`:dt))}}catch{}vi=!0}const Jc=[];if(n(xe)&&Array.isArray(sn)&&sn.length){const tt=((fc=z==null?void 0:z.style)==null?void 0:fc.labelLimit)??((rp=Pt==null?void 0:Pt.style)==null?void 0:rp.labelLimit)??(Pt==null?void 0:Pt.labelLimit),Gt=(()=>{const At=typeof tt=="number"?tt:Number(tt);return Number.isFinite(At)?Math.max(0,Math.floor(At)):600})();let dt=0,Tt=!1;for(const At of sn){if(Tt)break;if(!At||!At.when)continue;let io;try{const _o=cs(String(At.when));try{io=Jy(_o,Ys)}catch{io=Zt(String(At.when),Ys)}}catch{io=Zt(String(At.when),Ys)}const co=(At.source||At.name||"").replace(/\s+/g,"_").toLowerCase(),wo=co==="open"||co==="high"||co==="low"||co==="close"||co==="volume"||co==="time",$o=Wo[co],ws=$o||((au=Pl[0])==null?void 0:au.key);for(let _o=0;_o<Bt;(_o+=1)-1){if(Gt===0||dt>=Gt){Tt=!0;break}if(!io[_o])continue;const po=ol[_o]||(ol[_o]={});let Es=(co&&st[co]?st[co][_o]:void 0)??($o?po[$o]:void 0)??(ws?po[ws]:void 0);if(Pt.pane==="sub"&&typeof Pt.min=="number"&&typeof Pt.max=="number"&&wo&&typeof Es=="number"&&Number.isFinite(Es)&&(Es<Pt.min-5||Es>Pt.max+5)&&(Es=ws?po[ws]:Es),Es==null||Number.isNaN(Es)){const hn=Wo.__zero__||"__zero__",Bi=po[hn];Es=Bi??0}const ms=wo&&co||ws,Qn=`__label_${ms}_${At.position||"above"}`;po[Qn]={text:At.text||"",color:At.color||"#f97316",yKey:ms,position:At.position||"above",value:Es,shape:At.shape,bgColor:At.bgColor,borderColor:At.borderColor,textColor:At.textColor,size:At.size,offsetY:At.offsetY},Jc.push({index:_o,meta:po[Qn]}),dt+=1;try{u2("label",{pane:Pt.pane,index:_o,meta:po[Qn]})}catch{}}}}if(bc.__labelItems=Jc,Array.isArray(na)&&na.length){let tt=[];const Gt=dt=>{const Tt=[];for(let At=Bt-1;At>=0&&Tt.length<2;(At-=1)+1){const io=dt[At];io!=null&&Number.isFinite(io)&&Tt.push(At)}return Tt.reverse()};if(na.forEach(dt=>{const Tt=String(dt.start||"").replace(/\s+/g,"_").toLowerCase(),At=String(dt.end||"").replace(/\s+/g,"_").toLowerCase();let co=fe[Tt]||fe[At]||"";co||(/low/i.test(Tt)||/low/i.test(At)?co="pl":(/high/i.test(Tt)||/high/i.test(At))&&(co="ph"));const $o=(dt.segmentsFrom?String(dt.segmentsFrom):"").replace(/\s+/g,"_").toLowerCase(),ws=st[co],_o=$o&&st[$o]||void 0,po=_o||ws||st.ph||st.pl;if(po)if(_o){const Es=[];for(let Bi=0;Bi<Bt;(Bi+=1)-1){const qr=_o[Bi];qr!=null&&Number.isFinite(qr)&&Es.push(Bi)}const ms=Math.max(1,Number(dt.maxSegments)||Es.length-1),Qn=Math.min(ms,24);let hn=0;for(let Bi=Es.length-2;Bi>=0&&!(hn>=Qn);(Bi-=1)+1){const qr=Es[Bi],mi=Es[Bi+1],ql=_o[qr],rc=_o[mi];if(!Number.isFinite(ql)||!Number.isFinite(rc)||mi===qr)continue;const pd=(rc-ql)/(mi-qr),Fd=ql-pd*qr;let jl=!1;const bd=Math.max(qr,Bt-80);let Vc=NaN;for(let Pc=bd;Pc<=Math.min(mi,Bt-1);(Pc+=1)-1){const zl=pd*Pc+Fd,Hr=st.close[Pc];if(!Number.isFinite(zl)||!Number.isFinite(Hr))continue;const gl=Hr-zl;if(!Number.isNaN(Vc)&&gl*Vc<0){jl=!0;break}Vc=gl}jl||(tt.push({startIndex:qr,endIndex:mi,startValue:ql,endValue:rc,slope:pd,intercept:Fd,color:dt.color||"#64748b",width:dt.width??1,style:(dt.style||"dotted").toLowerCase(),extend:dt.extend||"right",name:dt.name}),hn+=1)}}else{const Es=Gt(po);if(Es.length===2){const ms=Es[0],Qn=Es[1],hn=po[ms],Bi=po[Qn];if(Number.isFinite(hn)&&Number.isFinite(Bi)){const qr=(Bi-hn)/(Qn-ms),mi=hn-qr*ms;let ql=!1;const rc=Math.max(ms,Bt-80);let pd=NaN;for(let Fd=rc;Fd<=Math.min(Qn,Bt-1);(Fd+=1)-1){const jl=qr*Fd+mi,bd=st.close[Fd];if(!Number.isFinite(jl)||!Number.isFinite(bd))continue;const Vc=bd-jl;if(!Number.isNaN(pd)&&Vc*pd<0){ql=!0;break}pd=Vc}if(ql)return;tt.push({startIndex:ms,endIndex:Qn,startValue:hn,endValue:Bi,slope:qr,intercept:mi,color:dt.color||"#22c55e",width:dt.width??2,style:(dt.style||"solid").toLowerCase(),extend:dt.extend||"none",name:dt.name})}}}}),tt.length){const dt=[],Tt=new Set;for(const At of tt){const io=Math.round((At.slope||0)*1e4),co=Math.round((At.intercept||0)*100),wo=`${io}:${co}:${At.style}:${At.color}:${At.extend}`;Tt.has(wo)||(Tt.add(wo),dt.push(At))}tt=dt.slice(0,60)}if(!tt.length){const dt=(Tt,At,io,co)=>{const wo=String(Tt||"").replace(/\s+/g,"_").toLowerCase(),$o=st[wo];if(!$o)return;const ws=[];for(let _o=0;_o<Bt;(_o+=1)-1){const po=$o[_o];po!=null&&Number.isFinite(po)&&ws.push(_o)}if(ws.length>=2){const _o=ws[ws.length-2],po=ws[ws.length-1],Es=$o[_o],ms=$o[po];if(Number.isFinite(Es)&&Number.isFinite(ms)&&po!==_o){const Qn=(ms-Es)/(po-_o),hn=Es-Qn*_o;tt.push({startIndex:_o,endIndex:po,startValue:Es,endValue:ms,slope:Qn,intercept:hn,color:At,width:co,style:io,extend:"right",name:wo})}}};dt("ph","#64748b","dotted",1),dt("pl","#64748b","dotted",1)}bc.__lineDefs=tt}if(Ue.length&&pi){const tt=El;try{const Gt=Be.map(At=>({timestamp:At.timestamp??At.time??0})),dt=Ue.map(At=>({...At,when:Eo(String((At==null?void 0:At.when)||"")),cooldownBars:typeof(At==null?void 0:At.cooldownBars)=="number"&&Number.isFinite(At.cooldownBars)?Math.max(0,Math.floor(At.cooldownBars)):void 0}));dt.forEach((At,io)=>{!At||At.id!=null||(At.id=String(io))});const Tt=`${Gt.length}:${((ud=Gt[Gt.length-1])==null?void 0:ud.timestamp)??0}:${dt.map(At=>`${String((At==null?void 0:At.type)||"")}:${String((At==null?void 0:At.when)||"")}`).join("|")}`;if(!(gs||Tt===No)){gs=!0,No=Tt;const At=new Worker(new URL(""+new URL("../workers/signals.worker-ClgVm33n.js",import.meta.url).href,import.meta.url),{type:"module"}),io={id:tt,condSeries:Ys,bars:Gt,signals:dt};At.onerror=()=>{gs=!1;try{At.terminate()}catch{}},At.onmessage=co=>{const wo=co.data;if(Array.isArray(wo==null?void 0:wo.errors)&&wo.errors.length){const po=wo.errors.slice(0,4).map(Es=>String(Es)).join(" • ");b(Ae,j(n(Ae)?`${n(Ae)} • ${po}`:po)),(!n(ye)||n(ye)==="Plotted from Pine"||n(ye)==="Plotted from DSL")&&b(ye,"Signals error")}const $o=new Map;dt.forEach((po,Es)=>{$o.set(String((po==null?void 0:po.id)??Es),po)});const ws=(po,Es,ms)=>{if(typeof po=="number"&&Number.isFinite(po))return po;if(typeof po=="string"){const Qn=po.replace(/\s+/g,"_").toLowerCase(),hn=Ys==null?void 0:Ys[Qn],Bi=hn?hn[Es]:NaN;if(Number.isFinite(Bi))return Bi;const qr=Number(po);if(Number.isFinite(qr))return qr}return ms},_o=(wo.signals||[]).map(po=>{const Es=$o.get(String((po==null?void 0:po.signalId)??""))||null,ms=(Es==null?void 0:Es.order)||null;if(!ms)return po;const Qn=String(ms.kind||"market").trim().toLowerCase().replace(/stop\s*limit|stoplimit/g,"stop_limit"),hn=Ys==null?void 0:Ys.close,Bi=hn?hn[po.index]:NaN,qr=Number.isFinite(Bi)?Bi:0,mi=Hr=>{const gl=typeof Hr=="string"?Hr.trim():"";return gl||void 0},ql=Hr=>{const gl=typeof Hr=="number"?Hr:Number(Hr);if(!(!Number.isFinite(gl)||gl<=0))return Math.floor(gl)},rc=(Hr,gl,ac)=>{if(typeof Hr=="number"&&Number.isFinite(Hr))return Hr;if(typeof Hr=="string")return ws(Hr,gl,ac)},pd=Qn==="limit"||Qn==="stop"?ws(ms.price,po.index,qr):void 0,Fd=ms.stopPrice??ms.stop??ms.trigger,jl=ms.limitPrice??ms.limit??ms.lmt,bd=Qn==="stop_limit"?rc(Fd??ms.price,po.index,qr):void 0,Vc=Qn==="stop_limit"?rc(jl??ms.price,po.index,qr):void 0,Pc=ms==null?void 0:ms.bracket,zl=Pc&&typeof Pc=="object"?{stopLossPct:typeof Pc.stopLossPct=="number"?Pc.stopLossPct:Number(Pc.stopLossPct),takeProfitPct:typeof Pc.takeProfitPct=="number"?Pc.takeProfitPct:Number(Pc.takeProfitPct),trailingStopPct:typeof Pc.trailingStopPct=="number"?Pc.trailingStopPct:Number(Pc.trailingStopPct),takeProfits:Array.isArray(Pc.takeProfits)?Pc.takeProfits.map(Hr=>({takeProfitPct:typeof(Hr==null?void 0:Hr.takeProfitPct)=="number"?Hr.takeProfitPct:Number(Hr==null?void 0:Hr.takeProfitPct),qtyPct:typeof(Hr==null?void 0:Hr.qtyPct)=="number"?Hr.qtyPct:Number(Hr==null?void 0:Hr.qtyPct)})).filter(Hr=>Number.isFinite(Hr.takeProfitPct)&&Hr.takeProfitPct>0&&Number.isFinite(Hr.qtyPct)&&Hr.qtyPct>0):void 0}:void 0;return{...po,order:{kind:Qn,price:pd,stopPrice:bd,limitPrice:Vc,qtyPct:ms.qtyPct==null?void 0:Math.max(0,Math.min(100,Number(ms.qtyPct)||0)),oco:mi(ms.oco),expiresBars:ql(ms.expiresBars),bracket:zl}}});cq(tt,_o);try{const po=hq(z==null?void 0:z.strategy);if(po){const Es=hn=>{const Bi=typeof hn=="number"?hn:Number(hn);return Number.isFinite(Bi)?Bi:void 0},ms=Be.map((hn,Bi)=>{const qr=(hn==null?void 0:hn.timestamp)??(hn==null?void 0:hn.time)??0,mi=typeof qr=="number"?qr:Number(qr),ql=Es(hn==null?void 0:hn.close);return{index:Bi,timestamp:Number.isFinite(mi)?mi:0,open:Es(hn==null?void 0:hn.open),high:Es(hn==null?void 0:hn.high),low:Es(hn==null?void 0:hn.low),close:ql??NaN}}),Qn=yq(ms,_o,po);gq(tt,Qn)}else p2(tt)}catch(po){console.error("[ScriptStudio] backtest error",po)}try{u2("signals",{id:wo.id,signals:wo.signals})}catch{}try{At.terminate()}catch{}gs=!1},At.postMessage(io)}}catch(Gt){gs=!1,console.error("[ScriptStudio] signals worker error",Gt)}}const xl=bc;return xl.__rows=ol,xl.__len=Bt,Na=yc,Xl=xl,Xl},draw:({ctx:Be,indicator:Bt,bounding:Gs,xAxis:Cr,yAxis:Da})=>{if(!Be||!Cr||!Da)return!1;const ic=(Bt==null?void 0:Bt.result)||{},Jr=Array.isArray(ic)?ic:Array.isArray(ic.__rows)?ic.__rows:[],bl=typeof Cr.getRange=="function"?Cr.getRange():{from:0,to:Jr.length?Jr.length-1:0},dd=Jr.length?Jr.length-1:-1,yc=dd>=0?Math.max(0,Math.floor(((bl==null?void 0:bl.from)??0)-2)):0,bc=dd>=0?Math.min(dd,Math.ceil(((bl==null?void 0:bl.to)??dd)+2)):-1,st=Gs?{left:0,top:0,width:Gs.width,height:Gs.height}:void 0;Be.save(),st&&(Be.beginPath(),Be.rect(0,0,st.width,st.height),Be.clip()),rs.forEach((fi,Il)=>{var _i,Wl,Zi,ol,Ys,Ld,Jc;const da=fs[Il]||Pl[Il].key,Nr=(fi.type||"").toLowerCase();if(Nr==="dots"){const xl=fi.color||"#22d3ee",$l=fi.width||4,ba=[];for(let Qr=yc;Qr<=bc;(Qr+=1)-1){const Fi=(_i=Jr[Qr])==null?void 0:_i[da];if(Fi==null){ba.push({x:NaN,y:NaN});continue}const Hs=Cr.convertToPixel(Qr),xa=Da.convertToPixel(Fi);ba.push({x:Hs,y:xa})}o2(Be,ba,xl,$l,st)}if(Nr==="stepped"||Nr==="step"){const xl=fi.color||"#22c55e",$l=fi.width||2,ba=[];for(let Qr=yc;Qr<=bc;(Qr+=1)-1){const Fi=(Wl=Jr[Qr])==null?void 0:Wl[da];if(Fi==null){ba.push({x:NaN,y:NaN});continue}ba.push({x:Cr.convertToPixel(Qr),y:Da.convertToPixel(Fi)})}dO(Be,ba,xl,$l,st)}if(Nr==="area"){const xl=fi.color||"rgba(56,189,248,0.3)",$l=[];for(let Hs=yc;Hs<=bc;(Hs+=1)-1){const xa=(Zi=Jr[Hs])==null?void 0:Zi[da];if(xa==null){$l.push({x:NaN,y:NaN});continue}const gi=Cr.convertToPixel(Hs),Qc=Da.convertToPixel(xa);$l.push({x:gi,y:Qc})}const ba=Da.convertToPixel(0),Fi=String(fi.baseline||"").toLowerCase()==="zero"?ba:st?st.height:Gs.top+Gs.height;cO(Be,$l,Fi,xl,null,0,st)}if(Nr==="glow_points"){const xl=fi.color||"#22d3ee",$l=(fi.width||4)+2,ba=[];for(let Qr=yc;Qr<=bc;(Qr+=1)-1){const Fi=(ol=Jr[Qr])==null?void 0:ol[da];if(Fi==null){ba.push({x:NaN,y:NaN});continue}ba.push({x:Cr.convertToPixel(Qr),y:Da.convertToPixel(Fi)})}Be.save(),Be.shadowColor=xl,Be.shadowBlur=12,o2(Be,ba,xl,$l,st),Be.restore()}if(Nr==="neon_line"){const xl=fi.color||"#22d3ee",$l=fi.width||2;Be.save(),Be.shadowColor=xl,Be.shadowBlur=14,Be.beginPath();let ba=!1;for(let Qr=yc;Qr<=bc;(Qr+=1)-1){const Fi=(Ys=Jr[Qr])==null?void 0:Ys[da];if(Fi==null)continue;const Hs=Cr.convertToPixel(Qr),xa=Da.convertToPixel(Fi);ba?Be.lineTo(Hs,xa):(Be.moveTo(Hs,xa),ba=!0)}Be.strokeStyle=xl,Be.lineWidth=$l,Be.stroke(),Be.restore()}if(Nr==="bezier_line"){const xl=fi.color||"#34d399",$l=fi.width||2;Be.save(),Be.beginPath();let ba=NaN,Qr=NaN,Fi=!1;for(let Hs=yc;Hs<=bc;(Hs+=1)-1){const xa=(Ld=Jr[Hs])==null?void 0:Ld[da];if(xa==null)continue;const gi=Cr.convertToPixel(Hs),Qc=Da.convertToPixel(xa);if(!Fi)Be.moveTo(gi,Qc),Fi=!0;else{const Hu=(ba+gi)/2,ed=(Qr+Qc)/2;Be.quadraticCurveTo(ba,Qr,Hu,ed)}ba=gi,Qr=Qc}Be.strokeStyle=xl,Be.lineWidth=$l,Be.stroke(),Be.restore()}if(Nr==="cloud"||Nr==="supertrend_cloud"){const xl=fi.color||"rgba(14,165,233,0.12)";Be.save();const $l=[],ba=[];for(let Qr=yc;Qr<=bc;(Qr+=1)-1){const Fi=Jr[Qr]||{},Hs=Cr.convertToPixel(Qr),xa=Da.convertToPixel(Fi[da]),gi=Da.convertToPixel(Fi[fs[0]]);$l.push({x:Hs,y:xa}),ba.push({x:Hs,y:gi})}s2(Be,$l,ba,xl,st),Be.restore()}if(Nr==="aura"||Nr==="candleshadow"){const xl=fi.color||"#a78bfa",$l=fi.width||2;Be.save(),Be.shadowColor=xl,Be.shadowBlur=18,Be.beginPath();let ba=!1;for(let Qr=yc;Qr<=bc;(Qr+=1)-1){const Fi=(Jc=Jr[Qr])==null?void 0:Jc[da];if(Fi==null)continue;const Hs=Cr.convertToPixel(Qr),xa=Da.convertToPixel(Fi);ba?Be.lineTo(Hs,xa):(Be.moveTo(Hs,xa),ba=!0)}Be.strokeStyle=xl,Be.lineWidth=$l,Be.stroke(),Be.restore()}});const ia=Pt.fills||[];if(Array.isArray(ia)&&ia.length)for(const fi of ia){const Il=Array.isArray(fi==null?void 0:fi.between)?fi.between:[];if(!Il||Il.length!==2)continue;const da=(Il[0]||"").replace(/\s+/g,"_").toLowerCase(),Nr=(Il[1]||"").replace(/\s+/g,"_").toLowerCase(),_i=Wo[da],Wl=Wo[Nr];if(!_i||!Wl)continue;const Zi=[],ol=[];for(let Ys=yc;Ys<=bc;(Ys+=1)-1){const Ld=Jr[Ys]||{},Jc=Cr.convertToPixel(Ys),xl=Da.convertToPixel(Ld[_i]),$l=Da.convertToPixel(Ld[Wl]);Zi.push({x:Jc,y:xl}),ol.push({x:Jc,y:$l})}s2(Be,Zi,ol,fi.color||"rgba(0,0,0,0.12)",st)}Ds.forEach(fi=>{const Il=Da.convertToPixel(fi.value);if(!Number.isFinite(Il))return;Be.beginPath(),Be.moveTo(0,Il),Be.lineTo(((st==null?void 0:st.width)??Gs.width)||0,Il),Be.strokeStyle=fi.color||"#64748b",Be.lineWidth=fi.width??1;const da=(fi.style||"dashed").toLowerCase();da==="dashed"||da==="dotted"?Be.setLineDash(da==="dashed"?[4,4]:[2,2]):Be.setLineDash([]),Be.stroke(),Be.setLineDash([])});const Oc=Pt.backgroundZones||[];if(Array.isArray(Oc)&&Oc.length)for(const fi of Oc){const Il=Number.isFinite(fi.from)?Da.convertToPixel(fi.from):0,da=Number.isFinite(fi.to)?Da.convertToPixel(fi.to):(st==null?void 0:st.height)??Gs.height,Nr=Math.min(Il,da),_i=Math.abs(da-Il);Be.beginPath(),Be.rect(0,Nr,((st==null?void 0:st.width)??Gs.width)||0,_i),Be.fillStyle=fi.color||"rgba(34,197,94,0.08)",Be.fill()}const Zd=ic.__lineDefs||[];if(Zd.length)for(const fi of Zd){const Il=Jr.length;let da=fi.startIndex,Nr=fi.endIndex;fi.extend==="both"?(da=0,Nr=Math.max(0,Il-1)):fi.extend==="left"?da=0:fi.extend==="right"&&(Nr=Math.max(0,Il-1));const _i=Number.isFinite(fi.slope)&&Number.isFinite(fi.intercept)?fi.slope*da+fi.intercept:fi.startValue,Wl=Number.isFinite(fi.slope)&&Number.isFinite(fi.intercept)?fi.slope*Nr+fi.intercept:fi.endValue,Zi=Cr.convertToPixel(da),ol=Da.convertToPixel(_i),Ys=Cr.convertToPixel(Nr),Ld=Da.convertToPixel(Wl);if(!Number.isFinite(Zi)||!Number.isFinite(ol)||!Number.isFinite(Ys)||!Number.isFinite(Ld))continue;Be.beginPath(),Be.moveTo(Zi,ol),Be.lineTo(Ys,Ld),Be.strokeStyle=fi.color||"#22c55e",Be.lineWidth=fi.width??2;const Jc=(fi.style||"solid").toLowerCase();Jc==="dashed"?Be.setLineDash([6,4]):Jc==="dotted"?Be.setLineDash([2,2]):Be.setLineDash([]),Be.stroke(),Be.setLineDash([])}const fu=ic.__labelItems||[];if(n(xe)&&Array.isArray(fu)&&fu.length){Be.font='12px "Inter", system-ui, -apple-system, sans-serif',Be.textAlign="center";const fi={},Il={};for(const da of fu){const Nr=da==null?void 0:da.index;if(typeof Nr!="number"||!Number.isFinite(Nr)||bc>=0&&(Nr<yc||Nr>bc))continue;const _i=Cr.convertToPixel(Nr);if(!Number.isFinite(_i))continue;const Wl=Jr[Nr]||{},Zi=da==null?void 0:da.meta;if(!Zi)continue;const ol=Zi==null?void 0:Zi.value;if(ol==null)continue;let Ys=Da.convertToPixel(ol);if(!Number.isFinite(Ys))continue;const Ld=typeof Zi.offsetY=="number"?Zi.offsetY:10,Jc=(Zi.position||"above")==="above",xl=Jc?fi[Nr]||0:Il[Nr]||0,$l=Ld+xl*Math.max(6,(Zi.size||12)/3);Jc?(Ys-=$l,Be.textBaseline="bottom",fi[Nr]=xl+1):(Ys+=$l,Be.textBaseline="top",Il[Nr]=xl+1);const ba=typeof Zi.size=="number"&&Zi.size>0?Zi.size:12,Qr=ba/2;if(st||Gs){const Mr=0+Qr+2,Pa=((st==null?void 0:st.height)??Gs.height)-Qr-2;Ys=Math.max(Mr,Math.min(Pa,Ys))}const Fi=Zi.shape||"",Hs=Fi==="arrow_up"?"arrowUp":Fi==="arrow_down"?"arrowDown":Fi==="triangle_up_filled"?"triangleUpFilled":Fi==="triangle_down_filled"?"triangleDownFilled":Fi==="arrow_up_glow"?"arrowUpGlow":Fi==="arrow_down_glow"?"arrowDownGlow":Fi==="triangle_up_gradient"?"triangleUpGradient":Fi==="triangle_down_gradient"?"triangleDownGradient":Fi==="circle_pulse"?"circlePulse":Fi==="tag"?"tag":Fi==="flag"?"flag":Fi==="pill"?"pill":Fi==="box_gradient"?"boxGradient":Fi==="bubble"?"bubble":Fi==="spark"?"spark":Fi==="star"?"star":Fi==="label"?"label":Fi==="text"||Fi==="emoji"?"text":Fi,xa=typeof Zi.size=="number"&&Zi.size>0?Zi.size:12,gi=xa/2,Qc=Zi.bgColor||"rgba(15,23,42,0.95)",Hu=Zi.borderColor||"rgba(0,0,0,0.65)",ed=Zi.textColor||Zi.color||"#f97316",td=String(Zi.text||"");Be.lineWidth=typeof Zi.borderWidth=="number"?Zi.borderWidth:1;const Xd=Be.globalAlpha;if(Be.globalAlpha=typeof Zi.opacity=="number"?Math.max(0,Math.min(1,Zi.opacity)):1,Hs==="circle"||Hs==="square"||Hs==="arrowUp"||Hs==="arrowDown"||Hs==="box"||Hs==="triangleUpFilled"||Hs==="triangleDownFilled"||Hs==="label"||Hs==="arrowUpGlow"||Hs==="arrowDownGlow"||Hs==="triangleUpGradient"||Hs==="triangleDownGradient"||Hs==="circlePulse"||Hs==="tag"||Hs==="flag"||Hs==="pill"||Hs==="boxGradient"||Hs==="bubble"||Hs==="spark"||Hs==="star"||Hs==="text"){if(Be.save(),Be.strokeStyle=Hu,Be.fillStyle=Zi.color||Qc,Hs==="circle")Be.beginPath(),Be.arc(_i,Ys,gi,0,Math.PI*2),Be.fill(),Be.stroke();else if(Hs==="square")Be.beginPath(),Be.rect(_i-gi,Ys-gi,xa,xa),Be.fill(),Be.stroke();else if(Hs==="arrowUp"||Hs==="arrowUpGlow")Be.beginPath(),Be.moveTo(_i,Ys-gi),Be.lineTo(_i-gi,Ys+gi),Be.lineTo(_i+gi,Ys+gi),Be.closePath(),(Hs==="arrowUpGlow"||Zi.shadow)&&(Be.shadowColor=Zi.color||Qc,Be.shadowBlur=12),Be.fill(),Be.stroke();else if(Hs==="arrowDown"||Hs==="arrowDownGlow")Be.beginPath(),Be.moveTo(_i,Ys+gi),Be.lineTo(_i-gi,Ys-gi),Be.lineTo(_i+gi,Ys-gi),Be.closePath(),(Hs==="arrowDownGlow"||Zi.shadow)&&(Be.shadowColor=Zi.color||Qc,Be.shadowBlur=12),Be.fill(),Be.stroke();else if(Hs==="triangleUpFilled")Be.beginPath(),Be.moveTo(_i,Ys-gi),Be.lineTo(_i-gi,Ys+gi),Be.lineTo(_i+gi,Ys+gi),Be.closePath(),Be.fill(),Be.stroke();else if(Hs==="triangleDownFilled")Be.beginPath(),Be.moveTo(_i,Ys+gi),Be.lineTo(_i-gi,Ys-gi),Be.lineTo(_i+gi,Ys-gi),Be.closePath(),Be.fill(),Be.stroke();else if(Hs==="triangleUpGradient"||Hs==="triangleDownGradient"){const Mr=Be.createLinearGradient(_i-gi,Ys-gi,_i+gi,Ys+gi);Mr.addColorStop(0,Zi.bgColor||"rgba(59,130,246,0.6)"),Mr.addColorStop(1,Zi.color||"rgba(34,197,94,0.6)"),Be.fillStyle=Mr,Be.beginPath(),Hs==="triangleUpGradient"?(Be.moveTo(_i,Ys-gi),Be.lineTo(_i-gi,Ys+gi),Be.lineTo(_i+gi,Ys+gi)):(Be.moveTo(_i,Ys+gi),Be.lineTo(_i-gi,Ys-gi),Be.lineTo(_i+gi,Ys-gi)),Be.closePath(),Be.fill(),Be.stroke()}else if(Hs==="circlePulse")Be.beginPath(),Be.arc(_i,Ys,gi,0,Math.PI*2),Be.fill(),Be.stroke(),Be.globalAlpha=.4,Be.beginPath(),Be.arc(_i,Ys,gi*1.6,0,Math.PI*2),Be.stroke(),Be.globalAlpha=1;else if(Hs==="pill"){const Mr=Math.max(10,Be.measureText(td||"").width+16),Pa=Math.max(12,xa),Ma=_i-Math.floor(Mr/2),wl=Ys-Math.floor(Pa/2),ga=Pa/2;Be.beginPath(),Be.moveTo(Ma+ga,wl),Be.lineTo(Ma+Mr-ga,wl),Be.arc(Ma+Mr-ga,wl+ga,ga,-Math.PI/2,Math.PI/2),Be.lineTo(Ma+ga,wl+Pa),Be.arc(Ma+ga,wl+ga,ga,Math.PI/2,-Math.PI/2),Be.closePath(),Be.fill(),Be.stroke()}else if(Hs==="tag"||Hs==="flag"){const Mr=Math.max(10,Be.measureText(td||"").width+20),Pa=Math.max(12,xa+4),Ma=_i-Math.floor(Mr/2),wl=Ys-Math.floor(Pa/2);Be.beginPath(),Be.rect(Ma,wl,Mr,Pa),Be.fill(),Be.stroke(),Hs==="flag"&&(Be.beginPath(),Be.moveTo(Ma,wl),Be.lineTo(Ma-Pa/2,wl+Pa/2),Be.lineTo(Ma,wl+Pa),Be.closePath(),Be.fill(),Be.stroke())}else if(Hs==="boxGradient"){const Mr=Math.max(10,Be.measureText(td||"").width+12),Pa=Math.max(12,xa+6),Ma=_i-Math.floor(Mr/2),wl=Ys-Math.floor(Pa/2),ga=Be.createLinearGradient(Ma,wl,Ma+Mr,wl+Pa);ga.addColorStop(0,Zi.bgColor||"rgba(15,23,42,0.5)"),ga.addColorStop(1,Zi.color||"rgba(59,130,246,0.35)"),Be.fillStyle=ga,Be.beginPath(),Be.rect(Ma,wl,Mr,Pa),Be.fill(),Be.stroke()}else if(Hs==="bubble")Be.beginPath(),Be.arc(_i,Ys,gi,0,Math.PI*2),Be.fill(),Be.stroke(),Be.beginPath(),Be.moveTo(_i,Ys+gi),Be.lineTo(_i+gi,Ys+gi+6),Be.stroke();else if(Hs==="spark")Be.beginPath(),Be.moveTo(_i,Ys-gi),Be.lineTo(_i,Ys+gi),Be.moveTo(_i-gi,Ys),Be.lineTo(_i+gi,Ys),Be.stroke();else if(Hs==="star"){Be.beginPath();for(let Mr=0;Mr<5;(Mr+=1)-1){const Pa=Math.PI*2*Mr/5,Ma=_i+Math.cos(Pa)*gi,wl=Ys+Math.sin(Pa)*gi,ga=Pa+Math.PI/5,Ml=_i+Math.cos(ga)*(gi/2),fc=Ys+Math.sin(ga)*(gi/2);Mr===0?Be.moveTo(Ma,wl):Be.lineTo(Ma,wl),Be.lineTo(Ml,fc)}Be.closePath(),Be.fill(),Be.stroke()}else if(Hs==="box"){const Mr=Wl.__open,Pa=Wl.__close,Ma=Wl.__high,wl=Wl.__low;if(Mr!=null&&Pa!=null&&Ma!=null&&wl!=null){const ga=Zi.boxMode||"body",Ml=ga==="wick"?Ma:Math.max(Mr,Pa),fc=ga==="wick"?wl:Math.min(Mr,Pa),rp=Da.convertToPixel(Ml),au=Da.convertToPixel(fc);if(Number.isFinite(rp)&&Number.isFinite(au)){const ud=Cr.convertToPixel(Nr),tt=Nr>0?Cr.convertToPixel(Nr-1):ud-Math.abs(Cr.convertToPixel(1)-Cr.convertToPixel(0)),Gt=Nr<Jr.length-1?Cr.convertToPixel(Nr+1):ud+Math.abs(Cr.convertToPixel(1)-Cr.convertToPixel(0)),dt=0,Tt=((st==null?void 0:st.width)??Gs.width)||0,At=Math.min(ud,Math.max(dt,Math.floor((tt+ud)/2))),io=Math.max(ud,Math.min(Tt,Math.ceil((ud+Gt)/2))),co=Math.min(rp,au),wo=Math.max(1,Math.abs(au-rp)),$o=Math.max(2,io-At);Be.beginPath(),Be.rect(At,co,$o,wo),Be.fill(),Be.strokeStyle=Hu,Be.lineWidth=xa,Be.stroke()}}}else if(Hs==="label"){const Mr=Be.measureText(td||""),Pa=Math.max(10,Mr.width+12),Ma=Math.max(12,xa+6),wl=Math.max(3,Math.floor(Ma/3)),ga=_i-Math.floor(Pa/2),Ml=Ys-Math.floor(Ma/2);Be.beginPath();const fc=wl;Be.moveTo(ga+fc,Ml),Be.lineTo(ga+Pa-fc,Ml),Be.quadraticCurveTo(ga+Pa,Ml,ga+Pa,Ml+fc),Be.lineTo(ga+Pa,Ml+Ma-fc),Be.quadraticCurveTo(ga+Pa,Ml+Ma,ga+Pa-fc,Ml+Ma),Be.lineTo(ga+fc,Ml+Ma),Be.quadraticCurveTo(ga,Ml+Ma,ga,Ml+Ma-fc),Be.lineTo(ga,Ml+fc),Be.quadraticCurveTo(ga,Ml,ga+fc,Ml),Be.closePath(),Be.fill(),Be.stroke()}else if(Hs==="text"){Be.fillStyle=ed,Be.textAlign="center";const Mr=typeof Zi.size=="number"&&Zi.size>0?Zi.size:14;Be.font=`${Mr}px sans-serif`;const Pa=Jc?Ys-(Mr/2+4):Ys+(Mr/2+4);Be.fillText(td||"",_i,Pa)}if(td&&Hs!=="text"){const Pa=(typeof Zi.size=="number"&&Zi.size>0?Zi.size:12)/2,Ma=typeof Zi.textPadding=="number"?Math.max(0,Zi.textPadding):Pa+6,wl=Jc?Ys-Ma:Ys+Ma;Be.fillStyle=ed,Be.strokeStyle="rgba(0,0,0,0.45)",Be.textAlign="center",Be.fillText(td,_i,wl),Be.strokeText(td,_i,wl)}Be.restore(),Be.globalAlpha=Xd}else if(td)Be.fillStyle=ed,Be.strokeStyle="rgba(0,0,0,0.45)",Be.lineWidth=1,Be.fillText(td,_i,Ys),Be.strokeText(td,_i,Ys);else{const Mr=String(Fi||"");if(!U.has(Mr)){U.add(Mr);try{console.warn("[ScriptStudio] Unknown label shape:",Mr)}catch{}}Be.beginPath(),Be.arc(_i,Ys,Math.max(3,ba/3),0,Math.PI*2),Be.fillStyle=Zi.color||"#22d3ee",Be.fill()}}}return Be.restore(),!1}}},Yo=[],is=[];je.forEach((Pt,Ut)=>{var El,fe,No,gs,pi,vi,Na;const xs=Ot(Pt,Ut);try{r_(xs)}catch(Xl){console.debug("Script indicator register error",Xl)}const fs=Pt.pane==="main"?"candle_pane":`pane_script_${Ut}`;is[Ut]=fs;const rs=Pt.pane==="main",mn=typeof Pt.min=="number"&&typeof Pt.max=="number",Ds=Pt.pane==="sub"?{gap:mn?{top:0,bottom:0}:{top:2,bottom:2}}:void 0;let sn=te.createIndicator(xs.name,rs,{id:fs,height:typeof Pt.height=="number"&&Number.isFinite(Pt.height)?Pt.height:Pt.pane==="sub"?((El=z==null?void 0:z.sub)==null?void 0:El.height)??(z==null?void 0:z.height)??200:((fe=z==null?void 0:z.main)==null?void 0:fe.height)??(z==null?void 0:z.height)??void 0,axis:Ds});if(sn||(sn=te.createIndicator(xs,rs,{id:fs,height:typeof Pt.height=="number"&&Number.isFinite(Pt.height)?Pt.height:Pt.pane==="sub"?((No=z==null?void 0:z.sub)==null?void 0:No.height)??(z==null?void 0:z.height)??200:((gs=z==null?void 0:z.main)==null?void 0:gs.height)??(z==null?void 0:z.height)??void 0,axis:Ds})),!sn)throw new Error("Unable to render script indicator.");He.push(sn),Ie.push(xs.name),V.push({def:xs,paneId:fs}),mn?(zt.set(fs,{min:Pt.min,max:Pt.max}),xt(fs),eo(fs)):zt.delete(fs);try{te.createOverlay({name:"script-layer",visible:!0,lock:!0,groupId:"runtime"})}catch{}const na=(Na=xs.calc)==null?void 0:Na.call(xs,((vi=(pi=i())==null?void 0:pi.getDataList)==null?void 0:vi.call(pi))||[],{calcParams:[]}),Wo=Array.isArray(na)?na:Array.isArray(na==null?void 0:na.__rows)?na.__rows:[],Pl=n(xe)?Wo.reduce((Xl,cd)=>Xl+Object.keys(cd||{}).filter(Be=>Be.startsWith("__label_")).length,0):0;Yo.push(Pl)});try{const Pt=((yl=te.getDataList)==null?void 0:yl.call(te))||[],Ut=No=>{const gs=typeof No=="number"?No:Number(No);return Number.isFinite(gs)?gs:void 0},xs=Pt.map(No=>{const gs=Ut((No==null?void 0:No.close)??(No==null?void 0:No.c)??(No==null?void 0:No.price));return Ut((No==null?void 0:No.high)??(No==null?void 0:No.h))??gs}),fs=Pt.map(No=>{const gs=Ut((No==null?void 0:No.close)??(No==null?void 0:No.c)??(No==null?void 0:No.price));return Ut((No==null?void 0:No.low)??(No==null?void 0:No.l))??gs}),rs=Pt.map(No=>Ut((No==null?void 0:No.close)??(No==null?void 0:No.c)??(No==null?void 0:No.price))),mn=(No,gs)=>{const pi=No[gs];return typeof pi=="number"&&Number.isFinite(pi)?pi:null},Ds=(No,gs)=>{const pi=Pt.length;if(pi<=0)return null;const vi=Math.max(1,Math.floor(gs.left)),Na=Math.max(1,Math.floor(gs.right)),Xl=Math.max(2,Math.floor(gs.lookback)),cd=pi-1,Be=Math.max(0,cd-Xl+1),Bt=Math.max(0,cd-Na);if(Bt<Be)return null;const Gs=No==="high"?xs:fs,Cr=[];for(let Jr=Be+vi;Jr<=Bt;(Jr+=1)-1){const bl=mn(Gs,Jr);if(bl==null)continue;let dd=!0;for(let yc=Jr-vi;yc<=Jr+Na;(yc+=1)-1){if(yc===Jr)continue;const bc=mn(Gs,yc);if(bc==null){dd=!1;break}if(No==="high"){if(bc>=bl){dd=!1;break}}else if(bc<=bl){dd=!1;break}}dd&&Cr.push(Jr)}if(!Cr.length)return null;const Da=Math.trunc(gs.which);if(Da===0)return Cr[Cr.length-1];if(Da<0){const Jr=Cr.length+Da;return Jr>=0?Cr[Jr]:null}const ic=Da-1;return ic>=0&&ic<Cr.length?Cr[ic]:null},sn=(No,gs)=>{const pi=Pt.length;if(pi<=0)return null;const vi=Math.max(2,Math.floor(gs.lookback)),Na=pi-1,Xl=Math.max(0,Na-vi+1),cd=No==="high"?xs:fs;let Be=null,Bt=No==="high"?-1/0:1/0;for(let Gs=Xl;Gs<=Na;(Gs+=1)-1){const Cr=mn(cd,Gs);Cr!=null&&(No==="high"?Cr>Bt&&(Bt=Cr,Be=Gs):Cr<Bt&&(Bt=Cr,Be=Gs))}return Be},na=No=>{const gs=typeof No=="number"?No:Number(No);if(!Number.isFinite(gs))return null;const pi=Pt.length,vi=gs<0?pi+Math.trunc(gs):Math.trunc(gs);return vi<0||vi>=pi?null:vi},Wo=No=>{var Xl,cd;if(!No||typeof No!="object")return null;if(No.pivot){const Be=String(No.pivot).toLowerCase()==="low"?"low":"high",Bt=Ds(Be,{left:Number(No.left??No.pivotLeft??3),right:Number(No.right??No.pivotRight??3),lookback:Number(No.lookback??400),which:Number(No.which??-1)});Bt!=null&&(No={index:Bt,source:Be})}else if(No.extreme){const Be=String(No.extreme).toLowerCase()==="low"?"low":"high",Bt=sn(Be,{lookback:Number(No.lookback??400)});Bt!=null&&(No={index:Bt,source:Be})}const gs=na(No.index),pi=typeof No.timestamp=="number"&&Number.isFinite(No.timestamp)?No.timestamp:gs!=null?((Xl=Pt[gs])==null?void 0:Xl.timestamp)??((cd=Pt[gs])==null?void 0:cd.time)??null:null;let vi=typeof No.value=="number"&&Number.isFinite(No.value)?No.value:null;if(vi==null&&gs!=null&&No.source){const Be=String(No.source||"").replace(/\s+/g,"_").toLowerCase(),Bt=Pt[gs],Gs=Be==="open"?Bt==null?void 0:Bt.open:Be==="high"?Bt==null?void 0:Bt.high:Be==="low"?Bt==null?void 0:Bt.low:Be==="close"?Bt==null?void 0:Bt.close:Be==="volume"?Bt==null?void 0:Bt.volume:null;typeof Gs=="number"&&Number.isFinite(Gs)&&(vi=Gs)}const Na={};return pi!=null&&(Na.timestamp=pi),vi!=null&&(Na.value=vi),gs!=null&&(Na.__index=gs),Object.keys(Na).length?Na:null},Pl=[];je.forEach((No,gs)=>{(Array.isArray(No.overlays)?No.overlays:[]).forEach(vi=>Pl.push({paneId:is[gs]||(No.pane==="main"?"candle_pane":"pane_script"),overlay:vi}))});let El=0;const fe=[];Pl.forEach(({paneId:No,overlay:gs})=>{try{const pi=String((gs==null?void 0:gs.name)||"").trim();if(!pi)return;const Na=(Array.isArray(gs==null?void 0:gs.points)?gs.points:[]).map(Wo).filter(Boolean),Xl={name:pi,paneId:(gs==null?void 0:gs.pane)==="main"?"candle_pane":((gs==null?void 0:gs.pane)==="sub",No),groupId:"runtime",lock:(gs==null?void 0:gs.lock)===!0,visible:(gs==null?void 0:gs.visible)!==!1,points:Na};gs!=null&&gs.styles&&(Xl.styles=gs.styles),gs!=null&&gs.extendData&&(Xl.extendData=gs.extendData),te.createOverlay(Xl),El+=1}catch(pi){fe.push(String((pi==null?void 0:pi.message)||pi))}});try{const No=Array.isArray(ve)?ve:[];for(const gs of No){const pi=String((gs==null?void 0:gs.type)||"").trim().toLowerCase();if(pi!=="auto_fib"&&pi!=="autofib"||!(gs.draw===!0||gs.autoDraw===!0)||Pt.length<2)continue;const Na=Math.max(2,Math.floor(Number(gs.lookback)||200)),cd=String(gs.direction||"up").trim().toLowerCase()==="down"?"down":"up",Be=String(gs.method||gs.mode||"extremes").trim().toLowerCase(),Bt=Be==="pivots"||Be==="pivot"||Be==="swing"?"pivots":"extremes",Gs=Math.max(1,Math.floor(Number(gs.pivotLeft??gs.left??3))),Cr=Math.max(1,Math.floor(Number(gs.pivotRight??gs.right??3))),Da=Ox(xs,fs,rs,Pt.length-1,{lookback:Na,direction:cd,method:Bt,pivotLeft:Gs,pivotRight:Cr});if(!Da)continue;const ic=Pt[Da.fromIndex],Jr=Pt[Da.toIndex],bl=(ic==null?void 0:ic.timestamp)??(ic==null?void 0:ic.time)??null,dd=(Jr==null?void 0:Jr.timestamp)??(Jr==null?void 0:Jr.time)??null;if(bl==null||dd==null)continue;const yc=gs.levels,bc=Array.isArray(yc)&&yc.length?yc.map(st=>{if(typeof st=="number")return{value:st,color:"#64748b",label:String(st)};if(st&&typeof st=="object"){const ia=typeof st.value=="number"?st.value:Number(st.value);return Number.isFinite(ia)?{value:ia,color:String(st.color||"#64748b"),label:String(st.label??ia)}:null}return null}).filter(Boolean):[{value:0,color:"#64748b",label:"0"},{value:.382,color:"#60a5fa",label:"0.382"},{value:.5,color:"#22c55e",label:"0.5"},{value:.618,color:"#f59e0b",label:"0.618"},{value:1,color:"#64748b",label:"1"}];te.createOverlay({name:"fibonacciSegment",paneId:"candle_pane",groupId:"runtime",lock:!1,visible:!0,points:[{timestamp:bl,value:Da.fromValue},{timestamp:dd,value:Da.toValue}],extendData:{fibonacciLevels:bc}}),El+=1}}catch(No){fe.push(String((No==null?void 0:No.message)||No))}El&&b(ye,`${n(ye)||"Plotted"} • overlays: ${El}`),fe.length&&b(Ae,`Overlay error: ${fe.slice(0,2).join(" • ")}`)}catch(Pt){console.error("[ScriptStudio] overlay create error",Pt)}try{const Pt=V.find(Ut=>Ut.paneId==="candle_pane");b(ne,j(((kn=Pt==null?void 0:Pt.def)==null?void 0:kn.name)||((Ba=(Sr=V[0])==null?void 0:Sr.def)==null?void 0:Ba.name)||null))}catch{b(ne,null)}const vs=je.map(Pt=>Pt.pane).join("+"),Rs=Yo.reduce((Pt,Ut)=>Pt+Ut,0);if(b(ye,`Plotted (${vs}) • labels: ${n(xe)?Rs:"off"}`),Rs===0)try{const Pt=je.reduce((rs,mn)=>rs+(mn.plots||[]).length,0),Ut=[];Pt===0&&Ut.push("Pane has no plots");const xs=new Set(["open","high","low","close","volume"]),fs=(rs,mn)=>{const Ds=(rs||"").toLowerCase(),sn=mn.replace(/\s+/g,"_").toLowerCase();return Ds==="bbands"||Ds==="bollinger"||Ds==="bollinger_bands"||Ds==="kc"||Ds==="keltner"||Ds==="donchian"||Ds==="linreg_channel"?[`${sn}_mid`,`${sn}_upper`,`${sn}_lower`]:Ds==="atr_bands"?[`${sn}_upper`,`${sn}_lower`]:Ds==="stoch"?[`${sn}_k`,`${sn}_d`]:Ds==="macd"?["macd_line","macd_signal","macd_hist"]:Ds==="ichimoku"?["tenkan","kijun","spana","spanb","chikou"]:[sn]};if(ve.forEach(rs=>{const mn=String((rs==null?void 0:rs.name)||(rs==null?void 0:rs.type)||"").replace(/\s+/g,"_").toLowerCase();fs(String((rs==null?void 0:rs.type)||""),mn).forEach(Ds=>xs.add(Ds))}),Ne.forEach(rs=>{const mn=String((rs==null?void 0:rs.name)||"").replace(/\s+/g,"_").toLowerCase();mn&&xs.add(mn)}),je.forEach((rs,mn)=>{(rs.labels||[]).forEach((Ds,sn)=>{const na=String((Ds==null?void 0:Ds.when)||"").trim();if(!na){Ut.push(`Label[${mn}:${sn}] has empty condition`);return}try{const Wo=z!=null&&z.params&&typeof z.params=="object"?z.params:{},Pl=na.replace(/\$\{([^}]+)\}/g,(pi,vi)=>{const Na=Wo[vi],Xl=typeof Na=="number"?Na:Number(Na);return Number.isFinite(Xl)?String(Xl):"0"}),El=Mv(Pl),fe=[],No=pi=>{!pi||typeof pi!="object"||(pi.kind==="SeriesRef"&&fe.push(String(pi.name||"")),Object.values(pi).forEach(No))};No(El);const gs=fe.filter(pi=>!xs.has(pi.replace(/\s+/g,"_").toLowerCase())&&!["open","high","low","close","volume"].includes(pi.replace(/\s+/g,"_").toLowerCase()));gs.length&&Ut.push(`Label[${mn}:${sn}] unknown series: ${gs.join(", ")}`)}catch(Wo){const Pl=(Wo==null?void 0:Wo.position)!=null?` at ${Wo.position}`:"",El=Wo!=null&&Wo.message?String(Wo.message):String(Wo);Ut.push(`Label[${mn}:${sn}] parse failed${Pl}: ${El}`)}})}),Ut.length){const rs=Ut.join(" • ");b(Ae,j(n(Ae)?`${n(Ae)} • ${rs}`:rs))}else b(ye,"No label signals matched")}catch{}rt();try{G&&(clearInterval(G),G=null)}catch{}Is()}async function Hn(z,te){var ve,Ne,Re;b(Ae,null),b(ye,"Running..."),b(ee,!0);try{let je=null;const kt=String(z||"").trim();if(kt.startsWith("{")||kt.startsWith("["))try{je=JSON.parse(kt)}catch(Ct){const Kt=String((Ct==null?void 0:Ct.message)||"Invalid JSON");b(Ae,`Invalid JSON: ${Kt}`),b(ye,"Validation failed");return}else try{je=JSON.parse(kt)}catch{}if(je&&typeof je=="object"&&(je.plots||je.calc||je.series||je.signals||je.strategy||je.labels||je.levels||je.lines||je.overlays||je.panes||je.main||je.sub))try{const Ct=je&&typeof je=="object"?je.params||{}:{},Kt=jx(je,Ct),Dt=$x(Kt);if(Dt.ok&&Dt.spec)await Ko(Kt);else{const jt=(Dt.errors||[]).join("; ");b(Ae,j(jt?`Schema validation failed: ${jt}`:"Schema validation failed")),b(ye,"Validation failed");return}}catch(Ct){const Kt=Ct instanceof Error?Ct.message:String(Ct);b(Ae,`Schema validation error: ${Kt}`),b(ye,"Validation failed");return}else try{const Ct=s1(z);if(Ct.ok){try{const jt=Ct.spec&&typeof Ct.spec=="object"?Ct.spec.params||{}:{},Co=te&&typeof te=="object"?{...jt,...te}:jt;Ct.spec.params=Co}catch{}await Ko(Ct.spec),b(ye,"Plotted from Pine");return}else{const jt=(Ct.errors||[]).filter(Co=>String((Co==null?void 0:Co.message)||"")!=="Not a Pine-like script");if(jt.length){b(Ae,j(jt.slice(0,6).map(Co=>`Line ${Co.line}: ${Co.message}`).join(" • "))),b(ye,"Validation failed");return}}const Kt=Tq(z),Dt={calc:[],series:Kt.series,panes:Kt.panes,signals:Kt.signals,params:te&&typeof te=="object"?{...Kt.params,...te}:Kt.params};await Ko(Dt),b(ye,"Plotted from DSL")}catch{const Kt=tc(z),Dt=i();if(!Dt)throw new Error("Chart not ready yet. Please try again in a moment.");sr(Dt);const jt=`${ke}_${Date.now()}`,Co=pe(Kt,jt);try{r_(Co)}catch(zi){console.debug("Script indicator register error",zi)}const Oo=n(J)==="main"?"candle_pane":"pane_script",Ho=n(J)==="main";let Vo=Dt.createIndicator(Co.name,Ho,{id:Oo,axis:n(J)==="sub"?{gap:{top:2,bottom:2}}:void 0});if(Vo||(Vo=Dt.createIndicator(Co,Ho,{id:Oo,axis:n(J)==="sub"?{gap:{top:2,bottom:2}}:void 0})),!Vo)throw new Error("Unable to render script indicator.");He.push(Vo),Ie.push(Co.name),b(ne,j(Co.name));const Cn=((Re=Co.calc)==null?void 0:Re.call(Co,((Ne=(ve=i())==null?void 0:ve.getDataList)==null?void 0:Ne.call(ve))||[],{calcParams:[Kt.window]}))||[],Qs=Cn.filter(zi=>zi==null?void 0:zi.topSignal).length,Gn=Cn.filter(zi=>zi==null?void 0:zi.botSignal).length;b(ye,`Plotted (WIN=${Kt.window}) • ▲ ${Qs} / ▼ ${Gn}`)}}catch(je){b(Ae,j(je instanceof Error?je.message:"Script failed to run.")),b(ye,null),console.error("[ScriptStudio] run failed",je)}finally{b(ee,!1)}$==null||$.restore()}function ji(){const z=i();try{sr(z)}catch{}try{z==null||z.removeOverlay({groupId:"runtime"})}catch{}try{z==null||z.removeOverlay({name:"script-layer"})}catch{}V=[];try{G&&(clearInterval(G),G=null)}catch{}try{$&&R&&$.clearRect(0,0,R.width,R.height)}catch{}try{vq()}catch{}try{mq()}catch{}b(ye,"Reset"),b(Ae,null),b(ee,!1),b(ne,null)}function zn(){typeof requestAnimationFrame>"u"||requestAnimationFrame(()=>{ml.request(()=>{var ve,Ne;if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const z=Ul(s().theme);Rt.merge(z,iv(s().styles)),i().setStyles(al(z)),ai();const te=(Ne=(ve=i()).getVisibleRange)==null?void 0:Ne.call(ve);te&&typeof te.to=="number"&&setTimeout(()=>{i()&&i().scrollToDataIndex(te.to,0)},30)})})}function Vs(){b(Pe,!1),b(ze,!1),zn()}const Bn=()=>{window.removeEventListener("mousemove",lr),window.removeEventListener("touchmove",lr),window.removeEventListener("mouseup",Ui),window.removeEventListener("touchend",Ui)};function tr(z){if(!n(Pe))return;const te="touches"in z?z.touches[0]:z,{clientY:ve}=te;Ve=ve,Ce=n(De),b($e,!0),window.addEventListener("mousemove",lr),window.addEventListener("touchmove",lr,{passive:!1}),window.addEventListener("mouseup",Ui),window.addEventListener("touchend",Ui),z.preventDefault()}function lr(z){var Ue;if(!n($e))return;const te="touches"in z?z.touches[0]:z,ve=(Ue=n(Q))==null?void 0:Ue.getBoundingClientRect();if(!ve)return;const Ne=Ve-te.clientY,Re=Ce*ve.height+Ne,je=Math.min(be,Math.max(ge,Re/ve.height));b(De,j(je)),zn(),z.preventDefault()}function Ui(){n($e)&&(b($e,!1),Bn(),zn(),setTimeout(()=>{ml.request(()=>{var ve,Ne;if(!i())return;i().resize(),window.__forceApplySavedCanvasColors=!0;const z=Ul(s().theme);Rt.merge(z,iv(s().styles)),i().setStyles(al(z)),ai();const te=(Ne=(ve=i()).getVisibleRange)==null?void 0:Ne.call(ve);te&&typeof te.to=="number"&&setTimeout(()=>{i()&&i().scrollToDataIndex(te.to,0)},30)})},140))}function _a(z){b(Ae,null);const te="Inline Script";try{const ve=aq(te,z);b(ye,`Saved • ${ve.name}`)}catch{b(ye,"Saved locally")}}yp(()=>{if(Bn(),G){try{clearInterval(G)}catch{}G=null}});function qi(z){if(!z)return"";if(Array.isArray(z.colors)&&z.colors.length>0){const te=z.angle||z.direction||0,ve=z.colors.map(Ne=>`${Ne.color} ${Ne.position}%`).join(", ");return`linear-gradient(${te}deg, ${ve})`}if(Array.isArray(z.stops)&&z.stops.length>0){const te=z.type==="radial"?"radial":"linear",ve=z.direction??z.angle??0,Re=[...z.stops].sort((je,Ue)=>(je.position??0)-(Ue.position??0)).map(je=>{const Ue=(je.color||"").trim(),kt=je.position??0,lt=(je.opacity??100)/100;if(Ue.startsWith("#")){const bt=parseInt(Ue.slice(1,3),16),Ct=parseInt(Ue.slice(3,5),16),Kt=parseInt(Ue.slice(5,7),16);return`rgba(${bt}, ${Ct}, ${Kt}, ${lt}) ${kt}%`}if(Ue.startsWith("rgb(")||Ue.startsWith("rgba(")){const bt=Ue.match(/rgba?\(([^)]+)\)/i);if(bt){const Ct=bt[1].split(",").map(Co=>Co.trim()),[Kt,Dt,jt]=Ct;return`rgba(${Kt}, ${Dt}, ${jt}, ${lt}) ${kt}%`}}return`${Ue} ${kt}%`});return te==="radial"?`radial-gradient(circle, ${Re.join(", ")})`:`linear-gradient(${ve}deg, ${Re.join(", ")})`}return""}function ai(){var z,te,ve,Ne,Re,je,Ue,kt,lt,bt,Ct,Kt;kr=!0;try{const Dt=s().styles;if(!Dt)return;const jt=Ul(s().theme),Co=Rt.get(jt,"pane.backgroundColor")||(s().theme==="dark"?"#070211":"#ffffff"),Oo=s().theme==="dark"?"#ffffff":"#070211",Ho=Dt.backgroundType||"solid",Vo=document.querySelector(".kline-main"),Cn=document.querySelector(".kline-widget");let Qs="";const Gn=Ho==="gradient"&&!!Dt.backgroundGradient;if(!window.__forceApplyThemeDefaults&&!window.__forceApplySavedCanvasColors&&!Gn){const Qo=oo=>{if(!oo)return"";const Yt=oo,To=(window.getComputedStyle(Yt).getPropertyValue("--chart-background-color")||"").trim(),vo=(Yt.style.background||Yt.style.backgroundColor||"").trim();return To||vo||""};Qs=Qo(Vo)||Qo(Cn)}if(!window.__forceApplyThemeDefaults&&!window.__forceApplySavedCanvasColors&&!Gn&&Qs)[Vo,Cn].forEach(Qo=>{Qo&&(Qo.style.background=Qs,Qo.style.backgroundColor=Qs,Qo.style.setProperty("--chart-background-color",Qs))}),console.log("🎨 Preserved live preview background:",Qs);else if(Ho==="solid"){let Qo=Dt.backgroundColor||Co;const oo=(Dt.backgroundOpacity??100)/100,Yt=typeof Dt.backgroundColor=="string"&&Dt.backgroundColor.trim().toLowerCase()===Oo.toLowerCase(),Ht=!!Dt.backgroundType||!!Dt.backgroundGradient||typeof Dt.backgroundOpacity=="number";Yt&&!Ht&&(Qo=Co);let To=Qo;if(oo!==1&&Qo.startsWith("#")){const vo=parseInt(Qo.slice(1,3),16),Ot=parseInt(Qo.slice(3,5),16),Yo=parseInt(Qo.slice(5,7),16);To=`rgba(${vo}, ${Ot}, ${Yo}, ${oo})`}[Vo,Cn].forEach(vo=>{vo&&(vo.style.background=To,vo.style.backgroundColor=To,vo.style.setProperty("--chart-background-color",To))}),console.log("🎨 Applied saved background color:",To)}else if(Ho==="gradient"&&Dt.backgroundGradient){const Qo=Dt.backgroundGradient,oo=Qo.css||qi(Qo);[Vo,Cn].forEach(Yt=>{Yt&&(Yt.style.background=oo,Yt.style.backgroundColor=oo,Yt.style.setProperty("--chart-background-color",oo))}),console.log("🎨 Applied saved gradient background:",oo)}const zi=Dt.gridType||"solid",wn=Rt.get(jt,"grid.horizontal.color")||(s().theme==="dark"?"#081115":"#F3F3F3"),Ro=s().theme==="dark"?"#F3F3F3":"#081115";if(i()&&zi==="solid"){const Qo=((te=(z=i()).getStyles)==null?void 0:te.call(z))??{},oo=window.__forceApplyThemeDefaults||window.__forceApplySavedCanvasColors?void 0:Rt.get(Qo,"grid.horizontal.color")||Rt.get(Qo,"grid.vertical.color"),Yt=((Ne=(ve=Dt.grid)==null?void 0:ve.horizontal)==null?void 0:Ne.color)||((je=(Re=Dt.grid)==null?void 0:Re.vertical)==null?void 0:je.color),Ht=typeof Dt.gridOpacity=="number"?Dt.gridOpacity:100,To=Math.max(0,Math.min(100,Ht))/100;let vo=oo||Yt||wn;const Ot=!oo&&typeof Yt=="string"&&Yt.trim().toLowerCase()===Ro.toLowerCase(),Yo=!!Dt.gridType||!!Dt.gridGradient||typeof Dt.gridOpacity=="number";if(Ot&&!Yo&&(vo=wn),!oo&&typeof vo=="string"&&vo.startsWith("#")&&To!==1){const vs=parseInt(vo.slice(1,3),16),Rs=parseInt(vo.slice(3,5),16),Ws=parseInt(vo.slice(5,7),16);vo=`rgba(${vs}, ${Rs}, ${Ws}, ${To})`}const is=Rt.cloneDeep(Qo);Rt.set(is,"grid.horizontal.color",vo),Rt.set(is,"grid.vertical.color",vo),(kt=(Ue=s().styles)==null?void 0:Ue.candle)!=null&&kt.type&&Rt.set(is,"candle.type",s().styles.candle.type),Dn?Dn(al(is)):i().setStyles(al(is)),console.log("🎨 Applied grid color (preserving preview when available):",vo)}else if(i()&&zi==="gradient"&&Dt.gridGradient){const Qo=((bt=(lt=i()).getStyles)==null?void 0:bt.call(lt))??{},oo=window.__forceApplyThemeDefaults||window.__forceApplySavedCanvasColors?void 0:Rt.get(Qo,"grid.horizontal.color")||Rt.get(Qo,"grid.vertical.color"),Yt=Dt.gridGradient,Ht=Yt.css||qi(Yt),To=oo||Ht,vo=Rt.cloneDeep(Qo);Rt.set(vo,"grid.horizontal.color",To),Rt.set(vo,"grid.vertical.color",To),(Kt=(Ct=s().styles)==null?void 0:Ct.candle)!=null&&Kt.type&&Rt.set(vo,"candle.type",s().styles.candle.type),Dn?Dn(al(vo)):i().setStyles(al(vo)),console.log("🎨 Applied gradient grid (preserving preview when available):",To)}}catch(Dt){console.error("Error applying canvas colors:",Dt)}finally{kr=!1,window.__forceApplyThemeDefaults&&(window.__forceApplyThemeDefaults=!1),window.__forceApplySavedCanvasColors&&(window.__forceApplySavedCanvasColors=!1)}}Ir(L(),Uo(r).applyCanvasColors=ai,Uo(r)),vl.setApplyCanvasColorsFunction(ai),Sl.setApplyCanvasColorsFunction(ai);let cr=null,Dn=null,kr=!1,Me=null;Wi(()=>{var z;if(i()&&i()!==cr){cr=i(),Dn=i().setStyles.bind(i());const te=i().resize.bind(i());Me=((z=i().createIndicator)==null?void 0:z.bind(i()))??null,Ir(ce,Uo(i).setStyles=function(ve){const Ne=Dn(ve);return kr||ml.request(()=>ai()),Ne},Uo(i)),Ir(ce,Uo(i).resize=function(){const ve=te();return ml.request(()=>ai()),ve},Uo(i)),Me&&Ir(ce,Uo(i).createIndicator=function(ve,Ne,Re){var bt,Ct,Kt;const je=this;let Ue=[];try{const Dt=(bt=je.getPaneOptions)==null?void 0:bt.call(je);Array.isArray(Dt)&&(Ue=Dt)}catch{}const kt=Me(ve,Ne,Re);let lt=[];try{const Dt=(Ct=je.getPaneOptions)==null?void 0:Ct.call(je);Array.isArray(Dt)&&(lt=Dt)}catch{return kt}try{const Dt=new Set(Ue.map(jt=>jt==null?void 0:jt.id).filter(Boolean));for(const jt of lt){const Co=jt==null?void 0:jt.id;if(Co&&!(Co==="candle_pane"||Co==="x_axis_pane")&&!Dt.has(Co)&&!Zl()){const Oo=typeof jt.height=="number"&&jt.height>0?jt.height:void 0;if(Oo!==void 0){const Ho=Oo+100;try{(Kt=je.setPaneOptions)==null||Kt.call(je,{id:Co,height:Ho}),console.log("📏 Increased new sub‑pane height by 100px (desktop only)",{paneId:Co,baseHeight:Oo,newHeight:Ho})}catch{}}}}}catch{}return kt},Uo(i)),console.log("🔧 Chart methods wrapped to preserve canvas colors")}});let Xe=`${((ho=s().period)==null?void 0:ho.timespan)||""}_${((no=s().period)==null?void 0:no.multiplier)||""}`;Wi(()=>{const z=s().period;if(!i()||!z||!z.timespan)return;const ve={s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month"}[z.timespan]??"day",Ne=Number(z.multiplier)||1,Re=`${ve}_${Ne}`;if(Re!==Xe){Xe=Re;try{i().setPeriod({type:ve,span:Ne});const je=Ul(s().theme);Rt.merge(je,iv(s().styles)),i().setStyles(al(je))}catch{}}}),console.log("📊 About to define onMount function"),console.log("📊 Browser environment:",N_),console.log("🚀 Attempting to call loadSymbols immediately"),Le().then(()=>{console.log("✅ loadSymbols completed successfully"),console.log("📊 allSymbols length:",s().allSymbols.length)}).catch(z=>{console.error("❌ loadSymbols failed:",z)}),Rd(async()=>{var kt,lt,bt,Ct,Kt,Dt,jt,Co,Oo,Ho,Vo,Cn,Qs,Gn,zi,wn;if(console.log("🚀 onMount started - browser:",N_),console.log("📊 chartRef:",B),!B){console.error("❌ chartRef is not available");return}try{let Ro=!1;typeof window<"u"&&(Ro=!!localStorage.getItem("chart.activeSaveId")),Ro&&or.set(!0)}catch{}(lt=(kt=s().styles)==null?void 0:kt.candle)!=null&&lt.type||T().update(Ro=>(Ro.styles=Ro.styles||{},Ro.styles.candle=Ro.styles.candle||{},Ro.styles.candle.type="renko_atr",Ro.styles.candle.renko||(Ro.styles.candle.renko={method:"ATR",atrLength:14,source:"close",wick:!1}),Ro));const z=Ul(s().theme),te=Rt.merge({},z,s().styles);if(console.log("🎨 onMount - Theme styles:",JSON.stringify(z,null,2)),console.log("💾 onMount - Saved styles:",JSON.stringify(s().styles,null,2)),console.log("🔄 onMount - Merged styles:",JSON.stringify(te,null,2)),_2(ce,j(R6(B,{styles:(()=>{var Ro,Qo,oo,Yt,Ht,To,vo,Ot,Yo,is,vs,Rs,Ws,li,an,Br,ya,As,qs,Jn,Pi,_l,ur,yl;try{if((Qo=(Ro=te==null?void 0:te.candle)==null?void 0:Ro.tooltip)!=null&&Qo.legend){const kn=te.candle.tooltip.legend.color;te.candle.tooltip.legend.template=({current:Sr})=>{const Ba="#32CD32",Pt="#FF0000",Ut=((Sr==null?void 0:Sr.close)??0)>((Sr==null?void 0:Sr.open)??0),xs=((Sr==null?void 0:Sr.close)??0)<((Sr==null?void 0:Sr.open)??0),fs=Ut?Ba:xs?Pt:kn,rs=Ds=>({text:Ds,color:fs});return typeof window<"u"&&window.innerWidth<=768?[{title:"O",value:rs("{open}")},{title:"H",value:rs("{high}")},{title:"L",value:rs("{low}")},{title:"C",value:rs("{close}")},{title:"V",value:rs("{volume}")}]:[{title:"O",value:rs("{open}")},{title:"H",value:rs("{high}")},{title:"L",value:rs("{low}")},{title:"C",value:rs("{close}")},{title:"V",value:rs("{volume}")}]}}}catch{}try{const kn=(Ht=(Yt=(oo=z==null?void 0:z.xAxis)==null?void 0:oo.tickText)==null?void 0:Yt.style)==null?void 0:Ht.color,Sr=(Ot=(vo=(To=z==null?void 0:z.yAxis)==null?void 0:To.tickText)==null?void 0:vo.style)==null?void 0:Ot.color;if(kn&&((is=(Yo=te==null?void 0:te.xAxis)==null?void 0:Yo.tickText)!=null&&is.style)&&(te.xAxis.tickText.style.color=kn,(vs=te==null?void 0:te.xAxis)!=null&&vs.tickText)){delete te.xAxis.tickText.color,delete te.xAxis.tickText.opacity,te.xAxis.tickText.color=kn;try{T().update(Ut=>(Ut.styles||(Ut.styles={}),Rt.unset(Ut.styles,"xAxis.tickText.color"),Rt.unset(Ut.styles,"xAxis.tickText.opacity"),Rt.set(Ut.styles,"xAxis.tickText.style.color",kn),Ut))}catch{}}if(Sr&&((Ws=(Rs=te==null?void 0:te.yAxis)==null?void 0:Rs.tickText)!=null&&Ws.style)&&(te.yAxis.tickText.style.color=Sr,(li=te==null?void 0:te.yAxis)!=null&&li.tickText)){delete te.yAxis.tickText.color,delete te.yAxis.tickText.opacity,te.yAxis.tickText.color=Sr;try{T().update(Ut=>(Ut.styles||(Ut.styles={}),Rt.unset(Ut.styles,"yAxis.tickText.color"),Rt.unset(Ut.styles,"yAxis.tickText.opacity"),Rt.set(Ut.styles,"yAxis.tickText.style.color",Sr),Ut))}catch{}}const Ba=(ya=(Br=(an=z==null?void 0:z.candle)==null?void 0:an.tooltip)==null?void 0:Br.legend)==null?void 0:ya.color,Pt=(Jn=(qs=(As=z==null?void 0:z.indicator)==null?void 0:As.tooltip)==null?void 0:qs.legend)==null?void 0:Jn.color;if(Ba&&((_l=(Pi=te==null?void 0:te.candle)==null?void 0:Pi.tooltip)!=null&&_l.legend)){te.candle.tooltip.legend.color=Ba;try{T().update(Ut=>(Ut.styles||(Ut.styles={}),Rt.set(Ut.styles,"candle.tooltip.legend.color",Ba),Ut))}catch{}}if(Pt&&((yl=(ur=te==null?void 0:te.indicator)==null?void 0:ur.tooltip)!=null&&yl.legend)){te.indicator.tooltip.legend.color=Pt;try{T().update(Ut=>(Ut.styles||(Ut.styles={}),Rt.set(Ut.styles,"indicator.tooltip.legend.color",Pt),Ut))}catch{}}}catch{}try{const kn=te.crosshair??{},Sr=kn.vertical??{},Ba=Sr.text??{};te.crosshair={...kn,show:kn.show??!0},te.crosshair.vertical={...Sr,show:Sr.show??!0},te.crosshair.vertical.text={...Ba,show:!0}}catch{}return al(te)})(),decimalFold:{threshold:999,format:w},formatter:{formatDate:({timestamp:Ro,template:Qo,type:oo})=>fy(s().period.timespan)(Ro,Qo,oo)}}))),i()){const Ro=Yt=>(Yt||"").toUpperCase(),Qo=Yt=>{var vo,Ot;const Ht=(Ot=(vo=s().allSymbols)==null?void 0:vo.find)==null?void 0:Ot.call(vo,Yo=>Ro(Yo.ticker)===Ro(Yt));return Ht!=null&&Ht.name?Ht.name:{GP:"Grameen Phone",DSEBD:"DSE Board Index",DSEX:"Dhaka Stock Exchange"}[Ro(Yt)]||""},oo={...s().symbol,ticker:s().symbol.ticker,name:s().symbol.name||Qo(s().symbol.ticker)||s().symbol.ticker,pricePrecision:bm(s().symbol),volumePrecision:s().symbol.volumePrecision};i().setSymbol(oo);try{const Yt=s().period;if(Yt!=null&&Yt.timespan&&(Yt!=null&&Yt.multiplier)){const To={second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month",year:"year",s:"second",m:"minute",h:"hour",d:"day",w:"week"}[Yt.timespan]??"day",vo=Number(Yt.multiplier)||1;i().setPeriod({type:To,span:vo})}}catch{}}if(rt(),i()){const Ro=Qo=>{var Ot,Yo,is,vs;const oo=typeof Qo=="object"&&Qo&&"paneId"in Qo?Qo.paneId:void 0;if(!oo)return;const Yt=oo.startsWith("pane_script")||V.some(Rs=>Rs.paneId===oo),Ht=Yt?Qt(oo):null,To=(Yo=(Ot=Ht==null?void 0:Ht.axis)==null?void 0:Ot.getRange)==null?void 0:Yo.call(Ot),vo=(vs=(is=Ht==null?void 0:Ht.axis)==null?void 0:is.getAutoCalcTickFlag)==null?void 0:vs.call(is);zt.has(oo)&&eo(oo),Yt&&requestAnimationFrame(()=>{var Rs,Ws,li,an,Br,ya;Ht!=null&&Ht.axis&&To&&Yt&&((Ws=(Rs=Ht.axis).setRange)==null||Ws.call(Rs,To),(an=(li=Ht.axis).buildTicks)==null||an.call(li,!0),vo&&((ya=(Br=Ht.axis).setAutoCalcTickFlag)==null||ya.call(Br,!0)))})};(Ct=(bt=i()).subscribeAction)==null||Ct.call(bt,Xu.OnPaneDrag,Ro),Mo=()=>{var Qo,oo;return(oo=(Qo=i())==null?void 0:Qo.unsubscribeAction)==null?void 0:oo.call(Qo,Xu.OnPaneDrag,Ro)}}try{const Ro=(Dt=(Kt=s().styles)==null?void 0:Kt.candle)==null?void 0:Dt.type;i()&&(Ro==="renko_atr"||Ro==="point_and_figure"||Ro==="heikin_ashi")&&vl.switchChartType({chart:i(),newType:Ro,reloadDataFn:async()=>{await ht()}})}catch{}if(i()){const Ro=new MR(i()),Qo=new AR(i()),oo=new LR(i()),Yt=Tx(i()),Ht=zR(Yt);Qo.setProjectionManager(Ro),Qo.setCreationManager(oo),Qo.initialize(),console.log("Enhanced overlay system initialized with templates:",Object.keys(Ht)),el=tT({chart:i(),persistenceKey:s().key+"_drawings",onDrawingCreated:vo=>{console.log("✅ Drawing created:",vo.id,"for symbol:",vo.symbolKey)},onDrawingRemoved:(vo,Ot)=>{console.log("🗑️ Drawing removed:",vo,"from symbol:",Ot)},onSymbolChanged:(vo,Ot)=>{console.log("🔄 Symbol changed in DrawingManager:",vo,"→",Ot)}});const To=Hp(s().symbol);el.setCurrentSymbol(To),oo.setCurrentSymbolKey(To),typeof window<"u"&&(window.overlayCreationManager=oo),console.log("✅ DrawingManager initialized for symbol:",To)}Ir(L(),Uo(r).cloudIndLoaded+=1,Uo(r)),Py.set(s().symbol),J_.set(s().period),console.log("🚀 About to call loadSymbols from onMount"),await Le(),console.log("✅ loadSymbols completed from onMount");try{window.__datafeed=k,window.__pipelineMetrics=()=>{var Ro;return(Ro=k.getPipelineMetrics)==null?void 0:Ro.call(k)}}catch{}window.addEventListener("resize",Ca);let ve=i();try{Wr=new ResizeObserver(()=>{Ca()}),B&&Wr.observe(B),n(Q)&&Wr.observe(n(Q)),n(K)&&Wr.observe(n(K))}catch{}const Ne=()=>{},Re=()=>{},je=Ro=>{var vo,Ot;if(!(!Ro||Ro&&Ro.x==null&&Ro.y==null)||!B)return;const oo=B.getBoundingClientRect();if(!(n(ui)>=oo.left&&n(ui)<=oo.right&&n(Ms)>=oo.top&&n(Ms)<=oo.bottom))return;const Ht=n(ui)-oo.left,To=n(Ms)-oo.top;try{(Ot=(vo=i())==null?void 0:vo.getChartStore)==null||Ot.call(vo).setCrosshair({x:Ht,y:To,paneId:"candle_pane"},{forceInvalidate:!0})}catch{}};if(i()&&((Co=(jt=i()).subscribeAction)==null||Co.call(jt,Xu.OnZoom,Ne),(Ho=(Oo=i()).subscribeAction)==null||Ho.call(Oo,Xu.OnScroll,Re),(Cn=(Vo=i()).subscribeAction)==null||Cn.call(Vo,Xu.OnCrosshairChange,je),qa=()=>{var Ro,Qo;return(Qo=(Ro=i())==null?void 0:Ro.unsubscribeAction)==null?void 0:Qo.call(Ro,Xu.OnZoom,Ne)},Kl=()=>{var Ro,Qo;return(Qo=(Ro=i())==null?void 0:Ro.unsubscribeAction)==null?void 0:Qo.call(Ro,Xu.OnScroll,Re)},ll=()=>{var Ro,Qo;return(Qo=(Ro=i())==null?void 0:Ro.unsubscribeAction)==null?void 0:Qo.call(Ro,Xu.OnCrosshairChange,je)}),setTimeout(()=>{var Ro,Qo;if(ve)try{const oo=((Ro=ve.getDataList)==null?void 0:Ro.call(ve))??[];Array.isArray(oo)&&oo.length>0&&b(Z,!0);const Yt=(Qo=ve.getVisibleRange)==null?void 0:Qo.call(ve);(Array.isArray(oo)&&oo.length>0&&Yt&&typeof Yt.to=="number"?Yt.to>=oo.length-2:!1)&&ve.scrollToRealTime()}catch{}},100),jr){try{jr()}catch{}jr=null}jr=X(ve);const Ue=Ul(s().theme);Rt.merge(Ue,iv(s().styles)),(Qs=i())==null||Qs.setStyles(al(Ue)),ai();try{const Ro=()=>{var Ot,Yo,is,vs,Rs,Ws,li,an,Br,ya,As,qs,Jn;if(!i())return;const Ht=i();let To=[];try{To=((Ot=Ht.getIndicators)==null?void 0:Ot.call(Ht))??[]}catch{To=[]}const vo=Object.entries(s().saveInds||{});for(const[,Pi]of vo){const _l=Pi==null?void 0:Pi.name;if(!_l)continue;const ur=(Pi==null?void 0:Pi.pane_id)||"";if(To.some(Pt=>Pt.name===_l&&(!ur||Pt.paneId===ur)))continue;let kn;if(Array.isArray(Pi.styles)&&Pi.styles.length>0){const Pt=Ut=>Ut==="dashed"||Ut==="dotted"?{style:Ee.Dashed,dashedValue:Ut==="dotted"?[2,2]:[4,4]}:{style:Ee.Solid,dashedValue:[2,2]};kn={lines:Pi.styles.map(Ut=>{const xs=Pt(Ut==null?void 0:Ut.lineStyle);return{color:Ut==null?void 0:Ut.color,size:(Ut==null?void 0:Ut.thickness)??1,style:xs.style,dashedValue:xs.dashedValue}})}}let Sr;if(_l==="SMARTTREND"){const Pt=Pi.superTrendGroup;if(Sr=Pt?{showLabels:!!Pt.showLabels,uptrendColor:((is=(Yo=Pt.styles)==null?void 0:Yo.uptrend)==null?void 0:is.color)??"#00FF00",downtrendColor:((Rs=(vs=Pt.styles)==null?void 0:vs.downtrend)==null?void 0:Rs.color)??"#FF0000",uptrendThickness:((li=(Ws=Pt.styles)==null?void 0:Ws.uptrend)==null?void 0:li.thickness)??1,downtrendThickness:((Br=(an=Pt.styles)==null?void 0:an.downtrend)==null?void 0:Br.thickness)??1,uptrendLineStyle:((As=(ya=Pt.styles)==null?void 0:ya.uptrend)==null?void 0:As.lineStyle)??"dashed",downtrendLineStyle:((Jn=(qs=Pt.styles)==null?void 0:qs.downtrend)==null?void 0:Jn.lineStyle)??"dashed"}:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"},!kn){const Ut=Sr.uptrendLineStyle==="dotted"||Sr.uptrendLineStyle==="dashed";kn={lines:[{color:Sr.uptrendColor,size:Sr.uptrendThickness,style:Ut?Ee.Dashed:Ee.Solid,dashedValue:Sr.uptrendLineStyle==="dotted"?[2,2]:[4,4]}]}}}const Ba=ur==="candle_pane";try{Ht.createIndicator({name:_l,calcParams:Pi==null?void 0:Pi.params,styles:kn,...Sr?{extendData:Sr}:{}},Ba,ur?{id:ur}:void 0)}catch(Pt){console.warn("⚠️ Failed to restore indicator:",_l,Pt)}}};let Qo=null;try{Qo=typeof window<"u"?localStorage.getItem("chart.activeSaveId"):null}catch{}console.log(Qo?"ℹ️ Active layout detected, SaveSystem will restore indicators.":"ℹ️ No active layout, will add default indicators if needed.");const oo=Ht=>{try{if(!i())return;const To=i();console.log("🎨 Adding default indicators...");const vo="candle_pane";try{To.createIndicator({name:"SMARTTREND",calcParams:[10,3],styles:{lines:[{color:"#00FF00",size:1,style:Ee.Dashed,dashedValue:[4,4]}]},extendData:{showLabels:!0,uptrendColor:"#00FF00",downtrendColor:"#FF0000",uptrendThickness:1,downtrendThickness:1,uptrendLineStyle:"dashed",downtrendLineStyle:"dashed"}},!0,{id:vo})&&T().update(Yo=>(Yo.saveInds[`${vo}_SMARTTREND`]={name:"SMARTTREND",pane_id:vo,params:[10,3]},Yo))}catch{}try{const Ot="candle_pane";To.createIndicator({name:"VOL",calcParams:[20],styles:{lines:[]}},!0,{id:Ot})&&T().update(is=>(is.saveInds[`${Ot}_VOL`]={name:"VOL",pane_id:Ot,params:[20]},is))}catch{}console.log("✅ Default indicators applied",{force:Ht})}catch(To){console.warn("⚠️ Failed to add default indicators:",To)}};let Yt=!1;try{const Ht=(Gn=performance.getEntriesByType)==null?void 0:Gn.call(performance,"navigation");Ht&&Ht.length>0?Yt=Ht[0].type==="reload":performance.navigation&&(Yt=performance.navigation.type===1)}catch{}T().update(Ht=>(Ht.saveInds={},Ht)),Qo?(console.log("✅ Active saved layout will be restored by SaveSystem"),setTimeout(()=>{var Ht,To;try{const vo=typeof window<"u"?localStorage.getItem("chart.activeSaveId"):null,Ot=((To=(Ht=i())==null?void 0:Ht.getIndicators)==null?void 0:To.call(Ht))??[];!vo&&(!Ot||Ot.length===0)&&(console.log("🛟 No active layout after restore attempt; applying default indicators"),oo(!0))}catch{}},500)):(console.log("🎨 No saved layout found, adding default indicators"),setTimeout(()=>{try{(typeof window<"u"?localStorage.getItem("chart.activeSaveId"):null)?console.log("ℹ️ activeSaveId appeared; skipping default indicators"):oo(!0)}catch{oo(!0)}},250))}catch(Ro){console.warn("⚠️ Indicator restore failed:",Ro)}if(((wn=(zi=s().styles)==null?void 0:zi.candle)==null?void 0:wn.type)==="point_and_figure"&&i())try{i().createIndicator("PNF",!1,{id:"candle_pane"}),console.log("📊 Added PNF indicator for initial Point & Figure chart")}catch(Ro){console.warn("Failed to add initial PNF indicator:",Ro)}Ir(L(),Uo(r).initDone+=1,Uo(r)),P()||setTimeout(()=>{i()&&!r().loadingKLine&&(console.log("🔄 Loading initial chart data after initialization"),ht())},100),Le(),setTimeout(()=>{console.log("🔍 Current allSymbols:",s().allSymbols),console.log("🔍 allSymbols length:",s().allSymbols.length)},3e3),B==null||B.focus();try{typeof window<"u"&&(window.drawBarRef=n(Y),window.sidebarHostRef=n(q),window.predictNextCandle=()=>tl(),window.getAutoPlayState=()=>n(js),window.getPlaybackSpeed=()=>n(_s),window.setPlaybackSpeed=Ro=>Od(Ro),window.stopPrediction=()=>fl())}catch{}Wa=Ro=>{if(!__())return;(Ro.key==="F5"||(Ro.metaKey||Ro.ctrlKey)&&(Ro.key==="r"||Ro.key==="R"))&&(Ro.preventDefault(),Ro.stopPropagation(),b(ar,!0))},window.addEventListener("keydown",Wa,{capture:!0}),Qa=Ro=>{var Qo,oo;if(__()){try{const Yt=(((Qo=s())==null?void 0:Qo.key)||"chart")+"_drawings";localStorage.removeItem(Yt)}catch{}try{const Yt=(((oo=s())==null?void 0:oo.key)||"chart")+"_overlays";localStorage.removeItem(Yt)}catch{}try{localStorage.removeItem("dataSpaceOverlays")}catch{}Ro.preventDefault(),Ro.returnValue=""}},window.addEventListener("beforeunload",Qa),setTimeout(()=>{const Ro=B==null?void 0:B.querySelectorAll(".klinecharts-pane-separator");Ro==null||Ro.forEach(Qo=>{const oo=Qo;oo.style.transition="background-color 0.2s ease, transform 0.1s ease",oo.addEventListener("mouseenter",()=>{oo.style.cursor="row-resize",oo.style.transform="scaleY(1.2)"}),oo.addEventListener("mouseleave",()=>{oo.style.transform="scaleY(1)"}),oo.addEventListener("mousedown",()=>{oo.classList.add("dragging"),document.body.style.cursor="row-resize"});const Yt=()=>{oo.classList.remove("dragging"),document.body.style.cursor=""};document.addEventListener("mouseup",Yt),oo.addEventListener("touchstart",Ht=>{Ht.preventDefault(),oo.classList.add("dragging"),"vibrate"in navigator&&navigator.vibrate(10)}),oo.addEventListener("touchend",()=>{oo.classList.remove("dragging")})})},500)}),yp(()=>{fl(),Ja&&(clearTimeout(Ja),Ja=null),Va&&(cancelAnimationFrame(Va),Va=null),Wa&&window.removeEventListener("keydown",Wa,{capture:!0}),Qa&&window.removeEventListener("beforeunload",Qa);try{const z=Xo}catch{}try{window.removeEventListener("resize",Ca)}catch{}if(qa){try{qa()}catch{}qa=null}if(Kl){try{Kl()}catch{}Kl=null}if(ll){try{ll()}catch{}ll=null}if(Mo){try{Mo()}catch{}Mo=null}if(Wr){try{Wr.disconnect()}catch{}Wr=null}if(jr){try{jr()}catch{}jr=null}i()&&sr(i())});function X(z){let te=null,ve=!1,Ne=0;const Re=800;let je=0;const Ue=5;let kt=null,lt=!1;const bt=()=>{try{if(lt)return;const Dt=z.getVisibleRange();if(!Dt||ve)return;const jt=z.getDataList();if(jt.length===0)return;const Co=jt.length-1;wr=Dt.to>=Co-1;const Ho=Dt.to-Dt.from;kt=Ho;const Vo=Math.max(3,Math.min(15,Math.floor(Ho*.15))),Cn=te&&Dt.from<te.from,Qs=Dt.from<=Vo,Gn=!te||Math.abs(Dt.from-te.from)>1,zi=Date.now(),wn=je>=Ue?Re*3:Re,Ro=zi-Ne>wn;if(Dt.from<=Math.max(1,Math.floor(Vo/2))&&Ro||Qs&&Ro){const Ht=jt[0];console.log(`🚀 Infinite scroll triggered: from=${Dt.from}, threshold=${Vo}, dataLength=${jt.length}, consecutive=${je}`),Ct(Ht.timestamp),Ne=zi,je+=1,setTimeout(()=>{je=Math.max(0,je-1)},Re*1.5)}te={...Dt}}catch(Dt){console.error("❌ Error checking scroll position:",Dt)}},Ct=async Dt=>{var jt,Co,Oo,Ho,Vo,Cn,Qs,Gn,zi,wn,Ro,Qo;if(ve||r().loadingKLine||n(es)){console.log("⏳ Already loading data, skipping request...");return}ve=!0,b(es,!0),b(rn,null),console.log("🔄 Loading more historical data...");try{const Yt=((Co=(jt=s().styles)==null?void 0:jt.candle)==null?void 0:Co.type)==="renko_atr"?rr??Dt:Dt,Ht=await k.loadMoreHistoricalData(s().symbol,s().period,Yt);if(Ht.data.length>0){let To=Ht.data;if(((Ho=(Oo=s().styles)==null?void 0:Oo.candle)==null?void 0:Ho.type)==="heikin_ashi")To=My(To);else if(((Cn=(Vo=s().styles)==null?void 0:Vo.candle)==null?void 0:Cn.type)==="renko_atr"){const is=((Gn=(Qs=s().styles)==null?void 0:Qs.candle)==null?void 0:Gn.renko)||{method:"ATR",atrLength:14,source:"close",wick:!1};To=Ty(To,is);try{const vs=Ht.data&&Ht.data.length?Math.min(...Ht.data.map(Rs=>Rs.timestamp||0)):null;vs&&(!rr||vs<rr)&&(rr=vs)}catch{}}else if(((wn=(zi=s().styles)==null?void 0:zi.candle)==null?void 0:wn.type)==="point_and_figure"){const is=((Qo=(Ro=s().styles)==null?void 0:Ro.candle)==null?void 0:Qo.pnf)||{boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"};To=Ay(To,is)}const vo=z.getDataList();To.sort((is,vs)=>is.timestamp-vs.timestamp);const Ot=new Set(vo.map(is=>is.timestamp)),Yo=To.filter(is=>!Ot.has(is.timestamp));if(Yo.length>0){const is=z.getVisibleRange(),vs=(is==null?void 0:is.to)??null,Rs=!is||!vo.length?!1:is.to>=vo.length-2,Ws=vs!==null&&vo[vs]?vo[vs].timestamp:null,li=[...Yo,...vo].sort((an,Br)=>an.timestamp-Br.timestamp);z.applyNewData(li,{backward:!0,forward:!0});try{nc()}catch{}try{li.length>0&&b(Z,!0)}catch{}console.log(`✅ Successfully loaded and merged ${Yo.length} more historical bars`),b(rn,null),is&&requestAnimationFrame(()=>{var an;try{if(Rs){z.scrollToDataIndex(li.length-1),console.log("🎯 Scroll anchored to right edge (pinned)");return}if(Ws){z.scrollToTimestamp(Ws),console.log(`🎯 Scroll anchored to timestamp ${Ws} (stable)`);return}const Br=(vs??0)+Yo.length;z.scrollToDataIndex(Br),console.log(`🎯 Scroll anchored to index ${Br} (fallback)`)}catch(Br){const ya=Ws??((an=li[Yo.length])==null?void 0:an.timestamp);if(ya)try{z.scrollToTimestamp(ya)}catch{}console.warn("Could not maintain scroll position:",Br)}})}else console.log("📭 No new unique historical data to add");Ht.lays&&Ht.lays.length>0&&n(Y)&&Ht.lays.forEach(is=>{n(Y).addOverlay(is)})}else console.log("📭 No historical chunk available from cache at the moment"),lt=!k.hasMoreServerHistory(s().symbol,s().period)}catch(oo){console.error("❌ Error loading more historical data:",oo),b(rn,j(oo instanceof Error?oo.message:"Failed to load historical data")),me.addAlert("error",`Failed to load historical data: ${n(rn)}`)}finally{ve=!1,b(es,!1)}},Kt=setInterval(bt,100);return()=>{clearInterval(Kt),console.log("🧹 Infinite scrolling cleanup completed")}}async function Le(){s().allSymbols||Ir(T(),Uo(s).allSymbols=[],Uo(s)),console.log("🚀 loadSymbols function called. loadingPairs:",r().loadingPairs,"allSymbols length:",s().allSymbols.length),Ir(L(),Uo(r).loadingPairs=!0,Uo(r)),console.log("🔄 Loading symbols..."),console.log("🔄 loadSymbols proceeding");const z=await k.getSymbols();console.log("📊 Symbols loaded:",z),console.log("📊 Symbols loaded count:",z.length),Ir(T(),Uo(s).allSymbols=z,Uo(s));const te=new Set;z.forEach(ve=>{ve.exchange&&te.add(ve.exchange)}),T().update(ve=>(te.forEach(Ne=>{ve.allExgs.add(Ne)}),ve)),Ir(L(),Uo(r).loadingPairs=!1,Uo(r))}async function nt(z,te,ve,Ne,Re=!0,je=ii){var Ho,Vo,Cn,Qs,Gn,zi,wn,Ro,Qo,oo,Yt;const Ue=i();if(!Ue)return;je===ii&&Ir(L(),Uo(r).loadingKLine=!0,Uo(r));const kt=a().url.searchParams.get("strategy");console.log("loadKlineRange",{symbol:z,period:te,start_ms:ve,stop_ms:Ne,strategy:kt});const lt=await k.getHistoryKLineData({symbol:z,period:te,from:ve,to:Ne,strategy:kt});let Ct=(lt.data||[]).slice(Math.max(0,(lt.data||[]).length-600));if(!Ct||Ct.length===0){je===ii&&Ir(L(),Uo(r).loadingKLine=!1,Uo(r));return}const Kt=((Vo=(Ho=s().styles)==null?void 0:Ho.candle)==null?void 0:Vo.type)||ZM((Qs=(Cn=i())==null?void 0:Cn.getStyles)==null?void 0:Qs.call(Cn),s().styles),Dt=ym(z),jt=Kt;if(jt==="heikin_ashi")Ct=My(Ct);else if(jt==="renko_atr"){try{const To=lt.data&&lt.data.length?Math.min(...lt.data.map(vo=>vo.timestamp||0)):null;To&&(!rr||To<rr)&&(rr=To)}catch{}const Ht=((zi=(Gn=s().styles)==null?void 0:Gn.candle)==null?void 0:zi.renko)||{method:"ATR",atrLength:14,source:"close",wick:!1};Ct=Ty(Ct,Ht)}else if(jt==="point_and_figure"){const Ht=((Ro=(wn=s().styles)==null?void 0:wn.candle)==null?void 0:Ro.pnf)||{boxSizeMode:"ATR",boxSize:1,atrLength:14,reversalBoxes:3,upColor:"#00E6D8",downColor:"#FF4D4D"};Ct=Ay(Ct,Ht)}if(Ct=Ct.map((Ht,To)=>((!Ht.timestamp||isNaN(Ht.timestamp)||Ht.timestamp<=0)&&(console.warn(`Invalid timestamp in klines at index ${To}:`,Ht.timestamp),Ht.timestamp=Date.now()-(Ct.length-To)*6e4),Ht)),je!==ii){console.log("⏭️ Ignoring stale load result");return}try{let Ht=bm(z,lt.data);try{const Ot=Array.isArray(lt.data)?lt.data[lt.data.length-1]:null,Yo=Ot&&typeof Ot=="object"?Number(Ot.close):Array.isArray(Ot)?Number(Ot[4]):NaN;(Number.isFinite(Yo)&&Math.abs(Yo)>=1e4||Dt==="crypto"&&Number.isFinite(Yo)&&Math.abs(Yo)>=1e3)&&(Ht=2)}catch{}((oo=(Qo=Ue==null?void 0:Ue.getSymbol)==null?void 0:Qo.call(Ue))==null?void 0:oo.pricePrecision)!==Ht&&(Ue==null||Ue.setSymbol({pricePrecision:Ht}));const vo=z==null?void 0:z.pricePrecision;(!Number.isFinite(vo)||vo!==Ht)&&T().update(Ot=>(Ot.symbol&&Ot.symbol.ticker===z.ticker&&(Ot.symbol.pricePrecision=Ht),Ot))}catch{}const Co=jt==="renko_atr",Oo=!Co&&Re&&Ct.length>0;Ue.applyNewData(Ct,!!Oo);try{nc()}catch{}try{(Ct??[]).length>0&&b(Z,!0)}catch{}try{k.startBackgroundPrefetch(z,{timeframe:te.timeframe})}catch{}if(lt.lays&&lt.lays.length>0&&n(Y)&&lt.lays.forEach(Ht=>{n(Y).addOverlay(Ht)}),je===ii&&Ir(L(),Uo(r).loadingKLine=!1,Uo(r)),Ir(L(),Uo(r).klineLoaded+=1,Uo(r)),Ct.length){const Ht=I0(te.timeframe)*1e3,To=new Date().getTime(),vo=Ct[Ct.length-1].timestamp+Ht;!Co&&vo+Ht>To&&(((Yt=s().options)==null?void 0:Yt.enableRealtime)===!0||l().playing===!0?k.subscribe(z,Yo=>{const is=Yo;if(!(z.exchange==="DSEBD"?(()=>{var Ut,xs,fs;const ur=new Date,yl=new Intl.DateTimeFormat("en-GB",{timeZone:"Asia/Dhaka",hour12:!1,weekday:"short",hour:"2-digit",minute:"2-digit"}).formatToParts(ur),kn=((Ut=yl.find(rs=>rs.type==="weekday"))==null?void 0:Ut.value)??"",Sr=Number(((xs=yl.find(rs=>rs.type==="hour"))==null?void 0:xs.value)??"0"),Ba=Number(((fs=yl.find(rs=>rs.type==="minute"))==null?void 0:fs.value)??"0"),Pt=Sr*60+Ba;return["Sun","Mon","Tue","Wed","Thu"].includes(kn)&&Pt>=600&&Pt<=870})():!0))return;const Rs=Ue.getDataList(),Ws=Rs[Rs.length-1],li=Ws&&Ws.timestamp?[Ws.timestamp,Ws.open,Ws.high,Ws.low,Ws.close,Ws.volume??0]:null,an=KM(is.bars,is.secs*1e3,Ht,li),Br=Ue.getChartStore(),ya=Ue.getVisibleRange(),As=Ue.getDataList(),qs=ya&&As[ya.from]?As[ya.from].timestamp:null,Jn=As.length-1,Pi=ya?ya.to>=Jn-1:!0,_l=an.map(([ur,yl,kn,Sr,Ba,Pt])=>({timestamp:ur,open:yl,high:kn,low:Sr,close:Ba,volume:Pt}));Br.addData(_l,"backward",{forward:Pi,backward:!1});try{const ur=Ue.getDataList();Array.isArray(ur)&&ur.length>0&&b(Z,!0)}catch{}!Pi&&ya&&qs&&requestAnimationFrame(()=>{try{const yl=Ue.getDataList().findIndex(kn=>kn.timestamp===qs);yl!==-1?Ue.scrollToDataIndex(yl):Ue.scrollToDataIndex(ya.from)}catch{}})}):console.log("⏹️ Realtime updates disabled"))}}async function et(){b(Z,!1);const z=py(s().dateStart);let te=py(s().dateEnd);if(!z||!te){me.addAlert("error","invalid time, please use: 202301011200");return}const ve=I0(s().period.timeframe)*1e3;(te-z)/ve>A&&(te=z+ve*A),await nt(s().symbol,s().period,z,te,!1)}function ht(z){console.log("🔄 loadSymbolPeriod called"),b(Z,!1);const te=s().symbol,ve=s().period;console.log("🔄 Loading symbol:",te.ticker,"period:",ve.timeframe);const Ne=new Date().getTime(),[Re,je]=Q6(ve,Ne,_e);console.log("🔄 Time range:",new Date(Re),"to",new Date(Ne)),nt(te,ve,Re,Ne,!P(),z??ii);try{setTimeout(()=>{var Ue;try{const kt=i(),lt=((Ue=kt==null?void 0:kt.getDataList)==null?void 0:Ue.call(kt))??[];if(!Array.isArray(lt)||lt.length===0){const bt=ii;console.log("🔁 Retrying loadSymbolPeriod due to empty data after TF change"),nt(te,ve,Re,Ne,!P(),bt)}}catch{}},250)}catch{}}Cc(T(),z=>z.period.timeframe).subscribe(z=>{var te,ve;try{(te=i())==null||te.setFormatter({formatDate:({timestamp:Ne,template:Re,type:je})=>fy(s().period.timespan)(Ne,Re,je)})}catch{}J_.set(s().period);try{const Ne=s().period,je={s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month"}[Ne.timespan]??"day",Ue=Number(Ne.multiplier)||1;(ve=i())==null||ve.setPeriod({type:je,span:Ue})}catch{}if(rr=null,!(P()||!i())){try{k.unsubscribe()}catch{}if(vl.changeTimeframe({chart:i(),period:s().period,loadDataFn:async()=>{const Ne=Xa();try{b(Z,!1)}catch{}await ht(Ne)}}),jr){try{jr()}catch{}jr=null}i()&&(jr=X(i()))}}),Cc(T(),z=>z.symbol.ticker).subscribe(z=>{var Re;console.log("📊 Symbol subscription triggered:",z),console.log("📊 Current symbol:",s().symbol),console.log("📊 Loading state:",r().loadingKLine,"Custom load:",P()),Py.set(s().symbol);const te={...s().symbol,ticker:s().symbol.ticker,pricePrecision:bm(s().symbol),volumePrecision:s().symbol.volumePrecision};try{eb({logo:s().symbol.logo,logo2:s().symbol.logo2})}catch{}if((Re=i())==null||Re.setSymbol(te),rr=null,el){const je=Hp(s().symbol);el.setCurrentSymbol(je),console.log("🔄 DrawingManager updated to symbol:",je),el.renderCurrentSymbolDrawings()}try{const je=window.overlayCreationManager;je&&je.setCurrentSymbolKey(Hp(s().symbol))}catch{}if(P())return;console.log("📊 Proceeding with symbol change - unsubscribing and loading new data");const ve=S;S=s().symbol,ve&&ve.ticker!==s().symbol.ticker?k.unsubscribe(ve):k.unsubscribe();try{b(Z,!1)}catch{}if(jr){try{jr()}catch{}jr=null}i()&&(jr=X(i()));const Ne=Xa();ht(Ne)});const Jt=["SMART_MONEY","TRAP_HUNTER","VOLCANIC","VOLCANIC_SIG"];function fo(){var Ne,Re;if(!i())return;const z=(Ne=d())==null?void 0:Ne.data;if(z&&(z.isPremium===!0||z.isTrial===!0))return;console.log("🔒 User does not have premium access. Removing AI indicators...");const ve=i();try{const je=((Re=ve.getIndicators)==null?void 0:Re.call(ve))??[];let Ue=0;for(const kt of je)if(kt.name&&Jt.includes(kt.name))try{ve.removeIndicator({paneId:kt.paneId||"candle_pane",name:kt.name}),Ue+=1,console.log(`✅ Removed AI indicator: ${kt.name} from pane: ${kt.paneId}`)}catch(lt){console.warn(`⚠️ Failed to remove indicator ${kt.name}:`,lt)}T().update(kt=>{if(!kt.saveInds)return kt;const lt=[];return Object.keys(kt.saveInds).forEach(bt=>{const Ct=kt.saveInds[bt];Ct&&Ct.name&&Jt.includes(Ct.name)&&lt.push(bt)}),lt.forEach(bt=>{delete kt.saveInds[bt],console.log(`🧹 Removed AI indicator from saveInds: ${bt}`)}),kt}),Ue>0&&(Ou(),console.log(`✅ Removed ${Ue} AI indicator(s) due to lack of premium access`))}catch(je){console.error("❌ Error removing AI indicators:",je)}}let lo=oe(null),so=oe(!1);Wi(()=>{var Ne;if(!i())return;const z=(Ne=d())==null?void 0:Ne.data;if(z===void 0)return;const te=z&&(z.isPremium===!0||z.isTrial===!0);(!n(so)||n(lo)===!0&&te===!1)&&!te&&setTimeout(()=>{fo()},1e3),b(lo,j(te)),b(so,!0)});const ko=Cc(T(),z=>z.theme);let ts=s().theme;ko.subscribe(z=>{var Ue,kt,lt,bt,Ct,Kt,Dt,jt,Co,Oo,Ho,Vo,Cn,Qs,Gn,zi,wn,Ro,Qo,oo,Yt,Ht,To,vo,Ot,Yo,is,vs,Rs,Ws,li,an,Br,ya,As,qs,Jn,Pi,_l,ur,yl,kn,Sr,Ba,Pt,Ut,xs,fs,rs;if(console.log("🎨 THEME SUBSCRIPTION TRIGGERED:",z,"Previous:",ts),z===ts){console.log("⏸️ Theme value unchanged, skipping subscription");return}if(console.log("🎨 THEME ACTUALLY CHANGED:",ts,"->",z),ts=z,bs){console.log("⏸️ Skipping theme subscription - manual styles being applied");return}if(r().isApplyingManualStyles){console.log("⏸️ SKIPPING theme application - manual styles are being applied via context");return}z=="light"?(Ir(T(),Uo(s).colorLong="green",Uo(s)),Ir(T(),Uo(s).colorShort="red",Uo(s))):(Ir(T(),Uo(s).colorLong="green",Uo(s)),Ir(T(),Uo(s).colorShort="rgb(255,135,8)",Uo(s)));const te=Ul(s().theme);console.log("🎨 Theme styles from getThemeStyles:",JSON.stringify(te,null,2)),console.log("💾 Current save.styles:",JSON.stringify(s().styles,null,2));const ve=iv(s().styles),Ne=(Ue=ve==null?void 0:ve.candle)==null?void 0:Ue.type;Ne&&console.log("🔒 Preserving chart type during theme change:",Ne);const Re=Rt.merge({},te,ve);console.log("🎨 theme axis colors:",(bt=(lt=(kt=te==null?void 0:te.xAxis)==null?void 0:kt.tickText)==null?void 0:lt.style)==null?void 0:bt.color,(Dt=(Kt=(Ct=te==null?void 0:te.yAxis)==null?void 0:Ct.tickText)==null?void 0:Kt.style)==null?void 0:Dt.color),console.log("💾 saved axis colors:",Rt.get(ve,"xAxis.tickText.style.color"),Rt.get(ve,"yAxis.tickText.style.color")),Ne&&Re.candle&&(Re.candle.type=Ne);try{const mn=(Oo=(Co=(jt=te==null?void 0:te.candle)==null?void 0:jt.tooltip)==null?void 0:Co.title)==null?void 0:Oo.color;if(mn&&((Vo=(Ho=Re==null?void 0:Re.candle)==null?void 0:Ho.tooltip)!=null&&Vo.title)){Re.candle.tooltip.title.color=mn;try{T().update(Ds=>(Ds.styles||(Ds.styles={}),Rt.set(Ds.styles,"candle.tooltip.title.color",mn),Ds))}catch{}}}catch{}try{const mn=(Gn=(Qs=(Cn=te==null?void 0:te.candle)==null?void 0:Cn.tooltip)==null?void 0:Qs.legend)==null?void 0:Gn.color,Ds=(Ro=(wn=(zi=te==null?void 0:te.indicator)==null?void 0:zi.tooltip)==null?void 0:wn.legend)==null?void 0:Ro.color;if(mn&&((oo=(Qo=Re==null?void 0:Re.candle)==null?void 0:Qo.tooltip)!=null&&oo.legend)){Re.candle.tooltip.legend.color=mn;try{T().update(sn=>(sn.styles||(sn.styles={}),Rt.set(sn.styles,"candle.tooltip.legend.color",mn),sn))}catch{}}if(Ds&&((Ht=(Yt=Re==null?void 0:Re.indicator)==null?void 0:Yt.tooltip)!=null&&Ht.legend)){Re.indicator.tooltip.legend.color=Ds;try{T().update(sn=>(sn.styles||(sn.styles={}),Rt.set(sn.styles,"indicator.tooltip.legend.color",Ds),sn))}catch{}}}catch{}try{const mn=(Ot=(vo=(To=te==null?void 0:te.xAxis)==null?void 0:To.tickText)==null?void 0:vo.style)==null?void 0:Ot.color,Ds=(vs=(is=(Yo=te==null?void 0:te.yAxis)==null?void 0:Yo.tickText)==null?void 0:is.style)==null?void 0:vs.color;mn&&((Ws=(Rs=Re==null?void 0:Re.xAxis)==null?void 0:Rs.tickText)!=null&&Ws.style)&&(Re.xAxis.tickText.style.color=mn,(li=Re==null?void 0:Re.xAxis)!=null&&li.tickText&&(delete Re.xAxis.tickText.color,delete Re.xAxis.tickText.opacity,Re.xAxis.tickText.color=mn)),Ds&&((Br=(an=Re==null?void 0:Re.yAxis)==null?void 0:an.tickText)!=null&&Br.style)&&(Re.yAxis.tickText.style.color=Ds,(ya=Re==null?void 0:Re.yAxis)!=null&&ya.tickText&&(delete Re.yAxis.tickText.color,delete Re.yAxis.tickText.opacity,Re.yAxis.tickText.color=Ds))}catch{}try{if((qs=(As=Re==null?void 0:Re.candle)==null?void 0:As.tooltip)!=null&&qs.legend){const mn=Re.candle.tooltip.legend.color;Re.candle.tooltip.legend.template=({current:Ds})=>{const sn="#32CD32",na="#FF0000",Wo=((Ds==null?void 0:Ds.close)??0)>((Ds==null?void 0:Ds.open)??0),Pl=((Ds==null?void 0:Ds.close)??0)<((Ds==null?void 0:Ds.open)??0),El=Wo?sn:Pl?na:mn,fe=gs=>({text:gs,color:El});return typeof window<"u"&&window.innerWidth<=768?[{title:"O",value:fe("{open}")},{title:"H",value:fe("{high}")},{title:"L",value:fe("{low}")},{title:"C",value:fe("{close}")},{title:"V",value:fe("{volume}")}]:[{title:"O",value:fe("{open}")},{title:"H",value:fe("{high}")},{title:"L",value:fe("{low}")},{title:"C",value:fe("{close}")},{title:"V",value:fe("{volume}")}]}}}catch{}console.log("🔄 Merged styles (theme + saved):",JSON.stringify(Re,null,2)),console.log("🔄 merged axis colors before process:",(_l=(Pi=(Jn=Re==null?void 0:Re.xAxis)==null?void 0:Jn.tickText)==null?void 0:Pi.style)==null?void 0:_l.color,(kn=(yl=(ur=Re==null?void 0:Re.yAxis)==null?void 0:ur.tickText)==null?void 0:yl.style)==null?void 0:kn.color);const je=al(Re);console.log("✨ Final processed styles:",JSON.stringify(je,null,2)),console.log("✨ processed axis colors:",(Pt=(Ba=(Sr=je==null?void 0:je.xAxis)==null?void 0:Sr.tickText)==null?void 0:Ba.style)==null?void 0:Pt.color,(fs=(xs=(Ut=je==null?void 0:je.yAxis)==null?void 0:Ut.tickText)==null?void 0:xs.style)==null?void 0:fs.color),(rs=i())==null||rs.setStyles(je),console.log("✅ Styles applied to chart via theme subscription"),console.log("🎨 APPLYING SAVED CANVAS COLORS AFTER THEME CHANGE"),setTimeout(()=>{ai(),console.log("✅ Canvas colors reapplied after theme change")},100),setTimeout(()=>{var Ds,sn,na;console.log("🔍 CHART STATE CHECK after theme subscription:");const mn=(Ds=i())==null?void 0:Ds.getStyles();console.log("  - Current chart styles:",JSON.stringify(mn,null,2)),console.log("  - Saved chart type in $save.styles:",(na=(sn=s().styles)==null?void 0:sn.candle)==null?void 0:na.type)},200)}),Cc(T(),z=>z.timezone).subscribe(z=>{var te;(te=i())==null||te.setTimezone(z),gy(z)});const ro=Cc(T(),z=>{var te,ve;return(ve=(te=z.styles)==null?void 0:te.candle)==null?void 0:ve.type});let Do=((dr=(gn=s().styles)==null?void 0:gn.candle)==null?void 0:dr.type)||null;ro.subscribe(z=>{if(r().loadingKLine||P())return;const te=i();if(!te)return;rr=null;const ve=Do==="point_and_figure",Ne=z==="point_and_figure";if(Ne&&!ve)try{te.createIndicator("PNF",!1,{id:"candle_pane"}),console.log("📊 Added PNF indicator for Point & Figure chart")}catch(Re){console.warn("Failed to add PNF indicator:",Re)}else if(!Ne&&ve)try{te.removeIndicator({paneId:"candle_pane",name:"PNF"}),console.log("📊 Removed PNF indicator (switched from P&F)");const Re=Ul(s().theme),je=Rt.merge({},Re,iv(s().styles)),Ue=al(je);te.setStyles(Ue),console.log("🎨 Refreshed styles after P&F exit - candle colors restored")}catch(Re){console.warn("Failed to cleanup after P&F:",Re)}Do=z||null,(z==="heikin_ashi"||z==="renko_atr"||z==="point_and_figure"||z!=="heikin_ashi"&&z!=="renko_atr"&&z!=="point_and_figure"&&te.getDataList().length>0)&&vl.switchChartType({chart:te,newType:z||"candle_solid",reloadDataFn:async()=>{await ht()}})}),Cc(T(),z=>{var ve,Ne;const te=((Ne=(ve=z.styles)==null?void 0:ve.candle)==null?void 0:Ne.renko)||{};return JSON.stringify(te)}).subscribe(z=>{var ve,Ne;if(r().loadingKLine||P()||((Ne=(ve=s().styles)==null?void 0:ve.candle)==null?void 0:Ne.type)!=="renko_atr")return;const te=i();te&&vl.switchChartType({chart:te,newType:"renko_atr",reloadDataFn:async()=>{await ht()}})}),Cc(T(),z=>{var ve,Ne;const te=((Ne=(ve=z.styles)==null?void 0:ve.candle)==null?void 0:Ne.pnf)||{};return JSON.stringify(te)}).subscribe(z=>{var ve,Ne;if(r().loadingKLine||P()||((Ne=(ve=s().styles)==null?void 0:ve.candle)==null?void 0:Ne.type)!=="point_and_figure")return;const te=i();te&&vl.switchChartType({chart:te,newType:"point_and_figure",reloadDataFn:async()=>{await ht()}})}),Cc(L(),z=>z.fireOhlcv).subscribe(async z=>{r().timeStart&&r().timeEnd?(await nt(s().symbol,s().period,r().timeStart,r().timeEnd),Ir(L(),Uo(r).timeStart=0,Uo(r)),Ir(L(),Uo(r).timeEnd=0,Uo(r))):await et()});function Cs(){return i()}function ns(z){bs=z}let Js=oe(0),Nn=oe(0),ui=oe(0),Ms=oe(0),Li=oe(!1),Dr=oe(0),Xr=oe(0),Ki=oe(""),Ge,at=oe(!1),So=oe(""),qt=0,Io=0,us=null,fn=oe(j([])),Ts=oe(0),js=oe(!1),on=null,_s=oe(1);function In(z){var te,ve;if(i())try{const Ne=i(),Re=((te=Ne.getPaneOptions)==null?void 0:te.call(Ne,z))||null,je=(Re==null?void 0:Re.state)||"normal",Ue=je==="maximize"?"normal":"maximize";(ve=Ne.setPaneOptions)==null||ve.call(Ne,{id:z,state:Ue}),console.log("🖱️ Pane double-click toggle",{paneId:z,from:je,to:Ue})}catch(Ne){console.warn("⚠️ Failed to toggle pane state",z,Ne)}}function Ci(z){var Ue;if(!i()||!B)return;const te=i();try{if(!(((Ue=te.getIndicators)==null?void 0:Ue.call(te))??[]).some(bt=>bt.paneId&&bt.paneId!=="candle_pane"))return}catch{return}const ve=te._drawPanes;if(!Array.isArray(ve)||ve.length===0){In("candle_pane");return}const Ne=B.getBoundingClientRect(),Re=z.clientY-Ne.top;let je=null;for(const kt of ve){if(!kt||typeof kt.getId!="function"||typeof kt.getBounding!="function")continue;const lt=kt.getId();if(lt==="x_axis_pane")continue;const bt=kt.getBounding();if(!bt||typeof bt.height!="number")continue;const Ct=typeof bt.top=="number"?bt.top:0,Kt=bt.height;if(Re>=Ct&&Re<=Ct+Kt){je=lt;break}}je||(je="candle_pane"),In(je)}function zr(z){const te=B==null?void 0:B.getBoundingClientRect();te&&(b(Js,z.clientX-te.left),b(Nn,z.clientY-te.top)),b(ui,j(z.clientX)),b(Ms,j(z.clientY))}function ca(z){if(z.preventDefault(),Zl())return;const te=B==null?void 0:B.getBoundingClientRect();if(te){const ve=z.clientX-te.left,Ne=z.clientY-te.top;b(Dr,ve),b(Xr,Ne),b(Ki,j(hd())),Vl(ve,Ne)}}function hl(z){if(z.touches.length===1){const te=z.touches[0],ve=B==null?void 0:B.getBoundingClientRect();ve&&(b(Js,te.clientX-ve.left),b(Nn,te.clientY-ve.top)),b(ui,j(te.clientX)),b(Ms,j(te.clientY));const Ne=z.target;if(n(Li)&&Ne&&(Ne.closest(".modal-content")||Ne.closest(".action-btn")))return;const Re=Date.now(),je=Re-qt;if(je<300&&je>0){if(Io+=1,Io===2){if(z.preventDefault(),ve){const Ue=te.clientX-ve.left,kt=te.clientY-ve.top;fa(Ue,kt)}Io=0;return}}else if(Io=1,n(Li)){z.preventDefault(),za(),Io=0;return}qt=Re,us&&clearTimeout(us),us=setTimeout(()=>{Io=0},300)}}function fa(z,te){b(Dr,j(z)),b(Xr,j(te)),b(Ki,j(hd())),b(Li,!0)}function za(){b(Li,!1)}let oc=oe(!1),sc=oe(0),Cl=oe(0);function Vl(z,te){b(sc,j(z)),b(Cl,j(te)),b(oc,!0)}function ul(){b(oc,!1)}function nc(){var z;try{if(n(le))return;const te=i();if(!te)return;const ve=te.getVisibleRange(),Ne=((z=te.getDataList)==null?void 0:z.call(te))??[];if(!ve||!Array.isArray(Ne)||Ne.length===0)return;const Re=ve.to-ve.from+1;b(se,Re),b(ie,ve.to>=Ne.length-2),b(le,!0)}catch{}}function vc(){var te,ve,Ne;const z=i();if(z)try{nc();const Re=B==null?void 0:B.getBoundingClientRect(),je=Re?Re.width:((te=z.getSize())==null?void 0:te.width)??0,Ue=z.getDataList(),kt=Math.min(180,Array.isArray(Ue)?Ue.length:180),lt=Math.max(1,n(se)??kt),bt=z.getChartStore(),Ct=je>0?Math.floor(je/lt):bt.getBarSpace().bar,Kt=Math.max(1,Math.min(50,Ct));bt.setBarSpace(Kt);const Dt=((ve=bt.getInitialOffsetRightDistance)==null?void 0:ve.call(bt))??bt.getOffsetRightDistance();bt.setOffsetRightDistance(Dt,!0),z.scrollToRealTime(),(Ne=z._drawPanes)==null||Ne.forEach(Co=>{var Ho,Vo,Cn;const Oo=(Ho=Co==null?void 0:Co.getAxisComponent)==null?void 0:Ho.call(Co);(Vo=Oo==null?void 0:Oo.setAutoCalcTickFlag)==null||Vo.call(Oo,!0),(Cn=Oo==null?void 0:Oo.buildTicks)==null||Cn.call(Oo,!0)})}finally{ul()}}function Zl(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window||navigator.maxTouchPoints>0}async function Ha(z){try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(z),console.log("✅ Copied using modern clipboard API"),!0}catch(te){console.warn("Modern clipboard API failed:",te)}try{const te=document.createElement("textarea");te.value=z,te.style.position="fixed",te.style.left="-999999px",te.style.top="-999999px",te.style.opacity="0",te.style.pointerEvents="none",te.setAttribute("readonly",""),document.body.appendChild(te),te.focus(),te.select(),te.setSelectionRange(0,z.length);const ve=document.execCommand("copy");if(document.body.removeChild(te),ve)return console.log("✅ Copied using fallback method"),!0}catch(te){console.error("Fallback copy method failed:",te)}try{const te=window.getSelection();if(te){const ve=document.createRange(),Ne=document.createElement("span");Ne.textContent=z,Ne.style.position="fixed",Ne.style.left="-999999px",Ne.style.opacity="0",document.body.appendChild(Ne),ve.selectNode(Ne),te.removeAllRanges(),te.addRange(ve);const Re=document.execCommand("copy");if(document.body.removeChild(Ne),te.removeAllRanges(),Re)return console.log("✅ Copied using selection API fallback"),!0}}catch(te){console.error("Selection API fallback failed:",te)}return console.error("❌ All copy methods failed"),!1}function qc(){const z=i();if(!z)return console.error("Chart not initialized"),!1;try{const te=z.getDataList();if(te.length<10)return console.warn("⚠️ Need more historical data for prediction"),!1;const ve=te[te.length-1],Re=I0(s().period.timeframe)*1e3;if(!PO(ve.timestamp,Re)&&n(Ts)===0){const Co=Date.now()-ve.timestamp,Oo=Math.floor(Co/6e4);console.info(`ℹ️ Market appears to be open (last candle ${Oo}m ago). Prediction is most useful when market is closed.`)}const Ue=te,kt=CO(Ue);if(!kt)return console.error("❌ Failed to generate prediction"),!1;b(fn,j([...n(fn),kt])),Zw(Ts);const lt=[...Ue,kt],bt=z.getVisibleRange(),Ct=bt?bt.to>=Ue.length-2:!0;z.applyNewData(lt,!1);try{(lt??[]).length>0&&b(Z,!0)}catch{}Ct&&setTimeout(()=>{z.scrollToRealTime()},50);const Kt=Ue[Ue.length-1].close,Dt=(kt.close-Kt)/Kt*100,jt=Dt>0?"📈":"📉";return console.log(`${jt} Prediction #${n(Ts)}: ${Dt>0?"+":""}${Dt.toFixed(2)}% (Close: ${kt.close.toFixed(2)})`),console.log("✅ Prediction added:",kt),console.log("📊 Total predictions so far:",n(Ts)),!0}catch(te){return console.error("❌ Prediction error:",te),!1}}function _c(){return Math.round(2e3/n(_s))}function ld(){if(!n(js))return;on&&(clearInterval(on),on=null);const z=_c();on=setInterval(()=>{n(js)&&qc()},z),console.log(`⚡ Speed changed: ${n(_s)}x (${z}ms interval)`)}function Od(z){b(_s,j(z)),ld()}function Hc(){if(n(js))return;b(js,!0),console.log("▶️ Auto-play started"),qc();const z=_c();on=setInterval(()=>{n(js)&&qc()},z)}function fl(){b(js,!1),on&&(clearInterval(on),on=null),console.log("⏸️ Auto-play stopped")}function tl(){n(js)?fl():Hc()}function hd(){const z=i();if(!z||n(Js)===null||n(Nn)===null)return"";try{const te=(jt,Co)=>{if(!Number.isFinite(jt)||jt===0)return`${jt}`;const Oo=jt<0?"-":"",Ho=Math.abs(jt),Vo=Math.floor(Math.log10(Ho))+1;let Cn=Ho/Math.pow(10,Vo),Qs=Vo;const Gn=Number(Cn.toFixed(Co));return Gn>=1?(Cn=Gn/10,Qs=Vo+1):Cn=Gn,`${Oo}${Cn.toFixed(Co)}e${Qs}`},ve=jt=>{var Vo,Cn;const Co=Number((Cn=(Vo=z==null?void 0:z.getSymbol)==null?void 0:Vo.call(z))==null?void 0:Cn.pricePrecision);let Oo=Number.isFinite(Co)?Math.max(0,Math.min(12,Math.trunc(Co))):bm(s().symbol);const Ho=ym(s().symbol);if(Number.isFinite(jt)&&Math.abs(jt)>=1e4)Oo=2;else if(Ho==="crypto"&&Number.isFinite(jt)){const Qs=Math.abs(jt);Qs>=1e3?Oo=2:Qs>=1?Oo=Math.min(Math.max(Oo,2),4):Qs>=.01?Oo=Math.min(Math.max(Oo,4),8):Oo=Math.min(Math.max(Oo,6),12)}return Math.max(0,Math.min(12,Math.trunc(Oo)))},Ne=jt=>{try{const Co=ym(s().symbol);if((Co==="stock"||Co==="crypto")&&Number.isFinite(jt)){const Oo=Math.abs(jt);if(Oo>0&&Oo<1e-4)return te(jt,5)}}catch{}return jt.toFixed(ve(jt))},Re=B==null?void 0:B.getBoundingClientRect();if(!Re)return"";if(z&&typeof z.convertFromPixel=="function")try{const jt=z.convertFromPixel([{x:n(Js),y:n(Nn)}],{paneId:"candle_pane"});if(jt&&Array.isArray(jt)&&jt[0]&&typeof jt[0].value=="number")return Ne(jt[0].value)}catch{}const je=z.getVisibleRange(),Ue=z.getDataList();if(!Ue||Ue.length===0||!je)return"";const kt=Ue.slice(je.from,je.to+1);if(kt.length===0)return"";let lt=1/0,bt=-1/0;kt.forEach(jt=>{lt=Math.min(lt,jt.low),bt=Math.max(bt,jt.high)});const Ct=bt-lt;if(Ct<=0)return"";const Kt=n(Nn)/Re.height,Dt=bt-Kt*Ct;return Ne(Dt)}catch{return""}}console.log("📊 Chart script execution completed");var Rc=zq();Rc.__click=[Fq,r,L];var iu=g(Rc);Ns(iu,5,v,z=>z.id,(z,te)=>{Jw(z,{get type(){return n(te).type},get text(){return n(te).text}})}),f(iu);var Iu=u(iu,2);CR(Iu,{get customLoad(){return P()},get mainContainer(){return n(K)},set mainContainer(z){b(K,j(z))},get sidebarHost(){return n(q)},set sidebarHost(z){b(q,j(z))},onToggleScriptStudio:()=>{b(Pe,!n(Pe)),n(Pe)||b(ze,!1),zn()}});var uu=u(Iu,2),Vd=g(uu),ru=g(Vd),qu=g(ru),Mu=g(qu);Ec(hA(Mu,{}),z=>b(Y,j(z)),()=>n(Y)),f(qu);var Ad=u(qu,2);Se(Ad,()=>!n(Z),z=>{var te=Dq();O(z,te)});var _d=u(Ad,2);_d.__keydown=[Aq,Y],_d.__contextmenu=ca,_d.__mousemove=zr,_d.__dblclick=Ci,_d.__touchstart=hl,_d.__click=[Lq,Li,za,oc,ul];var Bs=g(_d);Ec(Bs,z=>R=z,()=>R);var bp=u(Bs,2);Ec(bp,z=>N=z,()=>N),f(_d),Ec(_d,z=>B=z,()=>B);var xp=u(_d,2);DO(xp,{}),f(ru);var Xc=u(ru,2);const sp=We(()=>`height: ${n(Pe)?`${Math.round(n(De)*100)}%`:"0px"};`);var wp=g(Xc);wp.__mousedown=tr,wp.__touchstart=tr;var pu=u(wp,2);pu.__touchmove=[Eq];var Kp=g(pu),vu=We(()=>n(ne)?_()[n(ne)]:null),yd=We(()=>n(ne)?y()[n(ne)]||[]:[]);qW(Kp,{get code(){return n(Je)},set code(z){b(Je,j(z))},get status(){return n(ye)},get error(){return n(Ae)},get backtest(){return n(vu)},get signalEvents(){return n(yd)},get isRunning(){return n(ee)},get isOpen(){return n(Pe)},get paneTarget(){return n(J)},get labelsEnabled(){return n(xe)},$$events:{fullpage:z=>{var te;b(ze,j(!!((te=z==null?void 0:z.detail)!=null&&te.enabled)))},run:z=>{var te;return Hn(z.detail.code,((te=z==null?void 0:z.detail)==null?void 0:te.params)||null)},reset:ji,save:z=>_a(z.detail.code),close:Vs,pane:z=>b(J,j(z.detail.target)),labels:z=>b(xe,j(z.detail.enabled)),selectTrade:z=>{var ve;const te=(ve=z==null?void 0:z.detail)==null?void 0:ve.trade;te?ct(te):Oe()},focusIndex:z=>{var Re,je;const te=(Re=z==null?void 0:z.detail)==null?void 0:Re.index,ve=(je=z==null?void 0:z.detail)==null?void 0:je.timestamp;let Ne=!1;typeof te=="number"&&Number.isFinite(te)&&(Ne=Lt(te)),!Ne&&typeof ve=="number"&&Number.isFinite(ve)&&It(ve)},guide:()=>b(he,!0)}}),f(pu),f(Xc),f(Vd),Ec(Vd,z=>b(Q,z),()=>n(Q));var kp=u(Vd,2);Ec(iF(kp,{}),z=>b(q,j(z)),()=>n(q)),f(uu);var Sp=u(uu,2);Se(Sp,()=>n(es),z=>{var te=$q();O(z,te)});var Zp=u(Sp,2);nq(Zp,{get show(){return n(he)},$$events:{close:()=>b(he,!1),insert:z=>{b(Je,j(z.detail.code)),b(Pe,!0)}}});var np=u(Zp,2);IR(np,{get isOpen(){return n(Li)},set isOpen(z){b(Li,j(z))},get x(){return n(Dr)},get y(){return n(Xr)},get currentPrice(){return n(Ki)},$$events:{copy:async z=>{z.detail.price&&(await Ha(z.detail.price)?(b(So,`Price ${z.detail.price} copied!`),Ge==null||Ge.showToast(),za()):(b(So,"Failed to copy price"),Ge==null||Ge.showToast()))},reset:vc,close:za}});var ip=u(np,2);Se(ip,()=>n(oc),z=>{var te=jq(),ve=g(te);ve.__click=async()=>{await Ha(n(Ki))?b(So,`Price ${n(Ki)} copied!`):b(So,"Failed to copy price"),Ge==null||Ge.showToast(),ul()};var Ne=u(g(ve),2),Re=g(Ne);f(Ne),f(ve);var je=u(ve,2);je.__click=vc,f(te),we(()=>{St(te,"style",`left: ${n(sc)??""}px; top: ${n(Cl)??""}px;`),Ye(Re,`Copy Price ${(n(Ki)?`(${n(Ki)})`:"")??""}`)}),O(z,te)});var Xp=u(ip,2);Ec(Dx(Xp,{get visible(){return n(at)},set visible(z){b(at,j(z))},get message(){return n(So)},duration:2e3}),z=>Ge=z,()=>Ge);var Kd=u(Xp,2);mO(Kd,{get show(){return n(ar)},title:"Unsaved changes",message:"You made changes but did not save. Refresh will discard them.",$$events:{cancel:()=>{b(ar,!1)},confirm:()=>{var z;b(ar,!1);try{if(el&&__()){el.clearPersistedStorage();try{const te=(((z=s())==null?void 0:z.key)||"chart")+"_overlays";localStorage.removeItem(te)}catch{}try{localStorage.removeItem("dataSpaceOverlays")}catch{}}}catch{}location.reload()}}});var Mt=u(Kd,2);return pO(Mt,{}),f(Rc),Ec(Rc,z=>b(K,z),()=>n(K)),we(()=>{St(Rc,"data-theme",s().theme),Sn(Vd,"restoring",p()),Pn(Xc,`${`script-dock ${n(Pe)?"open":""} ${n(ze)?"fullpage":""}`??""} svelte-10y1ir0`),St(Xc,"style",n(sp)),St(Xc,"aria-hidden",!n(Pe)),St(pu,"style",`opacity:${n(Pe)?1:0}; pointer-events:${n(Pe)?"auto":"none"}; transform: ${n(Pe)?"none":"translateY(6px)"};`)}),Fl("wheel",pu,z=>z.stopPropagation()),O(o,Rc),Za({getChart:Cs,setManualStylesFlag:ns})}hc(["click","keydown","contextmenu","mousemove","dblclick","touchstart","mousedown","touchmove"]);function Gq(o,e){Ka(e,!1);const t=Zc(),s=()=>ir(y2,"$page",t),i=()=>ir(l,"$save",t);console.log("📄 +page.svelte loaded");const r=Id(new Ib);let a;try{const S=sessionStorage.getItem("chart.tabId");S?a=S:(a=`${Date.now()}-${Math.random().toString(36).slice(2)}`,sessionStorage.setItem("chart.tabId",a))}catch{a=`${Date.now()}-${Math.random().toString(36).slice(2)}`}const l=f1(`chart:${a}`,new Lm);let d=kl(!1),v="light";function p(S){v=S,document.documentElement.classList.toggle("dark",S==="dark"),document.documentElement.setAttribute("data-theme",S),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:S}})),console.log("🖌️ Applied theme to document:",S)}function _(){window.location.href="https://dutyai.app/chart"}let y=null;Rd(()=>((async()=>{var N,$,V,U;let S=null;const L=s().url.searchParams.get("userId");if(L){console.log("👤 User ID parameter found in URL:",L);try{localStorage.setItem("userId",L),console.log("✅ User ID saved to localStorage:",L);const G=new URL(window.location.href);G.searchParams.delete("userId"),window.history.replaceState({},"",G.toString()),console.log("🔗 User ID parameter removed from URL"),S=L}catch(G){console.error("❌ Failed to save user ID to localStorage:",G)}}else try{S=localStorage.getItem("userId"),S&&console.log("👤 User ID found in localStorage:",S)}catch(G){console.error("❌ Failed to read userId from localStorage:",G)}if(!S){console.warn("⚠️ No userId found in URL or localStorage. Redirecting..."),_();return}VM(!0);try{console.log("📡 Fetching user preferences for userId:",S);const G=await BM(S);console.log("✅ User preferences fetched successfully:",G),OM(G)}catch(G){console.error("❌ Failed to fetch user preferences:",G);{WM(G instanceof Error?G.message:"Unknown error"),console.warn("⚠️ User preferences fetch failed. Redirecting..."),_();return}}const T=s().url.searchParams.get("theme"),P=(V=($=(N=zd(Up))==null?void 0:N.data)==null?void 0:$.theme)==null?void 0:V.toLowerCase(),A=(U=zd(l))==null?void 0:U.theme,F=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,B=T==="dark"||T==="light"?T:P==="dark"||P==="light"?P==="dark"?"dark":"light":A==="dark"||A==="light"?A:F?"dark":"light";l.update(G=>(G.theme=B,G)),p(B),y=l.subscribe(G=>{const Z=G.theme==="dark"||G.theme==="light"?G.theme:F?"dark":"light";Z!==v&&p(Z)});const R=s().url.searchParams.get("symbol");if(R){console.log("🔗 Symbol parameter found in URL:",R);let G=0;const Z=50,le=()=>{G+=1;const se=i();if(se.allSymbols&&se.allSymbols.length>0){const ie=se.allSymbols.find(Y=>Y.ticker.toLowerCase()===R.toLowerCase());if(ie)console.log("✅ Found symbol from URL parameter:",ie),l.update(Y=>(Y.symbol=ie,Y));else{console.warn("⚠️ Symbol not found in available symbols:",R),console.log("📊 Available symbols:",se.allSymbols.map(K=>K.ticker).join(", "));const Y=se.allSymbols.slice(0,10).map(K=>K.ticker).join(", ");console.log(`💡 Try one of these symbols: ${Y}${se.allSymbols.length>10?"...":""}`)}}else G<Z?(console.log(`⏳ Waiting for symbols to load... (attempt ${G}/${Z})`),setTimeout(le,100)):console.error("❌ Timeout waiting for symbols to load. Symbol parameter will be ignored.")};le()}b(d,!0)})(),()=>{y&&y()})),Ud();var w=Xt(),k=_t(w);Se(k,()=>n(d),S=>{Bq(S,{ctx:r,save:l})}),O(o,w),Za()}export{Gq as component};
